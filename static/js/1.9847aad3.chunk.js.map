{"version":3,"sources":["component/highlight/index.js","component/utility/Export.js","data/utilities/checkModifierKeyActivated.js","component/EventsTrackers/BrushTracker.js","component/EventsTrackers/MouseTracker.js","component/context/ChartContext.jsx","component/context/DispatchContext.jsx","component/context/PreferencesContext.jsx","component/context/ScaleContext.jsx","component/elements/popup/options.js","component/elements/popup/Modal/Context.js","component/elements/popup/Modal/Modal.jsx","component/elements/popup/Transition.js","component/elements/popup/Wrapper.js","component/elements/popup/Modal/ConfirmDialog.jsx","component/elements/popup/Modal/Provider.js","component/reducer/types/Types.js","component/utility/FileUtility.js","component/loader/DropZone.jsx","component/loader/NoData.jsx","component/loader/DefaultSpinnerComponent.tsx","component/loader/SpinnerContext.tsx","component/loader/Spinner.jsx","component/context/GlobalContext.jsx","component/elements/ToolTip/ToolTip.jsx","component/elements/CloseButton.jsx","component/modal/MultipletAnalysisModal.jsx","component/constants/InitSetting.js","component/utility/LocalStorage.js","component/reducer/helper/Spectrum1DZoomHelper.js","component/reducer/actions/Zoom.js","component/1d/utilities/scale.js","component/reducer/scaleReducer.js","data/data1d/filter1d/absolute.js","data/data1d/filter1d/autoPhaseCorrection.js","data/data1d/filter1d/baselineCorrection.js","data/data1d/filter1d/digitalFilter.js","data/data1d/filter1d/fft.js","data/data1d/filter1d/lineBroadening.js","data/data1d/filter1d/phaseCorrection.js","data/data1d/filter1d/shiftX.js","data/data1d/filter1d/zeroFilling.js","data/data2d/filter2d/shiftX.js","data/data2d/filter2d/shiftY.js","data/Filters.js","component/toolbar/ToolTypes.js","component/tool/BrushXY.jsx","component/tool/CrossLinePointer.jsx","component/utility/Events.js","component/elements/DeleteButton.jsx","component/1d/BaseLineZones.jsx","component/panels/extra/preferences/defaultValues.js","component/1d/Resizable.jsx","component/1d/IntegralResizable.jsx","component/1d/Integral.jsx","component/1d/IntegralsSeries.jsx","component/1d/Line.jsx","component/1d/LinesSeries.jsx","component/utility/FormatNumber.js","component/1d/PeakNotation.jsx","component/1d/PeaksNotations.jsx","component/1d/XAxis.jsx","component/hoc/MultiAnalysisWrapper.js","component/1d/multiAnalysis/AnalysisRange.jsx","component/1d/multiAnalysis/MultiAnalysisRanges.jsx","component/hoc/RangesWrapper.js","data/constants/SignalsKinds.js","data/utilities/RangeUtilities.js","component/assignment/index.js","data/constants/Multiplets.js","component/panels/extra/utilities/MultiplicityUtilities.js","component/1d/multiplicityTree/TreeColors.js","component/1d/multiplicityTree/LevelNode.jsx","component/1d/multiplicityTree/StringNode.jsx","component/1d/multiplicityTree/TreeNodes.jsx","component/1d/multiplicityTree/buildTreeNode.js","component/1d/multiplicityTree/MultiplicityTree.jsx","component/1d/ranges/Range.jsx","component/1d/ranges/Ranges.jsx","component/1d/Chart1D.jsx","component/elements/popup/Help/Context.js","component/elements/popup/helpers.js","component/elements/popup/utility.js","component/elements/popup/Help/Reducer.js","component/elements/popup/Help/Provider.js","component/hoc/FooterWarpper.js","component/1d/FooterBanner.jsx","component/1d/SpectraTracker.jsx","component/1d/tool/PeakPointer.jsx","component/1d/tool/VerticalIndicator.jsx","component/1d/tool/XLabelPointer.jsx","component/1d/Viewer1D.jsx","component/2d/utilities/DimensionLayout.js","component/2d/utilities/scale.js","component/2d/Contours.jsx","component/reducer/core/Constants.js","component/2d/IndicationLines.jsx","component/2d/Left1DChart.jsx","component/2d/Top1DChart.jsx","component/2d/XAxis.jsx","component/2d/YAxis.jsx","component/hoc/ZonesWrapper.js","data/utilities/ZoneUtilities.js","data/utilities/Concatenation.js","component/2d/SignalDeltaLine.jsx","component/2d/zones/SignalCrosshair.jsx","component/2d/zones/Signal.jsx","component/2d/zones/Zone.jsx","component/2d/zones/Zones.jsx","component/2d/Chart2D.jsx","component/2d/FooterBanner.jsx","component/2d/tools/XYLabelPointer.jsx","data/utilities/generateID.js","data/FiltersManager.ts","data/utilities/getColor.js","data/data1d/autoRangesDetection.js","data/data1d/detectSignal.js","data/data1d/Datum1D.ts","data/data2d/Processing2D.js","data/data2d/Datum2D.ts","data/data2d/autoZonesDetection.js","component/2d/tools/slicing/SliceScale.js","component/2d/tools/slicing/HorizontalSliceChart.jsx","component/2d/tools/slicing/VerticalSliceChart.jsx","component/2d/tools/slicing/SlicingView.jsx","component/2d/Viewer2D.jsx","component/ErrorBoundary.tsx","component/elements/popup/Alert/Context.js","component/elements/popup/Alert/Provider.js","component/toolbar/useToolsFunctions.js","component/EventsTrackers/KeysListenerTracker.js","component/constants/help.js","component/modal/UserManualModal.jsx","component/elements/Tab/DeleteButton.jsx","component/elements/Tab/Tab.jsx","component/elements/Tab/options.js","component/elements/Tab/Tabs.jsx","component/elements/formik/FormikForm.jsx","component/reducer/preferencesReducer.js","component/elements/Logo.jsx","component/modal/setting/AboutTabContent.jsx","component/elements/CheckBox.jsx","component/elements/formik/FormikCheckBox.jsx","component/elements/Input.jsx","component/elements/formik/FormikInput.jsx","component/modal/setting/ControllersTabContent.jsx","component/modal/setting/DisplayTabContent.jsx","component/modal/setting/FormattingTabContent.jsx","component/modal/setting/GeneralSettings.jsx","component/elements/NumberInput.jsx","component/header/AutoPeakPickingOptionPanel.jsx","component/elements/Select.jsx","component/header/BaseLineCorrectionPanel.jsx","component/elements/InputRange.jsx","component/header/ManualPhaseCorrectionPanel.jsx","component/header/RangesPickingOptionPanel.jsx","component/header/ZeroFillingOptionsPanel.jsx","component/header/Zones2DOptionPanel.jsx","component/header/Header.jsx","component/elements/accordion/AccordionItem.jsx","component/elements/accordion/Accordion.jsx","component/elements/ReactTable/Style.js","component/elements/ReactTable/ReactTableFlexLayout.jsx","component/hoc/InfoWrapper.js","component/panels/InformationPanel.jsx","component/hoc/IntegralsWrapper.js","component/modal/changeSum/NumberInput.jsx","component/elements/NextPrev.jsx","component/elements/MoleculeSelection.jsx","component/modal/changeSum/SelectMolecule.jsx","component/modal/changeSum/ChangeSumModal.jsx","component/elements/ToggleButton.jsx","component/panels/header/DefaultPanelHeader.jsx","component/elements/SaveButton.jsx","component/panels/header/PreferencesHeader.jsx","component/elements/EditableColumn.jsx","component/elements/ContextMenu.jsx","component/elements/ReactTable/Elements/ReactTableHeader.js","component/elements/ReactTable/Elements/ReactTableRow.js","component/elements/ReactTable/ReactTable.jsx","component/panels/extra/placeholder/NoTableData.jsx","component/panels/IntegralsPanel/IntegralTable.jsx","component/elements/ColorInput.jsx","component/panels/extra/preferences/ColumnFormatField.jsx","component/panels/IntegralsPanel/IntegralsPreferences.jsx","component/panels/IntegralsPanel/IntegralPanel.jsx","component/elements/ButtonToolTip.jsx","component/elements/MenuButton.jsx","component/hoc/MoleculeWrapper.js","component/modal/MoleculeStructureEditorModal.jsx","component/elements/IsotopesViewer.jsx","component/elements/formik/FormikSelect.jsx","component/modal/PredictSpectraModal.jsx","component/panels/MoleculesPanel/Utilities.js","component/panels/MoleculesPanel/MoleculePanel.jsx","data/data1d/MulitpleAnalysis.js","data/utilities/generateChar.js","data/constants/References.js","component/modal/AlignSpectraModal.jsx","component/elements/styles/prism.js","component/utility/Evaluate.js","component/panels/MultipleSpectraAnalysisPanel/MulipleAnalysisCodeEditor.jsx","component/panels/MultipleSpectraAnalysisPanel/MultipleSpectraAnalysisPreferences.jsx","component/elements/dropDownButton/DropDownList.jsx","component/elements/dropDownButton/DropDownButton.jsx","component/panels/MultipleSpectraAnalysisPanel/ColumnHeader.jsx","component/panels/MultipleSpectraAnalysisPanel/MultipleSpectraAnalysisTable.jsx","component/panels/MultipleSpectraAnalysisPanel/MultipleSpectraAnalysisPanel.jsx","component/hoc/PeaksWrapper.js","component/panels/PeaksPanel/PeaksPreferences.jsx","component/panels/PeaksPanel/PeaksTable.jsx","component/panels/PeaksPanel/PeaksPanel.jsx","component/modal/CopyClipboardModal.jsx","component/panels/RangesPanel/RangesHeader.jsx","component/panels/RangesPanel/RangesPreferences.jsx","component/panels/extra/utilities/UseToggleStatus.js","component/panels/extra/preferences/ColumnsHelper.js","component/panels/RangesPanel/TableColumns/AbsoluteColumn.jsx","component/elements/SelectUncontrolled.jsx","component/elements/Button.jsx","component/elements/formik/ErrorMessage.jsx","component/elements/formik/Input.jsx","component/modal/editRange/forms/components/AddSignalFormTab.jsx","component/elements/formik/SelectBox.jsx","component/modal/editRange/forms/components/CouplingsTable.jsx","component/modal/editRange/forms/components/SignalFormTab.jsx","component/modal/editRange/forms/components/SignalsForm.jsx","component/modal/editRange/forms/validation/EditRangeValidation.js","component/modal/editRange/EditRangeModal.jsx","component/panels/RangesPanel/TableColumns/ActionsColumn.jsx","component/panels/RangesPanel/TableColumns/CouplingColumn.jsx","component/panels/RangesPanel/TableColumns/RangeAssignmentsColumn.jsx","component/panels/RangesPanel/TableColumns/RangeColumn.jsx","component/panels/RangesPanel/TableColumns/RelativeColumn.jsx","component/panels/RangesPanel/TableColumns/SignalAssignmentsColumn.jsx","component/panels/RangesPanel/TableColumns/format.js","component/panels/RangesPanel/TableColumns/SignalDeltaColumn.jsx","component/panels/RangesPanel/RangesTableRow.jsx","component/panels/RangesPanel/useMapRanges.js","component/panels/RangesPanel/RangesTable.jsx","component/panels/RangesPanel/RangesPanel.jsx","component/hoc/SpectraWraper.js","component/panels/SpectrumsPanel/SpectraPanelHeader.jsx","component/utility/GroupByInfoKey.js","component/panels/SpectrumsPanel/base/ColorIndicator.jsx","component/panels/SpectrumsPanel/base/ShowHideMarkersButton.jsx","component/panels/SpectrumsPanel/base/ShowHideSpectrumButton.jsx","component/panels/SpectrumsPanel/SpectrumListItem.jsx","component/elements/formik/FormikColorPicker.jsx","component/panels/SpectrumsPanel/base/setting/Spectrum1DSetting.jsx","component/elements/formik/FormikSlider.jsx","component/panels/SpectrumsPanel/base/setting/Spectrum2DSetting.jsx","component/panels/SpectrumsPanel/base/setting/SpectrumSetting.jsx","component/panels/SpectrumsPanel/SpectrumsTabs.jsx","component/panels/SpectrumsPanel/SpectrumListPanel.jsx","component/panels/SummaryPanel/CorrelationTable/Constants.js","component/panels/SummaryPanel/Utilities.js","component/panels/SummaryPanel/CorrelationTable/AdditionalColumnHeader.jsx","component/panels/SummaryPanel/CorrelationTable/AdditionalColumnField.jsx","component/panels/SummaryPanel/CorrelationTable/CorrelationTableRow.jsx","component/panels/SummaryPanel/CorrelationTable/CorrelationTable.jsx","component/panels/SummaryPanel/Overview.jsx","component/elements/MolecularFormulaInput.jsx","component/panels/SummaryPanel/SetMolecularFormulaModal.jsx","component/panels/SummaryPanel/SetShiftTolerancesModal.jsx","component/panels/SummaryPanel/SummaryPanel.jsx","component/panels/ZonesPanel/ZonesPreferences.jsx","component/panels/ZonesPanel/TableColumns/ActionsColumn.jsx","component/panels/ZonesPanel/TableColumns/SignalAssignmentsColumn.jsx","component/panels/ZonesPanel/TableColumns/SignalAssignmentsColumns.jsx","component/panels/ZonesPanel/TableColumns/SignalDeltaColumn.jsx","component/panels/ZonesPanel/TableColumns/ZoneAssignmentsColumn.jsx","component/panels/ZonesPanel/TableColumns/ZoneAssignmentsColumns.jsx","component/panels/ZonesPanel/ZonesTableRow.jsx","component/panels/ZonesPanel/ZonesTable.jsx","component/panels/ZonesPanel/ZonesPanel.jsx","component/elements/Table/Table.jsx","component/elements/Table/TableBody.jsx","component/elements/Table/TableCell.jsx","component/elements/Table/TableHead.jsx","component/elements/Table/TableRow.jsx","component/hoc/FiltersWrapper.js","component/panels/filtersPanel/FiltersTableRow.jsx","component/panels/filtersPanel/FilterPanel.jsx","component/panels/Panels.jsx","component/reducer/IgnoreActions.ts","data/data1d/Data1DManager.js","data/data2d/Data2DManager.js","data/SpectraManager.js","component/reducer/actions/CorrelationsActions.ts","component/reducer/actions/DomainActions.ts","component/reducer/helper/GetClosestNumber.js","component/reducer/helper/ZoomHistory.js","component/reducer/actions/PreferencesActions.ts","component/reducer/actions/FiltersActions.ts","component/reducer/helper/getRange.ts","component/reducer/actions/IntegralsActions.ts","data/molecules/Molecule.js","data/molecules/MoleculeManager.js","component/reducer/actions/ToolsActions.ts","component/reducer/actions/LoadActions.ts","component/reducer/actions/RangesActions.ts","component/reducer/actions/ZonesActions.ts","component/reducer/helper/get2DRange.ts","component/reducer/actions/MoleculeActions.ts","component/reducer/actions/PeaksActions.ts","data/data1d/autoPeakPicking.js","component/reducer/actions/SpectraAanalysisAction.ts","data/data1d/getReferenceShift.js","component/reducer/actions/SpectrumsActions.ts","component/reducer/types/HistoryTypes.js","component/reducer/Reducer.ts","component/reducer/actions/ExportActions.ts","component/reducer/actions/DimensionsActions.ts","component/reducer/actions/HistoryActions.js","component/reducer/actions/GlobalActions.ts","component/hoc/ToolBarWrapper.js","component/modal/LoadJCAMPModal.jsx","component/toolbar/BasicToolBar.jsx","component/elements/toggle/ToggleButton.jsx","component/elements/toggle/ToggleButtonGroup.jsx","component/toolbar/FunctionToolBar.jsx","component/toolbar/ToolBar.jsx","component/NMRium.tsx"],"names":["TYPES","PEAK","INTEGRAL","RANGE","ZONE","highlightContext","createContext","highlightReducer","state","action","type","payload","convertedHighlights","newState","highlights","value","highlighted","Object","keys","highlightedPermanently","Error","emptyState","HighlightProvider","props","useReducer","highlight","dispatch","contextValue","useMemo","Provider","children","useHighlightData","useContext","useHighlight","Array","isArray","context","newHighlights","push","String","useEffect","isActive","some","key","includes","isActivePermanently","show","useCallback","hide","add","id","remove","click","e","preventDefault","stopPropagation","onHover","onMouseEnter","onMouseLeave","onClick","copyFormattedHtml","html","container","document","createElement","innerHTML","style","position","pointerEvents","opacity","activeSheets","prototype","slice","call","styleSheets","filter","sheet","disabled","body","appendChild","window","getSelection","removeAllRanges","range","createRange","selectNode","addRange","execCommand","i","length","removeChild","copyHTMLToClipboard","data","a","copyTextToClipboard","navigator","clipboard","writeText","exportAsJSON","fileName","spaceIndent","fileData","JSON","stringify","ArrayBuffer","isView","from","blob","Blob","saveAs","exportAsNMRE","exportAsSVG","elementID","getBlob","exportAsPng","width","height","canvas","getContext","fillStyle","fillRect","img","Image","url","URL","createObjectURL","onload","drawImage","png","toDataURL","revokeObjectURL","src","console","log","copyDataURLCliboard","image","copyBlobToCliboard","toBlob","b","clip","ClipboardItem","write","then","err","copyPNGToClipboard","ReferenceError","alert","_svg","getElementById","cloneNode","getAttribute","replace","querySelectorAll","forEach","element","head","svg","checkModifierKeyActivated","event","getModifierState","BrushContext","initialState","step","brush","start","end","debounceClickEvents","BrushTracker","className","onBrush","onZoom","onDoubleClick","noPropagation","reducer","useState","mouseDownTime","setMouseDownTime","mouseDownHandler","button","shiftKey","altKey","screenX","screenY","clientX","clientY","boundingRect","currentTarget","getBoundingClientRect","timeStamp","clickHandler","persist","x","y","callback","lodashDebounce","lodashMap","debounce","cancel","handleMouseWheel","deltaY","deltaX","deltaMode","startX","endX","Math","abs","moveCallback","upCallback","onMouseDown","onMouseUp","onMouseMove","onWheel","endY","startY","startScreenX","startScreenY","startClientX","startClientY","defaultProps","MouseContext","MouseaProvider","MouseTracker","mouseTrackerState","setMouseTrackerState","mouseMoveHandler","mouseLeaveHandler","ChartContext","ChartDataProvider","useChartData","dispatchContext","DispatchProvider","useDispatch","PreferencesConext","PreferencesProvider","usePreferences","scaleContext","ScaleProvider","useScale","positions","TOP_LEFT","TOP_CENTER","TOP_RIGHT","MIDDLE_LEFT","MIDDLE","MIDDLE_RIGHT","BOTTOM_LEFT","BOTTOM_CENTER","BOTTOM_RIGHT","types","transitions","ModalContext","ModalProvider","useModal","styles","outerContainer","top","right","bottom","left","backgroundColor","display","justifyContent","alignItems","zIndex","innerContainer","boxSizing","boxShadow","flexDirection","minWidth","minHeight","borderRadius","Modal","open","onClose","handleClose","defaultStyle","transition","transform","defaultTransitionStyles","entering","entered","exiting","exited","Transtion","transitionStyles","ref","useRef","nodeRef","timeout","default","Wrapper","options","getStyles","initialStyles","overflow","containerStyle","messageStyle","css","buttonsStyle","ConfirmationDialog","onYes","onNo","message","yesHandler","noHandler","flex","offset","wrapperRef","root","modal","setModal","current","parentStyle","innerWidth","innerHeight","closeHandler","component","_modal","isBackgroundBlur","enableResizing","onOpen","showConfirmDialog","ConfirmDialog","keyHandler","addEventListener","removeEventListener","outerStyle","close","createPortal","TransitionGroup","appear","margin","userSelect","dragHandleClassName","enableUserSelectHack","cloneElement","cursor","CENTER","INITIATE","LOAD_JSON_FILE","LOAD_JCAMP_FILE","LOAD_MOL_FILE","LOAD_ZIP_FILE","LOAD_JDF_FILE","ADD_PEAK","ADD_PEAKS","DELETE_PEAK_NOTATION","SHIFT_SPECTRUM","SET_X_DOMAIN","SET_Y_DOMAIN","SET_ORIGINAL_DOMAIN","SET_WIDTH","SET_DIMENSIONS","SET_SELECTED_TOOL","SET_SELECTED_FILTER","CHANGE_SPECTRUM_SETTING","FULL_ZOOM_OUT","CHANGE_VISIBILITY","CHANGE_PEAKS_MARKERS_VISIBILITY","CHANGE_ACTIVE_SPECTRUM","CHANGE_SPECTRUM_COLOR","ADD_INTEGRAL","DELETE_INTEGRAL","TOGGLE_REAL_IMAGINARY_VISIBILITY","SET_ZOOM_FACTOR","ADD_MOLECULE","SET_MOLECULE","DELETE_MOLECULE","SET_CORRELATION","SET_CORRELATIONS","SET_CORRELATIONS_MF","SET_CORRELATIONS_TOLERANCE","DELETE_SPECTRA","CHANGE_SPECTRUM_DISPLAY_VIEW_MODE","RESIZE_INTEGRAL","BRUSH_END","RESET_DOMAIN","CHANGE_INTEGRAL_ZOOM","ENABLE_FILTER","DELETE_FILTER","APPLY_ZERO_FILLING_FILTER","APPLY_FFT_FILTER","CALCULATE_MANUAL_PHASE_CORRECTION_FILTER","APPLY_MANUAL_PHASE_CORRECTION_FILTER","APPLY_AUTO_PHASE_CORRECTION_FILTER","APPLY_ABSOLUTE_FILTER","SET_VERTICAL_INDICATOR_X_POSITION","AUTO_PEAK_PICKING","AUTO_RANGES_DETECTION","AUTO_ZONES_DETECTION","DELETE_RANGE","SET_SELECTED_OPTIONS_PANEL","SET_LOADING_FLAG","RESET_SELECTED_TOOL","SET_SPECTRUMS_VERTICAL_ALIGN","CHANGE_INTEGRAL_DATA","EXPORT_DATA","SET_ACTIVE_TAB","CHANGE_INTEGRAL_SUM","ADD_BASE_LINE_ZONE","DELETE_BASE_LINE_ZONE","APPLY_BASE_LINE_CORRECTION_FILTER","SET_KEY_PREFERENCES","APPLY_KEY_PREFERENCES","RESIZE_RANGE","CHANGE_RANGE_SUM","ADD_RANGE","SET_2D_LEVEL","ADD_2D_ZONE","DELETE_2D_ZONE","ADD_MISSING_PROJECTION","SET_FILTER_SNAPSHOT","CHANGE_RANGE_RELATIVE","CHANGE_RANGE_SIGNAL_VALUE","CHANGE_RANGE_SIGNAL_KIND","SAVE_EDITED_RANGE","UNLINK_RANGE","SET_DIAID_RANGE","CHANGE_INTEGRAL_RELATIVE","ANALYZE_SPECTRA","DELETE_ANALYZE_SPECTRA_RANGE","RESIZE_ANALYZE_SPECTRA_RANGE","SET_ANALYZE_SPECTRA_COLUMNS","FILTER_SPECTRA_COLUMN","ALIGN_SPECTRA","CHANGE_ZONE_SIGNAL_VALUE","CHANGE_ZONE_SIGNAL_KIND","UNLINK_ZONE","SET_DIAID_ZONE","PREDICT_SPECTRA","SET_SPECTRA_SAME_TOP","RESET_SPECTRA_SCALE","SET_MOUSE_OVER_DISPLAYER","file","fetch","checkStatus","response","text","ok","status","statusText","getFileExtension","name","toLowerCase","getFileName","substr","lastIndexOf","loadFiles","acceptedFiles","Promise","all","map","resolve","reject","reader","FileReader","onabort","onerror","result","binary","extension","asBuffer","readAsArrayBuffer","readAsBinaryString","DropZoneRef","createRef","DropZone","onDrop","droppedFiles","isLoading","uniqueFileExtensions","Set","selectedFilesByExtensions","files","useDropzone","noClick","getRootProps","getInputProps","isDragActive","NoData","isEmpty","openFileDialogHadnler","DefaultSpinnerComponent","xmlns","viewBox","fill","d","defaultGetSpinner","spinnerContext","SpinnerProvider","Spinner","checkEmpty","startCheckEmpty","timeour","setTimeout","clearTimeout","getSpinner","GlobalConetxt","GlobalProvider","useGlobal","padding","color","whiteSpace","fontSize","fontFamily","textShadow","ToolTip","popupPlacement","title","refChild","refContent","placement","setPlacement","showToolTip","elementsWraperRef","useLayoutEffect","pl","getPopupPlacement","childBounding","contentBounding","mouseOverHandler","mainContainer","onMouseOver","onMouseOut","popup","memo","CloseButton","popupTitle","loaderStyles","MultipletAnalysisModal","activeSpectrum","scaleX","analysisData","setAnalysisData","calcStart","setCalcStartStatus","isCalcFinished","setCalcFinished","index","info","invert","to","xGetFromToIndex","fromIndex","toIndex","analysesProps","analyseMultiplet","frequency","originFrequency","takeBestPartMultiplet","symmetrizeEachStep","debug","steps","chart","series","multiplet","j","multiplicity","coupling","toFixed","errorFunction","initSetting","controllers","mws","low","high","formatting","nucleus","useStateWithLocalStorage","localStorageKey","localStorage","getItem","setValue","setItem","setData","castData","parse","lodashSet","lodashGet","getLocalStorage","isJson","settings","getValue","object","keyPath","defaultValue","zoomDefaultValues","lowStep","highStep","speedThreshold","Spectrum1DZoomHelper","scale","this","slowZoomStep","fastZoomStep","wheel","deltaYValue","toString","_slowZoomStep","_fastZoomStep","LOW_STEP","FAST_STEP","ZOOM_STEP","_scale","sign","getScale","setScale","spectraZoomHanlders","integralZoomHanlder","ZoomType","initZoom1DHandler","datum","dimension","activeTab","getScaleByID","reduce","acc","setZoom","draft","defaultScale","spectrumID","zoomFactor","yDomains","scaleLinear","originDomain","min","max","scalePoint","yDomain","zoomIdentity","translate","rescaleY","domain","spectrumId","t","setZoom1D","tabActiveSpectrum","split","setIntegralZoom","originIntegralYDomain","scaleValue","newYDomain","integralZoomFactor","integralsYDomains","getXScale","xDomains","xDomain","mode","getYScale","verticalAlign","_height","flag","stacked","domainY","undefined","SET_SCALE","scaleInitialState","scaleY","scaleReducer","produce","apply","datum1D","isApplicable","re","reimAbsolute","im","Float64Array","isComplex","isFid","once","defaultOptions","magnitudeMode","minRegSize","maxDistanceToJoin","assign","reimAutoPhaseCorrection","previousValue","newValue","reduced","k","baselineAlgorithms","airpls","polynomial","corrected","algorithm","zones","airPLS","equallySpaced","numberOfPoints","baselineRegression","regression","predict","polynomialRegression","PolynomialRegression","degree","digitalFilterValue","pointsToShift","floor","skip","newRe","newIm","set","digitalFilterApplied","filters","reimFFT","applyZeroShift","digitalFilter","ph1","PI","reimPhaseCorrection","generateXAxis","baseFrequency","parseFloat","frequencyOffset","spectralWidth","spectralHalfWidth","nbPoints","firstPoint","dx","xAxis","grpdly","newRE","newIM","dw","em","exp","coefExp","curFactor","ph0","shiftValue","val","size","newX","diff","currentX","_previousValue","datum2D","minX","maxX","minY","maxY","Filters","absolute","baselineCorrection","lineBroadening","fft","phaseCorrection","autoPhaseCorrection","shiftX","zeroFilling","shift2DX","shift2DY","zoom","label","hasOptionPanel","isFilter","peakPicking","integral","zone2D","slicingTool","HMove","equalizerTool","rangesPicking","baseLineCorrection","generalSelector","editRange","multipleSpectraAnalysis","transformOrigin","allowTools","BRUSH_TYPE","BrushXY","brushType","dimensionBorder","widthProps","heightProps","selectedTool","willChange","line","stroke","strokeOpacity","shapeRendering","strokeWidth","CrossLinePointer","brushState","x1","y1","x2","y2","eventEmitter","EventEmitter","Emitter","on","fn","off","emit","freeze","DeleteButton","onDelete","data-no-export","rx","BaseLineZones","baseLineZones","deleteRangeHandler","zone","integralDefaultValues","showAbsolute","absoluteFormat","showRelative","relativeFormat","rangeDefaultValues","showFrom","fromFormat","showTo","toFormat","peaksDefaultValues","showPeakNumber","peakNumberFormat","showPeakIndex","peakIndexFormat","showDeltaPPM","deltaPPMFormat","showDeltaHz","deltaHzFormat","showPeakWidth","peakWidthFormat","showIntensity","intensityFormat","Resizable","onDrag","rightDragVisibility","setRightDragVisibility","leftDragVisibility","setLeftDragVisibility","enable","setEnable","draggableRightRef","draggableLeftRef","handleRightStart","handleRightDrag","handleRightStop","_range","layerX","handleLeftStart","handleLeftDrag","handleLeftStop","mouseDownCaptureHandler","mouseUpCaptureHandler","target","axis","defaultPosition","handle","onStart","onStop","fillOpacity","onMouseDownCapture","onMouseUpCapture","stylesOnHover","stylesHighlighted","IntegralResizable","integralSeries","integralData","xBoundary","d3","handleOnStopResizing","resized","handleOnEnterNotation","handleOnMouseLeaveNotation","x0","fontWeight","Integral","setIntegral","preferences","integralSettings","integralResult","xyIntegral","reverse","makePath","pathPoints","xyReduce","optimize","path","accumulator","point","IntegralsSeries","displayerKey","getIntegralYScale","Integrals","IsActive","isVisible","isVisibleInDomain","spectrum","integrals","values","clipPath","Line","vAlign","paths","_scaleX","_scaleY","get","LinesSeries","tempData","_data","useFormatNumberByNucleus","nucleusByKey","ppm","hz","formatFun","n","formatKey","prefix","suffix","Numeral","Number","format","getNumberOfDecimals","lastIndex","trim","FormatNumber","PeakNotation","refText","isSelected","setIsSelected","_value","containerSize","setContainerSize","handleOnPeakChange","textBox","getBBox","handleKeyDown","oldValue","blur","keyCode","handleChange","handleSelectPeakNotation","outline","dy","paddingRight","border","onKeyDown","onChange","PeaksNotations","Peaks","getVerticalAlign","findIndex","reSortData","sort","peaks","isPeaksMarkersVisible","delta","intensity","axisStyles","gridStyles","XAxis","showGrid","refAxis","refGrid","ticks","tickFormat","grid","tickSize","Axis","textAnchor","Grid","propTypes","PropTypes","bool","string","MultiAnalysisWrapper","WrappedComponent","spectraAnalysis","forwardedRef","rest","forwardRef","AnalysisRange","rangeData","columnKey","deleteHandler","colKey","MultiAnalysisRanges","columns","ranges","RangesWrapper","molecules","find","SignalKinds","SignalKindsToInclude","DatumKind","getPubIntegral","getDiaIDs","concat","diaID","signal","_signal","flat","unlink","isOnRangeLevel","signalIndex","resetDiaIDs","pubIntegral","setPubIntegral","checkRangeKind","kind","unlinkInAssignmentData","assignmentData","ids","assignmentContext","assignmentReducer","assignment","_id","activeID","activeAxis","isOnHover","onHoverID","onHoverAxis","AssignmentProvider","spectraData","initAssignmentDataRanges","_contextValue","_diaID","initAssignmentDataZones","useAssignmentData","useAssignment","assigned","removeAll","toggle","deleteRecord","setIsOnHover","Multiplets","checkMultiplet","rejected","_multiplet","m","checkMultiplicity","translateMultiplet","hasCouplingConstant","TREE_LEVEL_COLORS","LevelNode","levelHeight","StringNode","showLabels","lengthAdjust","visibility","TreeNodes","nodesData","signalID","labelOptions","buildTreeNodeAndEdge","_startX","ratio","multiplicityIndex","edgeLevel","_startYEdge","_startYNode","distance","node","createTreeNodes","spectrumData","buildTreeNodesData","jIndices","treeNodesData","jIndex","_jIndex","pascal","getPascal","spin","mult","previousLine","_line","getMultiplicityNumber","charAt","MultiplicityTree","rangeFrom","rangeTo","xRange","setXRange","treeProps","setTreeProps","drawInFullRange","setDrawInFullRange","setShowLabels","_drawInFullRange","_treeWidth","_treeHeight","_treeLevelHeight","yMax","_x","_mult","_i","_xRange","_treeNodeData","multiplicityTree","firstLevelStartY","_startY","secondLevelStartY","_rangeFrom","_rangeTo","pathData","Range","showMultiplicityTrees","assignmentRange","highlightRange","reduceOpacity","setReduceOpacity","isBlockedByEditing","setIsBlockedByEditing","mouseEnterHandler","assignHandler","Ranges","isMultiplicityTreesVisibile","Events","Chart1D","HelpContext","HelpProvider","useHelp","delay","ctrlKey","clear","groupBy","array","item","load","filePath","initState","helpText","helpObject","helpReducer","closeButton","dealyTimeOut","multiple","preventAutoHelp","timersId","modals","setModals","timersIdRef","currentModals","lengthBeforeRemove","filteredModals","helpid","mdtext","random","modalOptions","startModal","timerId","splice","indexOf","helpState","modalsByPosition","_position","frameBorder","scrolling","FooterWarpper","helpStyles","FooterBanner","useHelptData","getYValue","xPosition","xIndex","xFindClosestIndex","toPrecision","MIN_VALUE","colorIndicator","borderBottom","marginBottom","YTracker","SpectraTracker","ToggleVisiblility","trackers","borderColor","PeakPointer","closePeakPosition","setPosition","candidatePeakPosition","getClosePeak","xShift","mouseCoordinates","maxIndex","number","minIndex","yDataRange","yValue","xValue","cx","cy","r","VerticalIndicator","pivot","XLabelPointer","activeSpectrumData","getXValue","xVal","xInvert","Viewer1D","general","widthProp","heightProp","scaleState","dispatchScale","handelBrushEnd","brushData","disableMultipletAnalysis","propagateEvent","startXPPM","endXPPM","handelOnDoubleClick","zoomType","handleZoom","mouseClick","xPPM","useSize","sizedNMRChart","finalSize","setFinalSize","useDebounce","isFinite","LAYOUT","TOP_1D","LEFT_1D","CENTER_2D","getLayoutID","get2DXScale","get2DYScale","get1DYScale","ContoursPaths","contours","buildContourPath","lines","Contours","isPositiveVisible","positiveColor","isNegativeVisible","negativeColor","DISPLAYER_MODE","DM_1D","DM_2D","MARGIN","lineStyle","IndicationLines","displayerMode","deltas1D","setDeltas1D","deltas","_datum","experiment","_kind","indicationLines","_delta","Left1DChart","marignValue","originHeight","lastXIndex","lastYIndex","reduceRight","mainHeight","Top1DChart","marginProps","originMargin","shape","isRequired","YAxis","ZonesWrapper","isOnZoneLevel","buildID","SignalDeltaLine","SignalCrosshair","highlightIDsX","highlightIDsY","highlightX","highlightY","Signal","buildIDs","highlightData","isHighlighted","setIsHighlighted","_highlighted","signals","peak","Zone","zoneData","assignmentZone","highlightZone","checkZoneKind","Zones","setVisibility","prevVisiblity","Chart2D","onDimensionChange","propsTypes","PropsTypes","func","layout","data1D","trackID","nucleuses","formatX","formatY","getRealYValue","cordinate","getLabel","label2d","labelld","mf","getZValue","z","xStep","yStep","yIndex","getDeltaX","getRation","textAlign","XYLabelPointer","base62","Base","ALPHABET","TypeError","BASE_MAP","Uint8Array","xc","charCodeAt","BASE","LEADER","iFACTOR","encode","source","zeroes","pbegin","pend","b58","carry","it1","it2","str","repeat","bytes","generateID","substring","applyFilter","isReduced","filterOption","previousFilter","lookupForFilter","reduceResult","replaceFilter","addFilter","hasOwnProperty","isDeleteAllow","isLastFilter","reapplyFilters","f","filterName","_filters","enableFilter","checked","originalData","originalInfo","filterIndex","error","isSnapshot","filterID","COLORS","color2D","cosy","roesy","noesy","tocsy","hsqc","hmbc","percentToHex","p","percent","hexValue","round","padStart","adjustAlpha","factor","getColor","isRandom","usedColors","resetColors","c","lum","hex","toUpperCase","rgb","parseInt","defaultPeakPickingOptions","minMaxRatio","realTopDetection","maxCriteria","smoothY","nH","compile","frequencyCluster","clean","keepPeaks","sgOptions","windowSize","detectSignal","join","chemShift","usedColors1D","initiateDatum1D","jcamp","jcampURL","original","get1dColor","isRealSpectrumVisible","meta","sum","FiltersManager","preprocessing","FiltersTypes","lookupPeak","dataRange","updateIntegralIntegrals","updateRelatives","countingCondition","storageKey","currentSum","previous","updateIntegralRanges","checkSignalKinds","kinds","mapRanges","getShiftX","xyIntegration","originDelta","originFrom","originTo","detectRanges","impurities","solvent","autoRangesDetection","noiseLevel","xAbsoluteMedian","peakPickingOptions","rangesOptions","xyAutoRangesPicking","updateXShift","updatePeaksXShift","updateRangesXShift","s","updateIntegralXShift","defaultContourOptions","positive","contourLevels","numberOfLayers","negative","Processing2D","minMax","defaultLevel","currentLevelPositive","currentLevelNegative","xs","getRange","ys","conrec","Conrec","swapAxes","median","noise","getLevel","levelPositive","levelNegative","setLevel","setOptions","positiveBoundary","negativeBoundary","shiftWheel","drawContours","zoomPositive","zoomNegative","numberOfPositiveLayer","numberOfNegativeLayer","getContours","nbLevels","zoomLevel","maxZ","minZ","pow","drawContour","contourDrawer","levels","factors","lastFactor","usedColors2D","initiateDatum2D","get2DColor","colors","contourOptions","processingController","getShift","shift","yShift","updateShift","updateZonesShift","getMissingProjection","projection","zoneToX","getDetectionZones","dataMatrix","selectedZone","getSubMatrix","fromX","toX","fromY","toY","xIndexFrom","yIndexFrom","xIndexTo","yIndexTo","MIN_SAFE_INTEGER","MAX_SAFE_INTEGER","nbXPoints","row","Float32Array","rowValue","autoZonesDetection","thresholdFactor","maxPercentCutOff","enhanceSymmetry","convolutionByFFT","isHomoNuclear","xyzAutoPeaksPicking","observeFrequencies","extent","HorizontalSliceChart","VerticalSliceChart","SlicingView","spectra","useMouseTracker","chart2d","scale2dX","scale2dY","getSlice","infoX","dataX","infoY","dataY","horizontal","vertical","Viewer2D","DIMENSION","get2DDimensionLayout","wheelData","header","ErrorBoundary","errorInfo","setState","componentStack","Component","AlertContext","AlertProvider","useAlert","alertContext","alerts","setAlerts","currentAlerts","filteredAlerts","alertOptions","success","alertsByPosition","useToolsFunctions","isRealSpectrumShown","setIsRealSpectrumShown","isStacked","activateStackView","debounceClickEventsRef","clicks","handleChangeOption","handleFullZoomOut","saveToClipboardHandler","exportType","saveAsJSONHandler","saveAsNMREHandler","saveAsSVGHandler","saveAsPNGHandler","handleChangeDisplayViewMode","changeSpectrumViewHandler","alignSpectrumsVerticallyHandler","KeysListenerTracker","keysPreferences","overDisplayer","allow1DTool","allow2DTool","integralID","activeKey","keysPreferencesListenerHandler","num","toolsListenerHandler","metaKey","toolID","handleOnKeyDown","localName","code","baseURL","getHelpList","zoomIn","integralPicking","fullScreen","loadSpectrum","UserManualModal","getHelpData","Tab","tabid","tablabel","canDelete","tabstyles","topStyles","leftStyles","Tabs","defaultTabID","setActiveTab","onClickTabHandler","tab","tabs","Children","child","candelete","deleteFlag","tabsContent","FormikForm","initialValues","onSubmit","validationSchema","innerRef","INIT_PREFERENCES","SET_PREFERENCES","SET_PANELS_PREFERENCES","preferencesInitialState","basePreferences","hideSetSumFromMolecule","panels","hideSpectraPanel","hideInformationPanel","hidePeaksPanel","hideIntegralsPanel","hideRangesPanel","hideStructuresPanel","hideFiltersPanel","hideZonesPanel","hideSummaryPanel","hideMultipleSpectraAnalysisPanel","toolBarButtons","hideZoomTool","hideZoomOutTool","hideImport","hideExportAs","hideSpectraStackAlignments","hideSpectraCenterAlignments","hideRealImaginary","hidePeakTool","hideIntegralTool","hideAutoRangesTool","hideZeroFillingTool","hidePhaseCorrectionTool","hideBaseLineCorrectionTool","hideFFTTool","hideMultipleSpectraAnalysisTool","help","dimmedSpectraTransparency","mapNucleus","preferencesReducer","nmrLocalStorageVersion","removeData","removeItem","storeData","localData","resPreferences","entries","v","lodashMerge","Logo","getData","json","baseUrl","AboutTabContent","setInfo","href","zipball_url","rel","html_url","Date","commit","author","date","toUTCString","sha","CheckBox","checkProps","setCheck","handleCheck","defaultChecked","FormikCheckBox","resProps","useFormikContext","setFieldValue","changeHandler","htmlFor","lineHeight","Input","checkValue","enableAutoSelect","prop","setVal","select","formatValue","onChangeHandler","check","test","preventPropagate","input","onKeyPress","FormikInput","errors","touched","isInvalid","ControllersTabContent","marginTop","LIST","DisplayTabContent","FormattingTabContent","nucleusesObject","addNewNucleusFormatHandler","newFormat","newNucleuses","GeneralSettings","onSave","setSettingsData","refForm","handleSave","submitForm","submitHandler","resValues","tabChangeHandler","NumberInput","onInput","pattern","localRef","changeHander","checkValidity","inputContainer","actionButton","AutoPeakPickingOptionPanel","minMaxRatioRef","maxNumberOfPeaksRef","noiseFactor","lookNegativeRef","handleApplyFilter","maxNumberOfPeaks","lookNegative","handleCancelFilter","justifyItems","marginRight","Select","handleOnChanged","isNaN","BaseLineCorrectionPanel","algorithmRef","maxIterationsRef","toleranceRef","degreeRef","setAlgorithm","maxIterations","tolerance","getAlgorithmsList","changeAlgorithmHandler","marginLeft","textOverflow","maxWidth","stateValues","speedX","oldX","firstCalc","calcSpeed","setToZero","InputRange","minValue","maxValue","valueProps","mouseMoveCallback","valueRange","positionDiff","mouseUpCallback","phaseCorrectionTypes","algorithms","ManualPhaseCorrectionPanel","pivotIndex","phaseCorrectionType","setPhaseCorrectionType","handleInput","fieldName","inputValue","prevValue","handleRangeChange","hint","RangesPickingOptionPanel","formatNumber","Sizes","generateSizes","ZeroFillingOptionsPanel","sizeTextInputRef","lineBroadeningValue","setLineBroadeningValue","zeroFillingSize","getDefaultValue","log2","validity","valid","Zones2DOptionPanel","headerStyle","Button","helpID","data-helpid","Header","isFullscreen","onMaximize","selectedOptionPanel","selectedPanel","openGeneralSettingsHandler","openUserManual","timer","prevent","background","textDecoration","borderTop","buttonTitle","content","maxHeight","triggerSource","AccordionItem","isOpen","active","setActiveState","refContainer","toggleAccordion","dbClickHandler","forcedOpenedElements","alwaysOpen","Accordion","defaultOpenIndex","elements","setElements","handleOpen","trigger","el","mappedChildren","prevState","HighlightedRowStyle","ConstantlyHighlightedRowStyle","ReactTableStyle","ReactTableFlexLayout","useTable","useSortBy","useFlexLayout","getTableProps","getTableBodyProps","headerGroups","rows","prepareRow","headerGroup","getHeaderGroupProps","headers","column","getHeaderProps","getSortByToggleProps","render","isSorted","isSortedDesc","overflowY","getRowProps","cells","cell","getCellProps","InfoWrapper","tableContainer","searchInput","InformationPanel","information","setInformation","matches","setMatchesData","searchRef","handleSearch","sortType","Cell","resizable","placeholder","IntegralsWrapper","valueReft","saveHandler","Arrow","direction","NextPrev","loop","defaultIndex","useMeasure","activeIndex","setActiveIndex","Sliders","nextHandler","preActiveIndex","nextIndex","prevHandler","prevIndex","toolbarStyle","moleculeContainerStyle","MoleculeSelection","currentIndex","setCurrentIndex","slideIndex","mol","molfile","mw","selectMoleculeContainerStyle","optionalTextStyle","SelectMolecule","newSum","atoms","saveSelectMoleculeHandler","onChangeMoleculeSelectionHandler","modalContainer","ChangeSumModal","saveInputValueHandler","ToggleButton","Toggle","toggleHandler","DefaultPanelHeader","counter","deleteToolTip","onFilter","filterToolTip","filterIsActive","counterFiltered","onSettingClick","showSettingButton","SaveButton","PreferencesHeader","EditableColumn","onEditStart","editStatus","enabled","enableEdit","refInput","useImperativeHandle","startEdit","closeEdit","editModeHandler","ContextMenu","lef","rootRef","sourceElement","setSourceElement","handleContextMenu","contextMenuHandler","parentElement","clickX","clickY","_handleGlobalClick","isSameNode","ReactTableHeader","ReactTableRow","onContextMenu","isConstantlyHighlighted","ReactTable","contextRef","NoTableData","selectStyle","IntegralTable","relativeRefs","deleteIntegralHandler","params","changeIntegralDataHandler","defaultColumns","orderIndex","accessor","saveRealtiveHandler","editStartHander","tableColumns","setCustomColumn","columnLabel","cellHandler","integralsPreferences","cols","formattedNumber","object1","object2","tableData","isInRange","ColorInput","onColorChange","displayColorPicker","showColorPicker","setColor","handleClick","handleOnColorChanged","colorEvent","onChangeComplete","inputLabel","ColumnFormatField","checkControllerName","formatControllerName","inputChangeHandler","groupID","Boolean","_checked","setChecked","groupContainer","paddingBottom","formatFields","checkController","formatController","defaultFormat","IntegralsPreferences","setSetting","formRef","getValueByKeyPath","saveToLocalStorgate","showMessage","saveSetting","requestSubmit","dispatchEvent","Event","cancelable","handleSubmit","form","formData","FormData","field","keyIndex","nucleusLabel","IntegralPanel","setFilterIsActive","integralsCounter","setIntegralsCounter","isFlipped","setFlipStatus","settingRef","handleDeleteAll","changeIntegralSumHandler","showChangeIntegralSumModal","settingsPanelHandler","saveSettingHandler","handleOnFilter","changedHandler","infinite","ButtonToolTip","menuStyles","MenuButton","toolTip","isShown","showMenu","closeMenuButton","MoleculeWrapper","modalButtonStyle","MoleculeStructureEditorModal","selectedMolecule","setMolfile","cb","newMolfile","initialMolfile","svgMenu","fragment","IsotopesViewer","othersProps","dangerouslySetInnerHTML","__html","FormikSelect","FREQUENCIES","INITIAL_VALUE","PredictSpectraModal","extractFromAtom","atom","dim","oclIDs","oclID","hydrogenOCLIDs","nbAtoms","nbHydrogens","atomLabel","findDatumAndSignalIndex","panelContainerStyle","menuButton","MoleculePanel","setOpen","currentMolfile","setCurrentMolfile","onAtomHoverHighlights","setOnAtomHoverHighlights","onAtomHoverAction","setOnAtomHoverAction","activeAssignment","assignedDiaIDs","assignedDiaID","assignedDiaIDsMerged","toggleAssignment","atomInformation","_oclID","toggleDiaIDs","handleOnClickAtom","currentDiaIDsToHighlight","getCurrentDiaIDsToHighlight","assignmentOnHover","axisOnHover","handleOnAtomHover","getHighlightsOnHover","stop","_assigned","handlePaste","readText","handleDelete","saveAsMolHandler","handleReplaceMolecule","openPredicSpectraModal","OCLnmr","OCL","setSelectedAtom","atomHighlightColor","atomHighlightOpacity","setHoverAtom","COLUMNS_TYPES","reservedColumnsNames","addColumnKey","columnProps","getChar","aPotions","len","chartResult","fromCharCode","generateChar","getSpectraAnalysis","detectRange","xyMinYPoint","xyMaxYPoint","SID","init","refreshCalculation","refreshByRow","calculate","formula","analyzeSpectra","valueKey","spectraSum","prevNucleusData","relative","variables","l","Function","REFERENCES","tms","nbPeaks","tsp","glucose","baseList","AlignSpectraModal","List","list","setValues","optionChangeHandler","targetX","args","MulipleAnalysisCodeEditor","setCode","setResult","evalResult","Eval","valueChangeHandler","highlightHandler","languages","js","prismStyles","onValueChange","MultipleSpectraAnalysisPreferences","onAfterSave","setColumns","tempKey","columnsKeys","preferncesSchema","Yup","columnSchema","required","colmnName","addNewColumn","prevData","DropDownList","onSelect","DropDownButton","selectedKey","formatSelectedValue","drop","closest","selectHandler","columnsFilters","ColumnHeader","charLabel","rangeLabel","onColumnFilter","MultipleSpectraAnalysisTable","codeEvaluation","columnFilterHandler","initColumns","columnIndex","columnData","MultipleSpectraAnalysisPanel","afterSaveHandler","showTrackerHandler","openAlignSpectra","copyToClipboardHandler","getDataAsString","letter","PeaksWrapper","PeaksPreferences","peaksPreferences","PeaksTable","deltaPPMRefs","deletePeakHandler","initialColumns","saveDeltaPPMRefsHandler","extraParams","valueHz","peakWidth","PeaksPanel","peaksCounter","setPeaksCounter","CopyClipboardModal","onCopyClick","toolbar","center","removeAssignmentsButton","RangesHeader","onUnlink","onFilterActivated","isFilterActive","filterCounter","isMultiplicityTreesVisible","changeRangesSumHandler","showChangeRangesSumModal","removeAssignments","handleOnRemoveAssignments","handleSetShowMultiplicityTrees","saveAsHTMLHandler","observedFrequency","nbDecimalDelta","nbDecimalJ","rangesToACS","RangesPreferences","oldId","useToggleStatus","setStatus","statusflags","newStatus","isColumnVisible","lodash","AbsoluteColumn","rowSpanTags","onHoverRange","SelectUncontrolled","ErrorMessage","useField","onFocus","onBlur","enableErrorMessage","AddSignalFormTabStyle","AddSignalFormTab","disableAddButton","setDisableAddButton","onAddSignal","newSignal","newSignalDelta","_signals","SelectBox","as","protoTypes","valuePath","instanceOf","valueSelectionTemplate","CouplingsTableStyle","errorStyle","CouplingsTable","_coupling","hasMissingCouplingValue","_error","colSpan","SignalFormTabStyle","SignalFormTab","textStyles","tabStylesAddition","SignalsForm","activeField","setActiveField","setFrequency","handleOnFocus","tapClickHandler","handleDeleteSignal","tabContainsErrors","signalFormTabs","signalTabs","addSignalTab","editSignalInfoText","addSignalInfoText","noSignals","noCouplings","EditRangeValidation","createSignalsError","missingCouplings","EditRangeModal","onSaveEditRangeModal","onCloseEditRangeModal","onZoomEditRangeModal","handleOnZoom","handleOnClose","getCouplings","couplings","getSignals","handleOnSave","formValues","initialStateSignals","counterJ","_multiplicity","isSaveButtonDisabled","errorKeys","validate","setSubmitting","selectBoxStyle","ActionsColumn","rowData","onHoverSignal","zoomRangeHandler","changeRangeSignalKindHandler","saveEditRangeHandler","editedRowData","closeEditRangeHandler","openEditRangeHandler","CENTER_RIGHT","tableMetaInfo","CouplingColumn","spanStyle","RangeAssignmentsColumn","onUnlinkVisibilityChange","unlinkVisibility","onLink","diaIDs","visibilityChangeHandler","spanCss","RangeColumn","RelativeColumn","integralVal","formattedValue","SignalAssignmentsColumn","tdCss","useFormat","keysPath","SignalDeltaColumn","rangeID","editStartHandler","RangesTableRow","onColumnEditStart","editFlags","relativeFlags","signalFlags","assignmentSignal","highlightSignal","unlinkRangeButtonVisibility","showUnlinkRangeButton","unlinkSignalButtonVisibility","showUnlinkSignalButton","getFormat","rowSpan","unlinkHandler","linkHandler","trCss","rowIndex","signalId","useMapRanges","_rangesData","tableStyle","RangesTable","onChangeKind","onEdit","toggleRelativeColumn","toggleSignalColumn","columnEditStartHandler","handleEditStart","sumButton","setShowMultiplicityTreesButton","RangesTablePanel","rangesData","isInView","getFilteredRanges","unlinkRangeHandler","saveJSONToClipboardHandler","dataToClipboard","rangesPreferences","contextMenu","filterHandler","SpectraWraper","SpectraPanelHeader","spectrums","showAllSpectrumsHandler","spectrumsPerTab","hideAllSpectrumsHandler","addMissingProjectionHandler","missingNucleus","SpectrumsData","setSameTopHandler","resetScaleHandler","getNucleusSum","additions","GroupByInfoKey","orderByNucleus","unorderedGroup","objectsByKeyValue","obj","ColorIndicator1D","activated","ColorIndicator2D","ColorIndicator","ShowHideMarkersButton","onChangeMarkersVisibility","markersVisible","isMarkerVisible","ShowHideSpectrumButton","onChangeVisibility","alignContent","icon","SpectrumListItem","onChangeActiveSpectrum","onOpenSettingModal","formatValueAsHTML","borderLeft","pulse","FormikColorPicker","colorchangeHandler","presetColors","Spectrum1DSetting","triggerSubmitHandler","FormikSlider","onAfterChange","ReactSlider","thumbClassName","trackClassName","renderThumb","valueNow","pearling","minDistance","Spectrum2DSetting","SpectrumSetting","arePropsEqual","SpectrumsTabs","onTabChange","setMarkersVisible","selectedSpectrumData","setSelectedSpectrum","settingModalPosition","setSettingModalPosition","isSettingModalDisplayed","setIsSettingModalDisplayed","visibleMarkers","spectrumsGroupByNucleus","groupByNucleus","handleChangeMarkersVisibility","newChecked","onTabChangeHandler","openSettingHandler","selectedSpectrum","nativeEvent","handleChangeVisibility","handleChangeActiveSpectrum","group","SpectrumListPanel","activeTabState","setSpectrums","ErrorColors","Errors","errorColor","Hybridizations","DefaultTolerance","C","H","N","F","Si","P","getLabelColor","correlationData","correlation","atomType","errorIndex","findSpectrum","_spectrum","experimentID","findSignal","findRangeOrZoneID","findRange","findZone","findSignalMatch2D","xDomain0","xDomain1","yDomain0","yDomain1","AdditionalColumnHeader","correlationsData","highlightIDsAdditionalColumn","pseudo","link","highlightAdditionalColumn","focus","tableHeaderProps","experimentType","arr","equivalenceTextStyle","edited","equivalence","isInteger","origin","AdditionalColumnField","rowCorrelation","columnCorrelation","commonLinks","correlations","isEdited","setIsEdited","highlightIDsCommonLinks","highlightCommonLinks","commonLink","onEditHandler","_rowCorrelation","lodashCloneDeep","_columnCorrelation","pseudoLinkCountHSQC","pseudoLinkID","pseudoExperimentID","pseudoCommonLink","LinkUtilities","buildLink","CorrelationUtilities","addLink","match","GeneralUtilities","getCorrelationIndex","protonsCount","removeLink","commonLinkHSQC","linkSet","CorrelationTableRow","additionalColumnData","styleRow","styleLabel","onSaveEditEquivalences","onChangeHybridization","onSaveEditProtonsCount","onEditAdditionalColumnField","highlightIDsRow","highlightRow","onSaveEquivalencesHandler","onSaveProtonsCountHandler","additionalColumnFields","_correlation","_link","experimentLabel","onChangeHybridizationHandler","equivalenceCellStyle","tableDataProps","borderRight","hybridization","CorrelationTable","filteredCorrelationsData","editEquivalencesSaveHandler","changeHybridizationSaveHandler","editProtonsCountSaveHandler","editAdditionalColumnFieldSaveHandler","showProtonsAsRows","additionalColumnHeader","Overview","getAtomCounts","stateAtomType","errorColorIndex","complete","fontStyle","inputStyle","MolecularFormulaInput","previousMF","setMF","isValidMF","setIsValidMF","hasChanged","setHasChanged","checkMF","MF","onSaveHandler","SetMolecularFormulaModal","onSaveHandlerMolecularFormulaInput","onSaveHandlerMoleculeSelection","onChangeHandlerMoleculeSelection","SetShiftToleranceModal","previousTolerance","setTolerance","inputFields","panelStyle","SummaryPanel","setAdditionalColumnData","selectedAdditionalColumnsAtomType","setSelectedAdditionalColumnsAtomType","setShowProtonsAsRows","atomTypesInView","getAtomType","findSignalMatch1D","otherAxis","_values","handleOnSetMolecularFormula","handleOnSetShiftTolerance","showSetMolecularFormulaModal","showSetShiftToleranceModal","additionalColumnTypes","columnTypes","columnType","_selectedAdditionalColumnsAtomType","valuesString","char","additionalColumnField","selection","ZonesPreferences","zonesPreferences","changeSignalKindHandler","deleteZoneHandler","zoomZoneHandler","xMargin","yMargin","showUnlinkButton","setShowUnlinkButton","SignalAssignmentsColumns","onHoverSignalX","onHoverSignalY","showUnlinkButtonSignalX","showUnlinkButtonSignalY","setShowUnlinkButtonSignalX","setShowUnlinkButtonSignalY","highlightSignalX","highlightSignalY","signalDeltaX","signalDeltaY","saveXHandler","zoneID","saveYHandler","ZoneAssignmentColumn","ZoneAssignmentsColumns","onHoverZoneX","onHoverZoneY","showUnlinkButtonZoneX","showUnlinkButtonZoneY","setShowUnlinkButtonZoneX","setShowUnlinkButtonZoneY","highlightZoneX","highlightZoneY","ZonesTableRow","ZonesTable","nuclei","ZonesPanel","xFrom","xTo","yFrom","yTo","getFilteredZones","unlinkZoneHandler","visibilityHandler","Table","TableBody","getVAlign","align","TableHeader","TableHead","FiltersWrapper","FiltersTableRow","selectedFilterID","setSelectedFilter","handelFilterCheck","handelDeleteFilter","filterSnapShotHandler","newID","prevId","TableRow","TableCell","FilterPanel","accordionItems","openWhen","hidePreferenceKey","RangesPanel","Panels","panelIndex","setSelectedPanelIndex","getDefaultIndex","ignoreActions","checkActionType","fromBruker","dependentVariables","components","fromCSD","dimensions","quantityName","count","incr","increment","magnitude","originOffset","coordinatesOffset","buffer","addJcampFromURL","addJcamp","fromJCAMP","noContour","xy","keepRecordsRegExp","profiling","entry","addJcampSS","fromParsedJcamp","parsedJcamp","Data1DManager","Data2DManager","addData","Datum1D","Datum2D","addJDF","jdf","converted","fromJEOL","description","metadata","acquisitionMode","acquisitionTime","spectralWidthClipped","application","isFt","promises","addBruker","noContours","toJSON","multipleAnalysis","ob","handleUpdateCorrelations","Build","build","getActiveData","activeSpectrumIndex","activeData","getDomain","xArray","yArray","integralYDomain","_extent","get2DDomain","spectrumsIDs","filteredData","setDomain","isYDomainChanged","originYDomains","setMode","getClosestNumber","goal","prev","curr","ZoomHistory","stack","pop","getLast","ZoomHistoryInstances","changeSpectrumVerticalAlignment","checkData","YAxisShift","setDataByFilters","hideOptionPanel","deleteFilter","update2dShift","changeIntegral","orignalDatum","integralIndex","handleChangeIntegralsRaltiveValue","changeIntegralsRealtive","newIntegralValue","initMolecule","molecule","OCLMolecule","fromMolfile","mfInfo","getMolecularFormula","absoluteWeight","relativeWeight","toSVG","getInfo","addMolfile","fragments","Molecule","getFragments","toMolfileV3","setFilterChanges","selectedFilter","activeSpectrumId","getStrongestPeak","strongestPeakValue","spectrumIndex","resetTool","setDefaultTool","getSpectrumID","hasAcceptedSpectrum","setMargin","Processing2DData","setDisplayerMode","setTabActiveSpectrum","dataGroupByTab","tabs2D","tabkeys","tabKey","nucleusLength","tabSpectra","tabSpectraLength","FTSpectrums","setTab","refresh","groupByTab","refreshTabActiveSpectrums","dataGroupByNucleus","currentTab","zoomHistory","getInstance","zoomValue","fromJSON","mols","MoleculeManager","loadJDFFile","addJDFs","loadJcampFile","addJcamps","getRangeIndex","handleUnlinkRange","_rangeData","cloneDeep","rangeIndex","handleResizeRange","changeRange","handleAddRange","handleOnChangeRangesData","handleChangeRangeRaltiveValue","changeRangesRealtive","newRealtiveValue","add2dZoneHandler","drawnZone","get2DRange","detectZonesManual","fromTo","shiftY","handleOnChangeZonesData","handleAutoZonesDetection","detectionOptions","detectZones","formattedZones","getZoneIndex","handleUnlinkZone","_zoneData","zoneIndex","setMoleculeHandler","_mol","molIndex","handleAutoPeakPicking","autOptions","autoPeakPicking","xyAutoPeaksPicking","handleDeleteSpectraRanges","deleteSpectraAnalysis","MulitpleAnalysis","handleSetcolumns","setColumn","inputColumns","newColumns","outerAcc","spectraKey","newKey","isFormula","handleFiltercolumn","changeColumnValueKey","getReferenceShift","reference","xyCalibrate","checkIsVisible2D","setVisible","history","past","present","future","hasUndo","hasRedo","dispatchMiddleware","res","SpectraManager","zipFile","predictionProton","spectrumReducer","innerSpectrumReducer","actionType","initiate","LoadActions","setIsLoading","handleLoadJsonFile","handleLoadMOLFile","handleLoadZIPFile","exportData","exportedData","addPeak","candidatePeak","PeaksActions","addPeaks","datumOriginal","newPeak","deletePeak","peakData","peakIndex","addIntegral","IntegralsActions","deleteIntegral","handleChangeIntegralZoom","handleChangeIntegralSum","setOriginalDomain","DomainActions","setXDomain","setYDomain","setWidth","handleSetDimensions","setSelectedTool","ToolsActions","resetSelectedTool","filterOnly","setSelectedOptionPanel","zoomOut","shiftSpectrumAlongXAxis","FiltersActions","applyZeroFillingFilter","filterOptions","applyFFTFilter","applyManualPhaseCorrectionFilter","applyAutoPhaseCorrectionFilter","applyAbsoluteFilter","calculateManualPhaseCorrection","filterSnapshotHandler","handleSpectrumVisibility","IDs","SpectrumsActions","handleChangePeaksMarkersVisibility","refreshDomain","newIndex","oldIndex","newActiveSpectrum","handleChangeSpectrumColor","changeSpectrumSetting","alignSpectraHandler","handleToggleRealImaginaryVisibility","setSpectraSameTopHandler","resetSpectraScale","handleChangeSpectrumDisplayMode","addMoleculeHandler","MoleculeActions","deleteMoleculeHandler","moleculeIndex","predictSpectraFromMolculeHandler","signalsToXY","handleSetMF","CorrelationsActions","handleSetTolerance","handleSetCorrelation","setCorrelation","handleSetCorrelations","handleDeleteSpectra","handleChangeIntegralYDomain","handleBrushEnd","is2D","xScale","yScale","domainX","brushHistory","setVerticalIndicatorXPosition","setSpectrumsVerticalAlign","ZonesActions","handleAutoRangesDetection","RangesActions","handleDeleteRange","handleChangeRangeSum","handleChangeRangeSignalValue","changeRangeSignal","newSignalValue","handleChangeRangeSignalKind","handleSaveEditedRange","_editedRowData","handleSetDiaIDRange","handelSetPreferences","panelsPreferences","handelSetActiveTab","handleAddBaseLineZone","handleDeleteBaseLineZone","handleBaseLineCorrectionFilter","xDomainSnapshot","setKeyPreferencesHandler","spectrumsGroupsList","level","applyKeyPreferencesHandler","nucluesToString","nuclues","datumID","processController","levelChangeHandler","handleDeleteZone","addMissingProjectionHander","handelResetDomain","changeZoneSignalDelta","changeZoneSignal","originalSignal","handleChangeZoneSignalKind","_zone","handleSetDiaIDZone","SpectraAanalysisActions","handleResizeSpectraRange","handleHistoryUndo","newPast","newfuture","handleHistoryRedo","newPresent","handleHistoryReset","setIsOverDisplayer","actions","GlobalActions","ToolBarWrapper","spectrumsCount","allowedExtensions","LoadJCAMPModal","onLoadClick","startLoading","pathReft","loadJCAMPHandler","extractFileMetaFromPath","loadFile","onLoadButtonClick","BasicToolBar","selectedSpectrumInfo","LoadJacmpHandler","startLoadingHandler","importJCAMPFile","isButtonVisible","importFromFileSystemHandler","activeStyles","setActive","toggleButton","_isActive","displayName","onValueReady","ToggleButtonGroup","toggleButtons","setToggleButtons","handleOnChange","toggles","_child","FunctionToolBar","option","setOption","selectedOption","handleOnFFTFilter","ToolBar","splitPaneStyles","resizer","pane","containerStyles","NMRium","dataProp","onDataChange","docsBaseUrl","useToggle","useFullscreen","isRightPanelHide","hideRightPanel","isResizeEventStart","setResizeEventStart","helpList","helpData","setHelpData","preferencesState","dispatchPreferences","dispatchMiddleWare","setBaseUrl","newBaseUrl","handleSplitPanelDragFinished","rightPanelHandler","prevFlag","preventContextMenuHandler","resizerStyle","paneStyle","pane1Style","defaultSize","minSize","onDragFinished","onResizerDoubleClick","onDragStarted"],"mappings":"6TASaA,EAAQ,CACnBC,KAAM,OACNC,SAAU,WACVC,MAAO,QACPC,KAAM,QAGFC,EAAmBC,0BAEzB,SAASC,iBAAiBC,EAAOC,GAC/B,OAAQA,EAAOC,MACb,IAAK,OAAS,IAAD,IAC2BD,EAAOE,QAArCC,EADG,EACHA,oBAAqBF,EADlB,EACkBA,KACvBG,EAAQ,2BACTL,GADS,IAEZM,WAAW,eAAMN,EAAMM,YACvBJ,SALS,cAOSE,GAPT,IAOX,2BAAyC,CAAC,IAA/BG,EAA8B,QACjCA,KAASF,EAASC,aACtBD,EAASC,WAAWC,GAAS,IATtB,8BAcX,OAFAF,EAASG,YAAcC,OAAOC,KAAKL,EAASC,YAErCD,EAET,IAAK,OAAS,IAAD,EACHD,EAAwBH,EAAOE,QAA/BC,oBAEFC,EAAQ,2BACTL,GADS,IAEZM,WAAW,eAAMN,EAAMM,YACvBJ,KAAM,OANG,cAQSE,GART,IAQX,2BAAyC,CAAC,IAA/BG,EAA8B,QACnCA,KAASF,EAASC,mBACbD,EAASC,WAAWC,IAVpB,8BAcX,OADAF,EAASG,YAAcC,OAAOC,KAAKL,EAASC,YACrCD,EAET,IAAK,gBAOH,OANc,2BACTL,GADS,IAGZW,uBAAwBV,EAAOE,UAKnC,IAAK,kBAMH,OALc,2BACTH,GADS,IAEZW,uBAAwB,KAK5B,QACE,MAAM,IAAIC,MAAJ,+BAAkCX,EAAOC,QAKrD,IAAMW,EAAa,CACjBP,WAAY,GACZE,YAAa,GACbG,uBAAwB,GACxBT,KAAM,MAGD,SAASY,kBAAkBC,GAAQ,IAAD,EACTC,qBAAWjB,iBAAkBc,GADpB,mBAChCI,EADgC,KACrBC,EADqB,KAEjCC,EAAeC,mBAAQ,iBAAO,CAAEH,YAAWC,cAAa,CAACD,IAC/D,OACE,cAACpB,EAAiBwB,SAAlB,CAA2Bd,MAAOY,EAAlC,SACGJ,EAAMO,WAKN,SAASC,mBACd,OAAOC,qBAAW3B,GAGb,SAAS4B,aAAanB,GAA0B,IAAdJ,EAAa,uDAAN,KAC9C,IAAKwB,MAAMC,QAAQrB,GACjB,MAAM,IAAIM,MAAM,+BAGlB,IAAMgB,EAAUL,mBAEVnB,EAAsBgB,mBAAQ,WAClC,IADwC,EAClCS,EAAgB,GADkB,cAEhBvB,GAFgB,IAExC,2BAAoC,CAAC,IAA1BW,EAAyB,QAClC,GAAyB,kBAAdA,GAA+C,kBAAdA,EAC1C,MAAM,IAAIL,MAAJ,4CAEU,KAAdK,GACFY,EAAcC,KAAKC,OAAOd,KAPU,8BAUxC,OAAOY,IACN,CAACvB,IAEJ0B,qBAAU,WAER,OAAO,WACLJ,EAAQV,SAAS,CACfhB,KAAM,OACNC,QAAS,CAAEC,yBAEbwB,EAAQV,SAAS,CACfhB,KAAM,uBAIT,IAEH,IAAM+B,EAAWb,mBAAQ,WACvB,OAAOQ,EAAQX,UAAUT,YAAY0B,MAAK,SAACC,GAAD,OACxC/B,EAAoBgC,SAASD,QAE9B,CAACP,EAAQX,UAAUT,YAAaJ,IAE7BiC,EAAsBjB,mBAAQ,WAClC,OAAOQ,EAAQX,UAAUN,uBAAuBuB,MAAK,SAACC,GAAD,OACnD/B,EAAoBgC,SAASD,QAE9B,CAACP,EAAQX,UAAUN,uBAAwBP,IAExCkC,EAAOC,uBAAY,WACvBX,EAAQV,SAAS,CACfhB,KAAM,OACNC,QAAS,CACPC,sBACAF,YAGH,CAAC0B,EAASxB,EAAqBF,IAE5BsC,EAAOD,uBAAY,WACvBX,EAAQV,SAAS,CACfhB,KAAM,OACNC,QAAS,CACPC,2BAGH,CAACwB,EAASxB,IAEPqC,EAAMF,uBACV,SAACG,GACCd,EAAQV,SAAS,CACfhB,KAAM,OACNC,QAAS,CAAEC,oBAAqB,GAAIsC,UAGxC,CAACd,IAGGe,EAASJ,uBACb,SAACG,GACCd,EAAQV,SAAS,CACfhB,KAAM,OACNC,QAAS,CAAEC,oBAAqB,GAAIsC,UAGxC,CAACd,IAGGgB,EAAQL,uBACZ,SAACM,GACKA,IACFA,EAAEC,iBACFD,EAAEE,mBAGCV,EAMHT,EAAQV,SAAS,CACfhB,KAAM,oBANR0B,EAAQV,SAAS,CACfhB,KAAM,gBACNC,QAASC,MAQf,CAACwB,EAASxB,EAAqBiC,IAG3BW,EAAU,CACdC,aAAcX,EACdY,aAAcV,GAGVW,EAAU,CACdA,QAASP,GAGX,MAAO,CACLX,WACAK,OACAE,OACAQ,UACAG,UACAd,sBACAO,QACAH,MACAE,Y,4ZCzNJ,SAASS,kBAAkBC,GAEzB,IAAIC,EAAYC,SAASC,cAAc,OACvCF,EAAUG,UAAYJ,EAGtBC,EAAUI,MAAMC,SAAW,QAC3BL,EAAUI,MAAME,cAAgB,OAChCN,EAAUI,MAAMG,QAAU,EAG1B,IAAIC,EAAepC,MAAMqC,UAAUC,MAChCC,KAAKV,SAASW,aACdC,QAAO,SAAUC,GAChB,OAAQA,EAAMC,YAIlBd,SAASe,KAAKC,YAAYjB,GAG1BkB,OAAOC,eAAeC,kBAEtB,IAAIC,EAAQpB,SAASqB,cACrBD,EAAME,WAAWvB,GACjBkB,OAAOC,eAAeK,SAASH,GAE/BpB,SAASwB,YAAY,QACrB,IAAK,IAAIC,EAAI,EAAGA,EAAIlB,EAAamB,OAAQD,IACvClB,EAAakB,GAAGX,UAAW,EAE7Bd,SAASwB,YAAY,QACrB,IAAK,IAAIC,EAAI,EAAGA,EAAIlB,EAAamB,OAAQD,IACvClB,EAAakB,GAAGX,UAAW,EAI7Bd,SAASe,KAAKY,YAAY5B,G,SAGb6B,oB,uIAAf,kBAAmCC,GAAnC,SAAAC,EAAA,gFAEIjC,kBAAkBgC,GAFtB,mBAGW,GAHX,0DAKW,GALX,gE,+BAQeE,oB,uIAAf,kBAAmCF,GAAnC,SAAAC,EAAA,yFAEUE,UAAUC,UAAUC,UAAUL,GAFxC,iCAGW,GAHX,0DAKW,GALX,gE,sBAYA,SAASM,aAAaN,GAA6C,IAAvCO,EAAsC,uDAA3B,aAAcC,EAAa,uCAC1DC,EAAWC,KAAKC,UACpBX,GACA,SAACjD,EAAK5B,GAAN,OAAiByF,YAAYC,OAAO1F,GAASmB,MAAMwE,KAAK3F,GAASA,IACjEqF,GAEIO,EAAO,IAAIC,KAAK,CAACP,GAAW,CAAE3F,KAAM,eAC1CmG,iBAAOF,EAAD,UAAUR,EAAV,YAER,SAASW,aAAalB,GAAgC,IAA1BO,EAAyB,uDAAd,aAC/BE,EAAWC,KAAKC,UACpBX,GACA,SAACjD,EAAK5B,GAAN,OAAiByF,YAAYC,OAAO1F,GAASmB,MAAMwE,KAAK3F,GAASA,IACjE,GAEI4F,EAAO,IAAIC,KAAK,CAACP,GAAW,CAAE3F,KAAM,eAC1CmG,iBAAOF,EAAD,UAAUR,EAAV,YAUR,SAASY,cAAiD,IAArCZ,EAAoC,uDAAzB,aAAca,EAAW,yCACtCC,QAAQD,GAAjBL,EAD+C,EAC/CA,KACRE,iBAAOF,EAAD,UAAUR,EAAV,SAGR,SAASe,cAAiD,IAArCf,EAAoC,uDAAzB,aAAca,EAAW,yCACvBC,QAAQD,GAAhCL,EAD+C,EAC/CA,KAAMQ,EADyC,EACzCA,MAAOC,EADkC,EAClCA,OACrB,IACE,IAAIC,EAAStD,SAASC,cAAc,UACpCqD,EAAOF,MAAQA,EACfE,EAAOD,OAASA,EAChB,IAAIhF,EAAUiF,EAAOC,WAAW,MAChClF,EAAQmF,UAAY,QACpBnF,EAAQoF,SAAS,EAAG,EAAGH,EAAOF,MAAOE,EAAOD,QAC5C,IAAIK,EAAM,IAAIC,MACVC,EAAMC,IAAIC,gBAAgBlB,GAC9Bc,EAAIK,OAAJ,sBAAa,kCAAAjC,EAAA,+DACXzD,EAAQ2F,UAAUN,EAAK,EAAG,GACtBO,EAAMX,EAAOY,UAAU,YAAa,GACxCpB,iBAAOmB,EAAD,UAAS7B,EAAT,SACNyB,IAAIM,gBAAgBF,GAJT,iDAMbP,EAAIU,IAAMR,EACV,MAAOtE,GAEP+E,QAAQC,IAAIhF,IAIhB,SAASiF,oBAAoBC,GAC3B,IAAMd,EAAM1D,SAASC,cAAc,OACnCyD,EAAIU,IAAMI,EAEVd,EAAIvD,MAAMC,SAAW,QACrBsD,EAAIvD,MAAME,cAAgB,OAC1BqD,EAAIvD,MAAMG,QAAU,EAEpBN,SAASe,KAAKC,YAAY0C,GAC1B,IAAMtC,EAAQpB,SAASqB,cACvBD,EAAME,WAAWoC,GACjBzC,OAAOC,eAAeK,SAASH,GAC/BpB,SAASwB,YAAY,QACrBxB,SAASe,KAAKY,YAAY+B,GAG5B,SAASe,mBAAmBnB,GAC1BA,EAAOoB,QAAO,SAACC,GAEb,IAAMC,EAAO,IAAIC,cAAJ,eACVF,EAAEhI,KAAOgI,IAEZ3C,UAAUC,UAAU6C,MAAM,CAACF,IAAOG,MAChC,WAEEV,QAAQC,IAAI,yBAEd,SAACU,GAECX,QAAQC,IAAIU,SAMpB,SAASC,mBAAmBhC,GAAY,IAAD,EACLC,QAAQD,GAAhCL,EAD6B,EAC7BA,KAAMQ,EADuB,EACvBA,MAAOC,EADgB,EAChBA,OACrB,IACE,IAAIC,EAAStD,SAASC,cAAc,UACpCqD,EAAOF,MAAQA,EACfE,EAAOD,OAASA,EAChB,IAAIhF,EAAUiF,EAAOC,WAAW,MAChClF,EAAQmF,UAAY,QACpBnF,EAAQoF,SAAS,EAAG,EAAGH,EAAOF,MAAOE,EAAOD,QAC5C,IAAIK,EAAM,IAAIC,MACRC,EAAMC,IAAIC,gBAAgBlB,GAChCc,EAAIK,OAAJ,sBAAa,mCAAAjC,EAAA,gEACXzD,EAAQ2F,UAAUN,EAAK,EAAG,GACpBO,EAAMX,EAAOY,UAAU,YAAa,GACtClC,UAAUC,UAAU6C,MACtBL,mBAAmBnB,GAEnBiB,oBAAoBN,GAGtBJ,IAAIM,gBAAgBF,GATT,kDAWbP,EAAIU,IAAMR,EACV,MAAOtE,GACHA,aAAa4F,gBAEfC,MACE,wEAIJd,QAAQC,IAAIhF,IAIhB,SAAS4D,QAAQD,GAEf,IAAImC,EAAOpF,SAASqF,eAAepC,GAAWqC,WAAU,GAClDlC,EAAQgC,EAAKG,aAAa,SAASC,QAAQ,KAAM,IACjDnC,EAAS+B,EAAKG,aAAa,UAAUC,QAAQ,KAAM,IACzDJ,EACGK,iBAAiB,2BACjBC,SAAQ,SAACC,GAAD,OAAaA,EAAQvG,YAChC,IAAMwG,EAAI,8CAAyCxC,EAAzC,YAAkDC,EAAlD,qBAAoED,EAApE,sBAAuFC,EAAvF,wDAcJwC,EAAG,UAAMD,EAbJ,iQAamBR,EAAKlF,UAA1B,UAET,MAAO,CAAE0C,KADI,IAAIC,KAAK,CAACgD,GAAM,CAAElJ,KAAM,kBACtByG,QAAOC,Y,0iGCpNT,SAASyC,0BAA0BC,GAYhD,IAXA,IAWA,MAXsB,CACpB,MACA,WACA,WACA,UACA,OACA,UACA,aACA,QACA,MAEF,eAAiC,CAA5B,IAAMnH,EAAG,KACZ,GAAImH,EAAMC,iBAAiBpH,GACzB,OAAO,EAGX,OAAO,E,iECPIqH,EAAe1J,0BAEtB2J,EAAe,CACnBC,KAAM,UACNC,MAAO,CACLC,MAAO,KACPC,IAAK,OAILC,EAAsB,GAEnB,SAASC,aAAT,GASH,IARFzI,EAQC,EARDA,SACA0I,EAOC,EAPDA,UACAtG,EAMC,EANDA,MACAuG,EAKC,EALDA,QACAC,EAIC,EAJDA,OACAC,EAGC,EAHDA,cACAhH,EAEC,EAFDA,QACAiH,EACC,EADDA,cACC,EACyBpJ,qBAAWqJ,QAASZ,GAD7C,mBACMzJ,EADN,KACakB,EADb,OAEyCoJ,qBAFzC,mBAEMC,EAFN,KAEqBC,EAFrB,KAIKC,EAAmBlI,uBACvB,SAAC+G,GAkBC,OAjBqB,IAAjBA,EAAMoB,SACJN,GACFd,EAAMvG,kBAER7B,EAAS,CACPhB,KAAM,OACNyK,SAAUrB,EAAMqB,SAChBC,OAAQtB,EAAMsB,OACdC,QAASvB,EAAMuB,QACfC,QAASxB,EAAMwB,QACfC,QAASzB,EAAMyB,QACfC,QAAS1B,EAAM0B,QACfC,aAAc3B,EAAM4B,cAAcC,0BAGpCX,EAAiBlB,EAAM8B,aAElB,IAET,CAAChB,IAGGiB,EAAe9I,uBACnB,SAACM,GACCA,EAAEyI,UACF,IAAMF,EAAYvI,EAAEuI,UACdH,EAAepI,EAAEqI,cAAcC,wBAC/BI,EAAI1I,EAAEkI,QAAUE,EAAaM,EAC7BC,EAAI3I,EAAEmI,QAAUC,EAAaO,EAE7BC,EAAWC,KAAe,WAE5BN,EAAYb,GAAiB,KACE,IAA/BT,EAAoB7E,QAEpB9B,EAAQ,2BAAKN,GAAN,IAAS0I,IAAGC,OAErB1B,EAAsB,KACrB,KACHA,EAAoBhI,KAAK2J,GAEzBA,IAEI3B,EAAoB7E,OAAS,IAC/B0G,IAAU7B,GAAqB,SAAC8B,GAAD,OAAcA,EAASC,YACtD/B,EAAsB,GACtBK,EAAc,2BAAKtH,GAAN,IAAS0I,IAAGC,UAG7B,CAACjB,EAAepH,EAASgH,IAGrB2B,EAAmBvJ,uBACvB,SAAC+G,GACC,IAAM2B,EAAe3B,EAAM4B,cAAcC,wBACnCI,EAAIjC,EAAMyB,QAAUE,EAAaM,EACjCC,EAAIlC,EAAM0B,QAAUC,EAAaO,EAE/BO,EAAwCzC,EAAxCyC,OAAQC,EAAgC1C,EAAhC0C,OAAQrB,EAAwBrB,EAAxBqB,SAAUsB,EAAc3C,EAAd2C,UAClC/B,EAAO,CAAE6B,OAAQA,GAAUC,EAAQrB,WAAUsB,YAAWV,IAAGC,QAE7D,CAACtB,IAGHlI,qBAAU,WAAO,IACP0H,EAAuB1J,EAAvB0J,KAAMwC,EAAiBlM,EAAjBkM,OAAQC,EAASnM,EAATmM,KACT,QAATzC,GAAkB0C,KAAKC,IAAIH,EAASC,GAAQ,IAC9ClC,EAAQjK,GACRkB,EAAS,CACPhB,KAAM,YAGT,CAAC+J,EAASjK,IAEb,IAAMsM,EAAe/J,uBAAY,SAAC+G,GAChCpI,EAAS,CACPhB,KAAM,OACN2K,QAASvB,EAAMuB,QACfC,QAASxB,EAAMwB,QACfC,QAASzB,EAAMyB,QACfC,QAAS1B,EAAM0B,YAEhB,IAEGuB,EAAahK,uBAAY,SAAC+G,GAM9B,OALApI,EAAS,CACPhB,KAAM,KACN6K,QAASzB,EAAMyB,QACfC,QAAS1B,EAAM0B,WAEV,IACN,IAEH,OACE,cAACxB,EAAanI,SAAd,CAAuBd,MAAOP,EAA9B,SACE,qBACEgK,UAAWA,EACXtG,MAAOA,EACP8I,YAAa/B,EACbgC,UAAWF,EACXG,YAAaJ,EACbnJ,QAASkI,EACTsB,QAASb,EAPX,SASGxK,MAaT,SAAS+I,QAAQrK,EAAOC,GACtB,OAAQA,EAAOC,MACb,IAAK,KACH,GAAmB,aAAfF,EAAM0J,MAAsC,UAAf1J,EAAM0J,KAAkB,CAAC,IAChDqB,EAAqB9K,EAArB8K,QAASC,EAAY/K,EAAZ+K,QAEjB,OAAO,2BACFhL,GADL,IAEEmM,KAAMpB,EAAU/K,EAAMiL,aAAaM,EACnCqB,KAAM5B,EAAUhL,EAAMiL,aAAaO,EAEnC9B,KAAqB,UAAf1J,EAAM0J,KAAmB,UAAY,QAG/C,OAAO1J,EACT,IAAK,OACH,GAAmB,YAAfA,EAAM0J,MAAqC,QAAf1J,EAAM0J,KAAgB,CAAC,IAEnDmB,EAOE5K,EAPF4K,QACAC,EAME7K,EANF6K,QACAC,EAKE9K,EALF8K,QACAC,EAIE/K,EAJF+K,QACAC,EAGEhL,EAHFgL,aACAN,EAEE1K,EAFF0K,SACAC,EACE3K,EADF2K,OAEIW,EAAIR,EAAUE,EAAaM,EAC3BC,EAAIR,EAAUC,EAAaO,EAEjC,OAAO,2BACFxL,GADL,IAEE2K,WACAC,SACAsB,OAAQX,EACRsB,OAAQrB,EACRsB,aAAcjC,EACdkC,aAAcjC,EACdkC,aAAcjC,EACdkC,aAAcjC,EACdC,eACAvB,KAAM,UAGV,OAAO1J,EACT,IAAK,OACH,GAAmB,UAAfA,EAAM0J,MAAmC,aAAf1J,EAAM0J,KAAqB,CAAC,IAChDqB,EAAqB9K,EAArB8K,QAASC,EAAY/K,EAAZ+K,QAEjB,OAAO,2BACFhL,GADL,IAEE0J,KAAM,WACNyC,KAAMpB,EAAU/K,EAAMiL,aAAaM,EACnCqB,KAAM5B,EAAUhL,EAAMiL,aAAaO,IAGvC,OAAOxL,EACT,IAAK,OACH,GAAmB,QAAfA,EAAM0J,KACR,OAAO,2BACF1J,GADL,IAEE0J,KAAM,YAGV,MACF,QACE,OAAO1J,GAxEb+J,aAAamD,aAAe,CAC1BjD,QAAS,0BAAM,MACfC,OAAQ,yBAAM,MACdC,cAAe,gCAAM,MACrBhH,QAAS,0BAAM,OCrJV,IAAMgK,EAAerN,0BACtBsN,EAAiBD,EAAa9L,SAM7B,SAASgM,aAAT,GAAsE,IAA9C/L,EAA6C,EAA7CA,SAAU0I,EAAmC,EAAnCA,UAAWtG,EAAwB,EAAxBA,MAAO0G,EAAiB,EAAjBA,cAAiB,EACxBE,mBAAS,MADe,mBACnEgD,EADmE,KAChDC,EADgD,KAEpEC,EAAmBjL,uBACvB,SAACM,GACC,IAAMoI,EAAepI,EAAEqI,cAAcC,wBAC/BI,EAAI1I,EAAEkI,QAAUE,EAAaM,EAC7BC,EAAI3I,EAAEmI,QAAUC,EAAaO,EACnC+B,EAAqB,CAAEhC,IAAGC,MACtBpB,GACFvH,EAAEE,oBAGN,CAACqH,IAGGqD,EAAoBlL,uBACxB,SAACM,GACC0K,EAAqB,MACjBnD,GACFvH,EAAEE,oBAGN,CAACqH,IAGH,OACE,cAACgD,EAAD,CAAgB7M,MAAO+M,EAAvB,SACE,qBACEtD,UAAWA,EACXtG,MAAOA,EACPgJ,YAAac,EACbtK,aAAcuK,EAJhB,SAMGnM,MCxCF,IAAMoM,EAAe5N,0BAEf6N,EAAoBD,EAAarM,SAEvC,SAASuM,eACd,OAAOpM,qBAAWkM,GCLb,IAAMG,EAAkB/N,0BAElBgO,EAAmBD,EAAgBxM,SAEzC,SAAS0M,cACd,OAAOvM,qBAAWqM,GCLb,IAAMG,EAAoBlO,0BAEpBmO,EAAsBD,EAAkB3M,SAE9C,SAAS6M,iBACd,OAAO1M,qBAAWwM,GCLb,IAAMG,EAAerO,0BAEfsO,EAAgBD,EAAa9M,SAEnC,SAASgN,WACd,OAAO7M,qBAAW2M,GCPb,IAAMG,EAAY,CACvBC,SAAU,WACVC,WAAY,aACZC,UAAW,YACXC,YAAa,cACbC,OAAQ,SACRC,aAAc,eACdC,YAAa,cACbC,cAAe,gBACfC,aAAc,gBAGHC,EACL,OADKA,EAEF,UAFEA,EAGJ,QAGIC,EACL,OADKA,EAEJ,QClBHC,EAAepP,0BACRqP,EAAgBD,EAAa7N,SAE7B+N,EAAW,SAAXA,WACX,OAAO5N,qBAAW0N,ICJdG,EAAS,CACbC,eAAgB,CACd3L,SAAU,QACV4L,IAAK,EACLC,MAAO,EACPC,OAAQ,EACRC,KAAM,EACNC,gBAAiB,wBACjBC,QAAS,OACTC,eAAgB,SAChBC,WAAY,SACZC,OAAQ,GAEVC,eAAgB,CACdC,UAAW,UACXN,gBAAiB,OACjBO,UAAW,sCACXN,QAAS,OACTO,cAAe,SACfC,SAAU,QACVC,UAAW,QACXR,eAAgB,gBAChBS,aAAc,QAIZC,GAAQ,SAARA,MAAS,GAAwC,IAAtCjP,EAAqC,EAArCA,SAAUkP,EAA2B,EAA3BA,KAAMC,EAAqB,EAArBA,QAAS/M,EAAY,EAAZA,MAClCgN,EAAcnO,uBAClB,SAACM,GACC4N,EAAQ5N,KAEV,CAAC4N,IASH,OANAzO,qBAAU,YACK,IAATwO,GACFE,MAED,CAACA,EAAaF,IAGfA,GACE,qBAAK9M,MAAO2L,EAAOC,eAAgBnM,QAASuN,EAA5C,SACE,qBACEhN,MAAK,2BAAO2L,EAAOW,gBAAmBtM,GACtCP,QAAS,iBAACN,GACRA,EAAEC,iBACFD,EAAEE,mBAJN,SAOGzB,OAOXiP,GAAMrD,aAAe,CACnBuD,QAAS,SAAS,UAChB,OAAO,MAETD,MAAM,GAGOD,I,MAAAA,M,yDC3DTI,IAAY,sBACf1B,EAAmB,CAClB2B,WAAW,WAAD,OAJG,IAIH,WACV/M,QAAS,IAHK,gBAKfoL,EAAoB,CACnB4B,UAAW,WACXD,WAAW,OAAD,OATG,IASH,oBAPI,IAWZE,IAAuB,sBAC1B7B,EAAmB,CAClB8B,SAAU,CAAElN,QAAS,GACrBmN,QAAS,CAAEnN,QAAS,KAHK,gBAK1BoL,EAAoB,CACnB8B,SAAU,CAAEF,UAAW,YACvBG,QAAS,CAAEH,UAAW,YACtBI,QAAS,CAAEJ,UAAW,YACtBK,OAAQ,CAAEL,UAAW,cATI,IAavBM,GAAY,SAAZA,UAAa,GAAoD,IAAlD7P,EAAiD,EAAjDA,SAAUpB,EAAuC,EAAvCA,KAAMkR,EAAiC,EAAjCA,iBAAqBrQ,EAAY,uDAC9DsQ,EAAMC,iBAAO,MACnB,OACE,cAAC,KAAD,yBAAqBC,QAASF,GAAStQ,GAAvC,IAA8CyQ,QA7BjC,IA6Bb,SACG,kBAACxR,GAAD,OACC,qBACEqR,IAAKA,EACL3N,MAAK,uCACAiN,GAAazQ,IACbkR,EAAiBlR,GAAMF,IACvBoR,EAAiBK,SALxB,SAQGnQ,SAOX6P,GAAUjE,aAAe,CACvBkE,iBAAkBN,IAGLK,UCwDAO,I,MAAAA,GAZf,SAASA,gBAAT,GAAiE,IAA9CpQ,EAA6C,EAA7CA,SAAqBqC,EAAwB,EAAnCgO,QAAWhO,SAAe5C,EAAS,uCACxDsO,EAASjO,mBAAQ,kBAhGA,SAAZwQ,UAAajO,EAAU5C,GAClC,IAAM8Q,EAAa,aAEjBlO,SAAU,QACViM,QAAS,OACTC,eAAgB,SAChBC,WAAY,SACZK,cAAe,SAEfvM,cAAe,OACfkO,SAAU,WACN/Q,EAAMgR,eACN,CACExC,IAAI,GAAD,OAAKxO,EAAMgR,eAAexC,IAA1B,MACHG,KAAK,GAAD,OAAK3O,EAAMgR,eAAerC,KAA1B,MACJ9I,OAAO,GAAD,OAAK7F,EAAMgR,eAAenL,OAA1B,MACND,MAAM,GAAD,OAAK5F,EAAMgR,eAAepL,MAA1B,OAEP,CAAEA,MAAO,OAAQC,OAAQ,SAG/B,OAAQjD,GACN,KAAK2K,EAAUC,SACb,OAAO,2BACFsD,GADL,IAGEhC,eAAgB,aAChBC,WAAY,eAEhB,KAAKxB,EAAUE,WACb,OAAO,2BACFqD,GADL,IAEEhC,eAAgB,eAIpB,KAAKvB,EAAUG,UACb,OAAO,2BACFoD,GADL,IAGEhC,eAAgB,aAChBC,WAAY,aAEhB,KAAKxB,EAAUI,YACb,OAAO,2BACFmD,GADL,IAGEhC,eAAgB,SAChBC,WAAY,eAEhB,KAAKxB,EAAUK,OACb,OAAO,2BACFkD,GADL,IAGEhC,eAAgB,WAGpB,KAAKvB,EAAUM,aACb,OAAO,2BACFiD,GADL,IAGEhC,eAAgB,SAEhBC,WAAY,aAGhB,KAAKxB,EAAUO,YACb,OAAO,2BACFgD,GADL,IAGEhC,eAAgB,WAEhBC,WAAY,eAEhB,KAAKxB,EAAUQ,cACb,OAAO,2BACF+C,GADL,IAGEhC,eAAgB,aAEpB,KAAKvB,EAAUS,aACb,OAAO,2BACF8C,GADL,IAGEhC,eAAgB,WAEhBC,WAAY,aAGhB,QACE,OAAO+B,GAMkBD,CAAUjO,EAAU5C,KAAQ,CAAC4C,EAAU5C,IAEpE,OACEO,EAAS2D,OAAS,GAChB,6CAAKvB,MAAO2L,GAAYtO,GAAxB,aACGO,M,QCpGH0Q,GAAeC,YAAH,mJAQZC,GAAeD,YAAH,yuCA2CZE,GAAqB,SAArBA,mBAAsB,GAAuC,IAArCC,EAAoC,EAApCA,MAAOC,EAA6B,EAA7BA,KAAM5B,EAAuB,EAAvBA,QAAS6B,EAAc,EAAdA,QAC5CC,EAAahQ,uBACjB,SAACM,GACCuP,EAAMvP,GACN4N,MAEF,CAACA,EAAS2B,IAGNI,EAAYjQ,uBAChB,SAACM,GACCwP,EAAKxP,GACL4N,MAEF,CAACA,EAAS4B,IAGZ,OACE,oBACE3O,MAAO,CACLkM,QAAS,OACTO,cAAe,SACfR,gBAAiB,UACjB8C,KAAM,GALV,UAQE,kBAAGR,IAAKD,GAAR,SAAuBM,IACvB,oBAAKL,IAAKC,GAAV,UACE,uBAAQhS,KAAK,SAASiD,QAASqP,EAA/B,gBAGA,uBAAQtS,KAAK,SAASiD,QAASoP,EAA/B,wBAQRJ,GAAmBjF,aAAe,CAChCkF,MAAO,iBACL,OAAO,MAETC,KAAM,gBACJ,OAAO,OASIF,I,MAAAA,MCvFTf,IAAgB,sBACnBnC,EAAmB,CAClB8B,SAAU,CAAElN,QAAS,GACrBmN,QAAS,CAAEnN,QAAS,KAHF,gBAKnBoL,EAAoB,CACnB8B,SAAU,CAAEF,UAAW,YACvBG,QAAS,CAAEH,UAAW,YACtBI,QAAS,CAAEJ,UAAW,YACtBK,OAAQ,CAAEL,UAAW,cATH,IAatB,SAASxP,SAAT,GAOI,IANFC,EAMC,EANDA,SACAoC,EAKC,EALDA,MACAgP,EAIC,EAJDA,OACA/O,EAGC,EAHDA,SACAiN,EAEC,EAFDA,WACA+B,EACC,EADDA,WAEMC,EAAOtB,mBADZ,EAEyBhH,qBAFzB,mBAEMuI,EAFN,KAEaC,EAFb,KAID9Q,qBAAU,WACR4Q,EAAKG,QAAUxP,SAASC,cAAc,OACtC,IAAM6N,EAAMuB,EAAKG,QAIjB,OAHIJ,GACFA,EAAWpO,YAAY8M,GAElB,WACDA,GACEsB,GACFA,EAAWzN,YAAYmM,MAI5B,CAACsB,IAEJ,IAAMhQ,EAAS,SAATA,SACJmQ,EAAS,OAGLE,EAAc5R,mBAAQ,WAC1B,OAAOuR,EACHA,EAAWxH,wBACX,CACEoE,IAAK,EACLG,KAAM,EACN/I,MAAOnC,OAAOyO,WACdrM,OAAQpC,OAAO0O,eAEpB,CAACP,IAEEQ,EAAe5Q,uBAAY,WAC/BI,MACC,IAUGL,EAAOC,uBAAY,SAAC6Q,GAA6B,IAAlBzB,EAAiB,uDAAP,GACvC0B,EAAS,CACbD,YACAzB,QAAQ,aAAG2B,kBAAkB,EAAMC,gBAAgB,GAAU5B,GAG/D0B,MAAe,kBAAM1Q,MAIrB,OAFAmQ,EAASO,GACLA,EAAO1B,QAAQ6B,QAAQH,EAAO1B,QAAQ6B,SACnCH,IACN,IAEGI,EAAoBlR,uBAAY,SAAC+P,GAA2B,IAAlBX,EAAiB,uDAAP,GAClD0B,EAAS,CACbD,UAAW,aAACM,GAAD,CAAepB,QAASA,IACnCX,QAAQ,aAAG2B,kBAAkB,GAAS3B,GAGxC0B,MAAe,kBAAM1Q,MAKrB,OAHAmQ,EAASO,GACLA,EAAO1B,QAAQ6B,QAAQH,EAAO1B,QAAQ6B,SAEnCH,IACN,IAMHrR,qBAAU,WACR,IAAM2R,EAAa,SAAbA,WAAc9Q,GACd,CAAC,SAAU,OAAOT,SAASS,EAAEV,MAC/BgR,KAIJ,OADA5P,SAASqQ,iBAAiB,UAAWD,GAAY,GAC1C,kBAAMpQ,SAASsQ,oBAAoB,UAAWF,GAAY,MAChE,CAACR,IAEJ,IAAM9D,EAAS4C,YAAH,gWAoBN6B,EACJjB,GAASA,EAAMlB,QAAQ2B,iBACnB,CAAE3D,gBAAiB,yBACnB,CAAE/L,cAAe,QAEvB,OACE,aAACuL,EAAD,CAAe5O,MAAO,CAAE+B,OAAMyR,MAxClB,SAARA,QACJZ,KAuCqCN,QAAOY,qBAA5C,UACGnS,EACAsR,EAAKG,SACJiB,wBACE,aAAC,WAAD,UACGnB,EACC,oBACEZ,IAAK5C,EACL3L,MAAK,eACAoQ,GAHP,SAME,aAACG,GAAA,EAAD,CACEC,QAAM,EAQNvC,QAAS,CACPhO,SAAUkP,EAAMlB,QAAQhO,SACpBkP,EAAMlB,QAAQhO,SACdA,GAENoO,eAAgBiB,EAChBI,UAAW1B,GAfb,SAiBE,aAAC,GAAD,CACExR,KACE2S,EAAMlB,QAAQf,WACViC,EAAMlB,QAAQf,WACdA,EAENQ,iBAAgB,2BACXA,IADW,IAEdK,QAAS,CACP9K,MAAOkM,EAAMlB,QAAQhL,MAAd,UACAkM,EAAMlB,QAAQhL,MADd,MAEH,QAENC,OAAQiM,EAAMlB,QAAQ/K,OAAd,UACDiM,EAAMlB,QAAQ/K,OADb,MAEJ,SAfR,SAmBE,aAAC,KAAD,CACE6K,QAAS,CACP9K,MAAOkM,EAAMlB,QAAQhL,MACjBkM,EAAMlB,QAAQhL,MACd,OACJC,OAAQiM,EAAMlB,QAAQ/K,OAClBiM,EAAMlB,QAAQ/K,OACd,OACJ2E,EAAG,EACHC,EAAG,GAELxB,UAAU,gBACVtG,MAAK,2BACAA,GADA,IAEHyQ,OAAQzB,EACR9O,cAAe,MACfD,SAAU,OACVyQ,WAAY,SAEdb,eAAgBV,EAAMlB,QAAQ4B,eAC9Bc,oBAAoB,SACpBC,sBAAsB,EArBxB,SAuBGzB,EAAMlB,SACL4C,uBAAa1B,EAAMO,UAAP,YAAC,eACRP,EAAMlB,SADC,IAEVlB,QAAS0C,EACTzP,MAAO,CAAE8Q,OAAQ,iBA7BlB3B,EAAMnQ,KA/BX4L,EACEuE,EAAMlB,QAAQf,WACViC,EAAMlB,QAAQf,WACdA,MA+DV,OAENgC,EAAKG,YAMf1R,SAAS6L,aAAe,CACtBwF,OAAQ,OACR/O,SAAU2K,EAAUmG,OACpB7D,WAAY3B,EACZ0D,WAAY,KACZjP,MAAO,IAGMrC,I,MAAAA,Y,sCC5PFqT,GAAW,WAEXC,GAAiB,iBACjBC,GAAkB,kBAClBC,GAAgB,gBAChBC,GAAgB,gBAChBC,GAAgB,gBAChBC,GAAW,WACXC,GAAY,YACZC,GAAuB,uBACvBC,GAAiB,iBACjBC,GAAe,eACfC,GAAe,eACfC,GAAsB,sBACtBC,GAAY,YACZC,GAAiB,iBACjBC,GAAoB,oBACpBC,GAAsB,sBACtBC,GAA0B,0BAE1BC,GAAgB,gBAChBC,GAAoB,oBACpBC,GACX,kCACWC,GAAyB,yBACzBC,GAAwB,wBACxBC,GAAe,eACfC,GAAkB,kBAClBC,GACX,mCACWC,GAAkB,kBAClBC,GAAe,eACfC,GAAe,eACfC,GAAkB,kBAClBC,GAAkB,kBAClBC,GAAmB,mBACnBC,GAAsB,sBACtBC,GAA6B,6BAC7BC,GAAiB,iBACjBC,GACX,oCAEWC,GAAkB,kBAClBC,GAAY,YACZC,GAAe,iBACfC,GAAuB,uBACvBC,GAAgB,gBAChBC,GAAgB,gBAChBC,GAA4B,4BAC5BC,GAAmB,mBACnBC,GACX,2CACWC,GACX,uCACWC,GACX,qCACWC,GAAwB,wBACxBC,GACX,oCACWC,GAAoB,oBACpBC,GAAwB,wBACxBC,GAAuB,uBACvBC,GAAe,eACfC,GAA6B,6BAC7BC,GAAmB,mBACnBC,GAAsB,sBACtBC,GAA+B,+BAE/BC,GAAuB,uBACvBC,GAAc,cAEdC,GAAiB,iBACjBC,GAAsB,sBACtBC,GAAqB,qBACrBC,GAAwB,wBACxBC,GACX,oCACWC,GAAsB,sBACtBC,GAAwB,wBACxBC,GAAe,eACfC,GAAmB,mBACnBC,GAAY,YACZC,GAAe,eACfC,GAAc,cACdC,GAAiB,iBACjBC,GAAyB,yBACzBC,GAAsB,sBACtBC,GAAwB,wBACxBC,GAA4B,4BAC5BC,GAA2B,2BAC3BC,GAAoB,oBACpBC,GAAe,eACfC,GAAkB,kBAClBC,GAA2B,2BAC3BC,GAAkB,kBAClBC,GAA+B,+BAC/BC,GAA+B,+BAC/BC,GAA8B,8BAC9BC,GAAwB,wBACxBC,GAAgB,gBAChBC,GAA2B,2BAC3BC,GAA0B,0BAC1BC,GAAc,cACdC,GAAiB,iBACjBC,GAAkB,kBAClBC,GAAuB,uBACvBC,GAAsB,sBACtBC,GAA2B,2B,2FC3GxC,iBAAwBC,GAAxB,kBAAApV,EAAA,+EACyBqV,MAAMD,GAD/B,cAEEE,YADMC,EADR,iBAGqBA,EAASC,OAH9B,cAGQzV,EAHR,yBAISA,GAJT,kD,sBAOA,SAASuV,YAAYC,GACnB,IAAKA,EAASE,GACZ,MAAM,IAAIla,MAAJ,eAAkBga,EAASG,OAA3B,cAAuCH,EAASI,aAExD,OAAOJ,EAGT,SAASK,iBAAiBC,GACxB,OAAOA,EAAKnS,QAAQ,QAAS,IAAIoS,cAGnC,SAASC,YAAYF,GACnB,OAAOA,EAAKG,OAAO,EAAGH,EAAKI,YAAY,MAYzC,SAASC,UAAUC,GAA8B,IAAf7J,EAAc,uDAAJ,GAC1C,OAAO8J,QAAQC,IACb,GAAGC,IAAI1X,KAAKuX,GAAe,SAACf,GAC1B,OAAO,IAAIgB,SAAQ,SAACG,EAASC,GAC3B,IAAMC,EAAS,IAAIC,WACnBD,EAAOE,QAAU,SAACnZ,GAAD,OAAOgZ,EAAOhZ,IAC/BiZ,EAAOG,QAAU,SAACpZ,GAAD,OAAOgZ,EAAOhZ,IAC/BiZ,EAAOxU,OAAS,WACd,GAAIwU,EAAOI,OAAQ,CACjB,IAAMC,EAASL,EAAOI,OAChBhB,EAAOE,YAAYX,EAAKS,MACxBkB,EAAYnB,iBAAiBR,EAAKS,MACxCU,EAAQ,CAAEO,SAAQjB,OAAMkB,gBAGxBzK,EAAQ0K,SACVP,EAAOQ,kBAAkB7B,GAEzBqB,EAAOS,mBAAmB9B,UC/BpC,IAAM/W,GAAQuO,YAAH,0bAyBLF,GAAiBE,YAAH,2IAQPuK,GAAcC,sBAuHZC,I,GAAAA,GArHf,SAASA,SAAS3b,GAAQ,IAAD,EACG6M,eAAlBjH,EADe,EACfA,MAAOC,EADQ,EACRA,OACT1F,EAAW6M,cACX4O,EAASpa,uBACb,SAACqa,GACC1b,EAAS,CAAEhB,KAAM8X,GAAkB6E,WAAW,IAE9C,IAHgB,EAGVC,EAAoB,aACrB,IAAIC,IAAIH,EAAajB,KAAI,SAAClB,GAAD,OAAUQ,iBAAiBR,EAAKS,WAJ9C,eAOM4B,GAPN,+BAOPV,EAPO,QAQRY,EAA4BJ,EAAazY,QAC7C,SAACsW,GAAD,OAAUQ,iBAAiBR,EAAKS,QAAUkB,KAG5C,OAAQA,GACN,IAAK,MACHb,UAAUyB,GAA2B1U,MACnC,SAAC2U,GACC/b,EAAS,CAAEhB,KAAM2U,GAAeoI,aAElC,SAAC1U,GAECG,MAAMH,MAGV,MACF,IAAK,SACL,IAAK,OACsC,IAArCyU,EAA0B/X,OAC5BsW,UAAUyB,GAA2B1U,MACnC,SAAC2U,GACC/b,EAAS,CAAEhB,KAAMyU,GAAgBsI,aAEnC,SAAC1U,GAECG,MAAMH,MAKVG,MAAM,kCAGR,MAEF,IAAK,KACL,IAAK,MACH6S,UAAUyB,GAA2B1U,MACnC,SAAC2U,GACC/b,EAAS,CAAEhB,KAAM0U,GAAiBqI,aAEpC,SAAC1U,GAECG,MAAMH,MAGV,MACF,IAAK,MACHgT,UAAUyB,EAA2B,CAAEX,UAAU,IAAQ/T,MACvD,SAAC2U,GACC/b,EAAS,CAAEhB,KAAM6U,GAAekI,aAElC,SAAC1U,GAECG,MAAMH,MAGV,MACF,IAAK,MACHgT,UAAUyB,GAA2B1U,MACnC,SAAC2U,GACC/b,EAAS,CAAEhB,KAAM4U,GAAemI,aAElC,SAAC1U,GAECG,MAAMH,MAGV,MACF,QAEEG,MACE,mEAzER,2BAA6C,IAP7B,iCAsFlB,CAACxH,IAGHsb,GAAYzJ,QAAUmK,aAAY,CAChCP,SACAQ,SAAS,IA/FY,MAkG+BX,GAAYzJ,QAA1DqK,EAlGe,EAkGfA,aAAcC,EAlGC,EAkGDA,cAAeC,EAlGd,EAkGcA,aAErC,OACE,8CAASF,KAAT,IAAyBnL,IAAKF,GAA9B,UACE,oCAAWsL,MACVC,GACC,oBACErL,IAAKvO,GACLA,MAAO,CAAEiD,MAAM,GAAD,OAAKA,EAAQ,GAAb,MAAqBC,OAAO,GAAD,OAAKA,EAAL,OAF3C,UAIE,aAAC,KAAD,IACA,uDAGH7F,EAAMO,cC/JP+N,GAAS4C,YAAH,ujBA8CGsL,I,GAAAA,GAnBf,SAASA,OAAT,GAAqC,IAAD,IAAlBC,eAAkB,SAC5BC,EAAwBlb,uBAAY,WACxCia,GAAYzJ,QAAQvC,SACnB,IAEH,OAAKgN,EAKH,oBAAKvL,IAAK5C,GAAQlM,QAASsa,EAA3B,SACE,8GALK,MCpCLpO,GAAS4C,YAAH,0rBAkCG,SAASyL,0BACtB,OACE,oBAAKzL,IAAK5C,GAAV,UACE,oBAAKsO,MAAM,6BAA6BC,QAAQ,kBAAhD,SACE,kBAAGC,KAAK,UAAR,UACE,qBAAMC,EAAE,m6EACR,qBAAMA,EAAE,sBAGZ,8CC1CC,SAASC,oBACd,OAAO,cAACL,wBAAD,IAGF,IAAMM,GAAiBle,wBAC5Bie,mBAGWE,GAAkBD,GAAe3c,SCuB/B6c,OA5Bf,SAASA,QAAT,GAAwC,IAAD,IAApBrB,iBAAoB,SAC7BzX,EAASwI,eAATxI,KAD6B,EAECkF,oBAAS,GAFV,mBAE9B6T,EAF8B,KAElBC,EAFkB,KAIrCpc,qBAAU,WACR,IAAIqc,EAAU,KAMd,OALKxB,IACHwB,EAAUC,YAAW,WACnBF,GAAgB,KACf,MAEE,WACLG,aAAaF,MAEd,CAACxB,IAEJ,IAAM2B,EAAahd,qBAAWwc,IAE9B,OACE,eAAC,WAAD,WACGnB,GAAa2B,IACbL,IAAetB,GACd,cAAC,GAAD,CAAQW,QAASpY,GAAwB,IAAhBA,EAAKH,a,8BC3BzBwZ,GAAgB3e,0BAEhB4e,GAAiBD,GAAcpd,SAErC,SAASsd,YACd,OAAOnd,qBAAWid,ICKpB,IAAMpP,GACG,CACL1L,SAAU,QACV4L,IAAK,EACLG,KAAM,EACN9L,cAAe,OACf+L,gBAAiB,OACjBiP,QAAS,MACTtO,aAAc,MACduO,MAAO,QACPC,WAAY,SACZC,SAAU,OACVC,WAAY,SACZC,WAAY,QAIhB,SAASC,QAAT,GAOI,IANFxb,EAMC,EANDA,MACAsG,EAKC,EALDA,UAKC,IAJDmV,sBAIC,MAJgB,QAIhB,EAHD7d,EAGC,EAHDA,SACA8d,EAEC,EAFDA,MAEC,IADD1M,cACC,MADQ,CAAEnH,EAAG,EAAGC,EAAG,GACnB,EACK6T,EAAW/N,mBACXgO,EAAahO,mBAFlB,EAGiChH,mBAAS,CAAEiB,EAAG,EAAGC,EAAG,IAHrD,mBAGM+T,EAHN,KAGiBC,EAHjB,OAI2BlV,oBAAS,GAJpC,mBAIMhI,EAJN,KAIYmd,EAJZ,KAKOC,EAAsBf,YAAtBe,kBAERC,2BAAgB,WA0Cd,GAAIrd,EAAM,CACR,IAAMsd,EA1CkB,SAApBC,oBACJ,IAAItU,EACAC,EACEsU,EAAgBT,EAAStM,QAAQ5H,wBACjC4U,EAAkBT,EAAWvM,QAAQ5H,wBAC3C,OAAQgU,GACN,IAAK,OACH5T,GAAKwU,EAAgBpZ,MACrB6E,EACEsU,EAAclZ,OAAS,EACrBkZ,EAAclZ,OAAS,EAAKmZ,EAAgBnZ,OAC5CkZ,EAAclZ,OAClB,MACF,IAAK,QACH2E,EAAIuU,EAAcnZ,MAClB6E,EACEsU,EAAclZ,OAAS,EACrBkZ,EAAclZ,OAAS,EAAKmZ,EAAgBnZ,OAC5CkZ,EAAclZ,OAClB,MACF,IAAK,MACH2E,EACEuU,EAAcnZ,MAAQ,EACpBmZ,EAAcnZ,MAAQ,EAAKoZ,EAAgBpZ,MAC3CmZ,EAAcnZ,MAClB6E,GAAKsU,EAAclZ,OACnB,MACF,IAAK,SACH2E,EACEuU,EAAcnZ,MAAQ,EACpBmZ,EAAcnZ,MAAQ,EAAKoZ,EAAgBpZ,MAC3CmZ,EAAcnZ,MAClB6E,EAAIsU,EAAclZ,OAClB,MACF,QACE2E,EAAI,EACJC,EAAI,EAGR,MAAO,CAAED,EAAGA,EAAIuU,EAAcvU,EAAGC,EAAGA,EAAIsU,EAActU,GAG3CqU,GACXL,EAAaI,MAEd,CAACT,EAAgB7c,IAEpB,IAAM0d,EAAmBzd,uBAAY,WACnCkd,GAAY,KACX,IAEGhS,EAAoBlL,uBAAY,WACpCkd,GAAY,KACX,IAEH,OACE,eAAC,WAAD,WACE,qBACE/b,MAAK,aACHC,SAAU,WACViD,OAAQ,OACRgJ,QAAS,OACTC,eAAgB,SAChBC,WAAY,UACTpM,EAAMuc,eAEX5O,IAAKgO,EACLa,YAAaF,EACbG,WAAY1S,EAXd,SAaGnM,IAEFgB,GACC0R,wBACE,qBACE3C,IAAKiO,EACL5b,MAAK,2BACA2L,IADA,IAEHwB,UAAU,aAAD,OAAe0O,EAAUhU,EAAImH,EAAOnH,EAApC,cACPgU,EAAU/T,EAAIkH,EAAOlH,EADd,OAGTuE,OAAQ,WACLrM,EAAM0c,OAEXpW,UAAWA,EAVb,SAYE,sBAAMtG,MAAO,CAAEE,cAAe,QAA9B,SAAyCwb,MAE3CM,MAMVR,QAAQhS,aAAe,CACrBxJ,MAAO,CACL0c,MAAO,GACPH,cAAe,KAIJI,I,GAAAA,kBAAKnB,SCzId7P,GAAS4C,YAAH,+NAaZ,SAASqO,YAAT,GAA0E,IAAnDnd,EAAkD,EAAlDA,QAASod,EAAyC,EAAzCA,WAAYpB,EAA6B,EAA7BA,eAAgBnV,EAAa,EAAbA,UAC1D,OACE,oBAAKA,UAAWA,EAAhB,SACE,aAAC,GAAD,CAASoV,MAAOmB,EAAYpB,eAAgBA,EAA5C,SACE,uBAAQlN,IAAK5C,GAAQnP,KAAK,SAASiD,QAASA,EAA5C,SACE,aAAC,KAAD,UAOVmd,YAAYpT,aAAe,CACzB/J,QAAS,0BAAM,MACfod,WAAY,QACZpB,eAAgB,OAChBnV,UAAW,IASEqW,I,MAAAA,kBAAKC,aCrCdjR,GAAS4C,YAAH,y6BAsDNuO,GAAevO,YAAH,qnBAgClB,SAASwO,uBAAT,GAOI,IANFrb,EAMC,EANDA,KACAsb,EAKC,EALDA,eACAC,EAIC,EAJDA,OACAzU,EAGC,EAHDA,OACAC,EAEC,EAFDA,KACAsE,EACC,EADDA,QACC,EACuCnG,qBADvC,mBACMsW,EADN,KACoBC,EADpB,OAEuCvW,oBAAS,GAFhD,mBAEMwW,EAFN,KAEiBC,EAFjB,OAGyCzW,oBAAS,GAHlD,mBAGM0W,EAHN,KAGsBC,EAHtB,KA6CD,OAxCAjf,qBAAU,WACRsc,YAAW,WACTyC,GAAmB,KAClB,OACF,IAEH/e,qBAAU,WACR,GAAI0e,GAAkBxU,GAAUC,GAAQ2U,EAAW,CAAC,IAAD,EAI7C1b,EAAKsb,EAAeQ,OAJyB,IAE/C9b,KAAQmG,EAFuC,EAEvCA,EAAGC,EAFoC,EAEpCA,EACX2V,EAH+C,EAG/CA,KAGIjb,EAAOya,IAASS,OAAOlV,GACvBmV,EAAKV,IAASS,OAAOjV,GAPsB,EASlBmV,aAAgB/V,EAAG,CAChDrF,OACAmb,OAFME,EATyC,EASzCA,UAAWC,EAT8B,EAS9BA,QAIbC,EAAgB,CACpBlW,EAAGA,EAAEvH,MAAMud,EAAWC,GACtBhW,EAAGA,EAAExH,MAAMud,EAAWC,IAExB,IACE,IAAMtF,EAASwF,aAAiBD,EAAe,CAC7CE,UAAWR,EAAKS,gBAChBC,uBAAuB,EACvBC,oBAAoB,EACpBC,OAAO,IAETd,GAAgB,GAChBJ,EAAgB3E,GAChB,MAAO3T,GAEPX,QAAQC,IAAIU,OAGf,CAAC2D,EAAQC,EAAM/G,EAAMub,EAAQD,EAAgBI,IAE3CE,EAeH,oBAAK/O,IAAK5C,GAAV,UACE,oBAAKrF,UAAU,gBAAf,UACE,oDAEA,aAAC,GAAD,CAAa7G,QAASsN,OAExB,oBAAKzG,UAAU,YAAf,SACG4W,GACCA,EAAamB,OACbnB,EAAamB,MAAMC,MAAMrG,KAAI,SAACmC,EAAGoD,GAAJ,eAE3B,YADA,CACA,OAAiBlX,UAAU,MAA3B,UACE,aAAC,KAAD,CACEiY,MAAO,CACLC,OAAQ,CACNhiB,KAAM,OACNkF,KAAM0Y,EAAEqE,YAGZze,MAAO,CAAEkD,OAAQ,IAAKD,MAAO,IAAKmL,SAAU,UAE9C,oBAAK9H,UAAU,eAAf,SACE,2BACG4W,EAAawB,EAAElB,GAAf,oBACMN,EAAawB,EAAElB,UADrB,aACM,EAAuBmB,aAD7B,uBAC8CzB,EAAawB,EACtDlB,UAFL,aAC8C,EAExCoB,SAASC,QAAQ,GAHvB,OAIG,OAGR,aAAC,KAAD,CACEN,MAAO,CACLC,OAAQ,CACNhiB,KAAM,OACNkF,KAAM0Y,EAAE0E,gBAGZ9e,MAAO,CAAEkD,OAAQ,IAAKD,MAAO,IAAKmL,SAAU,YA1BtCoP,WAxBhB,oBAAKjP,IAAKuO,GAAV,UACE,oBAAK7C,MAAM,6BAA6BC,QAAQ,kBAAhD,SACE,kBAAGC,KAAK,UAAR,UACE,qBAAMC,EAAE,m6EACR,qBAAMA,EAAE,sBAGZ,iFAoDR2C,uBAAuBvT,aAAe,CACpCuD,QAAS,mBACP,OAAO,OAGIgQ,8B,4BCrMAgC,GAhBK,CAClBC,YAAa,CACXC,IAAK,CAAEC,IAAK,EAAGC,KAAM,KAEvBC,WAAY,CACVC,QAAS,CACP,CAAE5gB,IAAK,KAAM+Y,KAAM,KAAM3a,MAAO,QAChC,CAAE4B,IAAK,MAAO+Y,KAAM,MAAO3a,MAAO,QAClC,CAAE4B,IAAK,MAAO+Y,KAAM,MAAO3a,MAAO,QAClC,CAAE4B,IAAK,MAAO+Y,KAAM,MAAO3a,MAAO,QAClC,CAAE4B,IAAK,OAAQ+Y,KAAM,OAAQ3a,MAAO,QACpC,CAAE4B,IAAK,MAAO+Y,KAAM,MAAO3a,MAAO,W,qBCPxC,SAASyiB,yBAAyBC,GAA8B,IAAb9gB,EAAY,uDAAN,KAAM,EACnCmI,mBACxB4Y,aAAaC,QAAQF,IAAoB,MAFkB,mBACtD1iB,EADsD,KAC/C6iB,EAD+C,KAI7DphB,qBAAU,WACRkhB,aAAaG,QAAQJ,EAAiB1iB,KACrC,CAAC0iB,EAAiB1iB,IAErB,IAAM+iB,EAAU/gB,uBACd,SAAC6C,GAAsB,IAAhBjD,EAAe,uDAAT,KACPohB,EAAWzd,KAAK0d,MAAMjjB,GACtB4B,EACFshB,KAAUF,EAAUphB,EAAKiD,GAEzBme,EAAQ,2BAAQA,GAAane,GAE/Bge,EAAStd,KAAKC,UAAUwd,MAE1B,CAAChjB,IAEH,MAAO,CACL4B,EAAMuhB,IAAU5d,KAAK0d,MAAMjjB,GAAQ4B,EAAK,IAAM2D,KAAK0d,MAAMjjB,GACzD+iB,GAIJ,IAAMK,GAAkB,SAAlBA,gBAAmBV,GAAoC,IAAnBW,IAAkB,yDACpDC,EAAWX,aAAaC,QAAQF,GACtC,OAAOY,GAAYD,EAAS9d,KAAK0d,MAAMK,GAAYA,GAU/CC,GAAW,SAAXA,SAAYC,EAAQC,GAAkC,IAAzBC,EAAwB,uDAAT,KAChD,OAAOP,IAAUK,EAAQC,EAASC,ICxCvBC,GAAoB,CAC/BC,QAAS1B,GAAYC,YAAYC,IAAIC,IACrCwB,SAAU3B,GAAYC,YAAYC,IAAIE,KACtCwB,eAAgB,GAGGC,G,WACnB,gCAAsC,IAA1BC,EAAyB,uDAAjB,EAAG5S,EAAc,uDAAJ,GAAI,wCACnC6S,KAAKD,MAAQA,EACbC,KAAKH,eACH1S,EAAQ0S,gBAAkBH,GAAkBG,eAC9CG,KAAKC,aAAe9S,EAAQ8S,cAAgBP,GAAkBC,QAC9DK,KAAKE,aAAe/S,EAAQ+S,cAAgBR,GAAkBE,S,6DAIhE,SAAAO,MAAM5Y,EAAQE,GACZ,IAAM2Y,EACmC,IAAvCxY,KAAKC,IAAIN,GAAQ8Y,WAAW5f,OACxBmH,KAAKC,IAAIN,GACTK,KAAKC,IAAIN,GAAU,IACnB8X,EAAWF,GAAgB,wBAE3BmB,EAAgBhB,GAASD,EAAU,+BACnCkB,EAAgBjB,GAASD,EAAU,gCAEnCmB,EAAWF,EACb,IAAOA,EACP,IAAON,KAAKC,aACVQ,EAAYF,EACd,IAAOA,EACP,IAAOP,KAAKE,aAEZQ,EAAYN,GAAeJ,KAAKH,eAAiBW,EAAWC,EAG1DE,GACW,IAFC/Y,KAAKgZ,KAAKrZ,GAEPyY,KAAKD,MAAQW,EAAYV,KAAKD,MAAQW,EAEzDV,KAAKD,MADHY,GAAU,GAAgB,IAAXA,EACJA,EAEA,I,sBAIjB,SAAAE,WACE,OAAOb,KAAKD,Q,sBAGd,SAAAe,SAASf,GACPC,KAAKD,MAAQA,M,wBCjDJgB,GAAsB,GACtBC,GAAsB,IAAIlB,GAAqB,IAE/CmB,GACC,aADDA,GAED,WAFCA,GAGK,iBAIX,SAASC,kBAAkBtgB,GAChCA,EAAK6D,SAAQ,SAAC0c,GACPJ,GAAoBI,EAAMjjB,KAAgC,IAAzBijB,EAAMxE,KAAKyE,YAC/CL,GAAoBI,EAAMjjB,IAAM,IAAI4hB,OAKnC,SAASK,WACd5Y,EACAE,EAFK,GAKJ,IAFC7G,EAEF,EAFEA,KAAMsb,EAER,EAFQA,eAAgBmF,EAExB,EAFwBA,UACxBnjB,EACA,uDADK,KAEDge,GAAkBhe,EACpB6iB,GAAoB7iB,GAAUge,EAAehe,IAAIiiB,MAAM5Y,EAAQE,GAE/D7G,EAAK6D,SAAQ,SAAC0c,GACiB,IAAzBA,EAAMxE,KAAKyE,WAAmBC,IAAcF,EAAMxE,KAAK4B,SACzDwC,GAAoBI,EAAMjjB,IAAIiiB,MAAM5Y,EAAQE,MAK7C,SAAS6Z,aAAapjB,GAC3B,OAAO,gBAAGA,EAAK6iB,GAAoB7iB,GAAI2iB,SAAS3iB,IAG3C,SAAS2iB,SAAT,GAAwC,IAApBjgB,EAAmB,EAAnBA,KAAMygB,EAAa,EAAbA,UAC/B,OAAOzgB,EAAK2gB,QAAO,SAACC,EAAKL,GAIvB,OAH6B,IAAzBA,EAAMxE,KAAKyE,WAAmBC,IAAcF,EAAMxE,KAAK4B,UACzDiD,EAAIL,EAAMjjB,IAAM6iB,GAAoBI,EAAMjjB,IAAI2iB,YAEzCW,IACN,IAGE,SAASV,SAASf,GACvB,GAAqB,kBAAVA,EACT9jB,OAAOC,KAAK6kB,IAAqBtc,SAAQ,SAACvG,GACxC6iB,GAAoB7iB,GAAI4iB,SAASf,UAE9B,IAAqB,kBAAVA,EAKhB,MAAM3jB,MAAM,kCAJZH,OAAOC,KAAK6jB,GAAOtb,SAAQ,SAACvG,GAC1B6iB,GAAoB7iB,GAAI4iB,SAASf,EAAM7hB,QAa7C,SAASujB,QAAQC,GAAgD,IAAzCC,EAAwC,uDAAzB,KAAMC,EAAmB,uDAAN,KAChDxf,EAAmCsf,EAAnCtf,OAAQuN,EAA2B+R,EAA3B/R,OAAQuM,EAAmBwF,EAAnBxF,eACpByF,GACFb,SAASa,GAEX,IAAM5B,EAAQc,SAASa,GAGvB,GAFAA,EAAMG,WAAa,CAAE9B,SAEE,OAAnB7D,GAA0C,OAAf0F,EAC7BF,EAAMI,SAAW7lB,OAAOC,KAAKwlB,EAAMI,UAAUP,QAAO,SAACC,EAAKtjB,GACxD,IAAMyiB,EAASoB,aAAYL,EAAMM,aAAaF,SAAS5jB,GAAK,CAC1DkE,EAASuN,EAAO1E,OAChB0E,EAAO5E,MAHsD,cAK5C2W,EAAMM,aAAaF,SAAS5jB,GALgB,GAKxD+jB,EALwD,KAKnDC,EALmD,KAOzDC,EADWva,KAAKsa,IAAIta,KAAKC,IAAIqa,GAAMta,KAAKC,IAAIoa,MAClBC,EAAM,EAAID,EAQpCG,EAPIC,KACPC,UACC,GACA1a,KAAKgZ,KAAKuB,GAAmBxB,EAAOwB,KAErCpC,MAAMA,EAAM7hB,IACZokB,UAAU,GAAI3B,EAAO,IACN4B,SAAS5B,GAAQ6B,SAEnC,OADAhB,EAAItjB,GAAMkkB,EACHZ,IACN,QACE,CACL,IAAMiB,EAAab,GAA0B1F,EAAehe,GACtDyiB,EAASoB,aAAYL,EAAMM,aAAaF,SAASW,GAAa,CAClErgB,EAASuN,EAAO1E,OAChB0E,EAAO5E,MAGH2X,EAAIL,KACPC,UAAU,EAAG3B,EAAO,IACpBZ,MAAMA,EAAM0C,IACZH,UAAU,GAAI3B,EAAO,IAElByB,EAAUM,EAAEH,SAAS5B,GAAQ6B,SACnCd,EAAMI,SAAN,2BACKJ,EAAMI,UADX,mBAEGW,EAAaL,KAKpB,SAASO,UAAUjB,EAAOtf,EAAQuN,EAAQ+M,GAA6B,IAAtBiF,EAAqB,uDAAN,KACtDK,EAA+CN,EAA/CM,aAAcY,EAAiClB,EAAjCkB,kBAAmBvB,EAAcK,EAAdL,UAEjCnjB,EAAO0kB,EAAkBvB,EAAUwB,MAAM,KAAKnG,IAA9Cxe,GACJyjB,GACFb,SAASa,GAEX,IAAM5B,EAAQuB,aAAapjB,GAC3BwjB,EAAMG,WAAa,CAAE9B,SAErB,IAAMY,EAASoB,aAAYC,EAAaF,SAAS5jB,GAAK,CACpDkE,EAASuN,EACTA,IAEI+S,EAAIL,KACPC,UAAU,EAAG3B,EAAO,IACpBZ,MAAMA,EAAM7hB,IACZokB,UAAU,GAAI3B,EAAO,IACpByB,EAAUM,EAAEH,SAAS5B,GAAQ6B,SACjCd,EAAMI,SAAS5jB,GAAMkkB,EAGvB,SAASU,gBAAgB/C,EAAO2B,GAC9B,GAAIA,EAAMxF,eAAgB,CAAC,IACjB9Z,EAAmBsf,EAAnBtf,OAAQuN,EAAW+R,EAAX/R,OAChB,GAAI+R,EAAMqB,sBAAsBrB,EAAMxF,eAAehe,IAAK,CACxD,IAAMyiB,EAASoB,aACbL,EAAMqB,sBAAsBrB,EAAMxF,eAAehe,IACjD,CAACkE,EAASuN,EAAO1E,OAAQ0E,EAAO5E,MAG5BiY,EAAajD,EAAQ,GAAM,IAAOA,EAOlCkD,EALIZ,KACPC,UAAU,EAAG3B,EAAO,IACpBZ,MAAMiD,GACNV,UAAU,GAAI3B,EAAO,IAEH4B,SAAS5B,GAAQ6B,SAEtCd,EAAMwB,mBAAqB,CAAEnD,SAC7B,IAAM7D,EAAiBwF,EAAMxF,eAC7BwF,EAAMyB,kBAAkBjH,EAAehe,IAAM+kB,I,cC/JnD,SAASG,UAAU5nB,GAA2B,IAApBinB,EAAmB,uDAAN,KAC7BtgB,EAA2C3G,EAA3C2G,MAAOwN,EAAoCnU,EAApCmU,OAAQ0T,EAA4B7nB,EAA5B6nB,SAAUC,EAAkB9nB,EAAlB8nB,QAASC,EAAS/nB,EAAT+nB,KACpCpjB,EACK,QAATojB,EACI,CAACphB,EAAQwN,EAAO3E,MAAO2E,EAAOzE,MAC9B,CAACyE,EAAOzE,KAAM/I,EAAQwN,EAAO3E,OACnC,OAAO+W,aAAYU,EAAaY,EAASZ,GAAca,EAASnjB,GAGlE,SAASqjB,UAAUhoB,GAA2B,IAApBinB,EAAmB,uDAAN,KAC7BrgB,EAAqD5G,EAArD4G,OAAQuN,EAA6CnU,EAA7CmU,OAAQ8T,EAAqCjoB,EAArCioB,cAAerB,EAAsB5mB,EAAtB4mB,QAASN,EAAatmB,EAAbsmB,SAC1C4B,EACJD,EAAcE,OAASF,EAAcG,SAChCxhB,EAAS,IAAM,EAChBA,EAASuN,EAAO1E,OAAS,GAE3B4Y,EAAU,GAMd,OAJEA,EADiB,OAAfpB,QAAgDqB,IAAzBhC,EAASW,GACxB,CAAC,EAAGL,EAAQ,IAEZ,CAAC,EAAGN,EAASW,GAAY,IAE9BV,aAAY8B,EAAS,CAACH,EAAS/T,EAAO5E,MCpBxC,IAEMgZ,GAAY,YAEZC,GAAoB,CAC/B7H,OAAQ,KACR8H,OAAQ,MAGH,SAASC,aAAa1oB,EAAOC,GAClC,OAAQA,EAAOC,MACb,IAXuB,cAYrB,OAAOyoB,aAAQ3oB,GAAO,SAACkmB,GACrBA,EAAMvF,OAAS,eAACsG,EAAD,uDAAc,KAAd,OAAuBW,UAAU3nB,EAAQgnB,OAE5D,IAduB,cAerB,OAAO0B,aAAQ3oB,GAAO,SAACkmB,GACrBA,EAAMuC,OAAS,eAACxB,EAAD,uDAAc,KAAd,OAAuBe,UAAU/nB,EAAQgnB,OAE5D,KAAKsB,GACH,OAAOI,aAAQ3oB,GAAO,SAACkmB,GACrBA,EAAMvF,OAAS,eAACsG,EAAD,uDAAc,KAAd,OAAuBW,UAAU3nB,EAAQgnB,IACxDf,EAAMuC,OAAS,eAACxB,EAAD,uDAAc,KAAd,OAAuBe,UAAU/nB,EAAQgnB,OAG5D,QACE,OAAOjnB,GC5BN,IAAM0C,GAAK,WACLwY,GAAO,WAOb,SAAS0N,MAAMC,GACpB,IAAKC,aAAaD,GAChB,MAAM,IAAIjoB,MAAM,wCAGlBioB,EAAQzjB,KAAK2jB,GAAKC,aAAaH,EAAQzjB,MACvCyjB,EAAQzjB,KAAK6jB,GAAK,IAAIC,aAAa,GACnCL,EAAQ1H,KAAR,2BAAoB0H,EAAQ1H,MAA5B,IAAkCgI,WAAW,IAGxC,SAASL,aAAaD,GAC3B,SAAIA,EAAQ1H,KAAKgI,WAAcN,EAAQ1H,KAAKiI,OAIvC,SAASrD,SACd,MAAO,CACLsD,MAAM,EACNtD,OAAQ,MC1BL,IAAMrjB,GAAK,sBACLwY,GAAO,6BAUdoO,GAAiB,CACrBC,eAAe,EACfC,WAAY,GACZC,kBAAmB,KAGd,SAASb,0BAAMC,GAAwB,IAAflX,EAAc,uDAAJ,GACvC,IAAKmX,iCAAaD,GAChB,MAAM,IAAIjoB,MAAM,+CAIlB,OAFA+Q,EAAUlR,OAAOipB,OAAO,GAAIJ,GAAgB3X,GAErCgY,aAAwBd,EAAQzjB,KAAMuM,GAGxC,SAASmX,iCAAaD,GAC3B,SAAIA,EAAQ1H,KAAKgI,WAAcN,EAAQ1H,KAAKiI,OAIvC,SAASrD,2BAAO6D,EAAeC,GACpC,IAAIC,EAAUrpB,OAAOipB,OAAO,GAAIE,GAChC,IAAK,IAAMG,KAAKD,EACdA,EAAQC,IAAMF,EAASE,GAEzB,MAAO,CACLV,MAAM,EACNtD,OAAQ+D,G,4CCnCCpnB,GAAK,qBACLwY,GAAO,sBAOP8O,GAAqB,CAChCC,OAAQ,SACRC,WAAY,cAGP,SAAStB,yBAAMC,GAAwB,IAAflX,EAAc,uDAAJ,GACvC,IAAKmX,gCAAaD,GAChB,MAAM,IAAIjoB,MAAM,kDAFyB,IAOvCupB,EAHIC,EAAqBzY,EAArByY,UAAWC,EAAU1Y,EAAV0Y,MAJwB,EAK3BxB,EAAQzjB,KAAlBmG,EALqC,EAKrCA,EAAGwd,EALkC,EAKlCA,GAGT,OAAQqB,GACN,IAAK,SACHD,EAAYG,aAAO/e,EAAGwd,EAAIpX,GAASwY,UACnC,MACF,IAAK,aAED,IAAIL,EAAUS,aACZ,CAAEhf,IAAGC,EAAGud,GACR,CAAEyB,eAAgB,KAAMH,UAE1B,GAAqB,IAAjBA,EAAMplB,OAAc,CAAC,IAAD,EACDwlB,aACnBX,EAAQve,EACRue,EAAQte,EACRmG,GAHI+Y,EADgB,EAChBA,WAKNP,EAAY,IAAIjB,aAAa3d,EAAEtG,QAC/B,IAAK,IAAID,EAAI,EAAGA,EAAI+jB,EAAG9jB,OAAQD,IAC7BmlB,EAAUnlB,GAAK+jB,EAAG/jB,GAAK0lB,EAAWC,QAAQpf,EAAEvG,QAEzC,CACL,IAAI4lB,EAAuB,IAAIC,KAC7Btf,EACAwd,EACApX,EAAQmZ,QAEVX,EAAY,IAAIjB,aAAa3d,EAAEtG,QAC/B,IAAK,IAAID,EAAI,EAAGA,EAAI+jB,EAAG9jB,OAAQD,IAC7BmlB,EAAUnlB,GAAK+jB,EAAG/jB,GAAK4lB,EAAqBD,QAAQpf,EAAEvG,IAK5D,MACF,QACE,MAAM,IAAIpE,MAAJ,iDAAoDwpB,IAG9D3pB,OAAOipB,OAAOb,EAAQzjB,KAAM,CAAE2jB,GAAIoB,IAG7B,SAASrB,gCAAaD,GAC3B,OAAKA,EAAQ1H,KAAKiI,MAIb,SAASrD,4BACd,MAAO,CACLsD,MAAM,EACNtD,OAAQ,MC3EL,IAAMrjB,GAAK,gBACLwY,GAAO,iBAOb,SAAS0N,oBAAMC,GAAwB,IAAflX,EAAc,uDAAJ,GACvC,IAAKmX,2BAAaD,GAChB,MAAM,IAAIjoB,MAAM,iDAFyB,MAKV+Q,EAA3BoZ,0BALqC,MAKhB,EALgB,EAMvChC,EAAK,IAAIG,aAAaL,EAAQzjB,KAAK2jB,IACnCE,EAAK,IAAIC,aAAaL,EAAQzjB,KAAK6jB,IAEnC+B,EAAgB5e,KAAK6e,MAAMF,GAEzBG,EAAO,EACbF,GAAiB,EAEjB,IAAMG,EAAQ,IAAIjC,aAAaH,EAAG9jB,QAC5BmmB,EAAQ,IAAIlC,aAAaD,EAAGhkB,QAClCkmB,EAAME,IAAItC,EAAG/kB,MAAMgnB,IACnBG,EAAME,IAAItC,EAAG/kB,MAAMknB,EAAMF,GAAgBjC,EAAG9jB,OAAS+lB,GACrDI,EAAMC,IAAIpC,EAAGjlB,MAAMgnB,IACnBI,EAAMC,IAAIpC,EAAGjlB,MAAMknB,EAAMF,GAAgB/B,EAAGhkB,OAAS+lB,GAErDnC,EAAQzjB,KAAK2jB,GAAKoC,EAClBtC,EAAQzjB,KAAK6jB,GAAKmC,EAGb,SAAStC,2BAAaD,GAC3B,SAAIA,EAAQ1H,KAAKgI,YAAaN,EAAQ1H,KAAKiI,OAItC,SAASrD,uBACd,MAAO,CACLsD,MAAM,EACNtD,YAAQuC,GCvCL,IAAM5lB,GAAK,MACLwY,GAAO,MAOb,SAAS0N,UAAMC,GACpB,IAAKC,iBAAaD,GAChB,MAAM,IAAIjoB,MAAM,mCAGlB,IAAI0qB,EAAuBzC,EAAQ0C,QAAQrpB,MACzC,SAACW,GAAD,MAAkB,kBAAXA,EAAEqY,MAA4BrY,EAAEslB,QAKzC,GAFA1nB,OAAOipB,OAAOb,EAAQzjB,KAAMomB,aAAQ3C,EAAQzjB,KAAM,CAAEqmB,gBAAgB,KAEhEH,EAAsB,CAAC,IACnBI,EAAkB7C,EAAQ1H,KAA1BuK,cACFC,GAAOD,EAAgBtf,KAAK6e,MAAMS,IAAkBtf,KAAKwf,GAAK,EAClEnrB,OAAOipB,OAAOb,EAAQzjB,KAAMymB,aAAoBhD,EAAQzjB,KAAM,EAAGumB,IAGnE9C,EAAQzjB,KAAKmG,EAgBf,SAASugB,cAAcjD,GAWrB,IAVA,IAAM1H,EAAO0H,EAAQ1H,KACf4K,EAAgBC,WAAW7K,EAAK4K,eAChCE,EAAkBD,WAAW7K,EAAK8K,iBAClCC,EAAgBF,WAAW7K,EAAK+K,eAChCxZ,EAASuZ,EAAkBF,EAC7BI,EAAoB,GAAMD,EAC1BE,EAAWvD,EAAQzjB,KAAKmG,EAAEtG,OAC1BonB,EAAa3Z,EAASyZ,EACtBG,EAAKJ,GAAiBE,EAAW,GAC/BG,EAAQ,IAAI7qB,MAAM0qB,GACfpnB,EAAI,EAAGA,EAAIonB,EAAUpnB,IAC5BunB,EAAMvnB,GAAKqnB,EACXA,GAAcC,EAEhB,OAAOC,EA/BUT,CAAcjD,GAC/BA,EAAQ1H,KAAR,2BAAoB0H,EAAQ1H,MAA5B,IAAkCiI,OAAO,IAGpC,SAASN,iBAAaD,GAC3B,SAAIA,EAAQ1H,KAAKgI,YAAaN,EAAQ1H,KAAKiI,OAItC,SAASrD,aACd,MAAO,CACLsD,MAAM,EACNtD,YAAQuC,GCvCL,IAAM5lB,GAAK,iBACLwY,GAAO,kBAQb,SAAS0N,qBAAMC,EAAStoB,GAC7B,IAAKuoB,4BAAaD,GAChB,MAAM,IAAIjoB,MAAM,8CAGlB,IACIoqB,EADAwB,EAAS3D,EAAQ1H,KAAKuK,cAGxBV,EADEwB,EAAS,EACKpgB,KAAK6e,MAAMuB,GAEX,EAmBlB,IAhBA,IAAMzD,EAAKF,EAAQzjB,KAAK2jB,GAClBE,EAAKJ,EAAQzjB,KAAK6jB,GAClB/B,EAAI2B,EAAQzjB,KAAKmG,EAEjBtG,EAAS8jB,EAAG9jB,OAEZwnB,EAAQ,IAAIvD,aAAajkB,GACzBynB,EAAQ,IAAIxD,aAAajkB,GAGzB0nB,GAAMzF,EAAEjiB,EAAS,GAAKiiB,EAAE,KAAOjiB,EAAS,GAExC2nB,GAAMrsB,EAAQ6L,KAAKygB,IAAI,GAEvBC,EAAU1gB,KAAKygB,IAAID,EAAKD,GAC1BI,EAAY3gB,KAAKygB,IAAID,EAAK1F,EAAE,IACvBliB,EAAI,EAAGA,EAAIC,EAAS+lB,EAAehmB,IAC1CynB,EAAMznB,GAAK+jB,EAAG/jB,GAAK+nB,EACnBL,EAAM1nB,GAAKikB,EAAGjkB,GAAK+nB,EACnBA,GAAwBD,EAE1BC,EAAY3gB,KAAKygB,IAAID,EAAK1F,EAAE,IAC5B,IAAK,IAAIliB,EAAIC,EAAQD,EAAIC,EAAS+lB,EAAehmB,IAC/CynB,EAAMznB,GAAK+jB,EAAG/jB,GAAK+nB,EACnBL,EAAM1nB,GAAKikB,EAAGjkB,GAAK+nB,EACnBA,GAAwBD,EAE1BjE,EAAQzjB,KAAR,2BAAoByjB,EAAQzjB,MAAS,CAAE2jB,GAAI0D,EAAOxD,GAAIyD,IAGjD,SAAS5D,4BAAaD,GAC3B,SAAIA,EAAQ1H,KAAKgI,YAAaN,EAAQ1H,KAAKiI,OAItC,SAASrD,sBAAO6D,EAAeC,GACpC,MAAO,CACLR,MAAM,EACNtD,OAAQ6D,EAAgBC,GC1DrB,IAAMnnB,GAAK,kBACLwY,GAAO,mBAUb,SAAS0N,sBAAMC,GAAwB,IAAflX,EAAc,uDAAJ,GACvC,IAAKmX,6BAAaD,GAChB,MAAM,IAAIjoB,MAAM,+CAFyB,IAIrCosB,EAAarb,EAAbqb,IAAKrB,EAAQha,EAARga,IACXqB,GAAO5gB,KAAKwf,GAAK,IACjBD,GAAOvf,KAAKwf,GAAK,IACjBnrB,OAAOipB,OAAOb,EAAQzjB,KAAMymB,aAAoBhD,EAAQzjB,KAAM4nB,EAAKrB,IAG9D,SAAS7C,6BAAaD,GAC3B,SAAIA,EAAQ1H,KAAKgI,WAAcN,EAAQ1H,KAAKiI,OAIvC,SAASrD,uBAAO6D,EAAeC,GACpC,IAAIC,EAAUrpB,OAAOipB,OAAO,GAAIE,GAChC,IAAK,IAAMG,KAAKD,EACdA,EAAQC,IAAMF,EAASE,GAEzB,MAAO,CACLV,MAAM,EACNtD,OAAQ+D,GC7BL,IAAMpnB,GAAK,SACLwY,GAAO,UAEb,SAAS0N,aAAMC,GAA0B,IAAjBoE,EAAgB,uDAAH,EAK1CpE,EAAQzjB,KAAKmG,EAAIsd,EAAQzjB,KAAKmG,EAAEoQ,KAAI,SAACuR,GAAD,OAASA,EAAMD,KAG9C,SAASnE,sBACd,OAAO,EAGF,SAAS/C,cAAO6D,EAAeC,GACpC,MAAO,CACLR,MAAM,EACNtD,OAAQ6D,EAAgBC,GCxBrB,IAAMnnB,GAAK,cACLwY,GAAO,eAMb,SAAS0N,kBAAMC,EAASsE,GAC7B,IAAKrE,yBAAaD,GAChB,MAAM,IAAIjoB,MAAM,2CAGlB,IAKIoqB,EALAM,EAAuBzC,EAAQ0C,QAAQrpB,MACzC,SAACW,GAAD,MAAkB,kBAAXA,EAAEqY,MAA4BrY,EAAEslB,QAGrCqE,EAAS3D,EAAQ1H,KAAKuK,cAGxBV,EADEwB,EAAS,GAAKlB,EACAlf,KAAK6e,MAAMuB,GAEX,EAdiB,MAiBb3D,EAAQzjB,KAAtB2jB,EAjB2B,EAiB3BA,GAAIE,EAjBuB,EAiBvBA,GAAI1d,EAjBmB,EAiBnBA,EAEZkhB,EAAQ,IAAIvD,aAAaiE,GACzBT,EAAQ,IAAIxD,aAAaiE,GACzBC,EAAO,IAAIlE,aAAaiE,GAEtBloB,EAASmH,KAAKqa,IAAI0G,EAAMpE,EAAG9jB,QAEjCwnB,EAAMpB,IAAItC,EAAG/kB,MAAM,EAAGiB,EAAS+lB,IAC/B0B,EAAMrB,IAAIpC,EAAGjlB,MAAM,EAAGiB,EAAS+lB,IAC/BoC,EAAK/B,IAAI9f,EAAEvH,MAAM,EAAGiB,EAAS+lB,IAI7B,IAFA,IAAIqC,EAAO9hB,EAAE,GAAKA,EAAE,GAChB+hB,EAAW/hB,EAAEtG,EAAS+lB,EAAgB,GACjChmB,EAAIC,EAAS+lB,EAAehmB,EAAImoB,EAAMnoB,IAC7CsoB,GAAYD,EACZD,EAAKpoB,GAAKsoB,EAGRtC,EAAgB,GAAKA,EAAgBmC,IACvCV,EAAMpB,IAAItC,EAAG/kB,MAAM+kB,EAAG9jB,OAAS+lB,GAAgBmC,EAAOnC,GACtD0B,EAAMrB,IAAIpC,EAAGjlB,MAAM+kB,EAAG9jB,OAAS+lB,GAAgBmC,EAAOnC,IAGxDnC,EAAQzjB,KAAR,2BAAoByjB,EAAQzjB,MAAS,CAAE2jB,GAAI0D,EAAOxD,GAAIyD,EAAOnhB,EAAG6hB,IAG3D,SAAStE,yBAAaD,GAC3B,SAAIA,EAAQ1H,KAAKgI,YAAaN,EAAQ1H,KAAKiI,OAItC,SAASrD,mBAAOwH,EAAgB1D,GACrC,MAAO,CACLR,MAAM,EACNtD,OAAQ8D,GCrDL,IAAMnnB,GAAK,WACLwY,GAAO,aAEb,SAAS0N,sBAAM4E,GAA0B,IAAjBP,EAAgB,uDAAH,EAI1CO,EAAQpoB,KAAKqoB,MAAQR,EACrBO,EAAQpoB,KAAKsoB,MAAQT,EAGhB,SAASnE,+BACd,OAAO,EAGF,SAAS/C,uBAAO6D,EAAeC,GACpC,MAAO,CACLR,MAAM,EACNtD,OAAQ6D,EAAgBC,GClBrB,IAAMnnB,GAAK,WACLwY,GAAO,aAEb,SAAS0N,aAAM4E,GAA0B,IAAjBP,EAAgB,uDAAH,EAI1CO,EAAQpoB,KAAKuoB,MAAQV,EACrBO,EAAQpoB,KAAKwoB,MAAQX,EAGhB,SAASnE,sBACd,OAAO,EAGF,SAAS/C,cAAO6D,EAAeC,GACpC,MAAO,CACLR,MAAM,EACNtD,OAAQ6D,EAAgBC,GCZrB,IAAMgE,GAAU,CACrBC,WACAC,qBACAC,iBACAC,MACAC,kBACAC,sBACAC,SACAC,cACA3C,gBACA4C,WACAC,YCrBW5c,GAAU,CACrB6c,KAAM,CACJ9rB,GAAI,OACJ+rB,MAAO,OACPC,gBAAgB,EAChBC,UAAU,GAEZC,YAAa,CACXlsB,GAAI,cACJ+rB,MAAO,gBACPC,gBAAgB,EAChBC,UAAU,GAEZE,SAAU,CACRnsB,GAAI,WACJ+rB,MAAO,gBACPC,gBAAgB,EAChBC,UAAU,GAEZG,OAAQ,CACNpsB,GAAI,SACJ+rB,MAAO,YACPC,gBAAgB,EAChBC,UAAU,GAEZI,YAAa,CACXrsB,GAAI,cACJ+rB,MAAO,eACPC,gBAAgB,EAChBC,UAAU,GAEZK,MAAO,CACLtsB,GAAI,QACJ+rB,MAAO,6BACPC,gBAAgB,EAChBC,UAAU,GAEZM,cAAe,CACbvsB,GAAI,gBACJ+rB,MAAO,iBACPC,gBAAgB,EAChBC,UAAU,GAEZO,cAAe,CACbxsB,GAAI,gBACJ+rB,MAAO,6BACPC,gBAAgB,EAChBC,UAAU,GAEZN,YAAa,CACX3rB,GAAImrB,GAAQQ,YAAY3rB,GACxB+rB,MAAOZ,GAAQQ,YAAYnT,KAC3BwT,gBAAgB,EAChBC,UAAU,GAEZT,gBAAiB,CACfxrB,GAAImrB,GAAQK,gBAAgBxrB,GAC5B+rB,MAAM,GAAD,OAAKZ,GAAQK,gBAAgBhT,KAA7B,gBACLwT,gBAAgB,EAChBC,UAAU,GAEZQ,mBAAoB,CAClBzsB,GAAI,qBACJ+rB,MAAO,kCACPC,gBAAgB,EAChBC,UAAU,GAEZS,gBAAiB,CACf1sB,GAAI,kBACJ+rB,MAAO,0BACPC,gBAAgB,EAChBC,UAAU,GAGZU,UAAW,CACT3sB,GAAI,YACJ+rB,MAAO,aACPC,gBAAgB,EAChBC,UAAU,GAGZW,wBAAyB,CACvB5sB,GAAI,0BACJ+rB,MAAO,4BACPC,gBAAgB,EAChBC,UAAU,ICjFRtf,GACO,CACTkgB,gBAAiB,WACjB5rB,SAAU,WACV4L,IAAK,MACLG,KAAM,MACN8e,KAAM,QAIJgB,GAAa,CACjB7d,GAAQ6c,KAAK9rB,GACbiP,GAAQ0c,YAAY3rB,GACpBiP,GAAQid,YAAYlsB,GACpBiP,GAAQkd,SAASnsB,GACjBiP,GAAQuc,gBAAgBxrB,GACxBiP,GAAQwd,mBAAmBzsB,GAC3BiP,GAAQud,cAAcxsB,GACtBiP,GAAQmd,OAAOpsB,GACfiP,GAAQod,YAAYrsB,GACpBiP,GAAQ0d,UAAU3sB,GAClBiP,GAAQ2d,wBAAwB5sB,IAGrB+sB,GACR,EADQA,GAER,EAFQA,GAGP,EAGN,SAASC,QAAT,GAKI,IAJFC,EAIC,EAJDA,UACAC,EAGC,EAHDA,gBACOC,EAEN,EAFDlpB,MACQmpB,EACP,EADDlpB,OACC,EACqCgH,eAAhCjH,EADL,EACKA,MAAOC,EADZ,EACYA,OAAQmpB,EADpB,EACoBA,aADpB,EAE0CvuB,qBAAWgI,GAAhD0C,EAFL,EAEKA,OAAQC,EAFb,EAEaA,KAAMU,EAFnB,EAEmBA,OAAQD,EAF3B,EAE2BA,KAAMlD,EAFjC,EAEiCA,KAElC,IACG8lB,GAAWptB,SAAS2tB,IACZ,aAATrmB,IACCkmB,GACAA,EAAgB1jB,QAAUA,EAAS0jB,EAAgB1jB,QACnD0jB,EAAgB/iB,QAAUA,EAAS+iB,EAAgB/iB,SAClD+iB,EAAgBzjB,MAAqC,IAA7BC,KAAKgZ,KAAKjZ,EAAOD,GACvCC,EAAOyjB,EAAgBzjB,KACvBA,EAAOyjB,EAAgB1jB,UACxB0jB,EAAgBzjB,MAAqC,IAA7BC,KAAKgZ,KAAKxY,EAAOC,GACtCD,EAAOgjB,EAAgBhjB,KACvBA,EAAOgjB,EAAgB/iB,QAE7B,OAAO,KAGTlG,EAAQkpB,GAA0BlpB,EAElCC,EAASkpB,GAA4BlpB,EAErCuF,EACEyjB,EAAgBzjB,MAAQA,EAAOyjB,EAAgBzjB,KAC3CyjB,EAAgBzjB,KAChByjB,EAAgB1jB,QAAUC,EAAOyjB,EAAgB1jB,OACjD0jB,EAAgB1jB,OAChBC,EACNS,EACEgjB,EAAgBhjB,MAAQA,EAAOgjB,EAAgBhjB,KAC3CgjB,EAAgBhjB,KAChBgjB,EAAgB/iB,QAAUD,EAAOgjB,EAAgB/iB,OACjD+iB,EAAgB/iB,OAChBD,EAEN,IAAM+T,EACJgP,IAAcF,IAAgBE,IAAcF,IACvCtjB,EAAOD,GAAUvF,EAClB,EACNuF,EACEyjB,IAAcF,IAAgBE,IAAcF,GAAgBvjB,EAAS,EAEvE,IAAMuc,EACJkH,IAAcF,IAAgBE,IAAcF,IACvC7iB,EAAOC,GAAUjG,EAClB,EAGN,OAFAiG,EACE8iB,IAAcF,IAAgBE,IAAcF,GAAgB5iB,EAAS,EAErE,qBACEnJ,MAAK,2BACA2L,IADA,IAEHwB,UAAU,aAAD,OAAe3E,EAAf,eAA4BW,EAA5B,qBAA+C8T,EAA/C,YAAyD8H,EAAzD,KACTuH,WAAY,cAJhB,SAOE,qBAAKrpB,MAAOA,EAAOC,OAAQA,EAA3B,SACE,sBACE2E,EAAE,IACFC,EAAE,IACF7E,MAAOA,EACPC,OAAQA,EACRiX,KAAK,OACLha,QAAQ,YAOlB6rB,QAAQxiB,aAAe,CACrByiB,UAAWF,GACXG,gBAAiB,CACf1jB,OAAQ,EACRW,OAAQ,GAEVlG,MAAO,KACPC,OAAQ,MAGK8oB,eCpHTrgB,GAAS,CACb4gB,KAAM,CACJC,OAAQ,QACRC,cAAe,IACfC,eAAgB,aAChBC,YAAa,IACbL,WAAY,cAIVR,GAAa,CACjB7d,GAAQ6c,KAAK9rB,GACbiP,GAAQsd,cAAcvsB,GACtBiP,GAAQwd,mBAAmBzsB,GAC3BiP,GAAQmd,OAAOpsB,GACfiP,GAAQod,YAAYrsB,GACpBiP,GAAQkd,SAASnsB,GACjBiP,GAAQud,cAAcxsB,GACtBiP,GAAQ0d,UAAU3sB,GAClBiP,GAAQ2d,wBAAwB5sB,IA2DnB4tB,OAxDf,SAASA,mBAAoB,IAAD,EACsB1iB,eAAxChH,EADkB,EAClBA,OAAQD,EADU,EACVA,MAAOwN,EADG,EACHA,OAAQ4b,EADL,EACKA,aAC3BpsB,EAAWnC,qBAAW2L,GACpBojB,EAAa/uB,qBAAWgI,GAE9B,OACGgmB,GAAWptB,SAAS2tB,IACD,aAApBQ,EAAW7mB,OACV/F,GACDA,EAAS4H,EAAI5E,EAAQwN,EAAO3E,OAC5B7L,EAAS6H,EAAI5E,EAASuN,EAAO1E,SAC5B9I,IACAC,EAEM,KAGP,qBAEElD,MAAO,CACLssB,WAAY,YACZxb,OAAQ,YACR3D,UAAU,aAAD,QAAgBlK,EAAQhD,EAAS4H,EAAjC,gBACN3E,EAASjD,EAAS6H,EADZ,OAGT7H,SAAU,WACV4L,IAAK,EACLG,KAAM,EACN9L,cAAe,OACfkO,SAAU,UACVnL,MAAO,EAAIA,EACXC,OAAQ,EAAIA,GAdhB,SAiBE,sBAAKD,MAAO,EAAIA,EAAOC,OAAQ,EAAIA,EAAnC,UACE,sBACElD,MAAO2L,GAAO4gB,KACdO,GAAI7pB,EACJ8pB,GAAG,IACHC,GAAI/pB,EACJgqB,GAAa,EAAT/pB,GACA,iBAEN,sBACElD,MAAO2L,GAAO4gB,KACdO,GAAG,IACHC,GAAI7pB,EACJ8pB,GAAY,EAAR/pB,EACJgqB,GAAI/pB,GACA,uBA/BJ,c,UC7CJgqB,GAAe,I,QAAIC,GAEnBC,GAAU,CACdC,GAAI,YAACznB,EAAO0nB,GAAR,OAAeJ,GAAaG,GAAGznB,EAAO0nB,IAC1C3H,KAAM,cAAC/f,EAAO0nB,GAAR,OAAeJ,GAAavH,KAAK/f,EAAO0nB,IAC9CC,IAAK,aAAC3nB,EAAO0nB,GAAR,OAAeJ,GAAaK,IAAI3nB,EAAO0nB,IAC5CE,KAAM,cAAC5nB,EAAOnJ,GAAR,OAAoBywB,GAAaM,KAAK5nB,EAAOnJ,KAGrDM,OAAO0wB,OAAOL,IAECA,UCbf,SAASM,aAAT,GAAiD,IAAzB7lB,EAAwB,EAAxBA,EAAGC,EAAqB,EAArBA,EAAG6lB,EAAkB,EAAlBA,SAAUxT,EAAQ,EAARA,KACtC,OACE,sBACE7T,UAAU,gBACVuB,EAAGA,EACHC,EAAGA,EACHrI,QAASkuB,EACTC,iBAAe,OALjB,UAOE,sBAAMC,GAAG,IAAI5qB,MAAM,KAAKC,OAAO,KAAKiX,KAAMA,IAC1C,sBAAM2S,GAAG,IAAIE,GAAG,KAAKD,GAAG,IAAIE,GAAG,IAAIT,OAAO,QAAQG,YAAY,SAKpEe,aAAalkB,aAAe,CAC1BmkB,SAAU,2BAAM,MAChBxT,KAAM,UACNtS,EAAG,UACHC,EAAG,WAGU4lB,I,GAAAA,gBCZT/hB,GAAS4C,YAAH,8YA6DGuf,OAzCf,SAASA,gBAAiB,IAChBC,EAAkB7jB,eAAlB6jB,cAEA9Q,EAAWtS,WAAXsS,OACFzf,EAAW6M,cAEX2jB,EAAqBnvB,uBACzB,SAACG,GACCxB,EAAS,CAAEhB,KAAMsY,GAAuB9V,SAE1C,CAACxB,IAGH,OACEuwB,GACA/vB,MAAMC,QAAQ8vB,IACdA,EAAcxsB,OAAS,GACrB,2BACGwsB,EAAc9V,KAAI,SAACgW,GAAD,OACjB,kBAEE9gB,UAAS,oBAAe8P,IAASgR,EAAKtQ,IAA7B,OACTpP,IAAK5C,GAHP,UAKE,aAAC,GAAD,CACE9D,GAAI,GACJC,EAAG,GACH6lB,SAAU,2BAAMK,EAAmBC,EAAKjvB,OAE1C,qBACE6I,EAAE,IACF5E,MAAK,UAAKga,IAASgR,EAAKzrB,MAAQya,IAASgR,EAAKtQ,KAC9CrX,UAAU,gBAZP2nB,EAAKjvB,UClDhBkvB,GAAwB,CAC5BC,cAAc,EACdC,eAAgB,OAChBC,cAAc,EACdC,eAAgB,OAChBnT,MAAO,UACPwR,YAAa,GAGT4B,GAAqB,CACzBC,UAAU,EACVC,WAAY,OACZC,QAAQ,EACRC,SAAU,OACVR,cAAc,EACdC,eAAgB,OAChBC,cAAc,EACdC,eAAgB,QAGZM,GAAqB,CACzBC,gBAAgB,EAChBC,iBAAkB,IAClBC,eAAe,EACfC,gBAAiB,OACjBC,cAAc,EACdC,eAAgB,OAChBC,aAAa,EACbC,cAAe,OACfC,eAAe,EACfC,gBAAiB,UACjBC,eAAe,EACfC,gBAAiB,Q,+BC2JJC,I,MAAAA,GApLf,SAASA,UAAT,GAAkD,IAA7BjtB,EAA4B,EAA5BA,KAAMmb,EAAsB,EAAtBA,GAAI+R,EAAkB,EAAlBA,OAAQzW,EAAU,EAAVA,OAAU,EACd/O,eAAzBhH,EADuC,EACvCA,OAAQuN,EAD+B,EAC/BA,OAAQ4T,EADuB,EACvBA,KADuB,EAEOzd,oBAAS,GAFhB,mBAExC+oB,EAFwC,KAEnBC,EAFmB,OAGKhpB,oBAAS,GAHd,mBAGxCipB,EAHwC,KAGpBC,EAHoB,OAInBlpB,oBAAS,GAJU,mBAIxCmpB,EAJwC,KAIhCC,EAJgC,KAKzCC,EAAoBriB,iBAAO,MAC3BsiB,EAAmBtiB,iBAAO,MAExBqP,EAAWtS,WAAXsS,OAEFkT,EAAmBtxB,uBACvB,SAACM,GACCA,EAAEC,iBACFD,EAAEE,kBACFuwB,GAAuB,GAEnBF,GACFA,MAGJ,CAACA,IAEGU,EAAkBvxB,uBAAY,cAEjC,IACGwxB,EAAkBxxB,uBACtB,SAACM,GACCA,EAAEC,iBACFD,EAAEE,kBAEFuwB,GAAuB,GAEvB,IAAMU,EACK,QAATjM,EACI,CAACpH,IAASS,OAAOve,EAAEoxB,QAAS5S,GAC5B,CAACA,EAAIV,IAASS,OAAOve,EAAEoxB,SAe7BtX,EAZIqX,EAAO,GAAKA,EAAO,GACX,CACR9tB,KAAM8tB,EAAO,GACb3S,GAAI2S,EAAO,IAGH,CACR9tB,OACAmb,SAMN,CAACnb,EAAM6hB,EAAMpL,EAAQgE,EAAQU,IAGzB6S,EAAkB3xB,uBACtB,SAACM,GACCA,EAAEC,iBACFD,EAAEE,kBACFywB,GAAsB,GAElBJ,GACFA,MAGJ,CAACA,IAEGe,EAAiB5xB,uBAAY,cAEhC,IACG6xB,EAAiB7xB,uBACrB,SAACM,GACCA,EAAEC,iBACFD,EAAEE,kBAEFywB,GAAsB,GACtB,IAAMQ,EACK,QAATjM,EACI,CAAC7hB,EAAMya,IAASS,OAAOve,EAAEoxB,SACzB,CAACtT,IAASS,OAAOve,EAAEoxB,QAAS/tB,GAelCyW,EAZIqX,EAAO,GAAKA,EAAO,GACX,CACR9tB,KAAM8tB,EAAO,GACb3S,GAAI2S,EAAO,IAGH,CACR9tB,OACAmb,SAMN,CAACnb,EAAM6hB,EAAMpL,EAAQgE,EAAQU,IAGzBgT,EAA0B9xB,uBAAY,YAAkB,EAAfoI,UAE3C+oB,GAAU,KAEX,IACGY,EAAwB/xB,uBAAY,WACxCmxB,GAAU,KACT,IACG1T,EAAmBzd,uBAAY,YAA2B,IAAxBgyB,EAAuB,EAAvBA,OAAQ5pB,EAAe,EAAfA,SAE5C4pB,EAAO7wB,MAAM8Q,OADX7J,EACoB,YAEA,cAEvB,IAEH,OACE,aAAC,WAAD,WACE,aAAC,KAAD,CACE6pB,KAAK,IACLC,gBAAiB,CACflpB,EAAGoV,IAASza,GACZsF,EAAG,GAEL7H,SAAU,CACR4H,EAAGoV,IAASza,GACZsF,EAAG,GAEL+Y,MAAO,EACPmQ,OAAO,UACPC,QAASd,EACTT,OAAQU,EACRc,OAAQb,EACRxiB,QAASoiB,EAfX,SAiBE,qBACEtiB,IAAKsiB,EACL3pB,UAAWypB,EAAS,SAAW,GAC/B9sB,MAAO0sB,EAAsB,EAAI,EACjCxV,KAAK,MACLjX,OAAQA,EAASuN,EAAO5E,IACxB7L,MAAO,CAAEmxB,YAAaxB,EAAsB,EAAI,GAChDyB,mBAAoBT,EACpBU,iBAAkBT,EAClBrxB,aAAc+c,MAIlB,aAAC,KAAD,CACEwU,KAAK,IACLC,gBAAiB,CACflpB,EAAGoV,IAASU,GACZ7V,EAAG,GAEL7H,SAAU,CACR4H,EAAGoV,IAASU,GACZ7V,EAAG,GAELkpB,OAAO,UACPnQ,MAAO,EACPoQ,QAAST,EACTd,OAAQe,EACRS,OAAQR,EACR7iB,QAASqiB,EAfX,SAiBE,qBACEviB,IAAKuiB,EACL5pB,UAAWypB,EAAS,SAAW,GAC/B9sB,MAAO4sB,EAAqB,EAAI,EAChC1V,KAAK,MACLjX,OAAQA,EAASuN,EAAO5E,IACxB7L,MAAO,CAAEmxB,YAAatB,EAAqB,EAAI,GAC/CuB,mBAAoBT,EACpBU,iBAAkBT,EAClBrxB,aAAc+c,UCvKlBgV,GAAgB/iB,YAAH,wYAkBbgjB,GAAoBhjB,YAAH,oMA0FRijB,OA7Ef,SAASA,kBAAT,GAA8D,IAAjCC,EAAgC,EAAhCA,eAAgBC,EAAgB,EAAhBA,aAAgB,EAChCxnB,eAAnBhH,EADmD,EACnDA,OAAQuN,EAD2C,EAC3CA,OACRwM,EAAWtS,WAAXsS,OAEAje,EAAiB0yB,EAAjB1yB,GAAImsB,EAAauG,EAAbvG,SAEN5tB,EAAYQ,aAAa,CAACiB,GAAKlD,KAAME,UAGrC21B,EAAYj0B,mBAAQ,WACxB,OAAI+zB,EACKG,KAAUH,EAAe5pB,GAEzB,KAER,CAAC4pB,IAEEj0B,EAAW6M,cAEXwnB,EAAuBhzB,uBAC3B,SAACizB,GACCt0B,EAAS,CACPhB,KAAM4W,GACN1R,KAAK,2BAAMgwB,GAAiBI,OAGhC,CAACt0B,EAAUk0B,IAGPK,EAAwBlzB,uBAAY,WACxCtB,EAAUqB,SACT,CAACrB,IAEEy0B,EAA6BnzB,uBAAY,WAC7CtB,EAAUuB,SACT,CAACvB,IAEE00B,EAAKN,EAAU,GAAK1U,IAAS0U,EAAU,IAAM,EAC7C7E,EAAK6E,EAAU,GAAK1U,IAAS0U,EAAU,IAAM,EAEnD,OACE,aAAC,WAAD,UACE,kBACEpjB,IAAKhR,EAAUgB,SAAWgzB,GAAoBD,GAC9C/xB,aAAcwyB,EACdvyB,aAAcwyB,EAHhB,UAKE,qBACEpE,iBAAe,OACf/lB,EAAC,UAAKilB,GACNhlB,EAAE,IACF7E,MAAK,UAAKgvB,EAAKnF,GACf5pB,OAAQA,EAASuN,EAAO1E,OACxBzF,UAAU,cAGZ,qBACEuB,EAAGilB,EACHhlB,EAAG5E,EAASuN,EAAO1E,OAAS,GAC5BoO,KAAK,QACLna,MAAO,CAAEqb,SAAU,OAAQ6W,WAAY,QAJzC,cAMgBtN,IAAbuG,EAAyBA,EAAStM,QAAQ,GAAK,KAGlD,aAAC,GAAD,CACErc,KAAMkvB,EAAalvB,KACnBmb,GAAI+T,EAAa/T,GAEjB1E,OAAQ4Y,EACRjE,iBAAe,eCxBVuE,OAjFf,SAASA,SAAT,GASI,IARFT,EAQC,EARDA,aACA7pB,EAOC,EAPDA,EACAC,EAMC,EANDA,EACAsc,EAKC,EALDA,QACA7lB,EAIC,EAJDA,SACAmkB,EAGC,EAHDA,WACAqC,EAEC,EAFDA,OACA9H,EACC,EADDA,OAEQza,EAAakvB,EAAblvB,KAAMmb,EAAO+T,EAAP/T,GADb,EAE+B/W,qBAF/B,mBAEMukB,EAFN,KAEgBiH,EAFhB,KAIKC,EAAc7nB,iBAEd8nB,EAAmB50B,mBAAQ,WAAO,IAAD,EAIjC0iB,GAASiS,EAAa,gCAAkC,GAJvB,IAEnClX,aAFmC,MAE3B+S,GAAsB/S,MAFK,MAGnCwR,YAEF,MAAO,CAAExR,QAAOwR,iBALqB,MAGrBuB,GAAsBvB,YAHD,KAMpC,CAAC0F,IAEJ/zB,qBAAU,WACR,IAAMi0B,EAAiBC,aACrB,CAAE3qB,EAAGA,EAAGC,EAAGA,GACX,CACEtF,KAAMA,EACNmb,GAAIA,EACJ8U,SAAS,IAGbL,EAAYG,KACX,CAAC/vB,EAAMmb,EAAI9V,EAAGC,IAEjB,IAAM4qB,EAAW7zB,uBAAY,WAC3B,GAAIssB,GAAYpG,EAAQ,CACtB,IAAM4N,EAAaC,aAASzH,EAAU,CACpC3oB,KAAM4hB,EAAQ,GACdzG,GAAIyG,EAAQ,GACZsE,SAAU,IACVmK,UAAU,IAGRC,EAAI,YAAQ7V,IAAS0V,EAAW9qB,EAAE,IAA9B,YAAqCkd,EAAO4N,EAAW7qB,EAAE,KAMjE,OALAgrB,GAAQH,EAAW9qB,EAAEvH,MAAM,GAAG+hB,QAAO,SAAC0Q,EAAaC,EAAO1xB,GAExD,OADAyxB,GAAW,aAAU9V,IAAS+V,GAAnB,YAA6BjO,EAAO4N,EAAW7qB,EAAExG,EAAI,OAE/D,IAIH,MAAO,KAER,CAAC6pB,EAAUlO,EAAQ8H,EAAQX,IAE9B,OACE,eAAC,WAAD,WACE,sBACE9d,UAAU,OACVkmB,OAAQ8F,EAAiBnX,MACzBwR,YAAa2F,EAAiB3F,YAC9BxS,KAAK,OACLna,MAAO,CACL6rB,gBAAiB,aACjB1rB,QAAS5B,EAAW,EAAI,IAE1B6b,EAAGsY,MAIL,cAAC,GAAD,CACEhQ,WAAYA,EACZ+O,eAAgBtG,EAChBuG,aAAcA,EACd3M,OAAQA,QCVDkO,OAlEf,SAASA,kBAAmB,IAAD,EAUrB/oB,eARFka,EAFuB,EAEvBA,QACApH,EAHuB,EAGvBA,eACAtb,EAJuB,EAIvBA,KACAwB,EALuB,EAKvBA,OACAuN,EANuB,EAMvBA,OACA8T,EAPuB,EAOvBA,cACAN,EARuB,EAQvBA,kBACAiP,EATuB,EASvBA,aAEMjW,EAAWtS,WAAXsS,OAEF8H,EAASrnB,mBAAQ,WACrB,OAAIsf,GAAkBiH,EAAkBjH,EAAehe,IxBK3D,SAASm0B,kBAAkB72B,EAAOinB,GAAa,IACrCrgB,EAAqD5G,EAArD4G,OAAQuN,EAA6CnU,EAA7CmU,OAAQ8T,EAAqCjoB,EAArCioB,cAAeN,EAAsB3nB,EAAtB2nB,kBACjCO,EACJD,EAAcE,OAASF,EAAcG,QAAUxhB,EAAS,EAAIA,EAE9D,OAAO2f,aAAYoB,EAAkBV,GAAa,CAChDiB,GAAW/T,EAAO1E,OAAmB,GAAVyY,GAC3B/T,EAAO5E,MwBXEsnB,CACL,CAAEjwB,SAAQuN,SAAQ8T,gBAAeN,qBACjCjH,EAAehe,IAGV,OAER,CAACge,EAAgB9Z,EAAQ+gB,EAAmBxT,EAAQ8T,IAEjD6O,EAAY11B,mBAAQ,WACxB,IAAM21B,EAAW,SAAXA,SAAYr0B,GAChB,OAA0B,OAAnBge,GAEHhe,IAAOge,EAAehe,IAK5B,OACE0C,GACAA,EAAK,IACLA,EACGjB,QACC,SAAC2Z,GAAD,OAC0B,IAAxBA,EAAElO,QAAQonB,YACsB,IAAhClZ,EAAElO,QAAQqnB,qBAEbtb,KACC,SAACub,GAAD,OACEA,EAASC,WACTD,EAASC,UAAUC,QACnBF,EAASC,UAAUC,OAAOzb,KAAI,SAACkT,GAAD,OAC5B,cAAC,GAAD,CAEEzI,WAAY8Q,EAASx0B,GACrB0yB,aAAcvG,EACdtjB,EAAG2rB,EAAS9xB,KAAKmG,EACjBC,EAAG0rB,EAAS9xB,KAAKoG,EACjBvJ,SAAU80B,EAASG,EAASx0B,IAC5BolB,QAASA,EACTW,OAAQA,EACR9H,OAAQA,GARHkO,EAASnsB,YAazB,CAACge,EAAgBtb,EAAMub,EAAQ8H,EAAQX,IAE1C,OAAO,mBAAGuP,SAAQ,eAAUT,EAAV,kBAAX,SAAoDE,KCF9CQ,OA7Df,SAASA,KAAT,GAA6C,IAA7BlyB,EAA4B,EAA5BA,KAAM1C,EAAsB,EAAtBA,GAAIkN,EAAkB,EAAlBA,QAASsR,EAAS,EAATA,MAAS,EACStT,eAA3Cka,EADkC,EAClCA,QAASpH,EADyB,EACzBA,eAAgBuH,EADS,EACTA,cAC3B8N,EAAc7nB,iBAFsB,EAGfG,WAAnBsS,EAHkC,EAGlCA,OAAQ8H,EAH0B,EAG1BA,OAEVxmB,EAAWb,mBAAQ,WACvB,OAA0B,OAAnBsf,GAEHhe,IAAOge,EAAehe,KAGzB,CAACge,EAAgBhe,IAEd60B,EAASn2B,mBAAQ,WACrB,OAAO6mB,EAAcE,MACjBF,EAAcG,QACZlH,EAAQ+G,EAAc1nB,MAExB,IACH,CAAC2gB,EAAO+G,EAAcE,KAAMF,EAAcG,QAASH,EAAc1nB,QAE9Di3B,EAAQp2B,mBAAQ,WACpB,IAAMq2B,EAAU9W,IACV+W,EAAUjP,EAAO/lB,GACvB,IAAQ,OAAJ0C,QAAI,IAAJA,OAAA,EAAAA,EAAMmG,KAAN,OAAWnG,QAAX,IAAWA,OAAX,EAAWA,EAAMoG,IAAKisB,EAAQ,GAAI,CACpC,IAAMpB,EAAaC,aACjB,CAAE/qB,EAAGnG,EAAKmG,EAAGC,EAAGpG,EAAKoG,GACrB,CACEtF,KAAM4hB,EAAQ,GACdzG,GAAIyG,EAAQ,KAIZ0O,EAAI,YAAQiB,EAAQpB,EAAW9qB,EAAE,IAA7B,YAAoCmsB,EAAQrB,EAAW7qB,EAAE,IAAzD,KAKR,OAJAgrB,GAAQH,EAAW9qB,EAAEvH,MAAM,GAAG+hB,QAAO,SAAC0Q,EAAaC,EAAO1xB,GAExD,OADAyxB,GAAW,aAAUgB,EAAQf,GAAlB,YAA4BgB,EAAQrB,EAAW7qB,EAAExG,EAAI,OAE/D,IAGH,MAAO,KAER,CAACtC,EAAIie,EAAQ8H,EAAQrjB,EAAM0iB,IAE9B,OACE,sBACE9d,UAAU,OAEVkmB,OAAQtgB,EAAQiP,MAChBhB,KAAK,OACLna,MAAO,CACLG,QAAS5B,EACL,EACA01B,IAAI5B,EAAa,wCAAyC,KAEhEjY,EAAG0Z,EACH3mB,UAAS,uBAAkB0mB,EAAlB,MATJ70B,IChCIk1B,OAnBf,SAASA,cAAe,IAAD,EACoBhqB,eAAjCxI,EADa,EACbA,KAAMyyB,EADO,EACPA,SAAUjB,EADH,EACGA,aAElBkB,EAAQD,GAAsBzyB,EAEpC,OACE,mBAAGiyB,SAAQ,eAAUT,EAAV,kBAAX,SACGkB,GACCA,EACG3zB,QACC,SAAC2Z,GAAD,OAC0B,IAAxBA,EAAElO,QAAQonB,YACsB,IAAhClZ,EAAElO,QAAQqnB,qBAEbtb,KAAI,SAACmC,EAAG9Y,GAAJ,OAAU,cAAC,GAAD,2BAAqB8Y,GAArB,IAAwBoD,MAAOlc,IAApB8Y,EAAEpb,U,qBCJ/B,SAASq1B,yBAAyBhV,GACvC,IAAMgT,EAAc7nB,iBACd8pB,EAAetU,IAAUqS,EAAD,0BAAyC,CACrEkC,IAAK,MACLC,GAAI,QAGAC,EAAY,SAAZA,UAAaC,GAAD,OAAO,SACvB73B,GAII,IAHJ83B,EAGG,uDAHS,MACZC,EAEG,uDAFM,GACTC,EACG,uDADM,GAET,OACED,EACAE,KAAQC,OAAOl4B,IAAQm4B,OACrBhV,IAAUsU,EAAD,UAAkBI,EAAEjd,cAApB,YAAqCkd,GAAa,QAE7DE,IAIJ,GAAKxV,EAAL,CAIA,GAAuB,kBAAZA,EACT,OAAOoV,EAAUpV,GACZ,GAAIrhB,MAAMC,QAAQohB,GACvB,OAAOA,EAAQpH,KAAI,SAACyc,GAAD,OAAOD,EAAUC,MAEpC,MAAMx3B,MAAM,6CAOT,SAAS+3B,oBAAoBp4B,GAElC,IAAMq4B,GADNr4B,EAAQwB,OAAOxB,GAAOs4B,QACEvd,YAAY,KACpC,OAAOsd,EAAY,EAAIr4B,EAAM8a,OAAOud,GAAWvR,MAAM,IAAIpiB,OAAS,EAAI,EAGzD6zB,I,GAAAA,GApDf,SAASA,aAAav4B,EAAOm4B,GAAmC,IAA3BJ,EAA0B,uDAAjB,GAAIC,EAAa,uDAAJ,GACzD,OAAOD,EAASE,KAAQj4B,GAAOm4B,OAAOA,GAAUH,GCU5ClpB,GAAS4C,YAAH,4nDAkPG8mB,OAvKf,SAASA,aAAT,GASI,IARFr2B,EAQC,EARDA,GACA6I,EAOC,EAPDA,EACAC,EAMC,EANDA,EACA4Z,EAKC,EALDA,KACA7kB,EAIC,EAJDA,MACAse,EAGC,EAHDA,MACA5c,EAEC,EAFDA,SACA8gB,EACC,EADDA,QAEMiW,EAAU1nB,mBADf,EAEmChH,oBAAS,GAF5C,mBAEM2uB,EAFN,KAEkBC,EAFlB,OAG0B5uB,mBAAS/J,GAHnC,mBAGM44B,EAHN,KAGc/V,EAHd,OAIyC9Y,mBAAS,CAAE3D,MAAO,EAAGC,OAAQ,IAJtE,mBAIMwyB,EAJN,KAIqBC,EAJrB,KAKKX,EAASX,yBAAyBhV,GAClC9hB,EAAYQ,aAAa,CAACiB,GAAKlD,KAAMC,MAErCyB,EAAW6M,cAEXurB,EAAqB/2B,uBACzB,SAACM,GAAD,OAAO3B,EAAS,CAAEhB,KAAMiV,GAAgB8X,WAAYpqB,EAAEoqB,eACtD,CAAC/rB,IAGHye,2BAAgB,WACd,IAAM4Z,EAAUP,EAAQjmB,QAAQymB,UAChCH,EAAiB,CAAE1yB,MAAO4yB,EAAQ5yB,MAAOC,OAAQ2yB,EAAQ3yB,WACxD,CAACqyB,IAEJj3B,qBAAU,WACRohB,EAAS7iB,KACR,CAACA,IAEJ,IAAMk5B,EAAgBl3B,uBACpB,SAAC+G,GACC,GAAkB,UAAdA,EAAMnH,IAAiB,CACzB,IAAM0nB,EAAWmC,WAAW1iB,EAAMirB,OAAOh0B,OACnCm5B,EAAW1N,WAAWzrB,GACtB0sB,EAAajB,WAAW1iB,EAAMirB,OAAOh0B,OAASyrB,WAAWzrB,GAE/D+4B,EAAmB,CACjB52B,KACAnC,MAAOspB,EACP6P,SAAUA,EACVzM,WAAYA,IAGd3jB,EAAMirB,OAAOoF,OACbT,GAAc,QACa,KAAlB5vB,EAAMswB,UACfxW,EAAS7iB,GACT+I,EAAMirB,OAAOoF,OACbT,GAAc,MAGlB,CAAC34B,EAAO+4B,EAAoB52B,IAGxBm3B,EAAet3B,uBAAY,SAAC+G,GAChC8Z,EAAS9Z,EAAMirB,OAAOh0B,SACrB,IAEGu5B,EAA2Bv3B,uBAAY,SAACM,GAI5C,OAHAA,EAAEC,iBACFD,EAAEE,kBACFm2B,GAAc,IACP,IACN,IAEGzD,EAAwBlzB,uBAAY,WACxCtB,EAAUqB,SACT,CAACrB,IAEEy0B,EAA6BnzB,uBAAY,WAC7CtB,EAAUuB,SACT,CAACvB,IAEE4oB,EAAWzoB,mBAAQ,kBAAO63B,EAAa14B,EAAQm4B,EAAOn4B,KAAS,CACnEm4B,EACAO,EACA14B,IAEIm5B,EAAWt4B,mBAAQ,kBAAO63B,EAAaE,EAAST,EAAOS,KAAU,CACrEA,EACAT,EACAO,IAGF,OACE,aAAC,WAAD,WACE,aAAC,IAAD,CAAQ5pB,OAAQA,KAChB,kBACE3M,GAAIA,EACJgB,MAAO,CAAEq2B,QAAS,QAClBlpB,UAAS,oBAAetF,EAAf,aAAqBC,EAArB,KACTvI,aAAcwyB,EACdvyB,aAAcwyB,EALhB,UAQE,qBACElF,GAAG,IACHE,GAAG,IACHD,IAAc,IAAVrL,EAAc,GAAK,EACvBuL,IAAc,IAAVvL,EAAc,IAAM,GACxB8K,OAAQrR,EACRwR,YAAapvB,EAAUgB,SAAW,MAAQ,QAE5C,qBACEoP,IAAK2nB,EACLhvB,UAAU,aACVuB,EAAE,IACFC,GAAa,IAAV4Z,EAAc,IAAM,GACvB4U,GAAG,IACH1N,GAAG,SACHzO,KAAK,cACLkB,SAAS,OACT6W,WAAW,MACXlyB,MAAO,CACLC,SAAU,YAXd,SAcGkmB,IAEH,8BACEte,EAAE,IACFC,GAAa,IAAV4Z,EAAc,IAAM,GACvB4U,GAAG,QACH1N,GAAG,SACH3lB,MAAOyyB,EAAczyB,MAAQ,GAC7BC,OAAO,OACP0qB,iBAAe,OAPjB,SASE,oBACE5tB,MAAO,CACLiD,MAAOyyB,EAAczyB,MAAQ,GAC7BC,OAAQ,OACRqzB,aAAc,GAEhBtc,MAAM,+BANR,SAQE,sBACExa,QAAS22B,EACT9vB,UACEivB,EACI,gCACA,4BAENv1B,MAAO,CACLiD,MAAO,UACPuzB,OAAQjB,EAAU,oBAAgBpa,GAAhB,IAClBhb,QAAS5B,EAAW,EAAI,GACxBmS,WAAY,OACZyK,MAAOA,GAETte,MAAOm5B,EACPS,UAAWV,EACXW,SAAUP,EACV35B,KAAK,SACLmE,UAAWpC,eC7JVo4B,I,MAAAA,GAtFf,SAASA,iBAAkB,IAAD,EACsCzsB,eAAtDxI,EADgB,EAChBA,KAAMsb,EADU,EACVA,eAAgBuH,EADN,EACMA,cAAe2O,EADrB,EACqBA,aADrB,EAEGvoB,WAAnBsS,EAFgB,EAEhBA,OAAQ8H,EAFQ,EAERA,OAEV6R,EAAQl5B,mBAAQ,WACpB,IAAMm5B,EAAmB,SAAnBA,iBAAoB73B,GACxB,IAAMsC,EAAII,EAAKo1B,WAAU,SAAC1c,GAAD,OAAOA,EAAEpb,KAAOA,KACzC,OAAOulB,EAAcE,MACjBF,EAAcG,SACXpjB,EAAI,GAAKijB,EAAc1nB,MAE1B,GAgBN,OACE6E,GAdiB,SAAbq1B,aACJ,IAAM3C,EAAK,aAAO1yB,GAClB,OAAOsb,EACHoX,EAAM4C,MAAK,SAAUnvB,EAAGC,GACtB,OAAOD,EAAE7I,KAAOge,EAAehe,GAC3B,EACA8I,EAAE9I,KAAOge,EAAehe,IACvB,EACD,KAENo1B,EAKJ2C,GACGt2B,QACC,SAAC2Z,GAAD,OAC0B,IAAxBA,EAAElO,QAAQonB,YACsB,IAAhClZ,EAAElO,QAAQqnB,qBAEbtb,KAAI,SAACmC,GACJ,OACEA,EAAE6c,OACF7c,EAAE6c,MAAMvD,QACRtZ,EAAElO,QAAQgrB,uBACR,mBAEE/pB,UAAS,uBAAkB0pB,EAAiBzc,EAAEpb,IAArC,KAFX,SAIGob,EAAE6c,MAAMvD,OAAOzb,KAAI,gBAAGkf,EAAH,EAAGA,MAAOC,EAAV,EAAUA,UAAWp4B,EAArB,EAAqBA,GAArB,OAClB,cAAC,GAAD,CAEE6I,EAAGoV,IAASka,GACZrvB,EAAGid,EAAO3K,EAAEpb,GAAT+lB,CAAaqS,GAAa,EAC7B1V,KAAMhZ,KAAKgZ,KAAK0V,GAChBp4B,GAAIA,EACJ0jB,WAAYtI,EAAEpb,GACdnC,MAAOs6B,EACPhc,MAAM,UACNkE,QAASjF,EAAEqD,KAAK4B,QAChB9gB,SACoB,MAAlBye,GAEIA,EAAehe,KAAOob,EAAEpb,IAZzBA,OALJob,EAAEpb,SA4BlB,CACD0C,EACA6iB,EAAcE,KACdF,EAAcG,QACdH,EAAc1nB,MACdmgB,EACAC,EACA8H,IAGF,OACE,mBAAGze,UAAU,QAAQqtB,SAAQ,eAAUT,EAAV,kBAA7B,SACG0D,K,mBC/EDS,GAAa9oB,YAAH,mMAaV+oB,GAAa/oB,YAAH,iRAiBhB,SAASgpB,MAAT,GAAiD,IAAhCxM,EAA+B,EAA/BA,MAAOnsB,EAAwB,EAAxBA,KAAM44B,EAAkB,EAAlBA,SAAUnT,EAAQ,EAARA,KAAQ,EACHna,eAAnCka,EADsC,EACtCA,QAASlhB,EAD6B,EAC7BA,OAAQD,EADqB,EACrBA,MAAOwN,EADc,EACdA,OACxBwM,EAAWtS,WAAXsS,OAEFwa,EAAU7pB,mBACV8pB,EAAU9pB,mBAEhBmd,EAAQA,IAAyB,QAAT1G,EAAiB,eAAY,YAErD/lB,qBAAU,WACR,IAAMuqB,EAAQ+I,OAAgB+F,MAAM,GAAGC,WAAWhG,KAAU,MACtDiG,EAAOjG,OAEV+F,MAAM,IACNG,WAAW50B,EAASuN,EAAO5E,IAAM4E,EAAO1E,SACxC6rB,WAAW,IACVh5B,GAAQqe,IACV2U,KAAU6F,EAAQpoB,SAAS9O,KAAKsoB,EAAMhI,MAAM5D,IAASqG,OAAOc,KAC5DwN,KAAU8F,EAAQroB,SAAS9O,KAAKs3B,EAAKhX,MAAM5D,IAASqG,OAAOc,QAE5D,CAAClhB,EAAQuN,EAAO1E,OAAQ0E,EAAO5E,IAAKoR,EAAQre,EAAMwlB,IAErD,IAAM2T,EAAOr6B,mBACX,kBACEkB,IACS,IAATA,GACE,kBACE0H,UAAU,IACViI,IAAK8oB,GACLlqB,UAAS,sBAAiBjK,EAASuN,EAAO1E,OAAjC,KACT4B,IAAK8pB,EAJP,SAME,qBAAMtd,KAAK,OAAOtS,EAAG5E,EAAQ,GAAI6E,EAAE,KAAKwuB,GAAG,SAAS0B,WAAW,MAA/D,SACGjN,QAKT,CAAC7nB,EAAQ6nB,EAAOta,EAAO1E,OAAQnN,EAAMqE,IAGjCg1B,EAAOv6B,mBACX,kBACE85B,IACa,IAAbA,GACE,kBACEjpB,IAAK+oB,GACLhxB,UAAU,OACVqH,IAAK+pB,EACLvqB,UAAS,sBAAiBjK,EAASuN,EAAO1E,OAAjC,SAIf,CAACyrB,EAAUt0B,EAAQuN,EAAO1E,SAE5B,OAAK9I,GAAUC,GAAW+Z,EAKxB,6BACG8a,EACAE,KANI,KAWXV,MAAMW,UAAY,CAChBV,SAAUW,KAAUC,KACpBx5B,KAAMu5B,KAAUC,KAChBrN,MAAOoN,KAAUE,QAGnBd,MAAM/tB,aAAe,CACnBguB,UAAU,EACV54B,MAAM,EACNmsB,MAAO,IAGMwM,aC/FAe,I,MAAAA,GAnBf,SAASA,qBAAqBC,GAC5B,IAAMvqB,EAAU,SAAVA,QAAW3Q,GAAW,IAAD,EAC4B6M,eAA7CiY,EADiB,EACjBA,UAAWqW,EADM,EACNA,gBAAiBtF,EADX,EACWA,aAC5BuF,EAA0Bp7B,EAA1Bo7B,aAAiBC,EAFA,aAESr7B,EAFT,kBAIzB,OACE,cAACk7B,EAAD,2BACMG,GADN,IAEEvW,UAAWA,EACXqW,gBAAiBA,EACjBtF,aAAcA,EACdvlB,IAAK8qB,MAIX,OAAOE,sBAAW,SAACt7B,EAAOsQ,GACxB,OAAO,cAACK,EAAD,2BAAa3Q,GAAb,IAAoBo7B,aAAc9qB,SCNvC2jB,GAAgB/iB,YAAH,qTAcbgjB,GAAoBhjB,YAAH,0QAuERqqB,OAvDf,SAASA,cAAT,GAAkD,IAAzBC,EAAwB,EAAxBA,UAAWC,EAAa,EAAbA,UAC1Bt2B,EAAaq2B,EAAbr2B,KAAMmb,EAAOkb,EAAPlb,GACRpgB,EAAYQ,aAAa,CAAC+6B,IACxB7b,EAAWtS,WAAXsS,OACFzf,EAAW6M,cAEX0uB,EAAgBl6B,uBAAY,WAChCrB,EAAS,CAAEhB,KAAM0Z,GAA8B8iB,OAAQF,MACtD,CAACA,EAAWt7B,IAETq0B,EAAuBhzB,uBAC3B,SAACizB,GACCt0B,EAAS,CACPhB,KAAM2Z,GACN1Z,QAAQ,uCAAMo8B,GAAc/G,GAArB,IAA8BgH,kBAGzC,CAACA,EAAWt7B,EAAUq7B,IAGxB,OACE,4CACMt7B,EAAU+B,SADhB,IAEEiP,IAAKhR,EAAUgB,SAAWgzB,GAAoBD,GAFhD,UAIE,kBAAGnkB,UAAS,oBAAe8P,IAASU,GAAxB,QAAZ,UACE,qBACE9V,EAAE,IACF5E,MAAOga,IAASza,GAAQya,IAASU,GACjCza,OAAO,IACPoD,UAAU,aACV6T,KAAK,UAEP,qBACE6d,WAAW,SACXnwB,GAAIoV,IAASza,GAAQya,IAASU,IAAO,EACrC7V,EAAE,KACFuT,SAAS,KACTlB,KAAK,MACL+X,WAAW,SACXf,YAAa5zB,EAAUgB,SAAW,EAAI,GAPxC,SASGu6B,OAGL,aAAC,GAAD,CACEt2B,KAAMq2B,EAAUr2B,KAChBmb,GAAIkb,EAAUlb,GACd1E,OAAQ4Y,IAEV,aAAC,GAAD,CAAchqB,EAAGoV,IAASU,GAAM,GAAI7V,EAAG,GAAI6lB,SAAUoL,SCxF3D,SAASE,oBAAT,GAA4E,IAA7C9W,EAA4C,EAA5CA,UAAWqW,EAAiC,EAAjCA,gBAAiBtF,EAAgB,EAAhBA,aACnDgG,EAAUx7B,mBAAQ,WAMtB,OAHI86B,EAAgBrW,IAAc,CAChClU,QAAS,CAAEirB,QAAS,MAFpBjrB,QAAWirB,UAKZ,CAAC/W,EAAWqW,IAETW,EAASz7B,mBAAQ,WACrB,OAAOX,OAAOC,KAAKk8B,GAASjhB,KAAI,SAACxZ,GAAD,OAASA,IAAK,MAC7C,CAACy6B,IAEJ,OAAKC,GAA4B,IAAlBA,EAAO53B,OAKpB,mBAAGoyB,SAAQ,eAAUT,EAAV,kBAAX,SACGiG,EAAOlhB,KAAI,SAAC6gB,GAAD,OACV,cAAC,GAAD,CAEEA,UAAWA,EACXD,UAAWK,EAAQJ,IAFdA,QAPJ,KAgBIR,UAAqB3b,eAAKsc,sBC4B1BG,OA5Df,SAASA,cAAcb,GACrB,IAAMvqB,EAAU,SAAVA,QAAW3Q,GAAW,IAAD,EAUrB6M,eARFxI,EAFuB,EAEvBA,KACAsb,EAHuB,EAGvBA,eACAoH,EAJuB,EAIvBA,QACAjC,EALuB,EAKvBA,UACAkX,EANuB,EAMvBA,UACA3V,EAPuB,EAOvBA,kBACAwP,EARuB,EAQvBA,aACA7G,EATuB,EASvBA,aAEIgG,EAAc7nB,iBAXK,EAa0B9M,mBAAQ,WACzD,OAAIgE,GAAQsb,GAAkBA,EAAehe,GAC7B0C,EAAK43B,MAAK,SAACrX,GAAD,OAAWA,EAAMjjB,KAAOge,EAAehe,OAAO,CACpEm6B,OAAQ,GACRtxB,EAAG,GACHC,EAAG,GACH2V,KAAM,IAIH,KACN,CAACT,EAAgBtb,IAxBK,IAajBy3B,cAbiB,MAaR,GAbQ,MAaJtxB,SAbI,MAaA,GAbA,MAaIC,SAbJ,MAaQ,GAbR,MAaY2V,YAbZ,MAamB,GAbnB,EA0BnB4B,EAAU3hB,mBAAQ,WACtB,OAAIgmB,GAAqB3mB,OAAOC,KAAK0mB,GAAmBniB,OAAS,EACxDxE,OAAOC,KAAK0mB,GAEd,OACN,CAACA,IAEI+U,EAA0Bp7B,EAA1Bo7B,aAAiBC,EAjCA,aAiCSr7B,EAjCT,kBAkCzB,OACE,cAACk7B,EAAD,2BACMG,GADN,IAEES,OAAQA,EACRtxB,EAAGA,EACHC,EAAGA,EACH2V,KAAMA,EACN2G,QAASA,EACTiO,YAAaA,EACblQ,UAAWA,EACXkX,UAAWA,EACXha,QAASA,EACT6T,aAAcA,EACd7G,aAAcA,EACd1e,IAAK8qB,MAKX,OAAO9b,eACLgc,sBAAW,SAACt7B,EAAOsQ,GACjB,OAAO,cAACK,EAAD,2BAAa3Q,GAAb,IAAoBo7B,aAAc9qB,UC7DzC4rB,GAAc,CAClB,CACE96B,IAAK,SACLssB,MAAO,SACPluB,MAAO,UAET,CACE4B,IAAK,YACLssB,MAAO,YACPluB,MAAO,aAET,CACE4B,IAAK,UACLssB,MAAO,UACPluB,MAAO,WAET,CACE4B,IAAK,WACLssB,MAAO,WACPluB,MAAO,YAET,CACE4B,IAAK,WACLssB,MAAO,WACPluB,MAAO,YAET,CACE4B,IAAK,KACLssB,MAAO,KACPluB,MAAO,MAET,CACE4B,IAAK,KACLssB,MAAO,KACPluB,MAAO,MAET,CACE4B,IAAK,KACLssB,MAAO,KACPluB,MAAO,OAIL28B,GAAuB,CAAC,UACxBC,GAAsB,SAAtBA,GAAuC,QCjCvCC,GAAiB,SAAjBA,eAAkBz4B,GACtB,OAVgB,SAAZ04B,UAAa14B,GACjB,MAAO,GAAG24B,OACR34B,EAAM44B,OAAS,GACf54B,EAAM64B,OACF74B,EAAM64B,OAAO7hB,KAAI,SAAC8hB,GAAD,OAAaA,EAAQF,OAAS,MAAIG,OACnD,IAKCL,CAAU14B,GAAOM,QAkBpB04B,GAAS,SAATA,OAAUh5B,EAAOi5B,EAAgBC,GAYrC,YAXuBvV,IAAnBsV,GACqB,IAAnBA,SACKj5B,EAAM44B,WACYjV,IAAhBuV,UACFl5B,EAAM64B,OAAOK,GAAaN,MAbnB,SAAdO,YAAen5B,UACZA,EAAM44B,MACb54B,EAAM64B,OAAOv0B,SAAQ,SAACw0B,UACbA,EAAQF,gBAEV54B,EAAMo5B,YAWXD,CAAYn5B,GAvBO,SAAjBq5B,eAAkBr5B,GACtBA,EAAMo5B,YAAcX,GAAez4B,GACT,IAAtBA,EAAMo5B,oBACDp5B,EAAMo5B,YAsBfC,CAAer5B,GAERA,GAWHs5B,GAAiB,SAAjBA,eAAkBt5B,GACtB,OAAOA,EAAMu5B,OAASf,IASlBgB,GAAyB,SAAzBA,uBAA0BC,EAAgBvB,GAC9C,IAAMwB,EAAMxB,EAAO9W,QAAO,SAACC,EAAKrhB,GAK9B,OAJAqhB,EAAIlkB,KAAK6C,EAAMjC,IACXiC,EAAM64B,QACRxX,EAAIsX,OAAO34B,EAAM64B,OAAO7hB,KAAI,SAAC6hB,GAAD,OAAYA,EAAO96B,KAAI,KAE9CsjB,IACN,IAEHoY,EAAel9B,SAAS,CACtBhB,KAAM,aACNC,QAAS,CAAEuC,GAAI27B,EAAK7J,KAAM,QCjExB8J,GAAoBx+B,0BAE1B,SAASy+B,kBAAkBv+B,EAAOC,GAChC,OAAQA,EAAOC,MACb,IAAK,MACH,IAAMG,EAAQ,2BACTL,GADS,IAEZw+B,WAAW,eAAMx+B,EAAMw+B,cAsBzB,YApBkDlW,IAA9CjoB,EAASm+B,WAAWv+B,EAAOE,QAAQuC,GAAG,MACxCrC,EAASm+B,WAAWv+B,EAAOE,QAAQuC,GAAG,IAAM,SAI5C4lB,IADAjoB,EAASm+B,WAAWv+B,EAAOE,QAAQuC,GAAG,IAAIzC,EAAOE,QAAQq0B,QAGzDn0B,EAASm+B,WAAWv+B,EAAOE,QAAQuC,GAAG,IAAIzC,EAAOE,QAAQq0B,MAAQ,IAIhEn0B,EAASm+B,WAAWv+B,EAAOE,QAAQuC,GAAG,IACrCzC,EAAOE,QAAQq0B,MACfpyB,SAASnC,EAAOE,QAAQuC,GAAG,KAE7BrC,EAASm+B,WAAWv+B,EAAOE,QAAQuC,GAAG,IAAIzC,EAAOE,QAAQq0B,MAAM1yB,KAC7D7B,EAAOE,QAAQuC,GAAG,IAIfrC,EAET,IAAK,SACH,IAAMA,EAAQ,2BACTL,GADS,IAEZw+B,WAAW,eAAMx+B,EAAMw+B,cA0BzB,YAvBgDlW,IAA9CjoB,EAASm+B,WAAWv+B,EAAOE,QAAQuC,GAAG,UAEpC4lB,IADFjoB,EAASm+B,WAAWv+B,EAAOE,QAAQuC,GAAG,IAAIzC,EAAOE,QAAQq0B,QAGzDn0B,EAASm+B,WAAWv+B,EAAOE,QAAQuC,GAAG,IACpCzC,EAAOE,QAAQq0B,MACbn0B,EAASm+B,WAAWv+B,EAAOE,QAAQuC,GAAG,IACxCzC,EAAOE,QAAQq0B,MACfrwB,QAAO,SAACs6B,GAAD,OAASA,IAAQx+B,EAAOE,QAAQuC,GAAG,MAI5B,IADdrC,EAASm+B,WAAWv+B,EAAOE,QAAQuC,GAAG,IAAIzC,EAAOE,QAAQq0B,MACtDvvB,eAEI5E,EAASm+B,WAAWv+B,EAAOE,QAAQuC,GAAG,IAAIzC,EAAOE,QAAQq0B,MAGE,IAAlE/zB,OAAOC,KAAKL,EAASm+B,WAAWv+B,EAAOE,QAAQuC,GAAG,KAAKuC,eAEhD5E,EAASm+B,WAAWv+B,EAAOE,QAAQuC,GAAG,KAI1CrC,EAET,IAAK,aACH,IAAMA,EAAQ,2BACTL,GADS,IAEZw+B,WAAW,eAAMx+B,EAAMw+B,cAezB,OAZAv+B,EAAOE,QAAQuC,GAAGuG,SAAQ,SAACw1B,QAEMnW,IAA7BjoB,EAASm+B,WAAWC,SAC8BnW,IAAlDjoB,EAASm+B,WAAWC,GAAKx+B,EAAOE,QAAQq0B,eAEjCn0B,EAASm+B,WAAWC,GAAKx+B,EAAOE,QAAQq0B,MACM,IAAjD/zB,OAAOC,KAAKL,EAASm+B,WAAWC,IAAMx5B,eACjC5E,EAASm+B,WAAWC,OAK1Bp+B,EAET,IAAK,gBACH,OAAO,2BACFL,GADL,IAEEiC,cACwBqmB,IAAtBroB,EAAOE,QAAQuC,SAA4C4lB,IAAxBroB,EAAOE,QAAQq0B,KACpDkK,SAAUz+B,EAAOE,QAAQuC,GACzBi8B,WAAY1+B,EAAOE,QAAQq0B,OAG/B,IAAK,kBACH,OAAO,2BACFx0B,GADL,IAEE4+B,eAAiCtW,IAAtBroB,EAAOE,QAAQuC,GAC1Bm8B,UAAW5+B,EAAOE,QAAQuC,GAC1Bo8B,YAAa7+B,EAAOE,QAAQq0B,OAGhC,IAAK,gBACH,IAAMn0B,EAAQ,2BACTL,GADS,IAEZw+B,WAAW,eAAMx+B,EAAMw+B,cAezB,cAbOn+B,EAASm+B,WAAWv+B,EAAOE,QAAQuC,IAEtCrC,EAAS4B,UAAY5B,EAASq+B,WAAaz+B,EAAOE,QAAQuC,KAC5DrC,EAAS4B,UAAW,EACpB5B,EAASq+B,cAAWpW,EACpBjoB,EAASs+B,gBAAarW,GAEpBjoB,EAASu+B,WAAav+B,EAASw+B,YAAc5+B,EAAOE,QAAQuC,KAC9DrC,EAASu+B,WAAY,EACrBv+B,EAASw+B,eAAYvW,EACrBjoB,EAASy+B,iBAAcxW,GAGlBjoB,EAET,QACE,MAAM,IAAIO,MAAJ,+BAAkCX,EAAOC,QAKrD,IAAMW,GAAa,CACjB29B,WAAY,GACZv8B,UAAU,EACVy8B,cAAUpW,EACVqW,gBAAYrW,EACZsW,WAAW,EACXC,eAAWvW,EACXwW,iBAAaxW,GAGR,SAASyW,mBAAmBh+B,GAAQ,IACjCi+B,EAAgBj+B,EAAhBi+B,YADgC,EAETh+B,qBAAWu9B,kBAAmB19B,IAFrB,mBAEjC29B,EAFiC,KAErBt9B,EAFqB,KAGlCC,EAAeC,mBAAQ,iBAAO,CAAEo9B,aAAYt9B,cAAa,CAACs9B,IAyEhE,OAjBAx8B,qBAAU,WACJg9B,GACFA,EAAY/1B,SAAQ,SAACiuB,GACa,IAA5BA,EAAS/V,KAAKyE,UAChBsR,EAAS2F,OAAOzF,OAAOnuB,SAAQ,SAACtE,GAAD,OA1DN,SAA3Bs6B,yBAA4Bt6B,EAAOu6B,GACvCA,EAAch+B,SAAS,CACrBhB,KAAM,gBACNC,QAAS,CAAEuC,GAAIiC,EAAMjC,OAEtBiC,EAAM44B,OAAS,IAAIt0B,SAAQ,SAACk2B,GAAD,OAC1BD,EAAch+B,SAAS,CACrBhB,KAAM,MACNC,QAAS,CAAEuC,GAAI,CAACiC,EAAMjC,GAAIy8B,GAAS3K,KAAM,UAG7C7vB,EAAM64B,OAAOv0B,SAAQ,SAACu0B,GAAD,OAClBA,EAAOD,OAAS,IAAIt0B,SAAQ,SAACk2B,GAAD,OAC3BD,EAAch+B,SAAS,CACrBhB,KAAM,MACNC,QAAS,CAAEuC,GAAI,CAAC86B,EAAO96B,GAAIy8B,GAAS3K,KAAM,aA4CxCyK,CAAyBt6B,EAAOxD,MAEG,IAA5B+1B,EAAS/V,KAAKyE,WACvBsR,EAAS7M,MAAM+M,OAAOnuB,SAAQ,SAAC0oB,GAAD,OAzCN,SAA1ByN,wBAA2BzN,EAAMuN,GACrCA,EAAch+B,SAAS,CACrBhB,KAAM,gBACNC,QAAS,CAAEuC,GAAIivB,EAAKjvB,OAErBivB,EAAKnmB,EAAE+xB,OAAS,IAAIt0B,SAAQ,SAACk2B,GAAD,OAC3BD,EAAch+B,SAAS,CACrBhB,KAAM,MACNC,QAAS,CAAEuC,GAAI,CAACivB,EAAKjvB,GAAIy8B,GAAS3K,KAAM,WAG3C7C,EAAKpmB,EAAEgyB,OAAS,IAAIt0B,SAAQ,SAACk2B,GAAD,OAC3BD,EAAch+B,SAAS,CACrBhB,KAAM,MACNC,QAAS,CAAEuC,GAAI,CAACivB,EAAKjvB,GAAIy8B,GAAS3K,KAAM,UAG5C7C,EAAK6L,OAAOv0B,SAAQ,SAACu0B,IAClBA,EAAOjyB,EAAEgyB,OAAS,IAAIt0B,SAAQ,SAACk2B,GAAD,OAC7BD,EAAch+B,SAAS,CACrBhB,KAAM,MACNC,QAAS,CAAEuC,GAAI,CAAC86B,EAAO96B,GAAIy8B,GAAS3K,KAAM,WAG7CgJ,EAAOhyB,EAAE+xB,OAAS,IAAIt0B,SAAQ,SAACk2B,GAAD,OAC7BD,EAAch+B,SAAS,CACrBhB,KAAM,MACNC,QAAS,CAAEuC,GAAI,CAAC86B,EAAO96B,GAAIy8B,GAAS3K,KAAM,aAexC4K,CAAwBzN,EAAMxwB,WAMrC,CAAC69B,IAGF,cAACV,GAAkBj9B,SAAnB,CAA4Bd,MAAOY,EAAnC,SACGJ,EAAMO,WAKN,SAAS+9B,oBACd,OAAO79B,qBAAW88B,IAGb,SAASgB,cAAcn9B,GAC5B,IAAMP,EAAUy9B,oBAEhB,GAAoB,kBAARl9B,GAAmC,kBAARA,GAA6B,KAARA,EAC1D,MAAM,IAAIvB,MAAJ,uDAER,IAAM8B,EAAKX,OAAOI,GAEZF,EAAWb,mBAAQ,WACvB,OAAOQ,EAAQ48B,WAAWv8B,UAAYL,EAAQ48B,WAAWE,WAAah8B,IACrE,CAACd,EAAQ48B,WAAWE,SAAU98B,EAAQ48B,WAAWv8B,SAAUS,IAExDi8B,EAAav9B,mBAAQ,WACzB,OAAOa,EAAWL,EAAQ48B,WAAWG,gBAAarW,IACjD,CAAC1mB,EAAQ48B,WAAWG,WAAY18B,IAE7Bs9B,EAAWn+B,mBAAQ,WACvB,OAAOQ,EAAQ48B,WAAWA,WAAW97B,GACjCd,EAAQ48B,WAAWA,WAAW97B,GAC9B,KACH,CAACd,EAAQ48B,WAAWA,WAAY97B,IAE7Bk8B,EAAYx9B,mBAAQ,WACxB,OAAOQ,EAAQ48B,WAAWI,WAAah9B,EAAQ48B,WAAWK,YAAcn8B,IACvE,CAACd,EAAQ48B,WAAWI,UAAWh9B,EAAQ48B,WAAWK,UAAWn8B,IAE1Do8B,EAAc19B,mBAAQ,WAC1B,OAAOw9B,EAAYh9B,EAAQ48B,WAAWM,iBAAcxW,IACnD,CAAC1mB,EAAQ48B,WAAWM,YAAaF,IAE9Bn8B,EAAMF,uBACV,SAACk8B,GACC78B,EAAQV,SAAS,CACfhB,KAAM,MACNC,QAAS,CAAEuC,GAAI,CAACA,EAAI+7B,GAAMjK,KAAMmK,OAGpC,CAACA,EAAY/8B,EAASc,IAGlBC,EAASJ,uBACb,SAACk8B,GACC78B,EAAQV,SAAS,CACfhB,KAAM,SACNC,QAAS,CAAEuC,GAAI,CAACA,EAAI+7B,GAAMjK,KAAMmK,OAGpC,CAACA,EAAY/8B,EAASc,IAGlB88B,EAAYj9B,uBAChB,SAACiyB,GACC5yB,EAAQV,SAAS,CACfhB,KAAM,aACNC,QAAS,CAAEuC,GAAI,CAACA,GAAK8xB,YAGzB,CAAC5yB,EAASc,IAGN+8B,EAASl9B,uBACb,SAACk8B,QAE4BnW,IAAzBiX,EAASZ,IACRY,EAASZ,GAAYv8B,SAASq8B,GAI/B97B,EAAO87B,GAFPh8B,EAAIg8B,KAKR,CAACE,EAAYl8B,EAAK88B,EAAU58B,IAIxB+8B,EAAen9B,uBAAY,WAC/BX,EAAQV,SAAS,CACfhB,KAAM,gBACNC,QAAS,CAAEuC,UAEZ,CAACd,EAASc,IAEPS,EAAUZ,uBACd,SAACiyB,GACC5yB,EAAQV,SAAS,CACfhB,KAAM,gBACNC,QAAS,CACPuC,GAAKT,OAAgBqmB,EAAL5lB,EAChB8xB,KAAOvyB,QAAmBqmB,IAAP5lB,OAA0B4lB,EAAPkM,OAI5C,CAAC5yB,EAASc,EAAIT,IAGV09B,EAAep9B,uBACnB,SAACtC,EAAQu0B,GACQ,UAAXv0B,EACF2B,EAAQV,SAAS,CACfhB,KAAM,kBACNC,QAAS,CACPuC,GAAIA,EACJ8xB,UAAalM,IAAP5lB,EAAmB8xB,OAAOlM,KAGhB,UAAXroB,GACT2B,EAAQV,SAAS,CACfhB,KAAM,kBACNC,QAAS,OAIf,CAACyB,EAASc,IAGNO,EAAeV,uBAAY,SAACiyB,GAAD,OAAUmL,EAAa,QAASnL,KAAO,CACtEmL,IAGIz8B,EAAeX,uBAAY,SAACiyB,GAAD,OAAUmL,EAAa,QAASnL,KAAO,CACtEmL,IAGF,MAAO,CACLj9B,KACAT,WACA08B,aACAY,WACA98B,MACAE,SACA68B,YACAC,SACAC,eACAv8B,UACAy7B,YACAE,cACA77B,eACAC,gBChXJ,IAAM08B,GAAa,CACjB,CAAEnR,MAAO,cAAeluB,MAAO,IAAK8hB,aAAc,MAClD,CAAEoM,MAAO,cAAeluB,MAAO,IAAK8hB,aAAc,GAClD,CAAEoM,MAAO,cAAeluB,MAAO,IAAK8hB,aAAc,GAClD,CAAEoM,MAAO,cAAeluB,MAAO,IAAK8hB,aAAc,GAClD,CAAEoM,MAAO,cAAeluB,MAAO,IAAK8hB,aAAc,GAClD,CAAEoM,MAAO,cAAeluB,MAAO,IAAK8hB,aAAc,GAClD,CAAEoM,MAAO,aAAcluB,MAAO,IAAK8hB,aAAc,GACjD,CAAEoM,MAAO,aAAcluB,MAAO,IAAK8hB,aAAc,GACjD,CAAEoM,MAAO,YAAaluB,MAAO,IAAK8hB,aAAc,GAChD,CAAEoM,MAAO,YAAaluB,MAAO,IAAK8hB,aAAc,ICAlD,SAASwd,eAAe1d,GAA2B,IAAhB2d,EAAe,uDAAJ,GAE5C,QAAkBxX,IAAdnG,GAAgD,IAArBA,EAAUld,OACvC,OAAO,EAET,IAAM86B,EAAaH,GAAW5C,MAC5B,SAACgD,GAAD,OAAOA,EAAEz/B,QAAU4hB,GAAa6d,EAAEvR,QAAUtM,KAE9C,OACE4d,IACCD,EAAS19B,SAAS29B,EAAWx/B,SAC7Bu/B,EAAS19B,SAAS29B,EAAWtR,OAIlC,SAASwR,kBAAkB5d,GAA8B,IAAhByd,EAAe,uDAAJ,GAElD,YAAqBxX,IAAjBjG,GAAsD,IAAxBA,EAAapd,SAGvCod,EACLgF,MAAM,IACN2V,MAAK,SAAC+C,GAAD,OAAiBF,eAAeE,EAAYD,MAGtD,SAASI,mBAAmB/d,GAC1B,OAA4B,IAArBA,EAAUld,OACb26B,GAAW5C,MAAK,SAAC+C,GAAD,OAAgBA,EAAWx/B,QAAU4hB,KAAWsM,MAChEmR,GAAW5C,MAAK,SAAC+C,GAAD,OAAgBA,EAAWtR,QAAUtM,KAAW5hB,MAGtE,SAAS4/B,oBAAoBhe,GAK3B,OAJIA,EAAUld,OAAS,IACrBkd,EAAY+d,mBAAmB/d,IAG1B8d,kBAAkB9d,EAAW,CAAC,IAAK,MC9CrC,IAAMie,GAAoB,CAAC,MAAO,QAAS,OAAQ,WCkB3CC,OAdf,SAASA,UAAT,GAAqD,IAAhC7C,EAA+B,EAA/BA,OAAQ3wB,EAAuB,EAAvBA,OAAQyzB,EAAe,EAAfA,YAC3B3f,EAAWtS,WAAXsS,OACR,OACE,sBAEE6P,GAAI7P,IAAS6c,EAAO3C,OACpBpK,GAAI5jB,EACJ6jB,GAAI/P,IAAS6c,EAAO3C,OACpBlK,GAAI9jB,EAASyzB,EACbpQ,OAAQkQ,GAAkB,IAN5B,yBACyB5C,EAAO96B,MCYrB69B,OAlBf,SAASA,WAAT,GAA4E,IAAtD/C,EAAqD,EAArDA,OAAQ3wB,EAA6C,EAA7CA,OAAQyzB,EAAqC,EAArCA,YAAavhB,EAAwB,EAAxBA,SAAUyhB,EAAc,EAAdA,WACnD7f,EAAWtS,WAAXsS,OACR,OACE,sBAEE+a,WAAW,SACXnwB,EAAGoV,IAAS6c,EAAO3C,OACnBrvB,EAAGqB,EAASyzB,EAAc,EAC1BvhB,SAAUA,EACV0hB,aAAa,UACb5iB,KAAK,QACL6iB,WAAYF,EAAa,UAAY,SARvC,SAUGhD,EAAOnb,cAVV,6BAC6Bmb,EAAO96B,MC2DzBi+B,OA7Df,SAASA,UAAT,GAOI,IANFC,EAMC,EANDA,UACAN,EAKC,EALDA,YACAzzB,EAIC,EAJDA,OACAg0B,EAGC,EAHDA,SACAC,EAEC,EAFDA,aACAN,EACC,EADDA,WAEQ7f,EAAWtS,WAAXsS,OACFogB,EAAuBx+B,uBAC3B,YAA2D,IAAxD2J,EAAuD,EAAvDA,OAAQ80B,EAA+C,EAA/CA,QAASC,EAAsC,EAAtCA,MAAOC,EAA+B,EAA/BA,kBAAmBriB,EAAY,EAAZA,MACtCsiB,EAAY,EAAID,EAAoB,EACpCE,EAAcv0B,EAASs0B,EAAYb,EACnCe,EAAcx0B,GAAUs0B,EAAY,GAAKb,EAE/C,OACE,8BAEE,sBACE5E,WAAW,SACXnwB,EAAGoV,IAASqgB,GAAWF,EAAaQ,SACpC91B,EAAG61B,EAAmBf,EAAc,EAAnB,EACjBvhB,SAAU+hB,EAAa/hB,SACvBlB,KAAMgB,EACN6hB,WAAYF,EAAa,UAAY,SANvC,SAQGS,IAGH,sBACEzQ,GAAI7P,IAASzU,GACbukB,GAAI2Q,EACJ1Q,GAAI/P,IAASqgB,GACbrQ,GAAI0Q,EACJnR,OAAQrR,IAGV,sBACE2R,GAAI7P,IAASqgB,GACbvQ,GAAI4Q,EACJ3Q,GAAI/P,IAASqgB,GACbrQ,GAAI0Q,EAAcf,EAClBpQ,OAAQrR,MA1BZ,mBAAoBgiB,EAApB,YAAgC30B,EAAhC,YAA0C80B,EAA1C,YAAqDC,MA+BzD,CACEJ,EACAC,EAAaQ,SACbR,EAAa/hB,SACb4B,EACA6f,EACA3zB,EACAyzB,IAIJ,OAAOM,GAAaA,EAAUjlB,KAAI,SAAC4lB,GAAD,OAAUR,EAAqBQ,OC0BpDC,GA/ES,SAAlBA,gBAAmBhE,EAAQiE,GA2E/B,OA1EA,SAASC,mBACPR,EACAS,EACAC,EACA11B,GAEA,GAAIg1B,GAAqB1D,EAAOnb,aAAapd,OAC3C,OAAO28B,EAGT,IAAM/iB,EACJuhB,GAAkBc,EAAoBd,GAAkBn7B,QAEpD48B,EAASF,EAASnH,WACtB,SAACsH,GAAD,OAAaA,IAAYZ,KAGrBvf,EAAY+B,IAAU+d,EAAc,uBAAwB,GAC5Dnf,EACJuf,GAAU,GAAKlgB,EAAY,EACvB6b,EAAOpb,EAAEyf,GAAQvf,SAAWX,EAC5B,KAGN,GAAKW,EAeE,CAEL,IAAMyf,ELFZ,SAASC,UAAU5J,EAAG6J,GACpB,QAAU3Z,IAAN8P,GAAyB,IAANA,QAAoB9P,IAAT2Z,EAAoB,MAAO,CAAC,GAG9D,IAFA,IAAIC,EAAO,EAAID,EAAO,EAClBE,EAAe,GACV/f,EAAI,EAAGA,EAAI8f,EAAO,EAAG9f,IAAK+f,EAAargC,KAAK,GAErD,IAAK,IAAIkD,EAAI,EAAGA,EAAIozB,EAAI,EAAGpzB,IAAK,CAG9B,IADA,IAAIo9B,EAAQD,EAAan+B,QAChBoe,EAAI,EAAGA,EAAI8f,EAAM9f,IAAK,CAC7B,IAAK,IAAI2H,EAAI,EAAGA,EAAIoY,EAAal9B,OAAS,EAAG8kB,IAC3CqY,EAAMrY,EAAI3H,IAAM+f,EAAapY,GAE/BqY,EAAMtgC,KAAK,GAEbqgC,EAAeC,EAAMp+B,QAEvB,OAAOm+B,EKfYH,CLjDrB,SAASK,sBAAsBtG,GAC7B,IAAM5Z,EAAYyd,GAAW5C,MAC3B,SAAC+C,GAAD,OAAgBhE,IAAWgE,EAAWtR,OAASsN,IAAWgE,EAAWx/B,SAGvE,OAAO4hB,EAAYA,EAAUE,aAAe,KK6CtCggB,CAAsB7E,EAAOnb,aAAaigB,OAAOpB,IACjD,IAGEF,EACFe,EAAO98B,OAAS,IAAM,EAClBiH,EAAU61B,EAAO98B,OAAS,EAAKqd,EAAWA,EAAW,EACrDpW,GAAU61B,EAAO98B,OAAS,EAAI,IAAOqd,EAE3Cyf,EAAO94B,SAAQ,SAACg4B,EAAOlX,GACjBA,EAAI,IACNiX,GAAW1e,GAEbsf,EAAc9/B,KAAK,CACjBoK,SACA80B,UACAC,QACAC,oBACAriB,UAGF6iB,mBACER,EAAoB,EACpBS,EACAC,EACAZ,WA1CJY,EAAc9/B,KAAK,CACjBoK,SACA80B,QAAS90B,EACT+0B,MAAO,EACPC,oBACAriB,UAGF6iB,mBACER,EAAoB,EACpBS,EACAC,EACA11B,GAmCJ,OAAO01B,IC/DLvyB,GAAS,CACbmF,OAAQ,UACR3Q,QAAS,GACTwsB,YAAa,GA0PAkS,I,MAAAA,GAvPf,SAASA,iBAAT,GAQI,IAPFC,EAOC,EAPDA,UACAC,EAMC,EANDA,QACAjF,EAKC,EALDA,OAKC,IAJDsD,oBAIC,MAJc,CACbQ,SAAU,GACVviB,SAAU,IAEX,IAC0B1Q,WAAnBsS,EADP,EACOA,OAAQ8H,EADf,EACeA,OADf,EAOG7a,eAJIoxB,EAHP,EAGC55B,KACAsb,EAJD,EAICA,eACAqP,EALD,EAKCA,aACAppB,EAND,EAMCA,MAEI63B,EAAac,cAAc9B,EAAO96B,IAClCzB,EAAYQ,aAChB,CAAC+8B,EAAW97B,IAAI46B,OAAOkB,EAAWe,SAASh0B,GAAK,KAG5Ck2B,EAAergC,mBACnB,kBAAMsiB,IAAUsb,EAAD,UAAiBte,EAAeQ,OAAS,QACxD,CAACR,EAAgBse,IAflB,EAkB2B10B,mBAAS,CAAEkmB,GAAIgN,EAAO3C,MAAOnK,GAAI8M,EAAO3C,QAlBnE,mBAkBM6H,EAlBN,KAkBcC,EAlBd,OAmBiCr4B,mBAAS,CACzC3D,MAAO,EACPC,OAAQ,EACR05B,YAAa,IAtBd,mBAmBMsC,EAnBN,KAmBiBC,EAnBjB,OAwB6Cv4B,oBAAS,GAxBtD,mBAwBMw4B,EAxBN,KAwBuBC,EAxBvB,OAyBmCz4B,oBAAS,GAzB5C,mBAyBMk2B,EAzBN,KAyBkBwC,EAzBlB,KA2BDhhC,qBAAU,WACR,IAAMihC,GAAoBhD,kBAAkBzC,EAAOnb,aAAc,CAAC,MAC5D6gB,EAAaD,EACf72B,KAAKC,IAAIsU,IAAS+hB,EAAOlS,IAAM7P,IAAS+hB,EAAOhS,KAC/CtkB,KAAKC,IAAIsU,IAAS+hB,EAAOlS,IAAM7P,IAAS+hB,EAAOhS,KAC/CoQ,EAAaQ,SACX6B,EAAcF,EAAmBC,EAAa,EAAIA,EAAa,EAG/DE,EAAmBH,EACrBE,GAAe3F,EAAOnb,aAAapd,OAAS,GAC5Ck+B,GAAe,EAAI3F,EAAOnb,aAAapd,OAAS,GAEpD49B,EAAa,CACXl8B,MAAOu8B,EACPt8B,OAAQu8B,EACR7C,YAAa8C,IAEfL,EAAmBE,KAClB,CACDnC,EAAaQ,SACb3gB,EACA6c,EAAOnb,aACPqgB,EAAOlS,GACPkS,EAAOhS,KAGT1uB,qBAAU,WACJ4gC,EAAUj8B,MAAQA,GAAS,GAC7Bq8B,GAAc,GAEdA,GAAc,KAEf,CAACJ,EAAUj8B,MAAOA,IAErB,IAAMkG,EAASzL,mBAAQ,WACrB,IAAIiiC,EAWJ,OAVA5B,EAAar8B,KAAKmG,EAAEtC,SAAQ,SAACq6B,EAAIt+B,GAE7Bs+B,GAAMd,GACNc,GAAMb,KACJY,GAAQ5B,EAAar8B,KAAKoG,EAAExG,GAAKq+B,KAEnCA,EAAO5B,EAAar8B,KAAKoG,EAAExG,OAIxByjB,EAAOgZ,EAAa/+B,GAApB+lB,CAAwB4a,GAAQT,EAAUh8B,OAAS,KACzD,CACD66B,EAAar8B,KAAKmG,EAClBk2B,EAAar8B,KAAKoG,EAClBi2B,EAAa/+B,GACb+lB,EACAma,EAAUh8B,OACV47B,EACAC,IAGIb,EAAgBxgC,mBAAQ,WAO5B,OAN2BogC,GAAgBhE,EAAQiE,EAM5CC,CAAmB,EALTlE,EAAOnb,aACrBgF,MAAM,IACN1L,KAAI,SAAC4nB,EAAOv+B,GAAR,OAAem7B,oBAAoBoD,GAASv+B,OAAIsjB,KACpDnkB,QAAO,SAACq/B,GAAD,YAAelb,IAAPkb,KAEqB,GAAIhG,EAAO3C,SACjD,CAAC2C,EAAQiE,IAEZz/B,qBAAU,WACR,GAAI8gC,EACFH,EAAU,CAAEnS,GAAIgS,EAAW9R,GAAI+R,QAC1B,CACL,IAAMgB,EAAU,CAAEjT,GAAIgN,EAAO3C,MAAOnK,GAAI8M,EAAO3C,OAC/C+G,EAAc34B,SAAQ,SAACy6B,GACjBA,EAAcx3B,OAASu3B,EAAQjT,KACjCiT,EAAQjT,GAAKkT,EAAcx3B,QAEzBw3B,EAAcx3B,OAASu3B,EAAQ/S,KACjC+S,EAAQ/S,GAAKgT,EAAcx3B,QAEzBw3B,EAAc1C,QAAUyC,EAAQjT,KAClCiT,EAAQjT,GAAKkT,EAAc1C,SAEzB0C,EAAc1C,QAAUyC,EAAQ/S,KAClC+S,EAAQ/S,GAAKgT,EAAc1C,YAG/B2B,EAAUc,MAEX,CACDX,EACAN,EACAC,EACAjF,EAAO3C,MACP2C,EAAOnb,aACPuf,IAGF,IAAM+B,EAAmBviC,mBAAQ,WAAO,IAC9Bk/B,EAAgBsC,EAAhBtC,YAEFsD,EAAmB/2B,EACrBg3B,EAAUD,EAERE,EAAoBj3B,EAASyzB,EAMnC,GALAuD,EAAUC,EAGVD,GAAWvD,EAEPwC,EAAiB,CACnB,IAAMiB,EAAapjB,IAAS6hB,GACtBwB,EAAWrjB,IAAS8hB,GAEpBwB,EAAQ,YAAQF,EAAR,YACZF,EAAUvD,EADE,YAEVyD,EAFU,YAEIF,EAFJ,YAEeljB,IAC3B6c,EAAO3C,OAHK,YAITgJ,EAJS,YAIEG,EAJF,YAIcH,EAJd,YAIyBG,EAJzB,YAKZH,EAAUvD,GAGZ,OACE,4BACE,aAAC,GAAD,CACE9C,OAAQA,EACR3wB,OAAQ+2B,EACRtD,YAAaA,EACbvhB,SAAU+hB,EAAa/hB,SACvByhB,WAAYA,IAEd,aAAC,GAAD,CACEhD,OAAQA,EACR3wB,OAAQi3B,EACRxD,YAAaA,IAEf,qBAAMxiB,EAAGmmB,EAAU/T,OAAO,OAAOrS,KAAK,YAK5C,OACE,4BACE,aAAC,GAAD,CACE2f,OAAQA,EACR3wB,OAAQ+2B,EACRtD,YAAaA,EACbvhB,SAAU+hB,EAAa/hB,SACvByhB,WAAYA,IAEd,aAAC,GAAD,CACEhD,OAAQA,EACR3wB,OAAQi3B,EACRxD,YAAaA,IAEf,aAAC,GAAD,CACEM,UAAWgB,EACXf,SAAUe,EACVpB,WAAYA,EACZ3zB,OAAQA,EACRi0B,aAAcA,EACdR,YAAaA,SAIlB,CACDsC,EACA/1B,EACAi2B,EACAtF,EACAsD,EACAN,EACAoB,EACAjhB,EACA6hB,EACAC,IAGF,OACE,kBACExwB,IACEhR,EAAUgB,UAAYu8B,EAAWv8B,SAAjC,2BACSoN,IADT,IACiBxL,QAAS,EAAGwsB,YAAa,MACtChhB,GAGJpM,aAAc,wBACZu7B,EAAWv7B,aAAa,KACxBhC,EAAUqB,QAEZY,aAAc,wBACZs7B,EAAWt7B,aAAa,KACxBjC,EAAUuB,QAIZW,QACE4sB,GAAgBA,IAAiBpe,GAAQ0d,UAAU3sB,GAC/C,KACA,SAACG,GACKA,EAAE8H,WACJ9H,EAAEE,kBACFy7B,EAAWr7B,QAAQ,OAvBjC,SA4BGwgC,KC7PD3O,GAAgB/iB,YAAH,kfAqBbgjB,GAAoBhjB,YAAH,0QA6IRiyB,OA7Hf,SAASA,MAAT,GAAoE,IAAnD3H,EAAkD,EAAlDA,UAAW4H,EAAuC,EAAvCA,sBAAuBpU,EAAgB,EAAhBA,aACzCrtB,EAAmC65B,EAAnC75B,GAAIwD,EAA+Bq2B,EAA/Br2B,KAAMmb,EAAyBkb,EAAzBlb,GAAIwN,EAAqB0N,EAArB1N,SAAU2O,EAAWjB,EAAXiB,OAC1B4G,EAAkB9E,cAAc58B,GAChC2hC,EAAiB5iC,aACrB,CAAC2iC,EAAgB1hC,IAAI46B,OAAO8G,EAAgB7E,SAASh0B,GAAK,IAC1D/L,KAAMG,OAGAghB,EAAWtS,WAAXsS,OACFzf,EAAW6M,cATgD,EAWvBzD,oBAAS,GAXc,mBAW1Dg6B,EAX0D,KAW3CC,EAX2C,OAYbj6B,oBAAS,GAZI,mBAY1Dk6B,EAZ0D,KAYtCC,EAZsC,KAcjEziC,qBAAU,WACJ+tB,GAAgBA,IAAiBpe,GAAQ0d,UAAU3sB,GACrD+hC,GAAsB,GAEtBA,GAAsB,KAEvB,CAAC1U,IAEJ/tB,qBAAU,WACRuiC,GAAkBtG,GAAe1B,MAChC,CAACA,IAEJ,IAAMhH,EAAuBhzB,uBAC3B,SAACizB,GACCt0B,EAAS,CACPhB,KAAM0Y,GACNxT,KAAK,2BAAMm3B,GAAc/G,OAG7B,CAACt0B,EAAUq7B,IAGPmI,EAAoBniC,uBAAY,WACpC6hC,EAAgBnhC,aAAa,KAC7BohC,EAAe/hC,SACd,CAAC8hC,EAAiBC,IACf52B,EAAoBlL,uBAAY,WACpC6hC,EAAgBlhC,aAAa,KAC7BmhC,EAAe7hC,SACd,CAAC4hC,EAAiBC,IAEfM,EAAgBpiC,uBACpB,SAACM,GAEGktB,IAAiBpe,GAAQud,cAAcxsB,IACvCG,EAAE8H,WACD65B,GAEDJ,EAAgBjhC,QAAQ,OAG5B,CAACihC,EAAiBI,EAAoBzU,IAGxC,OACE,kBAEErsB,MAAO,CAAEq2B,QAAS,QAClB9nB,IACEuyB,GACAH,EAAepiC,UACfmiC,EAAgBniC,SACZgzB,GACAD,GAGN/xB,aAAcyhC,EACdxhC,aAAcuK,EACdtK,QAASwhC,EAbX,UAeE,kBAAG9zB,UAAS,oBAAe8P,IAASU,GAAxB,QAAZ,UACE,qBACE9V,EAAE,IACF5E,MAAOga,IAASza,GAAQya,IAASU,GACjCza,OAAO,IACPoD,UAAU,aACV6T,KAAK,QACLgX,aACGyP,GACDD,EAAepiC,UACfmiC,EAAgBniC,SACZ,EACA,KAGR,qBACEy5B,WAAW,SACXnwB,GAAIoV,IAASza,GAAQya,IAASU,IAAO,EACrC7V,EAAE,KACFuT,SAAS,KACTlB,KAAK,MACLgX,aACGyP,GACDD,EAAepiC,UACfmiC,EAAgBniC,SACZ,EACA,GAXR,cAcgBqmB,IAAbuG,EAAyBA,EAAStM,QAAQ,GAAK,QAGpD,aAAC,GAAD,CACErc,KAAMq2B,EAAUr2B,KAChBmb,GAAIkb,EAAUlb,GACd1E,OAAQ4Y,IAET4O,GAAyB3G,GAAUA,EAAOv4B,OAAS,EAChDu4B,EAAO7hB,KAAI,SAAC8hB,GAAD,OACT,aAAC,GAAD,CACE+E,UAAWt8B,EACXu8B,QAASphB,EACTmc,OAAQC,GACHD,EAAO96B,OAGhB,OAnDCA,ICjHX,SAASkiC,OAAT,GAAyD,IAAvC/H,EAAsC,EAAtCA,OAAQjG,EAA8B,EAA9BA,aAAc7G,EAAgB,EAAhBA,aAAgB,EACOzlB,oBAAS,GADhB,mBAC/Cu6B,EAD+C,KAClBV,EADkB,KAStD,OANAniC,qBAAU,WACR8iC,GAAO/T,GAAG,yBAAyB,SAAC5I,GAClCgc,EAAsBhc,QAEvB,IAGD,mBAAGkP,SAAQ,eAAUT,EAAV,kBAAX,SACGiG,GACCA,EAAOzF,QACPyF,EAAOzF,OAAOzb,KAAI,SAAChX,GAAD,OAChB,cAAC,GAAD,CAEE43B,UAAW53B,EACXorB,aAAcA,EACdoU,sBAAuBU,GAHlBlgC,EAAMjC,SAURo6B,UAAczc,eAAKukB,SCenBG,OArCf,SAASA,QAAT,GAAiE,IAA9Chd,EAA6C,EAA7CA,KAAMphB,EAAuC,EAAvCA,MAAOC,EAAgC,EAAhCA,OAAQuN,EAAwB,EAAxBA,OAAQyiB,EAAgB,EAAhBA,aAAgB,EACnCvoB,WAAnBsS,EADsD,EACtDA,OAAQ8H,EAD8C,EAC9CA,OAChB,OAAK9H,GAAW8H,GAAW9hB,GAAUC,EAGnC,sBACEgX,QAAO,cAASjX,EAAT,YAAkBC,GACzBD,MAAOA,EACPC,OAAQA,EACRlE,GAAG,SAJL,UAME,+BACE,0BAAUA,GAAE,UAAKk0B,EAAL,iBAAZ,SACE,sBACEjwB,MAAK,UAAKA,EAAQwN,EAAOzE,KAAOyE,EAAO3E,OACvC5I,OAAM,UAAKA,GACX2E,EAAC,UAAK4I,EAAOzE,MACblE,EAAC,UAAK,SAKZ,cAAC,GAAD,IACA,cAAC,GAAD,IACA,cAAC,GAAD,IACA,cAAC,GAAD,IACA,cAAC,GAAD,IACA,cAAC,GAAD,IAEA,mBAAGxB,UAAU,YAAYtG,MAAO,CAAEE,cAAe,QAAjD,SACE,cAAC,GAAD,CAAOs3B,UAAQ,EAACnT,KAAMA,SA5BwB,M,oBCVhDid,GAAcllC,0BAEPmlC,GAAeD,GAAY3jC,SAKjC,SAAS6jC,UACd,IAAMtjC,EAAUJ,qBAAWwjC,IAErB1iC,EAAOC,uBACX,SAACM,GACC,IAAMH,EAAKG,EAAE0xB,OAAOzrB,aAAa,eAC7BpG,IACFG,EAAE0xB,OAAO7wB,MAAM8Q,OAAS,OACxB5S,EAAQV,SAAS,CAAEhB,KAAM,OAAQwC,OAEjCd,EAAQU,KAAKI,EAAI,CAAEyiC,MAAOtiC,EAAEuiC,QAAU,EAAI,UAG9C,CAACxjC,IAGGY,EAAOD,uBAAY,WACvBX,EAAQV,SAAS,CAAEhB,KAAM,SACzB0B,EAAQyjC,UACP,CAACzjC,IAOJ,MAAO,CAAEU,OAAME,OAAMQ,QALL,CACdC,aAAcX,EACdY,aAAcV,IChCX,IAAM8iC,GAAU,SAAVA,QAAWC,EAAOvU,GAAR,OACrBuU,EAAMxf,QAAO,SAAC7J,EAAQspB,GACpB,IAAMrjC,EAAM6uB,EAAGwU,GAGf,OAFKtpB,EAAO/Z,KAAM+Z,EAAO/Z,GAAO,IAChC+Z,EAAO/Z,GAAKL,KAAK0jC,GACVtpB,IACN,K,SCNUupB,K,4FAAf,iBAAoBC,GAApB,kBAAArgC,EAAA,+EACyBqV,MAAMgrB,GAD/B,cAEE/qB,oBADMC,EADR,iBAGqBA,EAASC,OAH9B,cAGQzV,EAHR,yBAISA,GAJT,kD,sBAOA,SAASuV,oBAAYC,GACnB,IAAKA,EAASE,GACZ,MAAM,IAAIla,MAAJ,eAAkBga,EAASG,OAA3B,cAAuCH,EAASI,aAExD,OAAOJ,ECXF,I,GAAM+qB,GAAY,CACvBC,SAAU,KACVC,WAAY,MAEC,SAASC,YAAY9lC,EAAOC,GACzC,OAAQA,EAAOC,MACb,IAAK,OACH,IAAM0lC,EAAW5lC,EAAMoF,KAAKnF,EAAOyC,IAAImY,KACvC,OAAO,2BAAK7a,GAAZ,IAAmB4lC,aAErB,IAAK,OACH,OAAO,2BAAK5lC,GAAZ,IAAmB4lC,SAAU,OAE/B,QACE,MAAM,IAAIhlC,MAAJ,+BAAkCX,EAAOC,QCUrD,IAAMkR,IAAgB,sBACnBnC,EAAmB,CAClB8B,SAAU,CAAElN,QAAS,GACrBmN,QAAS,CAAEnN,QAAS,KAHF,gBAKnBoL,EAAoB,CACnB8B,SAAU,CAAEF,UAAW,YACvBG,QAAS,CAAEH,UAAW,YACtBI,QAAS,CAAEJ,UAAW,YACtBK,OAAQ,CAAEL,UAAW,cATH,IAahBxB,GAAS,CACbW,eAAgB,CACdJ,QAAS,OACTO,cAAe,SACfxJ,MAAO,OACPC,OAAQ,OACR0J,aAAc,MACdsO,QAAS,QAEXtP,eAAgB,CACdW,UAAW,UACXN,gBAAiB,yBACjBO,UAAW,kDACXtM,cAAe,OAEjBmiC,YAAa,CACX7L,OAAQ,OACRrb,MAAO,MACPlP,gBAAiB,cACjBoqB,QAAS,SAITiM,GAAe,KAEnB,SAAS3kC,kBAAT,GAaI,IAZFC,EAYC,EAZDA,SACA8D,EAWC,EAXDA,KACAsN,EAUC,EAVDA,OACA/O,EASC,EATDA,SACA6N,EAQC,EARDA,QACA2zB,EAOC,EAPDA,MACAjlC,EAMC,EANDA,KACA0Q,EAKC,EALDA,WACAmB,EAIC,EAJDA,eACAY,EAGC,EAHDA,WACAszB,EAEC,EAFDA,SACAC,EACC,EADDA,gBAEMtzB,EAAOtB,mBACP60B,EAAW70B,iBAAO,IAFvB,EAG2BhH,mBAAS,IAHpC,mBAGM87B,EAHN,KAGcC,EAHd,KAKDrkC,qBAAU,WACR4Q,EAAKG,QAAUxP,SAASC,cAAc,OACtC,IAAM6N,EAAMuB,EAAKG,QACbJ,GACFA,EAAWpO,YAAY8M,GAGzB,IAAMi1B,EAAcH,EAASpzB,QAE7B,OAAO,WACLuzB,EAAYr9B,QAAQsV,cAChB5L,GACFA,EAAWzN,YAAYmM,MAG1B,CAACsB,IAEJ,IAAMhQ,EAASJ,uBAAY,SAACsQ,GAC1BwzB,GAAU,SAACE,GACT,IAAMC,EAAqBD,EAActhC,OACnCwhC,EAAiBF,EAAcpiC,QAAO,SAACkB,GAAD,OAAOA,EAAE3C,KAAOmQ,EAAMnQ,MAMlE,OAJI8jC,EAAqBC,EAAexhC,QAAU4N,EAAMlB,QAAQlB,SAC9DoC,EAAMlB,QAAQlB,UAGTg2B,OAER,IAEGnkC,EAAOC,sBAAW,yCACtB,iBAAOmkC,GAAP,sCAAArhC,EAAA,kEAAesM,EAAf,+BAAyB,CAAEwzB,MAAO,MAC3BiB,EAAOlkC,MAAK,SAAC89B,GAAD,OAAOA,EAAE0G,SAAWA,KADvC,0CAG2BjB,KAAKrgC,EAAKshC,GAAQhB,UAH7C,cAGYiB,EAHZ,OAKYjkC,EAAK0J,KAAKw6B,SAAS/hB,SAAS,IAAIxJ,OAAO,EAAG,GAE1CwrB,EAPZ,aAQQljC,SAAUgO,EAAQhO,UAAYA,EAC9B6N,UACAtR,QACGyR,IAGCkB,EAAQ,CACZ6zB,SACAhkC,KACAikC,SACAh1B,QAASk1B,IAGL9yB,MAAQ,kBAAMpR,EAAOkQ,IAErBi0B,EAAa,SAAbA,aACJ,GAAIj0B,EAAMlB,QAAQH,QAAS,CACzB,IAAMu1B,EAAUzoB,YAAW,WACzB3b,EAAOkQ,GACPszB,EAASpzB,QAAQi0B,OAAOb,EAASpzB,QAAQk0B,QAAQF,GAAU,KAC1Dl0B,EAAMlB,QAAQH,SAEjB20B,EAASpzB,QAAQjR,KAAKilC,GAGxBV,GAAU,SAACrmC,GAAD,OAAYimC,EAAWjmC,EAAMs9B,OAAOzqB,GAAS,CAACA,MAEpDA,EAAMlB,QAAQ6B,QAAQX,EAAMlB,QAAQ6B,UAGpB,IAAlB7B,EAAQwzB,MACV2B,IACUZ,IACVF,GAAe1nB,YACb,WACEwoB,MAEFn1B,EAAQwzB,MAAQ,EAAIxzB,EAAQwzB,MAAQA,IA7C9C,kBAgDatyB,GAhDb,kCAmDMjL,QAAQC,IAAR,MAnDN,gEADsB,sDAwDtB,CACEzC,EACA+/B,EACAiB,EACAH,EACAtiC,EACAuiC,EACAvjC,EACA6O,EACAtR,IAIEmlC,EAAQ9iC,uBAAY,WACxBgc,aAAaynB,MACZ,IAEGhzB,EAAc5R,mBAAQ,WAC1B,OAAOuR,EACHA,EAAWxH,wBACX,CACEoE,IAAK,EACLG,KAAM,EACN/I,MAAOnC,OAAOyO,WACdrM,OAAQpC,OAAO0O,eAEpB,CAACP,IArHH,EAuH6B3R,qBAAW8kC,YAAD,YAAC,eACpCH,IADmC,IAEtCvgC,UAzHD,mBAuHM8hC,EAvHN,KAuHiBhmC,EAvHjB,KA4HKimC,EAAmB7B,GACvBc,GACA,SAACvzB,GAAD,OAAWA,EAAMlB,SAAWkB,EAAMlB,QAAQhO,YAG5C,OACE,eAACshC,GAAD,CAAc1kC,MAAO,CAAE2mC,YAAWhmC,WAAUoB,OAAM+iC,SAAlD,UACG/jC,EACAsR,EAAKG,SACJiB,wBACE,cAAC,WAAD,UACGvT,OAAOC,KAAK4N,GAAWqN,KAAI,SAACxZ,GAC3B,IAAMilC,EAAY94B,EAAUnM,GAE5B,OACE,cAAC8R,GAAA,EAAD,CACEC,QAAM,EAENvC,QAAS,CAAEhO,WAAUoO,kBACrBA,eAAgBiB,EAChBI,UAAW1B,GALb,SAOGy1B,EAAiBC,GACdD,EAAiBC,GAAWzrB,KAAI,SAAC9I,GAAD,OAC9B,cAAC,GAAD,CACE3S,KAAM0Q,EAENQ,iBAAgB,2BACXA,IADW,IAEdK,QAAS,CAAE9K,MAAO,QAASC,OAAQ,WALvC,SAQE,cAAC,KAAD,CACElD,MAAK,aACHyQ,OAAQzB,GACLrD,GAAOC,gBAEZmC,QAAS,CACPlG,EAAG,EACHC,EAAG,EACH7E,MAAO,IACPC,OAAQ,KATZ,SAYE,sBAAKlD,MAAO2L,GAAOW,eAAnB,UACE,8BACE,wBACE9P,KAAK,SACLiD,QAAS,0BAAMR,EAAOkQ,IACtBnP,MAAO2L,GAAO02B,YAHhB,SAKE,cAAC,KAAD,QAGHlzB,EAAM8zB,QACL,qBACEjjC,MAAO,CACL8Q,OAAQ,UACR7N,MAAO,OACPC,OAAQ,QAJZ,SAOE,wBACEwY,MAAM,mBACNzX,IAAKvC,EAAKyN,EAAM6zB,QAAQhB,SACxB2B,YAAY,IACZC,UAAU,OACV5jC,MAAO,CAAEiD,MAAO,OAAQC,OAAQ,kBAzCrCiM,EAAMnQ,OAiDf,MA1DC0kC,QA+Dbx0B,EAAKG,YAMf1R,kBAAS6L,aAAe,CACtBwF,OAAQ,OACR/O,SAAU2K,EAAUG,UACpB+C,QAAS,EACT2zB,MAAO,IACPv0B,WAAY3B,EACZ8C,eAAgB,CACdhC,OAAQ,KAEV4C,WAAY,KACZszB,UAAU,EACVC,iBAAiB,GAGJ7lB,sBAAKhf,mBCzQLkmC,I,MAAAA,GA9Bf,SAASA,cAActL,GACrB,IAAMvqB,EAAU,SAAVA,QAAW3Q,GAAW,IAAD,EAQrB6M,eANFuG,EAFuB,EAEvBA,OACAxN,EAHuB,EAGvBA,MACAC,EAJuB,EAIvBA,OACA8Z,EALuB,EAKvBA,eACAtb,EANuB,EAMvBA,KACAygB,EAPuB,EAOvBA,UAGMsW,EAA0Bp7B,EAA1Bo7B,aAAiBC,EAVA,aAUSr7B,EAVT,kBAWzB,OACE,cAACk7B,EAAD,2BACMG,GADN,IAEEh3B,KAAMA,EACNsb,eAAgBA,EAChBmF,UAAWA,EACX1R,OAAQA,EACRxN,MAAOA,EACPC,OAAQA,EACRyK,IAAK8qB,MAKX,OAAOE,sBAAW,SAACt7B,EAAOsQ,GACxB,OAAO,cAACK,EAAD,2BAAa3Q,GAAb,IAAoBo7B,aAAc9qB,SCjBvChC,GAAS4C,YAAH,g+BAuDNu1B,GAAav1B,YAAH,6fAuBhB,SAASw1B,aAAT,GAOI,IANFtzB,EAMC,EANDA,OACAxN,EAKC,EALDA,MACAC,EAIC,EAJDA,OACA8Z,EAGC,EAHDA,eACAtb,EAEC,EAFDA,KACAygB,EACC,EADDA,UAEIliB,EAAWnC,qBAAW2L,GADzB,EAE8B3L,qBAAWgI,GAAlC0C,EAFP,EAEOA,OAAQC,EAFf,EAEeA,KAAMzC,EAFrB,EAEqBA,KACdiX,EAAWtS,WAAXsS,OACAilB,ENjGH,SAAS8B,eACd,OAAOlmC,qBAAWwjC,IAAakC,UMgGVQ,GAAb9B,SACiBjkB,GAAcjB,EACnCtb,EAAKsb,EAAeQ,OAAOC,KAC3B,IAFIS,gBAIF8W,EAASX,yBAAyBlS,GAElC8hB,EAAYplC,uBAChB,SAACqlC,GACC,GAAIlnB,EAAgB,CAClB,IAAMmnB,EAASC,aACb1iC,EAAKsb,EAAeQ,OAAO9b,KAAKmG,EAChCoV,IAASS,OAAOwmB,IAElB,OAAOxiC,EAAKsb,EAAeQ,OAAO9b,KAAKoG,EAAEq8B,GAE3C,OAAO,IAET,CAACnnB,EAAgBtb,EAAMub,IAGzB,OAAIilB,EAEA,oBAAK3zB,IAAKu1B,GAAV,SACE,qBAAMx9B,UAAU,OAAhB,SAAwB47B,OAM3BjiC,GACDA,EAAS6H,EAAI2I,EAAO5E,KACpB5L,EAAS4H,EAAI4I,EAAOzE,MACpB/L,EAAS4H,EAAI5E,EAAQwN,EAAO3E,OAC5B7L,EAAS6H,EAAI5E,EAASuN,EAAO1E,OAEtB,oBAAKwC,IAAK5C,KAIjB,oBAAK4C,IAAK5C,GAAV,UACE,aAAC,KAAD,IACA,8BACE,qBAAMrF,UAAU,QAAhB,kBACA,qBAAMA,UAAU,QAAhB,SAAyB0uB,EAAO/X,IAASS,OAAOzd,EAAS4H,MACzD,qBAAMvB,UAAU,OAAhB,oBAED0W,GAAkBiB,GACjB,8BACE,qBAAM3X,UAAU,QAAhB,kBACA,qBAAMA,UAAU,eAAhB,SACG0uB,EAAO/X,IAASS,OAAOzd,EAAS4H,GAAKoW,EAAW,QAEnD,qBAAM3X,UAAU,OAAhB,mBAIM,aAATN,GACC,8BACE,qBAAMM,UAAU,QAAhB,0BACA,qBAAMA,UAAU,QAAhB,UACI2W,IAASS,OAAOlV,GAAUyU,IAASS,OAAOjV,IAAO47B,YAAY,QAIpErnB,GACC,aAAC,WAAD,WACGiB,GAAsB,aAATjY,GACZ,8BACE,qBAAMM,UAAU,QAAhB,yBACA,qBAAMA,UAAU,QAAhB,WAEK2W,IAASS,OAAOlV,GAAUyU,IAASS,OAAOjV,IAC3CwV,GACAomB,YAAY,QAIV,aAATr+B,GACC,8BACE,qBAAMM,UAAU,QAAhB,sBACA,qBAAMA,UAAU,QAAhB,WAEK29B,EAAUz7B,IAAWy7B,EAAUx7B,IAASssB,OAAOuP,WAChD,KACAzlB,QAAQ,GAJZ,aAWP7B,GACC,aAAC,WAAD,WACE,oBAAK1W,UAAU,cACf,aAAC,KAAD,IACA,8BACE,qBAAMA,UAAU,QAAhB,kBACA,qBAAMA,UAAU,eAAhB,SACG0uB,EAAOiP,EAAUhkC,EAAS4H,eAS1Bg8B,UAAclnB,eAAKonB,eC3M5Bp4B,GAAS,CACb/L,UAAW,CACTK,SAAU,WACV+L,KAAM,OACNH,IAAK,QAEPhP,MAAO,CACLoG,MAAO,OACPiJ,QAAS,eACTuE,OAAQ,QACR4K,SAAU,QAEZkpB,eAAgB,CACdthC,MAAO,OACPC,OAAQ,MACRshC,aAAa,YACbt4B,QAAS,eACTu4B,aAAc,OAEhBjtB,KAAM,CACJ6D,SAAU,SAId,SAASqpB,SAAT,GAA8B,IAAVziB,EAAS,EAATA,MACVhF,EAAWtS,WAAXsS,OACFhd,EAAWnC,qBAAW2L,GAE5B,IAAKwT,IAAWhd,EACd,OAAO,KAGT,IAAMkkC,EAASC,aAAkBniB,EAAMpa,EAAGoV,IAASS,OAAOzd,EAAS4H,IAEnE,OAAO,sBAAM7H,MAAO2L,GAAO9O,MAApB,SAA4BolB,EAAMna,EAAEq8B,KA2C9BQ,OAxCf,SAASA,iBAAkB,IAAD,EACIz6B,eAApBxI,EADgB,EAChBA,KAAMygB,EADU,EACVA,UADU,EAEevb,oBAAS,GAFxB,mBAEjB0sB,EAFiB,KAENsR,EAFM,KAGxBtmC,qBAAU,WAKR,OAJA8iC,GAAO/T,GAAG,wBAAwB,SAAC5I,GACjCmgB,EAAkBngB,MAGb,kBAAM2c,GAAO7T,IAAI,2BACvB,IAEH,IAAMsX,EAAWnnC,mBAAQ,WACvB,OACE41B,GACA5xB,EAAKuW,KACH,SAACgK,GAAD,OACEA,EAAM/V,QAAQonB,WACdrR,EAAM/V,QAAQqnB,mBACdtR,EAAMxE,KAAK4B,UAAY8C,GACrB,sBAAKniB,MAAO,CAAEkM,QAAS,SAAvB,UACE,sBACElM,MAAK,2BACA2L,GAAO44B,gBADP,IAEHO,YAAa7iB,EAAM/V,QAAQiP,UAG/B,cAACupB,SAAD,CAAUziB,MAAOA,EAAMvgB,OACvB,sBAAM1B,MAAO2L,GAAO9O,MAApB,SAA4BolB,EAAM/V,QAAQsL,SARLyK,EAAMjjB,MAWjD,MAGH,CAACmjB,EAAWzgB,EAAM4xB,IAErB,OAAKA,EAEE,qBAAKtzB,MAAO2L,GAAO/L,UAAnB,SAA+BilC,IAFf,M,UCvEnBl5B,GACI,GADJA,GAES,UAFTA,GAGS,EAHTA,GAIS,EAJTA,GAKQ,EA+ICo5B,OA5If,SAASA,cAAe,IAAD,EAUjB76B,eARFhH,EAFmB,EAEnBA,OACAD,EAHmB,EAGnBA,MACAwN,EAJmB,EAInBA,OACAuM,EALmB,EAKnBA,eACAtb,EANmB,EAMnBA,KACA2iB,EAPmB,EAOnBA,KACAgI,EARmB,EAQnBA,aACA9H,EATmB,EASnBA,cATmB,EAWM5Z,WAAnBsS,EAXa,EAWbA,OAAQ8H,EAXK,EAWLA,OAEZ9kB,EAAWnC,qBAAW2L,GACpBojB,EAAa/uB,qBAAWgI,GAdT,EAeoBc,qBAfpB,mBAedo+B,EAfc,KAeKC,EAfL,KA+ErB,OA9DA3mC,qBAAU,WAYR,IAqCM4mC,EArCe,SAAfC,aAAgBC,EAAQC,GAC5B,GACEroB,GACA/c,GACAosB,IAAiBpe,GAAQid,YAAYlsB,GACrC,CACA,IAAMiC,EAAQ,CACZgc,IAASS,OAAO2nB,EAAiBx9B,EAAIu9B,GACrCnoB,IAASS,OAAO2nB,EAAiBx9B,EAAIu9B,IACrCpO,MAAK,SAAUr1B,EAAG6C,GAClB,OAAO7C,EAAI6C,KAIPu5B,EAAer8B,EAAK43B,MAAK,SAAClf,GAAD,OAAOA,EAAEpb,KAAOge,EAAehe,MAExDsmC,EACJvH,EAAar8B,KAAKmG,EAAEivB,WAAU,SAACyO,GAAD,OAAYA,GAAUtkC,EAAM,MAAM,EAC5DukC,EAAWzH,EAAar8B,KAAKmG,EAAEivB,WACnC,SAACyO,GAAD,OAAYA,GAAUtkC,EAAM,MAGxBwkC,EAAa1H,EAAar8B,KAAKoG,EAAExH,MAAMklC,EAAUF,GACvD,GAAIG,GAAcA,EAAWlkC,OAAS,EAAG,CACvC,IAAMmkC,EAAS1iB,aAAIyiB,GACbtB,EAASsB,EAAW3O,WAAU,SAACj6B,GAAD,OAAWA,IAAU6oC,KACnDC,EAAS5H,EAAar8B,KAAKmG,EAAE29B,EAAWrB,GAC9C,MAAO,CACLt8B,EAAGoV,IAAS0oB,GACZ79B,EAAGid,EAAO/H,EAAehe,GAAtB+lB,CAA0B2gB,IAvC/B1oB,GACKuH,EAAcE,MACjBF,EAAcG,SACX1H,EAAeQ,MAAQ,GAAK+G,EAAc1nB,MAI5C,GAiCDsnC,OAAQqB,EAAWrB,IAIzB,OAAO,KAGqBgB,CAAa,GAAIllC,GAC/CglC,EAAYC,KACX,CACDloB,EACAtb,EACA2iB,EACApkB,EACAgd,EACA8H,EACAsH,EACA9H,IAIA8H,IAAiBpe,GAAQid,YAAYlsB,KACpCgmC,IACAhoB,GACmB,aAApB6P,EAAW7mB,OACV/F,GACDA,EAAS6H,EAAI2I,EAAO5E,KACpB5L,EAAS+L,KAAOyE,EAAOzE,MACvB/L,EAAS4H,EAAI5E,EAAQwN,EAAO3E,OAC5B7L,EAAS6H,EAAI5E,EAASuN,EAAO1E,OAEtB,KAIP,qBAEE/L,MAAO,CACL8Q,OAAQ,YACR3D,UAAU,aAAD,OAAe63B,EAAkBn9B,EAAjC,eAAyCm9B,EAAkBl9B,EAA3D,OACT+jB,gBAAiB,WACjB5rB,SAAU,WACV4L,MAAOF,GAAgBA,IACvBK,OAAQL,GAAgBA,IACxBzL,cAAe,OACfkO,SAAU,WAVd,SAaE,sBACEnL,MAAuB,EAAhB0I,GAAwC,EAApBA,GAC3BzI,OAAwB,EAAhByI,GAAwC,EAApBA,GAF9B,UAIE,wBACEi6B,GAAIj6B,GAAgBA,GACpBk6B,GAAIl6B,GAAgBA,GACpBm6B,EAAGn6B,GACH6gB,OAAQ7gB,GACRghB,YAAahhB,GACbwlB,YAAaxlB,KAEf,sBACEmhB,GAAInhB,GAAgBA,GACpBohB,GAAIphB,GACJqhB,GAAIrhB,GAAgBA,GACpBshB,GAAoB,EAAhBthB,GAAoBA,GACxB6gB,OAAQ7gB,GACRghB,YAAahhB,KAEf,sBACEmhB,GAAInhB,GACJohB,GAAIphB,GAAgBA,GACpBqhB,GAAoB,EAAhBrhB,GAAoBA,GACxBshB,GAAIthB,GAAgBA,GACpB6gB,OAAQ7gB,GACRghB,YAAahhB,SAtCb,gBC5GJA,GACO,CACTkgB,gBAAiB,WACjB5rB,SAAU,WACV4L,IAAK,MACLG,KAAM,MACN/I,MAAO,EACPgJ,gBAAiB,OAoBN85B,OAhBf,SAASA,oBAAqB,IAAD,EACa77B,eAAhChH,EADmB,EACnBA,OAAQmpB,EADW,EACXA,aAAc2Z,EADH,EACGA,MACtB/oB,EAAWtS,WAAXsS,OAER,OAAIhP,GAAQuc,gBAAgBxrB,KAAOqtB,EAAqB,KAEtD,qBACErsB,MAAK,2BACA2L,IADA,IAEHwB,UAAU,aAAD,OAAe8P,IAAS+oB,GAAxB,YACT9iC,OAAQA,OCjBVlD,GAAQ,CACZ8Q,OAAQ,YACR+a,gBAAiB,eACjB5rB,SAAU,WACV4L,IAAK,QACLG,KAAM,QACN9L,cAAe,OACfkO,SAAU,UACVsC,WAAY,QAqDCu1B,OAlDf,SAASA,gBAAiB,IAAD,EACiC/7B,eAAhDhH,EADe,EACfA,OAAQD,EADO,EACPA,MAAOwN,EADA,EACAA,OAAQ/O,EADR,EACQA,KAAMsb,EADd,EACcA,eAC7BC,EAAWtS,WAAXsS,OAEFhd,EAAWnC,qBAAW2L,GACtBojB,EAAa/uB,qBAAWgI,GACxBogC,EAAqBxoC,mBAAQ,WAIjC,OAHqBsf,EACjBtb,EAAK43B,MAAK,SAAClf,GAAD,OAAOA,EAAEpb,KAAOge,EAAehe,MACzC,OAEH,CAACge,EAAgBtb,IACdszB,EAASX,yBACb6R,GAAsBA,EAAmBzoB,KAAK4B,SAG1C8mB,EAAYtnC,uBAChB,SAACunC,GACC,GAAIF,EAAoB,CACtB,IAAMG,EAAUppB,IAASS,OAAO0oB,GAChC,OAAOpR,EAAOqR,MAGlB,CAACH,EAAoBlR,EAAQ/X,IAG/B,OACGD,GACmB,aAApB6P,EAAW7mB,OACV/F,GACDA,EAAS6H,EAAI2I,EAAO5E,KACpB5L,EAAS4H,EAAI4I,EAAOzE,MACpB/L,EAAS4H,EAAI5E,EAAQwN,EAAO3E,OAC5B7L,EAAS6H,EAAI5E,EAASuN,EAAO1E,OAEtB,KAGP,qBAEE/L,MAAK,2BACAA,IADA,IAEHmN,UAAU,aAAD,OAAelN,EAAS4H,EAAxB,eAAgC5H,EAAS6H,EAAzC,SAJb,SAOE,+BAAOq+B,EAAUlmC,EAAS4H,MANtB,kBCsPKy+B,OApQf,SAASA,WAAY,IAENC,EACT/7B,iBADF0B,QAAWq6B,QAEPjqC,EAAQ4N,eAEZmiB,EAcE/vB,EAdF+vB,aACAlT,EAaE7c,EAbF6c,UACAzX,EAYEpF,EAZFoF,KACA2iB,EAWE/nB,EAXF+nB,KACOmiB,EAULlqC,EAVF2G,MACQwjC,EASNnqC,EATF4G,OACAuN,EAQEnU,EARFmU,OACAuM,EAOE1gB,EAPF0gB,eACAoH,EAME9nB,EANF8nB,QACAD,EAKE7nB,EALF6nB,SACAjB,EAIE5mB,EAJF4mB,QACAN,EAGEtmB,EAHFsmB,SACA2B,EAEEjoB,EAFFioB,cACA2O,EACE52B,EADF42B,aAGI11B,EAAW6M,cACX8E,EAAQzD,IAvBI,EAwBkBpO,qBAClC0nB,aACAF,IA1BgB,mBAwBX4hB,EAxBW,KAwBCC,EAxBD,KA6BlBroC,qBAAU,WACRqoC,EAAc,CACZnqC,KAAMqoB,GACN3B,UACAN,WACAwB,UACAD,WACA1T,SACAvN,OAAQujC,EACRxjC,MAAOujC,EACPjiB,gBACAF,WAED,CACDoiB,EACAh2B,EACA4T,EACAE,EACAiiB,EACApiB,EACAD,EACAjB,EACAN,IAGF,IAAMgkB,EAAiB/nC,uBACrB,SAACgoC,GAWC,GAAIA,EAAU3/B,OACZ,OAAQmlB,GACN,KAAKpe,GAAQud,cAAcxsB,GACpBunC,EAAQO,0BACX33B,EAAMvQ,KACJ,cAAC,GAAD,aACE8C,KAAMA,EACNsb,eAAgBA,EAChBC,OAAQypB,EAAWzpB,QACf4pB,IAEN,CACE95B,QAAS,mBACPoC,EAAMkB,gBAUb,GAAIw2B,EAAU5/B,SACnB,OAAQolB,GACN,KAAKpe,GAAQkd,SAASnsB,GACpBxB,EAAS,aACPhB,KAAM+V,IACHs0B,IAEL,MACF,KAAK54B,GAAQud,cAAcxsB,GACzBxB,EAAS,aACPhB,KAAM4Y,IACHyxB,IAEL,MACF,KAAK54B,GAAQ2d,wBAAwB5sB,GACnCxB,EAAS,aACPhB,KAAMyZ,IACH4wB,IAEL,MAEF,KAAK54B,GAAQid,YAAYlsB,GACvBxB,EAAS,aACPhB,KAAM+U,IACHs1B,IAEL,MACF,SA5DmB,SAAjBE,iBAAwB,IACpBv+B,EAAiBq+B,EAAjBr+B,OAAQC,EAASo+B,EAATp+B,KACVu+B,EAAYN,EAAWzpB,SAASS,OAAOlV,GACvCy+B,EAAUP,EAAWzpB,SAASS,OAAOjV,GAC3C24B,GAAO5T,KAAK,WAAZ,2BACKqZ,GADL,IAEE5lC,MAAO,CAAC+lC,EAAWC,GAASjQ,UAuD1B+P,QAKJ,OAAQ1a,GACN,KAAKpe,GAAQwd,mBAAmBzsB,GAC9BxB,EAAS,CACPhB,KAAMqY,GACNoZ,KAAM,CAAEzrB,KAAMqkC,EAAUr+B,OAAQmV,GAAIkpB,EAAUp+B,QAEhD,MAEF,QACsB,MAAhB4jB,GACF7uB,EAAS,aAAEhB,KAAM6W,IAAcwzB,OAMzC,CAACH,EAAYra,EAAcka,EAASp3B,EAAOzN,EAAMsb,EAAgBxf,IAG7D0pC,EAAsBroC,uBAAY,WACtCrB,EAAS,CAAEhB,KAAM0V,GAAei1B,SAAUplB,OACzC,CAACvkB,IAEE4pC,EAAavoC,uBACjB,SAAC+G,GACC,OAAQymB,GACN,KAAKpe,GAAQkd,SAASnsB,GACpBxB,EAAS,aAAEhB,KAAM+W,IAAyB3N,IAC1C,MAEF,QAGE,YAFApI,EAAS,aAAEhB,KAAMkW,IAAoB9M,OAK3C,CAACpI,EAAU6uB,IAGPgb,EAAaxoC,uBACjB,SAACoB,GASC,GAAIA,EAASgH,SACX,OAAQolB,GACN,KAAKpe,GAAQid,YAAYlsB,GACvBxB,EAAS,CACPhB,KAAM8U,GACN+zB,iBAAkBplC,SAOxB,OAAQosB,GACN,KAAKpe,GAAQuc,gBAAgBxrB,GAC3BxB,EAAS,CACPhB,KAAMwX,GACN/T,SAAUA,EAAS4H,IAErB,MACF,IAAK,YACC5H,EAASgH,UA5BI,SAAjB8/B,iBACJ,IAAMO,EAAOZ,EAAWzpB,SAASS,OAAOzd,EAAS4H,GACjDu5B,GAAO5T,KAAK,aAAZ,2BACKvtB,GADL,IAEEqnC,UAyBIP,MAQV,CAACvpC,EAAUkpC,EAAYra,IAxMP,EA2MyBkb,aAAQ,WACjD,OACE,eAAC,WAAD,WACE,cAAC,GAAD,CAASpuB,UAAWA,IAEnBzX,GAAQA,EAAKH,OAAS,GACrB,cAAC8E,aAAD,CACEE,QAASqgC,EACTngC,cAAeygC,EACfznC,QAAS4nC,EACT7gC,OAAQ4gC,EACRpnC,MAAO,CACLiD,MAAO,OACPC,OAAQ,OACRuN,OAAQ,OACRxQ,SAAU,WACVmO,SAAU,UAVd,SAaE,eAACzE,aAAD,CACE3J,MAAO,CAAEiD,MAAO,OAAQC,OAAO,OAASjD,SAAU,YADpD,UAGE,cAAC,GAAD,IACA,cAAC,GAAD,IACA,cAAC,GAAD,CAASgsB,UAAWF,KACpB,cAAC,GAAD,IACA,cAAC,GAAD,IACA,cAAC,GAAD,IACA,cAAC,GAAD,IACA,cAAC,GAAD,CACE9oB,MAAOujC,EACPtjC,OAAQujC,EACRh2B,OAAQA,EACR4T,KAAMA,EACN6O,aAAcA,cAOzB,IApPe,mBA2MXsU,EA3MW,YA2MMvkC,EA3MN,EA2MMA,MAAOC,EA3Mb,EA2MaA,OA3Mb,EAsPgB0D,qBAtPhB,mBAsPX6gC,EAtPW,KAsPAC,EAtPA,KAiQlB,OAVAC,aAAY,kBAAMD,EAAa,CAAEzkC,QAAOC,aAAW,IAAK,CAACD,EAAOC,IAChE5E,qBAAU,WACJmpC,GAAaG,SAASH,EAAUxkC,QAAU2kC,SAASH,EAAUvkC,SAC/D1F,EAAS,aACPhB,KAAMsV,IACH21B,MAGN,CAACjqC,EAAUiqC,IAEP,cAAC/8B,EAAD,CAAe7N,MAAO6pC,EAAtB,SAAmCc,KC7StCK,GAAS,CACbC,OAAQ,SACRC,QAAS,UACTC,UAAW,aA0Bb,SAASC,YAAY/lB,EAAW2kB,GAC9B,cAAkB9pC,OAAOC,KAAKklB,GAA9B,eAA0C,CAArC,IAAMzjB,EAAG,KACZ,GACEooC,EAAUr+B,QAAU0Z,EAAUzjB,GAAK+J,QACnCq+B,EAAUr+B,QAAU0Z,EAAUzjB,GAAKgK,MACnCo+B,EAAU19B,QAAU+Y,EAAUzjB,GAAK0K,QACnC09B,EAAU19B,QAAU+Y,EAAUzjB,GAAKyK,KAEnC,OAAOzK,EAGX,OAAO,KC7BT,SAASypC,YAAY7qC,GAAQ,IACnB4F,EAA2B5F,EAA3B4F,MAAOwN,EAAoBpT,EAApBoT,OAAQ2T,EAAY/mB,EAAZ+mB,QACvB,OAAOvB,aAAYuB,EAAS,CAACnhB,EAAQwN,EAAO3E,MAAO2E,EAAOzE,OAY5D,SAASm8B,YAAY9qC,GAAyB,IAAlBo1B,EAAiB,wDACnCvvB,EAA4B7F,EAA5B6F,OAAQuN,EAAoBpT,EAApBoT,OAAQyS,EAAY7lB,EAAZ6lB,QACxB,OAAOL,aACLK,EACAuP,EACI,CAACvvB,EAASuN,EAAO1E,OAAQ0E,EAAO5E,KAChC,CAAC4E,EAAO5E,IAAK3I,EAASuN,EAAO1E,SAyBrC,SAASq8B,YAAYllB,EAAShgB,GAAsB,IAAduN,EAAa,uDAAJ,GAC7C,OAAOoS,aAAYK,EAAS,CAAChgB,EAASuN,EAAQA,ICjDhD,SAAS43B,cAAT,GAAyD,IAA5B3lB,EAA2B,EAA/B1jB,GAAgB0iB,EAAe,EAAfA,KAAMvG,EAAS,EAATA,MAAS,EASlDjR,eAPFuG,EAFoD,EAEpDA,OACAxN,EAHoD,EAGpDA,MACAC,EAJoD,EAIpDA,OACAkhB,EALoD,EAKpDA,QACAlB,EANoD,EAMpDA,QACAolB,EAPoD,EAOpDA,SACAtrB,EARoD,EAQpDA,eAGIqV,EAAc7nB,iBAEdjM,EAAWb,mBAAQ,WACvB,OAA0B,OAAnBsf,GAEH0F,IAAe1F,EAAehe,KAGjC,CAACge,EAAgB0F,IA2BpB,IAAMhhB,EAAOhE,mBAAQ,WACnB,OAAOu2B,IAAIqU,EAAD,UAAc5lB,EAAd,YAA4BhB,GAAQ,MAC7C,CAAC4mB,EAAU5mB,EAAMgB,IACpB,OACE,sBACEvI,KAAK,OACLqS,OAAQrR,EACRwR,YAAY,IACZ3sB,MAAO,CACLG,QAAS5B,EACL,EACA01B,IAAI5B,EAAa,wCAAyC,KAEhEjY,EAtCJ,SAASmuB,iBAAiB7mC,GAIxB,IAHA,IAAMqyB,EAAUmU,YAAY,CAAEz3B,SAAQxN,QAAOmhB,YACvC4P,EAAUmU,YAAY,CAAE13B,SAAQvN,SAAQggB,YAC1C4P,EAAO,GACFxxB,EAAI,EAAGA,EAAII,EAAKH,OAAQD,IAC/B,GAAII,EAAKJ,GAAGknC,MAAO,CACjB,IAAMA,EAAQ9mC,EAAKJ,GAAGknC,MACtB,GAAIA,EAAMjnC,OAAS,IACjB,IAAK,IAAID,EAAI,EAAGA,EAAIknC,EAAMjnC,OAAQD,GAAK,EACrCwxB,GAAI,WAAQiB,EAAQyU,EAAMlnC,IAAtB,YAA6B0yB,EAAQwU,EAAMlnC,EAAI,IAA/C,KACJwxB,GAAI,WAAQiB,EAAQyU,EAAMlnC,EAAI,IAA1B,YAAiC0yB,EAAQwU,EAAMlnC,EAAI,IAAnD,SAGH,CACLwxB,GAAI,WAAQiB,EAAQryB,EAAKJ,GAAG,GAAGuG,GAA3B,YAAiCmsB,EAAQtyB,EAAKJ,GAAG,GAAGwG,GAApD,KACJ,IAAK,IAAI4W,EAAI,EAAGA,EAAIhd,EAAKJ,GAAGC,OAAQmd,IAClCoU,GAAI,WAAQiB,EAAQryB,EAAKJ,GAAGod,GAAG7W,GAA3B,YAAiCmsB,EAAQtyB,EAAKJ,GAAGod,GAAG5W,GAApD,KAOV,OAHKgrB,IAAMA,EAAO,SAClBA,GAAQ,IAiBHyV,CAAiB7mC,KAkCX+mC,I,GAAAA,GA7Bf,SAASA,WAAY,IAAD,EACav+B,eAAvBxI,EADU,EACVA,KAAMwxB,EADI,EACJA,aAEd,OACE,mBAAGS,SAAQ,eAAUT,EAAV,kBAAwC5sB,UAAU,WAA7D,SACG5E,EACEjB,QAAO,SAACwhB,GAAD,OAAoC,IAAzBA,EAAMxE,KAAKyE,aAC7BjK,KAAI,SAACgK,EAAOzE,GAAR,OACH,8BACGyE,EAAM/V,QAAQw8B,mBACb,cAACL,cAAD,CACErpC,GAAIijB,EAAMjjB,GACV0iB,KAAK,WACLvG,MAAO8G,EAAM/V,QAAQy8B,gBAGxB1mB,EAAM/V,QAAQ08B,mBACb,cAACP,cAAD,CACErpC,GAAIijB,EAAMjjB,GACV0iB,KAAK,WACLvG,MAAO8G,EAAM/V,QAAQ28B,kBAZ3B,UAAW5mB,EAAMjjB,GAAKwe,UC9EnBsrB,GAAiB,CAC5BC,MAAO,KACPC,MAAO,MAGIC,GACL,CAAEp9B,IAAK,IAAKC,MAAO,GAAIC,OAAQ,GAAIC,KAAM,KADpCi9B,GAEL,CACJp9B,IAAK,GACLC,MAAO,GACPC,OAAQ,GACRC,KAAM,ICHJk9B,GAAY36B,YAAH,qEAsFA46B,OAjFf,SAASA,gBAAT,GAA0C,IAAfrY,EAAc,EAAdA,KAAMlyB,EAAQ,EAARA,KAAQ,EAUnCsL,eARFxI,EAFqC,EAErCA,KACAygB,EAHqC,EAGrCA,UACA1R,EAJqC,EAIrCA,OACAxN,EALqC,EAKrCA,MACAC,EANqC,EAMrCA,OACAkhB,EAPqC,EAOrCA,QACAlB,EARqC,EAQrCA,QACAkmB,EATqC,EASrCA,cATqC,EAWPxiC,mBAAS,IAXF,mBAWhCyiC,EAXgC,KAWtBC,EAXsB,KAajCrsB,EAASirB,YAAY,CAAEz3B,SAAQxN,QAAOmhB,YACtCW,EAASojB,YAAY,CAAE13B,SAAQvN,SAAQggB,YAE7C5kB,qBAAU,WACR,IAAMqlB,EAAQxB,EAAUwB,MAAM,KAC9B,GAAIylB,IAAkBN,GAAeE,OAA0B,IAAjBrlB,EAAMpiB,OAAc,CAChE,IAAM8d,EAAmB,MAATyR,EAAenN,EAAM,GAAc,MAATmN,EAAenN,EAAM,GAAK,KACpE,GAAgB,OAAZtE,EAAkB,CACpB,IAUMkqB,EAVS7nC,EACZjB,QACC,SAAC+oC,GAAD,OAC4B,IAA1BA,EAAO/rB,KAAKyE,YACiB,IAA7BsnB,EAAOt9B,QAAQonB,WACfkW,EAAO/rB,KAAK4B,UAAYA,GACG,OAA3BmqB,EAAO/rB,KAAKgsB,cAEfxxB,KAAI,SAACuxB,GAAD,OAAYA,EAAOrQ,OAAOzF,UAC9BsG,OAEA/hB,KAAI,SAACqY,GAAD,OACHA,EAAOwJ,OACJr5B,QAAO,SAACs5B,GAAD,OACNP,GAAqBh7B,MAAK,SAACkrC,GAAD,OAAW3P,EAAQS,OAASkP,QAEvDzxB,KAAI,SAAC8hB,GAAD,OAAaA,EAAQ5C,YAE7B6C,OACHsP,EAAYC,QAEZD,EAAY,SAGdA,EAAY,MAEb,CAACnnB,EAAW2O,EAAMpvB,EAAM0nC,IAE3B,IAAMO,EAAkBjsC,mBAAQ,WAC9B,IAAa,IAATkB,GAAiByqC,EAAS9nC,OAAS,EAwBrC,OAvBc8nC,EAASpxB,KAAI,SAAC2xB,EAAQtoC,GAClC,MAAgB,MAATwvB,EACL,qBACEviB,IAAK26B,GAGLpc,GAAI7P,EAAO2sB,GACX5c,GAAI/P,EAAO2sB,GACX7c,GAAIhI,EAAO7B,EAAQ,IACnB+J,GAAIlI,EAAO7B,EAAQ,KAPrB,wBAGwB4N,GAHxB,OAG+BxvB,IAMpB,MAATwvB,EACF,qBACEviB,IAAK26B,GAGLpc,GAAI7P,EAAOmH,EAAQ,IACnB4I,GAAI/P,EAAOmH,EAAQ,IACnB2I,GAAIhI,EAAO6kB,GACX3c,GAAIlI,EAAO6kB,IAPb,wBAGwB9Y,GAHxB,OAG+BxvB,IAM7B,UAIP,CAACwvB,EAAMuY,EAAUpsB,EAAQ8H,EAAQnmB,EAAMwlB,EAASlB,IAEnD,OAAO,2BAAIymB,KCtFb,SAASE,YAAT,GAA+D,IAAhCC,EAA+B,EAAvCr5B,OAA2B+iB,EAAY,EAAlB9xB,KAAkB,EAOxDwI,eALM6/B,EAFkD,EAE1D7mC,OACAuN,EAH0D,EAG1DA,OACAyS,EAJ0D,EAI1DA,QACAN,EAL0D,EAK1DA,SACAsQ,EAN0D,EAM1DA,aAGIhwB,EAASuN,EAAOzE,KAEhB8nB,EAAQp2B,mBAAQ,WACpB,GAAI81B,EAAU,CACZ,IAAMvW,EAASkrB,YAAY,CACzBjlC,OAAQ6mC,EACR7mB,QAAS,CAACA,EAAQ,GAAIA,EAAQ,IAC9BzS,WAEIsU,EAASqjB,YAAYxlB,EAAS4Q,EAASx0B,IAAKkE,EAAQ4mC,GAN9C,EAQKtW,EAAS9xB,KAAlBmG,EARI,EAQJA,EAAGC,EARC,EAQDA,EACL6qB,EAAaC,aACjB,CAAE/qB,IAAGC,KACL,CACEtF,KAAM0gB,EAAQ,GACdvF,GAAIuF,EAAQ,KAGV8mB,EAAarX,EAAW9qB,EAAEtG,OAAS,EACnC0oC,EAAatX,EAAW7qB,EAAEvG,OAAS,EACrCuxB,EAAI,aAAS/N,EAAO4N,EAAW7qB,EAAEmiC,IAA7B,YAA6ChtB,EACnD+sB,GADM,KASR,OANAlX,GAAQH,EAAW9qB,EAChBvH,MAAM,EAAG0pC,GACTE,aAAY,SAACnX,EAAaC,EAAOxV,GAEhC,OADAuV,GAAW,cAAWhO,EAAO4N,EAAW7qB,EAAE0V,IAA/B,YAA0CP,EAAO+V,MAE3D,IAGL,OAAO,OAER,CAAC9vB,EAAQuN,EAAQq5B,EAAaC,EAAcvW,EAAUtQ,EAASN,IAE5DunB,EAAaJ,EAAet5B,EAAO1E,OAAS0E,EAAO5E,IAEzD,OAAKs+B,GAAejnC,EAGlB,sBACEgX,QAAO,cAAShX,EAAT,YAAmBinC,EAAa15B,EAAO5E,KAC9C5I,MAAOC,EACPA,OAAQinC,EAAa15B,EAAO5E,IAH9B,UAKE,+BACE,0BAAU7M,GAAE,UAAKk0B,EAAL,aAAZ,SACE,sBAAMjwB,MAAOC,EAAQA,OAAQinC,EAAYtiC,EAAE,IAAIC,EAAG2I,EAAO5E,UAG7D,mBAAG8nB,SAAQ,eAAUT,EAAV,cAAX,SACE,sBAAM5sB,UAAU,OAAOkmB,OAAO,QAAQrS,KAAK,OAAOC,EAAG0Z,SAdxB,KAoBrC+V,YAAYrgC,aAAe,CACzBiH,OAAQ,IAGKkM,sBAAKktB,aCvEpB,SAASO,WAAT,GAA8D,IAAhCC,EAA+B,EAAvC55B,OAA2B+iB,EAAY,EAAlB9xB,KAAkB,EAOvDwI,eALFjH,EAFyD,EAEzDA,MACQqnC,EAHiD,EAGzD75B,OACA2T,EAJyD,EAIzDA,QACAxB,EALyD,EAKzDA,SACAsQ,EANyD,EAMzDA,aAGIhwB,EAASonC,EAAaz+B,IAEtBioB,EAAQp2B,mBAAQ,WACpB,GAAI81B,EAAU,CACZ,IAAMvW,EAASirB,YAAY,CAAEjlC,QAAOmhB,UAAS3T,OAAQ65B,IAE/CvlB,EAASqjB,YAAYxlB,EAAS4Q,EAASx0B,IAAKkE,EAAQmnC,GAH9C,EAKK7W,EAAS9xB,KAAlBmG,EALI,EAKJA,EAAGC,EALC,EAKDA,EACL6qB,EAAaC,aACjB,CAAE/qB,IAAGC,KACL,CACEtF,KAAM4hB,EAAQ,GACdzG,GAAIyG,EAAQ,KAIZ0O,EAAI,YAAQ7V,EAAO0V,EAAW9qB,EAAE,IAA5B,YAAmCkd,EAAO4N,EAAW7qB,EAAE,IAAvD,KAKR,OAJAgrB,GAAQH,EAAW9qB,EAAEvH,MAAM,GAAG+hB,QAAO,SAAC0Q,EAAaC,EAAO1xB,GAExD,OADAyxB,GAAW,aAAU9V,EAAO+V,GAAjB,YAA2BjO,EAAO4N,EAAW7qB,EAAExG,EAAI,OAE7D,IAGH,OAAO,OAER,CAAC4B,EAAQmnC,EAAaC,EAAc9W,EAAUvwB,EAAOmhB,EAASxB,IAEjE,OAAK3f,GAAUC,EAKb,sBAAKgX,QAAO,cAASjX,EAAT,YAAkBC,GAAUD,MAAOA,EAAOC,OAAQA,EAA9D,UACE,+BACE,0BAAUlE,GAAE,UAAKk0B,EAAL,YAAZ,SACE,sBACEjwB,MAAOA,EAAQqnC,EAAat+B,KAAOs+B,EAAax+B,MAChD5I,OAAQA,EACR2E,EAAGyiC,EAAat+B,KAChBlE,EAAC,UAAK,SAIZ,mBAAG6rB,SAAQ,eAAUT,EAAV,aAAX,SACE,sBACE5sB,UAAU,OACVkmB,OAAO,MACPrS,KAAK,OACLwS,YAAY,MACZvS,EAAG0Z,SArBF,KA4BXsW,WAAW5gC,aAAe,CACxBiH,OAAQ,IAGKkM,I,GAAAA,kBAAKytB,YCnEd/S,GAAa9oB,YAAH,mMAahB,SAASgpB,YAAT,GAAsD,IAArC34B,EAAoC,EAApCA,KAAMmsB,EAA8B,EAA9BA,MAAesf,EAAe,EAAvB55B,OACtBnU,EAAQ4N,eAEZka,EAME9nB,EANF8nB,QACAlhB,EAKE5G,EALF4G,OACAD,EAIE3G,EAJF2G,MACAwN,EAGEnU,EAHFmU,OACAiT,EAEEpnB,EAFFonB,kBACAvB,EACE7lB,EADF6lB,UAGIsV,EAAU7pB,mBAEhBtP,qBAAU,WACR,IAAMuqB,EAAQ+I,OAAgB+F,MAAM,GAAGC,WAAWhG,KAAU,MAE5D,GAAIhzB,EAAM,CACR,IAAMqe,EAASirB,YAAY,CAAEjlC,QAAOwN,SAAQ2T,YAC5CwN,KAAU6F,EAAQpoB,SAAS9O,KAAKsoB,EAAMhI,MAAM5D,OAE7C,CACDkF,EACAjf,EACAuN,EACAA,EAAO1E,OACP0E,EAAOzE,KACPyE,EAAO3E,MACP2E,EAAO5E,IACPjN,EACA8kB,EACAzgB,EACAmhB,IAGF,IAAM2T,EAAOr6B,mBACX,kBACEkB,IACS,IAATA,GACE,kBACE0H,UAAU,IACViI,IAAK8oB,GACLlqB,UAAS,sBACPjK,GAAUuN,EAAO1E,OAASs+B,EAAYt+B,QAD/B,KAGT4B,IAAK8pB,EANP,SAQE,qBAAMtd,KAAK,OAAOtS,EAAG5E,EAAQ,GAAI6E,EAAE,KAAKwuB,GAAG,SAAS0B,WAAW,MAA/D,SACGjN,QAKT,CAAC7nB,EAAQ6nB,EAAOta,EAAO1E,OAAQs+B,EAAYt+B,OAAQnN,EAAMqE,IAG3D,OAAKA,GAAUC,EAIR60B,EAHE,KAMXR,YAAMW,UAAY,CAChBznB,OAAQ0nB,KAAUoS,MAAM,CACtB1+B,IAAKssB,KAAUoN,OAAOiF,WACtB1+B,MAAOqsB,KAAUoN,OAAOiF,WACxBz+B,OAAQosB,KAAUoN,OAAOiF,WACzBx+B,KAAMmsB,KAAUoN,OAAOiF,aAEzB5rC,KAAMu5B,KAAUC,KAChBrN,MAAOoN,KAAUE,QAGnBd,YAAM/tB,aAAe,CACnB5K,MAAM,EACNmsB,MAAO,eACPta,OAAQ,CAAE3E,MAAO,IAAKD,IAAK,EAAGG,KAAM,EAAGD,OAAQ,IAGlC4Q,I,GAAAA,kBAAK4a,aC7FdF,GAAa9oB,YAAH,6ZAiBhB,SAASk8B,MAAT,GAAsD,IAArC7rC,EAAoC,EAApCA,KAAMmsB,EAA8B,EAA9BA,MAAesf,EAAe,EAAvB55B,OACtBgnB,EAAU7pB,mBACVtR,EAAQ4N,eAEZgZ,EAME5mB,EANF4mB,QACAjgB,EAKE3G,EALF2G,MACAC,EAIE5G,EAJF4G,OACAif,EAGE7lB,EAHF6lB,UACAuB,EAEEpnB,EAFFonB,kBACAjT,EACEnU,EADFmU,OAGFnS,qBAAU,WACR,IAAMwyB,EAAOc,OAAe+F,MAAM,GAAGC,WAAWhG,KAAU,MAE1D,GAAIhzB,GAAQskB,EAAS,CACnB,IAAM6B,EAASojB,YAAY,CAAEjlC,SAAQggB,UAASzS,WAE9CmhB,KAAU6F,EAAQpoB,SAAS9O,KAAKuwB,EAAKjQ,MAAMkE,OAE5C,CAACnmB,EAAMskB,EAASf,EAAWuB,EAAmBxgB,EAAQuN,IAEzD,IAAMsnB,EAAOr6B,mBACX,kBACEkB,IACS,IAATA,GACE,aAAC,WAAD,UACE,kBACE0H,UAAU,IACViI,IAAK8oB,GACLlqB,UAAS,oBAAelK,EAAQonC,EAAYv+B,MAAnC,KACT6B,IAAK8pB,EAJP,SAME,qBACEtd,KAAK,OACLtS,GAAIwiC,EAAYx+B,IAChB/D,IAAKuiC,EAAYv+B,MAAQ,GACzBwqB,GAAG,SACHnpB,UAAU,cACV6qB,WAAW,MANb,SAQGjN,UAMX,CAACA,EAAOsf,EAAYv+B,MAAOu+B,EAAYx+B,IAAKjN,EAAMqE,IAGpD,OAAKA,GAAUC,EAIR60B,EAHE,KAMX0S,MAAMjhC,aAAe,CACnB5K,MAAM,EACNmsB,MAAO,GACPta,OAAQ,CAAE3E,MAAO,GAAID,IAAK,EAAGE,OAAQ,EAAGC,KAAM,IAGjC2Q,sBAAK8tB,OC5BLC,I,GAAAA,GAxDf,SAASA,aAAanS,GACpB,IAAMvqB,EAAU,SAAVA,QAAW3Q,GAAW,IAAD,EASrB6M,eAPFxI,EAFuB,EAEvBA,KACAsb,EAHuB,EAGvBA,eACAoH,EAJuB,EAIvBA,QACAlB,EALuB,EAKvBA,QACAf,EANuB,EAMvBA,UACAuB,EAPuB,EAOvBA,kBACAwP,EARuB,EAQvBA,aAEIb,EAAc7nB,iBAVK,EAYuB9M,mBAAQ,WACtD,OAAIgE,GAAQsb,GAAkBA,EAAehe,GAC7B0C,EAAK43B,MAAK,SAACrX,GAAD,OAAWA,EAAMjjB,KAAOge,EAAehe,OAAO,CACpE2nB,MAAO,GACPlJ,KAAM,GACNvR,QAAS,IAIN,KACN,CAAC8Q,EAAgBtb,IAtBK,IAYjBilB,aAZiB,MAYT,GAZS,MAYLlJ,YAZK,MAYE,GAZF,MAYMvR,eAZN,MAYgB,GAZhB,EAwBnBmT,EAAU3hB,mBAAQ,WACtB,OAAIgmB,GAAqB3mB,OAAOC,KAAK0mB,GAAmBniB,OAAS,EACxDxE,OAAOC,KAAK0mB,GAEd,OACN,CAACA,IAEI+U,EAA0Bp7B,EAA1Bo7B,aAAiBC,EA/BA,aA+BSr7B,EA/BT,kBAgCzB,OACE,cAACk7B,EAAD,2BACMG,GADN,IAEE/R,MAAOA,EACPza,QAASA,EACTuR,KAAMA,EACN2G,QAASA,EACTlB,QAASA,EACTmP,YAAaA,EACblQ,UAAWA,EACX9C,QAASA,EACT6T,aAAcA,EACdvlB,IAAK8qB,MAKX,OAAO9b,eACLgc,sBAAW,SAACt7B,EAAOsQ,GACjB,OAAO,cAACK,EAAD,2BAAa3Q,GAAb,IAAoBo7B,aAAc9qB,UC9CzC+rB,GAAiB,SAAjBA,eAAkBzL,EAAM6C,GAC5B,OAVgB,SAAZ6I,UAAa1L,EAAM6C,GACvB,MAAO,GAAG8I,OACR3L,EAAK6C,GAAM+I,OAAS,GACpB5L,EAAK6L,OACD7L,EAAK6L,OAAO7hB,KAAI,SAAC8hB,GAAD,OAAaA,EAAQjJ,GAAM+I,OAAS,MAAIG,OACxD,IAKCL,CAAU1L,EAAM6C,GAAMvvB,QAGzB+4B,GAAiB,SAAjBA,eAAkBrM,EAAM6C,GAC5B7C,EAAK6C,GAAMuJ,YAAcX,GAAezL,EAAM6C,GACf,IAA3B7C,EAAK6C,GAAMuJ,oBACNpM,EAAK6C,GAAMuJ,aAIhBD,GAAc,SAAdA,YAAenM,EAAM6C,GAMzB,cALO7C,EAAK6C,GAAM+I,aACX5L,EAAKoM,YACZpM,EAAK6L,OAAOv0B,SAAQ,SAACw0B,UACZA,EAAQjJ,GAAM+I,SAEhB5L,GAaHgM,GAAS,SAATA,OAAUhM,EAAM0c,EAAexQ,EAAarJ,GAiBhD,YAhBsBlM,IAAlB+lB,QAAwC/lB,IAATkM,IACX,IAAlB6Z,SACK1c,EAAK6C,GAAM+I,WACOjV,IAAhBuV,UACFlM,EAAK6L,OAAOK,GAAarJ,GAAM+I,MAExCS,GAAerM,EAAM6C,SACHlM,IAATkM,GACTsJ,GAAYnM,EAAM6C,GAClBwJ,GAAerM,EAAM6C,IAErB,CAAC,IAAK,KAAKvrB,SAAQ,SAAC9G,GAClB27B,GAAYnM,EAAMxvB,GAClB67B,GAAerM,EAAMxvB,MAGlBwvB,GAGHwM,GAAyB,SAAzBA,uBAA0BC,EAAgB/T,EAAOmK,GACrD,IAAM6J,EAAMhU,EAAMtE,QAAO,SAACC,EAAK2L,GAK7B,OAJA3L,EAAIlkB,KAAK6vB,EAAKjvB,IACVivB,EAAK6L,QACPxX,EAAIsX,OAAO3L,EAAK6L,OAAO7hB,KAAI,SAAC6hB,GAAD,OAAYA,EAAO96B,KAAI,KAE7CsjB,IACN,IAECwO,EACF4J,EAAel9B,SAAS,CACtBhB,KAAM,aACNC,QAAS,CAAEuC,GAAI27B,EAAK7J,WAGtB4J,EAAel9B,SAAS,CACtBhB,KAAM,aACNC,QAAS,CAAEuC,GAAI27B,EAAK7J,KAAM,OAE5B4J,EAAel9B,SAAS,CACtBhB,KAAM,aACNC,QAAS,CAAEuC,GAAI27B,EAAK7J,KAAM,SChF1B8Z,GAAU,SAAVA,QAAWhW,EAAQC,GACvB,MAAM,GAAN,OAAUD,GAAV,OAH0B,OAG1B,OAAyCC,ICKrCqU,GAAY36B,YAAH,qFAsCAs8B,OAhCf,SAASA,gBAAT,GAAiD,IAAtB1T,EAAqB,EAArBA,MAAOrG,EAAc,EAAdA,KAAMlyB,EAAQ,EAARA,KAAQ,EACMsL,eAA5CuG,EADsC,EACtCA,OAAQxN,EAD8B,EAC9BA,MAAOC,EADuB,EACvBA,OAAQkhB,EADe,EACfA,QAASlB,EADM,EACNA,QAClCjG,EAASirB,YAAY,CAAEz3B,SAAQxN,QAAOmhB,YACtCW,EAASojB,YAAY,CAAE13B,SAAQvN,SAAQggB,YAEvCqJ,EAAO7uB,mBAAQ,WACnB,OAAgB,IAATkB,EACI,MAATkyB,EACE,qBACEviB,IAAK26B,GAELpc,GAAI7P,EAAOka,GACXnK,GAAI/P,EAAOka,GACXpK,GAAIhI,EAAO7B,EAAQ,IACnB+J,GAAIlI,EAAO7B,EAAQ,KANrB,qBAEqBiU,EAFrB,OAQW,MAATrG,EACF,qBACEviB,IAAK26B,GAELpc,GAAI7P,EAAOmH,EAAQ,IACnB4I,GAAI/P,EAAOmH,EAAQ,IACnB2I,GAAIhI,EAAOoS,GACXlK,GAAIlI,EAAOoS,IANb,qBAEqBA,EAFrB,OAQE,KACF,OACH,CAACrG,EAAMqG,EAAOla,EAAQ8H,EAAQnmB,EAAMwlB,EAASlB,IAEhD,OAAO,2BAAIqJ,KCTEue,I,MAAAA,GA1Bf,SAASA,gBAAT,GAAsC,IAAXhR,EAAU,EAAVA,OACnBiR,EAAgBrtC,mBAAQ,WAC5B,MAAO,CAACktC,GAAQ9Q,EAAO96B,GAAI,aAAc4rC,GAAQ9Q,EAAO96B,GAAI,kBAC3D,CAAC86B,EAAO96B,KACLgsC,EAAgBttC,mBAAQ,WAC5B,MAAO,CAACktC,GAAQ9Q,EAAO96B,GAAI,aAAc4rC,GAAQ9Q,EAAO96B,GAAI,kBAC3D,CAAC86B,EAAO96B,KACLisC,EAAaltC,aAAagtC,GAC1BG,EAAantC,aAAaitC,GAEhC,OACE,4BACE,aAAC,GAAD,CACE7T,MAAO2C,EAAOjyB,EAAEsvB,MAChBrG,KAAK,IACLlyB,KAAMqsC,EAAW1sC,WAEnB,aAAC,GAAD,CACE44B,MAAO2C,EAAOhyB,EAAEqvB,MAChBrG,KAAK,IACLlyB,KAAMssC,EAAW3sC,eC2DV4sC,GA3EAxuB,gBAAK,YAA4B,IAAzBmd,EAAwB,EAAxBA,OAAQxG,EAAgB,EAAhBA,UAAgB,EACOppB,eAA5CuG,EADqC,EACrCA,OAAQxN,EAD6B,EAC7BA,MAAOC,EADsB,EACtBA,OAAQkhB,EADc,EACdA,QAASlB,EADK,EACLA,QAClCjG,EAASirB,YAAY,CAAEz3B,SAAQxN,QAAOmhB,YACtCW,EAASojB,YAAY,CAAE13B,SAAQvN,SAAQggB,YAEvCkoB,EAAWvsC,uBAAY,SAACG,GAC5B,MAAO,CAACA,GAAI46B,OAAOgR,GAAQ5rC,EAAI,KAAM4rC,GAAQ5rC,EAAI,QAChD,IAEG87B,EAAac,cAAc9B,EAAO96B,IAClCzB,EAAYQ,aAAaqtC,EAAStQ,EAAW97B,KAC7CqsC,EAAgBxtC,eAXuB,EAaH+I,oBAAS,GAbN,mBAatC0kC,EAbsC,KAavBC,EAbuB,KAiC7C,OAlBAjtC,qBAAU,WAEN+sC,EAAc9tC,UAAUT,YAAY0B,MAAK,SAACgtC,GAAD,OACvCJ,EAAStR,EAAO96B,IAAIN,SAAS8sC,OAE/B1Q,EAAWv8B,SAEXgtC,GAAiB,GAEjBA,GAAiB,KAElB,CACDzQ,EAAWv8B,SACX6sC,EACAC,EAAc9tC,UAAUT,YACxBg9B,EAAO96B,KAGJ86B,EAGH,kBACExzB,UAAU,cACV/G,aAAc,wBACZu7B,EAAWv7B,eACXhC,EAAUqB,QAEZY,aAAc,wBACZs7B,EAAWt7B,eACXjC,EAAUuB,QARd,UAWGw0B,EAAUmY,SACT,4BACE,uBAEE7F,GAAI3oB,EAAO6c,EAAOjyB,EAAEsvB,OACpB0O,GAAI9gB,EAAO+U,EAAOhyB,EAAEqvB,OACpB2O,EAAGwF,EAAgB,EAAI,EACvBnxB,KAAMmxB,EAAgB,QAAU,aAJ3BxR,EAAO96B,IAMd,aAAC,GAAD,CAAiB86B,OAAQA,OAG7B,kBAAGxzB,UAAU,mBAAb,SACGgtB,EAAU2D,OACT6C,EAAO4R,KAAKzzB,KAAI,SAACyzB,EAAMpqC,GAAP,OACd,uBAEEskC,GAAI3oB,EAAOyuB,EAAK7jC,GAChBg+B,GAAI9gB,EAAO2mB,EAAK5jC,GAChBg+B,EAAG,EACH3rB,KAAK,SALP,UACU2f,EAAO96B,GAAKsC,YA9BZ,QCjChBgwB,GAAgB/iB,YAAH,kfAqBbgjB,GAAoBhjB,YAAH,gRAgBjBo9B,GAAO,SAAPA,KAAQ,GAA6B,IAA3BC,EAA0B,EAA1BA,SAAUtY,EAAgB,EAAhBA,UAChBzrB,EAAqB+jC,EAArB/jC,EAAGC,EAAkB8jC,EAAlB9jC,EAAG9I,EAAe4sC,EAAf5sC,GAAI86B,EAAW8R,EAAX9R,OACZ+R,EAAiBjQ,cAAc58B,GAC/B8sC,EAAgB/tC,aAAa,CAAC8tC,EAAe7sC,IAAKlD,KAAMI,MAHtB,EAIYgO,eAA5CuG,EAJgC,EAIhCA,OAAQxN,EAJwB,EAIxBA,MAAOC,EAJiB,EAIjBA,OAAQkhB,EAJS,EAITA,QAASlB,EAJA,EAIAA,QAClCjG,EAASirB,YAAY,CAAEz3B,SAAQxN,QAAOmhB,YACtCW,EAASojB,YAAY,CAAE13B,SAAQvN,SAAQggB,YAC/B4J,EAAejlB,EAArBrF,KAAcwqB,EAAOnlB,EAAX8V,GACJoP,EAAejlB,EAArBtF,KAAcyqB,EAAOnlB,EAAX6V,GARsB,EAUE/W,oBAAS,GAVX,mBAUjCg6B,EAViC,KAUlBC,EAVkB,KAgBxC,OAJAviC,qBAAU,WACRuiC,GL/BkB,SAAhBkL,cAAiB9d,GACrB,OAAOA,EAAKuM,OAASf,GK8BDsS,CAAcH,MAC/B,CAACA,IAGF,kBACEr9B,IACEu9B,EAAcvtC,UAAYstC,EAAettC,SACrCgzB,GACAD,GAGN/xB,aAAc,wBACZssC,EAAetsC,eACfusC,EAAcltC,QAEhBY,aAAc,wBACZqsC,EAAersC,eACfssC,EAAchtC,QAblB,UAgBGw0B,EAAU3M,OACT,kBAAGxZ,UAAS,oBAAe8P,EAAO6P,GAAtB,YAA6B/H,EAAOgI,GAApC,KAAZ,SACE,qBACEllB,EAAE,IACF5E,MAAOga,EAAO+P,GAAM/P,EAAO6P,GAC3B5pB,OAAQ6hB,EAAOkI,GAAMlI,EAAOgI,GAC5BzmB,UAAU,gBACV6T,KAAK,YACLqS,OAAQoU,EAAgB,UAAY,YACpCjU,YAAaiU,EAAgB,IAAM,QAIxC9G,EAAO7hB,KAAI,SAAC8hB,EAASz4B,GAAV,OACV,aAAC,GAAD,CAA0Bw4B,OAAQC,EAASzG,UAAWA,GAAtD,UAAgBt0B,EAAKsC,SAxBlBtC,IA8BX2sC,GAAKniC,aAAe,CAClBmkB,SAAU,2BAAM,OAGHge,UCzEAjB,OA1BD,SAARsB,MAAS,GAAsC,IAApCrlB,EAAmC,EAAnCA,MAAOza,EAA4B,EAA5BA,QAASgnB,EAAmB,EAAnBA,aAAmB,EACftsB,mBAAS,CAC1C+f,OAAO,EACP8kB,SAAS,EACTxU,OAAO,IAJyC,mBAC3C3D,EAD2C,KAChC2Y,EADgC,KAclD,OARA3tC,qBAAU,WACR8iC,GAAO/T,GAAG,2BAA2B,YAAc,IAAX5uB,EAAU,EAAVA,IACtCwtC,GAAc,SAACC,GAAD,mBAAC,eACVA,GADS,mBAEXztC,GAAOytC,EAAcztC,aAGzB,IAED,mBAAGk1B,SAAQ,eAAUT,EAAV,kBAAwC5sB,UAAU,WAA7D,SACG4F,EAAQonB,WACP3M,EAAM+M,OAAOzb,KAAI,SAACgW,GAAD,OACf,mBAAG3nB,UAAU,OAAb,SACE,cAAC,GAAD,CAAMslC,SAAU3d,EAAMqF,UAAWA,KADVrF,EAAKjvB,YCZxC,SAASmtC,QAAT,GAA4B,IAATzqC,EAAQ,EAARA,KAAQ,EACuBwI,eAAxCjH,EADiB,EACjBA,MAAOC,EADU,EACVA,OAAQuN,EADE,EACFA,OAAQyiB,EADN,EACMA,aAqD/B,OAnDgBx1B,mBAAQ,WACtB,OACE,sBACEwc,QAAO,cAASjX,EAAT,YAAkBC,GACzBD,MAAOA,EACPC,OAAQA,EACRlE,GAAG,SAJL,UAME,+BACE,0BAAUA,GAAE,UAAKk0B,EAAL,iBAAZ,SACE,sBACEjwB,MAAOA,EAAQwN,EAAOzE,KAAOyE,EAAO3E,MACpC5I,OAAQA,EAASuN,EAAO5E,IAAM4E,EAAO1E,OACrClE,EAAG4I,EAAOzE,KACVlE,EAAG2I,EAAO5E,UAIhB,sBACE5I,MAAOA,EAAQwN,EAAOzE,KAAOyE,EAAO3E,MACpC5I,OAAQA,EAASuN,EAAO5E,IAAM4E,EAAO1E,OACrClE,EAAG4I,EAAOzE,KACVlE,EAAG2I,EAAO5E,IACV2gB,OAAO,QACPG,YAAY,IACZxS,KAAK,gBAENzY,GAAQA,EAAK,IAAM,cAAC,GAAD,CAAYA,KAAMA,EAAK,KAC1CA,GAAQA,EAAK,IAAM,cAAC,GAAD,CAAaA,KAAMA,EAAK,KAC5C,cAAC,GAAD,IACA,cAAC,GAAD,IACA,cAAC,GAAD,CAAiBovB,KAAK,IAAIlyB,MAAI,IAC9B,cAAC,GAAD,CAAiBkyB,KAAK,IAAIlyB,MAAI,IAE9B,oBAAG0H,UAAU,YAAYtG,MAAO,CAAEE,cAAe,QAAjD,UACE,cAAC,GAAD,IACA,cAAC,GAAD,YAIL,CACD+C,EACAC,EACAgwB,EACAziB,EAAOzE,KACPyE,EAAO3E,MACP2E,EAAO5E,IACP4E,EAAO1E,OACPrK,IAKJyqC,QAAQ3iC,aAAe,CACrB4iC,kBAAmB,oCAAM,OAG3BD,QAAQE,WAAa,CACnBD,kBAAmBE,KAAWC,KAAK/B,YAGtB2B,I,GAAAA,W,UC9DTxgC,GAAS4C,YAAH,wrBAoQGw1B,OAlOf,SAASA,0BAAT,GAA2C,IAAnByI,EAAkB,EAAlBA,OAAQC,EAAU,EAAVA,OACxBxsC,EAAWnC,qBAAW2L,GADY,EAEK3L,qBAAWgI,GAAhD0C,EAFgC,EAEhCA,OAAQC,EAFwB,EAExBA,KAAMU,EAFkB,EAElBA,OAAQD,EAFU,EAEVA,KAAMlD,EAFI,EAEJA,KAFI,EAcpCkE,eAVFuG,EAJsC,EAItCA,OACAxN,EALsC,EAKtCA,MACAC,EANsC,EAMtCA,OACA8Z,EAPsC,EAOtCA,eACAoH,EARsC,EAQtCA,QACAlB,EATsC,EAStCA,QACAN,EAVsC,EAUtCA,SACAT,EAXsC,EAWtCA,UACAzgB,EAZsC,EAYtCA,KACA2qB,EAbsC,EAatCA,aAGIqgB,EACJzsC,GACAgoC,YAAYuE,EAAQ,CAClBhkC,OAAQvI,EAAS4H,EACjBsB,OAAQlJ,EAAS6H,IAGf6kC,EAAYxqB,EAAUwB,MAAM,KAvBM,EAwBb0Q,yBAAyBsY,GAxBZ,mBAwBjCC,EAxBiC,KAwBxBC,EAxBwB,KA0BlC5vB,EAASvf,mBAAQ,WACrB,IAAK+uC,GAA4B,IAAlBA,EAAOlrC,OACpB,OAAO2mC,YAAY,CAAEjlC,QAAOwN,SAAQ2T,YAEtC,GAAIiI,IAAiBpe,GAAQod,YAAYrsB,GACvC,OAAQ0tC,GACN,KAAK7E,GAAOC,OACZ,KAAKD,GAAOG,UACV,OAAOE,YAAY,CAAEjlC,QAAOwN,SAAQ2T,YAEtC,KAAKyjB,GAAOE,QACV,OAAOI,YAAY,CAAEjlC,SAAQuN,SAAQyS,YAEvC,QACE,OAAO,KAGb,OAAO,OACN,CAACupB,EAAQvpC,EAAQuN,EAAQ4b,EAAcqgB,EAASzpC,EAAOmhB,EAASlB,IAE7D6B,EAASrnB,mBAAQ,WACrB,IAAK+uC,GAA4B,IAAlBA,EAAOlrC,OACpB,OAAO4mC,YAAY,CAAEjlC,SAAQuN,SAAQyS,YAEvC,GAAImJ,IAAiBpe,GAAQod,YAAYrsB,GACvC,OAAQ0tC,GACN,KAAK7E,GAAOG,UACV,OAAOG,YAAY,CAAEjlC,SAAQuN,SAAQyS,YAEvC,KAAK2kB,GAAOC,OACV,OAAO2E,EAAO,GACVrE,YAAYxlB,EAAS6pB,EAAO,GAAGztC,IAAKyR,EAAO5E,KAC3C,KAEN,KAAKg8B,GAAOE,QACV,OAAO0E,EAAO,GACVrE,YAAYxlB,EAAS6pB,EAAO,GAAGztC,IAAKyR,EAAOzE,MAC3C,KAEN,QACE,OAAO,KAGb,OAAO,OACN,CAACygC,EAAQvpC,EAAQuN,EAAQ4b,EAAcqgB,EAASxpB,EAASN,IAE5D,IACG5F,IACA/c,GACDA,EAAS6H,EAAI,IACb7H,EAAS4H,EAAI,IACb5H,EAAS4H,EAAI5E,EAAQwN,EAAO3E,OAC5B7L,EAAS6H,EAAI5E,EAASuN,EAAO1E,OAE7B,OAAO,oBAAKwC,IAAK5C,KAEnB,IAAMmhC,EAAgB,SAAhBA,cAAiBC,GACrB,IAAIvvB,EAAQ,KAMZ,GALIkvB,IAAY7E,GAAOC,OACrBtqB,EAAQ,EACCkvB,IAAY7E,GAAOE,UAC5BvqB,EAAQ,GAEG,MAATA,GAA2B,MAAVP,EAAgB,CACnC,IAAMknB,EAASC,aACbqI,EAAOjvB,GAAO9b,KAAKmG,EACnBoV,EAAOS,OAAOqvB,IAEhB,OAAON,EAAOjvB,GAAO9b,KAAKoG,EAAEq8B,GAE9B,OAAO,GAGHgC,EAAY,SAAZA,YAA2B,IAAdt+B,EAAa,uDAAT,KACrB,GAAc,MAAVoV,EACF,OAAQyvB,GACN,KAAK7E,GAAOG,UACZ,KAAKH,GAAOC,OACV,OAAO7qB,EAAOS,OAAO7V,GAAQ5H,EAAS4H,GAExC,KAAKggC,GAAOE,QACV,OAAO9qB,EAAOS,OAAO7V,GAAQ5H,EAAS6H,GAExC,QACE,OAAO,EAGb,OAAO,GAGHm8B,EAAY,SAAZA,YACJ,GAAc,MAAVlf,EACF,OAAQ2nB,GACN,KAAK7E,GAAOG,UACZ,KAAKH,GAAOC,OACV,OAAO/iB,EAAOrH,OAAOzd,EAAS6H,GAEhC,KAAK+/B,GAAOE,QACV,OAAOhjB,EAAOrH,OAAOzd,EAAS4H,GAEhC,QACE,OAAO,EAGb,OAAO,GAmCHmlC,EAAW,SAAXA,SAAYC,EAASC,EAAS7tB,GAClC,OAAOqtB,IAAY7E,GAAOG,UACxB,aAAC,WAAD,WACGiF,EADH,MACc,aAAC,KAAD,CAAIE,GAAI9tB,IADtB,QAIA6tB,GAqBJ,OACE,oBAAK3+B,IAAK5C,GAAV,UACE,8BACE,qBAAMrF,UAAU,QAAhB,UAAyB0mC,EAAS,KAAM,IAAKL,EAAU,IAAvD,QACA,qBAAMrmC,UAAU,QAAhB,SAAyBsmC,EAAQzG,OACjC,qBAAM7/B,UAAU,OAAhB,oBAGF,8BACE,qBAAMA,UAAU,QAAhB,UAAyB0mC,EAAS,KAAM,IAAKL,EAAU,IAAvD,QACA,qBAAMrmC,UAAU,QAAhB,SAAyBumC,EAAQ5I,OACjC,qBAAM39B,UAAU,OAAhB,oBAEF,8BACE,qBAAMA,UAAU,QAAhB,yBACA,qBAAMA,UAAU,QAAhB,SAhCY,SAAZ8mC,YACJ,GAAIV,IAAY7E,GAAOG,UAAW,CAAC,IAAD,EACMtmC,EAAKsb,EAAeQ,OAAO9b,KAAzDsoB,EADwB,EACxBA,KAAME,EADkB,EAClBA,KAAMH,EADY,EACZA,KAAME,EADM,EACNA,KAAMojB,EADA,EACAA,EAE1BC,GAAStjB,EAAOD,IAASsjB,EAAE,GAAG9rC,OAAS,GACvCgsC,GAASrjB,EAAOD,IAASojB,EAAE9rC,OAAS,GACpC4iC,EAASz7B,KAAK6e,OAAO4e,IAAcpc,GAAQujB,GAC3CE,EAAS9kC,KAAK6e,OAAO0c,IAAcha,GAAQsjB,GAEjD,OAAIpJ,EAAS,GAAKA,GAAUkJ,EAAE,GAAG9rC,SAC7BisC,EAAS,GAAKA,GAAUH,EAAE9rC,QADkB,EAGzC8rC,EAAEG,GAAQrJ,GAEnB,OAAO,EAkBsBiJ,QAEjB,aAATpnC,GACC,8BACE,qBAAMM,UAAU,QAAhB,0BACA,qBAAMA,UAAU,QAAhB,SA5DU,SAAZmnC,YACJ,OAAQf,GACN,KAAK7E,GAAOC,OACV,OAAQ3B,EAAU39B,GAAU29B,EAAU19B,IAAO47B,YAAY,GAE3D,KAAKwD,GAAOE,QACV,OAAQ5B,EAAUh9B,GAAUg9B,EAAUj9B,IAAOm7B,YAAY,GAE3D,QACE,OAAO,GAmDoBoJ,QAInB,aAATznC,GACC,8BACE,qBAAMM,UAAU,QAAhB,sBACA,qBAAMA,UAAU,QAAhB,UAtFU,SAAZonC,YACJ,OAAQhB,GACN,KAAK7E,GAAOC,OACV,OACGgF,EAActkC,IAAWskC,EAAcrkC,IAASssB,OAAOuP,WACxD,KACAzlB,QAAQ,GAEZ,KAAKgpB,GAAOE,QACV,OACG+E,EAAc3jC,IAAW2jC,EAAc5jC,IAAS6rB,OAAOuP,WACxD,KACAzlB,QAAQ,GAEZ,QACE,OAAO,GAuEoB6uB,GAAzB,cCnQJ1tC,GAAQ,CACZ8Q,OAAQ,YACR+a,gBAAiB,eACjB5rB,SAAU,WACV4L,IAAK,QACLG,KAAM,QACNkmB,WAAY,OACZhyB,cAAe,OACfkO,SAAU,UACVsC,WAAY,OACZzN,MAAO,OACP0qC,UAAW,SA2HEC,OAxHf,SAASA,eAAT,GAA6C,IAAnBpB,EAAkB,EAAlBA,OAAQC,EAAU,EAAVA,OAC1BxsC,EAAWnC,qBAAW2L,GACpBzD,EAASlI,qBAAWgI,GAApBE,KAFkC,EAYtCkE,eARFuG,EAJwC,EAIxCA,OACAxN,EALwC,EAKxCA,MACAC,EANwC,EAMxCA,OACA8Z,EAPwC,EAOxCA,eACAoH,EARwC,EAQxCA,QACAlB,EATwC,EASxCA,QACAN,EAVwC,EAUxCA,SACAT,EAXwC,EAWxCA,UAGIuqB,EACJzsC,GACAgoC,YAAYuE,EAAQ,CAClBhkC,OAAQvI,EAAS4H,EACjBsB,OAAQlJ,EAAS6H,IAlBqB,EAsBfusB,yBADTlS,EAAUwB,MAAM,MArBQ,mBAsBnCipB,EAtBmC,KAsB1BC,EAtB0B,KAwBpC5vB,EAASvf,mBAAQ,WACrB,IAAK+uC,GAA4B,IAAlBA,EAAOlrC,OACpB,OAAO2mC,YAAY,CAAEjlC,QAAOwN,SAAQ2T,YAEtC,OAAQsoB,GACN,KAAK7E,GAAOC,OACZ,KAAKD,GAAOG,UACV,OAAOE,YAAY,CAAEjlC,QAAOwN,SAAQ2T,YAEtC,KAAKyjB,GAAOE,QACV,OAAOI,YAAY,CAAEjlC,SAAQuN,SAAQyS,YAEvC,QACE,OAAO,QAEV,CAACupB,EAAQvpC,EAAQuN,EAAQi8B,EAASzpC,EAAOmhB,EAASlB,IAE/C6B,EAASrnB,mBAAQ,WACrB,IAAK+uC,GAA4B,IAAlBA,EAAOlrC,OACpB,OAAO4mC,YAAY,CAAEjlC,SAAQuN,SAAQyS,YAGvC,OAAQwpB,GACN,KAAK7E,GAAOG,UACV,OAAOG,YAAY,CAAEjlC,SAAQuN,SAAQyS,YAEvC,KAAK2kB,GAAOC,OACV,OAAO2E,EAAO,GACVrE,YAAYxlB,EAAS6pB,EAAO,GAAGztC,IAAKyR,EAAO5E,KAC3C,KAEN,KAAKg8B,GAAOE,QACV,OAAO0E,EAAO,GACVrE,YAAYxlB,EAAS6pB,EAAO,GAAGztC,IAAKyR,EAAOzE,MAC3C,KAEN,QACE,OAAO,QAEV,CAACygC,EAAQvpC,EAAQuN,EAAQi8B,EAASxpB,EAASN,IAE9C,OACG5F,GACQ,aAAThX,IACC/F,GACDA,EAAS6H,EAAI2I,EAAO5E,KACpB5L,EAAS4H,EAAI4I,EAAOzE,MACpB/L,EAAS4H,EAAI5E,EAAQwN,EAAO3E,OAC5B7L,EAAS6H,EAAI5E,EAASuN,EAAO1E,OAEtB,KAgCP,sBAEE/L,MAAK,2BACAA,IADA,IAEHmN,UAAU,aAAD,OAAelN,EAAS4H,EAAxB,eAAgC5H,EAAS6H,EAAzC,SAJb,UAOE,+BAAO+kC,EAtBO,SAAZ5I,YACJ,OAAQyI,GACN,KAAK7E,GAAOG,UACZ,KAAKH,GAAOC,OACV,OAAO/iB,EAAOrH,OAAOzd,EAAS6H,GAEhC,KAAK+/B,GAAOE,QACV,OAAOhjB,EAAOrH,OAAOzd,EAAS4H,GAEhC,QACE,OAAO,GAYMo8B,MACf,sBAAMjkC,MAAO,CAAEmb,MAAO,QAAtB,SAAiC,MACjC,sBAAMnb,MAAO,CAAEmb,MAAO,OAAtB,SAAgCyxB,EAtClB,SAAZzG,YAA2B,IAAdt+B,EAAa,uDAAT,KACrB,OAAQ6kC,GACN,KAAK7E,GAAOG,UACZ,KAAKH,GAAOC,OACV,OAAO7qB,EAAOS,OAAO7V,GAAQ5H,EAAS4H,GAExC,KAAKggC,GAAOE,QACV,OAAO9qB,EAAOS,OAAO7V,GAAQ5H,EAAS6H,GAExC,QACE,OAAO,GA4B+Bq+B,QARpC,kBCjIJ0H,GAmBN,SAASC,KAAKC,GACZ,GAAIA,EAASxsC,QAAU,IACrB,MAAM,IAAIysC,UAAU,qBAGtB,IADA,IAAIC,EAAW,IAAIC,WAAW,KACrBxvB,EAAI,EAAGA,EAAIuvB,EAAS1sC,OAAQmd,IACnCuvB,EAASvvB,GAAK,IAEhB,IAAK,IAAIpd,EAAI,EAAGA,EAAIysC,EAASxsC,OAAQD,IAAK,CACxC,IAAIuG,EAAIkmC,EAASnP,OAAOt9B,GACpB6sC,EAAKtmC,EAAEumC,WAAW,GACtB,GAAqB,MAAjBH,EAASE,GACX,MAAM,IAAIH,UAAJ,UAAiBnmC,EAAjB,kBAERomC,EAASE,GAAM7sC,EAEjB,IAAI+sC,EAAON,EAASxsC,OAChB+sC,EAASP,EAASnP,OAAO,GACzB2P,EAAU7lC,KAAKvE,IAAI,KAAOuE,KAAKvE,IAAIkqC,GAkDvC,MAAO,CACLG,OAjDF,SAASA,OAAOC,GACd,GAAsB,IAAlBA,EAAOltC,OACT,MAAO,GAOT,IAJA,IAAImtC,EAAS,EACTntC,EAAS,EACTotC,EAAS,EACTC,EAAOH,EAAOltC,OACXotC,IAAWC,GAA2B,IAAnBH,EAAOE,IAC/BA,IACAD,IAMF,IAHA,IAAIjlB,GAASmlB,EAAOD,GAAUJ,EAAU,IAAO,EAC3CM,EAAM,IAAIX,WAAWzkB,GAElBklB,IAAWC,GAAM,CAItB,IAHA,IAAIE,EAAQL,EAAOE,GAEfrtC,EAAI,EAEFytC,EAAMtlB,EAAO,GACN,IAAVqlB,GAAextC,EAAIC,KAAoB,IAATwtC,EAC/BA,IAAOztC,IAEPwtC,GAAU,IAAMD,EAAIE,KAAU,EAC9BF,EAAIE,GAAOD,EAAQT,IAAS,EAC5BS,EAASA,EAAQT,IAAU,EAE7B,GAAc,IAAVS,EACF,MAAM,IAAI5xC,MAAM,kBAElBqE,EAASD,EACTqtC,IAIF,IADA,IAAIK,EAAMvlB,EAAOloB,EACVytC,IAAQvlB,GAAqB,IAAbolB,EAAIG,IACzBA,IAIF,IADA,IAAIC,EAAMX,EAAOY,OAAOR,GACjBM,EAAMvlB,IAAQulB,EACnBC,GAAOlB,EAASnP,OAAOiQ,EAAIG,IAE7B,OAAOC,IArFInB,CADA,kEAITqB,GAAQ,IAAIjB,WADH,GAGA,SAASkB,aACtB,IAAK,IAAI9tC,EAAI,EAAGA,EAJH,EAIeA,IAC1B6tC,GAAM7tC,GAAKoH,KAAK6e,MAAsB,IAAhB7e,KAAKw6B,UAE7B,OAAO2K,GAAOW,OAAOW,IAAOE,UAAU,EAAG,GCK3C,SAASC,YAAYrtB,GAA6B,IAAD,EAArB4F,EAAqB,uDAAJ,GACvC0nB,GAAY,EAD+B,eAE5B1nB,GAF4B,IAE/C,2BAA4B,CAAC,IAApBpnB,EAAmB,QACpB+uC,EAAe,CACnBh4B,KAAM/W,EAAO+W,KACbuT,MAAOZ,GAAQ1pB,EAAO+W,MAAMA,KAC5B3a,MAAO4D,EAAOwN,SAEVwhC,EAAiBC,gBAAgBztB,EAAOxhB,EAAO+W,MACrD,GAAIi4B,EAAgB,CAClB,IAAME,EAAexlB,GAAQ1pB,EAAO+W,MAAM6K,OACxCotB,EAAe5yC,MACf2yC,EAAa3yC,OAEX8yC,EAAahqB,MACV4pB,IACHA,GAAY,GAEa,MAAvBI,EAAattB,aAA0CuC,IAAxB+qB,EAAattB,QAC9CutB,cAAc3tB,EAAOwtB,EAAezwC,GAAI2wC,EAAattB,SAGvDwtB,UACE5tB,EACAutB,GACAzyC,OAAOsD,UAAUyvC,eAAevvC,KAAKE,EAAQ,kBACzCA,EAAOsvC,oBAKfF,UACE5tB,EACAutB,GACAzyC,OAAOsD,UAAUyvC,eAAevvC,KAAKE,EAAQ,kBACzCA,EAAOsvC,gBAnC8B,8BAwC/C,GAAIR,EACqB,IAAnB1nB,EAAQtmB,QAAgByuC,aAAa/tB,EAAO4F,EAAQ,GAAGrQ,MACzD2S,GAAQtC,EAAQ,GAAGrQ,MAAM0N,MAAMjD,EAAO4F,EAAQ,GAAG5Z,SAEjDgiC,eAAehuB,OAEZ,CAAC,IAAD,iBACc4F,GADd,IACL,2BAA4B,CAAC,IAApBpnB,EAAmB,QAC1B0pB,GAAQ1pB,EAAO+W,MAAM0N,MAAMjD,EAAOxhB,EAAOwN,UAFtC,gCAOT,SAAS+hC,aAAa/tB,EAAOjjB,GAC3B,IAAMwe,EAAQyE,EAAM4F,QAAQiP,WAAU,SAACoZ,GAAD,OAAOA,EAAE14B,OAASxY,KACxD,OAAIijB,EAAM4F,QAAQtmB,SAAWic,EAAQ,EAMvC,SAASkyB,gBAAgBztB,EAAOkuB,GAC9B,OAAOluB,EAAM4F,QAAQyR,MAAK,SAAC4W,GAAD,OAAOA,EAAE14B,OAAS24B,KAG9C,SAASF,eAAehuB,GAA6B,IAAtB4F,EAAqB,uDAAN,KACtCuoB,EAAWvoB,GAAoB5F,EAAM4F,QAC3CwoB,4BAAapuB,EAAO,KAAM,KAAMmuB,GAIlC,SAASC,4BAAapuB,EAAOjjB,EAAIsxC,GAA0B,IAAjBzoB,EAAgB,uDAAN,KAClD5F,EAAM4F,QAAU5F,EAAM4F,QAAQvnB,MAAM,GAChCtB,IACFijB,EAAM4F,QAAU5F,EAAM4F,QAAQ5P,KAAI,SAACxX,GACjC,OAAO,2BAAKA,GAAZ,IAAoBgkB,KAAMhkB,EAAOzB,KAAOA,EAAKsxC,EAAU7vC,EAAOgkB,SAC7D,KAELxC,EAAMvgB,KAAN,2BAAkBugB,EAAMvgB,MAASugB,EAAMsuB,cACvCtuB,EAAMxE,KAAN,2BAAkBwE,EAAMxE,MAASwE,EAAMuuB,cACvC,IAAMJ,EAAWvoB,GAAoB5F,EAAM4F,QAC3C,IAAK,IAAI4oB,KAAeL,EAAU,CAChC,IAAM3vC,EAASwhB,EAAM4F,QAAQ4oB,GAM7B,GALAxuB,EAAM4F,QAAQ4oB,GAAd,2BACKxuB,EAAM4F,QAAQ4oB,IADnB,IAEEC,MAAO,OAGLjwC,EAAOgkB,KACT,IACE0F,GAAQ1pB,EAAO+W,MAAM0N,MAAMjD,EAAOxhB,EAAO5D,OACzC,MAAO6zC,GACPzuB,EAAM4F,QAAQ4oB,GAAd,2BACKxuB,EAAM4F,QAAQ4oB,IADnB,IAEEC,MAAOA,EAAM9hC,YAgCvB,SAASihC,UAAU5tB,EAAOxhB,GAA+B,IAAvBsvC,IAAsB,yDAChD/wC,EAAKowC,aACXntB,EAAM4F,QAAU5F,EAAM4F,QAAQvnB,MAAM,UAC7BG,EAAOkwC,WACd1uB,EAAM4F,QAAQzpB,KAAd,2BACKqC,GADL,IAEEzB,GAAIA,EACJylB,MAAM,EACNsrB,mBAIJ,SAASH,cAAc3tB,EAAO2uB,EAAU/zC,GACtColB,EAAM4F,QAAU5F,EAAM4F,QAAQvnB,MAAM,GACpC,IAAMkd,EAAQyE,EAAM4F,QAAQiP,WAAU,SAACoZ,GAAD,OAAOA,EAAElxC,KAAO4xC,YAC/C3uB,EAAM4F,QAAQrK,GAAOmzB,WAC5B1uB,EAAM4F,QAAQrK,GAAd,2BACKyE,EAAM4F,QAAQrK,IADnB,IAEE3gB,UC/JG,IAAMg0C,GAAS,CACpB,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,IAGIC,GAAU,CACdC,KAAM,CAAEpI,cAAe,WAAYE,cAAe,QAClDmI,MAAO,CAAErI,cAAe,OAAQE,cAAe,UAC/CoI,MAAO,CAAEtI,cAAe,OAAQE,cAAe,UAC/CqI,MAAO,CAAEvI,cAAe,QAASE,cAAe,UAChDsI,KAAM,CAAExI,cAAe,QAASE,cAAe,UAC/CuI,KAAM,CAAEzI,cAAe,aAAcE,cAAe,WAgBhDwI,GAAe,SAAfA,aAAgBC,GACpB,IAAMC,EAAU7oC,KAAKsa,IAAI,EAAGta,KAAKqa,IAAI,IAAKuuB,IAEpCE,EADW9oC,KAAK+oC,MAAOF,EAAU,IAAO,KACpBpwB,SAAS,IACnC,OAAmB,MAAZowB,EAAkB,GAAKC,EAASE,SAAS,EAAG,MAG/CC,GAAc,SAAdA,YAAex2B,EAAOy2B,GAC1B,OAAOz2B,EAAQk2B,GAAaO,IAGxBC,GAAW,SAAXA,WAAkE,IAAtDC,EAAqD,wDAAnCC,EAAmC,uDAAtB,GAAI5xC,EAAkB,uDAAR,IACvD6xC,EAAcnB,GAAOpwC,QAAO,SAACwxC,GAAD,OAAQF,EAAWrzC,SAASuzC,MAC9D,GAAID,EAAYzwC,OAAS,IAAMuwC,EAC7B,OAAOE,EAAY,GAAKX,GAAalxC,GAErC,IAAM+xC,GAAO,IACTC,EAAM9zC,OAAO,IAAD,OACVqK,KAAKw6B,SAAS/hB,SAAS,IAAI7gB,MAAM,EAAG,GAAG8xC,gBAC3C/sC,QAAQ,cAAe,IACrB8sC,EAAI5wC,OAAS,IACf4wC,EAAMA,EAAI,GAAKA,EAAI,GAAKA,EAAI,GAAKA,EAAI,GAAKA,EAAI,GAAKA,EAAI,IAEzD,IACIF,EACA3wC,EAFA+wC,EAAM,IAGV,IAAK/wC,EAAI,EAAGA,EAAI,EAAGA,IACjB2wC,EAAIK,SAASH,EAAIx6B,OAAW,EAAJrW,EAAO,GAAI,IACnC2wC,EAAIvpC,KAAK+oC,MAAM/oC,KAAKqa,IAAIra,KAAKsa,IAAI,EAAGivB,EAAIA,EAAIC,GAAM,MAAM/wB,SAAS,IACjEkxB,GAAO,YAAKJ,GAAIt6B,OAAOs6B,EAAE1wC,QAG3B,OAAO8wC,EAAMhB,GAAalxC,IAIf0xC,M,UC/EXU,GAA4B,CAC9BC,YAAa,IACbC,kBAAkB,EAClBC,aAAa,EACbC,SAAS,EACTC,GAAI,IACJC,SAAS,EACTC,iBAAkB,GAClBC,OAAO,EACPC,WAAW,EACXC,UAAW,CAAEC,WAAY,EAAG1sB,WAAY,ICV1C,IAwBe2sB,GAxBM,SAAfA,aAAgBtrC,EAAGwd,EAAI7iB,EAAMmb,EAAIM,GAAe,IAAD,EACpBL,aAAgB/V,EAAG,CAChDrF,KAAMA,EACNmb,GAAIA,IAFEE,EAD2C,EAC3CA,UAAWC,EADgC,EAChCA,QAIbpc,EAAO,CACXmG,EAAGA,EAAEvH,MAAMud,EAAWC,GACtBhW,EAAGud,EAAG/kB,MAAMud,EAAWC,IAGnBtF,EAASwF,aAAiBtc,EAAM,CACpCuc,UAAWA,EACXE,uBAAuB,EACvBC,oBAAoB,IAGtB,MAAO,CACLO,aAAcnG,EAAOkG,EAAEzG,KAAI,SAACyG,GAAD,OAAOA,EAAEC,gBAAcy0B,KAAK,IACvD5Y,KAAM,SACNrD,MAAO3e,EAAO66B,UACd30B,EAAGlG,EAAOkG,ICVD40B,GAA8B,GAiGpC,SAASC,gBAAgBtlC,GAAwB,IAAD,EAC/CgU,EAAa,GAmEnB,OAlEAA,EAAMyI,OAASzc,EAAQyc,QAAU,EACjCzI,EAAMjjB,GAAKiP,EAAQjP,IAAMowC,aACzBntB,EAAMwsB,OAAS1xC,OAAOipB,OACpB,CACEwtB,MAAO,KACPC,SAAU,KACVC,SAAU,IAEZzlC,EAAQwgC,QAEVxsB,EAAM/V,QAAUnP,OAAOipB,OAAPjpB,OAAA,IAAAA,QAAA,IAAAA,CAAA,CAEZya,MAAM,UAAAvJ,EAAQ/B,eAAR,eAAiBsL,MAAOvJ,EAAQ/B,QAAQsL,KAAO43B,aACrDj0B,MAAO,SAgGb,SAAS02B,iBAAS5jC,GAChB,QAAwB2W,IAApB3W,EAAQ/B,cAAmD0Y,IAA1B3W,EAAQ/B,QAAQiP,MAAqB,CACxE,IAAMA,EAAQw4B,IAAW,EAAOL,IAEhC,OADAA,GAAal1C,KAAK+c,GACX,CAAEA,SAEX,MAAO,GArGA02B,CAAS5jC,IAJA,IAKZqlB,WAAW,EACX4D,uBAAuB,EACvB0c,uBAAuB,EACvBrgB,mBAAmB,IAErBtlB,EAAQ/B,SAGV+V,EAAMxE,KAAO1gB,OAAOipB,OAClB,CACE3G,QAAS,KACTqG,OAAO,EACPD,WAAW,EACXvD,UAAW,GAEbjU,EAAQwP,MAGVwE,EAAMuuB,aAAevuB,EAAMxE,KAE3BwE,EAAM4xB,KAAO92C,OAAOipB,OAAO,GAAI/X,EAAQ4lC,MACvC5xB,EAAMvgB,KAAO3E,OAAOipB,OAClB,CACEne,EAAG,GACHwd,GAAI,GACJE,GAAI,GACJzd,EAAG,IAELmG,EAAQvM,MAEVugB,EAAMsuB,aAAetuB,EAAMvgB,KAE3BugB,EAAMgV,MAAQl6B,OAAOipB,OAAO,CAAE0N,OAAQ,GAAIzlB,QAAS,IAAMA,EAAQgpB,OAIjEhV,EAAMwR,UAAY12B,OAAOipB,OACvB,CAAE0N,OAAQ,GAAIzlB,QAAS,CAAE6lC,IAAK,MAC9B7lC,EAAQwlB,WAEVxR,EAAM4F,QAAU9qB,OAAOipB,OAAO,GAAI/X,EAAQ4Z,SAC1C5F,EAAMkX,OAASp8B,OAAOipB,OACpB,CAAE0N,OAAQ,GAAIzlB,QAAS,CAAE6lC,IAAK,MAC9B7lC,EAAQkrB,QAIV4a,eAA8B9xB,GAOhC,SAAS+xB,cAAc/xB,GAEnBA,EAAMxE,KAAKiI,QAER,IADHzD,EAAM4F,QAAQiP,WAAU,SAACoZ,GAAD,OAAOA,EAAE14B,OAASy8B,GAAajsB,cAAchpB,OAGrE+0C,YAA2B9xB,EAAO,CAChC,CACEzK,KAAMy8B,GAAajsB,cAAchpB,GACjCiP,QAAS,CACPoZ,mBAAoBpF,EAAMxE,KAAKuK,eAEjC+nB,eAAe,KAjBrBiE,CAAc/xB,GACbA,EAAMvgB,KAAgBoG,EAAIma,EAAMvgB,KAAK2jB,GAC/BpD,EA0DF,SAASiyB,WAAWxyC,EAAMuM,GAAU,IACjCzL,EAAayL,EAAbzL,KAAMmb,EAAO1P,EAAP0P,GACV6nB,EAAW9jC,EAAKmG,EAAEivB,WAAU,SAACyO,GAAD,OAAYA,GAAU/iC,KAClD8iC,EAAW5jC,EAAKmG,EAAEivB,WAAU,SAACyO,GAAD,OAAYA,GAAU5nB,KAAM,EAExD6nB,EAAWF,IAEbA,EADAE,EAAWF,GAGb,IAAM6O,EAAYzyC,EAAK2jB,GAAG/kB,MAAMklC,EAAUF,GAC1C,GAAI6O,GAAaA,EAAU5yC,OAAS,EAAG,CACrC,IAAMmkC,EAAS1iB,aAAImxB,GACbhQ,EAASgQ,EAAUrd,WAAU,SAACj6B,GAAD,OAAWA,IAAU6oC,KAGxD,MAAO,CAAE79B,EAFMnG,EAAKmG,EAAE29B,EAAWrB,GAEbr8B,EAAG49B,EAAQvB,OAAQqB,EAAWrB,GAEpD,OAAO,KAGF,SAASiQ,wBAAwB3gB,QACR7O,IAA1B6O,EAAUxlB,QAAQ6lC,MACpBrgB,EAAUxlB,QAAV,2BAAyBwlB,EAAUxlB,SAAnC,IAA4C6lC,IAAK,OAKnDrgB,EAAUC,OAAS2gB,gBACjB5gB,EAAUC,OACVD,EAAUxlB,QAAQ6lC,IAClB,YANwB,SAApBQ,kBAAqBnpB,GACzB,OAAOA,EAASqP,MAAQhB,GAAqB96B,SAASysB,EAASqP,SAiCnE,SAAS6Z,gBAAgB3gB,EAAQogB,EAAKS,EAAYD,GAChD,IAAME,EAAa9gB,EAAOrR,QAAO,SAACoyB,EAAUplC,GAC1C,OAAOilC,IAAoD,IAA/BA,EAAkBjlC,GACzColC,GAAY/rC,KAAKC,IAAI0G,EAAQ+a,UAC9BqqB,IACH,GACG7C,EAAS4C,EAAa,EAAIV,EAAMU,EAAa,EACnD,OAAO9gB,EAAOzb,KAAI,SAACpb,GACjB,OAAO,2BAAKA,GAAZ,mBAAoB03C,EAAa13C,EAAMutB,SAAWwnB,OAI/C,SAAS8C,qBAAqBzyB,QACF2C,IAA7B3C,EAAMkX,OAAOlrB,QAAQ6lC,MACvB7xB,EAAMkX,OAAOlrB,QAAQ6lC,IAAM,KAK7B7xB,EAAMkX,OAAOzF,OAAS2gB,gBACpBpyB,EAAMkX,OAAOzF,OACbzR,EAAMkX,OAAOlrB,QAAQ6lC,IACrB,YANwB,SAApBQ,kBAAqBrzC,GACzB,OAAOA,EAAM64B,QlD9PQ,SAAnB6a,iBAAoB1zC,EAAO2zC,GAC/B,OAAQ3zC,EAAM64B,OAAOt7B,MACnB,SAACu7B,GAAD,YAA8BnV,IAAjBmV,EAAQS,OAAuBoa,EAAMl2C,SAASq7B,EAAQS,SkD4P5Cma,CAAiB1zC,EAAOu4B,OA+B5C,SAASqb,UAAU1b,EAAQlX,GAAQ,IAAD,EACrBA,EAAMvgB,KAAhBmG,EAD+B,EAC/BA,EAAGwd,EAD4B,EAC5BA,GACLqF,EAASoqB,UAAU7yB,GAEzB,OAAOkX,EAAOlhB,KAAI,SAAChX,GACjB,IAAMmpB,EAAW2qB,aACf,CAAEltC,IAAGC,EAAGud,GACR,CAAE7iB,KAAMvB,EAAMuB,KAAMmb,GAAI1c,EAAM0c,GAAI8U,SAAS,IAGvCqH,EAAS74B,EAAM64B,OAAO7hB,KAAI,SAAC8hB,GAC/B,OAAO,aACLS,KAAM,SACNx7B,GAAIowC,aACJ4F,YAAajb,EAAQ5C,MAAQzM,GAC1BqP,MAIP,OAAO,yBACLS,KAAMv5B,EAAM64B,OAAO,GAAGU,MAAQf,GAC9Bwb,WAAYh0C,EAAMuB,KAAOkoB,EACzBwqB,SAAUj0C,EAAM0c,GAAK+M,GAClBzpB,GAJL,IAKEjC,GAAIowC,aACJhlB,WACA0P,cAKC,SAASqb,aAAalzB,EAAOhU,GAClCA,EAAQmnC,WAAa,CAAEC,QAASpzB,EAAMxE,KAAK43B,SAC3C,IAAMlc,EFvWO,SAASmc,oBAAoBnwB,GAAwB,IAAflX,EAAc,uDAAJ,GAEzDsnC,EAAaC,aAAgBrwB,EAAQzjB,KAAK2jB,IAFmB,EAI/CF,EAAQzjB,KAAlB2jB,EAJyD,EAIzDA,GAAIxd,EAJqD,EAIrDA,EAJqD,EAK5Bsd,EAAQ1H,KAArCS,EALyD,EAKzDA,gBAAiBmB,EALwC,EAKxCA,QAEnBo2B,EAAkB,2BACnBlD,IACAtkC,EAAQid,aAGPwqB,EAAgB,CACpBz3B,UAAWC,EACXmB,UACAk2B,WAAY,EAAIA,GAUlB,OAPeI,aACb,CAAE9tC,IAAGC,EAAGud,GACR,CACE6F,YAAauqB,EACbtc,OAAQuc,IEiVGJ,CAAoBrzB,EAAOhU,GAE1CgU,EAAMkX,OAAOzF,OAASzR,EAAMkX,OAAOzF,OAAOkG,OAAOib,UAAU1b,EAAQlX,IACnEyyB,qBAAqBzyB,GA6ChB,SAAS2zB,aAAa3zB,GAC3B,IAAMyI,EAASoqB,UAAU7yB,IAcpB,SAAS4zB,kBAAkB5zB,EAAgBsH,GAChDtH,EAAMgV,MAAMvD,OAASzR,EAAMgV,MAAMvD,OAAOzb,KAAI,SAACyzB,GAAD,mBAAC,eACxCA,GADuC,IAE1CvU,MAAOuU,EAAKsJ,YAAczrB,OAhB5BssB,CAAkB5zB,EAAOyI,GAmBpB,SAASorB,mBAAmB7zB,EAAgBsH,GACjDtH,EAAMkX,OAAOzF,OAASzR,EAAMkX,OAAOzF,OAAOzb,KAAI,SAAChX,GAAD,mBAAC,eAC1CA,GADyC,IAE5CuB,KAAMvB,EAAMg0C,WAAa1rB,EACzB5L,GAAI1c,EAAMi0C,SAAW3rB,EACrBuQ,QACO,OAAL74B,QAAK,IAALA,OAAA,EAAAA,EAAO64B,SACP74B,EAAM64B,OAAO7hB,KAAI,SAAC89B,GAAD,mBAAC,eAAYA,GAAb,IAAgB5e,MAAO4e,EAAEf,YAAczrB,YAzB5DusB,CAAmB7zB,EAAOyI,GA4BrB,SAASsrB,qBAAqB/zB,EAAgBsH,GACnDtH,EAAMwR,UAAUC,OAASzR,EAAMwR,UAAUC,OAAOzb,KAAI,SAACkT,GAAD,mBAAC,eAChDA,GAD+C,IAElD3oB,KAAM2oB,EAAS8pB,WAAa1rB,EAC5B5L,GAAIwN,EAAS+pB,SAAW3rB,OA/B1BysB,CAAqB/zB,EAAOyI,GAGvB,SAASoqB,UAAU7yB,GACxB,IAAMxhB,GACC,OAALwhB,QAAK,IAALA,OAAA,EAAAA,EAAO4F,WAAP,OACA5F,QADA,IACAA,OADA,EACAA,EAAO4F,QAAQyR,MAAK,SAAC74B,GAAD,OAAYA,EAAO+W,OAASy8B,GAAavpB,OAAO1rB,OAEtE,OAAa,OAANyB,QAAM,IAANA,OAAA,EAAAA,EAAQgkB,MAAOhkB,EAAO5D,MAAQ,E,cCjb1Bo5C,GAAwB,CACnCC,SAAU,CACRC,cAAe,CAAC,EAAG,IACnBC,eAAgB,IAElBC,SAAU,CACRF,cAAe,CAAC,EAAG,IACnBC,eAAgB,KAICE,G,WACnB,sBACEC,GAMC,IALDtoC,EAKA,uDALUgoC,GACVO,EAIA,uDAJe,CACbN,SAAU,GACVG,SAAU,IAEZ,gCACAv1B,KAAK7S,QAAUA,EADf,IAEQioC,EAAuBM,EAAvBN,SAAUG,EAAaG,EAAbH,SAElBv1B,KAAK21B,qBAAuBP,EAC5Bp1B,KAAK41B,qBAAuBL,EAE5B,IAAMM,EAAKC,SAASL,EAAOxsB,KAAMwsB,EAAOvsB,KAAMusB,EAAOlJ,EAAE,GAAG9rC,QAEpDs1C,EAAKD,SAASL,EAAOtsB,KAAMssB,EAAOrsB,KAAMqsB,EAAOlJ,EAAE9rC,QAEvDuf,KAAKg2B,OAAS,IAAIC,KAAOR,EAAOlJ,EAAG,CAAEsJ,KAAIE,KAAIG,UAAU,IAEvDl2B,KAAKm2B,OAASV,EAAOW,MAErBp2B,KAAKy1B,OAASA,E,wDAGhB,SAAAY,WACE,MAAO,CACLC,cAAet2B,KAAK21B,qBACpBY,cAAev2B,KAAK41B,wB,sBAIxB,SAAAY,SAASF,EAAeC,GACtBv2B,KAAK21B,qBAAuBW,EAC5Bt2B,KAAK41B,qBAAuBW,I,wBAG9B,SAAAE,WAAWtpC,GACT,IAAMupC,EAAmBvpC,EAAQioC,SAASC,cACpCsB,EAAmBxpC,EAAQooC,SAASF,cAEtCr1B,KAAK21B,sBAAwBe,EAAiB,GAChD12B,KAAK21B,qBAAuBe,EAAiB,GACpC12B,KAAK21B,sBAAwBe,EAAiB,KACvD12B,KAAK21B,qBAAuBe,EAAiB,IAG3C12B,KAAK41B,sBAAwBe,EAAiB,GAChD32B,KAAK41B,qBAAuBe,EAAiB,GACpC32B,KAAK41B,sBAAwBe,EAAiB,KACvD32B,KAAK41B,qBAAuBe,EAAiB,IAG/C32B,KAAK7S,QAAUA,I,mBAGjB,SAAAgT,MAAMpkB,GACJ,IAAM6kB,EAAOhZ,KAAKgZ,KAAK7kB,GACjB26C,EAAmB12B,KAAK7S,QAAQioC,SAASC,cACzCsB,EAAmB32B,KAAK7S,QAAQooC,SAASF,eAG5Cr1B,KAAK21B,qBAAuBe,EAAiB,KAAgB,IAAV91B,GACnDZ,KAAK21B,qBAAuBe,EAAiB,IAAe,IAAT91B,KAEpDZ,KAAK21B,sBAAwB/0B,IAI5BZ,KAAK41B,qBAAuBe,EAAiB,KAAgB,IAAV/1B,GACnDZ,KAAK41B,qBAAuBe,EAAiB,IAAe,IAAT/1B,KAEpDZ,KAAK41B,sBAAwBh1B,K,wBAIjC,SAAAg2B,WAAW76C,GACT,IAAM6kB,EAAOhZ,KAAKgZ,KAAK7kB,GADP,cAEGikB,KAAK7S,QAAQioC,SAASC,cAFzB,GAETpzB,EAFS,KAEJC,EAFI,KAGhB,KACGlC,KAAK21B,uBAAyB1zB,IAAiB,IAAVrB,GACrCZ,KAAK21B,sBAAwBzzB,GAAgB,IAATtB,GAMvC,OADAZ,KAAK21B,sBAAwB/0B,EACtB,K,0BAGT,SAAAi2B,eACE,IAAMC,EAAe92B,KAAK21B,qBAAuB,EAAI,EAC/CoB,EAAe/2B,KAAK41B,qBAAuB,EAAI,EAFxC,EAMT51B,KAAK7S,QAFqB6pC,EAJjB,EAIX5B,SAAYE,eACgB2B,EALjB,EAKX1B,SAAYD,eAEd,MAAO,CACLF,SAAUp1B,KAAKk3B,YAAYJ,EAAc,CACvCK,SAAUH,IAEZzB,SAAUv1B,KAAKk3B,YAAYH,EAAc,CACvCxB,UAAU,EACV4B,SAAUF,O,yBAKhB,SAAAC,YAAYE,GAA0B,IAAfjqC,EAAc,uDAAJ,GAAI,EACyBA,EAApDooC,gBAD2B,WACyBpoC,EAAlCH,eADS,MACC,IADD,IACyBG,EAAlBgqC,gBADP,MACkB,GADlB,EAG7Bj1B,EAAMta,KAAKsa,IACfta,KAAKC,IAAImY,KAAKy1B,OAAO4B,MACrBzvC,KAAKC,IAAImY,KAAKy1B,OAAO6B,OAGnB9nB,EAASsmB,SACG,EAAd91B,KAAKm2B,OAAavuC,KAAK2vC,IAAI,EAAGH,GAC9Bl1B,EACAi1B,EACA,GAGE5B,IACF/lB,EAASA,EAAOrY,KAAI,SAACpb,GAAD,OAAYA,MAElC,IAAIyrC,EAAW,GACf,IACEA,EAAWxnB,KAAKg2B,OAAOwB,YAAY,CACjCC,cAAe,QACfC,OAAQloB,EACRxiB,QAASA,IAEX,MAAO3O,GAGP,MADA+E,QAAQC,IAAIhF,GACNA,EAGR,OAAOmpC,M,gBAIX,SAASsO,SAAS7zB,EAAKC,EAAKzhB,EAAQ4nB,GAClC,GAAIA,EAAK,CACP,IAAIsvB,EAAU,GAEdA,EAAQ,GAAK,EAEb,IAAK,IAAIn3C,EAAI,EAAGA,GAAKC,EAAQD,IAC3Bm3C,EAAQn3C,GAAKm3C,EAAQn3C,EAAI,IAAM6nB,EAAM,GAAKzgB,KAAK2vC,IAAIlvB,EAAK7nB,GAO1D,IAJA,IAAMo3C,EAAaD,EAAQl3C,GAErBiX,EAAS,IAAIxa,MAAMuD,GAEhBD,EAAI,EAAGA,EAAIC,EAAQD,IAC1BkX,EAAOlX,IAAM0hB,EAAMD,IAAQ,EAAI01B,EAAQn3C,EAAI,GAAKo3C,GAAc31B,EAGhE,OAAOvK,EAEP,IAAMxS,GAAQgd,EAAMD,IAAQxhB,EAAS,GAErC,OAIJ,SAASN,mBAAMuB,EAAMmb,EAAI3X,GAGvB,IAFA,IAAMwS,EAAS,GAENlX,EAAIkB,EAAMlB,EAAIqc,EAAIrc,GAAK0E,EAC9BwS,EAAOpa,KAAKkD,GAGd,OAAOkX,EAXEvX,CAAM8hB,EAAKC,EAAMhd,EAAO,EAAGA,GCvK/B,IAAM2yC,GAA8B,GAsFpC,SAASC,gBAAgB3qC,GAC9B,IAAMgU,EAAa,GA4DnB,OA1DAA,EAAMjjB,GAAKiP,EAAQjP,IAAMowC,aACzBntB,EAAMwsB,OAAS1xC,OAAOipB,OACpB,CACEwtB,MAAO,KACPC,SAAU,KACVC,SAAU,IAEZzlC,EAAQwgC,QAEVxsB,EAAM/V,QAAUnP,OAAOipB,OAAPjpB,OAAA,IAAAA,QAAA,IAAAA,CAAA,CAEZya,KAAMvJ,EAAQ/B,QAAQsL,MAAQ43B,aAC9BzG,cAAe,MACfE,cAAe,QAoErB,SAASgJ,iBAAS5jC,GAChB,QACsB2W,IAApB3W,EAAQ/B,cAC0B0Y,IAAlC3W,EAAQ/B,QAAQ28B,oBACkBjkB,IAAlC3W,EAAQ/B,QAAQy8B,cAChB,CACA,IAAMxtB,ELvJS,SAAb09B,WAAcpP,GAA6B,IAAjBqP,EAAgB,uDAAP,GACvC,IAAKhI,GAAQrH,GAAa,CACxB,IAAMd,EAAgBkJ,IAAS,EAAOiH,GAEtC,MAAO,CAAEnQ,gBAAeE,cADF8I,GAAYhJ,EAAe,KAGnD,OAAOmI,GAAQrH,GKiJCoP,CAAW5qC,EAAQwP,KAAKgsB,WAAYkP,IAElD,OADAA,GAAav6C,KAAK+c,EAAMwtB,eACjBxtB,EAET,MAAO,GA7EA02B,CAAS5jC,IALA,IAMZy6B,mBAAmB,EACnBE,mBAAmB,EACnBtV,WAAW,EACXylB,eAAgB9C,GAChB/zB,UAAW,IAEbjU,EAAQ/B,SAGV+V,EAAMxE,KAAO1gB,OAAOipB,OAClB,CACE3G,QAAS,CAAC,KAAM,MAChBqG,OAAO,EACPD,WAAW,GAEbxX,EAAQwP,MAGVwE,EAAMuuB,aAAevuB,EAAMxE,KAC3BwE,EAAM4xB,KAAO92C,OAAOipB,OAAO,GAAI/X,EAAQ4lC,MACvC5xB,EAAMvgB,KAAO3E,OAAOipB,OAClB,CACEqnB,EAAG,GACHtjB,KAAM,EACNE,KAAM,EACND,KAAM,EACNE,KAAM,GAERjc,EAAQvM,MAEVugB,EAAMsuB,aAAetuB,EAAMvgB,KAC3BugB,EAAM4F,QAAU9qB,OAAOipB,OAAO,GAAI/X,EAAQ4Z,SAE1C5F,EAAM0E,MAAQ5pB,OAAOipB,OAAO,CAAE0N,OAAQ,GAAIzlB,QAAS,IAAMA,EAAQ0Y,OAEjE1E,EAAM+2B,qBAAuB,IAAI1C,GAC/Br0B,EAAMvgB,KACNugB,EAAM/V,QAAQ6sC,gBAIhBhF,eAA8B9xB,GAEvBA,EAGF,SAASg3B,SAASh3B,GACvB,IAAIi3B,EAAa,CAAE9T,OAAQ,EAAG+T,OAAQ,GAgBtC,OAfA,OAAIl3B,QAAJ,IAAIA,OAAJ,EAAIA,EAAO4F,WACTqxB,EAAQj3B,EAAM4F,QAAQxF,QACpB,SAACC,EAAK7hB,GAOJ,OANIA,EAAO+W,OAAS2S,GAAQS,SAAS5rB,KACnCsjB,EAAI8iB,QAAe,OAAN3kC,QAAM,IAANA,OAAA,EAAAA,EAAQgkB,MAAOhkB,EAAO5D,MAAQ,GAEzC4D,EAAO+W,OAAS2S,GAAQU,SAAS7rB,KACnCsjB,EAAI62B,QAAe,OAAN14C,QAAM,IAANA,OAAA,EAAAA,EAAQgkB,MAAOhkB,EAAO5D,MAAQ,GAEtCylB,IAET,CAAE8iB,OAAQ,EAAG+T,OAAQ,KAIlBD,EA2FF,SAASE,YAAYn3B,GAAiB,IAAD,EACfg3B,SAASh3B,IAO/B,SAASo3B,iBAAiBp3B,EAA1B,GAA+D,IAAnBmjB,EAAkB,EAAlBA,OAAQ+T,EAAU,EAAVA,OACzDl3B,EAAM0E,MAAM+M,OAASzR,EAAM0E,MAAM+M,OAAOzb,KAAI,SAACgW,GAAD,yBAAC,eACxCA,GADuC,IAE1C6L,OAAM,UAAE7L,EAAK6L,cAAP,aAAE,EAAa7hB,KAAI,SAAC6hB,GAAD,mBAAC,eACrBA,GADoB,IAEvBjyB,EAAE,2BAAMiyB,EAAOjyB,GAAd,IAAiBsvB,MAAO2C,EAAOjyB,EAAEmtC,YAAc5P,IAChDt9B,EAAE,2BAAMgyB,EAAOhyB,GAAd,IAAiBqvB,MAAO2C,EAAOhyB,EAAEktC,YAAcmE,cAZpDE,CAAiBp3B,EAAO,CACtBmjB,OAHwC,EAClCA,OAGN+T,OAJwC,EAC1BA,SAwGX,SAASG,6BAAqBr3B,EAAO5C,GAC1C,IAAI7B,EAAQyE,EAAMxE,KAAK4B,QAAQkkB,QAAQlkB,IAExB,IAAX7B,IAAcA,EAAQ,GAE1B,IAAIC,EAAO,CACT4B,QAAS4C,EAAMxE,KAAK4B,QAAQ7B,GAC5BkI,OAAO,EACPD,WAAW,EACXvD,UAAW,GAGT1f,EAAiB,IAAVgb,EAAcyE,EAAMvgB,KAAKqoB,KAAO9H,EAAMvgB,KAAKuoB,KAClDtM,EAAe,IAAVH,EAAcyE,EAAMvgB,KAAKsoB,KAAO/H,EAAMvgB,KAAKwoB,KAChDxB,EAAqB,IAAVlL,EAAcyE,EAAMvgB,KAAK2rC,EAAE9rC,OAAS0gB,EAAMvgB,KAAK2rC,EAAE,GAAG9rC,OAE/Dg4C,EAAa,IAAI/zB,aAAakD,GAClC,GAAc,IAAVlL,EACF,IAAK,IAAIlc,EAAI,EAAGA,EAAI2gB,EAAMvgB,KAAK2rC,EAAE9rC,OAAQD,IACvC,IAAK,IAAIod,EAAI,EAAGA,EAAIuD,EAAMvgB,KAAK2rC,EAAE,GAAG9rC,OAAQmd,IAC1C66B,EAAWj4C,IAAM2gB,EAAMvgB,KAAK2rC,EAAE/rC,GAAGod,QAIrC,IAAK,IAAIpd,EAAI,EAAGA,EAAI2gB,EAAMvgB,KAAK2rC,EAAE,GAAG9rC,OAAQD,IAE1C,IAAK,IAAIod,EAAI,EAAGA,EAAIuD,EAAMvgB,KAAK2rC,EAAE9rC,OAAQmd,IACvC66B,EAAWj4C,IAAM2gB,EAAMvgB,KAAK2rC,EAAE3uB,GAAGpd,GAUvC,OADgBiyC,gBAAgB,CAAE91B,OAAM/b,KAJ7B,CACTmG,EAAG2xC,aAAQ,CAAEh3C,OAAMmb,MAAM+K,GACzBrD,GAAIk0B,KAgBD,SAASE,kBAAkBx3B,EAAOhU,GACvC,IAAIyrC,EAAa,GAOjB,OALEA,EADEzrC,EAAQ0rC,aAmDP,SAASC,aAAa33B,EAAO03B,GAoBlC,IApBiD,IACzCE,EAA2BF,EAA3BE,MAAOC,EAAoBH,EAApBG,IAAKC,EAAeJ,EAAfI,MAAOC,EAAQL,EAARK,IACrBt4C,EAAOugB,EAAMvgB,KACb4rC,GAAS5rC,EAAKsoB,KAAOtoB,EAAKqoB,MAAQroB,EAAK2rC,EAAE,GAAG9rC,OAC5CgsC,GAAS7rC,EAAKwoB,KAAOxoB,EAAKuoB,MAAQvoB,EAAK2rC,EAAE9rC,OAC3C04C,EAAavxC,KAAK6e,OAAOsyB,EAAQn4C,EAAKqoB,MAAQujB,GAC9C4M,EAAaxxC,KAAK6e,OAAOwyB,EAAQr4C,EAAKuoB,MAAQsjB,GAC9C4M,EAAWzxC,KAAK6e,OAAOuyB,EAAMp4C,EAAKqoB,MAAQujB,GAC1C8M,EAAW1xC,KAAK6e,OAAOyyB,EAAMt4C,EAAKuoB,MAAQsjB,GAC1CmM,EAAkB,CACpBrM,EAAG,GACHrjB,KAAMtoB,EAAKqoB,KAAOowB,EAAW7M,EAC7BvjB,KAAMroB,EAAKqoB,KAAOkwB,EAAa3M,EAC/BpjB,KAAMxoB,EAAKuoB,KAAOmwB,EAAW7M,EAC7BtjB,KAAMvoB,EAAKuoB,KAAOiwB,EAAa3M,GAE7B4K,EAAOpjB,OAAOslB,iBACdjC,EAAOrjB,OAAOulB,iBAEdC,EAAYN,EAAaE,EAAW,EAC/Bz7B,EAAIw7B,EAAYx7B,EAAI07B,EAAU17B,IAAK,CAG1C,IAFA,IAAI87B,EAAM,IAAIC,aAAaF,GACvBpW,EAAS8V,EACJ34C,EAAI,EAAGA,EAAIi5C,EAAWj5C,IAC7Bk5C,EAAIl5C,GAAKI,EAAK2rC,EAAE3uB,GAAGylB,KAJqB,qBAMrBqW,GANqB,IAM1C,2BAA0B,CAAC,IAAlBE,EAAiB,QACpBvC,EAAOuC,IAAUvC,EAAOuC,GACxBtC,EAAOsC,IAAUtC,EAAOsC,IARY,8BAU1ChB,EAAWrM,EAAEjvC,KAAKJ,MAAMwE,KAAKg4C,IAK/B,OAHAd,EAAWtB,KAAOA,EAClBsB,EAAWvB,KAAOA,EAEXuB,EArFQE,CAAa33B,EAAOhU,EAAQ0rC,cAE5B13B,EAAMvgB,KAErBuM,EAAQwP,KAAOwE,EAAMxE,KC9aR,SAASk9B,mBAAmBj5C,EAAMuM,GAAU,IAEvD2sC,EAKE3sC,EALF2sC,gBACA7H,EAIE9kC,EAJF8kC,MACA8H,EAGE5sC,EAHF4sC,iBACAC,EAEE7sC,EAFF6sC,gBACAC,EACE9sC,EADF8sC,iBANsD,EASnB9sC,EAAQwP,KAArC4B,EATgD,EAShDA,QAASnB,EATuC,EASvCA,gBACX88B,EAAgB37B,EAAQ,KAAOA,EAAQ,GAa7C,OAXY47B,aAAoBv5C,EAAM,CACpCs5C,gBACA37B,UACA67B,mBAAoBh9B,EACpB08B,kBACA7H,QACA8H,mBACAC,kBACAC,qBD2ZKJ,CAAmBjB,EAAYzrC,GExYxC,SAASqW,qBAAUphB,EAAQ4E,GAAiB,IAAd2I,EAAa,uDAAJ,GACrC,OAAOoS,aAAYs4B,aAAOrzC,GAAI,CAAC5E,EAASuN,EAAQA,IClClD,SAAS2qC,qBAAT,GAA8D,IAAtB/Q,EAAqB,EAA7B55B,OAAqB/O,EAAQ,EAARA,KAAQ,EACIwI,eAAvDjH,EADmD,EACnDA,MAAeqnC,EADoC,EAC5C75B,OAAsB2T,EADsB,EACtBA,QAAS8O,EADa,EACbA,aAExChwB,EAASonC,EAAaz+B,IAEtBioB,EAAQp2B,mBAAQ,WACpB,GAAIgE,EAAM,CAAC,IACDmG,EAAanG,EAAbmG,EAAOC,EAAMpG,EAAV2jB,GACLpI,EAASirB,YAAY,CAAEz3B,OAAQ65B,EAAcrnC,QAAOmhB,YAEpDW,EAAST,qBAAUphB,EAAQ4E,EAAGuiC,GAC9B1X,EAAaC,aACjB,CAAE/qB,IAAGC,KACL,CACEtF,KAAM4hB,EAAQ,GACdzG,GAAIyG,EAAQ,KAIZ0O,EAAI,YAAQ7V,EAAO0V,EAAW9qB,EAAE,IAA5B,YAAmCkd,EAAO4N,EAAW7qB,EAAE,IAAvD,KAKR,OAJAgrB,GAAQH,EAAW9qB,EAAEvH,MAAM,GAAG+hB,QAAO,SAAC0Q,EAAaC,EAAO1xB,GAExD,OADAyxB,GAAW,aAAU9V,EAAO+V,GAAjB,YAA2BjO,EAAO4N,EAAW7qB,EAAExG,EAAI,OAE7D,IAGH,OAAO,OAER,CAACI,EAAMwB,EAAQmnC,EAAaC,EAAcrnC,EAAOmhB,IAEpD,OAAKnhB,GAAUC,EAKb,sBAAKgX,QAAO,cAASjX,EAAT,YAAkBC,GAAUD,MAAOA,EAAOC,OAAQA,EAA9D,UACE,+BACE,0BAAUlE,GAAE,UAAKk0B,EAAL,YAAZ,SACE,sBACEjwB,MAAOA,EAAQqnC,EAAat+B,KAAOs+B,EAAax+B,MAChD5I,OAAQA,EACR2E,EAAGyiC,EAAat+B,KAChBlE,EAAC,UAAK,SAIZ,oBAAG6rB,SAAQ,eAAUT,EAAV,aAAX,UACE,sBACEjwB,MAAOA,EAAQqnC,EAAat+B,KAAOs+B,EAAax+B,MAChD5I,OAAQA,EACR2E,EAAGyiC,EAAat+B,KAChBlE,EAAC,UAAK,GACNqpB,YAAY,MAEd,sBAAM7qB,UAAU,OAAOkmB,OAAO,MAAMrS,KAAK,OAAOC,EAAG0Z,UAvBhD,KA6BXsnB,qBAAqB5xC,aAAe,CAClCiH,OAAQ,IAGKkM,sBAAKy+B,sBChEpB,SAASC,mBAAT,GAA4D,IAAtBvR,EAAqB,EAA7Br5B,OAAqB/O,EAAQ,EAARA,KAAQ,EAMrDwI,eAJM6/B,EAF+C,EAEvD7mC,OACAuN,EAHuD,EAGvDA,OACAyS,EAJuD,EAIvDA,QACAgQ,EALuD,EAKvDA,aAGIhwB,EAASuN,EAAOzE,KAEhB8nB,EAAQp2B,mBAAQ,WACpB,GAAIgE,EAAM,CAAC,IACDmG,EAAanG,EAAbmG,EAAOC,EAAMpG,EAAV2jB,GACLpI,EAASkrB,YAAY,CAAEjlC,OAAQ6mC,EAAct5B,SAAQyS,YAErD6B,EAAST,qBAAUphB,EAAQ4E,EAAGgiC,GAE9BnX,EAAaC,aACjB,CAAE/qB,IAAGC,KACL,CACEtF,KAAM0gB,EAAQ,GACdvF,GAAIuF,EAAQ,KAGV8mB,EAAarX,EAAW9qB,EAAEtG,OAAS,EACnC0oC,EAAatX,EAAW7qB,EAAEvG,OAAS,EACrCuxB,EAAI,aAAS/N,EAAO4N,EAAW7qB,EAAEmiC,IAA7B,YAA6ChtB,EACnD+sB,GADM,KASR,OANAlX,GAAQH,EAAW9qB,EAChBvH,MAAM,EAAG0pC,GACTE,aAAY,SAACnX,EAAaC,EAAOxV,GAEhC,OADAuV,GAAW,cAAWhO,EAAO4N,EAAW7qB,EAAE0V,IAA/B,YAA0CP,EAAO+V,MAE3D,IAGL,OAAO,OAER,CAACtxB,EAAMwB,EAAQuN,EAAQq5B,EAAaC,EAAc7mB,IAE/CinB,EAAaJ,EAAet5B,EAAO1E,OAAS0E,EAAO5E,IAEzD,OAAKs+B,GAAejnC,EAGlB,sBACEgX,QAAO,cAAShX,EAAT,YAAmBinC,EAAa15B,EAAO5E,KAC9C5I,MAAOC,EACPA,OAAQinC,EAAa15B,EAAO5E,IAH9B,UAKE,+BACE,0BAAU7M,GAAE,UAAKk0B,EAAL,aAAZ,SACE,sBAAMjwB,MAAOC,EAAQA,OAAQinC,EAAYtiC,EAAE,IAAIC,EAAG2I,EAAO5E,UAG7D,mBAAG8nB,SAAQ,eAAUT,EAAV,cAAX,SACE,sBAAM5sB,UAAU,OAAOkmB,OAAO,MAAMrS,KAAK,OAAOC,EAAG0Z,SAdtB,KAoBrCunB,mBAAmB7xC,aAAe,CAChCiH,OAAQ,IAGKkM,sBAAK0+B,oBChEpB,SAASC,cAAe,IAAD,EASjBpxC,eAPFjH,EAFmB,EAEnBA,MACAC,EAHmB,EAGnBA,OACAuN,EAJmB,EAInBA,OACAuM,EALmB,EAKnBA,eACMu+B,EANa,EAMnB75C,KACA0iB,EAPmB,EAOnBA,QACAlB,EARmB,EAQnBA,QAEIjjB,ExHhBD,SAASu7C,kBACd,OAAO19C,qBAAW2L,GwHeD+xC,GAEXC,EAAU/9C,mBAAQ,WACtB,GAAIuC,GAAY+c,EAAehe,GAAI,CAAC,IAC1B6I,EAAS5H,EAAT4H,EAAGC,EAAM7H,EAAN6H,EACL4zC,EAAWxT,YAAY,CAAEz3B,SAAQxN,QAAOmhB,YACxCu3B,EAAWxT,YAAY,CAAE13B,SAAQvN,SAAQggB,YACzCxhB,EL4LL,SAASk6C,SAASpoB,EAAUvzB,GACjC,IAAMyB,EAAO8xB,EAAS9xB,KAChB4rC,GAAS5rC,EAAKsoB,KAAOtoB,EAAKqoB,OAASroB,EAAK2rC,EAAE,GAAG9rC,OAAS,GACtDgsC,GAAS7rC,EAAKwoB,KAAOxoB,EAAKuoB,OAASvoB,EAAK2rC,EAAE9rC,OAAS,GACnD4iC,EAASz7B,KAAK6e,OAAOtnB,EAAS4H,EAAInG,EAAKqoB,MAAQujB,GAC/CE,EAAS9kC,KAAK6e,OAAOtnB,EAAS6H,EAAIpG,EAAKuoB,MAAQsjB,GAErD,KAAIpJ,EAAS,GAAKA,GAAUziC,EAAK2rC,EAAE,GAAG9rC,WAClCisC,EAAS,GAAKA,GAAU9rC,EAAK2rC,EAAE9rC,QAAnC,CAiBA,IAfA,IAAIs6C,EAAQ,CACVx8B,QAASmU,EAAS/V,KAAK4B,QAAQ,GAC/BqG,OAAO,EACPD,WAAW,EACXvD,UAAW,GAGT45B,EAAQ,CACVj0C,EAAG2xC,aACD,CAAEh3C,KAAMgxB,EAAS9xB,KAAKqoB,KAAMpM,GAAI6V,EAAS9xB,KAAKsoB,MAC9CwJ,EAAS9xB,KAAK2rC,EAAE,GAAG9rC,QAErB8jB,GAAI,IAAIG,aAAagO,EAAS9xB,KAAK2rC,EAAE,GAAG9rC,SAGjCD,EAAI,EAAGA,EAAIkyB,EAAS9xB,KAAK2rC,EAAE,GAAG9rC,OAAQD,IAC7Cw6C,EAAMz2B,GAAG/jB,IAAMkyB,EAAS9xB,KAAK2rC,EAAEG,GAAQlsC,GAmBzC,IAhBA,IAAIy6C,EAAQ,CACV18B,QAASmU,EAAS/V,KAAK4B,QAAQ,GAC/BqG,OAAO,EACPD,WAAW,EACXvD,UAAW,GAGT85B,EAAQ,CACVn0C,EAAG2xC,aACD,CAAEh3C,KAAMgxB,EAAS9xB,KAAKuoB,KAAMtM,GAAI6V,EAAS9xB,KAAKwoB,MAC9CsJ,EAAS9xB,KAAK2rC,EAAE9rC,QAElB8jB,GAAI,IAAIG,aAAagO,EAAS9xB,KAAK2rC,EAAE9rC,SAGnCic,EAAQgW,EAAS9xB,KAAK2rC,EAAE9rC,OAAS,EAC5BD,EAAI,EAAGA,EAAIkyB,EAAS9xB,KAAK2rC,EAAE9rC,OAAQD,IAC1C06C,EAAM32B,GAAG/jB,IAAMkyB,EAAS9xB,KAAK2rC,EAAE7vB,KAAS2mB,GAK1C,MAAO,CAAE8X,WAFU1I,gBAAgB,CAAE91B,KAAMo+B,EAAOn6C,KAAMo6C,IAEnCI,SADJ3I,gBAAgB,CAAE91B,KAAMs+B,EAAOr6C,KAAMs6C,MK9OrCJ,CAASL,EAAQv+B,EAAeQ,OAAQ,CACnD3V,EAAG6zC,EAASh+B,OAAO7V,GACnBC,EAAG6zC,EAASj+B,OAAO5V,KAErB,OACE,sBACEoS,QAAO,cAASjX,EAAT,YAAkBC,GACzBD,MAAOA,EACPC,OAAQA,EACRlD,MAAO,CACLC,SAAU,WACVgM,gBAAiB,yBANrB,UASGvK,GAAQA,EAAKu6C,YACZ,cAAC,GAAD,CAAsBv6C,KAAMA,EAAKu6C,WAAWv6C,OAE7CA,GAAQA,EAAKw6C,UACZ,cAAC,GAAD,CAAoBx6C,KAAMA,EAAKw6C,SAASx6C,UAKhD,OAAO,OACN,CACDzB,EACA+c,EAAehe,GACfge,EAAeQ,MACf/M,EACAxN,EACAmhB,EACAlhB,EACAggB,EACAq4B,IAGF,OAAKt7C,EAIEw7C,EAHE,KAKXH,YAAY9xC,aAAe,CACzB4iC,kBAAmB,oCAAM,OAG3BkP,YAAYjP,WAAa,CACvBD,kBAAmBE,KAAWC,KAAK/B,YAGtB8Q,mBCgIAa,OApLf,SAASA,WACP,IAAM7/C,EAAQ4N,eAEZmiB,EAME/vB,EANF+vB,aACAlT,EAKE7c,EALF6c,UACAzX,EAIEpF,EAJFoF,KACA+O,EAGEnU,EAHFmU,OACAiT,EAEEpnB,EAFFonB,kBACAvB,EACE7lB,EADF6lB,UAGI3kB,EAAW6M,cAEX0zB,EAAergC,mBAAQ,WAE3B,OADkBykB,EAAUwB,MAAM,KACjBtB,QAAO,SAACC,EAAKoS,GAC5B,GAAIhR,EAAkBgR,IAAMhR,EAAkBgR,GAAG11B,GAAI,CACnD,IAAMA,EAAK0kB,EAAkBgR,GAAG11B,GAC1Bw0B,EAAW9xB,EAAK43B,MACpB,SAACrX,GAAD,OAAWA,EAAMjjB,KAAOA,IAAOijB,EAAMxE,KAAKiI,SAExC8N,GACFlR,EAAIlkB,KAAKo1B,QAGXlR,EAAIlkB,KAAK,MAEX,OAAOkkB,IACN,MACF,CAACH,EAAWzgB,EAAMgiB,IAEf04B,EjCnDR,SAASC,qBAAT,GAA0D,IAA1Bp5C,EAAyB,EAAzBA,MAAOC,EAAkB,EAAlBA,OAAQuN,EAAU,EAAVA,OAC7C,MAAO,CACLu3B,UAAW,CACTx/B,OAAQiI,EAAOzE,KACf7C,OAAQsH,EAAO5E,IACfpD,KAAMxF,EAAQwN,EAAO3E,MACrB5C,KAAMhG,EAASuN,EAAO1E,QAExB+7B,OAAQ,CACNt/B,OAAQiI,EAAOzE,KACf7C,OAAQ,EACRV,KAAMxF,EAAQwN,EAAO3E,MACrB5C,KAAMuH,EAAO5E,KAEfk8B,QAAS,CACPv/B,OAAQ,EACRW,OAAQsH,EAAO5E,IACfpD,KAAMgI,EAAOzE,KACb9C,KAAMhG,EAASuN,EAAO1E,SiCiCRswC,CAAqB//C,GAEjCsqC,EAAiB/nC,uBACrB,SAACgoC,GAEC,GADgBoB,YAAYmU,EAAWvV,GAErC,GAAIA,EAAU3/B,OACJmlB,OAIH,GAAIwa,EAAU5/B,SACnB,OAAQolB,GACN,KAAKpe,GAAQmd,OAAOpsB,GAClBxB,EAAS,aAAEhB,KAAM8Y,IAAgBuxB,SAQjC,GAAoB,MAAhBxa,EACF,OAAO7uB,EAAS,yBACdhB,KAAM6W,IACHwzB,GAFU,IAGb6F,QAASzE,YAAYmU,EAAWvV,QAO9C,CAACxa,EAAc7uB,EAAU4+C,IAGrBlV,EAAsBroC,uBAC1B,SAACM,GAAO,IACKqJ,EAAsBrJ,EAAzB0I,EAAcsB,EAAWhK,EAAd2I,EACb4kC,EAAUzE,YAAYmU,EAAW,CAAE5zC,SAAQW,WAC7CujC,GACFlvC,EAAS,CAAEhB,KAAM0V,GAAew6B,cAGpC,CAAC0P,EAAW5+C,IAGR4pC,EAAa,SAAbA,WAAckV,GAAe,IACtB9zC,EAAsB8zC,EAAzBz0C,EAAcsB,EAAWmzC,EAAdx0C,EACb4kC,EAAUzE,YAAYmU,EAAW,CAAE5zC,SAAQW,WAE7CujC,GAEAlvC,EADc,cAAZkvC,EACO,aAAElwC,KAAM6Y,IAAiBinC,GAEzB,yBAAE9/C,KAAMkW,IAAoB4pC,GAA7B,IAAwC5P,cAKhDrF,EAAaxoC,uBACjB,SAACoB,GAEkBA,EAAT4H,EAAS5H,EAAN6H,IAMb,CAACukB,IApGe,EAuGyBkb,aAAQ,WACjD,OACE,eAAC,WAAD,WACE,cAAC,GAAD,CAASpuB,UAAWA,IAEnBzX,GAAQA,EAAKH,OAAS,GACrB,cAAC8E,aAAD,CACEE,QAASqgC,EACTngC,cAAeygC,EACfznC,QAAS4nC,EACT7gC,OAAQ4gC,EACRpnC,MAAO,CACLiD,MAAO,OACPC,OAAQ,OACRuN,OAAQ,OACRxQ,SAAU,WACVmO,SAAU,UAVd,SAaE,eAACzE,aAAD,CACE3J,MAAO,CAAEiD,MAAO,OAAQC,OAAO,OAASjD,SAAU,YADpD,UAGGosB,GAAgBA,IAAiBpe,GAAQod,YAAYrsB,IACpD,cAAC,GAAD,IAGF,cAAC,GAAD,IACC++B,GACC,cAAC,GAAD,CAAgB0O,OAAQ1O,EAAcyO,OAAQ4P,IAGhD,cAAC,GAAD,CACEnwB,UAAWF,GACXG,gBAAiBkwB,EAAUpU,YAE7B,qCACGjK,GAAgBA,EAAa,IAC5B,cAAC,GAAD,CACE9R,UAAWF,GACXG,gBAAiBkwB,EAAUtU,OAC3B5kC,OAAQuN,EAAO5E,MAGlBkyB,GAAgBA,EAAa,IAC5B,cAAC,GAAD,CACE9R,UAAWF,GACXG,gBAAiBkwB,EAAUrU,QAC3B9kC,MAAOwN,EAAOzE,UAInB+xB,GACC,cAAC,GAAD,CAAc0O,OAAQ1O,EAAcyO,OAAQ4P,IAG9C,cAAC,GAAD,CAAS16C,KAAMq8B,cAMxB,IApKe,mBAuGXyJ,EAvGW,YAuGMvkC,EAvGN,EAuGMA,MAAOC,EAvGb,EAuGaA,OAvGb,EAsKgB0D,qBAtKhB,mBAsKX6gC,EAtKW,KAsKAC,EAtKA,KAiLlB,OAVAC,aAAY,kBAAMD,EAAa,CAAEzkC,QAAOC,aAAW,IAAK,CAACD,EAAOC,IAChE5E,qBAAU,WACJmpC,GAAaG,SAASH,EAAUxkC,QAAU2kC,SAASH,EAAUvkC,SAC/D1F,EAAS,aACPhB,KAAMsV,IACH21B,MAGN,CAACjqC,EAAUiqC,IAEPD,G,kBCzMH77B,GAAwC,CAC5C/L,UAAW,CACT6Q,OAAQ,QAEV8rC,OAAQ,CACNtwC,gBAAiB,UACjBiP,QAAS,OACTtO,aAAc,OACdyO,SAAU,OACVsyB,UAAW,UAGb/sC,KAAM,CACJwa,WAAY,WACZnP,gBAAiB,QACjBiP,QAAS,OACTtO,aAAc,OACduO,MAAO,QAIUqhC,G,4EAInB,uBAAmBn/C,GAAiB,IAAD,2CACjC,cAAMA,IACDf,MAAQ,CAAEo0C,MAAO,KAAM+L,UAAW,MAFN,E,kEAKnC,2BAAyB/L,EAAc+L,GAErC37B,KAAK47B,SAAS,CACZhM,MAAOA,EACP+L,UAAWA,M,oBAKf,kBACE,OAAI37B,KAAKxkB,MAAMmgD,UAGX,sBAAKz8C,MAAO2L,GAAO/L,UAAnB,UACE,mBAAGI,MAAO2L,GAAO4wC,OAAjB,mCACA,0BAASv8C,MAAO2L,GAAO/K,KAAvB,UACGkgB,KAAKxkB,MAAMo0C,MACZ,uBACC5vB,KAAKxkB,MAAMmgD,UAAUE,qBAMvB77B,KAAKzjB,MAAMO,a,eAjCqBg/C,aCrBrCC,GAAezgD,0BAER0gD,GAAgBD,GAAal/C,SAE7Bo/C,GAAW,SAAXA,WACX,OAAOj/C,qBAAW++C,KCapB,SAASl/C,wBAAT,GASI,IARFC,EAQC,EARDA,SACAqR,EAOC,EAPDA,WACAD,EAMC,EANDA,OACA/O,EAKC,EALDA,SACA6N,EAIC,EAJDA,QACAtR,EAGC,EAHDA,KACA0Q,EAEC,EAFDA,WACG7P,EACF,4FACK6R,EAAOtB,iBAAO,MACdovC,EAAepvC,iBAAO,MACtB60B,EAAW70B,iBAAO,IAHvB,EAI2BhH,mBAAS,IAJpC,mBAIMq2C,EAJN,KAIcC,EAJd,KAMD5+C,qBAAU,WACR4Q,EAAKG,QAAUxP,SAASC,cAAc,OACtC,IAAM6N,EAAMuB,EAAKG,QACXuzB,EAAcH,EAASpzB,QAK7B,OAHIJ,GACFA,EAAWpO,YAAY8M,GAElB,WACDA,GACEsB,IACF2zB,EAAYr9B,QAAQsV,cAEpB5L,EAAWzN,YAAYmM,OAI5B,CAACsB,IAEJ,IAAMhQ,EAASJ,uBAAY,SAACmG,GAC1Bk4C,GAAU,SAACC,GACT,IAAMra,EAAqBqa,EAAc57C,OACnC67C,EAAiBD,EAAc18C,QAAO,SAACkB,GAAD,OAAOA,EAAE3C,KAAOgG,EAAMhG,MAMlE,OAJI8jC,EAAqBsa,EAAe77C,QAAUyD,EAAMiJ,QAAQlB,SAC9D/H,EAAMiJ,QAAQlB,UAGTqwC,OAER,IAEGthB,EAAYj9B,uBAAY,WAC5Bm+C,EAAa3tC,QAAQ4tC,OAAO13C,QAAQtG,KACnC,CAACA,IAEEL,EAAOC,uBACX,WAAiC,IAAhC+P,EAA+B,uDAArB,GAAIX,EAAiB,uDAAP,GACjBjP,EAAK0J,KAAKw6B,SAAS/hB,SAAS,IAAIxJ,OAAO,EAAG,GAE1C0lC,EAAY,aAChBp9C,SAAUgO,EAAQhO,UAAYA,EAC9B6N,UACAtR,OACAyP,gBAAiB,QACjBkP,MAAO,SACJlN,GAGCjJ,EAAQ,CACZhG,KACA4P,UACAX,QAASovC,EAGXr4C,MAAc,kBAAM/F,EAAO+F,KAE3B,GAAIA,EAAMiJ,QAAQH,QAAS,CACzB,IAAMu1B,EAAUzoB,YAAW,WACzB3b,EAAO+F,GAEPy9B,EAASpzB,QAAQi0B,OAAOb,EAASpzB,QAAQk0B,QAAQF,GAAU,KAC1Dr+B,EAAMiJ,QAAQH,SAEjB20B,EAASpzB,QAAQjR,KAAKilC,GAMxB,OAHA6Z,GAAU,SAAC5gD,GAAD,OAAWA,EAAMs9B,OAAO50B,MAC9BA,EAAMiJ,QAAQ6B,QAAQ9K,EAAMiJ,QAAQ6B,SAEjC9K,IAET,CAAC/E,EAAUhB,EAAQ6O,EAAStR,IAGxB8gD,EAAUz+C,uBACd,WAAiC,IAAhC+P,EAA+B,uDAArB,GAAIX,EAAiB,uDAAP,GAIvB,OAHAA,EAAQzR,KAAO8O,EACf2C,EAAO,aAAKhC,gBAAiB,UAAWkP,MAAO,SAAYlN,GAEpDrP,EAAKgQ,EAASX,KAEvB,CAACrP,IAGG8xC,EAAQ7xC,uBACZ,WAAiC,IAAhC+P,EAA+B,uDAArB,GAAIX,EAAiB,uDAAP,GAGvB,OAFAA,EAAQzR,KAAO8O,EACf2C,EAAO,aAAKhC,gBAAiB,UAAWkP,MAAO,SAAYlN,GACpDrP,EAAKgQ,EAASX,KAEvB,CAACrP,IAGG6e,EAAO5e,uBACX,WAAiC,IAAhC+P,EAA+B,uDAArB,GAAIX,EAAiB,uDAAP,GAGvB,OAFAA,EAAQzR,KAAO8O,EACf2C,EAAQkN,MAAQ,UACTvc,EAAKgQ,EAASX,KAEvB,CAACrP,IAGG6Q,EAAe5Q,uBACnB,SAACmG,GACC/F,EAAO+F,KAET,CAAC/F,IAGGs+C,EAAmB3b,GAAQqb,GAAQ,SAACj4C,GAAD,OAAWA,EAAMiJ,QAAQhO,YAE5DqP,EAAc5R,mBAAQ,WAC1B,OAAOuR,EACHA,EAAWxH,wBACX,CACEoE,IAAK,EACLG,KAAM,EACN/I,MAAOnC,OAAOyO,WACdrM,OAAQpC,OAAO0O,eAEpB,CAACP,IAEJ,OACE,eAAC6tC,GAAD,CACEjgD,MAAO,CAAEogD,SAAQr+C,OAAMK,SAAQ68B,YAAWwhB,UAAS5M,QAAOjzB,QAD5D,UAGG7f,EACAsR,EAAKG,SACJiB,wBACE,cAAC,WAAD,UACGvT,OAAOC,KAAK4N,GAAWqN,KAAI,SAACxZ,GAC3B,IAAMwB,EAAW2K,EAAUnM,GAE3B,OACE,cAAC8R,GAAA,EAAD,yBACEC,QAAM,EAENvC,QAAS,CAAEhO,WAAUoM,OAAQ,QAC7BqD,UAAW1B,GACXK,eAAgBiB,GACZjS,GANN,aAQGkgD,EAAiBt9C,GACds9C,EAAiBt9C,GAAUgY,KAAI,SAACjT,GAAD,OAC7B,cAAC,GAAD,CAAYxI,KAAM0Q,EAAlB,SACE,sBACElN,MAAO,CACLyQ,OAAQzB,EACRkM,QAAS,OACTtO,aAAc,OACd1M,cAAe,MACf+L,gBAAiBjH,EAAMiJ,QAAQhC,gBAC/BkP,MAAOnW,EAAMiJ,QAAQkN,MACrBxO,UAAW,OACX1M,SAAU,YATd,UAaE,wBACED,MAAO,CACLC,SAAU,WACV6L,MAAO,MACPD,IAAK,MACL2qB,OAAQ,OACRvqB,gBAAiB,cACjBkP,MAAO,SAET3e,KAAK,SACLiD,QAAS,0BAAMgQ,EAAazK,IAV9B,SAYE,cAAC,KAAD,MAGF,+BAAOA,EAAM4J,YAjBR5J,EAAMhG,KAZoBgG,EAAMhG,OAiC3C,OAzCCiB,QA8CbiP,EAAKG,YAwBf1R,wBAAS6L,aAAe,CACtBwF,OAAQ,MACR/O,SAAU2K,EAAUQ,cACpB8B,WAAY3B,EACZ0D,WAAY,KACZnB,QAAS,KAGInQ,+BC1OA,SAAS6/C,kBAAkBhgD,EAAUwH,GAAQ,IAAD,EACH4B,oBAAS,GADN,mBAClD62C,EADkD,KAC7BC,EAD6B,OAElB92C,oBAAS,GAFS,mBAElD+2C,EAFkD,KAEvCC,EAFuC,KAInDC,EAAyBjwC,iBAAO,CAAEkwC,OAAQ,KAsGhD,MAAO,CACLC,mBAtGyBl/C,uBACzB,SAACwtB,GAEG,CACEpe,GAAQid,YAAYlsB,GACpBiP,GAAQkd,SAASnsB,GACjBiP,GAAQmd,OAAOpsB,IACfN,SAAS2tB,IAEXrnB,EAAMpG,KACJ,gFAGJpB,EAAS,CAAEhB,KAAMuV,GAAmBsa,mBAEtC,CAACrnB,EAAOxH,IAwFRwgD,kBArFwBn/C,uBAAY,WACiB,IAAjDg/C,EAAuBxuC,QAAQyuC,OAAOv8C,QACxC/D,EAAS,CACPhB,KAAM0V,GACNi1B,SAAUplB,KAGd,IAAMha,EAAWC,KAAe,WAC9B61C,EAAuBxuC,QAAQyuC,OAAS,KACvC,KACHD,EAAuBxuC,QAAQyuC,OAAO1/C,KAAK2J,GAE3CA,IAEI81C,EAAuBxuC,QAAQyuC,OAAOv8C,OAAS,IACjD0G,IAAU41C,EAAuBxuC,QAAQyuC,QAAQ,SAAC51C,GAAD,OAC/CA,EAASC,YAEX01C,EAAuBxuC,QAAQyuC,OAAS,GACxCtgD,EAAS,CACPhB,KAAM0V,QAGT,CAAC1U,EAAUqgD,IA+DZI,uBA7D6Bp/C,uBAAY,WACzCrB,EAAS,CAAEhB,KAAMkY,GAAawpC,WAAY,SAC1Cl5C,EAAMpG,KAAK,kCACV,CAACoG,EAAOxH,IA2DT2gD,kBAzDwBt/C,uBACxB,WAAsB,IAArBqD,EAAoB,uDAAN,EACb1E,EAAS,CACPhB,KAAMkY,GACNwpC,WAAY,OACZh8C,YAAaA,MAGjB,CAAC1E,IAkDD4gD,kBA/CwBv/C,uBAAY,WACpCrB,EAAS,CACPhB,KAAMkY,GACNwpC,WAAY,WAEb,CAAC1gD,IA2CF6gD,iBAzCuBx/C,uBAAY,WACnCrB,EAAS,CACPhB,KAAMkY,GACNwpC,WAAY,UAEb,CAAC1gD,IAqCF8gD,iBAnCuBz/C,uBACvB,kBAAMrB,EAAS,CAAEhB,KAAMkY,GAAawpC,WAAY,UAChD,CAAC1gD,IAkCD+gD,4BA/BkC1/C,uBAAY,WAC9C,IAAM4lB,GAAQk5B,EACdC,EAAkBn5B,GAClBjnB,EAAS,CACPhB,KAAM2W,GACNsR,KAAMA,MAEP,CAACjnB,EAAUmgD,IAyBZa,0BAvBgC3/C,uBAAY,WAC5CrB,EAAS,CACPhB,KAAMiW,GACNmhC,uBAAwB6J,IAE1BC,GAAwBD,KACvB,CAACjgD,EAAUigD,IAkBZgB,gCAhBsC5/C,uBAAY,WAClDrB,EAAS,CACPhB,KAAMgY,OAEP,CAAChX,IAaFigD,sBACAE,aCqIWe,OAvPf,SAASA,sBAAuB,IAAD,EAMzBx0C,eAJFy0C,EAF2B,EAE3BA,gBACAvV,EAH2B,EAG3BA,cACAwV,EAJ2B,EAI3BA,cACAl9C,EAL2B,EAK3BA,KAEIlE,EAAW6M,cACXrF,EAAQ+3C,KARe,EAgBzBS,kBAAkBhgD,EAAUwH,GAN9B+4C,EAV2B,EAU3BA,mBACAC,EAX2B,EAW3BA,kBACAS,EAZ2B,EAY3BA,gCACAF,EAb2B,EAa3BA,4BACAN,EAd2B,EAc3BA,uBACAE,EAf2B,EAe3BA,kBAGM5gD,EAAcM,eAAdN,UACFm9B,EAAiBiB,oBAEjBkjB,EAAcnhD,mBAAQ,WAC1B,OAAO0rC,IAAkBN,GAAeC,OAASrnC,GAAQA,EAAKH,OAAS,IACtE,CAACG,EAAM0nC,IAEJ0V,EAAcphD,mBAAQ,WAC1B,OAAO0rC,IAAkBN,GAAeE,OAAStnC,GAAQA,EAAKH,OAAS,IACtE,CAACG,EAAM0nC,IAEJrQ,EAAgBl6B,uBACpB,SAACrC,EAAMkF,GACL,OAAQlF,GACN,KAAKV,KAAME,SACTwB,EAAS,CACPhB,KAAMgW,GACNusC,WAAYr9C,EAAKs9C,YAEnB,MAEF,KAAKljD,KAAMC,KACTyB,EAAS,CACPhB,KAAMgV,GACN9P,KAAM,CAAE1C,GAAI0C,EAAKs9C,aAEnB,MAEF,KAAKljD,KAAMG,MACTuB,EAAS,CACPhB,KAAM4X,GACN3X,QAAS,CACPuC,GAAI0C,EAAKs9C,UACTtkB,oBAGJ,MAEF,KAAK5+B,KAAMI,KACTsB,EAAS,CACPhB,KAAM+Y,GACN9Y,QAAS,CACPuC,GAAI0C,EAAKs9C,UACTtkB,uBASV,CAACA,EAAgBl9B,IAGbyhD,EAAiCpgD,uBACrC,SAACM,EAAG+/C,GACEx9C,GAAQA,EAAKH,OAAS,GAAK29C,GAAO,GAAKA,GAAO,IAC5C//C,EAAE8H,UACJzJ,EAAS,CACPhB,KAAMwY,GACNkhB,QAASgpB,IAEXl6C,EAAMpG,KAAN,sCAA0CsgD,EAA1C,2BAEKv5C,0BAA0BxG,KACzBw/C,GAAmBA,EAAgBO,GACrC1hD,EAAS,CACPhB,KAAMyY,GACNihB,QAASgpB,KAGX1hD,EAAS,CACPhB,KAAMwY,GACNkhB,QAASgpB,IAEXl6C,EAAMpG,KAAN,sCACiCsgD,EADjC,+BAQV,CAACl6C,EAAOtD,EAAMlE,EAAUmhD,IAGpBQ,EAAuBtgD,uBAC3B,SAACM,GACC,IAAKA,EAAE8H,WAAa9H,EAAEigD,QACpB,OAAQjgD,EAAEV,KACR,IAAK,IACHu/C,IACA,MACF,IAAK,IACL,IAAK,SACHD,EAAmB9vC,GAAQ6c,KAAK9rB,IAChC,MACF,IAAK,IACC6/C,GACFd,EAAmB9vC,GAAQud,cAAcxsB,IAE3C,MAEF,IAAK,IACC6/C,GACFd,EAAmB9vC,GAAQwd,mBAAmBzsB,IAEhD,MAEF,IAAK,IACC6/C,GACFd,EAAmB9vC,GAAQid,YAAYlsB,IAEzC,MAEF,IAAK,IACH,IAAMqgD,EAASP,EACX7wC,GAAQmd,OAAOpsB,GACf6/C,EACA5wC,GAAQkd,SAASnsB,GACjB,GACJ++C,EAAmBsB,GACnB,MAEF,IAAK,IACCR,GACFd,EAAmB9vC,GAAQuc,gBAAgBxrB,IAQnD,IAAKG,EAAE8H,WAAa9H,EAAEigD,UAAYjgD,EAAEuiC,QAClC,OAAQviC,EAAEV,KACR,IAAK,IACCogD,GACFJ,IAEF,MAEF,IAAK,IACCI,GACFN,IAQR,IAAKp/C,EAAE8H,WAAa9H,EAAEigD,SAAWjgD,EAAEuiC,SACjC,OAAQviC,EAAEV,KACR,IAAK,IACHw/C,IACA9+C,EAAEC,iBACF,MACF,IAAK,IACH++C,IACAh/C,EAAEC,iBAKR,GAAID,EAAE8H,WAAa9H,EAAEigD,SAAWjgD,EAAEuiC,SAChC,OAAQviC,EAAEV,KACR,IAAK,IACH0/C,EAAkB,GAClBh/C,EAAEC,oBAMV,CACEq/C,EACAI,EACAC,EACAP,EACAR,EACAC,EACAG,EACAF,IAIEqB,EAAkBzgD,uBACtB,SAACM,GAAO,IAEU6/C,EAFX,YAIDzhD,EAFFT,YAFG,MAGHN,EACEe,EADFf,KAGF,IACG,CAAC,QAAS,YAAYkC,SAASS,EAAE0xB,OAAO0uB,YACzCX,EACA,CACA,IAAMM,EAAMnqB,OAAO51B,EAAEqgD,KAAK7nC,OAAOxY,EAAEqgD,KAAKj+C,OAAS,KAAO,EACpD29C,EAAM,EACRD,EAA+B9/C,EAAG+/C,GAE9B,CAAmB,aAAcxgD,SAASS,EAAEV,MAAQjC,EACtDu8B,EAAcv8B,EAAM,CAAEwiD,cAEtBG,EAAqBhgD,MAK7B,CACE45B,EACAx7B,EACA0hD,EACAL,EACAO,IAUJ,OANA7gD,qBAAU,WAGR,OAFAuB,SAASqQ,iBAAiB,UAAWovC,GAAiB,GAE/C,kBAAMz/C,SAASsQ,oBAAoB,UAAWmvC,GAAiB,MACrE,CAACA,IAEG,MCxQLG,GAAU,GA8BCC,I,GAAAA,GAxBf,SAASA,cACP,MAAO,CACLC,OAAQ,CACNxoC,KAAM,YACN6qB,SAAS,GAAD,OAAKyd,GAAL,yBAEVv0B,YAAa,CACX/T,KAAM,oBACN6qB,SAAS,GAAD,OAAKyd,GAAL,8BAEVG,gBAAiB,CACfzoC,KAAM,gBACN6qB,SAAS,GAAD,OAAKyd,GAAL,kCAEVI,WAAY,CACV1oC,KAAM,mBACN6qB,SAAS,GAAD,OAAKyd,GAAL,gCAEVK,aAAc,CACZ3oC,KAAM,iBACN6qB,SAAS,GAAD,OAAKyd,GAAL,iCCpBR9zC,GAAS4C,YAAH,mwBAoEGwxC,I,GAAAA,GAxBf,SAASA,gBAAT,GAAuC,IAAZhzC,EAAW,EAAXA,QACnBi1B,EAAWge,KAAcF,aAAa9d,SAE5C,OACE,oBAAKzzB,IAAK5C,GAAV,UACE,oBAAKrF,UAAU,uBAAf,UACE,mBAAIA,UAAU,QAAd,yBACA,aAAC,GAAD,CAAa7G,QAASsN,EAASzG,UAAU,gBAE3C,oBAAKA,UAAU,eAAf,SACE,oBAAKA,UAAU,kBAAf,SACE,uBACEoV,MAAM,uBACNzX,IAAK+9B,EACL2B,YAAY,IACZC,UAAU,OACV5jC,MAAO,CAAEiD,MAAO,OAAQC,OAAQ,kBC9DtCyI,GAAS4C,YAAH,yYAkCGmf,I,GAAAA,GARf,SAASA,0BAAT,GAA2D,IAAnCC,EAAkC,EAAlCA,SAAkC,IAAxBrnB,iBAAwB,MAAZ,SAAY,EACxD,OACE,uBAAQiI,IAAK5C,GAAQrF,UAAWA,EAAW9J,KAAK,SAASiD,QAASkuB,EAAlE,SACE,aAAC,KAAD,CAASrnB,UAAU,YC1BnBqF,GAAS,gBAACA,GAAD,OAAY4C,YAAX,QAAD,iIASX5C,IAGJ,SAASs0C,IAAT,GAQI,IAPFC,EAOC,EAPDA,MACAC,EAMC,EANDA,SACAh+B,EAKC,EALDA,UACA1iB,EAIC,EAJDA,QACA2gD,EAGC,EAHDA,UACAzyB,EAEC,EAFDA,SACA0yB,EACC,EADDA,UAEI/5C,EAAY,gBAGZ6b,IAAc+9B,IAChB55C,GAAa,oBAGf,IAAMqB,EAAe9I,uBACnB,SAACM,GACCM,EAAQ,2BAAKN,GAAN,IAASghD,WAAUD,aAE5B,CAACzgD,EAAS0gD,EAAUD,IAEhBnnB,EAAgBl6B,uBACpB,SAACM,GAGCA,EAAEE,kBACFsuB,EAAS,2BAAKxuB,GAAN,IAASghD,WAAUD,aAE7B,CAACvyB,EAAUwyB,EAAUD,IAEvB,OACE,mBAAI55C,UAAWA,EAAW7G,QAASkI,EAAc4G,IAAK5C,GAAO00C,GAA7D,UACGD,GAAa,aAAC,GAAD,CAAczyB,SAAUoL,IACrConB,KAaQxjC,I,MAAAA,kBAAKsjC,KClEPr1C,GACN,MADMA,GAEL,OCcF01C,GAAY/xC,YAAH,moBAuCTgyC,GAAahyC,YAAH,kmBAqChB,SAASiyC,KAAT,GAOI,IANF5iD,EAMC,EANDA,SACA6B,EAKC,EALDA,QACAghD,EAIC,EAJDA,aACAxgD,EAGC,EAHDA,SACAmgD,EAEC,EAFDA,UACAzyB,EACC,EADDA,SACC,EACiC/mB,qBADjC,mBACMub,EADN,KACiBu+B,EADjB,KAGDpiD,qBAAU,WACRoiD,EAAaD,KACZ,CAACA,IAEJ,IAAME,EAAoB9hD,uBACxB,SAAC+hD,GAAS,IACAT,EAAoBS,EAApBT,SAAUD,EAAUU,EAAVV,MAClBzgD,EAAQ,CAAE0gD,WAAUD,UAEpBQ,EAAaR,KAEf,CAACzgD,IAGGohD,EAAOnjD,mBAAQ,WACnB,OAAOojD,WAAS7oC,IAAIra,GAAU,SAACmjD,GAAW,IAAD,EACWA,EAAM1jD,MAAhD8iD,EAD+B,EAC/BA,SAAUD,EADqB,EACrBA,MAAOc,EADc,EACdA,UAAWX,EADG,EACHA,UAC9BY,EAAaD,EACa,SAA5BA,EAAUvpC,cACV2oC,EACJ,OACE,aAAC,GAAD,CACEj+B,UAAWA,EAEXg+B,SAAUA,EACV1gD,QAASkhD,EACTT,MAAOA,EACPE,UAAWa,EACXtzB,SAAUA,EACV0yB,UAAWA,GANNH,QAUV,CAAC/9B,EAAWi+B,EAAWxiD,EAAU+iD,EAAmBhzB,IAEjDuzB,EAAcxjD,mBAAQ,WAC1B,OAAOojD,WAAS7oC,IAAIra,GAAU,SAACmjD,GAAW,IAAD,EACdA,EAAM1jD,MAAvB6iD,EAD+B,EAC/BA,MAAOlgD,EADwB,EACxBA,MACf,OAAIkgD,IAAU/9B,EACLtR,uBAAakwC,EAAO,CAAE/gD,MAAO,CAAEkM,QAAS,UAE1C2E,uBAAakwC,EAAO,CACzB/gD,MAAM,aAAGkM,QAAS,SAAYlM,UAGjC,CAACmiB,EAAWvkB,IAET+N,EAASjO,mBAAQ,WACrB,OAAQuC,GACN,KAAK2K,GACH,OAAO01C,GACT,KAAK11C,GACH,OAAO21C,GACT,QACE,OAAOD,MAEV,CAACrgD,IAEJ,OACE,oBAAKqG,UAAU,OAAOiI,IAAK5C,EAA3B,UACE,mBAAIrF,UAAU,WAAd,SAA0Bu6C,IAC1B,oBAAKv6C,UAAU,cAAf,SAA8B46C,OAKpCV,KAAKh3C,aAAe,CAClB/J,QAAS,0BAAM,MACfkuB,SAAU,2BAAM,MAChB1tB,SAAU,MACVmgD,WAAW,GAWEzjC,sBAAK6jC,M,UCnLdW,GAAaxoB,sBAAW,SAASwoB,WAAT,EAE5BxzC,GACC,IAFCyzC,EAEF,EAFEA,cAAeC,EAEjB,EAFiBA,SAAUC,EAE3B,EAF2BA,iBAAkB1jD,EAE7C,EAF6CA,SAG7C,OACE,cAAC,KAAD,CACE2jD,SAAU5zC,EACVyzC,cAAeA,EACfC,SAAUA,EACVC,iBAAkBA,EAJpB,SAMG,2BAAM,mCAAG1jD,UAKhBujD,GAAW33C,aAAe,CACxB43C,cAAe,GACfC,SAAU,2BAAM,MAChBC,iBAAkB,MAQLH,U,qBCtBFK,GAAmB,mBACnBC,GAAkB,kBAClBC,GAAyB,yBAEzBC,GAA0B,CACrCC,gBAAiB,GACjB11C,QAAS,CACPq6B,QAAS,CACPO,0BAA0B,EAC1B+a,wBAAwB,GAG1BC,OAAQ,CACNC,kBAAkB,EAClBC,sBAAsB,EACtBC,gBAAgB,EAChBC,oBAAoB,EACpBC,iBAAiB,EACjBC,qBAAqB,EACrBC,kBAAkB,EAClBC,gBAAgB,EAChBC,kBAAkB,EAClBC,kCAAkC,GAGpCC,eAAgB,CACdC,cAAc,EACdC,iBAAiB,EACjBC,YAAY,EACZC,cAAc,EACdC,4BAA4B,EAC5BC,6BAA6B,EAC7BC,mBAAmB,EACnBC,cAAc,EACdC,kBAAkB,EAClBC,oBAAoB,EACpBC,qBAAqB,EACrBC,yBAAyB,EACzBC,4BAA4B,EAC5BC,aAAa,EACbC,iCAAiC,IAGrCxkC,YAAa,CACXC,IAAK,CAAEC,IAAK,EAAGC,KAAM,IACrBskC,KAAM,CACJjhB,iBAAiB,GAEnBkhB,0BAA2B,IAE7BtkC,WAAY,CACVC,QAAS,CACP,CAAE5gB,IAAK,KAAM+Y,KAAM,KAAM+c,IAAK,OAAQC,GAAI,QAC1C,CAAE/1B,IAAK,MAAO+Y,KAAM,MAAO+c,IAAK,OAAQC,GAAI,QAC5C,CAAE/1B,IAAK,MAAO+Y,KAAM,MAAO+c,IAAK,OAAQC,GAAI,QAC5C,CAAE/1B,IAAK,MAAO+Y,KAAM,MAAO+c,IAAK,OAAQC,GAAI,QAC5C,CAAE/1B,IAAK,OAAQ+Y,KAAM,OAAQ+c,IAAK,OAAQC,GAAI,QAC9C,CAAE/1B,IAAK,MAAO+Y,KAAM,MAAO+c,IAAK,OAAQC,GAAI,SAE9CF,aAAc,GACdwtB,OAAQ,IAEVtkD,SAAU,MAGNmmD,GAAa,SAAbA,WAAcnhC,GACdA,EAAMpD,WAAWC,SAAWrhB,MAAMC,QAAQukB,EAAMpD,WAAWC,WAC7DmD,EAAMpD,WAAWkV,aAAe9R,EAAMpD,WAAWC,QAAQgD,QACvD,SAACC,EAAKwf,GAEJ,OADAxf,EAAIwf,EAAKtqB,KAAKC,eAAiBqqB,EACxB,eAAKxf,KAEd,MAKC,SAASshC,mBAAmBtnD,EAAOC,GACxC,OAAQA,EAAOC,MACb,KAAKglD,GACH,IAAMqC,EAAyB5jC,GAC7B,6BACA,GAGC4jC,GAlFqB,MAmFtBA,I9GzDW,SAAbC,WAAcvkC,GAClBC,aAAaukC,WAAWxkC,G8G0DlBukC,CAAW,wB9G9DD,SAAZE,UAAazkC,EAAiB1iB,GAClC2iB,aAAaG,QAAQJ,EAAiB1iB,G8G8DhCmnD,CAAU,4BAtFY,MAyFxB,IAAMC,EAAYhkC,GAAgB,wBAElC,OAAOgF,aAAQ3oB,GAAO,SAACkmB,GACrB,GAAIjmB,EAAOE,QAAS,CAAC,IAAD,EACsBF,EAAOE,QAAvCe,EADU,EACVA,SAAa0mD,EADH,6BAElB1hC,EAAMo/B,gBAAkBsC,EACxB1hC,EAAMtW,QAAUg4C,EAAeh4C,QAC/BsW,EAAMhlB,SAAWA,EACbymD,IACFlnD,OAAOonD,QAAQF,GAAW1+C,SAAQ,YAAa,IAAD,mBAAV8gB,EAAU,KAAP+9B,EAAO,KAC5C5hC,EAAM6D,GAAKg+B,KACTD,EACAF,EAAe79B,GAAK69B,EAAe79B,GAAK,OAG5Cs9B,GAAWnhC,QAKnB,KAAKi/B,GACH,OAAOx8B,aAAQ3oB,GAAO,SAACkmB,GACrB,GAAIjmB,EAAOE,QAAS,CAClB,IAAMiF,EAAOnF,EAAOE,QACpB+lB,EAAMxD,YAActd,EAAKsd,YACzBwD,EAAMpD,WAAa1d,EAAK0d,WACxBoD,EAAMtW,QAAQ41C,OAASpgD,EAAKwK,QAAQ41C,OACpC6B,GAAWnhC,OAGjB,KAAKk/B,GACH,OAAOz8B,aAAQ3oB,GAAO,SAACkmB,GACrB,GAAIjmB,EAAOE,QAAS,CAAC,IAAD,EACKF,EAAOE,QAAtBgC,EADU,EACVA,IAAK5B,EADK,EACLA,MACb2lB,EAAMpD,WAAW0iC,OAAOrjD,GAAO5B,MAGrC,QACE,OAAOP,GC1HEgoD,I,GAAAA,GAff,SAASA,KAAT,GAA+B,IAAD,IAAd76B,YAAc,MAAP,IAAO,EAC5B,OACE,qBACExP,MAAM,6BACNC,QAAQ,kBACRla,MAAO,CAAEiD,MAAOwmB,EAAMvmB,OAAQumB,GAHhC,SAKE,oBAAGtP,KAAK,UAAR,UACE,sBAAMC,EAAE,m6EACR,sBAAMA,EAAE,uB,SCLDmqC,Q,qGAAf,iBAAuB9gD,GAAvB,gBAAA9B,EAAA,wFAE2BqV,MAAMvT,GAFjC,cAEUyT,EAFV,yBAGWA,EAASstC,QAHpB,yDAKW,MALX,gE,sBASA,IAAMC,GAAU,+CAEV94C,GAAS4C,YAAH,ycAkEGm2C,OAhCf,SAASA,kBAAmB,IAAD,EACD99C,qBADC,mBAClB6W,EADkB,KACZknC,EADY,KAWzB,OATArmD,qBAAU,WACRyZ,QAAQC,IAAI,CACVusC,QAAQ,GAAD,OAAIE,GAAJ,aACPF,QAAQ,GAAD,OAAIE,GAAJ,YACN7/C,MAAK,SAAClD,GACPijD,EAAQjjD,QAET,IAEI+b,EACL,oBAAKlP,IAAK5C,GAAV,UACE,aAAC,GAAD,IACA,yCACA,mCAAQ8R,EAAK,GAAG,GAAGjG,QAEnB,qBAAMlR,UAAU,cAEhB,kBAAGs+C,KAAMnnC,EAAK,GAAG,GAAGonC,YAAah0B,OAAO,SAASi0B,IAAI,aAArD,mCACyBrnC,EAAK,GAAG,GAAGjG,QAEpC,qBAAMlR,UAAU,cAEhB,kBAAGs+C,KAAMnnC,EAAK,GAAG,GAAGsnC,SAAUl0B,OAAO,SAASi0B,IAAI,aAAlD,yBACe,IAAIE,KAAKvnC,EAAK,GAAG,GAAGwnC,OAAOC,OAAOC,MAAMC,cADvD,KAEG3nC,EAAK,GAAG,GAAG4nC,IAAI1tC,OAAO,EAAG,IAF5B,WAKA,MC9EA2tC,GAAW3sB,sBAAW,SAAS2sB,SAAT,EAE1B33C,GACC,IAAD,IAFE6J,YAEF,MAFS,GAET,EAFsB+tC,EAEtB,EAFajV,QAEb,IAFkC5Z,gBAElC,MAF6C,kBAAM,MAEnD,EAFyD/1B,EAEzD,EAFyDA,SAEzD,EAC4BiG,mBAAS2+C,GADrC,mBACOjV,EADP,KACgBkV,EADhB,KAGMC,EAAc5mD,uBAClB,SAACM,GAECqmD,GADkBlV,GAElB5Z,EAASv3B,KAEX,CAACmxC,EAAS5Z,IAGZ,OACE,uBACE/oB,IAAKA,EACLnR,KAAK,WACLgb,KAAMA,EACNxY,GAAIwY,EACJkf,SAAU+uB,EACVC,eAAgBH,EAChB5kD,SAAUA,OAKhB2kD,GAAS97C,aAAe,CACtBktB,SAAU,SAAS,WACjB,OAAO,MAETlf,KAAM,GACN7W,UAAU,GAGG2kD,UC/Bf,SAASK,eAAT,GAOI,IANF56B,EAMC,EANDA,MACAvT,EAKC,EALDA,KACAkf,EAIC,EAJDA,SACApwB,EAGC,EAHDA,UACAmsB,EAEC,EAFDA,QACGmzB,EACF,oEACiCC,eAA1BnyB,EADP,EACOA,OAAQoyB,EADf,EACeA,cACVjpD,EAAQ41B,GAAWzS,IAAU0T,EAAQlc,GAAQwI,IAAU0T,EAAQlc,GAE/DuuC,EAAgBlnD,uBACpB,SAACM,GACCA,EAAEyI,UACF8uB,EAASv3B,GACT2mD,EAActuC,EAAMib,EAAU51B,GAASA,KAEzC,CAAC2a,EAAMkf,EAAUjE,EAASqzB,EAAejpD,IAE3C,OACE,sBAAKyJ,UAAS,UAAKA,EAAL,kBAAwBzJ,GAAtC,UACE,uBAAOmpD,QAASxuC,EAAMlR,UAAU,iBAAhC,SACGykB,IAEH,cAAC,GAAD,aACE/rB,GAAIwY,EACJA,KAAMA,EACN84B,QAASzzC,EACT65B,SAAUqvB,EACVz/C,UAAU,YACNs/C,OAcZD,eAAen8C,aAAe,CAC5BlD,UAAW,GACXowB,SAAU,2BAAM,MAChBjE,SAAS,GAGIkzB,sBCtDTh6C,GACG,CACLs6C,WAAY,EACZv1C,WAAY,QAHV/E,GAKG,CACLzI,OAAQ,OACRD,MAAO,QACP2J,aAAc,MACd4pB,OAAQ,uBACR/lB,OAAQ,kBACRk9B,UAAW,UAITuY,GAAQvtB,sBAAW,SAASutB,MAAT,EAevBv4C,GACC,IAdCod,EAcF,EAdEA,MACAluB,EAaF,EAbEA,MACA2a,EAYF,EAZEA,KACAxX,EAWF,EAXEA,MACA02B,EAUF,EAVEA,SACAD,EASF,EATEA,UACA0vB,EAQF,EAREA,WACA3pD,EAOF,EAPEA,KACA4pD,EAMF,EANEA,iBACA9/C,EAKF,EALEA,UACA0uB,EAIF,EAJEA,OACGqxB,EAGL,sIACsBz/C,mBAAS/J,GAD/B,mBACO2sB,EADP,KACY88B,EADZ,KAEAhoD,qBAAU,WACRgoD,EAAOzpD,KACN,CAACA,IAEJyB,qBAAU,WACJ8nD,GACFz4C,EAAI0B,QAAQk3C,WAEb,CAACH,EAAkBz4C,IAEtB,IAAMyS,EAAWvhB,uBACf,SAAChC,GAEC,OADoBm4B,GACbwxB,CACI,WAAThqD,EAC6B,MAAzB6B,OAAOxB,GAAOs4B,OACZJ,OAAO,GACPA,OAAOl4B,GACTA,KAGR,CAACm4B,EAAQx4B,IAGLiqD,EAAkB5nD,uBACtB,SAACM,GACCA,EAAEyI,UACFzI,EAAEE,kBACFF,EAAEC,iBAWF,IAAMq2B,EAASt2B,EAAE0xB,OAAOh0B,MACxB,GAXA,SAAS6pD,MAAM7pD,GACb,GAAa,WAATL,EAAmB,CAErB,QAAqB,KAAjBK,EAAMs4B,SADM,yCACmBwxB,KAAK9pD,IAK1C,OAAO,EAGL6pD,CAAMjxB,IAAW0wB,EAAW1wB,GAAS,CACvC,IAAM+wB,EAAcxxB,IAEpBsxB,EAAOE,EAAY/wB,IACnBiB,EAAS,2BACJv3B,GADG,IAEN0xB,OAAQ,CAAErZ,KAAMrY,EAAE0xB,OAAOrZ,KAAM3a,MAAOujB,EAASqV,UAIrD,CAAC0wB,EAAYnxB,EAAQ5U,EAAUsW,EAAUl6B,IAGrCu5B,EAAgBl3B,uBACpB,SAAC+G,GACCA,EAAMgC,UACN6uB,EAAU,2BACL7wB,GADI,IAEPirB,OAAQ,CAAErZ,KAAM5R,EAAMirB,OAAOrZ,KAAM3a,MAAOujB,EAASoJ,SAGvD,CAACpJ,EAAUqW,EAAWjN,IAElBo9B,EAAmB/nD,uBAAY,SAAC+G,GACpCA,EAAMvG,oBACL,IAEH,OACE,sBACEW,MAAK,aACHkM,QAAS,OACTO,cAAe,MACfL,WAAY,UACRpM,GAASA,EAAMJ,UAAYI,EAAMJ,UAAY,IALrD,UAQGmrB,GACC,sBACE/qB,MAAK,2BACA2L,IACC3L,GAASA,EAAM+qB,MAAQ/qB,EAAM+qB,MAAQ,IAE3CzkB,UAAU,QALZ,SAOGykB,IAGL,iDACMs7B,GADN,IAEE14C,IAAKA,EACL6J,KAAMA,EACNxX,MAAK,2BACA2L,IACC3L,GAASA,EAAM6mD,MAAQ7mD,EAAM6mD,MAAQ,IAE3CrqD,KAAK,OACLK,MAAO2sB,EACPkN,SAAU+vB,EACVhwB,UAAWV,EACX+wB,WAAYF,EACZngD,cAAe,uBAACtH,GAAD,OAAOA,EAAEE,mBACxBiH,UAAS,gBAAWA,YAwB5B4/C,GAAM18C,aAAe,CACnBxJ,MAAO,CACL+qB,MAAO,GACP87B,MAAO,GACPjnD,UAAW,IAEb/C,MAAO,GACP65B,SAAU,oBACR,OAAO,MAETyvB,WAAY,6BAAM,GAClB1vB,UAAW,4BAAM,MACjBj6B,KAAM,OACN8J,UAAW,GACX8/C,kBAAkB,EAClBpxB,OAAQ,yBAAM,SAACxL,GAAD,OAASA,KAGV08B,UC5Kf,SAASa,YAAT,GAWI,IAVFh8B,EAUC,EAVDA,MACAvT,EASC,EATDA,KACAxX,EAQC,EARDA,MACA02B,EAOC,EAPDA,SACAyvB,EAMC,EANDA,WACA3pD,EAKC,EALDA,KACA8J,EAIC,EAJDA,UACAzJ,EAGC,EAHDA,MACAm4B,EAEC,EAFDA,OACG4wB,EACF,uGAOGC,eALFnyB,EAFD,EAECA,OACAyC,EAHD,EAGCA,aACA2vB,EAJD,EAICA,cACAkB,EALD,EAKCA,OACAC,EAND,EAMCA,QAEIlB,EAAgBlnD,uBACpB,SAACM,GACCu3B,EAASv3B,GACTg3B,EAAah3B,KAEf,CAACg3B,EAAcO,IAGjBp4B,qBAAU,WACJzB,GACFipD,EAActuC,EAAM3a,KAErB,CAAC2a,EAAMsuC,EAAejpD,IAEzB,IAAMqqD,EAAYxpD,mBAAQ,WACxB,OAAOsiB,IAAUgnC,EAAQxvC,IAASwI,IAAUinC,EAASzvC,KACpD,CAACwvC,EAAQxvC,EAAMyvC,IAClB,OACE,cAAC,GAAD,aACEl8B,MAAOA,EACPvT,KAAMA,EACN3a,MAAOA,GAAgBmjB,IAAU0T,EAAQlc,GACzCkf,SAAUqvB,EACVvpD,KAAMA,EACNwD,MAAO,CAAE6mD,MAAM,2BAAM7mD,GAAWknD,GAAa,CAAEpiB,YAAa,SAC5DqhB,WAAYA,EACZ7/C,UAAWA,EACX0uB,OAAQA,GACJ4wB,IAoBVmB,YAAYv9C,aAAe,CACzBxJ,MAAO,CACL+qB,MAAO,GACP87B,MAAO,IAETnwB,SAAU,oBACR,OAAO,MAETyvB,WAAY,6BAAM,GAClB3pD,KAAM,OACN8J,UAAW,GACXzJ,MAAO,KACPm4B,OAAQ,yBAAM,SAACxL,GAAD,OAASA,KAGVu9B,mBC1DAI,OA5Bf,SAASA,wBACP,OACE,qCACE,mBAAG7gD,UAAU,iBAAb,4CACA,cAAC,GAAD,CAAa9J,KAAK,SAASuuB,MAAM,MAAMvT,KAAK,wBAC5C,cAAC,GAAD,CAAahb,KAAK,SAASuuB,MAAM,OAAOvT,KAAK,yBAC7C,mBAAGlR,UAAU,iBAAiBtG,MAAO,CAAEonD,UAAW,QAAlD,gCAGA,cAAC,GAAD,CACE9gD,UAAU,wBACVykB,MAAM,+BACNvT,KAAK,qCAGP,mBAAGlR,UAAU,iBAAiBtG,MAAO,CAAEonD,UAAW,QAAlD,qBAGA,cAAC,GAAD,CACE5qD,KAAK,SACLuuB,MAAM,2CACNvT,KAAK,wCACL2uC,WAAY,oBAACtpD,GAAD,OAAWA,GAAS,GAAKA,GAAS,SCrBhDwqD,GAAO,CACX,CACEt8B,MAAO,gBACPvT,KAAM,mCAER,CACEuT,MAAO,oBACPvT,KAAM,uCAER,CACEuT,MAAO,cACPvT,KAAM,iCAER,CACEuT,MAAO,kBACPvT,KAAM,qCAER,CACEuT,MAAO,eACPvT,KAAM,kCAER,CACEuT,MAAO,mBACPvT,KAAM,sCAER,CACEuT,MAAO,gBACPvT,KAAM,mCAER,CACEuT,MAAO,cACPvT,KAAM,iCAER,CACEuT,MAAO,gBACPvT,KAAM,mCAER,CACEuT,MAAO,kCACPvT,KAAM,oDAwBK8vC,I,GAAAA,GApBf,SAASA,kBAAT,GAA6C,IAAhBj1B,EAAe,EAAfA,YAC3B,OACE,qCACE,mBAAG/rB,UAAU,iBAAb,gCACC+gD,GAAKpvC,KACJ,SAAC6pB,GAAD,OACG9hB,IAAUqS,EAAD,0BAAiCyP,EAAKtqB,OAAQ,IACtD,cAAC,GAAD,CAEElR,UAAU,mBACVykB,MAAO+W,EAAK/W,MACZvT,KAAMsqB,EAAKtqB,KACXib,SAAO,GAJFqP,EAAKtqB,aC5ClB7L,GAAS4C,YAAH,+kBAiIGg5C,I,GAAAA,GA5Ff,SAASA,uBAAwB,IAAD,EACI1B,eAA1BnyB,EADsB,EACtBA,OAAQoyB,EADc,EACdA,cACVnZ,EAAYjvC,mBAAQ,kBAAMsiB,IAAU0T,EAAQ,qBAAsB,MAAK,CAC3EA,IAGIqF,EAAgBl6B,uBACpB,SAAC2e,GACC,IAAMgqC,EAAkB7a,EAAUrJ,OAAO,EAAG9lB,GAC5CsoC,EAAc,qBAAsB0B,KAEtC,CAAC7a,EAAWmZ,IAGR2B,EAA6B5oD,uBAAY,WAC7C,IAAM6oD,EAAY,CAChBjpD,IAAK2wC,aACL53B,KAAM,GACN+c,IAAK,OACLC,GAAI,QAEAmzB,EAAY,uBAAOhb,GAAP,CAAkB+a,IACpC5B,EAAc,qBAAsB6B,KACnC,CAAChb,EAAWmZ,IAEf,OACE,aAAC,WAAD,WACE,kBAAGx/C,UAAU,iBAAb,4CACA,oBAAKiI,IAAK5C,GAAV,SACE,gCACE,+BACE,6BACE,mBAAIrF,UAAU,cAAd,eACA,mBAAIA,UAAU,oBAAd,sBACA,mBAAIA,UAAU,2BAAd,0BACA,mBAAIA,UAAU,2BAAd,2BACA,mBAAIA,UAAU,kCAGlB,+BACGqmC,GACCA,EAAU10B,KAAI,SAACoH,EAAS7B,GACtB,IAAM0hC,EAAM1hC,EAAQ,EACpB,OACE,6BACE,mBAAIlX,UAAU,cAAd,UACE,+BAAO44C,EAAP,SAAsB,OAExB,mBAAI54C,UAAU,oBAAd,SACE,aAAC,GAAD,CACEkR,KAAI,6BAAwBgG,EAAxB,SACJlX,UAAU,gBAGd,mBAAIA,UAAU,2BAAd,SACE,aAAC,GAAD,CACEkR,KAAI,6BAAwBgG,EAAxB,QACJlX,UAAU,gBAGd,mBAAIA,UAAU,2BAAd,SACE,aAAC,GAAD,CACEkR,KAAI,6BAAwBgG,EAAxB,OACJlX,UAAU,gBAGd,mBAAIA,UAAU,sBAAd,UACE,aAAC,GAAD,CACE7G,QAAS,0BAAMs5B,EAAcvb,IAC7BX,WAAU,iBAAYwC,EAAQ7H,MAC9BiE,eAAe,UAEhBkxB,EAAUprC,SAAWic,EAAQ,GAC5B,uBACElX,UAAU,MACV9J,KAAK,SACLiD,QAASgoD,EAHX,SAKE,aAAC,KAAD,WAlCR,UAAYpoC,EAAQ5gB,oBC5EhCkN,GAAS4C,YAAH,s8EA0MGq5C,OA1Ef,SAASA,gBAAT,GAA+C,IAApB76C,EAAmB,EAAnBA,QAAS86C,EAAU,EAAVA,OAAU,EACVjhD,mBAAS,eADC,mBACrCub,EADqC,KAC1Bu+B,EAD0B,KAEtCruB,EAAc7nB,iBAFwB,EAGhB8U,yBAAyB,wBAA5CwoC,EAHmC,oBAItCC,EAAUn6C,mBAEVo6C,EAAanpD,uBAAY,WAC7BkpD,EAAQ14C,QAAQ44C,eACf,IAEGC,EAAgBrpD,uBACpB,SAAC60B,GAEqDA,EAA5Cl2B,SAA4Ck2B,EAAlCkuB,gBAFR,IAE4BuG,EAF5B,aAE0Cz0B,EAF1C,gCAGVo0B,EAAgBK,GAChB91B,EAAY70B,SAAS,CAAEhB,KAAMilD,GAAiBhlD,QAASi3B,IACvDm0B,MAEF,CAACA,EAAQx1B,EAAay1B,IAGlBM,EAAmBvpD,uBAAY,SAAC+hD,GACpCF,EAAaE,EAAIV,SAChB,IAEH,OACE,oBAAK3xC,IAAK5C,GAAV,UACE,oBAAKrF,UAAU,gBAAf,UACE,mDACA,aAAC,GAAD,CAAa7G,QAASsN,EAASzG,UAAU,gBAE3C,oBAAKA,UAAU,eAAf,SACE,aAAC,GAAD,CACEqH,IAAKo6C,EACL3G,cAAe/uB,EACfgvB,SAAU6G,EAHZ,SAKE,aAAC,GAAD,CACEjoD,SAAS,OACTwgD,aAAct+B,EACd1iB,QAAS2oD,EAHX,UAKE,oBACE9hD,UAAU,gBACV65C,SAAS,cACTD,MAAM,cAHR,SAKE,aAAC,GAAD,MAEF,oBACE55C,UAAU,gBACV65C,SAAS,aACTD,MAAM,aAHR,SAKE,aAAC,GAAD,MAEF,oBAAK55C,UAAU,gBAAgB65C,SAAS,UAAUD,MAAM,UAAxD,SACE,aAAC,GAAD,CAAmB7tB,YAAaA,MAElC,oBAAK/rB,UAAU,gBAAgB65C,SAAS,QAAQD,MAAM,QAAtD,SACE,aAAC,GAAD,aAKR,oBAAK55C,UAAU,mBAAf,SACE,uBAAQ9J,KAAK,SAASiD,QAASuoD,EAAY1hD,UAAU,cAArD,wBC/MFqF,GACO,CACTO,QAAS,QAFPP,GAIG,CACLs6C,WAAY,EACZv1C,WAAY,OACZ3B,KAAM,KAPJpD,GASY,CACdoD,KAAM,IACN7C,QAAS,OACTC,eAAgB,cAZdR,GAcG,CACLzI,OAAQ,OACRD,MAAO,QACP2J,aAAc,MACd4pB,OAAQ,uBACR/lB,OAAQ,kBACRk9B,UAAW,UAIT0a,GAAc1vB,sBAAW,SAAS0vB,YAAT,EAE7B16C,GACC,IAFCod,EAEF,EAFEA,MAAOvT,EAET,EAFSA,KAAM+I,EAEf,EAFeA,aAAcvgB,EAE7B,EAF6BA,MAAO02B,EAEpC,EAFoCA,SAAU4xB,EAE9C,EAF8CA,QAASC,EAEvD,EAFuDA,QAASviD,EAEhE,EAFgEA,KAAM+c,EAEtE,EAFsEA,IAGhEylC,EAAW56C,mBACX66C,EAAe5pD,uBACnB,SAACM,GACKA,EAAE0xB,OAAO63B,gBACY,KAAnBvpD,EAAE0xB,OAAOh0B,MACX65B,EAAS,2BAAKv3B,GAAN,IAAS0xB,OAAO,2BAAM1xB,EAAE0xB,QAAT,IAAiBh0B,MAAO0jB,OAE/CmW,EAASv3B,IAGEwO,GAAY66C,GACpBn5C,QAAQxS,MAAQ0jB,IAGzB,CAACA,EAAcmW,EAAU/oB,IAE3B,OACE,sBAAK3N,MAAK,2BAAO2L,IAAqB3L,EAAMJ,WAA5C,UACE,sBAAMI,MAAK,2BAAO2L,IAAiB3L,EAAM+qB,OAAzC,SAAmDA,IACnD,qBAAK/qB,MAAK,2BAAO2L,IAA0B3L,EAAM2oD,gBAAjD,SACE,uBACEh7C,IAAKA,GAAY66C,EACjBhxC,KAAMA,EACNxX,MAAK,2BAAO2L,IAAiB3L,EAAM6mD,OACnCrqD,KAAK,SACL+rD,QAASA,EACThoC,aAAcA,EACdva,KAAMA,EACN0wB,SAAU+xB,EACVH,QAASA,EACTvlC,IAAKA,GACAxC,WAwBf8nC,GAAY7+C,aAAe,CACzB++C,QAAS,iBACTviD,KAAM,MACN+c,IAAK,MACL/iB,MAAO,CACL+qB,MAAO,GACP87B,MAAO,GACPjnD,UAAW,GACX+oD,eAAgB,IAElBpoC,aAAc,EACdmW,SAAU,oBACR,OAAO,MAET4xB,QAAS,mBACP,OAAO,OAIID,UClGT18C,GAAS,CACb/L,UAAW,CACTsb,QAAS,MACThY,OAAQ,OACRgJ,QAAS,OACTmP,SAAU,QAEZwrC,MAAO,CACL5jD,MAAO,QAET0lD,eAAgB,CACd55C,KAAM,KAERgc,MAAO,CACLhc,KAAM,KAER65C,aAAc,CACZ1lD,OAAQ,OACRD,MAAO,OACP2J,aAAc,MACd4pB,OAAQ,uBACR/lB,OAAQ,UACRC,WAAY,SA8FDm4C,I,GAAAA,GA1Ff,SAASA,6BACP,IAAMrrD,EAAW6M,cACXy+C,EAAiBl7C,mBACjBm7C,EAAsBn7C,mBACtBo7C,EAAcp7C,mBACdq7C,EAAkBr7C,mBAElBs7C,EAAoBrqD,uBAAY,WACpCrB,EAAS,CACPhB,KAAMyX,GACNhG,QAAS,CACPk7C,iBAAkBJ,EAAoB15C,QAAQxS,MAC9C21C,YAAasW,EAAez5C,QAAQxS,MACpCmsD,YAAaA,EAAY35C,QAAQxS,MACjCusD,aAAcH,EAAgB55C,QAAQihC,aAGzC,CAAC9yC,IAEE6rD,EAAqBxqD,uBAAY,WACrCrB,EAAS,CACPhB,KAAM+X,OAEP,CAAC/W,IAEJ,OACE,sBAAKwC,MAAO2L,GAAO/L,UAAnB,UACE,cAAC,GAAD,CACE+N,IAAKo7C,EACLh+B,MAAM,uBACNvT,KAAK,mBACLxX,MAAO,CACL6mD,MAAOl7C,GAAOk7C,MACd8B,eAAgBh9C,GAAOg9C,eACvB59B,MAAOpf,GAAOof,OAEhBxK,aAAc,KAEhB,cAAC,GAAD,CACE5S,IAAKq7C,EACLj+B,MAAM,eACNvT,KAAK,cACLxX,MAAO,CACL6mD,MAAOl7C,GAAOk7C,MACd8B,eAAgBh9C,GAAOg9C,eACvB59B,MAAOpf,GAAOof,OAEhBxK,aAAc,IAEhB,cAAC,GAAD,CACE5S,IAAKm7C,EACL/9B,MAAM,iBACNvT,KAAK,cACLxX,MAAO,CACL6mD,MAAOl7C,GAAOk7C,MACd8B,eAAgBh9C,GAAOg9C,eACvB59B,MAAOpf,GAAOof,OAEhBxK,aAAc,GACdva,KAAK,SAGP,sBAAKhG,MAAO,CAAEspD,aAAc,WAAYC,YAAa,OAArD,UACE,uBACEvpD,MAAO,CAAEupD,YAAa,MAAOtD,WAAY,EAAGv1C,WAAY,QACxDs1C,QAAQ,eAFV,8BAMA,cAAC,GAAD,CAAUxuC,KAAK,eAAe7J,IAAKs7C,OAGrC,wBACEzsD,KAAK,SACLwD,MAAO2L,GAAOi9C,aACdnpD,QAASypD,EAHX,mBAOA,wBACE1sD,KAAK,SACLwD,MAAO2L,GAAOi9C,aACdnpD,QAAS4pD,EAHX,wBCzGAG,GAAS7wB,sBAAW,SAAS6wB,OAAT,EAExB77C,GACC,IAFCjM,EAEF,EAFEA,KAAM1B,EAER,EAFQA,MAAO02B,EAEf,EAFeA,SAAUnW,EAEzB,EAFyBA,aAAc/I,EAEvC,EAFuCA,KAGjCiyC,EAAkB5qD,uBACtB,SAACM,GACC,IAAItC,EAAQsC,EAAE0xB,OAAOh0B,MAChB6sD,MAAM7sD,KACTA,EAAQk4B,OAAOl4B,IAEjB65B,EAAS75B,KAEX,CAAC65B,IAGG/qB,EAAS4C,YAAH,ybAKDvO,EAAMiD,MAAQjD,EAAMiD,MAAQ,EAAI,IAtB1B,+kBA2BUjD,EAAMiD,MAAQjD,EAAMiD,MAAQ,GAAK,IAU5D,OACE,uBACEsL,IAAK,CAAC5C,EAAQ3L,GACd2N,IAAKA,EACL6J,KAAMA,EACNkf,SAAU+yB,EACVlpC,aAAcA,EALhB,SAOG7e,EAAKuW,KAAI,SAACmC,GAAD,OACR,uBAAyBvd,MAAOud,EAAEvd,MAAlC,SACGud,EAAE2Q,OADL,UAAgB3Q,EAAE3b,cAgB1B+qD,GAAOhgD,aAAe,CACpBktB,SAAU,SAAS,WACjB,OAAO,MAET12B,MAAO,CAAEiD,MAAO,KAChBuU,KAAM,IAGOgyC,UChET79C,GAAS,CACb/L,UAAW,CACTsb,QAAS,MACThY,OAAQ,OACRgJ,QAAS,QAEX6e,MAAO,CACLk7B,WAAY,EACZv1C,WAAY,QAEdk4C,aAAc,CACZ1lD,OAAQ,OACRD,MAAO,OACP2J,aAAc,MACd4pB,OAAQ,uBACR/lB,OAAQ,UACRC,WAAY,SAqHDi5C,OAjHf,SAASA,0BACP,IAAMnsD,EAAW6M,cACXu/C,EAAeh8C,mBACfi8C,EAAmBj8C,mBACnBk8C,EAAel8C,mBACfm8C,EAAYn8C,mBALe,EAMChH,mBAAS,cANV,mBAM1B8f,EAN0B,KAMfsjC,EANe,KAQ3Bd,EAAoBrqD,uBAAY,WACpC,IAAIoP,EAAU,GACd,OAAQyY,GACN,IAAK,SACHzY,EAAU,CACRyY,UAAWkjC,EAAav6C,QAAQxS,MAChCotD,cAAeJ,EAAiBx6C,QAAQxS,MACxCqtD,UAAWJ,EAAaz6C,QAAQxS,OAElC,MACF,IAAK,aACHoR,EAAU,CACRyY,UAAWkjC,EAAav6C,QAAQxS,MAChCuqB,OAAQ2iC,EAAU16C,QAAQxS,OAMhCW,EAAS,CACPhB,KAAMuY,GACN9G,cAED,CAACyY,EAAWlpB,IAET6rD,EAAqBxqD,uBAAY,WACrCrB,EAAS,CACPhB,KAAM+X,OAEP,CAAC/W,IAEE2sD,EAAoBtrD,uBAAY,WACpC,OAAO9B,OAAOC,KAAKspB,IAAoBrO,KAAI,SAACuR,GAC1C,MAAO,CAAE/qB,IAAK+qB,EAAKuB,MAAOzE,GAAmBkD,GAAM3sB,MAAO2sB,QAE3D,IAEG4gC,EAAyBvrD,uBAAY,SAAC2qB,GAC1CwgC,EAAaxgC,KACZ,IAEH,OACE,sBAAKxpB,MAAO2L,GAAO/L,UAAnB,UACE,sBAAMI,MAAO2L,GAAOof,MAApB,yBACA,cAAC,GAAD,CACEpd,IAAKi8C,EACLloD,KAAMyoD,IACNnqD,MAAO,CAAEqqD,WAAY,GAAId,YAAa,IACtC7yB,SAAU0zB,EACV7pC,aAAa,eAEdmG,GAA2B,WAAdA,GACZ,eAAC,WAAD,WACE,cAAC,GAAD,CACEqE,MAAM,iBACNpd,IAAKk8C,EACLryC,KAAK,gBACL+I,aAAc,MAEhB,cAAC,GAAD,CACEwK,MAAM,aACNpd,IAAKm8C,EACLtyC,KAAK,YACL+I,aAAc,UAKnBmG,GAA2B,mBAAdA,GACZ,cAAC,GAAD,CACEqE,MAAM,UACNpd,IAAKo8C,EACLvyC,KAAK,SACL+I,aAAc,IAIjBmG,GAA2B,eAAdA,GACZ,cAAC,GAAD,CACEqE,MAAM,UACNpd,IAAKo8C,EACLvyC,KAAK,SACL+I,aAAc,IAIlB,wBACE/jB,KAAK,SACLwD,MAAO2L,GAAOi9C,aACdnpD,QAASypD,EAHX,mBAQA,wBACE1sD,KAAK,SACLwD,MAAO2L,GAAOi9C,aACdnpD,QAAS4pD,EAHX,wBCnIA19C,GAAS,CACb/L,UAAW,CACTqD,MAAO,OACPC,OAAQ,OACRgJ,QAAS,OACTE,WAAY,SACZD,eAAgB,SAChBqqB,OAAQ,uBACR5pB,aAAc,MACd8D,WAAY,OACZzE,gBAAiB,YACjBoP,SAAU,OACVF,MAAO,UACP1K,OAAQ,UACRK,OAAQ,aAEVia,MAAO,CACL3P,WAAY,SACZkvC,aAAc,WACdl8C,SAAU,SACVm8C,SAAU,SAIVC,GAAc,CAChBxkD,KAAM,WAGJq9B,GAAU,KACVonB,GAAS,EACTC,GAAO,EACPC,IAAY,EAChB,SAASC,UAAUzrD,GACZwrD,IAKHD,GAAOvrD,EAAEkI,QACTsjD,IAAY,IALZF,GAAStrD,EAAEkI,QAAUqjD,GACrBA,GAAOvrD,EAAEkI,QAQb,SAASwjD,YACPhwC,aAAawoB,IACbA,GAAUzoB,YAAW,WACnB6vC,GAAS,IACR,IAXDI,IAcJ,SAASC,WAAT,GAUI,IATFtzC,EASC,EATDA,KACAuzC,EAQC,EARDA,SACAC,EAOC,EAPDA,SACOC,EAMN,EANDpuD,MACA65B,EAKC,EALDA,SACA3L,EAIC,EAJDA,MACA/qB,EAGC,EAHDA,MACAsG,EAEC,EAFDA,UACAI,EACC,EADDA,cAEMs6B,EAAoBniC,uBAAY,WACX,WAArB2rD,GAAYxkD,MAA0C,UAArBwkD,GAAYxkD,OAC/CwkD,GAAW,2BACNA,IADM,IAETxkD,KAA2B,UAArBwkD,GAAYxkD,KAAmB,UAAY,WAGpD,IAEGe,EAAmBlI,uBACvB,SAAC+G,GACKc,GACFd,EAAMvG,kBAGR,IAAMkI,EAAe3B,EAAM4B,cAAcC,wBACnCI,EAAIjC,EAAMyB,QAAUE,EAAaM,EACjCC,EAAIlC,EAAM0B,QAAUC,EAAaO,EAcvC,MAbyB,YAArB0iD,GAAYxkD,MAA2C,QAArBwkD,GAAYxkD,OAChDwkD,GAAc,CACZhiD,OAAQX,EACRsB,OAAQrB,EACRsB,aAAcxD,EAAMuB,QACpBkC,aAAczD,EAAMwB,QACpBG,aAAc3B,EAAM4B,cAAcC,wBAClCzB,KAAM,QACNqB,QAASzB,EAAMyB,QACfC,QAAS1B,EAAM0B,WAIZ,IAET,CAACZ,IAmCH,OACE,qBACE1G,MAAK,2BAAO2L,GAAO/L,WAAcI,GACjCsG,UAAWA,EACX0C,YApCsB,SAApBkiD,kBAAqBtlD,GACzB,GAAyB,UAArB4kD,GAAYxkD,MAAyC,WAArBwkD,GAAYxkD,KAAmB,CAAC,IAC1DmB,EAAqBvB,EAArBuB,QAASC,EAAYxB,EAAZwB,QACjBojD,GAAW,2BACNA,IADM,IAETxkD,KAAM,SACNyC,KAAM+hD,GAAYhiD,OAASrB,EAAUqjD,GAAYphD,aACjDF,KAAMshD,GAAYrhD,OAAS/B,EAAUojD,GAAYnhD,eAEnDuhD,UAAUhlD,GACV,IAAMulD,EAAaH,EAAWD,EACxBK,EAAeZ,GAAY/hD,KAAO+hD,GAAYhiD,OAC9C3L,EACH6L,KAAKC,IAAIyiD,IAAiB1iD,KAAKC,IAAI8hD,IAAU,EAAIU,EAAa,GAC/DX,GAAYjjD,aAAatE,MAE3ByzB,EAAS,CACP75B,MAAO4tD,IAAU,EAAIQ,EAAaviD,KAAKC,IAAI9L,GAASouD,EAAapuD,EACjE2a,WAmBFzO,UAdoB,SAAlBsiD,kBACqB,WAArBb,GAAYxkD,MAA0C,UAArBwkD,GAAYxkD,OAC/CwkD,GAAW,2BACNA,IADM,IAETxkD,KAA2B,UAArBwkD,GAAYxkD,KAAmB,UAAY,UAWnD8C,YAAa/B,EACbxH,aAAcyhC,EANhB,SAQE,sBAAMhhC,MAAO2L,GAAOof,MAApB,SAA4BA,MAKlC+/B,WAAWthD,aAAe,CACxBgO,KAAM,GACNuzC,SAAU,EACVC,SAAU,GACVnuD,MAAO,EACP65B,SAAU,oBACR,OAAO,MAET3L,MAAO,2BACPrkB,eAAe,GAGFokD,kBC/ITn/C,GAAS,CACb/L,UAAW,CACTsb,QAAS,MACThY,OAAQ,OACRgJ,QAAS,QAEX26C,MAAO,CACL5jD,MAAO,SAET2lD,aAAc,CACZ1lD,OAAQ,OACRD,MAAO,OACP2J,aAAc,MACd4pB,OAAQ,uBACR/lB,OAAQ,UACRC,WAAY,QAEd61C,OAAQ,CACN8D,WAAY,MACZd,YAAa,OACb/yB,OAAQ,OACRtzB,OAAQ,SAINooD,GACI,SADJA,GAEO,YAFPA,GAGM,WAGNC,GAAa,CACjB,CACE9sD,IAAK6sD,GACLvgC,MAAO,SACPluB,MAAOyuD,IAET,CACE7sD,IAAK6sD,GACLvgC,MAAO,YACPluB,MAAOyuD,IAET,CACE7sD,IAAK6sD,GACLvgC,MAAO,WACPluB,MAAOyuD,KA0KIE,OAtKf,SAASA,6BACP,IAAMhuD,EAAW6M,cADmB,EAEVzD,mBAAS,CAAE0iB,IAAK,EAAGrB,IAAK,EAAGwjC,WAAY,IAF7B,mBAE7B5uD,EAF6B,KAEtB6iB,EAFsB,OAGkB9Y,mBACpD0kD,IAJkC,mBAG7BI,EAH6B,KAGRC,EAHQ,KAO9BzC,EAAoBrqD,uBAAY,WACpC,OAAQ6sD,GACN,KAAKJ,GACH9tD,EAAS,CACPhB,KAAMsX,KAER,MAGF,KAAKw3C,GACH9tD,EAAS,CACPhB,KAAMqX,GACNhX,MAAOA,IAET,MAEF,KAAKyuD,GACH9tD,EAAS,CACPhB,KAAMuX,QAOX,CAACvW,EAAUkuD,EAAqB7uD,IAE7B+uD,EAAc/sD,uBAClB,SAACM,GACC,IAAM0sD,EAAY1sD,EAAE0xB,OAAOrZ,KAC3B,GAAIrY,EAAE0xB,OAAQ,CACZ,IAAMi7B,EAAa3sD,EAAE0xB,OAAOh0B,MAE5B6iB,GAAS,SAACqsC,GACR,IAAMt2B,EAAM,2BACPs2B,GADO,mBAETF,EAAYC,IAGf,GAAmB,MAAfA,EAAoB,CACtB,IAAM3lC,EAAQ,2BACTtpB,GADS,mBAEXgvD,EAAYC,EAAaC,EAAUF,KAEtC,IAAK,IAAIptD,KAAOstD,EACVA,EAAUttD,KAAS0nB,EAAS1nB,KAC9B0nB,EAAS1nB,IAAQstD,EAAUttD,IAI/BjB,EAAS,CACPhB,KAAMoX,GACN/W,MAAOspB,IAIX,OAAOsP,QAIb,CAACj4B,EAAUX,IAGPmvD,EAAoBntD,uBACxB,SAACM,GACC,IAAMs2B,EAAM,2BAAQ54B,GAAR,mBAAgBsC,EAAEqY,KAAOrY,EAAEtC,QACnC8sB,EAAO,GACX,IAAK,IAAIlrB,KAAO5B,EACd8sB,EAAKlrB,GAAOg3B,EAAOh3B,GAAO5B,EAAM4B,GAElCjB,EAAS,CACPhB,KAAMoX,GACN/W,MAAO8sB,IAETjK,EAAS+V,KAEX,CAACj4B,EAAUX,IAGPwsD,EAAqBxqD,uBAAY,WACrCrB,EAAS,CACPhB,KAAM+X,OAEP,CAAC/W,IAEEipD,EAAkB5nD,uBAAY,SAAC2qB,GACnCmiC,EAAuBniC,KACtB,IAEH,OACE,sBAAKxpB,MAAO2L,GAAO/L,UAAnB,UACE,cAAC,GAAD,CACE82B,SAAU+vB,EACV/kD,KAAM6pD,GACN1uD,MAAOyuD,GACPtrD,MAAO2L,GAAO46C,SAGfmF,IAAwBJ,IACvB,qCACE,cAAC,GAAD,CACEvgC,MAAM,OACNvT,KAAK,MACLxX,MAAO,CAAE6mD,MAAOl7C,GAAOk7C,OACvBnwB,SAAUk1B,EACV/uD,MAAOA,EAAMysB,IACb9sB,KAAK,WAEP,cAAC,GAAD,CACEuuB,MAAM,OACNvT,KAAK,MACLxX,MAAO,CAAE6mD,MAAOl7C,GAAOk7C,OACvBnwB,SAAUk1B,EACV/uD,MAAOA,EAAMorB,IACbzrB,KAAK,WAGP,cAAC,GAAD,CACEgb,KAAK,MACL3a,MAAOA,EAAMysB,IACbyB,MAAM,qCACN/qB,MAAO,CAAEiD,MAAO,OAChByzB,SAAUs1B,IAEZ,cAAC,GAAD,CACEx0C,KAAK,MACL3a,MAAOA,EAAMorB,IACb8C,MAAM,qCACN/qB,MAAO,CAAEiD,MAAO,OAChByzB,SAAUs1B,OAKhB,wBACExvD,KAAK,SACLwD,MAAO2L,GAAOi9C,aACdnpD,QAASypD,EAHX,mBAOA,wBACE1sD,KAAK,SACLwD,MAAO2L,GAAOi9C,aACdnpD,QAAS4pD,EAHX,wBC1MA19C,GAAS,CACb/L,UAAW,CACTsb,QAAS,MACThY,OAAQ,OACRgJ,QAAS,OACTmP,SAAU,OACVjP,WAAY,YAEdy6C,MAAO,CACL3jD,OAAQ,OACRD,MAAO,OACP2J,aAAc,MACd4pB,OAAQ,uBACR/lB,OAAQ,kBACRk9B,UAAW,UAEbib,aAAc,CACZ1lD,OAAQ,OACRwJ,SAAU,OACVE,aAAc,MACd4pB,OAAQ,uBACR/lB,OAAQ,UACRC,WAAY,QAEdu7C,KAAM,CACJhG,WAAY,EACZv1C,WAAY,OACZ2K,SAAU,SA+DC6wC,OA3Df,SAASA,2BACP,IAAM1uD,EAAW6M,cACX4+C,EAAkBr7C,mBAElBs7C,EAAoBrqD,uBAAY,WACpCrB,EAAS,CACPhB,KAAM0X,GACNjG,QAAS,CACPid,YAAa,CACXsnB,YAAa,IACbI,GAAI,IACJC,SAAS,EACTC,iBAAkB,GAClBC,OAAO,EACPC,WAAW,EACXoW,aAAcH,EAAgB55C,QAAQihC,cAI3C,CAAC9yC,IAEE6rD,EAAqBxqD,uBAAY,WACrCrB,EAAS,CACPhB,KAAM+X,OAEP,CAAC/W,IAEJ,OACE,sBAAKwC,MAAO2L,GAAO/L,UAAnB,UACE,sBAAKI,MAAO,CAAEspD,aAAc,WAAY74C,OAAQ,UAAhD,UACE,uBACEzQ,MAAO,CAAEupD,YAAa,MAAOtD,WAAY,EAAGv1C,WAAY,QACxDs1C,QAAQ,eAFV,8BAMA,cAAC,GAAD,CAAUxuC,KAAK,eAAe7J,IAAKs7C,OAErC,wBACEzsD,KAAK,SACLwD,MAAO2L,GAAOi9C,aACdnpD,QAASypD,EAHX,iCAOA,wBACE1sD,KAAK,SACLwD,MAAO2L,GAAOi9C,aACdnpD,QAAS4pD,EAHX,oBAOA,sBAAMrpD,MAAO2L,GAAOsgD,KAApB,0FClFAtgD,GAAS,CACb/L,UAAW,CACTsb,QAAS,MACThY,OAAQ,OACRgJ,QAAS,QAGX26C,MAAO,CACL3jD,OAAQ,OACRD,MAAO,OACP2J,aAAc,MACd4pB,OAAQ,uBACR/lB,OAAQ,kBACRk9B,UAAW,UAEbib,aAAc,CACZ1lD,OAAQ,OACRD,MAAO,OACP2J,aAAc,MACd4pB,OAAQ,uBACR/lB,OAAQ,UACRC,WAAY,QAEdqa,MAAO,CACLk7B,WAAY,EACZv1C,WAAY,SAgBhB,SAASy7C,aAAa5mB,GACpB,OAAIA,GAAU,QACN,GAAN,OAAUA,EAAM,QAAhB,KACSA,GAAU,KACb,GAAN,OAAUA,EAAS,KAAnB,KAEOA,EAIX,IAAM6mB,GAtBN,SAASC,gBAEP,IAF2C,IAAtBnmD,EAAqB,uDAAb,EAAGC,EAAU,uDAAJ,GAClCutB,EAAS,GACJpyB,EAAI4E,EAAO5E,GAAK6E,EAAK7E,IAAK,CACjC,IAAMkX,EAAM,SAAG,EAAKlX,GACpBoyB,EAAOt1B,KAAK,CACVK,IAAK+Z,EACLuS,MAAOohC,aAAa3zC,GACpB3b,MAAO2b,IAGX,OAAOkb,EAYK24B,GAoFCC,OAlFf,SAASA,0BACP,IAAM9uD,EAAW6M,cADgB,EAEAH,eAAzBxI,EAFyB,EAEzBA,KAAMsb,EAFmB,EAEnBA,eACRuvC,EAAmB3+C,mBAHQ,EAIqBhH,mBAAS,GAJ9B,mBAI1B4lD,EAJ0B,KAILC,EAJK,KAM3BvD,EAAoBrqD,uBAAY,WACpCrB,EAAS,CACPhB,KAAMkX,GACN7W,MAAO,CACL6vD,gBAAiB33B,OAAOw3B,EAAiBl9C,QAAQxS,OACjD2vD,oBAAqBA,OAGxB,CAAChvD,EAAUgvD,IAERG,EAAkB9tD,uBAAY,WAClC,OAAI6C,IAAI,OAAIsb,QAAJ,IAAIA,OAAJ,EAAIA,EAAgBhe,IACnB,KAAP,IACE,EAAK0J,KAAK+oC,MAAM/oC,KAAKkkD,KAAKlrD,EAAKsb,EAAeQ,OAAO9b,KAAKmG,EAAEtG,UAGzD,KACN,CAACyb,EAAgBtb,IAEdkqD,EAAc/sD,uBAClB,SAACM,GACC,GAAIA,EAAE0xB,OAAQ,CACZ,IAAM4E,EAASt2B,EAAE0xB,OAAOg8B,SAASC,MAC7B/3B,OAAO51B,EAAE0xB,OAAOh0B,OAChB2vD,EACJC,EAAuBh3B,MAG3B,CAAC+2B,IAGGnD,EAAqBxqD,uBAAY,WACrCrB,EAAS,CACPhB,KAAM+X,OAEP,CAAC/W,IAEJ,OACE,sBAAKwC,MAAO2L,GAAO/L,UAAnB,UACE,sBAAMI,MAAO2L,GAAOof,MAApB,oBACA,cAAC,GAAD,CACEpd,IAAK4+C,EACL7qD,KAAM0qD,GACNpsD,MAAO,CAAEqqD,WAAY,GAAId,YAAa,IACtChpC,aAAcosC,MAEhB,sBAAM3sD,MAAO2L,GAAOof,MAApB,+BACA,uBACEvT,KAAK,kBACLxX,MAAO2L,GAAOk7C,MACdrqD,KAAK,SACL+jB,aAAcisC,EACdlE,QAASsD,EACTrD,QAAQ,uBACRviD,KAAK,QAGP,wBACExJ,KAAK,SACLwD,MAAO2L,GAAOi9C,aACdnpD,QAASypD,EAHX,mBAQA,wBACE1sD,KAAK,SACLwD,MAAO2L,GAAOi9C,aACdnpD,QAAS4pD,EAHX,wBC5HA19C,GAAS,CACb/L,UAAW,CACTsb,QAAS,MACThY,OAAQ,OACRgJ,QAAS,OACTmP,SAAU,QAEZwrC,MAAO,CACL5jD,MAAO,QAET0lD,eAAgB,CACd55C,KAAM,KAERgc,MAAO,CACLhc,KAAM,KAER65C,aAAc,CACZ1lD,OAAQ,OACR0J,aAAc,MACd4pB,OAAQ,uBACR/lB,OAAQ,UACRC,WAAY,SA8DDq8C,I,GAAAA,GA1Df,SAASA,qBACP,IAAMvvD,EAAW6M,cACXuwC,EAAkBhtC,mBAElBs7C,EAAoBrqD,uBAAY,WACpCrB,EAAS,CACPhB,KAAM2X,GACNlG,QAAS,CACP2sC,gBAAiBA,EAAgBvrC,QAAQxS,WAG5C,CAACW,IAEE6rD,EAAqBxqD,uBAAY,WACrCrB,EAAS,CACPhB,KAAM+X,OAEP,CAAC/W,IAEEouD,EAAc/sD,uBAAY,SAACM,GAC/B,GAAIA,EAAE0xB,OAAQ,CACZ,IAAMrH,EAAMrqB,EAAE0xB,OAAOh0B,MACrBukC,GAAO5T,KAAK,qBAAsBhE,MAEnC,IAEH,OACE,sBAAKxpB,MAAO2L,GAAO/L,UAAnB,UACE,cAAC,GAAD,CACE+N,IAAKitC,EACL7vB,MAAM,cACNvT,KAAK,cACLxX,MAAO,CACL6mD,MAAOl7C,GAAOk7C,MACd8B,eAAgBh9C,GAAOg9C,eACvB59B,MAAOpf,GAAOof,OAEhBxK,aAAc,EACdmW,SAAUk1B,IAEZ,wBACEpvD,KAAK,SACLwD,MAAO2L,GAAOi9C,aACdnpD,QAASypD,EAHX,gCAOA,wBACE1sD,KAAK,SACLwD,MAAO2L,GAAOi9C,aACdnpD,QAAS4pD,EAHX,wBCxDA2D,GAAcz+C,YAAH,2hCA8CV,SAAS0+C,OAAT,GAQH,IAPFvxC,EAOC,EAPDA,MACAD,EAMC,EANDA,eACAzb,EAKC,EALDA,MACAsG,EAIC,EAJDA,UACA7G,EAGC,EAHDA,QACA7B,EAEC,EAFDA,SAEC,IADDsvD,cACC,MADQ,GACR,EACKzJ,EAAOjiB,UAEb,OACE,aAAC,GAAD,CAAS9lB,MAAOA,EAAOD,eAAgBA,EAAgBzb,MAAOA,EAA9D,SACE,+CACExD,KAAK,SACLiD,QAASA,EACT6G,UAAWA,GACPm9C,EAAKnkD,SAJX,IAKE6tD,cAAaD,EALf,SAOGtvD,OAMT,SAASwvD,cAAT,GAA+C,IAA7BC,EAA4B,EAA5BA,aAAcC,EAAc,EAAdA,WACtBC,EAAwBrjD,eAAxBqjD,oBACFp+C,EAAQzD,IACR1G,EAAQ+3C,KAERyQ,EAAgB9vD,mBAAQ,WAC5B,OAAQ6vD,GACN,KAAKt/C,GAAQ0c,YAAY3rB,GACvB,OAAO,aAAC,GAAD,IACT,KAAKiP,GAAQuc,gBAAgBxrB,GAC3B,OAAO,aAAC,GAAD,IACT,KAAKiP,GAAQid,YAAYlsB,GACvB,OAAO,aAAC,GAAD,IACT,KAAKiP,GAAQud,cAAcxsB,GACzB,OAAO,aAAC,GAAD,IACT,KAAKiP,GAAQwd,mBAAmBzsB,GAC9B,OAAO,aAAC,GAAD,IACT,KAAKiP,GAAQmd,OAAOpsB,GAClB,OAAO,aAAC,GAAD,OAIV,CAACuuD,IAEEE,EAA6B5uD,uBAAY,WAC7CsQ,EAAMvQ,KACJ,aAAC,GAAD,CACEipD,OAAQ,kBACN7iD,EAAMs4C,QAAQ,+BACdnuC,EAAMkB,WAGV,CACEpQ,SAAU2K,EAAUE,WACpB+E,gBAAgB,EAChB5M,MAAO,IACPC,OAAQ,QAGX,CAAC8B,EAAOmK,IACLu+C,EAAiB7uD,uBAAY,WACjCsQ,EAAMvQ,KAAK,aAAC,GAAD,IAAqB,CAC9BgR,kBAAkB,EAClB3P,SAAU2K,EAAUE,WACpB+E,gBAAgB,EAChB5M,MAAO,IACPC,OAAQ,QAET,CAACiM,IAEJ,OACE,oBAAKZ,IAAKy+C,GAAV,UACE,oBAAK1mD,UAAU,mBAAf,SAAmCknD,IACnC,oBAAKlnD,UAAU,yBAAf,UACE,aAAC2mD,OAAD,CACEvxC,MAAM,cACND,eAAe,OACfzb,MAAO,CAAEuc,cAAe,CAAErZ,OAAQ,SAClCzD,QAASiuD,EACTpnD,UAAU,eALZ,SAOE,aAAC,KAAD,MAEF,aAAC2mD,OAAD,CACEvxC,MAAM,mBACND,eAAe,OACfzb,MAAO,CAAEuc,cAAe,CAAErZ,OAAQ,SAClCzD,QAASguD,EACTnnD,UAAU,eALZ,SAOE,aAAC,KAAD,MAEA+mD,EAYA,GAXA,aAACJ,OAAD,CACEvxC,MAAM,cACND,eAAe,OACfzb,MAAO,CAAEuc,cAAe,CAAErZ,OAAQ,SAClCzD,QAAS6tD,EACThnD,UAAU,eACV4mD,OAAO,aANT,SAQE,aAAC,KAAD,YAUZE,cAAO5jD,aAAe,CACpB8jD,WAAY,SAAS,aACnB,OAAO,OAIIF,qBCjMXO,GAAQ,EAERC,IAAU,EAERjiD,GAAS,CACb/L,UAAW,CACTsM,QAAS,OACTO,cAAe,SACfgE,OAAQ,MACRC,WAAY,QAEd1J,OAAQ,CACN8J,OAAQ,UACRoK,QAAS,WACThP,QAAS,OACTE,WAAY,SACZiP,SAAU,OACVmb,OAAQ,OACRH,QAAS,OACTnpB,WAAY,gCAEZV,UAAW,gCACXqhD,WAAY,uDACZptD,OACE,4GACFwL,gBAAiB,UACjBkP,MAAO,UACPG,WAAY,QACZ4W,WAAY,OACZ47B,eAAgB,OAChBvyC,WAAY,sBACZwyC,UAAW,yBAEbC,YAAa,CACX9yC,QAAS,EACTzK,OAAQ,GAEVw9C,QAAS,CACPhiD,gBAAiB,QACjBiiD,UAAW,IACX9/C,SAAU,SACVW,KAAM,YAIGo/C,GACJ,EADIA,GAEF,EAGX,SAASC,cAAT,GAA2E,IAAlD1yC,EAAiD,EAAjDA,MAAO9d,EAA0C,EAA1CA,SAAU4f,EAAgC,EAAhCA,MAAO6wC,EAAyB,EAAzBA,OAAQv+C,EAAiB,EAAjBA,OAAQ9P,EAAS,EAATA,MAAS,EACvC4G,mBAAS,MAD8B,mBACjE0nD,EADiE,KACzDC,EADyD,KAGlE3yC,EAAahO,mBACb4gD,EAAe5gD,mBACf6gD,EAAkB5vD,uBACtB,SAACM,GACCwuD,GAAQ/yC,YAAW,WACZgzC,IACH99C,EAAO0N,EAAO,CAAEixB,OAAQ0f,GAAqBlnD,SAAU9H,EAAE8H,WAE3D2mD,IAAU,IA5DN,OA+DR,CAACpwC,EAAO1N,IAGJ4+C,EAAiB7vD,uBACrB,SAACM,GACCA,EAAEyI,UACFiT,aAAa8yC,IACbC,IAAU,EACV99C,EAAO0N,EAAO,CAAEixB,OAAQ0f,GAAuBlnD,SAAU9H,EAAE8H,aAE7D,CAACuW,EAAO1N,IAOV,OAJAxR,qBAAU,WACRiwD,EAAeF,EAAS,CAAEpiD,gBAAiB,QAAW,QACrD,CAACoiD,IAGF,sBACE1gD,IAAK6gD,EACLxuD,MAAK,2BACA2L,GAAO/L,WADP,IAEHmP,KAAgB,MAAVu/C,EAAiB,EAAI,UAC3BphD,WAAYmhD,EAAS,iBAAmB,KAE1C/nD,UAAU,mBAPZ,UASE,wBACE9J,KAAK,SACLwD,MAAO2L,GAAO3E,OACdvH,QAASgvD,EACThoD,cAAeioD,EAJjB,SAME,mBAAG1uD,MAAO2L,GAAOqiD,YAAjB,SAA+BtyC,MAEjC,qBACE/N,IAAKiO,EACL5b,MAAK,2BACA2L,GAAOsiD,SADP,IAEHC,UAAqB,MAAVI,EAAiB,EAAI,QAC7BtuD,GALP,SAQGpC,OAMTwwD,cAAc5kD,aAAe,CAC3BsG,OAAQ,SAAS,SACf,OAAO,OAIIs+C,qBC7GTziD,GAAS,CACb/L,UAAW,CACTsD,OAAQ,OACRD,MAAO,OACPiJ,QAAS,OACTO,cAAe,WAGfkiD,GAAuB,GACvBC,GAAa,KAwEFC,I,SAAAA,GAvEf,SAASA,UAAT,GAAwD,IAAnCjxD,EAAkC,EAAlCA,SAAkC,IAAxBkxD,wBAAwB,MAAL,EAAK,IACrBloD,mBAAS,IADY,mBAC9CmoD,EAD8C,KACpCC,EADoC,KAE/CR,EAAe5gD,mBAEfqhD,EAAapwD,uBACjB,SAAC2e,EAAO0xC,GACN,IAAIC,EAAKJ,EAASzuD,QACd4uD,EAAQzgB,SAAW0f,GACrBgB,EAAKA,EAAGl3C,KAAI,SAAC9Y,EAAGmC,GAAJ,OAAWA,IAAMkc,GAASoxC,KAAepxC,GAASre,EAAIA,MAElEgwD,EAAKA,EAAGl3C,KAAI,SAAC9Y,EAAGmC,GAAJ,OAAWA,IAAMkc,KAGzBoxC,GAFAM,EAAQjoD,SACN2nD,KAAepxC,EACJ,KAEAA,EAGF,MAIjBmxC,GAAuBQ,EACvBH,EAAYG,KAEd,CAACJ,IAGGK,EAAiB1xD,mBAAQ,WAC7B,OAAOojD,WAAS7oC,IAAIra,GAAU,SAACmjD,EAAOvjC,GACpC,OACEujC,GACAlwC,uBAAakwC,EAAO,CAClBjxC,OAAQm/C,EACRzxC,QACA6wC,OAAQU,GAAYA,EAASvxC,UAIlC,CAAC5f,EAAUmxD,EAAUE,IAyBxB,OAvBA3wD,qBAAU,WACgB,MAApBwwD,GACFE,GAAY,SAACK,GACX,OAAIA,EAAU9tD,OAAS,EACd8tD,EAAUp3C,KAAI,SAAC9Y,EAAGmC,GAAJ,OAClBqtD,GAAqBrtD,GAIlBnC,EAHAmC,IAAMwtD,MAMdH,GAAuB3wD,MAAMJ,EAAS2D,QACnC4Y,MAAK,GACLlC,KAAI,SAAC9Y,GAAD,OAAOA,KAEPnB,MAAMJ,EAAS2D,QACnB4Y,MAAK,GACLlC,KAAI,SAAC9Y,EAAGmC,GAAJ,OAAWA,IAAMwtD,GAA0B3vD,WAGrD,CAACvB,EAAS2D,OAAQutD,IAGnB,qBAAKnhD,IAAK6gD,EAAcxuD,MAAO2L,GAAO/L,UAAtC,SACGwvD,K,UCtFDE,GAAsB/gD,YAAH,8DAInBghD,GAAgChhD,YAAH,4DAI7BihD,GAAkBjhD,YAAH,kjBCHrB,SAASkhD,qBAAT,GAA+D,IAA/B/tD,EAA8B,EAA9BA,KAAMw3B,EAAwB,EAAxBA,QAASpwB,EAAe,EAAfA,YAAe,EAOxD4mD,oBACF,CACEx2B,UACAx3B,QAEFiuD,aACAC,kBAXAC,EAF0D,EAE1DA,cACAC,EAH0D,EAG1DA,kBACAC,EAJ0D,EAI1DA,aACAC,EAL0D,EAK1DA,KACAC,EAN0D,EAM1DA,WASF,OACE,gDAAWJ,KAAX,IAA4BthD,IAAKihD,GAAjC,UACE,+BACGO,EAAa93C,KAAI,SAACi4C,GAAD,OAChB,6CAEMA,EAAYC,uBAFlB,aAIGD,EAAYE,QAAQn4C,KAAI,SAACo4C,GAAD,OACvB,6CAEMA,EAAOC,eAAeD,EAAOE,yBAFnC,cAIGF,EAAOG,OAAO,UACf,8BACGH,EAAOI,SAAYJ,EAAOK,aAAe,UAAO,UAAQ,QALtDL,EAAOC,iBAAiB7xD,UAL5ByxD,EAAYC,sBAAsB1xD,UAiB7C,gDACMqxD,KADN,IAEE9vD,MAAO,CAAEkM,QAAS,QAAShJ,OAAQ,OAAQytD,UAAW,QAFxD,SAIGX,EAAK/3C,KAAI,SAACuiC,GAET,OADAyV,EAAWzV,GAET,6CAEMA,EAAIoW,eAFV,IAGE9nD,YAAaA,EAHf,SAKG0xC,EAAIqW,MAAM54C,KAAI,SAAC64C,GACd,OACE,6CAEMA,EAAKC,gBAFX,IAGE/wD,MAAK,2BAAO8wD,EAAKC,eAAe/wD,OAA3B,IAAkCkb,QAAS,QAHlD,SAKG41C,EAAKN,OAAO,UAJRM,EAAKC,eAAetyD,UAP1B+7C,EAAIoW,cAAcnyD,eAuBrCgxD,qBAAqBjmD,aAAe,CAClCV,YAAa,uBACX,OAAO,OAII6T,sBAAK8yC,sBCpDLuB,ICxBTrlD,GAAS,CACb/L,UAAW,CACTsD,OAAQ,QAEV+tD,eAAgB,CACd/tD,OAAQ,qBAEVguD,YAAa,CACXjuD,MAAO,OACP2J,aAAc,MACd4pB,OAAQ,oBACRtb,QAAS,MACTupB,aAAc,QAKlB,SAAS0sB,iBAAT,GAA2C,IAAf1zC,EAAc,EAAdA,KAAMo2B,EAAQ,EAARA,KAAQ,EACFjtC,mBAAS,IADP,mBACjCwqD,EADiC,KACpBC,EADoB,OAENzqD,mBAAS,IAFH,mBAEjC0qD,EAFiC,KAExBC,EAFwB,KAGlCC,EAAY5jD,mBAEZ6jD,EAAe5yD,uBACnB,SAACM,GACC,IAAMu0B,EAAS32B,OAAOC,KAAKo0D,GAAa3wD,QAAO,SAAChC,GAAD,OAC7CA,EACGgZ,cACA/Y,SAASS,EAAE0xB,OAAS1xB,EAAE0xB,OAAOh0B,MAAM4a,cAAgBtY,EAAEsY,kBAE1D85C,EAAe79B,KAEjB,CAAC09B,IAGH9yD,qBAAU,WACJkzD,EAAUniD,SACZoiD,EAAaD,EAAUniD,QAAQxS,SAEhC,CAAC40D,EAAcD,IAElBlzD,qBAAU,WACR,GAAImf,GAAQo2B,EAAM,CAChB,IAAM72C,EAAOD,OAAOC,KAAKygB,GAAMmc,OAAO78B,OAAOC,KAAK62C,IAClD0d,EAAev0D,GACfq0D,EAAe,2BACV5zC,GACAo2B,OAGN,CAACp2B,EAAMo2B,IAEV,IAAM3a,EAAUx7B,mBACd,iBAAM,CACJ,CACE0vD,OAAQ,YACRsE,SAAU,QACVhlD,SAAU,IACVzJ,MAAO,GACPsnD,SAAU,GACVoH,KAAM,qBAAGnX,EAAH,EAAGA,IAAH,OACJ,mBAAGx6C,MAAO,CAAEkb,QAAS,MAAOjP,gBAAiB,SAA7C,SACGuuC,EAAI9G,aAIX,CACE0Z,OAAQ,QACRsE,SAAU,QACVE,WAAW,EACXD,KAAM,qBAAGnX,EAAH,EAAGA,IAAH,OACJ,mBACEx6C,MAAO,CACLiM,gBAAiB,UACjB/I,OAAQ,OACRgY,QAAS,MACTI,WAAY,YACZF,WAAY,MACZhN,SAAU,UAPd,SAUGgjD,EAAY5W,EAAI9G,UAAUvyB,kBAKnC,CAACiwC,IAGH,OACE,sBAAKpxD,MAAO2L,GAAO/L,UAAnB,UACE,8BACE,uBACEpD,KAAK,OACLwD,MAAO2L,GAAOulD,YACdW,YAAY,0BACZn7B,SAAU+6B,EACV9jD,IAAK6jD,MAGT,qBAAKxxD,MAAO2L,GAAOslD,eAAnB,SACE,cAAC,GAAD,CAAsBvvD,KAAM4vD,EAASp4B,QAASA,SAMvC83B,OD3Gf,SAASA,YAAYz4B,GACnB,IAAMvqB,EAAU,SAAVA,QAAW3Q,GAAW,IAAD,EACQ6M,eAAzBxI,EADiB,EACjBA,KAAMsb,EADW,EACXA,eADW,EAGQtf,mBAAQ,WACvC,OAAIgE,GAAQsb,GAAkBA,EAAehe,GAC7B0C,EAAK43B,MAAK,SAACrX,GAAD,OAAWA,EAAMjjB,KAAOge,EAAehe,OAAO,CACpEye,KAAM,GACNo2B,KAAM,IAIH,KACN,CAAC72B,EAAgBtb,IAZK,IAGjB+b,YAHiB,MAGV,GAHU,MAGNo2B,YAHM,MAGC,GAHD,EAcjBpb,EAA0Bp7B,EAA1Bo7B,aAAiBC,EAdA,aAcSr7B,EAdT,kBAezB,OACE,cAACk7B,EAAD,2BAAsBG,GAAtB,IAA4Bjb,KAAMA,EAAMo2B,KAAMA,EAAMlmC,IAAK8qB,MAI7D,OAAOE,sBAAW,SAACt7B,EAAOsQ,GACxB,OAAO,cAACK,EAAD,2BAAa3Q,GAAb,IAAoBo7B,aAAc9qB,QCqF9BqjD,CAAYr0C,eAAKw0C,mB,+BCxDjBW,I,GAAAA,GAlDf,SAASA,iBAAiBv5B,GACxB,IAAMvqB,EAAU,SAAVA,QAAW3Q,GAAW,IAAD,EAQrB6M,eANFxI,EAFuB,EAEvBA,KACAsb,EAHuB,EAGvBA,eACAoH,EAJuB,EAIvBA,QACAjC,EALuB,EAKvBA,UACAuB,EANuB,EAMvBA,kBACA2V,EAPuB,EAOvBA,UAEIhH,EAAc7nB,iBATK,EAWa9M,mBAAQ,WAC5C,OAAIgE,GAAQsb,GAAkBA,EAAehe,GAC7B0C,EAAK43B,MAAK,SAACrX,GAAD,OAAWA,EAAMjjB,KAAOge,EAAehe,OAAO,CACpEy0B,UAAW,GACXhW,KAAM,IAIH,KACN,CAACT,EAAgBtb,IApBK,IAWjB+xB,iBAXiB,MAWL,GAXK,MAWDhW,YAXC,MAWM,GAXN,EAsBnB4B,EAAU3hB,mBAAQ,WACtB,OAAIgmB,GAAqB3mB,OAAOC,KAAK0mB,GAAmBniB,OAAS,EACxDxE,OAAOC,KAAK0mB,GAEd,OACN,CAACA,IAEI+U,EAA0Bp7B,EAA1Bo7B,aAAiBC,EA7BA,aA6BSr7B,EA7BT,kBA8BzB,OACE,cAACk7B,EAAD,2BACMG,GADN,IAEEjF,UAAWA,EACXhW,KAAMA,EACN2G,QAASA,EACTiO,YAAaA,EACblQ,UAAWA,EACX9C,QAASA,EACTga,UAAWA,EACX1rB,IAAK8qB,MAKX,OAAOE,sBAAW,SAACt7B,EAAOsQ,GACxB,OAAO,cAACK,EAAD,2BAAa3Q,GAAb,IAAoBo7B,aAAc9qB,SC9CvChC,GAAS4C,YAAH,gyBAgDZ,SAAS85C,kCAAT,GAAmD,IAA5BR,EAA2B,EAA3BA,OAAQ96C,EAAmB,EAAnBA,QAASwvC,EAAU,EAAVA,OAChCwV,EAAYnkD,mBAEZokD,EAAcnzD,uBAAY,WAC9BgpD,EAAOkK,EAAU1iD,QAAQxS,SACxB,CAACgrD,IAEE9xB,EAAgBl3B,uBACpB,SAAC+G,GACmB,UAAdA,EAAMnH,KACRopD,EAAOkK,EAAU1iD,QAAQxS,SAG7B,CAACgrD,IAGH,OACE,oBAAKt5C,IAAK5C,GAAV,UACE,oBAAKrF,UAAU,gBAAf,UACE,8BAAOi2C,IAEP,aAAC,GAAD,CAAa98C,QAASsN,OAExB,oBAAKzG,UAAU,YAAf,UACE,sBACEqH,IAAKokD,EACLv1D,KAAK,SACLq1D,YAAY,sBACZp7B,UAAWV,IAEb,uBAAQv5B,KAAK,SAASiD,QAASuyD,EAA/B,uBAQR3J,kCAAY7+C,aAAe,CACzBq+C,OAAQ,kBACN,OAAO,MAET96C,QAAS,mBACP,OAAO,OAGIs7C,I,YAAAA,qC,yCCtFf,SAAS4J,MAAT,GAAwC,IAAvBC,EAAsB,EAAtBA,UAAWzyD,EAAW,EAAXA,QAC1B,OACE,oBACEA,QAASA,EACT8O,IAAKA,YAAF,uoBAIe,UAAd2jD,EAAA,2BAgBsC,SAAdA,EAAuB,KAAO,KAtB5D,SA6BE,aAAC,KAAD,CACElyD,MAAO,CAAEmN,UAAU,UAAD,OAA0B,UAAd+kD,EAAwB,KAAO,IAA3C,UAQ1B,SAASC,SAAT,GAA+D,IAA3Cv0D,EAA0C,EAA1CA,SAAUw0D,EAAgC,EAAhCA,KAAMC,EAA0B,EAA1BA,aAAc37B,EAAY,EAAZA,SAAY,EACnC47B,eADmC,mBACrD3kD,EADqD,KAC9C1K,EAD8C,KAC9CA,MAD8C,EAEtB2D,mBAAS,GAFa,mBAErD2rD,EAFqD,KAExCC,EAFwC,KAG5Dl0D,qBAAU,WACRk0D,EAAeH,KACd,CAACA,IAEJ,IAAMI,EAAU/0D,mBACd,kBACEojD,WAAS7oC,IAAIra,GAAU,SAACmjD,GACtB,OACE,oBAEExyC,IAAKA,YAAF,mGACQtL,GAHb,SAOG89C,GANIA,EAAMtiD,UAUnB,CAACb,EAAUqF,IAGPyvD,EAAc7zD,uBAAY,WAC9B2zD,GAAe,SAACG,GACd,GAAIA,IAAmBF,EAAQlxD,OAAS,EAGtC,OAFAm1B,EAASi8B,GAELP,EACK,EAEAO,EAIX,IAAMC,EAAYD,EAAiB,EAGnC,OAFAj8B,EAASk8B,GAEFA,OAER,CAACH,EAAQlxD,OAAQ6wD,EAAM17B,IAEpBm8B,EAAch0D,uBAAY,WAC9B2zD,GAAe,SAACG,GACd,GAAuB,IAAnBA,EAEF,OADAj8B,EAASi8B,GACLP,EACK,EAEAO,EAGX,IAAMG,EAAYH,EAAiB,EAInC,OAFAj8B,EAASo8B,GAEFA,OAER,CAACV,EAAM17B,IAEV,OAAKzzB,GAAUwvD,EAEb,oBACElkD,IAAKA,YAAF,kKAOHZ,IAAKA,EARP,UAUE,oBACEY,IAAKA,YAAF,2MACwBtL,EAAQsvD,EA9ExB,IAiFAtvD,EAAQwvD,EAAQlxD,QAL7B,SASGkxD,IAGc,IAAhBF,GAAqB,aAACN,MAAD,CAAOC,UAAU,OAAOzyD,QAASozD,IACtDN,IAAgBE,EAAQlxD,OAAS,GAChC,aAAC0wD,MAAD,CAAOC,UAAU,QAAQzyD,QAASizD,OA1BT,KAgCjCP,SAAS3oD,aAAe,CACtB4oD,MAAM,EACNC,aAAc,EACd37B,SAAU,2BAAM,OAEH/Z,I,MAAAA,kBAAKw1C,UCjJdY,GAAexkD,YAAH,wTAgBZykD,GAAyBzkD,YAAH,ytBAyC5B,SAAS0kD,kBAAT,GAAqD,IAAxB55B,EAAuB,EAAvBA,UAAW3C,EAAY,EAAZA,SAAY,EACV9vB,qBADU,mBAC3CssD,EAD2C,KAC7BC,EAD6B,KAGlD70D,qBAAU,WACJ+6B,GAAaA,EAAU93B,OAAS,GAClC4xD,EAAgB,KAEjB,CAAC95B,IAEJ,IAAMotB,EAAkB5nD,uBACtB,SAACu0D,GACCD,EAAgBC,GAChB18B,EAAS08B,KAEX,CAAC18B,IAGH,OACE,8BACE,oBAAKnoB,IAAKwkD,GAAV,SACE,4BACG15B,GACCA,EAAU93B,OAAS,GADpB,YAEM2xD,EAAe,GAFrB,cAE6B75B,EAAU93B,QAAU,SAGtD,oBAAKgN,IAAKykD,GAAV,SACE,aAAC,GAAD,CAAUt8B,SAAU+vB,EAApB,SACGptB,GACCA,EAAUphB,KAAI,SAACo7C,EAAK71C,GAAN,OACZ,oBAAmBlX,UAAU,SAA7B,UACE,6BACE,aAAC,KAAD,CACEtH,GAAE,gBAAWwe,GACbva,MAAO,IACPqwD,QAASD,EAAIC,YAGjB,4BACE,aAAC,KAAD,CAAInmB,GAAIkmB,EAAIlmB,KADd,MACwBkmB,EAAIE,GAAG10C,QAAQ,QAT/Bw0C,EAAI50D,eAmB5Bw0D,kBAAkBzpD,aAAe,CAC/BktB,SAAU,oBACR,OAAO,OAIIu8B,I,SAAAA,qBCjHTO,GAA+BjlD,YAAH,4FAM5BklD,GAAoBllD,YAAH,4YAwBjBykD,GAAyBzkD,YAAH,iZAyB5B,SAASmlD,eAAT,GAAyD,IAA/B7L,EAA8B,EAA9BA,OAAQxuB,EAAsB,EAAtBA,UAAW7zB,EAAW,EAAXA,QAAW,EACdoB,qBADc,mBAC/CssD,EAD+C,KACjCC,EADiC,OAIlD3oD,iBADF0B,QAAWq6B,EAHyC,EAGzCA,QAASub,EAHgC,EAGhCA,OAGhB6R,EAASj2D,mBAAQ,WACrB,OAAO8H,GACL6zB,GACAA,EAAU93B,OAAS,QACFqjB,IAAjBsuC,GACA75B,EAAU65B,GAAcU,MAAMpuD,GAC5B6zB,EAAU65B,GAAcU,MAAMpuD,GAC9B,IACH,CAAC0tD,EAAc1tD,EAAS6zB,IAE3B/6B,qBAAU,WACJ+6B,GAAaA,EAAU93B,OAAS,GAClC4xD,EAAgB,KAEjB,CAAC95B,IAEJ,IAAMw6B,EAA4Bh1D,uBAChC,SAACM,GACCA,EAAEC,iBACFyoD,EAAO8L,KAET,CAACA,EAAQ9L,IAGLiM,EAAmCj1D,uBAAY,SAAC2e,GACpD21C,EAAgB31C,KACf,IAEH,OAAQ+oB,EAAQsb,yBACbC,EAAOM,qBACR58C,GACA6zB,GACAA,EAAU93B,OAAS,EACnB,oBAAKgN,IAAKilD,GAAV,UACE,oBAAKjlD,IAAKklD,GAAV,UACE,kBAAGntD,UAAU,WAAb,gBACA,kBAAGA,UAAU,YAAb,gDAEF,oBAAKiI,IAAKykD,GAAV,UACE,aAAC,GAAD,CACE35B,UAAWA,EACX3C,SAAUo9B,IAEZ,uBAAQt3D,KAAK,SAASiD,QAASo0D,EAA/B,iBAGA,kBAAGvtD,UAAU,aAAb,yBACed,EADf,YACiCmuD,EADjC,aAKF,KAGND,eAAelqD,aAAe,CAC5Bq+C,OAAQ,kBACN,OAAO,OAGI6L,I,GAAAA,kBCxHTK,GAAiBxlD,YAAH,4FAMpB,SAASylD,eAAT,GAA0E,IAAhDnM,EAA+C,EAA/CA,OAAQ96C,EAAuC,EAAvCA,QAASwvC,EAA8B,EAA9BA,OAAQljB,EAAsB,EAAtBA,UAAW7zB,EAAW,EAAXA,QACtDyuD,EAAwBp1D,uBAC5B,SAACitD,GACCjE,EAAOiE,KAET,CAACjE,IAGGgM,EAA4Bh1D,uBAChC,SAACi1C,GACC+T,EAAO/T,KAET,CAAC+T,IAGH,OACE,oBAAKt5C,IAAKwlD,GAAV,UACE,aAAC,GAAD,CACElM,OAAQoM,EACRlnD,QAASA,EACTwvC,OAAQA,IAGV,aAAC,GAAD,CACEsL,OAAQgM,EACRx6B,UAAWA,EACX7zB,QAASA,OAMjBwuD,eAAexqD,aAAe,CAC5Bq+C,OAAQ,kBACN,OAAO,MAET96C,QAAS,mBACP,OAAO,OAGIinD,I,GAAAA,kBC/CTroD,GAAS4C,YAAH,0OAeZ,SAAS2lD,aAAT,GAQI,IAPFt2D,EAOC,EAPDA,SACAoC,EAMC,EANDA,MACAP,EAKC,EALDA,QACAod,EAIC,EAJDA,WACApB,EAGC,EAHDA,eACA8E,EAEC,EAFDA,aACA5f,EACC,EADDA,SACC,EACsBiG,mBAAS2Z,GAD/B,mBACMkE,EADN,KACY0vC,EADZ,KAGKC,EAAgBv1D,uBAAY,WAChCY,GAASglB,GAET0vC,GAAQ1vC,KACP,CAAChlB,EAASglB,IACb,OACE,aAAC,GAAD,CAAS/I,MAAOmB,EAAYpB,eAAgBA,EAA5C,SACE,uBACE9a,SAAUA,EACV4N,IAAK5C,GACL3L,MAAOA,EACPsG,UAAWme,EAAO,uBAAyB,SAC3CjoB,KAAK,SACLiD,QAAS20D,EANX,SAQGx2D,MAMTs2D,aAAa1qD,aAAe,CAC1BqT,WAAY,GACZpB,eAAgB,QAChBzb,MAAO,GACPugB,cAAc,EACd9gB,QAAS,0BAAM,MACfkB,UAAU,GAGGgc,I,GAAAA,kBAAKu3C,cCtDdvoD,GAAS4C,YAAH,wpBAwCZ,SAAS8lD,mBAAT,GAYI,IAXFC,EAWC,EAXDA,QACA3mC,EAUC,EAVDA,SACA4mC,EASC,EATDA,cACAC,EAQC,EARDA,SACAC,EAOC,EAPDA,cACAC,EAMC,EANDA,eACAC,EAKC,EALDA,gBACA/2D,EAIC,EAJDA,SACAg3D,EAGC,EAHDA,eACAC,EAEC,EAFDA,kBACAzU,EACC,EADDA,UAEA,OACE,oBAAK7xC,IAAK5C,GAAV,UACGy0C,GACC,aAAC,GAAD,CAAS1kC,MAAO64C,EAAe94C,eAAe,QAA9C,SACE,uBAAQjf,KAAK,SAASiD,QAASkuB,EAAUhtB,SAAsB,IAAZ2zD,EAAnD,SACE,aAAC,KAAD,QAMLE,GAAYC,EACX,aAAC,GAAD,CACE53C,WAAY43C,EACZh5C,eAAe,QACfhc,QAAS+0D,EAHX,SAME,aAAC,KAAD,CAAUx0D,MAAO,CAAEE,cAAe,OAAQmb,SAAU,YAEpD,KAEHzd,EAEA02D,EACC,kBAAGhuD,UAAU,gBAAb,cACI,IACDouD,IACkB,IAAnBA,QACoB9vC,IAApB+vC,EAFC,UAGMA,EAHN,YAGyBL,GACtBA,EAAS,IANf,OAUA,kBAAGt0D,MAAO,CAAE+O,KAAM,KAEnB8lD,GACC,aAAC,GAAD,CAASn5C,MAAM,cAAcD,eAAe,OAA5C,SACE,uBAAQjf,KAAK,SAASiD,QAASm1D,EAA/B,SACE,aAAC,KAAD,WAQZP,mBAAmB7qD,aAAe,CAChC8qD,QAAS,EACT3mC,SAAU,2BAAM,MAChB4mC,cAAe,SACfC,SAAU,2BAAM,MAChBC,cAAe,GACfC,gBAAgB,EAChBC,gBAAiB,EACjBC,eAAgB,iCAAM,MACtBC,mBAAmB,EACnBzU,WAAW,GAGEzjC,I,GAAAA,kBAAK03C,oBClHd1oD,GAAS4C,YAAH,wJASZ,SAASumD,WAAT,GAMI,IALFr1D,EAKC,EALDA,QACAod,EAIC,EAJDA,WACApB,EAGC,EAHDA,eACA9a,EAEC,EAFDA,SACA2F,EACC,EADDA,UAEA,OACE,oBAAKA,UAAWA,EAAhB,SACE,aAAC,GAAD,CAASoV,MAAOmB,EAAYpB,eAAgBA,EAA5C,SACE,uBACElN,IAAK5C,GACLnP,KAAK,SACLiD,QAASA,EACTkB,SAAUA,EACV2F,UAAWA,EALb,SAOE,aAAC,KAAD,UAOVwuD,WAAWtrD,aAAe,CACxB/J,QAAS,0BAAM,MACfod,WAAY,OACZpB,eAAgB,OAChB9a,UAAU,EACV2F,UAAW,IAUEqW,I,GAAAA,kBAAKm4C,YCjDdnpD,GAAS4C,YAAH,6QAcZ,SAASwmD,kBAAT,GAAiD,IAApBhoD,EAAmB,EAAnBA,QAAS86C,EAAU,EAAVA,OACpC,OACE,oBAAKt5C,IAAK5C,GAAV,UACE,aAAC,GAAD,CAAalM,QAASsN,EAAS8P,WAAW,sBAC1C,aAAC,GAAD,CAAYpd,QAASooD,EAAQhrC,WAAW,wBAK/BF,sBAAKo4C,mBCnBdC,GAAiBr8B,sBAAW,SAASq8B,eAAT,EAEhCrnD,GACC,IAFCk6C,EAEF,EAFEA,OAAQhrD,EAEV,EAFUA,MAAOL,EAEjB,EAFiBA,KAAMwD,EAEvB,EAFuBA,MAAOi1D,EAE9B,EAF8BA,YAAaC,EAE3C,EAF2CA,WAE3C,EAC8BtuD,qBAD9B,mBACOuuD,EADP,KACgBC,EADhB,KAEMC,EAAWznD,mBAEjBtP,qBAAU,WACR82D,EAAWF,KACV,CAACA,IAEJI,8BAAoB3nD,GAAK,iBAAO,CAC9B4nD,UAAW,qBACTH,GAAW,IAEbI,UAAW,qBACTJ,GAAW,QAIf,IAAMK,EAAkB52D,uBACtB,SAAC4lB,GAAwB,IAAlB7e,EAAiB,uDAAT,KACR6e,GAUHwwC,EAAYrvD,GACZwvD,EAAW3wC,IAVW,KAAlB7e,EAAMswB,SAER2xB,EAAOjiD,GACPwvD,EAAW3wC,IACgB,KAAlB7e,EAAMswB,SAEfk/B,EAAW3wC,KAOjB,CAACwwC,EAAapN,IAGhB,OACE,sBACE7nD,MAAK,aAAIkM,QAAS,QAASjJ,MAAO,OAAQC,OAAQ,QAAWlD,GAC7DyG,cAAe,uBAACb,GAAD,OAAW6vD,GAAgB,EAAM7vD,IAFlD,WAIIuvD,GACA,sBAAMn1D,MAAO,CAAEkM,QAAS,aAAcqY,cAAe,UAArD,SACG1nB,IAGJs4D,GACC,qBAAKn1D,MAAO,CAAEkM,QAAS,aAAcqY,cAAe,UAApD,SACE,cAAC,GAAD,CACE6hC,kBAAgB,EAChBz4C,IAAK0nD,EACLx4D,MAAOA,EACPL,KAAMA,EACNi6B,UAAW,mBAACt3B,GAAD,OAAOs2D,GAAgB,EAAOt2D,cAQrD61D,GAAexrD,aAAe,CAC5Bq+C,OAAQ,yBAAM,MACdoN,YAAa,8BAAM,MACnBz4D,KAAM,OACN04D,YAAY,GAGCF,I,GAAAA,MCpETrpD,GAAS4C,YAAH,2qBAmCZ,SAASmnD,YAAT,EAAkC/nD,GAAM,IAAjBzP,EAAgB,EAAhBA,QAAgB,EACL0I,mBAAS,CAAE+uD,IAAK,EAAG9pD,IAAK,IADnB,mBAC9B5L,EAD8B,KACpBglC,EADoB,OAEEhqB,YAA/B26C,EAF6B,EAE7BA,QAAS55C,EAFoB,EAEpBA,kBAFoB,EAGbpV,qBAHa,mBAG9BlF,EAH8B,KAGxBke,EAHwB,OAIXhZ,qBAJW,mBAI9B0sB,EAJ8B,KAInB10B,EAJmB,OAKKgI,mBAAS,MALd,mBAK9BivD,EAL8B,KAKfC,EALe,KAM/B5mD,EAAOtB,mBAEbtP,qBAAU,WAKR,OAJA4Q,EAAKG,QAAUxP,SAASC,cAAc,OAClCkc,GACFA,EAAkBnb,YAAYqO,EAAKG,SAE9B,WACDH,EAAKG,SAAW2M,GAClBA,EAAkBxa,YAAY0N,EAAKG,YAGtC,CAAC2M,IAqCJs5C,8BAAoB3nD,GAAK,iBAAO,CAC9BooD,kBAAmB,2BAAC52D,EAAGi1B,GACrBxU,EAAQwU,GArCe,SAArB4hC,mBAAsBpwD,GAC1BA,EAAMxG,iBACN02D,EAAiBlwD,EAAMirB,OAAOolC,eAC9Br3D,GAAK,GACL,IAAMs3D,EAAStwD,EAAMyB,QACf8uD,EAASvwD,EAAM0B,QAOfwE,EALUhL,OAAOyO,WAKC2mD,EAHV,IAIVlqD,GAAQF,EACRD,EANY/K,OAAO0O,YAMH2mD,EAJN,EAKRpqD,GAAUF,EACZC,IACFE,EAAI,UAAMkqD,EAAS,EAAf,OAGFlqD,IACFA,EAAI,UAAMkqD,EAZE,IAYe,EAAvB,OAGFrqD,IACFA,EAAG,UAAMsqD,EAAS,EAAf,OAGDpqD,IACFF,EAAG,UAAMsqD,EAnBG,EAmBc,EAAvB,OAGLlxB,EAAY,CAAEj5B,OAAMH,QAMlBmqD,CAAmB72D,QAIvB,IAAMwI,EAAe9I,uBACnB,SAAC+G,EAAO1G,GACN0G,EAAMxG,iBACNF,EAAMwC,GACN9C,GAAK,KAEP,CAAC8C,IAqBH,OAlBApD,qBAAU,WACR,IAAM83D,EAAqB,SAArBA,mBAAsBxwD,GAExBiwD,GACAjwD,EAAMirB,OAAOolC,gBACZrwD,EAAMirB,OAAOolC,cAAcI,WAAWR,IACvBviC,GAAW10B,GAAK,IAKpC,OAHIg3D,GACFA,EAAQ1lD,iBAAiB,QAASkmD,GAE7B,WACDR,GACFA,EAAQzlD,oBAAoB,QAASimD,MAGxC,CAAC9iC,EAAW3lB,EAAKioD,EAASC,IAExBviC,EAKHpkB,EAAKG,SACLiB,wBACEpS,GACE,oBAAKyP,IAAKA,EAAKY,IAAK,CAAC5C,GAAQ1L,GAA7B,SACG/B,EAAQ+Z,KAAI,SAACg6B,EAAGz0B,GAAJ,OACX,uBAGEhhB,KAAK,SACLiD,QAAS,iBAACN,GAAD,OAAOwI,EAAaxI,EAAG8yC,EAAExyC,UAJpC,SAMGwyC,EAAElnB,OAJEvN,QASbtO,EAAKG,SApBA,KAyBIspB,4BAAW+8B,aC3IXY,GAzBU,SAAnBA,iBAAoB,GAAsB,IAApBvG,EAAmB,EAAnBA,aAC1B,OACE,gCACGA,EAAa93C,KAAI,SAACi4C,GAAD,OAChB,8CAEMA,EAAYC,uBAFlB,aAIGD,EAAYE,QAAQn4C,KAAI,SAACo4C,GAAD,OACvB,+CAEMA,EAAOC,eAAeD,EAAOE,yBAFnC,cAIGF,EAAOG,OAAO,UACf,+BACGH,EAAOI,SAAYJ,EAAOK,aAAe,UAAO,UAAQ,QALtDL,EAAOC,iBAAiB7xD,UAL5ByxD,EAAYC,sBAAsB1xD,WC6ClC83D,GA7CO,SAAhBA,cAAiB,GAA4B,IAA1B/b,EAAyB,EAAzBA,IAAKgc,EAAoB,EAApBA,cACtBj5D,EAAYQ,aAAa,CAC7BhB,OAAOsD,UAAUyvC,eAAevvC,KAAKi6C,EAAI9G,SAAU,MAC/C8G,EAAI9G,SAAS10C,GACb,KAGN,OACE,uDACEw3D,cAAeA,EAEfjoD,IACEhR,EAAUgB,SACN+wD,GACAvyD,OAAOsD,UAAUyvC,eAAevvC,KAC9Bi6C,EAAI9G,SACJ,6BAC4C,IAAzC8G,EAAI9G,SAAS+iB,wBAClBlH,GACA,MAEF/U,EAAIoW,eACJrzD,EAAU+B,SAdhB,aAgBGk7C,EAAIqW,MAAM54C,KAAI,SAAC64C,GAAU,IAAD,EACwBA,EAAKT,OAA5C3jD,EADe,EACfA,SAAU69C,EADK,EACLA,SAAUtnD,EADL,EACKA,MAAOiY,EADZ,EACYA,QACnC,OACE,6CAEM41C,EAAKC,gBAFX,IAGEyF,cAAe,uBAACr3D,GAGd,OAFAA,EAAEC,kBAEK,GAETY,MAAO,CAAE0M,WAAU69C,WAAUtnD,QAAOiY,WARtC,SAUG41C,EAAKN,OAAO,UATRM,EAAKryD,UAlBX+7C,EAAIoW,cAAcnyD,MCF7B,SAASi4D,WAAT,GAAiD,IAA3Bh1D,EAA0B,EAA1BA,KAAMw3B,EAAoB,EAApBA,QAASh7B,EAAW,EAAXA,QAC7By4D,EAAa/oD,mBAD2B,EAQ1C8hD,oBACF,CACEx2B,UACAx3B,QAEFiuD,cAVAE,EAH4C,EAG5CA,cACAC,EAJ4C,EAI5CA,kBACAC,EAL4C,EAK5CA,aACAC,EAN4C,EAM5CA,KACAC,EAP4C,EAO5CA,WASI+F,EAAqBn3D,uBACzB,SAACM,EAAGq7C,GACG70C,0BAA0BxG,KAC7BA,EAAEC,iBACFu3D,EAAWtnD,QAAQ0mD,kBAAkB52D,EAAGq7C,EAAI9G,aAGhD,CAACijB,IAEH,OACE,aAAC,WAAD,WACE,gDAAW9G,KAAX,IAA4BthD,IAAKihD,GAAjC,UACE,aAAC,GAAD,CAAkBO,aAAcA,IAChC,gDAAWD,KAAX,aACGE,EAAK/3C,KAAI,SAACuiC,GAET,OADAyV,EAAWzV,GAET,aAAC,GAAD,yBAEEA,IAAKA,GACDA,EAAIoW,eAHV,IAIE4F,cAAe,uBAACr3D,GAAD,OAAO62D,EAAmB72D,EAAGq7C,MAHvCA,EAAI/7C,eASnB,aAAC,GAAD,CAAakP,IAAKgpD,EAAYz4D,QAASA,OAa7Cw4D,WAAWltD,aAAe,CACxBtL,QAAS,MAGIye,sBAAK+5C,YCzDLE,OAff,SAASA,cACP,OACE,mBACE52D,MAAO,CACL2tC,UAAW,SACX1qC,MAAO,OACPoY,SAAU,OACVH,QAAS,MACTC,MAAO,QANX,sBCkBE07C,GAAc,CAAExM,WAAY,GAAId,YAAa,GAAI/yB,OAAQ,QAE/D,SAASsgC,cAAT,GAQI,IAPFrjC,EAOC,EAPDA,UACAhW,EAMC,EANDA,KACA0E,EAKC,EALDA,UACAiC,EAIC,EAJDA,QACAisB,EAGC,EAHDA,aACAmkB,EAEC,EAFDA,SACAniC,EACC,EADDA,YAEM70B,EAAW6M,cACX0sD,EAAenpD,iBAAO,IACpBgoD,EAAY36C,YAAZ26C,QACFoB,EAAwBn4D,uBAC5B,SAACM,EAAGq7C,GACFr7C,EAAEC,iBACFD,EAAEE,kBACF,IAAM43D,EAASzc,EAAI9G,SACnBl2C,EAAS,CACPhB,KAAMgW,GACNusC,WAAYkY,EAAOj4D,OAGvB,CAACxB,IAEG05D,EAA4Br4D,uBAChC,SAAChC,EAAO29C,GACN,IAAM94C,EAAI,2BAAQ84C,EAAI9G,UAAZ,IAAsBlZ,KAAM39B,IACtCW,EAAS,CACPhB,KAAMiY,GACN/S,WAGJ,CAAClE,IAEG25D,EAAiBz5D,mBACrB,iBAAM,CACJ,CACE05D,WAAY,EACZhK,OAAQ,IACRuE,KAAM,0BAAGnX,IAAch9B,MAAQ,GAC/Bva,MAAO,IAGT,CACEm0D,WAAY,EACZhK,OAAQ,OACRiK,SAAU,OACV3F,SAAU,QACVE,WAAW,EACXD,KAAM,0BAAGnX,IAAc9G,SAASlxC,KAAKqc,QAAQ,KAE/C,CACEu4C,WAAY,EACZhK,OAAQ,KACRiK,SAAU,KACV3F,SAAU,QACVE,WAAW,EACXD,KAAM,0BAAGnX,IAAc9G,SAAS/1B,GAAGkB,QAAQ,KAE7C,CACEu4C,WAAY,EACZhK,OAAQ,OACRiK,SAAU,OACV3F,SAAU,QACVE,WAAW,EACXD,KAAM,qBAAGnX,EAAH,EAAGA,IAAH,OACJ,cAAC,GAAD,CACE9jB,SAAU,kBAAC75B,GAAD,OAAWq6D,EAA0Br6D,EAAO29C,IACtD94C,KAAM63B,GACNv5B,MAAO62D,GACPt2C,aAAci6B,EAAI9G,SAASlZ,SAIjC,CACE48B,WAAY,EACZhK,OAAQ,GACRnqD,MAAO,KACPsnD,SAAU,OACV79C,SAAU,OACV1N,GAAI,gBACJ2yD,KAAM,qBAAGnX,EAAH,EAAGA,IAAH,OACJ,wBACEh+C,KAAK,SACL8J,UAAU,gBACV7G,QAAS,iBAACN,GAAD,OAAO63D,EAAsB73D,EAAGq7C,IAH3C,SAKE,cAAC,KAAD,WAKR,CAAC0c,EAA2BF,IAGxBM,EAAsBz4D,uBAC1B,SAAC+G,EAAO40C,GACNh9C,EAAS,CACPhB,KAAMwZ,GACNnZ,MAAO+I,EAAMirB,OAAOh0B,MACpBmC,GAAIw7C,EAAIx7C,OAGZ,CAACxB,IAEG+5D,EAAkB14D,uBAAY,SAAC2e,GACnCu5C,EAAa1nD,QAAQ9J,SAAQ,SAACoI,EAAKrM,GAC7Bkc,IAAUlc,GAAKqM,GACjBA,EAAI6nD,iBAGP,IAEHl3D,qBAAU,WAIR,OAHIs3D,GACFA,EAAQ1lD,iBAAiB,YAAaqnD,GAEjC,WACD3B,GACFA,EAAQzlD,oBAAoB,YAAaonD,MAG5C,CAACA,EAAiB3B,IAErB,IAAM4B,EAAe95D,mBAAQ,WAC3B,IAAM+5D,EAAkB,SAAlBA,gBAAmB51B,EAAOrkB,EAAOk6C,EAAaC,GAClD91B,EAAMzjC,KAAK,CACTg5D,WAAY55C,EACZ4vC,OAAQsK,EACRhG,SAAU,QACVC,KAAM,qBAAGnX,EAAH,EAAGA,IAAH,OAAamd,EAAYnd,OAI7Bod,EAAuBx3C,GAC3BiS,EADmC,uCAEHlQ,EAFG,MAIjC01C,EAAI,aAAOV,GAmBf,GAjBEn3C,IACE43C,EACA,eACA1pC,GAAsBC,eAGxBspC,EAAgBI,EAAM,EAAG,YAAY,SAACrd,GAAD,OACnC2R,GACE3R,EAAI9G,SAAStpB,SACbpK,IACE43C,EACA,iBACA1pC,GAAsBE,oBAM5BpO,IACE43C,EACA,eACA1pC,GAAsBG,cAExB,CACA,IAAMqG,EAAIvS,GAAaA,EAAU9c,QAAQ,SAAU,IACnDoyD,EAAgBI,EAAM,EAAP,mBAAsBnjC,IAAK,SAAC8lB,GACzC,IAAMsd,EAAkB3L,GACtB3R,EAAI9G,SAASvoB,SACbnL,IACE43C,EACA,iBACA1pC,GAAsBI,iBAG1B,OACE,cAAC,GAAD,CACE2mC,YAAa,8BAAMsC,EAAgB/c,EAAIh9B,QACvC7P,IAAK,aAACA,GAAD,OAAUopD,EAAa1nD,QAAQmrC,EAAIh9B,OAAS7P,GACjD9Q,MAAOi7D,EACPjQ,OAAQ,gBAACjiD,GAAD,OAAW0xD,EAAoB1xD,EAAO40C,EAAI9G,WAClDl3C,KAAK,cAMb,OAAOq7D,EAAK7gC,MACV,SAAC+gC,EAASC,GAAV,OAAsBD,EAAQX,WAAaY,EAAQZ,gBAEpD,CACDj1C,EACAg1C,EACAI,EACAllC,EACAilC,IAGIW,EAAYv6D,mBAAQ,WACxB,SAASw6D,UAAU11D,EAAMmb,GACvB,IAAMi0B,EAAS,IAGf,OADApvC,GAAcovC,GADdj0B,GAAUi0B,IAGDxtB,EAAQ,GAAKwtB,GAAUpvC,GAAQ4hB,EAAQ,GAAKwtB,GAClDpvC,GAAQ4hB,EAAQ,GAAKwtB,GAAUj0B,GAAMyG,EAAQ,GAAKwtB,EAGvD,OAAuB,IAAnBn0B,EAAKyE,WAAmBuR,GAAaA,EAAUC,QAC9B2c,EACf5c,EAAUC,OAAOjzB,QAAO,SAAC0qB,GAAD,OACtB+sC,UAAU/sC,EAAS3oB,KAAM2oB,EAASxN,OAEpC8V,EAAUC,QAEIzb,KAAI,SAACkT,GACrB,OAAO,2BACFA,GADL,IAEEsrC,wBAAyByB,UAAU/sC,EAAS3oB,KAAM2oB,EAASxN,SAI1D,KACN,CAAC0yB,EAAc5yB,EAAKyE,UAAWuR,EAAWrP,IAM7C,OAJA9lB,qBAAU,WACRk2D,EAASyD,EAAU12D,UAClB,CAAC02D,EAAWzD,IAERyD,GAAaA,EAAU12D,OAAS,EACrC,cAAC,GAAD,CAAYG,KAAMu2D,EAAW/+B,QAASs+B,IAEtC,cAAC,GAAD,IAIW1F,I,GAAAA,MAAiBn1C,eAAKm6C,gB,UC7P/B92D,GAAQuO,YAAH,u+BA+DX,SAAS4pD,WAAT,GAA4D,IAAtCptC,EAAqC,EAArCA,MAAOqtC,EAA8B,EAA9BA,cAAe5gD,EAAe,EAAfA,KAAM3a,EAAS,EAATA,MAAS,EACX+J,oBAAS,GADE,mBAClDyxD,EADkD,KAC9BC,EAD8B,OAE/B1xD,mBAAS/J,GAFsB,mBAElDse,EAFkD,KAE3Co9C,EAF2C,KAInDC,EAAc35D,uBAAY,WAC9By5D,GAAiBD,KAChB,CAACA,IAEErrD,EAAcnO,uBAAY,WAC9By5D,GAAgB,KACf,IAEGG,EAAuB55D,uBAC3B,SAAC65D,GACC,IAAMvmB,EAAG,UAAMumB,EAAWvmB,KAAjB,OAAuBzpC,KAAK+oC,MAChB,IAAnBinB,EAAWrmB,IAAI1wC,GACfwf,SAAS,KACXo3C,EAASpmB,GACTimB,EAAc,2BAAKM,GAAN,IAAkBvmB,MAAK36B,YAEtC,CAACA,EAAM4gD,IAGT,OACE,oBAAK7pD,IAAKvO,GAAV,UACE,qBAAMsG,UAAU,aAAhB,SAA8BykB,IAC9B,oBAAK/qB,MAAO,CAAE+O,KAAM,GAApB,UACE,oBAAKzI,UAAU,SAAS7G,QAAS+4D,EAAjC,UACE,oBAAKlyD,UAAU,QAAQtG,MAAO,CAAEiM,gBAAiBkP,KACjD,sBAAO3e,KAAK,SAASK,MAAOse,EAAO3D,KAAMA,OAE1C6gD,EACC,oBAAK/xD,UAAU,gBAAf,UACE,oBAAKA,UAAU,QAAQ7G,QAASuN,IAChC,aAAC,gBAAD,CACEmO,MAAO,CAAEg3B,IAAKh3B,GACdw9C,iBAAkBF,OAGpB,WAMZN,WAAW3uD,aAAe,CACxB3M,MAAO,UACPkuB,MAAO,UACPqtC,cAAe,gCAAM,OAGRz7C,sBAAKw7C,YCnHdxsD,GAAS,CACb6uC,IAAK,CACHtuC,QAAS,OACTuE,OAAQ,UACRrE,WAAY,UAEdwsD,WAAY,CACV7pD,KAAM,EACNsM,SAAU,OACV6W,WAAY,OACZ/W,MAAO,WAET0rC,MAAO,CACL5jD,MAAO,MACP0qC,UAAW,WAIf,SAASkrB,kBAAT,GAQI,IAPF9tC,EAOC,EAPDA,MACA+tC,EAMC,EANDA,oBACAxoB,EAKC,EALDA,QACAtb,EAIC,EAJDA,OACA+jC,EAGC,EAHDA,qBACAC,EAEC,EAFDA,mBACAC,EACC,EADDA,QACC,EAC8BryD,mBAASsyD,QAAQ5oB,IAD/C,mBACM6oB,EADN,KACgBC,EADhB,KAGD,OACE,sBAAKp5D,MAAO2L,GAAO6uC,IAAnB,UACE,sBAAMx6C,MAAO2L,GAAOitD,WAApB,SAAiC7tC,IACjC,sBACE/qB,MAAO,CACL+O,KAAM,EACN7C,QAAS,OACTO,cAAe,MACfL,WAAY,UALhB,UAQE,uBACE5P,KAAK,WACLk6B,SAAU,kBAACv3B,GAAD,OAAOi6D,EAAWj6D,EAAE0xB,OAAOyf,UACrCtwC,MAAO,CAAEyQ,OAAQ,WACjBi1C,eAAgByT,IAElB,uBACE3hD,KAAI,UAAKyhD,EAAL,YAAgBH,GACpBt8D,KAAK,SACLK,MAAOs8D,IAET,cAAC,GAAD,CACEn5D,MAAO,CAAEJ,UAAW+L,GAAOk7C,OAC3BrvC,KAAI,UAAKyhD,EAAL,YAAgBF,GACpBv8D,KAAK,OACLk6B,SAAUsiC,EACVn8D,MAAOm4B,GAAkB,WAOpBrY,sBAAKk8C,mBC3CdltD,GAAS,CACb/L,UAAW,CACTsb,QAAS,GACTjP,gBAAiB,UACjB/I,OAAQ,OACR6L,KAAM,GAERsqD,eAAgB,CACdn+C,QAAS,MACTtO,aAAc,MACd6D,OAAQ,WACRxE,gBAAiB,SAEnBuuC,IAAK,CACHtuC,QAAS,OACTuE,OAAQ,WAEV8rC,OAAQ,CACN/X,aAAc,oBACd80B,cAAe,MACfpnC,WAAY,OACZ/W,MAAO,WAETy9C,WAAY,CACV7pD,KAAM,EACNsM,SAAU,OACV6W,WAAY,OACZ/W,MAAO,WAET0rC,MAAO,CACL5jD,MAAO,MACP0qC,UAAW,WAIT4rB,GAAe,CACnB,CACEv6D,GAAI,EACJ+rB,MAAO,aACPyuC,gBAAiB,eACjBC,iBAAkB,iBAClBC,cAAe,QAEjB,CACE16D,GAAI,EACJ+rB,MAAO,aACPyuC,gBAAiB,eACjBC,iBAAkB,iBAClBC,cAAe,UAGnB,SAASC,qBAAT,EAAwDhsD,GAAM,IAA9B0R,EAA6B,EAA7BA,QAASgT,EAAoB,EAApBA,YACjCrtB,EAAQ+3C,KAD6C,EAE/Bz9B,yBAAyB,wBAA5CwoC,EAFkD,sBAI5BlhD,mBAAS,MAJmB,mBAIpDuZ,EAJoD,KAI1Cy5C,EAJ0C,KAKrDC,EAAUjsD,mBAEhBtP,qBAAU,WACR,IAAMs5D,EAAuBkC,GAC3BznC,EACA,+BAGEulC,GACFgC,EAAWhC,KAEZ,CAACvlC,IAEJ,IAAM0nC,EAAsB,SAAtBA,oBAAuBrmC,GAC3Bo0B,EAAgBp0B,EAAQ,gCAGpBs+B,EAAcnzD,uBAClB,SAAC60B,GAAiC,IAAzBsmC,EAAwB,wDAC/B3nC,EAAY70B,SAAS,CACnBhB,KAAMklD,GACNjlD,QAAS,CAAEgC,IAAK,YAAa5B,MAAO62B,KAElCsmC,GACFh1D,EAAMs4C,QAAQ,8CAGlB,CAACt4C,EAAOqtB,IAGVijC,8BAAoB3nD,GAAK,iBAAO,CAC9BssD,YAD8B,uBAEiB,oBAAlCJ,EAAQxqD,QAAQ6qD,cACzBL,EAAQxqD,QAAQ6qD,gBAEhBL,EAAQxqD,QAAQ8qD,cACd,IAAIC,MAAM,SAAU,CAAEC,YAAY,UAM1C,IAAMC,EAAY,yCAAG,iBAAO10D,GAAP,8BAAAjE,EAAA,+DACnBiE,EAAMxG,iBACAm7D,EAAO30D,EAAMirB,OACb2pC,EAAW,IAAIC,SAASF,GAC1B7mC,EAAS,GAJM,eAKC8mC,EAASrW,WALV,IAKnB,2BAAWuW,EAA6B,QAChC19D,EAAO09D,EAAM,GAAG/2C,MAAM,KAAKyvB,KAAK,KAChC5pB,EAAM,CAAC,OAAQ,SAAS9qB,SAASg8D,EAAM,IAC5B,SAAbA,EAAM,GACNA,EAAM,GACVhnC,EAAS3T,KAAU2T,EAAQ12B,EAAMwsB,GAVhB,8BAYnBwoC,EAAYt+B,GAAQ,GACpBqmC,EAAoBrmC,GAbD,iDAAH,gBAAZ4mC,aAAY,sCAgBZl6C,EAAWvhB,uBACf,WAAgB,IAAD,uBAAXo4D,EAAW,yBAAXA,EAAW,gBACb,GAAI92C,EAAU,CACZ,IAAMtjB,EACU,OAAdo6D,EAAO,GACH92C,EAAS82C,EAAO,IAChBj3C,IAAUG,EAAU82C,EAAO7jB,KAAK,MACtC,OAAOv2C,GAAgB,KAEvB,IAAM89D,EAAW1D,EAAO11D,OAAS,EACjC,OAAO2sB,GAAsB+oC,EAAO0D,MAGxC,CAACx6C,IAEH,OACE,qBAAKngB,MAAO2L,GAAO/L,UAAnB,SACE,uBAAMyhD,SAAUiZ,EAAc3sD,IAAKksD,EAAnC,UACE,sBAAK75D,MAAO2L,GAAO0tD,eAAnB,UACE,mBAAGr5D,MAAO2L,GAAO4wC,OAAjB,qBACA,cAAC,GAAD,CAAY/kC,KAAK,QAAQ3a,MAAK,UAAKujB,EAAS,KAAM,YAClD,cAAC,GAAD,CACE5I,KAAK,cACLuT,MAAM,iBACN/qB,MAAO,CACL+qB,MAAO,CAAE1P,SAAU,OAAQ6W,WAAY,OAAQ/W,MAAO,WACtD0rC,MAAO,CACL5jD,MAAO,MACP0qC,UAAW,SACX/gC,aAAc,QAGlB2T,aAAcwU,OAAO3U,EAAS,KAAM,gBACpC2C,IAAK,EACLwlC,QAAQ,cAIXlpC,GACCA,EAAQpH,KAAI,SAAC2iD,GAAD,OACV,sBAAwB56D,MAAO2L,GAAO0tD,eAAtC,UACE,mBAAGr5D,MAAO2L,GAAO4wC,OAAjB,SACE,cAAC,KAAD,CAAIpP,GAAIytB,MAETrB,GAAathD,KAAI,SAACyiD,GAAD,OAChB,cAAC,GAAD,CAEE3vC,MAAO2vC,EAAM3vC,MACbulB,QAASlwB,EAASw6C,EAAcF,EAAMlB,iBACtCxkC,OAAQ5U,EAASw6C,EAAcF,EAAMjB,kBACrCX,oBAAqB4B,EAAMlB,gBAC3BT,qBAAsB2B,EAAMjB,iBAC5BR,QAAS2B,GANJF,EAAM17D,SANP47D,WAsBP9I,I,GAAAA,MAAiBn5B,qBAAWghC,uBClLrChuD,GAAS4C,YAAH,qOAcZ,SAASssD,cAAT,GAA6D,IAApCpnC,EAAmC,EAAnCA,UAAWtR,EAAwB,EAAxBA,UAAWkX,EAAa,EAAbA,UAAa,EACdzyB,oBAAS,GADK,mBACnD8tD,EADmD,KACnCoG,EADmC,OAEVl0D,mBAAS,GAFC,mBAEnDm0D,EAFmD,KAEjCC,EAFiC,KAIpDx9D,EAAW6M,cACX8E,EAAQzD,IAL4C,EAMvB9E,oBAAS,GANc,mBAMnDq0D,EANmD,KAMxCC,EANwC,KAOpDC,EAAavtD,mBAEbiB,EAAahQ,uBAAY,WAC7BrB,EAAS,CAAEhB,KAAMgW,GAAiBusC,WAAY,SAC7C,CAACvhD,IAEE49D,EAAkBv8D,uBAAY,WAClCsQ,EAAMY,kBAAkB,6CAA8C,CACpErB,MAAOG,MAER,CAACM,EAAON,IAELwsD,EAA2Bx8D,uBAC/B,SAAChC,QACe+nB,IAAV/nB,GACFW,EAAS,CAAEhB,KAAMoY,GAAqB/X,UAGxCsS,EAAMkB,UAER,CAAC7S,EAAU2R,IAGPqlC,EAAa92C,mBAAQ,WACzB,OAAOsiB,IAAUyT,EAAW,cAAe,QAC1C,CAACA,IAEE6nC,EAA6Bz8D,uBAAY,WAC7CsQ,EAAMvQ,KACJ,aAAC,GAAD,CACEmO,QAAS,0BAAMoC,EAAMkB,SACrBw3C,OAAQwT,EACR9e,OACE/H,EAAU,0CAC6Bzf,OAAOyf,GAAY31B,QACpD,GAFI,KAIN,wBAENwa,UAAWA,EACX7zB,QAAS2c,EAAYA,EAAU9c,QAAQ,SAAU,IAAM,UAG1D,CAAC8c,EAAWk5C,EAA0B7mB,EAAYrlC,EAAOkqB,IAEtDkiC,EAAuB18D,uBAAY,WACvCq8D,GAAeD,KACd,CAACA,IAEEO,EAAqB38D,uBAAY,WACrCs8D,EAAW9rD,QAAQ4qD,cACnBiB,GAAc,KACb,IAEGO,EAAiB58D,uBAAY,WACjCi8D,GAAmBpG,KAClB,CAACA,IAEEgH,EAAiB78D,uBAAY,SAAC2qB,GAClCwxC,EAAoBxxC,KACnB,IAEH,OACE,aAAC,WAAD,UACE,oBAAKjb,IAAK5C,GAAV,WACIsvD,GACA,aAAC,GAAD,CACE3G,QAASyG,EACTptC,SAAUytC,EACV7G,cAAc,uBACdC,SAAUiH,EACVhH,cACEC,EACI,qBACA,6BAENA,eAAgBA,EAChBC,gBAAiBoG,EACjBlG,kBAAkB,OAClBD,eAAgB2G,EAblB,SAeE,aAAC,GAAD,CACE7/C,MACE84B,EAAU,gCACmBzf,OAAOyf,GAAY31B,QAAQ,GAD9C,KAEN,uBAENpD,eAAe,QANjB,SAQE,uBACEnV,UAAU,aACV9J,KAAK,SACLiD,QAAS67D,EAHX,SAKE,aAAC,KAAD,UAKPL,GACC,aAAC,GAAD,CACEpT,OAAQ2T,EACRzuD,QAASwuD,IAGb,oBAAKv7D,MAAO,CAAEkD,OAAQ,OAAQkL,SAAU,QAAxC,SACE,aAAC,KAAD,CACE6sD,UAAWA,EACXU,UAAQ,EACRttD,eAAgB,CAAED,SAAU,UAH9B,UAKE,6BACE,aAAC,GAAD,CACEiiC,aAAcqkB,EACdF,SAAUkH,MAGd,aAAC,GAAD,CAAsB/tD,IAAKwtD,cAQxBrJ,UAAiBn1C,eAAKk+C,gB,+BCpKrC,SAASe,cAAT,GAOI,IANFh+D,EAMC,EANDA,SACAoC,EAKC,EALDA,MACAP,EAIC,EAJDA,QACAod,EAGC,EAHDA,WACApB,EAEC,EAFDA,eACGpe,EACF,6EACD,OACE,cAAC,GAAD,CAASqe,MAAOmB,EAAYpB,eAAgBA,EAA5C,SACE,gDAAQzb,MAAOA,EAAOxD,KAAK,SAASiD,QAASA,GAAapC,GAA1D,aACGO,OAMTg+D,cAAcpyD,aAAe,CAC3BqT,WAAY,GACZpB,eAAgB,QAChBzb,MAAO,GACPP,QAAS,0BAAM,MACfkB,UAAU,GAGGi7D,I,GAAAA,iBCrBTC,GAAattD,YAAH,yWAyDDutD,OAvCf,SAASA,WAAT,GAA8E,IAAxD97D,EAAuD,EAAvDA,MAAO0P,EAAgD,EAAhDA,UAAgD,IAArCqsD,eAAqC,MAA3B,GAA2B,EAAvBn+D,EAAuB,EAAvBA,SAAU0I,EAAa,EAAbA,UAAa,EAC/CM,oBAAS,GADsC,mBACpEo1D,EADoE,KAC3DC,EAD2D,KAEnErG,EAAY36C,YAAZ26C,QAEFsG,EAAkBr9D,uBAAY,WAClC+b,YAAW,WACTqhD,GAAS,KACR,OACF,IAEGzD,EAAc35D,uBAAY,WAC1B+2D,IACFqG,GAAS,GACTrG,EAAQ1lD,iBAAiB,YAAagsD,EAAiB,CAAEv2C,MAAM,OAEhE,CAACu2C,EAAiBtG,IAErB,OACE,oBAAK51D,MAAO,CAAEkD,OAAQ,QAAtB,UACE,uBACE1G,KAAK,SACL+R,IAAKvO,EACLP,QAAS+4D,EACTlyD,UAAWA,EAJb,SAME,aAAC,GAAD,CAASoV,MAAOqgD,EAAStgD,eAAe,QAAxC,SACG/L,MAIJssD,EACC,oBAAK11D,UAAU,OAAOiI,IAAKstD,GAA3B,SACGj+D,IAED,SCfKu+D,I,GAAAA,GAzCf,SAASA,gBAAgB5jC,GACvB,IAAMvqB,EAAU,SAAVA,QAAW3Q,GAAW,IAAD,EAOrB6M,eALFxI,EAFuB,EAEvBA,KACAsb,EAHuB,EAGvBA,eACAqc,EAJuB,EAIvBA,UACA+P,EALuB,EAKvBA,cACAjnB,EANuB,EAMvBA,UANuB,EASWzkB,mBAAQ,WAC1C,OAAIgE,GAAQsb,GAAkBA,EAAehe,GAC7B0C,EAAK43B,MAAK,SAACrX,GAAD,OAAWA,EAAMjjB,KAAOge,EAAehe,OAAO,CACpEm6B,OAAQ,GACRxS,MAAO,IAIJ,KACN,CAAC3J,EAAgBtb,IAlBK,IASjBy3B,cATiB,MASR,GATQ,MASJxS,aATI,MASI,GATJ,EAoBjB8R,EAA0Bp7B,EAA1Bo7B,aAAiBC,EApBA,aAoBSr7B,EApBT,kBAqBzB,OACE,cAACk7B,EAAD,2BACMG,GADN,IAEES,OAAQA,EACRxS,MAAOA,EACP0S,UAAWA,EACX+P,cAAeA,EACfjnB,UAAWA,EACXxU,IAAK8qB,MAKX,OAAO9b,eACLgc,sBAAW,SAACt7B,EAAOsQ,GACjB,OAAO,cAACK,EAAD,2BAAa3Q,GAAb,IAAoBo7B,aAAc9qB,UChCzCyuD,GAAmB7tD,YAAH,qqDA4GP8tD,OA/Df,SAASA,6BAA6Bh/D,GAAQ,IACpC0P,EAAoC1P,EAApC0P,QAASD,EAA2BzP,EAA3ByP,KAAMwvD,EAAqBj/D,EAArBi/D,iBADoB,EAEb11D,mBAAS,MAFI,mBAEpC0sD,EAFoC,KAE3BiJ,EAF2B,KAGrC/+D,EAAW6M,cAEjB/L,qBAAU,WAENi+D,EADED,EACSA,EAAiBhJ,QAEjB,QAEZ,CAACgJ,EAAkBxvD,IAEtB,IAAM0vD,EAAK39D,uBACT,SAAC49D,GACCF,EAAWE,KAEb,CAACF,IAGGvvD,EAAcnO,uBAAY,WAC9BkO,MACC,CAACA,IAEEi7C,EAAanpD,uBAAY,WACzBy9D,GACF9+D,EAAS,CAAEhB,KAAMoW,GAAc0gD,UAAS70D,IAAK69D,EAAiB79D,MAC9DsO,EAAQ,aAERvP,EAAS,CAAEhB,KAAMmW,GAAc2gD,YAC/BvmD,EAAQ,UAET,CAACvP,EAAU8+D,EAAkBhJ,EAASvmD,IAWzC,OACE,aAAC,GAAD,CAAOD,KAAMA,EAAMC,QAASC,EAA5B,UACE,aAAC,KAAD,CACE0vD,eAAgBJ,GAAoBA,EAAiBhJ,QACrDqJ,SAAO,EACPC,UAAU,EACVlmC,SAAU8lC,IAEZ,oBAAKx8D,MAhBC,CACNkM,QAAS,OACTE,WAAY,WACZD,eAAgB,WAChBsE,OAAQ,GAYR,UACE,uBAAQjU,KAAK,SAAS+R,IAAK6tD,GAAkB38D,QAASuN,EAAtD,mBAGA,uBAAQxQ,KAAK,SAAS+R,IAAK6tD,GAAkB38D,QAASuoD,EAAtD,yBC/FO6U,OAXf,SAASA,eAAT,GAAyD,IAAD,IAA9BhgE,aAA8B,MAAtB,GAAsB,EAAfigE,EAAe,0BACtD,OACE,+CACMA,GADN,IAEEC,wBAAyB,CACvBC,OAAQngE,EAAMwI,QAAQ,YAAa,sBCFrC43D,GAAe,SAASA,aAAT,GAKjB,IAJFzlD,EAIC,EAJDA,KACA3a,EAGC,EAHDA,MACA65B,EAEC,EAFDA,SACGkvB,EACF,8CACiCC,eAA1BnyB,EADP,EACOA,OAAQoyB,EADf,EACeA,cACVC,EAAgBlnD,uBACpB,SAAChC,GACC65B,EAAS75B,GACTipD,EAActuC,EAAM3a,KAEtB,CAAC2a,EAAMkf,EAAUovB,IASnB,OANAxnD,qBAAU,WACJzB,GACFipD,EAActuC,EAAM3a,KAErB,CAAC2a,EAAMsuC,EAAejpD,IAGvB,cAAC,GAAD,aACE2a,KAAMA,EACN+I,aAAc1jB,GAAgBmjB,IAAU0T,EAAQlc,GAChDkf,SAAUqvB,GACNH,KAMVqX,GAAazzD,aAAeggD,GAAOhgD,aAEpByzD,I,GAAAA,MC3BTtxD,GAAS4C,YAAH,swEAoHN2uD,GAAc,CAClB,CAAEz+D,IAAK,EAAG5B,MAAO,GAAIkuB,MAAO,UAC5B,CAAEtsB,IAAK,EAAG5B,MAAO,IAAKkuB,MAAO,WAC7B,CAAEtsB,IAAK,EAAG5B,MAAO,IAAKkuB,MAAO,WAC7B,CAAEtsB,IAAK,EAAG5B,MAAO,IAAKkuB,MAAO,WAC7B,CAAEtsB,IAAK,EAAG5B,MAAO,IAAKkuB,MAAO,WAC7B,CAAEtsB,IAAK,EAAG5B,MAAO,IAAKkuB,MAAO,WAC7B,CAAEtsB,IAAK,EAAG5B,MAAO,IAAKkuB,MAAO,WAC7B,CAAEtsB,IAAK,EAAG5B,MAAO,IAAKkuB,MAAO,WAC7B,CAAEtsB,IAAK,EAAG5B,MAAO,IAAMkuB,MAAO,YAC9B,CAAEtsB,IAAK,GAAI5B,MAAO,KAAMkuB,MAAO,aAG3BoyC,GAAgB,CACpB,KAAM,CAAE36D,MAAO,EAAGmb,GAAI,IACtB,MAAO,CAAEnb,MAAO,EAAGmb,GAAI,KACvBM,UAAW,IACXs9B,QAAS,CACP,MAAM,EACN,OAAO,EACPxK,MAAM,EACNI,MAAM,EACNC,MAAM,IAqHKgsB,I,YAAAA,GAjHf,SAASA,oBAAT,GAAoD,IAArBrwD,EAAoB,EAApBA,QAASumD,EAAW,EAAXA,QAChCvL,EAAUn6C,mBACVpQ,EAAW6M,cAEX29C,EAAanpD,uBAAY,WAC7BkpD,EAAQ14C,QAAQ44C,eACf,IAEGC,EAAgBrpD,uBACpB,SAAC60B,GACCl2B,EAAS,CACPhB,KAAM8X,GACN6E,WAAW,IAEb3b,EAAS,CACPhB,KAAMma,GACNla,QAAS,CAAE42D,IAAKC,EAASrlD,QAASylB,KAEpC3mB,MAEF,CAACvP,EAAU81D,EAASvmD,IAGtB,OACE,oBAAKwB,IAAK5C,GAAV,UACE,oBAAKrF,UAAU,gBAAf,UACE,kDACA,aAAC,GAAD,CAAa7G,QAASsN,EAASzG,UAAU,gBAE3C,oBAAKA,UAAU,gBAAf,SACE,aAAC,GAAD,CACEqH,IAAKo6C,EACL3G,cAAe+b,GACf9b,SAAU6G,EAHZ,UAKE,oBAAK5hD,UAAU,gBAAf,UACE,qBAAMA,UAAU,eAAhB,sCAEA,aAAC,GAAD,CACE5E,KAAMw7D,GACNl9D,MAAO,CAAEiD,MAAO,IAAKC,OAAQ,GAAIuN,OAAQ,GACzC+G,KAAK,iBAGT,oBAAKlR,UAAU,gBAAf,UACE,aAAC,GAAD,CAAgBzJ,MAAM,KAAKyJ,UAAU,iBACrC,aAAC,GAAD,CACEykB,MAAM,OACNvT,KAAK,UACLhb,KAAK,SACLwD,MAAO,CAAE+qB,MAAO,CAAE7P,QAAS,iBAE7B,aAAC,GAAD,CACE6P,MAAM,KACNvT,KAAK,QACLhb,KAAK,SACLwD,MAAO,CAAE+qB,MAAO,CAAE7P,QAAS,gBAG/B,oBAAK5U,UAAU,gBAAf,UACE,aAAC,GAAD,CAAgBzJ,MAAM,MAAMyJ,UAAU,iBACtC,aAAC,GAAD,CACEykB,MAAM,OACNvT,KAAK,WACLhb,KAAK,SACLwD,MAAO,CAAE+qB,MAAO,CAAE7P,QAAS,iBAE7B,aAAC,GAAD,CACE6P,MAAM,KACNvT,KAAK,SACLhb,KAAK,SACLwD,MAAO,CAAE+qB,MAAO,CAAE7P,QAAS,gBAG/B,oBAAK5U,UAAU,gBAAf,SACE,qBAAMA,UAAU,eAAhB,wBAEF,oBACEA,UAAU,gBACVtG,MAAO,CAAEmM,eAAgB,iBAF3B,UAIE,oBAAK7F,UAAU,MAAf,UACE,aAAC,GAAD,CAAgBkR,KAAK,eACrB,aAAC,GAAD,CAAgB3a,MAAM,KAAKmD,MAAO,CAAEkb,QAAS,gBAE/C,oBAAK5U,UAAU,MAAf,UACE,aAAC,GAAD,CAAgB3F,UAAQ,EAAC6W,KAAK,gBAC9B,aAAC,GAAD,CAAgB3a,MAAM,MAAMmD,MAAO,CAAEkb,QAAS,gBAEhD,oBAAK5U,UAAU,MAAf,UACE,aAAC,GAAD,CAAgB3F,UAAQ,EAAC6W,KAAK,iBAC9B,aAAC,GAAD,CAAgB3a,MAAM,OAAOmD,MAAO,CAAEkb,QAAS,gBAEjD,oBAAK5U,UAAU,MAAf,UACE,aAAC,GAAD,CAAgB3F,UAAQ,EAAC6W,KAAK,iBAC9B,aAAC,GAAD,CAAgB3a,MAAM,OAAOmD,MAAO,CAAEkb,QAAS,gBAEjD,oBAAK5U,UAAU,MAAf,UACE,aAAC,GAAD,CAAgB3F,UAAQ,EAAC6W,KAAK,iBAC9B,aAAC,GAAD,CAAgB3a,MAAM,OAAOmD,MAAO,CAAEkb,QAAS,wBAKvD,oBAAK5U,UAAU,mBAAf,SACE,uBAAQ9J,KAAK,SAASiD,QAASuoD,EAAY1hD,UAAU,cAArD,oC,UClQF+2D,GAAkB,SAAlBA,gBAAmBC,EAAMvO,EAAU9zB,GACvC,GAAI8zB,EAASxtD,OAAS,GAAKxE,OAAOC,KAAKsgE,GAAM/7D,OAAS,EAAG,CACvD,IAAMg8D,EAAqB,MAAftiC,EAAqB,EAAmB,MAAfA,EAAqB,OAAIrW,EAC9D,QAAYA,IAAR24C,EAaF,MAAO,CACLC,OAAQ,CAACF,EAAKG,OAAO7jC,OAAO0jC,EAAKI,gBACjCC,QAASL,EAAKK,QAAUL,EAAKK,QAAUL,EAAKM,aAd9C,GAAI7O,EAASwO,KAASD,EAAKO,UAEzB,MAAO,CAAEL,OAAQ,CAACF,EAAKG,OAAQE,QAASL,EAAKK,SAE/C,GAAsB,MAAlB5O,EAASwO,GAEX,MAAO,CACLC,OAAQF,EAAKI,eACbC,QAASL,EAAKK,QAAUL,EAAKM,aAWrC,MAAO,CAAEJ,OAAQ,GAAIG,QAAS,IAG1BG,GAA0B,SAA1BA,wBAA2BxiC,EAAat8B,GAE5C,IACIm7B,EADAlY,EAAQqZ,EAAYhC,MAAK,SAACkQ,GAAD,OAAYA,EAAOxqC,KAAOA,KAEvD,IAAKijB,EAEH,IAAK,IAAI3gB,EAAI,EAAGA,EAAIg6B,EAAY/5B,OAAQD,IAItC,IAHA64B,EAAcmB,EAAYh6B,GAAGw4B,OAAOhD,WAClC,SAACiD,GAAD,OAAaA,EAAQ/6B,KAAOA,OAEX,EAAG,CACpBijB,EAAQqZ,EAAYh6B,GACpB,MAKN,MAAO,CAAE2gB,QAAOkY,gBCQZ4jC,GAAsBxvD,YAAH,6HAQnBwkD,GAAexkD,YAAH,gZAyBZykD,GAAyBzkD,YAAH,gkBAkCtByvD,GAAazvD,YAAH,mUAkBhB,SAAS0vD,cAAT,GAAgF,IAAvDt3C,EAAsD,EAAtDA,MAAOwS,EAA+C,EAA/CA,OAAQE,EAAuC,EAAvCA,UAAWlX,EAA4B,EAA5BA,UAAWinB,EAAiB,EAAjBA,cAAiB,EACnCkpB,eADmC,mBACtE9D,EADsE,YACtDvrD,EADsD,EACtDA,MAAOC,EAD+C,EAC/CA,OAD+C,EAErD0D,oBAAS,GAF4C,mBAEtEkG,EAFsE,KAEhEoxD,EAFgE,OAGjCt3D,qBAHiC,mBAGtEu3D,EAHsE,KAGtDC,EAHsD,OAIrCx3D,mBAAS,GAJ4B,mBAItEssD,EAJsE,KAIxDC,EAJwD,OAKnBvsD,mBAAS,IALU,mBAKtEy3D,EALsE,KAK/CC,EAL+C,OAM3B13D,mBAAS,MANkB,mBAMtE23D,EANsE,KAMnDC,EANmD,KAQvEhhE,EAAW6M,cACXrF,EAAQ+3C,KACR5tC,EAAQzD,IAER2/B,EAAgBxtC,eAChB68B,EAAiBiB,oBAbsD,EAc7C/0B,mBAAS,IAdoC,mBActEmoD,EAdsE,KAc5DC,EAd4D,KAgB7E1wD,qBAAU,WACR,GAAI6jB,EAAW,CACb,IAAMwB,EAAQxB,EAAUwB,MAAM,KACT,IAAjBA,EAAMpiB,OACRytD,EAAY,CAAC7sC,EAAU9c,QAAQ,SAAU,MACf,IAAjBse,EAAMpiB,QACfytD,EAAYrrC,EAAM1L,KAAI,SAACoH,GAAD,OAAaA,EAAQha,QAAQ,SAAU,aAG/D2pD,EAAY,MAEb,CAAC7sC,IAEJ,IAAMs8C,EAAmB7iC,mBACgBhX,IAAvC8V,EAAeI,WAAWE,SACtBN,EAAeI,WAAWE,S3FzKN,O2F6KpBt5B,EAAOhE,mBAAQ,WACnB,GAAIipB,GAASwS,EAAQ,CACnB,GAAIiQ,IAAkBN,GAAeC,OAAS5P,GAAUA,EAAOzF,OAC7D,OAAOyF,EAAOzF,OACT,GACL0V,IAAkBN,GAAeE,OACjCriB,GACAA,EAAM+M,OAEN,OAAO/M,EAAM+M,OAGjB,MAAO,KACN,CAAC0V,EAAejQ,EAAQxS,IAErB+3C,EAAiBhhE,mBAAQ,WAC7B,IAAMihE,EAAgB,CAAE92D,EAAG,GAAIC,EAAG,IAClC,IAAK,IAAI9I,KAAM07B,EAAeI,WAAWA,WAAY,CACF,IAAD,EAGA,EAHhD,GAAIJ,EAAeI,WAAWA,WAAW97B,GAAI6I,GAC3C,EAAA82D,EAAc92D,GAAEzJ,KAAhB,qBAAwBs8B,EAAeI,WAAWA,WAAW97B,GAAI6I,IAEnE,GAAI6yB,EAAeI,WAAWA,WAAW97B,GAAI8I,GAC3C,EAAA62D,EAAc72D,GAAE1J,KAAhB,qBAAwBs8B,EAAeI,WAAWA,WAAW97B,GAAI8I,IAIrE,OAAO62D,IACN,CAACjkC,EAAeI,aAGb8jC,EAAuBlhE,mBAC3B,kBAAMghE,EAAe72D,EAAE+xB,OAAO8kC,EAAe52D,KAC7C,CAAC42D,EAAe72D,EAAG62D,EAAe52D,IAG9B+2D,EAAmBhgE,uBACvB,SAACg7B,EAAOilC,GAGN,OACEF,EAAqBpgE,MAAK,SAACugE,GAAD,OACxBD,EAAgBtB,OAAO9+D,SAASqgE,QAEjCllC,EAAMr7B,MAAK,SAACugE,GAAD,OAAYD,EAAgBtB,OAAO9+D,SAASqgE,OAExD/5D,EAAMyY,KAAK,+CACJoc,GDpGM,SAAfmlC,aAAgBnlC,EAAOilC,GAC3B,IAAIrjC,EAAS5B,EAAQA,EAAMv5B,QAAU,GACrC,GAAsC,IAAlCw+D,EAAgBtB,OAAOj8D,OACzB,GAAIk6B,EAAO/8B,SAASogE,EAAgBtB,OAAO,IACzC/hC,EAASA,EAAOh7B,QAAO,SAACs6B,GAAD,OAASA,IAAQ+jC,EAAgBtB,OAAO,WAE/D,IAAK,IAAIl8D,EAAI,EAAGA,EAAIw9D,EAAgBnB,QAASr8D,IAC3Cm6B,EAAOr9B,KAAK0gE,EAAgBtB,OAAO,SAG9BsB,EAAgBtB,OAAOj8D,OAAS,GACzCu9D,EAAgBtB,OAAOj4D,SAAQ,SAACw5D,GAC1BtjC,EAAO/8B,SAASqgE,GAClBtjC,EAASA,EAAOh7B,QAAO,SAACs6B,GAAD,OAASA,IAAQgkC,KAExCtjC,EAAOr9B,KAAK2gE,MAIlB,OAAOtjC,ECoFIujC,CAAanlC,EAAOilC,KAE7B,CAAC95D,EAAO45D,IAGJK,EAAoBpgE,uBACxB,SAACy+D,GACC,GAAImB,EAAiBlgE,SAAU,CAC7B,IAAMugE,EAAkBzB,GACtBC,EACAvO,EACA0P,EAAiBxjC,YAEnB,GAAI6jC,EAAgBnB,QAAU,EAAG,CAE/BmB,EAAgBtB,OAAOj4D,SAAQ,SAACw5D,GAC9BN,EAAiB1iC,OAAOgjC,MAHK,MAMAjB,GAC7Bp8D,EACA+8D,EAAiBz/D,IAFXijB,EANuB,EAMvBA,MAAOkY,EANgB,EAMhBA,YAIf,GAAIlY,EAAO,CAET,IAAIwZ,EAAS,QAEO7W,IAAhBuV,EACEiP,IAAkBN,GAAeC,MACnCtN,EAASojC,EAAiB58C,EAAM4X,OAAS,GAAIilC,GACpC11B,IAAkBN,GAAeE,QAC1CvN,EAASojC,EACP58C,EAAMw8C,EAAiBxjC,YAAYpB,OAAS,GAC5CilC,IAGK78C,EAAM6X,QAAU7X,EAAM6X,OAAOK,KAElCiP,IAAkBN,GAAeC,MACnCtN,EAASojC,EACP58C,EAAM6X,OAAOK,GAAaN,OAAS,GACnCilC,GAEO11B,IAAkBN,GAAeE,QAC1CvN,EAASojC,EACP58C,EAAM6X,OAAOK,GAAaskC,EAAiBxjC,YACxCpB,OAAS,GACZilC,KAIF11B,IAAkBN,GAAeC,MACnCvrC,EAAS,CACPhB,KAAMuZ,GACNtZ,QAAS,CACPo8B,UAAW5W,EACX4X,MAAO4B,EACPtB,iBAGKiP,IAAkBN,GAAeE,OAC1CxrC,EAAS,CACPhB,KAAMka,GACNja,QAAS,CACPmvC,SAAU3pB,EACV4X,MAAO4B,EACP3K,KAAM2tC,EAAiBxjC,WACvBd,uBAMRn1B,EAAMyY,KACJ,wEAKR,CACEghD,EACAz5D,EACAtD,EACAlE,EACA4rC,EACA2lB,EACA8P,IAIEK,EAA2BxhE,mBAAQ,WACvC,OD1NgC,SAA9ByhE,4BAA+BzkC,EAAgB0O,GACnD,IAAMg2B,EAAoB1kC,EAAeI,WAAWI,UAChDR,EAAeI,WAAWA,WAAWJ,EAAeI,WAAWK,WAC/D,KAEEkkC,EAAc3kC,EAAeI,WAAWI,UAC1CR,EAAeI,WAAWM,YAC1B,KAEJ,OAAOgkC,EACHh2B,IAAkBN,GAAeC,MAC/Bq2B,EAAkBv3D,GAAK,GACvBuhC,IAAkBN,GAAeE,MACjCq2B,EACkB,MAAhBA,EACED,EAAkBv3D,GAAK,GACP,MAAhBw3D,EACAD,EAAkBt3D,GAAK,IACtBs3D,EAAkBv3D,GAAK,IAAI+xB,OAAOwlC,EAAkBt3D,GAAK,KAC3Ds3D,EAAkBv3D,GAAK,IAAI+xB,OAAOwlC,EAAkBt3D,GAAK,IAC5D,GACF,GCqMKq3D,CAA4BzkC,EAAgB0O,KAClD,CAAC1O,EAAgB0O,IAEpB9qC,qBAAU,WACJigE,IACwB,SAAtBA,EACFlzB,EAAc7tC,SAAS,CACrBhB,KAAM,OACNC,QAAS,CAAEC,oBAAqB2hE,KAEH,SAAtBE,IACTlzB,EAAc7tC,SAAS,CACrBhB,KAAM,OACNC,QAAS,CAAEC,oBAAqB2hE,KAElCC,EAAyB,KAE3BE,EAAqB,SAEtB,CAACD,EAAmBF,EAAuBhzB,IAE9C,IAAMi0B,EAAoBzgE,uBACxB,SAACy+D,GACC,IAAME,EAASH,GACbC,EACAvO,EACA0P,EAAiBxjC,YACjBuiC,OAEF,GAAIA,EAAOj8D,OAAS,EAAG,CAErB,IAAM3E,EDxSe,SAAvB2iE,qBAAwB7kC,EAAgB8iC,EAAQliC,GAEpD,IAAI1+B,EAAa,GACjB,IAAK,IAAI6B,KAAOi8B,EAAeI,WAAWA,WAAY,CACpD,IAAI7Y,OAAK,EAAEkY,OAAW,EAClBqlC,GAAO,EACX,GACE9kC,EAAeI,WAAWA,WAAWr8B,GAAKoJ,GAC1C6yB,EAAeI,WAAWA,WAAWr8B,GAAKoJ,EAAErJ,MAAK,SAACihE,GAAD,OAC/CjC,EAAO9+D,SAAS+gE,MAElB,CACA7iE,EAAaA,EAAWg9B,OACtBc,EAAeI,WAAWA,WAAWr8B,GAAKoJ,GAE5C,IAAM2Q,EAASslD,GAAwBxiC,EAAa78B,GACpDwjB,EAAQzJ,EAAOyJ,MACfkY,EAAc3hB,EAAO2hB,YACrBqlC,GAAO,EAET,GACE9kC,EAAeI,WAAWA,WAAWr8B,GAAKqJ,GAC1C4yB,EAAeI,WAAWA,WAAWr8B,GAAKqJ,EAAEtJ,MAAK,SAACihE,GAAD,OAC/CjC,EAAO9+D,SAAS+gE,MAElB,CACA7iE,EAAaA,EAAWg9B,OACtBc,EAAeI,WAAWA,WAAWr8B,GAAKqJ,GAE5C,IAAM0Q,EAASslD,GAAwBxiC,EAAa78B,GACpDwjB,EAAQzJ,EAAOyJ,MACfkY,EAAc3hB,EAAO2hB,YACrBqlC,GAAO,EAQT,GANIv9C,IACFrlB,EAAWwB,KAAK6jB,EAAMjjB,SACF4lB,IAAhBuV,GACFv9B,EAAWwB,KAAK6jB,EAAM6X,OAAOK,GAAan7B,KAG1CwgE,EACF,MAGJ,OAAO5iE,EC4PkB2iE,CAAqB7kC,EAAgB8iC,EAAQ97D,GAChE48D,EAAyB1hE,GACzB4hE,EAAqB,aAGrBA,EAAqB,UAGzB,CAACC,EAAiBxjC,WAAYP,EAAgBh5B,EAAMqtD,IAGhD/hD,EAAcnO,uBAClB,SAACM,GACC++D,GAAQ,GACE,QAAN/+D,GACFg0D,EAAgB95B,EAAU93B,UAG9B,CAAC83B,EAAU93B,SAGP0tD,GAAapwD,uBAAY,SAAC+G,EAAOnH,EAAK60D,GAExC8K,EADE9K,EACgB,CAAEA,UAAS70D,OAEX,MAEpBy/D,GAAQ,KACP,IAEGwB,GAAc7gE,uBAAY,WAC9BgD,UAAUC,UAAU69D,WAAW/6D,MAAK,SAAC0uD,GACnC91D,EAAS,CAAEhB,KAAMmW,GAAc2gD,iBAEhC,CAAC91D,IAEEoiE,GAAe/gE,uBAAY,WAC3Bw6B,EAAU65B,IAAiB75B,EAAU65B,GAAcz0D,MACrD00D,EAAgB,GAChB31D,EAAS,CACPhB,KAAMqW,GACNpW,QAAS,CAAEgC,IAAK46B,EAAU65B,GAAcz0D,IAAKi8B,uBAGhD,CAACrB,EAAW65B,EAAcx4B,EAAgBl9B,IAEvC6gD,GAAmBx/C,uBAAY,WACnCgE,aAAY,UAAD,gBAAqBqwD,MAC/B,CAACA,IAEE5U,GAAmBz/C,uBAAY,WACnCiG,aAAmB,SAAD,OAAUouD,IAC5BluD,EAAMs4C,QAAQ,oCACb,CAACt4C,EAAOkuD,IAEL2M,GAAmBhhE,uBAAY,WAC/Bw6B,EAAU65B,KACCtxD,aAAoBy3B,EAAU65B,GAAcI,SAEvDtuD,EAAMs4C,QAAQ,+BAEdt4C,EAAM0rC,MAAM,2BAGf,CAAC1rC,EAAOkuD,EAAc75B,IAEnBymC,GAAwBjhE,uBAC5B,SAACJ,EAAK60D,GACJ91D,EAAS,CAAEhB,KAAMoW,GAAc0gD,UAAS70D,UAE1C,CAACjB,IAGGuiE,GAAyBlhE,uBAAY,WACzCsQ,EAAMvQ,KACJ,aAAC,GAAD,CACEipD,OAAQ,kBACN14C,EAAMkB,SAERijD,QAASj6B,EAAU65B,KAErB,CACEjzD,SAAU2K,EAAUE,WACpB+E,gBAAgB,EAChB5M,MAAO,IACPC,OAAQ,QAGX,CAACiM,EAAOkqB,EAAW65B,IAEtB,OACE,oBAAK3kD,IAAKwvD,GAAV,UACE,oBAAKxvD,IAAKwkD,GAAV,UACE,aAAC,GAAD,CAAYrjD,UAAW,aAAC,KAAD,IAAkBqsD,QAAQ,YAAjD,UACE,uBAAQv/D,KAAK,SAAS+R,IAAKyvD,GAAYv+D,QAASogE,GAAhD,UACE,aAAC,KAAD,IACA,qDAEF,uBAAQrjE,KAAK,SAAS+R,IAAKyvD,GAAYv+D,QAAS6+C,GAAhD,UACE,aAAC,KAAD,IACA,iDAEF,uBAAQ9hD,KAAK,SAAS+R,IAAKyvD,GAAYv+D,QAAS4+C,GAAhD,UACE,aAAC,KAAD,IACA,sDAIJ,aAAC,GAAD,CAAS3iC,MAAM,gBAAgBD,eAAe,OAA9C,SACE,uBAAQnV,UAAU,aAAa9J,KAAK,SAASiD,QAASigE,GAAtD,SACE,aAAC,KAAD,QAGJ,aAAC,GAAD,CAAShkD,MAAM,eAAeD,eAAe,OAA7C,SACE,uBAAQnV,UAAU,aAAa9J,KAAK,SAASiD,QAASwvD,GAAtD,SACE,aAAC,KAAD,QAGJ,aAAC,GAAD,CAASvzC,MAAM,kBAAkBD,eAAe,OAAhD,SACE,uBAAQnV,UAAU,aAAa9J,KAAK,SAASiD,QAASmgE,GAAtD,SACE,aAAC,KAAD,QAGJ,aAAC,GAAD,CACE/iD,WAAW,kBACXpB,eAAe,OACfhc,QAASsgE,GACTp/D,UAAW04B,GAAkC,IAArBA,EAAU93B,OAJpC,SAME,aAAC,KAAD,MAEF,4BACG83B,GACCA,EAAU93B,OAAS,GADpB,YAEM2xD,EAAe,GAFrB,cAE6B75B,EAAU93B,QAAU,UAGtD,oBAAKgN,IAAKykD,GAAV,UACE,aAAC,GAAD,CACEt8B,SAAU,kBAAC08B,GAAD,OAAgBD,EAAgBC,IAC1Cf,aAAca,EAFhB,SAIG75B,GAAaA,EAAU93B,OAAS,EAC/B83B,EAAUphB,KAAI,SAACo7C,EAAK71C,GAAN,OACZ,oBACElX,UAAU,SAEVG,cAAe,uBAACb,GAAD,OACbqpD,GAAWrpD,EAAOytD,EAAI50D,IAAK40D,EAAIC,UAEjCtzD,MAAO,CACLiM,iBAAkBuR,EAAQ,GAAK,IAAM,EAAI,UAAY,SAPzD,UAUE,oBAAKlX,UAAU,oBAAoBqH,IAAK6gD,EAAxC,SACE,aAACwR,GAAA,EAAD,CACEC,IAAKA,KACLjhE,GAAE,gBAAWwe,GACbva,MAAOA,EAAQ,EAAIA,EAAQ,IAC3BC,OAAQA,EAAS,EAAIA,EAAS,IAC9BowD,QAASD,EAAIC,QACbiJ,WAAY,oBAACjJ,GAAD,OACVwM,GAAsBzM,EAAI50D,IAAK60D,IAEjC4M,gBAAiBjB,EACjBkB,mBACEjB,GACAA,EAAyB39D,OAAS,EAC9B,MACA,UAEN6+D,qBAAsB,IACtBxjE,WACEsiE,GACAA,EAAyB39D,OAAS,EAC9B29D,EACAN,EAENyB,aAAcf,MAGlB,4BACE,aAAC,KAAD,CAAInyB,GAAIkmB,EAAIlmB,KADd,MACwBkmB,EAAIE,GAAG10C,QAAQ,QApClCw0C,EAAI50D,QAyCb,oBACEuB,MAAO,CAAEiD,MAAO,OAAQC,OAAQ,QAChCzD,QAASwvD,OAKf,aAAC,GAAD,CACEniD,KAAMA,EACNC,QAASC,EACTsvD,iBAAkB6B,UAObhC,UAAgBx/C,eAAKshD,gB,8BC7hB7B,IAAMqC,GACH,SADGA,GAEF,UAGPC,GAAuB,GAE3B,SAASC,aAAahoC,EAAiBnZ,EAASohD,EAAa3nC,GAC3D,IAAMtb,EAAQzgB,OAAOC,KAAKw7B,EAAgBnZ,GAASpR,QAAQirB,SAAS33B,OAC9D9C,EAAMq6B,GChBC,SAAS4nC,QAAQljD,GAM9B,IALA,IAAMmjD,EAAW,IAAIvyB,WAAW,GAE1BwyB,EADW,IAAIxyB,WAAW,GACTuyB,EAAW,EAE9BE,EAAc,GACXrjD,GAAS,GACdqjD,EAAcxiE,OAAOyiE,aAActjD,EAAQojD,EAAOD,GAAYE,EAC9DrjD,EAAQ9U,KAAK6e,MAAM/J,EAAQojD,GAAO,EAEpC,OAAOC,EDM6BE,CAAavjD,GAAO40B,cAExD,OADA5Z,EAAgBnZ,GAASpR,QAAQirB,QAAQz6B,GAAOgiE,EACzChiE,EAWF,SAASuiE,mBAAmBzlB,EAASttC,GAAU,IAC5CzL,EAAsByL,EAAtBzL,KAAMmb,EAAgB1P,EAAhB0P,GAAI0B,EAAYpR,EAAZoR,QAClB,OAAOk8B,EAAQl5B,QACb,SAACC,EAAKL,GACJ,GAC2B,IAAzBA,EAAMxE,KAAKyE,WACXD,EAAMxE,KAAK4B,UAAYA,IACtB4C,EAAMxE,KAAKiI,MACZ,CACA,IAAMzkB,E9E2RP,SAASggE,YAAYh/C,EAAOhU,GAAU,IACnCzL,EAAayL,EAAbzL,KAAMmb,EAAO1P,EAAP0P,GAD4B,EAErBsE,EAAMvgB,KAAnBmG,EAFkC,EAElCA,EAAOC,EAF2B,EAE/Bud,GAEL+E,EAAW2qB,aAAc,CAAEltC,IAAGC,KAAK,CAAEtF,OAAMmb,KAAI8U,SAAS,IACxD1P,EAAMm+C,aAAY,CAAEr5D,IAAGC,KAAK,CAAEtF,OAAMmb,OAAM7V,EAC1Ckb,EAAMm+C,aAAY,CAAEt5D,IAAGC,KAAK,CAAEtF,OAAMmb,OAAM7V,EAE1C4iB,EAASoqB,UAAU7yB,GAEzB,MAAO,CACLjjB,GAAIowC,aACJ6F,WAAYzyC,EAAOkoB,EACnBwqB,SAAUv3B,EAAK+M,EACfloB,OACAmb,KACAyM,WACArH,MACAC,O8E7SkBi+C,CAAYh/C,EAAO,CAAEzf,OAAMmb,OACzC2E,EAAIwxB,KAAO7yC,EAAMmpB,SACjB9H,EAAIoR,OAAOt1B,KAAX,aAAkBgjE,IAAKn/C,EAAMjjB,IAAOiC,IAEtC,OAAOqhB,IAET,CAAEoR,OAAQ,GAAIogB,IAAK,IAIvB,SAASutB,KAAK7oC,EAAiBnZ,QACIuF,IAA7B4T,EAAgBnZ,KAClBmZ,EAAgBnZ,GAAW,CACzBpR,QAAS,CACP6lC,IAAK,IACL0L,KAAM,KACNtmB,QAAS,IAEXxF,OAAQ,KAwFd,SAAS4tC,mBAAmB9oC,EAAiBnZ,GAAU,IAC7C6Z,EAAYV,EAAgBnZ,GAASpR,QAArCirB,QAcR,OAZan8B,OAAOonD,QAAQ3rB,EAAgBnZ,GAASqU,QAAQrR,QAC3D,SAACC,EAAKi5B,GAAa,IAAD,cACEA,EADF,GACTv8C,EADS,KACLw7C,EADK,KAMhB,OAJAl4B,EAAItjB,GAAJ,2BACKw7C,GArBX,SAAS+mB,aAAa/mB,EAAKthB,GACzB,OAAOn8B,OAAOC,KAAKk8B,GAAS7W,QAAO,SAACC,EAAK7jB,GASvC,OARIy6B,EAAQz6B,GAAKjC,OAAS8jE,KACxBh+C,EAAI7jB,GAAJ,yBACEu6B,OAAQv6B,GACL+7C,GAFL,IAGE39C,MAAO2kE,UAAUtoC,EAASshB,EAAKthB,EAAQz6B,GAAKgjE,YAIzCn/C,IACN,IAWMi/C,CAAa/mB,EAAKthB,IAEhB5W,IAET,IAMG,SAASo/C,eAAenmB,EAAS/iB,EAAiBvqB,GAAU,IACzDzL,EAAwCyL,EAAxCzL,KAAMmb,EAAkC1P,EAAlC0P,GAAI0B,EAA8BpR,EAA9BoR,QAD8C,EAChBpR,EAArB6qB,iBADqC,MACzB,KADyB,EAEhEuoC,KAAK7oC,EAAiBnZ,GACtB,IAAM2Z,EAASwnC,aACbhoC,EACAnZ,EACA,CACE7iB,KAAM8jE,GACNqB,SAAU,WACVn/D,OACAmb,KACAH,MAAO,GAETsb,GAGMgb,EAAQtb,EAAgBnZ,GAASpR,QAAjC6lC,IAhBwD,EAkBpBktB,mBAAmBzlB,EAAS,CACtE/4C,OACAmb,KACA0B,YAHc7G,EAlBgD,EAkBxDkb,OAAqBkuC,EAlBmC,EAkBxC9tB,IAMlB+tB,EAAkB7hD,IAAUwY,EAAD,UAAqBnZ,EAArB,WAAuC,IAEpE3d,EAAO8W,EAAO6J,QAAO,SAACC,EAAKk4B,GAC7B,IAAM5I,EAASgwB,EAAa,EAAI9tB,EAAM8tB,EAAa,EAUnD,OARAt/C,EAAIk4B,EAAI4mB,KAAR,2BACKS,EAAgBrnB,EAAI4mB,MADzB,mBAEGpoC,EAFH,yBAGIA,UACGwhB,GAJP,IAKIsnB,SAAUp5D,KAAKC,IAAI6xC,EAAIpwB,UAAYwnB,MAGhCtvB,IACN,IAEHkW,EAAgBnZ,GAASqU,OAAShyB,EAClC82B,EAAgBnZ,GAASqU,OAAS4tC,mBAChC9oC,EACAnZ,GA6BJ,SAASmiD,UAAUtoC,EAASx3B,GAAwB,IAAD,EAAjB+/D,EAAiB,uDAAP,MACpC5/B,EAAQ4/B,EAAQ99C,MAAM,sBAEtBo+C,EAAY,GAH+B,eAKnClgC,GALmC,IAKjD,2BAAqB,CAAC,IAAbvgC,EAAY,QACb0gE,EAAI1gE,EAAE6zB,OACR+D,EAAQ8oC,IACVD,EAAU3jE,KAAK4jE,IAR8B,8BAYjD,IAIIxpD,EAJEy+C,EAAS8K,EAAU9pD,KAAI,SAACxZ,GAAD,OAC3BiD,EAAKjD,GAAOiD,EAAKjD,GAAKy6B,EAAQz6B,GAAKkjE,UAAY,QAIjD,IAEEnpD,EAAS,aAAIypD,SAAYF,EAAhB,yBAAqCN,MAArC,0BAAmDxK,IAC5D,MAAO93D,GAEP+E,QAAQC,IAAIhF,GACZqZ,EAAS,IAAItb,MAAJ,4BAA+BukE,EAA/B,QAEX,OAAOjpD,EEnQT,I,GAAM0pD,GAAa,CACjB,KAAM,CACJC,IAAK,CACH3/D,MAAO,GACPmb,GAAI,GACJykD,QAAS,EACTjrC,MAAO,GAETkrC,IAAK,CACH7/D,MAAO,GACPmb,GAAI,GACJykD,QAAS,EACTjrC,MAAO,GAETmrC,QAAS,CACP9/D,KAAM,KACNmb,GAAI,KACJykD,QAAS,EACTjrC,MAAO,OAGX,MAAO,ICRT,IAAMxrB,GAAS4C,YAAH,q2EAyHNg0D,GAAW,CAAC,CAAE9jE,IAAK,EAAG5B,MAAO,SAAUkuB,MAAO,WAoGrCy3C,I,GAAAA,GAlGf,SAASA,kBAAT,GAAkD,IAArBz1D,EAAoB,EAApBA,QAASsS,EAAW,EAAXA,QAC9B0oC,EAAUn6C,mBACVpQ,EAAW6M,cACXo4D,EAAO/kE,mBAAQ,WACnB,IAAMglE,EAAOR,GAAW7iD,GACpBtiB,OAAOonD,QAAQ+d,GAAW7iD,IAAUpH,KAClC,SAAC6pB,GAAD,MAAW,CACTrjC,IAAKqjC,EAAK,GACVjlC,MAAOilC,EAAK,GACZ/W,MAAO+W,EAAK,MAEd,IAEF,GAEJ,OAAOygC,GAAS3oC,OAAO8oC,KACtB,CAACrjD,IACE2oC,EAAanpD,uBAAY,WAC7BkpD,EAAQ14C,QAAQ44C,eACf,IAEGC,EAAgBrpD,uBACpB,SAAC60B,GACCl2B,EAAS,CAAEhB,KAAM8Z,GAAe7Z,QAASi3B,IACzC3mB,MAEF,CAACvP,EAAUuP,IAGbzO,qBAAU,WAMR,OALA8iC,GAAO/T,GAAG,YAAY,SAACznB,GAAW,IAAD,cACZA,EAAM3E,MADM,GACxBuB,EADwB,KAClBmb,EADkB,KAE/BoqC,EAAQ14C,QAAQszD,UAAhB,2BAA+B5a,EAAQ14C,QAAQqkB,QAA/C,IAAuDlxB,OAAMmb,WAGxD,WACLyjB,GAAO7T,IAAI,eAEZ,IAEH,IAAMq1C,EAAsB/jE,uBAC1B,SAACG,GACC,IADM,EACQkjE,GAAW7iD,GAASrgB,IACW,CAAEm4B,MAAO,GAFhD,IAEEA,aAFF,MAEU,EAFV,EAEgBgxB,EAFhB,0BAGNJ,EAAQ14C,QAAQszD,UAAhB,2BACK5a,EAAQ14C,QAAQqkB,QADrB,IAEEmvC,QAAS1rC,GACNgxB,MAGP,CAAC9oC,IAGH,OACE,oBAAK9Q,IAAK5C,GAAV,UACE,oBAAKrF,UAAU,gBAAf,UACE,sDACA,aAAC,GAAD,CAAa7G,QAASsN,EAASzG,UAAU,gBAE3C,oBAAKA,UAAU,gBAAf,SACE,aAAC,GAAD,CACEqH,IAAKo6C,EACL3G,cAAe,CAAE5+C,MAAO,EAAGmb,GAAI,EAAGykD,QAAS,EAAGS,QAAS,GACvDxhB,SAAU6G,EAHZ,UAKE,oBAAK5hD,UAAU,gBAAf,UACE,qBAAMA,UAAU,eAAhB,uBAEA,aAAC,GAAD,CACE5E,KAAM+gE,EACNziE,MAAO,CAAEiD,MAAO,IAAKC,OAAQ,GAAIuhC,aAAc,QAC/C/N,SAAUksC,OAGd,oBAAKt8D,UAAU,gBAAf,UACE,qBAAMA,UAAU,eAAhB,qBACA,aAAC,GAAD,CAAaykB,MAAM,UAAUvT,KAAK,OAAOhb,KAAK,WAC9C,aAAC,GAAD,CAAauuB,MAAM,OAAOvT,KAAK,KAAKhb,KAAK,cAE3C,oBAAK8J,UAAU,gBAAf,UACE,qBAAMA,UAAU,eAAhB,gCACA,aAAC,GAAD,CAAakR,KAAK,UAAUhb,KAAK,cAEnC,oBAAK8J,UAAU,gBAAf,UACE,qBAAMA,UAAU,eAAhB,0BACA,aAAC,GAAD,CAAakR,KAAK,UAAUhb,KAAK,mBAIvC,oBAAK8J,UAAU,mBAAf,SACE,uBAAQ9J,KAAK,SAASiD,QAASuoD,EAAY1hD,UAAU,cAArD,wB,yDChOOiI,eAAf,4mFCFe,SAASizD,mBAAUhiB,GAAoB,IAAdsjB,EAAa,uDAAN,KAC7C,IAEE,OAAO,IAAIb,SAAS,OAAb,iBAA+BziB,GAA/B,CAAuCsjB,GAC9C,MAAO3jE,GACP,OAAOA,GCeX,SAAS4jE,0BAAT,GAA8C,IAATrhE,EAAQ,EAARA,KAAQ,EACTmkD,eAA1BnyB,EADmC,EACnCA,OAAQoyB,EAD2B,EAC3BA,cAD2B,EAEnBl/C,mBAAS8sB,EAAO8rB,KAAO9rB,EAAO8rB,KAT1C,uFAO+B,mBAEpCA,EAFoC,KAE9BwjB,EAF8B,OAGfp8D,mBAAS,IAHM,mBAGpC4R,EAHoC,KAG5ByqD,EAH4B,KAK3C3kE,qBAAU,WACR,IAAM4kE,EAAaC,mBAAK3jB,EAAM99C,GAC1BwhE,aAAsBhmE,MACxB+lE,EAAUC,EAAWt0D,UAErBk3C,EAAc,OAAQtG,GACtByjB,EAAUC,MAEX,CAAC1jB,EAAM99C,EAAMokD,IAEhB,IAAMsd,EAAqBvkE,uBAAY,SAAC2gD,GACtCwjB,EAAQxjB,KACP,IACG6jB,EAAmBxkE,uBAAY,SAAC2gD,GACpC,IACE,OAAOjiD,qBAAUiiD,EAAM8jB,aAAUC,IACjC,MAAOpkE,GACP,OAAO,QAER,IAEH,OACE,oBAAKa,MAAO,CAAEonD,UAAW,QAAU74C,IAAKi1D,GAAxC,UACE,aAAC,KAAD,CACE3mE,MAAO2iD,EACPikB,cAAeL,EACf7lE,UAAW8lE,EACXnoD,QAAS,GACTlb,MAAO,CACLsb,WAAY,sCACZD,SAAU,GACVpP,gBAAiB,UACjBw4B,aAAc,OACd93B,UAAW,QACXyB,SAAU,OACV8/C,UAAW,WAGf,kBAAGluD,MAAO,CAAEykC,aAAc,OAA1B,qBAEA,aAAC,KAAD,CACE5nC,MAAO2b,EACPirD,cAAe,uBAACjkB,GAAD,OAAUA,GACzBjiD,UAAW8lE,EACXnoD,QAAS,GACTlb,MAAO,CACLw2B,OAAQ,uBACRlb,WAAY,sCACZD,SAAU,GACVopB,aAAc,OACd93B,UAAW,QACXyB,SAAU,OACV8/C,UAAW,cAONvxC,I,GAAAA,kBAAKomD,2BC9Ddp3D,GAAS4C,YAAH,yxBAkDNm1D,GAAqC/qC,sBACzC,SAAS+qC,mCAAT,EAAmE/1D,GAAM,IAA3BjM,EAA0B,EAA1BA,KAAMiiE,EAAoB,EAApBA,YAC5CnmE,EAAW6M,cACX09C,EAAUn6C,mBAFsD,EAGxChH,mBAAS,IAH+B,mBAG/DsyB,EAH+D,KAGtD0qC,EAHsD,KAKtEtO,8BAAoB3nD,GAAK,iBAAO,CAC9BssD,YAD8B,uBAE5BlS,EAAQ14C,QAAQ44C,kBAIpB3pD,qBAAU,WACR,IAAMka,EAASzb,OAAOC,KAAK0E,EAAKw3B,SAAS7W,QAAO,SAACC,EAAK7jB,GAEpD,OADA6jB,EAAI7jB,GAAJ,2BAAgBiD,EAAKw3B,QAAQz6B,IAA7B,IAAmColE,QAASplE,IACrC6jB,IACN,IACHshD,EAAWprD,GACXuvC,EAAQ14C,QAAQszD,UAAU,CAAEzpC,QAAS1gB,EAAQgnC,KAAM99C,EAAK89C,SACvD,CAAC99C,IAEJ,IAAMoiE,EAAcpmE,mBAAQ,WAC1B,OAAOX,OAAOC,KAAKk8B,KAClB,CAACA,IAEE6qC,EAAmBrmE,mBAAQ,WA4B/B,OAAOsmE,OAAaz5B,MAAM,CACxBrR,QAAS8qC,OAAaz5B,MA5BxB,SAAS05B,eACP,OAAOH,EAAYzhD,QAAO,SAACC,EAAK7jB,GAoB9B,OAnBA6jB,EAAI7jB,GAAOulE,OAAaz5B,MAAb,yBACTs5B,QAASG,OACNE,WACAvd,KAAK,SAAU,8BAA8B,SAACwd,GAC7C,IAAM3J,EAAWzS,EAAQ14C,QAAQqkB,OAAOwF,QACxC,OAMoB,IALlBn8B,OAAOC,KAAKw9D,GAAUn4C,QAAO,SAACC,EAAK0W,GAIjC,OAHIwhC,EAASxhC,GAAQ6qC,UAAYM,GAC/B7hD,EAAIlkB,KAAK+lE,GAEJ7hD,IACN,IAAI/gB,WAGT23B,EAAQz6B,GAAKjC,OAAS8jE,GACtB,CAAEmB,QAASuC,OAAaE,YACxB,IAhBK,IAiBT1mD,MAAOwmD,OAAaE,cAEf5hD,IACN,IAMyB2hD,QAE7B,CAAC/qC,EAAS4qC,EAAa/b,IAEpBG,EAAgBrpD,uBACpB,SAAC60B,GACCiwC,GAAY,GACZ,IAAMnrD,EAASzb,OAAOonD,QAAQzwB,EAAOwF,SAAS7W,QAC5C,SAACC,EAAD,GAAwB,IAAD,mBAAhB7jB,EAAgB,KAAX5B,EAAW,KAErB,OADAylB,EAAI7jB,GAAJ,2BAAgBy6B,EAAQz6B,IAAS5B,GAC1BylB,IAET,IAEF9kB,EAAS,CACPhB,KAAM4Z,GACN3Z,QAAS,CAAE+iD,KAAM9rB,EAAO8rB,KAAMtmB,QAAS1gB,OAG3C,CAAC0gB,EAAS17B,EAAUmmE,IAGhBS,EAAevlE,uBAAY,SAAC2e,GAChComD,GAAW,SAACS,GACV,OAAO,2BACFA,GADL,iCAEU7mD,GAAU,CAChBqmD,QAAS,GACTrnE,KAAM,UACNmlE,SAAU,QACVF,QAAS,GACTjkD,MAAOA,UAIZ,IAEH,OACE,aAAC,GAAD,CACE7P,IAAKo6C,EACL3G,cAAe,CAAEloB,UAASsmB,KAAM,MAChC8B,iBAAkByiB,EAClB1iB,SAAU6G,EAJZ,UAMG4b,GACC,sBAAOv1D,IAAK5C,GAAZ,UACE,+BACE,6BACE,mBAAIrF,UAAU,UAAd,eACA,mBAAIA,UAAU,QAAd,mBACA,sCACA,mBAAIA,UAAU,QAAd,wBAGJ,+BACGw9D,EAAY7rD,KAAI,SAACxZ,EAAK+e,GACrB,OACE,6BACE,mBAAIlX,UAAU,UAAd,SAAyBkX,EAAQ,IACjC,mBAAIlX,UAAU,QAAd,SACE,aAAC,GAAD,CAEEkR,KAAI,kBAAa/Y,EAAb,YACJ5B,MAAOq8B,EAAQz6B,GAAKolE,SAFfplE,KAKT,4BACGy6B,EAAQz6B,GAAKjC,OAAS8jE,GACrB,aAAC,GAAD,CACE9oD,KAAI,kBAAa/Y,EAAb,YACJ5B,MAAOq8B,EAAQz6B,GAAKgjE,UAGtB,oBAAKn7D,UAAU,oBAGnB,mBAAIA,UAAU,QAAd,SACE,aAAC,GAAD,CACEkR,KAAI,kBAAa/Y,EAAb,UACJ5B,MAAOq8B,EAAQz6B,GAAK+e,UAGxB,mBAAIlX,UAAU,gBAAd,SACGw9D,EAAYviE,SAAWic,EAAQ,GAC9B,uBACElX,UAAU,MACV9J,KAAK,SACLiD,QAAS,0BAAM2kE,EAAa5mD,EAAQ,IAHtC,SAKE,aAAC,KAAD,UAhCC/e,WA0CnB,aAAC,GAAD,CAA2BiD,KAAMA,UAMzCgiE,GAAmCl6D,aAAe,CAChDm6D,YAAa,8BAAM,IAEND,I,GAAAA,MCvOT/3D,GAAS4C,YAAH,moBA+CG+1D,I,GAAAA,GAdf,SAASA,aAAT,GAAgD,IAAD,IAAvB5iE,YAAuB,MAAhB,GAAgB,EAAZ6iE,EAAY,EAAZA,SACjC,OACE,oBAAKh2D,IAAK5C,GAAV,SACE,4BACGjK,EAAKuW,KAAI,SAAC6pB,EAAMxgC,GAAP,OACR,mBAAmB7B,QAAS,0BAAM8kE,EAASjjE,IAA3C,SACGwgC,EAAK/W,OADC+W,EAAKrjC,aChClBkN,GAAS4C,YAAH,sPAcZ,SAASi2D,eAAT,GAA+E,IAArD9iE,EAAoD,EAApDA,KAAM+iE,EAA8C,EAA9CA,YAAaF,EAAiC,EAAjCA,SAAUG,EAAuB,EAAvBA,oBAAuB,EACpD99D,oBAAS,GAD2C,mBACrEkG,EADqE,KAC/DoxD,EAD+D,OAElDt3D,mBAAS69D,GAFyC,mBAErE5nE,EAFqE,KAE9D6iB,EAF8D,KAGpEk2C,EAAY36C,YAAZ26C,QAEF+O,EAAO/2D,iBAAO,MACd4qD,EAAc35D,uBAClB,SAACM,IACMA,EAAE0xB,OAAO+zC,QAAT,WAAqBD,EAAKt1D,QAAQ/I,aAAgBwG,GACrD8N,YAAW,WACTsjD,GAAQ,KACP,KAGP,CAACpxD,IAEHxO,qBAAU,WAIR,OAHIs3D,GACFA,EAAQ1lD,iBAAiB,QAASsoD,GAE7B,kBAAM5C,EAAQzlD,oBAAoB,QAASqoD,MACjD,CAACA,EAAa1rD,EAAM8oD,IAEvB,IAAMiP,EAAgBhmE,uBACpB,SAAC2e,GACCkC,EAAShe,EAAK8b,GAAOuN,OACrBw5C,EAAS7iE,EAAK8b,GAAO/e,OAEvB,CAACiD,EAAM6iE,IAGT,OACE,oBAAKj+D,UAAU,WAAWqH,IAAKg3D,EAAMp2D,IAAK5C,GAA1C,UACE,uBAAQnP,KAAK,SAASiD,QAAS,0BAAMy+D,GAAQ,SAACpxD,GAAD,OAAWA,MAAxD,SACIjQ,EAA0B6nE,EAAoB7nE,GAAtC,aAAC,KAAD,MAEXiQ,GAAQ,aAAC,GAAD,CAAcpL,KAAMA,EAAM6iE,SAAUM,OAKnDL,eAAeh7D,aAAe,CAC5B9H,KAAM,KACNgjE,oBAAqB,6BAACl7C,GAAD,OAASA,GAC9B3sB,MAAO,MAGM2nE,I,GAAAA,kBC5DT74D,GAAS,gBAACA,GAAD,OAAY4C,YAAX,QAAD,8hBAgCX5C,IAGEm5D,GAAiB,CACrB,CAAErmE,IAAK,WAAYssB,MAAO,YAC1B,CAAEtsB,IAAK,WAAYssB,MAAO,YAC1B,CAAEtsB,IAAK,MAAOssB,MAAO,iBACrB,CAAEtsB,IAAK,MAAOssB,MAAO,kBAmCRg6C,OAhCf,SAASA,aAAT,GAAwE,IAAhDC,EAA+C,EAA/CA,UAAWC,EAAoC,EAApCA,WAAYvjE,EAAwB,EAAxBA,KAAMwjE,EAAkB,EAAlBA,eAC7C1nE,EAAW6M,cAEX0uB,EAAgBl6B,uBAAY,WAChCrB,EAAS,CAAEhB,KAAM0Z,GAA8B8iB,OAAQgsC,MACtD,CAACA,EAAWxnE,IAEf,OACE,oBAAK+Q,IAAK5C,GAAV,UACE,oBAAKrF,UAAU,YAAf,UACG5E,EAAKlF,OAAS8jE,IACb,oBAAKh6D,UAAU,qBAAf,SACE,aAAC,GAAD,CACE5E,KAAMojE,GACNJ,oBAAqB,6BAAC7nE,GAAD,OACnBA,EAAQA,EAAM8a,OAAO,EAAG,GAAK9a,GAE/B4nE,YAAa/iE,EAAKigE,SAClB4C,SAAUW,MAIhB,oBAAK5+D,UAAU,kBAAf,UACE,qBAAMA,UAAU,QAAhB,cAA0B0+D,KAC1B,qBAAM1+D,UAAU,QAAhB,SAAyB2+D,UAG7B,aAAC,GAAD,CAAct3C,SAAUoL,QCnE9B,SAASosC,6BAAT,GAA4D,IAApBzjE,EAAmB,EAAnBA,KAChCszB,EAASX,yBAD0C,EAAblS,WAGtCijD,EAAiB1nE,mBAAQ,WAE7B,OAAOylE,mBADMnjD,IAAUte,EAAM,OAAQ,IACnBA,KACjB,CAACA,IAEElE,EAAW6M,cAEXg7D,EAAsBxmE,uBAC1B,SAACi6B,EAAW6oC,GACVnkE,EAAS,CACPhB,KAAM6Z,GACN5Z,QAAS,CACPq8B,YACA6oC,gBAIN,CAACnkE,IAGGg6D,EAAe95D,mBAAQ,WAC3B,IAAM4nE,EAAc,CAClB,CACElY,OAAQ,IACR5vC,MAAO,EACPm0C,KAAM,0BAAGnX,IAAch9B,MAAQ,KAI7B0b,EAAUosC,EAwChB,OAhBI5jE,EAAKw3B,SACPn8B,OAAOC,KAAK0E,EAAKw3B,SAAS3zB,SAAQ,SAAC9G,GAAS,IAAD,EACAiD,EAAKw3B,QAAQz6B,GAA9CkjE,EADiC,EACjCA,SAAiB4D,EADgB,EACvB/nD,OAzBE,SAAlBi6C,gBAAmB51B,EAAOrkB,EAAOk6C,EAAaC,GAClD,IAAM6N,EAAa9jE,EAAKw3B,QAAQw+B,GAChC71B,EAAMzjC,KAAK,CACTof,MAAOA,EACP4vC,OAAQ,yBACN,cAAC,GAAD,CACE4X,UAAWtN,EACXh2D,KAAM8jE,EACNN,eAAgB,wBAACvD,GAAD,OACd0D,EAAoB3N,EAAaiK,IAEnCsD,WACEO,EAAWhjE,MAAQgjE,EAAW7nD,GAA9B,UACOqX,EAAOwwC,EAAWhjE,MADzB,cACoCwyB,EAAOwwC,EAAW7nD,KAClD,MAIV3e,GAAI04D,EACJhG,SAAU,QACVC,KAAM,qBAAGnX,EAAH,EAAGA,IAAH,OAAamd,EAAYnd,MAM/Bid,CAAgBv+B,EAASqsC,EAAc,EAAG9mE,GAAK,SAAC+7C,GAC9C,IAAM39C,EAAQ29C,EAAI9G,SAASj1C,GAAKkjE,GAOhC,OALE9kE,aAAiBK,MACf,sBAAM8C,MAAO,CAAEmb,MAAO,OAAtB,SAAgCte,EAAM+R,UAEtComB,EAAOn4B,UAMKq8B,GAAoBosC,GACrBtuC,MACnB,SAAC+gC,EAASC,GAAV,OAAsBD,EAAQv6C,MAAQw6C,EAAQx6C,WAE/C,CAAC6nD,EAAqB3jE,EAAKw3B,QAASlE,IAEvC,OAAOtzB,EAAKgyB,QAAUhyB,EAAKgyB,OAAOnyB,OAAS,EACzC,eAAC,WAAD,WACE,cAAC,GAAD,CAAYG,KAAMA,EAAKgyB,OAAQwF,QAASs+B,IACxC,qBACEx3D,MAAO,CACLiD,MAAO,OACPiY,QAAS,QAGX6hD,wBAAyB,CAAEC,OAAQoI,QAIvC,cAAC,GAAD,IAIWzoD,sBAAKwoD,8BCnFdx5D,GAAS,CACb/L,UAAW,CACTsM,QAAS,OACTO,cAAe,SACfvJ,OAAQ,QAEV8D,OAAQ,CACNiF,gBAAiB,cACjBuqB,OAAQ,SAIZ,SAASivC,6BAAT,GAAuE,IAA/BjtC,EAA8B,EAA9BA,gBAAiBrW,EAAa,EAAbA,UAAa,EACjCvb,oBAAS,GADwB,mBAC7Dq0D,EAD6D,KAClDC,EADkD,KAE9DC,EAAavtD,mBACb5I,EAAQ+3C,KACR5tC,EAAQzD,IACRlO,EAAW6M,cAEX3I,EAAOhE,mBAAQ,WAAO,IAAD,EAIrB86B,EAAgBrW,IAAc,CAChCuR,OAAQ,GACRzlB,QAAS,CAAEirB,QAAS,GAAIsmB,KAAM,OAJ9B9rB,EAFuB,EAEvBA,OAFuB,IAGvBzlB,QAAWirB,EAHY,EAGZA,QAASsmB,EAHG,EAGHA,KAKtB,MAAO,CAAE9rB,OAAQ32B,OAAO22B,OAAOA,GAASwF,UAASsmB,UAChD,CAACr9B,EAAWqW,IAET+iC,EAAuB18D,uBAAY,WACvCq8D,GAAeD,KACd,CAACA,IAEEO,EAAqB38D,uBAAY,WACrCs8D,EAAW9rD,QAAQ4qD,gBAClB,IAEGyL,EAAmB7mE,uBAAY,WACnCq8D,GAAc,KACb,IAEGyK,EAAqB9mE,uBAAY,SAAC4lB,GACtC2c,GAAO5T,KAAK,uBAAwB/I,KACnC,IACGmhD,EAAmB/mE,uBAAY,WACnCrB,EAAS,CAAEhB,KAAM+X,KACjBpF,EAAMvQ,KAAK,cAAC,GAAD,CAAmBygB,QAAS8C,IAAe,CACpDvS,kBAAkB,EAClB3P,SAAU2K,EAAUE,WAEpB7H,MAAO,QAGR,CAACkf,EAAWhT,EAAO3R,IAEhBqoE,EAAyBhnE,uBAAY,WACzC,IAAM6C,EZqLH,SAASokE,gBAAgBttC,EAAiBnZ,GAC/C,GAAImZ,GAAmBA,EAAgBnZ,GAAU,CAAC,IAAD,EAI3CmZ,EAAgBnZ,GAFlBqU,EAF6C,EAE7CA,OACWwF,EAHkC,EAG7CjrB,QAAWirB,QAGT1gB,EAAS,GAEb,IAAK,IAAMutD,KAAU7sC,EACnB1gB,GAAM,UAAOutD,EAAP,MAERvtD,GAAU,KAEV,cAAuBzb,OAAO22B,OAAOA,GAArC,eAA8C,CAAzC,IAAMF,EAAQ,KACjB,IAAK,IAAMuyC,KAAU7sC,EACnB1gB,GAAM,UAAOgb,EAASuyC,GAAQ7sC,EAAQ6sC,GAAQpE,UAAxC,MAERnpD,GAAU,KAEZ,OAAOA,EAET,OAAO,KY3MQstD,CAAgBttC,EAAiBrW,GAC9BvgB,aAAoBF,GAElCsD,EAAMs4C,QAAQ,4BAEdt4C,EAAM0rC,MAAM,8BAEb,CAACvuB,EAAWnd,EAAOwzB,IAEtB,OACE,sBAAKx4B,MAAO2L,GAAO/L,UAAnB,WACIq7D,GACA,eAAC,GAAD,CACE1G,cAAc,mBACdM,kBAAkB,OAClBzU,WAAW,EACXwU,eAAgB2G,EAJlB,UAME,cAAC,GAAD,CACE1+C,WAAW,oBACX7c,MAAO2L,GAAO3E,OACdvH,QAASomE,EAHX,SAKE,cAAC,KAAD,MAEF,cAAC,GAAD,CACEhpD,WAAW,sBACX7c,MAAO2L,GAAO3E,OACdvH,QAASmmE,EAHX,SAKE,cAAC,KAAD,CAAe5lE,MAAO,CAAEqb,SAAU,YAEpC,cAAC,GAAD,CACEwB,WAAW,oBACXpB,eAAe,QACfhc,QAASkmE,EAHX,SAKE,cAAC,KAAD,SAIL1K,GACC,cAAC,GAAD,CACEpT,OAAQ2T,EACRzuD,QAASwuD,IAGb,qBAAKv7D,MAAO,CAAEkD,OAAQ,OAAQkL,SAAU,QAAxC,SACE,eAAC,KAAD,CACE6sD,UAAWA,EACXU,UAAQ,EACRttD,eAAgB,CAAED,SAAU,UAH9B,UAKE,cAAC,GAAD,CAA8B1M,KAAMA,EAAMygB,UAAWA,IACrD,cAAC,GAAD,CACEzgB,KAAMA,EACNiiE,YAAa+B,EACb/3D,IAAKwtD,YAQF7iC,UAAqB3b,eAAK8oD,+BCvF1BO,OArDf,SAASA,aAAaztC,GACpB,IAAMvqB,EAAU,SAAVA,QAAW3Q,GAAW,IAAD,EAOrB6M,eALIqxC,EAFiB,EAEvB75C,KACAsb,EAHuB,EAGvBA,eACAoH,EAJuB,EAIvBA,QACAjC,EALuB,EAKvBA,UACAuB,EANuB,EAMvBA,kBAEI2O,EAAc7nB,iBARK,EAUoB9M,mBAAQ,WACnD,OAAI69C,GAAWv+B,GAAkBA,EAAehe,GAChCu8C,EAAQjiB,MACpB,SAACrX,GAAD,OAAWA,EAAMjjB,KAAOge,EAAehe,OACpC,CACHi4B,MAAO,GACPxZ,KAAM,GACN/b,KAAM,IAIH,KACN,CAACsb,EAAgBu+B,IAtBK,IAUjBtkB,aAViB,MAUT,GAVS,MAULxZ,YAVK,MAUE,GAVF,MAUM/b,YAVN,MAUa,GAVb,EAwBnB2d,EAAU3hB,mBAAQ,WACtB,OAAIgmB,GAAqB3mB,OAAOC,KAAK0mB,GAAmBniB,OAAS,EACxDxE,OAAOC,KAAK0mB,GAEd,OACN,CAACA,IAEI+U,EAA0Bp7B,EAA1Bo7B,aAAiBC,EA/BA,aA+BSr7B,EA/BT,kBAiCzB,OACE,cAACk7B,EAAD,2BACMG,GADN,IAEEzB,MAAOA,EACPxZ,KAAMA,EACN5V,EAAGnG,EAAKmG,EACRC,EAAGpG,EAAKoG,EACRsc,QAASA,EACTiO,YAAaA,EACblQ,UAAWA,EACX9C,QAASA,EACT1R,IAAK8qB,MAIX,OAAOE,sBAAW,SAACt7B,EAAOsQ,GACxB,OAAO,cAACK,EAAD,2BAAa3Q,GAAb,IAAoBo7B,aAAc9qB,SCjCvChC,GAAS,CACb/L,UAAW,CAAEsb,QAAS,GAAIjP,gBAAiB,UAAW/I,OAAQ,QAC9Dm2D,eAAgB,CACdn+C,QAAS,MACTtO,aAAc,MACd6D,OAAQ,WACRxE,gBAAiB,SAEnBuuC,IAAK,CACHtuC,QAAS,OACTuE,OAAQ,WAEV8rC,OAAQ,CACN/X,aAAc,oBACd80B,cAAe,MACfpnC,WAAY,OACZ/W,MAAO,WAETy9C,WAAY,CACV7pD,KAAM,EACNsM,SAAU,OACV6W,WAAY,OACZ/W,MAAO,WAET0rC,MAAO,CACL5jD,MAAO,MACP0qC,UAAW,WAIT4rB,GAAe,CACnB,CACEv6D,GAAI,EACJ+rB,MAAO,gBACPyuC,gBAAiB,iBACjBC,iBAAkB,mBAClBC,cAAe,IAEjB,CACE16D,GAAI,EACJ+rB,MAAO,gBACPyuC,gBAAiB,gBACjBC,iBAAkB,kBAClBC,cAAe,IAEjB,CACE16D,GAAI,EACJ+rB,MAAO,iBACPyuC,gBAAiB,eACjBC,iBAAkB,iBAClBC,cAAe,SAEjB,CACE16D,GAAI,EACJ+rB,MAAO,gBACPyuC,gBAAiB,cACjBC,iBAAkB,gBAClBC,cAAe,SAEjB,CACE16D,GAAI,EACJ+rB,MAAO,aACPyuC,gBAAiB,gBACjBC,iBAAkB,kBAClBC,cAAe,WAEjB,CACE16D,GAAI,EACJ+rB,MAAO,cACPyuC,gBAAiB,gBACjBC,iBAAkB,kBAClBC,cAAe,UAInB,SAASuM,iBAAT,EAAoDt4D,GAAM,IAA9B0R,EAA6B,EAA7BA,QAASgT,EAAoB,EAApBA,YAC7BrtB,EAAQ+3C,KADyC,EAE3Bz9B,yBAAyB,wBAA5CwoC,EAF8C,sBAGxBlhD,mBAAS,MAHe,mBAGhDuZ,EAHgD,KAGtCy5C,EAHsC,KAIjDC,EAAUjsD,mBAEhBtP,qBAAU,WACR,IAAM4nE,EAAmBpM,GACvBznC,EADwC,2BAItC6zC,GACFtM,EAAWsM,KAEZ,CAAC7zC,IAEJ,IAAM2/B,EAAcnzD,uBAClB,SAAC60B,GAAiC,IAAzBsmC,EAAwB,wDAC/B3nC,EAAY70B,SAAS,CACnBhB,KAAMklD,GACNjlD,QAAS,CAAEgC,IAAK,QAAS5B,MAAO62B,KAE9BsmC,GAAah1D,EAAMs4C,QAAQ,0CAEjC,CAACt4C,EAAOqtB,IAGVijC,8BAAoB3nD,GAAK,iBAAO,CAC9BssD,YAD8B,uBAEiB,oBAAlCJ,EAAQxqD,QAAQ6qD,cACzBL,EAAQxqD,QAAQ6qD,gBAEhBL,EAAQxqD,QAAQ8qD,cACd,IAAIC,MAAM,SAAU,CAAEC,YAAY,UAM1C,IAAMC,EAAez7D,uBACnB,SAAC+G,GACCA,EAAMxG,iBACN,IAFS,EAEHm7D,EAAO30D,EAAMirB,OACb2pC,EAAW,IAAIC,SAASF,GAC1B7mC,EAAS,GAJJ,eAKS8mC,EAASrW,WALlB,IAKT,2BAAsC,CAAC,IAA9BuW,EAA6B,QAC9B19D,EAAO09D,EAAM,GAAG/2C,MAAM,KAAKyvB,KAAK,KAChC5pB,EAAM,CAAC,OAAQ,SAAS9qB,SAASg8D,EAAM,IAC5B,SAAbA,EAAM,GACNA,EAAM,GACVhnC,EAAS3T,KAAU2T,EAAQ12B,EAAMwsB,IAV1B,8BAYTwoC,EAAYt+B,GAAQ,GACpBo0B,EAAgBp0B,EAAQ,6BAE1B,CAACs+B,EAAalK,IAGV1nC,EAAWvhB,uBACf,WAAgB,IAAD,uBAAXo4D,EAAW,yBAAXA,EAAW,gBACb,IAAMj6D,EAAOi6D,EAAO7jB,KAAK,KACzB,GAAIjzB,EAAU,CACZ,IAAMtjB,EAAQmjB,IAAUG,EAAUnjB,GAClC,OAAOH,GAAgB,KAEvB,IAAM89D,EAAW1D,EAAO11D,OAAS,EACjC,OAAOqtB,GAAmBqoC,EAAO0D,MAGrC,CAACx6C,IAGH,OACE,qBAAKngB,MAAO2L,GAAO/L,UAAnB,SACE,sBAAMyhD,SAAUiZ,EAAc3sD,IAAKksD,EAAnC,SACGx6C,GACCA,EAAQpH,KAAI,SAAC2iD,GAAD,OACV,sBAAwB56D,MAAO2L,GAAO0tD,eAAtC,UACE,cAAC,GAAD,CAAgBr5D,MAAO2L,GAAO4wC,OAAQ1/C,MAAO+9D,IAC5CrB,GAAathD,KAAI,SAACyiD,GAAD,OAChB,cAAC,GAAD,CAEE3vC,MAAO2vC,EAAM3vC,MACbulB,QAASlwB,EAASw6C,EAAcF,EAAMlB,iBACtCxkC,OAAQ5U,EAASw6C,EAAcF,EAAMjB,kBACrCX,oBAAqB4B,EAAMlB,gBAC3BT,qBAAsB2B,EAAMjB,iBAC5BR,QAAS2B,GANJF,EAAM17D,SAJP47D,UAoBPoL,UAAartC,qBAAWstC,mBChLvC,SAASE,WAAT,GAQI,IAPFlvC,EAOC,EAPDA,MACAxZ,EAMC,EANDA,KACA2G,EAKC,EALDA,QACAjC,EAIC,EAJDA,UACAkuB,EAGC,EAHDA,aACAmkB,EAEC,EAFDA,SACAniC,EACC,EADDA,YAEM70B,EAAW6M,cACX+7D,EAAex4D,iBAAO,IACtBonB,EAASX,yBAAyB5W,EAAK4B,SACvCgnD,EAAoBxnE,uBACxB,SAACM,EAAGq7C,GACFr7C,EAAEC,iBACFD,EAAEE,kBACF,IAAM43D,EAASzc,EAAI9G,SACnBl2C,EAAS,CACPhB,KAAMgV,GACN9P,KAAM,CAAE1C,GAAIi4D,EAAOj4D,GAAImlC,OAAQ8yB,EAAO9yB,YAG1C,CAAC3mC,IAGG8oE,EAAiB5oE,mBACrB,iBAAM,CACJ,CACE8f,MAAO,GACP4vC,OAAQ,GACRnqD,MAAO,KACPsnD,SAAU,OACV79C,SAAU,OACV1N,GAAI,gBACJ2yD,KAAM,qBAAGnX,EAAH,EAAGA,IAAH,OACJ,wBACEh+C,KAAK,SACL8J,UAAU,gBACV7G,QAAS,iBAACN,GAAD,OAAOknE,EAAkBlnE,EAAGq7C,IAHvC,SAKE,cAAC,KAAD,WAKR,CAAC6rB,IAGG9O,EAAkB14D,uBAAY,SAAC2e,GACnC4oD,EAAa/2D,QAAQ9J,SAAQ,SAACoI,EAAKrM,GAC7Bkc,IAAUlc,GAAKqM,GACjBA,EAAI6nD,iBAGP,IAEG+Q,EAA0B1nE,uBAC9B,SAAC+G,EAAO40C,GACN,IAAMjxB,EAAajB,WAAW1iB,EAAMirB,OAAOh0B,OAASyrB,WAAWkyB,EAAI39C,OACnEW,EAAS,CAAEhB,KAAMiV,GAAgB8X,iBAEnC,CAAC/rB,IAGGg6D,EAAe95D,mBAAQ,WAC3B,IAAM+5D,EAAkB,SAAlBA,gBACJ51B,EACArkB,EACAk6C,EACAC,EACA6O,GAEA3kC,EAAMzjC,KAAN,2BACKooE,GADL,IAEEhpD,MAAOA,EACP4vC,OAAQsK,EACRhG,SAAU,QACVC,KAAM,qBAAGnX,EAAH,EAAGA,IAAH,OAAamd,EAAYnd,QAI7B0rB,EAAmB9lD,GACvBiS,EAD+B,mCAEHlQ,EAFG,KAG/ByM,IAGEipC,EAAI,aAAOyO,GA4Cf,OA3CIJ,EAAiBr3C,gBACnB4oC,EACEI,EACA,EACA,KACA,SAACrd,GAAD,OAAS2R,GAAa3R,EAAIh9B,MAAQ,EAAG0oD,EAAiBp3C,oBACtD,CAAE7rB,MAAO,KAAMsnD,SAAU,OAAQ79C,SAAU,SAG3Cw5D,EAAiBn3C,eACnB0oC,EAAgBI,EAAM,EAAG,SAAS,SAACrd,GAAD,OAChC2R,GAAa3R,EAAI9G,SAASvP,OAAQ+hC,EAAiBl3C,oBAGnDk3C,EAAiBj3C,cACnBwoC,EAAgBI,EAAM,EAAG,gBAAW,SAACrd,GAAD,OAClC,cAAC,GAAD,CACEya,YAAa,8BAAMsC,EAAgB/c,EAAIh9B,QACvC7P,IAAK,aAACA,GAAD,OAAUy4D,EAAa/2D,QAAQmrC,EAAIh9B,OAAS7P,GACjD9Q,MAAOsvD,GACL3R,EAAI9G,SAAS72C,MACbqpE,EAAiBh3C,gBAEnB24B,OAAQ,gBAACjiD,GAAD,OAAW2gE,EAAwB3gE,EAAO40C,EAAI9G,WACtDl3C,KAAK,cAIP0pE,EAAiB/2C,aACnBsoC,EAAgBI,EAAM,EAAG,eAAU,SAACrd,GAAD,OACjC2R,GAAa3R,EAAI9G,SAAS+yB,QAASP,EAAiB92C,kBAGpD82C,EAAiB32C,eACnBkoC,EAAgBI,EAAM,EAAG,aAAa,SAACrd,GAAD,OACpC2R,GAAa3R,EAAI9G,SAAStc,UAAW8uC,EAAiB12C,oBAGtD02C,EAAiB72C,eACnBooC,EAAgBI,EAAM,EAAG,cAAc,SAACrd,GAAD,OACrC2R,GAAa3R,EAAI9G,SAASgzB,UAAWR,EAAiB52C,oBAGnDuoC,EAAK7gC,MAAK,SAAC+gC,EAASC,GAAV,OAAsBD,EAAQv6C,MAAQw6C,EAAQx6C,WAC9D,CACD2E,EACAo1C,EACA+O,EACAj0C,EACAk0C,IAGInyC,EAAQ12B,mBAAQ,WACpB,SAASw6D,UAAUr7D,GACjB,IAAM+0C,EAAS,IACf,OACE/0C,EAAQ+0C,GAAUxtB,EAAQ,GAAKwtB,GAC/B/0C,EAAQ+0C,GAAUxtB,EAAQ,GAAKwtB,EAGnC,OAAI3a,GAASA,EAAMvD,QACF2c,EACXpZ,EAAMvD,OAAOjzB,QAAO,SAACirC,GAAD,OAAUwsB,UAAUxsB,EAAKvU,UAC7CF,EAAMvD,QAEIzb,KAAI,SAACyzB,GACjB,IAAM7uC,EAAQm4B,EAAO0W,EAAKvU,OAC1B,MAAO,CACLt6B,MAAOA,EACP4pE,QACEhpD,GAAQA,EAAKS,gBAAkBrhB,EAAQ4gB,EAAKS,gBAAkB,GAChElf,GAAI0sC,EAAK1sC,GACTo4B,UAAWsU,EAAKtU,UAChBsvC,UAAWh7B,EAAKzoC,MAAQyoC,EAAKzoC,MAAQ,GACrCwzD,wBAAyByB,UAAUr7D,OAKlC,KACN,CAACwzC,EAAcrb,EAAQvX,EAAMwZ,EAAO7S,IAMvC,OAJA9lB,qBAAU,WACRk2D,EAASpgC,EAAM7yB,UACd,CAAC6yB,EAAOogC,IAEJpgC,GAASA,EAAM7yB,OAAS,EAC7B,cAAC,GAAD,CAAYG,KAAM0yB,EAAO8E,QAASs+B,IAElC,cAAC,GAAD,IAIWwO,UAAarpD,eAAKwpD,aC3L3Bx6D,GAAS,CACb/L,UAAW,CACTsM,QAAS,OACTO,cAAe,SACfvJ,OAAQ,SAIZ,SAASyjE,aAAc,IAAD,EACwB//D,oBAAS,GADjC,mBACb8tD,EADa,KACGoG,EADH,OAEoBl0D,mBAAS,GAF7B,mBAEbggE,EAFa,KAECC,EAFD,KAIdrpE,EAAW6M,cACX8E,EAAQzD,IALM,EAMe9E,oBAAS,GANxB,mBAMbq0D,EANa,KAMFC,EANE,KAOdC,EAAavtD,mBACbiB,EAAahQ,uBAAY,WAC7BrB,EAAS,CAAEhB,KAAMgV,GAAsB9P,KAAM,SAC5C,CAAClE,IAEE49D,EAAkBv8D,uBAAY,WAClCsQ,EAAMY,kBAAkB,6CAA8C,CACpErB,MAAOG,MAER,CAACM,EAAON,IAEL0sD,EAAuB18D,uBAAY,WACvCq8D,GAAeD,KACd,CAACA,IAEEO,EAAqB38D,uBAAY,WACrCs8D,EAAW9rD,QAAQ4qD,cACnBiB,GAAc,KACb,IAEGO,EAAiB58D,uBAAY,WACjCi8D,GAAmBpG,KAClB,CAACA,IACEgH,EAAiB78D,uBAAY,SAAC2qB,GAClCq9C,EAAgBr9C,KACf,IAEH,OACE,sBAAKxpB,MAAO2L,GAAO/L,UAAnB,WACIq7D,GACA,cAAC,GAAD,CACE3G,QAASsS,EACTj5C,SAAUytC,EACV7G,cAAc,mBACdC,SAAUiH,EACVhH,cACEC,EAAiB,iBAAmB,yBAEtCA,eAAgBA,EAChBC,gBAAiBiS,EACjB/R,kBAAkB,OAClBD,eAAgB2G,IAGnBN,GACC,cAAC,GAAD,CACEpT,OAAQ2T,EACRzuD,QAASwuD,IAGb,qBAAKv7D,MAAO,CAAEkD,OAAQ,OAAQkL,SAAU,QAAxC,SACE,eAAC,KAAD,CACE6sD,UAAWA,EACXU,UAAQ,EACRttD,eAAgB,CAAED,SAAU,UAH9B,UAKE,cAAC,GAAD,CAAYiiC,aAAcqkB,EAAgBF,SAAUkH,IACpD,cAAC,GAAD,CAAkB/tD,IAAKwtD,YAOlBx+C,I,GAAAA,kBAAKgqD,YCrFdh7D,GAAS4C,YAAH,kdA+CGu4D,OAnBf,SAASA,mBAAT,GAA6D,IAA/B3vD,EAA8B,EAA9BA,KAAMpK,EAAwB,EAAxBA,QAASg6D,EAAe,EAAfA,YAC3C,OACE,oBAAKx4D,IAAK5C,GAAV,UACE,oBAAKrF,UAAU,8BAAf,UACE,uBAAQ9J,KAAK,SAASiD,QAAS,0BAAMsnE,EAAY5vD,IAAjD,SACE,aAAC,KAAD,MAGF,aAAC,GAAD,CAAa1X,QAASsN,OAExB,oBACEzG,UAAU,iBAEVy2D,wBAAyB,CAAEC,OAAQ7lD,SC1BrCxL,GAAS,CACbq7D,QAAS,CACP96D,QAAS,OACTO,cAAe,MACf+3B,aAAc,mCAEhByiC,OAAQ,CACN/6D,QAAS,OACTC,eAAgB,SAChBC,WAAY,SACZ8O,QAAS,OAEXgsD,wBAAyB,CACvB1wC,OAAQ,OACRtzB,OAAQ,OAERmY,SAAU,OACVpP,gBAAiB,eAEnBjF,OAAQ,CACNiF,gBAAiB,cACjBuqB,OAAQ,SA+KG2wC,OA3Kf,SAASA,aAAT,GAUI,IATFhuC,EASC,EATDA,OACA1b,EAQC,EARDA,KACA0E,EAOC,EAPDA,UACAkX,EAMC,EANDA,UACA+tC,EAKC,EALDA,SACAC,EAIC,EAJDA,kBACAzS,EAGC,EAHDA,eACA0S,EAEC,EAFDA,eACAC,EACC,EADDA,cAEM/pE,EAAW6M,cACX8E,EAAQzD,IACR1G,EAAQ+3C,KACR1qB,EAAc7nB,iBACdkwB,EAAiBiB,oBALtB,EAM2D/0B,oBAAS,GANpE,mBAMM4gE,EANN,KAMkC/mC,EANlC,KAQK+T,EAAax0B,IAAUmZ,EAAQ,cAAe,MAE9CsuC,EAAyB5oE,uBAC7B,SAAChC,QACe+nB,IAAV/nB,GACFW,EAAS,CAAEhB,KAAM2Y,GAAkBtY,UAGrCsS,EAAMkB,UAER,CAAC7S,EAAU2R,IAGPu4D,EAA2B7oE,uBAAY,WAC3CsQ,EAAMvQ,KACJ,cAAC,GAAD,CACEmO,QAAS,0BAAMoC,EAAMkB,SACrBw3C,OAAQ4f,EACRlrB,OACE/H,EAAU,uCAC0Bzf,OAAOyf,GAAY31B,QAAQ,GADrD,KAEN,qBAENwa,UAAWA,EACX7zB,QAAS2c,EAAYA,EAAU9c,QAAQ,SAAU,IAAM,UAG1D,CAAC8c,EAAWslD,EAAwBjzB,EAAYrlC,EAAOkqB,IAEpDsuC,EAAoB9oE,uBAAY,WAAO,IAAD,iBACtBs6B,EAAOzF,QADe,IAC1C,2BAAmC,CAAC,IAAzBzyB,EAAwB,QACjCmmE,EAASnmE,IAF+B,iCAIzC,CAACk4B,EAAQiuC,IAENQ,EAA4B/oE,uBAAY,WAC5CsQ,EAAMY,kBAAkB,iDAAkD,CACxErB,MAAOi5D,MAER,CAACA,EAAmBx4D,IAEjBisD,EAAkBv8D,uBAAY,WAClCsQ,EAAMY,kBAAkB,4CAA6C,CACnErB,MAAO,iBACLlR,EAAS,CAAEhB,KAAM4X,GAAc3X,QAAS,CAAEi+B,yBAG7C,CAACA,EAAgBl9B,EAAU2R,IAExB04D,EAAiChpE,uBAAY,SAAC4lB,GAClD2c,GAAO5T,KAAK,wBAAyB/I,GACrCgc,EAAsBhc,KACrB,IAEGw5B,EAAyBp/C,uBAC7B,SAAChC,GACiB4E,aAAoB5E,GAElCmI,EAAMs4C,QAAQ,4BAEdt4C,EAAM0rC,MAAM,8BAGhB,CAAC1rC,IAGG8iE,EAAoBjpE,uBAAY,WAAO,IAClBkpE,EAA+BtqD,EAAhDS,gBAAoCmB,EAAY5B,EAAZ4B,QACtC2V,EAAShV,IACbqS,EADsB,kCAEKhT,EAAQ5H,cAFb,MAIlBuwD,EAAiB/yC,oBAAoBD,EAAOT,KAC5C0zC,EAAahzC,oBAAoBD,EAAOR,IAExChc,EAAS0vD,aAAY/uC,EAAOzF,OAAQ,CACxCrU,UACA2oD,iBACAC,aACAF,sBAEF54D,EAAMvQ,KACJ,cAAC,GAAD,CACEuY,KAAMqB,EACNuuD,YAAa9oB,EACblxC,QAAS,0BAAMoC,EAAMkB,WAEvB,MAED,CAACoN,EAAMtO,EAAOkjB,EAAa8G,EAAOzF,OAAQuqB,IAE7C,OACE,eAAC,GAAD,CACEqW,QAASn7B,GAAUA,EAAOzF,QAAUyF,EAAOzF,OAAOnyB,OAClDosB,SAAUytC,EACV7G,cAAc,oBACdC,SAAU6S,EACV5S,cACE6S,EAAiB,kBAAoB,0BAEvC5S,eAAgB4S,EAChB3S,gBAAiB4S,EACjB1S,kBAAkB,OAClBD,eAAgBA,EAXlB,UAaE,cAAC,GAAD,CAASl5C,MAAM,6BAA6BD,eAAe,QAA3D,SACE,wBAAQzb,MAAO2L,GAAO3E,OAAQxK,KAAK,SAASiD,QAASqoE,EAArD,SACE,cAAC,KAAD,QAGJ,cAAC,GAAD,CACEpsD,MACE84B,EAAU,6BACgBzf,OAAOyf,GAAY31B,QAAQ,GAD3C,KAEN,oBAENpD,eAAe,QANjB,SAQE,wBACElN,IAAK5C,GAAO3E,OACZxK,KAAK,SACLiD,QAASioE,EAHX,SAKE,cAAC,KAAD,QAGJ,cAAC,GAAD,CAAShsD,MAAK,yBAA4BD,eAAe,QAAzD,SACE,wBACEzb,MAAK,2BAAO2L,GAAOs7D,QAAWt7D,GAAOu7D,yBACrC1qE,KAAK,SACLiD,QAASmoE,EACTjnE,UAAWw4B,IAAWA,EAAOzF,QAAmC,IAAzByF,EAAOzF,OAAOnyB,OAJvD,SAME,cAAC,KAAD,QAIJ,cAAC,GAAD,CACEsb,WACE2qD,EACI,sCACA,sCAEN/rD,eAAe,QACfhc,QAASooE,EACTlnE,UAAWw4B,IAAWA,EAAOzF,QAAmC,IAAzByF,EAAOzF,OAAOnyB,OARvD,SAUE,cAAC,KAAD,CAAWvB,MAAO,CAAEE,cAAe,OAAQmb,SAAU,gBC7LvD1P,GAAS,CACb/L,UAAW,CACTsb,QAAS,GACTjP,gBAAiB,UACjB/I,OAAQ,OACR6L,KAAM,GAERsqD,eAAgB,CACdn+C,QAAS,MACTtO,aAAc,MACd6D,OAAQ,WACRxE,gBAAiB,SAEnBuuC,IAAK,CACHtuC,QAAS,OACTuE,OAAQ,WAEV8rC,OAAQ,CACN/X,aAAc,oBACd80B,cAAe,MACfpnC,WAAY,OACZ/W,MAAO,WAETy9C,WAAY,CACV7pD,KAAM,EACNsM,SAAU,OACV6W,WAAY,OACZ/W,MAAO,WAET0rC,MAAO,CACL5jD,MAAO,MACP0qC,UAAW,WAIf,SAASw6B,kBAAT,EAAqDx6D,GAAM,IAA9B0R,EAA6B,EAA7BA,QAASgT,EAAoB,EAApBA,YAC9BrtB,EAAQ+3C,KAD0C,EAE5Bz9B,yBAAyB,wBAA5CwoC,EAF+C,sBAGzBlhD,mBAAS,MAHgB,mBAGjDuZ,EAHiD,KAGvCy5C,EAHuC,KAIlDC,EAAUjsD,mBAEhBtP,qBAAU,WACR,IAAMs5D,EAAuBkC,GAC3BznC,EACA,4BAEEulC,GACFgC,EAAWhC,KAEZ,CAACvlC,IAEJ,IAAM0nC,EAAsB,SAAtBA,oBAAuBrmC,GAC3Bo0B,EAAgBp0B,EAAQ,6BAGpBs+B,EAAcnzD,uBAClB,SAAC60B,GAAiC,IAAzBsmC,EAAwB,wDAC/B3nC,EAAY70B,SAAS,CACnBhB,KAAMklD,GACNjlD,QAAS,CAAEgC,IAAK,SAAU5B,MAAO62B,KAE/BsmC,GACFh1D,EAAMs4C,QAAQ,2CAGlB,CAACt4C,EAAOqtB,IAGVijC,8BAAoB3nD,GAAK,iBAAO,CAC9BssD,YAD8B,uBAEiB,oBAAlCJ,EAAQxqD,QAAQ6qD,cACzBL,EAAQxqD,QAAQ6qD,gBAEhBL,EAAQxqD,QAAQ8qD,cACd,IAAIC,MAAM,SAAU,CAAEC,YAAY,UAM1C,IAAMd,EAAe,CACnB,CACEv6D,GAAI,EACJ+rB,MAAO,SACPyuC,gBAAiB,WACjBC,iBAAkB,aAClBC,cAAe,QAEjB,CACE16D,GAAI,EACJ+rB,MAAO,OACPyuC,gBAAiB,SACjBC,iBAAkB,WAClBC,cAAe,QAEjB,CACE16D,GAAI,EACJ+rB,MAAO,aACPyuC,gBAAiB,eACjBC,iBAAkB,iBAClBC,cAAe,QAEjB,CACE16D,GAAI,EACJ+rB,MAAO,aACPyuC,gBAAiB,eACjBC,iBAAkB,iBAClBC,cAAe,UAIbY,EAAY,yCAAG,iBAAO10D,GAAP,8BAAAjE,EAAA,+DACnBiE,EAAMxG,iBACAm7D,EAAO30D,EAAMirB,OACb2pC,EAAW,IAAIC,SAASF,GAC1B7mC,EAAS,GAJM,eAKC8mC,EAASrW,WALV,IAKnB,2BAAWuW,EAA6B,QAChC19D,EAAO09D,EAAM,GAAG/2C,MAAM,KAAKyvB,KAAK,KAChC5pB,EAAM,CAAC,OAAQ,SAAS9qB,SAASg8D,EAAM,IAC5B,SAAbA,EAAM,GACNA,EAAM,GACVhnC,EAAS3T,KAAU2T,EAAQ12B,EAAMwsB,GAVhB,8BAanBwoC,EAAYt+B,GAAQ,GACpBqmC,EAAoBrmC,GAdD,iDAAH,gBAAZ4mC,aAAY,sCAiBZl6C,EAAWvhB,uBACf,WAAgB,IAAD,uBAAXo4D,EAAW,yBAAXA,EAAW,gBACb,IAAMj6D,EAAOi6D,EAAO7jB,KAAK,KACzB,GAAIjzB,EAAU,CACZ,IAAMtjB,EAAQmjB,IAAUG,EAAUnjB,GAClC,OAAOH,GAAgB,KAEvB,IAAM89D,EAAW1D,EAAO11D,OAAS,EACjC,OAAOgtB,GAAmB0oC,EAAO0D,MAGrC,CAACx6C,IAGH,OACE,qBAAKngB,MAAO2L,GAAO/L,UAAnB,SACE,sBAAMyhD,SAAUiZ,EAAc3sD,IAAKksD,EAAnC,SACGx6C,GACCA,EAAQpH,KAAI,SAAC2iD,GAAD,OACV,sBAAwB56D,MAAO2L,GAAO0tD,eAAtC,UACE,cAAC,GAAD,CAAgBr5D,MAAO2L,GAAO4wC,OAAQ1/C,MAAO+9D,IAC5CrB,EAAathD,KAAI,SAACyiD,GAAD,OAChB,cAAC,GAAD,CAEE3vC,MAAO2vC,EAAM3vC,MACbulB,QAASlwB,EAASw6C,EAAcF,EAAMlB,iBACtCxkC,OAAQ5U,EAASw6C,EAAcF,EAAMjB,kBACrCX,oBAAqB4B,EAAMlB,gBAC3BT,qBAAsB2B,EAAMjB,iBAC5BR,QAAS2B,GANJF,EAAM17D,SAJP47D,UAoBPj+C,sBAAKgc,qBAAWwvC,oBCrL3BC,GAAQ,KAiCGC,OA/Bf,SAASA,gBAAgB5pE,EAAKiD,GAAO,IAAD,EACNkF,mBAAS,IADH,mBAC3ByQ,EAD2B,KACnBixD,EADmB,KAGlChqE,qBAAU,WACR,IAAIiqE,EAAc,GAClB,GAAI7mE,GAAQ1D,MAAMC,QAAQyD,GAAO,CAC/B,IAAK,IAAIJ,EAAI,EAAGA,EAAII,EAAKH,OAAQD,IAC/BinE,EAAY7mE,EAAKJ,GAAG7C,KAAQ,EAE9B6pE,EAAUC,MAEX,CAAC7mE,EAAMjD,IAEV,IAAMs9B,EAASl9B,uBACb,SAACG,GACC,IAAMwpE,EAAS,eAAQnxD,GACnB+wD,KACFI,EAAUJ,KAAS,GAEX,MAANppE,IACFopE,GAAQppE,EACRwpE,EAAUxpE,IAAM,GAElBspE,EAAUE,KAEZ,CAACnxD,IAGH,MAAO,CAACA,EAAQ0kB,I,qBCiDX,SAAS0sC,gBAAgBp2C,EAAa5zB,GAC3C,OAAOiqE,KAAOz0C,IAAI5B,EAAa5zB,GAAK,GC9EvBkqE,I,GAAAA,GARf,SAASA,eAAT,GAAuE,IAA7CC,EAA4C,EAA5CA,YAAa/rE,EAA+B,EAA/BA,MAAOgsE,EAAwB,EAAxBA,aAAc7zC,EAAU,EAAVA,OAC1D,OACE,0DAAQ4zC,GAAiBC,GAAzB,aACGzzC,GAAav4B,EAAOm4B,OCE3B,SAAS8zC,mBAAT,GAA+D,IAAjCpnE,EAAgC,EAAhCA,KAAM1B,EAA0B,EAA1BA,MAAO02B,EAAmB,EAAnBA,SAAU75B,EAAS,EAATA,MAC7C4sD,EAAkB5qD,uBACtB,SAACM,GACCu3B,EAASv3B,EAAE0xB,OAAOh0B,SAEpB,CAAC65B,IAGG/qB,EAAS4C,YAAH,ybAKDvO,EAAMiD,MAAQjD,EAAMiD,MAAQ,EAAI,GAf1B,+kBAoBUjD,EAAMiD,MAAQjD,EAAMiD,MAAQ,GAAK,IAU5D,OACE,uBAAQsL,IAAK,CAAC5C,EAAQ3L,GAAQ02B,SAAU+yB,EAAiB5sD,MAAOA,EAAhE,SACG6E,EAAKuW,KAAI,SAACmC,GAAD,OACR,uBAEEvd,MAAOud,EAAEvd,MAFX,SAKGud,EAAE2Q,OALL,UACU3Q,EAAE3b,WAkBpBqqE,mBAAmBt/D,aAAe,CAChCktB,SAAU,SAAS,WACjB,OAAO,OAIIoyC,0BCpDA7b,OARf,SAASA,cAAT,GAAwC,IAAtBxtD,EAAqB,EAArBA,QAAYpC,EAAS,4BACrC,OACE,aAAC,WAAD,UACE,mCAAQb,KAAK,SAASiD,QAASA,GAAapC,OCSnC0rE,OAZf,SAASA,aAAT,GAA4C,IAApB/oE,EAAmB,EAAnBA,MAAU3C,EAAS,0BACnCw2C,EAAOm1B,aAAS3rE,GAAO,GAE7B,OACE,6BACGw2C,EAAKnD,MACJ,kBAAG1wC,MAAK,aAAImb,MAAO,MAAO1K,OAAQ,SAAYzQ,GAA9C,SAAwD6zC,EAAKnD,QAC3D,QCNV,SAASwV,mBAAT,GAAmE,IAAlD+iB,EAAiD,EAAjDA,QAASC,EAAwC,EAAxCA,OAAQC,EAAgC,EAAhCA,mBAAuB9rE,EAAS,4DAChD2rE,aAAS3rE,GAAlBq9D,EADyD,oBAEhE,OACE,gCACE,6DACMA,GACAr9D,GAFN,IAGE4rE,QAAS,0BAAMA,EAAQvO,EAAMljD,OAC7B0xD,OAAQ,yBAAMA,EAAOxO,EAAMljD,UAE5B2xD,IAA6C,IAAvBA,EACrB,cAAC,GAAD,eAAkB9rE,IAChB,QAKV6oD,mBAAM18C,aAAe,CACnBy/D,QAAS,0BAAM,MACfC,OAAQ,yBAAM,OAGDhjB,I,GAAAA,sBChBTkjB,GAAwB76D,YAAH,4cA2B3B,SAAS86D,iBAAT,GAAgD,IAApBJ,EAAmB,EAAnBA,QAASC,EAAU,EAAVA,OAAU,EACHrjB,eAAlCnyB,EADqC,EACrCA,OAAQoyB,EAD6B,EAC7BA,cAAekB,EADc,EACdA,OADc,EAGGpgD,oBAAS,GAHZ,mBAGtC0iE,EAHsC,KAGpBC,EAHoB,KAKvCC,EAAc3qE,uBAAY,WAC9B,IAAM4qE,EAAY,CAChB9qD,aAAc,IACd6b,KAAM,SACNrD,MAAOpC,OAAOrB,EAAOg2C,gBACrBhrD,EAAG,CAAC,CAAEC,aAAc6d,mBAAmB,KAAM5d,SAAU,MAEnD+qD,EAAWj2C,EAAO+X,QAAQnrC,QAAQs5B,OAAO6vC,GAE/C3jB,EAAc,UAAW6jB,GACzB7jB,EAAc,YAAaznD,OAAOsrE,EAASpoE,OAAS,MACnD,CAACukD,EAAepyB,EAAOg2C,eAAgBh2C,EAAO+X,UAUjD,OARAntC,qBAAU,WACJ0oD,EAAO0iB,eACTH,GAAoB,GAEpBA,GAAoB,KAErB,CAACviB,EAAO0iB,eAAgBh2C,EAAO+X,UAGhC,oBAAKl9B,IAAK66D,GAAV,UACE,8BACE,kBAAG9iE,UAAU,WAAb,+DAGA,aAAC,GAAD,CACEkR,KAAK,iBACLhb,KAAK,SACLq1D,YAAgB,SAAL,iBACXoX,QAASA,EACTC,OAAQA,OAIZ,6BACE,aAAC,GAAD,CACE5iE,UAAU,kBACV7G,QAAS+pE,EACT7oE,SAAU2oE,EACV/6D,IAAK,CACH4M,MAAOmuD,EAAmB,OAAS,OACnCrmE,MAAO,QANX,SASE,aAAC,KAAD,CAAQyY,MAAM,0BAOTiB,sBAAK0sD,kBCzFpB,SAASO,UAAT,GAA0C,IAArBl2C,EAAoB,EAApBA,OAAWr2B,EAAS,6BACvB2rE,aAAS3rE,GAAlBq9D,EADgC,oBAGvC,OAAOhnC,GAAUA,EAAOnyB,OAAS,EAC/B,8BACE,aAAC,KAAD,qCAAOsoE,GAAG,UAAanP,GAAWr9D,GAAlC,aACGq2B,EAAOzb,KAAI,SAACpb,EAAOyE,GAClB,OACE,gCAIGzE,GAFIyE,SAOb,aAAC,GAAD,eAAkBjE,OAElB,KAGNusE,UAAUE,WAAa,CACrBC,UAAW5xC,KAAU6xC,WAAWhsE,OAAOwsC,WACvCy/B,uBAAwB9xC,KAAUoU,MAGrBq9B,I,GAAAA,aCjBTM,GAAsB37D,YAAH,6jCA4DnB47D,GAAa,CACjB3zC,OAAQ,iBAGV,SAAS4zC,eAAT,GAA4D,IAAlChsE,EAAiC,EAAjCA,KAAMa,EAA2B,EAA3BA,OAAQgqE,EAAmB,EAAnBA,QAASC,EAAU,EAAVA,OAAU,EACfrjB,eAAlCnyB,EADiD,EACjDA,OAAQoyB,EADyC,EACzCA,cAAekB,EAD0B,EAC1BA,OAE/B1oD,qBAAU,WACJo1B,EAAO+X,QAAQ/X,EAAOvR,YACxBuR,EAAO+X,QAAQ/X,EAAOvR,WAAWzD,EAAEnZ,SAAQ,SAAC8kE,EAAW/oE,GAChDm7B,oBAAoB4tC,EAAU1rD,eACjCmnC,EAAc,WAAD,OAAYpyB,EAAOvR,UAAnB,cAAkC7gB,EAAlC,aAAgD,SAIlE,CAACwkD,EAAepyB,EAAOvR,UAAWuR,EAAO+X,UAE5C,IAAM6+B,EAA0BzrE,uBAC9B,SAACyC,GAAD,OACE0e,IACEgnC,EADO,kBAEItzB,EAAOvR,UAFX,sBAGP,IACA3jB,MAAK,SAAC+rE,GAAD,OAAYA,EAAO/sD,QAAUlc,OACtC,CAAC0lD,EAAQtzB,EAAOvR,YAGlB,OACE,sBAAO5T,IAAK27D,GAAZ,SACE,gCACE,6BACE,kCACA,6CACA,uCACA,4BAAK,QAENlqD,IAAU0T,EAAD,kBAAoBA,EAAOvR,UAA3B,OAA2C,IAAIlK,KACvD,SAACoyD,EAAW/oE,GAAZ,OACE,6BAIE,4BAAKA,EAAI,IACT,4BACE,aAAC,GAAD,CACEgF,UAAU,YACVkR,KAAI,kBAAakc,EAAOvR,UAApB,cAAmC7gB,EAAnC,iBACJoyB,OAAQwI,GAAWjkB,KAAI,SAACokB,GAAD,OAAgBA,EAAWtR,aAGtD,4BACE,aAAC,GAAD,CACEvT,KAAI,kBAAakc,EAAOvR,UAApB,cAAmC7gB,EAAnC,aACJ9E,KAAK,SACLq1D,YAAa,SACblxD,UAAW87B,oBAAoB4tC,EAAU1rD,cACzCsqD,QAASA,EACTC,OAAQA,EACRlpE,MAAOsqE,EAAwBhpE,GAAK6oE,GAAa,SAGrD,4BACE,aAAC,GAAD,CACE7jE,UAAU,gBACV7G,QAAS,mBACPR,EAAOqC,IAHX,SAME,aAAC,KAAD,CAASgF,UAAU,OAAOoV,MAAM,0BA9BtC,uBAEuBgY,EAAOvR,WAF9B,OAE0C7gB,OAkC9C,sBACA,4BACE,mBAAIkpE,QAAS,EAAb,SACE,aAAC,GAAD,CACElkE,UAAU,aACV7G,QAAS,0BACPrB,EAAK,CACHugB,aAAc6d,mBAAmB,KACjC5d,SAAU,MALhB,SASE,aAAC,KAAD,CAAQlD,MAAM,gCASbiB,I,GAAAA,kBAAKytD,gBCpKdK,GAAqBl8D,YAAH,kMAYxB,SAASm8D,cAAT,GAA6C,IAApBzB,EAAmB,EAAnBA,QAASC,EAAU,EAAVA,OACxBx1C,EAAWmyB,eAAXnyB,OAER,OACE,oBAAKnlB,IAAKk8D,GAAV,SACE,aAAC,KAAD,CACEjzD,KAAI,kBAAakc,EAAOvR,UAApB,MACJquC,OAAQ,uBAAGpyD,EAAH,EAAGA,KAAMa,EAAT,EAASA,OAAT,OACN,6BACE,aAAC,GAAD,CACEb,KAAMA,EACNa,OAAQA,EACRgqE,QAASA,EACTC,OAAQA,WASPvsD,I,MAAAA,kBAAK+tD,eC3BdC,GAAap8D,YAAH,mLAcVq8D,GAAoBr8D,YAAH,6CAIvB,SAASs8D,cAAe,IAAD,EACqBhlB,eAAlCnyB,EADa,EACbA,OAAQoyB,EADK,EACLA,cAAekB,EADV,EACUA,OADV,EAGyB98C,eAAhCoxB,EAHO,EAGb55B,KAAmBsb,EAHN,EAGMA,eAHN,EAIiBpW,mBAAS,MAJ1B,mBAIdkkE,EAJc,KAIDC,EAJC,OAKankE,mBAAS,MALtB,mBAKdqX,EALc,KAKH+sD,EALG,KAOrB1sE,qBAAU,WAENg9B,GACAte,GACAgD,IACEsb,EADO,WAEHte,EAAeQ,MAFZ,+BAGPoH,GAGFomD,EAAa1vC,EAAYte,EAAeQ,OAAOC,KAAKS,iBAEpD8sD,EAAa,QAEd,CAAChuD,EAAgBse,IAEpBh9B,qBAAU,WAUR,OATA8iC,GAAO/T,GAAG,YAAY,SAACznB,GACjBklE,GAAe7sD,GACjB6nC,EACEglB,EACApiE,KAAKC,IAAI/C,EAAM3E,MAAM,GAAK2E,EAAM3E,MAAM,IAAMgd,MAK3C,WACLmjB,GAAO7T,IAAI,eAEZ,CAACu9C,EAAahlB,EAAe7nC,EAAWyV,EAAOvR,YAElD7jB,qBAAU,WAOR,OANA8iC,GAAO/T,GAAG,cAAc,SAACznB,GACE,iBAArB8tB,EAAOvR,WAAgC2oD,GACzChlB,EAAcglB,EAAallE,EAAM0hC,SAI9B,WACLlG,GAAO7T,IAAI,iBAEZ,CAACmG,EAAOvR,UAAW2oD,EAAahlB,IAEnC,IAAMmlB,EAAgBpsE,uBACpB,SAAC2Y,GACCuzD,EAAevzD,KAEjB,CAACuzD,IAGGG,EAAkBrsE,uBACtB,YAAgB,IAAbqhD,EAAY,EAAZA,MACD4F,EAAc,YAAa5F,GAC3B6qB,EAAe,QAEjB,CAACjlB,IAGGqlB,EAAqBtsE,uBACzB,YAAgB,IAAbqhD,EAAY,EAAZA,MACKypB,EAAWj2C,EAAO+X,QAAQhrC,QAC9B,SAACs5B,EAASz4B,GAAV,OAAgBA,IAAMyzB,OAAOmrB,MAE/B4F,EAAc,UAAW6jB,KAE3B,CAAC7jB,EAAepyB,EAAO+X,UAGzBntC,qBAAU,WACRwnD,EACE,YACApyB,EAAO+X,QAAQlqC,OAAS,GACnBmyB,EAAO+X,QAAQlqC,OAAS,GAAG4f,WAC5B,kBAEL,CAAC2kC,EAAepyB,EAAO+X,QAAQlqC,SAElC,IAAM6pE,EAAoBvsE,uBACxB,SAACyC,GACC,OACE0lD,EAAOvb,UACNzrB,IAAUgnC,EAAQ,sBAAuB,IAAIxoD,MAC5C,SAAC+rE,GAAD,OAAYA,EAAO/sD,QAAUlc,MAE7B0e,IAAUgnC,EAAD,kBAAoB1lD,EAApB,sBAA2C,IAAIC,OAAS,KAGvE,CAACylD,IAGGqkB,EAAiB3tE,mBAAQ,WAC7B,IAAM4tE,EACJ53C,EAAO+X,QAAQlqC,OAAS,EACpBmyB,EAAO+X,QAAQxzB,KAAI,SAAC6hB,EAAQx4B,GAAT,OACjB,oBAGE4+C,MAAK,UAAK5+C,GACV6+C,SAAa,SAAL,YAAkBrmB,EAAO3C,MAAMtY,QACrC,GADM,aAEFib,EAAOpb,EACVzG,KAAI,SAACoyD,GAAD,OAAe7tC,mBAAmB6tC,EAAU1rD,iBAChDy0B,KAAK,IAJA,KAKRiN,UAAW+qB,EAAkB9pE,GAAKspE,GAAoB,KATxD,SAWE,aAAC,GAAD,CAAe3B,QAASgC,KAX1B,oBAEoB3pE,OAYtB,GAEAiqE,EACJ,oBACEprB,SAAU,IACVD,MAAM,eACNc,UAAU,QAHZ,SAME,aAAC,GAAD,CAAkBioB,QAASgC,KAFvB,gBAMR,OAAOK,EAAW1xC,OAAO2xC,KACxB,CAACN,EAAeG,EAAmB13C,EAAO+X,UAEvC+/B,EACJ,kBAAGllE,UAAU,WAAb,iHAMImlE,EACJ,kBAAGnlE,UAAU,WAAb,4HAMF,OACE,8BACE,oBAAKiI,IAAKo8D,GAAV,SACG3jB,EAAOvb,UACPub,EAAOvb,QAAQigC,WAAa1kB,EAAOvb,QAAQkgC,aAC1C,8BACE,kBAAGrlE,UAAU,YAAb,SACG0gD,EAAOvb,QAAQigC,WACd1kB,EAAOvb,QAAQkgC,YAAY,GAAG/8D,UAEjCo4C,EAAOvb,QAAQigC,UAAYD,EAAoB,QAE3B,iBAArB/3C,EAAOvR,UACTspD,EAEAD,IAGJ,aAAC,GAAD,CACE/qB,aAAc/sB,EAAOvR,UACrB1iB,QAASyrE,EACT9qB,WAAS,EACTzyB,SAAUw9C,EAJZ,SAMGE,OAMM1uD,sBAAKkuD,aCrJLe,I,GAAAA,GAxDf,SAASA,oBAAoBl4C,EAAQmF,GACnC,IAAMmuB,EAAS,GAEVtzB,EAAOg2C,gBAGVh2C,EAAOg2C,eAAiB7wC,EAAUr2B,MAClCkxB,EAAOg2C,eAAiB7wC,EAAUlb,MAElCqpC,EAAO0iB,eAAP,WAA4Bh2C,EAAOg2C,eAAe7qD,QAChD,GADF,0BALAmoC,EAAO0iB,eAAiB,WAU1B,IAAMmC,EAAqB,SAArBA,mBAAsBvqE,GACrB0lD,EAAOvb,UACVub,EAAOvb,QAAU,SAET7mB,IAANtjB,GAAoB0lD,EAAOvb,QAAP,UAAkBnqC,MACxC0lD,EAAOvb,QAAP,UAAkBnqC,IAAO,CAAEwqE,iBAAkB,MAkCjD,OA9B8B,IAA1Bp4C,EAAO+X,QAAQlqC,QACjBsqE,IACA7kB,EAAOvb,QAAQigC,UAAY,iDAE3Bh4C,EAAO+X,QAAQlmC,SAAQ,SAACw0B,EAASz4B,GACN,IAArBy4B,EAAQrb,EAAEnd,SACZsqE,EAAmBvqE,GACd0lD,EAAOvb,QAAQkgC,cAClB3kB,EAAOvb,QAAQkgC,YAAc,IAE/B3kB,EAAOvb,QAAQkgC,YAAYvtE,KAAK,CAC9Bof,MAAOlc,EACPsN,QAAQ,iDAAD,OAAmDtN,EAAI,EAAvD,QAGXy4B,EAAQrb,EAAEnZ,SAAQ,SAAC8kE,EAAW3rD,GAE1B+d,oBAAoB4tC,EAAU1rD,eACP,KAAvB0rD,EAAUzrD,WAEVitD,EAAmBvqE,GACnB0lD,EAAOvb,QAAP,UAAkBnqC,IAAKwqE,iBAAiB1tE,KAAK,CAC3Cof,MAAOkB,EACP9P,QAAQ,+CAAD,OAAiDtN,EAAI,EAArD,cAOV0lD,GCrCHr7C,GAAS4C,YAAH,04BAqDZ,SAASw9D,eAAT,GAKI,IAJFC,EAIC,EAJDA,qBACAC,EAGC,EAHDA,sBACAC,EAEC,EAFDA,qBACArzC,EACC,EADDA,UAEMszC,EAAettE,uBAAY,WAC/BqtE,EAAqBrzC,KACpB,CAACqzC,EAAsBrzC,IAE1Bv6B,qBAAU,WACR6tE,MACC,CAACA,IAEJ,IAAMC,EAAgBvtE,uBAAY,WAChCotE,MACC,CAACA,IAEEI,EAAextE,uBACnB,SAACytE,GAAD,OACEA,EACG7rE,QAAO,SAACme,GAAD,MAAoC,KAAtBA,EAASA,YAC9B3G,KAAI,SAAC2G,GACJ,OAAO,2BACFA,GADL,IAEED,aAAc6d,mBAAmB5d,EAASD,qBAGlD,IAGI4tD,EAAa1tE,uBACjB,SAAC4sC,GACC,OAAOA,EAAQxzB,KAAI,SAAC8hB,GAClB,OAAO,yBACL/6B,GAAIowC,cACDrV,GAFL,IAGEpb,aAAcob,EAAQrb,EACnBzG,KAAI,SAACoyD,GAAD,OAAe7tC,mBAAmB6tC,EAAU1rD,iBAChDy0B,KAAK,IACR10B,EAAG2tD,EAAatyC,EAAQrb,UAI9B,CAAC2tD,IAGGG,EAAe3tE,sBAAW,yCAC9B,iBAAO4tE,GAAP,gBAAA9qE,EAAA,sEACQ2uB,EADR,eACsBuI,IACbiB,OAASyyC,EAAWE,EAAWhhC,SAFxC,SAGQugC,EAAqB17C,GAH7B,OAIE87C,IAJF,iDAD8B,sDAO9B,CAACG,EAAYH,EAAeJ,EAAsBnzC,IAG9C6zC,EAAsBhvE,mBAAQ,WAClC,OAAOm7B,EAAUiB,OAAO7hB,KAAI,SAAC8hB,GAE3B,IAEInb,EAFA+tD,EAAW,EACTL,EAAY,GAYlB,OAVAvyC,EAAQpb,aAAagF,MAAM,IAAIpe,SAAQ,SAACqnE,GAClCnwC,oBAAoBmwC,IACtBhuD,EAAQ,eAAQmb,EAAQrb,EAAEiuD,IAC1BA,KAEA/tD,EAAW,CAAED,aAAciuD,EAAehuD,SAAU,IAEtDA,EAASD,aAAe6d,mBAAmB5d,EAASD,cACpD2tD,EAAUluE,KAAKwgB,MAEV,2BAAKmb,GAAZ,IAAqBrb,EAAG4tD,SAEzB,CAACzzC,EAAUiB,SAER+yC,EAAuBhuE,uBAAY,SAACmoD,GACxC,IAAM8lB,EAAY/vE,OAAOC,KAAKgqD,GAC9B,OAAI8lB,EAAUvrE,OAAS,IAGE,IAArBurE,EAAUvrE,QACO,mBAAjBurE,EAAU,MAOb,IAEH,OACE,oBAAKv+D,IAAK5C,GAAV,SACGktB,GACC,aAAC,KAAD,CACEuoB,cAAe,CACb3V,QAASihC,EACThD,gBAAiB7wC,EAAUr2B,KAAOq2B,EAAUlb,IAAM,EAClDwE,UAAW,KAEb4qD,SAAU,kBAACr5C,GAAD,OAAYk4C,GAAoBl4C,EAAQmF,IAClDwoB,SAAU,kBAAC3tB,EAAD,GAAgC,IAArBs5C,EAAoB,EAApBA,cACnBR,EAAa94C,GACbs5C,GAAc,IATlB,SAYG,qBAAyB,IAAtBt5C,EAAqB,EAArBA,OAAQszB,EAAa,EAAbA,OACV,OACE,aAAC,KAAD,WACE,oBAAK1gD,UAAU,gBAAf,UACE,aAAC,GAAD,CAAQ7G,QAAS0sE,EAAc7lE,UAAU,cAAzC,SACE,aAAC,KAAD,CAAcoV,MAAM,+CAEtB,gEACA,aAAC,GAAD,CACEjc,QAAS,0BAAM+sE,EAAa94C,IAC5B/yB,SAAUksE,EAAqB7lB,GAC/BnqC,WAAW,kBAGb,aAAC,GAAD,CAAapd,QAAS2sE,OAExB,aAAC,GAAD,YAUhBL,eAAeviE,aAAe,CAC5Bq+C,OAAQ,kBACN,OAAO,MAET96C,QAAS,mBACP,OAAO,MAETvG,OAAQ,kBACN,OAAO,OAIIulE,I,GAAAA,kBChMTpgE,GAAS4C,YAAH,kNAaN0+D,GAAiB,CACrB5iB,WAAY,EACZd,YAAa,EACb/yB,OAAQ,OACRtzB,OAAQ,QAsHKgqE,OAnHf,SAASA,cAAT,GAAiE,IAAxCC,EAAuC,EAAvCA,QAASC,EAA8B,EAA9BA,cAAexE,EAAe,EAAfA,YACzCprE,EAAW6M,cACX8E,EAAQzD,IACRgvB,EAAiBiB,oBAEjB0xC,EAAmBxuE,uBAAY,WACnC,IAAM4R,EAAS/H,KAAKC,IAAIwkE,EAAQ3qE,KAAO2qE,EAAQxvD,IAC/CngB,EAAS,CACPhB,KAAMkV,GACN0S,QAAS,CAAC+oD,EAAQ3qE,KAAOiO,EAAQ08D,EAAQxvD,GAAKlN,OAE/C,CAACjT,EAAU2vE,EAAQ3qE,KAAM2qE,EAAQxvD,KAE9BqQ,EAAqBnvB,uBAAY,WACrCrB,EAAS,CACPhB,KAAM4X,GACN3X,QAAS,CACPuC,GAAImuE,EAAQnuE,GACZ07B,sBAGH,CAACA,EAAgBl9B,EAAU2vE,IAExBG,EAA+BzuE,uBACnC,SAAChC,GACCW,EAAS,CACPhB,KAAMoZ,GACNnZ,QAAS,CACP0wE,UACAtwE,aAIN,CAACW,EAAU2vE,IAGPI,EAAuB1uE,uBAC3B,SAAC2uE,GACChwE,EAAS,CACPhB,KAAMqZ,GACNpZ,QAAS,CACP+wE,gBACA9yC,sBAIN,CAACA,EAAgBl9B,IAGbiwE,EAAwB5uE,uBAAY,WACxCrB,EAAS,CAAEhB,KAAM+X,KACjBpF,EAAMkB,UACL,CAAC7S,EAAU2R,IAERu+D,EAAuB7uE,uBAAY,WACvCrB,EAAS,CAAEhB,KAAMuV,GAAmBsa,aAAc,cAClDld,EAAMvQ,KACJ,aAAC,GAAD,CACEqtE,sBAAuBwB,EACvBzB,qBAAsBuB,EACtBrB,qBAAsBmB,EACtBx0C,UAAWs0C,IAEb,CACEltE,SAAU2K,EAAU+iE,aACpBzgE,WAAY3B,EACZqE,kBAAkB,MAGrB,CACD69D,EACAjwE,EACA2R,EACAg+D,EACAI,EACAF,IAGF,OACE,aAAC,WAAD,WACE,6CAAQD,GAAR,aACE,aAAC,GAAD,CACE12C,SAAU42C,EACV5rE,KAAM63B,GACN18B,MAAOswE,EAAQS,cAAc9zC,OAAOU,KACpCx6B,MAAOitE,QAGX,6CAAQrE,GAAR,IAAqBr6D,IAAK5C,GAA1B,UACE,uBACEnP,KAAK,SACL8J,UAAU,gBACV7G,QAASuuB,EAHX,SAKE,aAAC,KAAD,MAEF,uBACExxB,KAAK,SACL8J,UAAU,cACV7G,QAAS4tE,EAHX,SAKE,aAAC,KAAD,CAAc3xD,MAAM,gCAEtB,uBACElf,KAAK,SACL8J,UAAU,cACV7G,QAASiuE,EAHX,SAKE,aAAC,KAAD,CAAQvyD,MAAM,mBC5IT0yD,OAVf,SAASA,eAAT,GAAqD,IAA3BV,EAA0B,EAA1BA,QAASC,EAAiB,EAAjBA,cAC3B50D,EAASwH,IAAUmtD,EAAS,0BAClC,OACE,8CAAQC,GAAR,aACG50D,GACCA,EAAOP,KAAI,SAAC2G,GAAD,OAAcA,EAASA,SAASC,QAAQ,MAAIu0B,KAAK,SCH9D06B,GAAY,CAChB3yD,MAAO,MACP+W,WAAY,QAGd,SAAS67C,uBAAT,GAWI,IAVFZ,EAUC,EAVDA,QACAryC,EASC,EATDA,WACAv9B,EAQC,EARDA,UACAywE,EAOC,EAPDA,yBACAC,EAMC,EANDA,iBACAC,EAKC,EALDA,OACA9G,EAIC,EAJDA,SACAwB,EAGC,EAHDA,YACAtpE,EAEC,EAFDA,QACA+rC,EACC,EADDA,cAEM8iC,EAASzwE,mBAAQ,WACrB,OAAOsiB,IAAUmtD,EAAS,QAAS,MAClC,CAACA,IAEEiB,EAA0BvvE,uBAC9B,SAAC4lB,GACCupD,EAAyBvpD,KAE3B,CAACupD,IAGGK,EAAU3wE,mBAAQ,WAStB,OAPEo9B,EAAWv8B,UACXu8B,EAAWI,WACV39B,EAAUgB,WACR8sC,EAAc9tC,UAAUT,YAAYw8B,MAAK,SAACkS,GACzC,OAAOA,IAAiB1Q,EAAW97B,MAIrC,CACEmc,MAAO,MACP+W,WAAY,QAEd,CAAE/W,MAAO,QAAS+W,WAAY,YACjC,CACD4I,EAAW97B,GACX87B,EAAWv8B,SACXu8B,EAAWI,UACX39B,EAAUgB,SACV8sC,EAAc9tC,UAAUT,cAG1B,OACE,0DACM8rE,GACAtpE,GAFN,IAGQG,QAAS,iBAACN,GAAD,OAAO+uE,EAAO/uE,EAAG27B,IAHlC,cAK2BlW,IAAxBuoD,EAAQ9yC,aAA6B8yC,EAAQ9yC,YAAc,EAC1D8yC,EAAQtzC,OAASszC,EAAQtzC,MAAMt4B,OAAS,EACtC,sBACEhC,aAAc,+BAAM6uE,GAAwB,IAC5C5uE,aAAc,+BAAM4uE,GAAwB,IAF9C,UAIGjB,EAAQ9yC,YAJX,IAIyB,MACvB,sBAAMr6B,MAAOquE,EAAb,SAAuBF,EAAO5sE,SAC7B,MACD,8BACE,wBACE/E,KAAK,SACLwD,MAAO,CACLg9B,WAAYixC,EAAmB,UAAY,SAC3C/yD,QAAS,EACTzK,OAAQ,GAEVhR,QAAS,iBAACN,GAAD,OAAOioE,EAASjoE,GAAG,IAP9B,SASE,cAAC,KAAD,CAAegc,MAAM,eAIzB2f,EAAWv8B,SACb,0CACM4uE,EAAQ9yC,YADd,MAEE,sBAAMr6B,MAAO8tE,GAAb,eACC,OAGHX,EAAQ9yC,YAERS,EAAWv8B,SACb,gCACG,MACD,sBAAMyB,MAAO8tE,GAAb,eACC,OAGH,MAMRC,uBAAuBvkE,aAAe,CACpClK,QAAS,0BAAM,MACf0uE,yBAA0B,2CAAM,MAChCE,OAAQ,yBAAM,MACd9G,SAAU,2BAAM,OAGHzqD,sBAAKoxD,wBC7GpB,SAASO,YAAT,GAAoE,IAA7CzxE,EAA4C,EAA5CA,MAAO+rE,EAAqC,EAArCA,YAAaC,EAAwB,EAAxBA,aAAc7zC,EAAU,EAAVA,OACvD,OACE,0DAAQ4zC,GAAiBC,GAAzB,aACGzzC,GAAav4B,EAAOm4B,MAKZrY,sBAAK2xD,aCJpB,SAASC,eAAT,EAEE5gE,GACC,IAFCw/D,EAEF,EAFEA,QAASvE,EAEX,EAFWA,YAAaC,EAExB,EAFwBA,aAAc7zC,EAEtC,EAFsCA,OAAQigC,EAE9C,EAF8CA,YAAaC,EAE3D,EAF2DA,WAGrD13D,EAAW6M,cACXmkE,EAAc9wE,mBAAQ,WAC1B,IAAM+mB,EAAO8V,GAAe4yC,GACtBsB,EAAiBr5C,GAAa+3C,EAAQhiD,SAAU6J,GACtD,OAAOvQ,EAAOgqD,EAAH,YAAyBA,EAAzB,QACV,CAACz5C,EAAQm4C,IAENnb,EAAcnzD,uBAClB,SAAC+G,GACCpI,EAAS,CACPhB,KAAMkZ,GACN7Y,MAAO+I,EAAMirB,OAAOh0B,MACpBmC,GAAImuE,EAAQnuE,OAGhB,CAACxB,EAAU2vE,EAAQnuE,KAGrB,OACE,0DAAQ4pE,GAAiBC,GAAzB,aACE,cAAC,GAAD,CACEl7D,IAAKA,EACLsnD,YAAaA,EACbp4D,MAAO2xE,EACP3mB,OAAQmK,EACRx1D,KAAK,SACLwD,MAAO,CAAEkb,QAAS,iBAClBg6C,WAAYA,OAMLv8B,4BAAW41C,gBCzC1B,SAASG,wBAAT,GASI,IARFvB,EAQC,EARDA,QACA7tE,EAOC,EAPDA,QACAw7B,EAMC,EANDA,WACAv9B,EAKC,EALDA,UACAywE,EAIC,EAJDA,yBACAC,EAGC,EAHDA,iBACAC,EAEC,EAFDA,OACA9G,EACC,EADDA,SAEM+G,EAASzwE,mBAAQ,WACrB,OAAOsiB,IAAUmtD,EAAS,6BAA8B,MACvD,CAACA,IAEEwB,EAAQjxE,mBAAQ,WACpB,OAAOo9B,EAAWv8B,UAAYhB,EAAUgB,SACpC,CACE4c,MAAO,MACP+W,WAAY,QAEd,OACH,CAAC4I,EAAWv8B,SAAUhB,EAAUgB,WAE7B6vE,EAA0BvvE,uBAC9B,SAAC4lB,GACCupD,EAAyBvpD,KAE3B,CAACupD,IAEG/sC,EAAgBpiC,uBACpB,SAACM,GACC+uE,EAAO/uE,EAAG27B,KAEZ,CAACA,EAAYozC,IAGf,OACE,8CAAQ5uE,GAAR,IAAiBG,QAASwhC,EAAejhC,MAAO2uE,EAAhD,SACGR,GAAUA,EAAO5sE,OAAS,EACzB,sBACEhC,aAAc,+BAAM6uE,GAAwB,IAC5C5uE,aAAc,+BAAM4uE,GAAwB,IAF9C,UAIGD,EAAO5sE,OAAQ,IAChB,8BACE,wBACE/E,KAAK,SACLwD,MAAO,CACLg9B,WAAYixC,EAAmB,UAAY,SAC3C/yD,QAAS,EACTzK,OAAQ,GAEVhR,QAAS,iBAACN,GAAD,OAAOioE,EAASjoE,GAAG,IAP9B,SASE,cAAC,KAAD,CAAegc,MAAM,eAIzB2f,EAAWv8B,SACb,IAEA,MAMRmwE,wBAAwBllE,aAAe,CACrClK,QAAS,0BAAM,MACf0uE,yBAA0B,2CAAM,MAChCE,OAAQ,yBAAM,MACd9G,SAAU,2BAAM,OAGHzqD,sBAAK+xD,yBC1EL,SAASE,UAAUv8C,GAChC,OAAO,SAACx1B,EAAOgyE,GAAwC,IAA9Bj6C,EAA6B,uDAApB,GAAIC,EAAgB,uDAAP,GACvCG,EAAShV,IAAUqS,EAAaw8C,EAAU,SAChD,OAAOz5C,GAAav4B,EAAOm4B,EAAQJ,EAAQC,ICqDhCi6C,I,MAAAA,GAnDf,SAASA,kBAAT,GAMI,IALF3B,EAKC,EALDA,QACAC,EAIC,EAJDA,cACA/6C,EAGC,EAHDA,YACA4iC,EAEC,EAFDA,YACAC,EACC,EADDA,WAEM13D,EAAW6M,cACXyvB,EAASqzC,EAAQS,cAAc9zC,OAC/B9E,EAAS45C,UAAUv8C,GAEnB2/B,EAAcnzD,uBAClB,SAAC+G,GACCpI,EAAS,CACPhB,KAAMmZ,GACNlZ,QAAS,CACPI,MAAO+I,EAAMirB,OAAOh0B,MACpBkyE,QAAS5B,EAAQnuE,GACjBm+B,SAAUrD,EAAO96B,QAIvB,CAACxB,EAAU2vE,EAASrzC,EAAO96B,KAEvBgwE,EAAmBnwE,uBAAY,WACnCo2D,EAAYn7B,EAAO96B,MAClB,CAACi2D,EAAan7B,EAAO96B,KAExB,OAAK86B,EAGH,8CAAQszC,GAAR,aACI7wC,kBAAkBzC,EAAOnb,aAAc,CAAC,MAMxC,cAAC,GAAD,CACEs2C,YAAa+Z,EACbnyE,MAAOi9B,EAAO3C,MAAMtY,QAAQ,GAC5BgpC,OAAQmK,EACRx1D,KAAK,SACLwD,MAAO,CAAEkb,QAAS,iBAClBg6C,WAAYA,IAZf,UACIlgC,EAAOm4C,EAAQ3qE,KAAM,cADzB,cAC4CwyB,EACzCm4C,EAAQxvD,GACR,gBAPY,6BAAK,MClBrB2xC,GAAsB/gD,YAAH,8DAInBghD,GAAgChhD,YAAH,4DAwMpB0gE,OApMf,SAASA,eAAT,GAOI,IANF9B,EAMC,EANDA,QACA/F,EAKC,EALDA,SACA5Q,EAIC,EAJDA,cACA0Y,EAGC,EAHDA,kBACA78C,EAEC,EAFDA,YAEC,IADD88C,UAAaC,EACZ,EADYA,cAAeC,EAC3B,EAD2BA,YAEtB3uC,EAAkB9E,cAAcuxC,EAAQnuE,IACxC2hC,EAAiB5iC,aACrB,CAAC2iC,EAAgB1hC,IAAI46B,OAAO8G,EAAgB7E,SAASh0B,GAAK,KAEtDynE,EAAmB1zC,cAAcuxC,EAAQS,cAAc5uE,IACvDuwE,EAAkBxxE,aACtB,CAACuxE,EAAiBtwE,IAAI46B,OAAO01C,EAAiBzzC,SAASh0B,GAAK,KAExDwjC,EAAgBxtC,eATrB,EAW4D+I,oBAAS,GAXrE,mBAWM4oE,EAXN,KAWmCC,EAXnC,OAY8D7oE,oBAC7D,GAbD,mBAYM8oE,EAZN,KAYoCC,EAZpC,KAgBKC,EAAYhB,UAAUv8C,GAEtBu2C,EAAclrE,mBAAQ,WAC1B,MAAO,CACLmyE,QAAS1C,EAAQS,cAAciC,QAC/B7vE,MAAOggB,IAAUmtD,EAAQS,cAAe,QAAQ,GAC5C,CAAE1hE,QAAS,QACX,QAEL,CAACihE,EAAQS,gBAENkC,EAAgBjxE,uBACpB,SAACM,EAAG+6B,GAEE/6B,GACFA,EAAEE,kBAGJ+nE,EACE+F,EACAjzC,EACAla,IAAUmtD,EAAS,iCAA6BvoD,SAE3BA,IAAnBsV,EACEA,GACFu1C,GAAsB,GACtB/uC,EAAgB5E,UAAU,OAE1B6zC,GAAuB,GACvBL,EAAiBxzC,UAAU,OAG7B2zC,GAAsB,GACtBE,GAAuB,MAG3B,CAACjvC,EAAiB4uC,EAAkBlI,EAAU+F,IAG1C4C,EAAclxE,uBAAY,SAACM,EAAG27B,GAClC37B,EAAEE,kBACFy7B,EAAWr7B,QAAQ,OAClB,IAEGopE,EAAenrE,mBAAQ,WAC3B,MAAO,CACL6B,aAAc,wBACZmhC,EAAgBnhC,aAAa,KAC7BohC,EAAe/hC,QAEjBY,aAAc,wBACZkhC,EAAgBlhC,aAAa,KAC7BmhC,EAAe7hC,WAGlB,CAAC4hC,EAAiBC,IAEfysC,EAAgB1vE,mBAAQ,WAC5B,MAAO,CACL6B,aAAc,wBACZ+vE,EAAiB/vE,aAAa,KAC9BgwE,EAAgB3wE,QAElBY,aAAc,wBACZ8vE,EAAiB9vE,aAAa,KAC9B+vE,EAAgBzwE,WAGnB,CAACwwE,EAAkBC,IAEhBS,EAAQtyE,mBAAQ,WACpB,OAAOijC,EAAepiC,UAAYmiC,EAAgBniC,SAC9C+wD,GACAtvC,IAAUmtD,EAAS,yCAAyC,GAC5D5d,GACA,OACH,CAAC7uB,EAAgBniC,SAAUoiC,EAAepiC,SAAU4uE,IAEvD,OACE,2CACE3W,cAAe,uBAACr3D,GAAD,OAAOq3D,EAAcr3D,EAAGguE,IACvC5+D,IAAKyhE,GACDrvC,EAAerhC,SAHrB,cAKE,yDAAQspE,GAAiBC,GAAzB,aACGsE,EAAQS,cAAcqC,SAAW,KAGnCxH,gBAAgBp2C,EAAa,aAC5B,aAAC,GAAD,CACEx1B,MAAOswE,EAAQ3qE,KACfomE,YAAaA,EACbC,aAAcA,EACd7zC,OAAQ46C,EAAU,cAGrBnH,gBAAgBp2C,EAAa,WAC5B,aAAC,GAAD,CACEx1B,MAAOswE,EAAQxvD,GACfirD,YAAaA,EACbC,aAAcA,EACd7zC,OAAQ46C,EAAU,cAItB,aAAC,GAAD,CACEzC,QAASA,EACTC,cAAeA,EACf/6C,YAAaA,EACb4iC,YAAa,qBAACib,GAAD,OAAchB,EAAkB,SAAD,UAAcgB,KAC1Dhb,WAAYma,EAAYlC,EAAQS,cAAc9zC,OAAO96B,MAGtDypE,gBAAgBp2C,EAAa,iBAC5B,aAAC,GAAD,CACE86C,QAASA,EACTvE,YAAaA,EACbC,aAAcA,EACd7zC,OAAQ46C,EAAU,kBAClB3a,YAAa,8BAAMia,EAAkB,WAAY/B,EAAQnuE,KACzDk2D,WAAYka,EAAcjC,EAAQnuE,MAIrCypE,gBAAgBp2C,EAAa,iBAC5B,aAAC,GAAD,CACEx1B,MAAOswE,EAAQ/iD,SACfw+C,YAAaA,EACbC,aAAcA,EACd7zC,OAAQ46C,EAAU,oBAItB,6CAAQxC,GAAR,aACGptD,IAAUmtD,EAAS,oCAAqC,OAG3D,aAAC,GAAD,CAAgBA,QAASA,EAASC,cAAeA,IAEjD,aAAC,GAAD,CACED,QAASA,EACTryC,WAAYw0C,EACZ/xE,UAAWgyE,EACXjwE,QAAS8tE,EACTa,iBAAkByB,EAClB1B,yBAA0B,kCAACvpD,GAAD,OAAUkrD,EAAuBlrD,IAC3DypD,OAAQ6B,EACR3I,SAAU0I,IAGZ,aAAC,GAAD,CACE3C,QAASA,EACTryC,WAAY4F,EACZnjC,UAAWojC,EACXrhC,QAASupE,EACToF,iBAAkBuB,EAClBxB,yBAA0B,kCAACvpD,GAAD,OAAUgrD,EAAsBhrD,IAC1DypD,OAAQ6B,EACR3I,SAAU0I,EACVlH,YAAaA,EACbv9B,cAAeA,IAGjB,aAAC,GAAD,CACE8hC,QAASA,EACTC,cAAeA,EACfvE,aAAcA,EACdD,YAAaA,SCtKNuH,I,GAAAA,GAjDf,SAASA,aAAazuE,GACpB,OAAOhE,mBAAQ,WACb,IAAM0yE,EAAc,GA2CpB,OA1CA1uE,EAAK6D,SAAQ,SAACtE,EAAOK,GACS,IAAxBL,EAAM64B,OAAOv4B,OACf6uE,EAAYhyE,KAAZ,2BACK6C,GADL,IAEE2sE,cAAc,2BACT3sE,EAAM2sE,eADE,IAEX9zC,OAAQ74B,EAAM64B,OAAO,GACrBm2C,SAAU3uE,EACV64B,YAAa,EACbn7B,GAAIiC,EAAM64B,OAAO,GAAG96B,QAGfiC,EAAM64B,OAAOv4B,OAAS,GAC/BN,EAAM64B,OAAOv0B,SAAQ,SAACu0B,EAAQpb,GAC5B,IAAI5f,GAAO,EACP+wE,EAAU,KACVnxD,EAAIzd,EAAM64B,OAAOv4B,OAAS,GAClB,IAANmd,EACFmxD,EAAU5uE,EAAM64B,OAAOv4B,OAKzBzC,GAAO,EAGTsxE,EAAYhyE,KAAZ,2BACK6C,GADL,IAEE2sE,cAAc,2BACT3sE,EAAM2sE,eADE,IAEX9zC,SACA+1C,UACA/wE,OACAmxE,SAAU3uE,EACV64B,YAAazb,EACb1f,GAAI86B,EAAO96B,cAOdoxE,IACN,CAAC1uE,KClCA2uE,GAAa9hE,YAAH,gmBA6ID+hE,OA1Gf,SAASA,YAAT,GAUI,IATFrY,EASC,EATDA,UACAsY,EAQC,EARDA,aACA5iD,EAOC,EAPDA,SACAy5C,EAMC,EANDA,SACA5gE,EAKC,EALDA,OACAgqE,EAIC,EAJDA,OACAtyE,EAGC,EAHDA,QACAikB,EAEC,EAFDA,UACAkQ,EACC,EADDA,YAEM7sB,EAAU2c,GAAaA,EAAU9c,QAAQ,SAAU,IACnDsxD,EAAa/oD,mBACblM,EAAOyuE,GAAalY,GAHzB,EAI6CoQ,GAAgB,KAAM3mE,GAJnE,mBAIM0tE,EAJN,KAIqBqB,EAJrB,OAKyCpI,GAAgB,KAAM3mE,GAL/D,mBAKM2tE,EALN,KAKmBqB,EALnB,KAMO9a,EAAY36C,YAAZ26C,QAEFtiC,EAAY,SAAZA,UAAa70B,GACjB,OAAOuhB,IAAUqS,EAAa5zB,GAAK,IAG/Bu3D,EAAqBn3D,uBACzB,SAACM,EAAGguE,GACGxnE,0BAA0BxG,KAC7BA,EAAEC,iBACFu3D,EAAWtnD,QAAQ0mD,kBAAkB52D,EAAGguE,MAG5C,CAACxW,IAGGga,EAAyB9xE,uBAC7B,SAACi6B,EAAW95B,GACQ,aAAd85B,EACF23C,EAAqBzxE,GACE,WAAd85B,GACT43C,EAAmB1xE,KAGvB,CAACyxE,EAAsBC,IAkBzB,OAfApyE,qBAAU,WACR,IAAMsyE,EAAkB,SAAlBA,kBACJD,EAAuB,WAAY,MACnCA,EAAuB,SAAU,OAKnC,OAHI/a,GACFA,EAAQ1lD,iBAAiB,YAAa0gE,GAEjC,WACDhb,GACFA,EAAQzlD,oBAAoB,YAAaygE,MAG5C,CAACD,EAAwB/a,IAG1B,aAAC,WAAD,WACE,sBAAOrnD,IAAK8hE,GAAZ,UACE,+BACE,6BACE,kCACC/8C,EAAU,YAAc,qCAAgB,KACxCA,EAAU,UAAY,mCAAc,KACrC,6CACCA,EAAU,gBAAkB,qCAAU9tB,KAAgB,KACtD8tB,EAAU,gBAAkB,yCAAoB,KACjD,sCACA,uCACA,4BACE,aAAC,KAAD,CAAQtzB,MAAO,CAAEqb,SAAU,QAE7B,uCACA,qCACA,4BAAK,UAGT,+BACG3Z,GACCA,EAAKuW,KAAI,SAAChX,EAAOK,GACf,OACE,aAAC,GAAD,CAGE6rE,QAASzrE,EAAKJ,GACdivE,aAAcA,EACd5iD,SAAUA,EACVy5C,SAAUA,EACV5gE,OAAQA,EACRgqE,OAAQA,EACRha,cAAe,uBAACr3D,EAAGguE,GAAJ,OAAgBnX,EAAmB72D,EAAGguE,IACrD96C,YAAaA,EACb68C,kBAAmByB,EACnBxB,UAAW,CAAEC,gBAAeC,gBAZ9B,wBAEwB/tE,YAgBlC,aAAC,GAAD,CAAaqM,IAAKgpD,EAAYz4D,QAASA,QCnIvCyN,GAAS,CACbq7D,QAAS,CACP96D,QAAS,OACTO,cAAe,MACf+3B,aAAc,mCAEhB5kC,UAAW,CACT6M,cAAe,SACfvJ,OAAQ,OACRgJ,QAAS,QAEX2kE,UAAW,CACTjkE,aAAc,MACdw6C,UAAW,MACXjsC,MAAO,QACPlP,gBAAiB,UACjBuqB,OAAQ,OACRtzB,OAAQ,OACRD,MAAO,OACPoY,SAAU,OACVH,QAAS,GAEXgsD,wBAAyB,CACvBt6D,aAAc,MACdw6C,UAAW,MACXiD,WAAY,MACZ7zB,OAAQ,OACRtzB,OAAQ,OACRD,MAAO,OACPoY,SAAU,OACVH,QAAS,GAEX41D,+BAAgC,CAC9BlkE,aAAc,MACdw6C,UAAW,MACXiD,WAAY,MACZlvC,MAAO,QACPlP,gBAAiB,cACjBuqB,OAAQ,OACRtzB,OAAQ,OACRD,MAAO,OACPoY,SAAU,OACVH,QAAS,GAEXlU,OAAQ,CACNiF,gBAAiB,cACjBuqB,OAAQ,SAIZ,SAASu6C,iBAAT,GAUI,IATF53C,EASC,EATDA,OACAtxB,EAQC,EARDA,EACAC,EAOC,EAPDA,EACA2V,EAMC,EANDA,KACA2G,EAKC,EALDA,QACAiO,EAIC,EAJDA,YACAlQ,EAGC,EAHDA,UACAkX,EAEC,EAFDA,UACAha,EACC,EADDA,QACC,EAC2CzY,oBAAS,GADpD,mBACM0gE,EADN,KACsBxM,EADtB,KAEKpgC,EAAiBiB,oBAEjBn+B,EAAW6M,cACXrF,EAAQ+3C,KALb,EAMkCn2C,oBAAS,GAN3C,mBAMMq0D,EANN,KAMiBC,EANjB,KAOKC,EAAavtD,mBAEbojE,EAAatzE,mBAAQ,WACzB,IAAMuzE,EAAW,SAAXA,SAAYzuE,EAAMmb,GACtB,IAAMi0B,EAAS,IAGf,OADApvC,GAAcovC,GADdj0B,GAAUi0B,IAGDxtB,EAAQ,GAAKwtB,GAAUpvC,GAAQ4hB,EAAQ,GAAKwtB,GAClDpvC,GAAQ4hB,EAAQ,GAAKwtB,GAAUj0B,GAAMyG,EAAQ,GAAKwtB,GAQvD,OAAIzY,EAAOzF,QACO4zC,EALQ,SAApB4J,kBAAqB/3C,GACzB,OAAOA,EAAO14B,QAAO,SAACQ,GAAD,OAAWgwE,EAAShwE,EAAMuB,KAAMvB,EAAM0c,OAKvDuzD,CAAkB/3C,EAAOzF,QACzByF,EAAOzF,QAEIzb,KAAI,SAAChX,GAClB,OAAO,2BACFA,GADL,IAEE2sE,cAAe,CACbnX,wBAAyBwa,EAAShwE,EAAMuB,KAAMvB,EAAM0c,UAKrD,KACN,CAAC2pD,EAAgBnuC,EAAOzF,OAAQtP,IAE7B+sD,EAAqBtyE,uBACzB,SAACg6B,EAAWqB,EAAgBC,GAC1B38B,EAAS,CACPhB,KAAMsZ,GACNrZ,QAAS,CACPo8B,YACA6B,iBACAR,iBACAC,mBAIN,CAACO,EAAgBl9B,IAGb4zE,EAA6BvyE,uBACjC,SAAChC,GACC,GAAIgL,GAAKC,EAAG,CAAC,IACHtF,EAAa3F,EAAb2F,KAAMmb,EAAO9gB,EAAP8gB,GADJ,EAEqBC,aAAgB/V,EAAG,CAChDrF,OACAmb,OAFME,EAFE,EAEFA,UAAWC,EAFT,EAESA,QAKbuzD,EAAe,aACnBxpE,EAAGA,EAAEvH,MAAMud,EAAWC,GACtBhW,EAAGA,EAAExH,MAAMud,EAAWC,IACnBjhB,GAGW+E,aACdQ,KAAKC,UAAUgvE,OAAiBzsD,EAAW,IAI3C5f,EAAMpG,KAAK,4BAEXoG,EAAM0rC,MAAM,+BAIlB,CAAC7oC,EAAGC,EAAG9C,IAGHssE,EAAoB5zE,mBAAQ,WAKhC,OAHEsiB,IAAUqS,EAAD,oCAA2ClQ,EAA3C,OACToM,KAGD,CAACpM,EAAWkQ,IAETk/C,EAAc7zE,mBAClB,iBAAM,CACJ,CACEqtB,MAAO,oBACPtrB,QAAS2xE,MAGb,CAACA,IAGGI,EAAgB3yE,uBAAY,WAChCi8D,GAAmBwM,KAClB,CAACA,IAEE/L,EAAuB18D,uBAAY,WACvCq8D,GAAeD,KACd,CAACA,IAEEO,EAAqB38D,uBAAY,WACrCs8D,EAAW9rD,QAAQ4qD,cACnBiB,GAAc,KACb,IAEH,OACE,mCACE,sBAAKl7D,MAAO2L,GAAO/L,UAAnB,WACIq7D,GACA,cAAC,GAAD,CACE9hC,OAAQA,EACR1b,KAAMA,EACN0E,UAAWA,EACXkX,UAAWA,EACX+tC,SAAU+J,EACV9J,kBAAmBmK,EACnB5c,eAAgB2G,EAChB+L,eAAgBA,EAChBC,cAAeyJ,EAAWzvE,SAG7B05D,GACC,cAAC,GAAD,CACEpT,OAAQ2T,EACRzuD,QAASwuD,IAGb,qBAAKv7D,MAAO,CAAEkD,OAAQ,OAAQkL,SAAU,QAAxC,SACE,eAAC,KAAD,CACE6sD,UAAWA,EACXU,UAAQ,EACRttD,eAAgB,CAAED,SAAU,UAH9B,UAKE,8BACG4iE,GAAcA,EAAWzvE,OAAS,EACjC,cAAC,GAAD,CACE4gB,UAAWA,EACX81C,UAAW+Y,EACX5J,SAAU+J,EACVjzE,QAASqzE,EACTl/C,YAAai/C,IAGf,cAAC,GAAD,MAGJ,cAAC,GAAD,CACEn4C,OAAQA,EACRxrB,IAAKwtD,EACL97C,QAASA,EACTgT,YAAaA,cASZ+G,UAAczc,eAAKo0D,mBChOnBU,OArBf,SAASA,cAAcl5C,GACrB,IAAMvqB,EAAU,SAAVA,QAAW3Q,GAAW,IAAD,EACkC6M,eAAnDxI,EADiB,EACjBA,KAAMsb,EADW,EACXA,eAAgBmF,EADL,EACKA,UAAWinB,EADhB,EACgBA,cAEjC3Q,EAA0Bp7B,EAA1Bo7B,aAAiBC,EAHA,aAGSr7B,EAHT,kBAIzB,OACE,cAACk7B,EAAD,2BACMG,GADN,IAEEh3B,KAAMA,EACNsb,eAAgBA,EAChBmF,UAAWA,EACXinB,cAAeA,EACfz7B,IAAK8qB,MAKX,OAAOE,sBAAW,SAACt7B,EAAOsQ,GACxB,OAAO,cAACK,EAAD,2BAAa3Q,GAAb,IAAoBo7B,aAAc9qB,SCC7C,SAAS+jE,mBAAT,GAMI,IALFhwE,EAKC,EALDA,KACAsb,EAIC,EAJDA,eACAmF,EAGC,EAHDA,UACAinB,EAEC,EAFDA,cACAuoC,EACC,EADDA,UAEMxiE,EAAQzD,IACR1G,EAAQ+3C,KACRv/C,EAAW6M,cAEXu1D,EAAe/gE,uBAAY,WAC/BsQ,EAAMY,kBAAkB,6CAA8C,CACpErB,MAAO,iBACLlR,EAAS,CAAEhB,KAAM0W,UAGpB,CAAC1V,EAAU2R,IAERyiE,EAA0B/yE,uBAAY,WAC1C,IAAMgzE,EAAkBF,EAAU15D,KAAI,SAACgK,GACrC,OAAOA,EAAMjjB,MAEfxB,EAAS,CAAEhB,KAAM2V,GAAmBnT,GAAI6yE,MACvC,CAACr0E,EAAUm0E,IAERG,EAA0BjzE,uBAAY,WAC1CrB,EAAS,CAAEhB,KAAM2V,GAAmBnT,GAAI,OACvC,CAACxB,IAEEu0E,EAA8BlzE,uBAAY,WAa9C,IAAMmzE,EAZN,SAAS14B,qBAAqB24B,GAC5B,IAAI5yD,EAAU8C,EAAUwB,MAAM,KAC9BtE,EAAUA,EAAQ,KAAOA,EAAQ,GAAK,CAACA,EAAQ,IAAMA,EACrD,IAH2C,EAGrC2yD,EAAiB,GAHoB,eAI3B3yD,GAJ2B,+BAIhCqV,EAJgC,QAKpBu9C,EAAczzE,MAAK,SAAC4b,GAAD,OAAOA,EAAEqD,KAAK4B,UAAYqV,MAEhEs9C,EAAe5zE,KAAKs2B,IAHxB,2BAA0B,IAJiB,8BAU3C,OAAOs9C,EAEc14B,CAAqB53C,GACxCswE,EAAezwE,OAAS,EAC1B/D,EAAS,CAAEhB,KAAMgZ,GAAwB6J,QAAS2yD,IAElDhtE,EAAM0rC,MAAM,0BAEb,CAACvuB,EAAWnd,EAAOtD,EAAMlE,IAEtB00E,EAAoBrzE,uBAAY,WACpCrB,EAAS,CAAEhB,KAAMoa,OAChB,CAACpZ,IACE20E,EAAoBtzE,uBAAY,WACpCrB,EAAS,CAAEhB,KAAMqa,OAChB,CAACrZ,IAEJ,OACE,eAAC,GAAD,CACEmwB,SAAUiyC,EACVtL,QAASqd,GAAaA,EAAUpwE,OAChCgzD,cAAc,qBAHhB,UAKE,cAAC,GAAD,CAAS74C,MAAM,mBAAmBD,eAAe,QAAjD,SACE,wBAAQjf,KAAK,SAASiD,QAASqyE,EAA/B,SACE,cAAC,KAAD,QAGJ,cAAC,GAAD,CAASp2D,MAAM,mBAAmBD,eAAe,QAAjD,SACE,wBAAQjf,KAAK,SAASiD,QAASmyE,EAA/B,SACE,cAAC,KAAD,QAGH50D,GAAkBmF,GAAaA,EAAUwB,MAAM,KAAKpiB,OAAS,GAC5D,cAAC,GAAD,CAASma,MAAM,yBAAyBD,eAAe,QAAvD,SACE,wBAAQjf,KAAK,SAASiD,QAASsyE,EAA/B,SACE,cAAC,KAAD,QAIL3oC,IAAkBN,GAAeC,OAChC,qCACE,cAAC,GAAD,CAASrtB,MAAM,cAAcD,eAAe,QAA5C,SACE,wBAAQjf,KAAK,SAASiD,QAAS0yE,EAA/B,SACE,cAAC,KAAD,QAGJ,cAAC,GAAD,CAASz2D,MAAM,WAAWD,eAAe,QAAzC,SACE,wBAAQjf,KAAK,SAASiD,QAASyyE,EAA/B,SACE,cAAC,KAAD,cASCT,UAAc90D,eAAK+0D,qBC1HlC,SAASU,cAAcvrB,GACrB,IAAMxnC,EAAUwnC,EAAMljC,MAAM,KAC5B,OAAOtE,EAAQgD,QAAO,SAACC,EAAKhhB,GAC1B,IAAM+wE,EAA+B,IAAnBhzD,EAAQ9d,OAAe,IAAM,EAE/C,OADA+gB,GAAOyS,OAAOzzB,EAAE+D,QAAQ,MAAO,KAAOgtE,IAErC,GAEL,IAmBeC,GAnBQ,SAAjBA,eAAkB7zE,GAAD,OAAS,SAACojC,GAAmC,IAA5B0wC,EAA2B,wDAC3DC,EAAiB3wC,EAAMxf,QAAO,SAACowD,EAAmBC,GACtD,IAAM71E,EAAQ61E,EAAIj1D,KAAKhf,GAEvB,OADAg0E,EAAkB51E,IAAU41E,EAAkB51E,IAAU,IAAI+8B,OAAO84C,GAC5DD,IACN,IAEH,OAAKF,EAGIx1E,OAAOC,KAAKw1E,GAChBx7C,MAAK,SAACr1B,EAAG6C,GAAJ,OAAU4tE,cAAczwE,GAAKywE,cAAc5tE,MAChD6d,QAAO,SAACC,EAAK7jB,GAEZ,OADA6jB,EAAI7jB,GAAO+zE,EAAe/zE,GACnB6jB,IACN,IAPEkwD,ICdX,SAASG,iBAAT,GAAiD,IAArBx3D,EAAoB,EAApBA,MAAOy3D,EAAa,EAAbA,UACjC,OACE,qBACE5yE,MAAO,CACLiM,gBAAiBkP,EACjBjY,OAAQ,OACRD,MAAO,OACP9C,QAASyyE,EAAY,EAAI,GACzB1mE,QAAS,kBAKjB,SAAS2mE,iBAAT,GAAwE,IAA5ClqC,EAA2C,EAA3CA,cAAeE,EAA4B,EAA5BA,cAAe+pC,EAAa,EAAbA,UACxD,OACE,qBACE3vE,MAAM,KACNC,OAAO,KACPgX,QAAQ,YACR/Z,QAASyyE,EAAY,EAAI,GAJ3B,SAME,8BACE,sBAAMx4D,EAAE,gBAAgBD,KAAMwuB,EAAehc,YAAY,MACzD,sBAAMvS,EAAE,iBAAiBD,KAAM0uB,EAAelc,YAAY,WAMlE,SAASmmD,eAAT,GAA0E,IAAhD5wD,EAA+C,EAA/CA,UAAW/G,EAAoC,EAApCA,MAAOy3D,EAA6B,EAA7BA,UAAWnzE,EAAkB,EAAlBA,QAASO,EAAS,EAATA,MAC9D,OACE,wBAAQA,MAAOA,EAAOxD,KAAK,SAASiD,QAASA,EAA7C,SACiB,IAAdyiB,EACC,cAAC2wD,iBAAD,2BAAsB13D,GAAtB,IAA6By3D,UAAWA,KAExC,cAACD,iBAAD,aAAkBC,UAAWA,GAAez3D,MAMrCwB,sBAAKm2D,gBCZLC,OA5Bf,SAASA,sBAAT,GAKI,IAJFrxE,EAIC,EAJDA,KACAsxE,EAGC,EAHDA,0BACAC,EAEC,EAFDA,eACAjzE,EACC,EADDA,MAMA,OACE,wBACEA,MAAK,2BACAA,GADA,IAEHG,QARkB,SAAlB+yE,gBAAmBl0E,GACvB,OAAyD,IAAlDi0E,EAAen8C,WAAU,SAACstB,GAAD,OAAOA,EAAEplD,KAAOA,KAQ1Ck0E,CAAgBxxE,EAAK1C,KAAO0C,EAAKu1B,OAASv1B,EAAKu1B,MAAMvD,OAAOnyB,OAAS,EACjE,EACA,KAER/E,KAAK,SACLiD,QAAS,0BAAMuzE,EAA0BtxE,IACzCf,SAAUe,EAAKu1B,OAAsC,IAA7Bv1B,EAAKu1B,MAAMvD,OAAOnyB,OAV5C,SAYE,cAAC,KAAD,OCyDS4xE,OAhFf,SAASA,uBAAT,GAAsE,IAApCzxE,EAAmC,EAAnCA,KAAM0xE,EAA6B,EAA7BA,mBAAoBpzE,EAAS,EAATA,MACpDszB,EAAY,SAAZA,UAAat0B,EAAIP,GACrB,OAAOiD,GAAOA,EAAKwK,QAAQzN,IAE7B,OACE,qCAC2B,IAAxBiD,EAAK+b,KAAKyE,WACT,wBACEliB,MAAOA,EACPxD,KAAK,SACLiD,QAAS,0BAAM2zE,EAAmB1xE,EAAM,cAH1C,SAKE,cAAC,KAAD,CACE1B,MAAK,aACHma,KAAMzY,EAAKwK,QAAQiP,OAEfmY,EAAU5xB,EAAK1C,GAAI,aACnB,CACEmB,QAAS,EACTwsB,YAAa,MACbxS,KAAMzY,EAAKwK,QAAQiP,OAErB,CACEhb,QAAS,GACTga,KAAMzY,EAAKwK,QAAQiP,YAMR,IAAxBzZ,EAAK+b,KAAKyE,WACT,sBAAKliB,MAAO,CAAE0M,SAAU,QAAxB,UACE,wBACE1M,MAAK,2BAAOA,GAAP,IAAciD,MAAO,OAAQyJ,SAAU,SAC5ClQ,KAAK,SACLiD,QAAS,0BAAM2zE,EAAmB1xE,EAAM,sBAH1C,SAKE,cAAC,KAAD,CACE1B,MAAK,aACHma,KAAMzY,EAAKwK,QAAQy8B,eACfrV,EAAU5xB,EAAK1C,GAAI,qBACnB,CACEmB,QAAS,EACTwsB,YAAa,MACbxS,KAAMzY,EAAKwK,QAAQy8B,eAErB,CACExoC,QAAS,GACTga,KAAMzY,EAAKwK,QAAQy8B,oBAK/B,wBACE3oC,MAAK,2BAAOA,GAAP,IAAciD,MAAO,OAAQyJ,SAAU,SAC5ClQ,KAAK,SACLiD,QAAS,0BAAM2zE,EAAmB1xE,EAAM,sBAH1C,SAKE,cAAC,KAAD,CACE1B,MAAK,aACHma,KAAMzY,EAAKwK,QAAQ28B,eACfvV,EAAU5xB,EAAK1C,GAAI,qBACnB,CACEmB,QAAS,EACTwsB,YAAa,MACbxS,KAAMzY,EAAKwK,QAAQ28B,eAErB,CACE1oC,QAAS,GACTga,KAAMzY,EAAKwK,QAAQ28B,2BCjEnCl9B,GAAS,CACb3E,OAAQ,CACNiF,gBAAiB,cACjBuqB,OAAQ,OACRvzB,MAAO,OACPyJ,SAAU,QAEZ8tC,IAAK,CACHtuC,QAAS,OACTmnE,aAAc,SACdnwE,OAAQ,OACRshC,aAAc,wBAEhBhtB,KAAM,CACJzI,KAAM,EACN7L,OAAQ,OACRgJ,QAAS,QAEXuR,KAAM,CACJ1O,KAAM,UACN7L,OAAQ,OACRgJ,QAAS,QACTE,WAAY,SACZgC,SAAU,SACVk8C,aAAc,WACdlvC,WAAY,SACZ6qC,WAAY,QAEdqtB,KAAM,CACJpnE,QAAS,OACTuE,OAAQ,OACRtE,eAAgB,WAIpB,SAASonE,iBAAT,GASI,IARFv2D,EAQC,EARDA,eACAi2D,EAOC,EAPDA,eACAvxE,EAMC,EANDA,KACA0xE,EAKC,EALDA,mBACAJ,EAIC,EAJDA,0BACAQ,EAGC,EAHDA,uBACAC,EAEC,EAFDA,mBACAjd,EACC,EADDA,cASMoc,EAAY51D,GAAkBA,EAAehe,KAAO0C,EAAK1C,GAR9D,EASqD0C,EAAKwK,QAAnDiP,EATP,EASOA,MAAO3D,EATd,EAScA,KAAMmxB,EATpB,EASoBA,cAAeE,EATnC,EASmCA,cACpC,OACE,sBACE7oC,MAAK,2BACA2L,GAAO6uC,KACNo4B,EACA,CAAE3mE,gBAAiB,WACnB,CAAE9L,QAAS6c,EAAiB,GAAM,IAExCw5C,cAAeA,EAPjB,UASE,cAAC,GAAD,CACE90D,KAAMA,EACN0xE,mBAAoBA,EACpBpzE,MAAO2L,GAAO3E,SAGhB,sBAAKhH,MAAO2L,GAAO6L,KAAM/X,QAAS,0BAAM+zE,EAAuB9xE,IAA/D,UACE,qBAAK1B,MAAK,2BAAO2L,GAAO2nE,MAAd,IAAoBrwE,MAAO,SAArC,SACGvB,EAAK+b,KAAKiI,MACT,cAAC,KAAD,IAC0B,IAAxBhkB,EAAK+b,KAAKyE,UACZ,cAAC,KAAD,IAEA,cAAC,KAAD,MAGJ,sBAAMliB,MAAO2L,GAAO8R,KAApB,SAA2BjG,IAC3B,qBACExX,MAAO2L,GAAO8R,KAEds/C,wBAAyB,CACvBC,OAAQt7D,EAAK+b,MAxCG,SAApBi2D,kBAAqB72E,GAKzB,OAJIA,IAEFA,EAAQA,EAAMwI,QAAQ,YAAa,kBAE9BxI,EAmCsB62E,CAAkBhyE,EAAK+b,KAAK43B,YAGrD,uBAAMr1C,MAAO2L,GAAO8R,KAApB,UACE,sBACEzd,MAAO,CACL2zE,WAAY,uBACZp9C,aAAc,SAGjB70B,EAAK+b,MAAQ/b,EAAK+b,KAAKgsB,cAK1B,sBAAMzpC,MAAO2L,GAAO8R,KAApB,SAA2B/b,EAAK+b,MAAQ/b,EAAK+b,KAAKm2D,WAGpD,cAAC,GAAD,CACElyE,KAAMA,EACN1B,MAAK,2BACA2L,GAAO2nE,MACP3nE,GAAO3E,QAEZgsE,0BAA2BA,EAC3BC,eAAgBA,IAElB,cAAC,GAAD,CACEjzE,MAAO2L,GAAO3E,OACdkb,UAAWxgB,EAAK+b,KAAKyE,UACrB/G,MAAO,CAAEwtB,gBAAextB,QAAO0tB,iBAC/B+pC,UAAWA,EACXnzE,QAAS,iBAACmG,GAAD,OAAW6tE,EAAmB/xE,EAAMkE,SAMrD2tE,iBAAiB/pE,aAAe,CAC9BgtD,cAAe,gCAAM,OAGR75C,sBAAK42D,kBC/HpB,SAASM,kBAAT,GAA+D,IAAlCzb,EAAiC,EAAjCA,cAAe5gD,EAAkB,EAAlBA,KAASna,EAAS,2CAC1BwoD,eAA1BnyB,EADoD,EACpDA,OAAQoyB,EAD4C,EAC5CA,cAEVguB,EAAqBj1E,uBACzB,SAACsc,GACCi9C,EAAcj9C,GACd2qC,EACEtuC,EADW,UAER2D,EAAMg3B,KAFE,OAEIzpC,KAAK+oC,MAAoB,IAAdt2B,EAAMk3B,IAAI1wC,GAASwf,SAAS,QAG1D,CAAC3J,EAAM4gD,EAAetS,IAGxB,OACE,cAAC,gBAAD,aACE3qC,MAAO,CAAEg3B,IAAKnyB,IAAU0T,EAAQlc,EAAM,SACtCu8D,aAAcljC,GACd8nB,iBAAkB,0BAACx5D,GAAD,OAAO20E,EAAmB30E,KACxC9B,IAKVw2E,kBAAkBrqE,aAAe,CAC/B4uD,cAAe,gCAAM,OAGRz7C,sBAAKk3D,mBCZLG,OAlBf,SAASA,kBAAT,GAAgD,IAAnBtyE,EAAkB,EAAlBA,KAAM2/C,EAAY,EAAZA,SAC3B0G,EAAUn6C,mBAEVqmE,EAAuBp1E,uBAAY,WACnCkpD,EAAQ14C,SACV04C,EAAQ14C,QAAQ44C,eAEjB,IAEH,OACE,cAAC,GAAD,CAAYt6C,IAAKo6C,EAAS3G,cAAe1/C,EAAM2/C,SAAUA,EAAzD,SACE,8BACE,cAAC,GAAD,CAAmB7pC,KAAK,QAAQ4gD,cAAe6b,S,UCZvD,SAASC,aAAT,GAA0D,IAAlCC,EAAiC,EAAjCA,cAAe38D,EAAkB,EAAlBA,KAASna,EAAS,2CACrBwoD,eAA1BnyB,EAD+C,EAC/CA,OAAQoyB,EADuC,EACvCA,cAEVC,EAAgBlnD,uBACpB,SAAChC,GACCs3E,EAAct3E,GACdipD,EAActuC,EAAM3a,KAEtB,CAAC2a,EAAM28D,EAAeruB,IAGxB,OACE,cAACsuB,GAAA,EAAD,aACE9tE,UAAU,oBACV+tE,eAAe,QACfC,eAAe,QACf/zD,aAAcP,IAAU0T,EAAQlc,EAAM,CAAC,EAAG,MAC1C28D,cAAepuB,EAGfwuB,YAAa,qBAACl3E,EAAOf,GAAR,OACX,+CAASe,GAAT,aACE,+BAAOf,EAAMk4E,eAGjBC,UAAQ,EACRC,YAAa,IACTr3E,IAKV62E,aAAa1qE,aAAe,CAC1B4uD,cAAe,gCAAM,OAGRz7C,I,GAAAA,kBAAKu3D,cCuCLS,I,GAAAA,GAvEf,SAASA,kBAAT,GAAgD,IAAnBjzE,EAAkB,EAAlBA,KAAM2/C,EAAY,EAAZA,SAC3B0G,EAAUn6C,mBAEV5N,EAAQuO,YAAH,yRAIe7M,EAAKinC,cAOLjnC,EAAKmnC,eAKzBorC,EAAuBp1E,uBAAY,WACvCkpD,EAAQ14C,QAAQ44C,eACf,IAEH,OACE,aAAC,GAAD,CAAYt6C,IAAKo6C,EAAS3G,cAAe1/C,EAAM2/C,SAAUA,EAAzD,SACE,oBAAK9yC,IAAKvO,EAAV,UACE,oBAAKsG,UAAU,WAAf,UACE,qBAAMtG,MAAO,CAAEkb,QAAS,UAAxB,sBACA,aAAC,GAAD,CACE1D,KAAK,gBACL4gD,cAAe6b,IAEjB,oBAAKj0E,MAAO,CAAEkb,QAAS,OAAvB,UACE,qBAAM5U,UAAU,QAAhB,0CACA,aAAC,GAAD,CACEkR,KAAK,wCACL28D,cAAeF,IAEjB,qBAAM3tE,UAAU,QAAhB,+BACA,aAAC,GAAD,CACEkR,KAAK,yCACLkf,SAAUu9C,EACVz3E,KAAK,iBAIX,oBAAK8J,UAAU,WAAf,UACE,qBAAMtG,MAAO,CAAEkb,QAAS,UAAxB,sBACA,aAAC,GAAD,CACE1D,KAAK,gBACL4gD,cAAe6b,IAEjB,oBAAKj0E,MAAO,CAAEkb,QAAS,OAAvB,UACE,qBAAM5U,UAAU,QAAhB,0CACA,aAAC,GAAD,CACEkR,KAAK,wCACL28D,cAAeF,IAEjB,qBAAM3tE,UAAU,QAAhB,+BACA,aAAC,GAAD,CACEkR,KAAK,yCACLkf,SAAUu9C,EACVz3E,KAAK,uBC7DbwD,GAAQuO,YAAH,opCAgEX,SAASqmE,gBAAT,GAA8E,IAAnD30E,EAAkD,EAAlDA,SAAkD,IAAxCyB,KAAQ1C,EAAgC,EAAhCA,GAAIye,EAA4B,EAA5BA,KAAMvR,EAAsB,EAAtBA,QAAWa,EAAW,EAAXA,QAC1DvP,EAAW6M,cAEX69C,EAAgBrpD,uBACpB,SAAC60B,GACCl2B,EAAS,CAAEhB,KAAMyV,GAAyBjT,KAAIkN,QAASwnB,MAEzD,CAACl2B,EAAUwB,IAGP2I,EAAe9I,uBACnB,SAACM,GACKA,EAAE0xB,SAAW1xB,EAAEqI,eACjBuF,MAGJ,CAACA,IAGKlF,EAAS5H,EAAT4H,EAAGC,EAAM7H,EAAN6H,EACX,OACE,oBAAKyG,IAAKvO,GAAOP,QAASkI,EAA1B,SACE,oBACErB,UAAU,kBACVtG,MAAO,CACLgM,KAAyB,IAAnByR,EAAKyE,UAAkBra,EAAI,IAAMA,EAAI,IAC3CqT,QAA4B,IAAnBuC,EAAKyE,UAAkB,SAAW,GAC3CrW,IAAK/D,GALT,SAQsB,IAAnB2V,EAAKyE,UACJ,aAAC,GAAD,CAAmBm/B,SAAU6G,EAAexmD,KAAMwK,IAElD,aAAC,GAAD,CAAmBm1C,SAAU6G,EAAexmD,KAAMwK,QAO5D,SAAS2oE,gBACP,OAAO,EAGMl4D,sBAAKi4D,gBAAiBC,eC6FtBpD,WAvLf,SAASqD,cAAT,GAA0E,IAAjDpzE,EAAgD,EAAhDA,KAAMsb,EAA0C,EAA1CA,eAAgBmF,EAA0B,EAA1BA,UAAW4yD,EAAe,EAAfA,YAClDpe,EAAa/oD,mBADoD,EAE3BhH,mBAAS,IAFkB,mBAEhEqsE,EAFgE,KAEhD+B,EAFgD,OAGnBpuE,mBAAS,MAHU,mBAGhEquE,EAHgE,KAG1CC,EAH0C,OAIftuE,mBAAS,MAJM,mBAIhEuuE,EAJgE,KAI1CC,EAJ0C,OAKTxuE,oBAAS,GALA,mBAKhEyuE,EALgE,KAKvCC,EALuC,KAOjEtwE,EAAQ+3C,KACRv/C,EAAW6M,cAEjB/L,qBAAU,WACR,GAAIoD,EAAM,CACR,IAAM6zE,EAAiB7zE,EACnBA,EAAKjB,QAAO,SAAC2Z,GAAD,OAA2C,IAApCA,EAAElO,QAAQgrB,yBAC7B,GAEJ89C,EAAkBO,MAEnB,CAAC7zE,EAAMlE,IAEV,IAAMg4E,EAA0B93E,mBAAQ,WACtC,OAAKgE,EACkB4wE,GAAe,UAC/BmD,CAAe/zE,GAAM,GAFV,KAGjB,CAACA,IAEJpD,qBAAU,WACRy2E,EAAY,CACVn0B,IAAKz+B,EACLzgB,KAAM8zE,EAAwBrzD,OAE/B,CAACA,EAAW4yD,EAAaS,IAE5B,IAAME,EAAgC72E,uBACpC,SAACub,GACC,IAAM84C,EAAe+f,EAAen8C,WAAU,SAACstB,GAAD,OAAOA,EAAEplD,KAAOob,EAAEpb,MAC1D22E,EAAU,aAAO1C,IACD,IAAlB/f,EACFyiB,EAAWv3E,KAAK,CAAEY,GAAIob,EAAEpb,KAExB22E,EAAWryC,OAAO4vB,EAAc,GAElC11D,EAAS,CAAEhB,KAAM4V,GAAiC1Q,KAAMi0E,IACxDX,EAAkBW,KAEpB,CAACn4E,EAAUy1E,IAGP2C,EAAqB/2E,uBACzB,SAAC+hD,GACCm0B,EAAY,CACVn0B,IAAKA,EAAIV,MACTx+C,KAAM8zE,EAAwB50B,EAAIV,SAGpC1iD,EAAS,CAAEhB,KAAMmY,GAAgBisC,IAAKA,EAAIV,UAE5C,CAAC1iD,EAAUu3E,EAAaS,IAGpBjE,EAAc7zE,mBAClB,iBAAM,CACJ,CACEqtB,MAAO,oBACPtrB,QAAS,iBAACs+B,GAAkB,IAClBl2B,EAAek2B,EAAfl2B,EAAGC,EAAYi2B,EAAZj2B,EAAG2V,EAASsgB,EAATtgB,KACE7b,aACdQ,KAAKC,UAAU,CAAEwF,IAAGC,IAAG2V,aAAQmH,EAAW,IAI1C5f,EAAMs4C,QAAQ,4BAEdt4C,EAAM0rC,MAAM,8BAIlB,CACE3lB,MAAO,SACPtrB,QAAS,iBAACs+B,GACRnjB,YAAW,WACTpd,EAAS,CAAEhB,KAAM0W,GAAgBlU,GAAI++B,EAAa/+B,OACjD,QAIT,CAACgG,EAAOxH,IAGJw4D,EAAqBn3D,uBACzB,SAACM,EAAGguE,GACGxnE,0BAA0BxG,KAC7BA,EAAEC,iBACFu3D,EAAWtnD,QAAQ0mD,kBAAkB52D,EAAGguE,MAG5C,CAACxW,IAGGkf,EAAqBh3E,uBAAY,SAACi3E,EAAkBlwE,GACxDwvE,EAAwB,CACtBvtE,EAAGjC,EAAMmwE,YAAY1uE,QACrBS,EAAGlC,EAAMmwE,YAAYzuE,UAEvB4tE,EAAoBY,GACpBR,GAA2B,KAC1B,IAEGU,EAAyBn3E,uBAC7B,SAACub,EAAG3b,GACFjB,EAAS,CACPhB,KAAM2V,GACNnT,GAAIob,EAAEpb,GACNP,MACA5B,OAAQud,EAAElO,QAAQzN,OAGtB,CAACjB,IAGGy4E,EAA6Bp3E,uBACjC,SAACub,GACCQ,YAAW,WACLoC,GAAkBA,EAAehe,KAAOob,EAAEpb,GAC5CxB,EAAS,CAAEhB,KAAM6V,GAAwB3Q,KAAM,OAE/ClE,EAAS,CAAEhB,KAAM6V,GAAwB3Q,KAAM,CAAE1C,GAAIob,EAAEpb,QAExD,KAEL,CAACge,EAAgBxf,IAGbuM,EAAoBlL,uBAAY,WACpCy2E,GAA2B,KAC1B,IAEH,OACE,eAAC,WAAD,WACE,cAAC,GAAD,CAAM70B,aAAct+B,EAAW1iB,QAASm2E,EAAxC,SACGJ,GACCz4E,OAAOC,KAAKw4E,GAAyBv9D,KAAI,SAACi+D,GAAD,OACvC,qBACE/1B,SAAU+1B,EACVh2B,MAAOg2B,EAEPl2E,MAAO,CAAEoO,SAAU,OAAQlL,OAAQ,QAJrC,SAMGsyE,EAAwBU,IACvBV,EAAwBU,GAAOj+D,KAAI,SAACmC,GAAD,OACjC,cAAC,GAAD,CAEE4C,eAAgBA,EAMhBi2D,eAAgBA,EAChBvxE,KAAM0Y,EACNg5D,mBAAoB4C,EACpBhD,0BAA2B0C,EAC3BlC,uBAAwByC,EACxBxC,mBAAoBoC,EACpBrf,cAAe,uBAACr3D,GAAD,OAAO62D,EAAmB72D,EAAGib,KAbvCA,EAAEpb,QANRk3E,QAyBb,cAAC,GAAD,CAAavoE,IAAKgpD,EAAYz4D,QAASqzE,IAEtC8D,EACC,cAAC,GAAD,CACEtoE,QAAShD,EACTrI,KAAMuzE,EACNh1E,SAAUk1E,IAEV,WCzMJxpE,GAAS,CACbyC,SAAU,SACVlL,OAAQ,OACRgJ,QAAS,OACTO,cAAe,UAGjB,SAAS0pE,kBAAT,GAII,IAHFz0E,EAGC,EAHDA,KACAsb,EAEC,EAFDA,eACWo5D,EACV,EADDj0D,UACC,EACiCvb,mBAAS,IAD1C,mBACM+qE,EADN,KACiB0E,EADjB,KAGKjuB,EAAmBvpD,uBAAY,SAACM,GACpCk3E,EAAal3E,EAAEuC,KAAOvC,EAAEuC,KAAO,MAC9B,IAEH,OACE,sBAAK1B,MAAO2L,GAAZ,UACE,cAAC,GAAD,CAAoBgmE,UAAWA,IAC/B,cAAC,GAAD,CACEoD,YAAa3sB,EACb1mD,KAAMA,EACNsb,eAAgBA,EAChBmF,UAAWi0D,OAMJz5D,sBAAKw5D,mBCnCdG,GAAc,CAClB,CAAE73E,IAAK,aAAc0c,MAAO,OAC5B,CAAE1c,IAAK,sBAAuB0c,MAAO,UACrC,CAAE1c,IAAK,cAAe0c,MAAO,QAC7B,CAAE1c,IAAK,aAAc0c,MAAO,QAGxBo7D,GAASD,GAAYr+D,KAAI,SAACu+D,GAAD,OAAgBA,EAAW/3E,OAEpDg4E,GAAiB,CACrB,CACEh4E,IAAK,IACLssB,MAAO,GACPluB,MAAO,IAET,CACE4B,IAAK,KACLssB,MAAO,KACPluB,MAAO,MAET,CACE4B,IAAK,MACLssB,MAAO,MACPluB,MAAO,OAET,CACE4B,IAAK,MACLssB,MAAO,MACPluB,MAAO,QAIL65E,GAAmB,CACvBC,EAAG,IACHC,EAAG,IACHC,EAAG,IACHC,EAAG,IACHC,GAAI,IACJC,EAAG,KC/BL,SAASC,cAAcC,EAAiBC,GACtC,IAAMzmC,EAAQ1wB,IACZk3D,EADqB,gBAEZC,EAAYC,SAFA,UAGrB,MAEF,GAAI1mC,EACF,IAAK,IAAI2mC,KAAcd,GACrB,GACkC,eAAhCD,GAAYe,GAAY54E,MACS,gBAAhC63E,GAAYe,GAAY54E,KACS,wBAAhC63E,GAAYe,GAAY54E,MAC1BuhB,IAAU0wB,EAAD,UAAW4lC,GAAYe,GAAY54E,KAAO,IAAID,MACrD,SAACgf,GAAD,OAAW05D,EAAgBxjD,OAAOlW,GAAOxe,KAAOm4E,EAAYn4E,MAG9D,OAAOs3E,GAAYe,GAAYl8D,MAKrC,OAAO,KAGT,SAASm8D,aAAah8C,EAAaz+B,GACjC,OAAOy+B,EAAY76B,QACjB,SAAC82E,GAAD,OACEA,EAAUv4E,KAAOnC,EAAM26E,eACS,IAAhCD,EAAUrrE,QAAQonB,aACpB,GAGJ,SAASmkD,WAAWjkD,EAAU32B,GAC5B,IAAK,IAAIyE,EAAI,EAAGA,EAAIkyB,EAAS7M,MAAM+M,OAAOnyB,OAAQD,IAAK,CACrD,IAAM64B,EAAc3G,EAAS7M,MAAM+M,OAAOpyB,GAAGw4B,OAAOhD,WAClD,SAACiD,GAAD,OAAaA,EAAQ/6B,KAAOnC,EAAMi9B,OAAO96B,MAE3C,GAAIm7B,GAAe,EACjB,OAAO3G,EAAS7M,MAAM+M,OAAOpyB,GAAGw4B,OAAOK,IA2B7C,IAAMu9C,GAAoB,SAApBA,kBAAqBp8C,EAAaz+B,GACtC,IAAM22B,EAAW8jD,aAAah8C,EAAaz+B,GAC3C,GAAI22B,EACF,GAAgC,IAA5BA,EAAS/V,KAAKyE,UAAiB,CACjC,IAAMjhB,EA1BZ,SAAS02E,UAAUnkD,EAAU32B,GAC3B,IAAK,IAAIyE,EAAI,EAAGA,EAAIkyB,EAAS2F,OAAOzF,OAAOnyB,OAAQD,IAIjD,GAHoBkyB,EAAS2F,OAAOzF,OAAOpyB,GAAGw4B,OAAOhD,WACnD,SAACiD,GAAD,OAAaA,EAAQ/6B,KAAOnC,EAAMi9B,OAAO96B,OAExB,EACjB,OAAOw0B,EAAS2F,OAAOzF,OAAOpyB,GAoBhBq2E,CAAUnkD,EAAU32B,GAClC,GAAIoE,EAAO,OAAOA,EAAMjC,QACnB,GAAgC,IAA5Bw0B,EAAS/V,KAAKyE,UAAiB,CACxC,IAAM+L,EAlBZ,SAAS2pD,SAASpkD,EAAU32B,GAC1B,IAAK,IAAIyE,EAAI,EAAGA,EAAIkyB,EAAS7M,MAAM+M,OAAOnyB,OAAQD,IAIhD,GAHoBkyB,EAAS7M,MAAM+M,OAAOpyB,GAAGw4B,OAAOhD,WAClD,SAACiD,GAAD,OAAaA,EAAQ/6B,KAAOnC,EAAMi9B,OAAO96B,OAExB,EACjB,OAAOw0B,EAAS7M,MAAM+M,OAAOpyB,GAYhBs2E,CAASpkD,EAAU32B,GAChC,GAAIoxB,EAAM,OAAOA,EAAKjvB,KAkB5B,SAAS64E,kBACPrkD,EACA32B,EACA+0C,EACAkmC,EACAC,EACAC,EACAC,GAEA,GAAIzkD,GAAwC,IAA5BA,EAAS/V,KAAKyE,UAAiB,CAC7C,IAAM4X,EAAS29C,WAAWjkD,EAAU32B,GACpC,GAAIi9B,EACF,OACEA,EAAOjyB,EAAEsvB,MAAQya,GAAUkmC,GAC3Bh+C,EAAOjyB,EAAEsvB,MAAQya,GAAUmmC,GAC3Bj+C,EAAOhyB,EAAEqvB,MAAQya,GAAUomC,GAC3Bl+C,EAAOhyB,EAAEqvB,MAAQya,GAAUqmC,EAIjC,OAAO,ECEMC,OAlHf,SAASA,uBAAT,GAII,IAHF58C,EAGC,EAHDA,YACA68C,EAEC,EAFDA,iBACAhB,EACC,EADDA,YAEMiB,EAA+B16E,mBAAQ,WAC3C,IAA2B,IAAvBy5E,EAAYkB,OACd,MAAO,GAET,IAAM19C,EAAM,CACVw8C,EAAYr9C,OAAO96B,GACnB4rC,GAAQusC,EAAYr9C,OAAO96B,GAAI,gBAE3BA,EAAK04E,GAAkBp8C,EAAa67C,GAe1C,OAdIn4E,GACF27B,EAAIv8B,KAAKY,GAEXm4E,EAAYmB,KAAK/yE,SAAQ,SAAC+yE,GACxB,IAAoB,IAAhBA,EAAKD,OAAkB,CACzB19C,EAAIv8B,KAAKk6E,EAAKx+C,OAAO96B,IACrB27B,EAAIv8B,KAAKwsC,GAAQ0tC,EAAKx+C,OAAO96B,GAAI,gBACjC,IAAM+7B,EAAM28C,GAAkBp8C,EAAag9C,GACvCv9C,GACFJ,EAAIv8B,KAAK28B,OAKRJ,IACN,CAACw8C,EAAa77C,IACXi9C,EAA4Bx6E,aAAaq6E,GAEzCp3C,EAAoBniC,uBACxB,SAAC+G,GACCA,EAAM4B,cAAcgxE,QACpBD,EAA0B35E,SAE5B,CAAC25E,IAEGxuE,EAAoBlL,uBACxB,SAAC+G,GACCA,EAAM4B,cAAcyuB,OACpBsiD,EAA0Bz5E,SAE5B,CAACy5E,IAGGE,EAAmB/6E,mBAAQ,WAC/B,MAAO,CACLsC,MAAM,2BACD,CAAEmb,MAAO87D,cAAckB,EAAkBhB,KADzC,IAEHlrE,gBAAiBssE,EAA0Bh6E,SACvC,YACA,YAENmd,OACyB,IAAvBy7D,EAAYkB,QACZ,CAAClB,EAAYuB,eAAetmC,eACzBxY,OACCu9C,EAAYmB,KAAKj2D,QAAO,SAACs2D,EAAKL,GAQ5B,OANkB,IAAhBA,EAAKD,QACLC,EAAKI,iBAAmBvB,EAAYuB,gBACnCC,EAAIj6E,SAAS45E,EAAKI,eAAetmC,gBAElCumC,EAAIv6E,KAAKk6E,EAAKI,eAAetmC,eAExBumC,IACN,KAEJ3hD,OACAoc,KAAK,KACV7zC,aAAcyhC,EACdxhC,aAAcuK,KAEf,CACDotE,EACAgB,EACAI,EAA0Bh6E,SAC1ByiC,EACAj3B,IAGI6uE,EAAuBl7E,mBAAQ,WACnC,OAAOy5E,EAAY0B,OAAOC,YACtB,CAAE7sE,gBAAiB,WACnB,CACEkP,MAAO4Z,OAAOgkD,UAAU5B,EAAY2B,aACJ,IAA5B3B,EAAY2B,YACV,UACA,QACF,SAET,CAAC3B,IAEJ,OACE,6CAAQsB,GAAR,aACE,oBAAKz4E,MAAO,CAAEkM,QAAS,SAAvB,UACE,2BAAIirE,EAAYpsD,MAAMiuD,SACtB,2BACG7B,GAAeA,EAAYr9C,QAAUq9C,EAAYr9C,OAAO3C,MACrDggD,EAAYr9C,OAAO3C,MAAMtY,QAAQ,GACjC,KAEN,kBAAG7e,MAAO44E,EAAV,SACG7jD,OAAOgkD,UAAU5B,EAAY2B,aAC1B3B,EAAY2B,YACZ3B,EAAY2B,YAAYj6D,QAAQ,Y,+BCuH/Bo6D,OA3Nf,SAASA,sBAAT,GAOI,IANFC,EAMC,EANDA,eACAC,EAKC,EALDA,kBACAC,EAIC,EAJDA,YACAC,EAGC,EAHDA,aACA/9C,EAEC,EAFDA,YACAk1C,EACC,EADDA,OAEM7Z,EAAa/oD,mBADlB,EAE+BhH,oBAAS,GAFxC,mBAEM0yE,EAFN,KAEgBC,EAFhB,KAIKC,EAA0B97E,mBAAQ,WACtC,IAAMi9B,EAAM,GAYZ,OAXAy+C,EAAY7zE,SAAQ,SAAC+yE,GACnB,IAAoB,IAAhBA,EAAKD,OAAkB,CACzB19C,EAAIv8B,KAAKk6E,EAAKx+C,OAAO96B,IACrB27B,EAAIv8B,KAAKwsC,GAAQ0tC,EAAKx+C,OAAO96B,GAAI,cACjC,IAAM+7B,EAAM28C,GAAkBp8C,EAAag9C,GACvCv9C,GACFJ,EAAIv8B,KAAK28B,OAKRJ,IACN,CAACy+C,EAAa99C,IACXm+C,EAAuB17E,aAAay7E,GAEpCx4C,EAAoBniC,uBACxB,SAAC+G,GACCA,EAAM4B,cAAcgxE,QACpBiB,EAAqB76E,SAEvB,CAAC66E,IAEG1vE,EAAoBlL,uBACxB,SAAC+G,GACCA,EAAM4B,cAAcyuB,OACpBwjD,EAAqB36E,SAEvB,CAAC26E,IAGHn7E,qBAAU,WACJ86E,EAAY56E,MAAK,SAACk7E,GAAD,OAAsC,IAAtBA,EAAWrB,UAC9CkB,GAAY,GAEZA,GAAY,KAEb,CAACH,IAEJ,IAAMpjB,EAAqBn3D,uBACzB,SAACM,EAAGguE,GACFhuE,EAAEC,iBACFu3D,EAAWtnD,QAAQ0mD,kBAAkB52D,EAAGguE,KAE1C,CAACxW,IAGGgjB,EAAgB96E,uBACpB,SAAC65E,EAAgBn8E,EAAQm9E,GACvB,IAAME,EAAkBC,KAAgBX,GAClCY,EAAqBD,KAAgBV,GACrCY,EAAsBH,EAAgBtB,KAAK73E,QAC/C,SAAC63E,GAAD,MAC0B,SAAxBA,EAAKI,gBAAqD,SAAxBJ,EAAKI,kBACzCn3E,OAEF,GAAe,QAAXhF,EAAkB,CACpB,IAAMy9E,EAAe5qC,aACf6qC,EAAqB7qC,aACrB8qC,EAAmBC,iBAAcC,UAAU,CAC/C1B,iBACAlB,aAAcyC,EACd7C,SAAU,CAAC0C,EAAmB1C,SAAUwC,EAAgBxC,UACxDp4E,GAAIg7E,EACJ3B,QAAQ,EACRv+C,OAAQ,CAAE96B,GAAIowC,aAAc1tB,KAAM,KAGpC24D,wBAAqBC,QACnBR,EACAK,iBAAcC,UAAd,2BACKF,GADL,IAEEppD,KAAM,IACNypD,MAAO,CACLC,oBAAiBC,oBACfpB,EACAO,QAKRS,wBAAqBC,QACnBV,EACAO,iBAAcC,UAAd,2BACKF,GADL,IAEEppD,KAAM,IACNypD,MAAO,CACLC,oBAAiBC,oBACfpB,EACAS,QAKHF,EAAgBf,OAAO6B,eAC1Bd,EAAgBc,aAAe,CAACX,EAAsB,QAEpC,WAAXx9E,IACT89E,wBAAqBM,WAAWf,EAAiBF,EAAW16E,IAC5Dq7E,wBAAqBM,WAAWb,EAAoBJ,EAAW16E,IAC1D46E,EAAgBf,OAAO6B,eAC1Bd,EAAgBc,aACdX,EAAsB,EAAI,EAAI,CAACA,EAAsB,GAAK,KAIhEvJ,EAAOoJ,EAAiBE,KAE1B,CAACZ,EAAgB1I,EAAQ2I,EAAmBE,IAGxC9H,EAAc7zE,mBAAQ,WAG1B,IAAMk9E,EAAiBxB,EAAY9/C,MACjC,SAACogD,GAAD,MACgC,SAA9BA,EAAWhB,iBAAmD,IAAtBgB,EAAWrB,UAGvD,OAAiC,IAA1Ba,EAAeb,OAClBuC,EACE,CACE,CACE7vD,MAAO,cACPtrB,QAAS,mBACPk6E,EAAc,OAAQ,SAAUiB,MAItC,CACE,CACE7vD,MAAO,WACPtrB,QAAS,mBACPk6E,EAAc,OAAQ,UAI9B,KACH,CAACP,EAAaO,EAAeT,IAE1BjrB,EAAUvwD,mBAAQ,WACtB,IAAMm9E,EAAU,IAAIxhE,IAyBpB,OAxBA+/D,EAAY7zE,SAAQ,SAACm0E,GAEa,SAA9BA,EAAWhB,gBACmB,SAA9BgB,EAAWhB,eAEXmC,EAAQ97E,IACL26E,EAAW5/C,QAAqC,IAA3B4/C,EAAW5/C,OAAOpY,KAAxC,WAEmC,IAA3Bg4D,EAAW5/C,OAAOpY,KAAa,IAAM,KADzC,KAIwB,SAA9Bg4D,EAAWhB,gBACmB,SAA9BgB,EAAWhB,gBACmB,UAA9BgB,EAAWhB,eAEXmC,EAAQ97E,IAAI,KAEkB,UAA9B26E,EAAWhB,gBACmB,UAA9BgB,EAAWhB,gBAEXmC,EAAQ97E,IAAI,UAIT,aAAI87E,KACV,CAACzB,IAEE19D,EAAQhe,mBACZ,kBACE07E,EACG/2D,QAAO,SAACs2D,EAAKL,GAIZ,OAHKK,EAAIj6E,SAAS45E,EAAKI,eAAetmC,gBACpCumC,EAAIv6E,KAAKk6E,EAAKI,eAAetmC,eAExBumC,IACN,IACF3hD,OACAoc,KAAK,OACV,CAACgmC,IAGH,OACE,qBACE5iB,cAAe,uBAACr3D,GACVoyE,EAAYhwE,OAAS,GACvBy0D,EAAmB72D,EAAG+5E,IAG1Bl5E,MAAO,CACLiM,gBAAiBwtE,EAAqBl7E,SAClC,YACA+6E,EACA,UACA,WAEN59D,MAAOA,EACPnc,aAAcyhC,EACdxhC,aAAcuK,EAfhB,UAiBGkkD,EAAQ7a,KAAK,KACd,cAAC,GAAD,CAAazlC,IAAKgpD,EAAYz4D,QAASqzE,QCvNvCtE,GAAiB,CACrB5iB,WAAY,EACZd,YAAa,EACb/yB,OAAQ,OACRtzB,OAAQ,QAkPK43E,I,GAAAA,GA/Of,SAASA,oBAAT,GAWI,IAVFC,EAUC,EAVDA,qBACA1B,EASC,EATDA,aACAlC,EAQC,EARDA,YACA6D,EAOC,EAPDA,SACAC,EAMC,EANDA,WACAC,EAKC,EALDA,uBACAC,EAIC,EAJDA,sBACAC,EAGC,EAHDA,uBACAC,EAEC,EAFDA,4BACA//C,EACC,EADDA,YAEMggD,EAAkB59E,mBAAQ,WAC9B,IAA2B,IAAvBy5E,EAAYkB,OACd,MAAO,GAET,IAAM19C,EAAM,CACVw8C,EAAYr9C,OAAO96B,GACnB4rC,GAAQusC,EAAYr9C,OAAO96B,GAAI,gBAE3BA,EAAK04E,GAAkBp8C,EAAa67C,GAe1C,OAdIn4E,GACF27B,EAAIv8B,KAAKY,GAEXm4E,EAAYmB,KAAK/yE,SAAQ,SAAC+yE,GACxB,IAAoB,IAAhBA,EAAKD,OAAkB,CACzB19C,EAAIv8B,KAAKk6E,EAAKx+C,OAAO96B,IACrB27B,EAAIv8B,KAAKwsC,GAAQ0tC,EAAKx+C,OAAO96B,GAAI,gBACjC,IAAM+7B,EAAM28C,GAAkBp8C,EAAag9C,GACvCv9C,GACFJ,EAAIv8B,KAAK28B,OAKRJ,IACN,CAACw8C,EAAa77C,IACXigD,EAAex9E,aAAau9E,GAE5BE,EAA4B38E,uBAChC,SAACM,GACC+7E,EAAuB/D,EAAah4E,EAAE0xB,OAAOh0B,SAE/C,CAACs6E,EAAa+D,IAGVO,EAA4B58E,uBAChC,SAACM,GACCi8E,EAAuBjE,EAAah4E,EAAE0xB,OAAOh0B,SAE/C,CAACs6E,EAAaiE,IAGVM,EAAyBh+E,mBAAQ,WACrC,OAAOq9E,EAAqB9iE,KAAI,SAAC0jE,GAC/B,IAAMvC,EAAc,GAuBpB,OAtBAjC,EAAYmB,KAAK/yE,SAAQ,SAAC+yE,GACxBqD,EAAarD,KAAK/yE,SAAQ,SAACq2E,GACzB,GACEtD,EAAKxnD,OAAS8qD,EAAM9qD,MACpBwnD,EAAKd,eAAiBoE,EAAMpE,cAC5Bc,EAAKx+C,OAAO96B,KAAO48E,EAAM9hD,OAAO96B,GAChC,CACA,IAAI68E,EAAkBvD,EAAKI,eACvBJ,EAAKx+C,QAA+B,IAArBw+C,EAAKx+C,OAAOpY,OAC7Bm6D,GAAmB,aAErBzC,EAAYh7E,KACV+7E,iBAAcC,UAAd,2BACK9B,GADL,IAEEuD,kBACA/qD,UAAMlM,aAQd,cAAC,GAAD,CAEEs0D,eAAgB/B,EAChBgC,kBAAmBwC,EACnBvC,YAAaA,EACbC,aAAcA,EACd/9C,YAAaA,EACbk1C,OAAQ6K,GAPV,qBACqBlE,EAAYn4E,GADjC,YACuC28E,EAAa38E,UAUvD,CACD+7E,EACA5D,EACAkC,EACAgC,EACA//C,IAGIwgD,EAA+Bj9E,uBACnC,SAAChC,GACCs+E,EAAsBhE,EAAat6E,KAErC,CAACs6E,EAAagE,IAGVY,EAAuBr+E,mBAAQ,WACnC,OAAOy5E,EAAY0B,OAAOC,YACtB,CAAE7sE,gBAAiB,WACnB,CACEkP,MAAmC,IAA5Bg8D,EAAY2B,YAAoB,UAAY,WAExD,CAAC3B,IAEEn2C,EAAoBniC,uBACxB,SAAC+G,GACCA,EAAM4B,cAAcgxE,QACpB+C,EAAa38E,SAEf,CAAC28E,IAEGxxE,EAAoBlL,uBACxB,SAAC+G,GACCA,EAAM4B,cAAcyuB,OACpBslD,EAAaz8E,SAEf,CAACy8E,IAGGS,EAAiBt+E,mBAAQ,WAC7B,MAAO,CACLsC,MAAM,2BACDg7E,GADA,IAEH/uE,gBAAiBsvE,EAAah9E,SAAW,YAAc,YAEzDmd,OACyB,IAAvBy7D,EAAYkB,QACZ,CAAClB,EAAYuB,eAAetmC,eACzBxY,OACCu9C,EAAYmB,KAAKj2D,QAAO,SAACs2D,EAAKL,GAQ5B,OANkB,IAAhBA,EAAKD,QACLC,EAAKI,iBAAmBvB,EAAYuB,gBACnCC,EAAIj6E,SAAS45E,EAAKI,eAAetmC,gBAElCumC,EAAIv6E,KAAKk6E,EAAKI,eAAetmC,eAExBumC,IACN,KAEJ3hD,OACAoc,KAAK,KACV7zC,aAAcyhC,EACdxhC,aAAcuK,KAEf,CACDotE,EAAYuB,eACZvB,EAAYmB,KACZnB,EAAYkB,OACZkD,EAAah9E,SACbyiC,EACAj3B,EACAixE,IAGF,OACE,qBAAIh7E,MAAOg7E,EAAX,UACE,yEAEOgB,GAFP,IAGIh8E,MAAM,2BAAMg8E,EAAeh8E,OAAtB,IAA6Bi7E,kBAHtC,aAMGT,oBAAiBxtC,SAASqsC,EAAclC,MAE3C,8CAAQ6E,GAAR,aACGh8D,IAAUm3D,EAAYr9C,OAAQ,SAAS,GACpCq9C,EAAYr9C,OAAO3C,MAAMtY,QAAQ,GACjC,MAEN,8CAAQm9D,GAAR,cAC0B,IAAvB7E,EAAYkB,OACc,MAAzBlB,EAAYC,SACV,cAAC,GAAD,CACE56E,KAAK,SACLK,MAAOs6E,EAAY2B,YACnB94E,MAAO+7E,EACPl0B,OAAQ2zB,IAGV,sBAAMx7E,MAAO+7E,EAAb,SAAoC5E,EAAY2B,cAGlD,MAGJ,8CAAQkD,GAAR,aAC4B,MAAzB7E,EAAYC,SACX,cAAC,GAAD,CACE56E,KAAK,OACLK,MAAOs6E,EAAYuD,aAAatnC,KAAK,KACrCpzC,MACEm3E,EAAY0B,OAAO6B,aACf,CAAEzuE,gBAAiB,WACnB,GAEN47C,OAAQ4zB,IAGV,MAGJ,yEAEOO,GAFP,IAGIh8E,MAAM,2BAAMg8E,EAAeh8E,OAAtB,IAA6Bi8E,YAAa,iBAHnD,aAM4B,MAAzB9E,EAAYC,SACX,cAAC,GAAD,CACE1gD,SAAUolD,EACVp6E,KAAM+0E,GACN55E,MAAOs6E,EAAY+E,cACnBl8E,MAAK,2BACAitE,IADA,IAEHhhE,gBAAiBkrE,EAAY0B,OAAOqD,cAChC,UACAlB,EAAS/uE,gBACbhJ,MAAO,WAIX,MAGHy4E,MCrPDrL,GAAa9hE,YAAH,ylBA0HD4tE,OAvFf,SAASA,iBAAT,GAUI,IATFhE,EASC,EATDA,iBACAiE,EAQC,EARDA,yBACArB,EAOC,EAPDA,qBACAsB,EAMC,EANDA,4BACAC,EAKC,EALDA,+BACAC,EAIC,EAJDA,4BACAC,EAGC,EAHDA,qCACAC,EAEC,EAFDA,kBACAnhD,EACC,EADDA,YAEM00B,EAAOtyD,mBAAQ,WACnB,OAAK0+E,EAIEA,EAAyB1oD,OAC7BjzB,QAAO,SAAC02E,GAAD,OACNsF,EAC6B,MAAzBtF,EAAYC,SACa,MAAzBD,EAAYC,YAEjBn/D,KAAI,SAACk/D,GAAD,OACH,aAAC,GAAD,CACE4D,qBAAsBA,EACtB1B,aAAclB,EAAiBzkD,OAC/ByjD,YAAaA,EAEb6D,SAAU,CAAE/uE,gBAAiB,aAC7BgvE,WAC2B,MAAzB9D,EAAYC,SACR,CACEj8D,MAAO87D,cAAckB,EAAkBhB,IAEzC,GAEN+D,uBAAwBmB,EACxBlB,sBAAuBmB,EACvBlB,uBAAwBmB,EACxBlB,4BAA6BmB,EAC7BlhD,YAAaA,GAjBf,qBAIqB67C,EAAYC,UAJjC,OAI4CD,EAAYn4E,QAdnD,KA8BR,CACDo9E,EACAK,EACA1B,EACA5C,EACAkE,EACAC,EACAC,EACAC,EACAlhD,IAGIohD,EAAyBh/E,mBAC7B,kBACEq9E,EAAqB9iE,KAAI,SAACk/D,GAAD,OACvB,aAAC,GAAD,CAEE77C,YAAaA,EACb68C,iBAAkBA,EAClBhB,YAAaA,GAJf,sCACsCA,EAAYn4E,UAMtD,CAAC+7E,EAAsB5C,EAAkB78C,IAG3C,OACE,oBAAKh1B,UAAU,kBAAf,SACE,sBAAOiI,IAAK8hE,GAAZ,UACE,+BACE,6BACE,qCACA,6CACA,sCACA,mCACA,mBAAIrwE,MAAO,CAAEi8E,YAAa,aAA1B,oBACCS,OAGL,+BAAQ1sB,UCxHhB,SAAS2sB,SAAT,GAAyC,IAArBxE,EAAoB,EAApBA,iBAClB,IAAKA,EACH,OAAO,KAET,IAAMvkB,EAAQ4mB,oBAAiBoC,cAAczE,EAAiBlqE,QAAQk/B,IAEtE,OAAOpwC,OAAOC,KAAK42D,GAAOryD,OAAS,EACjCxE,OAAOC,KAAK42D,GAAO37C,KAAI,SAACm/D,EAAU91E,GAChC,IAAMu7E,EAAgB1E,EAAiB77E,MAAM86E,GACvC1mC,EAAQmsC,EAAgBA,EAAcnsC,WAAQ9rB,EAC9Ck4D,EAAkBpsC,EACpB6lC,GAAOz/C,WAAU,SAACyzC,GAAD,YAA8B3lD,IAAlB8rB,EAAM65B,MACnC,QAEJ,OACE,sBAGEvqE,MAAO,CACLmb,MAAO0hE,GACwB,IAA3BA,EAAcE,UACZrsC,GAAuC,IAA9B3zC,OAAOC,KAAK0zC,GAAOnvC,OAE5Bu7E,GAAmB,EACnBxG,GAAYwG,GAAiB3hE,MAC7B,QAHA,QAIF,SAXR,mBAcMi8D,EAdN,aAcmByF,EAAgBA,EAAcxtE,QAAU,IAd3D,YAeIukD,EAAMwjB,GAfV,iCAEyB91E,OAmB7B,mBAAGtB,MAAO,CAAEg9E,UAAW,SAAU7hE,MAAO,UAAxC,0CAMWwB,I,GAAAA,kBAAKggE,U,UC1CdM,GAAa1uE,YAAH,ieA4BhB,SAAS2uE,sBAAT,GAAwD,IAAvBr1B,EAAsB,EAAtBA,OAAQs1B,EAAc,EAAdA,WAAc,EACjCv2E,mBAAS,IADwB,mBAC9CumC,EAD8C,KAC1CiwC,EAD0C,OAEnBx2E,oBAAS,GAFU,mBAE9Cy2E,EAF8C,KAEnCC,EAFmC,OAGjB12E,oBAAS,GAHQ,mBAG9C22E,EAH8C,KAGlCC,EAHkC,KAK/CC,EAAU5+E,uBAAY,SAACsuC,GAC3B,IAEE,OADA,IAAIuwC,MAAGvwC,IACA,EACP,MAAOuD,GACP,OAAO,KAER,IAEG+V,EAAkB5nD,uBACtB,SAACM,GACCq+E,GAAc,GACVC,EAAQt+E,EAAE0xB,OAAOh0B,QACnBygF,GAAa,GACbF,EAAMj+E,EAAE0xB,OAAOh0B,SAEfygF,GAAa,GACbF,EAAM,OAGV,CAACK,IAGGE,EAAgB9+E,uBAAY,WAChCgpD,EAAO01B,EAAapwC,EAAGhY,OAASgoD,KAC/B,CAACI,EAAYpwC,EAAI0a,EAAQs1B,IAE5B,OACE,oBAAK5uE,IAAK0uE,GAAV,UACE,sBAAOzgF,KAAK,OAAOk6B,SAAU+vB,EAAiBlmC,aAAc48D,IAC5D,uBAAQ3gF,KAAK,SAASiD,QAASk+E,EAAeh9E,UAAW08E,EAAzD,oBAONH,sBAAsB1zE,aAAe,CACnCq+C,OAAQ,kBACN,OAAO,OAIIq1B,I,GAAAA,yBCzETnpB,GAAiBxlD,YAAH,ymCAoEpB,SAASqvE,yBAAT,GAA+E,IAA3C7wE,EAA0C,EAA1CA,QAAS86C,EAAiC,EAAjCA,OAAQxuB,EAAyB,EAAzBA,UAAW8jD,EAAc,EAAdA,WAAc,EACpCv2E,qBADoC,mBACrEssD,EADqE,KACvDC,EADuD,KAG5E70D,qBAAU,WACJ+6B,GAAaA,EAAU93B,OAAS,GAClC4xD,EAAgB,KAEjB,CAAC95B,IAEJ,IAAMwkD,EAAqCh/E,uBACzC,SAACsuC,GACC0a,EAAO1a,GACPpgC,MAEF,CAACA,EAAS86C,IAGNi2B,EAAiCj/E,uBAAY,WACjDgpD,EAAOxuB,EAAU65B,GAAc/lB,IAC/BpgC,MACC,CAACmmD,EAAc75B,EAAWtsB,EAAS86C,IAEhCk2B,EAAmCl/E,uBAAY,SAAC2e,GACpD21C,EAAgB31C,KACf,IAEH,OACE,oBAAKjP,IAAKwlD,GAAV,UACE,oBAAKztD,UAAU,SAAf,SACE,aAAC,GAAD,CAAa7G,QAASsN,MAExB,6BACE,kBAAGzG,UAAU,OAAb,mDAEF,aAAC,GAAD,CACEuhD,OAAQg2B,EACRV,WAAYA,IAEd,8BACE,kBAAG72E,UAAU,WAAb,gBACA,kBAAGA,UAAU,YAAb,gDAEF,aAAC,GAAD,CACE+yB,UAAWA,EACX3C,SAAUqnD,IAEZ,uBAAQvhF,KAAK,SAASiD,QAASq+E,EAA/B,oBAONF,yBAAyBp0E,aAAe,CACtCq+C,OAAQ,kBACN,OAAO,MAET96C,QAAS,mBACP,OAAO,OAII6wE,I,GAAAA,4BCpIT7pB,GAAiBxlD,YAAH,s9BA2DpB,SAASyvE,uBAAT,GAAyE,IAAvCjxE,EAAsC,EAAtCA,QAAS86C,EAA6B,EAA7BA,OAAQo2B,EAAqB,EAArBA,kBAAqB,EACpCr3E,qBADoC,mBAC/DsjD,EAD+D,KACpDg0B,EADoD,KAGtE5/E,qBAAU,WAEN4/E,EADED,QAGWr5D,KAEd,CAACq5D,IAEJ,IAAMN,EAAgB9+E,uBAAY,WAChCgpD,EAAOqC,GACPn9C,MACC,CAACA,EAAS86C,EAAQqC,IAEfzD,EAAkB5nD,uBACtB,SAACM,EAAGi4E,GAAJ,OACE8G,EAAa,2BAAKh0B,GAAN,mBAAkBktB,EAAWriD,OAAO51B,EAAE0xB,OAAOh0B,YAC3D,CAACqtD,IAGGi0B,EAAczgF,mBAAQ,WAC1B,OAAOwsD,EACHntD,OAAOC,KAAKktD,GAAWjyC,KAAI,SAACm/D,GAC1B,OACE,oBAEE9wE,UAAU,cAFZ,UAIE,+BAAO8wE,EAAP,QACA,sBACE56E,KAAK,SACLk6B,SAAU,kBAACv3B,GAAD,OAAOsnD,EAAgBtnD,EAAGi4E,IACpC72D,aAAc2pC,EAAUktB,OAR5B,8BAC8BA,YAYlCxyD,IACH,CAAC6hC,EAAiByD,IAErB,OACE,oBAAK37C,IAAKwlD,GAAV,UACE,oBAAKztD,UAAU,SAAf,SACE,aAAC,GAAD,CAAa7G,QAASsN,MAExB,6BACE,kBAAGzG,UAAU,OAAb,kCAED63E,EACD,uBAAQ3hF,KAAK,SAASiD,QAASk+E,EAA/B,oBAONK,uBAAuBx0E,aAAe,CACpCq+C,OAAQ,kBACN,OAAO,MAET96C,QAAS,mBACP,OAAO,OAIIixE,I,GAAAA,0BCtGTI,GAAa7vE,YAAH,otBA2ChB,SAAS8vE,eAAgB,IAAD,EASlBn0E,eAPFmvB,EAFoB,EAEpBA,UACc8+C,EAHM,EAGpBkB,aACM/9C,EAJc,EAIpB55B,KACA0iB,EALoB,EAKpBA,QACAlB,EANoB,EAMpBA,QACAkmB,EAPoB,EAOpBA,cACAjnB,EARoB,EAQpBA,UAGI3kB,EAAW6M,cACX8E,EAAQzD,IAZQ,EAckC9E,mBAAS,IAd3C,mBAcfm0E,EAde,KAcOuD,EAdP,OAkBlB13E,mBAAS,KAlBS,mBAgBpB23E,EAhBoB,KAiBpBC,EAjBoB,OAmB4B53E,oBAAS,GAnBrC,mBAmBf61E,EAnBe,KAmBIgC,EAnBJ,OAoBsB73E,oBAAS,GApB/B,mBAoBf8tD,EApBe,KAoBCoG,EApBD,KAsBhBshB,EAA2B1+E,mBAAQ,WACvC,IAAMuzE,EAAW,SAAXA,SAAYp0E,GAChB,IAAqB,IAAjBA,EAAMw7E,OACR,OAAO,EAET,IAAMqG,EAAkBv8D,EACrBwB,MAAM,KACN1L,KAAI,SAAC2oC,GAAD,OTlGb,SAAS+9B,YAAYt/D,GACnB,OAAOA,EAAQsE,MAAM,OAAO,GSiGRg7D,CAAY/9B,MAEtBhP,EAAS,IACTkmC,EAAW1zD,EAAQ,GAAKwtB,EACxBmmC,EAAW3zD,EAAQ,GAAKwtB,EACxBomC,EAAW90D,EAAQ,GAAK0uB,EACxBqmC,EAAW/0D,EAAQ,GAAK0uB,EAE9B,GAAIxI,IAAkBN,GAAeC,MAAO,CAC1C,IAAM5R,EAAQt6B,EAAMi9B,OAAO3C,MAAQya,EAEnC,GADiB0lC,aAAah8C,EAAaz+B,IAGzC6hF,EAAgB,KAAO7hF,EAAMu6E,UAC7BjgD,GAAS2gD,GACT3gD,GAAS4gD,EAET,OAAO,EAGT,GACEl7E,EAAMy7E,KAAK95E,MAAK,SAAC85E,GAEf,OTvCZ,SAASsG,kBAAkBprD,EAAU8kD,EAAM1mC,EAAQkmC,EAAUC,GAC3D,GAAIvkD,GAAwC,IAA5BA,EAAS/V,KAAKyE,UAAiB,CAC7C,IAAM4X,EAAS29C,WAAWjkD,EAAU8kD,GACpC,GAAIx+C,EAAQ,CACV,IAAM+kD,EAA0B,MAAdvG,EAAKxnD,KAAe,IAAM,IAC5C,OACEgJ,EAAO+kD,GAAW1nD,MAAQya,GAAUkmC,GACpCh+C,EAAO+kD,GAAW1nD,MAAQya,GAAUmmC,GAI1C,OAAO,ES4BU6G,CADUtH,aAAah8C,EAAag9C,GAGzCA,EACA1mC,EACAkmC,EACAC,MAIJ,OAAO,OAEJ,GAAI3uC,IAAkBN,GAAeE,MAAO,CACjD,IAAK01C,EAAgBhgF,SAAS7B,EAAMu6E,UAClC,OAAO,EAIT,GACES,kBAHeP,aAAah8C,EAAaz+B,GAKvCA,EACA+0C,EACAkmC,EACAC,EACAC,EACAC,GAGF,OAAO,EAGP,GACEp7E,EAAMy7E,KAAK95E,MAAK,SAAC85E,GAEf,OAAOT,kBADUP,aAAah8C,EAAag9C,GAGzCA,EACA1mC,EACAkmC,EACAC,EACAC,EACAC,MAIJ,OAAO,EAKb,OAAO,GAGT,GAAIE,EAAkB,CACpB,IAAM2G,EAAUpqB,EACZyjB,EAAiBzkD,OAAOjzB,QAAO,SAAC5D,GAAD,OAAWo0E,EAASp0E,MACnDs7E,EAAiBzkD,OAErB,OAAO,2BAAKykD,GAAZ,IAA8BzkD,OAAQorD,OAEvC,CACD38D,EACAg2D,EACA/uC,EACAsrB,EACAp5B,EACAlX,EACAlB,IAGI67D,EAA8BlgF,uBAClC,SAACsuC,GACC3vC,EAAS,CACPhB,KAAMwW,GACNvW,QAAS,CACP0wC,UAIN,CAAC3vC,IAGGwhF,EAA4BngF,uBAChC,SAACqrD,GACC1sD,EAAS,CACPhB,KAAMyW,GACNxW,QAAS,CACPytD,iBAIN,CAAC1sD,IAGGyhF,EAA+BpgF,uBAAY,WAC/CsQ,EAAMvQ,KACJ,aAAC,GAAD,CACEmO,QAAS,0BAAMoC,EAAMkB,SACrBw3C,OAAQk3B,EACR1lD,UAAWA,EACX8jD,WAAYhF,EAAiBlqE,QAAQk/B,QAGxC,CAACgrC,EAAkB4G,EAA6B5vE,EAAOkqB,IAEpD6lD,EAA6BrgF,uBAAY,WAC7CsQ,EAAMvQ,KACJ,aAAC,GAAD,CACEmO,QAAS,0BAAMoC,EAAMkB,SACrBw3C,OAAQm3B,EACRf,kBAAmB9F,EAAiBlqE,QAAQi8C,eAG/C,CAACiuB,EAAkB6G,EAA2B7vE,IAE3CgwE,EAAwBzhF,mBAAQ,WACpC,IAAM0hF,EAAc,CAAC,KAAKxlD,OACxBu+C,EACIA,EAAiBzkD,OACdzb,KAAI,SAACk/D,GAAD,OAAiBA,EAAYC,YACjC32E,QAAO,SAAC22E,EAAU91E,EAAGugC,GAAd,OAAwBA,EAAM0B,QAAQ6zC,KAAc91E,KAC9D,IAaN,OAVI89E,EAAY1gF,SAAS,MACvB0gF,EAAYhhF,KAAK,OAGfghF,EAAY1gF,SAAS,KACvB8/E,EAAqC,KAErCA,EAAqC,KAGhCY,EAAYnnE,KAAI,SAAConE,GACtB,MAAO,CACL5gF,IAAK4gF,EACLt0D,MAAOs0D,EACPxiF,MAAOwiF,QAGV,CAAClH,IAEJ75E,qBAAU,WACR,IAAMghF,EAAqCf,EAAkC56D,MAC3E,KACA,GAEF26D,EACElC,EACIA,EAAyB1oD,OACtBjzB,QACC,SAAC02E,GAAD,OACEA,EAAYC,WAAakI,KAE5B7sD,UACH,MAEL,CAAC2pD,EAA0BmC,IAE9B,IAAMlC,EAA8Bx9E,uBAClC,SAACs4E,EAAat6E,GACZW,EAAS,CACPhB,KAAMsW,GACNrW,QAAS,CACPuC,GAAIm4E,EAAYn4E,GAChBm4E,YAAY,2BACPA,GADM,IAET2B,YAAaj8E,EACbg8E,OAAO,2BAAM1B,EAAY0B,QAAnB,IAA2BC,aAAa,WAKtD,CAACt7E,IAGG++E,EAA8B19E,uBAClC,SAACs4E,EAAaoI,GACZ,IAAI7rD,EAEA6rD,EAAahF,MAAM,qBAErB7mD,EAAS6rD,EACN57D,MAAM,KACNljB,QAAO,SAAC++E,GAAD,OAAUA,EAAKj+E,OAAS,KAC/B0W,KAAI,SAACunE,GAAD,OAAUzqD,OAAOyqD,MACgB,IAA/BD,EAAapqD,OAAO5zB,SAE7BmyB,EAAS,IAGPA,GAEFl2B,EAAS,CACPhB,KAAMsW,GACNrW,QAAS,CACPuC,GAAIm4E,EAAYn4E,GAChBm4E,YAAY,2BACPA,GADM,IAETuD,aAAchnD,EACdmlD,OAAO,2BAAM1B,EAAY0B,QAAnB,IAA2B6B,cAAc,WAMzD,CAACl9E,IAGG8+E,EAAiCz9E,uBACrC,SAACs4E,EAAat6E,GACZW,EAAS,CACPhB,KAAMsW,GACNrW,QAAS,CACPuC,GAAIm4E,EAAYn4E,GAChBm4E,YAAY,2BACPA,GADM,IAET+E,cAAer/E,EACfg8E,OAAO,2BAAM1B,EAAY0B,QAAnB,IAA2BqD,eAAe,WAKxD,CAAC1+E,IAGGg/E,EAAuC39E,uBAC3C,SAACq6E,EAAgBC,GACf37E,EAAS,CACPhB,KAAMuW,GACNtW,QAAS,CACPk+B,IAAK,CAACu+C,EAAel6E,GAAIm6E,EAAkBn6E,IAC3Cq6E,aAAc,CAAC,2BAERH,GAFO,IAGVL,OAAO,2BACFK,EAAeL,QADd,IAEJ4G,uBAAuB,MALf,2BASPtG,GATO,IAUVN,OAAO,2BACFM,EAAkBN,QADjB,IAEJ4G,uBAAuB,YAOnC,CAACjiF,IAGGi+D,EAAiB58D,uBAAY,WACjCi8D,GAAmBpG,KAClB,CAACA,IAEJ,OACE,oBAAKnmD,IAAK6vE,GAAV,UACE,aAAC,GAAD,CACEh+B,WAAW,EACXkU,QAAS6jB,EAAmBA,EAAiBzkD,OAAOnyB,OAAS,EAC7DizD,SAAUiH,EACVhH,cACEC,EACI,wBACA,gCAENA,eAAgBA,EAChBC,gBACEynB,GAA4BA,EAAyB1oD,OAAOnyB,OAXhE,UAcE,aAAC,GAAD,CACEma,MAAK,iCAA4By8D,EAAiBlqE,QAAQk/B,GAArD,KACL1xB,eAAe,QAFjB,SAIE,uBAAQjf,KAAK,SAASiD,QAASw/E,EAA/B,SACE,aAAC,KAAD,QAGJ,aAAC,GAAD,CAASvjE,MAAK,sBAAyBD,eAAe,QAAtD,SACE,uBAAQjf,KAAK,SAASiD,QAASy/E,EAA/B,SACE,aAAC,KAAD,QAGJ,oBAAK54E,UAAU,qBAAf,SACE,aAAC,GAAD,CAAU6xE,iBAAkBA,MAE9B,oBAAK7xE,UAAU,4BAAf,SACE,aAAC,GAAD,CACEowB,SAAU,kBAACgpD,GACTlB,EAAqCkB,GAEnCjB,EADgB,QAAdiB,IAMNh+E,KAAMy9E,EACNtiF,MAAO0hF,EACPv+E,MAAO,CACLiD,MAAO,OACPC,OAAQ,OACRszB,OAAQ,yBAKhB,aAAC,GAAD,CACE2hD,iBAAkBA,EAClBiE,yBAA0BA,EAC1BrB,qBAAsBA,EACtBsB,4BAA6BA,EAC7BC,+BAAgCA,EAChCC,4BAA6BA,EAC7BC,qCACEA,EAEFC,kBAAmBA,EACnBnhD,YAAaA,OAMN3e,sBAAK0hE,cC7ad1yE,GAAS,CACb/L,UAAW,CACTsb,QAAS,GACTjP,gBAAiB,UACjB/I,OAAQ,OACR6L,KAAM,GAERsqD,eAAgB,CACdn+C,QAAS,MACTtO,aAAc,MACd6D,OAAQ,WACRxE,gBAAiB,SAEnBuuC,IAAK,CACHtuC,QAAS,OACTuE,OAAQ,WAEV8rC,OAAQ,CACN/X,aAAc,oBACd80B,cAAe,MACfpnC,WAAY,OACZ/W,MAAO,WAETy9C,WAAY,CACV7pD,KAAM,EACNsM,SAAU,OACV6W,WAAY,OACZ/W,MAAO,WAET0rC,MAAO,CACL5jD,MAAO,MACP0qC,UAAW,WAIT4rB,GAAe,CACnB,CACEv6D,GAAI,EACJ+rB,MAAO,SACPyuC,gBAAiB,WACjBC,iBAAkB,aAClBC,cAAe,QAEjB,CACE16D,GAAI,EACJ+rB,MAAO,OACPyuC,gBAAiB,SACjBC,iBAAkB,WAClBC,cAAe,QAEjB,CACE16D,GAAI,EACJ+rB,MAAO,aACPyuC,gBAAiB,eACjBC,iBAAkB,iBAClBC,cAAe,QAEjB,CACE16D,GAAI,EACJ+rB,MAAO,aACPyuC,gBAAiB,eACjBC,iBAAkB,iBAClBC,cAAe,UAInB,SAASimB,iBAAT,EAAuChyE,GAAM,IAAjB0R,EAAgB,EAAhBA,QACpBra,EAAQ+3C,KAD4B,EAEdz9B,yBAAyB,wBAA5CwoC,EAFiC,oBAGpCz1B,EAAc7nB,iBAHsB,EAKX5D,mBAAS,MALE,mBAKnCuZ,EALmC,KAKzBy5C,EALyB,KAMpCC,EAAUjsD,mBAChBtP,qBAAU,WACR,IAAMshF,EAAmB9lB,GACvBznC,EACA,2BAEEutD,GACFhmB,EAAWgmB,KAEZ,CAACvtD,IAEJ,IAAM0nC,EAAsB,SAAtBA,oBAAuBrmC,GAC3Bo0B,EAAgBp0B,EAAQ,6BAGpBs+B,EAAcnzD,uBAClB,SAAC60B,GAAiC,IAAzBsmC,EAAwB,wDAC/B3nC,EAAY70B,SAAS,CACnBhB,KAAMklD,GACNjlD,QAAS,CAAEgC,IAAK,QAAS5B,MAAO62B,KAE9BsmC,GACFh1D,EAAMs4C,QAAQ,0CAGlB,CAACt4C,EAAOqtB,IAGVijC,8BAAoB3nD,GAAK,iBAAO,CAC9BssD,YAD8B,uBAEiB,oBAAlCJ,EAAQxqD,QAAQ6qD,cACzBL,EAAQxqD,QAAQ6qD,gBAEhBL,EAAQxqD,QAAQ8qD,cACd,IAAIC,MAAM,SAAU,CAAEC,YAAY,UAM1C,IAAMC,EAAY,yCAAG,iBAAO10D,GAAP,8BAAAjE,EAAA,+DACnBiE,EAAMxG,iBACAm7D,EAAO30D,EAAMirB,OACb2pC,EAAW,IAAIC,SAASF,GAC1B7mC,EAAS,GAJM,eAKC8mC,EAASrW,WALV,IAKnB,2BAAWuW,EAA6B,QAChC19D,EAAO09D,EAAM,GAAG/2C,MAAM,KAAKyvB,KAAK,KAChC5pB,EAAM,CAAC,OAAQ,SAAS9qB,SAASg8D,EAAM,IAC5B,SAAbA,EAAM,GACNA,EAAM,GACVhnC,EAAS3T,KAAU2T,EAAQ12B,EAAMwsB,GAVhB,8BAanBwoC,EAAYt+B,GAAQ,GACpBqmC,EAAoBrmC,GAdD,iDAAH,gBAAZ4mC,aAAY,sCAiBZl6C,EAAWvhB,uBACf,WAAgB,IAAD,uBAAXo4D,EAAW,yBAAXA,EAAW,gBACb,IAAMj6D,EAAOi6D,EAAO7jB,KAAK,KACzB,GAAIjzB,EAAU,CACZ,IAAMtjB,EAAQmjB,IAAUG,EAAUnjB,GAClC,OAAOH,GAAgB,KAEvB,IAAM89D,EAAW1D,EAAO11D,OAAS,EACjC,OAAOgtB,GAAmB0oC,EAAO0D,MAGrC,CAACx6C,IAGH,OACE,qBAAKngB,MAAO2L,GAAO/L,UAAnB,SACE,sBAAMyhD,SAAUiZ,EAAc3sD,IAAKksD,EAAnC,SACGx6C,GACCA,EAAQpH,KAAI,SAAC2iD,GAAD,OACV,sBAAwB56D,MAAO2L,GAAO0tD,eAAtC,UACE,cAAC,GAAD,CAAgBr5D,MAAO2L,GAAO4wC,OAAQ1/C,MAAO+9D,IAC5CrB,GAAathD,KAAI,SAACyiD,GAAD,OAChB,cAAC,GAAD,CAEE3vC,MAAO2vC,EAAM3vC,MACbulB,QAASlwB,EAASw6C,EAAcF,EAAMlB,iBACtCxkC,OAAQ5U,EAASw6C,EAAcF,EAAMjB,kBACrCX,oBAAqB4B,EAAMlB,gBAC3BT,qBAAsB2B,EAAMjB,iBAC5BR,QAAS2B,GANJF,EAAM17D,SAJP47D,UAoBPlwB,UAAa/tB,eAAKgc,qBAAWgnD,oBClLtC1S,GAAiB,CACrB5iB,WAAY,EACZd,YAAa,EACb/yB,OAAQ,OACRtzB,OAAQ,QA6EKgqE,OA1Ef,SAASA,4BAAT,GAAkD,IAAzBC,EAAwB,EAAxBA,QAASvE,EAAe,EAAfA,YAC1BprE,EAAW6M,cACXqwB,EAAiBiB,oBAEjBkkD,EAA0BhhF,uBAC9B,SAAChC,GACCW,EAAS,CACPhB,KAAMga,GACN/Z,QAAS,CACP0wE,UACAtwE,aAIN,CAACW,EAAU2vE,IAGP2S,EAAoBjhF,uBAAY,WACpCrB,EAAS,CACPhB,KAAM+Y,GACN9Y,QAAS,CACPuC,GAAImuE,EAAQnuE,GACZ07B,sBAGH,CAACA,EAAgBl9B,EAAU2vE,IAExB4S,EAAkBlhF,uBAAY,WAClC,IAAMmhF,EAAoD,GAA1Ct3E,KAAKC,IAAIwkE,EAAQtlE,EAAErF,KAAO2qE,EAAQtlE,EAAE8V,IACpDngB,EAAS,CACPhB,KAAMkV,GACN0S,QACE+oD,EAAQtlE,EAAErF,MAAQ2qE,EAAQtlE,EAAE8V,GACxB,CAACwvD,EAAQtlE,EAAErF,KAAOw9E,EAAS7S,EAAQtlE,EAAE8V,GAAKqiE,GAC1C,CAAC7S,EAAQtlE,EAAE8V,GAAKqiE,EAAS7S,EAAQtlE,EAAErF,KAAOw9E,KAElD,IAAMC,EAAoD,GAA1Cv3E,KAAKC,IAAIwkE,EAAQrlE,EAAEtF,KAAO2qE,EAAQrlE,EAAE6V,IACpDngB,EAAS,CACPhB,KAAMmV,GACNuR,QACEiqD,EAAQrlE,EAAEtF,MAAQ2qE,EAAQrlE,EAAE6V,GACxB,CAACwvD,EAAQrlE,EAAEtF,KAAOy9E,EAAS9S,EAAQrlE,EAAE6V,GAAKsiE,GAC1C,CAAC9S,EAAQrlE,EAAE6V,GAAKsiE,EAAS9S,EAAQrlE,EAAEtF,KAAOy9E,OAEjD,CAACziF,EAAU2vE,EAAQtlE,EAAErF,KAAM2qE,EAAQtlE,EAAE8V,GAAIwvD,EAAQrlE,EAAEtF,KAAM2qE,EAAQrlE,EAAE6V,KAEtE,OACE,eAAC,WAAD,WACE,6BACE,cAAC,GAAD,CACE+Y,SAAU,kBAAC75B,GACTgjF,EAAwBhjF,IAE1B6E,KAAM63B,GACN18B,MAAOswE,EAAQS,cAAc9zC,OAAOU,KACpCx6B,MAAOitE,OAGX,+CAAQrE,GAAR,cACE,wBACEpsE,KAAK,SACL8J,UAAU,gBACV7G,QAASqgF,EAHX,SAKE,cAAC,KAAD,MAEF,wBAAQtjF,KAAK,SAAS8J,UAAU,cAAc7G,QAASsgF,EAAvD,SACE,cAAC,KAAD,CAAcrkE,MAAM,uCC9BfgzD,OAvDf,SAASA,gDAAT,GAUI,IATFvB,EASC,EATDA,QACAryC,EAQC,EARDA,WACAv9B,EAOC,EAPDA,UACA+B,EAMC,EANDA,QACAG,EAKC,EALDA,QACA2nE,EAIC,EAJDA,SACAt2C,EAGC,EAHDA,KACAovD,EAEC,EAFDA,iBACAC,EACC,EADDA,oBAEA,OACE,8CACM7gF,GADN,IAEQG,QAAS,iBAACN,GAAD,OAAOM,EAAQN,EAAG27B,EAAYhK,IAC7C9wB,MACEzC,EAAUgB,UACTu8B,EAAWv8B,UAAYu8B,EAAWG,aAAenK,EAC9C,CACE3V,MAAO,MACP+W,WAAY,QAEd,KAVR,SAaGlS,IAAUmtD,EAAD,+BAAkCr8C,EAAlC,UAAgD,IAAIvvB,OAC9D,EACE,sBACEhC,aAAc,+BAAM4gF,GAAoB,IACxC3gF,aAAc,+BAAM2gF,GAAoB,IAF1C,UAIGhT,EAAQS,cAAc9zC,OAAOhJ,GAAM+I,MAAMt4B,OAAQ,IAClD,8BACE,wBACE/E,KAAK,SACLwD,MAAO,CACLg9B,WAAYkjD,EAAmB,UAAY,SAC3ChlE,QAAS,EACTzK,OAAQ,GAEVhR,QAAS,iBAACN,GAAD,OAAOioE,EAASjoE,GAAG,EAAO2xB,IAPrC,SASE,cAAC,KAAD,CAAe3V,MAAM,eAIzB2f,EAAWv8B,UAAYu8B,EAAWG,aAAenK,EACnD,IAEA,OCNOsvD,OA1Cf,SAASA,yBAAT,GAaI,IAZFjT,EAYC,EAZDA,QACAmC,EAWC,EAXDA,iBACA+Q,EAUC,EAVDA,eACAC,EASC,EATDA,eACAC,EAQC,EARDA,wBACAC,EAOC,EAPDA,wBACAC,EAMC,EANDA,2BACAC,EAKC,EALDA,2BACAjhF,EAIC,EAJDA,QACA2nE,EAGC,EAHDA,SACAuZ,EAEC,EAFDA,iBACAC,EACC,EADDA,iBAEA,OACE,eAAC,WAAD,WACE,cAAC,GAAD,CACEzT,QAASA,EACTryC,WAAYw0C,EACZ/xE,UAAWojF,EACXrhF,QAAS+gF,EACT5gF,QAASA,EACT2nE,SAAUA,EACVt2C,KAAM,IACNovD,iBAAkBK,EAClBJ,oBAAqBM,IAEvB,cAAC,GAAD,CACEtT,QAASA,EACTryC,WAAYw0C,EACZ/xE,UAAWqjF,EACXthF,QAASghF,EACT7gF,QAASA,EACT2nE,SAAUA,EACVt2C,KAAM,IACNovD,iBAAkBM,EAClBL,oBAAqBO,QC+Bd5R,OAhEf,SAASA,oCAAT,GAAyE,IAA5C3B,EAA2C,EAA3CA,QAASkT,EAAkC,EAAlCA,eAAgBC,EAAkB,EAAlBA,eAC9C9iF,EAAW6M,cAEXw2E,EAAe7gE,IAAUmtD,EAAS,+BAAgC,MAClE2T,EAAe9gE,IAAUmtD,EAAS,+BAAgC,MAClEnuE,EAAKghB,IAAUmtD,EAAS,+BAA2BvoD,GAEnDm8D,EAAeliF,uBACnB,SAAC+G,GACC,IAAM/I,EAAQ+I,EAAMirB,OAAOh0B,MAC3BW,EAAS,CACPhB,KAAM+Z,GACN9Z,QAAS,CACPukF,OAAQ7T,EAAQnuE,GAChB86B,OAAQ,CAAE96B,KAAI6I,EAAGhL,QAIvB,CAACW,EAAUwB,EAAImuE,EAAQnuE,KAEnBiiF,EAAepiF,uBACnB,SAAC+G,GACC,IAAM/I,EAAQ+I,EAAMirB,OAAOh0B,MAC3BW,EAAS,CACPhB,KAAM+Z,GACN9Z,QAAS,CACPukF,OAAQ7T,EAAQnuE,GAChB86B,OAAQ,CAAE96B,KAAI8I,EAAGjL,QAIvB,CAACW,EAAUwB,EAAImuE,EAAQnuE,KAGzB,OACE,eAAC,WAAD,WACE,8CAAQqhF,GAAR,aACoB,OAAjBQ,EACC,cAAC,GAAD,CACEhkF,MAAOgkF,EAAahiE,QAAQ,GAC5BgpC,OAAQk5B,EACRvkF,KAAK,SACLwD,MAAO,CAAEkb,QAAS,mBAGpB,MAGJ,8CAAQolE,GAAR,aACoB,OAAjBQ,EACC,cAAC,GAAD,CACEjkF,MAAOikF,EAAajiE,QAAQ,GAC5BgpC,OAAQo5B,EACRzkF,KAAK,SACLwD,MAAO,CAAEkb,QAAS,mBAGpB,UCsBKgmE,OAnFf,SAASA,qBAAT,GAWI,IAVF/T,EAUC,EAVDA,QACAryC,EASC,EATDA,WACAv9B,EAQC,EARDA,UACA+B,EAOC,EAPDA,QACAG,EAMC,EANDA,QACA2nE,EAKC,EALDA,SACAt2C,EAIC,EAJDA,KACAovD,EAGC,EAHDA,iBACAC,EAEC,EAFDA,oBACAvX,EACC,EADDA,YAEA,OACE,0DACMA,GACAtpE,GAFN,IAGQG,QAAS,iBAACN,GAAD,OAAOM,EAAQN,EAAG27B,EAAYhK,IAH/C,SAKG9Q,IAAUmtD,EAAD,UAAar8C,EAAb,gBAAiC,GAAK,EAC9C9Q,IAAUmtD,EAAD,UAAar8C,EAAb,UAA2B,IAAIvvB,OAAS,EAC/C,sBACEhC,aAAc,+BAAM4gF,GAAoB,IACxC3gF,aAAc,+BAAM2gF,GAAoB,IAF1C,UAIGhT,EAAQr8C,GAAMuJ,YAJjB,QAKE,sBACEr6B,MACE86B,EAAWv8B,SAAYu8B,EAAWG,aAAenK,GACjDgK,EAAWI,UAAaJ,EAAWM,cAAgBtK,GACnDvzB,EAAUgB,SACN,CACE4c,MAAO,MACP+W,WAAY,QAEd,CAAE/W,MAAO,QAAS+W,WAAY,UATtC,SAYGlS,IAAUmtD,EAAD,UAAar8C,EAAb,UAA2B,IAAIvvB,SAjB7C,IAmBQ,IACN,8BACE,wBACE/E,KAAK,SACLwD,MAAO,CACLg9B,WAAYkjD,EAAmB,UAAY,SAC3ChlE,QAAS,EACTzK,OAAQ,GAEVhR,QAAS,iBAACN,GAAD,OAAOioE,EAASjoE,GAAG,EAAM2xB,IAPpC,SASE,cAAC,KAAD,CAAe3V,MAAM,eAIzB2f,EAAWv8B,UAAYu8B,EAAWG,aAAenK,EACnD,0CACM9Q,IAAUmtD,EAAD,UAAar8C,EAAb,gBAAiC,IADhD,MAEE,sBACE9wB,MAAO,CACLmb,MAAO,MACP+W,WAAY,QAHhB,eAQC,OAGHi7C,EAAQr8C,GAAMuJ,YAEdS,EAAWv8B,UAAYu8B,EAAWG,aAAenK,EACnD,gCACG,MACD,sBAAM9wB,MAAO,CAAEmb,MAAO,MAAO+W,WAAY,QAAzC,eACC,OAGH,OC/BOivD,OA7Cf,SAASA,uBAAT,GAcI,IAbFhU,EAaC,EAbDA,QACAthC,EAYC,EAZDA,eACAu1C,EAWC,EAXDA,aACAC,EAUC,EAVDA,aACAC,EASC,EATDA,sBACAC,EAQC,EARDA,sBACAC,EAOC,EAPDA,yBACAC,EAMC,EANDA,yBACA7Y,EAKC,EALDA,YACAnpE,EAIC,EAJDA,QACA2nE,EAGC,EAHDA,SACAsa,EAEC,EAFDA,eACAC,EACC,EADDA,eAEA,OACE,eAAC,WAAD,WACE,cAAC,GAAD,CACExU,QAASA,EACTryC,WAAY+Q,EACZtuC,UAAWmkF,EACXpiF,QAAS8hF,EACT3hF,QAASA,EACT2nE,SAAUA,EACVt2C,KAAM,IACNovD,iBAAkBoB,EAClBnB,oBAAqBqB,EACrB5Y,YAAaA,IAEf,cAAC,GAAD,CACEuE,QAASA,EACTryC,WAAY+Q,EACZtuC,UAAWokF,EACXriF,QAAS+hF,EACT5hF,QAASA,EACT2nE,SAAUA,EACVt2C,KAAM,IACNovD,iBAAkBqB,EAClBpB,oBAAqBsB,EACrB7Y,YAAaA,QC7BftZ,GAAsB,CAAErjD,gBAAiB,aAEzCsjD,GAAgC,CAAEtjD,gBAAiB,WAyM1C21E,I,GAAAA,GAvMf,SAASA,cAAT,GAA8D,IAArCzU,EAAoC,EAApCA,QAAS/F,EAA2B,EAA3BA,SAAU5Q,EAAiB,EAAjBA,cACpC3qB,EAAiBjQ,cAAcuxC,EAAQnuE,IACvC8sC,EAAgB/tC,aAAa,CAAC8tC,EAAe7sC,KAC7C0iF,EAAiB3jF,aACrB,CAAC6sC,GAAQiB,EAAe7sC,GAAI,MAAM46B,OAAOiS,EAAehQ,SAASh0B,GAAK,KAElE85E,EAAiB5jF,aACrB,CAAC6sC,GAAQiB,EAAe7sC,GAAI,MAAM46B,OAAOiS,EAAehQ,SAAS/zB,GAAK,KAGlEwnE,EAAmB1zC,cAAcuxC,EAAQS,cAAc5uE,IACvD2hF,EAAmB5iF,aACvB,CAAC6sC,GAAQ0kC,EAAiBtwE,GAAI,MAAM46B,OAClC01C,EAAiBzzC,SAASh0B,GAAK,GAC/B+iC,GAAQ0kC,EAAiBtwE,GAAI,eAG3B4hF,EAAmB7iF,aACvB,CAAC6sC,GAAQ0kC,EAAiBtwE,GAAI,MAAM46B,OAClC01C,EAAiBzzC,SAAS/zB,GAAK,GAC/B8iC,GAAQ0kC,EAAiBtwE,GAAI,eApB0B,EAwBD4H,oBAAS,GAxBR,mBAwBpD06E,EAxBoD,KAwB7BE,EAxB6B,OAyBD56E,oBAAS,GAzBR,mBAyBpD26E,EAzBoD,KAyB7BE,EAzB6B,OA0BG76E,oBAAS,GA1BZ,mBA0BpD25E,EA1BoD,KA0B3BE,EA1B2B,OA2BG75E,oBAAS,GA3BZ,mBA2BpD45E,EA3BoD,KA2B3BE,EA3B2B,KA6BrD9X,EAAclrE,mBAAQ,WAC1B,MAAO,CACLmyE,QAAS1C,EAAQS,cAAciC,QAC/B7vE,OACsD,IAApDggB,IAAUmtD,EAAS,sBAAsB,GACrC,CAAEjhE,QAAS,QACX,QAEP,CAACihE,IAEE2C,EAAgBjxE,uBACpB,SAACM,EAAGwrC,EAAe7Z,GAEb3xB,GACFA,EAAEE,kBAEJ+nE,EAAS+F,EAASxiC,EAAewiC,EAAQS,cAAczzC,YAAarJ,GACvD,MAATA,OACoBlM,IAAlB+lB,EACEA,GACF62C,GAAyB,GACzB31C,EAAe/P,UAAU,OAEzB2kD,GAA2B,GAC3BnR,EAAiBxzC,UAAU,OAG7B0lD,GAAyB,GACzBf,GAA2B,IAEX,MAAT3vD,OACalM,IAAlB+lB,EACEA,GACF82C,GAAyB,GACzB51C,EAAe/P,UAAU,OAEzB4kD,GAA2B,GAC3BpR,EAAiBxzC,UAAU,OAG7B2lD,GAAyB,GACzBf,GAA2B,KAG7Bc,GAAyB,GACzB31C,EAAe/P,UAAU,KACzB2kD,GAA2B,GAC3BnR,EAAiBxzC,UAAU,KAC3B2lD,GAAyB,GACzB51C,EAAe/P,UAAU,KACzB4kD,GAA2B,GAC3BpR,EAAiBxzC,UAAU,QAG/B,CAACwzC,EAAkBzjC,EAAgBu7B,EAAU+F,IAGzCxlE,EAAe9I,uBAAY,SAACM,EAAG27B,EAAYhK,GAC/C3xB,EAAEE,kBACFy7B,EAAWr7B,QAAQqxB,KAClB,IAEGswD,EAAe1jF,mBAAQ,WAC3B,MAAO,CACL6B,aAAc,wBACZssC,EAAetsC,aAAa,KAC5BmiF,EAAe9iF,QAEjBY,aAAc,wBACZqsC,EAAersC,aAAa,KAC5BkiF,EAAe5iF,WAGlB,CAAC+sC,EAAgB61C,IAEdL,EAAe3jF,mBAAQ,WAC3B,MAAO,CACL6B,aAAc,wBACZssC,EAAetsC,aAAa,KAC5BoiF,EAAe/iF,QAEjBY,aAAc,wBACZqsC,EAAersC,aAAa,KAC5BmiF,EAAe7iF,WAGlB,CAAC+sC,EAAgB81C,IAEdtB,EAAiB3iF,mBAAQ,WAC7B,MAAO,CACL6B,aAAc,wBACZ+vE,EAAiB/vE,aAAa,KAC9BohF,EAAiB/hF,QAEnBY,aAAc,wBACZ8vE,EAAiB9vE,aAAa,KAC9BmhF,EAAiB7hF,WAGpB,CAACwwE,EAAkBqR,IAEhBL,EAAiB5iF,mBAAQ,WAC7B,MAAO,CACL6B,aAAc,wBACZ+vE,EAAiB/vE,aAAa,KAC9BqhF,EAAiBhiF,QAEnBY,aAAc,wBACZ8vE,EAAiB9vE,aAAa,KAC9BohF,EAAiB9hF,WAGpB,CAACwwE,EAAkBsR,IAEtB,OACE,2CACEpqB,cAAe,uBAACr3D,GAAD,OAAOq3D,EAAcr3D,EAAGguE,IACvCntE,MACE8rC,EAAcvtC,UAAYstC,EAAettC,SACrC+wD,IAKM,IAJNtvC,IACEmtD,EACA,yCACA,GAEF5d,GACA,MAEFzjB,EAAcxsC,SAbpB,cAeE,6CAAQspE,GAAR,aAAsBuE,EAAQS,cAAcqC,SAAW,KACvD,aAAC,GAAD,CACE9C,QAASA,EACTkT,eAAgBA,EAChBC,eAAgBA,IAElB,aAAC,GAAD,CACEnT,QAASA,EACTmC,iBAAkBA,EAClB+Q,eAAgBA,EAChBC,eAAgBA,EAChBC,wBAAyBA,EACzBC,wBAAyBA,EACzBC,2BAA4B,oCAAC7hF,GAAD,OAAU6hF,EAA2B7hF,IACjE8hF,2BAA4B,oCAAC9hF,GAAD,OAAU8hF,EAA2B9hF,IACjEa,QAASkI,EACTy/D,SAAU0I,EACV6Q,iBAAkBA,EAClBC,iBAAkBA,IAEpB,aAAC,GAAD,CACEzT,QAASA,EACTthC,eAAgBA,EAChBu1C,aAAcA,EACdC,aAAcA,EACdC,sBAAuBA,EACvBC,sBAAuBA,EACvBC,yBAA0B,kCAAC5iF,GAAD,OAAU4iF,EAAyB5iF,IAC7D6iF,yBAA0B,kCAAC7iF,GAAD,OAAU6iF,EAAyB7iF,IAC7DgqE,YAAaA,EACbnpE,QAASkI,EACTy/D,SAAU0I,EACV4R,eAAgBA,EAChBC,eAAgBA,IAElB,aAAC,GAAD,CAAexU,QAASA,EAASvE,YAAaA,SC1M9CyH,GAAa9hE,YAAH,unBA2IDszE,OAvGf,SAASA,WAAT,GAA4E,IAAtD5pB,EAAqD,EAArDA,UAAWmP,EAA0C,EAA1CA,SAAUlpE,EAAgC,EAAhCA,QAAS4jF,EAAuB,EAAvBA,OAAQzvD,EAAe,EAAfA,YACpDskC,EAAa/oD,mBAEbooD,EAAqBn3D,uBACzB,SAACM,EAAGguE,GACGxnE,0BAA0BxG,KAC7BA,EAAEC,iBACFu3D,EAAWtnD,QAAQ0mD,kBAAkB52D,EAAGguE,MAG5C,CAACxW,IAGGj1D,EAAOhE,mBAAQ,WACnB,IAAM02B,EAAQ,GA0Cd,OAzCA6jC,EAAU1yD,SAAQ,SAAC0oB,EAAM3sB,GACI,IAAvB2sB,EAAK6L,OAAOv4B,OACd6yB,EAAMh2B,KAAN,2BACK6vB,GADL,IAEE2/C,cAAc,2BACT3/C,EAAK2/C,eADG,IAEX9zC,OAAQ7L,EAAK6L,OAAO,GACpBm2C,SAAU3uE,EACV64B,YAAa,EACbn7B,GAAIivB,EAAK6L,OAAO,GAAG96B,QAGdivB,EAAK6L,OAAOv4B,OAAS,GAC9B0sB,EAAK6L,OAAOv0B,SAAQ,SAACu0B,EAAQpb,GAC3B,IAAI5f,GAAO,EACP+wE,EAAU,KACVnxD,EAAIuP,EAAK6L,OAAOv4B,OAAS,GACjB,IAANmd,EACFmxD,EAAU5hD,EAAK6L,OAAOv4B,OAKxBzC,GAAO,EAETs1B,EAAMh2B,KAAN,2BACK6vB,GADL,IAEE2/C,cAAc,2BACT3/C,EAAK2/C,eADG,IAEX9zC,SACA+1C,UACA/wE,OACAmxE,SAAU3uE,EACV64B,YAAazb,EACb1f,GAAI86B,EAAO96B,cAOdo1B,IACN,CAAC6jC,IAEEjI,EAAOtyD,mBACX,kBACEgE,EAAKuW,KAAI,SAACk1D,GAAD,OACP,aAAC,GAAD,CAEEA,QAASA,EACT/F,SAAUA,EACV5Q,cAAe,uBAACr3D,EAAGguE,GAAJ,OAAgBnX,EAAmB72D,EAAGguE,IACrD96C,YAAaA,GALf,wBACwB86C,EAAQS,cAAc5uE,UAOlD,CAACg3D,EAAoBt0D,EAAM0lE,EAAU/0C,IAGvC,OACE,8BACE,sBAAO9jB,IAAK8hE,GAAZ,SACE,gCACE,6BACE,mBAAIR,QAAS,EAAb,eACA,mBAAIrF,QAAS,EAAb,0BACA,mBAAIA,QAAS,EAAb,SACE,aAAC,KAAD,MAEF,mBAAIA,QAAS,EAAb,oBACA,mBAAIqF,QAAS,EAAb,kBACA,mBAAIA,QAAS,EAAb,SAAiB,QAEnB,6BACE,4BAAKiS,EAAO,KACZ,4BAAKA,EAAO,KACZ,4BAAKA,EAAO,KACZ,4BAAKA,EAAO,KACZ,4BAAKA,EAAO,KACZ,4BAAKA,EAAO,QAEb9xB,OAGL,aAAC,GAAD,CAAariD,IAAKgpD,EAAYz4D,QAASA,QC5HvCyN,GAAS,CACb/L,UAAW,CACT6M,cAAe,SACfvJ,OAAQ,OACRgJ,QAAS,QAEXg7D,wBAAyB,CACvBt6D,aAAc,MACdw6C,UAAW,MACXiD,WAAY,MACZ7zB,OAAQ,OACRtzB,OAAQ,OACRD,MAAO,OACPoY,SAAU,OACVH,QAAS,EACTjP,gBAAiB,eAEnBjF,OAAQ,CACNiF,gBAAiB,cACjBuqB,OAAQ,QAEVuF,OAAQ,CACN94B,MAAO,OACPC,OAAQ,OACRmnD,WAAY,MACZn+C,QAAS,OACTC,eAAgB,SAChBC,WAAY,WAIhB,SAAS21E,WAAT,GAA0E,IAApDp7D,EAAmD,EAAnDA,MAAOxE,EAA4C,EAA5CA,UAAWkQ,EAAiC,EAAjCA,YAAajO,EAAoB,EAApBA,QAASlB,EAAW,EAAXA,QAAW,EAC3Btc,oBAAS,GADkB,mBAChE8tD,EADgE,KAChDoG,EADgD,KAGjEpgC,EAAiBiB,oBAEjBn+B,EAAW6M,cACX8E,EAAQzD,IANyD,EAOpC9E,oBAAS,GAP2B,mBAOhEq0D,EAPgE,KAOrDC,EAPqD,KAQjEC,EAAavtD,mBAEbqqD,EAAYv6D,mBAAQ,WACxB,IAAMuzE,EAAW,SAAXA,SAAY+Q,EAAOC,EAAKC,EAAOC,GACnC,IAAMvwC,EAAS,IAKf,OAJAowC,GAAgBpwC,EAEhBswC,GAAgBtwC,EAChBuwC,GAAYvwC,IAFZqwC,GAAYrwC,IAIDxtB,EAAQ,GAAKwtB,GAAUowC,GAAS59D,EAAQ,GAAKwtB,GACnDowC,GAAS59D,EAAQ,GAAKwtB,GAAUqwC,GAAO79D,EAAQ,GAAKwtB,KACrDuwC,GAAOj/D,EAAQ,GAAK0uB,GAAUswC,GAASh/D,EAAQ,GAAK0uB,GACnDswC,GAASh/D,EAAQ,GAAK0uB,GAAUuwC,GAAOj/D,EAAQ,GAAK0uB,IAS3D,GAAIjrB,EAAM+M,OAKR,OAJeghC,EANQ,SAAnB0tB,iBAAoBz7D,GACxB,OAAOA,EAAMlmB,QAAO,SAACwtB,GACnB,OAAOgjD,EAAShjD,EAAKpmB,EAAErF,KAAMyrB,EAAKpmB,EAAE8V,GAAIsQ,EAAKnmB,EAAEtF,KAAMyrB,EAAKnmB,EAAE6V,OAK1DykE,CAAiBz7D,EAAM+M,QACvB/M,EAAM+M,QAEIzb,KAAI,SAACgW,GACjB,OAAO,2BACFA,GADL,IAEE2/C,cAAe,CACbnX,wBAAyBwa,EACvBhjD,EAAKpmB,EAAErF,KACPyrB,EAAKpmB,EAAE8V,GACPsQ,EAAKnmB,EAAEtF,KACPyrB,EAAKnmB,EAAE6V,YAMhB,CAACgJ,EAAO+tC,EAAgBtwC,EAASlB,IAE9Bu4C,EAAiB58D,uBAAY,WACjCi8D,GAAmBpG,KAClB,CAACA,IAEE2tB,EAAoBxjF,uBACxB,SAAC+sC,EAAUjB,EAAexQ,EAAarJ,GACrCtzB,EAAS,CACPhB,KAAMia,GACNha,QAAS,CACPmvC,WACAlR,iBACAiQ,gBACAxQ,cACArJ,YAIN,CAAC4J,EAAgBl9B,IAGbmqE,EAAoB9oE,uBAAY,WACpC8nB,EAAM+M,OAAOnuB,SAAQ,SAAC0oB,GAAD,OAAUo0D,EAAkBp0D,QAChD,CAACtH,EAAM+M,OAAQ2uD,IAEZza,EAA4B/oE,uBAAY,WAC5CsQ,EAAMY,kBAAkB,iDAAkD,CACxErB,MAAOi5D,MAER,CAACA,EAAmBx4D,IAEjBisD,EAAkBv8D,uBAAY,WAClCsQ,EAAMY,kBAAkB,2CAA4C,CAClErB,MAAO,iBACLlR,EAAS,CAAEhB,KAAM+Y,GAAgB9Y,QAAS,CAAEi+B,yBAG/C,CAACA,EAAgBl9B,EAAU2R,IAExBywE,EAAmBliF,mBAAQ,WAG/B,OAFqBsiB,IAAUqS,EAAD,wBAA+BlQ,EAA/B,QAG7B,CAACA,EAAWkQ,IAETkpC,EAAuB18D,uBAAY,WACvCq8D,GAAeD,KACd,CAACA,IAEEO,EAAqB38D,uBAAY,WACrCs8D,EAAW9rD,QAAQ4qD,cACnBiB,GAAc,KACb,IAEGonB,EAAoBzjF,uBAAY,SAACJ,GACrC2iC,GAAO5T,KAAK,0BAA2B,CAAE/uB,UACxC,IAEH,OACE,mCACE,sBAAKuB,MAAO2L,GAAO/L,UAAnB,WACIq7D,GACA,eAAC,GAAD,CACE3G,QAAS3tC,EAAM+M,OAAS/M,EAAM+M,OAAOnyB,OAAS,EAC9CosB,SAAUytC,EACV7G,cAAc,mBACdC,SAAUiH,EACVhH,cACEC,EAAiB,iBAAmB,yBAEtCA,eAAgBA,EAChBC,gBAAiBsD,GAAaA,EAAU12D,OACxCszD,kBAAkB,OAClBD,eAAgB2G,EAXlB,UAaE,cAAC,GAAD,CAAS7/C,MAAK,yBAA4BD,eAAe,QAAzD,SACE,wBACEzb,MAAO2L,GAAOu7D,wBACd1qE,KAAK,SACLiD,QAASmoE,EACTjnE,UAAWgmB,EAAM+M,QAAkC,IAAxB/M,EAAM+M,OAAOnyB,OAJ1C,SAME,cAAC,KAAD,QAGJ,cAAC,GAAD,CACEsb,WAAW,kBACXpB,eAAe,QACfzb,MAAO2L,GAAOowB,OACdxb,cAAY,EACZ9gB,QAAS,0BAAM6iF,EAAkB,UALnC,SAOE,sBAAMtiF,MAAO,CAAEqb,SAAU,OAAQnb,cAAe,QAAhD,iBAEF,cAAC,GAAD,CACE2c,WAAW,oBACXpB,eAAe,QACfzb,MAAO2L,GAAOowB,OACdxb,cAAY,EACZ9gB,QAAS,0BAAM6iF,EAAkB,YALnC,SAOE,sBAAMtiF,MAAO,CAAEqb,SAAU,OAAQnb,cAAe,QAAhD,iBAEF,cAAC,GAAD,CACE2c,WAAW,kBACXpB,eAAe,QACfzb,MAAO2L,GAAOowB,OACdxb,cAAY,EACZ9gB,QAAS,0BAAM6iF,EAAkB,UALnC,SAOE,sBAAMtiF,MAAO,CAAEqb,SAAU,OAAQnb,cAAe,QAAhD,oBAIL+6D,GACC,cAAC,GAAD,CACEpT,OAAQ2T,EACRzuD,QAASwuD,IAGb,qBAAKv7D,MAAO,CAAEkD,OAAQ,OAAQkL,SAAU,QAAxC,SACE,eAAC,KAAD,CACE6sD,UAAWA,EACXU,UAAQ,EACRttD,eAAgB,CAAED,SAAU,UAH9B,UAKE,8BACG6pD,GAAaA,EAAU12D,OAAS,EAC/B,cAAC,GAAD,CACE02D,UAAWA,EACXmP,SAAUib,EACVhwD,YAAautD,EACbkC,OACE3/D,GAA6C,IAAhCA,EAAUwB,MAAM,KAAKpiB,OAC9B4gB,EAAUwB,MAAM,KAChB,CAAC,IAAK,OAId,cAAC,GAAD,MAGJ,cAAC,GAAD,CAAkBhW,IAAKwtD,cAQpBzwB,UAAa/tB,eAAKolE,aCzP3Bp2E,GAAS,CACb1I,MAAO,OACPC,OAAQ,OACRgY,QAAS,MACThP,QAAS,OACTO,cAAe,UAEjB,SAAS81E,MAAT,GAAgD,IAA/B3kF,EAA8B,EAA9BA,SAAU0I,EAAoB,EAApBA,UAAWtG,EAAS,EAATA,MACpC,OACE,qBAAKsG,UAAWA,EAAWtG,MAAK,2BAAO2L,IAAW3L,GAAlD,SACGpC,IAKQ+e,sBAAK4lE,OCfd52E,GAAS,CACb1I,MAAO,OACP0tD,UAAW,OACXzkD,QAAS,OACTO,cAAe,SACfyO,QAAS,UACTC,MAAO,QAET,SAASqnE,UAAT,GAAoD,IAA/B5kF,EAA8B,EAA9BA,SAAU0I,EAAoB,EAApBA,UAAWtG,EAAS,EAATA,MAClCovD,EAAiB1xD,mBAAQ,WAC7B,OAAOojD,WAAS7oC,IAAIra,GAAU,SAACmjD,GAAD,OAC5BlwC,uBAAakwC,EAAO,CAClB/gD,MAAM,aAAGwkC,aAAc,wBAA2Buc,EAAM1jD,MAAM2C,cAGjE,CAACpC,IAEJ,OACE,qBAAK0I,UAAWA,EAAWtG,MAAK,2BAAO2L,IAAP,IAAe3L,UAA/C,SACGovD,IAKQzyC,sBAAK6lE,WCxBd72E,GAAS,CACb1I,MAAO,OACPiJ,QAAS,OACTE,WAAY,cAGd,SAASq2E,UAAUC,GACjB,MAA4B,QAAxBA,EAAMjrE,cACD,aAC0B,WAAxBirE,EAAMjrE,cACR,WAEF,SAET,SAASkrE,YAAT,GAQI,IAPF/kF,EAOC,EAPDA,SACA0I,EAMC,EANDA,UACAtG,EAKC,EALDA,MAKC,IAJD0iF,aAIC,MAJO,SAIP,MAHD7uD,cAGC,MAHQ,SAGR,MAFDpK,YAEC,MAFM,EAEN,EADDhqB,EACC,EADDA,QAEA,OACE,qBACE6G,UAAWA,EACXtG,MAAK,2BACA2L,IADA,IAEHS,WAAYq2E,UAAU5uD,GACtB8Z,UAAW+0C,EACX3zE,KAAM0a,GACHzpB,GAELP,QAASA,EATX,SAWG7B,IAKP+kF,YAAYn5E,aAAe,CACzB/J,QAAS,0BAAM,OAGFkd,sBAAKgmE,aC5Cdh3E,GAAS,CACb1I,MAAO,OACPiJ,QAAS,OACTgP,QAAS,UACTC,MAAO,UACPlP,gBAAiB,UACjBu4B,aAAc,uBACdnpB,SAAU,GACV6W,WAAY,QAEd,SAAS0wD,UAAT,GAAoD,IAA/BhlF,EAA8B,EAA9BA,SAAU0I,EAAoB,EAApBA,UAAWtG,EAAS,EAATA,MACxC,OACE,qBAAKsG,UAAWA,EAAWtG,MAAK,2BAAO2L,IAAW3L,GAAlD,SACGpC,IAKQ+e,sBAAKimE,WClBdj3E,GAAS,CACb1I,MAAO,OACPiJ,QAAS,OACTgP,QAAS,WAEX,SAASynE,qBAAT,GAA+D,IAAxC/kF,EAAuC,EAAvCA,SAAU0I,EAA6B,EAA7BA,UAAWtG,EAAkB,EAAlBA,MAAOP,EAAW,EAAXA,QACjD,OACE,qBACE6G,UAAWA,EACXtG,MAAK,2BAAO2L,IAAW3L,GACvBP,QAASA,EAHX,SAKG7B,IAKP+kF,qBAAYn5E,aAAe,CACzB/J,QAAS,0BAAM,OAGFkd,sBAAKgmE,sBCELE,OArBf,SAASA,eAAetqD,GACtB,IAAMvqB,EAAU,SAAVA,QAAW3Q,GAAW,IAAD,EACQ6M,eAAzBxI,EADiB,EACjBA,KAAMsb,EADW,EACXA,eADW,EAGAtf,mBAAQ,WAC/B,OAAIgE,GAAQsb,GAAkBA,EAAehe,GAC7B0C,EAAK43B,MAAK,SAACrX,GAAD,OAAWA,EAAMjjB,KAAOge,EAAehe,OAAO,CACpE6oB,QAAS,IAIN,KACN,CAAC7K,EAAgBtb,IARZmmB,eAHiB,MAGP,GAHO,EAYjB4Q,EAA0Bp7B,EAA1Bo7B,aAAiBC,EAZA,aAYSr7B,EAZT,kBAazB,OAAO,cAACk7B,EAAD,2BAAsBG,GAAtB,IAA4B7Q,QAASA,EAASla,IAAK8qB,MAG5D,OAAOE,sBAAW,SAACt7B,EAAOsQ,GACxB,OAAO,cAACK,EAAD,2BAAa3Q,GAAb,IAAoBo7B,aAAc9qB,S,UCTvChC,GAAS,CACb3E,OAAQ,CACNiF,gBAAiB,cACjBuqB,OAAQ,OACRtzB,OAAQ,GACRD,MAAO,GACPiY,QAAS,OAEXozC,OAAQ,CACNriD,gBAAiB,UACjB8hD,UAAW,oBACXvpB,aAAc,sBAGlB,SAASs+C,gBAAT,GAAuC,IAAZj7D,EAAW,EAAXA,QACnBrqB,EAAW6M,cADmB,EAEUzD,qBAFV,mBAE7Bm8E,EAF6B,KAEXC,EAFW,KAI9BC,EAAoBpkF,uBACxB,SAACG,EAAIsxC,GACH9yC,EAAS,CAAEhB,KAAMgX,GAAexU,KAAIsxC,cAEtC,CAAC9yC,IAEG0lF,EAAqBrkF,uBACzB,SAACG,GACCxB,EAAS,CAAEhB,KAAMiX,GAAezU,SAElC,CAACxB,IAEG2lF,EAAwBtkF,uBAC5B,SAACukF,GACCJ,GAAkB,SAACK,GACjB,IAAMrkF,EAAKqkF,IAAWD,EAAQ,KAAOA,EAErC,OADA5lF,EAAS,CAAEhB,KAAMiZ,GAAqBzW,OAC/BA,OAGX,CAACxB,IAiDH,OA/CwBE,mBAAQ,WAC9B,OACEmqB,GACAA,EAAQ5P,KAAI,SAACmC,GAAD,OACV,eAACkpE,GAAD,CAEEtjF,MAAOoa,EAAEpb,KAAO+jF,EAAT,eAAiCp3E,GAAO2iD,QAAW,GAF5D,UAIE,cAACi1B,GAAD,CACEb,MAAM,SACNj5D,KAAK,IACLhqB,QAAS,0BAAM0jF,EAAsB/oE,EAAEpb,KAHzC,SAKGob,EAAE2Q,QAEL,cAACw4D,GAAD,CAAWb,MAAM,OAAOj5D,KAAK,IAA7B,SACE,qBAAKhqB,QAAS,iBAACN,GAAD,OAAOA,EAAEE,mBAAvB,SACE,cAAC,KAAD,CAAiBqC,KAAM0Y,EAAEs2B,MAAQt2B,EAAEs2B,MAAQt2B,EAAEvd,YAGjD,eAAC0mF,GAAD,CAAWb,MAAM,SAAS7uD,OAAO,SAASpK,KAAK,IAA/C,UACE,cAAC,GAAD,CACE6mB,QAASl2B,EAAEqK,KACXiS,SAAU,kBAAC9wB,GAAD,OACRq9E,EAAkB7oE,EAAEpb,GAAI4G,EAAMirB,OAAOyf,YAGxCl2B,EAAE21B,eACD,wBACE/vC,MAAO2L,GAAO3E,OACdxK,KAAK,SACLiD,QAAS,0BAAMyjF,EAAmB9oE,EAAEpb,KAHtC,SAKE,cAAC,KAAD,WA5BDob,EAAEpb,SAmCZ,CACDmkF,EACAt7D,EACAq7D,EACAD,EACAF,IAKWpmE,sBAAKmmE,iBCzFpB,SAASU,YAAT,GAAmC,IAAZ37D,EAAW,EAAXA,QAuBrB,OAtBqBnqB,mBAAQ,WAC3B,OAAOmqB,EACL,eAAC,GAAD,WACE,cAAC,GAAD,UACE,eAACy7D,GAAD,WACE,cAACC,GAAD,CAAWb,MAAM,SAASj5D,KAAK,IAA/B,mBAGA,cAAC85D,GAAD,CAAWb,MAAM,SAASj5D,KAAK,IAA/B,6BAKJ,cAAC,GAAD,UACE,cAAC,GAAD,CAAiB5B,QAASA,SAI9B,cAAC,GAAD,MAED,CAACA,IAKSg7D,UAAelmE,eAAK6mE,cCrB7BC,GAAiB,CACrB,CACE/nE,MAAO,UACPhM,UAAW,cAAC,GAAD,IACXg0E,SAAU,KACV1jF,MAAO,GACP2jF,kBAAmB,mBACnBt/D,KAAM,MAER,CACE3I,MAAO,cACPhM,UAAW,cAAC,GAAD,IACXg0E,SAAU,KACV1jF,MAAO,CAAEoO,SAAU,UACnBu1E,kBAAmB,uBACnBt/D,KAAM,MAER,CACE3I,MAAO,QACPhM,UAAW,cAAC,GAAD,IACXg0E,SAAU,CAACz1E,GAAQid,YAAYlsB,IAC/BgB,MAAO,GACP2jF,kBAAmB,iBACnBt/D,KAAM,MAER,CACE3I,MAAO,UACPhM,UAAW,cAAC,GAAD,IACXg0E,SAAU,KACV1jF,MAAO,GACP2jF,kBAAmB,mBACnBt/D,KAAM,MAER,CACE3I,MAAO,YACPhM,UAAW,cAAC,GAAD,IACXg0E,SAAU,CAACz1E,GAAQkd,SAASnsB,IAC5BgB,MAAO,GACP2jF,kBAAmB,qBACnBt/D,KAAM,MAER,CACE3I,MAAO,SACPhM,UAAW,cAACk0E,GAAD,IACXF,SAAU,CAACz1E,GAAQud,cAAcxsB,IACjCgB,MAAO,GACP2jF,kBAAmB,kBACnBt/D,KAAMykB,GAAeC,OAEvB,CACErtB,MAAO,4BACPhM,UAAW,cAAC,GAAD,IACXg0E,SAAU,CAACz1E,GAAQ2d,wBAAwB5sB,IAC3CgB,MAAO,GACP2jF,kBAAmB,mCACnBt/D,KAAM,MAER,CACE3I,MAAO,QACPhM,UAAW,cAAC,GAAD,IACXg0E,SAAU,CAACz1E,GAAQmd,OAAOpsB,IAC1BgB,MAAO,GACP2jF,kBAAmB,iBACnBt/D,KAAMykB,GAAeE,OAEvB,CACEttB,MAAO,UACPhM,UAAW,cAAC,GAAD,IACXg0E,SAAU,GACV1jF,MAAO,GACP2jF,kBAAmB,mBACnBt/D,KAAM,MAER,CACE3I,MAAO,aACPhM,UAAW,cAAC,GAAD,IACXg0E,SAAU,CAACz1E,GAAQud,cAAcxsB,IACjCgB,MAAO,GACP2jF,kBAAmB,sBACnBt/D,KAAM,OAIV,SAASw/D,OAAT,GAAkD,IAAhCx3D,EAA+B,EAA/BA,aAAc+c,EAAiB,EAAjBA,cAAiB,EACHxiC,mBAAS,GADN,mBACxCk9E,EADwC,KAC5BC,EAD4B,KAEzC1xD,EAAc7nB,iBAEpBlM,qBAAU,WAOR,IAAMkf,EANN,SAASwmE,kBACP,IAAMxmE,EAAQimE,GAAe3sD,WAC3B,SAACgL,GAAD,OAAUA,EAAK4hD,UAAY5hD,EAAK4hD,SAAShlF,SAAS2tB,MAEpD,OAAkB,IAAX7O,EAAeA,EAAQ,KAElBwmE,GACV33D,GACF03D,EAAsBvmE,KAEvB,CAAC6O,IAEJ,IAAMq6B,EAAQ7nD,uBACZ,SAACijC,GACC,OACG9hB,IAAUqS,EAAD,yBAAgCyP,EAAK6hD,sBACjC,MAAb7hD,EAAKzd,MAAgByd,EAAKzd,OAAS+kB,KAGxC,CAACA,EAAe/W,IAGlB,OACE,cAAC,GAAD,CAAWy8B,iBAAkBg1B,EAA7B,SACGL,GAAexrE,KAAI,SAAC6pB,GACnB,OACE4kB,EAAM5kB,IACJ,cAAC,GAAD,CAEEpmB,MAAOomB,EAAKpmB,MACZ1b,MAAO8hC,EAAK9hC,MAHd,SAKG8hC,EAAKpyB,WAJDoyB,EAAKpmB,YAaTiB,sBAAKknE,QClJdI,GAAgB,CACpB34E,GACAA,GACAA,GACAA,GACAA,GACAA,GACAA,GACAA,GACAA,GACAA,GACAA,GACAA,GACAA,GACAA,GACAA,GACAA,GACAA,GACAA,GACAA,GACAA,GACAA,GACAA,G7Q2CyB,cAlEM,oB6Q0B/BA,GACAA,GACAA,GACAA,GACAA,GACAA,IAQa44E,OALf,SAASA,gBAAgB1nF,GACvB,OAAKynF,GAAcvlF,SAASlC,I,UClCvB,SAAS2nF,WAAW3rE,GAAuB,IAAfvK,EAAc,uDAAJ,GACnCm2E,EAAmC5rE,EAAnC4rE,mBAAoB3mE,EAAejF,EAAfiF,KAAMo2B,EAASr7B,EAATq7B,KAC9BnyC,EAAO6iD,sBAAQ6/B,EAAmB,GAAGC,YACrC3iF,EAAK6jB,KAAI9H,EAAKgI,WAAY,GAE1BznB,MAAMC,QAAQwf,EAAK4B,WAAU5B,EAAK4B,QAAU5B,EAAK4B,QAAQ,IAE7D,IAAM8F,EAAUouB,gBAAgB,2BAC3BtlC,GAD0B,IAE7BwP,OACAo2B,OACAnyC,OACA+sC,OAAQ,CACN+E,MAAO,KACPC,SAAU,KACVC,SAAUhyC,MAId,OAAOyjB,EAGF,SAASm/D,QAAQ9rE,GAatB,IAb6C,IAAfvK,EAAc,uDAAJ,GACpCiU,EAAY1J,EAAO+rE,WAAW,GAC9BH,EAAqB5rE,EAAO4rE,mBAE5BI,EAAetiE,EAAUsiE,aACzB9vD,EAAIxS,EAAUuiE,MACdC,EAAOxiE,EAAUyiE,UAAUC,UAC3B5L,EAAS92D,EAAU2iE,aAAaD,UAChC51E,EAASkT,EAAU4iE,kBAAkBF,UAErCG,EAASX,EAAmB,GAAGC,WAAW,GAC1Ch/D,EAAK,GACLE,EAAK,GACAjkB,EAAIyjF,EAAOxjF,OAAS,EAAGD,EAAI,EAAGA,GAAK,EAC1C+jB,EAAGjnB,KAAK2mF,EAAOzjF,EAAI,IACnBikB,EAAGnnB,KAAK2mF,EAAOzjF,IAGjB,IACIA,EAAG2wB,EADHvwB,EAAO,GAEX,OAAQ8iF,GACN,IAAK,YACHvyD,EAAK,EAAKjjB,EAASgqE,EAAU,IAC7B13E,EAAKojF,EAAO1L,EAAU,IACtBt3E,EAAK2jB,GAAKA,EACV3jB,EAAK6jB,GAAKA,EACV,MACF,IAAK,OACH0M,EAAK+mD,EACL13E,EAAIojF,EACJhjF,EAAK2jB,GAAKA,EAAGoN,UACb/wB,EAAK6jB,GAAKA,EAAGkN,UAAUxa,KAAI,SAACo1B,GAAD,OAAQA,KAOvC,IADA,IAAIxsB,EAAQ,GACHhZ,EAAI,EAAGA,EAAI6sB,EAAG7sB,IACrBgZ,EAAMziB,KAAK6zB,EAAKpqB,EAAIvG,GAGtBI,EAAKmG,EAAIgZ,EAET,IAAMsE,EAAUouB,gBAAgB,2BAC3BtlC,GAD0B,IAE7B4lC,KAAM5lC,EAAQ4lC,KACdnyC,OACA+sC,OAAQ,CACN+E,MAAO,KACPC,SAAU,KACVC,SAAUhyC,MAGd,OAAOyjB,EAyBT,SAASo/B,sBAAQhJ,GACf,IAAI1zC,EACF0zC,EAAQ,IAAMA,EAAQ,GAAG75C,MAAQ65C,EAAQ,GAAG75C,KAAKmG,EAAI0zC,EAAQ,GAAG75C,KAAKmG,EAAI,GACvEwd,EACFk2B,EAAQ,IAAMA,EAAQ,GAAG75C,MAAQ65C,EAAQ,GAAG75C,KAAKoG,EAAIyzC,EAAQ,GAAG75C,KAAKoG,EAAI,GACvEyd,EACFg2B,EAAQ,IAAMA,EAAQ,GAAG75C,MAAQ65C,EAAQ,GAAG75C,KAAKoG,EAC7CyzC,EAAQ,GAAG75C,KAAKoG,EAChB,KAON,OALID,EAAE,GAAKA,EAAE,KACXA,EAAE4qB,UACFpN,EAAGoN,UACClN,GAAIA,EAAGkN,WAEN,CAAE5qB,IAAGwd,KAAIE,MChGX,SAAS4+D,yBAAW3rE,GAAuB,IAAfvK,EAAc,uDAAJ,GACnCm2E,EAA6B5rE,EAA7B4rE,mBAAoBvwC,EAASr7B,EAATq7B,KACxBnyC,EAAO0iF,EAAmB,GAAGC,WAC3Bv6D,EAAU8uB,gBAAgB,2BAC3B3qC,GAD0B,IAE7B4lC,OACAnyC,OACA+sC,OAAQ,CACN+E,MAAO,KACPC,SAAU,KACVC,SAAUhyC,MAId,OAAOooB,EAIF,SAASw6D,sBAAQ9rE,GAAuB,IACvCsR,EAAU8uB,gBAAgB,IAChC,OAAO9uB,ECnCF,SAASk7D,gBAAgBzpC,EAAS9H,EAAUxlC,GAEjD,OAAO+I,MAAMy8B,GACV7uC,MAAK,SAACsS,GAAD,OAAcA,EAASC,UAC5BvS,MAAK,SAAC4uC,GACLyxC,SAAS1pC,EAAS/H,EAAOvlC,MAIxB,SAASg3E,SAAS1pC,EAAS/H,GAAsB,IAAfvlC,EAAc,uDAAJ,GAE7Ck2C,EAAU+gC,aAAU1xC,EAAO,CAC7B2xC,WAAW,EACXC,IAAI,EACJC,kBAAmB,KACnBC,WAAW,IAEb,GAAuB,IAAnBnhC,EAAQ5iD,OAAZ,CARqD,qBAUnC4iD,GAVmC,IAUrD,2BAA2B,CAAC,IAAnBohC,EAAkB,QACnBnB,EAAuBmB,EAAvBnB,mBAEJA,EAAmB,GAAGC,aACrBD,EAAmB,GAAGC,WAAW9iF,OAAS,GACzC6iF,EAAmB,GAAGC,WAAWh3C,EAAE9rC,SAErCikF,WAAWjqC,EAASgqC,EAAOt3E,IAjBsB,gCAsBvD,SAASu3E,WAAWjqC,EAASgqC,EAAOt3E,GAClC,IAAMiU,EAAYqjE,EAAM9nE,KAAKyE,UACX,IAAdA,GACFq5B,EAAQn9C,KFwCL,SAASqnF,gBAAgBC,GAA4B,IAAfz3E,EAAc,uDAAJ,GAC7Cm2E,EAAmCsB,EAAnCtB,mBAAoB3mE,EAAeioE,EAAfjoE,KAAMo2B,EAAS6xC,EAAT7xC,KAC9BnyC,EAAO6iD,sBAAQ6/B,EAAmB,GAAGC,YAiBzC,OAhBIrmF,MAAMC,QAAQwf,EAAK4B,WAAU5B,EAAK4B,QAAU5B,EAAK4B,QAAQ,IAC7Ck0B,gBAAgB,2BAC3BtlC,GAD0B,IAE7BwP,OACAo2B,OACAnyC,OACA+sC,OAAQ,CACN+E,MAAO,KACPC,SACExlC,EAAQwgC,QAAUxgC,EAAQwgC,OAAOgF,SAC7BxlC,EAAQwgC,OAAOgF,SACf,KACNC,SAAUhyC,MEvDCikF,CAA8BJ,EAAOt3E,IAElC,IAAdiU,GACFq5B,EAAQn9C,KD1CL,SAASqnF,8BAAgBC,GAA4B,IAAfz3E,EAAc,uDAAJ,GAC7Cm2E,EAAmCsB,EAAnCtB,mBAAoB3mE,EAAeioE,EAAfjoE,KAAMo2B,EAAS6xC,EAAT7xC,KAC9BnyC,EAAO0iF,EAAmB,GAAGC,WAejC,OAdWzrC,gBAAgB,2BACtB3qC,GADqB,IAExBwP,OACAo2B,OACAnyC,OACA+sC,OAAQ,CACN+E,MAAO,KACPC,SACExlC,EAAQwgC,QAAUxgC,EAAQwgC,OAAOgF,SAC7BxlC,EAAQwgC,OAAOgF,SACf,KACNC,SAAUhyC,MC4BCkkF,CAA8BL,EAAOt3E,IAItD,SAAS43E,QAAQtqC,EAASt5B,GACxB,IAAMC,EAAYD,EAAMxE,KAAKyE,UACX,IAAdA,GACFq5B,EAAQn9C,KACN0nF,gBAAA,2BAA6B7jE,GAA7B,IAAoCvgB,KAAMugB,EAAMwsB,OAAOiF,aAGzC,IAAdxxB,GACFq5B,EAAQn9C,KACN2nF,gBAAA,2BAA6B9jE,GAA7B,IAAoCvgB,KAAMugB,EAAMwsB,OAAOiF,aAKtD,SAASsyC,OAAOzqC,EAAS0qC,GAAoB,IAAfh4E,EAAc,uDAAJ,GAEzCi4E,EAAYC,aAASF,EAAK,IAC1BxoE,EAAOyoE,EAAUE,YACjBC,EAAW5oE,EAAK4oE,gBACb5oE,EAAK4oE,SACZ5oE,EAAK6oE,gBAAkB,EACvB7oE,EAAKgsB,WAAgC,IAAnBhsB,EAAKyE,UAAkB,KAAO,KAChDzE,EAAKjhB,KAAO,eACZihB,EAAK4B,QAAU5B,EAAK4B,QAAQ,GAC5B5B,EAAKqJ,eAAiBrJ,EAAKqJ,eAAe,GAC1CrJ,EAAK8oE,gBAAkB9oE,EAAK8oE,gBAAgB,GAE5C9oE,EAAK4K,cAAgB5K,EAAK4K,cAAc,GACxC5K,EAAK8K,gBAAkB9K,EAAK8K,gBAAgB,GAE5C9K,EAAK+oE,qBAAuBN,EAAUO,YAAYD,qBAE3B,IAAnB/oE,EAAKyE,WACHgkE,EAAU9B,oBACZ7oC,EAAQn9C,KACNunF,QAAsBO,EAAtB,2BACKj4E,GADL,IAEE/B,QAAQ,eAAM+B,EAAQ/B,SACtBuR,KAAMA,EACNo2B,KAAMwyC,MAKS,IAAnB5oE,EAAKyE,WAAmBzE,EAAKipE,MAC/BnrC,EAAQn9C,KACNwnF,sBAAsBM,EAAtB,2BACKj4E,GADL,IAEE/B,QAAQ,eAAM+B,EAAQ/B,SACtBuR,W,8DAMD,yDAAA9b,EAAA,+DAAwBD,EAAxB,+BAA+B,GAC9B65C,EAAU,GACZorC,EAAW,GAFV,eAIajlF,GAJb,IAIL,2BAC4B,OADnBugB,EAAe,SACZwsB,OAAO+E,MACfyxC,SAAS1pC,EAASt5B,EAAMwsB,OAAO+E,MAAOvxB,GACJ,MAAzBA,EAAMwsB,OAAOgF,SACtBkzC,EAASvoF,KAAK4mF,gBAAgBzpC,EAASt5B,EAAMwsB,OAAOgF,SAAUxxB,IAE9D4jE,QAAQtqC,EAASt5B,GAVhB,8CAaClK,QAAQC,IAAI2uE,GAbb,gCAcEprC,GAdF,kD,sBAiBA,SAAeqrC,UAAtB,6C,gEAAO,kBAAyB34E,EAASvM,GAAlC,8BAAAC,EAAA,uEACC45C,EAAU,GADX,SAEc4oC,aAAWziF,EAAM,CAAE0jF,IAAI,EAAMyB,YAAY,IAFvD,OAEDruE,EAFC,OAGD2rC,EAAU3rC,EAHT,eAIa2rC,GAJb,IAIL,2BAASohC,EAAkB,QACnB9nE,EAA6B8nE,EAA7B9nE,KAAM2mE,EAAuBmB,EAAvBnB,mBACW,IAAnB3mE,EAAKyE,UACHkiE,EAAmB,GAAGC,YACxB9oC,EAAQn9C,KACNunF,WAAyBJ,EAAzB,2BACKt3E,GADL,IAEE/B,QAAQ,eAAM+B,EAAQ/B,aAIA,IAAnBuR,EAAKyE,WACVzE,EAAKipE,MACPnrC,EAAQn9C,KACNwnF,yBAAyBL,EAAzB,2BACKt3E,GADL,IAEEwP,OACAvR,QAAQ,eAAM+B,EAAQ/B,aArB3B,uDA6BEqvC,GA7BF,mD,sBAoFA,SAASurC,sBAAOxqF,GAAQ,IAAD,EAOxBA,GAAS,CACXoF,KAAM,GACN23B,UAAW,GACXhH,YAAa,GACbgnD,aAAc,GACd0N,iBAAkB,IAVlBrlF,EAF0B,EAE1BA,KACA23B,EAH0B,EAG1BA,UACAhH,EAJ0B,EAI1BA,YACAgnD,EAL0B,EAK1BA,aACA0N,EAN0B,EAM1BA,iBAYF,MAAO,CACLxrC,QALc75C,EAAKuW,KAAI,SAAC+uE,GACxB,OAA6B,IAAtBA,EAAGvpE,KAAKyE,U3KpBZ,SAAS4kE,OAAO3hE,GACrB,MAAO,CACLzjB,KAAMyjB,EAAQorB,aACdvxC,GAAImmB,EAAQnmB,GACZyvC,OAAQ,CACN+E,MAAOruB,EAAQspB,OAAO+E,MACtBC,SAAUtuB,EAAQspB,OAAOgF,SACzBC,SACEvuB,EAAQspB,OAAOgF,UAAYtuB,EAAQspB,OAAO+E,MACtC,GACAruB,EAAQspB,OAAOiF,UAEvBxnC,QAASiZ,EAAQjZ,QACjBuR,KAAM0H,EAAQqrB,aACdqD,KAAM1uB,EAAQ0uB,KACd5c,MAAO9R,EAAQ8R,MACfxD,UAAWtO,EAAQsO,UACnB0F,OAAQhU,EAAQgU,OAChBtR,QAAS1C,EAAQ0C,S2KEgBi+D,CAAekB,GzKxB7C,SAASF,eAAO7kE,GACrB,MAAO,CACLvgB,KAAMugB,EAAMsuB,aACZvxC,GAAIijB,EAAMjjB,GACVyvC,OAAQ,CACN+E,MAAOvxB,EAAMwsB,OAAO+E,MACpBC,SAAUxxB,EAAMwsB,OAAOgF,SACvBC,SAAUzxB,EAAMwsB,OAAOgF,SAAW,GAAKxxB,EAAMwsB,OAAOiF,UAEtD/sB,MAAO1E,EAAM0E,MACbkB,QAAS5F,EAAM4F,QACf3b,QAAS+V,EAAM/V,QACfuR,KAAMwE,EAAMuuB,aACZqD,KAAM5xB,EAAM4xB,MyKW0CkyC,CAAeiB,MAKrE3tD,YACAhH,cACAgnD,eACA0N,oBC7NJ,SAASE,yBAAyBzkE,GAAsB,IACxC+4B,EAA0B/4B,EAAhC9gB,KAAe23E,EAAiB72D,EAAjB62D,aACvB72D,EAAM62D,aAAe6N,SAAMC,MACzB5rC,EACA89B,EAAaprE,QACb4rE,KAAgBR,EAAa3lD,SCDjC,SAAS0zD,cAAc5kE,GACrB,GAAIA,EAAML,UAAW,CACnB,IACIzgB,EADmB4wE,GAAe,UAC3BmD,CAAejzD,EAAM9gB,MAAM8gB,EAAML,WAC5C,GAAIK,EAAM4mB,gBAAkBN,GAAeE,MACzC,OAAOtnC,EAEP,GAAI8gB,EAAMxF,gBAAkBtb,EAAM,CAChC,IAAM2lF,EAAsB3lF,EAAKo1B,WAC/B,SAAC7U,GAAD,OAAWA,EAAMjjB,KAAOwjB,EAAMxF,eAAehe,MAE/C,IAA6B,IAAzBqoF,EAA4B,CAC9B,IAAM3hE,EAAQhkB,EAAK2lF,GAAqB5pE,KAAKiI,QAAS,EACtDhkB,EAAOA,EAAKjB,QAAO,SAACwhB,GAAD,OAAWA,EAAMxE,KAAKiI,QAAUA,WAGrDhkB,EAAOA,EAAOA,EAAKjB,QAAO,SAACwhB,GAAD,OAAgC,IAArBA,EAAMxE,KAAKiI,SAAmB,GAVhE,qBAaalD,EAAM9gB,MAbnB,+BAaIugB,EAbJ,QAcCvgB,EAAKlD,MAAK,SAAC8oF,GAAD,OAAqBA,EAAWtoF,KAAOijB,EAAMjjB,MAExDijB,EAA4B/V,QAAQqnB,mBAAoB,EAGxDtR,EAA4B/V,QAAQqnB,mBAAoB,GAN7D,2BAA+B,IAb1B,8BAsBL,OAAO/Q,EAAM9gB,KAGf,OAAO8gB,EAAM9gB,KAIjB,SAAS6lF,UAAU7lF,GACjB,IAAI8lF,EAAS,GACTC,EAAS,GACT7kE,EAAW,GACXuB,EAAW,GACXujE,EAAkB,GACtB,IACEF,EAAS9lF,EAAK2gB,QAAO,SAACC,EAAKlI,GAAgB,IACjClO,EAAkBkO,EAAlBlO,QAASxK,EAAS0Y,EAAT1Y,KACjB,GAAIwK,EAAQqnB,kBAAmB,CAC7B,IAAMjQ,EAAS,CAAC5hB,EAAKmG,EAAE,GAAInG,EAAKmG,EAAEnG,EAAKmG,EAAEtG,OAAS,IAKlD,OAJA4iB,EAAS/J,EAAEpb,IAAMskB,EACbpX,EAAQonB,YACVhR,EAAMA,EAAIsX,OAAOtW,IAEZhB,EAEP,OAAOA,EAAIsX,OAAO,MAEnB,IAEH6tD,EAAS/lF,EAAK2gB,QAAO,SAACC,EAAKlI,GAAgB,IACjClO,EAA6BkO,EAA7BlO,QAASxK,EAAoB0Y,EAApB1Y,KAAM+xB,EAAcrZ,EAAdqZ,UACvB,GAAIvnB,EAAQqnB,kBAAmB,CAC7B,IAAMo0D,EAAUxsC,aAAOz5C,EAAKoG,GAE5B,GADA8a,EAASxI,EAAEpb,IAAM2oF,EACbl0D,EAAUC,QAAUD,EAAUC,OAAOnyB,OAAS,EAAG,CACnD,IADmD,EACpCkyB,EAAUC,OACG,GAApBlxB,EAF2C,EAE3CA,KAAMmb,EAFqC,EAErCA,GACN9V,EAASnG,EAATmG,EAAGC,EAAMpG,EAANoG,EACLyqB,EAAiBC,aACrB,CAAE3qB,EAAGA,EAAGC,EAAGA,GACX,CACEtF,KAAMA,EACNmb,GAAIA,EACJ8U,SAAS,IAGbi1D,EAAgBttE,EAAEpb,IAAMm8C,aAAO5oB,EAAezqB,GAKhD,OAHIoE,EAAQonB,YACVhR,EAAMA,EAAIsX,OAAO+tD,IAEZrlE,EAEP,OAAOA,EAAIsX,OAAO,MAEnB,IACH,MAAOz6B,GAEP+E,QAAQC,IAAIhF,GAGd,MAAO,CACLilB,QAAS+2B,aAAOqsC,GAChBtkE,QAASi4B,aAAOssC,GAChB7kE,WACAuB,WACAujE,mBAGJ,SAASE,YAAYtrF,GACnB,IAAIkrF,EAAS,GACTC,EAAS,GACT7kE,EAAW,GACXuB,EAAW,GAEPhC,EAAuC7lB,EAAvC6lB,UAAWuB,EAA4BpnB,EAA5BonB,kBAAmBhiB,EAASpF,EAAToF,KAEhC2d,EAAU8C,EAAUwB,MAAM,KAEhC,IACE6jE,EAAS9lF,EAAK2gB,QAAO,SAACC,EAAKL,GAOzB,OAN6B,IAAzBA,EAAMxE,KAAKyE,YACbI,EAAMA,EAAIsX,OAAO,CACd3X,EAAkBvgB,KAAKqoB,KACvB9H,EAAkBvgB,KAAKsoB,QAGrB1H,IACN,IAEHmlE,EAAS/lF,EAAK2gB,QAAO,SAACC,EAAKL,GAA8B,IAAD,EAUtD,OAR2B,IAAzBA,EAAMxE,KAAKyE,YACX,UAAAD,EAAMxE,KAAK4B,eAAX,eAAoB+zB,KAAK,QAASjxB,IAElCG,EAAMA,EAAIsX,OAAO,CACd3X,EAAkBvgB,KAAKuoB,KACvBhI,EAAkBvgB,KAAKwoB,QAGrB5H,IACN,IACH,MAAOnjB,GAEP+E,QAAQC,IAAIhF,GAGd,IAAM0oF,EAAexoE,EAAQpH,KAAI,SAACyc,GAAD,uBAAOhR,EAAkBgR,UAAzB,aAAO,EAAsB11B,MAExD8oF,EAAepmF,EAAK2gB,QAAO,SAACC,EAAKL,GACrC,OAAO4lE,EAAanpF,SAASujB,EAAMjjB,KAAgC,IAAzBijB,EAAMxE,KAAKyE,UACjDI,EAAIsX,OAAO3X,GACXK,EAAIsX,OAAO,MACd,IACH,IACEzV,EAAW2jE,EAAazlE,QAAO,SAACC,EAAKlI,GAAgB,IAC3CvS,EAAMuS,EAAE1Y,KAARmG,EACFyb,EAAS,CAACzb,EAAE,GAAIA,EAAEA,EAAEtG,OAAS,IAEnC,OADA+gB,EAAIlI,EAAEpb,IAAMskB,EACLhB,IACN,IAEHM,EAAWklE,EAAazlE,QAAO,SAACC,EAAKlI,GACnC,IAAMutE,EAAUxsC,aAAO/gC,EAAE1Y,KAAKoG,GAE9B,OADAwa,EAAIlI,EAAEpb,IAAM2oF,EACLrlE,IACN,IACH,MAAOnjB,GAEP+E,QAAQC,IAAIhF,GAGd,MAAO,CACLilB,QAAS+2B,aAAOqsC,GAChBtkE,QAASi4B,aAAOssC,GAChB7kE,WACAuB,YAIJ,SAAS4jE,UAAUvlE,GAA+C,IAC5Dc,EADkC0kE,IAAyB,yDAEzDtmF,EAAO0lF,cAAc5kE,GAGzBA,EAAML,WACN,CAAC2mB,GAAeC,MAAOD,GAAeE,OAAOtqC,SAAS8jB,EAAM4mB,iBAE5D9lB,EACEd,EAAM4mB,gBAAkBN,GAAeC,MACnCw+C,UAAU7lF,GACVkmF,YAAYplE,GAClBA,EAAM4B,QAAUd,EAAOc,QACvB5B,EAAM2B,SAAWb,EAAOa,SACpB6jE,GACFxlE,EAAMU,QAAUI,EAAOJ,QAEnBV,EAAM4mB,gBAAkBN,GAAeC,OACzCvmB,EAAMI,SAAW7lB,OAAOC,KAAKsmB,EAAOV,UAAUP,QAAO,SAACC,EAAK7jB,GAEzD,OADA6jB,EAAI7jB,GAAO6kB,EAAOJ,QACXZ,IACN,IACHE,EAAMM,aAAN,2BACKQ,GADL,IAEEV,SAAUJ,EAAMI,SAChBqlE,eAAgB3kE,EAAOV,aAGzBJ,EAAMI,SAAWU,EAAOV,SACxBJ,EAAMM,aAAeQ,GAGvBd,EAAMyB,kBACJX,EAAOokE,iBAAmBpkE,EAAOokE,gBACnCllE,EAAMqB,sBACJP,EAAOokE,iBAAmBpkE,EAAOokE,iBAEnCllE,EAAMM,aAAN,2BACKN,EAAMM,cADX,IAEEsB,QAASd,EAAOc,QAChBD,SAAUb,EAAOa,YA0BzB,SAAS+jE,QAAQ1lE,GAAQ,IAAD,EAChB9gB,EAAO0lF,cAAc5kE,GAAO/hB,QAChC,SAACwhB,GAAD,OAA+C,IAApCA,EAAM/V,QAAQqnB,qBAE3B/Q,EAAM6B,MAAO,UAAC3iB,EAAK,UAAN,eAAsB+b,KAAKiI,OAAQ,MAAQ,MChP3CyiE,OAPf,SAASA,mBAAwC,IAAvBtmD,EAAsB,uDAAd,GAAIumD,EAAU,uDAAH,EACrCxjB,EAAU/iC,EAAMxf,QAAO,SAACgmE,EAAMC,GAClC,OAAO5/E,KAAKC,IAAI2/E,EAAOF,GAAQ1/E,KAAKC,IAAI0/E,EAAOD,GAAQE,EAAOD,KAEhE,OAAOzjB,GCJY2jB,G,WACnB,uBAAe,+BACbznE,KAAK0nE,MAAQ,G,mDAcf,SAAApqF,KAAKorB,GACH1I,KAAK0nE,MAAMpqF,KAAKorB,K,iBAGlB,SAAAi/D,MAEE,OADY3nE,KAAK0nE,MAAMC,MACV3nE,KAAK0nE,MAAM1nE,KAAK0nE,MAAMjnF,OAAS,GAAK,O,qBAGnD,SAAAmnF,UACE,OAA0B,IAAtB5nE,KAAK0nE,MAAMjnF,OAAqB,KAC7Buf,KAAK0nE,MAAM1nE,KAAK0nE,MAAMjnF,OAAS,M,0BAtBxC,qBAAmBonF,EAAsBtpE,GACvC,OACEspE,EAAqBtpE,IACrBspE,EAAqBtpE,aAAoBkpE,cAI3CI,EAAqBtpE,GAAW,IAAIkpE,aAF3BI,EAAqBtpE,O,eCSlC,SAASupE,gCACPpmE,EACAykD,GAEC,IADD4hB,EACA,wDACA,GAAIrmE,EAAM9gB,MAAQ8gB,EAAM9gB,KAAKH,OAAS,EACpC,GACE0lE,GACC4hB,GACErmE,EAAM9gB,KAAK,GAAe+b,KAAKiI,QAC9BlD,EAAM9gB,KAAmBlD,MAAK,SAAC4b,GAAD,OAAwB,IAAjBA,EAAEqD,KAAKiI,SAChD,CACA,IAAMojE,EAAatmE,EAAMtf,OAAS,EAClCsf,EAAM+B,cAAcE,MAAO,EAC3BjC,EAAM+B,cAAc1nB,MAAQisF,EAC5BtmE,EAAM+B,cAAcG,SAAU,OAE9BlC,EAAM+B,cAAcE,MAAO,EAC3BjC,EAAM+B,cAAc1nB,MtMrCe,GsMsCnC2lB,EAAM+B,cAAcG,SAAU,ECnBpC,SAASqkE,iBAAiBvmE,GAA8C,IAAzBwmE,IAAwB,yDACjEA,IACFxmE,EAAM+qC,oBAAsB,KAC5B/qC,EAAM6J,aAAepe,GAAQ6c,KAAK9rB,IAEpC,IAAMijB,EAAQO,EAAM9gB,KAAK8gB,EAAMxF,eAAeQ,OAC9CyE,EAAMvgB,KAAKoG,EAAIma,EAAMvgB,KAAK2jB,GA4J5B,SAAS4jE,4BAAazmE,EAAqBouB,GAAW,IAAD,EACnD,aAAIpuB,EAAMxF,sBAAV,aAAI,EAAsBhe,GAAI,CAAC,IAAD,IACpBwe,EAAUgF,EAAMxF,eAAhBQ,OrLpEZ,SAASyrE,aAAahnE,EAAOjjB,GAM3B,IAAK,IAAIyxC,KALTxuB,EAAM4F,QAAU5F,EAAM4F,QAAQvnB,MAAM,GACpC2hB,EAAM4F,QAAU5F,EAAM4F,QAAQpnB,QAAO,SAACA,GAAD,OAAYA,EAAOzB,KAAOA,KAC/DijB,EAAMvgB,KAAN,2BAAkBugB,EAAMvgB,MAASugB,EAAMsuB,cACvCtuB,EAAMxE,KAAN,2BAAkBwE,EAAMxE,MAASwE,EAAMuuB,cAEfvuB,EAAM4F,QAAS,CACrC,IAAMpnB,EAASwhB,EAAM4F,QAAQ4oB,GAM7B,GALAxuB,EAAM4F,QAAQ4oB,GAAd,2BACKxuB,EAAM4F,QAAQ4oB,IADnB,IAEEC,MAAO,OAGLjwC,EAAOgkB,KACT,IACE0F,GAAQ1pB,EAAO+W,MAAM0N,MAAMjD,EAAOxhB,EAAO5D,OACzC,MAAO6zC,GACPzuB,EAAM4F,QAAQ4oB,GAAd,2BACKxuB,EAAM4F,QAAQ4oB,IADnB,IAEEC,MAAOA,EAAM9hC,YqLoDnBmlC,CAA4BvxB,EAAM9gB,KAAK8b,GAAQozB,GAEL,KAAtC,UAAApuB,EAAM9gB,KAAK8b,GAAOC,YAAlB,eAAwByE,WAC1B0zB,aAAapzB,EAAM9gB,KAAK8b,IACuB,KAAtC,UAAAgF,EAAM9gB,KAAK8b,GAAOC,YAAlB,eAAwByE,YACjCgnE,YAAc1mE,EAAM9gB,KAAK8b,IAG3BurE,iBAAiBvmE,GAAO,GACxBulE,UAAUvlE,GACV0lE,QAAQ1lE,IClMG,SAASo0B,kBAASp0B,EAAOvU,GAAU,IACxCzF,EAAiByF,EAAjBzF,OAAQC,EAASwF,EAATxF,KACVwU,EAASiH,UAAU1B,GAEnBtc,EAAQ+W,EAAOS,OAAOlV,GACtBrC,EAAM8W,EAAOS,OAAOjV,GACpBxH,EAAkB,GAQxB,OAPIiF,EAAQC,GACVlF,EAAM,GAAKkF,EACXlF,EAAM,GAAKiF,IAEXjF,EAAM,GAAKiF,EACXjF,EAAM,GAAKkF,GAENlF,EC+ET,SAASkoF,eAAe3mE,EAAqBjmB,GAAS,IAAD,EAC7CD,EAAQo3C,aAASlxB,GACjB2I,EAAW5uB,EAAOmF,KACxB,aAAI8gB,EAAMxF,sBAAV,aAAI,EAAsBhe,GAAI,CAAC,IACrBwe,EAAUgF,EAAMxF,eAAhBQ,MAEF4rE,EAAe9sF,EAAMoF,KAAK8b,GAC1ByE,EAAQO,EAAM9gB,KAAK8b,GAJG,EAMV4rE,EAAa1nF,KAAvBmG,EANoB,EAMpBA,EAAGwd,EANiB,EAMjBA,GACLgkE,EAAgBD,EAAa31D,UAAUC,OAAOoD,WAClD,SAACx1B,GAAD,OAAOA,EAAEtC,KAAOmsB,EAASnsB,OAEJ,IAAnBqqF,IACFpnE,EAAMwR,UAAUC,OAAO21D,GAAvB,yBAEEp0C,WAAY9pB,EAAS3oB,KACrB0yC,SAAU/pB,EAASxN,IAChBwN,GAJL,IAKEf,SAAU2qB,aACR,CAAEltC,IAAGC,EAAGud,GACR,CAAE7iB,KAAM2oB,EAAS3oB,KAAMmb,GAAIwN,EAASxN,GAAI8U,SAAS,MAGrD2hB,wBAAwBnyB,EAAMwR,aAKpC,SAAS61D,kCAAkC9mE,EAAqBjmB,GAAS,IAAD,EAC9DyC,EAAczC,EAAdyC,GAAInC,EAAUN,EAAVM,MACZ,aAAI2lB,EAAMxF,sBAAV,aAAI,EAAsBhe,GAAI,CAAC,IACrBwe,EAAUgF,EAAMxF,eAAhBQ,OnLgJL,SAAS+rE,wBAAwB91D,EAAWz0B,EAAIwqF,GACrD,IAAMr+D,EAAWsI,EAAUC,OAAO4F,MAAK,SAACnO,GAAD,OAAcA,EAASnsB,KAAOA,KACrE,GAAImsB,EAAU,CACZ,IAAMoS,EAAQpS,EAASf,SAAWo/D,EADtB,EAEY/1D,EAAUC,OAAOrR,QACvC,SAACC,EAAK6I,EAAU3N,GACd,IAAMgsE,EAAmBr+D,EAASf,SAAWmT,EAO7C,OANAjb,EAAIwxB,KAAO01C,EACXlnE,EAAIoR,OAAOlW,GAAX,2BACK2N,GADL,IAEEA,SAAUq+D,IAGLlnE,IAET,CAAEoR,OAAQ,GAAIogB,IAAK,IAXbpgB,EAFI,EAEJA,OAAQogB,EAFJ,EAEIA,IAchBrgB,EAAUC,OAASA,EACnBD,EAAUxlB,QAAQ6lC,IAAMA,GmLlKxBy1C,CACG/mE,EAAM9gB,KAAK8b,GAAmBiW,UAC/Bz0B,EACAnC,ICzHC,SAAS4sF,eAA4B,IAAfx7E,EAAc,uDAAJ,GAC/By7E,EAAW,GACjBA,EAASjrF,IAAMwP,EAAQxP,KAAO2wC,aAC9Bs6C,EAASp2B,QAAUrlD,EAAQqlD,SAAW,GACtC,IAAMD,EAAM,IAAIs2B,YAAYC,YAAYF,EAASp2B,SAC3Cu2B,EAASx2B,EAAIy2B,sBACnBJ,EAASv8C,GAAK08C,EAAOpoB,QACrBioB,EAASxgE,GAAK2gE,EAAOE,eACrBL,EAASn2B,GAAKs2B,EAAOG,eACrBN,EAAShkF,IAAM2tD,EAAI42B,MAAM,GAAI,IAE7B,IAAM98C,EAAK,IAAIuwC,MAAGgM,EAASv8C,IAE3B,OADAu8C,EAAS91B,MAAQzmB,EAAG+8C,UAAUt2B,MACvB81B,ECFF,SAASS,WAAW9wD,EAAWi6B,GAGpC,IAH6C,EAIzC82B,EADaC,YAAST,YAAYt2B,GACbg3B,eAJoB,eAKxBF,GALwB,IAK7C,2BAAgC,CAAC,IAAxBxtB,EAAuB,UAK1BA,EAASktB,sBAHXroB,EAF4B,EAE5BA,QACAsoB,EAH4B,EAG5BA,eACAC,EAJ4B,EAI5BA,eAEF3wD,EAAUj7B,KACRqrF,aAAa,CACXn2B,QAASsJ,EAAS2tB,cAClB7kF,IAAKk3D,EAASqtB,MAAM,IAAK,KACzB98C,GAAIs0B,EACJv4C,GAAI6gE,EACJx2B,GAAIy2B,MAjBmC,+BCgB/C,SAASQ,iBAAiBhoE,EAAqBioE,GAC7C,IAAMC,EAAmBloE,EAAMxF,eAAehe,GAI9C,GAAIyrF,IAAmBtgE,GAAQK,gBAAgBxrB,GAAI,CACjDwjB,EAAM2R,SAAW3R,EAAM9gB,KAD0B,IAGzCikC,EApBZ,SAASglD,iBAAiBnoE,GAAsB,IACtCxF,EAAyBwF,EAAzBxF,eACFsqE,EAD2B9kE,EAAT9gB,KACAsb,EAAeQ,OAAO9b,KACxCkpF,EAAqB5nE,aAAIskE,EAAWx/E,GACpC0V,EAAQ8pE,EAAWx/E,EAAEgvB,WAAU,SAACtN,GAAD,OAASA,IAAQohE,KACtD,MAAO,CACLjlD,OAAQ2hD,EAAWz/E,EAAE2V,GACrBkoB,OAAQklD,EACRptE,MAAOA,GAYYmtE,CAAiBnoE,GAA5BmjB,OACRnjB,EAAMwjB,MAAQL,OAEd,GAAInjB,EAAM6J,eAAiBpe,GAAQuc,gBAAgBxrB,GAAI,CACrD,IAAM6rF,EAAgBroE,EAAM9gB,KAAKo1B,WAC/B,SAACtD,GAAD,OAAcA,EAASx0B,KAAO0rF,KAGhCloE,EAAM9gB,KAAKmpF,GAAenpF,KAAO8gB,EAAM2R,SAAS02D,GAAenpF,MAKrE,SAASopF,UAAUtoE,GAA6C,IAAxBuoE,IAAuB,yDAC7DvoE,EAAM+qC,oBAAsB,KACxBw9B,IACFvoE,EAAM6J,aAAepe,GAAQ6c,KAAK9rB,IAEpCwjB,EAAMuL,cAAgB,GAClBvL,EAAM2R,WACR3R,EAAM2R,SAAW,KACjB4zD,UAAUvlE,IAkKd,SAASwoE,cAAcxoE,EAAqBhF,GAC1C,OAAOgF,EAAMkB,kBAAkBlB,EAAML,UAAUwB,MAAM,KAAKnG,IAAQxe,GA2FpE,SAASisF,oBAAoBzoE,EAAqBhF,GAChD,IAAMmvB,EAAYnqB,EAAML,UAAUwB,MAAM,KACxC,OACEnB,EAAMkB,kBAAkBipB,EAAUnvB,MAChCgF,EAAM9gB,KAAK8gB,EAAMkB,kBAAkBipB,EAAUnvB,IAAQA,OACpDC,KAAKiI,MAIZ,SAASwlE,UAAU1oE,GACjB,GACEA,EAAM4mB,gBAAkBN,GAAeE,OACvCxmB,EAAM6J,eAAiBpe,GAAQod,YAAYrsB,GAC3C,CACA,IAAM6M,EAAMo/E,oBAAoBzoE,EAAO,GACnCymB,GAAap9B,IACbo9B,GAAap9B,IACXG,EAAOi/E,oBAAoBzoE,EAAO,GACpCymB,GAAaj9B,KACbi9B,GAAaj9B,KACjBwW,EAAM/R,OAAN,2BAAoBw4B,IAApB,IAAkCp9B,MAAKG,cAC9BwW,EAAM6J,eAAiBpe,GAAQod,YAAYrsB,GACpDwjB,EAAM/R,OAASw4B,GACNzmB,EAAM4mB,gBAAkBN,GAAeC,QAChDvmB,EAAM/R,OAASw4B,IAInB,SAASkiD,iBAAiB3oE,EAAqB9gB,GAC7C,GAAI8gB,EAAM4mB,gBAAkBN,GAAeE,MAAO,CAChD,IADgD,EAC5C5U,EAAQ,GADoC,eAE5B1yB,EAAK8gB,EAAML,YAFiB,IAEhD,2BAA2C,CAAC,IAAjCF,EAAgC,QACzCmS,EAAMnS,EAAMjjB,IAAMijB,EAAM+2B,qBAAqBrB,gBAHC,8BAKhDn1B,EAAM8lB,SAAWlU,GAIrB,SAASg3D,iBAAiB5oE,EAAqB9gB,GAC7C8gB,EAAM4mB,cACJ1nC,GAASA,EAA+BlD,MAAK,SAAC4b,GAAD,OAA4B,IAArBA,EAAEqD,KAAKyE,aACvD4mB,GAAeE,MACfF,GAAeC,MAGvB,SAASsiD,qBAAqB7oE,EAAqB8oE,GACjD,IADiE,EAC7DC,EAAgB,GACd7nE,EAAoB,GAEpB8nE,EAAUzuF,OAAOC,KAAKsuF,GAAgBt0D,MAAK,SAACr1B,EAAG6C,GAAJ,OAC/C7C,EAAEgiB,MAAM,KAAKpiB,OAASiD,EAAEmf,MAAM,KAAKpiB,QAAU,EAAI,KALc,eAO9CiqF,GAP8C,+BAOxDC,EAPwD,QAQzD/pF,EAAO4pF,EAAeG,GACtBC,EAAgBD,EAAO9nE,MAAM,KAAKpiB,OAKxC,GAJsB,IAAlBmqF,GACFH,EAAOntF,KAAKqtF,GAGM,IAAhB/pF,EAAKH,OAAc,CACrB,IAAMic,EAAQgF,EAAM9gB,KAAKo1B,WAAU,SAAC7U,GAAD,OAAWA,EAAMjjB,KAAO0C,EAAK,GAAG1C,MACnE0kB,EAAkB+nE,GAAU,CAAEzsF,GAAI0C,EAAK,GAAG1C,GAAIwe,aACzC,CACL,IAAMmuE,EAAaL,EAAeG,GAC5BG,EAAmBD,EAAWpqF,OACpC,GAAIqqF,GAAoB,EAAG,CACzB,IAAMC,EAAcF,EAAWlrF,QAAO,SAAC2Z,GAAD,OAAQA,EAAEqD,KAAKiI,SACrD,GACEmmE,EAAYtqF,OAAS,IACF,IAAlBmqF,GACoB,IAAlBA,GAAuBE,IAAqBC,EAAYtqF,QAC3D,CACA,IAAMic,EAAQgF,EAAM9gB,KAAKo1B,WACvB,SAAC7U,GAAD,OAAWA,EAAMjjB,KAAO6sF,EAAY,GAAG7sF,MAEzC0kB,EAAkB+nE,GAAU,CAAEzsF,GAAI6sF,EAAY,GAAG7sF,GAAIwe,cAErDkG,EAAkB+nE,GAAU,UAG9B/nE,EAAkB+nE,GAAU,OA5BlC,2BAA6B,IAPoC,8BAwCjE,OADAjpE,EAAMkB,kBAAoBA,EACnB6nE,EAGT,SAASO,OAAOtpE,EAAqB8oE,EAAgB1qC,GAAuB,IAAlBmrC,EAAiB,wDACnEC,EAAajvF,OAAOC,KAAKsuF,GAAgBt0D,MAAK,SAACr1B,EAAG6C,GAAJ,OAClD7C,EAAEgiB,MAAM,KAAKpiB,OAASiD,EAAEmf,MAAM,KAAKpiB,QAAU,EAAI,KAGnD,GACEa,KAAKC,UAAU2pF,KACb5pF,KAAKC,UAAUtF,OAAOC,KAAKwlB,EAAMkB,qBACnCqoE,EACA,CACA,IAAMR,EAASF,qBAAqB7oE,EAAO8oE,GAEvCC,EAAOhqF,OAAS,GAAY,MAAPq/C,GACvBp+B,EAAMxF,eAAiBwF,EAAMkB,kBAAkB6nE,EAAO,IACtD/oE,EAAML,UAAYopE,EAAO,KAEzB/oE,EAAMxF,eAAiB4jC,EAAMp+B,EAAMkB,kBAAkBk9B,GAAOA,EAC5Dp+B,EAAML,UAAYy+B,QAGpBp+B,EAAML,UAAYy+B,EAClBp+B,EAAMxF,eAAiBwF,EAAMkB,kBAAkBk9B,GAGjDwqC,iBAAiB5oE,EAAO8oE,EAAe9oE,EAAML,YAC7C+oE,UAAU1oE,GAGZ,SAASk+B,0BACPl+B,GAGC,IAFDo+B,EAEA,uDAFM,KACNqrC,EACA,wDACMxW,EAAiBnD,GAAe,WAChC4Z,EAAqBzW,EAAejzD,EAAM9gB,MAC1Cm/C,EAAO9jD,OAAOC,KAAKkvF,GACnBC,EAAcvrC,GAAQC,EAAKniD,SAAL,OAAckiD,QAAd,IAAcA,IAAO,IAAgBA,EAAVC,EAAK,GAC5DirC,OAAOtpE,EAAO0pE,EAAoBC,EAAYF,GAC9CnB,UAAUtoE,GAGV2oE,iBAAiB3oE,EAAO0pE,GACxBnE,UAAUvlE,GAEV,IAAM4pE,EAAc7D,GAAY8D,YAC9B7pE,EAAM+lE,YACN/lE,EAAML,WAEFmqE,EAAYF,EAAY1D,UAC1B4D,IACF9pE,EAAM4B,QAAUkoE,EAAUloE,QAC1B5B,EAAMU,QAAUopE,EAAUppE,SAE5BglE,QAAQ1lE,GCxbV,SAAS5C,oBACP4C,EACA9gB,GAMC,IAAD,EAOIA,GAAQ,CACV65C,QAAS,GACTliB,UAAW,GACXhH,YAAa,GACbgnD,aAAc,GACd0N,iBAAkB,IAVlBxrC,EAFF,EAEEA,QACAliB,EAHF,EAGEA,UACAhH,EAJF,EAIEA,YACAgnD,EALF,EAKEA,aASF72D,EAAM9gB,KAAO65C,EACb/4B,EAAM6W,UFxCD,SAASkzD,2BAEd,IAFmC,IAAZC,EAAW,uDAAJ,GACxBnzD,EAAY,GACT/3B,EAAI,EAAGA,EAAIkrF,EAAKjrF,OAAQD,IAAK,CACpC,IADoC,EAE9B8oF,EADWT,YAAYC,YAAY4C,EAAKlrF,GAAGgyD,SACtBg3B,eAFS,eAGfF,GAHe,IAGpC,2BAAgC,CAAC,IAAxBxtB,EAAuB,QAC9BvjC,EAAUj7B,KACRqrF,aAAa,CACXn2B,QAASsJ,EAAS2tB,kBANY,+BAYtC,OAAOlxD,EE0BWozD,CAAyBpzD,GAC3C7W,EAAM6P,YAAcA,EAEfgnD,GAAqD,IAArCt8E,OAAOC,KAAKq8E,GAAc93E,OAO7CihB,EAAM62D,aAAe6N,SAAM7lB,KAAKgY,GANhC72D,EAAM62D,aAAe6N,SAAM7lB,KAAK,CAC9B3tC,OAAQ,GACRzlB,QAAS,CAAEi8C,UAAWwsB,GAAkBvpC,GAAI,IAC5C7wC,MAAO,KAmBb,SAASowF,YAAYlqE,EAAqBjJ,GACxC,IAD+C,EACzCgiC,EZ8FD,SAASoxC,QAAQpzE,GAEtB,IADA,IAAMgiC,EAAU,GACPj6C,EAAI,EAAGA,EAAIiY,EAAMhY,OAAQD,IAChC0kF,OAAOzqC,EAAShiC,EAAMjY,GAAGmX,OAAQ,CAC/BvM,QAAS,CACPsL,KAAM+B,EAAMjY,GAAGkW,MAEjBi3B,OAAQ,CACNgF,SAAUl6B,EAAMjY,GAAGmyC,SAAWl6B,EAAMjY,GAAGmyC,SAAW,QAIxD,OAAO8H,EY1GSoxC,CAAQpzE,GADuB,eAExBgiC,GAFwB,IAE/C,2BAAgC,CAAC,IAAtB/nB,EAAqB,QAC9BhR,EAAM9gB,KAAKtD,KAAKo1B,IAH6B,8BAM/CktB,0BAAal+B,GACbR,kBAAkBQ,EAAM9gB,MAExB8gB,EAAMrJ,WAAY,EAGpB,SAASyzE,cAAcpqE,EAAqBjJ,GAC1C,IADiD,EAC3CgiC,EZiGD,SAASsxC,UAAUtzE,GAExB,IADA,IAAMgiC,EAAU,GACPj6C,EAAI,EAAGA,EAAIiY,EAAMhY,OAAQD,IAChC2jF,SAAS1pC,EAAShiC,EAAMjY,GAAGmX,OAAO0I,WAAY,CAC5CjV,QAAS,CACPsL,KAAM+B,EAAMjY,GAAGkW,MAEjBi3B,OAAQ,CACNgF,SAAUl6B,EAAMjY,GAAGmyC,SAAWl6B,EAAMjY,GAAGmyC,SAAW,QAIxD,OAAO8H,EY7GSsxC,CAAUtzE,GADuB,eAE1BgiC,GAF0B,IAEjD,2BAAgC,CAAC,IAAtB/nB,EAAqB,QAC9BhR,EAAM9gB,KAAKtD,KAAKo1B,IAH+B,8BAKjDo1D,gCAAgCpmE,GAAO,GAAO,GAC9Ck+B,0BAAal+B,GACbR,kBAAkBQ,EAAM9gB,MAExB8gB,EAAMrJ,WAAY,ECnDpB,SAAS2zE,cAAcxwF,EAAcuuF,EAAe9b,GAClD,OAAQzyE,EAAMoF,KAAKmpF,GAA2B1xD,OAAOzF,OAAOoD,WAC1D,SAAC71B,GAAD,OAAWA,EAAMjC,KAAO+vE,KA+D5B,SAASge,kBAAkBvqE,EAAqBjmB,GAAS,IAAD,EAChDD,EAAQo3C,aAASlxB,GACvB,aAAIlmB,EAAM0gB,sBAAV,aAAI,EAAsBhe,GAAI,CAAC,IAAD,EACpBwe,EAAUlhB,EAAM0gB,eAAhBQ,MADoB,EAOxBjhB,EAAOE,QAJTo8B,EAH0B,EAG1BA,UACA6B,EAJ0B,EAI1BA,eACAR,EAL0B,EAK1BA,eACAC,EAN0B,EAM1BA,YAN0B,eASVtB,EACd,CAACA,GACAv8B,EAAMoF,KAAK8b,GAAmB2b,OAAOzF,QAXd,IAS5B,2BAEkD,CAAC,IAF1CzyB,EAEyC,QAC1C+rF,EAAa/yD,GAAOgzD,KAAUhsF,GAAQi5B,EAAgBC,GAG1DM,GAAuBC,EADrBR,EACqC,CAAC,CAAEl7B,GAAIguF,EAAWhuF,KAElB,CACrC,CAAEA,GAAIguF,EAAWlzD,OAAOK,GAAan7B,MAIzC,IAAMkuF,EAAaJ,cAAcxwF,EAAOkhB,EAAOwvE,EAAWhuF,IACzDwjB,EAAM9gB,KAAK8b,GAAmB2b,OAAOzF,OAAOw5D,GAAcF,GAvBjC,gCA6ChC,SAASG,kBAAkB3qE,EAAqBjmB,GAAS,IAAD,EACtD,aAAIimB,EAAMxF,sBAAV,aAAI,EAAsBhe,GAAI,CAAC,IACrBwe,EAAUgF,EAAMxF,eAAhBQ,OxLmOL,SAAS4vE,YAAYnrE,EAAOhhB,GAAQ,IACjCuB,EAAavB,EAAbuB,KAAMmb,EAAO1c,EAAP0c,GAD0B,EAEtBsE,EAAMvgB,KAAhBmG,EAFgC,EAEhCA,EAAGwd,EAF6B,EAE7BA,GAEL7H,EAAQyE,EAAMkX,OAAOzF,OAAOoD,WAAU,SAACx1B,GAAD,OAAOA,EAAEtC,KAAOiC,EAAMjC,MAC5DorB,EAAW2qB,aAAc,CAAEltC,IAAGC,EAAGud,GAAM,CAAE7iB,OAAMmb,KAAI8U,SAAS,KAEnD,IAAXjV,IACFyE,EAAMkX,OAAOzF,OAAOlW,GAApB,uCACKyE,EAAMkX,OAAOzF,OAAOlW,IADzB,IAEEy3B,WAAYzyC,EACZ0yC,SAAUv3B,GACP1c,GAJL,IAKEmpB,aAEFsqB,qBAAqBzyB,IwLjPrBmrE,CAAY5qE,EAAM9gB,KAAK8b,GAAQjhB,EAAOmF,OAW1C,SAAS2rF,eAAe7qE,EAAqBjmB,GAAS,IAAD,EAE7C0E,EAAQ21C,kBAASp0B,EAAO,CAAEha,OADPjM,EAAjBiM,OACgCC,KADflM,EAATkM,OAGhB,aAAI+Z,EAAMxF,sBAAV,aAAI,EAAsBhe,GAAI,CAAC,IACrBwe,EAAUgF,EAAMxF,eAAhBQ,MADoB,cAETvc,EAFS,GAErBuB,EAFqB,KAEfmb,EAFe,MxLsOzB,SAASvc,SAAS6gB,EAAOhU,GAAU,IAChCzL,EAAayL,EAAbzL,KAAMmb,EAAO1P,EAAP0P,GADyB,EAErBsE,EAAMvgB,KAAhBmG,EAF+B,EAE/BA,EAAGwd,EAF4B,EAE5BA,GACL+E,EAAW2qB,aAAc,CAAEltC,IAAGC,EAAGud,GAAM,CAAE7iB,OAAMmb,KAAI8U,SAAS,IAE5DgZ,EAAU0H,GAAatrC,EAAGwd,EAAI7iB,EAAMmb,EAAIsE,EAAMxE,KAAKS,iBAEzD,IACE,IAAMjd,EAAQ,CACZjC,GAAIowC,aACJ5sC,OACAmb,KACAyM,WACA0P,OAAQ,CAAC,aAAE96B,GAAIowC,cAAiB3D,IAChCjR,KAAMf,IAERxX,EAAMkX,OAAOzF,OAASzR,EAAMkX,OAAOzF,OAAOkG,OAAOib,UAAU,CAAC5zC,GAAQghB,IACpEyyB,qBAAqBzyB,GACrB,MAAO9iB,GACP,MAAM,IAAIjC,MAAM,yCwLtPhBkE,CAASohB,EAAM9gB,KAAK8b,GAAQ,CAAEhb,OAAMmb,OACpC2vE,yBAAyB9qE,IAI7B,SAAS+qE,8BAA8B/qE,EAAOjmB,GAAS,IAAD,EACxCwyE,EAAmBxyE,EAAvByC,GAAanC,EAAUN,EAAVM,MACrB,aAAI2lB,EAAMxF,sBAAV,aAAI,EAAsBhe,GAAI,CAAC,IACrBwe,EAAUgF,EAAMxF,eAAhBQ,OxLyRL,SAASgwE,qBAAqBvrE,EAAO8sD,EAAS0e,GACnD,IAAMxsF,EAAQghB,EAAMkX,OAAOzF,OAAO4F,MAAK,SAACr4B,GAAD,OAAWA,EAAMjC,KAAO+vE,KAC/D,GAAI9tE,EAAO,CACT,IAAMs8B,EAAQt8B,EAAMmpB,SAAWqjE,EAC/BxrE,EAAMkX,OAAOlrB,QAAQ6lC,IAClB25C,EAAmBxsF,EAAMkqB,SAAYlJ,EAAMkX,OAAOlrB,QAAQ6lC,IAC7D7xB,EAAMkX,OAAOzF,OAASzR,EAAMkX,OAAOzF,OAAOzb,KAAI,SAAChX,GAC7C,OAAO,2BACFA,GADL,IAEEkqB,SAAUlqB,EAAMmpB,SAAWmT,QwLjS/BiwD,CAAqBhrE,EAAM9gB,KAAK8b,GAAQuxD,EAASlyE,IA0BrD,SAASywF,yBAAyB9qE,GAChCykE,yBAAyBzkE,GCjL3B,IAAIwmC,GAAc,EAMlB,SAAS0kC,iBAAiBlrE,EAAqBjmB,GAAS,IAAD,EACrD,aAAIimB,EAAMxF,sBAAV,aAAI,EAAsBhe,GAAI,CAAC,IACrBwe,EAAUgF,EAAMxF,eAAhBQ,MACFmwE,ECvCK,SAASC,WAAWprE,EAAOvU,GAAU,IAC1CzF,EAA+ByF,EAA/BzF,OAAQW,EAAuB8E,EAAvB9E,OAAQV,EAAewF,EAAfxF,KAAMS,EAAS+E,EAAT/E,KACxB+T,EAASirB,YAAY1lB,GACrBuC,EAASojB,YAAY3lB,GACrBsK,EAAc,IAATtkB,EAA0B,IAAPC,EAAiBA,EAAOD,EAChDwkB,EAAc,IAATxkB,EAA0B,IAAPC,EAAiBD,EAASC,EAClDskB,EAAc,IAAT5jB,EAA0B,IAAPD,EAAiBA,EAAOC,EAChD8jB,EAAc,IAAT9jB,EAA0B,IAAPD,EAAiBC,EAASD,EAElD6wC,EAAQh1B,EAAOrH,OAAOqP,GACtB8sB,EAAQ58B,EAAOS,OAAOoP,GACtBktB,EAAMj1B,EAAOrH,OAAOuP,GAE1B,MAAO,CAAE4sB,QAAOE,QAAOD,IADX78B,EAAOS,OAAOsP,GACEgtB,OD0BR4zC,CAAWprE,EAAOjmB,IvL4SjC,SAASsxF,kBAAkB5rE,EAAOhU,GACvC,IADgD,EAC1Cw9B,EAAUgO,kBAAkBx3B,EAAOhU,GADO,EAErBgrC,SAASh3B,GAA5BmjB,EAFwC,EAExCA,OAAQ+T,EAFgC,EAEhCA,OAFgC,eAG7B1N,GAH6B,IAGhD,2BAA4B,CAAC,IAApB3R,EAAmB,QACpBg0D,EAAWh0D,EAAXg0D,OACN7rE,EAAM0E,MAAM+M,OAAOt1B,KAAK,CACtBY,GAAIowC,aACJvnC,EAAGimF,EAAO,GACVhmF,EAAGgmF,EAAO,GACVh0D,OAAQ,CACN,CACE96B,GAAIowC,aACJ1D,KAAM5R,EAAO7C,MACbpvB,EAAG,CACDmtC,YAAalb,EAAOpP,OAAS0a,EAC7BjO,MAAO2C,EAAOpP,OACdmP,MAAO,IAET/xB,EAAG,CACDktC,YAAalb,EAAOi0D,OAAS50C,EAC7BhiB,MAAO2C,EAAOi0D,OACdl0D,MAAO,IAETW,KAAM,WAGVA,KAAMf,MA1BsC,+BuL3S9Co0D,CAAkBrrE,EAAM9gB,KAAK8b,GAAQ,CACnCm8B,aAAcg0C,EACd/yC,gBAAiBoO,GACjBjO,kBAAkB,IAEpBizC,wBAAwBxrE,IAI5B,SAASyrE,yBAAyBzrE,EAAqB0rE,GAAmB,IAAD,EACvE,aAAI1rE,EAAMxF,sBAAV,aAAI,EAAsBhe,GAAI,CAAC,IACrBwe,EAAUgF,EAAMxF,eAAhBQ,OvLyYL,SAAS2wE,YAAYlsE,EAAOhU,GACjC,IAAM0Y,EAAQ8yB,kBAAkBx3B,EAAOhU,GADG,EAEfgrC,SAASh3B,GAA5BmjB,EAFkC,EAElCA,OAAQ+T,EAF0B,EAE1BA,OAEVi1C,EAAiBznE,EAAM1O,KAAI,SAACgW,GAChC,MAAO,CACLjvB,GAAIowC,aACJvnC,EAAG,CAAErF,KAAMyrB,EAAK6/D,OAAO,GAAGtrF,KAAMmb,GAAIsQ,EAAK6/D,OAAO,GAAGnwE,IACnD7V,EAAG,CAAEtF,KAAMyrB,EAAK6/D,OAAO,GAAGtrF,KAAMmb,GAAIsQ,EAAK6/D,OAAO,GAAGnwE,IACnDmc,OAAQ,CACN,CACE96B,GAAIowC,aACJ1D,KAAMzd,EAAKgJ,MACXpvB,EAAG,CACDmtC,YAAa/mB,EAAKvD,OAAS0a,EAC3BjO,MAAOlJ,EAAKvD,OACZmP,MAAO,IAET/xB,EAAG,CACDktC,YAAa/mB,EAAK8/D,OAAS50C,EAC3BhiB,MAAOlJ,EAAK8/D,OACZl0D,MAAO,IAETW,KAAM,WAGVA,KAAMf,OAGVxX,EAAM0E,MAAM+M,OAASzR,EAAM0E,MAAM+M,OAAOkG,OAAOw0D,GuLra7CD,CAAY3rE,EAAM9gB,KAAK8b,GAAQ0wE,GAC/BF,wBAAwBxrE,IA8B5B,SAAS6rE,aAAa/xF,EAAOuuF,EAAe7J,GAC1C,OAAO1kF,EAAMoF,KAAKmpF,GAAelkE,MAAM+M,OAAOoD,WAC5C,SAAC7I,GAAD,OAAUA,EAAKjvB,KAAOgiF,KA4C1B,SAASsN,iBAAiB9rE,EAAqBjmB,GAAS,IAAD,EAC/CD,EAAQo3C,aAASlxB,GACvB,aAAIlmB,EAAM0gB,sBAAV,aAAI,EAAsBhe,GAAI,CAAC,IAAD,EACpBwe,EAAUlhB,EAAM0gB,eAAhBQ,MADoB,EAQxBjhB,EAAOE,QALTmvC,EAH0B,EAG1BA,SACAlR,EAJ0B,EAI1BA,eACAiQ,EAL0B,EAK1BA,cACAxQ,EAN0B,EAM1BA,YACArJ,EAP0B,EAO1BA,KAP0B,eAUX8a,EACb,CAACA,GACAtvC,EAAMoF,KAAK8b,GAAmBmJ,MAAM+M,QAZb,IAU5B,2BAEiD,CAAC,IAFzCzF,EAEwC,QAEzCsgE,EAAYt0D,GAChBgzD,KAAUh/D,GACV0c,EACAxQ,EACArJ,GAIA2J,GAAuBC,EADrBiQ,EACqC,CAAC,CAAE3rC,GAAIuvF,EAAUvvF,KAItD,CAAC,CAAEA,GAAIuvF,EAAUz0D,OAAOK,GAAan7B,KAJwB8xB,GASjE,IAAM09D,EAAYH,aAAa/xF,EAAOkhB,EAAO+wE,EAAUvvF,IACtDwjB,EAAM9gB,KAAK8b,GAAmBmJ,MAAM+M,OAAO86D,GAAaD,GAhC/B,gCAwDhC,SAASP,wBAAwBxrE,GAC/BykE,yBAAyBzkE,GEzK3B,SAASisE,mBAAmBjsE,EAAqB8wC,EAAS70D,INwBnD,SAAS89D,2BAAWljC,EAAWi6B,EAAS70D,GAG7C,IACI2rF,EADWC,YAAST,YAAYt2B,GACXg3B,eAEzB,GAAIF,EAAU7oF,OAAS,EAAG,CACxB83B,EAAYvY,KAAKuY,UAAU54B,QAAO,SAAC67B,GAAD,OAAOA,EAAE79B,MAAQA,KAD3B,qBAGH2rF,GAHG,IAGxB,2BAAgC,CAAC,IAAxBxtB,EAAuB,UAK1BA,EAASktB,sBAHXroB,EAF4B,EAE5BA,QACAsoB,EAH4B,EAG5BA,eACAC,EAJ4B,EAI5BA,eAGF3wD,EAAUj7B,KACR,IAAIqrF,aAAa,CACfn2B,QAASsJ,EAAS2tB,cAClB7kF,IAAKk3D,EAASqtB,MAAM,IAAK,KACzB98C,GAAIs0B,EACJv4C,GAAI6gE,EACJx2B,GAAIy2B,MAhBc,oCAoBnB,GAAyB,IAArBI,EAAU7oF,OAAc,CACjC,IAAMq7D,EAAWwtB,EAAU,GADM,EAM7BxtB,EAASktB,sBAHXroB,EAH+B,EAG/BA,QACAsoB,EAJ+B,EAI/BA,eACAC,EAL+B,EAK/BA,eAEI0E,EAAOjF,aAAa,CACxBn2B,QAASsJ,EAAS2tB,cAClB7kF,IAAKk3D,EAASqtB,MAAM,IAAK,KACzB98C,GAAIs0B,EACJv4C,GAAI6gE,EACJx2B,GAAIy2B,EACJvrF,IAAKA,IAEHkwF,EAAWt1D,EAAUvC,WAAU,SAACwF,GAAD,OAAOA,EAAE79B,MAAQA,KACpD46B,EAAUiK,OAAOqrD,EAAU,EAAGD,IMjEhCjC,CAA2BjqE,EAAM6W,UAAWi6B,EAAS70D,GFYvD2iC,GAAO/T,GAAG,sBAAsB,SAAC7D,GAC/Bw/B,GAAcx/B,K,cG0ChB,SAASolE,sBAAsBpsE,EAAqBqsE,GAAa,IAAD,EAC9D,aAAIrsE,EAAMxF,sBAAV,aAAI,EAAsBhe,GAAI,CAC5BwjB,EAAM6J,aAAepe,GAAQ6c,KAAK9rB,GAClCwjB,EAAM+qC,oBAAsB,KAFA,IAGpB/vC,EAAUgF,EAAMxF,eAAhBQ,MACFyZ,EC5EK,SAAS63D,gBAAgB3pE,EAASlX,GAAU,IACjDukC,EAA6DvkC,EAA7DukC,YAAa2W,EAAgDl7C,EAAhDk7C,iBAAkBH,EAA8B/6C,EAA9B+6C,YAAaI,EAAiBn7C,EAAjBm7C,aAE9ClS,EAAQD,aAAO9xB,EAAQzjB,KAAK2jB,GAAGpN,KAAI,SAACnQ,GAAD,OAAOY,KAAKC,IAAIb,OAHD,EAKtCqd,EAAQzjB,KAAlB2jB,EALgD,EAKhDA,GAAIxd,EAL4C,EAK5CA,EACRovB,EAAQ83D,aACV,CAAElnF,IAAGC,EAAGud,GACR,CACE+jC,eACA7T,WAAY2B,EAAQ8R,EACpBxW,YAAaA,EACbC,kBAAkB,EAClBC,aAAa,EACbC,SAAS,EACTM,UAAW,CAAEC,WAAY,GAAI1sB,WAAY,KAG7CyQ,EAAMD,MAAK,SAACr1B,EAAG6C,GAAJ,OAAUA,EAAEsD,EAAInG,EAAEmG,KACzBqhD,EAAmBlyB,EAAM11B,SAAQ01B,EAAQA,EAAM32B,MAAM,EAAG6oD,IAE5D,IAAMz+B,EAASoqB,UAAU3vB,GAEzB,OAAO8R,EAAMhf,KAAI,SAACyzB,GAChB,MAAO,CACL1sC,GAAIowC,aACJ4F,YAAatJ,EAAK7jC,EAAI6iB,EACtByM,MAAOuU,EAAK7jC,EACZuvB,UAAWsU,EAAK5jC,EAChB7E,MAAOyoC,EAAKzoC,UD+CA6rF,CAAgBtsE,EAAM9gB,KAAK8b,GAAQqxE,GAChDrsE,EAAM9gB,KAAK8b,GAAmByZ,MAAMvD,OAASuD,GEpElD,SAAS+3D,0BAA0BxsE,EAAqBjmB,GAAS,IACvDy8B,EAAWz8B,EAAXy8B,QhHiMH,SAASi2D,sBAAsBz2D,EAAiBQ,EAAQ3Z,GAC7D,IAAM7G,EAASzb,OAAOonD,QAAQ3rB,EAAgBnZ,GAASqU,QAAQrR,QAC7D,SAACC,EAAKwf,GAEJ,cADOA,EAAK,GAAG9I,GACX8I,EAAK,IAAM/kC,OAAOC,KAAK8kC,EAAK,IAAIvgC,OAAS,GAC3C+gB,EAAIwf,EAAK,IAAMA,EAAK,GACbxf,GAEFA,IAET,WAGKkW,EAAgBnZ,GAASpR,QAAQirB,QAAQF,GAChDR,EAAgBnZ,GAASqU,OAASlb,EAClCggB,EAAgBnZ,GAASqU,OAAS4tC,mBAChC9oC,EACAnZ,GAGEvF,KAAQ0e,EAAgBnZ,GAASqU,UACnC6sC,GAAqBlhD,GAAW,IgHrNlC6vE,CACE1sE,EAAMgW,gBACNQ,EACAxW,EAAML,WAYV,SAASgtE,iBAAiB3sE,EAAqBjmB,GAC7C,IAAMmF,EAAOnF,EAAOE,ShH0Cf,SAAS2yF,UACd52D,EACAnZ,EAFK,GAIJ,IADUgwE,EACX,EADEn2D,QAAuBsmB,EACzB,EADyBA,KAEzB6hB,KAAK7oC,EAAiBnZ,GACtBmZ,EAAgBnZ,GAASpR,QAAQuxC,KAAOA,EACxChnB,EAAgBnZ,GAASpR,QAAQirB,QAAUn8B,OAAO22B,OAAO27D,GAAchtE,QACrE,SAACC,EAAKzlB,GACJ,IAAM6E,EAAI,eAAQ7E,GAGlB,cAFO6E,EAAKmiE,QACZvhD,EAAIzlB,EAAMgnE,SAAWniE,EACd4gB,IAET,IAVF,IAaiBgtE,EAAe92D,EAAgBnZ,GAASpR,QAAjDirB,QAEJx3B,EAAO3E,OAAOonD,QAAQ3rB,EAAgBnZ,GAASqU,QAAQrR,QACzD,SAACktE,EAAD,GAAsC,IAAD,mBAAzBC,EAAyB,KAAbj0C,EAAa,KAQnC,OAPAg0C,EAASC,GAAczyF,OAAOC,KAAKqyF,GAAchtE,QAAO,SAACC,EAAK7jB,GAC5D,IAAMgxF,EAASJ,EAAa5wF,GAAKolE,QAIjC,OAHItoB,EAAQ98C,KACV6jB,EAAImtE,GAAUl0C,EAAQ98C,IAEjB6jB,IACN,IACIitE,IAET,IAGF7tF,EAAO3E,OAAOonD,QAAQziD,GAAM2gB,QAAO,SAACC,EAAKi5B,GAiBvC,OAhBAj5B,EAAIi5B,EAAQ,IAAMx+C,OAAOC,KAAKsyF,GAAYjtE,QAAO,SAACC,EAAK7jB,GACrD,IAAMixF,EAAYJ,EAAW7wF,GAAKjC,OAAS8jE,GAY3C,OAXAh+C,EAAI7jB,GAAOixF,EACP,CACE12D,OAAQv6B,EACR5B,MAAO2kE,UACL8tB,EACA5tF,EAAK65C,EAAQ,IACb+zC,EAAW7wF,GAAKgjE,UANJ,2BASXlmB,EAAQ,GAAG98C,IATA,IASMu6B,OAAQv6B,IAE3B6jB,IACN,IAEIA,IACN,IACHkW,EAAgBnZ,GAASqU,OAAShyB,EgH7FlCwtF,CAA2B1sE,EAAMgW,gBAAiBhW,EAAML,UAAWzgB,GAErE,SAASiuF,mBAAmBntE,EAAqBjmB,GAAS,IAAD,EACvBA,EAAOE,QAA/Bq8B,EAD+C,EAC/CA,UAAW6oC,EADoC,EACpCA,UhHwBd,SAASiuB,qBACdp3D,EACAnZ,EACAyZ,EACA22D,GAEAj3D,EAAgBnZ,GAASpR,QAAQirB,QAAQJ,GAAW6oC,SAAW8tB,EAE/Dj3D,EAAgBnZ,GAASqU,OAAS4tC,mBAChC9oC,EACAnZ,GgHjCF6vE,CACE1sE,EAAMgW,gBACNhW,EAAML,UACN2W,EACA6oC,GC3BW,SAASkuB,kBAAkB1qE,EAASlX,GAAU,IACrDzL,EAA0CyL,EAA1CzL,KAAMmb,EAAoC1P,EAApC0P,GAAIykD,EAAgCn0D,EAAhCm0D,QAASS,EAAuB50D,EAAvB40D,QAASitB,EAAc7hF,EAAd6hF,UAClC,GAAIA,EAAW,CACb,IAAIpuF,E/GMR,SAASk1C,sBAAwB,IAAf3oC,EAAc,uDAAJ,GAAI,EACgBA,EAAtCoR,eADsB,MACZ,KADY,IACgBpR,EAAtB6hF,iBADM,MACM,MADN,EAG9B,IAAK5tB,GAAW7iD,GACd,MAAM,IAAIniB,MAAM,sBAAuBmiB,GAGzC,IAAI5B,EAAOykD,GAAW7iD,GAASywE,EAAUr4E,eAEzC,IAAKgG,EACH,MAAM,IAAIvgB,MAAM,wBAAyB4yF,GAG3C,MAAO,CACLttF,KAAMib,EAAK0Z,MAAQ,IACnBxZ,GAAIF,EAAK0Z,MAAQ,IACjBA,MAAO1Z,EAAK0Z,MACZirC,QAAS3kD,EAAK2kD,S+GvBHxrB,CAAS,CAAEk5C,UAAWA,EAAWzwE,QAAS8F,EAAQ9F,UAC7D7c,EAAOd,EAAKc,KACZmb,EAAKjc,EAAKic,GACVykD,EAAU1gE,EAAK0gE,QACfS,EAAUnhE,EAAKy1B,MAPyC,MAUxChS,EAAQzjB,KAAlB2jB,EAVkD,EAUlDA,GAAIxd,EAV8C,EAU9CA,EACZ,OAAOkoF,aAAY,CAAEloF,IAAGC,EAAGud,GAAM,CAAE7iB,OAAMmb,MAAM,CAAEykD,UAASS,YCb5D,SAASmtB,iBAAiB/tE,GACxB,OACsC,IAApCA,EAAM/V,QAAQw8B,oBACsB,IAApCzmB,EAAM/V,QAAQ08B,kBAOlB,SAASqnD,WAAWhuE,EAAOwC,GACI,IAAzBxC,EAAMxE,KAAKyE,WACZD,EAAkB/V,QAAQw8B,kBAAoBjkB,EAC9CxC,EAAkB/V,QAAQ08B,kBAAoBnkB,EAC9CxC,EAAkB/V,QAAQonB,UAAY08D,iBAAiB/tE,IAEvDA,EAAkB/V,QAAQonB,UAAY7O,EC7BpC,ICuCM1e,GAAe,CAC1BrE,KAAM,KACN4mC,SAAU,KACVnU,SAAU,KACV/P,QAAS,GACTlB,QAAS,GACTN,SAAU,GACVuB,SAAU,GACVrB,aAAc,GACdmB,kBAAmB,GACnBJ,sBAAuB,GACvBwI,aAAcpe,GAAQ6c,KAAK9rB,GAC3ByrF,eAAgB,KAChBl9B,oBAAqB,KACrBprC,UAAW,KACXlf,MAAO,EACPC,OAAQ,EACRuN,OAAQ,CACN5E,IAAK,GACLC,MAAO,GACPC,OAAQ,GACRC,KAAM,GAERgR,eAAgB,KAChBqH,KAAM,MACN1B,WAAY,CAAE9B,MAAO,GACrBmD,mBAAoB,CAAEnD,MAAO,IAC7BwY,UAAW,GACX9U,cAAe,CACbE,MAAM,EACNC,SAAS,EACT7nB,MxNtEqC,IwNwEvCqzF,QAAS,CACPC,KAAM,GACNC,QAAS,KACTC,OAAQ,GACRC,SAAS,EACTC,SAAS,GAEXvqD,MAAO,EACP7sB,WAAW,EACXkZ,YAAa,GACbtE,cAAe,GACf4wB,gBAAiB,GACjBvV,cAAeN,GAAeC,MAC9BrlB,kBAAmB,GACnB8U,gBAAiB,GACjB6gD,aAAc6N,SAAM7lB,KAAK,CACvB3tC,OAAQ,GACRzlB,QAAS,CAAEi8C,UAAWwsB,GAAkBvpC,GAAI,IAC5C7wC,MAAO,KAET42B,aAAc,GACdq1D,YAAa,GACb3pC,eAAe,GAqDV,SAAS4xC,mBAAmBhzF,GACjC,OAAO,SAACjB,GACN,OAAQA,EAAOC,MACb,KAAK8O,GACH,GAAI/O,EAAOE,QAAS,CAAC,IAAD,EACUF,EAAOE,QAA3B8+C,EADU,EACVA,QAAYk1C,EADF,6BvBhDrB,SAAelE,WAAtB,wCuBkDemE,CAAwBn1C,GAAS32C,MAAK,SAAClD,GAC1CnF,EAAOE,QAAP,aAAmB8+C,QAAS75C,GAAS+uF,GACrCjzF,EAASjB,WAGXiB,EAASjB,GAEX,MAEF,KAAK+O,GAAsB,IAAD,iBACJ/O,EAAOgd,OADH,IACxB,2BAAkC,CAAC,IAA1Bo3E,EAAyB,QAC3BD,UACH,CAAExkF,QAAS,CAAEsL,KAAMm5E,EAAQn5E,OAC3Bm5E,EAAQl4E,QACR7T,MAAK,SAAClD,GACNnF,EAAOE,QAAUiF,EACjBlE,EAASjB,OAPW,8BAUxB,MAEF,KAAK+O,GACH,IAAMo+E,EAAWzpB,KAAIoqB,SAAST,YAAYrtF,EAAOE,QAAQ42D,IAAIC,SACxDs9B,aAAiBlH,EAAU,IAAI9kF,MAAK,SAAC4T,GACxCjc,EAAOE,QAAQmtF,YAAcpxE,EAC7Bhb,EAASjB,MAGX,MAGF,QACEiB,EAASjB,KAkQV,IAAMs0F,GAAkB5rE,cA3P/B,SAAS6rE,qBAAqBtuE,EAAOjmB,GAEnC,OADAimB,EAAMuuE,WAAax0F,EAAOC,KAClBD,EAAOC,MACb,KAAK8O,GACH,OXxIN,SAAS0lF,SAASxuE,EAAqBjmB,GACrCimB,EAAM0Q,aAAekc,aACrBxvB,oBAAQ4C,EAAOjmB,EAAOE,SACtBulB,kBAAkBQ,EAAM9gB,MAExBknF,gCAAgCpmE,EADZxC,IAAUwC,EAAM6P,YAAa,iBAAkB,OACf,GACpDquB,0BAAal+B,GACbA,EAAMrJ,WAAY,EWiIP83E,CAAqBzuE,EAAOjmB,GACrC,KAAK+O,GACH,OXrLN,SAAS4lF,aAAa1uE,EAAqBrJ,GACzCqJ,EAAMrJ,UAAYA,EWoLP83E,CAAyBzuE,EAAOjmB,EAAO4c,WAChD,KAAK7N,GACH,OX1GN,SAAS6lF,mBAAmB3uE,EAAqBjJ,GAC/C,IAAM7X,EAAOU,KAAK0d,MAAMvG,EAAM,GAAGd,OAAO0I,YAExC,IAAK,IAAM7f,KAAKI,EAAK65C,QAAS,CAAC,IAAD,IACY,KAApC,UAAA75C,EAAK65C,QAAQj6C,GAAGmc,YAAhB,eAAsByE,WACxBxgB,EAAK65C,QAAQj6C,GAAKiyC,gBAAgB7xC,EAAK65C,QAAQj6C,IACF,KAApC,UAAAI,EAAK65C,QAAQj6C,GAAGmc,YAAhB,eAAsByE,aAC/BxgB,EAAK65C,QAAQj6C,GAAKs3C,gBAAgBl3C,EAAK65C,QAAQj6C,KAInDse,oBAAQ4C,EAAO9gB,GAGfknF,gCAAgCpmE,EAFZxC,IAAUwC,EAAM6P,YAAa,iBAAkB,OAEf,GAEpDquB,0BAAal+B,GACbR,kBAAkBQ,EAAM9gB,MAExB8gB,EAAMrJ,WAAY,EWuFP83E,CAA+BzuE,EAAOjmB,EAAOgd,OACtD,KAAKjO,GACH,OAAO2lF,cAA0BzuE,EAAOjmB,EAAOgd,OACjD,KAAKjO,GACH,OAAO2lF,YAAwBzuE,EAAOjmB,EAAOgd,OAC/C,KAAKjO,GACH,OX1FN,SAAS8lF,kBAAkB5uE,EAAqBjJ,GAAQ,IAAD,iBACpCA,GADoC,IACrD,2BAAwB,CAAC,IAAhBxC,EAAe,QACtB01E,WAA2BjqE,EAAM6W,UAAWtiB,EAAK0B,OAAO0I,aAFL,8BAIrDqB,EAAMrJ,WAAY,EWsFP83E,CAA8BzuE,EAAOjmB,EAAOgd,OACrD,KAAKjO,GACH,OXrFN,SAAS+lF,kBAAkB7uE,EAAqBjmB,GAC9CimB,EAAM9gB,KAAOnF,EAAOE,QACpBikD,0BAAal+B,GACbR,kBAAkBQ,EAAM9gB,MACxB8gB,EAAMrJ,WAAY,EWiFP83E,CAA8BzuE,EAAOjmB,GAC9C,KAAK+O,GACH,OCtMN,SAASgmF,WAAW9uE,EAApB,GAAuE,IAA5B07B,EAA2B,EAA3BA,WAAYh8C,EAAe,EAAfA,YAC/C5F,EAAQ+S,aAAQmT,GAEtB,GAAIlmB,EAAMoF,KAAKH,OAAS,EAAG,CAAC,IAAD,IAEnBU,EAAQ,UAAG3F,EAAMoF,KAAK,UAAd,iBAAG,EAAewK,eAAlB,aAAG,EAAwBsL,KAEzC,OAAQ0mC,GACN,IAAK,OACH,IAAMqzC,EAAezK,sBAAOxqF,GAC5B0F,aAAauvF,EAActvF,EAAUC,GACrC,MAEF,IAAK,OACH,IAAMqvF,EAAezK,sBAAOxqF,GAC5BsG,aAAa2uF,EAActvF,GAC3B,MAEF,IAAK,MACHY,aAAYZ,EAAU,UACtB,MAEF,IAAK,MACHe,aAAYf,EAAU,UACtB,MAEF,IAAK,OACH6C,aAAmB,YD2KdwsF,CAAW9uE,EAAOjmB,GAC3B,KAAK+O,GACH,ONzMN,SAASkmF,QAAQhvE,EAAqB6iB,GAAmB,IAAD,EAChD/oC,EAAQo3C,aAASlxB,GACvB,IAAI,UAAAA,EAAMxF,sBAAN,eAAsBhe,KAAM1C,EAAO,CAAC,IAC9BkhB,EAAUgF,EAAMxF,eAAhBQ,MAD6B,EAKlBo5B,kBAASp0B,EAAO,CAAEha,OAFtB68B,EAAiBx9B,EADjB,GAG8BY,KADhC48B,EAAiBx9B,EAFf,KAFsB,mBAK9BrF,EAL8B,KAKxBmb,EALwB,KAM/B8zE,EAAgBv9C,WAAW53C,EAAMoF,KAAK8b,GAAO9b,KAAM,CAAEc,OAAMmb,OAE3D+M,EAASoqB,UAAUtyB,EAAM9gB,KAAK8b,IAEpC,GAAIi0E,EAAe,CACjB,IAAM/lD,EAAO,CACX1sC,GAAIowC,aACJ4F,YAAay8C,EAAc5pF,EAAI6iB,EAC/ByM,MAAOs6D,EAAc5pF,EACrBuvB,UAAWq6D,EAAc3pF,GAE1B0a,EAAM9gB,KAAK8b,GAAmByZ,MAAMvD,OAAOt1B,KAAKstC,KMsL1CgmD,CAAqBlvE,EAAOjmB,EAAO8oC,kBAC5C,KAAK/5B,GACH,ONnLN,SAASqmF,SAASnvE,EAAqBjmB,GACrC,IAAMD,EAAQo3C,aAASlxB,GAEvB,GAAIA,EAAMxF,eAAgB,CAAC,IACjBQ,EAAUgF,EAAMxF,eAAhBQ,MACFo0E,EAAgBt1F,EAAMoF,KAAK8b,GAFT,EAKLo5B,kBAASp0B,EAAO,CAAEha,OADZjM,EAAjBiM,OACqCC,KADpBlM,EAATkM,OAJQ,mBAKjBjG,EALiB,KAKXmb,EALW,KAOxB,GAAInb,IAASmb,EAAI,CACf,IAAM+tB,EAAOwI,WAAW09C,EAAclwF,KAAM,CAAEc,OAAMmb,OAE9C+M,EAASoqB,UAAUtyB,EAAM9gB,KAAK8b,IAEpC,GAAIkuB,IAASkmD,EAAc36D,MAAMvD,OAAOl1B,MAAK,SAAC8yC,GAAD,OAAOA,EAAEna,QAAUuU,EAAK7jC,KAAI,CACvE,IAAMgqF,EAAU,CACd7yF,GAAIowC,aACJ4F,YAAatJ,EAAK7jC,EAAI6iB,EACtByM,MAAOuU,EAAK7jC,EACZuvB,UAAWsU,EAAK5jC,GAEjB0a,EAAM9gB,KAAK8b,GAAmByZ,MAAMvD,OAAOt1B,KAAKyzF,MM6J5CH,CAAsBlvE,EAAOjmB,GAEtC,KAAK+O,GACH,ON1JN,SAASwmF,WAAWtvE,EAAqBuvE,GAAW,IAC1Cv0E,EAAUgF,EAAMxF,eAAhBQ,MACFlhB,EAAQo3C,aAASlxB,GAEvB,GAAgB,MAAZuvE,EACDvvE,EAAM9gB,KAAK8b,GAAmByZ,MAAMvD,OAAS,OACzC,CACL,IAAMs+D,EAAa11F,EAAMoF,KAAK8b,GAAmByZ,MAAMvD,OAAOoD,WAC5D,SAACwa,GAAD,OAAOA,EAAEtyC,KAAO+yF,EAAS/yF,MAE1BwjB,EAAM9gB,KAAK8b,GAAmByZ,MAAMvD,OAAO4P,OAAO0uD,EAAW,IMgJrDN,CAAwBlvE,EAAOjmB,EAAOmF,MAE/C,KAAK4J,GACH,Of1LN,SAAS2mF,YAAYzvE,EAAqBjmB,GAAS,IAAD,EAC1CD,EAAQo3C,aAASlxB,GADyB,EAG7Bo0B,kBAASp0B,EAAO,CAAEha,OADZjM,EAAjBiM,OACqCC,KADpBlM,EAATkM,OAFgC,mBAGzCjG,EAHyC,KAGnCmb,EAHmC,KAKhD,IAAI,UAAA6E,EAAMxF,sBAAN,eAAsBhe,KAAM1C,EAAO,CAAC,IAAD,EACfkmB,EAAMxF,eAApBhe,EAD6B,EAC7BA,GAAIwe,EADyB,EACzBA,MACNyE,EAAQO,EAAM9gB,KAAK8b,GAFY,EAInByE,EAAMvgB,KAAhBmG,EAJ6B,EAI7BA,EAAGwd,EAJ0B,EAI1BA,GAELqF,EAASoqB,UAAU7yB,GAEnBkJ,EAAW,CACfnsB,GAAIowC,aACJ6F,WAAYzyC,EAAOkoB,EACnBwqB,SAAUv3B,EAAK+M,EACfloB,OACAmb,KACAyM,SAAU2qB,aAAc,CAAEltC,IAAGC,EAAGud,GAAM,CAAE7iB,OAAMmb,KAAI8U,SAAS,IAC3D+H,KAAM,UAIR,GAFAvY,EAAMwR,UAAUC,OAAOt1B,KAAK+sB,GAC5BipB,wBAAwBnyB,EAAMwR,WACQ,IAAlCxR,EAAMwR,UAAUC,OAAOnyB,OAAc,CAAC,IAAD,EAClB0gB,EAAMwR,UAAUC,OAAO,GAApClxB,EAD+B,EAC/BA,KAAMmb,EADyB,EACzBA,GADyB,EAEtBsE,EAAMvgB,KAAfmG,EAF+B,EAE/BA,EAAGC,EAF4B,EAE5BA,EACLyqB,EAAiBC,aACrB,CAAE3qB,EAAGA,EAAGC,EAAGA,GACX,CACEtF,KAAMA,EACNmb,GAAIA,EACJ8U,SAAS,IAGPi1D,EAAkBvsC,aAAO5oB,EAAezqB,GAC9C0a,EAAMyB,kBAAkBjlB,GAAM0oF,EAC9BllE,EAAMqB,sBAAsB7kB,GAAM0oF,EAClC9jE,gBAAgBpB,EAAMwB,mBAAmBnD,MAAO2B,KeoJzC0vE,CAA6B1vE,EAAOjmB,GAC7C,KAAK+O,GACH,OfjJN,SAAS6mF,eAAe3vE,EAAqBjmB,GAC3C,IAAMD,EAAQo3C,aAASlxB,GACfhF,EAAUgF,EAAMxF,eAAhBQ,MACAuhC,EAAexiD,EAAfwiD,WAEF98B,EAAQO,EAAM9gB,KAAK8b,GAEzB,GAAkB,MAAduhC,EACF98B,EAAMwR,UAAUC,OAAS,OACpB,CACL,IAAMs+D,EAAa11F,EAAMoF,KAAK8b,GAAmBiW,UAAUC,OAAOoD,WAChE,SAACwa,GAAD,OAAOA,EAAEtyC,KAAO+/C,KAElB98B,EAAMwR,UAAUC,OAAO4P,OAAO0uD,EAAW,GACzC59C,wBAAwBnyB,EAAMwR,YemIrBy+D,CAAgC1vE,EAAOjmB,GAChD,KAAK+O,GAEL,KAAKA,GACH,OAAO4mF,eAAgC1vE,EAAOjmB,GAChD,KAAK+O,GACH,OfxMN,SAAS8mF,yBAAyB5vE,EAAqBjmB,GAAS,IACtD8L,EAAsB9L,EAAtB8L,OAAQE,EAAchM,EAAdgM,UAChBuZ,GAAoBb,MAAM5Y,EAAQE,GAClCqb,gBAAgB9B,GAAoBH,WAAYa,GeqMrC0vE,CAA0C1vE,EAAOjmB,GAC1D,KAAK+O,GACH,OftNN,SAAS+mF,wBAAwB7vE,EAAqB3lB,GAAQ,IAAD,EAC3D,aAAI2lB,EAAMxF,sBAAV,aAAI,EAAsBhe,GAAI,CAAC,IAAD,EACNwjB,EAAMxF,eAApBQ,EADoB,EACpBA,MAAOxe,EADa,EACbA,GACdwjB,EAAM9gB,KAAK8b,GAAmBiW,UAAUxlB,QAAQ6lC,IAAMj3C,EACvDu3C,wBAAyB5xB,EAAM9gB,KAAK8b,GAAmBiW,WAElDjR,EAAMyB,oBACTzB,EAAMyB,kBAAkBjlB,GAAMwjB,EAAMI,SAAS5jB,Ke+MtCkzF,CAAyC1vE,EAAOjmB,EAAOM,OAChE,KAAKyO,GACH,OAAO4mF,kCAAmD1vE,EAAOjmB,GAEnE,KAAK+O,GACH,OrBZN,SAASgnF,kBAAkB9vE,EAAqBM,GAC9CN,EAAMM,aAAeA,EqBWVyvE,CAAgC/vE,EAAOjmB,EAAO+mB,QAEvD,KAAKhY,GACH,OrBXN,SAASknF,WAAWhwE,EAAqB4B,GACvC5B,EAAM4B,QAAUA,EqBULmuE,CAAyB/vE,EAAOjmB,EAAO6nB,SAEhD,KAAK9Y,GACH,OrBVN,SAASmnF,WAAWjwE,EAAqBU,GACvCV,EAAMU,QAAUA,EqBSLqvE,CAAyB/vE,EAAOjmB,EAAO2mB,SAEhD,KAAK5X,GACH,OEhPN,SAASonF,SAASlwE,EAAqBvf,GACrCuf,EAAMvf,MAAQA,EF+OHyvF,CAASlwE,EAAOjmB,EAAO0G,OAEhC,KAAKqI,GACH,OE/ON,SAASqnF,oBAAoBnwE,EAAqBvf,EAAOC,GACvDsf,EAAMvf,MAAQA,EACduf,EAAMtf,OAASA,EF6OJyvF,CAAoBnwE,EAAOjmB,EAAO0G,MAAO1G,EAAO2G,QAEzD,KAAKoI,GACH,OZ3KN,SAASsnF,gBAAgBpwE,EAAqB6J,IACnC,OAAL7J,QAAK,IAALA,OAAA,EAAAA,EAAO9gB,KAAKH,QAAS,IACnB8qB,GACEA,IAAiB7J,EAAM6J,cACzBy+D,UAAUtoE,GAAO,GAEnBA,EAAM6J,aAAeA,EACjBpe,GAAQoe,GAAcrB,iBACxBxI,EAAM+qC,oBAAsBlhC,GAG1Bpe,GAAQoe,GAAcpB,UACxBu/D,iBAAiBhoE,EAAO6J,IAG1By+D,UAAUtoE,GAAO,GAEnB0oE,UAAU1oE,IY0JDqwE,CAA6BrwE,EAAOjmB,EAAO8vB,cACpD,KAAK/gB,GACH,OZtLN,SAASwnF,kBAAkBtwE,GAA0C,IAArBuwE,EAAoB,yDAE/DvwE,EAAM6J,cAAgBpe,GAAQuU,EAAM6J,cAAcpB,WAClD8nE,IAEDjI,UAAUtoE,GYiLDqwE,CAA+BrwE,GACxC,KAAKlX,GACH,OZ1JN,SAAS0nF,uBAAuBxwE,EAAqB+qC,GACnD/qC,EAAM+qC,oBAAsBA,EYyJjBslC,CACLrwE,EACAjmB,EAAOgxD,qBAEX,KAAKjiD,GACH,OZFN,SAAS2nF,QAAQzwE,EAAqBjmB,GACpC,IAAS,OAALimB,QAAK,IAALA,OAAA,EAAAA,EAAO9gB,KAAKH,QAAS,EAAG,CAAC,IACnB4lC,EAAsB5qC,EAAtB4qC,SAAUuF,EAAYnwC,EAAZmwC,QACZ0/C,EAAc7D,GAAY8D,YAC9B7pE,EAAM+lE,YACN/lE,EAAML,WAGR,GAAIK,EAAM4mB,gBAAkBN,GAAeC,MACzC,OAAQ5B,GACN,KAAKplB,GACHS,EAAM4B,QAAU5B,EAAMM,aAAasB,QACnC,MAEF,KAAKrC,GACHQ,QAAQC,EAAO,IACf,MACF,KAAKT,GACH,IAAMuqE,EAAYF,EAAY3D,MAC9BjmE,EAAM4B,QAAUkoE,EACZA,EAAUloE,QACV5B,EAAMM,aAAasB,QACvB7B,QAAQC,EAAO,IACf,MAEF,QACEA,EAAM4B,QAAU5B,EAAMM,aAAasB,QACnC7B,QAAQC,EAAO,QAId,CAAC,IAAD,EACkCA,EAAMM,aAArCsB,EADH,EACGA,QAASlB,EADZ,EACYA,QAASN,EADrB,EACqBA,SAC1B,OAAQ8pB,GACN,KAAK7E,GAAOC,OAAS,IACX9oC,EAAOwjB,EAAMkB,kBAAkBlB,EAAML,UAAUwB,MAAM,KAAK,IAA1D3kB,GACRwjB,EAAM4B,QAAUA,EAChB5B,EAAMI,SAAS5jB,GAAM4jB,EAAS5jB,GAC9B,MAEF,KAAK6oC,GAAOE,QAAU,IACZ/oC,EAAOwjB,EAAMkB,kBAAkBlB,EAAML,UAAUwB,MAAM,KAAK,IAA1D3kB,GACRwjB,EAAMU,QAAUA,EAChBV,EAAMI,SAAS5jB,GAAM4jB,EAAS5jB,GAE9B,MAEF,KAAK6oC,GAAOG,UACV,IAAMskD,EAAYF,EAAY3D,MAC9BjmE,EAAM4B,QAAUkoE,EAAYA,EAAUloE,QAAUA,EAChD5B,EAAMU,QAAUopE,EAAYA,EAAUppE,QAAUA,EAChD,MAEF,QACEV,EAAM4B,QAAUA,EAChB5B,EAAMU,QAAUA,EAChBV,EAAMI,SAAWA,KYtDdiwE,CAAqBrwE,EAAOjmB,GACrC,KAAK+O,GACH,OjBzON,SAAS4nF,wBAAwB1wE,EAAqB+G,GAAa,IAAD,EAEhE,aAAI/G,EAAMxF,sBAAV,aAAI,EAAsBhe,GAAI,CAC5B,IAAMwe,EAAQgF,EAAMxF,eAAeQ,MAEnCu2B,YAA2BvxB,EAAM9gB,KAAK8b,GAAQ,CAC5C,CAAEhG,KAAM2S,GAAQO,OAAO1rB,GAAIiP,QAASsb,KAEtCqsB,aAAapzB,EAAM9gB,KAAK8b,IACxBurE,iBAAiBvmE,GACjBulE,UAAUvlE,IiB+ND2wE,CAAuC3wE,EAAOjmB,EAAOgtB,YAC9D,KAAKje,GACH,OjB7NN,SAAS8nF,uBAAuB5wE,EAAqB6wE,GAAgB,IAAD,EAClE,aAAI7wE,EAAMxF,sBAAV,aAAI,EAAsBhe,GAAI,CAC5B,IAAMwe,EAAQgF,EAAMxF,eAAeQ,MAE7BqK,EAAU,CACd,CAAErQ,KAAM2S,GAAQQ,YAAY3rB,GAAIiP,QAASolF,EAAc3mC,iBACvD,CACEl1C,KAAM2S,GAAQG,eAAetrB,GAC7BiP,QAASolF,EAAc7mC,sBAG3BzY,YAA2BvxB,EAAM9gB,KAAK8b,GAAQqK,GAC9CkhE,iBAAiBvmE,GACjBulE,UAAUvlE,GACV0lE,QAAQ1lE,IiB+MC2wE,CAAsC3wE,EAAOjmB,EAAOM,OAC7D,KAAKyO,GACH,OjB9MN,SAASgoF,eAAe9wE,GAAsB,IAAD,EAC3C,aAAIA,EAAMxF,sBAAV,aAAI,EAAsBhe,GAAI,CAAC,IACrBwe,EAAUgF,EAAMxF,eAAhBQ,MAKRu2B,YAA2BvxB,EAAM9gB,KAAK8b,GAAQ,CAC5C,CAAEhG,KAAM2S,GAAQI,IAAIvrB,GAAIiP,QAAS,MAEnC86E,iBAAiBvmE,GACjBomE,gCAAgCpmE,GAAO,GAAO,GAE9CulE,UAAUvlE,GACV0lE,QAAQ1lE,IiBgMC2wE,CAA8B3wE,GACvC,KAAKlX,GACH,OjB/LN,SAASioF,iCAAiC/wE,EAAqB6wE,GAAgB,IAAD,EAC5E,aAAI7wE,EAAMxF,sBAAV,aAAI,EAAsBhe,GAAI,CAAC,IACrBwe,EAAUgF,EAAMxF,eAAhBQ,MACF8L,EAAa+pE,EAAb/pE,IAAKrB,EAAQorE,EAARprE,IACLhG,EAAQO,EAAM9gB,KAAK8b,GACnBonD,EAAUujB,GAAiBlmE,EAAMvgB,KAAKmG,EAAG2a,EAAMwjB,OAGrD1c,GAAarB,EAFMhG,EAAMvgB,KAAKmG,EAAE07B,QAAQqhC,GAEP3iD,EAAMvgB,KAAKoG,EAAEvG,OAE9CwyC,YAA2BvxB,EAAM9gB,KAAK8b,GAAQ,CAC5C,CAAEhG,KAAM2S,GAAQK,gBAAgBxrB,GAAIiP,QAAS,CAAEqb,MAAKrB,UAGtD8gE,iBAAiBvmE,GACjBA,EAAM2R,SAAW,KACjB4zD,UAAUvlE,IiB+KD2wE,CACL3wE,EACAjmB,EAAOM,OAEX,KAAKyO,GACH,OjBrKN,SAASkoF,+BAA+BhxE,GAAsB,IAAD,EAC3D,aAAIA,EAAMxF,sBAAV,aAAI,EAAsBhe,GAAI,CAAC,IACrBwe,EAAUgF,EAAMxF,eAAhBQ,MADoB,EAMxBgF,EAAM2R,SAAS3W,GANS,IAI1B9b,KAJ0B,EASD+oB,0BADf,CAAE/oB,KAAM,CAAEmG,EARM,EAIlBA,EAIewd,GARG,EAIfvd,EAImByd,GARJ,EAIZA,IAIsB9H,KARV,EAK1BA,OAIM/b,EAToB,EASpBA,KAAM4nB,EATc,EASdA,IAAKrB,EATS,EASTA,IAEPP,EAAqBhmB,EAAzB6jB,GAAekC,EAAU/lB,EAAd2jB,GACnB7C,EAAM2R,SAAS3W,GAAO9b,KAAK6jB,GAAKmC,EAChClF,EAAM2R,SAAS3W,GAAO9b,KAAKoG,EAAI2f,EAC/BssB,YAA2BvxB,EAAM9gB,KAAK8b,GAAQ,CAC5C,CAAEhG,KAAM2S,GAAQK,gBAAgBxrB,GAAIiP,QAAS,CAAEqb,MAAKrB,UAEtD8gE,iBAAiBvmE,GACjBA,EAAM2R,SAAW,KACjB4zD,UAAUvlE,IiBiJD2wE,CAA8C3wE,GACvD,KAAKlX,GACH,OjBnLN,SAASmoF,oBAAoBjxE,GAAsB,IAAD,EAChD,aAAIA,EAAMxF,sBAAV,aAAI,EAAsBhe,GAAI,CAAC,IACrBwe,EAAUgF,EAAMxF,eAAhBQ,MACRu2B,YAA2BvxB,EAAM9gB,KAAK8b,GAAQ,CAC5C,CAAEhG,KAAM2S,GAAQC,SAASprB,GAAIiP,QAAS,MAExC86E,iBAAiBvmE,GACjBA,EAAM2R,SAAW,KACjB4zD,UAAUvlE,IiB2KD2wE,CAAmC3wE,GAC5C,KAAKlX,GACH,OjBjJN,SAASooF,+BAA+BlxE,EAAqB6wE,GAAgB,IACnEl/D,EAAa3R,EAAb2R,SACA3W,EAAUgF,EAAMxF,eAAhBQ,MAFkE,EAMtE2W,EAAS3W,GAN6D,IAIxE9b,KAAQmG,EAJgE,EAIhEA,EAAGC,EAJ6D,EAI7DA,EAAGyd,EAJ0D,EAI1DA,GACd9H,EALwE,EAKxEA,KAGI6L,EAAa+pE,EAAb/pE,IAAKrB,EAAQorE,EAARprE,IACL28C,EAAUujB,GAAiBh0D,EAAS3W,GAAO9b,KAAKmG,EAAG2a,EAAMwjB,OAK3D5R,EAAQ,CAAE1yB,KAAM,CAAEmG,IAAGwd,GAAIvd,EAAGyd,MAAM9H,QACtC+M,sBAAgB4J,EAAO,CAAE9K,IAHzBA,GAAarB,EAFMkM,EAAS3W,GAAO9b,KAAKmG,EAAE07B,QAAQqhC,GAEjB98D,EAAEvG,OAGL0mB,QAf4C,MAgBzCmM,EAAM1yB,KAA3BgmB,EAhB8D,EAgBlEnC,GAAekC,EAhBmD,EAgBvDpC,GACnB7C,EAAM2R,SAAS3W,GAAO9b,KAAK6jB,GAAKmC,EAChClF,EAAM2R,SAAS3W,GAAO9b,KAAKoG,EAAI2f,EiB+HpB0rE,CAA8C3wE,EAAOjmB,EAAOM,OACrE,KAAKyO,GACH,OjB9HN,SAAS+kC,4BAAa7tB,EAAqBouB,EAAUN,GAAU,IAAD,EAC5D,aAAI9tB,EAAMxF,sBAAV,aAAI,EAAsBhe,GAAI,CAAC,IAAD,IACpBwe,EAAUgF,EAAMxF,eAAhBQ,MAGRu2B,4BAA4BvxB,EAAM9gB,KAAK8b,GAAQozB,EAAUN,GAEf,KAAtC,UAAA9tB,EAAM9gB,KAAK8b,GAAOC,YAAlB,eAAwByE,WAC1B0zB,aAAapzB,EAAM9gB,KAAK8b,IACuB,KAAtC,UAAAgF,EAAM9gB,KAAK8b,GAAOC,YAAlB,eAAwByE,YACjCgnE,YAAc1mE,EAAM9gB,KAAK8b,IAG3BurE,iBAAiBvmE,GAAO,GACxBulE,UAAUvlE,GACV0lE,QAAQ1lE,GAER,IAIM8pE,EAJc/D,GAAY8D,YAC9B7pE,EAAM+lE,YACN/lE,EAAML,WAEsBumE,UAC1B4D,IACF9pE,EAAM4B,QAAUkoE,EAAUloE,QAC1B5B,EAAMU,QAAUopE,EAAUppE,UiBsGnBiwE,CAA4B3wE,EAAOjmB,EAAOyC,GAAIzC,EAAO+zC,SAC9D,KAAKhlC,GACH,OAAO6nF,4BAA4B3wE,EAAOjmB,EAAOyC,IACnD,KAAKsM,GACH,OjB9DN,SAASqoF,sBAAsBnxE,EAAqBjmB,GAAS,IAAD,EAC1D,aAAIimB,EAAMxF,sBAAV,aAAI,EAAsBhe,GAAI,CAC5B,IAAMwe,EAAQgF,EAAMxF,eAAeQ,MAEnC,GAAIjhB,EAAOyC,GAAI,CACb,IAAMyxC,EAAejuB,EAAM9gB,KAAK8b,GAAmBqK,QAAQiP,WACzD,SAACoZ,GAAD,OAAOA,EAAElxC,KAAOzC,EAAOyC,MAEnB6oB,EAAWrF,EAAM9gB,KAAK8b,GAAmBqK,QAAQvnB,MACrD,EACAmwC,EAAc,GAEhBsD,eAA8BvxB,EAAM9gB,KAAK8b,GAAQqK,QAGjDksB,eAA8BvxB,EAAM9gB,KAAK8b,IAI3CurE,iBAAiBvmE,GACjBulE,UAAUvlE,GACV0lE,QAAQ1lE,IiByCC2wE,CAAqC3wE,EAAOjmB,GAErD,KAAK+O,GACH,OF5PN,SAASsoF,yBAAyBpxE,EAAqBjmB,GACrD,GAAIyB,MAAMC,QAAQ1B,EAAOyC,IAAK,CAC5B,IAAM60F,EAAMt3F,EAAOyC,GACnB,GAAmB,IAAf60F,EAAItyF,OAAc,CAAC,IAAD,iBACAihB,EAAM9gB,MADN,IACpB,2BACEuuF,WAD8B,SACZ,GAFA,mCAIf,CAAC,IAAD,iBACeztE,EAAM9gB,MADrB,IACL,2BAAgC,CAAC,IAAtBugB,EAAqB,QAC1B4xE,EAAIn1F,SAASujB,EAAMjjB,IACrBixF,WAAWhuE,GAAO,GAElBguE,WAAWhuE,GAAO,IALjB,oCASF,CACL,IAAMzE,EAAQgF,EAAM9gB,KAAKo1B,WAAU,SAAC1c,GAAD,OAAOA,EAAEpb,KAAOzC,EAAOyC,MACzDwjB,EAAM9gB,KAAK8b,GAA6BtR,QAAQ3P,EAAOkC,KAAOlC,EAAOM,MAEN,IAA3D2lB,EAAM9gB,KAAK8b,GAA6BC,KAAKyE,YAC/CM,EAAM9gB,KAAK8b,GAAmBtR,QAAQonB,UAAY08D,iBACjDxtE,EAAM9gB,KAAK8b,MEsONs2E,CAA0CtxE,EAAOjmB,GAE1D,KAAK+O,GACH,OFnON,SAASyoF,mCAAmCvxE,EAAqB9gB,GAAO,IAAD,iBACnD8gB,EAAM9gB,MAD6C,iCAC5DugB,EAD4D,QAGvC,KAA1B,UAAAA,EAAMxE,YAAN,eAAYyE,YACZxgB,EAAKlD,MAAK,SAAC8oF,GAAD,OAAgBA,EAAWtoF,KAAOijB,EAAMjjB,MAEjDijB,EAAkB/V,QAAQgrB,uBAAwB,EAElDjV,EAAkB/V,QAAQgrB,uBAAwB,GAPvD,2BAA+B,IADsC,+BEmO1D48D,CACLtxE,EACAjmB,EAAOmF,MAEX,KAAK4J,GACH,OF3NN,SAAS2qE,4CAA2BzzD,EAAqBxF,GAGvD,IAAIg3E,GAAgB,EACpB,GAAIh3E,EAAgB,CAElB,IAAMi3E,EAAWzxE,EAAM9gB,KAAKo1B,WAAU,SAAC1c,GAAD,OAAOA,EAAEpb,KAAOge,EAAehe,MAC/Dk1F,EAAW1xE,EAAM9gB,KAAKo1B,WAC1B,SAAC1c,GAAD,aAAOA,EAAEpb,MAAF,UAASwjB,EAAMxF,sBAAf,aAAS,EAAsBhe,OAExC,IAAkB,IAAdi1F,EAAiB,CACnB,IAAME,EAAoB3xE,EAAM9gB,KAAKuyF,GAErCE,EAAkBjoF,QAAQonB,WAAY,EAGpC0gE,GADgB,IAAdE,EAEC1xE,EAAM9gB,KAAKwyF,GAAgCz2E,KAAKiI,QACjDyuE,EAAkB12E,KAAKiI,MAITyuE,EAAkB12E,KAAKiI,QAAS,EAGpD1I,EAAc,2BAAQA,GAAR,IAAwBQ,MAAOy2E,IAC7CzxE,EAAMxF,eAAiBA,EACvBwF,EAAMkB,kBAAkBlB,EAAML,WAAanF,OAE3CwF,EAAMxF,eAAiB,KACvBwF,EAAMkB,kBAAkBlB,EAAML,WAAa,KAC3C6xE,GAAgB,EAOdA,IACFjM,UAAUvlE,GAGV0lE,QAAQ1lE,IEiLCsxE,CAA4CtxE,EAAOjmB,EAAOmF,MACnE,KAAK4J,GACH,OFxKN,SAAS8oF,0BAA0B5xE,EAAnC,GAA6E,IAAnBxjB,EAAkB,EAAlBA,GAAImc,EAAc,EAAdA,MAAO1c,EAAO,EAAPA,IAE7D+e,EADQk2B,aAASlxB,GACH9gB,KAAKo1B,WAAU,SAAC1c,GAAD,OAAOA,EAAEpb,KAAOA,MACpC,IAAXwe,IACDgF,EAAM9gB,KAAK8b,GAA6BtR,QAAQzN,GAAO0c,GEoK/C24E,CAA2CtxE,EAAOjmB,EAAOmF,MAClE,KAAK4J,GACH,OFjLN,SAAS+oF,sBAAsB7xE,EAA/B,GAAsE,IAAhBxjB,EAAe,EAAfA,GAAIkN,EAAW,EAAXA,QAElDsR,EADQk2B,aAASlxB,GACH9gB,KAAKo1B,WAAU,SAAC1c,GAAD,OAAOA,EAAEpb,KAAOA,MACpC,IAAXwe,IACFgF,EAAM9gB,KAAK8b,GAAOtR,QAAUA,GE6KnB4nF,CAAuCtxE,EAAOjmB,GACvD,KAAK+O,GACH,OFtIN,SAASgpF,oBAAoB9xE,EAAqBjmB,GAChD,GAAIimB,EAAM9gB,MAAQ8gB,EAAM9gB,KAAKH,OAAS,EAAG,CAAC,IAAD,iBACrBihB,EAAM9gB,MADe,IACvC,2BAA8B,CAAC,IAAD,IAArBugB,EAAqB,QAC5B,GAC4B,KAA1B,UAAAA,EAAMxE,YAAN,eAAYyE,YACZD,EAAMxE,KAAK4B,UAAYmD,EAAML,aAC7B,UAACF,EAAMxE,YAAP,aAAC,EAAYiI,OACb,CACA,IAAMwzB,EAAQ22C,kBAAkB5tE,EAAD,eAAa1lB,EAAOE,UACnD6yC,YAAYrtB,EAAO,CACjB,CACEzK,KAAM2S,GAAQO,OAAO1rB,GACrBiP,QAASirC,OAXsB,+BAkBzC6uC,UAAUvlE,GACV0lE,QAAQ1lE,GEkHGsxE,CAAqCtxE,EAAOjmB,GACrD,KAAK+O,GACH,OZ/IN,SAASipF,oCAAoC/xE,GAC3C,GAA4B,MAAxBA,EAAMxF,eAAwB,CAAC,IACzBQ,EAAUgF,EAAMxF,eAAhBQ,MAIR,GAFAgF,EAAM9gB,KAAK8b,GAAOtR,QAAQ0nC,uBAAyBpxB,EAAM9gB,KAAK8b,GAAOtR,QAClE0nC,sBACCpxB,EAAM9gB,KAAK8b,GAAOtR,QAAQ0nC,sBAAuB,CACnD,IAAMvuB,EAAK7C,EAAM9gB,KAAK8b,GAAO9b,KAAK2jB,GACvB,OAAPA,QAAsBT,IAAPS,IACjB7C,EAAM9gB,KAAK8b,GAAO9b,KAAKoG,EAAIud,OAExB,CACL,IAAME,EAAK/C,EAAM9gB,KAAK8b,GAAO9b,KAAK6jB,GAEvB,OAAPA,QAAsBX,IAAPW,IACjB/C,EAAM9gB,KAAK8b,GAAO9b,KAAKoG,EAAIyd,GAI/BwiE,UAAUvlE,IY4HDqwE,CAAiDrwE,GAC1D,KAAKlX,GACH,OZvEN,SAAS87B,wBAAW5kB,EAAqBjmB,GAAS,IACxC8L,EAA+B9L,EAA/B8L,OAAQE,EAAuBhM,EAAvBgM,UAAWmkC,EAAYnwC,EAAZmwC,QAC3B,GAAIA,EACF,OAAQA,GACN,KAAK7E,GAAOC,OAEV7mB,WAAM5Y,EAAQE,EAAWia,EADdwoE,cAAcxoE,EAAO,IAEhCiB,UAAUjB,EAAOA,EAAM/R,OAAO5E,IAAK,GAAI,GACvC,MAEF,KAAKg8B,GAAOE,QAEV9mB,WAAM5Y,EAAQE,EAAWia,EADdwoE,cAAcxoE,EAAO,IAEhCiB,UAAUjB,EAAOA,EAAM/R,OAAOzE,KAAM,GAAI,QAO5CiV,WAAM5Y,EAAQE,EAAWia,GACzBD,QAAQC,GYkDCqwE,CAAwBrwE,EAAOjmB,GACxC,KAAK+O,GACH,OZ6LN,SAASkpF,yBAAyBhyE,GAC5BA,EAAM4mB,gBAAkBN,GAAeC,QACzCvmB,EAAMM,aAAaF,SAAWJ,EAAMM,aAAamlE,eACjD1lE,QAAQC,EAAO,KYhMNqwE,CAAsCrwE,GAC/C,KAAKlX,GACH,OZiMN,SAASmpF,kBAAkBjyE,GACrBA,EAAM4mB,gBAAkBN,GAAeC,QACzCvmB,EAAMI,SAAW7lB,OAAOC,KAAKwlB,EAAMI,UAAUP,QAAO,SAACC,EAAK7jB,GAExD,OADA6jB,EAAI7jB,GAAO+jB,EAAMM,aAAaI,QACvBZ,IACN,IACHE,EAAMM,aAAaF,SAAWJ,EAAMI,SACpCJ,EAAMU,QAAUV,EAAMM,aAAaI,SYxM1B2vE,CAA+BrwE,GAExC,KAAKlX,GACH,OZ1MN,SAASopF,gCAAgClyE,EAAzC,GAAyE,IAATiC,EAAQ,EAARA,KACxDnoB,EAAQo3C,aAASlxB,GACfxF,EAAsCwF,EAAtCxF,eAAgB9Z,EAAsBsf,EAAtBtf,OAAQif,EAAcK,EAAdL,UAC5B2mE,E5M/GmC,G4MgHvC,GAAI9rE,EAAgB,CAAC,IACXQ,EAAUR,EAAVQ,MACHlhB,EAAMoF,KAAK8b,GAAmBC,KAAKiI,QACtCojE,EAAa5lF,EAAS,GAM1B,GAHAsf,EAAM+B,cAAcE,KAAOA,EAC3BjC,EAAM+B,cAAcG,QAAUD,EAE1BA,EAAM,CACR,IAAMggE,EAASnoF,EAAMoF,KAAmBjB,QACtC,SAACwhB,GAAD,OAAWA,EAAMxE,KAAK4B,UAAY8C,KAClC5gB,OACFihB,EAAM+B,cAAc1nB,MAAQ6L,KAAK6e,MAAMrkB,GAAUuhF,EAAQ,SAEzDjiE,EAAM+B,cAAc1nB,MAAQisF,EYuLnB+J,CAA6CrwE,EAAOjmB,GAE7D,KAAK+O,GACH,OPxSN,SAASqpF,mBAAmBnyE,EAAqB8wC,GAC/Cm5B,WAA2BjqE,EAAM6W,UAAWi6B,GOuSjCshC,CAAmCpyE,EAAOjmB,EAAO+2D,SAE1D,KAAKhoD,GACH,OAAOspF,mBACLpyE,EACAjmB,EAAO+2D,QACP/2D,EAAOkC,KAGX,KAAK6M,GACH,OP1SN,SAASupF,sBAAsBryE,EAAqBjmB,GAAS,IAAD,EAC1BA,EAAOE,QAA/BgC,EADkD,EAClDA,IAAKi8B,EAD6C,EAC7CA,eACTlY,EAAM4mB,gBAAkBN,GAAeC,OACzCgkD,kBAAkBvqE,EAAO,CAAE/lB,QAAS,CAAEi+B,iBAAgB7B,UAAW,QAE/DrW,EAAM4mB,gBAAkBN,GAAeE,OACzCslD,iBAAiB9rE,EAAO,CAAE/lB,QAAS,CAAEi+B,iBAAgBkR,SAAU,QAEjE,IAAMkpD,EAAgBtyE,EAAM6W,UAAUvC,WACpC,SAAC4yD,GAAD,OAAcA,EAASjrF,MAAQA,KAGjC+jB,EAAM6W,UAAUiK,OAAOwxD,EAAe,GO8R3BF,CAAsCpyE,EAAOjmB,GAEtD,KAAK+O,GACH,OP9RN,SAASypF,iCAAiCvyE,EAAqBjmB,GAAS,IAAD,EACpCA,EAAOE,QAAhCmtF,EAD6D,EAC7DA,YAAa37E,EADgD,EAChDA,QADgD,EAEpD+mF,aAAYpL,EAAYn+C,QAAS,IAA1C5jC,EAF6D,EAE7DA,EAAGC,EAF0D,EAE1DA,EACP9I,EAAU,KACd,GAAIiP,EAAQstC,QAAQ,MAAO,CACzB,IAAMt5B,EAAQsxB,gBAAgB,CAC5B7xC,KAAM,CAAEmG,IAAG0d,GAAI,KAAMF,GAAIvd,GACzB2V,KAAM,CAAE4B,QAAS,QAEnBrgB,EAAKijB,EAAMjjB,GACXijB,EAAMkX,OAAOzF,OAASmhB,UAAU+0C,EAAYzwD,OAAQlX,GACpDyyB,qBAAqBzyB,GACrBO,EAAM9gB,KAAKtD,KAAK6jB,GAChB,IAAMjF,EAAiB,CAAEhe,KAAIwe,MAAOgF,EAAM9gB,KAAKH,OAAS,GACxDihB,EAAMkB,kBAAkB,MAAQ1G,EAChCwF,EAAMxF,eAAiBA,EAEzB0jC,0BAAal+B,GACbR,kBAAkBQ,EAAM9gB,MACxB6gB,QAAQC,EAAO,GAAKxjB,GAEpBwjB,EAAMrJ,WAAY,EOyQPy7E,CAAiDpyE,EAAOjmB,GAEjE,KAAK+O,GACH,OtB1TN,SAAS2pF,YAAYzyE,EAAqB/lB,GACxC,IAAMH,EAAQo3C,aAASlxB,GACT+4B,EAA0Bj/C,EAAhCoF,KAAe23E,EAAiB/8E,EAAjB+8E,aACflsC,EAAO1wC,EAAP0wC,GAEwB,KAA5BksC,EAAaprE,QAAQk/B,IAAaksC,EAAaprE,QAAQk/B,KAAOA,IAChE3qB,EAAM62D,aAAe6N,SAAMC,MACzB5rC,EADmB,2BAEd89B,EAAaprE,SAFC,IAEQk/B,OAC3B0sC,KAAgBR,EAAa3lD,UsBiTtBwhE,CAAgC1yE,EAAOjmB,EAAOE,SAEvD,KAAK6O,GACH,OtB/SN,SAAS6pF,mBACP3yE,EACA/lB,GAEA,IAAMH,EAAQo3C,aAASlxB,GACT+4B,EAA0Bj/C,EAAhCoF,KAAe23E,EAAiB/8E,EAAjB+8E,aACfnvB,EAAcztD,EAAdytD,UACR1nC,EAAM62D,aAAe6N,SAAMC,MACzB5rC,EADmB,2BAEd89B,EAAaprE,SAFC,IAEQi8C,cAC3B2vB,KAAgBR,EAAa3lD,SsBqSpBwhE,CAAuC1yE,EAAOjmB,EAAOE,SAE9D,KAAK6O,GACH,OtBpSN,SAAS8pF,qBACP5yE,EACA/lB,GAEA,IACQ48E,EADM3lC,aAASlxB,GACf62D,aACAr6E,EAAoBvC,EAApBuC,GAAIm4E,EAAgB16E,EAAhB06E,YACZ30D,EAAM62D,aAAegB,wBAAqBgb,eACxChc,EACAr6E,EACAm4E,GAEF8P,yBAAyBzkE,GsBwRd0yE,CAAyC1yE,EAAOjmB,EAAOE,SAEhE,KAAK6O,GACH,OtBxRN,SAASgqF,sBACP9yE,EACA/lB,GACC,IACOk+B,EAAsBl+B,EAAtBk+B,IAAK0+C,EAAiB58E,EAAjB48E,aACb1+C,EAAIp1B,SAAQ,SAACvG,EAAIsC,GAAO,IACA62E,EAAqB31D,EAAnC62D,aACR72D,EAAM62D,aAAegB,wBAAqBgb,eACxCld,EACAn5E,EACAq6E,EAAa/3E,OAGjB2lF,yBAAyBzkE,GsB2Qd0yE,CAA0C1yE,EAAOjmB,EAAOE,SAEjE,KAAK6O,GACH,OF9MN,SAASiqF,oBAAoB/yE,EAAqBjmB,GAAS,IACjD4lB,EAAcK,EAAdL,UACF7lB,EAAQo3C,aAASlxB,GACvB,GAAIjmB,EAAOyC,GAAI,CACb,IAAMwe,EAAQlhB,EAAMoF,KAAKo1B,WAAU,SAAC1c,GAAD,OAAOA,EAAEpb,KAAOzC,EAAOyC,MAC1DwjB,EAAM9gB,KAAK4hC,OAAO9lB,EAAO,QAEzBgF,EAAM9gB,KAAK6D,SAAQ,SAAC0c,EAAOzE,GACzBgF,EAAM9gB,KAAK4hC,OAAO9lB,EAAO,MAG7BgF,EAAMxF,eAAiB,KACvB0jC,0BAAal+B,EAAOL,GAAW,GEkMpB2xE,CAAqCtxE,EAAOjmB,GAErD,IvS9SiC,wBuS+S/B,OrB9FN,SAASi5F,4BAA4BhzE,EAAOuB,GAC1C,IAAM/G,EAAiBwF,EAAMxF,eACzBA,IACFwF,EAAMyB,kBAAkBjH,EAAehe,IAAM+kB,GqB2FpCwuE,CAA0C/vE,EAAOjmB,EAAO2mB,SAEjE,KAAK5X,GACH,OZtKN,SAASmqF,eAAejzE,EAAqBjmB,GAC3C,IAAMm5F,EAAOlzE,EAAM4mB,gBAAkBN,GAAeE,MAC9C2sD,EAASzxE,UAAU1B,GAEnBozE,EAASF,EAAOvtD,YAAY3lB,GAAS8B,UAAU9B,GAE/Cha,EAASmtF,EAAOj4E,OAAOnhB,EAAOiM,QAC9BC,EAAOktF,EAAOj4E,OAAOnhB,EAAOkM,MAC5BU,EAASysF,EAAOl4E,OAAOnhB,EAAO4M,QAC9BD,EAAO0sF,EAAOl4E,OAAOnhB,EAAO2M,MAC5B2sF,EAAUrtF,EAASC,EAAO,CAACA,EAAMD,GAAU,CAACA,EAAQC,GACpDkc,EAAUxb,EAASD,EAAO,CAACA,EAAMC,GAAU,CAACA,EAAQD,GACpD4sF,EAAevN,GAAY8D,YAC/B7pE,EAAM+lE,YACN/lE,EAAML,WAGR,GAAIK,EAAM4mB,gBAAkBN,GAAeE,MAAO,CAChD,OAAQzsC,EAAOmwC,SACb,KAAK7E,GAAOG,UACVxlB,EAAM4B,QAAUyxE,EAChBrzE,EAAMU,QAAUyB,EAChB,MACF,KAAKkjB,GAAOC,OACVtlB,EAAM4B,QAAUyxE,EAChB,MACF,KAAKhuD,GAAOE,QACVvlB,EAAMU,QAAUyB,EAKhBmxE,GACFA,EAAa13F,KAAK,CAAEgmB,QAASyxE,EAAS3yE,QAASyB,SAGjDnC,EAAM4B,QAAUyxE,EACZC,GACFA,EAAa13F,KAAK,CAAEgmB,QAASyxE,EAAS3yE,QAASyB,IYgIxCkuE,CAA4BrwE,EAAOjmB,GAE5C,KAAK+O,GACH,OZ/HN,SAASyqF,8BAA8BvzE,EAAqBviB,GAC1D,IAAMgd,EAASiH,UAAU1B,GACzBA,EAAMwjB,MAAQ/oB,EAAOS,OAAOzd,GY6HjB4yF,CAA2CrwE,EAAOjmB,EAAO0D,UAClE,KAAKqL,GACH,OZxPN,SAAS0qF,0BAA0BxzE,GACjComE,gCAAgCpmE,GAAQA,EAAM+B,cAAcE,MYuPjDouE,CAAuCrwE,GAEhD,KAAKlX,GACH,OAAOomF,sBAAmClvE,EAAOjmB,EAAO0R,SAE1D,KAAK3C,GACH,OAAO2qF,yBAAsCzzE,EAAOjmB,EAAO0R,SAC7D,KAAK3C,GACH,OVxUN,SAAS4qF,0BAA0B1zE,EAAqB0rE,GAAmB,IAAD,EACxE,aAAI1rE,EAAMxF,sBAAV,aAAI,EAAsBhe,GAAI,CAAC,IACrBwe,EAAUgF,EAAMxF,eAAhBQ,MACR23B,aAAa3yB,EAAM9gB,KAAK8b,GAAQ0wE,GAChCZ,yBAAyB9qE,IUoUhB2zE,CAAwC3zE,EAAOjmB,EAAO0R,SAC/D,KAAK3C,GACH,OAAO6qF,eAA6B3zE,EAAOjmB,GAC7C,KAAK+O,GACH,OV9TN,SAAS8qF,kBAAkB5zE,EAAqBjmB,GAAS,IAAD,EAChDD,EAAQo3C,aAASlxB,GACvB,aAAIlmB,EAAM0gB,sBAAV,aAAI,EAAsBhe,GAAI,CAAC,IACrBwe,EAAUlhB,EAAM0gB,eAAhBQ,MADoB,EAEGjhB,EAAOE,QAA9BuC,EAFoB,EAEpBA,GAAI07B,EAFgB,EAEhBA,eACNzY,EAAQO,EAAM9gB,KAAK8b,GACzB,GAAIxe,EAAI,CACN,IAAMiC,EAAQghB,EAAMkX,OAAOzF,OAAO4F,MAAK,SAACr4B,GAAD,OAAWA,EAAMjC,KAAOA,KAC/Dy7B,GAAuBC,EAAgB,CAACz5B,IACxC,IAAMisF,EAAaJ,cAAcxwF,EAAOkhB,EAAOxe,GAC/CijB,EAAMkX,OAAOzF,OAAO4P,OAAO4pD,EAAY,QAEvCzyD,GAAuBC,EAAgBzY,EAAMkX,OAAOzF,QACpDzR,EAAMkX,OAAOzF,OAAS,GAExBghB,qBAAqBlyB,EAAM9gB,KAAK8b,IAChC8vE,yBAAyB9qE,IU8ShB2zE,CAAgC3zE,EAAOjmB,GAChD,KAAK+O,GACH,OAAO6qF,kBAAgC3zE,EAAOjmB,GAChD,KAAK+O,GACH,OVjNN,SAAS+qF,qBAAqB7zE,EAAqB3lB,GAAQ,IAAD,EACxD,aAAI2lB,EAAMxF,sBAAV,aAAI,EAAsBhe,GAAI,CAAC,IACrBwe,EAAUgF,EAAMxF,eAAhBQ,MACPgF,EAAM9gB,KAAK8b,GAAmB2b,OAAOlrB,QAAQ6lC,IAAMj3C,EACpD63C,qBAAqBlyB,EAAM9gB,KAAK8b,KU6MvB24E,CAAmC3zE,EAAOjmB,EAAOM,OAC1D,KAAKyO,GACH,OAAO6qF,8BAA4C3zE,EAAOjmB,GAC5D,KAAK+O,GACH,OV1LN,SAASgrF,6BAA6B9zE,EAAOjmB,GAAS,IAAD,IACdA,EAAOE,QAApCsyE,EAD2C,EAC3CA,QAAS5xC,EADkC,EAClCA,SAAUtgC,EADwB,EACxBA,MAC3B,aAAI2lB,EAAMxF,sBAAV,aAAI,EAAsBhe,GAAI,CAAC,IACrBwe,EAAUgF,EAAMxF,eAAhBQ,MAEF07B,ExL8RH,SAASq9C,kBAAkBt0E,EAAO8sD,EAAS5xC,EAAUq5D,GAC1D,IAAIjtE,EAAa,EACX2jE,EAAajrE,EAAMkX,OAAOzF,OAAOoD,WACrC,SAAC71B,GAAD,OAAWA,EAAMjC,KAAO+vE,KAE1B,IAAoB,IAAhBme,EAAmB,CACrB,IAAM/yD,EAAclY,EAAMkX,OAAOzF,OAAOw5D,GAAYpzD,OAAOhD,WACzD,SAACgD,GAAD,OAAYA,EAAO96B,KAAOm+B,KAE5B5T,EACEitE,EACAv0E,EAAMkX,OAAOzF,OAAOw5D,GAAYpzD,OAAOK,GAAahD,MACtDlV,EAAMkX,OAAOzF,OAAOw5D,GAAYpzD,OAAOK,GAAahD,MAAQq/D,EAE9D,OAAOjtE,EwL5SSgtE,CACZ/zE,EAAM9gB,KAAK8b,GACXuxD,EACA5xC,EACAtgC,GAEFk3C,YAA2BvxB,EAAM9gB,KAAK8b,GAAQ,CAC5C,CAAEhG,KAAM2S,GAAQO,OAAO1rB,GAAIiP,QAASirC,KAGtCtD,aAAapzB,EAAM9gB,KAAK8b,IAExB8vE,yBAAyB9qE,GACzBulE,UAAUvlE,IUwKD2zE,CAA2C3zE,EAAOjmB,GAC3D,KAAK+O,GACH,OVpTN,SAASmrF,4BAA4Bj0E,EAAqBjmB,GAAS,IAAD,EAC1DD,EAAQo3C,aAASlxB,GACvB,aAAIlmB,EAAM0gB,sBAAV,aAAI,EAAsBhe,GAAI,CAAC,IACrBwe,EAAUlhB,EAAM0gB,eAAhBQ,MADoB,EAEDjhB,EAAOE,QAA1B0wE,EAFoB,EAEpBA,QAAStwE,EAFW,EAEXA,MACXqwF,EAAaJ,cAAcxwF,EAAOkhB,EAAO2vD,EAAQnuE,IACjDsxB,EAAU9N,EAAM9gB,KAAK8b,GAAmB2b,OAAOzF,OACnDw5D,IAEF,OAAI58D,QAAJ,IAAIA,OAAJ,EAAIA,EAAQwJ,UACTxJ,EAAOwJ,OAAOqzC,EAAQS,cAAczzC,aAAwBK,KAAO39B,EACpEyzB,EAAOkK,KAAOhB,GAAqB96B,SAAS7B,GACxC48B,GACAA,GACJib,qBAAqBlyB,EAAM9gB,KAAK8b,IAChC8vE,yBAAyB9qE,KUqSlB2zE,CAA0C3zE,EAAOjmB,GAC1D,KAAK+O,GACH,OVlSN,SAASorF,sBAAsBl0E,EAAqBjmB,GAAS,IAAD,EACpDD,EAAQo3C,aAASlxB,GACvB,aAAIlmB,EAAM0gB,sBAAV,aAAI,EAAsBhe,GAAI,CAAC,IACrBwe,EAAUlhB,EAAM0gB,eAAhBQ,MADoB,EAEcjhB,EAAOE,QAAzC+wE,EAFoB,EAEpBA,cAAe9yC,EAFK,EAELA,eAEjBi8D,EAAiB18D,GAAOuzC,UACvBmpB,EAAe/oB,cAGtBnzC,GAAuBC,EAAgBi8D,GAEvC,IAAMzJ,EAAaJ,cAAcxwF,EAAOkhB,EAAOm5E,EAAe33F,IAC7DwjB,EAAM9gB,KAAK8b,GAAmB2b,OAAOzF,OAAOw5D,GAAcyJ,EAC3DjiD,qBAAqBlyB,EAAM9gB,KAAK8b,IAChC8vE,yBAAyB9qE,IUmRhB2zE,CAAoC3zE,EAAOjmB,GACpD,KAAK+O,GACH,OAAO6qF,kBAAgC3zE,EAAOjmB,GAChD,KAAK+O,GACH,OVrPN,SAASsrF,oBAAoBp0E,EAAOjmB,GAAS,IAAD,EACpCD,EAAQo3C,aAASlxB,GACvB,aAAIlmB,EAAM0gB,sBAAV,aAAI,EAAsBhe,GAAI,CAAC,IACrBwe,EAAUlhB,EAAM0gB,eAAhBQ,MADoB,EAEcjhB,EAAOE,QAAzCo8B,EAFoB,EAEpBA,UAAWgB,EAFS,EAETA,MAAOM,EAFE,EAEFA,YAEpB+yD,EAAaJ,cAAcxwF,EAAOkhB,EAAOqb,EAAU75B,IACnDsxB,EAAS9N,EAAM9gB,KAAK8b,GAAO2b,OAAOzF,OAAOw5D,QAC3BtoE,IAAhBuV,EACF7J,EAAOuJ,MAAQA,EAEfvJ,EAAOwJ,OAAOK,GAAaN,MAAQA,EAErCvJ,EAAO+J,YAAcX,GAAepJ,IUwO3B6lE,CAAkC3zE,EAAOjmB,GAElD,IvSxT2B,kBuSyTzB,OlBlXN,SAASs6F,qBAAqBr0E,EAAqBjmB,GAAS,IAClDC,EAAiBD,EAAjBC,KAAMk3B,EAAWn3B,EAAXm3B,OACRojE,EAAoB92E,IAAUwC,EAAM6P,YAAa,SAAU,IACjE7P,EAAM6P,YAAYyvB,OAAlB,2BAAgCg1C,GAAhC,mBAAoDt6F,EAAOk3B,IkB+WhDmjE,CAAqBr0E,EAAOjmB,EAAOmF,MAC5C,KAAK4J,GACH,OZ+EN,SAASyrF,mBAAmBv0E,EAAqBo+B,GAC3CA,GACFF,0BAAal+B,EAAOo+B,GYjFXiyC,CAAgCrwE,EAAOjmB,EAAOqkD,KACvD,KAAKt1C,GACH,OZhQN,SAAS0rF,sBAAsBx0E,EAA/B,GAAmE,IAAbhgB,EAAY,EAAZA,KAAMmb,EAAM,EAANA,GACpDV,EAASiH,UAAU1B,GAErBtc,EAAQ+W,EAAOS,OAAOlb,GACpB2D,EAAM8W,EAAOS,OAAOC,GAEtBsQ,EAAY,GAEdA,EADE/nB,EAAQC,EACH,CAACA,EAAKD,GAEN,CAACA,EAAOC,GAGjB,IAAMwgB,EAAQnE,EAAMuL,cAAcztB,QAClCqmB,EAAMvoB,KAAK,CACTY,GAAIowC,aACJ5sC,KAAMyrB,EAAK,GACXtQ,GAAIsQ,EAAK,KAEXzL,EAAMuL,cAAgBpH,EY6OXksE,CAAmCrwE,EAAOjmB,EAAO0xB,MAC1D,KAAK3iB,GACH,OZ5ON,SAAS2rF,yBAAyBz0E,EAAqBxjB,GACrD,IAAM1C,EAAQo3C,aAASlxB,GACvBA,EAAMuL,cAAgBzxB,EAAMyxB,cAActtB,QAAO,SAACwtB,GAAD,OAAUA,EAAKjvB,KAAOA,KY0O5D6zF,CAAsCrwE,EAAOjmB,EAAOyC,IAC7D,KAAKsM,GACH,OjB/LN,SAAS4rF,+BAA+B10E,EAAqBjmB,GAAS,IAAD,EACnE,aAAIimB,EAAMxF,sBAAV,aAAI,EAAsBhe,GAAI,CAAC,IACrBwe,EAAUgF,EAAMxF,eAAhBQ,MAERu2B,YAA2BvxB,EAAM9gB,KAAK8b,GAAQ,CAC5C,CACEhG,KAAM2S,GAAQE,mBAAmBrrB,GACjCiP,QAAQ,aAAG0Y,MAAOnE,EAAMuL,eAAkBxxB,EAAO0R,YAIrDuU,EAAMuL,cAAgB,GACtB,IAAMopE,EAAkB30E,EAAM4B,QAAQ9jB,QAEtCyoF,iBAAiBvmE,GACjBulE,UAAUvlE,GACVA,EAAM4B,QAAU+yE,GiB+KPhE,CAA8C3wE,EAAOjmB,GAC9D,KAAK+O,GACH,OlB9VN,SAAS8rF,yBAAyB50E,EAAqB0T,GACrD,IAAM55B,EAAQo3C,aAASlxB,GAErBL,EAYE7lB,EAZF6lB,UACAzgB,EAWEpF,EAXFoF,KACAsb,EAUE1gB,EAVF0gB,eACA2F,EASErmB,EATFqmB,WACAyB,EAQE9nB,EARF8nB,QACAD,EAOE7nB,EAPF6nB,SACAjB,EAME5mB,EANF4mB,QACAN,EAKEtmB,EALFsmB,SACAE,EAIExmB,EAJFwmB,aACArS,EAGEnU,EAHFmU,OACA24B,EAEE9sC,EAFF8sC,cACA1lB,EACEpnB,EADFonB,kBAEF,GAAIvB,EAAW,CACb,IAEMk1E,EAFiB/kB,GAAe,UAEVmD,CAAe/zE,GAErC41F,EACJluD,IAAkBN,GAAeE,MAC7BquD,EAAoBl1E,GAAWE,QAAO,SAACC,EAAKL,GAE1C,OADAK,EAAIL,EAAMjjB,IAAMijB,EAAM+2B,qBAAqB7B,WACpC70B,IACN,IACH,KAENE,EAAMm8B,gBAAgBzoB,GAAW,CAC/B/T,YACAnF,iBACAosB,gBACA1lB,oBACAf,aACAyB,UACAD,WACAjB,UACAN,WACAE,eACAw0E,QACA7mF,SACA/O,KAAM21F,EAAoBl1E,GAAWE,QAAO,SAACC,EAAKL,GAQhD,OAPAK,EAAIL,EAAMjjB,IAAM,CACdkN,QAAS,CACPiP,MAAO8G,EAAM/V,QAAQiP,MACrBmY,UAAWrR,EAAM/V,QAAQonB,UACzB4D,sBAAuBjV,EAAM/V,QAAQgrB,wBAGlC5U,IACN,MkB2SI80E,CAAyB50E,EAAOjmB,EAAO25B,SAChD,KAAK5qB,GACH,OlBpSN,SAASisF,2BAA2B/0E,EAAqB0T,GACvD,IAAM55B,EAAQo3C,aAASlxB,GAEjB6P,EAAc/1B,EAAMqiD,gBAAgBzoB,GAC1C,GAAI7D,EAwBF,GAvBA7P,EAAML,UAAYkQ,EAAYlQ,UAC7B7lB,EAAMoF,KAA+B6D,SAAQ,SAAC0c,EAAOzE,IAV1D,SAASg6E,gBAAgBC,GACvB,MAA0B,kBAAZA,EAAuBA,EAAUA,EAAQrkD,KAAK,MAUpDokD,CAAgBv1E,EAAMxE,KAAK4B,WAAagT,EAAYlQ,YACtDK,EAAM9gB,KAAK8b,GAAOtR,QAAUnP,OAAOipB,OACjCinE,KAAUhrE,EAAM/V,SAChBmmB,EAAY3wB,KAAKugB,EAAMjjB,IAAIkN,aAIjCsW,EAAM4mB,cAAgB/W,EAAY+W,cAClC5mB,EAAMkB,kBAAoB2O,EAAY3O,kBACtClB,EAAMxF,eAAiBqV,EAAYrV,eAEnCwF,EAAM/R,OAAS4hB,EAAY5hB,OAE3Bs3E,UAAUvlE,GAEVA,EAAM4B,QAAUiO,EAAYjO,QAC5B5B,EAAM2B,SAAWkO,EAAYlO,SAC7B3B,EAAMU,QAAUmP,EAAYnP,QAC5BV,EAAMM,aAAeuP,EAAYvP,aACjCN,EAAMI,SAAWyP,EAAYzP,SAEzBJ,EAAM4mB,gBAAkBN,GAAeE,MAGzC,IAHiD,IAAD,mBAG3C,IAAM0uD,EAAO,KAH8B,EAILrlE,EAAYilE,MAAMI,GAAnDtgD,EAJsC,EAItCA,cAAeC,EAJuB,EAIvBA,cACjB75B,EAAQlhB,EAAMoF,KAAKo1B,WAAU,SAAC7U,GAAD,OAAWA,EAAMjjB,KAAO04F,KACrDC,EAAqBn1E,EAAM9gB,KAAK8b,GACnCw7B,qBACH2+C,EAAkBrgD,SAASF,EAAeC,GAC1C70B,EAAM8lB,SAASovD,GAAWC,EAAkBhgD,gBAN9C,MAAsB56C,OAAOC,KAAKq1B,EAAYilE,OAA9C,eAAuD,SASvD/0E,QAMEC,EACA6P,EAAY1P,WAAW9B,OkBqPlB02E,CAA2B/0E,EAAOjmB,EAAO25B,SAClD,KAAK5qB,GACH,OZyEN,SAASssF,mBAAmBp1E,EAA5B,GAAwE,IAArBna,EAAoB,EAApBA,OAAQpB,EAAY,EAAZA,SACzD,IAAK,IAAD,EACF,aAAIub,EAAMxF,sBAAV,aAAI,EAAsBhe,GAAI,CAAC,IAAD,EACNwjB,EAAMxF,eAApBQ,EADoB,EACpBA,MAAOxe,EADa,EACbA,GAGTg6C,EAAwBx2B,EAAM9gB,KAAK8b,GACtCw7B,qBAEC/xC,EACF+xC,EAAqBtB,WAAWrvC,GAEhC2wC,EAAqB/3B,MAAM5Y,GAE7B,IAAMigC,EAAWvrC,OAAO0wB,OAAOurB,EAAqBrB,gBACpDn1B,EAAM8lB,SAAStpC,GAAMspC,GAGvB,MAAOnpC,GAEP+E,QAAQC,IAAIhF,IY7FH0zF,CAAgCrwE,EAAOjmB,GAChD,KAAK+O,GACH,OAAO2qF,iBAA8BzzE,EAAOjmB,GAC9C,KAAK+O,GACH,OTrSN,SAASusF,iBAAiBr1E,EAAqBjmB,GAAS,IAAD,EAC/CD,EAAQo3C,aAASlxB,GACvB,aAAIlmB,EAAM0gB,sBAAV,aAAI,EAAsBhe,GAAI,CAAC,IACrBwe,EAAUlhB,EAAM0gB,eAAhBQ,MADoB,EAEGjhB,EAAOE,QAA9BuC,EAFoB,EAEpBA,GAAI07B,EAFgB,EAEhBA,eACZ,GAAI17B,EAAI,CACN,IAAMivB,EAAQzL,EAAM9gB,KAAK8b,GAAmBmJ,MAAM+M,OAAO4F,MACvD,SAACrL,GAAD,OAAUA,EAAKjvB,KAAOA,KAExBy7B,GAAuBC,EAAgB,CAACzM,IACxC,IAAMugE,EAAYH,aAAa/xF,EAAOkhB,EAAOxe,GAC5CwjB,EAAM9gB,KAAK8b,GAAmBmJ,MAAM+M,OAAO4P,OAAOkrD,EAAW,QAE9D/zD,GACEC,EACClY,EAAM9gB,KAAK8b,GAAmBmJ,MAAM+M,QAEtClR,EAAM9gB,KAAK8b,GAAmBmJ,MAAM+M,OAAS,GAEhDs6D,wBAAwBxrE,ISkRfyzE,CAA8BzzE,EAAOjmB,GAC9C,KAAK+O,GACH,OF9PN,SAASwsF,2BAA2Bt1E,EAAOjmB,GAAS,IAAD,EAC3CD,EAAQo3C,aAASlxB,GACjBnD,EAAU9iB,EAAO8iB,QACvB,aAAImD,EAAMxF,sBAAV,aAAI,EAAsBhe,GAAI,CAAC,IAAD,EACpBwe,EAAUgF,EAAMxF,eAAhBQ,MADoB,eAEd6B,GAFc,IAE5B,2BAAuB,CAAC,IAAfqV,EAAc,QACfvP,EAAUm0B,6BAAqBh9C,EAAMoF,KAAK8b,GAAQkX,GACxDlS,EAAM9gB,KAAKtD,KAAK+mB,IAJU,8BAQ5B2mE,OAAOtpE,EAFgB8vD,GAAe,UACXmD,CAAejzD,EAAM9gB,MACd8gB,EAAML,WAAW,GACnD4lE,UAAUvlE,GACV0lE,QAAQ1lE,IEiPCsxE,CAA4CtxE,EAAOjmB,GAC5D,KAAK+O,GACH,OrB1KN,SAASysF,kBAAkBv1E,GAAsB,IAAD,EACGA,EAAMM,aAA/CsB,EADsC,EACtCA,QAASlB,EAD6B,EAC7BA,QAASiB,EADoB,EACpBA,SAAUvB,EADU,EACVA,SACpCJ,EAAM4B,QAAUA,EAChB5B,EAAMU,QAAUA,EAChBV,EAAM2B,SAAWA,EACjB3B,EAAMI,SAAWA,EqBqKN2vE,CAAgC/vE,GACzC,KAAKlX,GACH,OT5VN,SAAS0sF,sBAAsBx1E,EAAqBjmB,GAAS,IAAD,IAC/BA,EAAOE,QAA1BukF,EADkD,EAClDA,OAAQlnD,EAD0C,EAC1CA,OAChB,aAAItX,EAAMxF,sBAAV,aAAI,EAAsBhe,GAAI,CAAC,IACrBwe,EAAUgF,EAAMxF,eAAhBQ,MADoB,EvL4OzB,SAASy6E,iBACdh2E,EACA++D,EACAvX,GAEA,IAAM+kB,EAAYvsE,EAAM0E,MAAM+M,OAAOoD,WAAU,SAAC7I,GAAD,OAAUA,EAAKjvB,KAAOgiF,KACrE,IAAmB,IAAfwN,EAAkB,CACpB,IAAMr0D,EAAclY,EAAM0E,MAAM+M,OAAO86D,GAAW10D,OAAOhD,WACvD,SAACif,GAAD,OAAOA,EAAE/2C,KAAOyqE,EAAUzqE,MAE5B,IAAqB,IAAjBm7B,EAAoB,CACtB,IAAM+9D,EAAiBj2E,EAAM0E,MAAM+M,OAAO86D,GAAW10D,OAAOK,GAgB5D,MAAO,CAAEiL,QAdE,OAATqkC,QAAS,IAATA,OAAA,EAAAA,EAAW5hE,IAAsB,KAAR,OAAT4hE,QAAS,IAATA,OAAA,EAAAA,EAAW5hE,GACvB4hE,EAAU5hE,EAAIqwF,EAAerwF,EAAEsvB,MAC/B,EAYWgiB,QAVN,OAATswB,QAAS,IAATA,OAAA,EAAAA,EAAW3hE,IAAsB,KAAR,OAAT2hE,QAAS,IAATA,OAAA,EAAAA,EAAW3hE,GACvB2hE,EAAU3hE,EAAIowF,EAAepwF,EAAEqvB,MAC/B,IAWV,MAAO,CAAEiO,OAAQ,EAAG+T,OAAQ,GuLxQC8+C,CACzBz1E,EAAM9gB,KAAK8b,GACXwjE,EACAlnD,GAHMsL,EAFoB,EAEpBA,OAAQ+T,EAFY,EAEZA,OAKZtxB,EAAe,GACJ,IAAXud,GACFvd,EAAQzpB,KAAK,CAAEoZ,KAAM2S,GAAQS,SAAS5rB,GAAIiP,QAASm3B,IAEtC,IAAX+T,GACFtxB,EAAQzpB,KAAK,CAAEoZ,KAAM2S,GAAQU,SAAS7rB,GAAIiP,QAASkrC,IAGrDpF,YAA2BvxB,EAAM9gB,KAAK8b,GAAQqK,GAE9CuxB,YAAY52B,EAAM9gB,KAAK8b,IAEvBuqE,UAAUvlE,GACVwrE,wBAAwBxrE,ISsUfyzE,CAAmCzzE,EAAOjmB,GACnD,KAAK+O,GACH,OT9TN,SAAS6sF,2BAA2B31E,EAAqBjmB,GAAS,IAAD,EACzDD,EAAQo3C,aAASlxB,GACvB,aAAIlmB,EAAM0gB,sBAAV,aAAI,EAAsBhe,GAAI,CAAC,IACrBwe,EAAUlhB,EAAM0gB,eAAhBQ,MADoB,EAEDjhB,EAAOE,QAA1B0wE,EAFoB,EAEpBA,QAAStwE,EAFW,EAEXA,MACX2xF,EAAYH,aAAa/xF,EAAOkhB,EAAO2vD,EAAQnuE,IAC/Co5F,EAAS51E,EAAM9gB,KAAK8b,GAAmBmJ,MAAM+M,OACjD86D,GAEF4J,EAAMt+D,OAAOqzC,EAAQS,cAAczzC,aAAaK,KAAO39B,EACvDu7F,EAAM59D,KAAOhB,GAAqB96B,SAAS7B,GACvC48B,GACAA,GACJu0D,wBAAwBxrE,ISiTfyzE,CAAwCzzE,EAAOjmB,GACxD,KAAK+O,GACH,OAAO2qF,iBAA8BzzE,EAAOjmB,GAC9C,KAAK+O,GACH,OTnPN,SAAS+sF,mBAAmB71E,EAAqBjmB,GAAS,IAAD,EACjDD,EAAQo3C,aAASlxB,GACvB,aAAIlmB,EAAM0gB,sBAAV,aAAI,EAAsBhe,GAAI,CAAC,IACrBwe,EAAUlhB,EAAM0gB,eAAhBQ,MADoB,EAEmBjhB,EAAOE,QAA9CmvC,EAFoB,EAEpBA,SAAU/R,EAFU,EAEVA,MAAO/I,EAFG,EAEHA,KAAMqJ,EAFH,EAEGA,YAEzBq0D,EAAYH,aAAa/xF,EAAOkhB,EAAOouB,EAAS5sC,IAChDo5F,EAAS51E,EAAM9gB,KAAK8b,GAAmBmJ,MAAM+M,OACjD86D,QAEkB5pE,IAAhBuV,EACFi+D,EAAMtnE,GAAM+I,MAAQA,EAEpBu+D,EAAMt+D,OAAOK,GAAarJ,GAAM+I,MAAQA,EAE1Cu+D,EAAMtnE,GAAMuJ,YAAcX,GAAe0+D,EAAOtnE,ISoOvCmlE,CAAgCzzE,EAAOjmB,GAEhD,KAAK+O,GACH,OJ1ZN,SAASo2D,sCAAel/C,EAAqBjmB,GAAS,IAAD,EAChCq6C,kBAASp0B,EAAOjmB,GADgB,mBAC5CiG,EAD4C,KACtCmb,EADsC,KAEnDuxE,eAAgC1sE,EAAM9gB,KAAM8gB,EAAMgW,gBAAiB,CACjEh2B,OACAmb,KACA0B,QAASmD,EAAML,YIqZNm2E,CAAuC91E,EAAOjmB,GACvD,KAAK+O,GACH,OAAOgtF,0BAAkD91E,EAAOjmB,GAClE,KAAK+O,GACH,OJ7YN,SAASitF,yBAAyB/1E,EAAqBjmB,GAAS,IAAD,EAC7BA,EAAOE,QAA/Bq8B,EADqD,EACrDA,UAAWt2B,EAD0C,EAC1CA,KAAMmb,EADoC,EACpCA,GACzBuxE,eAAgC1sE,EAAM9gB,KAAM8gB,EAAMgW,gBAAiB,CACjEh2B,OACAmb,KACA0B,QAASmD,EAAML,UACf2W,cIuYSw/D,CAAiD91E,EAAOjmB,GACjE,KAAK+O,GACH,OAAOgtF,iBAAyC91E,EAAOjmB,GACzD,KAAK+O,GACH,OAAOgtF,mBAA2C91E,EAAOjmB,GAE3D,ID1agB,OC2ad,OGzaN,SAASi8F,kBAAkBh2E,GAAQ,IAAD,EACEA,EAAM0tE,QAAhCC,EADwB,EACxBA,KAAMC,EADkB,EAClBA,QAASC,EADS,EACTA,OACjB57C,EAAW07C,EAAKA,EAAK5uF,OAAS,GAC9Bk3F,EAAUtI,EAAK7vF,MAAM,EAAG6vF,EAAK5uF,OAAS,GACtCm3F,EAAS,CAAItI,GAAJ,oBAAgBC,IAEzBE,EAA+B,IAArBmI,EAAUn3F,OACpB+uF,EAA0B,IAAhBH,EAAK5uF,OAKf+hB,EAASikE,UAAU/kE,EAAM9gB,MAEzBwuF,EAAU,CACdC,KAAMsI,EACNrI,QAAS37C,EACT47C,OAAQqI,EACRnI,UACAD,WAIF9tE,EAAM4B,QAAUd,EAAOc,QACvB5B,EAAMU,QAAUI,EAAOJ,QACvBV,EAAMM,aAAeQ,EACrBd,EAAM0tE,QAAUA,EH+YLsI,CAAkBh2E,GAE3B,ID5agB,OC6ad,OG/YN,SAASm2E,kBAAkBn2E,GAAQ,IACzB0tE,EAAY1tE,EAAZ0tE,QAGF0I,GADO1I,EAAQG,OAAO,GACTH,EAAQG,OAAOn3C,SAClCg3C,EAAQC,KAAK/xF,KAAK8xF,EAAQE,SAC1BF,EAAQE,QAAUwI,EAClB1I,EAAQI,SAAU,EAClBJ,EAAQK,QAAUL,EAAQG,OAAO9uF,OAAS,EAI1CwmF,UAAUvlE,EAAM9gB,MHmYLi3F,CAAkBn2E,GAE3B,ID7aiB,QC8af,OGnYN,SAASq2E,mBAAmBr2E,EAAOjmB,GACjCimB,EAAM0tE,QAAU,CACdC,KAAM,GACNC,QAAS7zF,EACT8zF,OAAQ,GACRE,SAAS,EACTD,SAAS,GH6XAuI,CAAmBr2E,EAAOjmB,GAEnC,KAAK+O,GACH,OIhbN,SAASwtF,mBAAmBt2E,EAAqBu2E,GAC/Cv2E,EAAMo8B,cAAgBm6C,EAAQt8F,QJ+anBu8F,CAAiCx2E,EAAOjmB,GAEjD,QACE,WK7YS08F,I,GAAAA,GAtCf,SAASA,eAAe1gE,GACtB,IAAMvqB,EAAU,SAAVA,QAAW3Q,GAAW,IAAD,EAMrB6M,eAJFxI,EAFuB,EAEvBA,KACAsb,EAHuB,EAGvBA,eACAuH,EAJuB,EAIvBA,cACA6kB,EALuB,EAKvBA,cALuB,EAQH1rC,mBAAQ,WAC5B,GAAIgE,GAAQsb,GAAkBA,EAAehe,GAAI,CAC/C,IAAMwZ,EAAS9W,EAAK43B,MAAK,SAACrX,GAAD,OAAWA,EAAMjjB,KAAOge,EAAehe,MAChE,OAAkB,OAAXwZ,QAA8BoM,IAAXpM,EACtB,CAAEiF,KAAMjF,EAAOiF,KAAMy7E,eAAgB1gF,EAAOjX,QAC5C,GAEN,MAAO,KACN,CAACyb,EAAgBtb,IARZ+b,YARiB,MAQV,GARU,EAkBjBgb,EAA0Bp7B,EAA1Bo7B,aAAiBC,EAlBA,aAkBSr7B,EAlBT,kBAmBzB,OACE,cAACk7B,EAAD,2BACMG,GADN,IAEEjb,KAAMA,EACNT,eAAgBA,EAChBuH,cAAeA,EACf6kB,cAAeA,EACfz7B,IAAK8qB,MAKX,OAAO9b,eACLgc,sBAAW,SAACt7B,EAAOsQ,GACjB,OAAO,cAACK,EAAD,2BAAa3Q,GAAb,IAAoBo7B,aAAc9qB,UC/BzChC,GAAS4C,YAAH,gyBA+CN4qF,GAAoB,CAAC,KAAM,OAEjC,SAASC,eAAT,GAAiE,IAAvCC,EAAsC,EAAtCA,YAAatsF,EAAyB,EAAzBA,QAASusF,EAAgB,EAAhBA,aACxCC,EAAW3rF,mBAEX4rF,EAAmB36F,uBAAY,WAEnC,IAAMi0B,EAAOymE,EAASlqF,QAAQxS,MACxBg3C,E5SxCV,SAAS4lD,wBAAwB3mE,GAC/B,IAAM+gB,EAAO/gB,EAEVztB,QAAQ,YAAa,IACrBse,MAAM,KAET,MAAO,CAAEnM,KAAMq8B,EAAK,GAAGp8B,cAAeiB,UAAWm7B,EAAK,GAAGp8B,e4SkC1CgiF,CAAwB3mE,GACjCqmE,GAAkBz6F,SAASm1C,EAAKn7B,YAClC4gF,I,S5ShESI,S,0C4SiETA,CAAS5mE,GAAMluB,MAAK,SAAClD,GACnB,IAAMqV,EAAO,CACX0B,OAAQ/W,EACR8V,KAAMq8B,EAAKr8B,KACXi8B,SAAU3gB,GAEZumE,EAAYtiF,OAGdsiF,EAAY,QAEb,CAACA,EAAaC,IACjB,OACE,oBAAK/qF,IAAK5C,GAAV,UACE,oBAAKrF,UAAU,gBAAf,UACE,oDAEA,aAAC,GAAD,CAAa7G,QAASsN,OAExB,oBAAKzG,UAAU,YAAf,UACE,sBACEqH,IAAK4rF,EACL/8F,KAAK,OACLq1D,YAAY,+BAEd,uBAAQr1D,KAAK,SAASiD,QAAS+5F,EAA/B,wBAQRJ,eAAe5vF,aAAe,CAC5BmwF,kBAAmB,6BACjB,OAAO,MAET5sF,QAAS,mBACP,OAAO,MAETusF,aAAc,wBACZ,OAAO,OAGIF,I,MAAAA,kBC1ETztF,GAAS4C,YAAH,4YA0BNyvD,GAAazvD,YAAH,yZAwBhB,SAASqrF,aAAT,GAA+D,IAAvCn8E,EAAsC,EAAtCA,KAAM8G,EAAgC,EAAhCA,cAAe6kB,EAAiB,EAAjBA,cACrC5rC,EAAW6M,cACXgoB,EAAc7nB,iBACdxF,EAAQ+3C,KACR5tC,EAAQzD,IAJ8C,EAgBxD8xC,kBAAkBhgD,EAAUwH,GAV9B24C,EAN0D,EAM1DA,UACAF,EAP0D,EAO1DA,oBACAY,EAR0D,EAQ1DA,iBACAC,EAT0D,EAS1DA,iBACAH,EAV0D,EAU1DA,kBACAC,EAX0D,EAW1DA,kBACAH,EAZ0D,EAY1DA,uBACAO,EAb0D,EAa1DA,0BACAD,EAd0D,EAc1DA,4BACAE,EAf0D,EAe1DA,gCAGIo7C,EAAoB,aAAKp0E,WAAW,EAAOC,OAAO,GAAUjI,GAE5Dq8E,EAAmBj7F,uBACvB,SAACkY,GACKA,GACFvZ,EAAS,CAAEhB,KAAM0U,GAAiBqI,MAAO,CAACxC,KAC1C5H,EAAMkB,SAENrL,EAAM0rC,MAAM,4DAGhB,CAAC1rC,EAAOxH,EAAU2R,IAGd4qF,EAAsBl7F,uBAAY,WACtCsQ,EAAMkB,QACN7S,EAAS,CAAEhB,KAAM8X,GAAkB6E,WAAW,MAC7C,CAAC3b,EAAU2R,IAER6qF,EAAkBn7F,uBAAY,WAClCsQ,EAAMvQ,KACJ,aAAC,GAAD,CACEy6F,YAAaS,EACb/sF,QAAS,0BAAMoC,EAAMkB,SACrBipF,aAAcS,IAEhB,MAED,CAACD,EAAkB3qF,EAAO4qF,IAEvBE,EAAkBp7F,uBACtB,SAACJ,GACC,OAAQuhB,IAAUqS,EAAD,iCAAwC5zB,MAE3D,CAAC4zB,IAEG6nE,EAA8Br7F,uBAAY,WAC9Cia,GAAYzJ,QAAQvC,SACnB,IAEH,OACE,aAAC,WAAD,WACGmtF,EAAgB,eACf,aAAC,GAAD,CACEj6F,MAAO2L,GACPrF,UAAU,KACVoJ,UAAW,aAAC,KAAD,IACXqsD,QAAQ,SAJV,UAME,uBACEv/D,KAAK,SACL+R,IAAKyvD,GACLv+D,QAASy6F,EAHX,UAKE,aAAC,KAAD,IACA,6DAEF,uBAAQ19F,KAAK,SAAS+R,IAAKyvD,GAAYv+D,QAASu6F,EAAhD,UACE,aAAC,KAAD,IACA,8DAILC,EAAgB,iBACf,aAAC,GAAD,CACEj6F,MAAO2L,GACPrF,UAAU,KACVoJ,UAAW,aAAC,KAAD,IACXqsD,QAAQ,YAJV,UAME,uBAAQv/D,KAAK,SAAS+R,IAAKyvD,GAAYv+D,QAAS4+C,EAAhD,UACE,aAAC,KAAD,IACA,mDAEF,uBAAQ7hD,KAAK,SAAS+R,IAAKyvD,GAAYv+D,QAAS6+C,EAAhD,UACE,aAAC,KAAD,IACA,mDAEF,uBAAQ9hD,KAAK,SAAS+R,IAAKyvD,GAAYv+D,QAAS0+C,EAAhD,UACE,aAAC,KAAD,IACA,kEAEF,uBAAQ3hD,KAAK,SAAS+R,IAAKyvD,GAAYv+D,QAAS2+C,EAAhD,UACE,aAAC,KAAD,IACA,qDAEF,uBACE5hD,KAAK,SACL+R,IAAKyvD,GACLv+D,QAASw+C,EAHX,UAKE,aAAC,KAAD,IACA,mFAKL7U,IAAkBN,GAAeC,OAChCkxD,EAAgB,+BACd,uBACEz9F,KAAK,SACL+R,IAAK5C,GACLrF,UAAU,WACV7G,QAAS8+C,EAJX,SAME,aAAC,GAAD,CAAS7iC,MAAM,oBAAoBD,eAAe,QAAlD,SACIkiC,EAAwC,aAAC,KAAD,IAA5B,aAAC,KAAD,QAIrBvU,IAAkBN,GAAeC,OAChCkxD,EAAgB,sBAChBJ,GACAA,EAAqBp0E,WACnB,uBACElX,IAAK5C,GACLrF,UAAU,WACV9J,KAAK,SACLiD,QAAS++C,EAJX,SAME,aAAC,GAAD,CACE9iC,MACE+hC,EAAsB,gBAAkB,qBAE1ChiC,eAAe,QAJjB,SAME,aAAC,KAAD,QAIP2tB,IAAkBN,GAAeC,OAChCkxD,EAAgB,gCACd,uBACE1rF,IAAK5C,GACLrF,UAAU,WACV9J,KAAK,SACLiD,QAASg/C,EAJX,SAME,aAAC,GAAD,CACE/iC,MACG6I,EAAcE,KAA4B,mBAArB,mBAExBhJ,eAAe,QAJjB,SAMI8I,EAAcE,KAGd,aAAC,KAAD,IAFA,aAAC,KAAD,WAWDw0E,I,MAAAA,MAAet8E,eAAKi9E,eC/P7BjuF,GAAS4C,YAAH,iNAaN4rF,GAAe5rF,YAAH,wFAKlB,SAAS2lD,0BAAT,GAYI,IAXFt2D,EAWC,EAXDA,SACAf,EAUC,EAVDA,MACA8D,EASC,EATDA,SACApC,EAQC,EARDA,SACAm4B,EAOC,EAPDA,SACApwB,EAMC,EANDA,UACAtG,EAKC,EALDA,MACAszB,EAIC,EAJDA,UACA/zB,EAGC,EAHDA,aACAC,EAEC,EAFDA,aACA0tD,EACC,EADDA,OACC,EAC2BtmD,mBAASrI,GADpC,mBACM+vD,EADN,KACc8rC,EADd,KAEKC,EAAex7F,uBAAY,WAC/B,IAAMy7F,GAAahsC,EACnB8rC,EAAUE,GAER5jE,EADE4jE,EACOz9F,EAEA,QAEV,CAACyxD,EAAQ53B,EAAU75B,IAMtB,OAJAyB,qBAAU,WACR87F,EAAU77F,KACT,CAACA,IAEC+0B,EAIH,uBACE92B,KAAK,SACLiD,QAAS46F,EACT9rF,IAAK,CAAC5C,GAAQ2iD,GAAU6rC,IACxBn6F,MAAOA,EACPsG,UAAiB,WAAOA,EAAbgoD,EAAM,gBACjB3tD,SAAUA,EACVpB,aAAcA,EACdC,aAAcA,EACd2tD,cAAaD,EATf,SAWGr8C,uBAAajT,EAAU,CAAEoC,MAAO,CAAEqb,SAAU,YAdxC,KAkBX64C,0BAAaqmC,YAAc,eAE3BrmC,0BAAa1qD,aAAe,CAC1BjL,UAAU,EACVoC,UAAU,EACV2yB,WAAW,EACXz2B,MAAO,KACPyJ,UAAW,GACXowB,SAAU,SAAS,WACjB,OAAO,MAET8jE,aAAc,SAAS,eACrB,OAAO,OAIItmC,iCC5ETl0D,GAAQ,CAAEkM,QAAS,OAAQO,cAAe,UAEhD,SAASguF,kBAAT,GAA2D,IAA9B78F,EAA6B,EAA7BA,SAAUf,EAAmB,EAAnBA,MAAO65B,EAAY,EAAZA,SAAY,EACd9vB,mBAAS,IADK,mBACjD8zF,EADiD,KAClCC,EADkC,KAElDC,EAAiB/7F,uBACrB,SAAC2qB,GACC,IACMqxE,EADQ,aAAOH,GACIziF,KAAI,SAAC8jB,GAC5B,MAAO,CACLl/B,MAAOk/B,EAAOl/B,MACd0B,SAAUw9B,EAAOl/B,QAAU2sB,MAG/BmxE,EAAiBE,GACjBnkE,EAASlN,KAEX,CAACkN,EAAUgkE,IAGPtrC,EAAiB1xD,mBAAQ,WAC7B,IAAI8f,EAAQ,EACZ,OAAOsjC,WAAS7oC,IAAIra,GAAU,SAACmjD,GAC7B,GAAIA,EAAO,CACT,GAA+B,iBAA3BA,EAAMvkD,KAAK+9F,YAAgC,CAC7C,IAAMO,EAASjqF,uBAAakwC,EAAO,CACjCrqB,SAAUkkE,EACVr8F,SACEm8F,EAAcl9E,IACdk9E,EAAcl9E,GAAOjf,UACrBm8F,EAAcl9E,GAAOjf,SACvBif,UAGF,OADAA,IACOs9E,EAEP,OAAOjqF,uBAAakwC,SAIzB,CAACnjD,EAAUg9F,EAAgBF,IAc9B,OAZAp8F,qBAAU,WACR,IAAMkrB,EAAMs3B,WAAS7oC,IAAIra,GAAU,SAACmjD,GAClC,GAAIA,GAAoC,iBAA3BA,EAAMvkD,KAAK+9F,YACtB,MAAO,CACL19F,MAAOkkD,EAAM1jD,MAAMR,MACnB0B,SAAUwiD,EAAM1jD,MAAMR,QAAUA,MAItC89F,EAAiBnxE,KAChB,CAAC5rB,EAAUf,IAEP,sBAAKmD,MAAOA,GAAZ,cAAqBovD,EAArB,OAGTqrC,kBAAkBjxF,aAAe,CAC/BktB,SAAU,SAAS,WACjB,OAAO,OAGI+jE,I,GAAAA,qBCxCT9uF,GAAS4C,YAAH,ycA8BZ,SAASwsF,gBAAT,GAKI,IAJFx6E,EAIC,EAJDA,aACAvD,EAGC,EAHDA,eACAS,EAEC,EAFDA,KACA2rB,EACC,EADDA,cACC,EAC2BxiC,qBAD3B,mBACMo0F,EADN,KACcC,EADd,KAEKx3C,EAAOjiB,UACPx8B,EAAQ+3C,KACR1qB,EAAc7nB,iBAEdhN,EAAW6M,cAEXwvF,EAAuB,CAC3Bp8E,KAAK,aAAGgI,WAAW,EAAOC,OAAO,GAAUjI,IAT5C,EAWiD+/B,kBAChDhgD,EACAwH,GAFM+4C,EAXP,EAWOA,mBAAoBC,EAX3B,EAW2BA,kBAKtB7nB,EAAet3B,uBACnB,SAACq8F,GACCD,EAAUC,GACVn9C,EAAmBm9C,KAErB,CAACn9C,IAGHz/C,qBAAU,WACR28F,EAAU16E,KACT,CAACA,IAEJ,IAAM46E,EAAoBt8F,uBAAY,WACpCrB,EAAS,CACPhB,KAAMmX,GACN9W,MAAO,KAETW,EAAS,CAAEhB,KAAMwV,GAAqBy4E,eAAgB,SACrD,CAACjtF,IAEEy8F,EAAkBp7F,uBACtB,SAACJ,GACC,OAAQuhB,IAAUqS,EAAD,iCAAwC5zB,MAE3D,CAAC4zB,IAGH,OACE,oBAAK9jB,IAAK5C,GAAV,UACE,aAAC,GAAD,CAAmB9O,MAAOm+F,EAAQtkE,SAAUP,EAA5C,UACG8jE,EAAgB,iBACf,aAAC,GAAD,yBAEEp9F,MAAOoR,GAAQ6c,KAAK9rB,IAChBykD,EAAKnkD,SAHX,IAIE4tD,OAAO,SACP5mD,UAAU,KALZ,SAOE,aAAC,GAAD,CACEoV,MAAK,UAAKzN,GAAQ6c,KAAKC,MAAlB,gBACLtP,eAAe,QACfzM,OAAQ,CAAEnH,EAAG,GAAIC,EAAG,GACpB9H,MAAO,CAAEkM,QAAS,QAJpB,SAME,aAAC,KAAD,QAZG+B,GAAQ6c,KAAK9rB,IAiBrBi7F,EAAgB,oBACf,uBAAQ3zF,UAAU,KAAK9J,KAAK,SAASiD,QAASu+C,EAA9C,SACE,aAAC,GAAD,CACEtiC,MAAM,+FACND,eAAe,QAFjB,SAIE,aAAC,KAAD,QAKL2tB,IAAkBN,GAAeC,OAChCkxD,EAAgB,iBACd,aAAC,GAAD,yBAEEp9F,MAAOoR,GAAQid,YAAYlsB,GAC3BsH,UAAU,WACVgtB,UACEtW,GACA68E,IACCA,EAAqBp8E,KAAKiI,OAEzB+9B,EAAKnkD,SATX,IAUE4tD,OAAO,cAVT,SAYE,aAAC,GAAD,CACExxC,MAAK,UAAKzN,GAAQid,YAAYH,MAAzB,gBACLtP,eAAe,QACfzM,OAAQ,CAAEnH,EAAG,GAAIC,EAAG,GAHtB,SAKE,aAAC,KAAD,QAhBGmG,GAAQid,YAAYlsB,IAoB9BoqC,IAAkBN,GAAeC,OAChCkxD,EAAgB,qBACd,aAAC,GAAD,yBAEEp9F,MAAOoR,GAAQkd,SAASnsB,GACxBsH,UAAU,WACVgtB,UACEtW,GACA68E,IACCA,EAAqBp8E,KAAKiI,OAEzB+9B,EAAKnkD,SATX,IAUE4tD,OAAO,kBAVT,SAYE,aAAC,GAAD,CACExxC,MAAK,UAAKzN,GAAQkd,SAASJ,MAAtB,gBACLtP,eAAe,QACfzM,OAAQ,CAAEnH,EAAG,GAAIC,EAAG,GAHtB,SAKE,aAAC,KAAD,QAhBGmG,GAAQkd,SAASnsB,IAoB3BoqC,IAAkBN,GAAeE,OAChCixD,EAAgB,qBACd,aAAC,GAAD,CAEEp9F,MAAOoR,GAAQmd,OAAOpsB,GACtBsH,UAAU,KACVgtB,UAAWtW,EAJb,SAME,aAAC,GAAD,CACEtB,MAAK,UAAKzN,GAAQmd,OAAOL,MAApB,iBACLtP,eAAe,QACfzM,OAAQ,CAAEnH,EAAG,GAAIC,EAAG,GAHtB,SAKE,aAAC,KAAD,OAVGmG,GAAQmd,OAAOpsB,IAczBoqC,IAAkBN,GAAeE,OAChC,aAAC,GAAD,CAEEnsC,MAAOoR,GAAQod,YAAYrsB,GAC3BgB,MAAO2L,GAAO2nE,KACdhgD,UAAWtW,EAJb,SAME,aAAC,GAAD,CACEtB,MAAK,UAAKzN,GAAQod,YAAYN,OAC9BtP,eAAe,QACfzM,OAAQ,CAAEnH,EAAG,GAAIC,EAAG,GAHtB,mBALKmG,GAAQod,YAAYrsB,IAc5BoqC,IAAkBN,GAAeC,OAChCkxD,EAAgB,uBACd,aAAC,GAAD,CAEEp9F,MAAOoR,GAAQud,cAAcxsB,GAC7BsH,UAAU,WACVgtB,UACEtW,GACA68E,IACCA,EAAqBp8E,KAAKiI,MAP/B,SAUE,aAAC,GAAD,CACEhK,MAAOzN,GAAQud,cAAcT,MAC7BtP,eAAe,QACfzM,OAAQ,CAAEnH,EAAG,GAAIC,EAAG,GAHtB,SAKE,aAAC,KAAD,OAdGmG,GAAQud,cAAcxsB,IAkBhCoqC,IAAkBN,GAAeC,OAChCkxD,EAAgB,oCACd,aAAC,GAAD,CAEEp9F,MAAOoR,GAAQ2d,wBAAwB5sB,GACvCsH,UAAU,WAHZ,SAKE,aAAC,GAAD,CACEoV,MAAOzN,GAAQ2d,wBAAwBb,MACvCtP,eAAe,QACfzM,OAAQ,CAAEnH,EAAG,GAAIC,EAAG,GAHtB,SAKE,aAAC,KAAD,OATGmG,GAAQ2d,wBAAwB5sB,IAa1CoqC,IAAkBN,GAAeC,OAChCkxD,EAAgB,wBACd,aAAC,GAAD,CAEEp9F,MAAOoR,GAAQ0c,YAAY3rB,GAC3BsH,UAAU,WACVgtB,UACEumE,GACA1vE,GAAQQ,YAAYvF,aAAay0E,GANrC,SASE,aAAC,GAAD,CACEn+E,MAAOzN,GAAQ0c,YAAYI,MAC3BtP,eAAe,QACfzM,OAAQ,CAAEnH,EAAG,GAAIC,EAAG,GAHtB,SAKE,aAAC,KAAD,OAbGmG,GAAQ0c,YAAY3rB,IAiB9BoqC,IAAkBN,GAAeC,OAChCkxD,EAAgB,4BACd,aAAC,GAAD,CAEEp9F,MAAOoR,GAAQuc,gBAAgBxrB,GAC/BsH,UAAU,WACVtG,MAAO2L,GAAO2nE,KACdhgD,UACEtW,GACA68E,GACA1vE,GAAQK,gBAAgBpF,aAAay0E,GARzC,SAWE,aAAC,GAAD,CACEn+E,MAAOzN,GAAQuc,gBAAgBO,MAC/BtP,eAAe,QACfzM,OAAQ,CAAEnH,EAAG,GAAIC,EAAG,GAHtB,SAKE,aAAC,KAAD,OAfGmG,GAAQuc,gBAAgBxrB,IAoBlCoqC,IAAkBN,GAAeC,OAChCkxD,EAAgB,+BACd,aAAC,GAAD,CAEEp9F,MAAOoR,GAAQwd,mBAAmBzsB,GAClCsH,UAAU,WACVgtB,UACEtW,GACA68E,GACA1vE,GAAQE,mBAAmBjF,aAAay0E,GAP5C,SAUE,aAAC,GAAD,CACEn+E,MAAOzN,GAAQwd,mBAAmBV,MAClCtP,eAAe,QACfzM,OAAQ,CAAEnH,EAAG,GAAIC,EAAG,GAHtB,SAKE,aAAC,KAAD,OAdGmG,GAAQwd,mBAAmBzsB,OAoBvCoqC,IAAkBN,GAAeC,OAChCkxD,EAAgB,gBAChBJ,GACA1vE,GAAQI,IAAInF,aAAay0E,IACvB,uBACEvzF,UAAU,WACV9J,KAAK,SACLiD,QAAS07F,EAHX,SAKE,aAAC,GAAD,CACEz/E,MAAK,aACLD,eAAe,QACfzM,OAAQ,CAAEnH,EAAG,GAAIC,EAAG,GAHtB,SAKE,aAAC,KAAD,WAQCmxF,UAAet8E,eAAKo+E,kBAEnCA,gBAAgBvxF,aAAe,CAC7B+W,aAActS,GAAQ6c,KAAK9rB,ICvV7B,IAAM2M,GAAS,CACbO,QAAS,OACTO,cAAe,SACfL,WAAY,QACZ6vE,YAAa,uBACb1lD,aAAc,MACdo6B,UAAW,OACXztD,OAAQ,QAEV,SAASk4F,QAAT,GAAoC,IAAjB/uE,EAAgB,EAAhBA,aACjB,OACE,sBAAKrsB,MAAK,eAAO2L,IAAjB,UACE,cAAC,GAAD,CAAiB4U,aAAc8L,IAE/B,cAAC,GAAD,OAKS1P,I,GAAAA,kBAAKy+E,SCsCdC,GAGF,CACFz7F,UAAW,CACTK,SAAU,WACViD,OAAQ,QAEVo4F,QAAS,CACPr4F,MAAO,GACPgJ,gBAAiB,UACjB6E,OAAQ,aAEVyqF,KAAM,CAAEntF,SAAU,WAGdotF,GAAkBjtF,YAAH,6gEAmHrB,SAASktF,OAAT,GAMiB,IALTC,EAKQ,EALdh6F,KACAi6F,EAIc,EAJdA,aACAC,EAGc,EAHdA,YACAvpE,EAEc,EAFdA,YAEc,IADdvX,kBACc,MADDT,kBACC,EACRu7C,EAAUhoD,iBAAuB,MACjCoO,EAAoBpO,iBAAuB,MAFnC,EAGSiuF,aAAU,GAHnB,mBAGPj9F,EAHO,KAGDm9B,EAHC,KAIRsxB,EAAeyuC,YAAclmC,EAASh3D,EAAM,CAChDmO,QAAS,mBACPgvB,GAAO,MANG,EAS6Bn1B,oBAAS,GATtC,mBASPm1F,EATO,KASWC,EATX,OAUoCp1F,oBAAS,GAV7C,mBAUPq1F,EAVO,KAUaC,EAVb,OAWkBt1F,mBAASu1F,IAX3B,mBAWPC,EAXO,KAWGC,EAXH,OAaY/+F,qBACxBuzF,GACA9qF,IAfY,mBAaPzJ,EAbO,KAaAkB,EAbA,OAiBkCF,qBAC9CsmD,mBACAjC,IAnBY,mBAiBP26C,EAjBO,KAiBWC,EAjBX,KAsBNlwE,EAAmD/vB,EAAnD+vB,aAAc+c,EAAqC9sC,EAArC8sC,cAAqB9N,EAAgBh/B,EAAtBoF,KAErCpD,qBAAU,WACJ4lF,GAAgB5nF,EAAMy0F,cACZ,OAAZ4K,QAAY,IAAZA,KAAer/F,MAEhB,CAACq/F,EAAcr/F,IAElB,IAAMkgG,EAAqB9+F,mBAAQ,WACjC,OAAO8yF,mBAAmBhzF,KACzB,IAEHc,qBAAU,WAAO,IAAD,EACd,UAAAs3D,EAAQvmD,eAAR,SAAiBmpE,UAChB,CAACnrB,IAEJ/uD,qBAAU,WACRi+F,EAAoB,CAClB//F,KAAMglD,GACN/kD,QAAS,CAAEyP,QAASmmB,EAAa70B,SAAU++F,OAE5C,CAAClqE,IAEJ/zB,qBAAU,WACRk+F,EAAmB,CAAEhgG,KAAM8X,GAAkB6E,WAAW,IACxDqjF,EAAmB,CAAEhgG,KAAMwU,GAAUvU,QAASi/F,MAC7C,CAACA,EAAUc,IAEdl+F,qBAAU,YhMvPL,SAASm+F,WAAWC,GACzBj9C,GAAUi9C,EgMuPRD,CAAWb,GACXS,EAAYF,QACX,CAACP,IAEJ,IAAMe,EAA+B99F,uBACnC,SAAC4qB,GACKA,IAASsyE,IACXG,GAAoB,GACpB1+F,EAAS,CAAEhB,KAAMqV,GAAW5O,MAAOwmB,OAGvC,CAACsyE,IAGGv5D,EAAkB9kC,mBAAQ,WAC9B,OAAOsiB,IACLs8E,EACA,oCACA,KAED,CAACA,IAEEM,EAAoB/9F,uBAAY,SAACM,GACrCA,EAAEE,kBACF28F,GAAe,SAACa,GAAD,OAAeA,OAC7B,IAEGC,EAA4Bj+F,uBAAY,SAACM,GACxCwG,0BAA0BxG,IAC7BA,EAAEC,mBAEH,IACG4hC,EAAoBniC,uBAAY,WACpC29F,EAAmB,CAAEhgG,KAAMsa,GAA0Bra,SAAS,MAC7D,CAAC+/F,IACEzyF,EAAoBlL,uBAAY,WACpC29F,EAAmB,CAAEhgG,KAAMsa,GAA0Bra,SAAS,MAC7D,CAAC+/F,IAEJ,OACE,aAAC,GAAD,UACE,aAACxhF,GAAD,CACEne,MAAO,CACL+4D,QAASA,EAAQvmD,QACjB2M,kBAAmBA,EAAkB3M,SAHzC,SAME,aAAC9E,EAAD,CAAqB1N,MAAOy/F,EAA5B,SACE,oBACE/8F,aAAcyhC,EACdxhC,aAAcuK,EACd/J,MAAO,CAAEkD,OAAQ,OAAQjD,SAAU,YAHrC,SAME,aAAC,GAAD,CACEyB,KAAM06F,EACNntF,WAAY+M,EAAkB3M,QAC9BmzB,gBAAiBA,EAHnB,SAME,aAAC,GAAD,CAAevzB,WAAY+M,EAAkB3M,QAA7C,SACE,aAACjF,EAAD,CAAkBvN,MAAO2/F,EAAzB,SACE,aAACvyF,EAAD,CAAmBpN,MAAK,2BAAOP,GAAP,IAAc2/F,uBAAtC,SACE,aAAC,GAAD,CAAehtF,WAAY+M,EAAkB3M,QAA7C,SACE,aAAC,KAAD,UACE,aAACgsB,mBAAD,CAAoBC,YAAaA,EAAjC,SACE,aAAC/gB,GAAD,CAAiB1d,MAAOie,EAAxB,SACE,oBACEnN,IAAKioD,EACLrnD,IAAKitF,GACLhlC,cAAesmC,EAHjB,UAKE,aAAC,GAAD,IAEA,aAAC,GAAD,CACEzvC,aAAcA,EACdC,WAAYvxB,IAGd,oBACE/7B,MAAO,CACLkD,OAAQ,oBACRD,MAAO,OACPgJ,gBAAiB,SAJrB,SAOE,aAAC,GAAD,WACE,aAAC,GAAD,CAASogB,aAAcA,IACvB,aAAC,IAAD,CACErsB,MAAOq7F,GAAgBz7F,UACvBm9F,aAAc1B,GAAgBC,QAC9B0B,UAAW3B,GAAgBE,KAC3B0B,WACElB,EACI,CACExxC,SAAU,OACVtnD,MAAO,qBAET,CAAEsnD,SAAU,OAElB5mC,MAAM,WACNu5E,YACEnB,EACI,MACA,qBAENoB,QAAQ,MACRC,eACET,EAEFU,qBAAsBT,EACtBU,cAAe,yBACbpB,GAAoB,IAxBxB,UA2BG9yD,IAAkBN,GAAeC,MAChC,aAAC,GAAD,IAEA,aAAC,GAAD,IAEAgzD,EAKE,KAJF,aAAC,GAAD,CACE1vE,aAAcA,EACd+c,cAAeA,YAMzB,oBACEz7B,IAAKqO,EAELhd,GAAG,eACHgB,MAAO,CACLC,SAAU,WACVC,cAAe,OACfmM,OAAQ,EACRL,KAAM,EACNF,MAAO,EACPD,IAAK,EACLE,OAAQ,IATL1N,OAAOgvD,+BAgE5CouC,OAAOjyF,aAAe,CACpBoyF,YAAa,iCACbD,aAAc,+BAAM,MACpBtpE,YAAa,CACXkU,QAAS,CACPO,0BAA0B,EAC1B+a,wBAAwB,GAG1BC,OAAQ,CACNC,kBAAkB,EAClBC,sBAAsB,EACtBC,gBAAgB,EAChBC,oBAAoB,EACpBC,iBAAiB,EACjBC,qBAAqB,EACrBC,kBAAkB,EAClBC,gBAAgB,EAChBC,kBAAkB,EAClBC,kCAAkC,GAGpCC,eAAgB,CACdC,cAAc,EACdC,iBAAiB,EACjBC,YAAY,EACZC,cAAc,EACdC,4BAA4B,EAC5BC,6BAA6B,EAC7BC,mBAAmB,EACnBC,cAAc,EACdC,kBAAkB,EAClBC,oBAAoB,EACpBC,qBAAqB,EACrBC,yBAAyB,EACzBC,4BAA4B,EAC5BC,aAAa,EACbC,iCAAiC,KAKxB7mC,mBAAK8+E","file":"static/js/1.9847aad3.chunk.js","sourcesContent":["import {\n  createContext,\n  useReducer,\n  useMemo,\n  useContext,\n  useCallback,\n  useEffect,\n} from 'react';\n\nexport const TYPES = {\n  PEAK: 'PEAK',\n  INTEGRAL: 'INTEGRAL',\n  RANGE: 'RANGE',\n  ZONE: 'ZONE',\n};\n\nconst highlightContext = createContext();\n\nfunction highlightReducer(state, action) {\n  switch (action.type) {\n    case 'SHOW': {\n      const { convertedHighlights, type } = action.payload;\n      const newState = {\n        ...state,\n        highlights: { ...state.highlights },\n        type,\n      };\n      for (const value of convertedHighlights) {\n        if (!(value in newState.highlights)) {\n          newState.highlights[value] = 1;\n        }\n      }\n      newState.highlighted = Object.keys(newState.highlights);\n\n      return newState;\n    }\n    case 'HIDE': {\n      const { convertedHighlights } = action.payload;\n\n      const newState = {\n        ...state,\n        highlights: { ...state.highlights },\n        type: null,\n      };\n      for (const value of convertedHighlights) {\n        if (value in newState.highlights) {\n          delete newState.highlights[value];\n        }\n      }\n      newState.highlighted = Object.keys(newState.highlights);\n      return newState;\n    }\n    case 'SET_PERMANENT': {\n      const newState = {\n        ...state,\n        // allow just one permanent highlights group at same time\n        highlightedPermanently: action.payload,\n      };\n\n      return newState;\n    }\n    case 'UNSET_PERMANENT': {\n      const newState = {\n        ...state,\n        highlightedPermanently: [],\n      };\n\n      return newState;\n    }\n    default: {\n      throw new Error(`unknown action type: ${action.type}`);\n    }\n  }\n}\n\nconst emptyState = {\n  highlights: {},\n  highlighted: [],\n  highlightedPermanently: [],\n  type: null,\n};\n\nexport function HighlightProvider(props) {\n  const [highlight, dispatch] = useReducer(highlightReducer, emptyState);\n  const contextValue = useMemo(() => ({ highlight, dispatch }), [highlight]);\n  return (\n    <highlightContext.Provider value={contextValue}>\n      {props.children}\n    </highlightContext.Provider>\n  );\n}\n\nexport function useHighlightData() {\n  return useContext(highlightContext);\n}\n\nexport function useHighlight(highlights, type = null) {\n  if (!Array.isArray(highlights)) {\n    throw new Error('highlights must be an array');\n  }\n\n  const context = useHighlightData();\n\n  const convertedHighlights = useMemo(() => {\n    const newHighlights = [];\n    for (const highlight of highlights) {\n      if (typeof highlight !== 'string' && typeof highlight !== 'number') {\n        throw new Error(`highlight key must be a string or number`);\n      }\n      if (highlight !== '') {\n        newHighlights.push(String(highlight));\n      }\n    }\n    return newHighlights;\n  }, [highlights]);\n\n  useEffect(() => {\n    // if deletion of component then also delete its highlight information -> componentWillUnmount\n    return () => {\n      context.dispatch({\n        type: 'HIDE',\n        payload: { convertedHighlights },\n      });\n      context.dispatch({\n        type: 'UNSET_PERMANENT',\n      });\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  const isActive = useMemo(() => {\n    return context.highlight.highlighted.some((key) =>\n      convertedHighlights.includes(key),\n    );\n  }, [context.highlight.highlighted, convertedHighlights]);\n\n  const isActivePermanently = useMemo(() => {\n    return context.highlight.highlightedPermanently.some((key) =>\n      convertedHighlights.includes(key),\n    );\n  }, [context.highlight.highlightedPermanently, convertedHighlights]);\n\n  const show = useCallback(() => {\n    context.dispatch({\n      type: 'SHOW',\n      payload: {\n        convertedHighlights,\n        type,\n      },\n    });\n  }, [context, convertedHighlights, type]);\n\n  const hide = useCallback(() => {\n    context.dispatch({\n      type: 'HIDE',\n      payload: {\n        convertedHighlights,\n      },\n    });\n  }, [context, convertedHighlights]);\n\n  const add = useCallback(\n    (id) => {\n      context.dispatch({\n        type: 'SHOW',\n        payload: { convertedHighlights: [], id },\n      });\n    },\n    [context],\n  );\n\n  const remove = useCallback(\n    (id) => {\n      context.dispatch({\n        type: 'HIDE',\n        payload: { convertedHighlights: [], id },\n      });\n    },\n    [context],\n  );\n\n  const click = useCallback(\n    (e) => {\n      if (e) {\n        e.preventDefault();\n        e.stopPropagation();\n      }\n\n      if (!isActivePermanently) {\n        context.dispatch({\n          type: 'SET_PERMANENT',\n          payload: convertedHighlights,\n        });\n      } else {\n        context.dispatch({\n          type: 'UNSET_PERMANENT',\n        });\n      }\n    },\n    [context, convertedHighlights, isActivePermanently],\n  );\n\n  const onHover = {\n    onMouseEnter: show,\n    onMouseLeave: hide,\n  };\n\n  const onClick = {\n    onClick: click,\n  };\n\n  return {\n    isActive,\n    show,\n    hide,\n    onHover,\n    onClick,\n    isActivePermanently,\n    click,\n    add,\n    remove,\n  };\n}\n","/* eslint-disable default-param-last */\nimport { saveAs } from 'file-saver';\n\nfunction copyFormattedHtml(html) {\n  // Create an iframe (isolated container) for the HTML\n  let container = document.createElement('div');\n  container.innerHTML = html;\n\n  // Hide element\n  container.style.position = 'fixed';\n  container.style.pointerEvents = 'none';\n  container.style.opacity = 0;\n\n  // Detect all style sheets of the page\n  let activeSheets = Array.prototype.slice\n    .call(document.styleSheets)\n    .filter(function (sheet) {\n      return !sheet.disabled;\n    });\n\n  // Mount the iframe to the DOM to make `contentWindow` available\n  document.body.appendChild(container);\n\n  // Copy to clipboard\n  window.getSelection().removeAllRanges();\n\n  let range = document.createRange();\n  range.selectNode(container);\n  window.getSelection().addRange(range);\n\n  document.execCommand('copy');\n  for (let i = 0; i < activeSheets.length; i++) {\n    activeSheets[i].disabled = true;\n  }\n  document.execCommand('copy');\n  for (let i = 0; i < activeSheets.length; i++) {\n    activeSheets[i].disabled = false;\n  }\n\n  // Remove the iframe\n  document.body.removeChild(container);\n}\n\nasync function copyHTMLToClipboard(data) {\n  try {\n    copyFormattedHtml(data);\n    return true;\n  } catch (err) {\n    return false;\n  }\n}\nasync function copyTextToClipboard(data) {\n  try {\n    await navigator.clipboard.writeText(data);\n    return true;\n  } catch (err) {\n    return false;\n  }\n}\n/**\n * export the experiments result in JSON format\n * @param {*} data\n */\nfunction exportAsJSON(data, fileName = 'experiment', spaceIndent) {\n  const fileData = JSON.stringify(\n    data,\n    (key, value) => (ArrayBuffer.isView(value) ? Array.from(value) : value),\n    spaceIndent,\n  );\n  const blob = new Blob([fileData], { type: 'text/plain' });\n  saveAs(blob, `${fileName}.nmrium`);\n}\nfunction exportAsNMRE(data, fileName = 'experiment') {\n  const fileData = JSON.stringify(\n    data,\n    (key, value) => (ArrayBuffer.isView(value) ? Array.from(value) : value),\n    0,\n  );\n  const blob = new Blob([fileData], { type: 'text/plain' });\n  saveAs(blob, `${fileName}.nmrium`);\n}\n\nfunction exportAsMol(data, fileName = 'mol') {\n  const blob = new Blob([data], { type: 'text/plain' });\n  saveAs(blob, `${fileName}.mol`);\n}\n/**\n * export the vitalization result as SVG, if you need to remove some content during exportation process enclose the the content with <!-- export-remove --> ${content} <!-- export-remove -->\n */\nfunction exportAsSVG(fileName = 'experiment', elementID) {\n  const { blob } = getBlob(elementID);\n  saveAs(blob, `${fileName}.svg`);\n}\n\nfunction exportAsPng(fileName = 'experiment', elementID) {\n  const { blob, width, height } = getBlob(elementID);\n  try {\n    let canvas = document.createElement('canvas');\n    canvas.width = width;\n    canvas.height = height;\n    let context = canvas.getContext('2d');\n    context.fillStyle = 'white';\n    context.fillRect(0, 0, canvas.width, canvas.height);\n    let img = new Image();\n    let url = URL.createObjectURL(blob);\n    img.onload = async function () {\n      context.drawImage(img, 0, 0);\n      let png = canvas.toDataURL('image/png', 1);\n      saveAs(png, `${fileName}.png`);\n      URL.revokeObjectURL(png);\n    };\n    img.src = url;\n  } catch (e) {\n    // eslint-disable-next-line no-console\n    console.log(e);\n  }\n}\n\nfunction copyDataURLCliboard(image) {\n  const img = document.createElement('img');\n  img.src = image;\n\n  img.style.position = 'fixed';\n  img.style.pointerEvents = 'none';\n  img.style.opacity = 0;\n\n  document.body.appendChild(img);\n  const range = document.createRange();\n  range.selectNode(img);\n  window.getSelection().addRange(range);\n  document.execCommand('Copy');\n  document.body.removeChild(img);\n}\n\nfunction copyBlobToCliboard(canvas) {\n  canvas.toBlob((b) => {\n    //eslint-disable-next-line no-undef\n    const clip = new ClipboardItem({\n      [b.type]: b,\n    });\n    navigator.clipboard.write([clip]).then(\n      () => {\n        // eslint-disable-next-line no-console\n        console.log('experiment copied.');\n      },\n      (err) => {\n        // eslint-disable-next-line no-console\n        console.log(err);\n      },\n    );\n  });\n}\n\nfunction copyPNGToClipboard(elementID) {\n  const { blob, width, height } = getBlob(elementID);\n  try {\n    let canvas = document.createElement('canvas');\n    canvas.width = width;\n    canvas.height = height;\n    let context = canvas.getContext('2d');\n    context.fillStyle = 'white';\n    context.fillRect(0, 0, canvas.width, canvas.height);\n    let img = new Image();\n    const url = URL.createObjectURL(blob);\n    img.onload = async function () {\n      context.drawImage(img, 0, 0);\n      const png = canvas.toDataURL('image/png', 1);\n      if (navigator.clipboard.write) {\n        copyBlobToCliboard(canvas);\n      } else {\n        copyDataURLCliboard(png);\n      }\n\n      URL.revokeObjectURL(png);\n    };\n    img.src = url;\n  } catch (e) {\n    if (e instanceof ReferenceError) {\n      // eslint-disable-next-line no-alert\n      alert(\n        'Your browser does not support this feature, please use Google Chrome',\n      );\n    }\n    // eslint-disable-next-line no-console\n    console.log(e);\n  }\n}\n\nfunction getBlob(elementID) {\n  // nmrSVG\n  let _svg = document.getElementById(elementID).cloneNode(true);\n  const width = _svg.getAttribute('width').replace('px', '');\n  const height = _svg.getAttribute('height').replace('px', '');\n  _svg\n    .querySelectorAll('[data-no-export=\"true\"]')\n    .forEach((element) => element.remove());\n  const head = `<svg class=\"nmr-svg\"  viewBox='0 0 ${width} ${height}' width=\"${width}\"  height=\"${height}\"  version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\">`;\n  const style = `<style>.grid line,.grid path{stroke:none;} .peaks-text{fill:#730000} .x path{stroke-width:1px} .x text{\n    font-size: 12px;\n    font-weight: bold;\n  } \n \n  .nmr-svg,.contours{\n    background-color:white;\n    fill:white;\n  }\n  \n\n  \n  </style>`;\n  const svg = `${head + style + _svg.innerHTML}</svg>`;\n  const blob = new Blob([svg], { type: 'image/svg+xml' });\n  return { blob, width, height };\n}\n\nexport {\n  exportAsSVG,\n  exportAsJSON,\n  exportAsNMRE,\n  exportAsPng,\n  copyPNGToClipboard,\n  copyTextToClipboard,\n  copyHTMLToClipboard,\n  exportAsMol,\n};\n","export default function checkModifierKeyActivated(event) {\n  const modifiersKeys = [\n    'Alt',\n    'AltGraph',\n    'CapsLock',\n    'Control',\n    'Meta',\n    'NumLocK',\n    'ScrollLock',\n    'Shift',\n    'OS',\n  ];\n  for (const key of modifiersKeys) {\n    if (event.getModifierState(key)) {\n      return true;\n    }\n  }\n  return false;\n}\n","import lodashDebounce from 'lodash/debounce';\nimport lodashMap from 'lodash/map';\nimport {\n  createContext,\n  useCallback,\n  useEffect,\n  useReducer,\n  useState,\n} from 'react';\n\nexport const BrushContext = createContext();\n\nconst initialState = {\n  step: 'initial',\n  brush: {\n    start: null,\n    end: null,\n  },\n};\n\nlet debounceClickEvents = [];\n\nexport function BrushTracker({\n  children,\n  className,\n  style,\n  onBrush,\n  onZoom,\n  onDoubleClick,\n  onClick,\n  noPropagation,\n}) {\n  const [state, dispatch] = useReducer(reducer, initialState);\n  const [mouseDownTime, setMouseDownTime] = useState();\n\n  const mouseDownHandler = useCallback(\n    (event) => {\n      if (event.button === 0) {\n        if (noPropagation) {\n          event.stopPropagation();\n        }\n        dispatch({\n          type: 'DOWN',\n          shiftKey: event.shiftKey,\n          altKey: event.altKey,\n          screenX: event.screenX,\n          screenY: event.screenY,\n          clientX: event.clientX,\n          clientY: event.clientY,\n          boundingRect: event.currentTarget.getBoundingClientRect(),\n        });\n\n        setMouseDownTime(event.timeStamp);\n      }\n      return false;\n    },\n    [noPropagation],\n  );\n\n  const clickHandler = useCallback(\n    (e) => {\n      e.persist();\n      const timeStamp = e.timeStamp;\n      const boundingRect = e.currentTarget.getBoundingClientRect();\n      const x = e.clientX - boundingRect.x;\n      const y = e.clientY - boundingRect.y;\n\n      const callback = lodashDebounce(() => {\n        if (\n          timeStamp - mouseDownTime <= 150 &&\n          debounceClickEvents.length === 1\n        ) {\n          onClick({ ...e, x, y });\n        }\n        debounceClickEvents = [];\n      }, 200);\n      debounceClickEvents.push(callback);\n\n      callback();\n\n      if (debounceClickEvents.length > 1) {\n        lodashMap(debounceClickEvents, (debounce) => debounce.cancel());\n        debounceClickEvents = [];\n        onDoubleClick({ ...e, x, y });\n      }\n    },\n    [mouseDownTime, onClick, onDoubleClick],\n  );\n\n  const handleMouseWheel = useCallback(\n    (event) => {\n      const boundingRect = event.currentTarget.getBoundingClientRect();\n      const x = event.clientX - boundingRect.x;\n      const y = event.clientY - boundingRect.y;\n\n      const { deltaY, deltaX, shiftKey, deltaMode } = event;\n      onZoom({ deltaY: deltaY || deltaX, shiftKey, deltaMode, x, y });\n    },\n    [onZoom],\n  );\n\n  useEffect(() => {\n    const { step, startX, endX } = state;\n    if (step === 'end' && Math.abs(startX - endX) > 5) {\n      onBrush(state);\n      dispatch({\n        type: 'DONE',\n      });\n    }\n  }, [onBrush, state]);\n\n  const moveCallback = useCallback((event) => {\n    dispatch({\n      type: 'MOVE',\n      screenX: event.screenX,\n      screenY: event.screenY,\n      clientX: event.clientX,\n      clientY: event.clientY,\n    });\n  }, []);\n\n  const upCallback = useCallback((event) => {\n    dispatch({\n      type: 'UP',\n      clientX: event.clientX,\n      clientY: event.clientY,\n    });\n    return false;\n  }, []);\n\n  return (\n    <BrushContext.Provider value={state}>\n      <div\n        className={className}\n        style={style}\n        onMouseDown={mouseDownHandler}\n        onMouseUp={upCallback}\n        onMouseMove={moveCallback}\n        onClick={clickHandler}\n        onWheel={handleMouseWheel}\n      >\n        {children}\n      </div>\n    </BrushContext.Provider>\n  );\n}\n\nBrushTracker.defaultProps = {\n  onBrush: () => null,\n  onZoom: () => null,\n  onDoubleClick: () => null,\n  onClick: () => null,\n};\n\nfunction reducer(state, action) {\n  switch (action.type) {\n    case 'UP':\n      if (state.step === 'brushing' || state.step === 'start') {\n        const { clientX, clientY } = action;\n\n        return {\n          ...state,\n          endX: clientX - state.boundingRect.x,\n          endY: clientY - state.boundingRect.y,\n\n          step: state.step === 'start' ? 'initial' : 'end',\n        };\n      }\n      return state;\n    case 'DOWN':\n      if (state.step === 'initial' || state.step === 'end') {\n        const {\n          screenX,\n          screenY,\n          clientX,\n          clientY,\n          boundingRect,\n          shiftKey,\n          altKey,\n        } = action;\n        const x = clientX - boundingRect.x;\n        const y = clientY - boundingRect.y;\n\n        return {\n          ...state,\n          shiftKey,\n          altKey,\n          startX: x,\n          startY: y,\n          startScreenX: screenX,\n          startScreenY: screenY,\n          startClientX: clientX,\n          startClientY: clientY,\n          boundingRect,\n          step: 'start',\n        };\n      }\n      return state;\n    case 'MOVE':\n      if (state.step === 'start' || state.step === 'brushing') {\n        const { clientX, clientY } = action;\n\n        return {\n          ...state,\n          step: 'brushing',\n          endX: clientX - state.boundingRect.x,\n          endY: clientY - state.boundingRect.y,\n        };\n      }\n      return state;\n    case 'DONE':\n      if (state.step === 'end') {\n        return {\n          ...state,\n          step: 'initial',\n        };\n      }\n      break;\n    default:\n      return state;\n  }\n}\n","import { createContext, useCallback, useState, useContext } from 'react';\n\nexport const MouseContext = createContext();\nconst MouseaProvider = MouseContext.Provider;\n\nexport function useMouseTracker() {\n  return useContext(MouseContext);\n}\n\nexport function MouseTracker({ children, className, style, noPropagation }) {\n  const [mouseTrackerState, setMouseTrackerState] = useState(null);\n  const mouseMoveHandler = useCallback(\n    (e) => {\n      const boundingRect = e.currentTarget.getBoundingClientRect();\n      const x = e.clientX - boundingRect.x;\n      const y = e.clientY - boundingRect.y;\n      setMouseTrackerState({ x, y });\n      if (noPropagation) {\n        e.stopPropagation();\n      }\n    },\n    [noPropagation],\n  );\n\n  const mouseLeaveHandler = useCallback(\n    (e) => {\n      setMouseTrackerState(null);\n      if (noPropagation) {\n        e.stopPropagation();\n      }\n    },\n    [noPropagation],\n  );\n\n  return (\n    <MouseaProvider value={mouseTrackerState}>\n      <div\n        className={className}\n        style={style}\n        onMouseMove={mouseMoveHandler}\n        onMouseLeave={mouseLeaveHandler}\n      >\n        {children}\n      </div>\n    </MouseaProvider>\n  );\n}\n","import { createContext, useContext } from 'react';\n\nexport const ChartContext = createContext();\n\nexport const ChartDataProvider = ChartContext.Provider;\n\nexport function useChartData() {\n  return useContext(ChartContext);\n}\n","import { createContext, useContext } from 'react';\n\nexport const dispatchContext = createContext();\n\nexport const DispatchProvider = dispatchContext.Provider;\n\nexport function useDispatch() {\n  return useContext(dispatchContext);\n}\n","import { createContext, useContext } from 'react';\n\nexport const PreferencesConext = createContext();\n\nexport const PreferencesProvider = PreferencesConext.Provider;\n\nexport function usePreferences() {\n  return useContext(PreferencesConext);\n}\n","import { createContext, useContext } from 'react';\n\nexport const scaleContext = createContext();\n\nexport const ScaleProvider = scaleContext.Provider;\n\nexport function useScale() {\n  return useContext(scaleContext);\n}\n","export const positions = {\n  TOP_LEFT: 'top left',\n  TOP_CENTER: 'top center',\n  TOP_RIGHT: 'top right',\n  MIDDLE_LEFT: 'middle left',\n  MIDDLE: 'middle',\n  MIDDLE_RIGHT: 'middle right',\n  BOTTOM_LEFT: 'bottom left',\n  BOTTOM_CENTER: 'bottom center',\n  BOTTOM_RIGHT: 'bottom right',\n};\n\nexport const types = {\n  INFO: 'info',\n  SUCCESS: 'success',\n  ERROR: 'error',\n};\n\nexport const transitions = {\n  FADE: 'fade',\n  SCALE: 'scale',\n  SLIDE_RIGHT: 'slide_right',\n  SLIDE_LEFT: 'slide_left',\n  SLIDE_TOP: 'slide_top',\n  SLIDE_BOTTOM: 'slide_bottom',\n};\n","import { createContext, useContext } from 'react';\n\nconst ModalContext = createContext();\nexport const ModalProvider = ModalContext.Provider;\n\nexport const useModal = () => {\n  return useContext(ModalContext);\n};\n","import { useEffect, useCallback } from 'react';\n\nconst styles = {\n  outerContainer: {\n    position: 'fixed',\n    top: 0,\n    right: 0,\n    bottom: 0,\n    left: 0,\n    backgroundColor: 'rgba(255,255,255,0.8)',\n    display: 'flex',\n    justifyContent: 'center',\n    alignItems: 'center',\n    zIndex: 1,\n  },\n  innerContainer: {\n    boxSizing: 'initial',\n    backgroundColor: '#fff',\n    boxShadow: '0 0 0 0, 0 8px 16px rgba(0,0,0,.30)',\n    display: 'flex',\n    flexDirection: 'column',\n    minWidth: '300px',\n    minHeight: '140px',\n    justifyContent: 'space-between',\n    borderRadius: '5px',\n  },\n};\n\nconst Modal = ({ children, open, onClose, style }) => {\n  const handleClose = useCallback(\n    (e) => {\n      onClose(e);\n    },\n    [onClose],\n  );\n\n  useEffect(() => {\n    if (open === false) {\n      handleClose();\n    }\n  }, [handleClose, open]);\n\n  return (\n    open && (\n      <div style={styles.outerContainer} onClick={handleClose}>\n        <div\n          style={{ ...styles.innerContainer, ...style }}\n          onClick={(e) => {\n            e.preventDefault();\n            e.stopPropagation();\n          }}\n        >\n          {children}\n        </div>\n      </div>\n    )\n  );\n};\n\nModal.defaultProps = {\n  onClose: function () {\n    return null;\n  },\n  open: false,\n};\n\nexport default Modal;\n","import { useRef } from 'react';\nimport { Transition as ContainerTransition } from 'react-transition-group';\n\nimport { transitions } from './options';\n\nconst duration = 250;\n\nconst defaultStyle = {\n  [transitions.FADE]: {\n    transition: `opacity ${duration}ms ease`,\n    opacity: 0,\n  },\n  [transitions.SCALE]: {\n    transform: 'scale(1)',\n    transition: `all ${duration}ms ease-in-out`,\n  },\n};\n\nconst defaultTransitionStyles = {\n  [transitions.FADE]: {\n    entering: { opacity: 0 },\n    entered: { opacity: 1 },\n  },\n  [transitions.SCALE]: {\n    entering: { transform: 'scale(0)' },\n    entered: { transform: 'scale(1)' },\n    exiting: { transform: 'scale(0)' },\n    exited: { transform: 'scale(1)' },\n  },\n};\n\nconst Transtion = ({ children, type, transitionStyles, ...props }) => {\n  const ref = useRef(null);\n  return (\n    <ContainerTransition nodeRef={ref} {...props} timeout={duration}>\n      {(state) => (\n        <div\n          ref={ref}\n          style={{\n            ...defaultStyle[type],\n            ...transitionStyles[type][state],\n            ...transitionStyles.default,\n          }}\n        >\n          {children}\n        </div>\n      )}\n    </ContainerTransition>\n  );\n};\n\nTranstion.defaultProps = {\n  transitionStyles: defaultTransitionStyles,\n};\n\nexport default Transtion;\n","import { useMemo } from 'react';\n\nimport { positions } from './options';\n\nexport const getStyles = (position, props) => {\n  const initialStyles = {\n    // left: 0,\n    position: 'fixed',\n    display: 'flex',\n    justifyContent: 'center',\n    alignItems: 'center',\n    flexDirection: 'column',\n    // width: '100%',\n    pointerEvents: 'none',\n    overflow: 'visible',\n    ...(props.containerStyle\n      ? {\n          top: `${props.containerStyle.top}px`,\n          left: `${props.containerStyle.left}px`,\n          height: `${props.containerStyle.height}px`,\n          width: `${props.containerStyle.width}px`,\n        }\n      : { width: '100%', height: '100%' }),\n  };\n\n  switch (position) {\n    case positions.TOP_LEFT:\n      return {\n        ...initialStyles,\n        // top: 0,\n        justifyContent: 'flex-start',\n        alignItems: 'flex-start',\n      };\n    case positions.TOP_CENTER:\n      return {\n        ...initialStyles,\n        justifyContent: 'flex-start',\n\n        // top: 0,\n      };\n    case positions.TOP_RIGHT:\n      return {\n        ...initialStyles,\n        // top: 0,\n        justifyContent: 'flex-start',\n        alignItems: 'flex-end',\n      };\n    case positions.MIDDLE_LEFT:\n      return {\n        ...initialStyles,\n        // top: '50%',\n        justifyContent: 'center',\n        alignItems: 'flex-start',\n      };\n    case positions.MIDDLE: {\n      return {\n        ...initialStyles,\n        // top: '50%',\n        justifyContent: 'center',\n      };\n    }\n    case positions.MIDDLE_RIGHT:\n      return {\n        ...initialStyles,\n        // top: '50%',\n        justifyContent: 'center',\n\n        alignItems: 'flex-end',\n      };\n\n    case positions.BOTTOM_LEFT:\n      return {\n        ...initialStyles,\n        // bottom: 0,\n        justifyContent: 'flex-end',\n\n        alignItems: 'flex-start',\n      };\n    case positions.BOTTOM_CENTER:\n      return {\n        ...initialStyles,\n        // bottom: 0,\n        justifyContent: 'flex-end',\n      };\n    case positions.BOTTOM_RIGHT:\n      return {\n        ...initialStyles,\n        // bottom: 0,\n        justifyContent: 'flex-end',\n\n        alignItems: 'flex-end',\n      };\n\n    default: {\n      return initialStyles;\n    }\n  }\n};\n\nfunction Wrapper({ children, options: { position }, ...props }) {\n  const styles = useMemo(() => getStyles(position, props), [position, props]);\n\n  return (\n    children.length > 0 && (\n      <div style={styles} {...props}>\n        {children}\n      </div>\n    )\n  );\n}\n\nexport default Wrapper;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport PropTypes from 'prop-types';\nimport { useCallback } from 'react';\n\nconst messageStyle = css`\n  font-size: 16px;\n  text-align: center;\n  color: white;\n  text-align: center;\n  margin: 35px 10px;\n  flex: 1;\n`;\nconst buttonsStyle = css`\n  display: flex;\n  align-items: flex-end;\n  justify-content: flex-end;\n  padding: 5px;\n  background-color: #ffffff52;\n\n  button:first-of-type {\n    border-radius: 5px 0 0 5px;\n    border-weight: 0 1px 0 0;\n  }\n  button:last-child {\n    border-radius: 0px 5px 5px 0px;\n    border-weight: 0 0 0 1px;\n  }\n  button {\n    border: 1px solid #dcdcdc;\n    background-color: white;\n    display: inline-block;\n    cursor: pointer;\n    color: #666666;\n    font-weight: bold;\n    padding: 6px 24px;\n    text-decoration: none;\n  }\n  button:hover {\n    background: -webkit-gradient(\n      linear,\n      left top,\n      left bottom,\n      color-stop(0.05, #f6f6f6),\n      color-stop(1, #ffffff)\n    );\n    background: -moz-linear-gradient(top, #f6f6f6 5%, #ffffff 100%);\n    background: -webkit-linear-gradient(top, #f6f6f6 5%, #ffffff 100%);\n    background: -o-linear-gradient(top, #f6f6f6 5%, #ffffff 100%);\n    background: -ms-linear-gradient(top, #f6f6f6 5%, #ffffff 100%);\n    background: linear-gradient(to bottom, #f6f6f6 5%, #ffffff 100%);\n    filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#f6f6f6', endColorstr='#ffffff',GradientType=0);\n    background-color: #f6f6f6;\n  }\n`;\n\nconst ConfirmationDialog = ({ onYes, onNo, onClose, message }) => {\n  const yesHandler = useCallback(\n    (e) => {\n      onYes(e);\n      onClose();\n    },\n    [onClose, onYes],\n  );\n\n  const noHandler = useCallback(\n    (e) => {\n      onNo(e);\n      onClose();\n    },\n    [onClose, onNo],\n  );\n\n  return (\n    <div\n      style={{\n        display: 'flex',\n        flexDirection: 'column',\n        backgroundColor: '#ff3636',\n        flex: 1,\n      }}\n    >\n      <p css={messageStyle}>{message}</p>\n      <div css={buttonsStyle}>\n        <button type=\"button\" onClick={noHandler}>\n          No\n        </button>\n        <button type=\"button\" onClick={yesHandler}>\n          Yes\n        </button>\n      </div>\n    </div>\n  );\n};\n\nConfirmationDialog.defaultProps = {\n  onYes: () => {\n    return null;\n  },\n  onNo: () => {\n    return null;\n  },\n};\n\nConfirmationDialog.propTypes = {\n  onYes: PropTypes.func,\n  onNo: PropTypes.func,\n};\n\nexport default ConfirmationDialog;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport {\n  useRef,\n  useState,\n  useEffect,\n  useCallback,\n  Fragment,\n  cloneElement,\n  useMemo,\n} from 'react';\nimport { createPortal } from 'react-dom';\nimport { Rnd } from 'react-rnd';\nimport { TransitionGroup } from 'react-transition-group';\n\nimport Transition from '../Transition';\nimport Wrapper from '../Wrapper';\nimport { positions, transitions } from '../options';\n\nimport ConfirmDialog from './ConfirmDialog';\nimport { ModalProvider } from './Context';\n\nconst transitionStyles = {\n  [transitions.FADE]: {\n    entering: { opacity: 0 },\n    entered: { opacity: 1 },\n  },\n  [transitions.SCALE]: {\n    entering: { transform: 'scale(0)' },\n    entered: { transform: 'scale(1)' },\n    exiting: { transform: 'scale(0)' },\n    exited: { transform: 'scale(0)' },\n  },\n};\n\nfunction Provider({\n  children,\n  style,\n  offset,\n  position,\n  transition,\n  wrapperRef,\n}) {\n  const root = useRef();\n  const [modal, setModal] = useState();\n\n  useEffect(() => {\n    root.current = document.createElement('div');\n    const ref = root.current;\n    if (wrapperRef) {\n      wrapperRef.appendChild(ref);\n    }\n    return () => {\n      if (ref) {\n        if (wrapperRef) {\n          wrapperRef.removeChild(ref);\n        }\n      }\n    };\n  }, [wrapperRef]);\n\n  const remove = () => {\n    setModal(null);\n  };\n\n  const parentStyle = useMemo(() => {\n    return wrapperRef\n      ? wrapperRef.getBoundingClientRect()\n      : {\n          top: 0,\n          left: 0,\n          width: window.innerWidth,\n          height: window.innerHeight,\n        };\n  }, [wrapperRef]);\n\n  const closeHandler = useCallback(() => {\n    remove();\n  }, []);\n  /**\n   *\n   * @param {*} component  <component />\n   * @param {object} options    {onYest:()=>{}, prop1, .... etc}\n   * @param {transitions} options.transition\n   * @param {positions} options.position\n   * @param {boolean} options.isBackgroundBlur\n   * @param {boolean} options.enableResizing\n   */\n  const show = useCallback((component, options = {}) => {\n    const _modal = {\n      component,\n      options: { isBackgroundBlur: true, enableResizing: false, ...options },\n    };\n\n    _modal.close = () => remove();\n\n    setModal(_modal);\n    if (_modal.options.onOpen) _modal.options.onOpen();\n    return _modal;\n  }, []);\n\n  const showConfirmDialog = useCallback((message, options = {}) => {\n    const _modal = {\n      component: <ConfirmDialog message={message} />,\n      options: { isBackgroundBlur: true, ...options },\n    };\n\n    _modal.close = () => remove();\n\n    setModal(_modal);\n    if (_modal.options.onOpen) _modal.options.onOpen();\n\n    return _modal;\n  }, []);\n\n  const close = () => {\n    closeHandler();\n  };\n\n  useEffect(() => {\n    const keyHandler = (e) => {\n      if (['Escape', 'Esc'].includes(e.key)) {\n        closeHandler();\n      }\n    };\n    document.addEventListener('keydown', keyHandler, false);\n    return () => document.removeEventListener('keydown', keyHandler, false);\n  }, [closeHandler]);\n\n  const styles = css`\n    position: absolute;\n    left: 0;\n    top: 0;\n    bottom: 0;\n    right: 0;\n    z-index: 0;\n\n    .handle {\n      cursor: move;\n    }\n\n    .rnd-container {\n      box-sizing: initial;\n      background-color: #fff;\n      box-shadow: 0 0 0 0, 0 8px 16px rgba(0, 0, 0, 0.3);\n      borderradius: 5px;\n    }\n  `;\n\n  const outerStyle =\n    modal && modal.options.isBackgroundBlur\n      ? { backgroundColor: 'rgba(255,255,255,0.8)' }\n      : { pointerEvents: 'none' };\n\n  return (\n    <ModalProvider value={{ show, close, modal, showConfirmDialog }}>\n      {children}\n      {root.current &&\n        createPortal(\n          <Fragment>\n            {modal ? (\n              <div\n                css={styles}\n                style={{\n                  ...outerStyle,\n                }}\n              >\n                <TransitionGroup\n                  appear\n                  key={\n                    positions[\n                      modal.options.transition\n                        ? modal.options.transition\n                        : transition\n                    ]\n                  }\n                  options={{\n                    position: modal.options.position\n                      ? modal.options.position\n                      : position,\n                  }}\n                  containerStyle={parentStyle}\n                  component={Wrapper}\n                >\n                  <Transition\n                    type={\n                      modal.options.transition\n                        ? modal.options.transition\n                        : transition\n                    }\n                    transitionStyles={{\n                      ...transitionStyles,\n                      default: {\n                        width: modal.options.width\n                          ? `${modal.options.width}px`\n                          : 'auto',\n                      },\n                      height: modal.options.height\n                        ? `${modal.options.height}px`\n                        : 'auto',\n                    }}\n                    key={modal.id}\n                  >\n                    <Rnd\n                      default={{\n                        width: modal.options.width\n                          ? modal.options.width\n                          : 'auto',\n                        height: modal.options.height\n                          ? modal.options.height\n                          : 'auto',\n                        x: 0,\n                        y: 0,\n                      }}\n                      className=\"rnd-container\"\n                      style={{\n                        ...style,\n                        margin: offset,\n                        pointerEvents: 'all',\n                        position: 'none',\n                        userSelect: 'none',\n                      }}\n                      enableResizing={modal.options.enableResizing}\n                      dragHandleClassName=\"handle\"\n                      enableUserSelectHack={false}\n                    >\n                      {modal.options &&\n                        cloneElement(modal.component, {\n                          ...modal.options,\n                          onClose: closeHandler,\n                          style: { cursor: 'default' },\n                        })}\n                    </Rnd>\n                  </Transition>\n                </TransitionGroup>\n              </div>\n            ) : null}\n          </Fragment>,\n          root.current,\n        )}\n    </ModalProvider>\n  );\n}\n\nProvider.defaultProps = {\n  offset: '10px',\n  position: positions.CENTER,\n  transition: transitions.SCALE,\n  wrapperRef: null,\n  style: {},\n};\n\nexport default Provider;\n","export const INITIATE = 'INITIATE';\nexport const SAVE_DATA_AS_JSON = 'SAVE_DATA_AS_JSON';\nexport const LOAD_JSON_FILE = 'LOAD_JSON_FILE';\nexport const LOAD_JCAMP_FILE = 'LOAD_JCAMP_FILE';\nexport const LOAD_MOL_FILE = 'LOAD_MOL_FILE';\nexport const LOAD_ZIP_FILE = 'LOAD_ZIP_FILE';\nexport const LOAD_JDF_FILE = 'LOAD_JDF_FILE';\nexport const ADD_PEAK = 'ADD_PEAK';\nexport const ADD_PEAKS = 'ADD_PEAKS';\nexport const DELETE_PEAK_NOTATION = 'DELETE_PEAK_NOTATION';\nexport const SHIFT_SPECTRUM = 'SHIFT_SPECTRUM';\nexport const SET_X_DOMAIN = 'SET_X_DOMAIN';\nexport const SET_Y_DOMAIN = 'SET_Y_DOMAIN';\nexport const SET_ORIGINAL_DOMAIN = 'SET_ORIGINAL_DOMAIN';\nexport const SET_WIDTH = 'SET_WIDTH';\nexport const SET_DIMENSIONS = 'SET_DIMENSIONS';\nexport const SET_SELECTED_TOOL = 'SET_SELECTED_TOOL';\nexport const SET_SELECTED_FILTER = 'SET_SELECTED_FILTER';\nexport const CHANGE_SPECTRUM_SETTING = 'CHANGE_SPECTRUM_SETTING';\nexport const CHANGE_SPECTRUM_TYPE = 'CHANGE_SPECTRUM_TYPE';\nexport const FULL_ZOOM_OUT = 'FULL_ZOOM_OUT';\nexport const CHANGE_VISIBILITY = 'CHANGE_VISIBILITY';\nexport const CHANGE_PEAKS_MARKERS_VISIBILITY =\n  'CHANGE_PEAKS_MARKERS_VISIBILITY';\nexport const CHANGE_ACTIVE_SPECTRUM = 'CHANGE_ACTIVE_SPECTRUM';\nexport const CHANGE_SPECTRUM_COLOR = 'CHANGE_SPECTRUM_COLOR';\nexport const ADD_INTEGRAL = 'ADD_INTEGRAL';\nexport const DELETE_INTEGRAL = 'DELETE_INTEGRAL';\nexport const TOGGLE_REAL_IMAGINARY_VISIBILITY =\n  'TOGGLE_REAL_IMAGINARY_VISIBILITY';\nexport const SET_ZOOM_FACTOR = 'SET_ZOOM_FACTOR';\nexport const ADD_MOLECULE = 'ADD_MOLECULE';\nexport const SET_MOLECULE = 'SET_MOLECULE';\nexport const DELETE_MOLECULE = 'DELETE_MOLECULE';\nexport const SET_CORRELATION = 'SET_CORRELATION';\nexport const SET_CORRELATIONS = 'SET_CORRELATIONS';\nexport const SET_CORRELATIONS_MF = 'SET_CORRELATIONS_MF';\nexport const SET_CORRELATIONS_TOLERANCE = 'SET_CORRELATIONS_TOLERANCE';\nexport const DELETE_SPECTRA = 'DELETE_SPECTRA';\nexport const CHANGE_SPECTRUM_DISPLAY_VIEW_MODE =\n  'CHANGE_SPECTRUM_DISPLAY_VIEW_MODE';\nexport const SET_INTEGRAL_Y_DOMAIN = 'SET_INTEGRAL_Y_DOMAIN';\nexport const RESIZE_INTEGRAL = 'RESIZE_INTEGRAL';\nexport const BRUSH_END = 'BRUSH_END';\nexport const RESET_DOMAIN = 'RESET_X_DOMAIN';\nexport const CHANGE_INTEGRAL_ZOOM = 'CHANGE_INTEGRAL_ZOOM';\nexport const ENABLE_FILTER = 'ENABLE_FILTER';\nexport const DELETE_FILTER = 'DELETE_FILTER';\nexport const APPLY_ZERO_FILLING_FILTER = 'APPLY_ZERO_FILLING_FILTER';\nexport const APPLY_FFT_FILTER = 'APPLY_FFT_FILTER';\nexport const CALCULATE_MANUAL_PHASE_CORRECTION_FILTER =\n  'CALCULATE_MANUAL_PHASE_CORRECTION_FILTER';\nexport const APPLY_MANUAL_PHASE_CORRECTION_FILTER =\n  'APPLY_MANUAL_PHASE_CORRECTION_FILTER';\nexport const APPLY_AUTO_PHASE_CORRECTION_FILTER =\n  'APPLY_AUTO_PHASE_CORRECTION_FILTER';\nexport const APPLY_ABSOLUTE_FILTER = 'APPLY_ABSOLUTE_FILTER';\nexport const SET_VERTICAL_INDICATOR_X_POSITION =\n  'SET_VERTICAL_INDICATOR_X_POSITION';\nexport const AUTO_PEAK_PICKING = 'AUTO_PEAK_PICKING';\nexport const AUTO_RANGES_DETECTION = 'AUTO_RANGES_DETECTION';\nexport const AUTO_ZONES_DETECTION = 'AUTO_ZONES_DETECTION';\nexport const DELETE_RANGE = 'DELETE_RANGE';\nexport const SET_SELECTED_OPTIONS_PANEL = 'SET_SELECTED_OPTIONS_PANEL';\nexport const SET_LOADING_FLAG = 'SET_LOADING_FLAG';\nexport const RESET_SELECTED_TOOL = 'RESET_SELECTED_TOOL';\nexport const SET_SPECTRUMS_VERTICAL_ALIGN = 'SET_SPECTRUMS_VERTICAL_AlIGN';\nexport const SAVE_AS_SVG = 'SAVE_AS_SVG';\nexport const CHANGE_INTEGRAL_DATA = 'CHANGE_INTEGRAL_DATA';\nexport const EXPORT_DATA = 'EXPORT_DATA';\nexport const SET_PREFERENCES = 'SET_PREFERENCES';\nexport const SET_ACTIVE_TAB = 'SET_ACTIVE_TAB';\nexport const CHANGE_INTEGRAL_SUM = 'CHANGE_INTEGRAL_SUM';\nexport const ADD_BASE_LINE_ZONE = 'ADD_BASE_LINE_ZONE';\nexport const DELETE_BASE_LINE_ZONE = 'DELETE_BASE_LINE_ZONE';\nexport const APPLY_BASE_LINE_CORRECTION_FILTER =\n  'APPLY_BASE_LINE_CORRECTION_FILTER';\nexport const SET_KEY_PREFERENCES = 'SET_KEY_PREFERENCES';\nexport const APPLY_KEY_PREFERENCES = 'APPLY_KEY_PREFERENCES';\nexport const RESIZE_RANGE = 'RESIZE_RANGE';\nexport const CHANGE_RANGE_SUM = 'CHANGE_RANGE_SUM';\nexport const ADD_RANGE = 'ADD_RANGE';\nexport const SET_2D_LEVEL = 'SET_2D_LEVEL';\nexport const ADD_2D_ZONE = 'ADD_2D_ZONE';\nexport const DELETE_2D_ZONE = 'DELETE_2D_ZONE';\nexport const ADD_MISSING_PROJECTION = 'ADD_MISSING_PROJECTION';\nexport const SET_FILTER_SNAPSHOT = 'SET_FILTER_SNAPSHOT';\nexport const CHANGE_RANGE_RELATIVE = 'CHANGE_RANGE_RELATIVE';\nexport const CHANGE_RANGE_SIGNAL_VALUE = 'CHANGE_RANGE_SIGNAL_VALUE';\nexport const CHANGE_RANGE_SIGNAL_KIND = 'CHANGE_RANGE_SIGNAL_KIND';\nexport const SAVE_EDITED_RANGE = 'SAVE_EDITED_RANGE';\nexport const UNLINK_RANGE = 'UNLINK_RANGE';\nexport const SET_DIAID_RANGE = 'SET_DIAID_RANGE';\nexport const CHANGE_INTEGRAL_RELATIVE = 'CHANGE_INTEGRAL_RELATIVE';\nexport const ANALYZE_SPECTRA = 'ANALYZE_SPECTRA';\nexport const DELETE_ANALYZE_SPECTRA_RANGE = 'DELETE_ANALYZE_SPECTRA_RANGE';\nexport const RESIZE_ANALYZE_SPECTRA_RANGE = 'RESIZE_ANALYZE_SPECTRA_RANGE';\nexport const SET_ANALYZE_SPECTRA_COLUMNS = 'SET_ANALYZE_SPECTRA_COLUMNS';\nexport const FILTER_SPECTRA_COLUMN = 'FILTER_SPECTRA_COLUMN';\nexport const ALIGN_SPECTRA = 'ALIGN_SPECTRA';\nexport const CHANGE_ZONE_SIGNAL_VALUE = 'CHANGE_ZONE_SIGNAL_VALUE';\nexport const CHANGE_ZONE_SIGNAL_KIND = 'CHANGE_ZONE_SIGNAL_KIND';\nexport const UNLINK_ZONE = 'UNLINK_ZONE';\nexport const SET_DIAID_ZONE = 'SET_DIAID_ZONE';\nexport const PREDICT_SPECTRA = 'PREDICT_SPECTRA';\nexport const SET_SPECTRA_SAME_TOP = 'SET_SPECTRA_SAME_TOP';\nexport const RESET_SPECTRA_SCALE = 'RESET_SPECTRA_SCALE';\nexport const SET_MOUSE_OVER_DISPLAYER = 'SET_MOUSE_OVER_DISPLAYER';\n","async function loadFile(file) {\n  const response = await fetch(file);\n  checkStatus(response);\n  const data = await response.text();\n  return data;\n}\n\nfunction checkStatus(response) {\n  if (!response.ok) {\n    throw new Error(`HTTP ${response.status} - ${response.statusText}`);\n  }\n  return response;\n}\n\nfunction getFileExtension(name) {\n  return name.replace(/^.*\\./, '').toLowerCase();\n}\n\nfunction getFileName(name) {\n  return name.substr(0, name.lastIndexOf('.'));\n}\n\nfunction extractFileMetaFromPath(path) {\n  const meta = path\n    // eslint-disable-next-line no-useless-escape\n    .replace(/^.*[\\\\\\/]/, '')\n    .split('.');\n\n  return { name: meta[0].toLowerCase(), extension: meta[1].toLowerCase() };\n}\n\nfunction loadFiles(acceptedFiles, options = {}) {\n  return Promise.all(\n    [].map.call(acceptedFiles, (file) => {\n      return new Promise((resolve, reject) => {\n        const reader = new FileReader();\n        reader.onabort = (e) => reject(e);\n        reader.onerror = (e) => reject(e);\n        reader.onload = () => {\n          if (reader.result) {\n            const binary = reader.result;\n            const name = getFileName(file.name);\n            const extension = getFileExtension(file.name);\n            resolve({ binary, name, extension });\n          }\n        };\n        if (options.asBuffer) {\n          reader.readAsArrayBuffer(file);\n        } else {\n          reader.readAsBinaryString(file);\n        }\n      });\n    }),\n  );\n}\n\nexport {\n  loadFiles,\n  loadFile,\n  getFileExtension,\n  getFileName,\n  extractFileMetaFromPath,\n};\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { createRef, useCallback } from 'react';\nimport { useDropzone } from 'react-dropzone';\nimport { FaUpload } from 'react-icons/fa';\n\nimport { useChartData } from '../context/ChartContext';\nimport { useDispatch } from '../context/DispatchContext';\nimport {\n  LOAD_MOL_FILE,\n  LOAD_JSON_FILE,\n  LOAD_JCAMP_FILE,\n  SET_LOADING_FLAG,\n  LOAD_ZIP_FILE,\n  LOAD_JDF_FILE,\n} from '../reducer/types/Types';\nimport { getFileExtension, loadFiles } from '../utility/FileUtility';\n\nconst style = css`\n  height: 100%;\n  background-color: #b5b5b599;\n  position: absolute;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  flex-flow: column;\n  z-index: 99999;\n\n  p {\n    color: white;\n    background-color: rgb(104, 104, 104);\n    padding: 1.5%;\n    border-radius: 30px;\n    margin: 0px;\n  }\n\n  svg {\n    stroke-width: 0;\n    font-size: 3rem !important;\n    fill: white;\n  }\n`;\n\nconst containerStyle = css`\n  border: 0.55px #e6e6e6 solid;\n  display: flex;\n  flex: 1;\n  flex-direction: 'column';\n  height: 100%;\n`;\n\nexport const DropZoneRef = createRef();\n\nfunction DropZone(props) {\n  const { width, height } = useChartData();\n  const dispatch = useDispatch();\n  const onDrop = useCallback(\n    (droppedFiles) => {\n      dispatch({ type: SET_LOADING_FLAG, isLoading: true });\n\n      const uniqueFileExtensions = [\n        ...new Set(droppedFiles.map((file) => getFileExtension(file.name))),\n      ];\n\n      for (let extension of uniqueFileExtensions) {\n        const selectedFilesByExtensions = droppedFiles.filter(\n          (file) => getFileExtension(file.name) === extension,\n        );\n\n        switch (extension) {\n          case 'mol':\n            loadFiles(selectedFilesByExtensions).then(\n              (files) => {\n                dispatch({ type: LOAD_MOL_FILE, files });\n              },\n              (err) => {\n                // eslint-disable-next-line no-alert\n                alert(err);\n              },\n            );\n            break;\n          case 'nmrium':\n          case 'json':\n            if (selectedFilesByExtensions.length === 1) {\n              loadFiles(selectedFilesByExtensions).then(\n                (files) => {\n                  dispatch({ type: LOAD_JSON_FILE, files });\n                },\n                (err) => {\n                  // eslint-disable-next-line no-alert\n                  alert(err);\n                },\n              );\n            } else {\n              // eslint-disable-next-line no-alert\n              alert('You can add only one json file');\n            }\n\n            break;\n\n          case 'dx':\n          case 'jdx':\n            loadFiles(selectedFilesByExtensions).then(\n              (files) => {\n                dispatch({ type: LOAD_JCAMP_FILE, files });\n              },\n              (err) => {\n                // eslint-disable-next-line no-alert\n                alert(err);\n              },\n            );\n            break;\n          case 'jdf':\n            loadFiles(selectedFilesByExtensions, { asBuffer: true }).then(\n              (files) => {\n                dispatch({ type: LOAD_JDF_FILE, files });\n              },\n              (err) => {\n                // eslint-disable-next-line no-alert\n                alert(err);\n              },\n            );\n            break;\n          case 'zip':\n            loadFiles(selectedFilesByExtensions).then(\n              (files) => {\n                dispatch({ type: LOAD_ZIP_FILE, files });\n              },\n              (err) => {\n                // eslint-disable-next-line no-alert\n                alert(err);\n              },\n            );\n            break;\n          default:\n            // eslint-disable-next-line no-alert\n            alert(\n              'The file extension must be zip, dx, jdx, json, mol or nmrium.',\n            );\n            break;\n        }\n      }\n    },\n    [dispatch],\n  );\n\n  DropZoneRef.current = useDropzone({\n    onDrop,\n    noClick: true,\n  });\n\n  const { getRootProps, getInputProps, isDragActive } = DropZoneRef.current;\n\n  return (\n    <div {...getRootProps()} css={containerStyle}>\n      <input {...getInputProps()} />\n      {isDragActive && (\n        <div\n          css={style}\n          style={{ width: `${width + 41}px`, height: `${height}px` }}\n        >\n          <FaUpload />\n          <p>Drop your files here</p>\n        </div>\n      )}\n      {props.children}\n    </div>\n  );\n}\n\nexport default DropZone;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback } from 'react';\n\nimport { DropZoneRef } from './DropZone';\n\nconst styles = css`\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background-color: rgba(255, 255, 255, 0.25);\n  height: 100%;\n  flex-direction: column;\n  user-select: none;\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  outline: 10px dashed rgba(0, 0, 0, 0.3);\n  outline-offset: -10px;\n  padding-left: 20px;\n  padding-right: 20px;\n\n  p {\n    padding: 15px 30px;\n    background-color:rgba(0, 0, 0, 0.5);\n    border-radius: 39px;\n    color: white;\n    font-size: x-large;\n    font-weight: bold;\n\n  }\n}\n`;\nfunction NoData({ isEmpty = true }) {\n  const openFileDialogHadnler = useCallback(() => {\n    DropZoneRef.current.open();\n  }, []);\n\n  if (!isEmpty) {\n    return null;\n  }\n\n  return (\n    <div css={styles} onClick={openFileDialogHadnler}>\n      <p>\n        Drag and drop here a JCAMP-DX, zipped Bruker folder, Jeol jdf or NMRium\n        file\n      </p>\n    </div>\n  );\n}\n\nexport default NoData;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\n\nconst styles = css`\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background-color: rgba(255, 255, 255, 0.25);\n  height: 100%;\n  flex-direction: column;\n  user-select: none;\n  position: absolute;\n  width: 100%;\n\n  svg {\n    animation-duration: 0.5s;\n    animation-name: spinAnimation;\n    animation-iteration-count: infinite;\n    animation-fill-mode: forwards;\n    animation-direction: inherit;\n    animation-timing-function: linear;\n    animation-duration: 1s;\n    width: 100px;\n    height: 100px;\n  }\n\n  @keyframes spinAnimation {\n    from {\n      transform: rotate(0deg);\n    }\n\n    to {\n      transform: rotate(360deg);\n    }\n  }\n`;\n\nexport default function DefaultSpinnerComponent() {\n  return (\n    <div css={styles}>\n      <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 841.9 595.3\">\n        <g fill=\"#61DAFB\">\n          <path d=\"M666.3 296.5c0-32.5-40.7-63.3-103.1-82.4 14.4-63.6 8-114.2-20.2-130.4-6.5-3.8-14.1-5.6-22.4-5.6v22.3c4.6 0 8.3.9 11.4 2.6 13.6 7.8 19.5 37.5 14.9 75.7-1.1 9.4-2.9 19.3-5.1 29.4-19.6-4.8-41-8.5-63.5-10.9-13.5-18.5-27.5-35.3-41.6-50 32.6-30.3 63.2-46.9 84-46.9V78c-27.5 0-63.5 19.6-99.9 53.6-36.4-33.8-72.4-53.2-99.9-53.2v22.3c20.7 0 51.4 16.5 84 46.6-14 14.7-28 31.4-41.3 49.9-22.6 2.4-44 6.1-63.6 11-2.3-10-4-19.7-5.2-29-4.7-38.2 1.1-67.9 14.6-75.8 3-1.8 6.9-2.6 11.5-2.6V78.5c-8.4 0-16 1.8-22.6 5.6-28.1 16.2-34.4 66.7-19.9 130.1-62.2 19.2-102.7 49.9-102.7 82.3 0 32.5 40.7 63.3 103.1 82.4-14.4 63.6-8 114.2 20.2 130.4 6.5 3.8 14.1 5.6 22.5 5.6 27.5 0 63.5-19.6 99.9-53.6 36.4 33.8 72.4 53.2 99.9 53.2 8.4 0 16-1.8 22.6-5.6 28.1-16.2 34.4-66.7 19.9-130.1 62-19.1 102.5-49.9 102.5-82.3zm-130.2-66.7c-3.7 12.9-8.3 26.2-13.5 39.5-4.1-8-8.4-16-13.1-24-4.6-8-9.5-15.8-14.4-23.4 14.2 2.1 27.9 4.7 41 7.9zm-45.8 106.5c-7.8 13.5-15.8 26.3-24.1 38.2-14.9 1.3-30 2-45.2 2-15.1 0-30.2-.7-45-1.9-8.3-11.9-16.4-24.6-24.2-38-7.6-13.1-14.5-26.4-20.8-39.8 6.2-13.4 13.2-26.8 20.7-39.9 7.8-13.5 15.8-26.3 24.1-38.2 14.9-1.3 30-2 45.2-2 15.1 0 30.2.7 45 1.9 8.3 11.9 16.4 24.6 24.2 38 7.6 13.1 14.5 26.4 20.8 39.8-6.3 13.4-13.2 26.8-20.7 39.9zm32.3-13c5.4 13.4 10 26.8 13.8 39.8-13.1 3.2-26.9 5.9-41.2 8 4.9-7.7 9.8-15.6 14.4-23.7 4.6-8 8.9-16.1 13-24.1zM421.2 430c-9.3-9.6-18.6-20.3-27.8-32 9 .4 18.2.7 27.5.7 9.4 0 18.7-.2 27.8-.7-9 11.7-18.3 22.4-27.5 32zm-74.4-58.9c-14.2-2.1-27.9-4.7-41-7.9 3.7-12.9 8.3-26.2 13.5-39.5 4.1 8 8.4 16 13.1 24 4.7 8 9.5 15.8 14.4 23.4zM420.7 163c9.3 9.6 18.6 20.3 27.8 32-9-.4-18.2-.7-27.5-.7-9.4 0-18.7.2-27.8.7 9-11.7 18.3-22.4 27.5-32zm-74 58.9c-4.9 7.7-9.8 15.6-14.4 23.7-4.6 8-8.9 16-13 24-5.4-13.4-10-26.8-13.8-39.8 13.1-3.1 26.9-5.8 41.2-7.9zm-90.5 125.2c-35.4-15.1-58.3-34.9-58.3-50.6 0-15.7 22.9-35.6 58.3-50.6 8.6-3.7 18-7 27.7-10.1 5.7 19.6 13.2 40 22.5 60.9-9.2 20.8-16.6 41.1-22.2 60.6-9.9-3.1-19.3-6.5-28-10.2zM310 490c-13.6-7.8-19.5-37.5-14.9-75.7 1.1-9.4 2.9-19.3 5.1-29.4 19.6 4.8 41 8.5 63.5 10.9 13.5 18.5 27.5 35.3 41.6 50-32.6 30.3-63.2 46.9-84 46.9-4.5-.1-8.3-1-11.3-2.7zm237.2-76.2c4.7 38.2-1.1 67.9-14.6 75.8-3 1.8-6.9 2.6-11.5 2.6-20.7 0-51.4-16.5-84-46.6 14-14.7 28-31.4 41.3-49.9 22.6-2.4 44-6.1 63.6-11 2.3 10.1 4.1 19.8 5.2 29.1zm38.5-66.7c-8.6 3.7-18 7-27.7 10.1-5.7-19.6-13.2-40-22.5-60.9 9.2-20.8 16.6-41.1 22.2-60.6 9.9 3.1 19.3 6.5 28.1 10.2 35.4 15.1 58.3 34.9 58.3 50.6-.1 15.7-23 35.6-58.4 50.6zM320.8 78.4z\" />\n          <path d=\"M520.5 78.1z\" />\n        </g>\n      </svg>\n      <p>Loading ...</p>\n    </div>\n  );\n}\n","import { createContext, ReactElement } from 'react';\n\nimport DefaultSpinnerComponent from './DefaultSpinnerComponent';\n\nexport function defaultGetSpinner() {\n  return <DefaultSpinnerComponent />;\n}\n\nexport const spinnerContext = createContext<() => ReactElement>(\n  defaultGetSpinner,\n);\n\nexport const SpinnerProvider = spinnerContext.Provider;\n","import { useState, Fragment, useEffect, useContext } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\n\nimport NoData from './NoData';\nimport { spinnerContext } from './SpinnerContext';\n\nfunction Spinner({ isLoading = true }) {\n  const { data } = useChartData();\n  const [checkEmpty, startCheckEmpty] = useState(false);\n\n  useEffect(() => {\n    let timeour = null;\n    if (!isLoading) {\n      timeour = setTimeout(() => {\n        startCheckEmpty(true);\n      }, 500);\n    }\n    return () => {\n      clearTimeout(timeour);\n    };\n  }, [isLoading]);\n\n  const getSpinner = useContext(spinnerContext);\n\n  return (\n    <Fragment>\n      {isLoading && getSpinner()}\n      {checkEmpty && !isLoading && (\n        <NoData isEmpty={data && data.length === 0} />\n      )}\n    </Fragment>\n  );\n}\n\nexport default Spinner;\n","import { createContext, useContext } from 'react';\n\nexport const GlobalConetxt = createContext();\n\nexport const GlobalProvider = GlobalConetxt.Provider;\n\nexport function useGlobal() {\n  return useContext(GlobalConetxt);\n}\n","import {\n  useRef,\n  useLayoutEffect,\n  useCallback,\n  useState,\n  memo,\n  Fragment,\n} from 'react';\nimport { createPortal } from 'react-dom';\n\nimport { useGlobal } from '../../context/GlobalContext';\n\nconst styles = {\n  popup: {\n    position: 'fixed',\n    top: 0,\n    left: 0,\n    pointerEvents: 'none',\n    backgroundColor: 'gray',\n    padding: '3px',\n    borderRadius: '2px',\n    color: 'white',\n    whiteSpace: 'nowrap',\n    fontSize: '10px',\n    fontFamily: 'tahoma',\n    textShadow: 'none',\n  },\n};\n\nfunction ToolTip({\n  style,\n  className,\n  popupPlacement = 'right',\n  children,\n  title,\n  offset = { x: 0, y: 0 },\n}) {\n  const refChild = useRef();\n  const refContent = useRef();\n  const [placement, setPlacement] = useState({ x: 0, y: 0 });\n  const [show, showToolTip] = useState(false);\n  const { elementsWraperRef } = useGlobal();\n\n  useLayoutEffect(() => {\n    const getPopupPlacement = () => {\n      let x;\n      let y;\n      const childBounding = refChild.current.getBoundingClientRect();\n      const contentBounding = refContent.current.getBoundingClientRect();\n      switch (popupPlacement) {\n        case 'left':\n          x = -contentBounding.width;\n          y =\n            childBounding.height / 2 -\n            ((childBounding.height / 2) * contentBounding.height) /\n              childBounding.height;\n          break;\n        case 'right':\n          x = childBounding.width;\n          y =\n            childBounding.height / 2 -\n            ((childBounding.height / 2) * contentBounding.height) /\n              childBounding.height;\n          break;\n        case 'top':\n          x =\n            childBounding.width / 2 -\n            ((childBounding.width / 2) * contentBounding.width) /\n              childBounding.width;\n          y = -childBounding.height;\n          break;\n        case 'bottom':\n          x =\n            childBounding.width / 2 -\n            ((childBounding.width / 2) * contentBounding.width) /\n              childBounding.width;\n          y = childBounding.height;\n          break;\n        default:\n          x = 0;\n          y = 0;\n          break;\n      }\n      return { x: x + childBounding.x, y: y + childBounding.y };\n    };\n    if (show) {\n      const pl = getPopupPlacement();\n      setPlacement(pl);\n    }\n  }, [popupPlacement, show]);\n\n  const mouseOverHandler = useCallback(() => {\n    showToolTip(true);\n  }, []);\n\n  const mouseLeaveHandler = useCallback(() => {\n    showToolTip(false);\n  }, []);\n\n  return (\n    <Fragment>\n      <div\n        style={{\n          position: 'relative',\n          height: '100%',\n          display: 'flex',\n          justifyContent: 'center',\n          alignItems: 'center',\n          ...style.mainContainer,\n        }}\n        ref={refChild}\n        onMouseOver={mouseOverHandler}\n        onMouseOut={mouseLeaveHandler}\n      >\n        {children}\n      </div>\n      {show &&\n        createPortal(\n          <div\n            ref={refContent}\n            style={{\n              ...styles.popup,\n              transform: `translate(${placement.x + offset.x}px,${\n                placement.y + offset.y\n              }px)`,\n              zIndex: 999999999,\n              ...style.popup,\n            }}\n            className={className}\n          >\n            <span style={{ pointerEvents: 'none' }}>{title}</span>\n          </div>,\n          elementsWraperRef,\n        )}\n    </Fragment>\n  );\n}\n\nToolTip.defaultProps = {\n  style: {\n    popup: {},\n    mainContainer: {},\n  },\n};\n\nexport default memo(ToolTip);\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport PropTypes from 'prop-types';\nimport { memo } from 'react';\nimport { FaTimes } from 'react-icons/fa';\n\nimport ToolTip from './ToolTip/ToolTip';\n\nconst styles = css`\n  background-color: transparent;\n  border: none;\n  height: 100%;\n  display:flex,\n  justify-content:center;\n  align-items:center;\n\n  svg {\n    fill: #ca0000;\n    font-size: 16px;\n  }\n`;\nfunction CloseButton({ onClick, popupTitle, popupPlacement, className }) {\n  return (\n    <div className={className}>\n      <ToolTip title={popupTitle} popupPlacement={popupPlacement}>\n        <button css={styles} type=\"button\" onClick={onClick}>\n          <FaTimes />\n        </button>\n      </ToolTip>\n    </div>\n  );\n}\n\nCloseButton.defaultProps = {\n  onClick: () => null,\n  popupTitle: 'Close',\n  popupPlacement: 'left',\n  className: '',\n};\nCloseButton.propTypes = {\n  onClick: PropTypes.func,\n  popupTitle: PropTypes.string,\n  popupPlacement: PropTypes.string,\n  className: PropTypes.string,\n};\n\nexport default memo(CloseButton);\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { xGetFromToIndex } from 'ml-spectra-processing';\nimport { analyseMultiplet } from 'multiplet-analysis';\nimport { useState, useEffect } from 'react';\nimport { Chart } from 'react-jsgraph';\n\nimport CloseButton from '../elements/CloseButton';\n\nconst styles = css`\n  display: flex;\n  flex-direction: column;\n  width: 900px;\n  height: 400px;\n  padding: 5px;\n  button:focus {\n    outline: none;\n  }\n  .header {\n    height: 24px;\n    border-bottom: 1px solid #f0f0f0;\n    display: flex;\n    span {\n      color: #464646;\n      font-size: 15px;\n      flex: 1;\n    }\n\n    button {\n      background-color: transparent;\n      border: none;\n      svg {\n        height: 16px;\n      }\n    }\n  }\n  .container {\n    overflow-y: auto;\n    background-color: white;\n    padding-top: 10px;\n\n    .row {\n      outline: none;\n      display: flex !important;\n      flex-direction: row;\n      margin: 0;\n      div {\n        flex: 4;\n      }\n      .multiplicity {\n        flex: 2;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n      }\n    }\n\n    .row:nth-child(odd) {\n      background: #fafafa;\n    }\n  }\n`;\n\nconst loaderStyles = css`\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  flex-direction: column;\n  user-select: none;\n  width: 900px;\n  height: 400px;\n\n  svg {\n    animation-duration: 0.5s;\n    animation-name: spinAnimation;\n    animation-iteration-count: infinite;\n    animation-fill-mode: forwards;\n    animation-direction: inherit;\n    animation-timing-function: linear;\n    animation-duration: 1s;\n    width: 100px;\n    height: 100px;\n  }\n\n  @keyframes spinAnimation {\n    from {\n      transform: rotate(0deg);\n    }\n\n    to {\n      transform: rotate(360deg);\n    }\n  }\n`;\n\nfunction MultipletAnalysisModal({\n  data,\n  activeSpectrum,\n  scaleX,\n  startX,\n  endX,\n  onClose,\n}) {\n  const [analysisData, setAnalysisData] = useState();\n  const [calcStart, setCalcStartStatus] = useState(false);\n  const [isCalcFinished, setCalcFinished] = useState(false);\n\n  useEffect(() => {\n    setTimeout(() => {\n      setCalcStartStatus(true);\n    }, 400);\n  }, []);\n\n  useEffect(() => {\n    if (activeSpectrum && startX && endX && calcStart) {\n      const {\n        data: { x, y },\n        info,\n      } = data[activeSpectrum.index];\n\n      const from = scaleX().invert(startX);\n      const to = scaleX().invert(endX);\n\n      const { fromIndex, toIndex } = xGetFromToIndex(x, {\n        from,\n        to,\n      });\n      const analysesProps = {\n        x: x.slice(fromIndex, toIndex),\n        y: y.slice(fromIndex, toIndex),\n      };\n      try {\n        const result = analyseMultiplet(analysesProps, {\n          frequency: info.originFrequency,\n          takeBestPartMultiplet: true,\n          symmetrizeEachStep: true,\n          debug: true,\n        });\n        setCalcFinished(true);\n        setAnalysisData(result);\n      } catch (err) {\n        // eslint-disable-next-line no-console\n        console.log(err);\n      }\n    }\n  }, [startX, endX, data, scaleX, activeSpectrum, calcStart]);\n\n  if (!isCalcFinished) {\n    return (\n      <div css={loaderStyles}>\n        <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 841.9 595.3\">\n          <g fill=\"#61DAFB\">\n            <path d=\"M666.3 296.5c0-32.5-40.7-63.3-103.1-82.4 14.4-63.6 8-114.2-20.2-130.4-6.5-3.8-14.1-5.6-22.4-5.6v22.3c4.6 0 8.3.9 11.4 2.6 13.6 7.8 19.5 37.5 14.9 75.7-1.1 9.4-2.9 19.3-5.1 29.4-19.6-4.8-41-8.5-63.5-10.9-13.5-18.5-27.5-35.3-41.6-50 32.6-30.3 63.2-46.9 84-46.9V78c-27.5 0-63.5 19.6-99.9 53.6-36.4-33.8-72.4-53.2-99.9-53.2v22.3c20.7 0 51.4 16.5 84 46.6-14 14.7-28 31.4-41.3 49.9-22.6 2.4-44 6.1-63.6 11-2.3-10-4-19.7-5.2-29-4.7-38.2 1.1-67.9 14.6-75.8 3-1.8 6.9-2.6 11.5-2.6V78.5c-8.4 0-16 1.8-22.6 5.6-28.1 16.2-34.4 66.7-19.9 130.1-62.2 19.2-102.7 49.9-102.7 82.3 0 32.5 40.7 63.3 103.1 82.4-14.4 63.6-8 114.2 20.2 130.4 6.5 3.8 14.1 5.6 22.5 5.6 27.5 0 63.5-19.6 99.9-53.6 36.4 33.8 72.4 53.2 99.9 53.2 8.4 0 16-1.8 22.6-5.6 28.1-16.2 34.4-66.7 19.9-130.1 62-19.1 102.5-49.9 102.5-82.3zm-130.2-66.7c-3.7 12.9-8.3 26.2-13.5 39.5-4.1-8-8.4-16-13.1-24-4.6-8-9.5-15.8-14.4-23.4 14.2 2.1 27.9 4.7 41 7.9zm-45.8 106.5c-7.8 13.5-15.8 26.3-24.1 38.2-14.9 1.3-30 2-45.2 2-15.1 0-30.2-.7-45-1.9-8.3-11.9-16.4-24.6-24.2-38-7.6-13.1-14.5-26.4-20.8-39.8 6.2-13.4 13.2-26.8 20.7-39.9 7.8-13.5 15.8-26.3 24.1-38.2 14.9-1.3 30-2 45.2-2 15.1 0 30.2.7 45 1.9 8.3 11.9 16.4 24.6 24.2 38 7.6 13.1 14.5 26.4 20.8 39.8-6.3 13.4-13.2 26.8-20.7 39.9zm32.3-13c5.4 13.4 10 26.8 13.8 39.8-13.1 3.2-26.9 5.9-41.2 8 4.9-7.7 9.8-15.6 14.4-23.7 4.6-8 8.9-16.1 13-24.1zM421.2 430c-9.3-9.6-18.6-20.3-27.8-32 9 .4 18.2.7 27.5.7 9.4 0 18.7-.2 27.8-.7-9 11.7-18.3 22.4-27.5 32zm-74.4-58.9c-14.2-2.1-27.9-4.7-41-7.9 3.7-12.9 8.3-26.2 13.5-39.5 4.1 8 8.4 16 13.1 24 4.7 8 9.5 15.8 14.4 23.4zM420.7 163c9.3 9.6 18.6 20.3 27.8 32-9-.4-18.2-.7-27.5-.7-9.4 0-18.7.2-27.8.7 9-11.7 18.3-22.4 27.5-32zm-74 58.9c-4.9 7.7-9.8 15.6-14.4 23.7-4.6 8-8.9 16-13 24-5.4-13.4-10-26.8-13.8-39.8 13.1-3.1 26.9-5.8 41.2-7.9zm-90.5 125.2c-35.4-15.1-58.3-34.9-58.3-50.6 0-15.7 22.9-35.6 58.3-50.6 8.6-3.7 18-7 27.7-10.1 5.7 19.6 13.2 40 22.5 60.9-9.2 20.8-16.6 41.1-22.2 60.6-9.9-3.1-19.3-6.5-28-10.2zM310 490c-13.6-7.8-19.5-37.5-14.9-75.7 1.1-9.4 2.9-19.3 5.1-29.4 19.6 4.8 41 8.5 63.5 10.9 13.5 18.5 27.5 35.3 41.6 50-32.6 30.3-63.2 46.9-84 46.9-4.5-.1-8.3-1-11.3-2.7zm237.2-76.2c4.7 38.2-1.1 67.9-14.6 75.8-3 1.8-6.9 2.6-11.5 2.6-20.7 0-51.4-16.5-84-46.6 14-14.7 28-31.4 41.3-49.9 22.6-2.4 44-6.1 63.6-11 2.3 10.1 4.1 19.8 5.2 29.1zm38.5-66.7c-8.6 3.7-18 7-27.7 10.1-5.7-19.6-13.2-40-22.5-60.9 9.2-20.8 16.6-41.1 22.2-60.6 9.9 3.1 19.3 6.5 28.1 10.2 35.4 15.1 58.3 34.9 58.3 50.6-.1 15.7-23 35.6-58.4 50.6zM320.8 78.4z\" />\n            <path d=\"M520.5 78.1z\" />\n          </g>\n        </svg>\n        <p>Analyse Multiplet in progress. Please wait ...</p>\n      </div>\n    );\n  }\n\n  return (\n    <div css={styles}>\n      <div className=\"header handle\">\n        <span>Analyse Multiplet</span>\n\n        <CloseButton onClick={onClose} />\n      </div>\n      <div className=\"container\">\n        {analysisData &&\n          analysisData.debug &&\n          analysisData.debug.steps.map((d, index) => (\n            // eslint-disable-next-line react/no-array-index-key\n            <div key={index} className=\"row\">\n              <Chart\n                chart={{\n                  series: {\n                    type: 'line',\n                    data: d.multiplet,\n                  },\n                }}\n                style={{ height: 200, width: 400, overflow: 'auto' }}\n              />\n              <div className=\"multiplicity\">\n                <p>\n                  {analysisData.j[index]\n                    ? `${analysisData.j[index]?.multiplicity}: ${analysisData.j[\n                        index\n                      ]?.coupling.toFixed(3)} Hz`\n                    : ''}\n                </p>\n              </div>\n              <Chart\n                chart={{\n                  series: {\n                    type: 'line',\n                    data: d.errorFunction,\n                  },\n                }}\n                style={{ height: 200, width: 400, overflow: 'auto' }}\n              />\n            </div>\n          ))}\n      </div>\n    </div>\n  );\n}\n\nMultipletAnalysisModal.defaultProps = {\n  onClose: () => {\n    return null;\n  },\n};\nexport default MultipletAnalysisModal;\n","const initSetting = {\n  controllers: {\n    mws: { low: 2, high: 20 },\n  },\n  formatting: {\n    nucleus: [\n      { key: '1H', name: '1H', value: '0.00' },\n      { key: '13C', name: '13C', value: '0.00' },\n      { key: '15N', name: '15N', value: '0.00' },\n      { key: '19F', name: '19F', value: '0.00' },\n      { key: '29Si', name: '29Si', value: '0.00' },\n      { key: '31P', name: '31P', value: '0.00' },\n    ],\n  },\n};\n\nexport default initSetting;\n","import lodashGet from 'lodash/get';\nimport lodashSet from 'lodash/set';\nimport { useCallback, useEffect, useState } from 'react';\n\nfunction useStateWithLocalStorage(localStorageKey, key = null) {\n  const [value, setValue] = useState(\n    localStorage.getItem(localStorageKey) || '{}',\n  );\n  useEffect(() => {\n    localStorage.setItem(localStorageKey, value);\n  }, [localStorageKey, value]);\n\n  const setData = useCallback(\n    (data, key = null) => {\n      let castData = JSON.parse(value);\n      if (key) {\n        lodashSet(castData, key, data);\n      } else {\n        castData = { ...castData, ...data };\n      }\n      setValue(JSON.stringify(castData));\n    },\n    [value],\n  );\n  return [\n    key ? lodashGet(JSON.parse(value), key, {}) : JSON.parse(value),\n    setData,\n  ];\n}\n\nconst getLocalStorage = (localStorageKey, isJson = true) => {\n  const settings = localStorage.getItem(localStorageKey);\n  return settings && isJson ? JSON.parse(settings) : settings;\n};\n\nconst storeData = (localStorageKey, value) => {\n  localStorage.setItem(localStorageKey, value);\n};\nconst removeData = (localStorageKey) => {\n  localStorage.removeItem(localStorageKey);\n};\n\nconst getValue = (object, keyPath, defaultValue = null) => {\n  return lodashGet(object, keyPath, defaultValue);\n};\n\nexport {\n  useStateWithLocalStorage,\n  getLocalStorage,\n  getValue,\n  storeData,\n  removeData,\n};\n","import initSetting from '../../constants/InitSetting';\nimport { getLocalStorage, getValue } from '../../utility/LocalStorage';\n\nexport const zoomDefaultValues = {\n  lowStep: initSetting.controllers.mws.low,\n  highStep: initSetting.controllers.mws.high,\n  speedThreshold: 3,\n};\n\nexport default class Spectrum1DZoomHelper {\n  constructor(scale = 1, options = {}) {\n    this.scale = scale;\n    this.speedThreshold =\n      options.speedThreshold || zoomDefaultValues.speedThreshold;\n    this.slowZoomStep = options.slowZoomStep || zoomDefaultValues.lowStep;\n    this.fastZoomStep = options.fastZoomStep || zoomDefaultValues.highStep;\n  }\n\n  // eslint-disable-next-line no-unused-vars\n  wheel(deltaY, deltaMode) {\n    const deltaYValue =\n      Math.abs(deltaY).toString().length === 1\n        ? Math.abs(deltaY)\n        : Math.abs(deltaY) / 100;\n    const settings = getLocalStorage('nmr-general-settings');\n\n    const _slowZoomStep = getValue(settings, 'general.controllers.mws.low');\n    const _fastZoomStep = getValue(settings, 'general.controllers.mws.high');\n\n    const LOW_STEP = _slowZoomStep\n      ? 0.01 * _slowZoomStep\n      : 0.01 * this.slowZoomStep;\n    const FAST_STEP = _fastZoomStep\n      ? 0.05 * _fastZoomStep\n      : 0.05 * this.fastZoomStep;\n\n    let ZOOM_STEP = deltaYValue <= this.speedThreshold ? LOW_STEP : FAST_STEP;\n\n    const direction = Math.sign(deltaY);\n    const _scale =\n      direction === -1 ? this.scale + ZOOM_STEP : this.scale - ZOOM_STEP;\n    if (_scale >= 0 || _scale === 0) {\n      this.scale = _scale;\n    } else {\n      this.scale = 0;\n    }\n  }\n\n  getScale() {\n    return this.scale;\n  }\n\n  setScale(scale) {\n    this.scale = scale;\n  }\n}\n","import { zoomIdentity, scaleLinear } from 'd3';\n\nimport Spectrum1DZoomHelper from '../helper/Spectrum1DZoomHelper';\n\nexport const spectraZoomHanlders = {};\nexport const integralZoomHanlder = new Spectrum1DZoomHelper(0.5);\n\nexport const ZoomType = {\n  HORIZONTAL: 'HORIZONTAL',\n  VERTICAL: 'VERTICAL',\n  STEP_HROZENTAL: 'STEP_HROZENTAL',\n  FULL: 'FULL',\n};\n\nexport function initZoom1DHandler(data) {\n  data.forEach((datum) => {\n    if (!spectraZoomHanlders[datum.id] && datum.info.dimension === 1) {\n      spectraZoomHanlders[datum.id] = new Spectrum1DZoomHelper();\n    }\n  });\n}\n\nexport function wheel(\n  deltaY,\n  deltaMode,\n  { data, activeSpectrum, activeTab },\n  id = null,\n) {\n  if (activeSpectrum || id) {\n    spectraZoomHanlders[id ? id : activeSpectrum.id].wheel(deltaY, deltaMode);\n  } else {\n    data.forEach((datum) => {\n      if (datum.info.dimension === 1 && activeTab === datum.info.nucleus) {\n        spectraZoomHanlders[datum.id].wheel(deltaY, deltaMode);\n      }\n    });\n  }\n}\nexport function getScaleByID(id) {\n  return { [id]: spectraZoomHanlders[id].getScale(id) };\n}\n\nexport function getScale({ data, activeTab }) {\n  return data.reduce((acc, datum) => {\n    if (datum.info.dimension === 1 && activeTab === datum.info.nucleus) {\n      acc[datum.id] = spectraZoomHanlders[datum.id].getScale();\n    }\n    return acc;\n  }, {});\n}\n\nexport function setScale(scale) {\n  if (typeof scale === 'number') {\n    Object.keys(spectraZoomHanlders).forEach((id) => {\n      spectraZoomHanlders[id].setScale(scale);\n    });\n  } else if (typeof scale === 'object') {\n    Object.keys(scale).forEach((id) => {\n      spectraZoomHanlders[id].setScale(scale[id]);\n    });\n  } else {\n    throw Error('scale must be number or Object');\n  }\n}\n/**\n *\n * @param {Draft} draft\n * @param {number} defaultScale\n * @param {string | null } [spectrumID = null]\n * @param {boolean} [useOrigin = false]\n */\nfunction setZoom(draft, defaultScale = null, spectrumID = null) {\n  const { height, margin, activeSpectrum } = draft;\n  if (defaultScale) {\n    setScale(defaultScale);\n  }\n  const scale = getScale(draft);\n  draft.zoomFactor = { scale };\n\n  if (activeSpectrum === null && spectrumID === null) {\n    draft.yDomains = Object.keys(draft.yDomains).reduce((acc, id) => {\n      const _scale = scaleLinear(draft.originDomain.yDomains[id], [\n        height - margin.bottom,\n        margin.top,\n      ]);\n      const [min, max] = draft.originDomain.yDomains[id];\n      const maxPoint = Math.max(Math.abs(max), Math.abs(min));\n      const scalePoint = maxPoint === max ? 0 : min;\n      const t = zoomIdentity\n        .translate(\n          0,\n          Math.sign(scalePoint) >= 0 ? _scale(scalePoint) : _scale(scalePoint),\n        )\n        .scale(scale[id])\n        .translate(0, -_scale(0));\n      const yDomain = t.rescaleY(_scale).domain();\n      acc[id] = yDomain;\n      return acc;\n    }, {});\n  } else {\n    const spectrumId = spectrumID ? spectrumID : activeSpectrum.id;\n    const _scale = scaleLinear(draft.originDomain.yDomains[spectrumId], [\n      height - margin.bottom,\n      margin.top,\n    ]);\n\n    const t = zoomIdentity\n      .translate(0, _scale(0))\n      .scale(scale[spectrumId])\n      .translate(0, -_scale(0));\n\n    const yDomain = t.rescaleY(_scale).domain();\n    draft.yDomains = {\n      ...draft.yDomains,\n      [spectrumId]: yDomain,\n    };\n  }\n}\n\nfunction setZoom1D(draft, height, margin, index, defaultScale = null) {\n  const { originDomain, tabActiveSpectrum, activeTab } = draft;\n\n  const { id } = tabActiveSpectrum[activeTab.split(',')[index]];\n  if (defaultScale) {\n    setScale(defaultScale);\n  }\n  const scale = getScaleByID(id);\n  draft.zoomFactor = { scale };\n\n  const _scale = scaleLinear(originDomain.yDomains[id], [\n    height - margin,\n    margin,\n  ]);\n  const t = zoomIdentity\n    .translate(0, _scale(0))\n    .scale(scale[id])\n    .translate(0, -_scale(0));\n  let yDomain = t.rescaleY(_scale).domain();\n  draft.yDomains[id] = yDomain;\n}\n\nfunction setIntegralZoom(scale, draft) {\n  if (draft.activeSpectrum) {\n    const { height, margin } = draft;\n    if (draft.originIntegralYDomain[draft.activeSpectrum.id]) {\n      const _scale = scaleLinear(\n        draft.originIntegralYDomain[draft.activeSpectrum.id],\n        [height - margin.bottom, margin.top],\n      );\n\n      const scaleValue = scale < 0.1 ? 0.05 : scale;\n\n      const t = zoomIdentity\n        .translate(0, _scale(0))\n        .scale(scaleValue)\n        .translate(0, -_scale(0));\n\n      const newYDomain = t.rescaleY(_scale).domain();\n\n      draft.integralZoomFactor = { scale };\n      const activeSpectrum = draft.activeSpectrum;\n      draft.integralsYDomains[activeSpectrum.id] = newYDomain;\n    }\n  }\n}\n\nexport { setZoom, setZoom1D, setIntegralZoom };\n","import { scaleLinear } from 'd3';\n\nfunction getXScale(state, spectrumId = null) {\n  const { width, margin, xDomains, xDomain, mode } = state;\n  const range =\n    mode === 'RTL'\n      ? [width - margin.right, margin.left]\n      : [margin.left, width - margin.right];\n  return scaleLinear(spectrumId ? xDomains[spectrumId] : xDomain, range);\n}\n\nfunction getYScale(state, spectrumId = null) {\n  const { height, margin, verticalAlign, yDomain, yDomains } = state;\n  const _height =\n    verticalAlign.flag && !verticalAlign.stacked\n      ? (height - 30) / 2\n      : height - margin.bottom - 30;\n\n  let domainY = [];\n  if (spectrumId === null || yDomains[spectrumId] === undefined) {\n    domainY = [0, yDomain[1]];\n  } else {\n    domainY = [0, yDomains[spectrumId][1]];\n  }\n  return scaleLinear(domainY, [_height, margin.top]);\n}\n\nfunction getIntegralYScale(state, spectrumId) {\n  const { height, margin, verticalAlign, integralsYDomains } = state;\n  const _height =\n    verticalAlign.flag && !verticalAlign.stacked ? height / 2 : height;\n\n  return scaleLinear(integralsYDomains[spectrumId], [\n    _height - (margin.bottom + _height * 0.3),\n    margin.top,\n  ]);\n}\n\nexport { getXScale, getYScale, getIntegralYScale };\n","import { produce } from 'immer';\n\nimport { getXScale, getYScale } from '../1d/utilities/scale';\n\nexport const SET_X_SCALE = 'SET_X_SCALE';\nexport const SET_Y_SCALE = 'SET_Y_SCALE';\nexport const SET_SCALE = 'SET_SCALE';\n\nexport const scaleInitialState = {\n  scaleX: null,\n  scaleY: null,\n};\n\nexport function scaleReducer(state, action) {\n  switch (action.type) {\n    case SET_X_SCALE:\n      return produce(state, (draft) => {\n        draft.scaleX = (spectrumId = null) => getXScale(action, spectrumId);\n      });\n    case SET_Y_SCALE:\n      return produce(state, (draft) => {\n        draft.scaleY = (spectrumId = null) => getYScale(action, spectrumId);\n      });\n    case SET_SCALE:\n      return produce(state, (draft) => {\n        draft.scaleX = (spectrumId = null) => getXScale(action, spectrumId);\n        draft.scaleY = (spectrumId = null) => getYScale(action, spectrumId);\n      });\n\n    default:\n      return state;\n  }\n}\n","import { reimAbsolute } from 'ml-spectra-processing';\n\nexport const id = 'absolute';\nexport const name = 'Absolute';\n\n/**\n *\n * @param {Datum1d} datum1d\n */\n\nexport function apply(datum1D) {\n  if (!isApplicable(datum1D)) {\n    throw new Error('absolute not applicable on this data');\n  }\n\n  datum1D.data.re = reimAbsolute(datum1D.data);\n  datum1D.data.im = new Float64Array(0);\n  datum1D.info = { ...datum1D.info, isComplex: false };\n}\n\nexport function isApplicable(datum1D) {\n  if (datum1D.info.isComplex && !datum1D.info.isFid) return true;\n  return false;\n}\n\nexport function reduce() {\n  return {\n    once: false,\n    reduce: null,\n  };\n}\n","import { reimAutoPhaseCorrection } from 'ml-spectra-processing';\n\nexport const id = 'autoPhaseCorrection';\nexport const name = 'Automatic phase correction';\n\n/**\n *\n * @param {Datum1d} datum1d\n * @param {Object} [options={}]\n * @param {number} [options.ph0=0]\n * @param {number} [options.ph1=0]\n */\n\nconst defaultOptions = {\n  magnitudeMode: false,\n  minRegSize: 30,\n  maxDistanceToJoin: 256,\n};\n\nexport function apply(datum1D, options = {}) {\n  if (!isApplicable(datum1D)) {\n    throw new Error('phaseCorrection not applicable on this data');\n  }\n  options = Object.assign({}, defaultOptions, options);\n\n  return reimAutoPhaseCorrection(datum1D.data, options);\n}\n\nexport function isApplicable(datum1D) {\n  if (datum1D.info.isComplex && !datum1D.info.isFid) return true;\n  return false;\n}\n\nexport function reduce(previousValue, newValue) {\n  let reduced = Object.assign({}, previousValue);\n  for (const k in reduced) {\n    reduced[k] += newValue[k];\n  }\n  return {\n    once: true,\n    reduce: reduced,\n  };\n}\n","import airPLS from 'ml-airpls';\nimport equallySpaced from 'ml-array-xy-equally-spaced';\nimport baselineRegression from 'ml-baseline-correction-regression';\nimport PolynomialRegression from 'ml-regression-polynomial';\n\nexport const id = 'baselineCorrection';\nexport const name = 'Baseline correction';\n\n/**\n *\n * @param {Datum1d} datum1d\n */\n\nexport const baselineAlgorithms = {\n  airpls: 'airPLS',\n  polynomial: 'Polynomial',\n};\n\nexport function apply(datum1D, options = {}) {\n  if (!isApplicable(datum1D)) {\n    throw new Error('baselineCorrection not applicable on this data');\n  }\n  const { algorithm, zones } = options;\n  let { x, re } = datum1D.data;\n\n  let corrected;\n  switch (algorithm) {\n    case 'airpls':\n      corrected = airPLS(x, re, options).corrected;\n      break;\n    case 'polynomial':\n      {\n        let reduced = equallySpaced(\n          { x, y: re },\n          { numberOfPoints: 4096, zones },\n        );\n        if (zones.length === 0) {\n          let { regression } = baselineRegression(\n            reduced.x,\n            reduced.y,\n            options,\n          );\n          corrected = new Float64Array(x.length);\n          for (let i = 0; i < re.length; i++) {\n            corrected[i] = re[i] - regression.predict(x[i]);\n          }\n        } else {\n          let polynomialRegression = new PolynomialRegression(\n            x,\n            re,\n            options.degree,\n          );\n          corrected = new Float64Array(x.length);\n          for (let i = 0; i < re.length; i++) {\n            corrected[i] = re[i] - polynomialRegression.predict(x[i]);\n          }\n        }\n      }\n\n      break;\n    default:\n      throw new Error(`baselineCorrection: algorithm unknown: ${algorithm}`);\n  }\n\n  Object.assign(datum1D.data, { re: corrected });\n}\n\nexport function isApplicable(datum1D) {\n  if (!datum1D.info.isFid) return true;\n  return false;\n}\n\nexport function reduce() {\n  return {\n    once: false,\n    reduce: null,\n  };\n}\n\n/**\n * Will extract x/y points based on zones\n * @param {*} x\n * @param {*} re\n * @param {*} zones\n */\n// eslint-disable-next-line no-unused-vars,no-empty-function\nfunction getZones(x, re, zones = []) {}\n","export const id = 'digitalFilter';\nexport const name = 'Digital Filter';\n\n/**\n * Move points from the beginning to the end of FID and performs a first order phase correction\n * @param {Datum1d} datum1d\n */\n\nexport function apply(datum1D, options = {}) {\n  if (!isApplicable(datum1D)) {\n    throw new Error('Digital Filter is not applicable on this data');\n  }\n\n  let { digitalFilterValue = 0 } = options;\n  let re = new Float64Array(datum1D.data.re);\n  let im = new Float64Array(datum1D.data.im);\n\n  let pointsToShift = Math.floor(digitalFilterValue);\n\n  const skip = 0;\n  pointsToShift += 0;\n\n  const newRe = new Float64Array(re.length);\n  const newIm = new Float64Array(im.length);\n  newRe.set(re.slice(pointsToShift));\n  newRe.set(re.slice(skip, pointsToShift), re.length - pointsToShift);\n  newIm.set(im.slice(pointsToShift));\n  newIm.set(im.slice(skip, pointsToShift), im.length - pointsToShift);\n\n  datum1D.data.re = newRe;\n  datum1D.data.im = newIm;\n}\n\nexport function isApplicable(datum1D) {\n  if (datum1D.info.isComplex && datum1D.info.isFid) return true;\n  return false;\n}\n\nexport function reduce() {\n  return {\n    once: true,\n    reduce: undefined,\n  };\n}\n","import { reimFFT, reimPhaseCorrection } from 'ml-spectra-processing';\n\nexport const id = 'fft';\nexport const name = 'FFT';\n\n/**\n *\n * @param {Datum1d} datum1d\n */\n\nexport function apply(datum1D) {\n  if (!isApplicable(datum1D)) {\n    throw new Error('fft not applicable on this data');\n  }\n\n  let digitalFilterApplied = datum1D.filters.some(\n    (e) => e.name === 'digitalFilter' && e.flag,\n  );\n\n  Object.assign(datum1D.data, reimFFT(datum1D.data, { applyZeroShift: true }));\n\n  if (digitalFilterApplied) {\n    let { digitalFilter } = datum1D.info;\n    let ph1 = (digitalFilter - Math.floor(digitalFilter)) * Math.PI * 2;\n    Object.assign(datum1D.data, reimPhaseCorrection(datum1D.data, 0, ph1));\n  }\n\n  datum1D.data.x = generateXAxis(datum1D);\n  datum1D.info = { ...datum1D.info, isFid: false };\n}\n\nexport function isApplicable(datum1D) {\n  if (datum1D.info.isComplex && datum1D.info.isFid) return true;\n  return false;\n}\n\nexport function reduce() {\n  return {\n    once: true,\n    reduce: undefined,\n  };\n}\n\nfunction generateXAxis(datum1D) {\n  const info = datum1D.info;\n  const baseFrequency = parseFloat(info.baseFrequency);\n  const frequencyOffset = parseFloat(info.frequencyOffset);\n  const spectralWidth = parseFloat(info.spectralWidth);\n  const offset = frequencyOffset / baseFrequency;\n  let spectralHalfWidth = 0.5 * spectralWidth;\n  let nbPoints = datum1D.data.x.length;\n  let firstPoint = offset - spectralHalfWidth;\n  let dx = spectralWidth / (nbPoints - 1);\n  const xAxis = new Array(nbPoints);\n  for (let i = 0; i < nbPoints; i++) {\n    xAxis[i] = firstPoint;\n    firstPoint += dx;\n  }\n  return xAxis;\n}\n","export const id = 'lineBroadening';\nexport const name = 'Line broadening';\n\n/**\n *\n * @param {Datum1d} datum1d\n * @param {Object} [value]\n */\n\nexport function apply(datum1D, value) {\n  if (!isApplicable(datum1D)) {\n    throw new Error('lineBroadening not applicable on this data');\n  }\n\n  let grpdly = datum1D.info.digitalFilter;\n  let pointsToShift;\n  if (grpdly > 0) {\n    pointsToShift = Math.floor(grpdly);\n  } else {\n    pointsToShift = 0;\n  }\n\n  const re = datum1D.data.re;\n  const im = datum1D.data.im;\n  const t = datum1D.data.x;\n\n  const length = re.length;\n\n  const newRE = new Float64Array(length); // I don't think we need a new array... here\n  const newIM = new Float64Array(length);\n  //if (value !== 0) {// is it OK to skip this line if \"value\" is zero?\n  //please check this test of zero is correct !== or != ...\n  const dw = (t[length - 1] - t[0]) / (length - 1); //REPLACE CONSTANT with calculated value... : for this we need AQ or DW to set it right...\n  // convert line broadening in Hz into exponential coefficient:\n  const em = -value * Math.exp(1);\n\n  const coefExp = Math.exp(em * dw);\n  let curFactor = Math.exp(em * t[0]); // in case does not start at zero\n  for (let i = 0; i < length - pointsToShift; i++) {\n    newRE[i] = re[i] * curFactor;\n    newIM[i] = im[i] * curFactor;\n    curFactor = curFactor * coefExp;\n  }\n  curFactor = Math.exp(em * t[0]);\n  for (let i = length; i > length - pointsToShift; i--) {\n    newRE[i] = re[i] * curFactor;\n    newIM[i] = im[i] * curFactor;\n    curFactor = curFactor * coefExp;\n  }\n  datum1D.data = { ...datum1D.data, ...{ re: newRE, im: newIM } };\n  //}\n}\nexport function isApplicable(datum1D) {\n  if (datum1D.info.isComplex && datum1D.info.isFid) return true;\n  return false;\n}\n\nexport function reduce(previousValue, newValue) {\n  return {\n    once: true,\n    reduce: previousValue + newValue,\n  };\n}\n","import { reimPhaseCorrection } from 'ml-spectra-processing';\n\nexport const id = 'phaseCorrection';\nexport const name = 'Phase correction';\n\n/**\n *\n * @param {Datum1d} datum1d\n * @param {Object} [options={}]\n * @param {number} [options.ph0=0]\n * @param {number} [options.ph1=0]\n */\n\nexport function apply(datum1D, options = {}) {\n  if (!isApplicable(datum1D)) {\n    throw new Error('phaseCorrection not applicable on this data');\n  }\n  let { ph0, ph1 } = options;\n  ph0 *= Math.PI / 180.0;\n  ph1 *= Math.PI / 180.0;\n  Object.assign(datum1D.data, reimPhaseCorrection(datum1D.data, ph0, ph1));\n}\n\nexport function isApplicable(datum1D) {\n  if (datum1D.info.isComplex && !datum1D.info.isFid) return true;\n  return false;\n}\n\nexport function reduce(previousValue, newValue) {\n  let reduced = Object.assign({}, previousValue);\n  for (const k in reduced) {\n    reduced[k] += newValue[k];\n  }\n  return {\n    once: true,\n    reduce: reduced,\n  };\n}\n","/**\n *\n * @param {Object} datum1d\n * @param {number} [shiftValue=0]\n */\n\nexport const id = 'shiftX';\nexport const name = 'Shift X';\n\nexport function apply(datum1D, shiftValue = 0) {\n  if (!isApplicable(datum1D)) {\n    throw new Error('shiftX not applicable on this data');\n  }\n\n  datum1D.data.x = datum1D.data.x.map((val) => val + shiftValue);\n}\n\nexport function isApplicable() {\n  return true;\n}\n\nexport function reduce(previousValue, newValue) {\n  return {\n    once: true,\n    reduce: previousValue + newValue,\n  };\n}\n","export const id = 'zeroFilling';\nexport const name = 'Zero Filling';\n/**\n *\n * @param {Datum1d} datum1d\n * @param {Object} [size]\n */\nexport function apply(datum1D, size) {\n  if (!isApplicable(datum1D)) {\n    throw new Error('zeroFilling not applicable on this data');\n  }\n\n  let digitalFilterApplied = datum1D.filters.some(\n    (e) => e.name === 'digitalFilter' && e.flag,\n  );\n\n  let grpdly = datum1D.info.digitalFilter;\n  let pointsToShift;\n  if (grpdly > 0 && digitalFilterApplied) {\n    pointsToShift = Math.floor(grpdly);\n  } else {\n    pointsToShift = 0;\n  }\n\n  const { re, im, x } = datum1D.data;\n\n  let newRE = new Float64Array(size);\n  let newIM = new Float64Array(size);\n  let newX = new Float64Array(size);\n\n  const length = Math.min(size, re.length);\n\n  newRE.set(re.slice(0, length - pointsToShift));\n  newIM.set(im.slice(0, length - pointsToShift));\n  newX.set(x.slice(0, length - pointsToShift));\n\n  let diff = x[1] - x[0];\n  let currentX = x[length - pointsToShift - 1];\n  for (let i = length - pointsToShift; i < size; i++) {\n    currentX += diff;\n    newX[i] = currentX;\n  }\n\n  if (pointsToShift > 0 && pointsToShift < size) {\n    newRE.set(re.slice(re.length - pointsToShift), size - pointsToShift);\n    newIM.set(im.slice(re.length - pointsToShift), size - pointsToShift);\n  }\n\n  datum1D.data = { ...datum1D.data, ...{ re: newRE, im: newIM, x: newX } };\n}\n\nexport function isApplicable(datum1D) {\n  if (datum1D.info.isComplex && datum1D.info.isFid) return true;\n  return false;\n}\n\nexport function reduce(_previousValue, newValue) {\n  return {\n    once: true,\n    reduce: newValue,\n  };\n}\n","/**\n *\n * @param {Object} datum2d\n * @param {number} [shiftValue=0]\n */\n\nexport const id = 'shift2DX';\nexport const name = 'Shift 2D X';\n\nexport function apply(datum2D, shiftValue = 0) {\n  if (!isApplicable(datum2D)) {\n    throw new Error('shiftX not applicable on this data');\n  }\n  datum2D.data.minX += shiftValue;\n  datum2D.data.maxX += shiftValue;\n}\n\nexport function isApplicable() {\n  return true;\n}\n\nexport function reduce(previousValue, newValue) {\n  return {\n    once: true,\n    reduce: previousValue + newValue,\n  };\n}\n","/**\n *\n * @param {Object} datum2d\n * @param {number} [shiftValue=0]\n */\n\nexport const id = 'shift2DY';\nexport const name = 'Shift 2D Y';\n\nexport function apply(datum2D, shiftValue = 0) {\n  if (!isApplicable(datum2D)) {\n    throw new Error('shiftY not applicable on this data');\n  }\n  datum2D.data.minY += shiftValue;\n  datum2D.data.maxY += shiftValue;\n}\n\nexport function isApplicable() {\n  return true;\n}\n\nexport function reduce(previousValue, newValue) {\n  return {\n    once: true,\n    reduce: previousValue + newValue,\n  };\n}\n","import * as absolute from './data1d/filter1d/absolute';\nimport * as autoPhaseCorrection from './data1d/filter1d/autoPhaseCorrection';\nimport * as baselineCorrection from './data1d/filter1d/baselineCorrection';\nimport * as digitalFilter from './data1d/filter1d/digitalFilter';\nimport * as fft from './data1d/filter1d/fft';\nimport * as lineBroadening from './data1d/filter1d/lineBroadening';\nimport * as phaseCorrection from './data1d/filter1d/phaseCorrection';\nimport * as shiftX from './data1d/filter1d/shiftX';\nimport * as zeroFilling from './data1d/filter1d/zeroFilling';\nimport * as shift2DX from './data2d/filter2d/shiftX';\nimport * as shift2DY from './data2d/filter2d/shiftY';\n\nexport const Filters = {\n  absolute,\n  baselineCorrection,\n  lineBroadening,\n  fft,\n  phaseCorrection,\n  autoPhaseCorrection,\n  shiftX,\n  zeroFilling,\n  digitalFilter,\n  shift2DX,\n  shift2DY,\n};\n","import { Filters } from '../../data/Filters';\n\nexport const options = {\n  zoom: {\n    id: 'zoom',\n    label: 'Zoom',\n    hasOptionPanel: false,\n    isFilter: false,\n  },\n  peakPicking: {\n    id: 'peakPicking',\n    label: 'Peaks Picking',\n    hasOptionPanel: true,\n    isFilter: false,\n  },\n  integral: {\n    id: 'integral',\n    label: 'integral Tool',\n    hasOptionPanel: false,\n    isFilter: false,\n  },\n  zone2D: {\n    id: 'zone2D',\n    label: 'Zone Tool',\n    hasOptionPanel: true,\n    isFilter: false,\n  },\n  slicingTool: {\n    id: 'slicingTool',\n    label: 'Slicing Tool',\n    hasOptionPanel: false,\n    isFilter: false,\n  },\n  HMove: {\n    id: 'HMove',\n    label: 'Move spectrum horizontally',\n    hasOptionPanel: false,\n    isFilter: false,\n  },\n  equalizerTool: {\n    id: 'equalizerTool',\n    label: 'Equalizer Tool',\n    hasOptionPanel: false,\n    isFilter: false,\n  },\n  rangesPicking: {\n    id: 'rangesPicking',\n    label: 'Ranges Picking ( Press r )',\n    hasOptionPanel: true,\n    isFilter: false,\n  },\n  zeroFilling: {\n    id: Filters.zeroFilling.id,\n    label: Filters.zeroFilling.name,\n    hasOptionPanel: true,\n    isFilter: true,\n  },\n  phaseCorrection: {\n    id: Filters.phaseCorrection.id,\n    label: `${Filters.phaseCorrection.name} ( Press a )`,\n    hasOptionPanel: true,\n    isFilter: true,\n  },\n  baseLineCorrection: {\n    id: 'baseLineCorrection',\n    label: 'baseline correction ( Press b )',\n    hasOptionPanel: true,\n    isFilter: true,\n  },\n  generalSelector: {\n    id: 'generalSelector',\n    label: 'range general selecttor',\n    hasOptionPanel: false,\n    isFilter: false,\n  },\n\n  editRange: {\n    id: 'editRange',\n    label: 'edit range',\n    hasOptionPanel: false,\n    isFilter: false,\n  },\n\n  multipleSpectraAnalysis: {\n    id: 'multipleSpectraAnalysis',\n    label: 'Multiple Spectra Analysis',\n    hasOptionPanel: false,\n    isFilter: false,\n  },\n};\n","import { useContext } from 'react';\n\nimport { BrushContext } from '../EventsTrackers/BrushTracker';\nimport { useChartData } from '../context/ChartContext';\nimport { options } from '../toolbar/ToolTypes';\n\nconst styles = {\n  container: {\n    transformOrigin: 'top left',\n    position: 'absolute',\n    top: '0px',\n    left: '0px',\n    zoom: '100%',\n  },\n};\n\nconst allowTools = [\n  options.zoom.id,\n  options.zeroFilling.id,\n  options.peakPicking.id,\n  options.integral.id,\n  options.phaseCorrection.id,\n  options.baseLineCorrection.id,\n  options.rangesPicking.id,\n  options.zone2D.id,\n  options.slicingTool.id,\n  options.editRange.id,\n  options.multipleSpectraAnalysis.id,\n];\n\nexport const BRUSH_TYPE = {\n  X: 1,\n  Y: 2,\n  XY: 3,\n};\n\nfunction BrushXY({\n  brushType,\n  dimensionBorder,\n  width: widthProps,\n  height: heightProps,\n}) {\n  let { width, height, selectedTool } = useChartData();\n  let { startX, endX, startY, endY, step } = useContext(BrushContext);\n\n  if (\n    !allowTools.includes(selectedTool) ||\n    step !== 'brushing' ||\n    !dimensionBorder ||\n    (dimensionBorder.startX && startX < dimensionBorder.startX) ||\n    (dimensionBorder.startY && startY < dimensionBorder.startY) ||\n    ((dimensionBorder.endX && Math.sign(endX - startX) === 1\n      ? endX > dimensionBorder.endX\n      : endX < dimensionBorder.startX) &&\n      (dimensionBorder.endX && Math.sign(endY - startY) === 1\n        ? endY > dimensionBorder.endY\n        : endY < dimensionBorder.startY))\n  ) {\n    return null;\n  }\n\n  width = widthProps ? widthProps : width;\n\n  height = heightProps ? heightProps : height;\n\n  endX =\n    dimensionBorder.endX && endX > dimensionBorder.endX\n      ? dimensionBorder.endX\n      : dimensionBorder.startX && endX < dimensionBorder.startX\n      ? dimensionBorder.startX\n      : endX;\n  endY =\n    dimensionBorder.endY && endY > dimensionBorder.endY\n      ? dimensionBorder.endY\n      : dimensionBorder.startY && endY < dimensionBorder.startY\n      ? dimensionBorder.startY\n      : endY;\n\n  const scaleX =\n    brushType === BRUSH_TYPE.X || brushType === BRUSH_TYPE.XY\n      ? (endX - startX) / width\n      : 1;\n  startX =\n    brushType === BRUSH_TYPE.X || brushType === BRUSH_TYPE.XY ? startX : 0;\n\n  const scaleY =\n    brushType === BRUSH_TYPE.Y || brushType === BRUSH_TYPE.XY\n      ? (endY - startY) / height\n      : 1;\n  startY =\n    brushType === BRUSH_TYPE.Y || brushType === BRUSH_TYPE.XY ? startY : 0;\n  return (\n    <div\n      style={{\n        ...styles.container,\n        transform: `translate(${startX}px, ${startY}px) scale(${scaleX},${scaleY})`,\n        willChange: 'transform',\n      }}\n    >\n      <svg width={width} height={height}>\n        <rect\n          x=\"0\"\n          y=\"0\"\n          width={width}\n          height={height}\n          fill=\"gray\"\n          opacity=\"0.2\"\n        />\n      </svg>\n    </div>\n  );\n}\n\nBrushXY.defaultProps = {\n  brushType: BRUSH_TYPE.XY,\n  dimensionBorder: {\n    startX: 0,\n    startY: 0,\n  },\n  width: null,\n  height: null,\n};\n\nexport default BrushXY;\n","import { useContext } from 'react';\n\nimport { BrushContext } from '../EventsTrackers/BrushTracker';\nimport { MouseContext } from '../EventsTrackers/MouseTracker';\nimport { useChartData } from '../context/ChartContext';\nimport { options } from '../toolbar/ToolTypes';\n\nconst styles = {\n  line: {\n    stroke: 'black',\n    strokeOpacity: '1',\n    shapeRendering: 'crispEdges',\n    strokeWidth: '1',\n    willChange: 'transform',\n  },\n};\n\nconst allowTools = [\n  options.zoom.id,\n  options.equalizerTool.id,\n  options.baseLineCorrection.id,\n  options.zone2D.id,\n  options.slicingTool.id,\n  options.integral.id,\n  options.rangesPicking.id,\n  options.editRange.id,\n  options.multipleSpectraAnalysis.id,\n];\n\nfunction CrossLinePointer() {\n  const { height, width, margin, selectedTool } = useChartData();\n  let position = useContext(MouseContext);\n  const brushState = useContext(BrushContext);\n\n  if (\n    !allowTools.includes(selectedTool) ||\n    brushState.step === 'brushing' ||\n    !position ||\n    position.x > width - margin.right ||\n    position.y > height - margin.bottom ||\n    !width ||\n    !height\n  ) {\n    return null;\n  }\n  return (\n    <div\n      key=\"crossLine\"\n      style={{\n        willChange: 'transform',\n        cursor: 'crosshair',\n        transform: `translate(${-width + position.x}px, ${\n          -height + position.y\n        }px)`,\n        position: 'absolute',\n        top: 0,\n        left: 0,\n        pointerEvents: 'none',\n        overflow: 'visible',\n        width: 2 * width,\n        height: 2 * height,\n      }}\n    >\n      <svg width={2 * width} height={2 * height}>\n        <line\n          style={styles.line}\n          x1={width}\n          y1=\"0\"\n          x2={width}\n          y2={height * 2}\n          key=\"vertical_line\"\n        />\n        <line\n          style={styles.line}\n          x1=\"0\"\n          y1={height}\n          x2={width * 2}\n          y2={height}\n          key=\"horizontal_line\"\n        />\n      </svg>\n    </div>\n  );\n}\n\nexport default CrossLinePointer;\n","import EventEmitter from 'eventemitter3';\n\nconst eventEmitter = new EventEmitter();\n\nconst Emitter = {\n  on: (event, fn) => eventEmitter.on(event, fn),\n  once: (event, fn) => eventEmitter.once(event, fn),\n  off: (event, fn) => eventEmitter.off(event, fn),\n  emit: (event, payload) => eventEmitter.emit(event, payload),\n};\n\nObject.freeze(Emitter);\n\nexport default Emitter;\n","function DeleteButton({ x, y, onDelete, fill }) {\n  return (\n    <svg\n      className=\"delete-button\"\n      x={x}\n      y={y}\n      onClick={onDelete}\n      data-no-export=\"true\"\n    >\n      <rect rx=\"5\" width=\"16\" height=\"16\" fill={fill} />\n      <line x1=\"5\" x2=\"10\" y1=\"8\" y2=\"8\" stroke=\"white\" strokeWidth=\"2\" />\n    </svg>\n  );\n}\n\nDeleteButton.defaultProps = {\n  onDelete: () => null,\n  fill: '#c81121',\n  x: 'initial',\n  y: 'initial',\n};\n\nexport default DeleteButton;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\nimport { useDispatch } from '../context/DispatchContext';\nimport { useScale } from '../context/ScaleContext';\nimport DeleteButton from '../elements/DeleteButton';\nimport { DELETE_BASE_LINE_ZONE } from '../reducer/types/Types';\n\nconst styles = css`\n  pointer-events: bounding-box;\n  user-select: 'none';\n  -webkit-user-select: none; /* Chrome all / Safari all */\n  -moz-user-select: none; /* Firefox all */\n\n  .zone-area {\n    height: 100%;\n    fill: #b8b8b857;\n    cursor: pointer;\n  }\n  .delete-button {\n    display: none;\n    cursor: pointer;\n  }\n  :hover .delete-button {\n    display: block;\n  }\n`;\n\nfunction BaseLineZones() {\n  const { baseLineZones } = useChartData();\n\n  const { scaleX } = useScale();\n  const dispatch = useDispatch();\n\n  const deleteRangeHandler = useCallback(\n    (id) => {\n      dispatch({ type: DELETE_BASE_LINE_ZONE, id });\n    },\n    [dispatch],\n  );\n\n  return (\n    baseLineZones &&\n    Array.isArray(baseLineZones) &&\n    baseLineZones.length > 0 && (\n      <g>\n        {baseLineZones.map((zone) => (\n          <g\n            key={zone.id}\n            transform={`translate(${scaleX()(zone.to)},0)`}\n            css={styles}\n          >\n            <DeleteButton\n              x={-20}\n              y={10}\n              onDelete={() => deleteRangeHandler(zone.id)}\n            />\n            <rect\n              x=\"0\"\n              width={`${scaleX()(zone.from) - scaleX()(zone.to)}`}\n              className=\"zone-area\"\n            />\n          </g>\n        ))}\n      </g>\n    )\n  );\n}\n\nexport default BaseLineZones;\n","const integralDefaultValues = {\n  showAbsolute: false,\n  absoluteFormat: '0.00',\n  showRelative: true,\n  relativeFormat: '0.00',\n  color: '#000000',\n  strokeWidth: 1,\n};\n\nconst rangeDefaultValues = {\n  showFrom: false,\n  fromFormat: '0.00',\n  showTo: false,\n  toFormat: '0.00',\n  showAbsolute: false,\n  absoluteFormat: '0.00',\n  showRelative: true,\n  relativeFormat: '0.00',\n};\n\nconst peaksDefaultValues = {\n  showPeakNumber: true,\n  peakNumberFormat: '0',\n  showPeakIndex: false,\n  peakIndexFormat: '0.00',\n  showDeltaPPM: true,\n  deltaPPMFormat: '0.00',\n  showDeltaHz: false,\n  deltaHzFormat: '0.00',\n  showPeakWidth: false,\n  peakWidthFormat: '00.0000',\n  showIntensity: true,\n  intensityFormat: '0.00',\n};\n\nexport { peaksDefaultValues, integralDefaultValues, rangeDefaultValues };\n","/** @jsxImportSource @emotion/react */\nimport { Fragment, useCallback, useRef, useState } from 'react';\nimport Draggable from 'react-draggable';\n\nimport { useChartData } from '../context/ChartContext';\nimport { useScale } from '../context/ScaleContext';\n\nfunction Resizable({ from, to, onDrag, onDrop }) {\n  const { height, margin, mode } = useChartData();\n  const [rightDragVisibility, setRightDragVisibility] = useState(false);\n  const [leftDragVisibility, setLeftDragVisibility] = useState(false);\n  const [enable, setEnable] = useState(true);\n  const draggableRightRef = useRef(null);\n  const draggableLeftRef = useRef(null);\n\n  const { scaleX } = useScale();\n\n  const handleRightStart = useCallback(\n    (e) => {\n      e.preventDefault();\n      e.stopPropagation();\n      setRightDragVisibility(true);\n\n      if (onDrag) {\n        onDrag();\n      }\n    },\n    [onDrag],\n  );\n  const handleRightDrag = useCallback(() => {\n    // Empty\n  }, []);\n  const handleRightStop = useCallback(\n    (e) => {\n      e.preventDefault();\n      e.stopPropagation();\n\n      setRightDragVisibility(false);\n\n      const _range =\n        mode === 'RTL'\n          ? [scaleX().invert(e.layerX), to]\n          : [to, scaleX().invert(e.layerX)];\n\n      let resized;\n      if (_range[1] > _range[0]) {\n        resized = {\n          from: _range[0],\n          to: _range[1],\n        };\n      } else {\n        resized = {\n          from,\n          to,\n        };\n      }\n\n      onDrop(resized);\n    },\n    [from, mode, onDrop, scaleX, to],\n  );\n\n  const handleLeftStart = useCallback(\n    (e) => {\n      e.preventDefault();\n      e.stopPropagation();\n      setLeftDragVisibility(true);\n\n      if (onDrag) {\n        onDrag();\n      }\n    },\n    [onDrag],\n  );\n  const handleLeftDrag = useCallback(() => {\n    // Empty\n  }, []);\n  const handleLeftStop = useCallback(\n    (e) => {\n      e.preventDefault();\n      e.stopPropagation();\n\n      setLeftDragVisibility(false);\n      const _range =\n        mode === 'RTL'\n          ? [from, scaleX().invert(e.layerX)]\n          : [scaleX().invert(e.layerX), from];\n\n      let resized;\n      if (_range[1] > _range[0]) {\n        resized = {\n          from: _range[0],\n          to: _range[1],\n        };\n      } else {\n        resized = {\n          from,\n          to,\n        };\n      }\n\n      onDrop(resized);\n    },\n    [from, mode, onDrop, scaleX, to],\n  );\n\n  const mouseDownCaptureHandler = useCallback(({ shiftKey }) => {\n    if (shiftKey) {\n      setEnable(false);\n    }\n  }, []);\n  const mouseUpCaptureHandler = useCallback(() => {\n    setEnable(true);\n  }, []);\n  const mouseOverHandler = useCallback(({ target, shiftKey }) => {\n    if (shiftKey) {\n      target.style.cursor = 'crosshair';\n    } else {\n      target.style.cursor = 'ew-resize';\n    }\n  }, []);\n\n  return (\n    <Fragment>\n      <Draggable\n        axis=\"x\"\n        defaultPosition={{\n          x: scaleX()(from),\n          y: 0,\n        }}\n        position={{\n          x: scaleX()(from),\n          y: 0,\n        }}\n        scale={1}\n        handle=\".handle\"\n        onStart={handleRightStart}\n        onDrag={handleRightDrag}\n        onStop={handleRightStop}\n        nodeRef={draggableRightRef}\n      >\n        <rect\n          ref={draggableRightRef}\n          className={enable ? 'handle' : ''}\n          width={rightDragVisibility ? 1 : 6}\n          fill=\"red\"\n          height={height + margin.top}\n          style={{ fillOpacity: rightDragVisibility ? 1 : 0 }}\n          onMouseDownCapture={mouseDownCaptureHandler}\n          onMouseUpCapture={mouseUpCaptureHandler}\n          onMouseEnter={mouseOverHandler}\n        />\n      </Draggable>\n\n      <Draggable\n        axis=\"x\"\n        defaultPosition={{\n          x: scaleX()(to),\n          y: 0,\n        }}\n        position={{\n          x: scaleX()(to),\n          y: 0,\n        }}\n        handle=\".handle\"\n        scale={1}\n        onStart={handleLeftStart}\n        onDrag={handleLeftDrag}\n        onStop={handleLeftStop}\n        nodeRef={draggableLeftRef}\n      >\n        <rect\n          ref={draggableLeftRef}\n          className={enable ? 'handle' : ''}\n          width={leftDragVisibility ? 1 : 6}\n          fill=\"red\"\n          height={height + margin.top}\n          style={{ fillOpacity: leftDragVisibility ? 1 : 0 }}\n          onMouseDownCapture={mouseDownCaptureHandler}\n          onMouseUpCapture={mouseUpCaptureHandler}\n          onMouseEnter={mouseOverHandler}\n        />\n      </Draggable>\n    </Fragment>\n  );\n}\n\nexport default Resizable;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport * as d3 from 'd3';\nimport { useCallback, Fragment, useMemo } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\nimport { useDispatch } from '../context/DispatchContext';\nimport { useScale } from '../context/ScaleContext';\nimport { TYPES, useHighlight } from '../highlight/index';\nimport { RESIZE_INTEGRAL } from '../reducer/types/Types';\n\nimport Resizable from './Resizable';\n\nconst stylesOnHover = css`\n  pointer-events: bounding-box;\n  @-moz-document url-prefix() {\n    pointer-events: fill;\n  }\n  // // disabled because Resizable component appears now when hovering over it\n  // :hover .target {\n  //   visibility: visible !important;\n  //   cursor: pointer;\n  // }\n  .highlight {\n    fill: transparent;\n  }\n  .target {\n    visibility: hidden;\n  }\n`;\n\nconst stylesHighlighted = css`\n  pointer-events: bounding-box;\n\n  @-moz-document url-prefix() {\n    pointer-events: fill;\n  }\n  fill: #ff6f0057;\n\n  .target {\n    visibility: visible;\n  }\n`;\n\nfunction IntegralResizable({ integralSeries, integralData }) {\n  const { height, margin } = useChartData();\n  const { scaleX } = useScale();\n\n  const { id, integral } = integralData;\n\n  const highlight = useHighlight([id], TYPES.INTEGRAL);\n\n  // isn't it actually the from/to range? -> return [from, to]\n  const xBoundary = useMemo(() => {\n    if (integralSeries) {\n      return d3.extent(integralSeries.x);\n    } else {\n      return [];\n    }\n  }, [integralSeries]);\n\n  const dispatch = useDispatch();\n\n  const handleOnStopResizing = useCallback(\n    (resized) => {\n      dispatch({\n        type: RESIZE_INTEGRAL,\n        data: { ...integralData, ...resized },\n      });\n    },\n    [dispatch, integralData],\n  );\n\n  const handleOnEnterNotation = useCallback(() => {\n    highlight.show();\n  }, [highlight]);\n\n  const handleOnMouseLeaveNotation = useCallback(() => {\n    highlight.hide();\n  }, [highlight]);\n\n  const x0 = xBoundary[0] ? scaleX()(xBoundary[0]) : 0;\n  const x1 = xBoundary[1] ? scaleX()(xBoundary[1]) : 0;\n\n  return (\n    <Fragment>\n      <g\n        css={highlight.isActive ? stylesHighlighted : stylesOnHover}\n        onMouseEnter={handleOnEnterNotation}\n        onMouseLeave={handleOnMouseLeaveNotation}\n      >\n        <rect\n          data-no-export=\"true\"\n          x={`${x1}`}\n          y=\"0\"\n          width={`${x0 - x1}`}\n          height={height - margin.bottom}\n          className=\"highlight\"\n        />\n        {/* {highlight.isActive && ( */}\n        <text\n          x={x1}\n          y={height - margin.bottom + 30}\n          fill=\"black\"\n          style={{ fontSize: '12px', fontWeight: 'bold' }}\n        >\n          {integral !== undefined ? integral.toFixed(2) : ''}\n        </text>\n        {/* )} */}\n        <Resizable\n          from={integralData.from}\n          to={integralData.to}\n          // onDrag={handleOnStartResizing}\n          onDrop={handleOnStopResizing}\n          data-no-export=\"true\"\n        />\n      </g>\n    </Fragment>\n  );\n}\n\nexport default IntegralResizable;\n","import { xyReduce, xyIntegral } from 'ml-spectra-processing';\nimport { useEffect, useState, useCallback, Fragment, useMemo } from 'react';\n\nimport { usePreferences } from '../context/PreferencesContext';\nimport { integralDefaultValues } from '../panels/extra/preferences/defaultValues';\nimport { getValue } from '../utility/LocalStorage';\n\nimport IntegralResizable from './IntegralResizable';\n\nfunction Integral({\n  integralData,\n  x,\n  y,\n  xDomain,\n  isActive,\n  spectrumID,\n  scaleY,\n  scaleX,\n}) {\n  const { from, to } = integralData;\n  const [integral, setIntegral] = useState();\n  // const { preferences } = useChartData();\n  const preferences = usePreferences();\n\n  const integralSettings = useMemo(() => {\n    let {\n      color = integralDefaultValues.color,\n      strokeWidth = integralDefaultValues.strokeWidth,\n    } = getValue(preferences, 'formatting.panels.integrals') || {};\n    return { color, strokeWidth };\n  }, [preferences]);\n\n  useEffect(() => {\n    const integralResult = xyIntegral(\n      { x: x, y: y },\n      {\n        from: from,\n        to: to,\n        reverse: true,\n      },\n    );\n    setIntegral(integralResult);\n  }, [from, to, x, y]);\n\n  const makePath = useCallback(() => {\n    if (integral && scaleY) {\n      const pathPoints = xyReduce(integral, {\n        from: xDomain[0],\n        to: xDomain[1],\n        nbPoints: 200,\n        optimize: true,\n      });\n\n      let path = `M ${scaleX()(pathPoints.x[0])} ${scaleY(pathPoints.y[0])}`;\n      path += pathPoints.x.slice(1).reduce((accumulator, point, i) => {\n        accumulator += ` L ${scaleX()(point)} ${scaleY(pathPoints.y[i + 1])}`;\n        return accumulator;\n      }, '');\n\n      return path;\n    } else {\n      return '';\n    }\n  }, [integral, scaleX, scaleY, xDomain]);\n\n  return (\n    <Fragment>\n      <path\n        className=\"line\"\n        stroke={integralSettings.color}\n        strokeWidth={integralSettings.strokeWidth}\n        fill=\"none\"\n        style={{\n          transformOrigin: 'center top',\n          opacity: isActive ? 1 : 0.2,\n        }}\n        d={makePath()}\n        // vectorEffect=\"non-scaling-stroke\"\n      />\n\n      <IntegralResizable\n        spectrumID={spectrumID}\n        integralSeries={integral}\n        integralData={integralData}\n        scaleY={scaleY}\n      />\n    </Fragment>\n  );\n}\n\nexport default Integral;\n","import { useMemo } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\nimport { useScale } from '../context/ScaleContext';\n\nimport Integral from './Integral';\nimport { getIntegralYScale } from './utilities/scale';\n\nfunction IntegralsSeries() {\n  const {\n    xDomain,\n    activeSpectrum,\n    data,\n    height,\n    margin,\n    verticalAlign,\n    integralsYDomains,\n    displayerKey,\n  } = useChartData();\n  const { scaleX } = useScale();\n\n  const scaleY = useMemo(() => {\n    if (activeSpectrum && integralsYDomains[activeSpectrum.id]) {\n      return getIntegralYScale(\n        { height, margin, verticalAlign, integralsYDomains },\n        activeSpectrum.id,\n      );\n    } else {\n      return null;\n    }\n  }, [activeSpectrum, height, integralsYDomains, margin, verticalAlign]);\n\n  const Integrals = useMemo(() => {\n    const IsActive = (id) => {\n      return activeSpectrum === null\n        ? true\n        : id === activeSpectrum.id\n        ? true\n        : false;\n    };\n\n    return (\n      data &&\n      data[0] &&\n      data\n        .filter(\n          (d) =>\n            d.display.isVisible === true &&\n            d.display.isVisibleInDomain === true,\n        )\n        .map(\n          (spectrum) =>\n            spectrum.integrals &&\n            spectrum.integrals.values &&\n            spectrum.integrals.values.map((integral) => (\n              <Integral\n                key={integral.id}\n                spectrumID={spectrum.id}\n                integralData={integral}\n                x={spectrum.data.x}\n                y={spectrum.data.y}\n                isActive={IsActive(spectrum.id)}\n                xDomain={xDomain}\n                scaleY={scaleY}\n                scaleX={scaleX}\n              />\n            )),\n        )\n    );\n  }, [activeSpectrum, data, scaleX, scaleY, xDomain]);\n\n  return <g clipPath={`url(#${displayerKey}clip-chart-1d)`}>{Integrals}</g>;\n}\n\nexport default IntegralsSeries;\n","import get from 'lodash/get';\nimport { xyReduce } from 'ml-spectra-processing';\nimport { useMemo } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\nimport { usePreferences } from '../context/PreferencesContext';\nimport { useScale } from '../context/ScaleContext';\n\nfunction Line({ data, id, display, index }) {\n  const { xDomain, activeSpectrum, verticalAlign } = useChartData();\n  const preferences = usePreferences();\n  const { scaleX, scaleY } = useScale();\n\n  const isActive = useMemo(() => {\n    return activeSpectrum === null\n      ? true\n      : id === activeSpectrum.id\n      ? true\n      : false;\n  }, [activeSpectrum, id]);\n\n  const vAlign = useMemo(() => {\n    return verticalAlign.flag\n      ? verticalAlign.stacked\n        ? index * verticalAlign.value\n        : 0\n      : 0;\n  }, [index, verticalAlign.flag, verticalAlign.stacked, verticalAlign.value]);\n\n  const paths = useMemo(() => {\n    const _scaleX = scaleX();\n    const _scaleY = scaleY(id);\n    if (data?.x && data?.y && _scaleX(0)) {\n      const pathPoints = xyReduce(\n        { x: data.x, y: data.y },\n        {\n          from: xDomain[0],\n          to: xDomain[1],\n        },\n      );\n\n      let path = `M ${_scaleX(pathPoints.x[0])} ${_scaleY(pathPoints.y[0])} `;\n      path += pathPoints.x.slice(1).reduce((accumulator, point, i) => {\n        accumulator += ` L ${_scaleX(point)} ${_scaleY(pathPoints.y[i + 1])}`;\n        return accumulator;\n      }, '');\n      return path;\n    } else {\n      return '';\n    }\n  }, [id, scaleX, scaleY, data, xDomain]);\n\n  return (\n    <path\n      className=\"line\"\n      key={id}\n      stroke={display.color}\n      fill=\"none\"\n      style={{\n        opacity: isActive\n          ? 1\n          : get(preferences, 'controllers.dimmedSpectraTransparency', 0.1),\n      }}\n      d={paths}\n      transform={`translate(0,-${vAlign})`}\n    />\n  );\n}\n\nexport default Line;\n","import { useChartData } from '../context/ChartContext';\n\nimport Line from './Line';\n\nfunction LinesSeries() {\n  const { data, tempData, displayerKey } = useChartData();\n\n  const _data = tempData ? tempData : data;\n\n  return (\n    <g clipPath={`url(#${displayerKey}clip-chart-1d)`}>\n      {_data &&\n        _data\n          .filter(\n            (d) =>\n              d.display.isVisible === true &&\n              d.display.isVisibleInDomain === true,\n          )\n          .map((d, i) => <Line key={d.id} {...d} index={i} />)}\n    </g>\n  );\n}\n\nexport default LinesSeries;\n","import lodashGet from 'lodash/get';\nimport Numeral from 'numeral';\n\nimport { usePreferences } from '../context/PreferencesContext';\n// let getNuclusFormat = memoize(getDefaultNuclusFormat);\n\nfunction FormatNumber(value, format, prefix = '', suffix = '') {\n  return prefix + Numeral(value).format(format) + suffix;\n}\n\n/**\n *\n * @param {string|Array} nucleus\n */\nexport function useFormatNumberByNucleus(nucleus) {\n  const preferences = usePreferences();\n  const nucleusByKey = lodashGet(preferences, `formatting.nucleusByKey`, {\n    ppm: '0.0',\n    hz: '0.0',\n  });\n\n  const formatFun = (n) => (\n    value,\n    formatKey = 'ppm',\n    prefix = '',\n    suffix = '',\n  ) => {\n    return (\n      prefix +\n      Numeral(Number(value)).format(\n        lodashGet(nucleusByKey, `${n.toLowerCase()}.${formatKey}`, '0.0'),\n      ) +\n      suffix\n    );\n  };\n\n  if (!nucleus) {\n    return;\n  }\n\n  if (typeof nucleus === 'string') {\n    return formatFun(nucleus);\n  } else if (Array.isArray(nucleus)) {\n    return nucleus.map((n) => formatFun(n));\n  } else {\n    throw Error('nuclus must be string or array of string');\n  }\n}\n\n/**\n * @param {number|string} value\n */\nexport function getNumberOfDecimals(value) {\n  value = String(value).trim();\n  const lastIndex = value.lastIndexOf('.');\n  return lastIndex > 0 ? value.substr(lastIndex).split('').length - 1 : 0;\n}\n\nexport default FormatNumber;\n","/** @jsxImportSource @emotion/react */\nimport { css, Global } from '@emotion/react';\nimport {\n  useRef,\n  useState,\n  useCallback,\n  useLayoutEffect,\n  useEffect,\n  Fragment,\n  useMemo,\n} from 'react';\n\nimport { useDispatch } from '../context/DispatchContext';\nimport { TYPES, useHighlight } from '../highlight';\nimport { SHIFT_SPECTRUM } from '../reducer/types/Types';\nimport { useFormatNumberByNucleus } from '../utility/FormatNumber';\n\nconst styles = css`\n  user-select: 'none';\n  -webkit-user-select: none; /* Chrome all / Safari all */\n  -moz-user-select: none; /* Firefox all */\n\n  text,\n  input {\n    -webkit-user-select: none; /* Safari 3.1+ */\n    -moz-user-select: none; /* Firefox 2+ */\n    -ms-user-select: none; /* IE 10+ */\n    user-select: none; /* Standard syntax */\n  }\n\n  input[type='number']::-webkit-outer-spin-button,\n  input[type='number']::-webkit-inner-spin-button {\n    -webkit-appearance: none;\n    margin: 0;\n  }\n\n  input[type='number'] {\n    -moz-appearance: textfield;\n  }\n\n  .notification-input {\n    width: calc(100% - 10px) !important;\n    user-select: 'none';\n    -webkit-user-select: none; /* Chrome all / Safari all */\n    -moz-user-select: none; /* Firefox all */\n  }\n\n  .notification-input-normal {\n    opacity: 1;\n    left: 4px;\n    position: absolute;\n    font-size: 10px;\n    outline: none;\n    user-select: 'none';\n    -webkit-user-select: none; /* Chrome all / Safari all */\n    -moz-user-select: none; /* Firefox all */\n    background-color: transparent;\n  }\n\n  .notification-input-normal input:focus {\n    outline: none;\n    background-color: white;\n  }\n\n  .input-over {\n    background-color: white;\n    outline: none;\n  }\n\n  .notification-label {\n    display: none;\n  }\n\n  .notification-group-over {\n    z-index: 9999999999;\n  }\n\n  .notification-group {\n    z-index: 1;\n  }\n\n  .notifcate-selected {\n    opacity: 0;\n  }\n\n  input[type='number']::-webkit-inner-spin-button,\n  input[type='number']::-webkit-outer-spin-button {\n    -webkit-appearance: none;\n    margin: 0;\n  }\n`;\n\nfunction PeakNotation({\n  id,\n  x,\n  y,\n  sign, // 1 positive -1 negative\n  value,\n  color,\n  isActive,\n  nucleus,\n}) {\n  const refText = useRef();\n  const [isSelected, setIsSelected] = useState(false);\n  const [_value, setValue] = useState(value);\n  const [containerSize, setContainerSize] = useState({ width: 0, height: 0 });\n  const format = useFormatNumberByNucleus(nucleus);\n  const highlight = useHighlight([id], TYPES.PEAK);\n\n  const dispatch = useDispatch();\n\n  const handleOnPeakChange = useCallback(\n    (e) => dispatch({ type: SHIFT_SPECTRUM, shiftValue: e.shiftValue }),\n    [dispatch],\n  );\n\n  useLayoutEffect(() => {\n    const textBox = refText.current.getBBox();\n    setContainerSize({ width: textBox.width, height: textBox.height });\n  }, [isSelected]);\n\n  useEffect(() => {\n    setValue(value);\n  }, [value]);\n\n  const handleKeyDown = useCallback(\n    (event) => {\n      if (event.key === 'Enter') {\n        const newValue = parseFloat(event.target.value);\n        const oldValue = parseFloat(value);\n        const shiftValue = parseFloat(event.target.value) - parseFloat(value);\n\n        handleOnPeakChange({\n          id,\n          value: newValue,\n          oldValue: oldValue,\n          shiftValue: shiftValue,\n        });\n\n        event.target.blur();\n        setIsSelected(false);\n      } else if (event.keyCode === 27) {\n        setValue(value);\n        event.target.blur();\n        setIsSelected(false);\n      }\n    },\n    [value, handleOnPeakChange, id],\n  );\n\n  const handleChange = useCallback((event) => {\n    setValue(event.target.value);\n  }, []);\n\n  const handleSelectPeakNotation = useCallback((e) => {\n    e.preventDefault();\n    e.stopPropagation();\n    setIsSelected(true);\n    return false;\n  }, []);\n\n  const handleOnEnterNotation = useCallback(() => {\n    highlight.show();\n  }, [highlight]);\n\n  const handleOnMouseLeaveNotation = useCallback(() => {\n    highlight.hide();\n  }, [highlight]);\n\n  const newValue = useMemo(() => (isSelected ? value : format(value)), [\n    format,\n    isSelected,\n    value,\n  ]);\n  const oldValue = useMemo(() => (isSelected ? _value : format(_value)), [\n    _value,\n    format,\n    isSelected,\n  ]);\n\n  return (\n    <Fragment>\n      <Global styles={styles} />\n      <g\n        id={id}\n        style={{ outline: 'none' }}\n        transform={`translate(${x}, ${y})`}\n        onMouseEnter={handleOnEnterNotation}\n        onMouseLeave={handleOnMouseLeaveNotation}\n        // onKeyDown={keyDownHandler}\n      >\n        <line\n          x1=\"0\"\n          x2=\"0\"\n          y1={sign === -1 ? 10 : 0}\n          y2={sign === -1 ? 28 : -18}\n          stroke={color}\n          strokeWidth={highlight.isActive ? '7px' : '1px'}\n        />\n        <text\n          ref={refText}\n          className=\"peaks-text\"\n          x=\"0\"\n          y={sign === -1 ? 28 : -12}\n          dy=\"0\"\n          dx=\"0.35em\"\n          fill=\"transparent\"\n          fontSize=\"10px\"\n          fontWeight=\"100\"\n          style={{\n            position: 'absolute',\n          }}\n        >\n          {newValue}\n        </text>\n        <foreignObject\n          x=\"0\"\n          y={sign === -1 ? 16 : -22}\n          dy=\"0.1em\"\n          dx=\"0.35em\"\n          width={containerSize.width + 20}\n          height=\"40px\"\n          data-no-export=\"true\"\n        >\n          <div\n            style={{\n              width: containerSize.width + 20,\n              height: '100%',\n              paddingRight: 5,\n            }}\n            xmlns=\"http://www.w3.org/1999/xhtml\"\n          >\n            <input\n              onClick={handleSelectPeakNotation}\n              className={\n                isSelected\n                  ? 'notification-input input-over'\n                  : 'notification-input-normal'\n              }\n              style={{\n                width: 'inherit',\n                border: isSelected ? `1px solid ${color}` : `0`,\n                opacity: isActive ? 1 : 0.2,\n                userSelect: 'none',\n                color: color,\n              }}\n              value={oldValue}\n              onKeyDown={handleKeyDown}\n              onChange={handleChange}\n              type=\"number\"\n              disabled={!isActive}\n            />\n          </div>\n        </foreignObject>\n      </g>\n    </Fragment>\n  );\n}\n\nexport default PeakNotation;\n","import { useMemo } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\nimport { useScale } from '../context/ScaleContext';\n\nimport PeakNotation from './PeakNotation';\n\nfunction PeaksNotations() {\n  const { data, activeSpectrum, verticalAlign, displayerKey } = useChartData();\n  const { scaleX, scaleY } = useScale();\n\n  const Peaks = useMemo(() => {\n    const getVerticalAlign = (id) => {\n      const i = data.findIndex((d) => d.id === id);\n      return verticalAlign.flag\n        ? verticalAlign.stacked\n          ? (i + 1) * verticalAlign.value\n          : 0\n        : 0;\n    };\n\n    const reSortData = () => {\n      const _data = [...data];\n      return activeSpectrum\n        ? _data.sort(function (x, y) {\n            return x.id === activeSpectrum.id\n              ? 1\n              : y.id === activeSpectrum.id\n              ? -1\n              : 0;\n          })\n        : _data;\n    };\n\n    return (\n      data &&\n      reSortData()\n        .filter(\n          (d) =>\n            d.display.isVisible === true &&\n            d.display.isVisibleInDomain === true,\n        )\n        .map((d) => {\n          return (\n            d.peaks &&\n            d.peaks.values &&\n            d.display.isPeaksMarkersVisible && (\n              <g\n                key={d.id}\n                transform={`translate(0,-${getVerticalAlign(d.id)})`}\n              >\n                {d.peaks.values.map(({ delta, intensity, id }) => (\n                  <PeakNotation\n                    key={id}\n                    x={scaleX()(delta)}\n                    y={scaleY(d.id)(intensity) - 5}\n                    sign={Math.sign(intensity)}\n                    id={id}\n                    spectrumID={d.id}\n                    value={delta}\n                    color=\"#730000\"\n                    nucleus={d.info.nucleus}\n                    isActive={\n                      activeSpectrum == null\n                        ? false\n                        : activeSpectrum.id === d.id\n                        ? true\n                        : false\n                    }\n                  />\n                ))}\n              </g>\n            )\n          );\n        })\n    );\n  }, [\n    data,\n    verticalAlign.flag,\n    verticalAlign.stacked,\n    verticalAlign.value,\n    activeSpectrum,\n    scaleX,\n    scaleY,\n  ]);\n\n  return (\n    <g className=\"peaks\" clipPath={`url(#${displayerKey}clip-chart-1d)`}>\n      {Peaks}\n    </g>\n  );\n}\n\nexport default PeaksNotations;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport * as d3 from 'd3';\nimport PropTypes from 'prop-types';\nimport { useEffect, useRef, useMemo } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\nimport { useScale } from '../context/ScaleContext';\n\nconst axisStyles = css`\n  user-select: none;\n\n  path,\n  line {\n    fill: none;\n    stroke: black;\n    stroke-width: 1;\n    shape-rendering: crispEdges;\n    user-select: none;\n  }\n`;\n\nconst gridStyles = css`\n  user-select: none;\n\n  line {\n    stroke: rgb(104, 104, 104);\n    stroke-opacity: 0.2;\n    shape-rendering: crispEdges;\n    stroke-dasharray: 3;\n    stroke-width: 1;\n    user-select: none;\n  }\n\n  path {\n    stroke-width: 0;\n  }\n`;\n\nfunction XAxis({ label, show, showGrid, mode }) {\n  const { xDomain, height, width, margin } = useChartData();\n  const { scaleX } = useScale();\n\n  const refAxis = useRef();\n  const refGrid = useRef();\n\n  label = label ? label : mode === 'RTL' ? ' [ppm]' : 'time [s]';\n\n  useEffect(() => {\n    const xAxis = d3.axisBottom().ticks(8).tickFormat(d3.format('0'));\n    const grid = d3\n      .axisBottom()\n      .ticks(50)\n      .tickSize(-(height - margin.top - margin.bottom))\n      .tickFormat('');\n    if (show && scaleX) {\n      d3.select(refAxis.current).call(xAxis.scale(scaleX().domain(xDomain)));\n      d3.select(refGrid.current).call(grid.scale(scaleX().domain(xDomain)));\n    }\n  }, [height, margin.bottom, margin.top, scaleX, show, xDomain]);\n\n  const Axis = useMemo(\n    () =>\n      show &&\n      show === true && (\n        <g\n          className=\"x\"\n          css={axisStyles}\n          transform={`translate(0,${height - margin.bottom})`}\n          ref={refAxis}\n        >\n          <text fill=\"#000\" x={width - 10} y=\"30\" dy=\"0.70em\" textAnchor=\"end\">\n            {label}\n          </text>\n        </g>\n      ),\n\n    [height, label, margin.bottom, show, width],\n  );\n\n  const Grid = useMemo(\n    () =>\n      showGrid &&\n      showGrid === true && (\n        <g\n          css={gridStyles}\n          className=\"grid\"\n          ref={refGrid}\n          transform={`translate(0,${height - margin.bottom})`}\n        />\n      ),\n\n    [showGrid, height, margin.bottom],\n  );\n  if (!width || !height || !scaleX) {\n    return null;\n  }\n\n  return (\n    <>\n      {Axis}\n      {Grid}\n    </>\n  );\n}\n\nXAxis.propTypes = {\n  showGrid: PropTypes.bool,\n  show: PropTypes.bool,\n  label: PropTypes.string,\n};\n\nXAxis.defaultProps = {\n  showGrid: false,\n  show: true,\n  label: '',\n};\n\nexport default XAxis;\n","import { forwardRef } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\n\nfunction MultiAnalysisWrapper(WrappedComponent) {\n  const Wrapper = (props) => {\n    const { activeTab, spectraAnalysis, displayerKey } = useChartData();\n    const { forwardedRef, ...rest } = props;\n\n    return (\n      <WrappedComponent\n        {...rest}\n        activeTab={activeTab}\n        spectraAnalysis={spectraAnalysis}\n        displayerKey={displayerKey}\n        ref={forwardedRef}\n      />\n    );\n  };\n  return forwardRef((props, ref) => {\n    return <Wrapper {...props} forwardedRef={ref} />;\n  });\n}\nexport default MultiAnalysisWrapper;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback } from 'react';\n\nimport { useDispatch } from '../../context/DispatchContext';\nimport { useScale } from '../../context/ScaleContext';\nimport DeleteButton from '../../elements/DeleteButton';\nimport { useHighlight } from '../../highlight';\nimport {\n  DELETE_ANALYZE_SPECTRA_RANGE,\n  RESIZE_ANALYZE_SPECTRA_RANGE,\n} from '../../reducer/types/Types';\nimport Resizable from '../Resizable';\n\nconst stylesOnHover = css`\n  pointer-events: bounding-box;\n  @-moz-document url-prefix() {\n    pointer-events: fill;\n  }\n  user-select: 'none';\n  -webkit-user-select: none; /* Chrome all / Safari all */\n  -moz-user-select: none; /* Firefox all */\n\n  .delete-button {\n    visibility: hidden;\n  }\n`;\n\nconst stylesHighlighted = css`\n  pointer-events: bounding-box;\n\n  @-moz-document url-prefix() {\n    pointer-events: fill;\n  }\n  .range-area {\n    height: 100%;\n    fill: #ff6f0057;\n  }\n  .delete-button {\n    visibility: visible;\n    cursor: pointer;\n  }\n`;\n\nfunction AnalysisRange({ rangeData, columnKey }) {\n  const { from, to } = rangeData;\n  const highlight = useHighlight([columnKey]);\n  const { scaleX } = useScale();\n  const dispatch = useDispatch();\n\n  const deleteHandler = useCallback(() => {\n    dispatch({ type: DELETE_ANALYZE_SPECTRA_RANGE, colKey: columnKey });\n  }, [columnKey, dispatch]);\n\n  const handleOnStopResizing = useCallback(\n    (resized) => {\n      dispatch({\n        type: RESIZE_ANALYZE_SPECTRA_RANGE,\n        payload: { ...rangeData, ...resized, columnKey },\n      });\n    },\n    [columnKey, dispatch, rangeData],\n  );\n\n  return (\n    <g\n      {...highlight.onHover}\n      css={highlight.isActive ? stylesHighlighted : stylesOnHover}\n    >\n      <g transform={`translate(${scaleX()(to)},25)`}>\n        <rect\n          x=\"0\"\n          width={scaleX()(from) - scaleX()(to)}\n          height=\"6\"\n          className=\"range-area\"\n          fill=\"green\"\n        />\n        <text\n          textAnchor=\"middle\"\n          x={(scaleX()(from) - scaleX()(to)) / 2}\n          y=\"-5\"\n          fontSize=\"12\"\n          fill=\"red\"\n          fontWeight=\"bolder\"\n          fillOpacity={highlight.isActive ? 1 : 0.6}\n        >\n          {columnKey}\n        </text>\n      </g>\n      <Resizable\n        from={rangeData.from}\n        to={rangeData.to}\n        onDrop={handleOnStopResizing}\n      />\n      <DeleteButton x={scaleX()(to) - 20} y={10} onDelete={deleteHandler} />\n    </g>\n  );\n}\n\nexport default AnalysisRange;\n","import { memo, useMemo } from 'react';\n\nimport MultiAnalysisWrapper from '../../hoc/MultiAnalysisWrapper';\n\nimport AnalysisRange from './AnalysisRange';\n\nfunction MultiAnalysisRanges({ activeTab, spectraAnalysis, displayerKey }) {\n  const columns = useMemo(() => {\n    const {\n      options: { columns },\n    } = spectraAnalysis[activeTab] || {\n      options: { columns: {} },\n    };\n    return columns;\n  }, [activeTab, spectraAnalysis]);\n\n  const ranges = useMemo(() => {\n    return Object.keys(columns).map((key) => key, []);\n  }, [columns]);\n\n  if (!ranges || ranges.length === 0) {\n    return null;\n  }\n\n  return (\n    <g clipPath={`url(#${displayerKey}clip-chart-1d)`}>\n      {ranges.map((columnKey) => (\n        <AnalysisRange\n          key={columnKey}\n          columnKey={columnKey}\n          rangeData={columns[columnKey]}\n        />\n      ))}\n    </g>\n  );\n}\n\nexport default MultiAnalysisWrapper(memo(MultiAnalysisRanges));\n","import { useMemo, memo, forwardRef } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\nimport { usePreferences } from '../context/PreferencesContext';\n\nfunction RangesWrapper(WrappedComponent) {\n  const Wrapper = (props) => {\n    const {\n      data,\n      activeSpectrum,\n      xDomain,\n      activeTab,\n      molecules,\n      tabActiveSpectrum,\n      displayerKey,\n      selectedTool,\n    } = useChartData();\n    const preferences = usePreferences();\n\n    const { ranges = {}, x = [], y = [], info = {} } = useMemo(() => {\n      if (data && activeSpectrum && activeSpectrum.id) {\n        const datum = data.find((datum) => datum.id === activeSpectrum.id) || {\n          ranges: {},\n          x: [],\n          y: [],\n          info: {},\n        };\n        return datum;\n      }\n      return {};\n    }, [activeSpectrum, data]);\n\n    const nucleus = useMemo(() => {\n      if (tabActiveSpectrum && Object.keys(tabActiveSpectrum).length > 0) {\n        return Object.keys(tabActiveSpectrum);\n      }\n      return null;\n    }, [tabActiveSpectrum]);\n\n    const { forwardedRef, ...rest } = props;\n    return (\n      <WrappedComponent\n        {...rest}\n        ranges={ranges}\n        x={x}\n        y={y}\n        info={info}\n        xDomain={xDomain}\n        preferences={preferences}\n        activeTab={activeTab}\n        molecules={molecules}\n        nucleus={nucleus}\n        displayerKey={displayerKey}\n        selectedTool={selectedTool}\n        ref={forwardedRef}\n      />\n    );\n  };\n\n  return memo(\n    forwardRef((props, ref) => {\n      return <Wrapper {...props} forwardedRef={ref} />;\n    }),\n  );\n}\nexport default RangesWrapper;\n","const SignalKinds = [\n  {\n    key: 'signal',\n    label: 'Signal',\n    value: 'signal',\n  },\n  {\n    key: 'reference',\n    label: 'Reference',\n    value: 'reference',\n  },\n  {\n    key: 'solvent',\n    label: 'Solvent',\n    value: 'solvent',\n  },\n  {\n    key: 'impurity',\n    label: 'Impurity',\n    value: 'impurity',\n  },\n  {\n    key: 'standard',\n    label: 'Standard',\n    value: 'standard',\n  },\n  {\n    key: 'p1',\n    label: 'P1',\n    value: 'p1',\n  },\n  {\n    key: 'p2',\n    label: 'P2',\n    value: 'p2',\n  },\n  {\n    key: 'p3',\n    label: 'P3',\n    value: 'p3',\n  },\n];\n\nconst SignalKindsToInclude = ['signal'];\nconst DatumKind = { signal: 'signal', mixed: 'mixed' };\n\nexport { SignalKinds, SignalKindsToInclude, DatumKind };\n","import { DatumKind } from '../constants/SignalsKinds';\n\nconst getDiaIDs = (range) => {\n  return [].concat(\n    range.diaID || [],\n    range.signal\n      ? range.signal.map((_signal) => _signal.diaID || []).flat()\n      : [],\n  );\n};\n\nconst getPubIntegral = (range) => {\n  return getDiaIDs(range).length;\n};\n\nconst setPubIntegral = (range) => {\n  range.pubIntegral = getPubIntegral(range);\n  if (range.pubIntegral === 0) {\n    delete range.pubIntegral;\n  }\n};\n\nconst resetDiaIDs = (range) => {\n  delete range.diaID;\n  range.signal.forEach((_signal) => {\n    delete _signal.diaID;\n  });\n  delete range.pubIntegral;\n};\n\nconst unlink = (range, isOnRangeLevel, signalIndex) => {\n  if (isOnRangeLevel !== undefined) {\n    if (isOnRangeLevel === true) {\n      delete range.diaID;\n    } else if (signalIndex !== undefined) {\n      delete range.signal[signalIndex].diaID;\n    }\n  } else {\n    resetDiaIDs(range);\n  }\n  setPubIntegral(range);\n\n  return range;\n};\n\nconst addDefaultSignal = (range) => {\n  range.signal.push({\n    multiplicity: 'm',\n    kind: 'signal',\n    delta: (range.to + range.from) / 2,\n  });\n};\n\nconst checkRangeKind = (range) => {\n  return range.kind === DatumKind.signal;\n};\n\nconst checkSignalKinds = (range, kinds) => {\n  return !range.signal.some(\n    (_signal) => _signal.kind === undefined || !kinds.includes(_signal.kind),\n  );\n};\n\nconst unlinkInAssignmentData = (assignmentData, ranges) => {\n  const ids = ranges.reduce((acc, range) => {\n    acc.push(range.id);\n    if (range.signal) {\n      acc.concat(range.signal.map((signal) => signal.id, []));\n    }\n    return acc;\n  }, []);\n\n  assignmentData.dispatch({\n    type: 'REMOVE_ALL',\n    payload: { id: ids, axis: 'x' },\n  });\n};\n\nexport {\n  addDefaultSignal,\n  checkRangeKind,\n  checkSignalKinds,\n  getDiaIDs,\n  getPubIntegral,\n  resetDiaIDs,\n  unlink,\n  unlinkInAssignmentData,\n};\n","import {\n  createContext,\n  useReducer,\n  useMemo,\n  useContext,\n  useCallback,\n  useEffect,\n} from 'react';\n\nconst assignmentContext = createContext();\n\nfunction assignmentReducer(state, action) {\n  switch (action.type) {\n    case 'ADD': {\n      const newState = {\n        ...state,\n        assignment: { ...state.assignment },\n      };\n      if (newState.assignment[action.payload.id[0]] === undefined) {\n        newState.assignment[action.payload.id[0]] = {};\n      }\n      if (\n        newState.assignment[action.payload.id[0]][action.payload.axis] ===\n        undefined\n      ) {\n        newState.assignment[action.payload.id[0]][action.payload.axis] = [];\n      }\n      // avoid duplicates\n      if (\n        !newState.assignment[action.payload.id[0]][\n          action.payload.axis\n        ].includes(action.payload.id[1])\n      ) {\n        newState.assignment[action.payload.id[0]][action.payload.axis].push(\n          action.payload.id[1],\n        );\n      }\n\n      return newState;\n    }\n    case 'REMOVE': {\n      const newState = {\n        ...state,\n        assignment: { ...state.assignment },\n      };\n      if (\n        newState.assignment[action.payload.id[0]] !== undefined &&\n        newState.assignment[action.payload.id[0]][action.payload.axis] !==\n          undefined\n      ) {\n        newState.assignment[action.payload.id[0]][\n          action.payload.axis\n        ] = newState.assignment[action.payload.id[0]][\n          action.payload.axis\n        ].filter((_id) => _id !== action.payload.id[1]);\n\n        if (\n          newState.assignment[action.payload.id[0]][action.payload.axis]\n            .length === 0\n        ) {\n          delete newState.assignment[action.payload.id[0]][action.payload.axis];\n        }\n        if (\n          Object.keys(newState.assignment[action.payload.id[0]]).length === 0\n        ) {\n          delete newState.assignment[action.payload.id[0]];\n        }\n      }\n\n      return newState;\n    }\n    case 'REMOVE_ALL': {\n      const newState = {\n        ...state,\n        assignment: { ...state.assignment },\n      };\n      // takes an array now to delete multiple identifiers\n      action.payload.id.forEach((_id) => {\n        if (\n          newState.assignment[_id] !== undefined &&\n          newState.assignment[_id][action.payload.axis] !== undefined\n        ) {\n          delete newState.assignment[_id][action.payload.axis];\n          if (Object.keys(newState.assignment[_id]).length === 0) {\n            delete newState.assignment[_id];\n          }\n        }\n      });\n\n      return newState;\n    }\n    case 'SET_IS_ACTIVE': {\n      return {\n        ...state,\n        isActive:\n          action.payload.id !== undefined && action.payload.axis !== undefined,\n        activeID: action.payload.id,\n        activeAxis: action.payload.axis,\n      };\n    }\n    case 'SET_IS_ON_HOVER': {\n      return {\n        ...state,\n        isOnHover: action.payload.id !== undefined,\n        onHoverID: action.payload.id,\n        onHoverAxis: action.payload.axis,\n      };\n    }\n    case 'DELETE_RECORD': {\n      const newState = {\n        ...state,\n        assignment: { ...state.assignment },\n      };\n      delete newState.assignment[action.payload.id];\n\n      if (newState.isActive && newState.activeID === action.payload.id) {\n        newState.isActive = false;\n        newState.activeID = undefined;\n        newState.activeAxis = undefined;\n      }\n      if (newState.isOnHover && newState.onHoverID === action.payload.id) {\n        newState.isOnHover = false;\n        newState.onHoverID = undefined;\n        newState.onHoverAxis = undefined;\n      }\n\n      return newState;\n    }\n    default: {\n      throw new Error(`unknown action type: ${action.type}`);\n    }\n  }\n}\n\nconst emptyState = {\n  assignment: {},\n  isActive: false,\n  activeID: undefined,\n  activeAxis: undefined,\n  isOnHover: false,\n  onHoverID: undefined,\n  onHoverAxis: undefined,\n};\n\nexport function AssignmentProvider(props) {\n  const { spectraData } = props;\n  const [assignment, dispatch] = useReducer(assignmentReducer, emptyState);\n  const contextValue = useMemo(() => ({ assignment, dispatch }), [assignment]);\n\n  const initAssignmentDataRanges = (range, _contextValue) => {\n    _contextValue.dispatch({\n      type: 'DELETE_RECORD',\n      payload: { id: range.id },\n    });\n    (range.diaID || []).forEach((_diaID) =>\n      _contextValue.dispatch({\n        type: 'ADD',\n        payload: { id: [range.id, _diaID], axis: 'x' },\n      }),\n    );\n    range.signal.forEach((signal) =>\n      (signal.diaID || []).forEach((_diaID) =>\n        _contextValue.dispatch({\n          type: 'ADD',\n          payload: { id: [signal.id, _diaID], axis: 'x' },\n        }),\n      ),\n    );\n  };\n\n  const initAssignmentDataZones = (zone, _contextValue) => {\n    _contextValue.dispatch({\n      type: 'DELETE_RECORD',\n      payload: { id: zone.id },\n    });\n    (zone.y.diaID || []).forEach((_diaID) =>\n      _contextValue.dispatch({\n        type: 'ADD',\n        payload: { id: [zone.id, _diaID], axis: 'y' },\n      }),\n    );\n    (zone.x.diaID || []).forEach((_diaID) =>\n      _contextValue.dispatch({\n        type: 'ADD',\n        payload: { id: [zone.id, _diaID], axis: 'x' },\n      }),\n    );\n    zone.signal.forEach((signal) => {\n      (signal.x.diaID || []).forEach((_diaID) =>\n        _contextValue.dispatch({\n          type: 'ADD',\n          payload: { id: [signal.id, _diaID], axis: 'x' },\n        }),\n      );\n      (signal.y.diaID || []).forEach((_diaID) =>\n        _contextValue.dispatch({\n          type: 'ADD',\n          payload: { id: [signal.id, _diaID], axis: 'y' },\n        }),\n      );\n    });\n  };\n\n  useEffect(() => {\n    if (spectraData) {\n      spectraData.forEach((spectrum) => {\n        if (spectrum.info.dimension === 1) {\n          spectrum.ranges.values.forEach((range) =>\n            initAssignmentDataRanges(range, contextValue),\n          );\n        } else if (spectrum.info.dimension === 2) {\n          spectrum.zones.values.forEach((zone) =>\n            initAssignmentDataZones(zone, contextValue),\n          );\n        }\n      });\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [spectraData]);\n\n  return (\n    <assignmentContext.Provider value={contextValue}>\n      {props.children}\n    </assignmentContext.Provider>\n  );\n}\n\nexport function useAssignmentData() {\n  return useContext(assignmentContext);\n}\n\nexport function useAssignment(key) {\n  const context = useAssignmentData();\n\n  if ((typeof key !== 'string' && typeof key !== 'number') || key === '') {\n    throw new Error(`assignment key must be a non-empty string or number`);\n  }\n  const id = String(key);\n\n  const isActive = useMemo(() => {\n    return context.assignment.isActive && context.assignment.activeID === id;\n  }, [context.assignment.activeID, context.assignment.isActive, id]);\n\n  const activeAxis = useMemo(() => {\n    return isActive ? context.assignment.activeAxis : undefined;\n  }, [context.assignment.activeAxis, isActive]);\n\n  const assigned = useMemo(() => {\n    return context.assignment.assignment[id]\n      ? context.assignment.assignment[id]\n      : [];\n  }, [context.assignment.assignment, id]);\n\n  const isOnHover = useMemo(() => {\n    return context.assignment.isOnHover && context.assignment.onHoverID === id;\n  }, [context.assignment.isOnHover, context.assignment.onHoverID, id]);\n\n  const onHoverAxis = useMemo(() => {\n    return isOnHover ? context.assignment.onHoverAxis : undefined;\n  }, [context.assignment.onHoverAxis, isOnHover]);\n\n  const add = useCallback(\n    (_id) => {\n      context.dispatch({\n        type: 'ADD',\n        payload: { id: [id, _id], axis: activeAxis },\n      });\n    },\n    [activeAxis, context, id],\n  );\n\n  const remove = useCallback(\n    (_id) => {\n      context.dispatch({\n        type: 'REMOVE',\n        payload: { id: [id, _id], axis: activeAxis },\n      });\n    },\n    [activeAxis, context, id],\n  );\n\n  const removeAll = useCallback(\n    (axis) => {\n      context.dispatch({\n        type: 'REMOVE_ALL',\n        payload: { id: [id], axis },\n      });\n    },\n    [context, id],\n  );\n\n  const toggle = useCallback(\n    (_id) => {\n      if (\n        assigned[activeAxis] === undefined ||\n        !assigned[activeAxis].includes(_id)\n      ) {\n        add(_id);\n      } else {\n        remove(_id);\n      }\n    },\n    [activeAxis, add, assigned, remove],\n  );\n\n  // totally deletion of a record from assignment storage\n  const deleteRecord = useCallback(() => {\n    context.dispatch({\n      type: 'DELETE_RECORD',\n      payload: { id },\n    });\n  }, [context, id]);\n\n  const onClick = useCallback(\n    (axis) => {\n      context.dispatch({\n        type: 'SET_IS_ACTIVE',\n        payload: {\n          id: !isActive ? id : undefined,\n          axis: !isActive && id !== undefined ? axis : undefined,\n        },\n      });\n    },\n    [context, id, isActive],\n  );\n\n  const setIsOnHover = useCallback(\n    (action, axis) => {\n      if (action === 'enter') {\n        context.dispatch({\n          type: 'SET_IS_ON_HOVER',\n          payload: {\n            id: id,\n            axis: id !== undefined ? axis : undefined,\n          },\n        });\n      } else if (action === 'leave') {\n        context.dispatch({\n          type: 'SET_IS_ON_HOVER',\n          payload: {},\n        });\n      }\n    },\n    [context, id],\n  );\n\n  const onMouseEnter = useCallback((axis) => setIsOnHover('enter', axis), [\n    setIsOnHover,\n  ]);\n\n  const onMouseLeave = useCallback((axis) => setIsOnHover('leave', axis), [\n    setIsOnHover,\n  ]);\n\n  return {\n    id,\n    isActive,\n    activeAxis,\n    assigned,\n    add,\n    remove,\n    removeAll,\n    toggle,\n    deleteRecord,\n    onClick,\n    isOnHover,\n    onHoverAxis,\n    onMouseEnter,\n    onMouseLeave,\n  };\n}\n","const Multiplets = [\n  { label: 'massive (m)', value: 'm', multiplicity: null },\n  { label: 'singlet (s)', value: 's', multiplicity: 1 },\n  { label: 'doublet (d)', value: 'd', multiplicity: 2 },\n  { label: 'triplet (t)', value: 't', multiplicity: 3 },\n  { label: 'quartet (q)', value: 'q', multiplicity: 4 },\n  { label: 'quintet (i)', value: 'i', multiplicity: 5 },\n  { label: 'sextet (x)', value: 'x', multiplicity: 6 },\n  { label: 'septet (p)', value: 'p', multiplicity: 7 },\n  { label: 'octet (o)', value: 'o', multiplicity: 8 },\n  { label: 'nonet (n)', value: 'n', multiplicity: 9 },\n];\n\nexport { Multiplets };\n","import { Multiplets } from '../../../../data/constants/Multiplets';\n\nfunction getMultiplicityNumber(string) {\n  const multiplet = Multiplets.find(\n    (_multiplet) => string === _multiplet.label || string === _multiplet.value,\n  );\n\n  return multiplet ? multiplet.multiplicity : null;\n}\n\nfunction checkMultiplet(multiplet, rejected = []) {\n  // options to determine whether a massive (m), for example, should be considered as rejected multiplet\n  if (multiplet === undefined || multiplet.length === 0) {\n    return false;\n  }\n  const _multiplet = Multiplets.find(\n    (m) => m.value === multiplet || m.label === multiplet,\n  );\n  return (\n    _multiplet &&\n    !rejected.includes(_multiplet.value) &&\n    !rejected.includes(_multiplet.label)\n  );\n}\n\nfunction checkMultiplicity(multiplicity, rejected = []) {\n  // options to determine whether a massive (m), for example, should be considered as rejected multiplicity\n  if (multiplicity === undefined || multiplicity.length === 0) {\n    return false;\n  }\n  return !multiplicity\n    .split('')\n    .find((_multiplet) => !checkMultiplet(_multiplet, rejected));\n}\n\nfunction translateMultiplet(multiplet) {\n  return multiplet.length === 1\n    ? Multiplets.find((_multiplet) => _multiplet.value === multiplet).label\n    : Multiplets.find((_multiplet) => _multiplet.label === multiplet).value;\n}\n\nfunction hasCouplingConstant(multiplet) {\n  if (multiplet.length > 1) {\n    multiplet = translateMultiplet(multiplet);\n  }\n  // with the pre-set rejected ones, we check the given multiplicity for the need of having a coupling constant (massive and singlet do not)\n  return checkMultiplicity(multiplet, ['m', 's']);\n}\n\nfunction getPascal(n, spin) {\n  if (n === undefined || n === 0 || spin === undefined) return [1];\n  let mult = 2 * spin + 1;\n  let previousLine = [];\n  for (let j = 0; j < mult - 1; j++) previousLine.push(1);\n  // complete with \"1 1\" or \"1 1 1\" for spin 1/2 and 1 respectively\n  for (let i = 0; i < n - 1; i++) {\n    // copy the line\n    let _line = previousLine.slice();\n    for (let j = 1; j < mult; j++) {\n      for (let k = 0; k < previousLine.length - 1; k++) {\n        _line[k + j] += previousLine[k];\n      } // add the previous line\n      _line.push(1); // complete the line\n    }\n    previousLine = _line.slice();\n  }\n  return previousLine;\n}\n\nexport {\n  checkMultiplet,\n  checkMultiplicity,\n  getMultiplicityNumber,\n  getPascal,\n  hasCouplingConstant,\n  translateMultiplet,\n};\n","export const TREE_LEVEL_COLORS = ['red', 'green', 'blue', 'magenta'];\n","import { useScale } from '../../context/ScaleContext';\n\nimport { TREE_LEVEL_COLORS } from './TreeColors';\n\nfunction LevelNode({ signal, startY, levelHeight }) {\n  const { scaleX } = useScale();\n  return (\n    <line\n      key={`startLevelNode_${signal.id}`}\n      x1={scaleX()(signal.delta)}\n      y1={startY}\n      x2={scaleX()(signal.delta)}\n      y2={startY + levelHeight}\n      stroke={TREE_LEVEL_COLORS[0]}\n    />\n  );\n}\n\nexport default LevelNode;\n","import { useScale } from '../../context/ScaleContext';\n\nfunction StringNode({ signal, startY, levelHeight, fontSize, showLabels }) {\n  const { scaleX } = useScale();\n  return (\n    <text\n      key={`multiplicityString_${signal.id}`}\n      textAnchor=\"middle\"\n      x={scaleX()(signal.delta)}\n      y={startY + levelHeight / 2}\n      fontSize={fontSize}\n      lengthAdjust=\"spacing\"\n      fill=\"black\"\n      visibility={showLabels ? 'visible' : 'hidden'}\n    >\n      {signal.multiplicity}\n    </text>\n  );\n}\n\nexport default StringNode;\n","import { useCallback } from 'react';\n\nimport { useScale } from '../../context/ScaleContext';\n\nfunction TreeNodes({\n  nodesData,\n  levelHeight,\n  startY,\n  signalID,\n  labelOptions,\n  showLabels,\n}) {\n  const { scaleX } = useScale();\n  const buildTreeNodeAndEdge = useCallback(\n    ({ startX, _startX, ratio, multiplicityIndex, color }) => {\n      const edgeLevel = 2 * multiplicityIndex + 2;\n      const _startYEdge = startY + edgeLevel * levelHeight;\n      const _startYNode = startY + (edgeLevel + 1) * levelHeight;\n\n      return (\n        <g key={`treeNode_${signalID}_${startX}_${_startX}_${ratio}`}>\n          {/* ratio text */}\n          <text\n            textAnchor=\"middle\"\n            x={scaleX()(_startX) + labelOptions.distance}\n            y={_startYNode + 2 * (levelHeight / 3)}\n            fontSize={labelOptions.fontSize}\n            fill={color}\n            visibility={showLabels ? 'visible' : 'hidden'}\n          >\n            {ratio}\n          </text>\n          {/* edge line */}\n          <line\n            x1={scaleX()(startX)}\n            y1={_startYEdge}\n            x2={scaleX()(_startX)}\n            y2={_startYNode}\n            stroke={color}\n          />\n          {/* node line */}\n          <line\n            x1={scaleX()(_startX)}\n            y1={_startYNode}\n            x2={scaleX()(_startX)}\n            y2={_startYNode + levelHeight}\n            stroke={color}\n          />\n        </g>\n      );\n    },\n    [\n      signalID,\n      labelOptions.distance,\n      labelOptions.fontSize,\n      scaleX,\n      showLabels,\n      startY,\n      levelHeight,\n    ],\n  );\n\n  return nodesData && nodesData.map((node) => buildTreeNodeAndEdge(node));\n}\n\nexport default TreeNodes;\n","import lodashGet from 'lodash/get';\n\nimport {\n  getMultiplicityNumber,\n  getPascal,\n} from '../../panels/extra/utilities/MultiplicityUtilities';\n\nimport { TREE_LEVEL_COLORS } from './TreeColors';\n\nconst createTreeNodes = (signal, spectrumData) => {\n  function buildTreeNodesData(\n    multiplicityIndex,\n    jIndices,\n    treeNodesData,\n    startX,\n  ) {\n    if (multiplicityIndex >= signal.multiplicity.length) {\n      return treeNodesData;\n    }\n    // re-use colors if needed\n    const color =\n      TREE_LEVEL_COLORS[multiplicityIndex % TREE_LEVEL_COLORS.length];\n\n    const jIndex = jIndices.findIndex(\n      (_jIndex) => _jIndex === multiplicityIndex,\n    );\n\n    const frequency = lodashGet(spectrumData, 'info.originFrequency', 0);\n    const coupling =\n      jIndex >= 0 && frequency > 0\n        ? signal.j[jIndex].coupling / frequency // convert to ppm\n        : null;\n\n    // in case of \"s\": no coupling constant and build one tree node only\n    if (!coupling) {\n      treeNodesData.push({\n        startX,\n        _startX: startX,\n        ratio: 1,\n        multiplicityIndex,\n        color,\n      });\n      // go to next multiplet in multiplicity string\n      buildTreeNodesData(\n        multiplicityIndex + 1,\n        jIndices,\n        treeNodesData,\n        startX,\n      );\n    } else {\n      // in case of other multiplets\n      const pascal = getPascal(\n        getMultiplicityNumber(signal.multiplicity.charAt(multiplicityIndex)),\n        0.5,\n      ); // @TODO for now we use the default spin of 1 / 2 only\n\n      let _startX =\n        pascal.length % 2 === 0\n          ? startX - (pascal.length / 2) * coupling + coupling / 2 // in case of even number of nodes\n          : startX - (pascal.length / 2 - 0.5) * coupling; // in case of odd number of nodes\n\n      pascal.forEach((ratio, k) => {\n        if (k > 0) {\n          _startX += coupling;\n        }\n        treeNodesData.push({\n          startX,\n          _startX,\n          ratio,\n          multiplicityIndex,\n          color,\n        });\n        // go to next multiplet in multiplicity string\n        buildTreeNodesData(\n          multiplicityIndex + 1,\n          jIndices,\n          treeNodesData,\n          _startX,\n        );\n      });\n    }\n\n    return treeNodesData;\n  }\n  return buildTreeNodesData;\n};\n//   [signal.multiplicity, signal.j, spectrumData],\n\nexport default createTreeNodes;\n","/** @jsxImportSource @emotion/react */\nimport lodashGet from 'lodash/get';\nimport { useMemo, useState, useEffect } from 'react';\n\nimport { useAssignment } from '../../assignment';\nimport { useChartData } from '../../context/ChartContext';\nimport { useScale } from '../../context/ScaleContext';\nimport { useHighlight } from '../../highlight';\nimport {\n  hasCouplingConstant,\n  checkMultiplicity,\n} from '../../panels/extra/utilities/MultiplicityUtilities';\nimport { options } from '../../toolbar/ToolTypes';\n\nimport LevelNode from './LevelNode';\nimport StringNode from './StringNode';\nimport TreeNodes from './TreeNodes';\nimport createTreeNodes from './buildTreeNode';\n\nconst styles = {\n  cursor: 'default',\n  opacity: 0.6,\n  strokeWidth: 1,\n};\n\nfunction MultiplicityTree({\n  rangeFrom,\n  rangeTo,\n  signal,\n  labelOptions = {\n    distance: 10,\n    fontSize: 11,\n  },\n}) {\n  const { scaleX, scaleY } = useScale();\n  const {\n    data: spectraData,\n    activeSpectrum,\n    selectedTool,\n    width,\n  } = useChartData();\n  const assignment = useAssignment(signal.id);\n  const highlight = useHighlight(\n    [assignment.id].concat(assignment.assigned.x || []),\n  );\n\n  const spectrumData = useMemo(\n    () => lodashGet(spectraData, `${activeSpectrum.index}`, null),\n    [activeSpectrum, spectraData],\n  );\n\n  const [xRange, setXRange] = useState({ x1: signal.delta, x2: signal.delta });\n  const [treeProps, setTreeProps] = useState({\n    width: 0,\n    height: 0,\n    levelHeight: 0,\n  });\n  const [drawInFullRange, setDrawInFullRange] = useState(false);\n  const [showLabels, setShowLabels] = useState(false);\n\n  useEffect(() => {\n    const _drawInFullRange = !checkMultiplicity(signal.multiplicity, ['m']);\n    const _treeWidth = _drawInFullRange\n      ? Math.abs(scaleX()(xRange.x1) - scaleX()(xRange.x2))\n      : Math.abs(scaleX()(xRange.x1) - scaleX()(xRange.x2)) +\n        labelOptions.distance;\n    const _treeHeight = _drawInFullRange ? _treeWidth / 3 : _treeWidth / 2;\n    // +2 because of multiplicity text and start level node before the actual tree starts\n    // 2* for levels between nodes (edges)\n    const _treeLevelHeight = _drawInFullRange\n      ? _treeHeight / (signal.multiplicity.length + 2)\n      : _treeHeight / (2 * signal.multiplicity.length + 2);\n\n    setTreeProps({\n      width: _treeWidth,\n      height: _treeHeight,\n      levelHeight: _treeLevelHeight,\n    });\n    setDrawInFullRange(_drawInFullRange);\n  }, [\n    labelOptions.distance,\n    scaleX,\n    signal.multiplicity,\n    xRange.x1,\n    xRange.x2,\n  ]);\n\n  useEffect(() => {\n    if (treeProps.width / width >= 0.1) {\n      setShowLabels(true);\n    } else {\n      setShowLabels(false);\n    }\n  }, [treeProps.width, width]);\n\n  const startY = useMemo(() => {\n    let yMax;\n    spectrumData.data.x.forEach((_x, i) => {\n      if (\n        _x >= rangeFrom &&\n        _x <= rangeTo &&\n        (!yMax || spectrumData.data.y[i] > yMax)\n      ) {\n        yMax = spectrumData.data.y[i];\n      }\n    });\n\n    return scaleY(spectrumData.id)(yMax) - treeProps.height - 30;\n  }, [\n    spectrumData.data.x,\n    spectrumData.data.y,\n    spectrumData.id,\n    scaleY,\n    treeProps.height,\n    rangeFrom,\n    rangeTo,\n  ]);\n\n  const treeNodesData = useMemo(() => {\n    const buildTreeNodesData = createTreeNodes(signal, spectrumData);\n    const jIndices = signal.multiplicity\n      .split('')\n      .map((_mult, i) => (hasCouplingConstant(_mult) ? i : undefined))\n      .filter((_i) => _i !== undefined);\n\n    return buildTreeNodesData(0, jIndices, [], signal.delta);\n  }, [signal, spectrumData]);\n\n  useEffect(() => {\n    if (drawInFullRange) {\n      setXRange({ x1: rangeFrom, x2: rangeTo });\n    } else {\n      const _xRange = { x1: signal.delta, x2: signal.delta };\n      treeNodesData.forEach((_treeNodeData) => {\n        if (_treeNodeData.startX < _xRange.x1) {\n          _xRange.x1 = _treeNodeData.startX;\n        }\n        if (_treeNodeData.startX > _xRange.x2) {\n          _xRange.x2 = _treeNodeData.startX;\n        }\n        if (_treeNodeData._startX < _xRange.x1) {\n          _xRange.x1 = _treeNodeData._startX;\n        }\n        if (_treeNodeData._startX > _xRange.x2) {\n          _xRange.x2 = _treeNodeData._startX;\n        }\n      });\n      setXRange(_xRange);\n    }\n  }, [\n    drawInFullRange,\n    rangeFrom,\n    rangeTo,\n    signal.delta,\n    signal.multiplicity,\n    treeNodesData,\n  ]);\n\n  const multiplicityTree = useMemo(() => {\n    const { levelHeight } = treeProps;\n    // first tree level\n    const firstLevelStartY = startY;\n    let _startY = firstLevelStartY;\n    // second tree level\n    const secondLevelStartY = startY + levelHeight;\n    _startY = secondLevelStartY;\n\n    // third tree level\n    _startY += levelHeight;\n\n    if (drawInFullRange) {\n      const _rangeFrom = scaleX()(rangeFrom);\n      const _rangeTo = scaleX()(rangeTo);\n\n      const pathData = `M ${_rangeFrom} ${\n        _startY + levelHeight\n      } ${_rangeFrom} ${_startY} ${scaleX()(\n        signal.delta,\n      )} ${_startY} ${_rangeTo} ${_startY} ${_rangeTo} ${\n        _startY + levelHeight\n      }`;\n\n      return (\n        <g>\n          <StringNode\n            signal={signal}\n            startY={firstLevelStartY}\n            levelHeight={levelHeight}\n            fontSize={labelOptions.fontSize}\n            showLabels={showLabels}\n          />\n          <LevelNode\n            signal={signal}\n            startY={secondLevelStartY}\n            levelHeight={levelHeight}\n          />\n          <path d={pathData} stroke=\"blue\" fill=\"none\" />\n        </g>\n      );\n    }\n\n    return (\n      <g>\n        <StringNode\n          signal={signal}\n          startY={firstLevelStartY}\n          levelHeight={levelHeight}\n          fontSize={labelOptions.fontSize}\n          showLabels={showLabels}\n        />\n        <LevelNode\n          signal={signal}\n          startY={secondLevelStartY}\n          levelHeight={levelHeight}\n        />\n        <TreeNodes\n          nodesData={treeNodesData}\n          signalID={treeNodesData}\n          showLabels={showLabels}\n          startY={startY}\n          labelOptions={labelOptions}\n          levelHeight={levelHeight}\n        />\n      </g>\n    );\n  }, [\n    treeProps,\n    startY,\n    drawInFullRange,\n    signal,\n    labelOptions,\n    showLabels,\n    treeNodesData,\n    scaleX,\n    rangeFrom,\n    rangeTo,\n  ]);\n\n  return (\n    <g\n      css={\n        highlight.isActive || assignment.isActive\n          ? { ...styles, opacity: 1, strokeWidth: 1.5 }\n          : styles\n      }\n      {...{\n        onMouseEnter: () => {\n          assignment.onMouseEnter('x');\n          highlight.show();\n        },\n        onMouseLeave: () => {\n          assignment.onMouseLeave('x');\n          highlight.hide();\n        },\n      }}\n      {...{\n        onClick:\n          selectedTool && selectedTool === options.editRange.id\n            ? null\n            : (e) => {\n                if (e.shiftKey) {\n                  e.stopPropagation();\n                  assignment.onClick('x');\n                }\n              },\n      }}\n    >\n      {multiplicityTree}\n    </g>\n  );\n}\n\nexport default MultiplicityTree;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback, useState, useEffect } from 'react';\n\nimport { checkRangeKind } from '../../../data/utilities/RangeUtilities';\nimport { useAssignment } from '../../assignment';\nimport { useDispatch } from '../../context/DispatchContext';\nimport { useScale } from '../../context/ScaleContext';\nimport { TYPES, useHighlight } from '../../highlight';\nimport { RESIZE_RANGE } from '../../reducer/types/Types';\nimport { options } from '../../toolbar/ToolTypes';\nimport Resizable from '../Resizable';\nimport MultiplicityTree from '../multiplicityTree/MultiplicityTree';\n\nconst stylesOnHover = css`\n  pointer-events: bounding-box;\n  @-moz-document url-prefix() {\n    pointer-events: fill;\n  }\n  user-select: 'none';\n  -webkit-user-select: none; /* Chrome all / Safari all */\n  -moz-user-select: none; /* Firefox all */\n\n  // // disabled because Resizable component appears now when hovering over it\n  // :hover .range-area {\n  //   height: 100%;\n  //   fill: #ff6f0057;\n  //   cursor: pointer;\n  // }\n\n  .delete-button {\n    visibility: hidden;\n  }\n`;\n\nconst stylesHighlighted = css`\n  pointer-events: bounding-box;\n\n  @-moz-document url-prefix() {\n    pointer-events: fill;\n  }\n  .range-area {\n    height: 100%;\n    fill: #ff6f0057;\n  }\n  .delete-button {\n    visibility: visible;\n    cursor: pointer;\n  }\n`;\n\nfunction Range({ rangeData, showMultiplicityTrees, selectedTool }) {\n  const { id, from, to, integral, signal } = rangeData;\n  const assignmentRange = useAssignment(id);\n  const highlightRange = useHighlight(\n    [assignmentRange.id].concat(assignmentRange.assigned.x || []),\n    TYPES.RANGE,\n  );\n\n  const { scaleX } = useScale();\n  const dispatch = useDispatch();\n\n  const [reduceOpacity, setReduceOpacity] = useState(false);\n  const [isBlockedByEditing, setIsBlockedByEditing] = useState(false);\n\n  useEffect(() => {\n    if (selectedTool && selectedTool === options.editRange.id) {\n      setIsBlockedByEditing(true);\n    } else {\n      setIsBlockedByEditing(false);\n    }\n  }, [selectedTool]);\n\n  useEffect(() => {\n    setReduceOpacity(!checkRangeKind(rangeData));\n  }, [rangeData]);\n\n  const handleOnStopResizing = useCallback(\n    (resized) => {\n      dispatch({\n        type: RESIZE_RANGE,\n        data: { ...rangeData, ...resized },\n      });\n    },\n    [dispatch, rangeData],\n  );\n\n  const mouseEnterHandler = useCallback(() => {\n    assignmentRange.onMouseEnter('x');\n    highlightRange.show();\n  }, [assignmentRange, highlightRange]);\n  const mouseLeaveHandler = useCallback(() => {\n    assignmentRange.onMouseLeave('x');\n    highlightRange.hide();\n  }, [assignmentRange, highlightRange]);\n\n  const assignHandler = useCallback(\n    (e) => {\n      if (\n        selectedTool === options.rangesPicking.id &&\n        e.shiftKey &&\n        !isBlockedByEditing\n      ) {\n        assignmentRange.onClick('x');\n      }\n    },\n    [assignmentRange, isBlockedByEditing, selectedTool],\n  );\n\n  return (\n    <g\n      // tabIndex=\"0\"\n      style={{ outline: 'none' }}\n      css={\n        isBlockedByEditing ||\n        highlightRange.isActive ||\n        assignmentRange.isActive\n          ? stylesHighlighted\n          : stylesOnHover\n      }\n      key={id}\n      onMouseEnter={mouseEnterHandler}\n      onMouseLeave={mouseLeaveHandler}\n      onClick={assignHandler}\n    >\n      <g transform={`translate(${scaleX()(to)},10)`}>\n        <rect\n          x=\"0\"\n          width={scaleX()(from) - scaleX()(to)}\n          height=\"6\"\n          className=\"range-area\"\n          fill=\"green\"\n          fillOpacity={\n            !reduceOpacity ||\n            highlightRange.isActive ||\n            assignmentRange.isActive\n              ? 1\n              : 0.4\n          }\n        />\n        <text\n          textAnchor=\"middle\"\n          x={(scaleX()(from) - scaleX()(to)) / 2}\n          y=\"20\"\n          fontSize=\"10\"\n          fill=\"red\"\n          fillOpacity={\n            !reduceOpacity ||\n            highlightRange.isActive ||\n            assignmentRange.isActive\n              ? 1\n              : 0.6\n          }\n        >\n          {integral !== undefined ? integral.toFixed(2) : ''}\n        </text>\n      </g>\n      <Resizable\n        from={rangeData.from}\n        to={rangeData.to}\n        onDrop={handleOnStopResizing}\n      />\n      {showMultiplicityTrees && signal && signal.length > 0\n        ? signal.map((_signal) => (\n            <MultiplicityTree\n              rangeFrom={from}\n              rangeTo={to}\n              signal={_signal}\n              key={signal.id}\n            />\n          ))\n        : null}\n    </g>\n  );\n}\n\nexport default Range;\n","import { memo, useEffect, useState } from 'react';\n\nimport RangesWrapper from '../../hoc/RangesWrapper';\nimport Events from '../../utility/Events';\n\nimport Range from './Range';\n\nfunction Ranges({ ranges, displayerKey, selectedTool }) {\n  const [isMultiplicityTreesVisibile, showMultiplicityTrees] = useState(false);\n\n  useEffect(() => {\n    Events.on('showMultiplicityTrees', (flag) => {\n      showMultiplicityTrees(flag);\n    });\n  }, []);\n\n  return (\n    <g clipPath={`url(#${displayerKey}clip-chart-1d)`}>\n      {ranges &&\n        ranges.values &&\n        ranges.values.map((range) => (\n          <Range\n            key={range.id}\n            rangeData={range}\n            selectedTool={selectedTool}\n            showMultiplicityTrees={isMultiplicityTreesVisibile}\n          />\n        ))}\n    </g>\n  );\n}\n\nexport default RangesWrapper(memo(Ranges));\n","import { useScale } from '../context/ScaleContext';\n\nimport BaseLineZones from './BaseLineZones';\nimport IntegralsSeries from './IntegralsSeries';\nimport LinesSeries from './LinesSeries';\nimport PeaksNotations from './PeaksNotations';\nimport XAxis from './XAxis';\nimport MultiAnalysisRanges from './multiAnalysis/MultiAnalysisRanges';\nimport Ranges from './ranges/Ranges';\n\nfunction Chart1D({ mode, width, height, margin, displayerKey }) {\n  const { scaleX, scaleY } = useScale();\n  if (!scaleX || !scaleY || !width || !height) return null;\n\n  return (\n    <svg\n      viewBox={`0 0 ${width} ${height}`}\n      width={width}\n      height={height}\n      id=\"nmrSVG\"\n    >\n      <defs>\n        <clipPath id={`${displayerKey}clip-chart-1d`}>\n          <rect\n            width={`${width - margin.left - margin.right}`}\n            height={`${height}`}\n            x={`${margin.left}`}\n            y={`${0}`}\n          />\n        </clipPath>\n      </defs>\n\n      <LinesSeries />\n      <IntegralsSeries />\n      <PeaksNotations />\n      <Ranges />\n      <MultiAnalysisRanges />\n      <BaseLineZones />\n\n      <g className=\"container\" style={{ pointerEvents: 'none' }}>\n        <XAxis showGrid mode={mode} />\n        {/* <YAxis label=\"PPM\" show /> */}\n      </g>\n    </svg>\n  );\n}\n\nexport default Chart1D;\n","import { createContext, useCallback, useContext } from 'react';\n\nconst HelpContext = createContext();\n\nexport const HelpProvider = HelpContext.Provider;\n\nexport function useHelptData() {\n  return useContext(HelpContext).helpState;\n}\nexport function useHelp() {\n  const context = useContext(HelpContext);\n\n  const show = useCallback(\n    (e) => {\n      const id = e.target.getAttribute('data-helpid');\n      if (id) {\n        e.target.style.cursor = 'help';\n        context.dispatch({ type: 'SHOW', id });\n\n        context.show(id, { delay: e.ctrlKey ? 0 : null });\n      }\n    },\n    [context],\n  );\n\n  const hide = useCallback(() => {\n    context.dispatch({ type: 'HIDE' });\n    context.clear();\n  }, [context]);\n\n  const onHover = {\n    onMouseEnter: show,\n    onMouseLeave: hide,\n  };\n\n  return { show, hide, onHover };\n}\n","export const groupBy = (array, fn) =>\n  array.reduce((result, item) => {\n    const key = fn(item);\n    if (!result[key]) result[key] = [];\n    result[key].push(item);\n    return result;\n  }, {});\n","async function load(filePath) {\n  const response = await fetch(filePath);\n  checkStatus(response);\n  const data = await response.text();\n  return data;\n}\n\nfunction checkStatus(response) {\n  if (!response.ok) {\n    throw new Error(`HTTP ${response.status} - ${response.statusText}`);\n  }\n  return response;\n}\n\nexport { load };\n","export const initState = {\n  helpText: null,\n  helpObject: null,\n};\nexport default function helpReducer(state, action) {\n  switch (action.type) {\n    case 'SHOW': {\n      const helpText = state.data[action.id].text;\n      return { ...state, helpText };\n    }\n    case 'HIDE': {\n      return { ...state, helpText: null };\n    }\n    default: {\n      throw new Error(`unknown action type: ${action.type}`);\n    }\n  }\n}\n","import {\n  useReducer,\n  useRef,\n  useEffect,\n  useCallback,\n  Fragment,\n  useState,\n  memo,\n  useMemo,\n} from 'react';\nimport { createPortal } from 'react-dom';\nimport { FaTimes } from 'react-icons/fa';\nimport { Rnd } from 'react-rnd';\nimport { TransitionGroup } from 'react-transition-group';\n\nimport Transition from '../Transition';\nimport Wrapper from '../Wrapper';\nimport { groupBy } from '../helpers';\nimport { positions, transitions } from '../options';\nimport { load } from '../utility';\n\nimport { HelpProvider } from './Context';\nimport helpReducer, { initState } from './Reducer';\n\nconst transitionStyles = {\n  [transitions.FADE]: {\n    entering: { opacity: 0 },\n    entered: { opacity: 1 },\n  },\n  [transitions.SCALE]: {\n    entering: { transform: 'scale(0)' },\n    entered: { transform: 'scale(1)' },\n    exiting: { transform: 'scale(0)' },\n    exited: { transform: 'scale(0)' },\n  },\n};\n\nconst styles = {\n  innerContainer: {\n    display: 'flex',\n    flexDirection: 'column',\n    width: '100%',\n    height: '100%',\n    borderRadius: '5px',\n    padding: '10px',\n  },\n  outerContainer: {\n    boxSizing: 'initial',\n    backgroundColor: 'rgba(255, 255, 255, 1)',\n    boxShadow: '0px 0px 0px 0px, rgba(0, 0, 0, 0.1) 0px 3px 5px',\n    pointerEvents: 'all',\n  },\n  closeButton: {\n    border: 'none',\n    color: 'red',\n    backgroundColor: 'transparent',\n    outline: 'none',\n  },\n};\n\nlet dealyTimeOut = null;\n\nfunction Provider({\n  children,\n  data,\n  offset,\n  position,\n  timeout,\n  delay,\n  type,\n  transition,\n  containerStyle,\n  wrapperRef,\n  multiple,\n  preventAutoHelp,\n}) {\n  const root = useRef();\n  const timersId = useRef([]);\n  const [modals, setModals] = useState([]);\n\n  useEffect(() => {\n    root.current = document.createElement('div');\n    const ref = root.current;\n    if (wrapperRef) {\n      wrapperRef.appendChild(ref);\n    }\n\n    const timersIdRef = timersId.current;\n\n    return () => {\n      timersIdRef.forEach(clearTimeout);\n      if (wrapperRef) {\n        wrapperRef.removeChild(ref);\n      }\n    };\n  }, [wrapperRef]);\n\n  const remove = useCallback((modal) => {\n    setModals((currentModals) => {\n      const lengthBeforeRemove = currentModals.length;\n      const filteredModals = currentModals.filter((a) => a.id !== modal.id);\n\n      if (lengthBeforeRemove > filteredModals.length && modal.options.onClose) {\n        modal.options.onClose();\n      }\n\n      return filteredModals;\n    });\n  }, []);\n\n  const show = useCallback(\n    async (helpid, options = { delay: null }) => {\n      if (!modals.some((m) => m.helpid === helpid)) {\n        try {\n          const mdtext = await load(data[helpid].filePath);\n\n          const id = Math.random().toString(36).substr(2, 9);\n\n          const modalOptions = {\n            position: options.position || position,\n            timeout,\n            type,\n            ...options,\n          };\n\n          const modal = {\n            helpid,\n            id,\n            mdtext,\n            options: modalOptions,\n          };\n\n          modal.close = () => remove(modal);\n\n          const startModal = () => {\n            if (modal.options.timeout) {\n              const timerId = setTimeout(() => {\n                remove(modal);\n                timersId.current.splice(timersId.current.indexOf(timerId), 1);\n              }, modal.options.timeout);\n\n              timersId.current.push(timerId);\n            }\n\n            setModals((state) => (multiple ? state.concat(modal) : [modal]));\n\n            if (modal.options.onOpen) modal.options.onOpen();\n          };\n\n          if (options.delay === 0) {\n            startModal();\n          } else if (!preventAutoHelp) {\n            dealyTimeOut = setTimeout(\n              () => {\n                startModal();\n              },\n              options.delay > 0 ? options.delay : delay,\n            );\n          }\n          return modal;\n        } catch (e) {\n          // eslint-disable-next-line no-console\n          console.log(e);\n        }\n      }\n    },\n    [\n      data,\n      delay,\n      modals,\n      multiple,\n      position,\n      preventAutoHelp,\n      remove,\n      timeout,\n      type,\n    ],\n  );\n\n  const clear = useCallback(() => {\n    clearTimeout(dealyTimeOut);\n  }, []);\n\n  const parentStyle = useMemo(() => {\n    return wrapperRef\n      ? wrapperRef.getBoundingClientRect()\n      : {\n          top: 0,\n          left: 0,\n          width: window.innerWidth,\n          height: window.innerHeight,\n        };\n  }, [wrapperRef]);\n\n  const [helpState, dispatch] = useReducer(helpReducer, {\n    ...initState,\n    data,\n  });\n\n  const modalsByPosition = groupBy(\n    modals,\n    (modal) => modal.options && modal.options.position,\n  );\n\n  return (\n    <HelpProvider value={{ helpState, dispatch, show, clear }}>\n      {children}\n      {root.current &&\n        createPortal(\n          <Fragment>\n            {Object.keys(positions).map((key) => {\n              const _position = positions[key];\n\n              return (\n                <TransitionGroup\n                  appear\n                  key={_position}\n                  options={{ position, containerStyle }}\n                  containerStyle={parentStyle}\n                  component={Wrapper}\n                >\n                  {modalsByPosition[_position]\n                    ? modalsByPosition[_position].map((modal) => (\n                        <Transition\n                          type={transition}\n                          key={modal.id}\n                          transitionStyles={{\n                            ...transitionStyles,\n                            default: { width: '400px', height: '400px' },\n                          }}\n                        >\n                          <Rnd\n                            style={{\n                              margin: offset,\n                              ...styles.outerContainer,\n                            }}\n                            default={{\n                              x: 0,\n                              y: 0,\n                              width: 400,\n                              height: 400,\n                            }}\n                          >\n                            <div style={styles.innerContainer}>\n                              <div>\n                                <button\n                                  type=\"button\"\n                                  onClick={() => remove(modal)}\n                                  style={styles.closeButton}\n                                >\n                                  <FaTimes />\n                                </button>\n                              </div>\n                              {modal.mdtext && (\n                                <div\n                                  style={{\n                                    cursor: 'default',\n                                    width: '100%',\n                                    height: '100%',\n                                  }}\n                                >\n                                  <iframe\n                                    title=\"Tool User Manual\"\n                                    src={data[modal.helpid].filePath}\n                                    frameBorder=\"0\"\n                                    scrolling=\"auto\"\n                                    style={{ width: '100%', height: '100%' }}\n                                  />\n                                </div>\n                              )}\n                            </div>\n                          </Rnd>\n                        </Transition>\n                      ))\n                    : null}\n                </TransitionGroup>\n              );\n            })}\n          </Fragment>,\n          root.current,\n        )}\n    </HelpProvider>\n  );\n}\n\nProvider.defaultProps = {\n  offset: '10px',\n  position: positions.TOP_RIGHT,\n  timeout: 0,\n  delay: 2000,\n  transition: transitions.SCALE,\n  containerStyle: {\n    zIndex: 100,\n  },\n  wrapperRef: null,\n  multiple: false,\n  preventAutoHelp: false,\n};\n\nexport default memo(Provider);\n","import { forwardRef } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\n\nfunction FooterWarpper(WrappedComponent) {\n  const Wrapper = (props) => {\n    const {\n      margin,\n      width,\n      height,\n      activeSpectrum,\n      data,\n      activeTab,\n    } = useChartData();\n\n    const { forwardedRef, ...rest } = props;\n    return (\n      <WrappedComponent\n        {...rest}\n        data={data}\n        activeSpectrum={activeSpectrum}\n        activeTab={activeTab}\n        margin={margin}\n        width={width}\n        height={height}\n        ref={forwardedRef}\n      />\n    );\n  };\n\n  return forwardRef((props, ref) => {\n    return <Wrapper {...props} forwardedRef={ref} />;\n  });\n}\nexport default FooterWarpper;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { xFindClosestIndex } from 'ml-spectra-processing';\nimport { useContext, useCallback, Fragment, memo } from 'react';\nimport { BsCursor } from 'react-icons/bs';\nimport { IoPulseSharp } from 'react-icons/io5';\n\nimport { BrushContext } from '../EventsTrackers/BrushTracker';\nimport { MouseContext } from '../EventsTrackers/MouseTracker';\nimport { useScale } from '../context/ScaleContext';\nimport { useHelptData } from '../elements/popup/Help';\nimport FooterWarpper from '../hoc/FooterWarpper';\nimport { useFormatNumberByNucleus } from '../utility/FormatNumber';\n\nconst styles = css`\n  display: flex;\n  flex-firection: row;\n  align-items: center;\n  pointer-events: bounding-box;\n  user-select: 'none';\n  -webkit-user-select: none; /* Chrome all / Safari all */\n  -moz-user-select: none; /* Firefox all */\n  background-color: #f7f7f7;\n  height: 30px;\n  padding: 6px;\n  color: #8d0018;\n  position: absolute;\n  width: 100%;\n  bottom: 0;\n\n  .help {\n    font-size: 6px;\n    color: black;\n  }\n\n  div {\n    margin: 0px 10px;\n    display: inline-block;\n\n    .label {\n      font-size: 12px;\n      color: #4d4d4d;\n      font-weight: bold;\n    }\n    .value {\n      font-weight: bold;\n      font-size: 14px;\n      display: inline-block;\n    }\n    .unit {\n      font-weight: bold;\n      font-size: 10px;\n    }\n    .xvalue {\n      min-width: 50px;\n    }\n    .yvalue {\n      min-width: 80px;\n    }\n  }\n\n  .separator {\n    border-left: 2px solid gray;\n    margin: 0 20px;\n    width: 1px;\n    height: 100%;\n  }\n`;\n\nconst helpStyles = css`\n  pointer-events: bounding-box;\n  user-select: 'none';\n  -webkit-user-select: none; /* Chrome all / Safari all */\n  -moz-user-select: none; /* Firefox all */\n  background-color: #f7f7f7;\n  height: 30px;\n  padding: 6px;\n  color: #8d0018;\n  position: absolute;\n  width: 100%;\n  bottom: 0;\n  span {\n    font-size: 10px;\n    color: black;\n    display: inline-block;\n    text-overflow: ellipsis;\n    width: 100%;\n    white-space: nowrap;\n    overflow: hidden;\n  }\n`;\n\nfunction FooterBanner({\n  margin,\n  width,\n  height,\n  activeSpectrum,\n  data,\n  activeTab,\n}) {\n  let position = useContext(MouseContext);\n  const { startX, endX, step } = useContext(BrushContext);\n  const { scaleX } = useScale();\n  const { helpText } = useHelptData();\n  const { originFrequency: frequency } = activeSpectrum\n    ? data[activeSpectrum.index].info\n    : {};\n\n  const format = useFormatNumberByNucleus(activeTab);\n\n  const getYValue = useCallback(\n    (xPosition) => {\n      if (activeSpectrum) {\n        const xIndex = xFindClosestIndex(\n          data[activeSpectrum.index].data.x,\n          scaleX().invert(xPosition),\n        );\n        return data[activeSpectrum.index].data.y[xIndex];\n      }\n      return 1;\n    },\n    [activeSpectrum, data, scaleX],\n  );\n\n  if (helpText) {\n    return (\n      <div css={helpStyles}>\n        <span className=\"help\">{helpText}</span>\n      </div>\n    );\n  }\n\n  if (\n    !position ||\n    position.y < margin.top ||\n    position.x < margin.left ||\n    position.x > width - margin.right ||\n    position.y > height - margin.bottom\n  ) {\n    return <div css={styles} />;\n  }\n\n  return (\n    <div css={styles}>\n      <BsCursor />\n      <div>\n        <span className=\"label\"> X :</span>\n        <span className=\"value\">{format(scaleX().invert(position.x))}</span>\n        <span className=\"unit\">ppm</span>\n      </div>\n      {activeSpectrum && frequency && (\n        <div>\n          <span className=\"label\"> X :</span>\n          <span className=\"value xvalue\">\n            {format(scaleX().invert(position.x) * frequency, 'hz')}\n          </span>\n          <span className=\"unit\">Hz</span>\n        </div>\n      )}\n\n      {step === 'brushing' && (\n        <div>\n          <span className=\"label\"> ppm :</span>\n          <span className=\"value\">\n            {(scaleX().invert(startX) - scaleX().invert(endX)).toPrecision(6)}\n          </span>\n        </div>\n      )}\n      {activeSpectrum && (\n        <Fragment>\n          {frequency && step === 'brushing' && (\n            <div>\n              <span className=\"label\"> Hz :</span>\n              <span className=\"value\">\n                {(\n                  (scaleX().invert(startX) - scaleX().invert(endX)) *\n                  frequency\n                ).toPrecision(5)}\n              </span>\n            </div>\n          )}\n          {step === 'brushing' && (\n            <div>\n              <span className=\"label\"> ratio :</span>\n              <span className=\"value\">\n                {(\n                  (getYValue(startX) / (getYValue(endX) || Number.MIN_VALUE)) *\n                  100\n                ).toFixed(2)}\n                %\n              </span>\n            </div>\n          )}\n        </Fragment>\n      )}\n      {activeSpectrum && (\n        <Fragment>\n          <div className=\"separator\" />\n          <IoPulseSharp />\n          <div>\n            <span className=\"label\"> Y :</span>\n            <span className=\"value yvalue\">\n              {format(getYValue(position.x))}\n            </span>\n          </div>\n        </Fragment>\n      )}\n    </div>\n  );\n}\n\nexport default FooterWarpper(memo(FooterBanner));\n","import { xFindClosestIndex } from 'ml-spectra-processing';\nimport { useContext, useEffect, useMemo, useState } from 'react';\n\nimport { MouseContext } from '../EventsTrackers/MouseTracker';\nimport { useChartData } from '../context/ChartContext';\nimport { useScale } from '../context/ScaleContext';\nimport Events from '../utility/Events';\n\nconst styles = {\n  container: {\n    position: 'absolute',\n    left: '10px',\n    top: '10px',\n  },\n  value: {\n    width: '67px',\n    display: 'inline-block',\n    margin: '0 5px',\n    fontSize: '12px',\n  },\n  colorIndicator: {\n    width: '10px',\n    height: '1px',\n    borderBottom: `2px solid`,\n    display: 'inline-block',\n    marginBottom: '3px',\n  },\n  name: {\n    fontSize: '12px',\n  },\n};\n\nfunction YTracker({ datum }) {\n  const { scaleX } = useScale();\n  const position = useContext(MouseContext);\n\n  if (!scaleX || !position) {\n    return null;\n  }\n\n  const xIndex = xFindClosestIndex(datum.x, scaleX().invert(position.x));\n\n  return <span style={styles.value}>{datum.y[xIndex]}</span>;\n}\n\nfunction SpectraTracker() {\n  const { data, activeTab } = useChartData();\n  const [isVisible, ToggleVisiblility] = useState(false);\n  useEffect(() => {\n    Events.on('showYSpectraTrackers', (flag) => {\n      ToggleVisiblility(flag);\n    });\n\n    return () => Events.off('showYSpectraTrackers');\n  }, []);\n\n  const trackers = useMemo(() => {\n    return (\n      isVisible &&\n      data.map(\n        (datum) =>\n          datum.display.isVisible &&\n          datum.display.isVisibleInDomain &&\n          datum.info.nucleus === activeTab && (\n            <div style={{ display: 'block' }} key={datum.id}>\n              <span\n                style={{\n                  ...styles.colorIndicator,\n                  borderColor: datum.display.color,\n                }}\n              />\n              <YTracker datum={datum.data} />\n              <span style={styles.value}>{datum.display.name}</span>\n            </div>\n          ),\n        [],\n      )\n    );\n  }, [activeTab, data, isVisible]);\n\n  if (!isVisible) return null;\n\n  return <div style={styles.container}>{trackers}</div>;\n}\n\nexport default SpectraTracker;\n","import max from 'ml-array-max';\nimport { useContext, useEffect, useState } from 'react';\n\nimport { BrushContext } from '../../EventsTrackers/BrushTracker';\nimport { MouseContext } from '../../EventsTrackers/MouseTracker';\nimport { useChartData } from '../../context/ChartContext';\nimport { useScale } from '../../context/ScaleContext';\nimport { options } from '../../toolbar/ToolTypes';\n\nconst styles = {\n  radius: 10,\n  borderColor: '#1f1f1f',\n  strokeWidth: 1,\n  fillOpacity: 0,\n  SVGPadding: 1,\n};\n\nfunction PeakPointer() {\n  const {\n    height,\n    width,\n    margin,\n    activeSpectrum,\n    data,\n    mode,\n    selectedTool,\n    verticalAlign,\n  } = useChartData();\n  const { scaleX, scaleY } = useScale();\n\n  let position = useContext(MouseContext);\n  const brushState = useContext(BrushContext);\n  const [closePeakPosition, setPosition] = useState();\n\n  useEffect(() => {\n    function getVerticalAlign() {\n      if (activeSpectrum) {\n        return verticalAlign.flag\n          ? verticalAlign.stacked\n            ? (activeSpectrum.index + 1) * verticalAlign.value\n            : 0\n          : 0;\n      }\n      return 0;\n    }\n\n    const getClosePeak = (xShift, mouseCoordinates) => {\n      if (\n        activeSpectrum &&\n        position &&\n        selectedTool === options.peakPicking.id\n      ) {\n        const range = [\n          scaleX().invert(mouseCoordinates.x - xShift),\n          scaleX().invert(mouseCoordinates.x + xShift),\n        ].sort(function (a, b) {\n          return a - b;\n        });\n\n        //get the active sepectrum data by looking for it by id\n        const spectrumData = data.find((d) => d.id === activeSpectrum.id);\n\n        const maxIndex =\n          spectrumData.data.x.findIndex((number) => number >= range[1]) - 1;\n        const minIndex = spectrumData.data.x.findIndex(\n          (number) => number >= range[0],\n        );\n\n        const yDataRange = spectrumData.data.y.slice(minIndex, maxIndex);\n        if (yDataRange && yDataRange.length > 0) {\n          const yValue = max(yDataRange);\n          const xIndex = yDataRange.findIndex((value) => value === yValue);\n          const xValue = spectrumData.data.x[minIndex + xIndex];\n          return {\n            x: scaleX()(xValue),\n            y: scaleY(activeSpectrum.id)(yValue) - getVerticalAlign(),\n            xIndex: minIndex + xIndex,\n          };\n        }\n      }\n      return null;\n    };\n\n    const candidatePeakPosition = getClosePeak(10, position);\n    setPosition(candidatePeakPosition);\n  }, [\n    activeSpectrum,\n    data,\n    mode,\n    position,\n    scaleX,\n    scaleY,\n    selectedTool,\n    verticalAlign,\n  ]);\n\n  if (\n    selectedTool !== options.peakPicking.id ||\n    !closePeakPosition ||\n    !activeSpectrum ||\n    brushState.step === 'brushing' ||\n    !position ||\n    position.y < margin.top ||\n    position.left < margin.left ||\n    position.x > width - margin.right ||\n    position.y > height - margin.bottom\n  ) {\n    return null;\n  }\n\n  return (\n    <div\n      key=\"peakPointer\"\n      style={{\n        cursor: 'crosshair',\n        transform: `translate(${closePeakPosition.x}px, ${closePeakPosition.y}px)`,\n        transformOrigin: 'top left',\n        position: 'absolute',\n        top: -(styles.radius + styles.SVGPadding),\n        left: -(styles.radius + styles.SVGPadding),\n        pointerEvents: 'none',\n        overflow: 'visible',\n      }}\n    >\n      <svg\n        width={styles.radius * 2 + styles.SVGPadding * 2}\n        height={styles.radius * 2 + styles.SVGPadding * 2}\n      >\n        <circle\n          cx={styles.radius + styles.SVGPadding}\n          cy={styles.radius + styles.SVGPadding}\n          r={styles.radius}\n          stroke={styles.borderColor}\n          strokeWidth={styles.strokeWidth}\n          fillOpacity={styles.fillOpacity}\n        />\n        <line\n          x1={styles.radius + styles.SVGPadding}\n          y1={styles.SVGPadding}\n          x2={styles.radius + styles.SVGPadding}\n          y2={styles.radius * 2 + styles.SVGPadding}\n          stroke={styles.borderColor}\n          strokeWidth={styles.strokeWidth}\n        />\n        <line\n          x1={styles.SVGPadding}\n          y1={styles.radius + styles.SVGPadding}\n          x2={styles.radius * 2 + styles.SVGPadding}\n          y2={styles.radius + styles.SVGPadding}\n          stroke={styles.borderColor}\n          strokeWidth={styles.strokeWidth}\n        />\n      </svg>\n    </div>\n  );\n}\n\nexport default PeakPointer;\n","import { useChartData } from '../../context/ChartContext';\nimport { useScale } from '../../context/ScaleContext';\nimport { options } from '../../toolbar/ToolTypes';\n\nconst styles = {\n  container: {\n    transformOrigin: 'top left',\n    position: 'absolute',\n    top: '0px',\n    left: '0px',\n    width: 1,\n    backgroundColor: 'red',\n  },\n};\n\nfunction VerticalIndicator() {\n  const { height, selectedTool, pivot } = useChartData();\n  const { scaleX } = useScale();\n\n  if (options.phaseCorrection.id !== selectedTool) return null;\n  return (\n    <div\n      style={{\n        ...styles.container,\n        transform: `translate(${scaleX()(pivot)}px, 0px)`,\n        height: height,\n      }}\n    />\n  );\n}\n\nexport default VerticalIndicator;\n","import { useContext, useCallback, useMemo } from 'react';\n\nimport { BrushContext } from '../../EventsTrackers/BrushTracker';\nimport { MouseContext } from '../../EventsTrackers/MouseTracker';\nimport { useChartData } from '../../context/ChartContext';\nimport { useScale } from '../../context/ScaleContext';\nimport { useFormatNumberByNucleus } from '../../utility/FormatNumber';\n\nconst style = {\n  cursor: 'crosshair',\n  transformOrigin: 'bottom right',\n  position: 'absolute',\n  top: '-18px',\n  left: '-30px',\n  pointerEvents: 'none',\n  overflow: 'visible',\n  userSelect: 'none',\n};\n\nfunction XLabelPointer() {\n  const { height, width, margin, data, activeSpectrum } = useChartData();\n  const { scaleX } = useScale();\n\n  const position = useContext(MouseContext);\n  const brushState = useContext(BrushContext);\n  const activeSpectrumData = useMemo(() => {\n    const spectrumData = activeSpectrum\n      ? data.find((d) => d.id === activeSpectrum.id)\n      : null;\n    return spectrumData;\n  }, [activeSpectrum, data]);\n  const format = useFormatNumberByNucleus(\n    activeSpectrumData && activeSpectrumData.info.nucleus,\n  );\n\n  const getXValue = useCallback(\n    (xVal) => {\n      if (activeSpectrumData) {\n        const xInvert = scaleX().invert(xVal);\n        return format(xInvert);\n      }\n    },\n    [activeSpectrumData, format, scaleX],\n  );\n\n  if (\n    !activeSpectrum ||\n    brushState.step === 'brushing' ||\n    !position ||\n    position.y < margin.top ||\n    position.x < margin.left ||\n    position.x > width - margin.right ||\n    position.y > height - margin.bottom\n  ) {\n    return null;\n  }\n  return (\n    <div\n      key=\"xLabelPointer\"\n      style={{\n        ...style,\n        transform: `translate(${position.x}px, ${position.y}px)`,\n      }}\n    >\n      <span>{getXValue(position.x)}</span>\n    </div>\n  );\n}\n\nexport default XLabelPointer;\n","import { useCallback, Fragment, useEffect, useState, useReducer } from 'react';\nimport { useSize, useDebounce } from 'react-use';\n\nimport { BrushTracker } from '../EventsTrackers/BrushTracker';\nimport { MouseTracker } from '../EventsTrackers/MouseTracker';\nimport { useChartData } from '../context/ChartContext';\nimport { useDispatch } from '../context/DispatchContext';\nimport { usePreferences } from '../context/PreferencesContext';\nimport { ScaleProvider } from '../context/ScaleContext';\nimport { useModal } from '../elements/popup/Modal';\nimport Spinner from '../loader/Spinner';\nimport MultipletAnalysisModal from '../modal/MultipletAnalysisModal';\nimport { ZoomType } from '../reducer/actions/Zoom';\nimport {\n  scaleInitialState,\n  scaleReducer,\n  SET_SCALE,\n} from '../reducer/scaleReducer';\nimport {\n  ADD_INTEGRAL,\n  ADD_PEAKS,\n  ADD_BASE_LINE_ZONE,\n  BRUSH_END,\n  FULL_ZOOM_OUT,\n  CHANGE_INTEGRAL_ZOOM,\n  SET_ZOOM_FACTOR,\n  ADD_PEAK,\n  SET_VERTICAL_INDICATOR_X_POSITION,\n  SET_DIMENSIONS,\n  ADD_RANGE,\n  ANALYZE_SPECTRA,\n} from '../reducer/types/Types';\nimport BrushXY, { BRUSH_TYPE } from '../tool/BrushXY';\nimport CrossLinePointer from '../tool/CrossLinePointer';\nimport { options } from '../toolbar/ToolTypes';\nimport Events from '../utility/Events';\n\nimport Chart1D from './Chart1D';\nimport FooterBanner from './FooterBanner';\nimport SpectraTracker from './SpectraTracker';\nimport PeakPointer from './tool/PeakPointer';\nimport VerticalIndicator from './tool/VerticalIndicator';\nimport XLabelPointer from './tool/XLabelPointer';\n\nfunction Viewer1D() {\n  const {\n    display: { general },\n  } = usePreferences();\n  const state = useChartData();\n  const {\n    selectedTool,\n    isLoading,\n    data,\n    mode,\n    width: widthProp,\n    height: heightProp,\n    margin,\n    activeSpectrum,\n    xDomain,\n    xDomains,\n    yDomain,\n    yDomains,\n    verticalAlign,\n    displayerKey,\n  } = state;\n\n  const dispatch = useDispatch();\n  const modal = useModal();\n  const [scaleState, dispatchScale] = useReducer(\n    scaleReducer,\n    scaleInitialState,\n  );\n\n  useEffect(() => {\n    dispatchScale({\n      type: SET_SCALE,\n      yDomain,\n      yDomains,\n      xDomain,\n      xDomains,\n      margin,\n      height: heightProp,\n      width: widthProp,\n      verticalAlign,\n      mode,\n    });\n  }, [\n    heightProp,\n    margin,\n    mode,\n    verticalAlign,\n    widthProp,\n    xDomain,\n    xDomains,\n    yDomain,\n    yDomains,\n  ]);\n\n  const handelBrushEnd = useCallback(\n    (brushData) => {\n      const propagateEvent = () => {\n        const { startX, endX } = brushData;\n        const startXPPM = scaleState.scaleX().invert(startX);\n        const endXPPM = scaleState.scaleX().invert(endX);\n        Events.emit('brushEnd', {\n          ...brushData,\n          range: [startXPPM, endXPPM].sort(),\n        });\n      };\n\n      if (brushData.altKey) {\n        switch (selectedTool) {\n          case options.rangesPicking.id: {\n            if (!general.disableMultipletAnalysis) {\n              modal.show(\n                <MultipletAnalysisModal\n                  data={data}\n                  activeSpectrum={activeSpectrum}\n                  scaleX={scaleState.scaleX}\n                  {...brushData}\n                />,\n                {\n                  onClose: () => {\n                    modal.close();\n                  },\n                },\n              );\n            }\n            break;\n          }\n          default:\n            break;\n        }\n      } else if (brushData.shiftKey) {\n        switch (selectedTool) {\n          case options.integral.id:\n            dispatch({\n              type: ADD_INTEGRAL,\n              ...brushData,\n            });\n            break;\n          case options.rangesPicking.id:\n            dispatch({\n              type: ADD_RANGE,\n              ...brushData,\n            });\n            break;\n          case options.multipleSpectraAnalysis.id:\n            dispatch({\n              type: ANALYZE_SPECTRA,\n              ...brushData,\n            });\n            break;\n\n          case options.peakPicking.id:\n            dispatch({\n              type: ADD_PEAKS,\n              ...brushData,\n            });\n            break;\n          default:\n            propagateEvent(brushData);\n\n            break;\n        }\n      } else {\n        switch (selectedTool) {\n          case options.baseLineCorrection.id:\n            dispatch({\n              type: ADD_BASE_LINE_ZONE,\n              zone: { from: brushData.startX, to: brushData.endX },\n            });\n            break;\n\n          default:\n            if (selectedTool != null) {\n              dispatch({ type: BRUSH_END, ...brushData });\n            }\n            break;\n        }\n      }\n    },\n    [scaleState, selectedTool, general, modal, data, activeSpectrum, dispatch],\n  );\n\n  const handelOnDoubleClick = useCallback(() => {\n    dispatch({ type: FULL_ZOOM_OUT, zoomType: ZoomType.STEP_HROZENTAL });\n  }, [dispatch]);\n\n  const handleZoom = useCallback(\n    (event) => {\n      switch (selectedTool) {\n        case options.integral.id:\n          dispatch({ type: CHANGE_INTEGRAL_ZOOM, ...event });\n          break;\n\n        default:\n          dispatch({ type: SET_ZOOM_FACTOR, ...event });\n\n          return;\n      }\n    },\n    [dispatch, selectedTool],\n  );\n\n  const mouseClick = useCallback(\n    (position) => {\n      const propagateEvent = () => {\n        const xPPM = scaleState.scaleX().invert(position.x);\n        Events.emit('mouseClick', {\n          ...position,\n          xPPM,\n        });\n      };\n\n      if (position.shiftKey) {\n        switch (selectedTool) {\n          case options.peakPicking.id:\n            dispatch({\n              type: ADD_PEAK,\n              mouseCoordinates: position,\n            });\n            break;\n          default:\n            break;\n        }\n      } else {\n        switch (selectedTool) {\n          case options.phaseCorrection.id:\n            dispatch({\n              type: SET_VERTICAL_INDICATOR_X_POSITION,\n              position: position.x,\n            });\n            break;\n          case 'editRange':\n            if (position.shiftKey) {\n              propagateEvent();\n            }\n            break;\n\n          default:\n        }\n      }\n    },\n    [dispatch, scaleState, selectedTool],\n  );\n\n  const [sizedNMRChart, { width, height }] = useSize(() => {\n    return (\n      <Fragment>\n        <Spinner isLoading={isLoading} />\n\n        {data && data.length > 0 && (\n          <BrushTracker\n            onBrush={handelBrushEnd}\n            onDoubleClick={handelOnDoubleClick}\n            onClick={mouseClick}\n            onZoom={handleZoom}\n            style={{\n              width: '100%',\n              height: '100%',\n              margin: 'auto',\n              position: 'relative',\n              overflow: 'hidden',\n            }}\n          >\n            <MouseTracker\n              style={{ width: '100%', height: `100%`, position: 'absolute' }}\n            >\n              <SpectraTracker />\n              <CrossLinePointer />\n              <BrushXY brushType={BRUSH_TYPE.X} />\n              <XLabelPointer />\n              <PeakPointer />\n              <VerticalIndicator />\n              <FooterBanner />\n              <Chart1D\n                width={widthProp}\n                height={heightProp}\n                margin={margin}\n                mode={mode}\n                displayerKey={displayerKey}\n              />\n            </MouseTracker>\n          </BrushTracker>\n        )}\n      </Fragment>\n    );\n  }, []);\n\n  const [finalSize, setFinalSize] = useState();\n  useDebounce(() => setFinalSize({ width, height }), 400, [width, height]);\n  useEffect(() => {\n    if (finalSize && isFinite(finalSize.width) && isFinite(finalSize.height)) {\n      dispatch({\n        type: SET_DIMENSIONS,\n        ...finalSize,\n      });\n    }\n  }, [dispatch, finalSize]);\n\n  return <ScaleProvider value={scaleState}>{sizedNMRChart}</ScaleProvider>;\n}\n\nexport default Viewer1D;\n","const LAYOUT = {\n  TOP_1D: 'TOP_1D',\n  LEFT_1D: 'LEFT_1D',\n  CENTER_2D: 'CENTER_2D',\n};\n\nfunction get2DDimensionLayout({ width, height, margin }) {\n  return {\n    CENTER_2D: {\n      startX: margin.left,\n      startY: margin.top,\n      endX: width - margin.right,\n      endY: height - margin.bottom,\n    },\n    TOP_1D: {\n      startX: margin.left,\n      startY: 0,\n      endX: width - margin.right,\n      endY: margin.top,\n    },\n    LEFT_1D: {\n      startX: 0,\n      startY: margin.top,\n      endX: margin.left,\n      endY: height - margin.bottom,\n    },\n  };\n}\n\nfunction getLayoutID(dimension, brushData) {\n  for (const key of Object.keys(dimension)) {\n    if (\n      brushData.startX >= dimension[key].startX &&\n      brushData.startX <= dimension[key].endX &&\n      brushData.startY >= dimension[key].startY &&\n      brushData.startY <= dimension[key].endY\n    ) {\n      return key;\n    }\n  }\n  return null;\n}\n\nexport { LAYOUT, get2DDimensionLayout, getLayoutID };\n","import { scaleLinear } from 'd3';\n\nimport { LAYOUT } from './DimensionLayout';\n\n/***\n * @param {object} props\n * @param {number}  props.width\n * @param {number}  props.margin\n * @param {number}  props.xDomain\n */\n\nfunction get2DXScale(props) {\n  const { width, margin, xDomain } = props;\n  return scaleLinear(xDomain, [width - margin.right, margin.left]);\n}\n\n/***\n * props {height,margin,yDomain}\n */\n/***\n * @param {any} props\n * @param {number}  props.height\n * @param {number}  props.margin\n * @param {number}  props.yDomain\n */\nfunction get2DYScale(props, reverse = false) {\n  const { height, margin, yDomain } = props;\n  return scaleLinear(\n    yDomain,\n    reverse\n      ? [height - margin.bottom, margin.top]\n      : [margin.top, height - margin.bottom],\n  );\n}\n\nfunction get1DXScale(props, layout) {\n  if (![LAYOUT.TOP_1D, LAYOUT.LEFT_1D].includes(layout)) {\n    throw new Error(\n      `layout is required and must be ${LAYOUT.TOP_1D} or ${LAYOUT.LEFT_1D}  `,\n    );\n  }\n\n  switch (layout) {\n    case LAYOUT.TOP_1D: {\n      const { width, margin, xDomain } = props;\n      return scaleLinear(xDomain, [width - margin.right, margin.left]);\n    }\n    case LAYOUT.LEFT_1D: {\n      const { height, margin, yDomain } = props;\n      return scaleLinear(yDomain, [height - margin.bottom, margin.top]);\n    }\n    default:\n      break;\n  }\n}\n\nfunction get1DYScale(yDomain, height, margin = 10) {\n  return scaleLinear(yDomain, [height - margin, margin]);\n}\n\nexport { get2DXScale, get2DYScale, get1DXScale, get1DYScale };\n","import get from 'lodash/get';\nimport { useMemo } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\nimport { usePreferences } from '../context/PreferencesContext';\n\nimport { get2DXScale, get2DYScale } from './utilities/scale';\n\nfunction ContoursPaths({ id: spectrumID, sign, color }) {\n  const {\n    margin,\n    width,\n    height,\n    xDomain,\n    yDomain,\n    contours,\n    activeSpectrum,\n  } = useChartData();\n\n  const preferences = usePreferences();\n\n  const isActive = useMemo(() => {\n    return activeSpectrum === null\n      ? true\n      : spectrumID === activeSpectrum.id\n      ? true\n      : false;\n  }, [activeSpectrum, spectrumID]);\n\n  function buildContourPath(data) {\n    const _scaleX = get2DXScale({ margin, width, xDomain });\n    const _scaleY = get2DYScale({ margin, height, yDomain });\n    let path = '';\n    for (let i = 0; i < data.length; i++) {\n      if (data[i].lines) {\n        const lines = data[i].lines;\n        if (lines.length < 1e6) {\n          for (let i = 0; i < lines.length; i += 4) {\n            path += `M${_scaleX(lines[i])} ${_scaleY(lines[i + 1])} `;\n            path += `L${_scaleX(lines[i + 2])} ${_scaleY(lines[i + 3])} `;\n          }\n        }\n      } else {\n        path += `M${_scaleX(data[i][0].x)} ${_scaleY(data[i][0].y)} `;\n        for (let j = 1; j < data[i].length; j++) {\n          path += `L${_scaleX(data[i][j].x)} ${_scaleY(data[i][j].y)} `;\n        }\n      }\n    }\n    if (!path) path = 'M0 0 ';\n    path += 'Z';\n\n    return path;\n  }\n  const data = useMemo(() => {\n    return get(contours, `${spectrumID}.${sign}`, []);\n  }, [contours, sign, spectrumID]);\n  return (\n    <path\n      fill=\"none\"\n      stroke={color}\n      strokeWidth=\"1\"\n      style={{\n        opacity: isActive\n          ? 1\n          : get(preferences, 'controllers.dimmedSpectraTransparency', 0.1),\n      }}\n      d={buildContourPath(data)}\n    />\n  );\n}\n\nfunction Contours() {\n  const { data, displayerKey } = useChartData();\n\n  return (\n    <g clipPath={`url(#${displayerKey}clip-chart-2d)`} className=\"contours\">\n      {data\n        .filter((datum) => datum.info.dimension === 2)\n        .map((datum, index) => (\n          <g key={`${datum.id + index}`}>\n            {datum.display.isPositiveVisible && (\n              <ContoursPaths\n                id={datum.id}\n                sign=\"positive\"\n                color={datum.display.positiveColor}\n              />\n            )}\n            {datum.display.isNegativeVisible && (\n              <ContoursPaths\n                id={datum.id}\n                sign=\"negative\"\n                color={datum.display.negativeColor}\n              />\n            )}\n          </g>\n        ))}\n    </g>\n  );\n}\n\nexport default Contours;\n","export const DEFAULT_YAXIS_SHIFT_VALUE = 20;\n\nexport const DISPLAYER_MODE = {\n  DM_1D: '1D',\n  DM_2D: '2D',\n};\n\nexport const MARGIN = {\n  '2D': { top: 100, right: 50, bottom: 70, left: 100 },\n  '1D': {\n    top: 10,\n    right: 10,\n    bottom: 70,\n    left: 10,\n  },\n};\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useState, useEffect, useMemo } from 'react';\n\nimport { SignalKindsToInclude } from '../../data/constants/SignalsKinds';\nimport { useChartData } from '../context/ChartContext';\nimport { DISPLAYER_MODE } from '../reducer/core/Constants';\n\nimport { get2DXScale, get2DYScale } from './utilities/scale';\n\nconst lineStyle = css`\n  stroke: lightgrey;\n  opacity: 0.7;\n`;\n\nfunction IndicationLines({ axis, show }) {\n  const {\n    data,\n    activeTab,\n    margin,\n    width,\n    height,\n    xDomain,\n    yDomain,\n    displayerMode,\n  } = useChartData();\n  const [deltas1D, setDeltas1D] = useState([]);\n\n  const scaleX = get2DXScale({ margin, width, xDomain });\n  const scaleY = get2DYScale({ margin, height, yDomain });\n\n  useEffect(() => {\n    const split = activeTab.split(',');\n    if (displayerMode === DISPLAYER_MODE.DM_2D && split.length === 2) {\n      const nucleus = axis === 'X' ? split[0] : axis === 'Y' ? split[1] : null;\n      if (nucleus !== null) {\n        const ranges = data\n          .filter(\n            (_datum) =>\n              _datum.info.dimension === 1 &&\n              _datum.display.isVisible === true &&\n              _datum.info.nucleus === nucleus &&\n              _datum.info.experiment === '1d',\n          )\n          .map((_datum) => _datum.ranges.values)\n          .flat();\n        const deltas = ranges\n          .map((_range) =>\n            _range.signal\n              .filter((_signal) =>\n                SignalKindsToInclude.some((_kind) => _signal.kind === _kind),\n              )\n              .map((_signal) => _signal.delta),\n          )\n          .flat();\n        setDeltas1D(deltas);\n      } else {\n        setDeltas1D([]);\n      }\n    } else {\n      setDeltas1D([]);\n    }\n  }, [activeTab, axis, data, displayerMode]);\n\n  const indicationLines = useMemo(() => {\n    if (show === true && deltas1D.length > 0) {\n      const lines = deltas1D.map((_delta, i) => {\n        return axis === 'X' ? (\n          <line\n            css={lineStyle}\n            // eslint-disable-next-line react/no-array-index-key\n            key={`indicationLine${axis}${i}`}\n            x1={scaleX(_delta)}\n            x2={scaleX(_delta)}\n            y1={scaleY(yDomain[0])}\n            y2={scaleY(yDomain[1])}\n          />\n        ) : axis === 'Y' ? (\n          <line\n            css={lineStyle}\n            // eslint-disable-next-line react/no-array-index-key\n            key={`indicationLine${axis}${i}`}\n            x1={scaleX(xDomain[0])}\n            x2={scaleX(xDomain[1])}\n            y1={scaleY(_delta)}\n            y2={scaleY(_delta)}\n          />\n        ) : null;\n      });\n      return lines;\n    }\n  }, [axis, deltas1D, scaleX, scaleY, show, xDomain, yDomain]);\n\n  return <g>{indicationLines}</g>;\n}\n\nexport default IndicationLines;\n","import { xyReduce } from 'ml-spectra-processing';\nimport { useMemo, memo } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\n\nimport { get1DYScale, get2DYScale } from './utilities/scale';\n\nfunction Left1DChart({ margin: marignValue, data: spectrum }) {\n  const {\n    height: originHeight,\n    margin,\n    yDomain,\n    yDomains,\n    displayerKey,\n  } = useChartData();\n\n  const height = margin.left;\n\n  const paths = useMemo(() => {\n    if (spectrum) {\n      const scaleX = get2DYScale({\n        height: originHeight,\n        yDomain: [yDomain[0], yDomain[1]],\n        margin,\n      });\n      const scaleY = get1DYScale(yDomains[spectrum.id], height, marignValue);\n\n      const { x, y } = spectrum.data;\n      const pathPoints = xyReduce(\n        { x, y },\n        {\n          from: yDomain[0],\n          to: yDomain[1],\n        },\n      );\n      const lastXIndex = pathPoints.x.length - 1;\n      const lastYIndex = pathPoints.y.length - 1;\n      let path = `M  ${scaleY(pathPoints.y[lastYIndex])} ${scaleX(\n        lastXIndex,\n      )} `;\n      path += pathPoints.x\n        .slice(0, lastXIndex)\n        .reduceRight((accumulator, point, index) => {\n          accumulator += ` L  ${scaleY(pathPoints.y[index])} ${scaleX(point)}`;\n          return accumulator;\n        }, '');\n      return path;\n    } else {\n      return null;\n    }\n  }, [height, margin, marignValue, originHeight, spectrum, yDomain, yDomains]);\n\n  const mainHeight = originHeight - margin.bottom - margin.top;\n\n  if (!mainHeight || !height) return null;\n\n  return (\n    <svg\n      viewBox={`0 0 ${height} ${mainHeight + margin.top}`}\n      width={height}\n      height={mainHeight + margin.top}\n    >\n      <defs>\n        <clipPath id={`${displayerKey}clip-left`}>\n          <rect width={height} height={mainHeight} x=\"0\" y={margin.top} />\n        </clipPath>\n      </defs>\n      <g clipPath={`url(#${displayerKey}clip-left)`}>\n        <path className=\"line\" stroke=\"black\" fill=\"none\" d={paths} />\n      </g>\n    </svg>\n  );\n}\n\nLeft1DChart.defaultProps = {\n  margin: 10,\n};\n\nexport default memo(Left1DChart);\n","import { xyReduce } from 'ml-spectra-processing';\nimport { useMemo, memo } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\n\nimport { get1DYScale, get2DXScale } from './utilities/scale';\n\nfunction Top1DChart({ margin: marginProps, data: spectrum }) {\n  const {\n    width,\n    margin: originMargin,\n    xDomain,\n    yDomains,\n    displayerKey,\n  } = useChartData();\n\n  const height = originMargin.top;\n\n  const paths = useMemo(() => {\n    if (spectrum) {\n      const scaleX = get2DXScale({ width, xDomain, margin: originMargin });\n\n      const scaleY = get1DYScale(yDomains[spectrum.id], height, marginProps);\n\n      const { x, y } = spectrum.data;\n      const pathPoints = xyReduce(\n        { x, y },\n        {\n          from: xDomain[0],\n          to: xDomain[1],\n        },\n      );\n\n      let path = `M ${scaleX(pathPoints.x[0])} ${scaleY(pathPoints.y[0])} `;\n      path += pathPoints.x.slice(1).reduce((accumulator, point, i) => {\n        accumulator += ` L ${scaleX(point)} ${scaleY(pathPoints.y[i + 1])}`;\n        return accumulator;\n      }, '');\n      return path;\n    } else {\n      return null;\n    }\n  }, [height, marginProps, originMargin, spectrum, width, xDomain, yDomains]);\n\n  if (!width || !height) {\n    return null;\n  }\n\n  return (\n    <svg viewBox={`0 0 ${width} ${height}`} width={width} height={height}>\n      <defs>\n        <clipPath id={`${displayerKey}clip-top`}>\n          <rect\n            width={width - originMargin.left - originMargin.right}\n            height={height}\n            x={originMargin.left}\n            y={`${0}`}\n          />\n        </clipPath>\n      </defs>\n      <g clipPath={`url(#${displayerKey}clip-top)`}>\n        <path\n          className=\"line\"\n          stroke=\"red\"\n          fill=\"none\"\n          strokeWidth=\"1px\"\n          d={paths}\n        />\n      </g>\n    </svg>\n  );\n}\n\nTop1DChart.defaultProps = {\n  margin: 10,\n};\n\nexport default memo(Top1DChart);\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport * as d3 from 'd3';\nimport PropTypes from 'prop-types';\nimport { useEffect, useRef, useMemo, memo } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\n\nimport { get2DXScale } from './utilities/scale';\n\nconst axisStyles = css`\n  user-select: none;\n\n  path,\n  line {\n    fill: none;\n    stroke: black;\n    stroke-width: 1;\n    shape-rendering: crispEdges;\n    user-select: none;\n  }\n`;\n\nfunction XAxis({ show, label, margin: marginProps }) {\n  const state = useChartData();\n  const {\n    xDomain,\n    height,\n    width,\n    margin,\n    tabActiveSpectrum,\n    activeTab,\n  } = state;\n\n  const refAxis = useRef();\n\n  useEffect(() => {\n    const xAxis = d3.axisBottom().ticks(8).tickFormat(d3.format('0'));\n\n    if (show) {\n      const scaleX = get2DXScale({ width, margin, xDomain });\n      d3.select(refAxis.current).call(xAxis.scale(scaleX));\n    }\n  }, [\n    activeTab,\n    height,\n    margin,\n    margin.bottom,\n    margin.left,\n    margin.right,\n    margin.top,\n    show,\n    tabActiveSpectrum,\n    width,\n    xDomain,\n  ]);\n\n  const Axis = useMemo(\n    () =>\n      show &&\n      show === true && (\n        <g\n          className=\"x\"\n          css={axisStyles}\n          transform={`translate(0,${\n            height - (margin.bottom + marginProps.bottom)\n          })`}\n          ref={refAxis}\n        >\n          <text fill=\"#000\" x={width - 60} y=\"20\" dy=\"0.71em\" textAnchor=\"end\">\n            {label}\n          </text>\n        </g>\n      ),\n\n    [height, label, margin.bottom, marginProps.bottom, show, width],\n  );\n\n  if (!width || !height) {\n    return null;\n  }\n\n  return Axis;\n}\n\nXAxis.propTypes = {\n  margin: PropTypes.shape({\n    top: PropTypes.number.isRequired,\n    right: PropTypes.number.isRequired,\n    bottom: PropTypes.number.isRequired,\n    left: PropTypes.number.isRequired,\n  }),\n  show: PropTypes.bool,\n  label: PropTypes.string,\n};\n\nXAxis.defaultProps = {\n  show: true,\n  label: ' [ppm]',\n  margin: { right: 100, top: 0, left: 0, bottom: 0 },\n};\n\nexport default memo(XAxis);\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport * as d3 from 'd3';\nimport { Fragment, useEffect, useRef, useMemo, memo } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\n\nimport { get2DYScale } from './utilities/scale';\n\nconst axisStyles = css`\n  user-select: 'none';\n  -webkit-user-select: none; /* Chrome all / Safari all */\n  -moz-user-select: none; /* Firefox all */\n\n  path,\n  line {\n    fill: none;\n    stroke: black;\n    stroke-width: 1;\n    shape-rendering: crispEdges;\n    user-select: 'none';\n    -webkit-user-select: none; /* Chrome all / Safari all */\n    -moz-user-select: none; /* Firefox all */\n  }\n`;\n\nfunction YAxis({ show, label, margin: marginProps }) {\n  const refAxis = useRef();\n  const state = useChartData();\n  const {\n    yDomain,\n    width,\n    height,\n    activeTab,\n    tabActiveSpectrum,\n    margin,\n  } = state;\n\n  useEffect(() => {\n    const axis = d3.axisRight().ticks(8).tickFormat(d3.format('0'));\n\n    if (show && yDomain) {\n      const scaleY = get2DYScale({ height, yDomain, margin });\n\n      d3.select(refAxis.current).call(axis.scale(scaleY));\n    }\n  }, [show, yDomain, activeTab, tabActiveSpectrum, height, margin]);\n\n  const Axis = useMemo(\n    () =>\n      show &&\n      show === true && (\n        <Fragment>\n          <g\n            className=\"y\"\n            css={axisStyles}\n            transform={`translate(${width - marginProps.right})`}\n            ref={refAxis}\n          >\n            <text\n              fill=\"#000\"\n              x={-marginProps.top}\n              y={-(marginProps.right - 5)}\n              dy=\"0.71em\"\n              transform=\"rotate(-90)\"\n              textAnchor=\"end\"\n            >\n              {label}\n            </text>\n          </g>\n        </Fragment>\n      ),\n\n    [label, marginProps.right, marginProps.top, show, width],\n  );\n\n  if (!width || !height) {\n    return null;\n  }\n\n  return Axis;\n}\n\nYAxis.defaultProps = {\n  show: true,\n  label: '',\n  margin: { right: 50, top: 0, bottom: 0, left: 0 },\n};\n\nexport default memo(YAxis);\n","import { useMemo, memo, forwardRef } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\nimport { usePreferences } from '../context/PreferencesContext';\n\nfunction ZonesWrapper(WrappedComponent) {\n  const Wrapper = (props) => {\n    const {\n      data,\n      activeSpectrum,\n      xDomain,\n      yDomain,\n      activeTab,\n      tabActiveSpectrum,\n      displayerKey,\n    } = useChartData();\n    const preferences = usePreferences();\n\n    const { zones = {}, info = {}, display = {} } = useMemo(() => {\n      if (data && activeSpectrum && activeSpectrum.id) {\n        const datum = data.find((datum) => datum.id === activeSpectrum.id) || {\n          zones: {},\n          info: {},\n          display: {},\n        };\n        return datum;\n      }\n      return {};\n    }, [activeSpectrum, data]);\n\n    const nucleus = useMemo(() => {\n      if (tabActiveSpectrum && Object.keys(tabActiveSpectrum).length > 0) {\n        return Object.keys(tabActiveSpectrum);\n      }\n      return null;\n    }, [tabActiveSpectrum]);\n\n    const { forwardedRef, ...rest } = props;\n    return (\n      <WrappedComponent\n        {...rest}\n        zones={zones}\n        display={display}\n        info={info}\n        xDomain={xDomain}\n        yDomain={yDomain}\n        preferences={preferences}\n        activeTab={activeTab}\n        nucleus={nucleus}\n        displayerKey={displayerKey}\n        ref={forwardedRef}\n      />\n    );\n  };\n\n  return memo(\n    forwardRef((props, ref) => {\n      return <Wrapper {...props} forwardedRef={ref} />;\n    }),\n  );\n}\nexport default ZonesWrapper;\n","import { DatumKind } from '../constants/SignalsKinds';\n\nconst getDiaIDs = (zone, axis) => {\n  return [].concat(\n    zone[axis].diaID || [],\n    zone.signal\n      ? zone.signal.map((_signal) => _signal[axis].diaID || []).flat()\n      : [],\n  );\n};\n\nconst getPubIntegral = (zone, axis) => {\n  return getDiaIDs(zone, axis).length;\n};\n\nconst setPubIntegral = (zone, axis) => {\n  zone[axis].pubIntegral = getPubIntegral(zone, axis);\n  if (zone[axis].pubIntegral === 0) {\n    delete zone[axis].pubIntegral;\n  }\n};\n\nconst resetDiaIDs = (zone, axis) => {\n  delete zone[axis].diaID;\n  delete zone.pubIntegral;\n  zone.signal.forEach((_signal) => {\n    delete _signal[axis].diaID;\n  });\n  return zone;\n};\n\nconst checkZoneKind = (zone) => {\n  return zone.kind === DatumKind.signal;\n};\n\nconst checkSignalKinds = (zone, kinds) => {\n  return !zone.signal.some(\n    (_signal) => _signal.kind === undefined || !kinds.includes(_signal.kind),\n  );\n};\n\nconst unlink = (zone, isOnZoneLevel, signalIndex, axis) => {\n  if (isOnZoneLevel !== undefined && axis !== undefined) {\n    if (isOnZoneLevel === true) {\n      delete zone[axis].diaID;\n    } else if (signalIndex !== undefined) {\n      delete zone.signal[signalIndex][axis].diaID;\n    }\n    setPubIntegral(zone, axis);\n  } else if (axis !== undefined) {\n    resetDiaIDs(zone, axis);\n    setPubIntegral(zone, axis);\n  } else {\n    ['x', 'y'].forEach((key) => {\n      resetDiaIDs(zone, key);\n      setPubIntegral(zone, key);\n    });\n  }\n  return zone;\n};\n\nconst unlinkInAssignmentData = (assignmentData, zones, axis) => {\n  const ids = zones.reduce((acc, zone) => {\n    acc.push(zone.id);\n    if (zone.signal) {\n      acc.concat(zone.signal.map((signal) => signal.id, []));\n    }\n    return acc;\n  }, []);\n\n  if (axis) {\n    assignmentData.dispatch({\n      type: 'REMOVE_ALL',\n      payload: { id: ids, axis },\n    });\n  } else {\n    assignmentData.dispatch({\n      type: 'REMOVE_ALL',\n      payload: { id: ids, axis: 'x' },\n    });\n    assignmentData.dispatch({\n      type: 'REMOVE_ALL',\n      payload: { id: ids, axis: 'y' },\n    });\n  }\n};\n\nexport {\n  checkSignalKinds,\n  checkZoneKind,\n  getDiaIDs,\n  getPubIntegral,\n  resetDiaIDs,\n  unlink,\n  unlinkInAssignmentData,\n};\n","const ConcatenationString = '___';\n\nconst buildID = (prefix, suffix) => {\n  return `${prefix}${ConcatenationString}${suffix}`;\n};\n\nexport { buildID, ConcatenationString };\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useMemo } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\n\nimport { get2DXScale, get2DYScale } from './utilities/scale';\n\nconst lineStyle = css`\n  stroke: green;\n  stroke-width: 2;\n  opacity: 0.5;\n`;\n\nfunction SignalDeltaLine({ delta, axis, show }) {\n  const { margin, width, height, xDomain, yDomain } = useChartData();\n  const scaleX = get2DXScale({ margin, width, xDomain });\n  const scaleY = get2DYScale({ margin, height, yDomain });\n\n  const line = useMemo(() => {\n    return show === true ? (\n      axis === 'X' ? (\n        <line\n          css={lineStyle}\n          key={`signalLine_${delta}_X`}\n          x1={scaleX(delta)}\n          x2={scaleX(delta)}\n          y1={scaleY(yDomain[0])}\n          y2={scaleY(yDomain[1])}\n        />\n      ) : axis === 'Y' ? (\n        <line\n          css={lineStyle}\n          key={`signalLine_${delta}_Y`}\n          x1={scaleX(xDomain[0])}\n          x2={scaleX(xDomain[1])}\n          y1={scaleY(delta)}\n          y2={scaleY(delta)}\n        />\n      ) : null\n    ) : null;\n  }, [axis, delta, scaleX, scaleY, show, xDomain, yDomain]);\n\n  return <g>{line}</g>;\n}\n\nexport default SignalDeltaLine;\n","/** @jsxImportSource @emotion/react */\n\nimport { useMemo } from 'react';\n\nimport { buildID } from '../../../data/utilities/Concatenation';\nimport { useHighlight } from '../../highlight';\nimport SignalDeltaLine from '../SignalDeltaLine';\n\nfunction SignalCrosshair({ signal }) {\n  const highlightIDsX = useMemo(() => {\n    return [buildID(signal.id, 'Crosshair'), buildID(signal.id, 'Crosshair_X')];\n  }, [signal.id]);\n  const highlightIDsY = useMemo(() => {\n    return [buildID(signal.id, 'Crosshair'), buildID(signal.id, 'Crosshair_Y')];\n  }, [signal.id]);\n  const highlightX = useHighlight(highlightIDsX);\n  const highlightY = useHighlight(highlightIDsY);\n\n  return (\n    <g>\n      <SignalDeltaLine\n        delta={signal.x.delta}\n        axis=\"X\"\n        show={highlightX.isActive}\n      />\n      <SignalDeltaLine\n        delta={signal.y.delta}\n        axis=\"Y\"\n        show={highlightY.isActive}\n      />\n    </g>\n  );\n}\n\nexport default SignalCrosshair;\n","/** @jsxImportSource @emotion/react */\n\nimport { memo, useState, useEffect, useCallback } from 'react';\n\nimport { buildID } from '../../../data/utilities/Concatenation';\nimport { useAssignment } from '../../assignment';\nimport { useChartData } from '../../context/ChartContext';\nimport { useHighlightData, useHighlight } from '../../highlight';\nimport { get2DXScale, get2DYScale } from '../utilities/scale';\n\nimport SignalCrosshair from './SignalCrosshair';\n\nconst Signal = memo(({ signal, isVisible }) => {\n  const { margin, width, height, xDomain, yDomain } = useChartData();\n  const scaleX = get2DXScale({ margin, width, xDomain });\n  const scaleY = get2DYScale({ margin, height, yDomain });\n\n  const buildIDs = useCallback((id) => {\n    return [id].concat(buildID(id, 'X'), buildID(id, 'Y'));\n  }, []);\n\n  const assignment = useAssignment(signal.id);\n  const highlight = useHighlight(buildIDs(assignment.id));\n  const highlightData = useHighlightData();\n\n  const [isHighlighted, setIsHighlighted] = useState(false);\n\n  useEffect(() => {\n    if (\n      highlightData.highlight.highlighted.some((_highlighted) =>\n        buildIDs(signal.id).includes(_highlighted),\n      ) ||\n      assignment.isActive\n    ) {\n      setIsHighlighted(true);\n    } else {\n      setIsHighlighted(false);\n    }\n  }, [\n    assignment.isActive,\n    buildIDs,\n    highlightData.highlight.highlighted,\n    signal.id,\n  ]);\n\n  if (!signal) return null;\n\n  return (\n    <g\n      className=\"zone-signal\"\n      onMouseEnter={() => {\n        assignment.onMouseEnter();\n        highlight.show();\n      }}\n      onMouseLeave={() => {\n        assignment.onMouseLeave();\n        highlight.hide();\n      }}\n    >\n      {isVisible.signals && (\n        <g>\n          <circle\n            key={signal.id}\n            cx={scaleX(signal.x.delta)}\n            cy={scaleY(signal.y.delta)}\n            r={isHighlighted ? 6 : 4}\n            fill={isHighlighted ? 'green' : 'darkgreen'}\n          />\n          <SignalCrosshair signal={signal} />\n        </g>\n      )}\n      <g className=\"zone-signal-peak\">\n        {isVisible.peaks &&\n          signal.peak.map((peak, i) => (\n            <circle\n              key={`${signal.id + i}`}\n              cx={scaleX(peak.x)}\n              cy={scaleY(peak.y)}\n              r={2}\n              fill=\"black\"\n            />\n          ))}\n      </g>\n    </g>\n  );\n});\n\nexport default Signal;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useState, useEffect } from 'react';\n\nimport { checkZoneKind } from '../../../data/utilities/ZoneUtilities';\nimport { useAssignment } from '../../assignment';\nimport { useChartData } from '../../context/ChartContext';\nimport { TYPES, useHighlight } from '../../highlight';\nimport { get2DXScale, get2DYScale } from '../utilities/scale';\n\nimport Signal from './Signal';\n\nconst stylesOnHover = css`\n  pointer-events: bounding-box;\n  @-moz-document url-prefix() {\n    pointer-events: fill;\n  }\n  user-select: 'none';\n  -webkit-user-select: none; /* Chrome all / Safari all */\n  -moz-user-select: none; /* Firefox all */\n\n  // // disabled because Resizable component appears now when hovering over it\n  // :hover .range-area {\n  //   height: 100%;\n  //   fill: #ff6f0057;\n  //   cursor: pointer;\n  // }\n\n  .delete-button {\n    visibility: hidden;\n  }\n`;\n\nconst stylesHighlighted = css`\n  pointer-events: bounding-box;\n\n  @-moz-document url-prefix() {\n    pointer-events: fill;\n  }\n  .Integral-area {\n    // height: 100%;\n    fill: #ff6f0057;\n  }\n  .delete-button {\n    visibility: visible;\n    cursor: pointer;\n  }\n`;\n\nconst Zone = ({ zoneData, isVisible }) => {\n  const { x, y, id, signal } = zoneData;\n  const assignmentZone = useAssignment(id);\n  const highlightZone = useHighlight([assignmentZone.id], TYPES.ZONE);\n  const { margin, width, height, xDomain, yDomain } = useChartData();\n  const scaleX = get2DXScale({ margin, width, xDomain });\n  const scaleY = get2DYScale({ margin, height, yDomain });\n  const { from: x1, to: x2 } = x;\n  const { from: y1, to: y2 } = y;\n\n  const [reduceOpacity, setReduceOpacity] = useState(false);\n\n  useEffect(() => {\n    setReduceOpacity(!checkZoneKind(zoneData));\n  }, [zoneData]);\n\n  return (\n    <g\n      css={\n        highlightZone.isActive || assignmentZone.isActive\n          ? stylesHighlighted\n          : stylesOnHover\n      }\n      key={id}\n      onMouseEnter={() => {\n        assignmentZone.onMouseEnter();\n        highlightZone.show();\n      }}\n      onMouseLeave={() => {\n        assignmentZone.onMouseLeave();\n        highlightZone.hide();\n      }}\n    >\n      {isVisible.zones && (\n        <g transform={`translate(${scaleX(x1)},${scaleY(y1)})`}>\n          <rect\n            x=\"0\"\n            width={scaleX(x2) - scaleX(x1)}\n            height={scaleY(y2) - scaleY(y1)}\n            className=\"Integral-area\"\n            fill=\"#0000000f\"\n            stroke={reduceOpacity ? '#343a40' : 'darkgreen'}\n            strokeWidth={reduceOpacity ? '0' : '1'}\n          />\n        </g>\n      )}\n      {signal.map((_signal, i) => (\n        <Signal key={`${id + i}`} signal={_signal} isVisible={isVisible} />\n      ))}\n    </g>\n  );\n};\n\nZone.defaultProps = {\n  onDelete: () => null,\n};\n\nexport default Zone;\n","import { useEffect, useState } from 'react';\n\nimport ZonesWrapper from '../../hoc/ZonesWrapper';\nimport Events from '../../utility/Events';\n\nimport Zone from './Zone';\n\nconst Zones = ({ zones, display, displayerKey }) => {\n  const [isVisible, setVisibility] = useState({\n    zones: true,\n    signals: true,\n    peaks: true,\n  });\n  useEffect(() => {\n    Events.on('onZonesVisibilityChange', ({ key }) => {\n      setVisibility((prevVisiblity) => ({\n        ...prevVisiblity,\n        [key]: !prevVisiblity[key],\n      }));\n    });\n  }, []);\n  return (\n    <g clipPath={`url(#${displayerKey}clip-chart-2d)`} className=\"2D-Zones\">\n      {display.isVisible &&\n        zones.values.map((zone) => (\n          <g className=\"zone\" key={zone.id}>\n            <Zone zoneData={zone} isVisible={isVisible} />\n          </g>\n        ))}\n    </g>\n  );\n};\n\nexport default ZonesWrapper(Zones);\n","import PropsTypes from 'prop-types';\nimport { useMemo } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\n\nimport Contours from './Contours';\nimport IndicationLines from './IndicationLines';\nimport Left1DChart from './Left1DChart';\nimport Top1DChart from './Top1DChart';\nimport XAxis from './XAxis';\nimport YAxis from './YAxis';\nimport Zones from './zones/Zones';\n\nfunction Chart2D({ data }) {\n  const { width, height, margin, displayerKey } = useChartData();\n\n  const chart2d = useMemo(() => {\n    return (\n      <svg\n        viewBox={`0 0 ${width} ${height}`}\n        width={width}\n        height={height}\n        id=\"nmrSVG\"\n      >\n        <defs>\n          <clipPath id={`${displayerKey}clip-chart-2d`}>\n            <rect\n              width={width - margin.left - margin.right}\n              height={height - margin.top - margin.bottom}\n              x={margin.left}\n              y={margin.top}\n            />\n          </clipPath>\n        </defs>\n        <rect\n          width={width - margin.left - margin.right}\n          height={height - margin.top - margin.bottom}\n          x={margin.left}\n          y={margin.top}\n          stroke=\"black\"\n          strokeWidth=\"1\"\n          fill=\"transparent\"\n        />\n        {data && data[0] && <Top1DChart data={data[0]} />}\n        {data && data[1] && <Left1DChart data={data[1]} />}\n        <Contours />\n        <Zones />\n        <IndicationLines axis=\"X\" show />\n        <IndicationLines axis=\"Y\" show />\n\n        <g className=\"container\" style={{ pointerEvents: 'none' }}>\n          <XAxis />\n          <YAxis />\n        </g>\n      </svg>\n    );\n  }, [\n    width,\n    height,\n    displayerKey,\n    margin.left,\n    margin.right,\n    margin.top,\n    margin.bottom,\n    data,\n  ]);\n\n  return chart2d;\n}\nChart2D.defaultProps = {\n  onDimensionChange: () => null,\n};\n\nChart2D.propsTypes = {\n  onDimensionChange: PropsTypes.func.isRequired,\n};\n\nexport default Chart2D;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { xFindClosestIndex } from 'ml-spectra-processing';\nimport { useContext, useMemo, Fragment } from 'react';\nimport { MF } from 'react-mf';\n\nimport { BrushContext } from '../EventsTrackers/BrushTracker';\nimport { MouseContext } from '../EventsTrackers/MouseTracker';\nimport { useChartData } from '../context/ChartContext';\nimport { options } from '../toolbar/ToolTypes';\nimport { useFormatNumberByNucleus } from '../utility/FormatNumber';\n\nimport { getLayoutID, LAYOUT } from './utilities/DimensionLayout';\nimport { get2DXScale, get1DYScale, get2DYScale } from './utilities/scale';\n\nconst styles = css`\n  display: flex;\n  flex-firection: row;\n  align-items: center;\n  pointer-events: bounding-box;\n  user-select: 'none';\n  -webkit-user-select: none; /* Chrome all / Safari all */\n  -moz-user-select: none; /* Firefox all */\n  background-color: #f7f7f7;\n  height: 30px;\n  padding: 6px;\n  color: #8d0018;\n  position: absolute;\n  width: 100%;\n  bottom: 0;\n  div {\n    margin: 0px 10px;\n    display: inline-block;\n\n    .label {\n      font-size: 12px;\n      color: #4d4d4d;\n      font-weight: bold;\n    }\n    .value {\n      font-weight: bold;\n      font-size: 14px;\n    }\n    .unit {\n      font-weight: bold;\n      font-size: 10px;\n    }\n  }\n`;\nfunction FooterBanner({ layout, data1D }) {\n  const position = useContext(MouseContext);\n  const { startX, endX, startY, endY, step } = useContext(BrushContext);\n  const {\n    margin,\n    width,\n    height,\n    activeSpectrum,\n    xDomain,\n    yDomain,\n    yDomains,\n    activeTab,\n    data,\n    selectedTool,\n  } = useChartData();\n\n  const trackID =\n    position &&\n    getLayoutID(layout, {\n      startX: position.x,\n      startY: position.y,\n    });\n\n  const nucleuses = activeTab.split(',');\n  const [formatX, formatY] = useFormatNumberByNucleus(nucleuses);\n\n  const scaleX = useMemo(() => {\n    if (!data1D || data1D.length === 0) {\n      return get2DXScale({ width, margin, xDomain });\n    }\n    if (selectedTool !== options.slicingTool.id) {\n      switch (trackID) {\n        case LAYOUT.TOP_1D:\n        case LAYOUT.CENTER_2D: {\n          return get2DXScale({ width, margin, xDomain });\n        }\n        case LAYOUT.LEFT_1D: {\n          return get2DYScale({ height, margin, yDomain });\n        }\n        default:\n          return null;\n      }\n    }\n    return null;\n  }, [data1D, height, margin, selectedTool, trackID, width, xDomain, yDomain]);\n\n  const scaleY = useMemo(() => {\n    if (!data1D || data1D.length === 0) {\n      return get2DYScale({ height, margin, yDomain });\n    }\n    if (selectedTool !== options.slicingTool.id) {\n      switch (trackID) {\n        case LAYOUT.CENTER_2D: {\n          return get2DYScale({ height, margin, yDomain });\n        }\n        case LAYOUT.TOP_1D: {\n          return data1D[0]\n            ? get1DYScale(yDomains[data1D[0].id], margin.top)\n            : null;\n        }\n        case LAYOUT.LEFT_1D: {\n          return data1D[1]\n            ? get1DYScale(yDomains[data1D[1].id], margin.left)\n            : null;\n        }\n        default:\n          return null;\n      }\n    }\n    return null;\n  }, [data1D, height, margin, selectedTool, trackID, yDomain, yDomains]);\n\n  if (\n    !activeSpectrum ||\n    !position ||\n    position.y < 10 ||\n    position.x < 10 ||\n    position.x > width - margin.right ||\n    position.y > height - margin.bottom\n  ) {\n    return <div css={styles} />;\n  }\n  const getRealYValue = (cordinate) => {\n    let index = null;\n    if (trackID === LAYOUT.TOP_1D) {\n      index = 0;\n    } else if (trackID === LAYOUT.LEFT_1D) {\n      index = 1;\n    }\n    if (index != null && scaleX != null) {\n      const xIndex = xFindClosestIndex(\n        data1D[index].data.x,\n        scaleX.invert(cordinate),\n      );\n      return data1D[index].data.y[xIndex];\n    }\n    return 1;\n  };\n\n  const getXValue = (x = null) => {\n    if (scaleX != null) {\n      switch (trackID) {\n        case LAYOUT.CENTER_2D:\n        case LAYOUT.TOP_1D: {\n          return scaleX.invert(x ? x : position.x);\n        }\n        case LAYOUT.LEFT_1D: {\n          return scaleX.invert(x ? x : position.y);\n        }\n        default:\n          return 0;\n      }\n    }\n    return 0;\n  };\n\n  const getYValue = () => {\n    if (scaleY != null) {\n      switch (trackID) {\n        case LAYOUT.CENTER_2D:\n        case LAYOUT.TOP_1D: {\n          return scaleY.invert(position.y);\n        }\n        case LAYOUT.LEFT_1D: {\n          return scaleY.invert(position.x);\n        }\n        default:\n          return 0;\n      }\n    }\n    return 0;\n  };\n\n  const getRation = () => {\n    switch (trackID) {\n      case LAYOUT.TOP_1D: {\n        return (\n          (getRealYValue(startX) / (getRealYValue(endX) || Number.MIN_VALUE)) *\n          100\n        ).toFixed(2);\n      }\n      case LAYOUT.LEFT_1D: {\n        return (\n          (getRealYValue(startY) / (getRealYValue(endY) || Number.MIN_VALUE)) *\n          100\n        ).toFixed(2);\n      }\n      default:\n        return 0;\n    }\n  };\n\n  const getDeltaX = () => {\n    switch (trackID) {\n      case LAYOUT.TOP_1D: {\n        return (getXValue(startX) - getXValue(endX)).toPrecision(6);\n      }\n      case LAYOUT.LEFT_1D: {\n        return (getXValue(startY) - getXValue(endY)).toPrecision(6);\n      }\n      default:\n        return 0;\n    }\n  };\n\n  const getLabel = (label2d, labelld, nucleus) => {\n    return trackID === LAYOUT.CENTER_2D ? (\n      <Fragment>\n        {label2d} ( <MF mf={nucleus} /> )\n      </Fragment>\n    ) : (\n      labelld\n    );\n  };\n\n  const getZValue = () => {\n    if (trackID === LAYOUT.CENTER_2D) {\n      const { maxX, maxY, minX, minY, z } = data[activeSpectrum.index].data;\n\n      const xStep = (maxX - minX) / (z[0].length - 1);\n      const yStep = (maxY - minY) / (z.length - 1);\n      const xIndex = Math.floor((getXValue() - minX) / xStep);\n      const yIndex = Math.floor((getYValue() - minY) / yStep);\n\n      if (xIndex < 0 || xIndex >= z[0].length) return 0;\n      if (yIndex < 0 || yIndex >= z.length) return 0;\n\n      return z[yIndex][xIndex];\n    }\n    return 0;\n  };\n\n  return (\n    <div css={styles}>\n      <div>\n        <span className=\"label\">{getLabel('F2', 'X', nucleuses[0])} :</span>\n        <span className=\"value\">{formatX(getXValue())}</span>\n        <span className=\"unit\">ppm</span>\n      </div>\n\n      <div>\n        <span className=\"label\">{getLabel('F1', 'Y', nucleuses[1])} :</span>\n        <span className=\"value\">{formatY(getYValue())}</span>\n        <span className=\"unit\">ppm</span>\n      </div>\n      <div>\n        <span className=\"label\">Intensity :</span>\n        <span className=\"value\">{getZValue()}</span>\n      </div>\n      {step === 'brushing' && (\n        <div>\n          <span className=\"label\"> ppm :</span>\n          <span className=\"value\">{getDeltaX()}</span>\n        </div>\n      )}\n\n      {step === 'brushing' && (\n        <div>\n          <span className=\"label\"> ratio :</span>\n          <span className=\"value\">{getRation()}%</span>\n        </div>\n      )}\n    </div>\n  );\n}\n\nexport default FooterBanner;\n","import { useContext, useMemo } from 'react';\n\nimport { BrushContext } from '../../EventsTrackers/BrushTracker';\nimport { MouseContext } from '../../EventsTrackers/MouseTracker';\nimport { useChartData } from '../../context/ChartContext';\nimport { useFormatNumberByNucleus } from '../../utility/FormatNumber';\nimport { getLayoutID, LAYOUT } from '../utilities/DimensionLayout';\nimport { get2DXScale, get2DYScale, get1DYScale } from '../utilities/scale';\n\nconst style = {\n  cursor: 'crosshair',\n  transformOrigin: 'bottom right',\n  position: 'absolute',\n  top: '-18px',\n  left: '-88px',\n  fontWeight: 'bold',\n  pointerEvents: 'none',\n  overflow: 'visible',\n  userSelect: 'none',\n  width: '85px',\n  textAlign: 'right',\n};\n\nfunction XYLabelPointer({ layout, data1D }) {\n  const position = useContext(MouseContext);\n  const { step } = useContext(BrushContext);\n  const {\n    margin,\n    width,\n    height,\n    activeSpectrum,\n    xDomain,\n    yDomain,\n    yDomains,\n    activeTab,\n  } = useChartData();\n\n  const trackID =\n    position &&\n    getLayoutID(layout, {\n      startX: position.x,\n      startY: position.y,\n    });\n\n  const nucleuses = activeTab.split(',');\n  const [formatX, formatY] = useFormatNumberByNucleus(nucleuses);\n\n  const scaleX = useMemo(() => {\n    if (!data1D || data1D.length === 0) {\n      return get2DXScale({ width, margin, xDomain });\n    }\n    switch (trackID) {\n      case LAYOUT.TOP_1D:\n      case LAYOUT.CENTER_2D: {\n        return get2DXScale({ width, margin, xDomain });\n      }\n      case LAYOUT.LEFT_1D: {\n        return get2DYScale({ height, margin, yDomain });\n      }\n      default:\n        return null;\n    }\n  }, [data1D, height, margin, trackID, width, xDomain, yDomain]);\n\n  const scaleY = useMemo(() => {\n    if (!data1D || data1D.length === 0) {\n      return get2DYScale({ height, margin, yDomain });\n    }\n\n    switch (trackID) {\n      case LAYOUT.CENTER_2D: {\n        return get2DYScale({ height, margin, yDomain });\n      }\n      case LAYOUT.TOP_1D: {\n        return data1D[0]\n          ? get1DYScale(yDomains[data1D[0].id], margin.top)\n          : null;\n      }\n      case LAYOUT.LEFT_1D: {\n        return data1D[1]\n          ? get1DYScale(yDomains[data1D[1].id], margin.left)\n          : null;\n      }\n      default:\n        return null;\n    }\n  }, [data1D, height, margin, trackID, yDomain, yDomains]);\n\n  if (\n    !activeSpectrum ||\n    step === 'brushing' ||\n    !position ||\n    position.y < margin.top ||\n    position.x < margin.left ||\n    position.x > width - margin.right ||\n    position.y > height - margin.bottom\n  ) {\n    return null;\n  }\n\n  const getXValue = (x = null) => {\n    switch (trackID) {\n      case LAYOUT.CENTER_2D:\n      case LAYOUT.TOP_1D: {\n        return scaleX.invert(x ? x : position.x);\n      }\n      case LAYOUT.LEFT_1D: {\n        return scaleX.invert(x ? x : position.y);\n      }\n      default:\n        return 0;\n    }\n  };\n\n  const getYValue = () => {\n    switch (trackID) {\n      case LAYOUT.CENTER_2D:\n      case LAYOUT.TOP_1D: {\n        return scaleY.invert(position.y);\n      }\n      case LAYOUT.LEFT_1D: {\n        return scaleY.invert(position.x);\n      }\n      default:\n        return 0;\n    }\n  };\n\n  return (\n    <div\n      key=\"xLabelPointer\"\n      style={{\n        ...style,\n        transform: `translate(${position.x}px, ${position.y}px)`,\n      }}\n    >\n      <span>{formatY(getYValue())}</span>\n      <span style={{ color: 'gray' }}>{','}</span>\n      <span style={{ color: 'red' }}>{formatX(getXValue())}</span>\n    </div>\n  );\n}\n\nexport default XYLabelPointer;\n","const BASE62 = '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ';\nconst base62 = Base(BASE62);\n\nconst LENGTH = 8;\nconst bytes = new Uint8Array(LENGTH);\n\nexport default function generateID() {\n  for (let i = 0; i < LENGTH; i++) {\n    bytes[i] = Math.floor(Math.random() * 256);\n  }\n  return base62.encode(bytes).substring(0, 8);\n}\n\n// base-x encoding / decoding\n// https://github.com/cryptocoinjs/base-x/blob/master/src/index.js\n// Copyright (c) 2018 base-x contributors\n// Copyright (c) 2014-2018 The Bitcoin Core developers (base58.cpp)\n// Distributed under the MIT software license, see the accompanying\n// file LICENSE or http://www.opensource.org/licenses/mit-license.php.\n// @ts-ignore\nfunction Base(ALPHABET) {\n  if (ALPHABET.length >= 255) {\n    throw new TypeError('Alphabet too long');\n  }\n  let BASE_MAP = new Uint8Array(256);\n  for (let j = 0; j < BASE_MAP.length; j++) {\n    BASE_MAP[j] = 255;\n  }\n  for (let i = 0; i < ALPHABET.length; i++) {\n    let x = ALPHABET.charAt(i);\n    let xc = x.charCodeAt(0);\n    if (BASE_MAP[xc] !== 255) {\n      throw new TypeError(`${x} is ambiguous`);\n    }\n    BASE_MAP[xc] = i;\n  }\n  let BASE = ALPHABET.length;\n  let LEADER = ALPHABET.charAt(0);\n  let iFACTOR = Math.log(256) / Math.log(BASE); // log(256) / log(BASE), rounded up\n\n  function encode(source) {\n    if (source.length === 0) {\n      return '';\n    }\n    // Skip & count leading zeroes.\n    let zeroes = 0;\n    let length = 0;\n    let pbegin = 0;\n    let pend = source.length;\n    while (pbegin !== pend && source[pbegin] === 0) {\n      pbegin++;\n      zeroes++;\n    }\n    // Allocate enough space in big-endian base58 representation.\n    let size = ((pend - pbegin) * iFACTOR + 1) >>> 0;\n    let b58 = new Uint8Array(size);\n    // Process the bytes.\n    while (pbegin !== pend) {\n      let carry = source[pbegin];\n      // Apply \"b58 = b58 * 256 + ch\".\n      let i = 0;\n      for (\n        let it1 = size - 1;\n        (carry !== 0 || i < length) && it1 !== -1;\n        it1--, i++\n      ) {\n        carry += (256 * b58[it1]) >>> 0;\n        b58[it1] = carry % BASE >>> 0;\n        carry = (carry / BASE) >>> 0;\n      }\n      if (carry !== 0) {\n        throw new Error('Non-zero carry');\n      }\n      length = i;\n      pbegin++;\n    }\n    // Skip leading zeroes in base58 result.\n    let it2 = size - length;\n    while (it2 !== size && b58[it2] === 0) {\n      it2++;\n    }\n    // Translate the result into a string.\n    let str = LEADER.repeat(zeroes);\n    for (; it2 < size; ++it2) {\n      str += ALPHABET.charAt(b58[it2]);\n    }\n    return str;\n  }\n  return {\n    encode,\n  };\n}\n","import { Filters } from './Filters';\nimport generateID from './utilities/generateID';\n\nexport interface Filter {\n  id: string;\n  name: string;\n  label: string;\n  isDeleteAllow: boolean;\n  flag: boolean;\n  value: any;\n}\n\n/***\n * @param {object} Filters [{name:'',options:{}},{...}]\n */\nfunction applyFilter(datum, filters: any[] = []) {\n  let isReduced = false;\n  for (let filter of filters) {\n    const filterOption = {\n      name: filter.name,\n      label: Filters[filter.name].name,\n      value: filter.options,\n    };\n    const previousFilter = lookupForFilter(datum, filter.name);\n    if (previousFilter) {\n      const reduceResult = Filters[filter.name].reduce(\n        previousFilter.value,\n        filterOption.value,\n      );\n      if (reduceResult.once) {\n        if (!isReduced) {\n          isReduced = true;\n        }\n        if (reduceResult.reduce != null && reduceResult.reduce !== undefined) {\n          replaceFilter(datum, previousFilter.id, reduceResult.reduce);\n        }\n      } else {\n        addFilter(\n          datum,\n          filterOption,\n          Object.prototype.hasOwnProperty.call(filter, 'isDeleteAllow')\n            ? filter.isDeleteAllow\n            : true,\n        );\n      }\n    } else {\n      addFilter(\n        datum,\n        filterOption,\n        Object.prototype.hasOwnProperty.call(filter, 'isDeleteAllow')\n          ? filter.isDeleteAllow\n          : true,\n      );\n    }\n  }\n  if (isReduced) {\n    if (filters.length === 1 && isLastFilter(datum, filters[0].name)) {\n      Filters[filters[0].name].apply(datum, filters[0].options);\n    } else {\n      reapplyFilters(datum);\n    }\n  } else {\n    for (let filter of filters) {\n      Filters[filter.name].apply(datum, filter.options);\n    }\n  }\n}\n\nfunction isLastFilter(datum, id) {\n  const index = datum.filters.findIndex((f) => f.name === id);\n  if (datum.filters.length === index + 1) {\n    return true;\n  }\n  return false;\n}\n\nfunction lookupForFilter(datum, filterName) {\n  return datum.filters.find((f) => f.name === filterName);\n}\n\nfunction reapplyFilters(datum, filters: any = null) {\n  const _filters = filters ? filters : datum.filters;\n  enableFilter(datum, null, null, _filters);\n}\n\n// id filter id\nfunction enableFilter(datum, id, checked, filters = null) {\n  datum.filters = datum.filters.slice(0);\n  if (id) {\n    datum.filters = datum.filters.map((filter) => {\n      return { ...filter, flag: filter.id === id ? checked : filter.flag };\n    }, []);\n  }\n  datum.data = { ...datum.data, ...datum.originalData };\n  datum.info = { ...datum.info, ...datum.originalInfo };\n  const _filters = filters ? filters : datum.filters;\n  for (let filterIndex in _filters) {\n    const filter = datum.filters[filterIndex];\n    datum.filters[filterIndex] = {\n      ...datum.filters[filterIndex],\n      error: null,\n    };\n\n    if (filter.flag) {\n      try {\n        Filters[filter.name].apply(datum, filter.value);\n      } catch (error) {\n        datum.filters[filterIndex] = {\n          ...datum.filters[filterIndex],\n          error: error.message,\n        };\n      }\n    }\n  }\n}\nfunction deleteFilter(datum, id) {\n  datum.filters = datum.filters.slice(0);\n  datum.filters = datum.filters.filter((filter) => filter.id !== id);\n  datum.data = { ...datum.data, ...datum.originalData };\n  datum.info = { ...datum.info, ...datum.originalInfo };\n\n  for (let filterIndex in datum.filters) {\n    const filter = datum.filters[filterIndex];\n    datum.filters[filterIndex] = {\n      ...datum.filters[filterIndex],\n      error: null,\n    };\n\n    if (filter.flag) {\n      try {\n        Filters[filter.name].apply(datum, filter.value);\n      } catch (error) {\n        datum.filters[filterIndex] = {\n          ...datum.filters[filterIndex],\n          error: error.message,\n        };\n      }\n    }\n  }\n}\n\nfunction addFilter(datum, filter, isDeleteAllow = true) {\n  const id = generateID();\n  datum.filters = datum.filters.slice(0);\n  delete filter.isSnapshot;\n  datum.filters.push({\n    ...filter,\n    id: id,\n    flag: true,\n    isDeleteAllow,\n  });\n}\n\nfunction replaceFilter(datum, filterID, value) {\n  datum.filters = datum.filters.slice(0);\n  const index = datum.filters.findIndex((f) => f.id === filterID);\n  delete datum.filters[index].isSnapshot;\n  datum.filters[index] = {\n    ...datum.filters[index],\n    value,\n  };\n}\n\nexport { applyFilter, reapplyFilters, enableFilter, addFilter, deleteFilter };\n","export const COLORS = [\n  '#FFB300',\n  '#803E75',\n  '#FF6800',\n  '#A6BDD7',\n  '#C10020',\n  '#CEA262',\n  '#817066',\n  '#007D34',\n  '#F6768E',\n  '#00538A',\n  '#FF7A5C',\n  '#53377A',\n  '#FF8E00',\n  '#B32851',\n  '#F4C800',\n  '#7F180D',\n  '#93AA00',\n  '#593315',\n  '#F13A13',\n  '#232C16',\n  '',\n];\n\nconst color2D = {\n  cosy: { positiveColor: 'darkblue', negativeColor: 'blue' },\n  roesy: { positiveColor: 'pink', negativeColor: 'yellow' },\n  noesy: { positiveColor: 'pink', negativeColor: 'yellow' },\n  tocsy: { positiveColor: 'green', negativeColor: 'yellow' },\n  hsqc: { positiveColor: 'black', negativeColor: 'yellow' },\n  hmbc: { positiveColor: 'darkviolet', negativeColor: 'yellow' },\n};\n\nconst hasPredefine2DColor = (experiment) => {\n  return color2D[experiment] ? true : false;\n};\n\nconst get2DColor = (experiment, colors = []) => {\n  if (!color2D[experiment]) {\n    const positiveColor = getColor(false, colors);\n    const negativeColor = adjustAlpha(positiveColor, 50);\n    return { positiveColor, negativeColor };\n  }\n  return color2D[experiment];\n};\n\nconst percentToHex = (p) => {\n  const percent = Math.max(0, Math.min(100, p));\n  const intValue = Math.round((percent / 100) * 255);\n  const hexValue = intValue.toString(16);\n  return percent === 100 ? '' : hexValue.padStart(2, '0');\n};\n\nconst adjustAlpha = (color, factor) => {\n  return color + percentToHex(factor);\n};\n\nconst getColor = (isRandom = false, usedColors = [], opacity = 100) => {\n  const resetColors = COLORS.filter((c) => !usedColors.includes(c));\n  if (resetColors.length > 0 && !isRandom) {\n    return resetColors[0] + percentToHex(opacity);\n  } else {\n    const lum = -0.25;\n    let hex = String(\n      `#${Math.random().toString(16).slice(2, 8).toUpperCase()}`,\n    ).replace(/[^0-9a-f]/gi, '');\n    if (hex.length < 6) {\n      hex = hex[0] + hex[0] + hex[1] + hex[1] + hex[2] + hex[2];\n    }\n    let rgb = '#';\n    let c;\n    let i;\n    for (i = 0; i < 3; i++) {\n      c = parseInt(hex.substr(i * 2, 2), 16);\n      c = Math.round(Math.min(Math.max(0, c + c * lum), 255)).toString(16);\n      rgb += `00${c}`.substr(c.length);\n    }\n\n    return rgb + percentToHex(opacity);\n  }\n};\nexport { percentToHex, adjustAlpha, hasPredefine2DColor, get2DColor };\nexport default getColor;\n","import { xAbsoluteMedian } from 'ml-spectra-processing';\nimport { xyAutoRangesPicking } from 'nmr-processing';\n\nlet defaultPeakPickingOptions = {\n  minMaxRatio: 0.05,\n  realTopDetection: true,\n  maxCriteria: true,\n  smoothY: false,\n  nH: 100,\n  compile: true,\n  frequencyCluster: 16,\n  clean: true,\n  keepPeaks: true,\n  sgOptions: { windowSize: 7, polynomial: 3 },\n};\n\nexport default function autoRangesDetection(datum1D, options = {}) {\n  // we calculate the noise but this could be improved\n  let noiseLevel = xAbsoluteMedian(datum1D.data.re);\n\n  const { re, x } = datum1D.data;\n  const { originFrequency, nucleus } = datum1D.info;\n\n  const peakPickingOptions = {\n    ...defaultPeakPickingOptions,\n    ...options.peakPicking,\n  };\n\n  const rangesOptions = {\n    frequency: originFrequency,\n    nucleus,\n    noiseLevel: 3 * noiseLevel,\n  };\n\n  const ranges = xyAutoRangesPicking(\n    { x, y: re },\n    {\n      peakPicking: peakPickingOptions,\n      ranges: rangesOptions,\n    },\n  );\n  return ranges;\n}\n","import { xGetFromToIndex } from 'ml-spectra-processing';\nimport { analyseMultiplet } from 'multiplet-analysis';\n\nconst detectSignal = (x, re, from, to, frequency) => {\n  const { fromIndex, toIndex } = xGetFromToIndex(x, {\n    from: from,\n    to: to,\n  });\n  const data = {\n    x: x.slice(fromIndex, toIndex),\n    y: re.slice(fromIndex, toIndex),\n  };\n\n  const result = analyseMultiplet(data, {\n    frequency: frequency,\n    takeBestPartMultiplet: true,\n    symmetrizeEachStep: true,\n  });\n\n  return {\n    multiplicity: result.j.map((j) => j.multiplicity).join(''),\n    kind: 'signal',\n    delta: result.chemShift,\n    j: result.j,\n  };\n};\n\nexport default detectSignal;\n","import max from 'ml-array-max';\nimport { xyIntegration, xyMinYPoint, xyMaxYPoint } from 'ml-spectra-processing';\n\nimport { Filters as FiltersTypes } from '../Filters';\nimport * as FiltersManager from '../FiltersManager';\nimport { DatumKind, SignalKindsToInclude } from '../constants/SignalsKinds';\nimport { checkSignalKinds } from '../utilities/RangeUtilities';\nimport generateID from '../utilities/generateID';\nimport get1dColor from '../utilities/getColor';\n\nimport autoRangesDetection from './autoRangesDetection';\nimport detectSignal from './detectSignal';\n\nexport const usedColors1D: Array<string> = [];\n\nexport interface Data1D {\n  y: Array<number>;\n  x: Array<number>;\n  re: Array<number>;\n  im: Array<number>;\n}\n\nexport interface Display {\n  name: string;\n  color: string;\n  isVisible: boolean;\n  isPeaksMarkersVisible: boolean;\n  isRealSpectrumVisible: boolean;\n  isVisibleInDomain: boolean;\n}\n\nexport interface Info {\n  nucleus: Array<string>;\n  isFid: boolean;\n  isComplex: boolean;\n  dimension: number;\n  isFt: boolean;\n}\nexport interface Peak {\n  id: string;\n  delta: number;\n  originDelta: number;\n  width: number;\n}\nexport interface Peaks {\n  values: Array<Partial<Peak>>;\n  options: any;\n}\nexport interface Integral {\n  id: string;\n  originFrom: number;\n  originTo: number;\n  from: number;\n  to: number;\n  absolute: number;\n  integral: number;\n  kind: string;\n}\nexport interface Integrals {\n  values: Array<Partial<Integral>>;\n  options: Partial<{ sum: number }>;\n}\n\nexport interface Signal {\n  id: string;\n  kind: string;\n  originDelta?: number;\n  delta: number;\n  multiplicity: string;\n  peak?: Array<Partial<{ x: number; intensity: number; width: number }>>;\n}\nexport interface Range {\n  id: string;\n  originFrom?: number;\n  originTo?: number;\n  from: number;\n  to: number;\n  absolute: number;\n  integral: number;\n  kind: string;\n  signal?: Array<Partial<Signal>>;\n}\n\nexport interface Ranges {\n  values: Array<Partial<Range>>;\n  options: Partial<{ sum: number }>;\n}\n\nexport interface Source {\n  jcamp: string;\n  jcampURL: string;\n  original: Data1D;\n}\n\nexport interface Datum1D {\n  id: string | number;\n  source: Partial<Source>;\n  display: Partial<Display>;\n  info: Partial<Info>;\n  originalInfo?: Partial<Info>;\n  meta: any;\n  data: Data1D;\n  originalData?: Data1D;\n  peaks: Peaks;\n  integrals: Integrals;\n  ranges: Ranges;\n  filters: Array<Partial<FiltersManager.Filter>>;\n  shiftX?: number;\n}\n\nexport function initiateDatum1D(options: any): Datum1D {\n  const datum: any = {};\n  datum.shiftX = options.shiftX || 0;\n  datum.id = options.id || generateID();\n  datum.source = Object.assign(\n    {\n      jcamp: null,\n      jcampURL: null,\n      original: [],\n    },\n    options.source,\n  );\n  datum.display = Object.assign(\n    {\n      name: options.display?.name ? options.display.name : generateID(),\n      color: 'black',\n      ...getColor(options),\n      isVisible: true,\n      isPeaksMarkersVisible: true,\n      isRealSpectrumVisible: true,\n      isVisibleInDomain: true,\n    },\n    options.display,\n  );\n\n  datum.info = Object.assign(\n    {\n      nucleus: '1H', // 1H, 13C, 19F, ...\n      isFid: false,\n      isComplex: false, // if isComplex is true that mean it contains real/ imaginary  x set, if not hid re/im button .\n      dimension: 1,\n    },\n    options.info,\n  );\n\n  datum.originalInfo = datum.info;\n\n  datum.meta = Object.assign({}, options.meta);\n  datum.data = Object.assign(\n    {\n      x: [],\n      re: [],\n      im: [],\n      y: [],\n    },\n    options.data,\n  );\n  datum.originalData = datum.data;\n\n  datum.peaks = Object.assign({ values: [], options: {} }, options.peaks);\n  // array of object {index: xIndex, xShift}\n  // in case the peak does not exactly correspond to the point value\n  // we can think about a second attributed `xShift`\n  datum.integrals = Object.assign(\n    { values: [], options: { sum: 100 } },\n    options.integrals,\n  ); // array of object (from: xIndex, to: xIndex)\n  datum.filters = Object.assign([], options.filters); //array of object {name: \"FilterName\", options: FilterOptions = {value | object} }\n  datum.ranges = Object.assign(\n    { values: [], options: { sum: 100 } },\n    options.ranges,\n  );\n\n  //reapply filters after load the original data\n  FiltersManager.reapplyFilters(datum);\n\n  preprocessing(datum);\n  (datum.data as Data1D).y = datum.data.re;\n  return datum;\n}\n\nfunction preprocessing(datum) {\n  if (\n    datum.info.isFid &&\n    datum.filters.findIndex((f) => f.name === FiltersTypes.digitalFilter.id) ===\n      -1\n  ) {\n    FiltersManager.applyFilter(datum, [\n      {\n        name: FiltersTypes.digitalFilter.id,\n        options: {\n          digitalFilterValue: datum.info.digitalFilter,\n        },\n        isDeleteAllow: false,\n      },\n    ]);\n  }\n}\n\nexport function toJSON(datum1D: Datum1D) {\n  return {\n    data: datum1D.originalData,\n    id: datum1D.id,\n    source: {\n      jcamp: datum1D.source.jcamp,\n      jcampURL: datum1D.source.jcampURL,\n      original:\n        datum1D.source.jcampURL || datum1D.source.jcamp\n          ? []\n          : datum1D.source.original,\n    },\n    display: datum1D.display,\n    info: datum1D.originalInfo,\n    meta: datum1D.meta,\n    peaks: datum1D.peaks,\n    integrals: datum1D.integrals,\n    ranges: datum1D.ranges,\n    filters: datum1D.filters,\n  };\n}\n\nfunction getColor(options) {\n  if (options.display === undefined || options.display.color === undefined) {\n    const color = get1dColor(false, usedColors1D);\n    usedColors1D.push(color);\n    return { color };\n  }\n  return {};\n}\n\n// with mouse move\n/**\n *\n * @param {object<{x:Array<number>,re:Array<number>}>} data\n * @param  {object<{from:number,to:number}>} options\n */\nexport function lookupPeak(data, options) {\n  const { from, to } = options;\n  let minIndex = data.x.findIndex((number) => number >= from);\n  let maxIndex = data.x.findIndex((number) => number >= to) - 1;\n\n  if (minIndex > maxIndex) {\n    minIndex = maxIndex;\n    maxIndex = minIndex;\n  }\n  const dataRange = data.re.slice(minIndex, maxIndex);\n  if (dataRange && dataRange.length > 0) {\n    const yValue = max(dataRange);\n    const xIndex = dataRange.findIndex((value) => value === yValue);\n    const xValue = data.x[minIndex + xIndex];\n\n    return { x: xValue, y: yValue, xIndex: minIndex + xIndex };\n  }\n  return null;\n}\n\nexport function updateIntegralIntegrals(integrals) {\n  if (integrals.options.sum === undefined) {\n    integrals.options = { ...integrals.options, sum: 100 };\n  }\n  const countingCondition = (integral) => {\n    return integral.kind && SignalKindsToInclude.includes(integral.kind);\n  };\n  integrals.values = updateRelatives(\n    integrals.values,\n    integrals.options.sum,\n    'integral',\n    countingCondition,\n  );\n}\n\nexport function changeIntegralsRealtive(integrals, id, newIntegralValue) {\n  const integral = integrals.values.find((integral) => integral.id === id);\n  if (integral) {\n    const ratio = integral.absolute / newIntegralValue;\n    const { values, sum } = integrals.values.reduce(\n      (acc, integral, index) => {\n        const newIntegralValue = integral.absolute / ratio;\n        acc.sum += newIntegralValue;\n        acc.values[index] = {\n          ...integral,\n          integral: newIntegralValue,\n        };\n\n        return acc;\n      },\n      { values: [], sum: 0 },\n    );\n\n    integrals.values = values;\n    integrals.options.sum = sum;\n  }\n}\n\nfunction updateRelatives(values, sum, storageKey, countingCondition) {\n  const currentSum = values.reduce((previous, current) => {\n    return countingCondition && countingCondition(current) === true\n      ? (previous += Math.abs(current.absolute))\n      : previous;\n  }, 0);\n  const factor = currentSum > 0 ? sum / currentSum : 0.0;\n  return values.map((value) => {\n    return { ...value, [storageKey]: value.absolute * factor };\n  });\n}\n\nexport function updateIntegralRanges(datum) {\n  if (datum.ranges.options.sum === undefined) {\n    datum.ranges.options.sum = 100;\n  }\n  const countingCondition = (range) => {\n    return range.signal && checkSignalKinds(range, SignalKindsToInclude);\n  };\n  datum.ranges.values = updateRelatives(\n    datum.ranges.values,\n    datum.ranges.options.sum,\n    'integral',\n    countingCondition,\n  );\n}\n\nexport function detectRange(datum, options) {\n  const { from, to } = options;\n  const { x, re: y } = datum.data;\n\n  const absolute = xyIntegration({ x, y }, { from, to, reverse: true });\n  const min = xyMinYPoint({ x, y }, { from, to }).y;\n  const max = xyMaxYPoint({ x, y }, { from, to }).y;\n\n  const shiftX = getShiftX(datum);\n\n  return {\n    id: generateID(),\n    originFrom: from - shiftX,\n    originTo: to - shiftX,\n    from,\n    to,\n    absolute, // the real value,\n    min,\n    max,\n  };\n}\nexport function mapRanges(ranges, datum) {\n  const { x, re } = datum.data;\n  const shiftX = getShiftX(datum);\n\n  return ranges.map((range) => {\n    const absolute = xyIntegration(\n      { x, y: re },\n      { from: range.from, to: range.to, reverse: true },\n    );\n\n    const signal = range.signal.map((_signal) => {\n      return {\n        kind: 'signal',\n        id: generateID(),\n        originDelta: _signal.delta - shiftX,\n        ..._signal,\n      };\n    });\n\n    return {\n      kind: range.signal[0].kind || DatumKind.signal,\n      originFrom: range.from - shiftX,\n      originTo: range.to - shiftX,\n      ...range,\n      id: generateID(),\n      absolute,\n      signal,\n    };\n  });\n}\n\nexport function detectRanges(datum, options) {\n  options.impurities = { solvent: datum.info.solvent };\n  const ranges = autoRangesDetection(datum, options);\n\n  datum.ranges.values = datum.ranges.values.concat(mapRanges(ranges, datum));\n  updateIntegralRanges(datum);\n}\n\nexport function changeRange(datum, range) {\n  const { from, to } = range;\n  const { x, re } = datum.data;\n\n  const index = datum.ranges.values.findIndex((i) => i.id === range.id);\n  const absolute = xyIntegration({ x, y: re }, { from, to, reverse: true });\n\n  if (index !== -1) {\n    datum.ranges.values[index] = {\n      ...datum.ranges.values[index],\n      originFrom: from,\n      originTo: to,\n      ...range,\n      absolute,\n    };\n    updateIntegralRanges(datum);\n  }\n}\n\nexport function addRange(datum, options) {\n  const { from, to } = options;\n  const { x, re } = datum.data;\n  const absolute = xyIntegration({ x, y: re }, { from, to, reverse: true });\n\n  const signals = detectSignal(x, re, from, to, datum.info.originFrequency);\n\n  try {\n    const range = {\n      id: generateID(),\n      from,\n      to,\n      absolute, // the real value,\n      signal: [{ id: generateID(), ...signals }],\n      kind: DatumKind.signal,\n    };\n    datum.ranges.values = datum.ranges.values.concat(mapRanges([range], datum));\n    updateIntegralRanges(datum);\n  } catch (e) {\n    throw new Error('Could not calculate the multiplicity');\n  }\n}\n\nexport function updateXShift(datum: Datum1D) {\n  const shiftX = getShiftX(datum);\n  updatePeaksXShift(datum, shiftX);\n  updateRangesXShift(datum, shiftX);\n  updateIntegralXShift(datum, shiftX);\n}\n\nexport function getShiftX(datum: Datum1D) {\n  const filter =\n    datum?.filters &&\n    datum?.filters.find((filter) => filter.name === FiltersTypes.shiftX.id);\n\n  return filter?.flag ? filter.value : 0;\n}\n\nexport function updatePeaksXShift(datum: Datum1D, shiftValue) {\n  datum.peaks.values = datum.peaks.values.map((peak) => ({\n    ...peak,\n    delta: peak.originDelta + shiftValue,\n  }));\n}\nexport function updateRangesXShift(datum: Datum1D, shiftValue) {\n  datum.ranges.values = datum.ranges.values.map((range) => ({\n    ...range,\n    from: range.originFrom + shiftValue,\n    to: range.originTo + shiftValue,\n    signal:\n      range?.signal &&\n      range.signal.map((s) => ({ ...s, delta: s.originDelta + shiftValue })),\n  }));\n}\nexport function updateIntegralXShift(datum: Datum1D, shiftValue) {\n  datum.integrals.values = datum.integrals.values.map((integral) => ({\n    ...integral,\n    from: integral.originFrom + shiftValue,\n    to: integral.originTo + shiftValue,\n  }));\n}\n\nexport function changeRangesRealtive(datum, rangeID, newRealtiveValue) {\n  const range = datum.ranges.values.find((range) => range.id === rangeID);\n  if (range) {\n    const ratio = range.absolute / newRealtiveValue;\n    datum.ranges.options.sum =\n      (newRealtiveValue / range.integral) * datum.ranges.options.sum;\n    datum.ranges.values = datum.ranges.values.map((range) => {\n      return {\n        ...range,\n        integral: range.absolute / ratio,\n      };\n    });\n  }\n}\n\nexport function changeRangeSignal(datum, rangeID, signalID, newSignalValue) {\n  let shiftValue = 0;\n  const rangeIndex = datum.ranges.values.findIndex(\n    (range) => range.id === rangeID,\n  );\n  if (rangeIndex !== -1) {\n    const signalIndex = datum.ranges.values[rangeIndex].signal.findIndex(\n      (signal) => signal.id === signalID,\n    );\n    shiftValue =\n      newSignalValue -\n      datum.ranges.values[rangeIndex].signal[signalIndex].delta;\n    datum.ranges.values[rangeIndex].signal[signalIndex].delta = newSignalValue;\n  }\n  return shiftValue;\n}\n","import { Conrec } from 'ml-conrec';\n\nexport const defaultContourOptions = {\n  positive: {\n    contourLevels: [0, 21],\n    numberOfLayers: 10,\n  },\n  negative: {\n    contourLevels: [0, 21],\n    numberOfLayers: 10,\n  },\n};\n\nexport default class Processing2D {\n  constructor(\n    minMax,\n    options = defaultContourOptions,\n    defaultLevel = {\n      positive: 10,\n      negative: 10,\n    },\n  ) {\n    this.options = options;\n    const { positive, negative } = defaultLevel;\n\n    this.currentLevelPositive = positive;\n    this.currentLevelNegative = negative;\n\n    const xs = getRange(minMax.minX, minMax.maxX, minMax.z[0].length);\n\n    const ys = getRange(minMax.minY, minMax.maxY, minMax.z.length);\n\n    this.conrec = new Conrec(minMax.z, { xs, ys, swapAxes: false });\n\n    this.median = minMax.noise;\n\n    this.minMax = minMax;\n  }\n\n  getLevel() {\n    return {\n      levelPositive: this.currentLevelPositive,\n      levelNegative: this.currentLevelNegative,\n    };\n  }\n\n  setLevel(levelPositive, levelNegative) {\n    this.currentLevelPositive = levelPositive;\n    this.currentLevelNegative = levelNegative;\n  }\n\n  setOptions(options) {\n    const positiveBoundary = options.positive.contourLevels;\n    const negativeBoundary = options.negative.contourLevels;\n\n    if (this.currentLevelPositive >= positiveBoundary[1]) {\n      this.currentLevelPositive = positiveBoundary[1];\n    } else if (this.currentLevelPositive <= positiveBoundary[0]) {\n      this.currentLevelPositive = positiveBoundary[0];\n    }\n\n    if (this.currentLevelNegative >= negativeBoundary[1]) {\n      this.currentLevelNegative = negativeBoundary[1];\n    } else if (this.currentLevelNegative <= negativeBoundary[0]) {\n      this.currentLevelNegative = negativeBoundary[0];\n    }\n\n    this.options = options;\n  }\n\n  wheel(value) {\n    const sign = Math.sign(value);\n    const positiveBoundary = this.options.positive.contourLevels;\n    const negativeBoundary = this.options.negative.contourLevels;\n\n    if (\n      (this.currentLevelPositive > positiveBoundary[0] && sign === -1) ||\n      (this.currentLevelPositive < positiveBoundary[1] && sign === 1)\n    ) {\n      this.currentLevelPositive += sign;\n    }\n\n    if (\n      (this.currentLevelNegative > negativeBoundary[0] && sign === -1) ||\n      (this.currentLevelNegative < negativeBoundary[1] && sign === 1)\n    ) {\n      this.currentLevelNegative += sign;\n    }\n  }\n\n  shiftWheel(value) {\n    const sign = Math.sign(value);\n    const [min, max] = this.options.positive.contourLevels;\n    if (\n      (this.currentLevelPositive === min && sign === -1) ||\n      (this.currentLevelPositive >= max && sign === 1)\n    ) {\n      return;\n    }\n\n    this.currentLevelPositive += sign;\n    return [];\n  }\n\n  drawContours() {\n    const zoomPositive = this.currentLevelPositive / 2 + 1;\n    const zoomNegative = this.currentLevelNegative / 2 + 1;\n    const {\n      positive: { numberOfLayers: numberOfPositiveLayer },\n      negative: { numberOfLayers: numberOfNegativeLayer },\n    } = this.options;\n    return {\n      positive: this.getContours(zoomPositive, {\n        nbLevels: numberOfPositiveLayer,\n      }),\n      negative: this.getContours(zoomNegative, {\n        negative: true,\n        nbLevels: numberOfNegativeLayer,\n      }),\n    };\n  }\n\n  getContours(zoomLevel, options = {}) {\n    const { negative = false, timeout = 2000, nbLevels = 10 } = options;\n\n    const max = Math.max(\n      Math.abs(this.minMax.maxZ),\n      Math.abs(this.minMax.minZ),\n    );\n\n    let _range = getRange(\n      this.median * 1 * Math.pow(2, zoomLevel),\n      max,\n      nbLevels,\n      2,\n    );\n\n    if (negative) {\n      _range = _range.map((value) => -value);\n    }\n    let contours = [];\n    try {\n      contours = this.conrec.drawContour({\n        contourDrawer: 'basic', // shape or basic\n        levels: _range,\n        timeout: timeout,\n      });\n    } catch (e) {\n      // eslint-disable-next-line no-console\n      console.log(e);\n      throw e;\n    }\n\n    return contours;\n  }\n}\n\nfunction getRange(min, max, length, exp) {\n  if (exp) {\n    let factors = [];\n\n    factors[0] = 0;\n\n    for (let i = 1; i <= length; i++) {\n      factors[i] = factors[i - 1] + (exp - 1) / Math.pow(exp, i);\n    }\n\n    const lastFactor = factors[length];\n\n    const result = new Array(length);\n\n    for (let i = 0; i < length; i++) {\n      result[i] = (max - min) * (1 - factors[i + 1] / lastFactor) + min;\n    }\n\n    return result;\n  } else {\n    const step = (max - min) / (length - 1);\n\n    return range(min, max + step / 2, step);\n  }\n}\n\nfunction range(from, to, step) {\n  const result = [];\n\n  for (let i = from; i < to; i += step) {\n    result.push(i);\n  }\n\n  return result;\n}\n","import { zoneToX } from 'ml-spectra-processing';\n\nimport { Filters } from '../Filters';\nimport * as FiltersManager from '../FiltersManager';\nimport { DatumKind } from '../constants/SignalsKinds';\nimport { initiateDatum1D } from '../data1d/Datum1D';\nimport generateID from '../utilities/generateID';\nimport { get2DColor } from '../utilities/getColor';\n\nimport Processing2D, { defaultContourOptions } from './Processing2D';\nimport autoZonesDetection from './autoZonesDetection';\n\nexport const usedColors2D: Array<string> = [];\n\nexport interface Data2D {\n  z: Array<Array<number>>;\n  minX: number;\n  minY: number;\n  maxX: number;\n  maxY: number;\n}\n\nexport interface ContourOptions {\n  positive: {\n    contourLevels: [number, number];\n    numberOfLayers: number;\n  };\n  negative: {\n    contourLevels: [number, number];\n    numberOfLayers: number;\n  };\n}\n\nexport interface Display {\n  name: string;\n  positiveColor: string;\n  negativeColor: string;\n  isVisible: boolean;\n  isPositiveVisible: boolean;\n  isNegativeVisible: boolean;\n  contourOptions: ContourOptions;\n  isVisibleInDomain: boolean;\n}\n\nexport interface Info {\n  nucleus: Array<string>;\n  isFid: boolean;\n  isComplex: boolean;\n  dimension: number;\n  isFt: boolean;\n}\n\nexport interface Signal {\n  id: number;\n  peak: any;\n  x: Partial<{\n    originDelta: number;\n    delta: number;\n    diaID: any;\n  }>;\n  y: Partial<{\n    originDelta: number;\n    delta: number;\n    diaID: any;\n  }>;\n  kind: string;\n}\n\nexport interface Zone {\n  id: number;\n  x: Partial<{ from: number; to: number }>;\n  y: Partial<{ from: number; to: number }>;\n  signal: Array<Signal>;\n  kind: string;\n}\n\nexport interface ZoneOption {\n  sum: number;\n}\nexport interface Zones {\n  values: Array<Partial<Zone>>;\n  options?: Partial<ZoneOption>;\n}\n\nexport interface Datum2D {\n  id: string;\n  source: Partial<{ jcamp: string; jcampURL: string; original: Data2D }>;\n  display: Display;\n  info: Partial<Info>;\n  originalInfo?: Partial<Info>;\n  meta: any;\n  data: Data2D;\n  originalData?: Data2D;\n  zones: Zones;\n  filters: Array<Partial<FiltersManager.Filter>>;\n  processingController: Processing2D;\n}\n\nexport function initiateDatum2D(options: any): Datum2D {\n  const datum: any = {};\n\n  datum.id = options.id || generateID();\n  datum.source = Object.assign(\n    {\n      jcamp: null,\n      jcampURL: null,\n      original: [],\n    },\n    options.source,\n  );\n  datum.display = Object.assign(\n    {\n      name: options.display.name || generateID(),\n      positiveColor: 'red',\n      negativeColor: 'blue',\n      ...getColor(options),\n      isPositiveVisible: true,\n      isNegativeVisible: true,\n      isVisible: true,\n      contourOptions: defaultContourOptions,\n      dimension: 2,\n    },\n    options.display,\n  );\n\n  datum.info = Object.assign(\n    {\n      nucleus: ['1H', '1H'],\n      isFid: false,\n      isComplex: false, // if isComplex is true that mean it contains real/ imaginary  x set, if not hid re/im button .\n    },\n    options.info,\n  );\n\n  datum.originalInfo = datum.info;\n  datum.meta = Object.assign({}, options.meta);\n  datum.data = Object.assign(\n    {\n      z: [],\n      minX: 0,\n      minY: 0,\n      maxX: 0,\n      maxY: 0,\n    },\n    options.data,\n  );\n  datum.originalData = datum.data;\n  datum.filters = Object.assign([], options.filters);\n\n  datum.zones = Object.assign({ values: [], options: {} }, options.zones);\n\n  datum.processingController = new Processing2D(\n    datum.data,\n    datum.display.contourOptions,\n  );\n\n  //reapply filters after load the original data\n  FiltersManager.reapplyFilters(datum);\n\n  return datum;\n}\n\nexport function getShift(datum: Datum2D): { xShift: number; yShift: number } {\n  let shift: any = { xShift: 0, yShift: 0 };\n  if (datum?.filters) {\n    shift = datum.filters.reduce(\n      (acc, filter) => {\n        if (filter.name === Filters.shift2DX.id) {\n          acc.xShift = filter?.flag ? filter.value : 0;\n        }\n        if (filter.name === Filters.shift2DY.id) {\n          acc.yShift = filter?.flag ? filter.value : 0;\n        }\n        return acc;\n      },\n      { xShift: 0, yShift: 0 },\n    );\n  }\n\n  return shift;\n}\n\nfunction getColor(options) {\n  if (\n    options.display === undefined ||\n    options.display.negativeColor === undefined ||\n    options.display.positiveColor === undefined\n  ) {\n    const color = get2DColor(options.info.experiment, usedColors2D);\n    usedColors2D.push(color.positiveColor);\n    return color;\n  }\n  return {};\n}\n\nexport function toJSON(datum: Datum2D) {\n  return {\n    data: datum.originalData,\n    id: datum.id,\n    source: {\n      jcamp: datum.source.jcamp,\n      jcampURL: datum.source.jcampURL,\n      original: datum.source.jcampURL ? [] : datum.source.original,\n    },\n    zones: datum.zones,\n    filters: datum.filters,\n    display: datum.display,\n    info: datum.originalInfo,\n    meta: datum.meta,\n  };\n}\n\n/** get 2d projection\n * @param {number} x in ppm\n * @param {number} y in ppm\n */\nexport function getSlice(spectrum, position) {\n  const data = spectrum.data;\n  const xStep = (data.maxX - data.minX) / (data.z[0].length - 1);\n  const yStep = (data.maxY - data.minY) / (data.z.length - 1);\n  const xIndex = Math.floor((position.x - data.minX) / xStep);\n  const yIndex = Math.floor((position.y - data.minY) / yStep);\n\n  if (xIndex < 0 || xIndex >= data.z[0].length) return;\n  if (yIndex < 0 || yIndex >= data.z.length) return;\n\n  let infoX = {\n    nucleus: spectrum.info.nucleus[0], // 1H, 13C, 19F, ...\n    isFid: false,\n    isComplex: false, // if isComplex is true that mean it contains real/ imaginary  x set, if not hid re/im button .\n    dimension: 1,\n  };\n\n  let dataX = {\n    x: zoneToX(\n      { from: spectrum.data.minX, to: spectrum.data.maxX },\n      spectrum.data.z[0].length,\n    ),\n    re: new Float64Array(spectrum.data.z[0].length),\n  };\n\n  for (let i = 0; i < spectrum.data.z[0].length; i++) {\n    dataX.re[i] += spectrum.data.z[yIndex][i];\n  }\n\n  let infoY = {\n    nucleus: spectrum.info.nucleus[1], // 1H, 13C, 19F, ...\n    isFid: false,\n    isComplex: false, // if isComplex is true that mean it contains real/ imaginary  x set, if not hid re/im button .\n    dimension: 1,\n  };\n\n  let dataY = {\n    x: zoneToX(\n      { from: spectrum.data.minY, to: spectrum.data.maxY },\n      spectrum.data.z.length,\n    ),\n    re: new Float64Array(spectrum.data.z.length),\n  };\n\n  let index = spectrum.data.z.length - 1;\n  for (let i = 0; i < spectrum.data.z.length; i++) {\n    dataY.re[i] += spectrum.data.z[index--][xIndex];\n  }\n\n  const horizontal = initiateDatum1D({ info: infoX, data: dataX });\n  const vertical = initiateDatum1D({ info: infoY, data: dataY });\n  return { horizontal, vertical };\n}\n\nexport function updateShift(datum: Datum2D) {\n  const { xShift, yShift } = getShift(datum);\n  updateZonesShift(datum, {\n    xShift,\n    yShift,\n  });\n}\n\nexport function updateZonesShift(datum: Datum2D, { xShift, yShift }) {\n  datum.zones.values = datum.zones.values.map((zone) => ({\n    ...zone,\n    signal: zone.signal?.map((signal) => ({\n      ...signal,\n      x: { ...signal.x, delta: signal.x.originDelta + xShift },\n      y: { ...signal.y, delta: signal.y.originDelta + yShift },\n    })),\n  }));\n}\n\n/**\n *\n * @param {number} zoneID\n * @param {object} signal\n * @param {number} signal.x\n * @param {number} signal.y\n * @param {string} signal.id\n */\nexport function changeZoneSignal(\n  datum,\n  zoneID,\n  newSignal,\n): { xShift: number; yShift: number } {\n  const zoneIndex = datum.zones.values.findIndex((zone) => zone.id === zoneID);\n  if (zoneIndex !== -1) {\n    const signalIndex = datum.zones.values[zoneIndex].signal.findIndex(\n      (s) => s.id === newSignal.id,\n    );\n    if (signalIndex !== -1) {\n      const originalSignal = datum.zones.values[zoneIndex].signal[signalIndex];\n      const xShift =\n        newSignal?.x || newSignal?.x === 0\n          ? newSignal.x - originalSignal.x.delta\n          : 0;\n      const yShift =\n        newSignal?.y || newSignal?.y === 0\n          ? newSignal.y - originalSignal.y.delta\n          : 0;\n\n      // if (newSignal.x) {\n      //   datum.zones.values[zoneIndex].signal[signalIndex].x.delta = newSignal.x;\n      // }\n      // if (newSignal.y) {\n      //   datum.zones.values[zoneIndex].signal[signalIndex].y.delta = newSignal.y;\n      // }\n      return { xShift, yShift };\n    }\n  }\n  return { xShift: 0, yShift: 0 };\n}\n\n/**\n *\n * @param {object} options\n * @param {object} options.selectedZone\n * @param {number} options.selectedZone.fromX\n * @param {number} options.selectedZone.fromY\n * @param {number} options.selectedZone.toX\n * @param {number} options.selectedZone.toY\n * @param {number} options.thresholdFactor\n * @param {boolean} options.convolutionByFFT\n */\nexport function detectZonesManual(datum, options) {\n  const signals = getDetectionZones(datum, options);\n  const { xShift, yShift } = getShift(datum);\n  for (let signal of signals) {\n    let { fromTo } = signal;\n    datum.zones.values.push({\n      id: generateID(),\n      x: fromTo[0],\n      y: fromTo[1],\n      signal: [\n        {\n          id: generateID(),\n          peak: signal.peaks,\n          x: {\n            originDelta: signal.shiftX - xShift,\n            delta: signal.shiftX,\n            diaID: [],\n          },\n          y: {\n            originDelta: signal.shiftY - yShift,\n            delta: signal.shiftY,\n            diaID: [],\n          },\n          kind: 'signal',\n        },\n      ],\n      kind: DatumKind.signal,\n    });\n  }\n}\n\n/** calculate the missing projection\n * @param {string[]} nucleus\n */\nexport function getMissingProjection(datum, nucleus) {\n  let index = datum.info.nucleus.indexOf(nucleus);\n  // temporary because nuclus was undefined;\n  if (index === -1) index = 0;\n\n  let info = {\n    nucleus: datum.info.nucleus[index], // 1H, 13C, 19F, ...\n    isFid: false,\n    isComplex: false, // if isComplex is true that mean it contains real/ imaginary  x set, if not hid re/im button .\n    dimension: 1,\n  };\n\n  let from = index === 0 ? datum.data.minX : datum.data.minY;\n  let to = index === 0 ? datum.data.maxX : datum.data.maxY;\n  let nbPoints = index === 0 ? datum.data.z.length : datum.data.z[0].length;\n\n  let projection = new Float64Array(nbPoints);\n  if (index === 1) {\n    for (let i = 0; i < datum.data.z.length; i++) {\n      for (let j = 0; j < datum.data.z[0].length; j++) {\n        projection[i] += datum.data.z[i][j];\n      }\n    }\n  } else {\n    for (let i = 0; i < datum.data.z[0].length; i++) {\n      // eslint-disable-next-line @typescript-eslint/prefer-for-of\n      for (let j = 0; j < datum.data.z.length; j++) {\n        projection[i] += datum.data.z[j][i];\n      }\n    }\n  }\n\n  let data = {\n    x: zoneToX({ from, to }, nbPoints),\n    re: projection,\n  };\n  const datum1D = initiateDatum1D({ info, data });\n  return datum1D;\n}\n/**\n *\n * @param {object} options\n * @param {object} options.selectedZone\n * @param {number} options.selectedZone.fromX\n * @param {number} options.selectedZone.fromY\n * @param {number} options.selectedZone.toX\n * @param {number} options.selectedZone.toY\n * @param {number} options.thresholdFactor\n * @param {boolean} options.convolutionByFFT\n */\nexport function getDetectionZones(datum, options) {\n  let dataMatrix = {};\n  if (options.selectedZone) {\n    dataMatrix = getSubMatrix(datum, options.selectedZone);\n  } else {\n    dataMatrix = datum.data;\n  }\n  options.info = datum.info;\n  return autoZonesDetection(dataMatrix, options);\n}\n/**\n *\n * @param {object} options\n * @param {object} options.selectedZone\n * @param {number} options.selectedZone.fromX\n * @param {number} options.selectedZone.fromY\n * @param {number} options.selectedZone.toX\n * @param {number} options.selectedZone.toY\n * @param {number} options.thresholdFactor\n * @param {boolean} options.convolutionByFFT\n */\nexport function detectZones(datum, options) {\n  const zones = getDetectionZones(datum, options);\n  const { xShift, yShift } = getShift(datum);\n\n  const formattedZones = zones.map((zone) => {\n    return {\n      id: generateID(),\n      x: { from: zone.fromTo[0].from, to: zone.fromTo[0].to },\n      y: { from: zone.fromTo[1].from, to: zone.fromTo[1].to },\n      signal: [\n        {\n          id: generateID(),\n          peak: zone.peaks,\n          x: {\n            originDelta: zone.shiftX - xShift,\n            delta: zone.shiftX,\n            diaID: [],\n          },\n          y: {\n            originDelta: zone.shiftY - yShift,\n            delta: zone.shiftY,\n            diaID: [],\n          },\n          kind: 'signal',\n        },\n      ],\n      kind: DatumKind.signal,\n    };\n  });\n  datum.zones.values = datum.zones.values.concat(formattedZones);\n}\n\nexport function getSubMatrix(datum, selectedZone) {\n  const { fromX, toX, fromY, toY } = selectedZone;\n  const data = datum.data;\n  const xStep = (data.maxX - data.minX) / data.z[0].length;\n  const yStep = (data.maxY - data.minY) / data.z.length;\n  let xIndexFrom = Math.floor((fromX - data.minX) / xStep);\n  let yIndexFrom = Math.floor((fromY - data.minY) / yStep);\n  let xIndexTo = Math.floor((toX - data.minX) / xStep);\n  let yIndexTo = Math.floor((toY - data.minY) / yStep);\n  let dataMatrix: any = {\n    z: [],\n    maxX: data.minX + xIndexTo * xStep,\n    minX: data.minX + xIndexFrom * xStep,\n    maxY: data.minY + yIndexTo * yStep,\n    minY: data.minY + yIndexFrom * yStep,\n  };\n  let maxZ = Number.MIN_SAFE_INTEGER;\n  let minZ = Number.MAX_SAFE_INTEGER;\n\n  let nbXPoints = xIndexFrom - xIndexTo + 1;\n  for (let j = yIndexFrom; j < yIndexTo; j++) {\n    let row = new Float32Array(nbXPoints);\n    let xIndex = xIndexFrom;\n    for (let i = 0; i < nbXPoints; i++) {\n      row[i] = data.z[j][xIndex--];\n    }\n    for (let rowValue of row) {\n      if (maxZ < rowValue) maxZ = rowValue;\n      if (minZ > rowValue) minZ = rowValue;\n    }\n    dataMatrix.z.push(Array.from(row));\n  }\n  dataMatrix.minZ = minZ;\n  dataMatrix.maxZ = maxZ;\n\n  return dataMatrix;\n}\n","import { xyzAutoPeaksPicking } from 'nmr-processing';\n\nexport default function autoZonesDetection(data, options) {\n  const {\n    thresholdFactor,\n    clean,\n    maxPercentCutOff,\n    enhanceSymmetry,\n    convolutionByFFT,\n  } = options;\n\n  const { nucleus, originFrequency } = options.info;\n  const isHomoNuclear = nucleus[0] === nucleus[1];\n\n  let zones = xyzAutoPeaksPicking(data, {\n    isHomoNuclear,\n    nucleus,\n    observeFrequencies: originFrequency,\n    thresholdFactor,\n    clean,\n    maxPercentCutOff,\n    enhanceSymmetry,\n    convolutionByFFT,\n  });\n\n  return zones;\n}\n","import { extent, scaleLinear } from 'd3';\n/***\n * @param {number} width\n * @param {object} margin\n * @param {number} margin.right\n * @param {number} margin.left\n * @param {number[]} x\n * @returns {object={somain.scaleX}}\n\n */\nfunction getTopXScale(width, margin, x) {\n  const xDomain = extent(x);\n  const scaleX = scaleLinear(extent(x), [width - margin.right, margin.left]);\n  return {\n    xDomain,\n    scaleX,\n  };\n}\n/***\n * @param {number} width\n * @param {object} margin\n * @param {number} margin.bottom\n * @param {number} margin.top\n * @param {number[]} x\n * @returns {object={somain.scaleX}}\n */\nfunction getLeftXScale(height, margin, x) {\n  const xDomain = extent(x);\n  const scaleX = scaleLinear(extent(x), [height - margin.bottom, margin.top]);\n\n  return {\n    xDomain,\n    scaleX,\n  };\n}\n\n/***\n * @param {number} height\n * @param {number} margin\n * @param {number[]} y\n */\nfunction getYScale(height, y, margin = 10) {\n  return scaleLinear(extent(y), [height - margin, margin]);\n}\n\nexport { getTopXScale, getLeftXScale, getYScale };\n","import { xyReduce } from 'ml-spectra-processing';\nimport { useMemo, memo } from 'react';\n\nimport { useChartData } from '../../../context/ChartContext';\nimport { get2DXScale } from '../../utilities/scale';\n\nimport { getYScale } from './SliceScale';\n\nfunction HorizontalSliceChart({ margin: marginProps, data }) {\n  const { width, margin: originMargin, xDomain, displayerKey } = useChartData();\n\n  const height = originMargin.top;\n\n  const paths = useMemo(() => {\n    if (data) {\n      const { x, re: y } = data;\n      const scaleX = get2DXScale({ margin: originMargin, width, xDomain });\n\n      const scaleY = getYScale(height, y, marginProps);\n      const pathPoints = xyReduce(\n        { x, y },\n        {\n          from: xDomain[0],\n          to: xDomain[1],\n        },\n      );\n\n      let path = `M ${scaleX(pathPoints.x[0])} ${scaleY(pathPoints.y[0])} `;\n      path += pathPoints.x.slice(1).reduce((accumulator, point, i) => {\n        accumulator += ` L ${scaleX(point)} ${scaleY(pathPoints.y[i + 1])}`;\n        return accumulator;\n      }, '');\n      return path;\n    } else {\n      return null;\n    }\n  }, [data, height, marginProps, originMargin, width, xDomain]);\n\n  if (!width || !height) {\n    return null;\n  }\n\n  return (\n    <svg viewBox={`0 0 ${width} ${height}`} width={width} height={height}>\n      <defs>\n        <clipPath id={`${displayerKey}clip-top`}>\n          <rect\n            width={width - originMargin.left - originMargin.right}\n            height={height}\n            x={originMargin.left}\n            y={`${0}`}\n          />\n        </clipPath>\n      </defs>\n      <g clipPath={`url(#${displayerKey}clip-top)`}>\n        <rect\n          width={width - originMargin.left - originMargin.right}\n          height={height}\n          x={originMargin.left}\n          y={`${0}`}\n          fillOpacity=\"0\"\n        />\n        <path className=\"line\" stroke=\"red\" fill=\"none\" d={paths} />\n      </g>\n    </svg>\n  );\n}\n\nHorizontalSliceChart.defaultProps = {\n  margin: 10,\n};\n\nexport default memo(HorizontalSliceChart);\n","import { xyReduce } from 'ml-spectra-processing';\nimport { useMemo, memo } from 'react';\n\nimport { useChartData } from '../../../context/ChartContext';\nimport { get2DYScale } from '../../utilities/scale';\n\nimport { getYScale } from './SliceScale';\n\nfunction VerticalSliceChart({ margin: marignValue, data }) {\n  const {\n    height: originHeight,\n    margin,\n    yDomain,\n    displayerKey,\n  } = useChartData();\n\n  const height = margin.left;\n\n  const paths = useMemo(() => {\n    if (data) {\n      const { x, re: y } = data;\n      const scaleX = get2DYScale({ height: originHeight, margin, yDomain });\n\n      const scaleY = getYScale(height, y, marignValue);\n\n      const pathPoints = xyReduce(\n        { x, y },\n        {\n          from: yDomain[0],\n          to: yDomain[1],\n        },\n      );\n      const lastXIndex = pathPoints.x.length - 1;\n      const lastYIndex = pathPoints.y.length - 1;\n      let path = `M  ${scaleY(pathPoints.y[lastYIndex])} ${scaleX(\n        lastXIndex,\n      )} `;\n      path += pathPoints.x\n        .slice(0, lastXIndex)\n        .reduceRight((accumulator, point, index) => {\n          accumulator += ` L  ${scaleY(pathPoints.y[index])} ${scaleX(point)}`;\n          return accumulator;\n        }, '');\n      return path;\n    } else {\n      return null;\n    }\n  }, [data, height, margin, marignValue, originHeight, yDomain]);\n\n  const mainHeight = originHeight - margin.bottom - margin.top;\n\n  if (!mainHeight || !height) return null;\n\n  return (\n    <svg\n      viewBox={`0 0 ${height} ${mainHeight + margin.top}`}\n      width={height}\n      height={mainHeight + margin.top}\n    >\n      <defs>\n        <clipPath id={`${displayerKey}clip-left`}>\n          <rect width={height} height={mainHeight} x=\"0\" y={margin.top} />\n        </clipPath>\n      </defs>\n      <g clipPath={`url(#${displayerKey}clip-left)`}>\n        <path className=\"line\" stroke=\"red\" fill=\"none\" d={paths} />\n      </g>\n    </svg>\n  );\n}\n\nVerticalSliceChart.defaultProps = {\n  margin: 10,\n};\n\nexport default memo(VerticalSliceChart);\n","import PropsTypes from 'prop-types';\nimport { useMemo } from 'react';\n\nimport { getSlice } from '../../../../data/data2d/Datum2D';\nimport { useMouseTracker } from '../../../EventsTrackers/MouseTracker';\nimport { useChartData } from '../../../context/ChartContext';\nimport { get2DXScale, get2DYScale } from '../../utilities/scale';\n\nimport HorizontalSliceChart from './HorizontalSliceChart';\nimport VerticalSliceChart from './VerticalSliceChart';\n\nfunction SlicingView() {\n  const {\n    width,\n    height,\n    margin,\n    activeSpectrum,\n    data: spectra,\n    xDomain,\n    yDomain,\n  } = useChartData();\n  const position = useMouseTracker();\n\n  const chart2d = useMemo(() => {\n    if (position && activeSpectrum.id) {\n      const { x, y } = position;\n      const scale2dX = get2DXScale({ margin, width, xDomain });\n      const scale2dY = get2DYScale({ margin, height, yDomain });\n      const data = getSlice(spectra[activeSpectrum.index], {\n        x: scale2dX.invert(x),\n        y: scale2dY.invert(y),\n      });\n      return (\n        <svg\n          viewBox={`0 0 ${width} ${height}`}\n          width={width}\n          height={height}\n          style={{\n            position: 'absolute',\n            backgroundColor: 'rgba(255,255,255,0.8)',\n          }}\n        >\n          {data && data.horizontal && (\n            <HorizontalSliceChart data={data.horizontal.data} />\n          )}\n          {data && data.vertical && (\n            <VerticalSliceChart data={data.vertical.data} />\n          )}\n        </svg>\n      );\n    }\n    return null;\n  }, [\n    position,\n    activeSpectrum.id,\n    activeSpectrum.index,\n    margin,\n    width,\n    xDomain,\n    height,\n    yDomain,\n    spectra,\n  ]);\n\n  if (!position) {\n    return null;\n  }\n\n  return chart2d;\n}\nSlicingView.defaultProps = {\n  onDimensionChange: () => null,\n};\n\nSlicingView.propsTypes = {\n  onDimensionChange: PropsTypes.func.isRequired,\n};\n\nexport default SlicingView;\n","import { useCallback, Fragment, useEffect, useState, useMemo } from 'react';\nimport { useSize, useDebounce } from 'react-use';\n\nimport { BrushTracker } from '../EventsTrackers/BrushTracker';\nimport { MouseTracker } from '../EventsTrackers/MouseTracker';\nimport { useChartData } from '../context/ChartContext';\nimport { useDispatch } from '../context/DispatchContext';\nimport Spinner from '../loader/Spinner';\nimport {\n  BRUSH_END,\n  FULL_ZOOM_OUT,\n  SET_DIMENSIONS,\n  SET_2D_LEVEL,\n  SET_ZOOM_FACTOR,\n  ADD_2D_ZONE,\n} from '../reducer/types/Types';\nimport BrushXY, { BRUSH_TYPE } from '../tool/BrushXY';\nimport CrossLinePointer from '../tool/CrossLinePointer';\nimport { options } from '../toolbar/ToolTypes';\n\nimport Chart2D from './Chart2D';\nimport FooterBanner from './FooterBanner';\nimport XYLabelPointer from './tools/XYLabelPointer';\nimport SlicingView from './tools/slicing/SlicingView';\nimport { get2DDimensionLayout, getLayoutID } from './utilities/DimensionLayout';\n\nfunction Viewer2D() {\n  const state = useChartData();\n  const {\n    selectedTool,\n    isLoading,\n    data,\n    margin,\n    tabActiveSpectrum,\n    activeTab,\n  } = state;\n\n  const dispatch = useDispatch();\n\n  const spectrumData = useMemo(() => {\n    const nucleuses = activeTab.split(',');\n    return nucleuses.reduce((acc, n) => {\n      if (tabActiveSpectrum[n] && tabActiveSpectrum[n].id) {\n        const id = tabActiveSpectrum[n].id;\n        const spectrum = data.find(\n          (datum) => datum.id === id && !datum.info.isFid,\n        );\n        if (spectrum) {\n          acc.push(spectrum);\n        }\n      } else {\n        acc.push(null);\n      }\n      return acc;\n    }, []);\n  }, [activeTab, data, tabActiveSpectrum]);\n\n  const DIMENSION = get2DDimensionLayout(state);\n\n  const handelBrushEnd = useCallback(\n    (brushData) => {\n      const trackID = getLayoutID(DIMENSION, brushData);\n      if (trackID) {\n        if (brushData.altKey) {\n          switch (selectedTool) {\n            default:\n              break;\n          }\n        } else if (brushData.shiftKey) {\n          switch (selectedTool) {\n            case options.zone2D.id:\n              dispatch({ type: ADD_2D_ZONE, ...brushData });\n              break;\n            default:\n              break;\n          }\n        } else {\n          switch (selectedTool) {\n            default:\n              if (selectedTool != null) {\n                return dispatch({\n                  type: BRUSH_END,\n                  ...brushData,\n                  trackID: getLayoutID(DIMENSION, brushData),\n                });\n              }\n          }\n        }\n      }\n    },\n    [selectedTool, dispatch, DIMENSION],\n  );\n\n  const handelOnDoubleClick = useCallback(\n    (e) => {\n      const { x: startX, y: startY } = e;\n      const trackID = getLayoutID(DIMENSION, { startX, startY });\n      if (trackID) {\n        dispatch({ type: FULL_ZOOM_OUT, trackID });\n      }\n    },\n    [DIMENSION, dispatch],\n  );\n\n  const handleZoom = (wheelData) => {\n    const { x: startX, y: startY } = wheelData;\n    const trackID = getLayoutID(DIMENSION, { startX, startY });\n\n    if (trackID) {\n      if (trackID === 'CENTER_2D') {\n        dispatch({ type: SET_2D_LEVEL, ...wheelData });\n      } else {\n        dispatch({ type: SET_ZOOM_FACTOR, ...wheelData, trackID });\n      }\n    }\n  };\n\n  const mouseClick = useCallback(\n    (position) => {\n      // eslint-disable-next-line no-unused-vars\n      const { x, y } = position;\n      switch (selectedTool) {\n        default:\n          break;\n      }\n    },\n    [selectedTool],\n  );\n\n  const [sizedNMRChart, { width, height }] = useSize(() => {\n    return (\n      <Fragment>\n        <Spinner isLoading={isLoading} />\n\n        {data && data.length > 0 && (\n          <BrushTracker\n            onBrush={handelBrushEnd}\n            onDoubleClick={handelOnDoubleClick}\n            onClick={mouseClick}\n            onZoom={handleZoom}\n            style={{\n              width: '100%',\n              height: '100%',\n              margin: 'auto',\n              position: 'relative',\n              overflow: 'hidden',\n            }}\n          >\n            <MouseTracker\n              style={{ width: '100%', height: `100%`, position: 'absolute' }}\n            >\n              {selectedTool && selectedTool === options.slicingTool.id && (\n                <SlicingView />\n              )}\n\n              <CrossLinePointer />\n              {spectrumData && (\n                <XYLabelPointer data1D={spectrumData} layout={DIMENSION} />\n              )}\n\n              <BrushXY\n                brushType={BRUSH_TYPE.XY}\n                dimensionBorder={DIMENSION.CENTER_2D}\n              />\n              <>\n                {spectrumData && spectrumData[0] && (\n                  <BrushXY\n                    brushType={BRUSH_TYPE.X}\n                    dimensionBorder={DIMENSION.TOP_1D}\n                    height={margin.top}\n                  />\n                )}\n                {spectrumData && spectrumData[1] && (\n                  <BrushXY\n                    brushType={BRUSH_TYPE.Y}\n                    dimensionBorder={DIMENSION.LEFT_1D}\n                    width={margin.left}\n                  />\n                )}\n              </>\n              {spectrumData && (\n                <FooterBanner data1D={spectrumData} layout={DIMENSION} />\n              )}\n\n              <Chart2D data={spectrumData} />\n            </MouseTracker>\n          </BrushTracker>\n        )}\n      </Fragment>\n    );\n  }, []);\n\n  const [finalSize, setFinalSize] = useState();\n  useDebounce(() => setFinalSize({ width, height }), 400, [width, height]);\n  useEffect(() => {\n    if (finalSize && isFinite(finalSize.width) && isFinite(finalSize.height)) {\n      dispatch({\n        type: SET_DIMENSIONS,\n        ...finalSize,\n      });\n    }\n  }, [dispatch, finalSize]);\n\n  return sizedNMRChart;\n}\n\nexport default Viewer2D;\n","import { Component, CSSProperties, ErrorInfo } from 'react';\n\nconst styles: Record<string, CSSProperties> = {\n  container: {\n    margin: '25px',\n  },\n  header: {\n    backgroundColor: '#ffffff',\n    padding: '20px',\n    borderRadius: '10px',\n    fontSize: '30px',\n    textAlign: 'center',\n  },\n\n  body: {\n    whiteSpace: 'pre-wrap',\n    backgroundColor: 'white',\n    padding: '20px',\n    borderRadius: '10px',\n    color: 'red',\n  },\n};\n\nexport default class ErrorBoundary extends Component<\n  unknown,\n  { error: Error | null; errorInfo: ErrorInfo | null }\n> {\n  public constructor(props: unknown) {\n    super(props);\n    this.state = { error: null, errorInfo: null };\n  }\n\n  public componentDidCatch(error: Error, errorInfo: ErrorInfo) {\n    // Catch errors in any components below and re-render with error message\n    this.setState({\n      error: error,\n      errorInfo: errorInfo,\n    });\n    // You can also log error messages to an error reporting service here\n  }\n\n  public render() {\n    if (this.state.errorInfo && process.env.NODE_ENV === 'production') {\n      // Error path\n      return (\n        <div style={styles.container}>\n          <p style={styles.header}>Something went wrong.</p>\n          <details style={styles.body}>\n            {this.state.error}\n            <br />\n            {this.state.errorInfo.componentStack}\n          </details>\n        </div>\n      );\n    }\n    // Normally, just render children\n    return this.props.children;\n  }\n}\n","import { createContext, useContext } from 'react';\n\nconst AlertContext = createContext();\n\nexport const AlertProvider = AlertContext.Provider;\n\nexport const useAlert = () => {\n  return useContext(AlertContext);\n};\n","import PropTypes from 'prop-types';\nimport {\n  Fragment,\n  useState,\n  useRef,\n  useEffect,\n  useCallback,\n  useMemo,\n} from 'react';\nimport { createPortal } from 'react-dom';\nimport { FaTimes } from 'react-icons/fa';\nimport { TransitionGroup } from 'react-transition-group';\n\nimport Transition from '../Transition';\nimport Wrapper from '../Wrapper';\nimport { groupBy } from '../helpers';\nimport { positions, transitions, types } from '../options';\n\nimport { AlertProvider } from './Context';\n\nfunction Provider({\n  children,\n  wrapperRef,\n  offset,\n  position,\n  timeout,\n  type,\n  transition,\n  ...props\n}) {\n  const root = useRef(null);\n  const alertContext = useRef(null);\n  const timersId = useRef([]);\n  const [alerts, setAlerts] = useState([]);\n\n  useEffect(() => {\n    root.current = document.createElement('div');\n    const ref = root.current;\n    const timersIdRef = timersId.current;\n\n    if (wrapperRef) {\n      wrapperRef.appendChild(ref);\n    }\n    return () => {\n      if (ref) {\n        if (wrapperRef) {\n          timersIdRef.forEach(clearTimeout);\n\n          wrapperRef.removeChild(ref);\n        }\n      }\n    };\n  }, [wrapperRef]);\n\n  const remove = useCallback((alert) => {\n    setAlerts((currentAlerts) => {\n      const lengthBeforeRemove = currentAlerts.length;\n      const filteredAlerts = currentAlerts.filter((a) => a.id !== alert.id);\n\n      if (lengthBeforeRemove > filteredAlerts.length && alert.options.onClose) {\n        alert.options.onClose();\n      }\n\n      return filteredAlerts;\n    });\n  }, []);\n\n  const removeAll = useCallback(() => {\n    alertContext.current.alerts.forEach(remove);\n  }, [remove]);\n\n  const show = useCallback(\n    (message = '', options = {}) => {\n      const id = Math.random().toString(36).substr(2, 9);\n\n      const alertOptions = {\n        position: options.position || position,\n        timeout,\n        type,\n        backgroundColor: 'black',\n        color: 'white',\n        ...options,\n      };\n\n      const alert = {\n        id,\n        message,\n        options: alertOptions,\n      };\n\n      alert.close = () => remove(alert);\n\n      if (alert.options.timeout) {\n        const timerId = setTimeout(() => {\n          remove(alert);\n\n          timersId.current.splice(timersId.current.indexOf(timerId), 1);\n        }, alert.options.timeout);\n\n        timersId.current.push(timerId);\n      }\n\n      setAlerts((state) => state.concat(alert));\n      if (alert.options.onOpen) alert.options.onOpen();\n\n      return alert;\n    },\n    [position, remove, timeout, type],\n  );\n\n  const success = useCallback(\n    (message = '', options = {}) => {\n      options.type = types.SUCCESS;\n      options = { backgroundColor: '#28ba62', color: 'white', ...options };\n\n      return show(message, options);\n    },\n    [show],\n  );\n\n  const error = useCallback(\n    (message = '', options = {}) => {\n      options.type = types.ERROR;\n      options = { backgroundColor: '#cf3c4f', color: 'white', ...options };\n      return show(message, options);\n    },\n    [show],\n  );\n\n  const info = useCallback(\n    (message = '', options = {}) => {\n      options.type = types.INFO;\n      options.color = '#28ba62';\n      return show(message, options);\n    },\n    [show],\n  );\n\n  const closeHandler = useCallback(\n    (alert) => {\n      remove(alert);\n    },\n    [remove],\n  );\n\n  const alertsByPosition = groupBy(alerts, (alert) => alert.options.position);\n\n  const parentStyle = useMemo(() => {\n    return wrapperRef\n      ? wrapperRef.getBoundingClientRect()\n      : {\n          top: 0,\n          left: 0,\n          width: window.innerWidth,\n          height: window.innerHeight,\n        };\n  }, [wrapperRef]);\n\n  return (\n    <AlertProvider\n      value={{ alerts, show, remove, removeAll, success, error, info }}\n    >\n      {children}\n      {root.current &&\n        createPortal(\n          <Fragment>\n            {Object.keys(positions).map((key) => {\n              const position = positions[key];\n\n              return (\n                <TransitionGroup\n                  appear\n                  key={position}\n                  options={{ position, zIndex: 999999 }}\n                  component={Wrapper}\n                  containerStyle={parentStyle}\n                  {...props}\n                >\n                  {alertsByPosition[position]\n                    ? alertsByPosition[position].map((alert) => (\n                        <Transition type={transition} key={alert.id}>\n                          <div\n                            style={{\n                              margin: offset,\n                              padding: '25px',\n                              borderRadius: '10px',\n                              pointerEvents: 'all',\n                              backgroundColor: alert.options.backgroundColor,\n                              color: alert.options.color,\n                              minHeight: '60px',\n                              position: 'relative',\n                            }}\n                            key={alert.id}\n                          >\n                            <button\n                              style={{\n                                position: 'absolute',\n                                right: '5px',\n                                top: '5px',\n                                border: 'none',\n                                backgroundColor: 'transparent',\n                                color: 'white',\n                              }}\n                              type=\"button\"\n                              onClick={() => closeHandler(alert)}\n                            >\n                              <FaTimes />\n                            </button>\n\n                            <span>{alert.message}</span>\n                          </div>\n                        </Transition>\n                      ))\n                    : null}\n                </TransitionGroup>\n              );\n            })}\n          </Fragment>,\n          root.current,\n        )}\n    </AlertProvider>\n  );\n}\n\nProvider.propTypes = {\n  offset: PropTypes.string,\n  position: PropTypes.oneOf(\n    Object.keys(positions).map((position) => positions[position]),\n  ),\n  timeout: PropTypes.number,\n  type: PropTypes.oneOf(Object.keys(types).map((type) => types[type])),\n  transition: PropTypes.oneOf(\n    Object.keys(transitions).map((transition) => transitions[transition]),\n  ),\n  containerStyle: PropTypes.object,\n  wrapperRef: PropTypes.object,\n  context: PropTypes.shape({\n    Provider: PropTypes.object,\n    Consumer: PropTypes.object,\n  }),\n};\n\nProvider.defaultProps = {\n  offset: '5px',\n  position: positions.BOTTOM_CENTER,\n  transition: transitions.FADE,\n  wrapperRef: null,\n  timeout: 3000,\n};\n\nexport default Provider;\n","import lodashDebounce from 'lodash/debounce';\nimport lodashMap from 'lodash/map';\nimport { useCallback, useRef, useState } from 'react';\n\nimport { ZoomType } from '../reducer/actions/Zoom';\nimport {\n  CHANGE_SPECTRUM_DISPLAY_VIEW_MODE,\n  EXPORT_DATA,\n  FULL_ZOOM_OUT,\n  SET_SELECTED_TOOL,\n  SET_SPECTRUMS_VERTICAL_ALIGN,\n  TOGGLE_REAL_IMAGINARY_VISIBILITY,\n} from '../reducer/types/Types';\n\nimport { options } from './ToolTypes';\n\nexport default function useToolsFunctions(dispatch, alert) {\n  const [isRealSpectrumShown, setIsRealSpectrumShown] = useState(false);\n  const [isStacked, activateStackView] = useState(false);\n\n  const debounceClickEventsRef = useRef({ clicks: [] });\n  const handleChangeOption = useCallback(\n    (selectedTool) => {\n      if (\n        [\n          options.peakPicking.id,\n          options.integral.id,\n          options.zone2D.id,\n        ].includes(selectedTool)\n      ) {\n        alert.show(\n          'Press Shift + Left Mouse button to select zone for integral and peak picking',\n        );\n      }\n      dispatch({ type: SET_SELECTED_TOOL, selectedTool });\n    },\n    [alert, dispatch],\n  );\n\n  const handleFullZoomOut = useCallback(() => {\n    if (debounceClickEventsRef.current.clicks.length === 0) {\n      dispatch({\n        type: FULL_ZOOM_OUT,\n        zoomType: ZoomType.HORIZONTAL,\n      });\n    }\n    const callback = lodashDebounce(() => {\n      debounceClickEventsRef.current.clicks = [];\n    }, 500);\n    debounceClickEventsRef.current.clicks.push(callback);\n\n    callback();\n\n    if (debounceClickEventsRef.current.clicks.length > 1) {\n      lodashMap(debounceClickEventsRef.current.clicks, (debounce) =>\n        debounce.cancel(),\n      );\n      debounceClickEventsRef.current.clicks = [];\n      dispatch({\n        type: FULL_ZOOM_OUT,\n      });\n    }\n  }, [dispatch, debounceClickEventsRef]);\n\n  const saveToClipboardHandler = useCallback(() => {\n    dispatch({ type: EXPORT_DATA, exportType: 'copy' });\n    alert.show('Spectrum copied to clipboard');\n  }, [alert, dispatch]);\n\n  const saveAsJSONHandler = useCallback(\n    (spaceIndent = 0) => {\n      dispatch({\n        type: EXPORT_DATA,\n        exportType: 'json',\n        spaceIndent: spaceIndent,\n      });\n    },\n    [dispatch],\n  );\n\n  const saveAsNMREHandler = useCallback(() => {\n    dispatch({\n      type: EXPORT_DATA,\n      exportType: 'nmre',\n    });\n  }, [dispatch]);\n\n  const saveAsSVGHandler = useCallback(() => {\n    dispatch({\n      type: EXPORT_DATA,\n      exportType: 'svg',\n    });\n  }, [dispatch]);\n\n  const saveAsPNGHandler = useCallback(\n    () => dispatch({ type: EXPORT_DATA, exportType: 'png' }),\n    [dispatch],\n  );\n\n  const handleChangeDisplayViewMode = useCallback(() => {\n    const flag = !isStacked;\n    activateStackView(flag);\n    dispatch({\n      type: CHANGE_SPECTRUM_DISPLAY_VIEW_MODE,\n      flag: flag,\n    });\n  }, [dispatch, isStacked]);\n\n  const changeSpectrumViewHandler = useCallback(() => {\n    dispatch({\n      type: TOGGLE_REAL_IMAGINARY_VISIBILITY,\n      isRealSpectrumVisible: !isRealSpectrumShown,\n    });\n    setIsRealSpectrumShown(!isRealSpectrumShown);\n  }, [dispatch, isRealSpectrumShown]);\n\n  const alignSpectrumsVerticallyHandler = useCallback(() => {\n    dispatch({\n      type: SET_SPECTRUMS_VERTICAL_ALIGN,\n    });\n  }, [dispatch]);\n\n  return {\n    handleChangeOption,\n    handleFullZoomOut,\n    saveToClipboardHandler,\n    saveAsJSONHandler,\n    saveAsNMREHandler,\n    saveAsSVGHandler,\n    saveAsPNGHandler,\n    handleChangeDisplayViewMode,\n    changeSpectrumViewHandler,\n    alignSpectrumsVerticallyHandler,\n    isRealSpectrumShown,\n    isStacked,\n  };\n}\n","import { useCallback, useEffect, useMemo } from 'react';\n\nimport checkModifierKeyActivated from '../../data/utilities/checkModifierKeyActivated';\nimport { useAssignmentData } from '../assignment';\nimport { useChartData } from '../context/ChartContext';\nimport { useDispatch } from '../context/DispatchContext';\nimport { useAlert } from '../elements/popup/Alert';\nimport { TYPES, useHighlightData } from '../highlight/index';\nimport { DISPLAYER_MODE } from '../reducer/core/Constants';\nimport {\n  SET_KEY_PREFERENCES,\n  APPLY_KEY_PREFERENCES,\n  DELETE_INTEGRAL,\n  DELETE_PEAK_NOTATION,\n  DELETE_RANGE,\n  DELETE_2D_ZONE,\n} from '../reducer/types/Types';\nimport { options } from '../toolbar/ToolTypes';\nimport useToolsFunctions from '../toolbar/useToolsFunctions';\n\nfunction KeysListenerTracker() {\n  const {\n    keysPreferences,\n    displayerMode,\n    overDisplayer,\n    data,\n  } = useChartData();\n  const dispatch = useDispatch();\n  const alert = useAlert();\n  const {\n    handleChangeOption,\n    handleFullZoomOut,\n    alignSpectrumsVerticallyHandler,\n    handleChangeDisplayViewMode,\n    saveToClipboardHandler,\n    saveAsJSONHandler,\n  } = useToolsFunctions(dispatch, alert);\n\n  const { highlight } = useHighlightData();\n  const assignmentData = useAssignmentData();\n\n  const allow1DTool = useMemo(() => {\n    return displayerMode === DISPLAYER_MODE.DM_1D && data && data.length > 0;\n  }, [data, displayerMode]);\n\n  const allow2DTool = useMemo(() => {\n    return displayerMode === DISPLAYER_MODE.DM_2D && data && data.length > 0;\n  }, [data, displayerMode]);\n\n  const deleteHandler = useCallback(\n    (type, data) => {\n      switch (type) {\n        case TYPES.INTEGRAL: {\n          dispatch({\n            type: DELETE_INTEGRAL,\n            integralID: data.activeKey,\n          });\n          break;\n        }\n        case TYPES.PEAK: {\n          dispatch({\n            type: DELETE_PEAK_NOTATION,\n            data: { id: data.activeKey },\n          });\n          break;\n        }\n        case TYPES.RANGE: {\n          dispatch({\n            type: DELETE_RANGE,\n            payload: {\n              id: data.activeKey,\n              assignmentData,\n            },\n          });\n          break;\n        }\n        case TYPES.ZONE: {\n          dispatch({\n            type: DELETE_2D_ZONE,\n            payload: {\n              id: data.activeKey,\n              assignmentData,\n            },\n          });\n          break;\n        }\n        default:\n          break;\n      }\n    },\n    [assignmentData, dispatch],\n  );\n\n  const keysPreferencesListenerHandler = useCallback(\n    (e, num) => {\n      if (data && data.length > 0 && num >= 1 && num <= 9) {\n        if (e.shiftKey) {\n          dispatch({\n            type: SET_KEY_PREFERENCES,\n            keyCode: num,\n          });\n          alert.show(`Configuration Reset, press '${num}' again to reload it.`);\n        } else {\n          if (!checkModifierKeyActivated(e)) {\n            if (keysPreferences && keysPreferences[num]) {\n              dispatch({\n                type: APPLY_KEY_PREFERENCES,\n                keyCode: num,\n              });\n            } else {\n              dispatch({\n                type: SET_KEY_PREFERENCES,\n                keyCode: num,\n              });\n              alert.show(\n                `Configuration saved, press '${num}' again to reload it.`,\n              );\n            }\n          }\n        }\n      }\n    },\n    [alert, data, dispatch, keysPreferences],\n  );\n\n  const toolsListenerHandler = useCallback(\n    (e) => {\n      if (!e.shiftKey && !e.metaKey) {\n        switch (e.key) {\n          case 'f':\n            handleFullZoomOut();\n            break;\n          case 'z':\n          case 'Escape':\n            handleChangeOption(options.zoom.id);\n            break;\n          case 'r': {\n            if (allow1DTool) {\n              handleChangeOption(options.rangesPicking.id);\n            }\n            break;\n          }\n          case 'b': {\n            if (allow1DTool) {\n              handleChangeOption(options.baseLineCorrection.id);\n            }\n            break;\n          }\n          case 'p': {\n            if (allow1DTool) {\n              handleChangeOption(options.peakPicking.id);\n            }\n            break;\n          }\n          case 'i': {\n            const toolID = allow2DTool\n              ? options.zone2D.id\n              : allow1DTool\n              ? options.integral.id\n              : '';\n            handleChangeOption(toolID);\n            break;\n          }\n          case 'a': {\n            if (allow1DTool) {\n              handleChangeOption(options.phaseCorrection.id);\n            }\n            break;\n          }\n          default:\n        }\n      }\n\n      if (!e.shiftKey && !e.metaKey && !e.ctrlKey) {\n        switch (e.key) {\n          case 'c': {\n            if (allow1DTool) {\n              alignSpectrumsVerticallyHandler();\n            }\n            break;\n          }\n          case 's': {\n            if (allow1DTool) {\n              handleChangeDisplayViewMode();\n            }\n            break;\n          }\n          default:\n        }\n      }\n\n      if (!e.shiftKey && (e.metaKey || e.ctrlKey)) {\n        switch (e.key) {\n          case 'c':\n            saveToClipboardHandler();\n            e.preventDefault();\n            break;\n          case 's':\n            saveAsJSONHandler();\n            e.preventDefault();\n            break;\n          default:\n        }\n      }\n      if (e.shiftKey && (e.metaKey || e.ctrlKey)) {\n        switch (e.key) {\n          case 'S':\n            saveAsJSONHandler(2);\n            e.preventDefault();\n            break;\n          default:\n        }\n      }\n    },\n    [\n      alignSpectrumsVerticallyHandler,\n      allow1DTool,\n      allow2DTool,\n      handleChangeDisplayViewMode,\n      handleChangeOption,\n      handleFullZoomOut,\n      saveAsJSONHandler,\n      saveToClipboardHandler,\n    ],\n  );\n\n  const handleOnKeyDown = useCallback(\n    (e) => {\n      const {\n        highlighted: [activeKey],\n        type,\n      } = highlight;\n\n      if (\n        !['input', 'textarea'].includes(e.target.localName) &&\n        overDisplayer\n      ) {\n        const num = Number(e.code.substr(e.code.length - 1)) || 0;\n        if (num > 0) {\n          keysPreferencesListenerHandler(e, num);\n        } else {\n          if ([('Escape', 'Esc', 'Backspace')].includes(e.key) && type) {\n            deleteHandler(type, { activeKey });\n          } else {\n            toolsListenerHandler(e);\n          }\n        }\n      }\n    },\n    [\n      deleteHandler,\n      highlight,\n      keysPreferencesListenerHandler,\n      overDisplayer,\n      toolsListenerHandler,\n    ],\n  );\n\n  useEffect(() => {\n    document.addEventListener('keydown', handleOnKeyDown, true);\n\n    return () => document.removeEventListener('keydown', handleOnKeyDown, true);\n  }, [handleOnKeyDown]);\n\n  return null;\n}\n\nexport default KeysListenerTracker;\n","let baseURL = '';\n\nexport function setBaseUrl(newBaseUrl) {\n  baseURL = newBaseUrl;\n}\n\nfunction getHelpList() {\n  return {\n    zoomIn: {\n      text: 'Zoom Tool',\n      filePath: `${baseURL}/1d/zoom/zoomIn.html`,\n    },\n    peakPicking: {\n      text: 'peak picking tool',\n      filePath: `${baseURL}/1d/peak/peakPicking.html`,\n    },\n    integralPicking: {\n      text: 'integral tool',\n      filePath: `${baseURL}/1d/integral/integration.html`,\n    },\n    fullScreen: {\n      text: 'Full Screen mode',\n      filePath: `${baseURL}/1d/general/fullScreen.html`,\n    },\n    loadSpectrum: {\n      text: 'load spectrums',\n      filePath: `${baseURL}/1d/load/loadSpectrum.html`,\n    },\n  };\n}\nexport default getHelpList;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\n\nimport getHelpData from '../constants/help';\nimport CloseButton from '../elements/CloseButton';\n\nconst styles = css`\n  width: 100%;\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  .manual-header {\n    .title {\n      text-align: center;\n      padding: 10px 0 10px 0px;\n      margin: 0px;\n      color: #000000;\n      place-items: normal;\n      text-transform: none;\n      background-color: #fafafa;\n    }\n\n    .close-bt {\n      border: none;\n      color: red;\n      background-color: transparent;\n      outline: none;\n      position: absolute;\n      right: 15px;\n      top: 10px;\n    }\n  }\n  .main-content {\n    width: 100%;\n    height: 100%;\n    border: none;\n    padding-left: 5px;\n  }\n\n  .inner-container {\n    padding: 5px;\n    width: 100%;\n    height: 100%;\n  }\n\n  .tab-content {\n    width: 100%;\n  }\n`;\n\nfunction UserManualModal({ onClose }) {\n  const filePath = getHelpData().loadSpectrum.filePath;\n\n  return (\n    <div css={styles}>\n      <div className=\"manual-header handle\">\n        <h6 className=\"title\">User Manual</h6>\n        <CloseButton onClick={onClose} className=\"close-bt\" />\n      </div>\n      <div className=\"main-content\">\n        <div className=\"inner-container\">\n          <iframe\n            title=\"General User Manual \"\n            src={filePath}\n            frameBorder=\"0\"\n            scrolling=\"auto\"\n            style={{ width: '100%', height: '100%' }}\n          />\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default UserManualModal;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { FaTimes } from 'react-icons/fa';\n\nconst styles = css`\n  border-radius: 50%;\n  width: 16px;\n  height: 16px;\n  background-color: transparent;\n  border: none;\n  padding: 0;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n\n  :hover {\n    background-color: red;\n    border-radius: 50%;\n\n    .icon {\n      color: white;\n    }\n  }\n\n  .icon {\n    color: #252525;\n    width: 8px;\n  }\n`;\n\nfunction DeleteButton({ onDelete, className = 'delete' }) {\n  return (\n    <button css={styles} className={className} type=\"button\" onClick={onDelete}>\n      <FaTimes className=\"icon\" />\n    </button>\n  );\n}\n\nexport default DeleteButton;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport PropTypes from 'prop-types';\nimport { memo, useCallback } from 'react';\n\nimport DeleteButton from './DeleteButton';\n\nconst styles = (styles) => css`\n  position: relative;\n\n  .delete {\n    position: absolute;\n    top: 2px;\n    left: 2px;\n  }\n\n  ${styles}\n`;\n\nfunction Tab({\n  tabid,\n  tablabel,\n  activeTab,\n  onClick,\n  canDelete,\n  onDelete,\n  tabstyles,\n}) {\n  let className = 'tab-list-item';\n\n  // use tab identifier if given (higher priority)\n  if (activeTab === tabid) {\n    className += ' tab-list-active';\n  }\n\n  const clickHandler = useCallback(\n    (e) => {\n      onClick({ ...e, tablabel, tabid });\n    },\n    [onClick, tablabel, tabid],\n  );\n  const deleteHandler = useCallback(\n    (e) => {\n      // stop propagation here to not have set it\n      // as active tab too (via tab click event triggering)\n      e.stopPropagation();\n      onDelete({ ...e, tablabel, tabid });\n    },\n    [onDelete, tablabel, tabid],\n  );\n  return (\n    <li className={className} onClick={clickHandler} css={styles(tabstyles)}>\n      {canDelete && <DeleteButton onDelete={deleteHandler} />}\n      {tablabel}\n    </li>\n  );\n}\n\nTab.propTypes = {\n  activeTab: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n  tablabel: PropTypes.string.isRequired,\n  onClick: PropTypes.func.isRequired,\n  tabid: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n  canDelete: PropTypes.bool,\n};\n\nexport default memo(Tab);\n","export const positions = {\n  TOP: 'TOP',\n  LEFT: 'LEFT',\n};\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport PropTypes from 'prop-types';\nimport {\n  useState,\n  useCallback,\n  useEffect,\n  useMemo,\n  Children,\n  cloneElement,\n  memo,\n} from 'react';\n\nimport Tab from './Tab';\nimport { positions } from './options';\n\nconst topStyles = css`\n  height: 100%;\n  width: 100%;\n  display: flex;\n  flex-direction: column;\n\n  .tab-list {\n    border-bottom: 1px solid #ccc;\n    padding-left: 0;\n    margin: 0;\n  }\n\n  .tab-list li:first-of-type {\n    margin-left: 5px;\n  }\n\n  .tab-list li:hover {\n    background-color: #f7f7f7;\n  }\n\n  .tab-list-item {\n    display: inline-block;\n    list-style: none;\n    margin-bottom: -1px;\n    padding: 0.5rem 2rem;\n  }\n\n  .tab-list-active {\n    background-color: white;\n    border: solid #ccc;\n    border-width: 1px 1px 0 1px;\n  }\n\n  .tab-content {\n    height: 100%;\n    overflow: auto;\n  }\n`;\n\nconst leftStyles = css`\n  display: flex;\n  height: 100%;\n  width: 100%;\n  .tab-list {\n    border-right: 1px solid #ccc;\n    padding-left: 0;\n    margin: 0;\n  }\n\n  .tab-list li:hover {\n    background-color: #f7f7f7;\n  }\n\n  .tab-list li:first-of-type {\n    margin-top: 10px;\n  }\n\n  .tab-list-item {\n    display: block;\n    list-style: none;\n    margin-right: -1px;\n    padding: 0.5rem 0.75rem;\n  }\n\n  .tab-list-active {\n    background-color: white;\n    border: solid #ccc;\n    border-width: 1px 0px 1px 1px;\n  }\n\n  .tab-content {\n    height: 100%;\n    overflow: auto;\n  }\n`;\n\nfunction Tabs({\n  children,\n  onClick,\n  defaultTabID,\n  position,\n  canDelete,\n  onDelete,\n}) {\n  const [activeTab, setActiveTab] = useState();\n\n  useEffect(() => {\n    setActiveTab(defaultTabID);\n  }, [defaultTabID]);\n\n  const onClickTabHandler = useCallback(\n    (tab) => {\n      const { tablabel, tabid } = tab;\n      onClick({ tablabel, tabid });\n      // use tab identifier if given (higher priority)\n      setActiveTab(tabid);\n    },\n    [onClick],\n  );\n\n  const tabs = useMemo(() => {\n    return Children.map(children, (child) => {\n      const { tablabel, tabid, candelete, tabstyles } = child.props;\n      const deleteFlag = candelete\n        ? candelete.toLowerCase() === 'true'\n        : canDelete;\n      return (\n        <Tab\n          activeTab={activeTab}\n          key={tabid}\n          tablabel={tablabel}\n          onClick={onClickTabHandler}\n          tabid={tabid}\n          canDelete={deleteFlag}\n          onDelete={onDelete}\n          tabstyles={tabstyles}\n        />\n      );\n    });\n  }, [activeTab, canDelete, children, onClickTabHandler, onDelete]);\n\n  const tabsContent = useMemo(() => {\n    return Children.map(children, (child) => {\n      const { tabid, style } = child.props;\n      if (tabid !== activeTab) {\n        return cloneElement(child, { style: { display: 'none' } });\n      }\n      return cloneElement(child, {\n        style: { display: 'block', ...style },\n      });\n    });\n  }, [activeTab, children]);\n\n  const styles = useMemo(() => {\n    switch (position) {\n      case positions.TOP:\n        return topStyles;\n      case positions.LEFT:\n        return leftStyles;\n      default:\n        return topStyles;\n    }\n  }, [position]);\n\n  return (\n    <div className=\"tabs\" css={styles}>\n      <ol className=\"tab-list\">{tabs}</ol>\n      <div className=\"tab-content\">{tabsContent}</div>\n    </div>\n  );\n}\n\nTabs.defaultProps = {\n  onClick: () => null,\n  onDelete: () => null,\n  position: 'TOP',\n  canDelete: false,\n};\n\nTabs.propTypes = {\n  children: PropTypes.array.isRequired,\n  onClick: PropTypes.func,\n  position: PropTypes.oneOf(['TOP', 'LEFT']),\n  canDelete: PropTypes.bool,\n  onDelete: PropTypes.func,\n};\n\nexport default memo(Tabs);\n","import { Formik } from 'formik';\nimport PropTypes from 'prop-types';\nimport { forwardRef } from 'react';\n\nconst FormikForm = forwardRef(function FormikForm(\n  { initialValues, onSubmit, validationSchema, children },\n  ref,\n) {\n  return (\n    <Formik\n      innerRef={ref}\n      initialValues={initialValues}\n      onSubmit={onSubmit}\n      validationSchema={validationSchema}\n    >\n      {() => <>{children}</>}\n    </Formik>\n  );\n});\n\nFormikForm.defaultProps = {\n  initialValues: {},\n  onSubmit: () => null,\n  validationSchema: null,\n};\nFormikForm.propTypes = {\n  initialValues: PropTypes.object,\n  onSubmit: PropTypes.func,\n  validationSchema: PropTypes.object,\n};\n\nexport default FormikForm;\n","import { produce } from 'immer';\nimport lodashMerge from 'lodash/merge';\n\nimport {\n  getLocalStorage,\n  removeData,\n  storeData,\n} from '../utility/LocalStorage';\n\nexport const INIT_PREFERENCES = 'INIT_PREFERENCES';\nexport const SET_PREFERENCES = 'SET_PREFERENCES';\nexport const SET_PANELS_PREFERENCES = 'SET_PANELS_PREFERENCES';\nconst LOCAL_STORGAE_VERSION = '1';\nexport const preferencesInitialState = {\n  basePreferences: {},\n  display: {\n    general: {\n      disableMultipletAnalysis: false,\n      hideSetSumFromMolecule: false,\n    },\n\n    panels: {\n      hideSpectraPanel: false,\n      hideInformationPanel: false,\n      hidePeaksPanel: false,\n      hideIntegralsPanel: false,\n      hideRangesPanel: false,\n      hideStructuresPanel: false,\n      hideFiltersPanel: false,\n      hideZonesPanel: false,\n      hideSummaryPanel: false,\n      hideMultipleSpectraAnalysisPanel: false,\n    },\n\n    toolBarButtons: {\n      hideZoomTool: false,\n      hideZoomOutTool: false,\n      hideImport: false,\n      hideExportAs: false,\n      hideSpectraStackAlignments: false,\n      hideSpectraCenterAlignments: false,\n      hideRealImaginary: false,\n      hidePeakTool: false,\n      hideIntegralTool: false,\n      hideAutoRangesTool: false,\n      hideZeroFillingTool: false,\n      hidePhaseCorrectionTool: false,\n      hideBaseLineCorrectionTool: false,\n      hideFFTTool: false,\n      hideMultipleSpectraAnalysisTool: false,\n    },\n  },\n  controllers: {\n    mws: { low: 2, high: 20 },\n    help: {\n      preventAutoHelp: true,\n    },\n    dimmedSpectraTransparency: 0.1,\n  },\n  formatting: {\n    nucleus: [\n      { key: '1H', name: '1H', ppm: '0.00', hz: '0.00' },\n      { key: '13C', name: '13C', ppm: '0.00', hz: '0.00' },\n      { key: '15N', name: '15N', ppm: '0.00', hz: '0.00' },\n      { key: '19F', name: '19F', ppm: '0.00', hz: '0.00' },\n      { key: '29Si', name: '29Si', ppm: '0.00', hz: '0.00' },\n      { key: '31P', name: '31P', ppm: '0.00', hz: '0.00' },\n    ],\n    nucleusByKey: {},\n    panels: {},\n  },\n  dispatch: null,\n};\n\nconst mapNucleus = (draft) => {\n  if (draft.formatting.nucleus && Array.isArray(draft.formatting.nucleus)) {\n    draft.formatting.nucleusByKey = draft.formatting.nucleus.reduce(\n      (acc, item) => {\n        acc[item.name.toLowerCase()] = item;\n        return { ...acc };\n      },\n      {},\n    );\n  }\n};\n\nexport function preferencesReducer(state, action) {\n  switch (action.type) {\n    case INIT_PREFERENCES: {\n      const nmrLocalStorageVersion = getLocalStorage(\n        'nmr-local-storage-version',\n        false,\n      );\n      if (\n        !nmrLocalStorageVersion ||\n        nmrLocalStorageVersion !== LOCAL_STORGAE_VERSION\n      ) {\n        removeData('nmr-general-settings');\n        storeData('nmr-local-storage-version', LOCAL_STORGAE_VERSION);\n      }\n\n      const localData = getLocalStorage('nmr-general-settings');\n\n      return produce(state, (draft) => {\n        if (action.payload) {\n          const { dispatch, ...resPreferences } = action.payload;\n          draft.basePreferences = resPreferences;\n          draft.display = resPreferences.display;\n          draft.dispatch = dispatch;\n          if (localData) {\n            Object.entries(localData).forEach(([k, v]) => {\n              draft[k] = lodashMerge(\n                v,\n                resPreferences[k] ? resPreferences[k] : {},\n              );\n            });\n            mapNucleus(draft, state);\n          }\n        }\n      });\n    }\n    case SET_PREFERENCES:\n      return produce(state, (draft) => {\n        if (action.payload) {\n          const data = action.payload;\n          draft.controllers = data.controllers;\n          draft.formatting = data.formatting;\n          draft.display.panels = data.display.panels;\n          mapNucleus(draft, data);\n        }\n      });\n    case SET_PANELS_PREFERENCES:\n      return produce(state, (draft) => {\n        if (action.payload) {\n          const { key, value } = action.payload;\n          draft.formatting.panels[key] = value;\n        }\n      });\n    default:\n      return state;\n  }\n}\n","import React from 'react';\n\nfunction Logo({ size = 100 }) {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      viewBox=\"0 0 841.9 595.3\"\n      style={{ width: size, height: size }}\n    >\n      <g fill=\"#61DAFB\">\n        <path d=\"M666.3 296.5c0-32.5-40.7-63.3-103.1-82.4 14.4-63.6 8-114.2-20.2-130.4-6.5-3.8-14.1-5.6-22.4-5.6v22.3c4.6 0 8.3.9 11.4 2.6 13.6 7.8 19.5 37.5 14.9 75.7-1.1 9.4-2.9 19.3-5.1 29.4-19.6-4.8-41-8.5-63.5-10.9-13.5-18.5-27.5-35.3-41.6-50 32.6-30.3 63.2-46.9 84-46.9V78c-27.5 0-63.5 19.6-99.9 53.6-36.4-33.8-72.4-53.2-99.9-53.2v22.3c20.7 0 51.4 16.5 84 46.6-14 14.7-28 31.4-41.3 49.9-22.6 2.4-44 6.1-63.6 11-2.3-10-4-19.7-5.2-29-4.7-38.2 1.1-67.9 14.6-75.8 3-1.8 6.9-2.6 11.5-2.6V78.5c-8.4 0-16 1.8-22.6 5.6-28.1 16.2-34.4 66.7-19.9 130.1-62.2 19.2-102.7 49.9-102.7 82.3 0 32.5 40.7 63.3 103.1 82.4-14.4 63.6-8 114.2 20.2 130.4 6.5 3.8 14.1 5.6 22.5 5.6 27.5 0 63.5-19.6 99.9-53.6 36.4 33.8 72.4 53.2 99.9 53.2 8.4 0 16-1.8 22.6-5.6 28.1-16.2 34.4-66.7 19.9-130.1 62-19.1 102.5-49.9 102.5-82.3zm-130.2-66.7c-3.7 12.9-8.3 26.2-13.5 39.5-4.1-8-8.4-16-13.1-24-4.6-8-9.5-15.8-14.4-23.4 14.2 2.1 27.9 4.7 41 7.9zm-45.8 106.5c-7.8 13.5-15.8 26.3-24.1 38.2-14.9 1.3-30 2-45.2 2-15.1 0-30.2-.7-45-1.9-8.3-11.9-16.4-24.6-24.2-38-7.6-13.1-14.5-26.4-20.8-39.8 6.2-13.4 13.2-26.8 20.7-39.9 7.8-13.5 15.8-26.3 24.1-38.2 14.9-1.3 30-2 45.2-2 15.1 0 30.2.7 45 1.9 8.3 11.9 16.4 24.6 24.2 38 7.6 13.1 14.5 26.4 20.8 39.8-6.3 13.4-13.2 26.8-20.7 39.9zm32.3-13c5.4 13.4 10 26.8 13.8 39.8-13.1 3.2-26.9 5.9-41.2 8 4.9-7.7 9.8-15.6 14.4-23.7 4.6-8 8.9-16.1 13-24.1zM421.2 430c-9.3-9.6-18.6-20.3-27.8-32 9 .4 18.2.7 27.5.7 9.4 0 18.7-.2 27.8-.7-9 11.7-18.3 22.4-27.5 32zm-74.4-58.9c-14.2-2.1-27.9-4.7-41-7.9 3.7-12.9 8.3-26.2 13.5-39.5 4.1 8 8.4 16 13.1 24 4.7 8 9.5 15.8 14.4 23.4zM420.7 163c9.3 9.6 18.6 20.3 27.8 32-9-.4-18.2-.7-27.5-.7-9.4 0-18.7.2-27.8.7 9-11.7 18.3-22.4 27.5-32zm-74 58.9c-4.9 7.7-9.8 15.6-14.4 23.7-4.6 8-8.9 16-13 24-5.4-13.4-10-26.8-13.8-39.8 13.1-3.1 26.9-5.8 41.2-7.9zm-90.5 125.2c-35.4-15.1-58.3-34.9-58.3-50.6 0-15.7 22.9-35.6 58.3-50.6 8.6-3.7 18-7 27.7-10.1 5.7 19.6 13.2 40 22.5 60.9-9.2 20.8-16.6 41.1-22.2 60.6-9.9-3.1-19.3-6.5-28-10.2zM310 490c-13.6-7.8-19.5-37.5-14.9-75.7 1.1-9.4 2.9-19.3 5.1-29.4 19.6 4.8 41 8.5 63.5 10.9 13.5 18.5 27.5 35.3 41.6 50-32.6 30.3-63.2 46.9-84 46.9-4.5-.1-8.3-1-11.3-2.7zm237.2-76.2c4.7 38.2-1.1 67.9-14.6 75.8-3 1.8-6.9 2.6-11.5 2.6-20.7 0-51.4-16.5-84-46.6 14-14.7 28-31.4 41.3-49.9 22.6-2.4 44-6.1 63.6-11 2.3 10.1 4.1 19.8 5.2 29.1zm38.5-66.7c-8.6 3.7-18 7-27.7 10.1-5.7-19.6-13.2-40-22.5-60.9 9.2-20.8 16.6-41.1 22.2-60.6 9.9 3.1 19.3 6.5 28.1 10.2 35.4 15.1 58.3 34.9 58.3 50.6-.1 15.7-23 35.6-58.4 50.6zM320.8 78.4z\" />\n        <path d=\"M520.5 78.1z\" />\n      </g>\n    </svg>\n  );\n}\n\nexport default Logo;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useEffect, useState } from 'react';\n\nimport Logo from '../../elements/Logo';\n\nasync function getData(url) {\n  try {\n    const response = await fetch(url);\n    return response.json();\n  } catch (e) {\n    return null;\n  }\n}\n\nconst baseUrl = 'https://api.github.com/repos/cheminfo/nmrium';\n\nconst styles = css`\n  width: 100%;\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  padding-top: 20px;\n\n  span {\n    font-weight: bold;\n    color: #636363;\n  }\n\n  img {\n    width: 100px;\n  }\n\n  a {\n    color: #969696;\n  }\n\n  a:hover,\n  a:focus {\n    color: #00bcd4;\n  }\n\n  .separator {\n    border-bottom: 1px solid gray;\n    width: 15px;\n    height: 1px;\n    margin: 10px 0px;\n  }\n`;\n\nfunction AboutTabContent() {\n  const [info, setInfo] = useState();\n  useEffect(() => {\n    Promise.all([\n      getData(`${baseUrl}/commits`),\n      getData(`${baseUrl}/tags`),\n    ]).then((data) => {\n      setInfo(data);\n    });\n  }, []);\n\n  return info ? (\n    <div css={styles}>\n      <Logo />\n      <span>NMRium</span>\n      <span> {info[1][0].name}</span>\n\n      <span className=\"separator\" />\n\n      <a href={info[1][0].zipball_url} target=\"_blank\" rel=\"noreferrer\">\n        Download Last Version {info[1][0].name}\n      </a>\n      <span className=\"separator\" />\n\n      <a href={info[0][0].html_url} target=\"_blank\" rel=\"noreferrer\">\n        Last Commit {new Date(info[0][0].commit.author.date).toUTCString()} [\n        {info[0][0].sha.substr(0, 12)} ]\n      </a>\n    </div>\n  ) : null;\n}\n\nexport default AboutTabContent;\n","import { useState, useCallback, forwardRef } from 'react';\n\nconst CheckBox = forwardRef(function CheckBox(\n  { name = '', checked: checkProps, onChange = () => null, disabled },\n  ref,\n) {\n  const [checked, setCheck] = useState(checkProps);\n\n  const handleCheck = useCallback(\n    (e) => {\n      const _checked = !checked;\n      setCheck(_checked);\n      onChange(e);\n    },\n    [checked, onChange],\n  );\n\n  return (\n    <input\n      ref={ref}\n      type=\"checkbox\"\n      name={name}\n      id={name}\n      onChange={handleCheck}\n      defaultChecked={checkProps}\n      disabled={disabled}\n    />\n  );\n});\n\nCheckBox.defaultProps = {\n  onChange: function () {\n    return null;\n  },\n  name: '',\n  disabled: false,\n};\n\nexport default CheckBox;\n","import { useFormikContext } from 'formik';\nimport lodashGet from 'lodash/get';\nimport PropTypes from 'prop-types';\nimport { useCallback } from 'react';\n\nimport CheckBox from '../CheckBox';\n\nfunction FormikCheckBox({\n  label,\n  name,\n  onChange,\n  className,\n  reverse,\n  ...resProps\n}) {\n  const { values, setFieldValue } = useFormikContext();\n  const value = reverse ? !lodashGet(values, name) : lodashGet(values, name);\n\n  const changeHandler = useCallback(\n    (e) => {\n      e.persist();\n      onChange(e);\n      setFieldValue(name, reverse ? value : !value);\n    },\n    [name, onChange, reverse, setFieldValue, value],\n  );\n  return (\n    <div className={`${className} check-${value}`}>\n      <label htmlFor={name} className=\"checkbox-lable\">\n        {label}\n      </label>\n      <CheckBox\n        id={name}\n        name={name}\n        checked={value}\n        onChange={changeHandler}\n        className=\"checkbox\"\n        {...resProps}\n      />\n    </div>\n  );\n}\n\nFormikCheckBox.propTypes = {\n  label: PropTypes.string,\n  name: PropTypes.string,\n  className: PropTypes.string,\n  onChange: PropTypes.func,\n  reverse: PropTypes.bool,\n};\n\nFormikCheckBox.defaultProps = {\n  className: '',\n  onChange: () => null,\n  reverse: false,\n};\n\nexport default FormikCheckBox;\n","import PropTypes from 'prop-types';\nimport { forwardRef, useState, useEffect, useCallback } from 'react';\n\nconst styles = {\n  label: {\n    lineHeight: 2,\n    userSelect: 'none',\n  },\n  input: {\n    height: '100%',\n    width: '100px',\n    borderRadius: '5px',\n    border: '0.55px solid #c7c7c7',\n    margin: '0px 5px 0px 5px',\n    textAlign: 'center',\n  },\n};\n\nconst Input = forwardRef(function Input(\n  {\n    label,\n    value,\n    name,\n    style,\n    onChange,\n    onKeyDown,\n    checkValue,\n    type,\n    enableAutoSelect,\n    className,\n    format,\n    ...prop\n  },\n  ref,\n) {\n  const [val, setVal] = useState(value);\n  useEffect(() => {\n    setVal(value);\n  }, [value]);\n\n  useEffect(() => {\n    if (enableAutoSelect) {\n      ref.current.select();\n    }\n  }, [enableAutoSelect, ref]);\n\n  const getValue = useCallback(\n    (value) => {\n      const formatValue = format();\n      return formatValue(\n        type === 'number'\n          ? String(value).trim() === '-'\n            ? Number(0)\n            : Number(value)\n          : value,\n      );\n    },\n    [format, type],\n  );\n\n  const onChangeHandler = useCallback(\n    (e) => {\n      e.persist();\n      e.stopPropagation();\n      e.preventDefault();\n      function check(value) {\n        if (type === 'number') {\n          const pattern = /^(?:-?[0-9]*|[0-9]\\d*)(?:\\.\\d{0,20})?$/;\n          if (value.trim() === '' || pattern.test(value)) {\n            return true;\n          }\n          return false;\n        }\n        return true;\n      }\n      const _value = e.target.value;\n      if (check(_value) && checkValue(_value)) {\n        const formatValue = format();\n\n        setVal(formatValue(_value));\n        onChange({\n          ...e,\n          target: { name: e.target.name, value: getValue(_value) },\n        });\n      }\n    },\n    [checkValue, format, getValue, onChange, type],\n  );\n\n  const handleKeyDown = useCallback(\n    (event) => {\n      event.persist();\n      onKeyDown({\n        ...event,\n        target: { name: event.target.name, value: getValue(val) },\n      });\n    },\n    [getValue, onKeyDown, val],\n  );\n  const preventPropagate = useCallback((event) => {\n    event.stopPropagation();\n  }, []);\n\n  return (\n    <div\n      style={{\n        display: 'flex',\n        flexDirection: 'row',\n        alignItems: 'center',\n        ...(style && style.container ? style.container : {}),\n      }}\n    >\n      {label && (\n        <span\n          style={{\n            ...styles.label,\n            ...(style && style.label ? style.label : {}),\n          }}\n          className=\"label\"\n        >\n          {label}\n        </span>\n      )}\n      <input\n        {...prop}\n        ref={ref}\n        name={name}\n        style={{\n          ...styles.input,\n          ...(style && style.input ? style.input : {}),\n        }}\n        type=\"text\"\n        value={val}\n        onChange={onChangeHandler}\n        onKeyDown={handleKeyDown}\n        onKeyPress={preventPropagate}\n        onDoubleClick={(e) => e.stopPropagation()}\n        className={`input ${className}`}\n      />\n    </div>\n  );\n});\n\nInput.propTypes = {\n  label: PropTypes.string,\n  name: PropTypes.string,\n  value: PropTypes.any,\n  style: PropTypes.shape({\n    label: PropTypes.object,\n    input: PropTypes.object,\n    container: PropTypes.object,\n  }),\n  onChange: PropTypes.func,\n  checkValue: PropTypes.func,\n  onKeyDown: PropTypes.func,\n  className: PropTypes.string,\n  format: PropTypes.func,\n  type: PropTypes.oneOf(['text', 'number']),\n  enableAutoSelect: PropTypes.bool,\n};\n\nInput.defaultProps = {\n  style: {\n    label: {},\n    input: {},\n    container: {},\n  },\n  value: '',\n  onChange: () => {\n    return null;\n  },\n  checkValue: () => true,\n  onKeyDown: () => null,\n  type: 'text',\n  className: '',\n  enableAutoSelect: false,\n  format: () => (val) => val,\n};\n\nexport default Input;\n","import { useFormikContext } from 'formik';\nimport lodashGet from 'lodash/get';\nimport PropTypes from 'prop-types';\nimport { useCallback, useEffect, useMemo } from 'react';\n\nimport Input from '../Input';\n\nfunction FormikInput({\n  label,\n  name,\n  style,\n  onChange,\n  checkValue,\n  type,\n  className,\n  value,\n  format,\n  ...resProps\n}) {\n  const {\n    values,\n    handleChange,\n    setFieldValue,\n    errors,\n    touched,\n  } = useFormikContext();\n  const changeHandler = useCallback(\n    (e) => {\n      onChange(e);\n      handleChange(e);\n    },\n    [handleChange, onChange],\n  );\n\n  useEffect(() => {\n    if (value) {\n      setFieldValue(name, value);\n    }\n  }, [name, setFieldValue, value]);\n\n  const isInvalid = useMemo(() => {\n    return lodashGet(errors, name) && lodashGet(touched, name);\n  }, [errors, name, touched]);\n  return (\n    <Input\n      label={label}\n      name={name}\n      value={value ? value : lodashGet(values, name)}\n      onChange={changeHandler}\n      type={type}\n      style={{ input: { ...style, ...(isInvalid && { borderColor: 'red' }) } }}\n      checkValue={checkValue}\n      className={className}\n      format={format}\n      {...resProps}\n    />\n  );\n}\n\nFormikInput.propTypes = {\n  label: PropTypes.string,\n  name: PropTypes.string,\n  style: PropTypes.shape({\n    label: PropTypes.object,\n    input: PropTypes.object,\n  }),\n  onChange: PropTypes.func,\n  checkValue: PropTypes.func,\n  type: PropTypes.oneOf(['text', 'number']),\n  className: PropTypes.string,\n  value: PropTypes.any,\n  format: PropTypes.func,\n};\n\nFormikInput.defaultProps = {\n  style: {\n    label: {},\n    input: {},\n  },\n  onChange: () => {\n    return null;\n  },\n  checkValue: () => true,\n  type: 'text',\n  className: '',\n  value: null,\n  format: () => (val) => val,\n};\n\nexport default FormikInput;\n","import FormikCheckBox from '../../elements/formik/FormikCheckBox';\nimport FormikInput from '../../elements/formik/FormikInput';\n\nfunction ControllersTabContent() {\n  return (\n    <>\n      <p className=\"section-header\">Mouse Scroll Wheel Sensitivity</p>\n      <FormikInput type=\"number\" label=\"Low\" name=\"controllers.mws.low\" />\n      <FormikInput type=\"number\" label=\"high\" name=\"controllers.mws.high\" />\n      <p className=\"section-header\" style={{ marginTop: '40px' }}>\n        Show / Hide Panels\n      </p>\n      <FormikCheckBox\n        className=\"help-checkbox-element\"\n        label=\"Prevent automatic show help \"\n        name=\"controllers.help.preventAutoHelp\"\n      />\n\n      <p className=\"section-header\" style={{ marginTop: '40px' }}>\n        Spectra\n      </p>\n      <FormikInput\n        type=\"number\"\n        label=\"Transparency of Dimmed Spectra [ 0 - 1 ]\"\n        name=\"controllers.dimmedSpectraTransparency\"\n        checkValue={(value) => value >= 0 && value <= 1}\n      />\n    </>\n  );\n}\n\nexport default ControllersTabContent;\n","import lodashGet from 'lodash/get';\n\nimport FormikCheckBox from '../../elements/formik/FormikCheckBox';\n\nconst LIST = [\n  {\n    label: 'Spectra Panel',\n    name: 'display.panels.hideSpectraPanel',\n  },\n  {\n    label: 'Information Panel',\n    name: 'display.panels.hideInformationPanel',\n  },\n  {\n    label: 'Peaks Panel',\n    name: 'display.panels.hidePeaksPanel',\n  },\n  {\n    label: 'Integrals Panel',\n    name: 'display.panels.hideIntegralsPanel',\n  },\n  {\n    label: 'Ranges Panel',\n    name: 'display.panels.hideRangesPanel',\n  },\n  {\n    label: 'Structures Panel',\n    name: 'display.panels.hideStructuresPanel',\n  },\n  {\n    label: 'Filters Panel',\n    name: 'display.panels.hideFiltersPanel',\n  },\n  {\n    label: 'Zones Panel',\n    name: 'display.panels.hideZonesPanel',\n  },\n  {\n    label: 'Summary Panel',\n    name: 'display.panels.hideSummaryPanel',\n  },\n  {\n    label: 'Multiple Spectra Analysis Panel',\n    name: 'display.panels.hideMultipleSpectraAnalysisPanel',\n  },\n];\n\nfunction DisplayTabContent({ preferences }) {\n  return (\n    <>\n      <p className=\"section-header\">Show / Hide Panels</p>\n      {LIST.map(\n        (item) =>\n          !lodashGet(preferences, `basePreferences.${item.name}`, false) && (\n            <FormikCheckBox\n              key={item.name}\n              className=\"checkbox-element\"\n              label={item.label}\n              name={item.name}\n              reverse\n            />\n          ),\n      )}\n    </>\n  );\n}\n\nexport default DisplayTabContent;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useFormikContext } from 'formik';\nimport lodashGet from 'lodash/get';\nimport { Fragment, useCallback, useMemo } from 'react';\nimport { FaPlus } from 'react-icons/fa';\n\nimport generateID from '../../../data/utilities/generateID';\nimport CloseButton from '../../elements/CloseButton';\nimport FormikInput from '../../elements/formik/FormikInput';\n\nconst styles = css`\n  .counter-col {\n    width: 30px;\n  }\n  .nucleus-label-col {\n    display: flex;\n    justify-content: center;\n    width: 80px;\n  }\n\n  .width-100 {\n    width: 100% !important;\n    margin: 0px !important;\n  }\n\n  .nucleus-format-input-col {\n    text-align: center;\n    width: 100px;\n  }\n\n  th {\n    font-size: 11px;\n    font-weight: 600;\n  }\n  .operation-container {\n    display: flex;\n  }\n  .add {\n    background-color: transparent;\n    border: 0;\n    outline: none;\n    svg {\n      font-szie: 14px;\n      fill: green;\n    }\n  }\n`;\nfunction FormattingTabContent() {\n  const { values, setFieldValue } = useFormikContext();\n  const nucleuses = useMemo(() => lodashGet(values, 'formatting.nucleus', []), [\n    values,\n  ]);\n\n  const deleteHandler = useCallback(\n    (index) => {\n      const nucleusesObject = nucleuses.splice(0, index);\n      setFieldValue('formatting.nucleus', nucleusesObject);\n    },\n    [nucleuses, setFieldValue],\n  );\n\n  const addNewNucleusFormatHandler = useCallback(() => {\n    const newFormat = {\n      key: generateID(),\n      name: '',\n      ppm: '0.00',\n      hz: '0.00',\n    };\n    const newNucleuses = [...nucleuses, newFormat];\n    setFieldValue('formatting.nucleus', newNucleuses);\n  }, [nucleuses, setFieldValue]);\n\n  return (\n    <Fragment>\n      <p className=\"section-header\">Formating according to Nucleus</p>\n      <div css={styles}>\n        <table>\n          <thead>\n            <tr>\n              <th className=\"counter-col\">#</th>\n              <th className=\"nucleus-label-col\">Nucleus </th>\n              <th className=\"nucleus-format-input-col\"> (ppm)</th>\n              <th className=\"nucleus-format-input-col\">Coupling (Hz)</th>\n              <th className=\"nucleus-format-input-col\" />\n            </tr>\n          </thead>\n          <tbody>\n            {nucleuses &&\n              nucleuses.map((nucleus, index) => {\n                const num = index + 1;\n                return (\n                  <tr key={`${nucleus.key}`}>\n                    <td className=\"counter-col\">\n                      <span>{num} - </span>{' '}\n                    </td>\n                    <td className=\"nucleus-label-col\">\n                      <FormikInput\n                        name={`formatting.nucleus.${index}.name`}\n                        className=\"width-100\"\n                      />\n                    </td>\n                    <td className=\"nucleus-format-input-col\">\n                      <FormikInput\n                        name={`formatting.nucleus.${index}.ppm`}\n                        className=\"width-100\"\n                      />\n                    </td>\n                    <td className=\"nucleus-format-input-col\">\n                      <FormikInput\n                        name={`formatting.nucleus.${index}.hz`}\n                        className=\"width-100\"\n                      />\n                    </td>\n                    <td className=\"operation-container\">\n                      <CloseButton\n                        onClick={() => deleteHandler(index)}\n                        popupTitle={`remove ${nucleus.name}`}\n                        popupPlacement=\"right\"\n                      />\n                      {nucleuses.length === index + 1 && (\n                        <button\n                          className=\"add\"\n                          type=\"button\"\n                          onClick={addNewNucleusFormatHandler}\n                        >\n                          <FaPlus />\n                        </button>\n                      )}\n                    </td>\n                  </tr>\n                );\n              })}\n          </tbody>\n        </table>\n      </div>\n    </Fragment>\n  );\n}\n\nexport default FormattingTabContent;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback, useRef, useState } from 'react';\n\nimport { usePreferences } from '../../context/PreferencesContext';\nimport CloseButton from '../../elements/CloseButton';\nimport { Tabs } from '../../elements/Tab';\nimport FormikForm from '../../elements/formik/FormikForm';\nimport { SET_PREFERENCES } from '../../reducer/preferencesReducer';\nimport { useStateWithLocalStorage } from '../../utility/LocalStorage';\n\nimport AboutTabContent from './AboutTabContent';\nimport ControllersTabContent from './ControllersTabContent';\nimport DisplayTabContent from './DisplayTabContent';\nimport FormattingTabContent from './FormattingTabContent';\n\nconst styles = css`\n  overflow: auto;\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n\n  .header {\n    text-align: center;\n    padding: 10px 0 10px 0px;\n    margin: 0px;\n    color: #005d9e;\n    place-items: normal;\n    text-transform: none;\n    background-color: #fcfcfc;\n  }\n  .main-content {\n    width: 100%;\n    flex: 1;\n    overflow: auto;\n    border: none;\n  }\n\n  .tab-content {\n    width: 100%;\n  }\n\n  .inner-content {\n    padding: 15px 30px;\n    width: 100%;\n    overflow: auto;\n  }\n\n  button:focus {\n    outline: none;\n  }\n  button:hover {\n    color: #007bff;\n  }\n  .save-button:hover {\n    background-color: #ffffff;\n  }\n  .save-button {\n    border: none;\n    padding: 0 15px;\n    background-color: #ffffff5e;\n    border-radius: 5px;\n    height: 25px;\n  }\n\n  .footer-container {\n    display: flex;\n    align-items: flex-end;\n    justify-content: flex-end;\n    background: rgb(242, 242, 242);\n    background: -moz-linear-gradient(\n      0deg,\n      rgba(242, 242, 242, 1) 0%,\n      rgba(245, 245, 245, 1) 37%,\n      rgba(255, 255, 255, 1) 90%\n    );\n    background: -webkit-linear-gradient(\n      0deg,\n      rgba(242, 242, 242, 1) 0%,\n      rgba(245, 245, 245, 1) 37%,\n      rgba(255, 255, 255, 1) 90%\n    );\n    background: linear-gradient(\n      0deg,\n      rgba(242, 242, 242, 1) 0%,\n      rgba(245, 245, 245, 1) 37%,\n      rgba(255, 255, 255, 1) 90%\n    );\n    filter: progid:DXImageTransform.Microsoft.gradient(startColorstr=\"#f2f2f2\",endColorstr=\"#ffffff\",GradientType=1);\n    padding: 6px 15px;\n    height: 55px;\n  }\n\n  .section-header {\n    font-size: 13px;\n    color: #2ca8ff;\n    margin-bottom: 10px;\n    border-bottom: 0.55px solid #f9f9f9;\n    padding: 6px 2px;\n  }\n\n  .label {\n    font-size: 12px;\n    font-weight: bold;\n    margin-right: 10px;\n  }\n\n  .input {\n    font-size: 14px;\n    border-radius: 5px;\n    border: 1px solid #cccccc;\n    padding: 5px;\n    width: 100px;\n    margin-right: 10px;\n    height: initial !important;\n  }\n\n  .close-bt {\n    border: none;\n    color: red;\n    background-color: transparent;\n    outline: none;\n    position: absolute;\n    right: 10px;\n    top: 2px;\n    width: 30px;\n    height: 30px;\n  }\n\n  .checkbox-lable {\n    min-width: 300px;\n    display: inline-block;\n  }\n\n  .help-checkbox-element {\n    .checkbox-lable {\n      width: 260px;\n    }\n  }\n  .checkbox-element {\n    margin-bottom: 5px;\n  }\n`;\n\nfunction GeneralSettings({ onClose, onSave }) {\n  const [activeTab, setActiveTab] = useState('controllers');\n  const preferences = usePreferences();\n  const [, setSettingsData] = useStateWithLocalStorage('nmr-general-settings');\n  const refForm = useRef();\n\n  const handleSave = useCallback(() => {\n    refForm.current.submitForm();\n  }, []);\n\n  const submitHandler = useCallback(\n    (values) => {\n      // eslint-disable-next-line no-unused-vars\n      const { dispatch, basePreferences, ...resValues } = values;\n      setSettingsData(resValues);\n      preferences.dispatch({ type: SET_PREFERENCES, payload: values });\n      onSave();\n    },\n    [onSave, preferences, setSettingsData],\n  );\n\n  const tabChangeHandler = useCallback((tab) => {\n    setActiveTab(tab.tabid);\n  }, []);\n\n  return (\n    <div css={styles}>\n      <div className=\"header handle\">\n        <span>General Settings</span>\n        <CloseButton onClick={onClose} className=\"close-bt\" />\n      </div>\n      <div className=\"main-content\">\n        <FormikForm\n          ref={refForm}\n          initialValues={preferences}\n          onSubmit={submitHandler}\n        >\n          <Tabs\n            position=\"LEFT\"\n            defaultTabID={activeTab}\n            onClick={tabChangeHandler}\n          >\n            <div\n              className=\"inner-content\"\n              tablabel=\"Controllers\"\n              tabid=\"controllers\"\n            >\n              <ControllersTabContent />\n            </div>\n            <div\n              className=\"inner-content\"\n              tablabel=\"Formatting\"\n              tabid=\"formatting\"\n            >\n              <FormattingTabContent />\n            </div>\n            <div className=\"inner-content\" tablabel=\"Display\" tabid=\"display\">\n              <DisplayTabContent preferences={preferences} />\n            </div>\n            <div className=\"inner-content\" tablabel=\"About\" tabid=\"about\">\n              <AboutTabContent />\n            </div>\n          </Tabs>\n        </FormikForm>\n      </div>\n      <div className=\"footer-container\">\n        <button type=\"button\" onClick={handleSave} className=\"save-button\">\n          Save\n        </button>\n      </div>\n    </div>\n  );\n}\n\nexport default GeneralSettings;\n","import PropTypes from 'prop-types';\nimport { forwardRef, useCallback, useRef } from 'react';\n\nconst styles = {\n  container: {\n    display: 'flex',\n  },\n  label: {\n    lineHeight: 2,\n    userSelect: 'none',\n    flex: '2',\n  },\n  inputContainer: {\n    flex: '4',\n    display: 'flex',\n    justifyContent: 'flex-start',\n  },\n  input: {\n    height: '100%',\n    width: '100px',\n    borderRadius: '5px',\n    border: '0.55px solid #c7c7c7',\n    margin: '0px 5px 0px 5px',\n    textAlign: 'center',\n  },\n};\n\nconst NumberInput = forwardRef(function NumberInput(\n  { label, name, defaultValue, style, onChange, onInput, pattern, step, min },\n  ref,\n) {\n  const localRef = useRef();\n  const changeHander = useCallback(\n    (e) => {\n      if (e.target.checkValidity()) {\n        if (e.target.value === '') {\n          onChange({ ...e, target: { ...e.target, value: defaultValue } });\n        } else {\n          onChange(e);\n        }\n      } else {\n        const _ref = ref ? ref : localRef;\n        _ref.current.value = defaultValue;\n      }\n    },\n    [defaultValue, onChange, ref],\n  );\n  return (\n    <div style={{ ...styles.container, ...style.container }}>\n      <span style={{ ...styles.label, ...style.label }}>{label}</span>\n      <div style={{ ...styles.inputContainer, ...style.inputContainer }}>\n        <input\n          ref={ref ? ref : localRef}\n          name={name}\n          style={{ ...styles.input, ...style.input }}\n          type=\"number\"\n          pattern={pattern}\n          defaultValue={defaultValue}\n          step={step}\n          onChange={changeHander}\n          onInput={onInput}\n          min={min}\n          key={defaultValue}\n        />\n      </div>\n    </div>\n  );\n});\n\nNumberInput.propTypes = {\n  pattern: PropTypes.string,\n  label: PropTypes.string,\n  name: PropTypes.string,\n  step: PropTypes.any,\n  min: PropTypes.any,\n  defaultValue: PropTypes.number,\n  style: PropTypes.shape({\n    container: PropTypes.object,\n    label: PropTypes.object,\n    inputContainer: PropTypes.object,\n    input: PropTypes.object,\n  }),\n  onChange: PropTypes.func,\n  onInput: PropTypes.func,\n};\n\nNumberInput.defaultProps = {\n  pattern: '^d*(.d{0,2})?$',\n  step: 'any',\n  min: 'any',\n  style: {\n    label: {},\n    input: {},\n    container: {},\n    inputContainer: {},\n  },\n  defaultValue: 0,\n  onChange: () => {\n    return null;\n  },\n  onInput: () => {\n    return null;\n  },\n};\n\nexport default NumberInput;\n","import { useCallback, useRef } from 'react';\n\nimport { useDispatch } from '../context/DispatchContext';\nimport CheckBox from '../elements/CheckBox';\nimport NumberInput from '../elements/NumberInput';\nimport { AUTO_PEAK_PICKING, RESET_SELECTED_TOOL } from '../reducer/types/Types';\n\nconst styles = {\n  container: {\n    padding: '5px',\n    height: '100%',\n    display: 'flex',\n    fontSize: '12px',\n  },\n  input: {\n    width: '50px',\n  },\n  inputContainer: {\n    flex: '2',\n  },\n  label: {\n    flex: '5',\n  },\n  actionButton: {\n    height: '100%',\n    width: '60px',\n    borderRadius: '5px',\n    border: '0.55px solid #c7c7c7',\n    margin: '0px 5px',\n    userSelect: 'none',\n  },\n};\n\nfunction AutoPeakPickingOptionPanel() {\n  const dispatch = useDispatch();\n  const minMaxRatioRef = useRef();\n  const maxNumberOfPeaksRef = useRef();\n  const noiseFactor = useRef();\n  const lookNegativeRef = useRef();\n\n  const handleApplyFilter = useCallback(() => {\n    dispatch({\n      type: AUTO_PEAK_PICKING,\n      options: {\n        maxNumberOfPeaks: maxNumberOfPeaksRef.current.value,\n        minMaxRatio: minMaxRatioRef.current.value,\n        noiseFactor: noiseFactor.current.value,\n        lookNegative: lookNegativeRef.current.checked,\n      },\n    });\n  }, [dispatch]);\n\n  const handleCancelFilter = useCallback(() => {\n    dispatch({\n      type: RESET_SELECTED_TOOL,\n    });\n  }, [dispatch]);\n\n  return (\n    <div style={styles.container}>\n      <NumberInput\n        ref={maxNumberOfPeaksRef}\n        label=\"Max Number Of Peaks:\"\n        name=\"maxNumberOfPeaks\"\n        style={{\n          input: styles.input,\n          inputContainer: styles.inputContainer,\n          label: styles.label,\n        }}\n        defaultValue={50}\n      />\n      <NumberInput\n        ref={noiseFactor}\n        label=\"Noise factor\"\n        name=\"noiseFactor\"\n        style={{\n          input: styles.input,\n          inputContainer: styles.inputContainer,\n          label: styles.label,\n        }}\n        defaultValue={3}\n      />\n      <NumberInput\n        ref={minMaxRatioRef}\n        label=\"Min Max Ratio:\"\n        name=\"minMaxRatio\"\n        style={{\n          input: styles.input,\n          inputContainer: styles.inputContainer,\n          label: styles.label,\n        }}\n        defaultValue={0.1}\n        step=\"0.01\"\n      />\n\n      <div style={{ justifyItems: 'baseline', marginRight: '3px' }}>\n        <label\n          style={{ marginRight: '2px', lineHeight: 2, userSelect: 'none' }}\n          htmlFor=\"lookNegative\"\n        >\n          Detect Negative:\n        </label>\n        <CheckBox name=\"lookNegative\" ref={lookNegativeRef} />\n      </div>\n\n      <button\n        type=\"button\"\n        style={styles.actionButton}\n        onClick={handleApplyFilter}\n      >\n        Apply\n      </button>\n      <button\n        type=\"button\"\n        style={styles.actionButton}\n        onClick={handleCancelFilter}\n      >\n        Cancel\n      </button>\n    </div>\n  );\n}\n\nexport default AutoPeakPickingOptionPanel;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport PropTypes from 'prop-types';\nimport { forwardRef, useCallback } from 'react';\n\nconst arrowDownIcon = `url('data:image/svg+xml;utf8,<svg  xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\" width=\"960px\" height=\"560px\" viewBox=\"0 0 960 560\" enable-background=\"new 0 0 960 560\" xml:space=\"preserve\"><g id=\"Rounded_Rectangle_33_copy_4_1_\"><path d=\"M480,344.181L268.869,131.889c-15.756-15.859-41.3-15.859-57.054,0c-15.754,15.857-15.754,41.57,0,57.431l237.632,238.937c8.395,8.451,19.562,12.254,30.553,11.698c10.993,0.556,22.159-3.247,30.555-11.698l237.631-238.937c15.756-15.86,15.756-41.571,0-57.431s-41.299-15.859-57.051,0L480,344.181z\"/></g></svg>')`;\n\nconst Select = forwardRef(function Select(\n  { data, style, onChange, defaultValue, name },\n  ref,\n) {\n  const handleOnChanged = useCallback(\n    (e) => {\n      let value = e.target.value;\n      if (!isNaN(value)) {\n        value = Number(value);\n      }\n      onChange(value);\n    },\n    [onChange],\n  );\n\n  const styles = css`\n    position: relative;\n    padding: 0px 5px;\n    border: 0.55px solid #cacaca;\n    font-size: 14px;\n    width: ${style.width ? style.width - 5 : 115}px;\n    margin: 0;\n    height: 100%;\n    background: ${arrowDownIcon} no-repeat right white;\n    -webkit-appearance: none;\n    background-position-x: ${style.width ? style.width - 18 : 115 - 18}px;\n    background-size: 15px 15px;\n    border-radius: 5px;\n    margin: 0px 5px;\n    :focus,\n    input:focus {\n      outline: none;\n    }\n  `;\n\n  return (\n    <select\n      css={[styles, style]}\n      ref={ref}\n      name={name}\n      onChange={handleOnChanged}\n      defaultValue={defaultValue}\n    >\n      {data.map((d) => (\n        <option key={`${d.key}`} value={d.value}>\n          {d.label}\n        </option>\n      ))}\n    </select>\n  );\n});\n\nSelect.propTypes = {\n  onChange: PropTypes.func,\n  data: PropTypes.array.isRequired,\n  style: PropTypes.any,\n  defaultValue: PropTypes.any,\n  name: PropTypes.string,\n};\n\nSelect.defaultProps = {\n  onChange: function () {\n    return null;\n  },\n  style: { width: 100 },\n  name: '',\n};\n\nexport default Select;\n","import { useCallback, useRef, useState, Fragment } from 'react';\n\nimport { baselineAlgorithms } from '../../data/data1d/filter1d/baselineCorrection';\nimport { useDispatch } from '../context/DispatchContext';\nimport NumberInput from '../elements/NumberInput';\nimport Select from '../elements/Select';\nimport {\n  RESET_SELECTED_TOOL,\n  APPLY_BASE_LINE_CORRECTION_FILTER,\n} from '../reducer/types/Types';\n\nconst styles = {\n  container: {\n    padding: '5px',\n    height: '100%',\n    display: 'flex',\n  },\n  label: {\n    lineHeight: 2,\n    userSelect: 'none',\n  },\n  actionButton: {\n    height: '100%',\n    width: '60px',\n    borderRadius: '5px',\n    border: '0.55px solid #c7c7c7',\n    margin: '0px 5px',\n    userSelect: 'none',\n  },\n};\n\nfunction BaseLineCorrectionPanel() {\n  const dispatch = useDispatch();\n  const algorithmRef = useRef();\n  const maxIterationsRef = useRef();\n  const toleranceRef = useRef();\n  const degreeRef = useRef();\n  const [algorithm, setAlgorithm] = useState('polynomial');\n\n  const handleApplyFilter = useCallback(() => {\n    let options = {};\n    switch (algorithm) {\n      case 'airpls':\n        options = {\n          algorithm: algorithmRef.current.value,\n          maxIterations: maxIterationsRef.current.value,\n          tolerance: toleranceRef.current.value,\n        };\n        break;\n      case 'polynomial':\n        options = {\n          algorithm: algorithmRef.current.value,\n          degree: degreeRef.current.value,\n        };\n        break;\n      default:\n        break;\n    }\n    dispatch({\n      type: APPLY_BASE_LINE_CORRECTION_FILTER,\n      options,\n    });\n  }, [algorithm, dispatch]);\n\n  const handleCancelFilter = useCallback(() => {\n    dispatch({\n      type: RESET_SELECTED_TOOL,\n    });\n  }, [dispatch]);\n\n  const getAlgorithmsList = useCallback(() => {\n    return Object.keys(baselineAlgorithms).map((val) => {\n      return { key: val, label: baselineAlgorithms[val], value: val };\n    });\n  }, []);\n\n  const changeAlgorithmHandler = useCallback((val) => {\n    setAlgorithm(val);\n  }, []);\n\n  return (\n    <div style={styles.container}>\n      <span style={styles.label}>Algorithm: </span>\n      <Select\n        ref={algorithmRef}\n        data={getAlgorithmsList()}\n        style={{ marginLeft: 10, marginRight: 10 }}\n        onChange={changeAlgorithmHandler}\n        defaultValue=\"polynomial\"\n      />\n      {algorithm && algorithm === 'airpls' && (\n        <Fragment>\n          <NumberInput\n            label=\"maxIterations:\"\n            ref={maxIterationsRef}\n            name=\"maxIterations\"\n            defaultValue={100}\n          />\n          <NumberInput\n            label=\"tolerance:\"\n            ref={toleranceRef}\n            name=\"tolerance\"\n            defaultValue={0.001}\n          />\n        </Fragment>\n      )}\n\n      {algorithm && algorithm === 'autoPolynomial' && (\n        <NumberInput\n          label=\"degree:\"\n          ref={degreeRef}\n          name=\"degree\"\n          defaultValue={3}\n        />\n      )}\n\n      {algorithm && algorithm === 'polynomial' && (\n        <NumberInput\n          label=\"degree:\"\n          ref={degreeRef}\n          name=\"degree\"\n          defaultValue={3}\n        />\n      )}\n\n      <button\n        type=\"button\"\n        style={styles.actionButton}\n        onClick={handleApplyFilter}\n      >\n        Apply\n      </button>\n\n      <button\n        type=\"button\"\n        style={styles.actionButton}\n        onClick={handleCancelFilter}\n      >\n        Cancel\n      </button>\n    </div>\n  );\n}\n\nexport default BaseLineCorrectionPanel;\n","import { useCallback } from 'react';\n\nconst styles = {\n  container: {\n    width: '100%',\n    height: '100%',\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'center',\n    border: '0.55px solid #c7c7c7',\n    borderRadius: '5px',\n    userSelect: 'none',\n    backgroundColor: '#18ce0f14',\n    fontSize: '10px',\n    color: '#00801d',\n    margin: '0px 5px',\n    cursor: 'ew-resize',\n  },\n  label: {\n    whiteSpace: 'nowrap',\n    textOverflow: 'ellipsis',\n    overflow: 'hidden',\n    maxWidth: '100%',\n  },\n};\n\nlet stateValues = {\n  step: 'initial',\n};\n\nlet timerId = null;\nlet speedX = 1;\nlet oldX = 0;\nlet firstCalc = true;\nfunction calcSpeed(e) {\n  if (!firstCalc) {\n    speedX = e.clientX - oldX;\n    oldX = e.clientX;\n    setToZero();\n  } else {\n    oldX = e.clientX;\n    firstCalc = false;\n  }\n}\n\nfunction setToZero() {\n  clearTimeout(timerId);\n  timerId = setTimeout(() => {\n    speedX = 0;\n  }, 50);\n}\n\nfunction InputRange({\n  name,\n  minValue,\n  maxValue,\n  value: valueProps,\n  onChange,\n  label,\n  style,\n  className,\n  noPropagation,\n}) {\n  const mouseEnterHandler = useCallback(() => {\n    if (stateValues.step === 'moving' || stateValues.step === 'start') {\n      stateValues = {\n        ...stateValues,\n        step: stateValues.step === 'start' ? 'initial' : 'end',\n      };\n    }\n  }, []);\n\n  const mouseDownHandler = useCallback(\n    (event) => {\n      if (noPropagation) {\n        event.stopPropagation();\n      }\n\n      const boundingRect = event.currentTarget.getBoundingClientRect();\n      const x = event.clientX - boundingRect.x;\n      const y = event.clientY - boundingRect.y;\n      if (stateValues.step === 'initial' || stateValues.step === 'end') {\n        stateValues = {\n          startX: x,\n          startY: y,\n          startScreenX: event.screenX,\n          startScreenY: event.screenY,\n          boundingRect: event.currentTarget.getBoundingClientRect(),\n          step: 'start',\n          clientX: event.clientX,\n          clientY: event.clientY,\n        };\n      }\n\n      return false;\n    },\n    [noPropagation],\n  );\n\n  const mouseMoveCallback = (event) => {\n    if (stateValues.step === 'start' || stateValues.step === 'moving') {\n      const { screenX, screenY } = event;\n      stateValues = {\n        ...stateValues,\n        step: 'moving',\n        endX: stateValues.startX + screenX - stateValues.startScreenX,\n        endY: stateValues.startY + screenY - stateValues.startScreenY,\n      };\n      calcSpeed(event);\n      const valueRange = maxValue - minValue;\n      const positionDiff = stateValues.endX - stateValues.startX;\n      const value =\n        (Math.abs(positionDiff) * (Math.abs(speedX) > 3 ? valueRange : 5)) /\n        stateValues.boundingRect.width;\n\n      onChange({\n        value: speedX >= 0 ? valueProps + Math.abs(value) : valueProps - value,\n        name,\n      });\n    }\n  };\n\n  const mouseUpCallback = () => {\n    if (stateValues.step === 'moving' || stateValues.step === 'start') {\n      stateValues = {\n        ...stateValues,\n        step: stateValues.step === 'start' ? 'initial' : 'end',\n      };\n    }\n  };\n\n  return (\n    <div\n      style={{ ...styles.container, ...style }}\n      className={className}\n      onMouseMove={mouseMoveCallback}\n      onMouseUp={mouseUpCallback}\n      onMouseDown={mouseDownHandler}\n      onMouseEnter={mouseEnterHandler}\n    >\n      <span style={styles.label}>{label}</span>\n    </div>\n  );\n}\n\nInputRange.defaultProps = {\n  name: '',\n  minValue: 0,\n  maxValue: 50,\n  value: 0,\n  onChange: () => {\n    return null;\n  },\n  label: 'Drag to Change the value',\n  noPropagation: true,\n};\n\nexport default InputRange;\n","import { useCallback, useState } from 'react';\n\nimport { useDispatch } from '../context/DispatchContext';\nimport Input from '../elements/Input';\nimport InputRange from '../elements/InputRange';\nimport Select from '../elements/Select';\nimport {\n  APPLY_MANUAL_PHASE_CORRECTION_FILTER,\n  APPLY_AUTO_PHASE_CORRECTION_FILTER,\n  CALCULATE_MANUAL_PHASE_CORRECTION_FILTER,\n  RESET_SELECTED_TOOL,\n  APPLY_ABSOLUTE_FILTER,\n} from '../reducer/types/Types';\n\nconst styles = {\n  container: {\n    padding: '5px',\n    height: '100%',\n    display: 'flex',\n  },\n  input: {\n    width: '100px',\n  },\n  actionButton: {\n    height: '100%',\n    width: '60px',\n    borderRadius: '5px',\n    border: '0.55px solid #c7c7c7',\n    margin: '0px 5px',\n    userSelect: 'none',\n  },\n  select: {\n    marginLeft: '5px',\n    marginRight: '10px',\n    border: 'none',\n    height: '20px',\n  },\n};\n\nconst phaseCorrectionTypes = {\n  manual: 'manual',\n  automatic: 'automatic',\n  absolute: 'absolute',\n};\n\nconst algorithms = [\n  {\n    key: phaseCorrectionTypes.manual,\n    label: 'Manual',\n    value: phaseCorrectionTypes.manual,\n  },\n  {\n    key: phaseCorrectionTypes.automatic,\n    label: 'Automatic',\n    value: phaseCorrectionTypes.automatic,\n  },\n  {\n    key: phaseCorrectionTypes.absolute,\n    label: 'Absolute',\n    value: phaseCorrectionTypes.absolute,\n  },\n];\n\nfunction ManualPhaseCorrectionPanel() {\n  const dispatch = useDispatch();\n  const [value, setValue] = useState({ ph0: 0, ph1: 0, pivotIndex: 1 });\n  const [phaseCorrectionType, setPhaseCorrectionType] = useState(\n    phaseCorrectionTypes.manual,\n  );\n\n  const handleApplyFilter = useCallback(() => {\n    switch (phaseCorrectionType) {\n      case phaseCorrectionTypes.automatic: {\n        dispatch({\n          type: APPLY_AUTO_PHASE_CORRECTION_FILTER,\n        });\n        break;\n      }\n\n      case phaseCorrectionTypes.manual: {\n        dispatch({\n          type: APPLY_MANUAL_PHASE_CORRECTION_FILTER,\n          value: value,\n        });\n        break;\n      }\n      case phaseCorrectionTypes.absolute: {\n        dispatch({\n          type: APPLY_ABSOLUTE_FILTER,\n        });\n        break;\n      }\n      default:\n        break;\n    }\n  }, [dispatch, phaseCorrectionType, value]);\n\n  const handleInput = useCallback(\n    (e) => {\n      const fieldName = e.target.name;\n      if (e.target) {\n        const inputValue = e.target.value;\n\n        setValue((prevValue) => {\n          const _value = {\n            ...prevValue,\n            [fieldName]: inputValue,\n          };\n\n          if (inputValue !== '-') {\n            const newValue = {\n              ...value,\n              [fieldName]: inputValue - prevValue[fieldName],\n            };\n            for (let key in prevValue) {\n              if (prevValue[key] === newValue[key]) {\n                newValue[key] -= prevValue[key];\n              }\n            }\n\n            dispatch({\n              type: CALCULATE_MANUAL_PHASE_CORRECTION_FILTER,\n              value: newValue,\n            });\n          }\n\n          return _value;\n        });\n      }\n    },\n    [dispatch, value],\n  );\n\n  const handleRangeChange = useCallback(\n    (e) => {\n      const _value = { ...value, [e.name]: e.value };\n      let diff = {};\n      for (let key in value) {\n        diff[key] = _value[key] - value[key];\n      }\n      dispatch({\n        type: CALCULATE_MANUAL_PHASE_CORRECTION_FILTER,\n        value: diff,\n      });\n      setValue(_value);\n    },\n    [dispatch, value],\n  );\n\n  const handleCancelFilter = useCallback(() => {\n    dispatch({\n      type: RESET_SELECTED_TOOL,\n    });\n  }, [dispatch]);\n\n  const onChangeHandler = useCallback((val) => {\n    setPhaseCorrectionType(val);\n  }, []);\n\n  return (\n    <div style={styles.container}>\n      <Select\n        onChange={onChangeHandler}\n        data={algorithms}\n        value={phaseCorrectionTypes.manual}\n        style={styles.select}\n      />\n\n      {phaseCorrectionType === phaseCorrectionTypes.manual && (\n        <>\n          <Input\n            label=\"PH0:\"\n            name=\"ph0\"\n            style={{ input: styles.input }}\n            onChange={handleInput}\n            value={value.ph0}\n            type=\"number\"\n          />\n          <Input\n            label=\"PH1:\"\n            name=\"ph1\"\n            style={{ input: styles.input }}\n            onChange={handleInput}\n            value={value.ph1}\n            type=\"number\"\n          />\n\n          <InputRange\n            name=\"ph0\"\n            value={value.ph0}\n            label=\"Change Ph0 By mouse click and drag\"\n            style={{ width: '20%' }}\n            onChange={handleRangeChange}\n          />\n          <InputRange\n            name=\"ph1\"\n            value={value.ph1}\n            label=\"Change Ph1 By mouse click and drag\"\n            style={{ width: '20%' }}\n            onChange={handleRangeChange}\n          />\n        </>\n      )}\n\n      <button\n        type=\"button\"\n        style={styles.actionButton}\n        onClick={handleApplyFilter}\n      >\n        Apply\n      </button>\n      <button\n        type=\"button\"\n        style={styles.actionButton}\n        onClick={handleCancelFilter}\n      >\n        Cancel\n      </button>\n      {/* <button\n        type=\"button\"\n        style={styles.actionButton}\n        onClick={handleAutoFilter}\n      >\n        Auto\n      </button> */}\n    </div>\n  );\n}\n\nexport default ManualPhaseCorrectionPanel;\n","import { useCallback, useRef } from 'react';\n\nimport { useDispatch } from '../context/DispatchContext';\nimport CheckBox from '../elements/CheckBox';\nimport {\n  AUTO_RANGES_DETECTION,\n  RESET_SELECTED_TOOL,\n} from '../reducer/types/Types';\n\nconst styles = {\n  container: {\n    padding: '5px',\n    height: '100%',\n    display: 'flex',\n    fontSize: '12px',\n    alignItems: 'baseline',\n  },\n  input: {\n    height: '100%',\n    width: '50px',\n    borderRadius: '5px',\n    border: '0.55px solid #c7c7c7',\n    margin: '0px 5px 0px 5px',\n    textAlign: 'center',\n  },\n  actionButton: {\n    height: '100%',\n    minWidth: '60px',\n    borderRadius: '5px',\n    border: '0.55px solid #c7c7c7',\n    margin: '0px 5px',\n    userSelect: 'none',\n  },\n  hint: {\n    lineHeight: 2,\n    userSelect: 'none',\n    fontSize: '11px',\n  },\n};\n\nfunction RangesPickingOptionPanel() {\n  const dispatch = useDispatch();\n  const lookNegativeRef = useRef();\n\n  const handleApplyFilter = useCallback(() => {\n    dispatch({\n      type: AUTO_RANGES_DETECTION,\n      options: {\n        peakPicking: {\n          minMaxRatio: 0.05,\n          nH: 100,\n          compile: true,\n          frequencyCluster: 16,\n          clean: true,\n          keepPeaks: true,\n          lookNegative: lookNegativeRef.current.checked,\n        },\n      },\n    });\n  }, [dispatch]);\n\n  const handleCancelFilter = useCallback(() => {\n    dispatch({\n      type: RESET_SELECTED_TOOL,\n    });\n  }, [dispatch]);\n\n  return (\n    <div style={styles.container}>\n      <div style={{ justifyItems: 'baseline', margin: '0 10px' }}>\n        <label\n          style={{ marginRight: '2px', lineHeight: 2, userSelect: 'none' }}\n          htmlFor=\"lookNegative\"\n        >\n          Detect negative:\n        </label>\n        <CheckBox name=\"lookNegative\" ref={lookNegativeRef} />\n      </div>\n      <button\n        type=\"button\"\n        style={styles.actionButton}\n        onClick={handleApplyFilter}\n      >\n        Auto ranges picking\n      </button>\n      <button\n        type=\"button\"\n        style={styles.actionButton}\n        onClick={handleCancelFilter}\n      >\n        Cancel\n      </button>\n      <span style={styles.hint}>\n        Manual selection using SHIFT + select zone or click on Auto peak picking\n      </span>\n    </div>\n  );\n}\n\nexport default RangesPickingOptionPanel;\n","import { useCallback, useRef, useState } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\nimport { useDispatch } from '../context/DispatchContext';\nimport Select from '../elements/Select';\nimport {\n  APPLY_ZERO_FILLING_FILTER,\n  RESET_SELECTED_TOOL,\n} from '../reducer/types/Types';\n\nconst styles = {\n  container: {\n    padding: '5px',\n    height: '100%',\n    display: 'flex',\n  },\n\n  input: {\n    height: '100%',\n    width: '50px',\n    borderRadius: '5px',\n    border: '0.55px solid #c7c7c7',\n    margin: '0px 5px 0px 5px',\n    textAlign: 'center',\n  },\n  actionButton: {\n    height: '100%',\n    width: '60px',\n    borderRadius: '5px',\n    border: '0.55px solid #c7c7c7',\n    margin: '0px 5px',\n    userSelect: 'none',\n  },\n  label: {\n    lineHeight: 2,\n    userSelect: 'none',\n  },\n};\n\nfunction generateSizes(start = 8, end = 21) {\n  let values = [];\n  for (let i = start; i <= end; i++) {\n    const result = 2 ** i;\n    values.push({\n      key: result,\n      label: formatNumber(result),\n      value: result,\n    });\n  }\n  return values;\n}\nfunction formatNumber(number) {\n  if (number >= 1024 * 1024) {\n    return `${number / (1024 * 1024)}M`;\n  } else if (number >= 1024) {\n    return `${number / 1024}K`;\n  } else {\n    return number;\n  }\n}\n\nconst Sizes = generateSizes();\n\nfunction ZeroFillingOptionsPanel() {\n  const dispatch = useDispatch();\n  const { data, activeSpectrum } = useChartData();\n  const sizeTextInputRef = useRef();\n  const [lineBroadeningValue, setLineBroadeningValue] = useState(1);\n\n  const handleApplyFilter = useCallback(() => {\n    dispatch({\n      type: APPLY_ZERO_FILLING_FILTER,\n      value: {\n        zeroFillingSize: Number(sizeTextInputRef.current.value),\n        lineBroadeningValue: lineBroadeningValue,\n      },\n    });\n  }, [dispatch, lineBroadeningValue]);\n\n  const getDefaultValue = useCallback(() => {\n    if (data && activeSpectrum?.id) {\n      return (\n        2 ** Math.round(Math.log2(data[activeSpectrum.index].data.x.length))\n      );\n    }\n    return '';\n  }, [activeSpectrum, data]);\n\n  const handleInput = useCallback(\n    (e) => {\n      if (e.target) {\n        const _value = e.target.validity.valid\n          ? Number(e.target.value)\n          : lineBroadeningValue;\n        setLineBroadeningValue(_value);\n      }\n    },\n    [lineBroadeningValue],\n  );\n\n  const handleCancelFilter = useCallback(() => {\n    dispatch({\n      type: RESET_SELECTED_TOOL,\n    });\n  }, [dispatch]);\n\n  return (\n    <div style={styles.container}>\n      <span style={styles.label}>Size: </span>\n      <Select\n        ref={sizeTextInputRef}\n        data={Sizes}\n        style={{ marginLeft: 10, marginRight: 10 }}\n        defaultValue={getDefaultValue()}\n      />\n      <span style={styles.label}>Line Broadening: </span>\n      <input\n        name=\"line-broadening\"\n        style={styles.input}\n        type=\"number\"\n        defaultValue={lineBroadeningValue}\n        onInput={handleInput}\n        pattern=\"^\\d*(\\.\\d{0,2})?$\"\n        step=\"any\"\n      />\n\n      <button\n        type=\"button\"\n        style={styles.actionButton}\n        onClick={handleApplyFilter}\n      >\n        Apply\n      </button>\n\n      <button\n        type=\"button\"\n        style={styles.actionButton}\n        onClick={handleCancelFilter}\n      >\n        Cancel\n      </button>\n    </div>\n  );\n}\n\nexport default ZeroFillingOptionsPanel;\n","import { useCallback, useRef } from 'react';\n\nimport { useDispatch } from '../context/DispatchContext';\nimport NumberInput from '../elements/NumberInput';\nimport {\n  RESET_SELECTED_TOOL,\n  AUTO_ZONES_DETECTION,\n} from '../reducer/types/Types';\nimport Events from '../utility/Events';\n\nconst styles = {\n  container: {\n    padding: '5px',\n    height: '100%',\n    display: 'flex',\n    fontSize: '12px',\n  },\n  input: {\n    width: '50px',\n  },\n  inputContainer: {\n    flex: '2',\n  },\n  label: {\n    flex: '5',\n  },\n  actionButton: {\n    height: '100%',\n    borderRadius: '5px',\n    border: '0.55px solid #c7c7c7',\n    margin: '0px 5px',\n    userSelect: 'none',\n  },\n};\n\nfunction Zones2DOptionPanel() {\n  const dispatch = useDispatch();\n  const thresholdFactor = useRef();\n\n  const handleApplyFilter = useCallback(() => {\n    dispatch({\n      type: AUTO_ZONES_DETECTION,\n      options: {\n        thresholdFactor: thresholdFactor.current.value,\n      },\n    });\n  }, [dispatch]);\n\n  const handleCancelFilter = useCallback(() => {\n    dispatch({\n      type: RESET_SELECTED_TOOL,\n    });\n  }, [dispatch]);\n\n  const handleInput = useCallback((e) => {\n    if (e.target) {\n      const val = e.target.value;\n      Events.emit('noiseFactorChanged', val);\n    }\n  }, []);\n\n  return (\n    <div style={styles.container}>\n      <NumberInput\n        ref={thresholdFactor}\n        label=\"NoiseFactor\"\n        name=\"noiseFactor\"\n        style={{\n          input: styles.input,\n          inputContainer: styles.inputContainer,\n          label: styles.label,\n        }}\n        defaultValue={1}\n        onChange={handleInput}\n      />\n      <button\n        type=\"button\"\n        style={styles.actionButton}\n        onClick={handleApplyFilter}\n      >\n        Auto Zones Picking\n      </button>\n      <button\n        type=\"button\"\n        style={styles.actionButton}\n        onClick={handleCancelFilter}\n      >\n        Cancel\n      </button>\n    </div>\n  );\n}\n\nexport default Zones2DOptionPanel;\n","/** @jsxImportSource @emotion/react */\n\nimport { css } from '@emotion/react';\nimport { useMemo, useCallback } from 'react';\nimport {\n  FaRegWindowMaximize,\n  FaWrench,\n  FaQuestionCircle,\n} from 'react-icons/fa';\n\nimport { useChartData } from '../context/ChartContext';\nimport ToolTip from '../elements/ToolTip/ToolTip';\nimport { useAlert } from '../elements/popup/Alert';\nimport { useHelp } from '../elements/popup/Help';\nimport { useModal, positions } from '../elements/popup/Modal';\nimport UserManualModal from '../modal/UserManualModal';\nimport GeneralSettings from '../modal/setting/GeneralSettings';\nimport { options } from '../toolbar/ToolTypes';\n\nimport AutoPeakPickingOptionPanel from './AutoPeakPickingOptionPanel';\nimport BaseLineCorrectionPanel from './BaseLineCorrectionPanel';\nimport ManualPhaseCorrectionPanel from './ManualPhaseCorrectionPanel';\nimport RangesPickingOptionPanel from './RangesPickingOptionPanel';\nimport ZeroFillingOptionsPanel from './ZeroFillingOptionsPanel';\nimport Zones2DOptionPanel from './Zones2DOptionPanel';\n\nconst headerStyle = css`\n  display: flex;\n  align-items: flex-start;\n  justify-content: flex-start;\n  height: 36px;\n  min-height: 36px;\n  border-width: 1px 1px 0px 1px;\n  border-style: solid;\n  border-color: rgb(213, 213, 213);\n  outline: none;\n  transition: background-color 0.2s ease-in 0s;\n  box-shadow: rgb(255, 255, 255) 0px 1px 0px 0px inset;\n  background: linear-gradient(rgb(255, 255, 255) 5%, rgb(246, 246, 246) 100%)\n    rgb(255, 255, 255);\n  color: rgb(102, 102, 102);\n  font-family: Arial;\n  font-weight: bold;\n  text-decoration: none;\n  text-shadow: rgb(255, 255, 255) 0px 1px 0px;\n\n  .toolOptionsPanel {\n    flex: 10;\n    padding: 0px;\n    margin: 0px;\n    height: 100%;\n  }\n\n  .windowButtonsContainer {\n    flex: 0.5;\n    display: flex;\n    align-items: center;\n    justify-content: flex-end;\n    height: 100%;\n  }\n\n  .windowButton {\n    width: 40px !important;\n    min-width: 40px !important;\n    background-color: transparent;\n    border: none;\n  }\n  button:focus {\n    outline: 0;\n  }\n`;\n\nexport function Button({\n  title,\n  popupPlacement,\n  style,\n  className,\n  onClick,\n  children,\n  helpID = '',\n}) {\n  const help = useHelp();\n\n  return (\n    <ToolTip title={title} popupPlacement={popupPlacement} style={style}>\n      <button\n        type=\"button\"\n        onClick={onClick}\n        className={className}\n        {...help.onHover}\n        data-helpid={helpID}\n      >\n        {children}\n      </button>\n    </ToolTip>\n  );\n}\n\nfunction Header({ isFullscreen, onMaximize }) {\n  const { selectedOptionPanel } = useChartData();\n  const modal = useModal();\n  const alert = useAlert();\n\n  const selectedPanel = useMemo(() => {\n    switch (selectedOptionPanel) {\n      case options.zeroFilling.id:\n        return <ZeroFillingOptionsPanel />;\n      case options.phaseCorrection.id:\n        return <ManualPhaseCorrectionPanel />;\n      case options.peakPicking.id:\n        return <AutoPeakPickingOptionPanel />;\n      case options.rangesPicking.id:\n        return <RangesPickingOptionPanel />;\n      case options.baseLineCorrection.id:\n        return <BaseLineCorrectionPanel />;\n      case options.zone2D.id:\n        return <Zones2DOptionPanel />;\n      default:\n        break;\n    }\n  }, [selectedOptionPanel]);\n\n  const openGeneralSettingsHandler = useCallback(() => {\n    modal.show(\n      <GeneralSettings\n        onSave={() => {\n          alert.success('Settings saved successfully');\n          modal.close();\n        }}\n      />,\n      {\n        position: positions.TOP_CENTER,\n        enableResizing: true,\n        width: 600,\n        height: 400,\n      },\n    );\n  }, [alert, modal]);\n  const openUserManual = useCallback(() => {\n    modal.show(<UserManualModal />, {\n      isBackgroundBlur: false,\n      position: positions.TOP_CENTER,\n      enableResizing: true,\n      width: 800,\n      height: 600,\n    });\n  }, [modal]);\n\n  return (\n    <div css={headerStyle}>\n      <div className=\"toolOptionsPanel\">{selectedPanel}</div>\n      <div className=\"windowButtonsContainer\">\n        <Button\n          title=\"User Manual\"\n          popupPlacement=\"left\"\n          style={{ mainContainer: { height: 'auto' } }}\n          onClick={openUserManual}\n          className=\"windowButton\"\n        >\n          <FaQuestionCircle />\n        </Button>\n        <Button\n          title=\"General Settings\"\n          popupPlacement=\"left\"\n          style={{ mainContainer: { height: 'auto' } }}\n          onClick={openGeneralSettingsHandler}\n          className=\"windowButton\"\n        >\n          <FaWrench />\n        </Button>\n        {!isFullscreen ? (\n          <Button\n            title=\"Full Screen\"\n            popupPlacement=\"left\"\n            style={{ mainContainer: { height: 'auto' } }}\n            onClick={onMaximize}\n            className=\"windowButton\"\n            helpID=\"fullScreen\"\n          >\n            <FaRegWindowMaximize />\n          </Button>\n        ) : (\n          ''\n        )}\n      </div>\n    </div>\n  );\n}\n\nHeader.defaultProps = {\n  onMaximize: function () {\n    return null;\n  },\n};\n\nexport default Header;\n","import { useState, useRef, useEffect, useCallback } from 'react';\n\nlet timer = 0;\nlet delay = 200;\nlet prevent = false;\n\nconst styles = {\n  container: {\n    display: 'flex',\n    flexDirection: 'column',\n    margin: '0px',\n    userSelect: 'none',\n  },\n  button: {\n    cursor: 'pointer',\n    padding: '5px 12px',\n    display: 'flex',\n    alignItems: 'center',\n    fontSize: '11px',\n    border: 'none',\n    outline: 'none',\n    transition: 'background-color 0.2s ease-in',\n\n    boxShadow: 'inset 0px 1px 0px 0px #ffffff',\n    background: 'linear-gradient(to bottom, #f0f0f0 5%, #e1e1e1 100%)',\n    filter:\n      'progid:DXImageTransform.Microsoft.gradient(startColorstr=\"#f0f0f0\", endColorstr=\"#e1e1e1\",GradientType=0)',\n    backgroundColor: '#ffffff',\n    color: '#2d2d2d',\n    fontFamily: 'Arial',\n    fontWeight: 'bold',\n    textDecoration: 'none',\n    textShadow: '0px 1px 0px #ffffff',\n    borderTop: '0.55px  solid #d5d5d5',\n  },\n  buttonTitle: {\n    padding: 0,\n    margin: 0,\n  },\n  content: {\n    backgroundColor: 'white',\n    maxHeight: '0',\n    overflow: 'hidden',\n    flex: '1 1 1px',\n  },\n};\n\nexport const triggerSource = {\n  click: 1,\n  dbClick: 2,\n};\n\nfunction AccordionItem({ title, children, index, isOpen, onOpen, style }) {\n  const [active, setActiveState] = useState(null);\n\n  const refContent = useRef();\n  const refContainer = useRef();\n  const toggleAccordion = useCallback(\n    (e) => {\n      timer = setTimeout(function () {\n        if (!prevent) {\n          onOpen(index, { source: triggerSource.click, shiftKey: e.shiftKey });\n        }\n        prevent = false;\n      }, delay);\n    },\n    [index, onOpen],\n  );\n\n  const dbClickHandler = useCallback(\n    (e) => {\n      e.persist();\n      clearTimeout(timer);\n      prevent = true;\n      onOpen(index, { source: triggerSource.dbClick, shiftKey: e.shiftKey });\n    },\n    [index, onOpen],\n  );\n\n  useEffect(() => {\n    setActiveState(isOpen ? { backgroundColor: '#ccc' } : null);\n  }, [isOpen]);\n\n  return (\n    <div\n      ref={refContainer}\n      style={{\n        ...styles.container,\n        flex: active == null ? 0 : '1 1 1px',\n        transition: isOpen ? 'flex 0.2s ease' : '',\n      }}\n      className=\"custom-accordion\"\n    >\n      <button\n        type=\"button\"\n        style={styles.button}\n        onClick={toggleAccordion}\n        onDoubleClick={dbClickHandler}\n      >\n        <p style={styles.buttonTitle}>{title}</p>\n      </button>\n      <div\n        ref={refContent}\n        style={{\n          ...styles.content,\n          maxHeight: active == null ? 0 : '100%',\n          ...style,\n        }}\n      >\n        {children}\n      </div>\n    </div>\n  );\n}\n\nAccordionItem.defaultProps = {\n  onOpen: function () {\n    return null;\n  },\n};\n\nexport default AccordionItem;\n","import {\n  useState,\n  useRef,\n  useCallback,\n  useMemo,\n  useEffect,\n  Children,\n  cloneElement,\n} from 'react';\n\nimport { triggerSource } from './AccordionItem';\n\nconst styles = {\n  container: {\n    height: '100%',\n    width: '100%',\n    display: 'flex',\n    flexDirection: 'column',\n  },\n};\nlet forcedOpenedElements = [];\nlet alwaysOpen = null;\nfunction Accordion({ children, defaultOpenIndex = 0 }) {\n  const [elements, setElements] = useState([]);\n  const refContainer = useRef();\n\n  const handleOpen = useCallback(\n    (index, trigger) => {\n      let el = elements.slice();\n      if (trigger.source === triggerSource.click) {\n        el = el.map((e, i) => (i === index && alwaysOpen !== index ? !e : e));\n      } else {\n        el = el.map((e, i) => (i === index ? true : false));\n        if (trigger.shiftKey) {\n          if (alwaysOpen === index) {\n            alwaysOpen = null;\n          } else {\n            alwaysOpen = index;\n          }\n        } else {\n          alwaysOpen = null;\n        }\n      }\n\n      forcedOpenedElements = el;\n      setElements(el);\n    },\n    [elements],\n  );\n\n  const mappedChildren = useMemo(() => {\n    return Children.map(children, (child, index) => {\n      return (\n        child &&\n        cloneElement(child, {\n          onOpen: handleOpen,\n          index,\n          isOpen: elements && elements[index],\n        })\n      );\n    });\n  }, [children, elements, handleOpen]);\n\n  useEffect(() => {\n    if (defaultOpenIndex != null) {\n      setElements((prevState) => {\n        if (prevState.length > 0) {\n          return prevState.map((e, i) =>\n            !forcedOpenedElements[i]\n              ? i === defaultOpenIndex\n                ? true\n                : false\n              : e,\n          );\n        }\n        forcedOpenedElements = Array(children.length)\n          .fill(false)\n          .map((e) => e);\n\n        return Array(children.length)\n          .fill(false)\n          .map((e, i) => (i === defaultOpenIndex ? true : e));\n      });\n    }\n  }, [children.length, defaultOpenIndex]);\n\n  return (\n    <div ref={refContainer} style={styles.container}>\n      {mappedChildren}\n    </div>\n  );\n}\n\nexport default Accordion;\n","import { css } from '@emotion/react';\n\nconst HighlightedRowStyle = css`\n  background-color: #ff6f0057;\n`;\n\nconst ConstantlyHighlightedRowStyle = css`\n  background-color: #f5f5dc;\n`;\n\nconst ReactTableStyle = css`\n  border-spacing: 0;\n  border: 1px solid #dedede;\n  width: 100%;\n  height: 100%;\n  font-size: 12px;\n\n  .react-contextmenu-wrapper {\n    display: contents;\n  }\n\n  tr {\n    :last-child {\n      td {\n        border-bottom: 0;\n      }\n    }\n  }\n  th,\n  td {\n    margin: 0;\n    padding: 0.15rem 0.4rem;\n    border-bottom: 1px solid #dedede;\n    border-right: 1px solid #dedede;\n\n    :last-child {\n      border-right: 0;\n    }\n    button {\n      background-color: transparent;\n      border: none;\n    }\n  }\n`;\n\nexport { ReactTableStyle, HighlightedRowStyle, ConstantlyHighlightedRowStyle };\n","/** @jsxImportSource @emotion/react */\n\nimport { memo } from 'react';\nimport { useTable, useSortBy, useFlexLayout } from 'react-table';\n\nimport { ReactTableStyle } from './Style';\n\nfunction ReactTableFlexLayout({ data, columns, onMouseDown }) {\n  const {\n    getTableProps,\n    getTableBodyProps,\n    headerGroups,\n    rows,\n    prepareRow,\n  } = useTable(\n    {\n      columns,\n      data,\n    },\n    useSortBy,\n    useFlexLayout,\n  );\n  return (\n    <table {...getTableProps()} css={ReactTableStyle}>\n      <thead>\n        {headerGroups.map((headerGroup) => (\n          <tr\n            key={headerGroup.getHeaderGroupProps().key}\n            {...headerGroup.getHeaderGroupProps()}\n          >\n            {headerGroup.headers.map((column) => (\n              <th\n                key={column.getHeaderProps().key}\n                {...column.getHeaderProps(column.getSortByToggleProps())}\n              >\n                {column.render('Header')}\n                <span>\n                  {column.isSorted ? (column.isSortedDesc ? ' ' : ' ') : ''}\n                </span>\n              </th>\n            ))}\n          </tr>\n        ))}\n      </thead>\n      <tbody\n        {...getTableBodyProps()}\n        style={{ display: 'block', height: '100%', overflowY: 'auto' }}\n      >\n        {rows.map((row) => {\n          prepareRow(row);\n          return (\n            <tr\n              key={row.getRowProps().key}\n              {...row.getRowProps()}\n              onMouseDown={onMouseDown}\n            >\n              {row.cells.map((cell) => {\n                return (\n                  <td\n                    key={cell.getCellProps().key}\n                    {...cell.getCellProps()}\n                    style={{ ...cell.getCellProps().style, padding: '0px' }}\n                  >\n                    {cell.render('Cell')}\n                  </td>\n                );\n              })}\n            </tr>\n          );\n        })}\n      </tbody>\n    </table>\n  );\n}\n\nReactTableFlexLayout.defaultProps = {\n  onMouseDown: () => {\n    return null;\n  },\n};\n\nexport default memo(ReactTableFlexLayout);\n","import { forwardRef, useMemo } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\n\nfunction InfoWrapper(WrappedComponent) {\n  const Wrapper = (props) => {\n    const { data, activeSpectrum } = useChartData();\n\n    const { info = {}, meta = {} } = useMemo(() => {\n      if (data && activeSpectrum && activeSpectrum.id) {\n        const datum = data.find((datum) => datum.id === activeSpectrum.id) || {\n          info: {},\n          meta: {},\n        };\n        return datum;\n      }\n      return {};\n    }, [activeSpectrum, data]);\n\n    const { forwardedRef, ...rest } = props;\n    return (\n      <WrappedComponent {...rest} info={info} meta={meta} ref={forwardedRef} />\n    );\n  };\n\n  return forwardRef((props, ref) => {\n    return <Wrapper {...props} forwardedRef={ref} />;\n  });\n}\nexport default InfoWrapper;\n","import { useState, useCallback, useEffect, memo, useMemo, useRef } from 'react';\n\nimport ReactTableFlexLayout from '../elements/ReactTable/ReactTableFlexLayout';\nimport InfoWrapper from '../hoc/InfoWrapper';\n\nconst styles = {\n  container: {\n    height: '100%',\n  },\n  tableContainer: {\n    height: 'calc(100% - 30px)',\n  },\n  searchInput: {\n    width: '100%',\n    borderRadius: '5px',\n    border: '0.55px solid gray',\n    padding: '5px',\n    marginBottom: '2px',\n  },\n};\n\n// information panel\nfunction InformationPanel({ info, meta }) {\n  const [information, setInformation] = useState({});\n  const [matches, setMatchesData] = useState([]);\n  const searchRef = useRef();\n\n  const handleSearch = useCallback(\n    (e) => {\n      const values = Object.keys(information).filter((key) =>\n        key\n          .toLowerCase()\n          .includes(e.target ? e.target.value.toLowerCase() : e.toLowerCase()),\n      );\n      setMatchesData(values);\n    },\n    [information],\n  );\n\n  useEffect(() => {\n    if (searchRef.current) {\n      handleSearch(searchRef.current.value);\n    }\n  }, [handleSearch, searchRef]);\n\n  useEffect(() => {\n    if (info && meta) {\n      const keys = Object.keys(info).concat(Object.keys(meta));\n      setMatchesData(keys);\n      setInformation({\n        ...info,\n        ...meta,\n      });\n    }\n  }, [info, meta]);\n\n  const columns = useMemo(\n    () => [\n      {\n        Header: 'Parameter',\n        sortType: 'basic',\n        minWidth: 100,\n        width: 20,\n        maxWidth: 20,\n        Cell: ({ row }) => (\n          <p style={{ padding: '5px', backgroundColor: 'white' }}>\n            {row.original}\n          </p>\n        ),\n      },\n      {\n        Header: 'Value',\n        sortType: 'basic',\n        resizable: true,\n        Cell: ({ row }) => (\n          <p\n            style={{\n              backgroundColor: '#efefef',\n              height: '100%',\n              padding: '5px',\n              fontFamily: 'monospace',\n              whiteSpace: 'pre',\n              overflow: 'hidden',\n            }}\n          >\n            {information[row.original].toString()}\n          </p>\n        ),\n      },\n    ],\n    [information],\n  );\n\n  return (\n    <div style={styles.container}>\n      <div>\n        <input\n          type=\"text\"\n          style={styles.searchInput}\n          placeholder=\"Search for parameter...\"\n          onChange={handleSearch}\n          ref={searchRef}\n        />\n      </div>\n      <div style={styles.tableContainer}>\n        <ReactTableFlexLayout data={matches} columns={columns} />\n      </div>\n    </div>\n  );\n}\n\nexport default InfoWrapper(memo(InformationPanel));\n","import { forwardRef, useMemo } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\nimport { usePreferences } from '../context/PreferencesContext';\n\nfunction IntegralsWrapper(WrappedComponent) {\n  const Wrapper = (props) => {\n    const {\n      data,\n      activeSpectrum,\n      xDomain,\n      activeTab,\n      tabActiveSpectrum,\n      molecules,\n    } = useChartData();\n    const preferences = usePreferences();\n\n    const { integrals = {}, info = {} } = useMemo(() => {\n      if (data && activeSpectrum && activeSpectrum.id) {\n        const datum = data.find((datum) => datum.id === activeSpectrum.id) || {\n          integrals: {},\n          info: {},\n        };\n        return datum;\n      }\n      return {};\n    }, [activeSpectrum, data]);\n\n    const nucleus = useMemo(() => {\n      if (tabActiveSpectrum && Object.keys(tabActiveSpectrum).length > 0) {\n        return Object.keys(tabActiveSpectrum);\n      }\n      return null;\n    }, [tabActiveSpectrum]);\n\n    const { forwardedRef, ...rest } = props;\n    return (\n      <WrappedComponent\n        {...rest}\n        integrals={integrals}\n        info={info}\n        xDomain={xDomain}\n        preferences={preferences}\n        activeTab={activeTab}\n        nucleus={nucleus}\n        molecules={molecules}\n        ref={forwardedRef}\n      />\n    );\n  };\n\n  return forwardRef((props, ref) => {\n    return <Wrapper {...props} forwardedRef={ref} />;\n  });\n}\nexport default IntegralsWrapper;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useRef, useCallback } from 'react';\n\nimport CloseButton from '../../elements/CloseButton';\n\nconst styles = css`\n  display: flex;\n  flex-direction: column;\n  width: 450px;\n  padding: 5px;\n  button:focus {\n    outline: none;\n  }\n  .header {\n    height: 24px;\n    border-bottom: 1px solid #f0f0f0;\n    display: flex;\n    span {\n      color: #464646;\n      font-size: 15px;\n      flex: 1;\n    }\n\n    button {\n      background-color: transparent;\n      border: none;\n      svg {\n        height: 16px;\n      }\n    }\n  }\n  .container {\n    display: flex;\n    margin: 30px 5px;\n    input,\n    button {\n      padding: 5px;\n      border: 1px solid gray;\n      border-radius: 5px;\n      height: 36px;\n      margin: 2px;\n    }\n    input {\n      flex: 10;\n    }\n    button {\n      flex: 2;\n      color: white;\n      background-color: gray;\n    }\n  }\n`;\n\nfunction NumberInput({ onSave, onClose, header }) {\n  const valueReft = useRef();\n\n  const saveHandler = useCallback(() => {\n    onSave(valueReft.current.value);\n  }, [onSave]);\n\n  const handleKeyDown = useCallback(\n    (event) => {\n      if (event.key === 'Enter') {\n        onSave(valueReft.current.value);\n      }\n    },\n    [onSave],\n  );\n\n  return (\n    <div css={styles}>\n      <div className=\"header handle\">\n        <span>{header}</span>\n\n        <CloseButton onClick={onClose} />\n      </div>\n      <div className=\"container\">\n        <input\n          ref={valueReft}\n          type=\"number\"\n          placeholder=\"Enter the new value\"\n          onKeyDown={handleKeyDown}\n        />\n        <button type=\"button\" onClick={saveHandler}>\n          Set\n        </button>\n      </div>\n    </div>\n  );\n}\n\nNumberInput.defaultProps = {\n  onSave: () => {\n    return null;\n  },\n  onClose: () => {\n    return null;\n  },\n};\nexport default NumberInput;\n","/** @jsxImportSource @emotion/react */\n\nimport { css } from '@emotion/react';\nimport {\n  useState,\n  Children,\n  useMemo,\n  useEffect,\n  useCallback,\n  memo,\n} from 'react';\nimport { FaAngleLeft } from 'react-icons/fa';\nimport { useMeasure } from 'react-use';\n\nfunction Arrow({ direction, onClick }) {\n  return (\n    <div\n      onClick={onClick}\n      css={css`\n        display: flex;\n        position: absolute;\n        top: calc(50% - 18px);\n        ${direction === 'right' ? `right: 25px` : `left: 25px`};\n        height: 36px;\n        width: 36px;\n        justify-content: center;\n        background: white;\n        border-radius: 50%;\n        cursor: pointer;\n        align-items: center;\n        border: none;\n        transition: transform ease-in 0.1s;\n        &:hover {\n          transform: scale(1.2);\n          background-color: #607d8b;\n          color: white;\n        }\n        img {\n          transform: translateX(${direction === 'left' ? '-2' : '2'}px);\n          &:focus {\n            outline: 0;\n          }\n        }\n      `}\n    >\n      <FaAngleLeft\n        style={{ transform: `scaleX(${direction === 'right' ? '-1' : '1'})` }}\n      />\n    </div>\n  );\n}\n\nconst transition = 0.45;\n\nfunction NextPrev({ children, loop, defaultIndex, onChange }) {\n  const [ref, { width }] = useMeasure();\n  const [activeIndex, setActiveIndex] = useState(0);\n  useEffect(() => {\n    setActiveIndex(defaultIndex);\n  }, [defaultIndex]);\n\n  const Sliders = useMemo(\n    () =>\n      Children.map(children, (child) => {\n        return (\n          <div\n            key={child.key}\n            css={css`\n              width: ${width}px;\n              height: 100%;\n            `}\n          >\n            {child}\n          </div>\n        );\n      }),\n    [children, width],\n  );\n\n  const nextHandler = useCallback(() => {\n    setActiveIndex((preActiveIndex) => {\n      if (preActiveIndex === Sliders.length - 1) {\n        onChange(preActiveIndex);\n\n        if (loop) {\n          return 0;\n        } else {\n          return preActiveIndex;\n        }\n      }\n\n      const nextIndex = preActiveIndex + 1;\n      onChange(nextIndex);\n\n      return nextIndex;\n    });\n  }, [Sliders.length, loop, onChange]);\n\n  const prevHandler = useCallback(() => {\n    setActiveIndex((preActiveIndex) => {\n      if (preActiveIndex === 0) {\n        onChange(preActiveIndex);\n        if (loop) {\n          return 0;\n        } else {\n          return preActiveIndex;\n        }\n      }\n      const prevIndex = preActiveIndex - 1;\n\n      onChange(prevIndex);\n\n      return prevIndex;\n    });\n  }, [loop, onChange]);\n\n  if (!width && !Sliders) return null;\n  return (\n    <div\n      css={css`\n        position: relative;\n        height: 100%;\n        width: 100%;\n        margin: 0 auto;\n        overflow: hidden;\n      `}\n      ref={ref}\n    >\n      <div\n        css={css`\n          transform: translateX(-${width * activeIndex}px);\n          transition: transform ease-out ${transition}s;\n          height: 100%;\n          width: ${width * Sliders.length}px;\n          display: flex;\n        `}\n      >\n        {Sliders}\n      </div>\n\n      {activeIndex !== 0 && <Arrow direction=\"left\" onClick={prevHandler} />}\n      {activeIndex !== Sliders.length - 1 && (\n        <Arrow direction=\"right\" onClick={nextHandler} />\n      )}\n    </div>\n  );\n}\n\nNextPrev.defaultProps = {\n  loop: false,\n  defaultIndex: 0,\n  onChange: () => null,\n};\nexport default memo(NextPrev);\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback, useEffect, useState } from 'react';\nimport MF from 'react-mf/lib/components/MF';\nimport { MolfileSvgRenderer } from 'react-ocl/full';\n\nimport NextPrev from './NextPrev';\n\nconst toolbarStyle = css`\n  display: flex;\n  flex-direction: row;\n  border-top: 0.55px solid rgb(240, 240, 240);\n  border-bottom: 0.55px solid rgb(240, 240, 240);\n  padding: 0px 5px;\n\n  p {\n    margin: 0;\n    text-align: right;\n    width: 100%;\n    line-height: 22px;\n    padding: 0px 10px;\n  }\n`;\n\nconst moleculeContainerStyle = css`\n  width: 450px;\n\n  .slider {\n    height: 180px;\n    width: 100%;\n    padding: 0px;\n    height: 180px;\n    width: 100%;\n    padding: 0px;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    flex-direction: column;\n  }\n  .slider p {\n    width: 100%;\n    margin: 0 auto;\n    display: block;\n    position: relative;\n    text-align: center;\n  }\n  .slider svg polygon {\n    fill: gray !important;\n  }\n  button {\n    flex: 2;\n    padding: 5px;\n    border: 1px solid gray;\n    border-radius: 5px;\n    height: 36px;\n    margin: 0 auto;\n    margin-top: 15px;\n    display: block;\n    width: 20%;\n\n    color: white;\n    background-color: gray;\n  }\n`;\n\nfunction MoleculeSelection({ molecules, onChange }) {\n  const [currentIndex, setCurrentIndex] = useState();\n\n  useEffect(() => {\n    if (molecules && molecules.length > 0) {\n      setCurrentIndex(0);\n    }\n  }, [molecules]);\n\n  const onChangeHandler = useCallback(\n    (slideIndex) => {\n      setCurrentIndex(slideIndex);\n      onChange(slideIndex);\n    },\n    [onChange],\n  );\n\n  return (\n    <div>\n      <div css={toolbarStyle}>\n        <p>\n          {molecules &&\n            molecules.length > 0 &&\n            `${+(currentIndex + 1)} / ${molecules.length}`}{' '}\n        </p>\n      </div>\n      <div css={moleculeContainerStyle}>\n        <NextPrev onChange={onChangeHandler}>\n          {molecules &&\n            molecules.map((mol, index) => (\n              <div key={mol.key} className=\"slider\">\n                <div>\n                  <MolfileSvgRenderer\n                    id={`molSVG${index}`}\n                    width={120}\n                    molfile={mol.molfile}\n                  />\n                </div>\n                <p>\n                  <MF mf={mol.mf} /> - {mol.mw.toFixed(2)}\n                </p>\n              </div>\n            ))}\n        </NextPrev>\n      </div>\n    </div>\n  );\n}\n\nMoleculeSelection.defaultProps = {\n  onChange: () => {\n    return null;\n  },\n};\n\nexport default MoleculeSelection;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback, useState, useEffect, useMemo } from 'react';\n\nimport { usePreferences } from '../../context/PreferencesContext';\nimport MoleculeSelection from '../../elements/MoleculeSelection';\n\nconst selectMoleculeContainerStyle = css`\n  display: flex;\n  flex-direction: column;\n  flex-grow: 1;\n`;\n\nconst optionalTextStyle = css`\n  display: flex;\n  flex-direction: column;\n  padding: 5px;\n\n  .optional {\n    margin-top: 5px;\n    margin-bottom: 5px;\n    padding: 0px 10px;\n\n    text-align: center;\n    font-size: 18px;\n    font-weight: bold;\n  }\n  .optional2 {\n    margin-top: 5px;\n    margin-bottom: 25px;\n    padding: 0px 10px;\n    width: 100%;\n\n    text-align: center;\n  }\n`;\n\nconst moleculeContainerStyle = css`\n  button {\n    flex: 2;\n    padding: 5px;\n    border: 1px solid gray;\n    border-radius: 5px;\n    height: 36px;\n    margin: 0 auto;\n    margin-top: 15px;\n    display: block;\n    width: 20%;\n\n    color: white;\n    background-color: gray;\n  }\n\n  .newSumText {\n    margin-top: 15px;\n    padding: 0px 10px;\n    width: 100%;\n\n    text-align: center;\n  }\n`;\n\nfunction SelectMolecule({ onSave, molecules, element }) {\n  const [currentIndex, setCurrentIndex] = useState();\n  const {\n    display: { general, panels },\n  } = usePreferences();\n\n  const newSum = useMemo(() => {\n    return element &&\n      molecules &&\n      molecules.length > 0 &&\n      currentIndex !== undefined &&\n      molecules[currentIndex].atoms[element]\n      ? molecules[currentIndex].atoms[element]\n      : 0;\n  }, [currentIndex, element, molecules]);\n\n  useEffect(() => {\n    if (molecules && molecules.length > 0) {\n      setCurrentIndex(0);\n    }\n  }, [molecules]);\n\n  const saveSelectMoleculeHandler = useCallback(\n    (e) => {\n      e.preventDefault();\n      onSave(newSum);\n    },\n    [newSum, onSave],\n  );\n\n  const onChangeMoleculeSelectionHandler = useCallback((index) => {\n    setCurrentIndex(index);\n  }, []);\n\n  return !general.hideSetSumFromMolecule &&\n    !panels.hideStructuresPanel &&\n    element &&\n    molecules &&\n    molecules.length > 0 ? (\n    <div css={selectMoleculeContainerStyle}>\n      <div css={optionalTextStyle}>\n        <p className=\"optional\">OR</p>\n        <p className=\"optional2\">Select a molecule as reference!</p>\n      </div>\n      <div css={moleculeContainerStyle}>\n        <MoleculeSelection\n          molecules={molecules}\n          onChange={onChangeMoleculeSelectionHandler}\n        />\n        <button type=\"button\" onClick={saveSelectMoleculeHandler}>\n          Set\n        </button>\n        <p className=\"newSumText\">\n          New sum for {element} will be {newSum}!\n        </p>\n      </div>\n    </div>\n  ) : null;\n}\n\nSelectMolecule.defaultProps = {\n  onSave: () => {\n    return null;\n  },\n};\nexport default SelectMolecule;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback } from 'react';\n\nimport NumberInput from './NumberInput';\nimport SelectMolecule from './SelectMolecule';\n\nconst modalContainer = css`\n  display: flex;\n  flex-direction: column;\n  padding: 5px;\n`;\n\nfunction ChangeSumModal({ onSave, onClose, header, molecules, element }) {\n  const saveInputValueHandler = useCallback(\n    (inputValue) => {\n      onSave(inputValue);\n    },\n    [onSave],\n  );\n\n  const saveSelectMoleculeHandler = useCallback(\n    (sum) => {\n      onSave(sum);\n    },\n    [onSave],\n  );\n\n  return (\n    <div css={modalContainer}>\n      <NumberInput\n        onSave={saveInputValueHandler}\n        onClose={onClose}\n        header={header}\n      />\n\n      <SelectMolecule\n        onSave={saveSelectMoleculeHandler}\n        molecules={molecules}\n        element={element}\n      />\n    </div>\n  );\n}\n\nChangeSumModal.defaultProps = {\n  onSave: () => {\n    return null;\n  },\n  onClose: () => {\n    return null;\n  },\n};\nexport default ChangeSumModal;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { memo, useCallback, useState } from 'react';\n\nimport ToolTip from './ToolTip/ToolTip';\n\nconst styles = css`\n  background-color: transparent;\n  border: none;\n  border-radius: 5px;\n\n  &:hover {\n    background-color: lightgray;\n  }\n\n  &.toggle-active {\n    background-color: gray;\n    color: white;\n  }\n`;\n\nfunction ToggleButton({\n  children,\n  style,\n  onClick,\n  popupTitle,\n  popupPlacement,\n  defaultValue,\n  disabled,\n}) {\n  const [flag, Toggle] = useState(defaultValue);\n\n  const toggleHandler = useCallback(() => {\n    onClick(!flag);\n\n    Toggle(!flag);\n  }, [onClick, flag]);\n  return (\n    <ToolTip title={popupTitle} popupPlacement={popupPlacement}>\n      <button\n        disabled={disabled}\n        css={styles}\n        style={style}\n        className={flag ? 'toogle toggle-active' : 'toggle'}\n        type=\"button\"\n        onClick={toggleHandler}\n      >\n        {children}\n      </button>\n    </ToolTip>\n  );\n}\n\nToggleButton.defaultProps = {\n  popupTitle: '',\n  popupPlacement: 'right',\n  style: {},\n  defaultValue: false,\n  onClick: () => null,\n  disabled: false,\n};\n\nexport default memo(ToggleButton);\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { memo } from 'react';\nimport { FaRegTrashAlt, FaCog, FaFilter } from 'react-icons/fa';\n\nimport ToggleButton from '../../elements/ToggleButton';\nimport ToolTip from '../../elements/ToolTip/ToolTip';\n\nconst styles = css`\n  \n  display: flex;\n  flex-direction: row;\n  border-bottom: 0.55px solid rgb(240, 240, 240);\n  padding: 0px 5px;\n\n  button {\n    background-color: transparent;\n    border: none;\n    padding: 5px;\n  }\n\n  button:disabled{\n    opacity:0.6;\n  }\n  \n  .counter-label {\n    margin: 0;\n    text-align: right;\n    width: 100%;\n    line-height: 22px;\n    padding: 0px 10px;\n  }\n\n  filter-button{\n    borderRadius: 5px;\n    marginTop: 3px;\n    marginLeft: 5px;\n    color: black;\n    backgroundColor: transparent;\n    border: none;\n    height: 16px;\n    width: 18px;\n    fontSize: 12px;\n    padding: 0;\n  },\n\n`;\n\nfunction DefaultPanelHeader({\n  counter,\n  onDelete,\n  deleteToolTip,\n  onFilter,\n  filterToolTip,\n  filterIsActive,\n  counterFiltered,\n  children,\n  onSettingClick,\n  showSettingButton,\n  canDelete,\n}) {\n  return (\n    <div css={styles}>\n      {canDelete && (\n        <ToolTip title={deleteToolTip} popupPlacement=\"right\">\n          <button type=\"button\" onClick={onDelete} disabled={counter === 0}>\n            <FaRegTrashAlt />\n          </button>\n        </ToolTip>\n      )}\n\n      {/* Optional if there is no filter needed, e.g. in spectra panel */}\n      {onFilter && filterToolTip ? (\n        <ToggleButton\n          popupTitle={filterToolTip}\n          popupPlacement=\"right\"\n          onClick={onFilter}\n          // defaultValue={filterIsActive && filterIsActive === true}\n        >\n          <FaFilter style={{ pointerEvents: 'none', fontSize: '12px' }} />\n        </ToggleButton>\n      ) : null}\n\n      {children}\n\n      {counter ? (\n        <p className=\"counter-label\">\n          [{' '}\n          {filterIsActive &&\n          filterIsActive === true &&\n          counterFiltered !== undefined\n            ? `${counterFiltered}/${counter}`\n            : counter}{' '}\n          ]\n        </p>\n      ) : (\n        <p style={{ flex: 1 }} />\n      )}\n      {showSettingButton && (\n        <ToolTip title=\"preferences\" popupPlacement=\"left\">\n          <button type=\"button\" onClick={onSettingClick}>\n            <FaCog />\n          </button>\n        </ToolTip>\n      )}\n    </div>\n  );\n}\n\nDefaultPanelHeader.defaultProps = {\n  counter: 0,\n  onDelete: () => null,\n  deleteToolTip: 'Delete',\n  onFilter: () => null,\n  filterToolTip: '',\n  filterIsActive: false,\n  counterFiltered: 0,\n  onSettingClick: () => null,\n  showSettingButton: false,\n  canDelete: true,\n};\n\nexport default memo(DefaultPanelHeader);\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport PropTypes from 'prop-types';\nimport { memo } from 'react';\nimport { FaCheck } from 'react-icons/fa';\n\nimport ToolTip from './ToolTip/ToolTip';\n\nconst styles = css`\n  background-color: transparent;\n  border: none;\n  height: 100%;\n  svg {\n    fill: green;\n    font-size: 16px;\n  }\n`;\nfunction SaveButton({\n  onClick,\n  popupTitle,\n  popupPlacement,\n  disabled,\n  className,\n}) {\n  return (\n    <div className={className}>\n      <ToolTip title={popupTitle} popupPlacement={popupPlacement}>\n        <button\n          css={styles}\n          type=\"button\"\n          onClick={onClick}\n          disabled={disabled}\n          className={className}\n        >\n          <FaCheck />\n        </button>\n      </ToolTip>\n    </div>\n  );\n}\n\nSaveButton.defaultProps = {\n  onClick: () => null,\n  popupTitle: 'Save',\n  popupPlacement: 'left',\n  disabled: false,\n  className: '',\n};\nSaveButton.propTypes = {\n  onClick: PropTypes.func,\n  popupTitle: PropTypes.string,\n  popupPlacement: PropTypes.string,\n  disabled: PropTypes.bool,\n  className: PropTypes.string,\n};\n\nexport default memo(SaveButton);\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { memo } from 'react';\n\nimport CloseButton from '../../elements/CloseButton';\nimport SaveButton from '../../elements/SaveButton';\n\nconst styles = css`\n  display: flex;\n  flex-direction: row-reverse;\n  border-bottom: 0.55px solid rgb(240, 240, 240);\n\n  button {\n    background-color: transparent;\n    border: none;\n    padding: 5px;\n  }\n  button:disabled {\n    opacity: 0.6;\n  }\n`;\nfunction PreferencesHeader({ onClose, onSave }) {\n  return (\n    <div css={styles}>\n      <CloseButton onClick={onClose} popupTitle=\"close Preferences\" />\n      <SaveButton onClick={onSave} popupTitle=\"save Preferences\" />\n    </div>\n  );\n}\n\nexport default memo(PreferencesHeader);\n","import {\n  forwardRef,\n  useCallback,\n  useEffect,\n  useImperativeHandle,\n  useRef,\n  useState,\n} from 'react';\n\nimport Input from './Input';\n\nconst EditableColumn = forwardRef(function EditableColumn(\n  { onSave, value, type, style, onEditStart, editStatus },\n  ref,\n) {\n  const [enabled, enableEdit] = useState();\n  const refInput = useRef();\n\n  useEffect(() => {\n    enableEdit(editStatus);\n  }, [editStatus]);\n\n  useImperativeHandle(ref, () => ({\n    startEdit: () => {\n      enableEdit(true);\n    },\n    closeEdit: () => {\n      enableEdit(false);\n    },\n  }));\n\n  const editModeHandler = useCallback(\n    (flag, event = null) => {\n      if (!flag) {\n        if (event.keyCode === 13) {\n          // when press Enter\n          onSave(event);\n          enableEdit(flag);\n        } else if (event.keyCode === 27) {\n          // when press Escape\n          enableEdit(flag);\n        }\n      } else {\n        onEditStart(event);\n        enableEdit(flag);\n      }\n    },\n    [onEditStart, onSave],\n  );\n\n  return (\n    <div\n      style={{ display: 'table', width: '100%', height: '100%', ...style }}\n      onDoubleClick={(event) => editModeHandler(true, event)}\n    >\n      {!enabled && (\n        <span style={{ display: 'table-cell', verticalAlign: 'middle' }}>\n          {value}\n        </span>\n      )}\n      {enabled && (\n        <div style={{ display: 'table-cell', verticalAlign: 'middle' }}>\n          <Input\n            enableAutoSelect\n            ref={refInput}\n            value={value}\n            type={type}\n            onKeyDown={(e) => editModeHandler(false, e)}\n          />\n        </div>\n      )}\n    </div>\n  );\n});\n\nEditableColumn.defaultProps = {\n  onSave: () => null,\n  onEditStart: () => null,\n  type: 'text',\n  editStatus: false,\n};\n\nexport default EditableColumn;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport {\n  forwardRef,\n  useState,\n  useImperativeHandle,\n  useCallback,\n  useRef,\n  useEffect,\n} from 'react';\nimport { createPortal } from 'react-dom';\n\nimport { useGlobal } from '../context/GlobalContext';\n\nconst styles = css`\n  box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.25);\n  padding: 0px;\n  margin: 0px;\n  border-radius: 2px;\n  display: flex;\n  flex-direction: column;\n  position: fixed;\n  z-index: 99999;\n  padding: 2px;\n  background-color: white;\n  width: 150px;\n  button {\n    background-color: transparent;\n    border: none;\n    border-bottom: 0.55px solid #f0f0f0;\n    font-size: 11px;\n    padding: 5px;\n    text-align: left;\n    outline: none;\n  }\n  button:hover {\n    background-color: #fafafa;\n    outline: none;\n  }\n\n  button:active {\n    background-color: #eaeaea;\n    outline: none;\n  }\n\n  button:last-of-type {\n    border: none;\n  }\n`;\nfunction ContextMenu({ context }, ref) {\n  const [position, setPosition] = useState({ lef: 0, top: 0 });\n  const { rootRef, elementsWraperRef } = useGlobal();\n  const [data, setData] = useState();\n  const [isVisible, show] = useState();\n  const [sourceElement, setSourceElement] = useState(null);\n  const root = useRef();\n\n  useEffect(() => {\n    root.current = document.createElement('div');\n    if (elementsWraperRef) {\n      elementsWraperRef.appendChild(root.current);\n    }\n    return () => {\n      if (root.current && elementsWraperRef) {\n        elementsWraperRef.removeChild(root.current);\n      }\n    };\n  }, [elementsWraperRef]);\n\n  const contextMenuHandler = (event) => {\n    event.preventDefault();\n    setSourceElement(event.target.parentElement);\n    show(true);\n    const clickX = event.clientX;\n    const clickY = event.clientY;\n\n    const screenW = window.innerWidth;\n    const screenH = window.innerHeight;\n    const rootW = 150;\n    const rootH = 0;\n\n    const right = screenW - clickX > rootW;\n    let left = !right;\n    let top = screenH - clickY > rootH;\n    const bottom = !top;\n    if (right) {\n      left = `${clickX + 5}px`;\n    }\n\n    if (left) {\n      left = `${clickX - rootW - 5}px`;\n    }\n\n    if (top) {\n      top = `${clickY + 5}px`;\n    }\n\n    if (bottom) {\n      top = `${clickY - rootH - 5}px`;\n    }\n\n    setPosition({ left, top });\n  };\n\n  useImperativeHandle(ref, () => ({\n    handleContextMenu: (e, _data) => {\n      setData(_data);\n      contextMenuHandler(e);\n    },\n  }));\n\n  const clickHandler = useCallback(\n    (event, click) => {\n      event.preventDefault();\n      click(data);\n      show(false);\n    },\n    [data],\n  );\n\n  useEffect(() => {\n    const _handleGlobalClick = (event) => {\n      const wasOutside =\n        sourceElement &&\n        event.target.parentElement &&\n        !event.target.parentElement.isSameNode(sourceElement);\n      if (wasOutside && isVisible) show(false);\n    };\n    if (rootRef) {\n      rootRef.addEventListener('click', _handleGlobalClick);\n    }\n    return () => {\n      if (rootRef) {\n        rootRef.removeEventListener('click', _handleGlobalClick);\n      }\n    };\n  }, [isVisible, ref, rootRef, sourceElement]);\n\n  if (!isVisible) {\n    return null;\n  }\n\n  return (\n    root.current &&\n    createPortal(\n      context && (\n        <div ref={ref} css={[styles, position]}>\n          {context.map((c, index) => (\n            <button\n              // eslint-disable-next-line react/no-array-index-key\n              key={index}\n              type=\"button\"\n              onClick={(e) => clickHandler(e, c.onClick)}\n            >\n              {c.label}\n            </button>\n          ))}\n        </div>\n      ),\n      root.current,\n    )\n  );\n}\n\nexport default forwardRef(ContextMenu);\n","const ReactTableHeader = ({ headerGroups }) => {\n  return (\n    <thead>\n      {headerGroups.map((headerGroup) => (\n        <tr\n          key={headerGroup.getHeaderGroupProps().key}\n          {...headerGroup.getHeaderGroupProps()}\n        >\n          {headerGroup.headers.map((column) => (\n            <th\n              key={column.getHeaderProps().key}\n              {...column.getHeaderProps(column.getSortByToggleProps())}\n            >\n              {column.render('Header')}\n              <span>\n                {column.isSorted ? (column.isSortedDesc ? ' ' : ' ') : ''}\n              </span>\n            </th>\n          ))}\n        </tr>\n      ))}\n    </thead>\n  );\n};\n\nexport default ReactTableHeader;\n","/** @jsxImportSource @emotion/react */\n\nimport { useHighlight } from '../../../highlight/index';\nimport { HighlightedRowStyle, ConstantlyHighlightedRowStyle } from '../Style';\n\nconst ReactTableRow = ({ row, onContextMenu }) => {\n  const highlight = useHighlight([\n    Object.prototype.hasOwnProperty.call(row.original, 'id')\n      ? row.original.id\n      : '',\n  ]);\n\n  return (\n    <tr\n      onContextMenu={onContextMenu}\n      key={row.getRowProps().key}\n      css={\n        highlight.isActive\n          ? HighlightedRowStyle\n          : Object.prototype.hasOwnProperty.call(\n              row.original,\n              'isConstantlyHighlighted',\n            ) && row.original.isConstantlyHighlighted === true\n          ? ConstantlyHighlightedRowStyle\n          : null\n      }\n      {...row.getRowProps()}\n      {...highlight.onHover}\n    >\n      {row.cells.map((cell) => {\n        const { minWidth, maxWidth, width, padding } = cell.column;\n        return (\n          <td\n            key={cell.key}\n            {...cell.getCellProps()}\n            onContextMenu={(e) => {\n              e.preventDefault();\n\n              return false;\n            }}\n            style={{ minWidth, maxWidth, width, padding }}\n          >\n            {cell.render('Cell')}\n          </td>\n        );\n      })}\n    </tr>\n  );\n};\n\nexport default ReactTableRow;\n","/** @jsxImportSource @emotion/react */\n\nimport PropTypes from 'prop-types';\nimport { Fragment, useRef, useCallback, memo } from 'react';\nimport { useTable, useSortBy } from 'react-table';\n\nimport checkModifierKeyActivated from '../../../data/utilities/checkModifierKeyActivated';\nimport ContextMenu from '../ContextMenu';\n\nimport ReactTableHeader from './Elements/ReactTableHeader';\nimport ReactTableRow from './Elements/ReactTableRow';\nimport { ReactTableStyle } from './Style';\n\nfunction ReactTable({ data, columns, context }) {\n  const contextRef = useRef();\n  const {\n    getTableProps,\n    getTableBodyProps,\n    headerGroups,\n    rows,\n    prepareRow,\n  } = useTable(\n    {\n      columns,\n      data,\n    },\n    useSortBy,\n  );\n\n  const contextMenuHandler = useCallback(\n    (e, row) => {\n      if (!checkModifierKeyActivated(e)) {\n        e.preventDefault();\n        contextRef.current.handleContextMenu(e, row.original);\n      }\n    },\n    [contextRef],\n  );\n  return (\n    <Fragment>\n      <table {...getTableProps()} css={ReactTableStyle}>\n        <ReactTableHeader headerGroups={headerGroups} />\n        <tbody {...getTableBodyProps()}>\n          {rows.map((row) => {\n            prepareRow(row);\n            return (\n              <ReactTableRow\n                key={row.key}\n                row={row}\n                {...row.getRowProps()}\n                onContextMenu={(e) => contextMenuHandler(e, row)}\n              />\n            );\n          })}\n        </tbody>\n      </table>\n      <ContextMenu ref={contextRef} context={context} />\n    </Fragment>\n  );\n}\n\nReactTable.propTypes = {\n  context: PropTypes.arrayOf(\n    PropTypes.shape({\n      label: PropTypes.string,\n      onClick: PropTypes.func,\n    }),\n  ),\n};\nReactTable.defaultProps = {\n  context: null,\n};\n\nexport default memo(ReactTable);\n","// placeholder for empty tables if no data is available to show (e.g. peaks, integrals, ranges)\nfunction NoTableData() {\n  return (\n    <p\n      style={{\n        textAlign: 'center',\n        width: '100%',\n        fontSize: '11px',\n        padding: '5px',\n        color: 'gray',\n      }}\n    >\n      No Data\n    </p>\n  );\n}\nexport default NoTableData;\n","import lodashGet from 'lodash/get';\nimport { useCallback, useMemo, memo, useRef, useEffect } from 'react';\nimport { FaRegTrashAlt } from 'react-icons/fa';\n\nimport { SignalKinds } from '../../../data/constants/SignalsKinds';\nimport { useDispatch } from '../../context/DispatchContext';\nimport { useGlobal } from '../../context/GlobalContext';\nimport EditableColumn from '../../elements/EditableColumn';\nimport ReactTable from '../../elements/ReactTable/ReactTable';\nimport Select from '../../elements/Select';\nimport IntegralsWrapper from '../../hoc/IntegralsWrapper';\nimport {\n  DELETE_INTEGRAL,\n  CHANGE_INTEGRAL_DATA,\n  CHANGE_INTEGRAL_RELATIVE,\n} from '../../reducer/types/Types';\nimport formatNumber from '../../utility/FormatNumber';\nimport { getValue } from '../../utility/LocalStorage';\nimport NoTableData from '../extra/placeholder/NoTableData';\nimport { integralDefaultValues } from '../extra/preferences/defaultValues';\n\nconst selectStyle = { marginLeft: 10, marginRight: 10, border: 'none' };\n\nfunction IntegralTable({\n  integrals,\n  info,\n  activeTab,\n  xDomain,\n  enableFilter,\n  onFilter,\n  preferences,\n}) {\n  const dispatch = useDispatch();\n  const relativeRefs = useRef([]);\n  const { rootRef } = useGlobal();\n  const deleteIntegralHandler = useCallback(\n    (e, row) => {\n      e.preventDefault();\n      e.stopPropagation();\n      const params = row.original;\n      dispatch({\n        type: DELETE_INTEGRAL,\n        integralID: params.id,\n      });\n    },\n    [dispatch],\n  );\n  const changeIntegralDataHandler = useCallback(\n    (value, row) => {\n      const data = { ...row.original, kind: value };\n      dispatch({\n        type: CHANGE_INTEGRAL_DATA,\n        data,\n      });\n    },\n    [dispatch],\n  );\n  const defaultColumns = useMemo(\n    () => [\n      {\n        orderIndex: 1,\n        Header: '#',\n        Cell: ({ row }) => row.index + 1,\n        width: 10,\n      },\n\n      {\n        orderIndex: 2,\n        Header: 'From',\n        accessor: 'from',\n        sortType: 'basic',\n        resizable: true,\n        Cell: ({ row }) => row.original.from.toFixed(2),\n      },\n      {\n        orderIndex: 3,\n        Header: 'To',\n        accessor: 'to',\n        sortType: 'basic',\n        resizable: true,\n        Cell: ({ row }) => row.original.to.toFixed(2),\n      },\n      {\n        orderIndex: 6,\n        Header: 'Kind',\n        accessor: 'kind',\n        sortType: 'basic',\n        resizable: true,\n        Cell: ({ row }) => (\n          <Select\n            onChange={(value) => changeIntegralDataHandler(value, row)}\n            data={SignalKinds}\n            style={selectStyle}\n            defaultValue={row.original.kind}\n          />\n        ),\n      },\n      {\n        orderIndex: 7,\n        Header: '',\n        width: '1%',\n        maxWidth: '24px',\n        minWidth: '24px',\n        id: 'delete-button',\n        Cell: ({ row }) => (\n          <button\n            type=\"button\"\n            className=\"delete-button\"\n            onClick={(e) => deleteIntegralHandler(e, row)}\n          >\n            <FaRegTrashAlt />\n          </button>\n        ),\n      },\n    ],\n    [changeIntegralDataHandler, deleteIntegralHandler],\n  );\n\n  const saveRealtiveHandler = useCallback(\n    (event, row) => {\n      dispatch({\n        type: CHANGE_INTEGRAL_RELATIVE,\n        value: event.target.value,\n        id: row.id,\n      });\n    },\n    [dispatch],\n  );\n  const editStartHander = useCallback((index) => {\n    relativeRefs.current.forEach((ref, i) => {\n      if (index !== i && ref) {\n        ref.closeEdit();\n      }\n    });\n  }, []);\n\n  useEffect(() => {\n    if (rootRef) {\n      rootRef.addEventListener('mousedown', editStartHander);\n    }\n    return () => {\n      if (rootRef) {\n        rootRef.removeEventListener('mousedown', editStartHander);\n      }\n    };\n  }, [editStartHander, rootRef]);\n\n  const tableColumns = useMemo(() => {\n    const setCustomColumn = (array, index, columnLabel, cellHandler) => {\n      array.push({\n        orderIndex: index,\n        Header: columnLabel,\n        sortType: 'basic',\n        Cell: ({ row }) => cellHandler(row),\n      });\n    };\n\n    const integralsPreferences = getValue(\n      preferences,\n      `formatting.panels.integrals.[${activeTab}]`,\n    );\n    let cols = [...defaultColumns];\n    if (\n      lodashGet(\n        integralsPreferences,\n        'showAbsolute',\n        integralDefaultValues.showAbsolute,\n      )\n    ) {\n      setCustomColumn(cols, 4, 'Absolute', (row) =>\n        formatNumber(\n          row.original.absolute,\n          lodashGet(\n            integralsPreferences,\n            'absoluteFormat',\n            integralDefaultValues.absoluteFormat,\n          ),\n        ),\n      );\n    }\n    if (\n      lodashGet(\n        integralsPreferences,\n        'showRelative',\n        integralDefaultValues.showRelative,\n      )\n    ) {\n      const n = activeTab && activeTab.replace(/[0-9]/g, '');\n      setCustomColumn(cols, 5, `Relative ${n}`, (row) => {\n        const formattedNumber = formatNumber(\n          row.original.integral,\n          lodashGet(\n            integralsPreferences,\n            'relativeFormat',\n            integralDefaultValues.relativeFormat,\n          ),\n        );\n        return (\n          <EditableColumn\n            onEditStart={() => editStartHander(row.index)}\n            ref={(ref) => (relativeRefs.current[row.index] = ref)}\n            value={formattedNumber}\n            onSave={(event) => saveRealtiveHandler(event, row.original)}\n            type=\"number\"\n          />\n        );\n      });\n    }\n\n    return cols.sort(\n      (object1, object2) => object1.orderIndex - object2.orderIndex,\n    );\n  }, [\n    activeTab,\n    defaultColumns,\n    editStartHander,\n    preferences,\n    saveRealtiveHandler,\n  ]);\n\n  const tableData = useMemo(() => {\n    function isInRange(from, to) {\n      const factor = 10000;\n      to = to * factor;\n      from = from * factor;\n      return (\n        (to >= xDomain[0] * factor && from <= xDomain[1] * factor) ||\n        (from <= xDomain[0] * factor && to >= xDomain[1] * factor)\n      );\n    }\n    if (info.dimension === 1 && integrals && integrals.values) {\n      const _integrals = enableFilter\n        ? integrals.values.filter((integral) =>\n            isInRange(integral.from, integral.to),\n          )\n        : integrals.values;\n\n      return _integrals.map((integral) => {\n        return {\n          ...integral,\n          isConstantlyHighlighted: isInRange(integral.from, integral.to),\n        };\n      });\n    }\n    return [];\n  }, [enableFilter, info.dimension, integrals, xDomain]);\n\n  useEffect(() => {\n    onFilter(tableData.length);\n  }, [tableData, onFilter]);\n\n  return tableData && tableData.length > 0 ? (\n    <ReactTable data={tableData} columns={tableColumns} />\n  ) : (\n    <NoTableData />\n  );\n}\n\nexport default IntegralsWrapper(memo(IntegralTable));\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback, memo, useState } from 'react';\nimport { ChromePicker } from 'react-color';\n\nconst style = css`\n  display: flex;\n  margin: 5px 0px;\n\n.inputLabel{\n  flex: 2;\n  font-size: 11px;\n  font-weight: bold;\n  color: #232323;\n}\n\n.input {\n  width: '60%',\n  text-align: 'center',\n}\n\n.color{\n  width: 36px;\n  height: 14px;\n  border-radius: 2px;\n}\n\n.swatch{\n  padding: 5px;\n  background: #fff;\n  border-radius: 1px;\n  box-shadow: 0 0 0 1px rgba(0,0,0,.1);\n  display: inline-block;\n  cursor: pointer;\n}\n.color-popover {\n  position: absolute;\n  z-index: 2;\n}\n\n.cover {\n  position: fixed;\n  top: 0px;\n  right: 0px;\n  bottom: 0px;\n  left: 0px;\n}\n  .chrome-picker {\n    border-radius: none !important;\n    width: 200px !important;\n    height: 60px !important;\n    display: flex;\n\n\n  }\n  .chrome-picker > div:first-of-type {\n    padding: 0px !important;\n\n  }\n  .chrome-picker > div:last-child >  div:first-of-type {\n    width: 120px;\n\n  }\n  .chrome-picker > div:last-child >  div:last-child {\n    display:none !important;\n  }\n`;\n\nfunction ColorInput({ label, onColorChange, name, value }) {\n  const [displayColorPicker, showColorPicker] = useState(false);\n  const [color, setColor] = useState(value);\n\n  const handleClick = useCallback(() => {\n    showColorPicker(!displayColorPicker);\n  }, [displayColorPicker]);\n\n  const handleClose = useCallback(() => {\n    showColorPicker(false);\n  }, []);\n\n  const handleOnColorChanged = useCallback(\n    (colorEvent) => {\n      const hex = `${colorEvent.hex}${Math.round(\n        colorEvent.rgb.a * 255,\n      ).toString(16)}`;\n      setColor(hex);\n      onColorChange({ ...colorEvent, hex, name });\n    },\n    [name, onColorChange],\n  );\n\n  return (\n    <div css={style}>\n      <span className=\"inputLabel\">{label}</span>\n      <div style={{ flex: 4 }}>\n        <div className=\"swatch\" onClick={handleClick}>\n          <div className=\"color\" style={{ backgroundColor: color }} />\n          <input type=\"hidden\" value={color} name={name} />\n        </div>\n        {displayColorPicker ? (\n          <div className=\"color-popover\">\n            <div className=\"cover\" onClick={handleClose} />\n            <ChromePicker\n              color={{ hex: color }}\n              onChangeComplete={handleOnColorChanged}\n            />\n          </div>\n        ) : null}\n      </div>\n    </div>\n  );\n}\n\nColorInput.defaultProps = {\n  value: '#000000',\n  label: 'Color: ',\n  onColorChange: () => null,\n};\n\nexport default memo(ColorInput);\n","import { memo, useState } from 'react';\n\nimport Input from '../../../elements/Input';\n\nconst styles = {\n  row: {\n    display: 'flex',\n    margin: '5px 0px',\n    alignItems: 'center',\n  },\n  inputLabel: {\n    flex: 2,\n    fontSize: '11px',\n    fontWeight: 'bold',\n    color: '#232323',\n  },\n  input: {\n    width: '60%',\n    textAlign: 'center',\n  },\n};\n\nfunction ColumnFormatField({\n  label,\n  checkControllerName,\n  checked,\n  format,\n  formatControllerName,\n  inputChangeHandler,\n  groupID,\n}) {\n  const [_checked, setChecked] = useState(Boolean(checked));\n\n  return (\n    <div style={styles.row}>\n      <span style={styles.inputLabel}>{label}</span>\n      <div\n        style={{\n          flex: 4,\n          display: 'flex',\n          flexDirection: 'row',\n          alignItems: 'center',\n        }}\n      >\n        <input\n          type=\"checkbox\"\n          onChange={(e) => setChecked(e.target.checked)}\n          style={{ margin: '0px 5px' }}\n          defaultChecked={_checked}\n        />\n        <input\n          name={`${groupID}-${checkControllerName}`}\n          type=\"hidden\"\n          value={_checked}\n        />\n        <Input\n          style={{ container: styles.input }}\n          name={`${groupID}-${formatControllerName}`}\n          type=\"text\"\n          onChange={inputChangeHandler}\n          value={format ? format : ''}\n        />\n      </div>\n    </div>\n  );\n}\n\nexport default memo(ColumnFormatField);\n","import lodashGet from 'lodash/get';\nimport lodashSet from 'lodash/set';\nimport {\n  useEffect,\n  useState,\n  useCallback,\n  forwardRef,\n  useImperativeHandle,\n  useRef,\n} from 'react';\nimport { MF } from 'react-mf';\n\nimport ColorInput from '../../elements/ColorInput';\nimport NumberInput from '../../elements/NumberInput';\nimport { useAlert } from '../../elements/popup/Alert';\nimport IntegralsWrapper from '../../hoc/IntegralsWrapper';\nimport { SET_PANELS_PREFERENCES } from '../../reducer/preferencesReducer';\nimport {\n  useStateWithLocalStorage,\n  getValue as getValueByKeyPath,\n} from '../../utility/LocalStorage';\nimport ColumnFormatField from '../extra/preferences/ColumnFormatField';\nimport { integralDefaultValues } from '../extra/preferences/defaultValues';\n\nconst styles = {\n  container: {\n    padding: 10,\n    backgroundColor: '#f1f1f1',\n    height: '100%',\n    flex: 1,\n  },\n  groupContainer: {\n    padding: '5px',\n    borderRadius: '5px',\n    margin: '10px 0px',\n    backgroundColor: 'white',\n  },\n  row: {\n    display: 'flex',\n    margin: '5px 0px',\n  },\n  header: {\n    borderBottom: '1px solid #e8e8e8',\n    paddingBottom: '5px',\n    fontWeight: 'bold',\n    color: '#4a4a4a',\n  },\n  inputLabel: {\n    flex: 2,\n    fontSize: '11px',\n    fontWeight: 'bold',\n    color: '#232323',\n  },\n  input: {\n    width: '30%',\n    textAlign: 'center',\n  },\n};\n\nconst formatFields = [\n  {\n    id: 1,\n    label: 'Absolute :',\n    checkController: 'showAbsolute',\n    formatController: 'absoluteFormat',\n    defaultFormat: '0.00',\n  },\n  {\n    id: 2,\n    label: 'Relative :',\n    checkController: 'showRelative',\n    formatController: 'relativeFormat',\n    defaultFormat: '00.00',\n  },\n];\nfunction IntegralsPreferences({ nucleus, preferences }, ref) {\n  const alert = useAlert();\n  const [, setSettingsData] = useStateWithLocalStorage('nmr-general-settings');\n\n  const [settings, setSetting] = useState(null);\n  const formRef = useRef();\n\n  useEffect(() => {\n    const integralsPreferences = getValueByKeyPath(\n      preferences,\n      'formatting.panels.integrals',\n    );\n\n    if (integralsPreferences) {\n      setSetting(integralsPreferences);\n    }\n  }, [preferences]);\n\n  const saveToLocalStorgate = (values) => {\n    setSettingsData(values, 'formatting.panels.integrals');\n  };\n\n  const saveHandler = useCallback(\n    (values, showMessage = false) => {\n      preferences.dispatch({\n        type: SET_PANELS_PREFERENCES,\n        payload: { key: 'integrals', value: values },\n      });\n      if (showMessage) {\n        alert.success('Integrals preferences saved successfully');\n      }\n    },\n    [alert, preferences],\n  );\n\n  useImperativeHandle(ref, () => ({\n    saveSetting() {\n      if (typeof formRef.current.requestSubmit === 'function') {\n        formRef.current.requestSubmit();\n      } else {\n        formRef.current.dispatchEvent(\n          new Event('submit', { cancelable: true }),\n        );\n      }\n    },\n  }));\n\n  const handleSubmit = async (event) => {\n    event.preventDefault();\n    const form = event.target;\n    const formData = new FormData(form);\n    let values = {};\n    for (const field of formData.entries()) {\n      const keys = field[0].split('-').join('.');\n      const val = ['true', 'false'].includes(field[1])\n        ? field[1] === 'true'\n        : field[1];\n      values = lodashSet(values, keys, val);\n    }\n    saveHandler(values, true);\n    saveToLocalStorgate(values);\n  };\n\n  const getValue = useCallback(\n    (...params) => {\n      if (settings) {\n        const value =\n          params[0] === null\n            ? settings[params[1]]\n            : lodashGet(settings, params.join('.'));\n        return value ? value : null;\n      } else {\n        const keyIndex = params.length - 1;\n        return integralDefaultValues[params[keyIndex]];\n      }\n    },\n    [settings],\n  );\n  return (\n    <div style={styles.container}>\n      <form onSubmit={handleSubmit} ref={formRef}>\n        <div style={styles.groupContainer}>\n          <p style={styles.header}>General</p>\n          <ColorInput name=\"color\" value={`${getValue(null, 'color')}`} />\n          <NumberInput\n            name=\"strokeWidth\"\n            label=\"stroke width :\"\n            style={{\n              label: { fontSize: '11px', fontWeight: 'bold', color: '#232323' },\n              input: {\n                width: '60%',\n                textAlign: 'center',\n                borderRadius: '5px',\n              },\n            }}\n            defaultValue={Number(getValue(null, 'strokeWidth'))}\n            min={1}\n            pattern=\"[1-9]*\"\n          />\n        </div>\n\n        {nucleus &&\n          nucleus.map((nucleusLabel) => (\n            <div key={nucleusLabel} style={styles.groupContainer}>\n              <p style={styles.header}>\n                <MF mf={nucleusLabel} />\n              </p>\n              {formatFields.map((field) => (\n                <ColumnFormatField\n                  key={field.id}\n                  label={field.label}\n                  checked={getValue(nucleusLabel, field.checkController)}\n                  format={getValue(nucleusLabel, field.formatController)}\n                  checkControllerName={field.checkController}\n                  formatControllerName={field.formatController}\n                  groupID={nucleusLabel}\n                />\n              ))}\n            </div>\n          ))}\n      </form>\n    </div>\n  );\n}\n\nexport default IntegralsWrapper(forwardRef(IntegralsPreferences));\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { SvgNmrSum } from 'cheminfo-font';\nimport lodashGet from 'lodash/get';\nimport { useCallback, useMemo, useState, useRef, memo, Fragment } from 'react';\nimport ReactCardFlip from 'react-card-flip';\n\nimport { useDispatch } from '../../context/DispatchContext';\nimport ToolTip from '../../elements/ToolTip/ToolTip';\nimport { useModal } from '../../elements/popup/Modal';\nimport IntegralsWrapper from '../../hoc/IntegralsWrapper';\nimport ChangeSumModal from '../../modal/changeSum/ChangeSumModal';\nimport {\n  DELETE_INTEGRAL,\n  CHANGE_INTEGRAL_SUM,\n} from '../../reducer/types/Types';\nimport DefaultPanelHeader from '../header/DefaultPanelHeader';\nimport PreferencesHeader from '../header/PreferencesHeader';\n\nimport IntegralTable from './IntegralTable';\nimport IntegralsPreferences from './IntegralsPreferences';\n\nconst styles = css`\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n\n  .sum-button {\n    width: 22px;\n    height: 22px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n  }\n`;\n\nfunction IntegralPanel({ integrals, activeTab, molecules }) {\n  const [filterIsActive, setFilterIsActive] = useState(false);\n  const [integralsCounter, setIntegralsCounter] = useState(0);\n\n  const dispatch = useDispatch();\n  const modal = useModal();\n  const [isFlipped, setFlipStatus] = useState(false);\n  const settingRef = useRef();\n\n  const yesHandler = useCallback(() => {\n    dispatch({ type: DELETE_INTEGRAL, integralID: null });\n  }, [dispatch]);\n\n  const handleDeleteAll = useCallback(() => {\n    modal.showConfirmDialog('All records will be deleted, Are You sure?', {\n      onYes: yesHandler,\n    });\n  }, [modal, yesHandler]);\n\n  const changeIntegralSumHandler = useCallback(\n    (value) => {\n      if (value !== undefined) {\n        dispatch({ type: CHANGE_INTEGRAL_SUM, value });\n      }\n\n      modal.close();\n    },\n    [dispatch, modal],\n  );\n\n  const currentSum = useMemo(() => {\n    return lodashGet(integrals, 'options.sum', null);\n  }, [integrals]);\n\n  const showChangeIntegralSumModal = useCallback(() => {\n    modal.show(\n      <ChangeSumModal\n        onClose={() => modal.close()}\n        onSave={changeIntegralSumHandler}\n        header={\n          currentSum\n            ? `Set new Integrals Sum (Current: ${Number(currentSum).toFixed(\n                2,\n              )})`\n            : 'Set new Integrals Sum'\n        }\n        molecules={molecules}\n        element={activeTab ? activeTab.replace(/[0-9]/g, '') : null}\n      />,\n    );\n  }, [activeTab, changeIntegralSumHandler, currentSum, modal, molecules]);\n\n  const settingsPanelHandler = useCallback(() => {\n    setFlipStatus(!isFlipped);\n  }, [isFlipped]);\n\n  const saveSettingHandler = useCallback(() => {\n    settingRef.current.saveSetting();\n    setFlipStatus(false);\n  }, []);\n\n  const handleOnFilter = useCallback(() => {\n    setFilterIsActive(!filterIsActive);\n  }, [filterIsActive]);\n\n  const changedHandler = useCallback((val) => {\n    setIntegralsCounter(val);\n  }, []);\n\n  return (\n    <Fragment>\n      <div css={styles}>\n        {!isFlipped && (\n          <DefaultPanelHeader\n            counter={integralsCounter}\n            onDelete={handleDeleteAll}\n            deleteToolTip=\"Delete All Integrals\"\n            onFilter={handleOnFilter}\n            filterToolTip={\n              filterIsActive\n                ? 'Show all integrals'\n                : 'Hide integrals out of view'\n            }\n            filterIsActive={filterIsActive}\n            counterFiltered={integralsCounter}\n            showSettingButton=\"true\"\n            onSettingClick={settingsPanelHandler}\n          >\n            <ToolTip\n              title={\n                currentSum\n                  ? `Change Integrals Sum (${Number(currentSum).toFixed(2)})`\n                  : 'Change Integrals Sum'\n              }\n              popupPlacement=\"right\"\n            >\n              <button\n                className=\"sum-button\"\n                type=\"button\"\n                onClick={showChangeIntegralSumModal}\n              >\n                <SvgNmrSum />\n              </button>\n            </ToolTip>\n          </DefaultPanelHeader>\n        )}\n        {isFlipped && (\n          <PreferencesHeader\n            onSave={saveSettingHandler}\n            onClose={settingsPanelHandler}\n          />\n        )}\n        <div style={{ height: '100%', overflow: 'auto' }}>\n          <ReactCardFlip\n            isFlipped={isFlipped}\n            infinite\n            containerStyle={{ overflow: 'hidden' }}\n          >\n            <div>\n              <IntegralTable\n                enableFilter={filterIsActive}\n                onFilter={changedHandler}\n              />\n            </div>\n            <IntegralsPreferences ref={settingRef} />\n          </ReactCardFlip>\n        </div>\n      </div>\n    </Fragment>\n  );\n}\n\nexport default IntegralsWrapper(memo(IntegralPanel));\n","import React from 'react';\n\nimport ToolTip from './ToolTip/ToolTip';\n\nfunction ButtonToolTip({\n  children,\n  style,\n  onClick,\n  popupTitle,\n  popupPlacement,\n  ...props\n}) {\n  return (\n    <ToolTip title={popupTitle} popupPlacement={popupPlacement}>\n      <button style={style} type=\"button\" onClick={onClick} {...props}>\n        {children}\n      </button>\n    </ToolTip>\n  );\n}\n\nButtonToolTip.defaultProps = {\n  popupTitle: '',\n  popupPlacement: 'right',\n  style: {},\n  onClick: () => null,\n  disabled: false,\n};\n\nexport default ButtonToolTip;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useState, useCallback } from 'react';\n\nimport { useGlobal } from '../context/GlobalContext';\n\nimport ToolTip from './ToolTip/ToolTip';\n\nconst menuStyles = css`\n  box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.5);\n  padding: 0px;\n  margin: 0px;\n  border-radius: 5px;\n  display: flex;\n  flex-direction: column;\n  position: absolute;\n  z-index: 99999;\n  padding: 2px;\n  transform: translate(40px, -26px);\n  background-color: white;\n\n  button:hover {\n    background-color: #fafafa;\n  }\n`;\n\nfunction MenuButton({ style, component, toolTip = '', children, className }) {\n  const [isShown, showMenu] = useState(false);\n  const { rootRef } = useGlobal();\n\n  const closeMenuButton = useCallback(() => {\n    setTimeout(() => {\n      showMenu(false);\n    }, 100);\n  }, []);\n\n  const handleClick = useCallback(() => {\n    if (rootRef) {\n      showMenu(true);\n      rootRef.addEventListener('mousedown', closeMenuButton, { once: true });\n    }\n  }, [closeMenuButton, rootRef]);\n\n  return (\n    <div style={{ height: 'auto' }}>\n      <button\n        type=\"button\"\n        css={style}\n        onClick={handleClick}\n        className={className}\n      >\n        <ToolTip title={toolTip} popupPlacement=\"right\">\n          {component}\n        </ToolTip>\n      </button>\n\n      {isShown ? (\n        <div className=\"menu\" css={menuStyles}>\n          {children}\n        </div>\n      ) : null}\n    </div>\n  );\n}\n\nexport default MenuButton;\n","import { useMemo, memo, forwardRef } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\n\nfunction MoleculeWrapper(WrappedComponent) {\n  const Wrapper = (props) => {\n    const {\n      data,\n      activeSpectrum,\n      molecules,\n      displayerMode,\n      activeTab,\n    } = useChartData();\n\n    const { ranges = {}, zones = {} } = useMemo(() => {\n      if (data && activeSpectrum && activeSpectrum.id) {\n        const datum = data.find((datum) => datum.id === activeSpectrum.id) || {\n          ranges: {},\n          zones: {},\n        };\n        return datum;\n      }\n      return {};\n    }, [activeSpectrum, data]);\n\n    const { forwardedRef, ...rest } = props;\n    return (\n      <WrappedComponent\n        {...rest}\n        ranges={ranges}\n        zones={zones}\n        molecules={molecules}\n        displayerMode={displayerMode}\n        activeTab={activeTab}\n        ref={forwardedRef}\n      />\n    );\n  };\n\n  return memo(\n    forwardRef((props, ref) => {\n      return <Wrapper {...props} forwardedRef={ref} />;\n    }),\n  );\n}\nexport default MoleculeWrapper;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useState, useEffect, useCallback } from 'react';\nimport { StructureEditor } from 'react-ocl/full';\n\nimport { useDispatch } from '../context/DispatchContext';\nimport { Modal } from '../elements/popup/Modal';\nimport { SET_MOLECULE, ADD_MOLECULE } from '../reducer/types/Types';\n\nconst modalButtonStyle = css`\n  -moz-box-shadow: inset 0px 1px 0px 0px #ffffff;\n  -webkit-box-shadow: inset 0px 1px 0px 0px #ffffff;\n  box-shadow: inset 0px 1px 0px 0px #ffffff;\n  background: -webkit-gradient(\n    linear,\n    left top,\n    left bottom,\n    color-stop(0.05, #ffffff),\n    color-stop(1, #f6f6f6)\n  );\n  background: -moz-linear-gradient(top, #ffffff 5%, #f6f6f6 100%);\n  background: -webkit-linear-gradient(top, #ffffff 5%, #f6f6f6 100%);\n  background: -o-linear-gradient(top, #ffffff 5%, #f6f6f6 100%);\n  background: -ms-linear-gradient(top, #ffffff 5%, #f6f6f6 100%);\n  background: linear-gradient(to bottom, #ffffff 5%, #f6f6f6 100%);\n  filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#ffffff', endColorstr='#f6f6f6',GradientType=0);\n  background-color: #ffffff;\n  border: 0.55px solid #dcdcdc;\n  display: inline-block;\n  cursor: pointer;\n  color: #666666;\n  font-weight: bold;\n  padding: 6px 24px;\n  text-decoration: none;\n  text-shadow: 0px 1px 0px #ffffff;\n\n  :hover {\n    background: -webkit-gradient(\n      linear,\n      left top,\n      left bottom,\n      color-stop(0.05, #f6f6f6),\n      color-stop(1, #ffffff)\n    );\n    background: -moz-linear-gradient(top, #f6f6f6 5%, #ffffff 100%);\n    background: -webkit-linear-gradient(top, #f6f6f6 5%, #ffffff 100%);\n    background: -o-linear-gradient(top, #f6f6f6 5%, #ffffff 100%);\n    background: -ms-linear-gradient(top, #f6f6f6 5%, #ffffff 100%);\n    background: linear-gradient(to bottom, #f6f6f6 5%, #ffffff 100%);\n    filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#f6f6f6', endColorstr='#ffffff',GradientType=0);\n    background-color: #f6f6f6;\n  }\n`;\n\nfunction MoleculeStructureEditorModal(props) {\n  const { onClose, open, selectedMolecule } = props;\n  const [molfile, setMolfile] = useState(null);\n  const dispatch = useDispatch();\n\n  useEffect(() => {\n    if (selectedMolecule) {\n      setMolfile(selectedMolecule.molfile);\n    } else {\n      setMolfile(null);\n    }\n  }, [selectedMolecule, open]);\n\n  const cb = useCallback(\n    (newMolfile) => {\n      setMolfile(newMolfile);\n    },\n    [setMolfile],\n  );\n\n  const handleClose = useCallback(() => {\n    onClose();\n  }, [onClose]);\n\n  const handleSave = useCallback(() => {\n    if (selectedMolecule) {\n      dispatch({ type: SET_MOLECULE, molfile, key: selectedMolecule.key });\n      onClose('replace');\n    } else {\n      dispatch({ type: ADD_MOLECULE, molfile });\n      onClose('new');\n    }\n  }, [dispatch, selectedMolecule, molfile, onClose]);\n\n  const styles = {\n    footer: {\n      display: 'flex',\n      alignItems: 'flex-end',\n      justifyContent: 'flex-end',\n      margin: 5,\n    },\n  };\n\n  return (\n    <Modal open={open} onClose={handleClose}>\n      <StructureEditor\n        initialMolfile={selectedMolecule && selectedMolecule.molfile}\n        svgMenu\n        fragment={false}\n        onChange={cb}\n      />\n      <div style={styles.footer}>\n        <button type=\"button\" css={modalButtonStyle} onClick={handleClose}>\n          Close\n        </button>\n        <button type=\"button\" css={modalButtonStyle} onClick={handleSave}>\n          Save\n        </button>\n      </div>\n    </Modal>\n  );\n}\n\nexport default MoleculeStructureEditorModal;\n","/* eslint-disable prefer-named-capture-group */\n/* eslint-disable react/no-danger */\n\nfunction IsotopesViewer({ value = '', ...othersProps }) {\n  return (\n    <div\n      {...othersProps}\n      dangerouslySetInnerHTML={{\n        __html: value.replace(/([0-9]+)/g, '<sup>$1</sup>'),\n      }}\n    />\n  );\n}\n\nexport default IsotopesViewer;\n","import { useFormikContext } from 'formik';\nimport lodashGet from 'lodash/get';\nimport { useCallback, useEffect } from 'react';\n\nimport Select from '../Select';\n\nconst FormikSelect = function FormikSelect({\n  name,\n  value,\n  onChange,\n  ...resProps\n}) {\n  const { values, setFieldValue } = useFormikContext();\n  const changeHandler = useCallback(\n    (value) => {\n      onChange(value);\n      setFieldValue(name, value);\n    },\n    [name, onChange, setFieldValue],\n  );\n\n  useEffect(() => {\n    if (value) {\n      setFieldValue(name, value);\n    }\n  }, [name, setFieldValue, value]);\n\n  return (\n    <Select\n      name={name}\n      defaultValue={value ? value : lodashGet(values, name)}\n      onChange={changeHandler}\n      {...resProps}\n    />\n  );\n};\n// eslint-disable-next-line react/forbid-foreign-prop-types\nFormikSelect.propTypes = Select.propTypes;\nFormikSelect.defaultProps = Select.defaultProps;\n\nexport default FormikSelect;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback, useRef } from 'react';\n\nimport { useDispatch } from '../context/DispatchContext';\nimport CloseButton from '../elements/CloseButton';\nimport IsotopesViewer from '../elements/IsotopesViewer';\nimport FormikCheckBox from '../elements/formik/FormikCheckBox';\nimport FormikForm from '../elements/formik/FormikForm';\nimport FormikInput from '../elements/formik/FormikInput';\nimport FormikSelect from '../elements/formik/FormikSelect';\nimport { PREDICT_SPECTRA, SET_LOADING_FLAG } from '../reducer/types/Types';\n\nconst styles = css`\n  overflow: auto;\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n\n  .header {\n    text-align: center;\n    padding: 10px 0 10px 0px;\n    margin: 0px;\n    color: #005d9e;\n    place-items: normal;\n    text-transform: none;\n    background-color: #fcfcfc;\n  }\n\n  .tab-content {\n    width: 100%;\n  }\n  .row {\n    display: flex;\n    align-items: center;\n  }\n\n  .inner-content {\n    padding: 15px 30px;\n    width: 100%;\n    flex: 1;\n  }\n\n  button:focus {\n    outline: none;\n  }\n  button:hover {\n    color: #007bff;\n  }\n  .save-button:hover {\n    background-color: #ffffff;\n  }\n  .save-button {\n    border: none;\n    padding: 0 15px;\n    background-color: #ffffff5e;\n    border-radius: 5px;\n    height: 25px;\n  }\n\n  .footer-container {\n    display: flex;\n    align-items: flex-end;\n    justify-content: flex-end;\n    background: rgb(242, 242, 242);\n    background: -moz-linear-gradient(\n      0deg,\n      rgba(242, 242, 242, 1) 0%,\n      rgba(245, 245, 245, 1) 37%,\n      rgba(255, 255, 255, 1) 90%\n    );\n    background: -webkit-linear-gradient(\n      0deg,\n      rgba(242, 242, 242, 1) 0%,\n      rgba(245, 245, 245, 1) 37%,\n      rgba(255, 255, 255, 1) 90%\n    );\n    background: linear-gradient(\n      0deg,\n      rgba(242, 242, 242, 1) 0%,\n      rgba(245, 245, 245, 1) 37%,\n      rgba(255, 255, 255, 1) 90%\n    );\n    filter: progid:DXImageTransform.Microsoft.gradient(startColorstr=\"#f2f2f2\",endColorstr=\"#ffffff\",GradientType=1);\n    padding: 6px 15px;\n    height: 55px;\n  }\n\n  .section-header {\n    font-size: 13px;\n    color: #2ca8ff;\n    margin-bottom: 10px;\n    border-bottom: 0.55px solid #f9f9f9;\n    padding: 6px 2px;\n  }\n\n  .custom-label {\n    font-size: 12px;\n    font-weight: bold;\n    margin-right: 10px;\n    width: 155px;\n  }\n  .margin-10 {\n    margin: 10px 0;\n  }\n\n  .input {\n    font-size: 14px;\n    border-radius: 5px;\n    border: 1px solid #cccccc;\n    padding: 5px;\n    width: 100px;\n    margin-right: 10px;\n    height: initial !important;\n  }\n\n  .close-bt {\n    border: none;\n    color: red;\n    background-color: transparent;\n    outline: none;\n    position: absolute;\n    right: 10px;\n    top: 2px;\n    width: 30px;\n    height: 30px;\n  }\n`;\n\nconst FREQUENCIES = [\n  { key: 1, value: 60, label: '60 MHz' },\n  { key: 2, value: 100, label: '100 MHz' },\n  { key: 3, value: 200, label: '200 MHz' },\n  { key: 4, value: 300, label: '300 MHz' },\n  { key: 5, value: 400, label: '400 MHz' },\n  { key: 6, value: 500, label: '500 MHz' },\n  { key: 7, value: 600, label: '600 MHz' },\n  { key: 8, value: 800, label: '800 MHz' },\n  { key: 9, value: 1000, label: '1000 MHz' },\n  { key: 10, value: 1200, label: '1200 MHz' },\n];\n\nconst INITIAL_VALUE = {\n  '1h': { from: -1, to: 12 },\n  '13c': { from: -5, to: 220 },\n  frequency: 400,\n  spectra: {\n    '1h': true,\n    '13c': false,\n    cosy: false,\n    hsqc: false,\n    hmbc: false,\n  },\n};\n\nfunction PredictSpectraModal({ onClose, molfile }) {\n  const refForm = useRef();\n  const dispatch = useDispatch();\n\n  const handleSave = useCallback(() => {\n    refForm.current.submitForm();\n  }, []);\n\n  const submitHandler = useCallback(\n    (values) => {\n      dispatch({\n        type: SET_LOADING_FLAG,\n        isLoading: true,\n      });\n      dispatch({\n        type: PREDICT_SPECTRA,\n        payload: { mol: molfile, options: values },\n      });\n      onClose();\n    },\n    [dispatch, molfile, onClose],\n  );\n\n  return (\n    <div css={styles}>\n      <div className=\"header handle\">\n        <span>Predict Spectra</span>\n        <CloseButton onClick={onClose} className=\"close-bt\" />\n      </div>\n      <div className=\"inner-content\">\n        <FormikForm\n          ref={refForm}\n          initialValues={INITIAL_VALUE}\n          onSubmit={submitHandler}\n        >\n          <div className=\"row margin-10\">\n            <span className=\"custom-label\">Spectrometer Frequency :</span>\n\n            <FormikSelect\n              data={FREQUENCIES}\n              style={{ width: 290, height: 30, margin: 0 }}\n              name=\"frequency\"\n            />\n          </div>\n          <div className=\"row margin-10\">\n            <IsotopesViewer value=\"1H\" className=\"custom-label\" />\n            <FormikInput\n              label=\"From\"\n              name=\"1h.from\"\n              type=\"number\"\n              style={{ label: { padding: '0 10px 0 0' } }}\n            />\n            <FormikInput\n              label=\"To\"\n              name=\"1h.to\"\n              type=\"number\"\n              style={{ label: { padding: '0 10px' } }}\n            />\n          </div>\n          <div className=\"row margin-10\">\n            <IsotopesViewer value=\"13C\" className=\"custom-label\" />\n            <FormikInput\n              label=\"From\"\n              name=\"13c.from\"\n              type=\"number\"\n              style={{ label: { padding: '0 10px 0 0' } }}\n            />\n            <FormikInput\n              label=\"To\"\n              name=\"13c.to\"\n              type=\"number\"\n              style={{ label: { padding: '0 10px' } }}\n            />\n          </div>\n          <div className=\"row margin-10\">\n            <span className=\"custom-label\">Spectra </span>\n          </div>\n          <div\n            className=\"row margin-10\"\n            style={{ justifyContent: 'space-between' }}\n          >\n            <div className=\"row\">\n              <FormikCheckBox name=\"spectra.1h\" />\n              <IsotopesViewer value=\"1H\" style={{ padding: ' 0 10px' }} />\n            </div>\n            <div className=\"row\">\n              <FormikCheckBox disabled name=\"spectra.13c\" />\n              <IsotopesViewer value=\"13C\" style={{ padding: ' 0 10px' }} />\n            </div>\n            <div className=\"row\">\n              <FormikCheckBox disabled name=\"spectra.cosy\" />\n              <IsotopesViewer value=\"cosy\" style={{ padding: ' 0 10px' }} />\n            </div>\n            <div className=\"row\">\n              <FormikCheckBox disabled name=\"spectra.hsqc\" />\n              <IsotopesViewer value=\"HSQC\" style={{ padding: ' 0 10px' }} />\n            </div>\n            <div className=\"row\">\n              <FormikCheckBox disabled name=\"spectra.hmbc\" />\n              <IsotopesViewer value=\"HMBC\" style={{ padding: ' 0 10px' }} />\n            </div>\n          </div>\n        </FormikForm>\n      </div>\n      <div className=\"footer-container\">\n        <button type=\"button\" onClick={handleSave} className=\"save-button\">\n          Start Predicting\n        </button>\n      </div>\n    </div>\n  );\n}\n\nexport default PredictSpectraModal;\n","import { DISPLAYER_MODE } from '../../reducer/core/Constants';\n\nconst extractFromAtom = (atom, elements, activeAxis) => {\n  if (elements.length > 0 && Object.keys(atom).length > 0) {\n    const dim = activeAxis === 'x' ? 0 : activeAxis === 'y' ? 1 : undefined;\n    if (dim !== undefined) {\n      if (elements[dim] === atom.atomLabel) {\n        // take always oclID if atom type is same as element of activeTab)\n        return { oclIDs: [atom.oclID], nbAtoms: atom.nbAtoms };\n      }\n      if (elements[dim] === 'H') {\n        // if we are in proton spectrum and use then the IDs of attached hydrogens of an atom\n        return {\n          oclIDs: atom.hydrogenOCLIDs,\n          nbAtoms: atom.nbAtoms * atom.nbHydrogens,\n        };\n      }\n    } else {\n      return {\n        oclIDs: [atom.oclID].concat(atom.hydrogenOCLIDs),\n        nbAtoms: atom.nbAtoms + atom.nbAtoms * atom.nbHydrogens,\n      };\n    }\n  }\n\n  return { oclIDs: [], nbAtoms: 0 };\n};\n\nconst findDatumAndSignalIndex = (spectraData, id) => {\n  // if datum could be found then the id is on range/zone level\n  let datum = spectraData.find((_datum) => _datum.id === id);\n  let signalIndex;\n  if (!datum) {\n    // figure out the datum via id\n    for (let i = 0; i < spectraData.length; i++) {\n      signalIndex = spectraData[i].signal.findIndex(\n        (_signal) => _signal.id === id,\n      );\n      if (signalIndex >= 0) {\n        datum = spectraData[i];\n        break;\n      }\n    }\n  }\n\n  return { datum, signalIndex };\n};\n\nconst getHighlightsOnHover = (assignmentData, oclIDs, spectraData) => {\n  // set all IDs to highlight when hovering over an atom from assignment data\n  let highlights = [];\n  for (let key in assignmentData.assignment.assignment) {\n    let datum, signalIndex;\n    let stop = false;\n    if (\n      assignmentData.assignment.assignment[key].x &&\n      assignmentData.assignment.assignment[key].x.some((_assigned) =>\n        oclIDs.includes(_assigned),\n      )\n    ) {\n      highlights = highlights.concat(\n        assignmentData.assignment.assignment[key].x,\n      );\n      const result = findDatumAndSignalIndex(spectraData, key);\n      datum = result.datum;\n      signalIndex = result.signalIndex;\n      stop = true;\n    }\n    if (\n      assignmentData.assignment.assignment[key].y &&\n      assignmentData.assignment.assignment[key].y.some((_assigned) =>\n        oclIDs.includes(_assigned),\n      )\n    ) {\n      highlights = highlights.concat(\n        assignmentData.assignment.assignment[key].y,\n      );\n      const result = findDatumAndSignalIndex(spectraData, key);\n      datum = result.datum;\n      signalIndex = result.signalIndex;\n      stop = true;\n    }\n    if (datum) {\n      highlights.push(datum.id);\n      if (signalIndex !== undefined) {\n        highlights.push(datum.signal[signalIndex].id);\n      }\n    }\n    if (stop) {\n      break;\n    }\n  }\n  return highlights;\n};\n\nconst getCurrentDiaIDsToHighlight = (assignmentData, displayerMode) => {\n  const assignmentOnHover = assignmentData.assignment.isOnHover\n    ? assignmentData.assignment.assignment[assignmentData.assignment.onHoverID]\n    : null;\n\n  const axisOnHover = assignmentData.assignment.isOnHover\n    ? assignmentData.assignment.onHoverAxis\n    : null;\n\n  return assignmentOnHover\n    ? displayerMode === DISPLAYER_MODE.DM_1D\n      ? assignmentOnHover.x || []\n      : displayerMode === DISPLAYER_MODE.DM_2D\n      ? axisOnHover\n        ? axisOnHover === 'x'\n          ? assignmentOnHover.x || []\n          : axisOnHover === 'y'\n          ? assignmentOnHover.y || []\n          : (assignmentOnHover.x || []).concat(assignmentOnHover.y || [])\n        : (assignmentOnHover.x || []).concat(assignmentOnHover.y || [])\n      : []\n    : [];\n};\n\nconst toggleDiaIDs = (diaID, atomInformation) => {\n  let _diaID = diaID ? diaID.slice() : [];\n  if (atomInformation.oclIDs.length === 1) {\n    if (_diaID.includes(atomInformation.oclIDs[0])) {\n      _diaID = _diaID.filter((_id) => _id !== atomInformation.oclIDs[0]);\n    } else {\n      for (let i = 0; i < atomInformation.nbAtoms; i++) {\n        _diaID.push(atomInformation.oclIDs[0]);\n      }\n    }\n  } else if (atomInformation.oclIDs.length > 1) {\n    atomInformation.oclIDs.forEach((_oclID) => {\n      if (_diaID.includes(_oclID)) {\n        _diaID = _diaID.filter((_id) => _id !== _oclID);\n      } else {\n        _diaID.push(_oclID);\n      }\n    });\n  }\n  return _diaID;\n};\n\nexport {\n  extractFromAtom,\n  findDatumAndSignalIndex,\n  getCurrentDiaIDsToHighlight,\n  getHighlightsOnHover,\n  toggleDiaIDs,\n};\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { SvgNmrFt } from 'cheminfo-font';\nimport OCL from 'openchemlib/full';\nimport { useState, useCallback, useMemo, useEffect, memo } from 'react';\nimport {\n  FaPlus,\n  FaPaste,\n  FaRegTrashAlt,\n  FaFileExport,\n  FaDownload,\n  FaFileImage,\n  FaCopy,\n} from 'react-icons/fa';\nimport { MF } from 'react-mf';\nimport OCLnmr from 'react-ocl-nmr';\nimport { useMeasure } from 'react-use';\n\nimport { ConcatenationString } from '../../../data/utilities/Concatenation';\nimport { useAssignmentData, useAssignment } from '../../assignment';\nimport { useDispatch } from '../../context/DispatchContext';\nimport ButtonToolTip from '../../elements/ButtonToolTip';\nimport MenuButton from '../../elements/MenuButton';\nimport NextPrev from '../../elements/NextPrev';\nimport ToolTip from '../../elements/ToolTip/ToolTip';\nimport { positions, useAlert } from '../../elements/popup/Alert';\nimport { useModal } from '../../elements/popup/Modal';\nimport { useHighlightData } from '../../highlight';\nimport MoleculeWrapper from '../../hoc/MoleculeWrapper';\nimport MoleculeStructureEditorModal from '../../modal/MoleculeStructureEditorModal';\nimport PredictSpectraModal from '../../modal/PredictSpectraModal';\nimport { DISPLAYER_MODE } from '../../reducer/core/Constants';\nimport {\n  ADD_MOLECULE,\n  DELETE_MOLECULE,\n  SET_DIAID_RANGE,\n  SET_DIAID_ZONE,\n  SET_MOLECULE,\n} from '../../reducer/types/Types';\nimport {\n  copyTextToClipboard,\n  copyPNGToClipboard,\n  exportAsSVG,\n} from '../../utility/Export';\n\nimport {\n  extractFromAtom,\n  findDatumAndSignalIndex,\n  getCurrentDiaIDsToHighlight,\n  getHighlightsOnHover,\n  toggleDiaIDs,\n} from './Utilities';\n\nconst panelContainerStyle = css`\n  display: flex;\n  flex-direction: column;\n  flex-grow: 1;\n  width: 100%;\n  height: 100%;\n`;\n\nconst toolbarStyle = css`\n  display: flex;\n  flex-direction: row;\n  border-bottom: 0.55px solid rgb(240, 240, 240);\n  padding: 0px 5px;\n\n  button svg {\n    fill: #4e4e4e;\n  }\n\n  button {\n    background-color: transparent;\n    border: none;\n    padding: 5px;\n  }\n\n  p {\n    margin: 0;\n    text-align: right;\n    width: 100%;\n    line-height: 22px;\n    padding: 0px 10px;\n  }\n`;\n\nconst moleculeContainerStyle = css`\n  width: 100%;\n  height: 100%;\n\n  .slider {\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    align-items: center;\n    height: 100%;\n    padding: 0px;\n    .mol-svg-container {\n      height: calc(100% - 25px);\n      width: 100%;\n      div {\n        width: 100%;\n        height: 100%;\n      }\n    }\n\n    p {\n      width: 100%;\n      margin: 0 auto;\n      display: block;\n      position: relative;\n      text-align: center;\n    }\n\n    svg polygon {\n      fill: gray !important;\n    }\n  }\n`;\n\nconst menuButton = css`\n  background-color: transparent;\n  border: none;\n  border-bottom: 0.55px solid whitesmoke;\n  height: 35px;\n  outline: outline;\n  display: flex;\n  justify-content: flex-start;\n\n  :focus {\n    outline: none !important;\n  }\n  span {\n    font-size: 10px;\n    padding: 0px 10px;\n  }\n`;\n\nfunction MoleculePanel({ zones, ranges, molecules, activeTab, displayerMode }) {\n  const [refContainer, { width, height }] = useMeasure();\n  const [open, setOpen] = useState(false);\n  const [currentMolfile, setCurrentMolfile] = useState();\n  const [currentIndex, setCurrentIndex] = useState(0);\n  const [onAtomHoverHighlights, setOnAtomHoverHighlights] = useState([]);\n  const [onAtomHoverAction, setOnAtomHoverAction] = useState(null);\n\n  const dispatch = useDispatch();\n  const alert = useAlert();\n  const modal = useModal();\n\n  const highlightData = useHighlightData();\n  const assignmentData = useAssignmentData();\n  const [elements, setElements] = useState([]);\n\n  useEffect(() => {\n    if (activeTab) {\n      const split = activeTab.split(',');\n      if (split.length === 1) {\n        setElements([activeTab.replace(/[0-9]/g, '')]);\n      } else if (split.length === 2) {\n        setElements(split.map((nucleus) => nucleus.replace(/[0-9]/g, '')));\n      }\n    } else {\n      setElements([]);\n    }\n  }, [activeTab]);\n\n  const activeAssignment = useAssignment(\n    assignmentData.assignment.activeID !== undefined\n      ? assignmentData.assignment.activeID\n      : ConcatenationString, // dummy value\n  );\n\n  const data = useMemo(() => {\n    if (zones || ranges) {\n      if (displayerMode === DISPLAYER_MODE.DM_1D && ranges && ranges.values) {\n        return ranges.values;\n      } else if (\n        displayerMode === DISPLAYER_MODE.DM_2D &&\n        zones &&\n        zones.values\n      ) {\n        return zones.values;\n      }\n    }\n    return [];\n  }, [displayerMode, ranges, zones]);\n\n  const assignedDiaIDs = useMemo(() => {\n    const assignedDiaID = { x: [], y: [] };\n    for (let id in assignmentData.assignment.assignment) {\n      if (assignmentData.assignment.assignment[id].x) {\n        assignedDiaID.x.push(...assignmentData.assignment.assignment[id].x);\n      }\n      if (assignmentData.assignment.assignment[id].y) {\n        assignedDiaID.y.push(...assignmentData.assignment.assignment[id].y);\n      }\n    }\n    // with its structure it's prepared for showing assigned IDs per axis\n    return assignedDiaID;\n  }, [assignmentData.assignment]);\n\n  // used for atom highlighting for now, until we would like to highlight atoms per axis separately\n  const assignedDiaIDsMerged = useMemo(\n    () => assignedDiaIDs.x.concat(assignedDiaIDs.y),\n    [assignedDiaIDs.x, assignedDiaIDs.y],\n  );\n\n  const toggleAssignment = useCallback(\n    (diaID, atomInformation) => {\n      // 1. one atom can only be assigned to one range/zone/signal\n      // 2. check whether an atom is already assigned to a range to allow toggling the assignment\n      if (\n        assignedDiaIDsMerged.some((_oclID) =>\n          atomInformation.oclIDs.includes(_oclID),\n        ) &&\n        !diaID.some((_oclID) => atomInformation.oclIDs.includes(_oclID))\n      ) {\n        alert.info('Atom is already assigned to another signal!');\n        return diaID;\n      }\n\n      return toggleDiaIDs(diaID, atomInformation);\n    },\n    [alert, assignedDiaIDsMerged],\n  );\n\n  const handleOnClickAtom = useCallback(\n    (atom) => {\n      if (activeAssignment.isActive) {\n        const atomInformation = extractFromAtom(\n          atom,\n          elements,\n          activeAssignment.activeAxis,\n        );\n        if (atomInformation.nbAtoms > 0) {\n          // save assignment in assignment hook\n          atomInformation.oclIDs.forEach((_oclID) => {\n            activeAssignment.toggle(_oclID);\n          });\n          // save assignment (diaIDs) in range/zone data\n          const { datum, signalIndex } = findDatumAndSignalIndex(\n            data,\n            activeAssignment.id,\n          );\n          if (datum) {\n            // determine the level of setting the diaID array (range vs. signal level) and save there\n            let _diaID = [];\n            // on range/zone level\n            if (signalIndex === undefined) {\n              if (displayerMode === DISPLAYER_MODE.DM_1D) {\n                _diaID = toggleAssignment(datum.diaID || [], atomInformation);\n              } else if (displayerMode === DISPLAYER_MODE.DM_2D) {\n                _diaID = toggleAssignment(\n                  datum[activeAssignment.activeAxis].diaID || [],\n                  atomInformation,\n                );\n              }\n            } else if (datum.signal && datum.signal[signalIndex]) {\n              // on signal level\n              if (displayerMode === DISPLAYER_MODE.DM_1D) {\n                _diaID = toggleAssignment(\n                  datum.signal[signalIndex].diaID || [],\n                  atomInformation,\n                );\n              } else if (displayerMode === DISPLAYER_MODE.DM_2D) {\n                _diaID = toggleAssignment(\n                  datum.signal[signalIndex][activeAssignment.activeAxis]\n                    .diaID || [],\n                  atomInformation,\n                );\n              }\n            }\n            if (displayerMode === DISPLAYER_MODE.DM_1D) {\n              dispatch({\n                type: SET_DIAID_RANGE,\n                payload: {\n                  rangeData: datum,\n                  diaID: _diaID,\n                  signalIndex,\n                },\n              });\n            } else if (displayerMode === DISPLAYER_MODE.DM_2D) {\n              dispatch({\n                type: SET_DIAID_ZONE,\n                payload: {\n                  zoneData: datum,\n                  diaID: _diaID,\n                  axis: activeAssignment.activeAxis,\n                  signalIndex,\n                },\n              });\n            }\n          }\n        } else {\n          alert.info(\n            'Not assigned! Different atom type or no attached hydrogens found!',\n          );\n        }\n      }\n    },\n    [\n      activeAssignment,\n      alert,\n      data,\n      dispatch,\n      displayerMode,\n      elements,\n      toggleAssignment,\n    ],\n  );\n\n  const currentDiaIDsToHighlight = useMemo(() => {\n    return getCurrentDiaIDsToHighlight(assignmentData, displayerMode);\n  }, [assignmentData, displayerMode]);\n\n  useEffect(() => {\n    if (onAtomHoverAction) {\n      if (onAtomHoverAction === 'show') {\n        highlightData.dispatch({\n          type: 'SHOW',\n          payload: { convertedHighlights: onAtomHoverHighlights },\n        });\n      } else if (onAtomHoverAction === 'hide') {\n        highlightData.dispatch({\n          type: 'HIDE',\n          payload: { convertedHighlights: onAtomHoverHighlights },\n        });\n        setOnAtomHoverHighlights([]);\n      }\n      setOnAtomHoverAction(null);\n    }\n  }, [onAtomHoverAction, onAtomHoverHighlights, highlightData]);\n\n  const handleOnAtomHover = useCallback(\n    (atom) => {\n      const oclIDs = extractFromAtom(\n        atom,\n        elements,\n        activeAssignment.activeAxis,\n      ).oclIDs;\n      // on enter the atom\n      if (oclIDs.length > 0) {\n        // set all IDs to highlight when hovering over an atom from assignment data\n        const highlights = getHighlightsOnHover(assignmentData, oclIDs, data);\n        setOnAtomHoverHighlights(highlights);\n        setOnAtomHoverAction('show');\n      } else {\n        // on leave the atom\n        setOnAtomHoverAction('hide');\n      }\n    },\n    [activeAssignment.activeAxis, assignmentData, data, elements],\n  );\n\n  const handleClose = useCallback(\n    (e) => {\n      setOpen(false);\n      if (e === 'new') {\n        setCurrentIndex(molecules.length);\n      }\n    },\n    [molecules.length],\n  );\n\n  const handleOpen = useCallback((event, key, molfile) => {\n    if (molfile) {\n      setCurrentMolfile({ molfile, key });\n    } else {\n      setCurrentMolfile(null);\n    }\n    setOpen(true);\n  }, []);\n\n  const handlePaste = useCallback(() => {\n    navigator.clipboard.readText().then((molfile) => {\n      dispatch({ type: ADD_MOLECULE, molfile });\n    });\n  }, [dispatch]);\n\n  const handleDelete = useCallback(() => {\n    if (molecules[currentIndex] && molecules[currentIndex].key) {\n      setCurrentIndex(0);\n      dispatch({\n        type: DELETE_MOLECULE,\n        payload: { key: molecules[currentIndex].key, assignmentData },\n      });\n    }\n  }, [molecules, currentIndex, assignmentData, dispatch]);\n\n  const saveAsSVGHandler = useCallback(() => {\n    exportAsSVG('molFile', `molSVG${currentIndex}`);\n  }, [currentIndex]);\n\n  const saveAsPNGHandler = useCallback(() => {\n    copyPNGToClipboard(`molSVG${currentIndex}`);\n    alert.success('MOL copied as PNG to clipboard');\n  }, [alert, currentIndex]);\n\n  const saveAsMolHandler = useCallback(() => {\n    if (molecules[currentIndex]) {\n      const flag = copyTextToClipboard(molecules[currentIndex].molfile);\n      if (flag) {\n        alert.success('MOLFile copied to clipboard');\n      } else {\n        alert.error('copied not completed');\n      }\n    }\n  }, [alert, currentIndex, molecules]);\n\n  const handleReplaceMolecule = useCallback(\n    (key, molfile) => {\n      dispatch({ type: SET_MOLECULE, molfile, key });\n    },\n    [dispatch],\n  );\n\n  const openPredicSpectraModal = useCallback(() => {\n    modal.show(\n      <PredictSpectraModal\n        onSave={() => {\n          modal.close();\n        }}\n        molfile={molecules[currentIndex]}\n      />,\n      {\n        position: positions.TOP_CENTER,\n        enableResizing: true,\n        width: 600,\n        height: 350,\n      },\n    );\n  }, [modal, molecules, currentIndex]);\n\n  return (\n    <div css={panelContainerStyle}>\n      <div css={toolbarStyle}>\n        <MenuButton component={<FaFileExport />} toolTip=\"Export As\">\n          <button type=\"button\" css={menuButton} onClick={saveAsMolHandler}>\n            <FaCopy />\n            <span>Copy as molfile</span>\n          </button>\n          <button type=\"button\" css={menuButton} onClick={saveAsPNGHandler}>\n            <FaFileImage />\n            <span>Copy as PNG</span>\n          </button>\n          <button type=\"button\" css={menuButton} onClick={saveAsSVGHandler}>\n            <FaDownload />\n            <span>Export as SVG</span>\n          </button>\n        </MenuButton>\n\n        <ToolTip title=\"Paste molfile\" popupPlacement=\"left\">\n          <button className=\"bar-button\" type=\"button\" onClick={handlePaste}>\n            <FaPaste />\n          </button>\n        </ToolTip>\n        <ToolTip title=\"Add Molecule\" popupPlacement=\"left\">\n          <button className=\"bar-button\" type=\"button\" onClick={handleOpen}>\n            <FaPlus />\n          </button>\n        </ToolTip>\n        <ToolTip title=\"Delete Molecule\" popupPlacement=\"left\">\n          <button className=\"bar-button\" type=\"button\" onClick={handleDelete}>\n            <FaRegTrashAlt />\n          </button>\n        </ToolTip>\n        <ButtonToolTip\n          popupTitle=\"Predict Spectra\"\n          popupPlacement=\"left\"\n          onClick={openPredicSpectraModal}\n          disabled={!molecules || molecules.length === 0}\n        >\n          <SvgNmrFt />\n        </ButtonToolTip>\n        <p>\n          {molecules &&\n            molecules.length > 0 &&\n            `${+(currentIndex + 1)} / ${molecules.length}`}{' '}\n        </p>\n      </div>\n      <div css={moleculeContainerStyle}>\n        <NextPrev\n          onChange={(slideIndex) => setCurrentIndex(slideIndex)}\n          defaultIndex={currentIndex}\n        >\n          {molecules && molecules.length > 0 ? (\n            molecules.map((mol, index) => (\n              <div\n                className=\"slider\"\n                key={mol.key}\n                onDoubleClick={(event) =>\n                  handleOpen(event, mol.key, mol.molfile)\n                }\n                style={{\n                  backgroundColor: (index + 1) % 2 !== 0 ? '#fafafa' : 'white',\n                }}\n              >\n                <div className=\"mol-svg-container\" ref={refContainer}>\n                  <OCLnmr\n                    OCL={OCL}\n                    id={`molSVG${index}`}\n                    width={width > 0 ? width : 100}\n                    height={height > 0 ? height : 100}\n                    molfile={mol.molfile}\n                    setMolfile={(molfile) =>\n                      handleReplaceMolecule(mol.key, molfile)\n                    }\n                    setSelectedAtom={handleOnClickAtom}\n                    atomHighlightColor={\n                      currentDiaIDsToHighlight &&\n                      currentDiaIDsToHighlight.length > 0\n                        ? 'red'\n                        : '#FFD700'\n                    }\n                    atomHighlightOpacity={0.35}\n                    highlights={\n                      currentDiaIDsToHighlight &&\n                      currentDiaIDsToHighlight.length > 0\n                        ? currentDiaIDsToHighlight\n                        : assignedDiaIDsMerged\n                    }\n                    setHoverAtom={handleOnAtomHover}\n                  />\n                </div>\n                <p>\n                  <MF mf={mol.mf} /> - {mol.mw.toFixed(2)}\n                </p>\n              </div>\n            ))\n          ) : (\n            <div\n              style={{ width: '100%', height: '100%' }}\n              onClick={handleOpen}\n            />\n          )}\n        </NextPrev>\n\n        <MoleculeStructureEditorModal\n          open={open}\n          onClose={handleClose}\n          selectedMolecule={currentMolfile}\n        />\n      </div>\n    </div>\n  );\n}\n\nexport default MoleculeWrapper(memo(MoleculePanel));\n","import lodashGet from 'lodash/get';\nimport isEmpty from 'lodash/isEmpty';\n\nimport generateChar from '../utilities/generateChar';\n\nimport { detectRange } from './Datum1D';\n\nexport const COLUMNS_TYPES = {\n  NORMAL: 'NORMAL',\n  FORMULA: 'FORMULA',\n};\n\nlet reservedColumnsNames = {};\n\nfunction addColumnKey(spectraAnalysis, nucleus, columnProps, columnKey) {\n  const index = Object.keys(spectraAnalysis[nucleus].options.columns).length;\n  const key = columnKey ? columnKey : generateChar(index).toUpperCase();\n  spectraAnalysis[nucleus].options.columns[key] = columnProps;\n  return key;\n}\n\nexport function getColumns(spectraAnalysis, nucleus) {\n  return spectraAnalysis[nucleus].options.columns;\n}\n\nexport function getValue(colKey, columns, data) {\n  return data[columns[colKey].valueKey];\n}\n\nexport function getSpectraAnalysis(spectra, options) {\n  const { from, to, nucleus } = options;\n  return spectra.reduce(\n    (acc, datum) => {\n      if (\n        datum.info.dimension === 1 &&\n        datum.info.nucleus === nucleus &&\n        !datum.info.isFid\n      ) {\n        const range = detectRange(datum, { from, to });\n        acc.sum += range.absolute;\n        acc.values.push({ SID: datum.id, ...range });\n      }\n      return acc;\n    },\n    { values: [], sum: 0 },\n  );\n}\n\nfunction init(spectraAnalysis, nucleus) {\n  if (spectraAnalysis[nucleus] === undefined) {\n    spectraAnalysis[nucleus] = {\n      options: {\n        sum: 100,\n        code: null,\n        columns: {},\n      },\n      values: {},\n    };\n  }\n}\n\nexport function changeColumnValueKey(\n  spectraAnalysis,\n  nucleus,\n  columnKey,\n  newKey,\n) {\n  spectraAnalysis[nucleus].options.columns[columnKey].valueKey = newKey;\n\n  spectraAnalysis[nucleus].values = refreshCalculation(\n    spectraAnalysis,\n    nucleus,\n  );\n}\n\nexport function setColumn(\n  spectraAnalysis,\n  nucleus,\n  { columns: inputColumns, code },\n) {\n  init(spectraAnalysis, nucleus);\n  spectraAnalysis[nucleus].options.code = code;\n  spectraAnalysis[nucleus].options.columns = Object.values(inputColumns).reduce(\n    (acc, value) => {\n      const data = { ...value };\n      delete data.tempKey;\n      acc[value.tempKey] = data;\n      return acc;\n    },\n    {},\n  );\n\n  const { columns: newColumns } = spectraAnalysis[nucleus].options;\n\n  let data = Object.entries(spectraAnalysis[nucleus].values).reduce(\n    (outerAcc, [spectraKey, spectra]) => {\n      outerAcc[spectraKey] = Object.keys(inputColumns).reduce((acc, key) => {\n        const newKey = inputColumns[key].tempKey;\n        if (spectra[key]) {\n          acc[newKey] = spectra[key];\n        }\n        return acc;\n      }, {});\n      return outerAcc;\n    },\n    {},\n  );\n\n  data = Object.entries(data).reduce((acc, spectra) => {\n    acc[spectra[0]] = Object.keys(newColumns).reduce((acc, key) => {\n      const isFormula = newColumns[key].type === COLUMNS_TYPES.FORMULA;\n      acc[key] = isFormula\n        ? {\n            colKey: key,\n            value: calculate(\n              newColumns,\n              data[spectra[0]],\n              newColumns[key].formula,\n            ),\n          }\n        : { ...spectra[1][key], colKey: key };\n\n      return acc;\n    }, {});\n\n    return acc;\n  }, {});\n  spectraAnalysis[nucleus].values = data;\n}\n\nfunction refreshByRow(row, columns) {\n  return Object.keys(columns).reduce((acc, key) => {\n    if (columns[key].type === COLUMNS_TYPES.FORMULA) {\n      acc[key] = {\n        colKey: key,\n        ...row,\n        value: calculate(columns, row, columns[key].formula),\n      };\n    }\n\n    return acc;\n  }, {});\n}\n\nfunction refreshCalculation(spectraAnalysis, nucleus) {\n  const { columns } = spectraAnalysis[nucleus].options;\n\n  const data = Object.entries(spectraAnalysis[nucleus].values).reduce(\n    (acc, spectra) => {\n      const [id, row] = spectra;\n      acc[id] = {\n        ...row,\n        ...refreshByRow(row, columns),\n      };\n      return acc;\n    },\n    {},\n  );\n\n  return data;\n}\n\nexport function analyzeSpectra(spectra, spectraAnalysis, options) {\n  const { from, to, nucleus, columnKey = null } = options;\n  init(spectraAnalysis, nucleus);\n  const colKey = addColumnKey(\n    spectraAnalysis,\n    nucleus,\n    {\n      type: COLUMNS_TYPES.NORMAL,\n      valueKey: 'relative',\n      from,\n      to,\n      index: 1,\n    },\n    columnKey,\n  );\n\n  const { sum } = spectraAnalysis[nucleus].options;\n\n  const { values: result, sum: spectraSum } = getSpectraAnalysis(spectra, {\n    from,\n    to,\n    nucleus,\n  });\n\n  const prevNucleusData = lodashGet(spectraAnalysis, `${nucleus}.values`, {});\n\n  let data = result.reduce((acc, row) => {\n    const factor = spectraSum > 0 ? sum / spectraSum : 0.0;\n\n    acc[row.SID] = {\n      ...prevNucleusData[row.SID],\n      [colKey]: {\n        colKey,\n        ...row,\n        relative: Math.abs(row.absolute) * factor,\n      },\n    };\n    return acc;\n  }, {});\n\n  spectraAnalysis[nucleus].values = data;\n  spectraAnalysis[nucleus].values = refreshCalculation(\n    spectraAnalysis,\n    nucleus,\n  );\n}\n\nexport function deleteSpectraAnalysis(spectraAnalysis, colKey, nucleus) {\n  const result = Object.entries(spectraAnalysis[nucleus].values).reduce(\n    (acc, item) => {\n      delete item[1][colKey];\n      if (item[1] && Object.keys(item[1]).length > 0) {\n        acc[item[0]] = item[1];\n        return acc;\n      }\n      return acc;\n    },\n    {},\n  );\n\n  delete spectraAnalysis[nucleus].options.columns[colKey];\n  spectraAnalysis[nucleus].values = result;\n  spectraAnalysis[nucleus].values = refreshCalculation(\n    spectraAnalysis,\n    nucleus,\n  );\n\n  if (isEmpty(spectraAnalysis[nucleus].values)) {\n    reservedColumnsNames[nucleus] = [];\n  }\n}\n\nfunction calculate(columns, data, formula = 'A+B') {\n  const array = formula.split(/\\+|-|\\*|\\/|%|\\(|\\)/);\n\n  const variables = [];\n\n  for (let i of array) {\n    const l = i.trim();\n    if (columns[l]) {\n      variables.push(l);\n    }\n  }\n\n  const params = variables.map((key) =>\n    data[key] ? data[key][columns[key].valueKey] : null,\n  );\n\n  let result;\n  try {\n    // eslint-disable-next-line no-new-func\n    result = new Function(...variables, `return ${formula}`)(...params);\n  } catch (e) {\n    // eslint-disable-next-line no-console\n    console.log(e);\n    result = new Error(`Invalid Formula ( ${formula} ) `);\n  }\n  return result;\n}\nexport function getDataAsString(spectraAnalysis, nucleus) {\n  if (spectraAnalysis && spectraAnalysis[nucleus]) {\n    const {\n      values,\n      options: { columns },\n    } = spectraAnalysis[nucleus];\n\n    let result = '';\n\n    for (const letter in columns) {\n      result += `${letter}\\t`;\n    }\n    result += '\\n';\n\n    for (const spectrum of Object.values(values)) {\n      for (const letter in columns) {\n        result += `${spectrum[letter][columns[letter].valueKey]}\\t`;\n      }\n      result += '\\n';\n    }\n    return result;\n  }\n  return null;\n}\n","export default function getChar(index) {\n  const aPotions = 'a'.charCodeAt(0);\n  const zPostion = 'z'.charCodeAt(0);\n  const len = zPostion - aPotions + 1;\n\n  let chartResult = '';\n  while (index >= 0) {\n    chartResult = String.fromCharCode((index % len) + aPotions) + chartResult;\n    index = Math.floor(index / len) - 1;\n  }\n  return chartResult;\n}\n","const REFERENCES = {\n  '1H': {\n    tms: {\n      from: -0.1,\n      to: 0.1,\n      nbPeaks: 1,\n      delta: 0,\n    },\n    tsp: {\n      from: -0.1,\n      to: 0.1,\n      nbPeaks: 1,\n      delta: 0,\n    },\n    glucose: {\n      from: 5.18,\n      to: 5.28,\n      nbPeaks: 2,\n      delta: 5.23,\n    },\n  },\n  '13C': {},\n};\n\nfunction getRange(options = {}) {\n  const { nucleus = '1H', reference = 'tms' } = options;\n\n  if (!REFERENCES[nucleus]) {\n    throw new Error('Nucleus not found: ', nucleus);\n  }\n\n  let info = REFERENCES[nucleus][reference.toLowerCase()];\n\n  if (!info) {\n    throw new Error('Reference not found: ', reference);\n  }\n\n  return {\n    from: info.delta - 0.05,\n    to: info.delta + 0.05,\n    delta: info.delta,\n    nbPeaks: info.nbPeaks,\n  };\n}\n\nexport { REFERENCES, getRange };\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback, useEffect, useMemo, useRef } from 'react';\n\nimport { REFERENCES } from '../../data/constants/References';\nimport { useDispatch } from '../context/DispatchContext';\nimport CloseButton from '../elements/CloseButton';\nimport Select from '../elements/Select';\nimport FormikForm from '../elements/formik/FormikForm';\nimport FormikInput from '../elements/formik/FormikInput';\nimport { ALIGN_SPECTRA } from '../reducer/types/Types';\nimport Events from '../utility/Events';\n\nconst styles = css`\n  overflow: auto;\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n\n  .header {\n    text-align: center;\n    padding: 10px 0 10px 0px;\n    margin: 0px;\n    color: #005d9e;\n    place-items: normal;\n    text-transform: none;\n    background-color: #fcfcfc;\n  }\n  // .main-content {\n  //   width: 100%;\n  //   flex: 1;\n  //   overflow: auto;\n  //   border: none;\n  // }\n\n  .tab-content {\n    width: 100%;\n  }\n  .row {\n    display: flex;\n  }\n\n  .inner-content {\n    padding: 15px 30px;\n    width: 100%;\n    overflow: auto;\n  }\n\n  button:focus {\n    outline: none;\n  }\n  button:hover {\n    color: #007bff;\n  }\n  .save-button:hover {\n    background-color: #ffffff;\n  }\n  .save-button {\n    border: none;\n    padding: 0 15px;\n    background-color: #ffffff5e;\n    border-radius: 5px;\n    height: 25px;\n  }\n\n  .footer-container {\n    display: flex;\n    align-items: flex-end;\n    justify-content: flex-end;\n    background: rgb(242, 242, 242);\n    background: -moz-linear-gradient(\n      0deg,\n      rgba(242, 242, 242, 1) 0%,\n      rgba(245, 245, 245, 1) 37%,\n      rgba(255, 255, 255, 1) 90%\n    );\n    background: -webkit-linear-gradient(\n      0deg,\n      rgba(242, 242, 242, 1) 0%,\n      rgba(245, 245, 245, 1) 37%,\n      rgba(255, 255, 255, 1) 90%\n    );\n    background: linear-gradient(\n      0deg,\n      rgba(242, 242, 242, 1) 0%,\n      rgba(245, 245, 245, 1) 37%,\n      rgba(255, 255, 255, 1) 90%\n    );\n    filter: progid:DXImageTransform.Microsoft.gradient(startColorstr=\"#f2f2f2\",endColorstr=\"#ffffff\",GradientType=1);\n    padding: 6px 15px;\n    height: 55px;\n  }\n\n  .section-header {\n    font-size: 13px;\n    color: #2ca8ff;\n    margin-bottom: 10px;\n    border-bottom: 0.55px solid #f9f9f9;\n    padding: 6px 2px;\n  }\n\n  .custom-label {\n    font-size: 12px;\n    font-weight: bold;\n    margin-right: 10px;\n    width: 120px;\n  }\n  .margin-10 {\n    margin: 10px 0;\n  }\n\n  .input {\n    font-size: 14px;\n    border-radius: 5px;\n    border: 1px solid #cccccc;\n    padding: 5px;\n    width: 100px;\n    margin-right: 10px;\n    height: initial !important;\n  }\n\n  .close-bt {\n    border: none;\n    color: red;\n    background-color: transparent;\n    outline: none;\n    position: absolute;\n    right: 10px;\n    top: 2px;\n    width: 30px;\n    height: 30px;\n  }\n`;\n\nconst baseList = [{ key: 1, value: 'manual', label: 'Manual' }];\n\nfunction AlignSpectraModal({ onClose, nucleus }) {\n  const refForm = useRef();\n  const dispatch = useDispatch();\n  const List = useMemo(() => {\n    const list = REFERENCES[nucleus]\n      ? Object.entries(REFERENCES[nucleus]).map(\n          (item) => ({\n            key: item[0],\n            value: item[0],\n            label: item[0],\n          }),\n          [],\n        )\n      : [];\n\n    return baseList.concat(list);\n  }, [nucleus]);\n  const handleSave = useCallback(() => {\n    refForm.current.submitForm();\n  }, []);\n\n  const submitHandler = useCallback(\n    (values) => {\n      dispatch({ type: ALIGN_SPECTRA, payload: values });\n      onClose();\n    },\n    [dispatch, onClose],\n  );\n\n  useEffect(() => {\n    Events.on('brushEnd', (event) => {\n      const [from, to] = event.range;\n      refForm.current.setValues({ ...refForm.current.values, from, to });\n    });\n\n    return () => {\n      Events.off('brushEnd');\n    };\n  }, []);\n\n  const optionChangeHandler = useCallback(\n    (id) => {\n      const value = REFERENCES[nucleus][id];\n      const { delta = 0, ...resValues } = value || { delta: 0 };\n      refForm.current.setValues({\n        ...refForm.current.values,\n        targetX: delta,\n        ...resValues,\n      });\n    },\n    [nucleus],\n  );\n\n  return (\n    <div css={styles}>\n      <div className=\"header handle\">\n        <span>Spectra calibration</span>\n        <CloseButton onClick={onClose} className=\"close-bt\" />\n      </div>\n      <div className=\"inner-content\">\n        <FormikForm\n          ref={refForm}\n          initialValues={{ from: -1, to: 1, nbPeaks: 1, targetX: 0 }}\n          onSubmit={submitHandler}\n        >\n          <div className=\"row margin-10\">\n            <span className=\"custom-label\">Options :</span>\n\n            <Select\n              data={List}\n              style={{ width: 270, height: 30, marginBottom: '20px' }}\n              onChange={optionChangeHandler}\n            />\n          </div>\n          <div className=\"row margin-10\">\n            <span className=\"custom-label\">Range :</span>\n            <FormikInput label=\"From : \" name=\"from\" type=\"number\" />\n            <FormikInput label=\"To :\" name=\"to\" type=\"number\" />\n          </div>\n          <div className=\"row margin-10\">\n            <span className=\"custom-label\">Number of Peaks : </span>\n            <FormikInput name=\"nbPeaks\" type=\"number\" />\n          </div>\n          <div className=\"row margin-10\">\n            <span className=\"custom-label\">Target PPM :</span>\n            <FormikInput name=\"targetX\" type=\"number\" />\n          </div>\n        </FormikForm>\n      </div>\n      <div className=\"footer-container\">\n        <button type=\"button\" onClick={handleSave} className=\"save-button\">\n          Done\n        </button>\n      </div>\n    </div>\n  );\n}\n\nexport default AlignSpectraModal;\n","import { css } from '@emotion/react';\n\nexport default css`\n  code[class*='language-'],\n  pre[class*='language-'] {\n    color: black;\n    background: none;\n    text-shadow: 0 1px white;\n    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;\n    font-size: 1em;\n    text-align: left;\n    white-space: pre;\n    word-spacing: normal;\n    word-break: normal;\n    word-wrap: normal;\n    line-height: 1.5;\n\n    -moz-tab-size: 4;\n    -o-tab-size: 4;\n    tab-size: 4;\n\n    -webkit-hyphens: none;\n    -moz-hyphens: none;\n    -ms-hyphens: none;\n    hyphens: none;\n  }\n\n  pre[class*='language-']::-moz-selection,\n  pre[class*='language-'] ::-moz-selection,\n  code[class*='language-']::-moz-selection,\n  code[class*='language-'] ::-moz-selection {\n    text-shadow: none;\n    background: #b3d4fc;\n  }\n\n  pre[class*='language-']::selection,\n  pre[class*='language-'] ::selection,\n  code[class*='language-']::selection,\n  code[class*='language-'] ::selection {\n    text-shadow: none;\n    background: #b3d4fc;\n  }\n\n  @media print {\n    code[class*='language-'],\n    pre[class*='language-'] {\n      text-shadow: none;\n    }\n  }\n\n  /* Code blocks */\n  pre[class*='language-'] {\n    padding: 1em;\n    margin: 0.5em 0;\n    overflow: auto;\n  }\n\n  :not(pre) > code[class*='language-'],\n  pre[class*='language-'] {\n    background: #f5f2f0;\n  }\n\n  /* Inline code */\n  :not(pre) > code[class*='language-'] {\n    padding: 0.1em;\n    border-radius: 0.3em;\n    white-space: normal;\n  }\n\n  .token.comment,\n  .token.prolog,\n  .token.doctype,\n  .token.cdata {\n    color: slategray;\n  }\n\n  .token.punctuation {\n    color: #999;\n  }\n\n  .token.namespace {\n    opacity: 0.7;\n  }\n\n  .token.property,\n  .token.tag,\n  .token.boolean,\n  .token.number,\n  .token.constant,\n  .token.symbol,\n  .token.deleted {\n    color: #905;\n  }\n\n  .token.selector,\n  .token.attr-name,\n  .token.string,\n  .token.char,\n  .token.builtin,\n  .token.inserted {\n    color: #690;\n  }\n\n  .token.operator,\n  .token.entity,\n  .token.url,\n  .language-css .token.string,\n  .style .token.string {\n    color: #9a6e3a;\n    /* This background color was intended by the author of this theme. */\n    background: hsla(0, 0%, 100%, 0.5);\n  }\n\n  .token.atrule,\n  .token.attr-value,\n  .token.keyword {\n    color: #07a;\n  }\n\n  .token.function,\n  .token.class-name {\n    color: #dd4a68;\n  }\n\n  .token.regex,\n  .token.important,\n  .token.variable {\n    color: #e90;\n  }\n\n  .token.important,\n  .token.bold {\n    font-weight: bold;\n  }\n  .token.italic {\n    font-style: italic;\n  }\n\n  .token.entity {\n    cursor: help;\n  }\n`;\n","export default function calculate(code, args = null) {\n  try {\n    // eslint-disable-next-line no-new-func\n    return new Function('args', `return ${code}`)(args);\n  } catch (e) {\n    return e;\n  }\n}\n","/** @jsxImportSource @emotion/react */\nimport { useFormikContext } from 'formik';\nimport { highlight, languages } from 'prismjs/components/prism-core';\n// eslint-disable-next-line import/no-unassigned-import\nimport 'prismjs/components/prism-clike';\n// eslint-disable-next-line import/no-unassigned-import\nimport 'prismjs/components/prism-javascript';\nimport { memo, useCallback, useEffect, useState } from 'react';\nimport Editor from 'react-simple-code-editor';\n\nimport prismStyles from '../../elements/styles/prism';\nimport Eval from '../../utility/Evaluate';\n\nconst initCode = `function run(data) {\n\n  return JSON.stringify(data,undefined, 2);\n  \n}(args);\n`;\n\nfunction MulipleAnalysisCodeEditor({ data }) {\n  const { values, setFieldValue } = useFormikContext();\n  const [code, setCode] = useState(values.code ? values.code : initCode);\n  const [result, setResult] = useState('');\n\n  useEffect(() => {\n    const evalResult = Eval(code, data);\n    if (evalResult instanceof Error) {\n      setResult(evalResult.message);\n    } else {\n      setFieldValue('code', code);\n      setResult(evalResult);\n    }\n  }, [code, data, setFieldValue]);\n\n  const valueChangeHandler = useCallback((code) => {\n    setCode(code);\n  }, []);\n  const highlightHandler = useCallback((code) => {\n    try {\n      return highlight(code, languages.js);\n    } catch (e) {\n      return null;\n    }\n  }, []);\n\n  return (\n    <div style={{ marginTop: '20px' }} css={prismStyles}>\n      <Editor\n        value={code}\n        onValueChange={valueChangeHandler}\n        highlight={highlightHandler}\n        padding={10}\n        style={{\n          fontFamily: '\"Fira code\", \"Fira Mono\", monospace',\n          fontSize: 12,\n          backgroundColor: '#fcfcfc',\n          marginBottom: '10px',\n          minHeight: '100px',\n          overflow: 'auto',\n          maxHeight: '200px',\n        }}\n      />\n      <p style={{ marginBottom: '5px' }}>Result:</p>\n\n      <Editor\n        value={result}\n        onValueChange={(code) => code}\n        highlight={highlightHandler}\n        padding={10}\n        style={{\n          border: '0.55px solid #f3f3f3',\n          fontFamily: '\"Fira code\", \"Fira Mono\", monospace',\n          fontSize: 12,\n          marginBottom: '10px',\n          minHeight: '100px',\n          overflow: 'auto',\n          maxHeight: '200px',\n        }}\n      />\n    </div>\n  );\n}\n\nexport default memo(MulipleAnalysisCodeEditor);\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport {\n  forwardRef,\n  useCallback,\n  useEffect,\n  useImperativeHandle,\n  useMemo,\n  useRef,\n  useState,\n} from 'react';\nimport { FaPlus } from 'react-icons/fa';\nimport * as Yup from 'yup';\n\nimport { COLUMNS_TYPES } from '../../../data/data1d/MulitpleAnalysis';\nimport { useDispatch } from '../../context/DispatchContext';\nimport FormikForm from '../../elements/formik/FormikForm';\nimport FormikInput from '../../elements/formik/FormikInput';\nimport { SET_ANALYZE_SPECTRA_COLUMNS } from '../../reducer/types/Types';\n\nimport MulipleAnalysisCodeEditor from './MulipleAnalysisCodeEditor';\n\nconst styles = css`\n  width: 100%;\n  thead {\n    border-bottom: 1px solid lightgray;\n    background-color: #fafafa;\n    font-size: 12px;\n  }\n\n  td,\n  th {\n    padding: 3px 5px;\n    text-align: center;\n  }\n\n  .operation-col {\n    width: 30px;\n  }\n\n  .input {\n    // border: 0.55px solid rgb(237 237 237) !important;\n    height: 25px !important;\n    width: 100% !important;\n    margin: 0 !important;\n    // text-transform: uppercase;\n  }\n\n  .input.disbale {\n    background-color: #e8e8e8;\n    border-radius: 5px;\n  }\n\n  .label,\n  .index {\n    width: 100px;\n  }\n\n  .counter {\n    width: 50px;\n  }\n\n  .add {\n    background-color: transparent;\n    border: 0;\n    outline: none;\n    svg {\n      font-szie: 14px;\n      fill: green;\n    }\n  }\n`;\nconst MultipleSpectraAnalysisPreferences = forwardRef(\n  function MultipleSpectraAnalysisPreferences({ data, onAfterSave }, ref) {\n    const dispatch = useDispatch();\n    const refForm = useRef();\n    const [columns, setColumns] = useState({});\n\n    useImperativeHandle(ref, () => ({\n      saveSetting() {\n        refForm.current.submitForm();\n      },\n    }));\n\n    useEffect(() => {\n      const result = Object.keys(data.columns).reduce((acc, key) => {\n        acc[key] = { ...data.columns[key], tempKey: key };\n        return acc;\n      }, {});\n      setColumns(result);\n      refForm.current.setValues({ columns: result, code: data.code });\n    }, [data]);\n\n    const columnsKeys = useMemo(() => {\n      return Object.keys(columns);\n    }, [columns]);\n\n    const preferncesSchema = useMemo(() => {\n      function columnSchema() {\n        return columnsKeys.reduce((acc, key) => {\n          acc[key] = Yup.object().shape({\n            tempKey: Yup.string()\n              .required()\n              .test('unique', 'must be unique column name', (colmnName) => {\n                const formData = refForm.current.values.columns;\n                return (\n                  Object.keys(formData).reduce((acc, colKey) => {\n                    if (formData[colKey].tempKey === colmnName) {\n                      acc.push(colmnName);\n                    }\n                    return acc;\n                  }, []).length === 1\n                );\n              }),\n            ...(columns[key].type === COLUMNS_TYPES.FORMULA\n              ? { formula: Yup.string().required() }\n              : {}),\n            index: Yup.string().required(),\n          });\n          return acc;\n        }, {});\n      }\n\n      //   console.log(columnSchema());\n\n      return Yup.object().shape({\n        columns: Yup.object().shape(columnSchema()),\n      });\n    }, [columns, columnsKeys, refForm]);\n\n    const submitHandler = useCallback(\n      (values) => {\n        onAfterSave(true);\n        const result = Object.entries(values.columns).reduce(\n          (acc, [key, value]) => {\n            acc[key] = { ...columns[key], ...value };\n            return acc;\n          },\n          {},\n        );\n        dispatch({\n          type: SET_ANALYZE_SPECTRA_COLUMNS,\n          payload: { code: values.code, columns: result },\n        });\n      },\n      [columns, dispatch, onAfterSave],\n    );\n\n    const addNewColumn = useCallback((index) => {\n      setColumns((prevData) => {\n        return {\n          ...prevData,\n          [`temp${index}`]: {\n            tempKey: '',\n            type: 'FORMULA',\n            valueKey: 'value',\n            formula: '',\n            index: index,\n          },\n        };\n      });\n    }, []);\n\n    return (\n      <FormikForm\n        ref={refForm}\n        initialValues={{ columns, code: null }}\n        validationSchema={preferncesSchema}\n        onSubmit={submitHandler}\n      >\n        {columnsKeys && (\n          <table css={styles}>\n            <thead>\n              <tr>\n                <th className=\"counter\">#</th>\n                <th className=\"label\">Label</th>\n                <th>value</th>\n                <th className=\"index\">index</th>\n              </tr>\n            </thead>\n            <tbody>\n              {columnsKeys.map((key, index) => {\n                return (\n                  <tr key={key}>\n                    <td className=\"counter\">{index + 1}</td>\n                    <td className=\"label\">\n                      <FormikInput\n                        key={key}\n                        name={`columns.${key}.tempKey`}\n                        value={columns[key].tempKey}\n                      />\n                    </td>\n                    <td>\n                      {columns[key].type === COLUMNS_TYPES.FORMULA ? (\n                        <FormikInput\n                          name={`columns.${key}.formula`}\n                          value={columns[key].formula}\n                        />\n                      ) : (\n                        <div className=\"input disbale\" />\n                      )}\n                    </td>\n                    <td className=\"index\">\n                      <FormikInput\n                        name={`columns.${key}.index`}\n                        value={columns[key].index}\n                      />\n                    </td>\n                    <td className=\"operation-col\">\n                      {columnsKeys.length === index + 1 && (\n                        <button\n                          className=\"add\"\n                          type=\"button\"\n                          onClick={() => addNewColumn(index + 1)}\n                        >\n                          <FaPlus />\n                        </button>\n                      )}\n                    </td>\n                  </tr>\n                );\n              })}\n            </tbody>\n          </table>\n        )}\n        <MulipleAnalysisCodeEditor data={data} />\n      </FormikForm>\n    );\n  },\n);\n\nMultipleSpectraAnalysisPreferences.defaultProps = {\n  onAfterSave: () => false,\n};\nexport default MultipleSpectraAnalysisPreferences;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\n\nconst styles = css`\n  background-color: white;\n  position: absolute;\n  height: auto;\n  z-index: 99999999999999;\n  box-shadow: 0 19px 38px rgba(0, 0, 0, 0.3), 0 15px 12px rgba(0, 0, 0, 0.22);\n  border-radius: 10px;\n  margin-bottom: 20px;\n\n  ul {\n    list-style-type: none;\n    padding: 0;\n    margin: 0;\n\n    li {\n      padding: 10px 30px;\n      text-align: center;\n      color: black;\n      border-bottom: 0.55px solid lightgoldenrodyellow;\n      min-width: 150px;\n    }\n\n    li:last-of-type {\n      border-bottom: none;\n    }\n\n    li:hover {\n      background-color: gray;\n      color: white;\n    }\n  }\n`;\n\nfunction DropDownList({ data = [], onSelect }) {\n  return (\n    <div css={styles}>\n      <ul>\n        {data.map((item, i) => (\n          <li key={item.key} onClick={() => onSelect(i)}>\n            {item.label}\n          </li>\n        ))}\n      </ul>\n    </div>\n  );\n}\n\nexport default DropDownList;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback, useEffect, useRef, useState } from 'react';\nimport { FaEllipsisH } from 'react-icons/fa';\n\nimport { useGlobal } from '../../context/GlobalContext';\n\nimport DropDownList from './DropDownList';\n\nconst styles = css`\n  // position: absolute;\n  padding: 2px;\n  border-radius: 10px;\n  width: auto;\n  display: inline-block;\n  border: 0.55px solid lightgray;\n  font-size: 10px;\n\n  button {\n    text-transform: Capitalize;\n  }\n`;\n\nfunction DropDownButton({ data, selectedKey, onSelect, formatSelectedValue }) {\n  const [open, setOpen] = useState(false);\n  const [value, setValue] = useState(selectedKey);\n  const { rootRef } = useGlobal();\n\n  const drop = useRef(null);\n  const handleClick = useCallback(\n    (e) => {\n      if (!e.target.closest(`.${drop.current.className}`) && open) {\n        setTimeout(() => {\n          setOpen(false);\n        }, 0);\n      }\n    },\n    [open],\n  );\n  useEffect(() => {\n    if (rootRef) {\n      rootRef.addEventListener('click', handleClick);\n    }\n    return () => rootRef.removeEventListener('click', handleClick);\n  }, [handleClick, open, rootRef]);\n\n  const selectHandler = useCallback(\n    (index) => {\n      setValue(data[index].label);\n      onSelect(data[index].key);\n    },\n    [data, onSelect],\n  );\n\n  return (\n    <div className=\"dropdown\" ref={drop} css={styles}>\n      <button type=\"button\" onClick={() => setOpen((open) => !open)}>\n        {!value ? <FaEllipsisH /> : formatSelectedValue(value)}\n      </button>\n      {open && <DropDownList data={data} onSelect={selectHandler} />}\n    </div>\n  );\n}\n\nDropDownButton.defaultProps = {\n  data: null,\n  formatSelectedValue: (val) => val,\n  value: null,\n};\n\nexport default DropDownButton;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback } from 'react';\n\nimport { COLUMNS_TYPES } from '../../../data/data1d/MulitpleAnalysis';\nimport { useDispatch } from '../../context/DispatchContext';\nimport DeleteButton from '../../elements/Tab/DeleteButton';\nimport DropDownButton from '../../elements/dropDownButton/DropDownButton';\nimport { DELETE_ANALYZE_SPECTRA_RANGE } from '../../reducer/types/Types';\n\nconst styles = (styles) => css`\n  position: relative;\n\n  .delete {\n    position: absolute;\n    right: 0px;\n    top: 0px;\n  }\n\n  .container {\n    display: flex;\n    flex-direction: column;\n    padding: 0;\n    margin: 0;\n  }\n  .dropDown-container {\n    justify-content: flex-start;\n    align-items: flex-start;\n  }\n  .label-container {\n    flex: 1;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    flex-direction: column;\n    min-height: 45px;\n  }\n\n  .label {\n    text-align: center;\n  }\n\n  ${styles}\n`;\n\nconst columnsFilters = [\n  { key: 'relative', label: 'Relative' },\n  { key: 'absolute', label: 'Absolute' },\n  { key: 'min', label: 'Min Intensity' },\n  { key: 'max', label: 'Max Intensity' },\n];\n\nfunction ColumnHeader({ charLabel, rangeLabel, data, onColumnFilter }) {\n  const dispatch = useDispatch();\n\n  const deleteHandler = useCallback(() => {\n    dispatch({ type: DELETE_ANALYZE_SPECTRA_RANGE, colKey: charLabel });\n  }, [charLabel, dispatch]);\n\n  return (\n    <div css={styles}>\n      <div className=\"container\">\n        {data.type === COLUMNS_TYPES.NORMAL && (\n          <div className=\"dropDown-container\">\n            <DropDownButton\n              data={columnsFilters}\n              formatSelectedValue={(value) =>\n                value ? value.substr(0, 3) : value\n              }\n              selectedKey={data.valueKey}\n              onSelect={onColumnFilter}\n            />\n          </div>\n        )}\n        <div className=\"label-container\">\n          <span className=\"label\"> {charLabel}</span>\n          <span className=\"label\">{rangeLabel}</span>\n        </div>\n      </div>\n      <DeleteButton onDelete={deleteHandler} />\n    </div>\n  );\n}\n\nexport default ColumnHeader;\n","import lodashGet from 'lodash/get';\nimport { useMemo, memo, useCallback, Fragment } from 'react';\n\nimport { useDispatch } from '../../context/DispatchContext';\nimport ReactTable from '../../elements/ReactTable/ReactTable';\nimport { FILTER_SPECTRA_COLUMN } from '../../reducer/types/Types';\nimport Eval from '../../utility/Evaluate';\nimport { useFormatNumberByNucleus } from '../../utility/FormatNumber';\nimport NoTableData from '../extra/placeholder/NoTableData';\n\nimport ColumnHeader from './ColumnHeader';\n\nfunction MultipleSpectraAnalysisTable({ data, activeTab }) {\n  const format = useFormatNumberByNucleus(activeTab);\n\n  const codeEvaluation = useMemo(() => {\n    const code = lodashGet(data, 'code', '');\n    return Eval(code, data);\n  }, [data]);\n\n  const dispatch = useDispatch();\n\n  const columnFilterHandler = useCallback(\n    (columnKey, valueKey) => {\n      dispatch({\n        type: FILTER_SPECTRA_COLUMN,\n        payload: {\n          columnKey,\n          valueKey,\n        },\n      });\n    },\n    [dispatch],\n  );\n\n  const tableColumns = useMemo(() => {\n    const initColumns = [\n      {\n        Header: '#',\n        index: 0,\n        Cell: ({ row }) => row.index + 1,\n      },\n    ];\n\n    const columns = initColumns;\n    const setCustomColumn = (array, index, columnLabel, cellHandler) => {\n      const columnData = data.columns[columnLabel];\n      array.push({\n        index: index,\n        Header: () => (\n          <ColumnHeader\n            charLabel={columnLabel}\n            data={columnData}\n            onColumnFilter={(valueKey) =>\n              columnFilterHandler(columnLabel, valueKey)\n            }\n            rangeLabel={\n              columnData.from && columnData.to\n                ? `${format(columnData.from)} - ${format(columnData.to)}`\n                : ''\n            }\n          />\n        ),\n        id: columnLabel,\n        sortType: 'basic',\n        Cell: ({ row }) => cellHandler(row),\n      });\n    };\n    if (data.columns) {\n      Object.keys(data.columns).forEach((key) => {\n        const { valueKey, index: columnIndex } = data.columns[key];\n        setCustomColumn(columns, columnIndex + 1, key, (row) => {\n          const value = row.original[key][valueKey];\n          const result =\n            value instanceof Error ? (\n              <span style={{ color: 'red' }}>{value.message}</span>\n            ) : (\n              format(value)\n            );\n          return result;\n        });\n      });\n    }\n    const resultColumns = columns ? columns : initColumns;\n    return resultColumns.sort(\n      (object1, object2) => object1.index - object2.index,\n    );\n  }, [columnFilterHandler, data.columns, format]);\n\n  return data.values && data.values.length > 0 ? (\n    <Fragment>\n      <ReactTable data={data.values} columns={tableColumns} />\n      <div\n        style={{\n          width: '100%',\n          padding: '10px',\n        }}\n        // eslint-disable-next-line react/no-danger\n        dangerouslySetInnerHTML={{ __html: codeEvaluation }}\n      />\n    </Fragment>\n  ) : (\n    <NoTableData />\n  );\n}\n\nexport default memo(MultipleSpectraAnalysisTable);\n","import { SvgNmrOverlay } from 'cheminfo-font';\nimport { useCallback, useState, useRef, memo, useMemo } from 'react';\nimport ReactCardFlip from 'react-card-flip';\nimport { FaFileExport } from 'react-icons/fa';\nimport { IoPulseOutline } from 'react-icons/io5';\n\nimport { getDataAsString } from '../../../data/data1d/MulitpleAnalysis';\nimport { useDispatch } from '../../context/DispatchContext';\nimport Button from '../../elements/ButtonToolTip';\nimport ToggleButton from '../../elements/ToggleButton';\nimport { positions, useAlert } from '../../elements/popup/Alert';\nimport { useModal } from '../../elements/popup/Modal';\nimport MultiAnalysisWrapper from '../../hoc/MultiAnalysisWrapper';\nimport AlignSpectraModal from '../../modal/AlignSpectraModal';\nimport { RESET_SELECTED_TOOL } from '../../reducer/types/Types';\nimport Events from '../../utility/Events';\nimport { copyTextToClipboard } from '../../utility/Export';\nimport DefaultPanelHeader from '../header/DefaultPanelHeader';\nimport PreferencesHeader from '../header/PreferencesHeader';\n\nimport MultipleSpectraAnalysisPreferences from './MultipleSpectraAnalysisPreferences';\nimport MultipleSpectraAnalysisTable from './MultipleSpectraAnalysisTable';\n\nconst styles = {\n  container: {\n    display: 'flex',\n    flexDirection: 'column',\n    height: '100%',\n  },\n  button: {\n    backgroundColor: 'transparent',\n    border: 'none',\n  },\n};\n\nfunction MultipleSpectraAnalysisPanel({ spectraAnalysis, activeTab }) {\n  const [isFlipped, setFlipStatus] = useState(false);\n  const settingRef = useRef();\n  const alert = useAlert();\n  const modal = useModal();\n  const dispatch = useDispatch();\n\n  const data = useMemo(() => {\n    const {\n      values,\n      options: { columns, code },\n    } = spectraAnalysis[activeTab] || {\n      values: {},\n      options: { columns: {}, code: null },\n    };\n    return { values: Object.values(values), columns, code };\n  }, [activeTab, spectraAnalysis]);\n\n  const settingsPanelHandler = useCallback(() => {\n    setFlipStatus(!isFlipped);\n  }, [isFlipped]);\n\n  const saveSettingHandler = useCallback(() => {\n    settingRef.current.saveSetting();\n  }, []);\n\n  const afterSaveHandler = useCallback(() => {\n    setFlipStatus(false);\n  }, []);\n\n  const showTrackerHandler = useCallback((flag) => {\n    Events.emit('showYSpectraTrackers', flag);\n  }, []);\n  const openAlignSpectra = useCallback(() => {\n    dispatch({ type: RESET_SELECTED_TOOL });\n    modal.show(<AlignSpectraModal nucleus={activeTab} />, {\n      isBackgroundBlur: false,\n      position: positions.TOP_CENTER,\n      // enableResizing: false,\n      width: 500,\n      // height: 600,\n    });\n  }, [activeTab, modal, dispatch]);\n\n  const copyToClipboardHandler = useCallback(() => {\n    const data = getDataAsString(spectraAnalysis, activeTab);\n    const success = copyTextToClipboard(data);\n    if (success) {\n      alert.success('Data copied to clipboard');\n    } else {\n      alert.error('copy to clipboard failed');\n    }\n  }, [activeTab, alert, spectraAnalysis]);\n\n  return (\n    <div style={styles.container}>\n      {!isFlipped && (\n        <DefaultPanelHeader\n          deleteToolTip=\"Delete All Peaks\"\n          showSettingButton=\"true\"\n          canDelete={false}\n          onSettingClick={settingsPanelHandler}\n        >\n          <Button\n            popupTitle=\"Copy To Clipboard\"\n            style={styles.button}\n            onClick={copyToClipboardHandler}\n          >\n            <FaFileExport />\n          </Button>\n          <Button\n            popupTitle=\"Spectra calibration\"\n            style={styles.button}\n            onClick={openAlignSpectra}\n          >\n            <SvgNmrOverlay style={{ fontSize: '18px' }} />\n          </Button>\n          <ToggleButton\n            popupTitle=\"Y Spectra Tracker\"\n            popupPlacement=\"right\"\n            onClick={showTrackerHandler}\n          >\n            <IoPulseOutline />\n          </ToggleButton>\n        </DefaultPanelHeader>\n      )}\n      {isFlipped && (\n        <PreferencesHeader\n          onSave={saveSettingHandler}\n          onClose={settingsPanelHandler}\n        />\n      )}\n      <div style={{ height: '100%', overflow: 'auto' }}>\n        <ReactCardFlip\n          isFlipped={isFlipped}\n          infinite\n          containerStyle={{ overflow: 'hidden' }}\n        >\n          <MultipleSpectraAnalysisTable data={data} activeTab={activeTab} />\n          <MultipleSpectraAnalysisPreferences\n            data={data}\n            onAfterSave={afterSaveHandler}\n            ref={settingRef}\n          />\n        </ReactCardFlip>\n      </div>\n    </div>\n  );\n}\n\nexport default MultiAnalysisWrapper(memo(MultipleSpectraAnalysisPanel));\n","import { forwardRef, useMemo } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\nimport { usePreferences } from '../context/PreferencesContext';\n\nfunction PeaksWrapper(WrappedComponent) {\n  const Wrapper = (props) => {\n    const {\n      data: spectra,\n      activeSpectrum,\n      xDomain,\n      activeTab,\n      tabActiveSpectrum,\n    } = useChartData();\n    const preferences = usePreferences();\n\n    const { peaks = {}, info = {}, data = {} } = useMemo(() => {\n      if (spectra && activeSpectrum && activeSpectrum.id) {\n        const datum = spectra.find(\n          (datum) => datum.id === activeSpectrum.id,\n        ) || {\n          peaks: {},\n          info: {},\n          data: {},\n        };\n        return datum;\n      }\n      return {};\n    }, [activeSpectrum, spectra]);\n\n    const nucleus = useMemo(() => {\n      if (tabActiveSpectrum && Object.keys(tabActiveSpectrum).length > 0) {\n        return Object.keys(tabActiveSpectrum);\n      }\n      return null;\n    }, [tabActiveSpectrum]);\n\n    const { forwardedRef, ...rest } = props;\n\n    return (\n      <WrappedComponent\n        {...rest}\n        peaks={peaks}\n        info={info}\n        x={data.x}\n        y={data.y}\n        xDomain={xDomain}\n        preferences={preferences}\n        activeTab={activeTab}\n        nucleus={nucleus}\n        ref={forwardedRef}\n      />\n    );\n  };\n  return forwardRef((props, ref) => {\n    return <Wrapper {...props} forwardedRef={ref} />;\n  });\n}\nexport default PeaksWrapper;\n","import lodashGet from 'lodash/get';\nimport lodashSet from 'lodash/set';\nimport {\n  useEffect,\n  useState,\n  useCallback,\n  forwardRef,\n  useImperativeHandle,\n  useRef,\n} from 'react';\n\nimport IsotopesViewer from '../../elements/IsotopesViewer';\nimport { useAlert } from '../../elements/popup/Alert';\nimport PeaksWrapper from '../../hoc/PeaksWrapper';\nimport { SET_PANELS_PREFERENCES } from '../../reducer/preferencesReducer';\nimport {\n  useStateWithLocalStorage,\n  getValue as getValueByKeyPath,\n} from '../../utility/LocalStorage';\nimport ColumnFormatField from '../extra/preferences/ColumnFormatField';\nimport { peaksDefaultValues } from '../extra/preferences/defaultValues';\n\nconst styles = {\n  container: { padding: 10, backgroundColor: '#f1f1f1', height: '100%' },\n  groupContainer: {\n    padding: '5px',\n    borderRadius: '5px',\n    margin: '10px 0px',\n    backgroundColor: 'white',\n  },\n  row: {\n    display: 'flex',\n    margin: '5px 0px',\n  },\n  header: {\n    borderBottom: '1px solid #e8e8e8',\n    paddingBottom: '5px',\n    fontWeight: 'bold',\n    color: '#4a4a4a',\n  },\n  inputLabel: {\n    flex: 2,\n    fontSize: '11px',\n    fontWeight: 'bold',\n    color: '#232323',\n  },\n  input: {\n    width: '30%',\n    textAlign: 'center',\n  },\n};\n\nconst formatFields = [\n  {\n    id: 1,\n    label: 'Peak Number :',\n    checkController: 'showPeakNumber',\n    formatController: 'peakNumberFormat',\n    defaultFormat: '',\n  },\n  {\n    id: 2,\n    label: 'Peak Index : ',\n    checkController: 'showPeakIndex',\n    formatController: 'peakIndexFormat',\n    defaultFormat: '',\n  },\n  {\n    id: 3,\n    label: ' (ppm) :',\n    checkController: 'showDeltaPPM',\n    formatController: 'deltaPPMFormat',\n    defaultFormat: '00.00',\n  },\n  {\n    id: 4,\n    label: ' (Hz) :',\n    checkController: 'showDeltaHz',\n    formatController: 'deltaHzFormat',\n    defaultFormat: '00.00',\n  },\n  {\n    id: 5,\n    label: 'Peak Width',\n    checkController: 'showPeakWidth',\n    formatController: 'peakWidthFormat',\n    defaultFormat: '00.0000',\n  },\n  {\n    id: 6,\n    label: 'Intensity :',\n    checkController: 'showIntensity',\n    formatController: 'intensityFormat',\n    defaultFormat: '00.00',\n  },\n];\n\nfunction PeaksPreferences({ nucleus, preferences }, ref) {\n  const alert = useAlert();\n  const [, setSettingsData] = useStateWithLocalStorage('nmr-general-settings');\n  const [settings, setSetting] = useState(null);\n  const formRef = useRef();\n\n  useEffect(() => {\n    const peaksPreferences = getValueByKeyPath(\n      preferences,\n      `formatting.panels.peaks`,\n    );\n    if (peaksPreferences) {\n      setSetting(peaksPreferences);\n    }\n  }, [preferences]);\n\n  const saveHandler = useCallback(\n    (values, showMessage = false) => {\n      preferences.dispatch({\n        type: SET_PANELS_PREFERENCES,\n        payload: { key: 'peaks', value: values },\n      });\n      if (showMessage) alert.success('Peaks preferences saved successfully');\n    },\n    [alert, preferences],\n  );\n\n  useImperativeHandle(ref, () => ({\n    saveSetting() {\n      if (typeof formRef.current.requestSubmit === 'function') {\n        formRef.current.requestSubmit();\n      } else {\n        formRef.current.dispatchEvent(\n          new Event('submit', { cancelable: true }),\n        );\n      }\n    },\n  }));\n\n  const handleSubmit = useCallback(\n    (event) => {\n      event.preventDefault();\n      const form = event.target;\n      const formData = new FormData(form);\n      let values = {};\n      for (let field of formData.entries()) {\n        const keys = field[0].split('-').join('.');\n        const val = ['true', 'false'].includes(field[1])\n          ? field[1] === 'true'\n          : field[1];\n        values = lodashSet(values, keys, val);\n      }\n      saveHandler(values, true);\n      setSettingsData(values, 'formatting.panels.peaks');\n    },\n    [saveHandler, setSettingsData],\n  );\n\n  const getValue = useCallback(\n    (...params) => {\n      const keys = params.join('.');\n      if (settings) {\n        const value = lodashGet(settings, keys);\n        return value ? value : null;\n      } else {\n        const keyIndex = params.length - 1;\n        return peaksDefaultValues[params[keyIndex]];\n      }\n    },\n    [settings],\n  );\n\n  return (\n    <div style={styles.container}>\n      <form onSubmit={handleSubmit} ref={formRef}>\n        {nucleus &&\n          nucleus.map((nucleusLabel) => (\n            <div key={nucleusLabel} style={styles.groupContainer}>\n              <IsotopesViewer style={styles.header} value={nucleusLabel} />\n              {formatFields.map((field) => (\n                <ColumnFormatField\n                  key={field.id}\n                  label={field.label}\n                  checked={getValue(nucleusLabel, field.checkController)}\n                  format={getValue(nucleusLabel, field.formatController)}\n                  checkControllerName={field.checkController}\n                  formatControllerName={field.formatController}\n                  groupID={nucleusLabel}\n                />\n              ))}\n            </div>\n          ))}\n      </form>\n    </div>\n  );\n}\n\nexport default PeaksWrapper(forwardRef(PeaksPreferences));\n","import { useCallback, useMemo, memo, useEffect, useRef } from 'react';\nimport { FaRegTrashAlt } from 'react-icons/fa';\n\nimport { useDispatch } from '../../context/DispatchContext';\nimport EditableColumn from '../../elements/EditableColumn';\nimport ReactTable from '../../elements/ReactTable/ReactTable';\nimport PeaksWrapper from '../../hoc/PeaksWrapper';\nimport {\n  DELETE_PEAK_NOTATION,\n  SHIFT_SPECTRUM,\n} from '../../reducer/types/Types';\nimport formatNumber, {\n  useFormatNumberByNucleus,\n} from '../../utility/FormatNumber';\nimport { getValue } from '../../utility/LocalStorage';\nimport NoTableData from '../extra/placeholder/NoTableData';\nimport { peaksDefaultValues } from '../extra/preferences/defaultValues';\n\nfunction PeaksTable({\n  peaks,\n  info,\n  xDomain,\n  activeTab,\n  enableFilter,\n  onFilter,\n  preferences,\n}) {\n  const dispatch = useDispatch();\n  const deltaPPMRefs = useRef([]);\n  const format = useFormatNumberByNucleus(info.nucleus);\n  const deletePeakHandler = useCallback(\n    (e, row) => {\n      e.preventDefault();\n      e.stopPropagation();\n      const params = row.original;\n      dispatch({\n        type: DELETE_PEAK_NOTATION,\n        data: { id: params.id, xIndex: params.xIndex },\n      });\n    },\n    [dispatch],\n  );\n\n  const initialColumns = useMemo(\n    () => [\n      {\n        index: 20,\n        Header: '',\n        width: '1%',\n        maxWidth: '24px',\n        minWidth: '24px',\n        id: 'delete-button',\n        Cell: ({ row }) => (\n          <button\n            type=\"button\"\n            className=\"delete-button\"\n            onClick={(e) => deletePeakHandler(e, row)}\n          >\n            <FaRegTrashAlt />\n          </button>\n        ),\n      },\n    ],\n    [deletePeakHandler],\n  );\n\n  const editStartHander = useCallback((index) => {\n    deltaPPMRefs.current.forEach((ref, i) => {\n      if (index !== i && ref) {\n        ref.closeEdit();\n      }\n    });\n  }, []);\n\n  const saveDeltaPPMRefsHandler = useCallback(\n    (event, row) => {\n      const shiftValue = parseFloat(event.target.value) - parseFloat(row.value);\n      dispatch({ type: SHIFT_SPECTRUM, shiftValue });\n    },\n    [dispatch],\n  );\n\n  const tableColumns = useMemo(() => {\n    const setCustomColumn = (\n      array,\n      index,\n      columnLabel,\n      cellHandler,\n      extraParams,\n    ) => {\n      array.push({\n        ...extraParams,\n        index: index,\n        Header: columnLabel,\n        sortType: 'basic',\n        Cell: ({ row }) => cellHandler(row),\n      });\n    };\n\n    const peaksPreferences = getValue(\n      preferences,\n      `formatting.panels.peaks.[${activeTab}]`,\n      peaksDefaultValues,\n    );\n\n    let cols = [...initialColumns];\n    if (peaksPreferences.showPeakNumber) {\n      setCustomColumn(\n        cols,\n        1,\n        '#',\n        (row) => formatNumber(row.index + 1, peaksPreferences.peakNumberFormat),\n        { width: '1%', maxWidth: '40px', minWidth: '40px' },\n      );\n    }\n    if (peaksPreferences.showPeakIndex) {\n      setCustomColumn(cols, 2, 'index', (row) =>\n        formatNumber(row.original.xIndex, peaksPreferences.peakIndexFormat),\n      );\n    }\n    if (peaksPreferences.showDeltaPPM) {\n      setCustomColumn(cols, 3, ' (ppm)', (row) => (\n        <EditableColumn\n          onEditStart={() => editStartHander(row.index)}\n          ref={(ref) => (deltaPPMRefs.current[row.index] = ref)}\n          value={formatNumber(\n            row.original.value,\n            peaksPreferences.deltaPPMFormat,\n          )}\n          onSave={(event) => saveDeltaPPMRefsHandler(event, row.original)}\n          type=\"number\"\n        />\n      ));\n    }\n    if (peaksPreferences.showDeltaHz) {\n      setCustomColumn(cols, 4, ' (Hz)', (row) =>\n        formatNumber(row.original.valueHz, peaksPreferences.deltaHzFormat),\n      );\n    }\n    if (peaksPreferences.showIntensity) {\n      setCustomColumn(cols, 5, 'Intensity', (row) =>\n        formatNumber(row.original.intensity, peaksPreferences.intensityFormat),\n      );\n    }\n    if (peaksPreferences.showPeakWidth) {\n      setCustomColumn(cols, 5, 'Peak Width', (row) =>\n        formatNumber(row.original.peakWidth, peaksPreferences.peakWidthFormat),\n      );\n    }\n    return cols.sort((object1, object2) => object1.index - object2.index);\n  }, [\n    activeTab,\n    editStartHander,\n    initialColumns,\n    preferences,\n    saveDeltaPPMRefsHandler,\n  ]);\n\n  const _data = useMemo(() => {\n    function isInRange(value) {\n      const factor = 100000;\n      return (\n        value * factor >= xDomain[0] * factor &&\n        value * factor <= xDomain[1] * factor\n      );\n    }\n    if (peaks && peaks.values) {\n      const _peaks = enableFilter\n        ? peaks.values.filter((peak) => isInRange(peak.delta))\n        : peaks.values;\n\n      return _peaks.map((peak) => {\n        const value = format(peak.delta);\n        return {\n          value: value,\n          valueHz:\n            info && info.originFrequency ? value * info.originFrequency : '',\n          id: peak.id,\n          intensity: peak.intensity,\n          peakWidth: peak.width ? peak.width : '',\n          isConstantlyHighlighted: isInRange(value),\n        };\n      });\n    }\n\n    return [];\n  }, [enableFilter, format, info, peaks, xDomain]);\n\n  useEffect(() => {\n    onFilter(_data.length);\n  }, [_data, onFilter]);\n\n  return _data && _data.length > 0 ? (\n    <ReactTable data={_data} columns={tableColumns} />\n  ) : (\n    <NoTableData />\n  );\n}\n\nexport default PeaksWrapper(memo(PeaksTable));\n","import { useCallback, useState, useRef, memo } from 'react';\nimport ReactCardFlip from 'react-card-flip';\n\nimport { useDispatch } from '../../context/DispatchContext';\nimport { useModal } from '../../elements/popup/Modal';\nimport { DELETE_PEAK_NOTATION } from '../../reducer/types/Types';\nimport DefaultPanelHeader from '../header/DefaultPanelHeader';\nimport PreferencesHeader from '../header/PreferencesHeader';\n\nimport PeaksPreferences from './PeaksPreferences';\nimport PeaksTable from './PeaksTable';\n\nconst styles = {\n  container: {\n    display: 'flex',\n    flexDirection: 'column',\n    height: '100%',\n  },\n};\n\nfunction PeaksPanel() {\n  const [filterIsActive, setFilterIsActive] = useState(false);\n  const [peaksCounter, setPeaksCounter] = useState(0);\n\n  const dispatch = useDispatch();\n  const modal = useModal();\n  const [isFlipped, setFlipStatus] = useState(false);\n  const settingRef = useRef();\n  const yesHandler = useCallback(() => {\n    dispatch({ type: DELETE_PEAK_NOTATION, data: null });\n  }, [dispatch]);\n\n  const handleDeleteAll = useCallback(() => {\n    modal.showConfirmDialog('All records will be deleted, Are You sure?', {\n      onYes: yesHandler,\n    });\n  }, [modal, yesHandler]);\n\n  const settingsPanelHandler = useCallback(() => {\n    setFlipStatus(!isFlipped);\n  }, [isFlipped]);\n\n  const saveSettingHandler = useCallback(() => {\n    settingRef.current.saveSetting();\n    setFlipStatus(false);\n  }, []);\n\n  const handleOnFilter = useCallback(() => {\n    setFilterIsActive(!filterIsActive);\n  }, [filterIsActive]);\n  const changedHandler = useCallback((val) => {\n    setPeaksCounter(val);\n  }, []);\n\n  return (\n    <div style={styles.container}>\n      {!isFlipped && (\n        <DefaultPanelHeader\n          counter={peaksCounter}\n          onDelete={handleDeleteAll}\n          deleteToolTip=\"Delete All Peaks\"\n          onFilter={handleOnFilter}\n          filterToolTip={\n            filterIsActive ? 'Show all peaks' : 'Hide peaks out of view'\n          }\n          filterIsActive={filterIsActive}\n          counterFiltered={peaksCounter}\n          showSettingButton=\"true\"\n          onSettingClick={settingsPanelHandler}\n        />\n      )}\n      {isFlipped && (\n        <PreferencesHeader\n          onSave={saveSettingHandler}\n          onClose={settingsPanelHandler}\n        />\n      )}\n      <div style={{ height: '100%', overflow: 'auto' }}>\n        <ReactCardFlip\n          isFlipped={isFlipped}\n          infinite\n          containerStyle={{ overflow: 'hidden' }}\n        >\n          <PeaksTable enableFilter={filterIsActive} onFilter={changedHandler} />\n          <PeaksPreferences ref={settingRef} />\n        </ReactCardFlip>\n      </div>\n    </div>\n  );\n}\n\nexport default memo(PeaksPanel);\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { FaCopy } from 'react-icons/fa';\n\nimport CloseButton from '../elements/CloseButton';\n\nconst styles = css`\n  overflow: auto;\n  width: 400px;\n  .innerContainer {\n    padding: 5px;\n    width: 100%;\n    height: 180px;\n    border: none;\n  }\n\n  .mainButtonsContainer {\n    padding: 5px 0px;\n    border-bottom: 0.55px solid #ebebeb;\n    display: flex;\n    justify-content: space-between;\n  }\n\n  button {\n    background-color: transparent;\n    border: none;\n    padding: 0 5px;\n  }\n\n  button:disabled {\n    opacity: 0.6;\n  }\n`;\n\nfunction CopyClipboardModal({ text, onClose, onCopyClick }) {\n  return (\n    <div css={styles}>\n      <div className=\"mainButtonsContainer handle\">\n        <button type=\"button\" onClick={() => onCopyClick(text)}>\n          <FaCopy />\n        </button>\n\n        <CloseButton onClick={onClose} />\n      </div>\n      <div\n        className=\"innerContainer\"\n        // eslint-disable-next-line react/no-danger\n        dangerouslySetInnerHTML={{ __html: text }}\n      />\n    </div>\n  );\n}\n\nexport default CopyClipboardModal;\n","import { SvgNmrSum } from 'cheminfo-font';\nimport lodashGet from 'lodash/get';\nimport { rangesToACS } from 'nmr-processing';\nimport { useCallback, useState } from 'react';\nimport { FaFileExport, FaUnlink, FaSitemap } from 'react-icons/fa';\n\nimport { useAssignmentData } from '../../assignment';\nimport { useDispatch } from '../../context/DispatchContext';\nimport { usePreferences } from '../../context/PreferencesContext';\nimport ToggleButton from '../../elements/ToggleButton';\nimport ToolTip from '../../elements/ToolTip/ToolTip';\nimport { useAlert } from '../../elements/popup/Alert';\nimport { useModal } from '../../elements/popup/Modal';\nimport CopyClipboardModal from '../../modal/CopyClipboardModal';\nimport ChangeSumModal from '../../modal/changeSum/ChangeSumModal';\nimport { CHANGE_RANGE_SUM, DELETE_RANGE } from '../../reducer/types/Types';\nimport Events from '../../utility/Events';\nimport { copyHTMLToClipboard } from '../../utility/Export';\nimport { getNumberOfDecimals } from '../../utility/FormatNumber';\nimport DefaultPanelHeader from '../header/DefaultPanelHeader';\n\nconst styles = {\n  toolbar: {\n    display: 'flex',\n    flexDirection: 'row',\n    borderBottom: '0.55px solid rgb(240, 240, 240)',\n  },\n  center: {\n    display: 'flex',\n    justifyContent: 'center',\n    alignItems: 'center',\n    padding: '5px',\n  },\n  removeAssignmentsButton: {\n    border: 'none',\n    height: '16px',\n    // width: '18px',\n    fontSize: '12px',\n    backgroundColor: 'transparent',\n  },\n  button: {\n    backgroundColor: 'transparent',\n    border: 'none',\n  },\n};\n\nfunction RangesHeader({\n  ranges,\n  info,\n  activeTab,\n  molecules,\n  onUnlink,\n  onFilterActivated,\n  onSettingClick,\n  isFilterActive,\n  filterCounter,\n}) {\n  const dispatch = useDispatch();\n  const modal = useModal();\n  const alert = useAlert();\n  const preferences = usePreferences();\n  const assignmentData = useAssignmentData();\n  const [isMultiplicityTreesVisible, showMultiplicityTrees] = useState(false);\n\n  const currentSum = lodashGet(ranges, 'options.sum', null);\n\n  const changeRangesSumHandler = useCallback(\n    (value) => {\n      if (value !== undefined) {\n        dispatch({ type: CHANGE_RANGE_SUM, value });\n      }\n\n      modal.close();\n    },\n    [dispatch, modal],\n  );\n\n  const showChangeRangesSumModal = useCallback(() => {\n    modal.show(\n      <ChangeSumModal\n        onClose={() => modal.close()}\n        onSave={changeRangesSumHandler}\n        header={\n          currentSum\n            ? `Set new Ranges Sum (Current: ${Number(currentSum).toFixed(2)})`\n            : 'Set new Ranges Sum'\n        }\n        molecules={molecules}\n        element={activeTab ? activeTab.replace(/[0-9]/g, '') : null}\n      />,\n    );\n  }, [activeTab, changeRangesSumHandler, currentSum, modal, molecules]);\n\n  const removeAssignments = useCallback(() => {\n    for (const range of ranges.values) {\n      onUnlink(range);\n    }\n  }, [ranges, onUnlink]);\n\n  const handleOnRemoveAssignments = useCallback(() => {\n    modal.showConfirmDialog('All assignments will be removed. Are you sure?', {\n      onYes: removeAssignments,\n    });\n  }, [removeAssignments, modal]);\n\n  const handleDeleteAll = useCallback(() => {\n    modal.showConfirmDialog('All ranges will be deleted. Are You sure?', {\n      onYes: () => {\n        dispatch({ type: DELETE_RANGE, payload: { assignmentData } });\n      },\n    });\n  }, [assignmentData, dispatch, modal]);\n\n  const handleSetShowMultiplicityTrees = useCallback((flag) => {\n    Events.emit('showMultiplicityTrees', flag);\n    showMultiplicityTrees(flag);\n  }, []);\n\n  const saveToClipboardHandler = useCallback(\n    (value) => {\n      const success = copyHTMLToClipboard(value);\n      if (success) {\n        alert.success('Data copied to clipboard');\n      } else {\n        alert.error('copy to clipboard failed');\n      }\n    },\n    [alert],\n  );\n\n  const saveAsHTMLHandler = useCallback(() => {\n    const { originFrequency: observedFrequency, nucleus } = info;\n    const format = lodashGet(\n      preferences,\n      `formatting.nucleusByKey[${nucleus.toLowerCase()}]`,\n    );\n    const nbDecimalDelta = getNumberOfDecimals(format.ppm);\n    const nbDecimalJ = getNumberOfDecimals(format.hz);\n\n    const result = rangesToACS(ranges.values, {\n      nucleus, // '19f'\n      nbDecimalDelta, // 2\n      nbDecimalJ, // 1\n      observedFrequency, //400\n    });\n    modal.show(\n      <CopyClipboardModal\n        text={result}\n        onCopyClick={saveToClipboardHandler}\n        onClose={() => modal.close()}\n      />,\n      {},\n    );\n  }, [info, modal, preferences, ranges.values, saveToClipboardHandler]);\n\n  return (\n    <DefaultPanelHeader\n      counter={ranges && ranges.values && ranges.values.length}\n      onDelete={handleDeleteAll}\n      deleteToolTip=\"Delete All Ranges\"\n      onFilter={onFilterActivated}\n      filterToolTip={\n        isFilterActive ? 'Show all ranges' : 'Hide ranges out of view'\n      }\n      filterIsActive={isFilterActive}\n      counterFiltered={filterCounter}\n      showSettingButton=\"true\"\n      onSettingClick={onSettingClick}\n    >\n      <ToolTip title=\"Preview publication string\" popupPlacement=\"right\">\n        <button style={styles.button} type=\"button\" onClick={saveAsHTMLHandler}>\n          <FaFileExport />\n        </button>\n      </ToolTip>\n      <ToolTip\n        title={\n          currentSum\n            ? `Change Ranges Sum (${Number(currentSum).toFixed(2)})`\n            : 'Change Ranges Sum'\n        }\n        popupPlacement=\"right\"\n      >\n        <button\n          css={styles.button}\n          type=\"button\"\n          onClick={showChangeRangesSumModal}\n        >\n          <SvgNmrSum />\n        </button>\n      </ToolTip>\n      <ToolTip title={`Remove all Assignments`} popupPlacement=\"right\">\n        <button\n          style={{ ...styles.center, ...styles.removeAssignmentsButton }}\n          type=\"button\"\n          onClick={handleOnRemoveAssignments}\n          disabled={!ranges || !ranges.values || ranges.values.length === 0}\n        >\n          <FaUnlink />\n        </button>\n      </ToolTip>\n\n      <ToggleButton\n        popupTitle={\n          isMultiplicityTreesVisible\n            ? 'Hide Multiplicity Trees in Spectrum'\n            : 'Show Multiplicity Trees in Spectrum'\n        }\n        popupPlacement=\"right\"\n        onClick={handleSetShowMultiplicityTrees}\n        disabled={!ranges || !ranges.values || ranges.values.length === 0}\n      >\n        <FaSitemap style={{ pointerEvents: 'none', fontSize: '12px' }} />\n      </ToggleButton>\n    </DefaultPanelHeader>\n  );\n}\n\nexport default RangesHeader;\n","import lodashGet from 'lodash/get';\nimport lodashSet from 'lodash/set';\nimport {\n  useEffect,\n  useState,\n  useCallback,\n  forwardRef,\n  useImperativeHandle,\n  useRef,\n  memo,\n} from 'react';\n\nimport IsotopesViewer from '../../elements/IsotopesViewer';\nimport { useAlert } from '../../elements/popup/Alert';\nimport { SET_PANELS_PREFERENCES } from '../../reducer/preferencesReducer';\nimport {\n  useStateWithLocalStorage,\n  getValue as getValueByKeyPath,\n} from '../../utility/LocalStorage';\nimport ColumnFormatField from '../extra/preferences/ColumnFormatField';\nimport { rangeDefaultValues } from '../extra/preferences/defaultValues';\n\nconst styles = {\n  container: {\n    padding: 10,\n    backgroundColor: '#f1f1f1',\n    height: '100%',\n    flex: 1,\n  },\n  groupContainer: {\n    padding: '5px',\n    borderRadius: '5px',\n    margin: '10px 0px',\n    backgroundColor: 'white',\n  },\n  row: {\n    display: 'flex',\n    margin: '5px 0px',\n  },\n  header: {\n    borderBottom: '1px solid #e8e8e8',\n    paddingBottom: '5px',\n    fontWeight: 'bold',\n    color: '#4a4a4a',\n  },\n  inputLabel: {\n    flex: 2,\n    fontSize: '11px',\n    fontWeight: 'bold',\n    color: '#232323',\n  },\n  input: {\n    width: '30%',\n    textAlign: 'center',\n  },\n};\n\nfunction RangesPreferences({ nucleus, preferences }, ref) {\n  const alert = useAlert();\n  const [, setSettingsData] = useStateWithLocalStorage('nmr-general-settings');\n  const [settings, setSetting] = useState(null);\n  const formRef = useRef();\n\n  useEffect(() => {\n    const integralsPreferences = getValueByKeyPath(\n      preferences,\n      'formatting.panels.ranges',\n    );\n    if (integralsPreferences) {\n      setSetting(integralsPreferences);\n    }\n  }, [preferences]);\n\n  const saveToLocalStorgate = (values) => {\n    setSettingsData(values, 'formatting.panels.ranges');\n  };\n\n  const saveHandler = useCallback(\n    (values, showMessage = false) => {\n      preferences.dispatch({\n        type: SET_PANELS_PREFERENCES,\n        payload: { key: 'ranges', value: values },\n      });\n      if (showMessage) {\n        alert.success('ranges preferences saved successfully');\n      }\n    },\n    [alert, preferences],\n  );\n\n  useImperativeHandle(ref, () => ({\n    saveSetting() {\n      if (typeof formRef.current.requestSubmit === 'function') {\n        formRef.current.requestSubmit();\n      } else {\n        formRef.current.dispatchEvent(\n          new Event('submit', { cancelable: true }),\n        );\n      }\n    },\n  }));\n\n  const formatFields = [\n    {\n      id: 1,\n      label: 'From :',\n      checkController: 'showFrom',\n      formatController: 'fromFormat',\n      defaultFormat: '0.00',\n    },\n    {\n      id: 2,\n      label: 'To :',\n      checkController: 'showTo',\n      formatController: 'toFormat',\n      defaultFormat: '0.00',\n    },\n    {\n      id: 3,\n      label: 'Absolute :',\n      checkController: 'showAbsolute',\n      formatController: 'absoluteFormat',\n      defaultFormat: '0.00',\n    },\n    {\n      id: 4,\n      label: 'Relative :',\n      checkController: 'showRelative',\n      formatController: 'relativeFormat',\n      defaultFormat: '00.00',\n    },\n  ];\n\n  const handleSubmit = async (event) => {\n    event.preventDefault();\n    const form = event.target;\n    const formData = new FormData(form);\n    let values = {};\n    for (const field of formData.entries()) {\n      const keys = field[0].split('-').join('.');\n      const val = ['true', 'false'].includes(field[1])\n        ? field[1] === 'true'\n        : field[1];\n      values = lodashSet(values, keys, val);\n    }\n\n    saveHandler(values, true);\n    saveToLocalStorgate(values);\n  };\n\n  const getValue = useCallback(\n    (...params) => {\n      const keys = params.join('.');\n      if (settings) {\n        const value = lodashGet(settings, keys);\n        return value ? value : null;\n      } else {\n        const keyIndex = params.length - 1;\n        return rangeDefaultValues[params[keyIndex]];\n      }\n    },\n    [settings],\n  );\n\n  return (\n    <div style={styles.container}>\n      <form onSubmit={handleSubmit} ref={formRef}>\n        {nucleus &&\n          nucleus.map((nucleusLabel) => (\n            <div key={nucleusLabel} style={styles.groupContainer}>\n              <IsotopesViewer style={styles.header} value={nucleusLabel} />\n              {formatFields.map((field) => (\n                <ColumnFormatField\n                  key={field.id}\n                  label={field.label}\n                  checked={getValue(nucleusLabel, field.checkController)}\n                  format={getValue(nucleusLabel, field.formatController)}\n                  checkControllerName={field.checkController}\n                  formatControllerName={field.formatController}\n                  groupID={nucleusLabel}\n                />\n              ))}\n            </div>\n          ))}\n      </form>\n    </div>\n  );\n}\n\nexport default memo(forwardRef(RangesPreferences));\n","import { useCallback, useEffect, useState } from 'react';\n\n/**\n *\n * @param {string} key\n * @param {Array} data\n */\n\nlet oldId = null;\n\nfunction useToggleStatus(key, data) {\n  const [status, setStatus] = useState({});\n\n  useEffect(() => {\n    let statusflags = {};\n    if (data && Array.isArray(data)) {\n      for (let i = 0; i < data.length; i++) {\n        statusflags[data[i][key]] = false;\n      }\n      setStatus(statusflags);\n    }\n  }, [data, key]);\n\n  const toggle = useCallback(\n    (id) => {\n      const newStatus = { ...status };\n      if (oldId) {\n        newStatus[oldId] = false;\n      }\n      if (id != null) {\n        oldId = id;\n        newStatus[id] = true;\n      }\n      setStatus(newStatus);\n    },\n    [status],\n  );\n\n  return [status, toggle];\n}\n\nexport default useToggleStatus;\n","import lodash from 'lodash';\n\nimport FormatNumber from '../../../utility/FormatNumber';\n\nexport default class ColumnsHelper {\n  constructor(preferences, defaultPreference) {\n    this.preferences = preferences;\n    this.defaultPreference = defaultPreference;\n  }\n\n  checkPreferences(preferencesToCheck, key) {\n    const val =\n      preferencesToCheck === undefined ||\n      Object.keys(preferencesToCheck).length === 0 ||\n      (preferencesToCheck && preferencesToCheck[key] === true)\n        ? true\n        : false;\n    return val;\n  }\n\n  setCustomColumn(array, index, columnLabel, cellHandler) {\n    array.push({\n      orderIndex: index,\n      Header: columnLabel,\n      sortType: 'basic',\n      Cell: ({ row }) => cellHandler(row),\n    });\n  }\n  /**\n   * @callback hasPrefix\n   * @param {...any}\n   * @returns {boolean}\n   */\n\n  /**\n   *\n   * @param {string} columns\n   * @param {string} flagKey\n   * @param {string} formatKey\n   * @param {string} columnKey\n   * @param {string} columnLabel\n   * @param {string} columnIndex\n   * @param {Object=} [option = {}]\n   * @param {string} [option.formatPrefix = '']\n   * @param {string} [option.formatSuffix = '']\n   * @param {hasPrefix}   [option.showPrefixSuffixCallback = ()=>true]\n   */\n  addColumn(\n    columns,\n    flagKey,\n    formatKey,\n    columnKey,\n    columnLabel,\n    columnIndex,\n    options = {},\n  ) {\n    const preferences = this.preferences || this.defaultPreference;\n\n    if (this.checkPreferences(preferences, flagKey)) {\n      this.setCustomColumn(columns, columnIndex, columnLabel, (row) => {\n        const format =\n          preferences &&\n          Object.prototype.hasOwnProperty.call(preferences, formatKey)\n            ? preferences[formatKey]\n            : this.defaultPreference[formatKey];\n\n        const {\n          formatPrefix = '',\n          formatSuffix = '',\n          showPrefixSuffixCallback = () => true,\n        } = options;\n\n        if (showPrefixSuffixCallback(row)) {\n          return FormatNumber(\n            row.original[columnKey],\n            format,\n            formatPrefix,\n            formatSuffix,\n          );\n        } else {\n          return FormatNumber(row.original[columnKey], format, '', '');\n        }\n      });\n    }\n  }\n}\n\nexport function isColumnVisible(preferences, key) {\n  return lodash.get(preferences, key, false);\n}\n","import FormatNumber from '../../../utility/FormatNumber';\n\nfunction AbsoluteColumn({ rowSpanTags, value, onHoverRange, format }) {\n  return (\n    <td {...rowSpanTags} {...onHoverRange}>\n      {FormatNumber(value, format)}\n    </td>\n  );\n}\n\nexport default AbsoluteColumn;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport PropTypes from 'prop-types';\nimport { useCallback } from 'react';\n\nconst arrowDownIcon = `url('data:image/svg+xml;utf8,<svg  xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\" width=\"960px\" height=\"560px\" viewBox=\"0 0 960 560\" enable-background=\"new 0 0 960 560\" xml:space=\"preserve\"><g id=\"Rounded_Rectangle_33_copy_4_1_\"><path d=\"M480,344.181L268.869,131.889c-15.756-15.859-41.3-15.859-57.054,0c-15.754,15.857-15.754,41.57,0,57.431l237.632,238.937c8.395,8.451,19.562,12.254,30.553,11.698c10.993,0.556,22.159-3.247,30.555-11.698l237.631-238.937c15.756-15.86,15.756-41.571,0-57.431s-41.299-15.859-57.051,0L480,344.181z\"/></g></svg>')`;\n\nfunction SelectUncontrolled({ data, style, onChange, value }) {\n  const handleOnChanged = useCallback(\n    (e) => {\n      onChange(e.target.value);\n    },\n    [onChange],\n  );\n\n  const styles = css`\n    position: relative;\n    padding: 0px 5px;\n    border: 0.55px solid #cacaca;\n    font-size: 14px;\n    width: ${style.width ? style.width - 5 : 95}px;\n    margin: 0;\n    height: 100%;\n    background: ${arrowDownIcon} no-repeat right white;\n    -webkit-appearance: none;\n    background-position-x: ${style.width ? style.width - 18 : 95 - 18}px;\n    background-size: 15px 15px;\n    border-radius: 5px;\n    margin: 0px 5px;\n    :focus,\n    input:focus {\n      outline: none;\n    }\n  `;\n\n  return (\n    <select css={[styles, style]} onChange={handleOnChanged} value={value}>\n      {data.map((d) => (\n        <option\n          key={`${d.key}`}\n          value={d.value}\n          // selected={d.value === defaultValue ? 'selected' : ''}\n        >\n          {d.label}\n        </option>\n      ))}\n    </select>\n  );\n}\n\nSelectUncontrolled.propTypes = {\n  onChange: PropTypes.func,\n  data: PropTypes.array.isRequired,\n  style: PropTypes.any,\n  value: PropTypes.any,\n};\n\nSelectUncontrolled.defaultProps = {\n  onChange: function () {\n    return null;\n  },\n};\n\nexport default SelectUncontrolled;\n","/** @jsxImportSource @emotion/react */\nimport { Fragment } from 'react';\n\nfunction Button({ onClick, ...props }) {\n  return (\n    <Fragment>\n      <button type=\"button\" onClick={onClick} {...props} />\n    </Fragment>\n  );\n}\n\nexport default Button;\n","/** @jsxImportSource @emotion/react */\nimport { useField } from 'formik';\n\nfunction ErrorMessage({ style, ...props }) {\n  const meta = useField(props)[1];\n\n  return (\n    <div>\n      {meta.error ? (\n        <p style={{ color: 'red', margin: '0.5px', ...style }}>{meta.error}</p>\n      ) : null}\n    </div>\n  );\n}\n\nexport default ErrorMessage;\n","import { useField } from 'formik';\n\nimport ErrorMessage from './ErrorMessage';\n\nfunction Input({ onFocus, onBlur, enableErrorMessage, ...props }) {\n  const [field] = useField(props);\n  return (\n    <div>\n      <input\n        {...field}\n        {...props}\n        onFocus={() => onFocus(field.name)}\n        onBlur={() => onBlur(field.name)}\n      />\n      {enableErrorMessage && enableErrorMessage === true ? (\n        <ErrorMessage {...props} />\n      ) : null}\n    </div>\n  );\n}\n\nInput.defaultProps = {\n  onFocus: () => null,\n  onBlur: () => null,\n};\n\nexport default Input;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useFormikContext } from 'formik';\nimport { memo, useState, useCallback, useEffect } from 'react';\nimport { FaPlus } from 'react-icons/fa';\n\nimport Button from '../../../../elements/Button';\nimport Input from '../../../../elements/formik/Input';\nimport { translateMultiplet } from '../../../../panels/extra/utilities/MultiplicityUtilities';\n\nconst AddSignalFormTabStyle = css`\n  text-align: center;\n  width: 100%;\n  height: 100%;\n\n  .infoText {\n    margin-top: 20px;\n    font-size: 12px;\n  }\n\n  input {\n    background-color: transparent;\n    border: 0.5px solid #dedede;\n    width: 50%;\n    text-align: center;\n  }\n\n  .addSignalButton {\n    margin-top: 15px;\n    margin-top: 20px;\n    background-color: transparent;\n    border: none;\n    padding: 0.3rem;\n    border-radius: 25%;\n  }\n`;\n\nfunction AddSignalFormTab({ onFocus, onBlur }) {\n  const { values, setFieldValue, errors } = useFormikContext();\n\n  const [disableAddButton, setDisableAddButton] = useState(false);\n\n  const onAddSignal = useCallback(() => {\n    const newSignal = {\n      multiplicity: 'm',\n      kind: 'signal',\n      delta: Number(values.newSignalDelta),\n      j: [{ multiplicity: translateMultiplet('m'), coupling: '' }],\n    };\n    const _signals = values.signals.slice().concat(newSignal);\n\n    setFieldValue('signals', _signals);\n    setFieldValue('activeTab', String(_signals.length - 1));\n  }, [setFieldValue, values.newSignalDelta, values.signals]);\n\n  useEffect(() => {\n    if (errors.newSignalDelta) {\n      setDisableAddButton(true);\n    } else {\n      setDisableAddButton(false);\n    }\n  }, [errors.newSignalDelta, values.signals]);\n\n  return (\n    <div css={AddSignalFormTabStyle}>\n      <div>\n        <p className=\"infoText\">\n          Edit or select a delta value of new signal (ppm):\n        </p>\n        <Input\n          name=\"newSignalDelta\"\n          type=\"number\"\n          placeholder={`${'\\u0394'} (ppm)`}\n          onFocus={onFocus}\n          onBlur={onBlur}\n        />\n      </div>\n\n      <div>\n        <Button\n          className=\"addSignalButton\"\n          onClick={onAddSignal}\n          disabled={disableAddButton}\n          css={{\n            color: disableAddButton ? 'grey' : 'blue',\n            width: '100%',\n          }}\n        >\n          <FaPlus title=\"Add new signal\" />\n        </Button>\n      </div>\n    </div>\n  );\n}\n\nexport default memo(AddSignalFormTab);\n","/** @jsxImportSource @emotion/react */\nimport { Field, useField } from 'formik';\nimport PropTypes from 'prop-types';\n\nimport ErrorMessage from './ErrorMessage';\n\nfunction SelectBox({ values, ...props }) {\n  const [field] = useField(props);\n\n  return values && values.length > 0 ? (\n    <div>\n      <Field as=\"select\" {...field} {...props}>\n        {values.map((value, i) => {\n          return (\n            <option\n              // eslint-disable-next-line react/no-array-index-key\n              key={i}\n            >\n              {value}\n            </option>\n          );\n        })}\n      </Field>\n      <ErrorMessage {...props} />\n    </div>\n  ) : null;\n}\n\nSelectBox.protoTypes = {\n  valuePath: PropTypes.instanceOf(Array).isRequired,\n  valueSelectionTemplate: PropTypes.func,\n};\n\nexport default SelectBox;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useFormikContext } from 'formik';\nimport lodashGet from 'lodash/get';\nimport { memo, useEffect, useCallback } from 'react';\nimport { FaMinus, FaPlus } from 'react-icons/fa';\n\nimport { Multiplets } from '../../../../../data/constants/Multiplets';\nimport Button from '../../../../elements/Button';\nimport Input from '../../../../elements/formik/Input';\nimport SelectBox from '../../../../elements/formik/SelectBox';\nimport {\n  hasCouplingConstant,\n  translateMultiplet,\n} from '../../../../panels/extra/utilities/MultiplicityUtilities';\n\nconst CouplingsTableStyle = css`\n  border-spacing: 0;\n  border: 1px solid #dedede;\n  width: 100%;\n  height: 100%;\n  font-size: 12px;\n\n  th,\n  td {\n    text-align: center;\n    margin: 0;\n    padding: 0.4rem;\n    border-bottom: 1px solid #dedede;\n    border-right: 1px solid #dedede;\n\n    button {\n      background-color: transparent;\n      border: none;\n    }\n\n    .add-button {\n      color: blue;\n    }\n\n    .delete-button {\n      border-radius: 25%;\n      padding: 0;\n      padding-left: 0.3rem;\n      padding-right: 0.3rem;\n    }\n    .delete-button:hover {\n      background-color: red;\n      .icon {\n        color: white;\n      }\n    }\n\n    input {\n      background-color: transparent;\n      border: 0.5px solid #dedede;\n      height: 100%;\n      width: 100%;\n      text-align: center;\n    }\n    .selectBox {\n      background-color: transparent;\n      border: 0.5px solid #dedede;\n      height: 100%;\n      width: 100%;\n      text-align: center;\n    }\n  }\n\n  tr {\n    :last-child {\n      border-top: 3px solid #dedede;\n    }\n  }\n`;\n\nconst errorStyle = {\n  border: '1px solid red',\n};\n\nfunction CouplingsTable({ push, remove, onFocus, onBlur }) {\n  const { values, setFieldValue, errors } = useFormikContext();\n\n  useEffect(() => {\n    if (values.signals[values.activeTab]) {\n      values.signals[values.activeTab].j.forEach((_coupling, i) => {\n        if (!hasCouplingConstant(_coupling.multiplicity)) {\n          setFieldValue(`signals.${values.activeTab}.j.${i}.coupling`, '');\n        }\n      });\n    }\n  }, [setFieldValue, values.activeTab, values.signals]);\n\n  const hasMissingCouplingValue = useCallback(\n    (i) =>\n      lodashGet(\n        errors,\n        `signals[${values.activeTab}].missingCouplings`,\n        [],\n      ).some((_error) => _error.index === i),\n    [errors, values.activeTab],\n  );\n\n  return (\n    <table css={CouplingsTableStyle}>\n      <tbody>\n        <tr>\n          <th>#</th>\n          <th>Multiplicity</th>\n          <th>J (Hz)</th>\n          <th>{''}</th>\n        </tr>\n        {lodashGet(values, `signals[${values.activeTab}].j`, []).map(\n          (_coupling, i) => (\n            <tr\n              // eslint-disable-next-line react/no-array-index-key\n              key={`editCouplings${values.activeTab}${i}`}\n            >\n              <td>{i + 1}</td>\n              <td>\n                <SelectBox\n                  className=\"selectBox\"\n                  name={`signals.${values.activeTab}.j.${i}.multiplicity`}\n                  values={Multiplets.map((_multiplet) => _multiplet.label)}\n                />\n              </td>\n              <td>\n                <Input\n                  name={`signals.${values.activeTab}.j.${i}.coupling`}\n                  type=\"number\"\n                  placeholder={'J (Hz)'}\n                  disabled={!hasCouplingConstant(_coupling.multiplicity)}\n                  onFocus={onFocus}\n                  onBlur={onBlur}\n                  style={hasMissingCouplingValue(i) ? errorStyle : null}\n                />\n              </td>\n              <td>\n                <Button\n                  className=\"delete-button\"\n                  onClick={() => {\n                    remove(i);\n                  }}\n                >\n                  <FaMinus className=\"icon\" title=\"Delete coupling\" />\n                </Button>\n              </td>\n            </tr>\n          ),\n        )}\n        <tr />\n        <tr>\n          <td colSpan={4}>\n            <Button\n              className=\"add-button\"\n              onClick={() =>\n                push({\n                  multiplicity: translateMultiplet('m'),\n                  coupling: '',\n                })\n              }\n            >\n              <FaPlus title=\"Add new coupling\" />\n            </Button>\n          </td>\n        </tr>\n      </tbody>\n    </table>\n  );\n}\n\nexport default memo(CouplingsTable);\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useFormikContext, FieldArray } from 'formik';\nimport { memo } from 'react';\n\nimport CouplingsTable from './CouplingsTable';\n\nconst SignalFormTabStyle = css`\n  border-spacing: 0;\n  border: 1px solid #dedede;\n  width: 100%;\n  font-size: 12px;\n  height: 100%;\n\n  margin: 0;\n  padding: 0.4rem;\n  text-align: center;\n`;\n\nfunction SignalFormTab({ onFocus, onBlur }) {\n  const { values } = useFormikContext();\n\n  return (\n    <div css={SignalFormTabStyle}>\n      <FieldArray\n        name={`signals.${values.activeTab}.j`}\n        render={({ push, remove }) => (\n          <div>\n            <CouplingsTable\n              push={push}\n              remove={remove}\n              onFocus={onFocus}\n              onBlur={onBlur}\n            />\n          </div>\n        )}\n      />\n    </div>\n  );\n}\n\nexport default memo(SignalFormTab);\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useFormikContext } from 'formik';\nimport lodashGet from 'lodash/get';\nimport { useCallback, useMemo, memo, useEffect, useState } from 'react';\n\nimport { useChartData } from '../../../../context/ChartContext';\nimport { Tabs } from '../../../../elements/Tab';\nimport { translateMultiplet } from '../../../../panels/extra/utilities/MultiplicityUtilities';\nimport Events from '../../../../utility/Events';\n\nimport AddSignalFormTab from './AddSignalFormTab';\nimport SignalFormTab from './SignalFormTab';\n\nconst textStyles = css`\n  text-align: center;\n  width: 100%;\n\n  .errorText {\n    color: red;\n  }\n\n  .infoText {\n    margin-bottom: 20px;\n    font-size: 11px;\n  }\n`;\n\nconst tabStylesAddition = css`\n  color: red;\n`;\n\nfunction SignalsForm() {\n  const { values, setFieldValue, errors } = useFormikContext();\n\n  const { data: spectraData, activeSpectrum } = useChartData();\n  const [activeField, setActiveField] = useState(null);\n  const [frequency, setFrequency] = useState(null);\n\n  useEffect(() => {\n    if (\n      spectraData &&\n      activeSpectrum &&\n      lodashGet(\n        spectraData,\n        `[${activeSpectrum.index}].info.originFrequency`,\n        undefined,\n      )\n    ) {\n      setFrequency(spectraData[activeSpectrum.index].info.originFrequency);\n    } else {\n      setFrequency(null);\n    }\n  }, [activeSpectrum, spectraData]);\n\n  useEffect(() => {\n    Events.on('brushEnd', (event) => {\n      if (activeField && frequency) {\n        setFieldValue(\n          activeField,\n          Math.abs(event.range[0] - event.range[1]) * frequency,\n        );\n      }\n    });\n\n    return () => {\n      Events.off('brushEnd');\n    };\n  }, [activeField, setFieldValue, frequency, values.activeTab]);\n\n  useEffect(() => {\n    Events.on('mouseClick', (event) => {\n      if (values.activeTab === 'addSignalTab' && activeField) {\n        setFieldValue(activeField, event.xPPM);\n      }\n    });\n\n    return () => {\n      Events.off('mouseClick');\n    };\n  }, [values.activeTab, activeField, setFieldValue]);\n\n  const handleOnFocus = useCallback(\n    (name) => {\n      setActiveField(name);\n    },\n    [setActiveField],\n  );\n\n  const tapClickHandler = useCallback(\n    ({ tabid }) => {\n      setFieldValue('activeTab', tabid);\n      setActiveField(null);\n    },\n    [setFieldValue],\n  );\n\n  const handleDeleteSignal = useCallback(\n    ({ tabid }) => {\n      const _signals = values.signals.filter(\n        (_signal, i) => i !== Number(tabid),\n      );\n      setFieldValue('signals', _signals);\n    },\n    [setFieldValue, values.signals],\n  );\n\n  useEffect(() => {\n    setFieldValue(\n      'activeTab',\n      values.signals.length > 0\n        ? (values.signals.length - 1).toString()\n        : 'addSignalTab',\n    );\n  }, [setFieldValue, values.signals.length]);\n\n  const tabContainsErrors = useCallback(\n    (i) => {\n      return (\n        errors.signals &&\n        (lodashGet(errors, 'signals.noCouplings', []).some(\n          (_error) => _error.index === i,\n        ) ||\n          lodashGet(errors, `signals[${i}].missingCouplings`, []).length > 0)\n      );\n    },\n    [errors],\n  );\n\n  const signalFormTabs = useMemo(() => {\n    const signalTabs =\n      values.signals.length > 0\n        ? values.signals.map((signal, i) => (\n            <div\n              // eslint-disable-next-line react/no-array-index-key\n              key={`signalForm${i}`}\n              tabid={`${i}`}\n              tablabel={`${'\\u0394'}: ${signal.delta.toFixed(\n                5,\n              )} (${signal.j\n                .map((_coupling) => translateMultiplet(_coupling.multiplicity))\n                .join('')})`}\n              tabstyles={tabContainsErrors(i) ? tabStylesAddition : null}\n            >\n              <SignalFormTab onFocus={handleOnFocus} />\n            </div>\n          ))\n        : [];\n\n    const addSignalTab = (\n      <div\n        tablabel={'\\u002B'}\n        tabid=\"addSignalTab\"\n        candelete=\"false\"\n        key=\"addSignalTab\"\n      >\n        <AddSignalFormTab onFocus={handleOnFocus} />\n      </div>\n    );\n\n    return signalTabs.concat(addSignalTab);\n  }, [handleOnFocus, tabContainsErrors, values.signals]);\n\n  const editSignalInfoText = (\n    <p className=\"infoText\">\n      Focus on an input field and press Shift + Drag &#38; Drop to draw a\n      coupling constant in spectrum view.\n    </p>\n  );\n\n  const addSignalInfoText = (\n    <p className=\"infoText\">\n      Focus on the input field and press Shift + Left mouse click to select new\n      signal delta value in spectrum view.\n    </p>\n  );\n\n  return (\n    <div>\n      <div css={textStyles}>\n        {errors.signals &&\n        (errors.signals.noSignals || errors.signals.noCouplings) ? (\n          <div>\n            <p className=\"errorText\">\n              {errors.signals.noSignals ||\n                errors.signals.noCouplings[0].message}\n            </p>\n            {errors.signals.noSignals ? addSignalInfoText : null}\n          </div>\n        ) : values.activeTab === 'addSignalTab' ? (\n          addSignalInfoText\n        ) : (\n          editSignalInfoText\n        )}\n      </div>\n      <Tabs\n        defaultTabID={values.activeTab}\n        onClick={tapClickHandler}\n        canDelete\n        onDelete={handleDeleteSignal}\n      >\n        {signalFormTabs}\n      </Tabs>\n    </div>\n  );\n}\n\nexport default memo(SignalsForm);\n","import { hasCouplingConstant } from '../../../../panels/extra/utilities/MultiplicityUtilities';\n\nfunction EditRangeValidation(values, rangeData) {\n  const errors = {};\n\n  if (!values.newSignalDelta) {\n    errors.newSignalDelta = 'required';\n  } else if (\n    values.newSignalDelta < rangeData.from ||\n    values.newSignalDelta > rangeData.to\n  ) {\n    errors.newSignalDelta = ` ${values.newSignalDelta.toFixed(\n      5,\n    )} ppm out of the range`;\n  }\n\n  const createSignalsError = (i) => {\n    if (!errors.signals) {\n      errors.signals = {};\n    }\n    if (i !== undefined && !errors.signals[`${i}`]) {\n      errors.signals[`${i}`] = { missingCouplings: [] };\n    }\n  };\n\n  if (values.signals.length === 0) {\n    createSignalsError();\n    errors.signals.noSignals = 'There must be at least one signal in a range!';\n  } else {\n    values.signals.forEach((_signal, i) => {\n      if (_signal.j.length === 0) {\n        createSignalsError(i);\n        if (!errors.signals.noCouplings) {\n          errors.signals.noCouplings = [];\n        }\n        errors.signals.noCouplings.push({\n          index: i,\n          message: `There must be at least one coupling in signal ${i + 1}!`,\n        });\n      }\n      _signal.j.forEach((_coupling, j) => {\n        if (\n          hasCouplingConstant(_coupling.multiplicity) &&\n          _coupling.coupling === ''\n        ) {\n          createSignalsError(i);\n          errors.signals[`${i}`].missingCouplings.push({\n            index: j,\n            message: `There are coupling values missing in signal ${i + 1}!`,\n          });\n        }\n      });\n    });\n  }\n\n  return errors;\n}\n\nexport default EditRangeValidation;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { Form, Formik } from 'formik';\nimport { useCallback, useEffect, useMemo } from 'react';\nimport { FaSearchPlus } from 'react-icons/fa';\n\nimport generateID from '../../../data/utilities/generateID';\nimport Button from '../../elements/Button';\nimport CloseButton from '../../elements/CloseButton';\nimport SaveButton from '../../elements/SaveButton';\nimport {\n  hasCouplingConstant,\n  translateMultiplet,\n} from '../../panels/extra/utilities/MultiplicityUtilities';\n\nimport SignalsForm from './forms/components/SignalsForm';\nimport EditRangeValidation from './forms/validation/EditRangeValidation';\n\nconst styles = css`\n  overflow: auto;\n  width: 600px;\n  height: 500px;\n  padding: 5px;\n  button:focus {\n    outline: none;\n  }\n  .header {\n    height: 24px;\n    border-bottom: 1px solid #f0f0f0;\n    display: flex;\n    align-items: center;\n    span {\n      color: #464646;\n      font-size: 15px;\n      flex: 1;\n      border-left: 1px solid #ececec;\n      padding-left: 6px;\n    }\n\n    button {\n      background-color: transparent;\n      border: none;\n      padding: 5px;\n\n      svg {\n        height: 16px;\n      }\n    }\n  }\n  .container {\n    display: flex;\n    margin: 30px 5px;\n    input,\n    button {\n      padding: 5px;\n      border: 1px solid gray;\n      border-radius: 5px;\n      height: 36px;\n      margin: 2px;\n    }\n    input {\n      flex: 10;\n    }\n    button {\n      flex: 2;\n      color: white;\n      background-color: gray;\n    }\n  }\n`;\n\nfunction EditRangeModal({\n  onSaveEditRangeModal,\n  onCloseEditRangeModal,\n  onZoomEditRangeModal,\n  rangeData,\n}) {\n  const handleOnZoom = useCallback(() => {\n    onZoomEditRangeModal(rangeData);\n  }, [onZoomEditRangeModal, rangeData]);\n\n  useEffect(() => {\n    handleOnZoom();\n  }, [handleOnZoom]);\n\n  const handleOnClose = useCallback(() => {\n    onCloseEditRangeModal();\n  }, [onCloseEditRangeModal]);\n\n  const getCouplings = useCallback(\n    (couplings) =>\n      couplings\n        .filter((coupling) => coupling.coupling !== '')\n        .map((coupling) => {\n          return {\n            ...coupling,\n            multiplicity: translateMultiplet(coupling.multiplicity),\n          };\n        }),\n    [],\n  );\n\n  const getSignals = useCallback(\n    (signals) => {\n      return signals.map((_signal) => {\n        return {\n          id: generateID(),\n          ..._signal,\n          multiplicity: _signal.j\n            .map((_coupling) => translateMultiplet(_coupling.multiplicity))\n            .join(''),\n          j: getCouplings(_signal.j),\n        };\n      });\n    },\n    [getCouplings],\n  );\n\n  const handleOnSave = useCallback(\n    async (formValues) => {\n      const _range = { ...rangeData };\n      _range.signal = getSignals(formValues.signals);\n      await onSaveEditRangeModal(_range);\n      handleOnClose();\n    },\n    [getSignals, handleOnClose, onSaveEditRangeModal, rangeData],\n  );\n\n  const initialStateSignals = useMemo(() => {\n    return rangeData.signal.map((_signal) => {\n      // counter within j array to access to right j values\n      let counterJ = 0;\n      const couplings = [];\n      let coupling;\n      _signal.multiplicity.split('').forEach((_multiplicity) => {\n        if (hasCouplingConstant(_multiplicity)) {\n          coupling = { ..._signal.j[counterJ] };\n          counterJ++;\n        } else {\n          coupling = { multiplicity: _multiplicity, coupling: '' };\n        }\n        coupling.multiplicity = translateMultiplet(coupling.multiplicity);\n        couplings.push(coupling);\n      });\n      return { ..._signal, j: couplings };\n    });\n  }, [rangeData.signal]);\n\n  const isSaveButtonDisabled = useCallback((errors) => {\n    const errorKeys = Object.keys(errors);\n    if (errorKeys.length > 0) {\n      if (\n        // ignore non-relevant newSignalDelta field\n        errorKeys.length === 1 &&\n        errorKeys[0] === 'newSignalDelta'\n      ) {\n        return false;\n      }\n      return true;\n    }\n    return false;\n  }, []);\n\n  return (\n    <div css={styles}>\n      {rangeData && (\n        <Formik\n          initialValues={{\n            signals: initialStateSignals,\n            newSignalDelta: (rangeData.from + rangeData.to) / 2,\n            activeTab: '0',\n          }}\n          validate={(values) => EditRangeValidation(values, rangeData)}\n          onSubmit={(values, { setSubmitting }) => {\n            handleOnSave(values);\n            setSubmitting(false);\n          }}\n        >\n          {({ values, errors }) => {\n            return (\n              <Form>\n                <div className=\"header handle\">\n                  <Button onClick={handleOnZoom} className=\"zoom-button\">\n                    <FaSearchPlus title=\"Set to default view on range in spectrum\" />\n                  </Button>\n                  <span>Range Information and Editing</span>\n                  <SaveButton\n                    onClick={() => handleOnSave(values)}\n                    disabled={isSaveButtonDisabled(errors)}\n                    popupTitle=\"Save and exit\"\n                  />\n\n                  <CloseButton onClick={handleOnClose} />\n                </div>\n                <SignalsForm />\n              </Form>\n            );\n          }}\n        </Formik>\n      )}\n    </div>\n  );\n}\n\nEditRangeModal.defaultProps = {\n  onSave: () => {\n    return null;\n  },\n  onClose: () => {\n    return null;\n  },\n  onZoom: () => {\n    return null;\n  },\n};\n\nexport default EditRangeModal;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { Fragment, useCallback } from 'react';\nimport { FaRegTrashAlt, FaSearchPlus, FaEdit } from 'react-icons/fa';\n\nimport { SignalKinds } from '../../../../data/constants/SignalsKinds';\nimport { useAssignmentData } from '../../../assignment';\nimport { useDispatch } from '../../../context/DispatchContext';\nimport SelectUncontrolled from '../../../elements/SelectUncontrolled';\nimport {\n  useModal,\n  positions,\n  transitions,\n} from '../../../elements/popup/Modal';\nimport EditRangeModal from '../../../modal/editRange/EditRangeModal';\nimport {\n  SET_X_DOMAIN,\n  RESET_SELECTED_TOOL,\n  SET_SELECTED_TOOL,\n  CHANGE_RANGE_SIGNAL_KIND,\n  SAVE_EDITED_RANGE,\n  DELETE_RANGE,\n} from '../../../reducer/types/Types';\n\nconst styles = css`\n  width: 66px;\n  padding: 0 !important;\n  button {\n    background-color: transparent;\n    border: none;\n    padding: 5px;\n  }\n\n  button:disabled {\n    opacity: 0.6;\n  }\n`;\nconst selectBoxStyle = {\n  marginLeft: 2,\n  marginRight: 2,\n  border: 'none',\n  height: '20px',\n};\n\nfunction ActionsColumn({ rowData, onHoverSignal, rowSpanTags }) {\n  const dispatch = useDispatch();\n  const modal = useModal();\n  const assignmentData = useAssignmentData();\n\n  const zoomRangeHandler = useCallback(() => {\n    const margin = Math.abs(rowData.from - rowData.to);\n    dispatch({\n      type: SET_X_DOMAIN,\n      xDomain: [rowData.from - margin, rowData.to + margin],\n    });\n  }, [dispatch, rowData.from, rowData.to]);\n\n  const deleteRangeHandler = useCallback(() => {\n    dispatch({\n      type: DELETE_RANGE,\n      payload: {\n        id: rowData.id,\n        assignmentData,\n      },\n    });\n  }, [assignmentData, dispatch, rowData]);\n\n  const changeRangeSignalKindHandler = useCallback(\n    (value) => {\n      dispatch({\n        type: CHANGE_RANGE_SIGNAL_KIND,\n        payload: {\n          rowData,\n          value,\n        },\n      });\n    },\n    [dispatch, rowData],\n  );\n\n  const saveEditRangeHandler = useCallback(\n    (editedRowData) => {\n      dispatch({\n        type: SAVE_EDITED_RANGE,\n        payload: {\n          editedRowData,\n          assignmentData,\n        },\n      });\n    },\n    [assignmentData, dispatch],\n  );\n\n  const closeEditRangeHandler = useCallback(() => {\n    dispatch({ type: RESET_SELECTED_TOOL });\n    modal.close();\n  }, [dispatch, modal]);\n\n  const openEditRangeHandler = useCallback(() => {\n    dispatch({ type: SET_SELECTED_TOOL, selectedTool: 'editRange' });\n    modal.show(\n      <EditRangeModal\n        onCloseEditRangeModal={closeEditRangeHandler}\n        onSaveEditRangeModal={saveEditRangeHandler}\n        onZoomEditRangeModal={zoomRangeHandler}\n        rangeData={rowData}\n      />,\n      {\n        position: positions.CENTER_RIGHT,\n        transition: transitions.SCALE,\n        isBackgroundBlur: false,\n      },\n    );\n  }, [\n    closeEditRangeHandler,\n    dispatch,\n    modal,\n    rowData,\n    saveEditRangeHandler,\n    zoomRangeHandler,\n  ]);\n\n  return (\n    <Fragment>\n      <td {...onHoverSignal}>\n        <SelectUncontrolled\n          onChange={changeRangeSignalKindHandler}\n          data={SignalKinds}\n          value={rowData.tableMetaInfo.signal.kind}\n          style={selectBoxStyle}\n        />\n      </td>\n      <td {...rowSpanTags} css={styles}>\n        <button\n          type=\"button\"\n          className=\"delete-button\"\n          onClick={deleteRangeHandler}\n        >\n          <FaRegTrashAlt />\n        </button>\n        <button\n          type=\"button\"\n          className=\"zoom-button\"\n          onClick={zoomRangeHandler}\n        >\n          <FaSearchPlus title=\"Zoom to range in spectrum\" />\n        </button>\n        <button\n          type=\"button\"\n          className=\"edit-button\"\n          onClick={openEditRangeHandler}\n        >\n          <FaEdit color=\"blue\" />\n        </button>\n      </td>\n    </Fragment>\n  );\n}\n\nexport default ActionsColumn;\n","import lodashGet from 'lodash/get';\n\nfunction CouplingColumn({ rowData, onHoverSignal }) {\n  const result = lodashGet(rowData, 'tableMetaInfo.signal.j');\n  return (\n    <td {...onHoverSignal}>\n      {result &&\n        result.map((coupling) => coupling.coupling.toFixed(1)).join(',')}\n    </td>\n  );\n}\n\nexport default CouplingColumn;\n","import lodashGet from 'lodash/get';\nimport { useMemo, useCallback, memo } from 'react';\nimport { FaMinusCircle } from 'react-icons/fa';\n\nconst spanStyle = {\n  color: 'red',\n  fontWeight: 'bold',\n};\n\nfunction RangeAssignmentsColumn({\n  rowData,\n  assignment,\n  highlight,\n  onUnlinkVisibilityChange,\n  unlinkVisibility,\n  onLink,\n  onUnlink,\n  rowSpanTags,\n  onHover,\n  highlightData,\n}) {\n  const diaIDs = useMemo(() => {\n    return lodashGet(rowData, 'diaID', []);\n  }, [rowData]);\n\n  const visibilityChangeHandler = useCallback(\n    (flag) => {\n      onUnlinkVisibilityChange(flag);\n    },\n    [onUnlinkVisibilityChange],\n  );\n\n  const spanCss = useMemo(() => {\n    const flag =\n      assignment.isActive ||\n      assignment.isOnHover ||\n      (highlight.isActive &&\n        !highlightData.highlight.highlighted.find((_highlighted) => {\n          return _highlighted === assignment.id;\n        }));\n\n    return flag\n      ? {\n          color: 'red',\n          fontWeight: 'bold',\n        }\n      : { color: 'black', fontWeight: 'normal' };\n  }, [\n    assignment.id,\n    assignment.isActive,\n    assignment.isOnHover,\n    highlight.isActive,\n    highlightData.highlight.highlighted,\n  ]);\n\n  return (\n    <td\n      {...rowSpanTags}\n      {...onHover}\n      {...{ onClick: (e) => onLink(e, assignment) }}\n    >\n      {rowData.pubIntegral !== undefined && rowData.pubIntegral > 0 ? (\n        rowData.diaID && rowData.diaID.length > 0 ? (\n          <div\n            onMouseEnter={() => visibilityChangeHandler(true)}\n            onMouseLeave={() => visibilityChangeHandler(false)}\n          >\n            {rowData.pubIntegral} {' ( '}\n            <span style={spanCss}>{diaIDs.length}</span>\n            {' ) '}\n            <sup>\n              <button\n                type=\"button\"\n                style={{\n                  visibility: unlinkVisibility ? 'visible' : 'hidden',\n                  padding: 0,\n                  margin: 0,\n                }}\n                onClick={(e) => onUnlink(e, true)}\n              >\n                <FaMinusCircle color=\"red\" />\n              </button>\n            </sup>\n          </div>\n        ) : assignment.isActive ? (\n          <div>\n            {`${rowData.pubIntegral} (`}\n            <span style={spanStyle}>0</span>\n            {')'}\n          </div>\n        ) : (\n          rowData.pubIntegral\n        )\n      ) : assignment.isActive ? (\n        <div>\n          {'0 ('}\n          <span style={spanStyle}>0</span>\n          {')'}\n        </div>\n      ) : (\n        ''\n      )}\n    </td>\n  );\n}\n\nRangeAssignmentsColumn.defaultProps = {\n  onHover: () => null,\n  onUnlinkVisibilityChange: () => null,\n  onLink: () => null,\n  onUnlink: () => null,\n};\n\nexport default memo(RangeAssignmentsColumn);\n","import { memo } from 'react';\n\nimport FormatNumber from '../../../utility/FormatNumber';\n\nfunction RangeColumn({ value, rowSpanTags, onHoverRange, format }) {\n  return (\n    <td {...rowSpanTags} {...onHoverRange}>\n      {FormatNumber(value, format)}\n    </td>\n  );\n}\n\nexport default memo(RangeColumn);\n","import { forwardRef, useCallback, useMemo } from 'react';\n\nimport { checkRangeKind } from '../../../../data/utilities/RangeUtilities';\nimport { useDispatch } from '../../../context/DispatchContext';\nimport EditableColumn from '../../../elements/EditableColumn';\nimport { CHANGE_RANGE_RELATIVE } from '../../../reducer/types/Types';\nimport FormatNumber from '../../../utility/FormatNumber';\n\nfunction RelativeColumn(\n  { rowData, rowSpanTags, onHoverRange, format, onEditStart, editStatus },\n  ref,\n) {\n  const dispatch = useDispatch();\n  const integralVal = useMemo(() => {\n    const flag = checkRangeKind(rowData);\n    const formattedValue = FormatNumber(rowData.integral, format);\n    return flag ? formattedValue : `[ ${formattedValue} ]`;\n  }, [format, rowData]);\n\n  const saveHandler = useCallback(\n    (event) => {\n      dispatch({\n        type: CHANGE_RANGE_RELATIVE,\n        value: event.target.value,\n        id: rowData.id,\n      });\n    },\n    [dispatch, rowData.id],\n  );\n\n  return (\n    <td {...rowSpanTags} {...onHoverRange}>\n      <EditableColumn\n        ref={ref}\n        onEditStart={onEditStart}\n        value={integralVal}\n        onSave={saveHandler}\n        type=\"number\"\n        style={{ padding: '0.1rem 0.4rem' }}\n        editStatus={editStatus}\n      />\n    </td>\n  );\n}\n\nexport default forwardRef(RelativeColumn);\n","import lodashGet from 'lodash/get';\nimport { useMemo, useCallback, memo } from 'react';\nimport { FaMinusCircle } from 'react-icons/fa';\n\nfunction SignalAssignmentsColumn({\n  rowData,\n  onHover,\n  assignment,\n  highlight,\n  onUnlinkVisibilityChange,\n  unlinkVisibility,\n  onLink,\n  onUnlink,\n}) {\n  const diaIDs = useMemo(() => {\n    return lodashGet(rowData, 'tableMetaInfo.signal.diaID', []);\n  }, [rowData]);\n\n  const tdCss = useMemo(() => {\n    return assignment.isActive || highlight.isActive\n      ? {\n          color: 'red',\n          fontWeight: 'bold',\n        }\n      : null;\n  }, [assignment.isActive, highlight.isActive]);\n\n  const visibilityChangeHandler = useCallback(\n    (flag) => {\n      onUnlinkVisibilityChange(flag);\n    },\n    [onUnlinkVisibilityChange],\n  );\n  const assignHandler = useCallback(\n    (e) => {\n      onLink(e, assignment);\n    },\n    [assignment, onLink],\n  );\n\n  return (\n    <td {...onHover} onClick={assignHandler} style={tdCss}>\n      {diaIDs && diaIDs.length > 0 ? (\n        <div\n          onMouseEnter={() => visibilityChangeHandler(true)}\n          onMouseLeave={() => visibilityChangeHandler(false)}\n        >\n          {diaIDs.length}{' '}\n          <sup>\n            <button\n              type=\"button\"\n              style={{\n                visibility: unlinkVisibility ? 'visible' : 'hidden',\n                padding: 0,\n                margin: 0,\n              }}\n              onClick={(e) => onUnlink(e, false)}\n            >\n              <FaMinusCircle color=\"red\" />\n            </button>\n          </sup>\n        </div>\n      ) : assignment.isActive ? (\n        '0'\n      ) : (\n        ''\n      )}\n    </td>\n  );\n}\n\nSignalAssignmentsColumn.defaultProps = {\n  onHover: () => null,\n  onUnlinkVisibilityChange: () => null,\n  onLink: () => null,\n  onUnlink: () => null,\n};\n\nexport default memo(SignalAssignmentsColumn);\n","import lodashGet from 'lodash/get';\n\nimport FormatNumber from '../../../utility/FormatNumber';\n\nexport default function useFormat(preferences) {\n  return (value, keysPath, prefix = '', suffix = '') => {\n    const format = lodashGet(preferences, keysPath, '0.000');\n    return FormatNumber(value, format, prefix, suffix);\n  };\n}\n","import { useCallback } from 'react';\n\nimport { useDispatch } from '../../../context/DispatchContext';\nimport EditableColumn from '../../../elements/EditableColumn';\nimport { CHANGE_RANGE_SIGNAL_VALUE } from '../../../reducer/types/Types';\nimport { checkMultiplicity } from '../../extra/utilities/MultiplicityUtilities';\n\nimport useFormat from './format';\n\nfunction SignalDeltaColumn({\n  rowData,\n  onHoverSignal,\n  preferences,\n  onEditStart,\n  editStatus,\n}) {\n  const dispatch = useDispatch();\n  const signal = rowData.tableMetaInfo.signal;\n  const format = useFormat(preferences);\n\n  const saveHandler = useCallback(\n    (event) => {\n      dispatch({\n        type: CHANGE_RANGE_SIGNAL_VALUE,\n        payload: {\n          value: event.target.value,\n          rangeID: rowData.id,\n          signalID: signal.id,\n        },\n      });\n    },\n    [dispatch, rowData, signal.id],\n  );\n  const editStartHandler = useCallback(() => {\n    onEditStart(signal.id);\n  }, [onEditStart, signal.id]);\n\n  if (!signal) return <td>{''}</td>;\n\n  return (\n    <td {...onHoverSignal}>\n      {!checkMultiplicity(signal.multiplicity, ['m']) ? (\n        `${format(rowData.from, 'fromFormat')} - ${format(\n          rowData.to,\n          'toFormat',\n        )}`\n      ) : (\n        <EditableColumn\n          onEditStart={editStartHandler}\n          value={signal.delta.toFixed(3)}\n          onSave={saveHandler}\n          type=\"number\"\n          style={{ padding: '0.1rem 0.4rem' }}\n          editStatus={editStatus}\n        />\n      )}\n    </td>\n  );\n}\n\nexport default SignalDeltaColumn;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport lodashGet from 'lodash/get';\nimport { useMemo, useCallback, useState } from 'react';\n\nimport { useAssignment } from '../../assignment';\nimport { useHighlight, useHighlightData } from '../../highlight';\nimport { isColumnVisible } from '../extra/preferences/ColumnsHelper';\n\nimport AbsoluteColumn from './TableColumns/AbsoluteColumn';\nimport ActionsColumn from './TableColumns/ActionsColumn';\nimport CouplingColumn from './TableColumns/CouplingColumn';\nimport RangeAssignmentsColumn from './TableColumns/RangeAssignmentsColumn';\nimport RangeColumn from './TableColumns/RangeColumn';\nimport RelativeColumn from './TableColumns/RelativeColumn';\nimport SignalAssignmentsColumn from './TableColumns/SignalAssignmentsColumn';\nimport SignalDeltaColumn from './TableColumns/SignalDeltaColumn';\nimport useFormat from './TableColumns/format';\n\nconst HighlightedRowStyle = css`\n  background-color: #ff6f0057;\n`;\n\nconst ConstantlyHighlightedRowStyle = css`\n  background-color: #f5f5dc;\n`;\n\nfunction RangesTableRow({\n  rowData,\n  onUnlink,\n  onContextMenu,\n  onColumnEditStart,\n  preferences,\n  editFlags: { relativeFlags, signalFlags },\n}) {\n  const assignmentRange = useAssignment(rowData.id);\n  const highlightRange = useHighlight(\n    [assignmentRange.id].concat(assignmentRange.assigned.x || []),\n  );\n  const assignmentSignal = useAssignment(rowData.tableMetaInfo.id);\n  const highlightSignal = useHighlight(\n    [assignmentSignal.id].concat(assignmentSignal.assigned.x || []),\n  );\n  const highlightData = useHighlightData();\n\n  const [unlinkRangeButtonVisibility, showUnlinkRangeButton] = useState(false);\n  const [unlinkSignalButtonVisibility, showUnlinkSignalButton] = useState(\n    false,\n  );\n\n  const getFormat = useFormat(preferences);\n\n  const rowSpanTags = useMemo(() => {\n    return {\n      rowSpan: rowData.tableMetaInfo.rowSpan,\n      style: lodashGet(rowData.tableMetaInfo, 'hide', false)\n        ? { display: 'none' }\n        : null,\n    };\n  }, [rowData.tableMetaInfo]);\n\n  const unlinkHandler = useCallback(\n    (e, isOnRangeLevel) => {\n      // stop propagation here to prevent enabling/disabling the assignment mode at the same time\n      if (e) {\n        e.stopPropagation();\n      }\n\n      onUnlink(\n        rowData,\n        isOnRangeLevel,\n        lodashGet(rowData, 'tableMetaInfo.signalIndex', undefined),\n      );\n      if (isOnRangeLevel !== undefined) {\n        if (isOnRangeLevel) {\n          showUnlinkRangeButton(false);\n          assignmentRange.removeAll('x');\n        } else {\n          showUnlinkSignalButton(false);\n          assignmentSignal.removeAll('x');\n        }\n      } else {\n        showUnlinkRangeButton(false);\n        showUnlinkSignalButton(false);\n      }\n    },\n    [assignmentRange, assignmentSignal, onUnlink, rowData],\n  );\n\n  const linkHandler = useCallback((e, assignment) => {\n    e.stopPropagation();\n    assignment.onClick('x');\n  }, []);\n\n  const onHoverRange = useMemo(() => {\n    return {\n      onMouseEnter: () => {\n        assignmentRange.onMouseEnter('x');\n        highlightRange.show();\n      },\n      onMouseLeave: () => {\n        assignmentRange.onMouseLeave('x');\n        highlightRange.hide();\n      },\n    };\n  }, [assignmentRange, highlightRange]);\n\n  const onHoverSignal = useMemo(() => {\n    return {\n      onMouseEnter: () => {\n        assignmentSignal.onMouseEnter('x');\n        highlightSignal.show();\n      },\n      onMouseLeave: () => {\n        assignmentSignal.onMouseLeave('x');\n        highlightSignal.hide();\n      },\n    };\n  }, [assignmentSignal, highlightSignal]);\n\n  const trCss = useMemo(() => {\n    return highlightRange.isActive || assignmentRange.isActive\n      ? HighlightedRowStyle\n      : lodashGet(rowData, 'tableMetaInfo.isConstantlyHighlighted', false)\n      ? ConstantlyHighlightedRowStyle\n      : null;\n  }, [assignmentRange.isActive, highlightRange.isActive, rowData]);\n\n  return (\n    <tr\n      onContextMenu={(e) => onContextMenu(e, rowData)}\n      css={trCss}\n      {...highlightRange.onHover}\n    >\n      <td {...rowSpanTags} {...onHoverRange}>\n        {rowData.tableMetaInfo.rowIndex + 1}\n      </td>\n\n      {isColumnVisible(preferences, 'showFrom') && (\n        <RangeColumn\n          value={rowData.from}\n          rowSpanTags={rowSpanTags}\n          onHoverRange={onHoverRange}\n          format={getFormat('showFrom')}\n        />\n      )}\n      {isColumnVisible(preferences, 'showTo') && (\n        <RangeColumn\n          value={rowData.to}\n          rowSpanTags={rowSpanTags}\n          onHoverRange={onHoverRange}\n          format={getFormat('toFormat')}\n        />\n      )}\n\n      <SignalDeltaColumn\n        rowData={rowData}\n        onHoverSignal={onHoverSignal}\n        preferences={preferences}\n        onEditStart={(signalId) => onColumnEditStart('signal', `${signalId}`)}\n        editStatus={signalFlags[rowData.tableMetaInfo.signal.id]}\n      />\n\n      {isColumnVisible(preferences, 'showRelative') && (\n        <RelativeColumn\n          rowData={rowData}\n          rowSpanTags={rowSpanTags}\n          onHoverRange={onHoverRange}\n          format={getFormat('relativeFormat')}\n          onEditStart={() => onColumnEditStart('relative', rowData.id)}\n          editStatus={relativeFlags[rowData.id]}\n        />\n      )}\n\n      {isColumnVisible(preferences, 'showAbsolute') && (\n        <AbsoluteColumn\n          value={rowData.absolute}\n          rowSpanTags={rowSpanTags}\n          onHoverRange={onHoverRange}\n          format={getFormat('absoluteFormat')}\n        />\n      )}\n\n      <td {...onHoverSignal}>\n        {lodashGet(rowData, 'tableMetaInfo.signal.multiplicity', '')}\n      </td>\n\n      <CouplingColumn rowData={rowData} onHoverSignal={onHoverSignal} />\n\n      <SignalAssignmentsColumn\n        rowData={rowData}\n        assignment={assignmentSignal}\n        highlight={highlightSignal}\n        onHover={onHoverSignal}\n        unlinkVisibility={unlinkSignalButtonVisibility}\n        onUnlinkVisibilityChange={(flag) => showUnlinkSignalButton(flag)}\n        onLink={linkHandler}\n        onUnlink={unlinkHandler}\n      />\n\n      <RangeAssignmentsColumn\n        rowData={rowData}\n        assignment={assignmentRange}\n        highlight={highlightRange}\n        onHover={onHoverRange}\n        unlinkVisibility={unlinkRangeButtonVisibility}\n        onUnlinkVisibilityChange={(flag) => showUnlinkRangeButton(flag)}\n        onLink={linkHandler}\n        onUnlink={unlinkHandler}\n        rowSpanTags={rowSpanTags}\n        highlightData={highlightData}\n      />\n\n      <ActionsColumn\n        rowData={rowData}\n        onHoverSignal={onHoverSignal}\n        onHoverRange={onHoverRange}\n        rowSpanTags={rowSpanTags}\n      />\n    </tr>\n  );\n}\n\nexport default RangesTableRow;\n","import { useMemo } from 'react';\n\nfunction useMapRanges(data) {\n  return useMemo(() => {\n    const _rangesData = [];\n    data.forEach((range, i) => {\n      if (range.signal.length === 1) {\n        _rangesData.push({\n          ...range,\n          tableMetaInfo: {\n            ...range.tableMetaInfo,\n            signal: range.signal[0],\n            rowIndex: i,\n            signalIndex: 0,\n            id: range.signal[0].id,\n          },\n        });\n      } else if (range.signal.length > 1) {\n        range.signal.forEach((signal, j) => {\n          let hide = false;\n          let rowSpan = null;\n          if (j < range.signal.length - 1) {\n            if (j === 0) {\n              rowSpan = range.signal.length;\n            } else {\n              hide = true;\n            }\n          } else {\n            hide = true;\n          }\n\n          _rangesData.push({\n            ...range,\n            tableMetaInfo: {\n              ...range.tableMetaInfo,\n              signal,\n              rowSpan,\n              hide,\n              rowIndex: i,\n              signalIndex: j,\n              id: signal.id,\n            },\n          });\n        });\n      }\n    });\n\n    return _rangesData;\n  }, [data]);\n}\n\nexport default useMapRanges;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport lodashGet from 'lodash/get';\nimport { Fragment, useCallback, useEffect, useRef } from 'react';\nimport { FaLink } from 'react-icons/fa';\n\nimport checkModifierKeyActivated from '../../../data/utilities/checkModifierKeyActivated';\nimport { useGlobal } from '../../context/GlobalContext';\nimport ContextMenu from '../../elements/ContextMenu';\nimport useToggleStatus from '../extra/utilities/UseToggleStatus';\n\nimport RangesTableRow from './RangesTableRow';\nimport useMapRanges from './useMapRanges';\n\nconst tableStyle = css`\n  border-spacing: 0;\n  border: 1px solid #dedede;\n  width: 100%;\n  font-size: 12px;\n  height: 100%;\n  .react-contextmenu-wrapper {\n    display: contents;\n  }\n  tr {\n    :last-child {\n      td {\n        border-bottom: 0;\n      }\n    }\n  }\n  th,\n  td {\n    white-space: nowrap;\n    text-align: center;\n    margin: 0;\n    padding: 0.1rem 0.4rem;\n    border-bottom: 1px solid #dedede;\n    border-right: 1px solid #dedede;\n\n    :last-child {\n      border-right: 0;\n    }\n    button {\n      background-color: transparent;\n      border: none;\n    }\n  }\n`;\n\nfunction RangesTable({\n  tableData,\n  onChangeKind,\n  onDelete,\n  onUnlink,\n  onZoom,\n  onEdit,\n  context,\n  activeTab,\n  preferences,\n}) {\n  const element = activeTab && activeTab.replace(/[0-9]/g, '');\n  const contextRef = useRef();\n  const data = useMapRanges(tableData);\n  const [relativeFlags, toggleRelativeColumn] = useToggleStatus('id', data);\n  const [signalFlags, toggleSignalColumn] = useToggleStatus('id', data);\n  const { rootRef } = useGlobal();\n\n  const isVisible = (key) => {\n    return lodashGet(preferences, key, false);\n  };\n\n  const contextMenuHandler = useCallback(\n    (e, rowData) => {\n      if (!checkModifierKeyActivated(e)) {\n        e.preventDefault();\n        contextRef.current.handleContextMenu(e, rowData);\n      }\n    },\n    [contextRef],\n  );\n\n  const columnEditStartHandler = useCallback(\n    (columnKey, id) => {\n      if (columnKey === 'relative') {\n        toggleRelativeColumn(id);\n      } else if (columnKey === 'signal') {\n        toggleSignalColumn(id);\n      }\n    },\n    [toggleRelativeColumn, toggleSignalColumn],\n  );\n\n  useEffect(() => {\n    const handleEditStart = () => {\n      columnEditStartHandler('realtive', null);\n      columnEditStartHandler('signal', null);\n    };\n    if (rootRef) {\n      rootRef.addEventListener('mousedown', handleEditStart);\n    }\n    return () => {\n      if (rootRef) {\n        rootRef.removeEventListener('mousedown', handleEditStart);\n      }\n    };\n  }, [columnEditStartHandler, rootRef]);\n\n  return (\n    <Fragment>\n      <table css={tableStyle}>\n        <thead>\n          <tr>\n            <th>#</th>\n            {isVisible('showFrom') ? <th>From</th> : null}\n            {isVisible('showTo') ? <th>To</th> : null}\n            <th> (ppm)</th>\n            {isVisible('showRelative') ? <th>Rel. {element}</th> : null}\n            {isVisible('showAbsolute') ? <th>Absolute</th> : null}\n            <th>Mult.</th>\n            <th>J (Hz)</th>\n            <th>\n              <FaLink style={{ fontSize: 10 }} />\n            </th>\n            <th></th>\n            <th>Kind</th>\n            <th>{''}</th>\n          </tr>\n        </thead>\n        <tbody>\n          {data &&\n            data.map((range, i) => {\n              return (\n                <RangesTableRow\n                  // eslint-disable-next-line react/no-array-index-key\n                  key={`rangesTableRow${i}`}\n                  rowData={data[i]}\n                  onChangeKind={onChangeKind}\n                  onDelete={onDelete}\n                  onUnlink={onUnlink}\n                  onZoom={onZoom}\n                  onEdit={onEdit}\n                  onContextMenu={(e, rowData) => contextMenuHandler(e, rowData)}\n                  preferences={preferences}\n                  onColumnEditStart={columnEditStartHandler}\n                  editFlags={{ relativeFlags, signalFlags }}\n                />\n              );\n            })}\n        </tbody>\n      </table>\n      <ContextMenu ref={contextRef} context={context} />\n    </Fragment>\n  );\n}\n\nexport default RangesTable;\n","import lodashGet from 'lodash/get';\nimport { xGetFromToIndex } from 'ml-spectra-processing';\nimport { useCallback, useMemo, memo, useState, useRef } from 'react';\nimport ReactCardFlip from 'react-card-flip';\n\nimport { useAssignmentData } from '../../assignment';\nimport { useDispatch } from '../../context/DispatchContext';\nimport { useAlert } from '../../elements/popup/Alert';\nimport RangesWrapper from '../../hoc/RangesWrapper';\nimport { UNLINK_RANGE } from '../../reducer/types/Types';\nimport { copyTextToClipboard } from '../../utility/Export';\nimport NoTableData from '../extra/placeholder/NoTableData';\nimport { rangeDefaultValues } from '../extra/preferences/defaultValues';\nimport PreferencesHeader from '../header/PreferencesHeader';\n\nimport RangesHeader from './RangesHeader';\nimport RangesPreferences from './RangesPreferences';\nimport RangesTable from './RangesTable';\n\nconst styles = {\n  toolbar: {\n    display: 'flex',\n    flexDirection: 'row',\n    borderBottom: '0.55px solid rgb(240, 240, 240)',\n  },\n  container: {\n    flexDirection: 'column',\n    height: '100%',\n    display: 'flex',\n  },\n  sumButton: {\n    borderRadius: '5px',\n    marginTop: '3px',\n    color: 'white',\n    backgroundColor: '#6d6d6d',\n    border: 'none',\n    height: '16px',\n    width: '18px',\n    fontSize: '12px',\n    padding: 0,\n  },\n  removeAssignmentsButton: {\n    borderRadius: '5px',\n    marginTop: '3px',\n    marginLeft: '2px',\n    border: 'none',\n    height: '16px',\n    width: '18px',\n    fontSize: '12px',\n    padding: 0,\n  },\n  setShowMultiplicityTreesButton: {\n    borderRadius: '5px',\n    marginTop: '3px',\n    marginLeft: '5px',\n    color: 'black',\n    backgroundColor: 'transparent',\n    border: 'none',\n    height: '16px',\n    width: '18px',\n    fontSize: '12px',\n    padding: 0,\n  },\n  button: {\n    backgroundColor: 'transparent',\n    border: 'none',\n  },\n};\n\nfunction RangesTablePanel({\n  ranges,\n  x,\n  y,\n  info,\n  xDomain,\n  preferences,\n  activeTab,\n  molecules,\n  nucleus,\n}) {\n  const [isFilterActive, setFilterIsActive] = useState(false);\n  const assignmentData = useAssignmentData();\n\n  const dispatch = useDispatch();\n  const alert = useAlert();\n  const [isFlipped, setFlipStatus] = useState(false);\n  const settingRef = useRef();\n\n  const rangesData = useMemo(() => {\n    const isInView = (from, to) => {\n      const factor = 10000;\n      to = to * factor;\n      from = from * factor;\n      return (\n        (to >= xDomain[0] * factor && from <= xDomain[1] * factor) ||\n        (from <= xDomain[0] * factor && to >= xDomain[1] * factor)\n      );\n    };\n\n    const getFilteredRanges = (ranges) => {\n      return ranges.filter((range) => isInView(range.from, range.to));\n    };\n\n    if (ranges.values) {\n      const _ranges = isFilterActive\n        ? getFilteredRanges(ranges.values)\n        : ranges.values;\n\n      return _ranges.map((range) => {\n        return {\n          ...range,\n          tableMetaInfo: {\n            isConstantlyHighlighted: isInView(range.from, range.to),\n          },\n        };\n      });\n    }\n    return [];\n  }, [isFilterActive, ranges.values, xDomain]);\n\n  const unlinkRangeHandler = useCallback(\n    (rangeData, isOnRangeLevel, signalIndex) => {\n      dispatch({\n        type: UNLINK_RANGE,\n        payload: {\n          rangeData,\n          assignmentData,\n          isOnRangeLevel,\n          signalIndex,\n        },\n      });\n    },\n    [assignmentData, dispatch],\n  );\n\n  const saveJSONToClipboardHandler = useCallback(\n    (value) => {\n      if (x && y) {\n        const { from, to } = value;\n        const { fromIndex, toIndex } = xGetFromToIndex(x, {\n          from,\n          to,\n        });\n\n        const dataToClipboard = {\n          x: x.slice(fromIndex, toIndex),\n          y: y.slice(fromIndex, toIndex),\n          ...value,\n        };\n\n        const success = copyTextToClipboard(\n          JSON.stringify(dataToClipboard, undefined, 2),\n        );\n\n        if (success) {\n          alert.show('Data copied to clipboard');\n        } else {\n          alert.error('copy to clipboard failed');\n        }\n      }\n    },\n    [x, y, alert],\n  );\n\n  const rangesPreferences = useMemo(() => {\n    const _preferences =\n      lodashGet(preferences, `formatting.panels.ranges.[${activeTab}]`) ||\n      rangeDefaultValues;\n\n    return _preferences;\n  }, [activeTab, preferences]);\n\n  const contextMenu = useMemo(\n    () => [\n      {\n        label: 'Copy to clipboard',\n        onClick: saveJSONToClipboardHandler,\n      },\n    ],\n    [saveJSONToClipboardHandler],\n  );\n\n  const filterHandler = useCallback(() => {\n    setFilterIsActive(!isFilterActive);\n  }, [isFilterActive]);\n\n  const settingsPanelHandler = useCallback(() => {\n    setFlipStatus(!isFlipped);\n  }, [isFlipped]);\n\n  const saveSettingHandler = useCallback(() => {\n    settingRef.current.saveSetting();\n    setFlipStatus(false);\n  }, []);\n\n  return (\n    <>\n      <div style={styles.container}>\n        {!isFlipped && (\n          <RangesHeader\n            ranges={ranges}\n            info={info}\n            activeTab={activeTab}\n            molecules={molecules}\n            onUnlink={unlinkRangeHandler}\n            onFilterActivated={filterHandler}\n            onSettingClick={settingsPanelHandler}\n            isFilterActive={isFilterActive}\n            filterCounter={rangesData.length}\n          />\n        )}\n        {isFlipped && (\n          <PreferencesHeader\n            onSave={saveSettingHandler}\n            onClose={settingsPanelHandler}\n          />\n        )}\n        <div style={{ height: '100%', overflow: 'auto' }}>\n          <ReactCardFlip\n            isFlipped={isFlipped}\n            infinite\n            containerStyle={{ overflow: 'hidden' }}\n          >\n            <div>\n              {rangesData && rangesData.length > 0 ? (\n                <RangesTable\n                  activeTab={activeTab}\n                  tableData={rangesData}\n                  onUnlink={unlinkRangeHandler}\n                  context={contextMenu}\n                  preferences={rangesPreferences}\n                />\n              ) : (\n                <NoTableData />\n              )}\n            </div>\n            <RangesPreferences\n              ranges={ranges}\n              ref={settingRef}\n              nucleus={nucleus}\n              preferences={preferences}\n            />\n          </ReactCardFlip>\n        </div>\n      </div>\n    </>\n  );\n}\n\nexport default RangesWrapper(memo(RangesTablePanel));\n","import { forwardRef } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\n\nfunction SpectraWraper(WrappedComponent) {\n  const Wrapper = (props) => {\n    const { data, activeSpectrum, activeTab, displayerMode } = useChartData();\n\n    const { forwardedRef, ...rest } = props;\n    return (\n      <WrappedComponent\n        {...rest}\n        data={data}\n        activeSpectrum={activeSpectrum}\n        activeTab={activeTab}\n        displayerMode={displayerMode}\n        ref={forwardedRef}\n      />\n    );\n  };\n\n  return forwardRef((props, ref) => {\n    return <Wrapper {...props} forwardedRef={ref} />;\n  });\n}\nexport default SpectraWraper;\n","import { SvgNmrSameTop, SvgNmrResetScale } from 'cheminfo-font';\nimport React, { memo, useCallback } from 'react';\nimport {\n  FaCreativeCommonsSamplingPlus,\n  FaEye,\n  FaEyeSlash,\n} from 'react-icons/fa';\n\nimport { useDispatch } from '../../context/DispatchContext';\nimport ToolTip from '../../elements/ToolTip/ToolTip';\nimport { useAlert } from '../../elements/popup/Alert';\nimport { useModal } from '../../elements/popup/Modal';\nimport SpectraWraper from '../../hoc/SpectraWraper';\nimport { DISPLAYER_MODE } from '../../reducer/core/Constants';\nimport {\n  ADD_MISSING_PROJECTION,\n  CHANGE_VISIBILITY,\n  DELETE_SPECTRA,\n  RESET_SPECTRA_SCALE,\n  SET_SPECTRA_SAME_TOP,\n} from '../../reducer/types/Types';\nimport DefaultPanelHeader from '../header/DefaultPanelHeader';\n\nfunction SpectraPanelHeader({\n  data,\n  activeSpectrum,\n  activeTab,\n  displayerMode,\n  spectrums,\n}) {\n  const modal = useModal();\n  const alert = useAlert();\n  const dispatch = useDispatch();\n\n  const handleDelete = useCallback(() => {\n    modal.showConfirmDialog('All records will be deleted, Are You sure?', {\n      onYes: () => {\n        dispatch({ type: DELETE_SPECTRA });\n      },\n    });\n  }, [dispatch, modal]);\n\n  const showAllSpectrumsHandler = useCallback(() => {\n    const spectrumsPerTab = spectrums.map((datum) => {\n      return datum.id;\n    });\n    dispatch({ type: CHANGE_VISIBILITY, id: spectrumsPerTab });\n  }, [dispatch, spectrums]);\n\n  const hideAllSpectrumsHandler = useCallback(() => {\n    dispatch({ type: CHANGE_VISIBILITY, id: [] });\n  }, [dispatch]);\n\n  const addMissingProjectionHandler = useCallback(() => {\n    function getMissingProjection(SpectrumsData) {\n      let nucleus = activeTab.split(',');\n      nucleus = nucleus[0] === nucleus[1] ? [nucleus[0]] : nucleus;\n      const missingNucleus = [];\n      for (const n of nucleus) {\n        const hasSpectrums = SpectrumsData.some((d) => d.info.nucleus === n);\n        if (!hasSpectrums) {\n          missingNucleus.push(n);\n        }\n      }\n      return missingNucleus;\n    }\n    const missingNucleus = getMissingProjection(data);\n    if (missingNucleus.length > 0) {\n      dispatch({ type: ADD_MISSING_PROJECTION, nucleus: missingNucleus });\n    } else {\n      alert.error('Nothing to calculate');\n    }\n  }, [activeTab, alert, data, dispatch]);\n\n  const setSameTopHandler = useCallback(() => {\n    dispatch({ type: SET_SPECTRA_SAME_TOP });\n  }, [dispatch]);\n  const resetScaleHandler = useCallback(() => {\n    dispatch({ type: RESET_SPECTRA_SCALE });\n  }, [dispatch]);\n\n  return (\n    <DefaultPanelHeader\n      onDelete={handleDelete}\n      counter={spectrums && spectrums.length}\n      deleteToolTip=\"Delete all spectra\"\n    >\n      <ToolTip title=\"Hide all spectra\" popupPlacement=\"right\">\n        <button type=\"button\" onClick={hideAllSpectrumsHandler}>\n          <FaEyeSlash />\n        </button>\n      </ToolTip>\n      <ToolTip title=\"Show all spectra\" popupPlacement=\"right\">\n        <button type=\"button\" onClick={showAllSpectrumsHandler}>\n          <FaEye />\n        </button>\n      </ToolTip>\n      {activeSpectrum && activeTab && activeTab.split(',').length > 1 && (\n        <ToolTip title=\"Add missing projection\" popupPlacement=\"right\">\n          <button type=\"button\" onClick={addMissingProjectionHandler}>\n            <FaCreativeCommonsSamplingPlus />\n          </button>\n        </ToolTip>\n      )}\n      {displayerMode === DISPLAYER_MODE.DM_1D && (\n        <>\n          <ToolTip title=\"Reset Scale\" popupPlacement=\"right\">\n            <button type=\"button\" onClick={resetScaleHandler}>\n              <SvgNmrResetScale />\n            </button>\n          </ToolTip>\n          <ToolTip title=\"Same Top\" popupPlacement=\"right\">\n            <button type=\"button\" onClick={setSameTopHandler}>\n              <SvgNmrSameTop />\n            </button>\n          </ToolTip>\n        </>\n      )}\n    </DefaultPanelHeader>\n  );\n}\n\nexport default SpectraWraper(memo(SpectraPanelHeader));\n","function getNucleusSum(input) {\n  const nucleus = input.split(',');\n  return nucleus.reduce((acc, i) => {\n    const additions = nucleus.length === 2 ? 100 : 0;\n    acc += Number(i.replace(/\\D/g, '')) + additions;\n    return acc;\n  }, 0);\n}\nconst GroupByInfoKey = (key) => (array, orderByNucleus = false) => {\n  const unorderedGroup = array.reduce((objectsByKeyValue, obj) => {\n    const value = obj.info[key];\n    objectsByKeyValue[value] = (objectsByKeyValue[value] || []).concat(obj);\n    return objectsByKeyValue;\n  }, {});\n\n  if (!orderByNucleus) {\n    return unorderedGroup;\n  } else {\n    return Object.keys(unorderedGroup)\n      .sort((a, b) => getNucleusSum(a) - getNucleusSum(b))\n      .reduce((acc, key) => {\n        acc[key] = unorderedGroup[key];\n        return acc;\n      }, {});\n  }\n};\n\nexport default GroupByInfoKey;\n","import { memo } from 'react';\n\nfunction ColorIndicator1D({ color, activated }) {\n  return (\n    <div\n      style={{\n        backgroundColor: color,\n        height: '12px',\n        width: '12px',\n        opacity: activated ? 1 : 0.1,\n        display: 'inline-block',\n      }}\n    />\n  );\n}\nfunction ColorIndicator2D({ positiveColor, negativeColor, activated }) {\n  return (\n    <svg\n      width=\"12\"\n      height=\"12\"\n      viewBox=\"0 0 12 12\"\n      opacity={activated ? 1 : 0.1}\n    >\n      <g>\n        <path d=\"M0,0H12L0,12Z\" fill={positiveColor} strokeWidth=\"0\" />\n        <path d=\"M12,12H0L12,0Z\" fill={negativeColor} strokeWidth=\"0\" />\n      </g>\n    </svg>\n  );\n}\n\nfunction ColorIndicator({ dimension, color, activated, onClick, style }) {\n  return (\n    <button style={style} type=\"button\" onClick={onClick}>\n      {dimension === 2 ? (\n        <ColorIndicator2D {...color} activated={activated} />\n      ) : (\n        <ColorIndicator1D activated={activated} {...color} />\n      )}\n    </button>\n  );\n}\n\nexport default memo(ColorIndicator);\n","import { SvgNmrPeaks } from 'cheminfo-font';\nimport React from 'react';\n\nfunction ShowHideMarkersButton({\n  data,\n  onChangeMarkersVisibility,\n  markersVisible,\n  style,\n}) {\n  const isMarkerVisible = (id) => {\n    return markersVisible.findIndex((v) => v.id === id) !== -1 ? true : false;\n  };\n\n  return (\n    <button\n      style={{\n        ...style,\n        opacity:\n          isMarkerVisible(data.id) && data.peaks && data.peaks.values.length > 0\n            ? 1\n            : 0.1,\n      }}\n      type=\"button\"\n      onClick={() => onChangeMarkersVisibility(data)}\n      disabled={data.peaks && data.peaks.values.length === 0}\n    >\n      <SvgNmrPeaks />\n    </button>\n  );\n}\n\nexport default ShowHideMarkersButton;\n","import React from 'react';\nimport { FaEye } from 'react-icons/fa';\n\nfunction ShowHideSpectrumButton({ data, onChangeVisibility, style }) {\n  const isVisible = (id, key) => {\n    return data ? data.display[key] : true;\n  };\n  return (\n    <>\n      {data.info.dimension === 1 && (\n        <button\n          style={style}\n          type=\"button\"\n          onClick={() => onChangeVisibility(data, 'isVisible')}\n        >\n          <FaEye\n            style={{\n              fill: data.display.color,\n\n              ...(isVisible(data.id, 'isVisible')\n                ? {\n                    opacity: 1,\n                    strokeWidth: '1px',\n                    fill: data.display.color,\n                  }\n                : {\n                    opacity: 0.1,\n                    fill: data.display.color,\n                  }),\n            }}\n          />\n        </button>\n      )}\n      {data.info.dimension === 2 && (\n        <div style={{ minWidth: '40px' }}>\n          <button\n            style={{ ...style, width: '20px', minWidth: '20px' }}\n            type=\"button\"\n            onClick={() => onChangeVisibility(data, 'isPositiveVisible')}\n          >\n            <FaEye\n              style={{\n                fill: data.display.positiveColor,\n                ...(isVisible(data.id, 'isPositiveVisible')\n                  ? {\n                      opacity: 1,\n                      strokeWidth: '1px',\n                      fill: data.display.positiveColor,\n                    }\n                  : {\n                      opacity: 0.1,\n                      fill: data.display.positiveColor,\n                    }),\n              }}\n            />\n          </button>\n          <button\n            style={{ ...style, width: '20px', minWidth: '20px' }}\n            type=\"button\"\n            onClick={() => onChangeVisibility(data, 'isNegativeVisible')}\n          >\n            <FaEye\n              style={{\n                fill: data.display.negativeColor,\n                ...(isVisible(data.id, 'isNegativeVisible')\n                  ? {\n                      opacity: 1,\n                      strokeWidth: '1px',\n                      fill: data.display.negativeColor,\n                    }\n                  : {\n                      opacity: 0.1,\n                      fill: data.display.negativeColor,\n                    }),\n              }}\n            />\n          </button>\n        </div>\n      )}\n    </>\n  );\n}\n\nexport default ShowHideSpectrumButton;\n","import { SvgNmrFid, SvgNmrFt, SvgNmr2D } from 'cheminfo-font';\nimport { memo } from 'react';\n\nimport ColorIndicator from './base/ColorIndicator';\nimport ShowHideMarkersButton from './base/ShowHideMarkersButton';\nimport ShowHideSpectrumButton from './base/ShowHideSpectrumButton';\n\nconst styles = {\n  button: {\n    backgroundColor: 'transparent',\n    border: 'none',\n    width: '26px',\n    minWidth: '26px',\n  },\n  row: {\n    display: 'flex',\n    alignContent: 'center',\n    height: '25px',\n    borderBottom: '0.55px solid #f1f1f1',\n  },\n  name: {\n    flex: 1,\n    height: '100%',\n    display: 'flex',\n  },\n  info: {\n    flex: '1 1 1px',\n    height: '100%',\n    display: 'block',\n    alignItems: 'center',\n    overflow: 'hidden',\n    textOverflow: 'ellipsis',\n    whiteSpace: 'nowrap',\n    lineHeight: '24px',\n  },\n  icon: {\n    display: 'flex',\n    margin: 'auto',\n    justifyContent: 'center',\n  },\n};\n\nfunction SpectrumListItem({\n  activeSpectrum,\n  markersVisible,\n  data,\n  onChangeVisibility,\n  onChangeMarkersVisibility,\n  onChangeActiveSpectrum,\n  onOpenSettingModal,\n  onContextMenu,\n}) {\n  const formatValueAsHTML = (value) => {\n    if (value) {\n      // eslint-disable-next-line prefer-named-capture-group\n      value = value.replace(/([0-9]+)/g, '<sub>$1</sub>');\n    }\n    return value;\n  };\n  const activated = activeSpectrum && activeSpectrum.id === data.id;\n  const { color, name, positiveColor, negativeColor } = data.display;\n  return (\n    <div\n      style={{\n        ...styles.row,\n        ...(activated\n          ? { backgroundColor: '#fafafa' }\n          : { opacity: activeSpectrum ? 0.2 : 1 }),\n      }}\n      onContextMenu={onContextMenu}\n    >\n      <ShowHideSpectrumButton\n        data={data}\n        onChangeVisibility={onChangeVisibility}\n        style={styles.button}\n      />\n\n      <div style={styles.name} onClick={() => onChangeActiveSpectrum(data)}>\n        <div style={{ ...styles.icon, width: '16px' }}>\n          {data.info.isFid ? (\n            <SvgNmrFid />\n          ) : data.info.dimension === 2 ? (\n            <SvgNmr2D />\n          ) : (\n            <SvgNmrFt />\n          )}\n        </div>\n        <span style={styles.info}>{name}</span>\n        <div\n          style={styles.info}\n          // eslint-disable-next-line react/no-danger\n          dangerouslySetInnerHTML={{\n            __html: data.info && formatValueAsHTML(data.info.solvent),\n          }}\n        />\n        <span style={styles.info}>\n          <span\n            style={{\n              borderLeft: '0.55px solid #e5e5e5',\n              paddingRight: '5px',\n            }}\n          />\n          {data.info && data.info.experiment}\n        </span>\n\n        {/* {data.info && data.info.solvent} */}\n        {/* </div> */}\n        <span style={styles.info}>{data.info && data.info.pulse}</span>\n      </div>\n\n      <ShowHideMarkersButton\n        data={data}\n        style={{\n          ...styles.icon,\n          ...styles.button,\n        }}\n        onChangeMarkersVisibility={onChangeMarkersVisibility}\n        markersVisible={markersVisible}\n      />\n      <ColorIndicator\n        style={styles.button}\n        dimension={data.info.dimension}\n        color={{ positiveColor, color, negativeColor }}\n        activated={activated}\n        onClick={(event) => onOpenSettingModal(data, event)}\n      />\n    </div>\n  );\n}\n\nSpectrumListItem.defaultProps = {\n  onContextMenu: () => null,\n};\n\nexport default memo(SpectrumListItem);\n","import { useFormikContext } from 'formik';\nimport lodashGet from 'lodash/get';\nimport { useCallback, memo } from 'react';\nimport { SketchPicker } from 'react-color';\n\nimport { COLORS } from '../../../data/utilities/getColor';\n\nfunction FormikColorPicker({ onColorChange, name, ...props }) {\n  const { values, setFieldValue } = useFormikContext();\n\n  const colorchangeHandler = useCallback(\n    (color) => {\n      onColorChange(color);\n      setFieldValue(\n        name,\n        `${color.hex}${Math.round(color.rgb.a * 255).toString(16)}`,\n      );\n    },\n    [name, onColorChange, setFieldValue],\n  );\n\n  return (\n    <SketchPicker\n      color={{ hex: lodashGet(values, name, '#000') }}\n      presetColors={COLORS}\n      onChangeComplete={(e) => colorchangeHandler(e)}\n      {...props}\n    />\n  );\n}\n\nFormikColorPicker.defaultProps = {\n  onColorChange: () => null,\n};\n\nexport default memo(FormikColorPicker);\n","import { useCallback, useRef } from 'react';\n\nimport FormikColorPicker from '../../../../elements/formik/FormikColorPicker';\nimport FormikForm from '../../../../elements/formik/FormikForm';\n\nfunction Spectrum1DSetting({ data, onSubmit }) {\n  const refForm = useRef();\n\n  const triggerSubmitHandler = useCallback(() => {\n    if (refForm.current) {\n      refForm.current.submitForm();\n    }\n  }, []);\n\n  return (\n    <FormikForm ref={refForm} initialValues={data} onSubmit={onSubmit}>\n      <div>\n        <FormikColorPicker name=\"color\" onColorChange={triggerSubmitHandler} />\n      </div>\n    </FormikForm>\n  );\n}\n\nexport default Spectrum1DSetting;\n","import { useFormikContext } from 'formik';\nimport lodashGet from 'lodash/get';\nimport { useCallback, memo } from 'react';\nimport ReactSlider from 'react-slider';\n\nfunction FormikSlider({ onAfterChange, name, ...props }) {\n  const { values, setFieldValue } = useFormikContext();\n\n  const changeHandler = useCallback(\n    (value) => {\n      onAfterChange(value);\n      setFieldValue(name, value);\n    },\n    [name, onAfterChange, setFieldValue],\n  );\n\n  return (\n    <ReactSlider\n      className=\"horizontal-slider\"\n      thumbClassName=\"thumb\"\n      trackClassName=\"track\"\n      defaultValue={lodashGet(values, name, [0, 100])}\n      onAfterChange={changeHandler}\n      // ariaLabel={['Lower thumb', 'Upper thumb']}\n      // ariaValuetext={(state) => ` ${state.valueNow}`}\n      renderThumb={(props, state) => (\n        <div {...props}>\n          <span>{state.valueNow}</span>\n        </div>\n      )}\n      pearling\n      minDistance={10}\n      {...props}\n    />\n  );\n}\n\nFormikSlider.defaultProps = {\n  onColorChange: () => null,\n};\n\nexport default memo(FormikSlider);\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback, useRef } from 'react';\n\nimport FormikColorPicker from '../../../../elements/formik/FormikColorPicker';\nimport FormikForm from '../../../../elements/formik/FormikForm';\nimport FormikInput from '../../../../elements/formik/FormikInput';\nimport FormikSlider from '../../../../elements/formik/FormikSlider';\n\nfunction Spectrum2DSetting({ data, onSubmit }) {\n  const refForm = useRef();\n\n  const style = css`\n    .positive {\n      display: inline-block;\n      .track-1 {\n        background-color: ${data.positiveColor} !important;\n      }\n    }\n    .negative {\n      display: inline-block;\n\n      .track-1 {\n        background-color: ${data.negativeColor} !important;\n      }\n    }\n  `;\n\n  const triggerSubmitHandler = useCallback(() => {\n    refForm.current.submitForm();\n  }, []);\n\n  return (\n    <FormikForm ref={refForm} initialValues={data} onSubmit={onSubmit}>\n      <div css={style}>\n        <div className=\"positive\">\n          <span style={{ padding: '0 10px' }}>Positive</span>\n          <FormikColorPicker\n            name=\"positiveColor\"\n            onColorChange={triggerSubmitHandler}\n          />\n          <div style={{ padding: '5px' }}>\n            <span className=\"label\">contour Levels [ min - max ]</span>\n            <FormikSlider\n              name=\"contourOptions.positive.contourLevels\"\n              onAfterChange={triggerSubmitHandler}\n            />\n            <span className=\"label\">number of Layers </span>\n            <FormikInput\n              name=\"contourOptions.positive.numberOfLayers\"\n              onChange={triggerSubmitHandler}\n              type=\"number\"\n            />\n          </div>\n        </div>\n        <div className=\"negative\">\n          <span style={{ padding: '0 10px' }}>Negative</span>\n          <FormikColorPicker\n            name=\"negativeColor\"\n            onColorChange={triggerSubmitHandler}\n          />\n          <div style={{ padding: '5px' }}>\n            <span className=\"label\">contour Levels [ min - max ]</span>\n            <FormikSlider\n              name=\"contourOptions.negative.contourLevels\"\n              onAfterChange={triggerSubmitHandler}\n            />\n            <span className=\"label\">number of Layers </span>\n            <FormikInput\n              name=\"contourOptions.negative.numberOfLayers\"\n              onChange={triggerSubmitHandler}\n              type=\"number\"\n            />\n          </div>\n        </div>\n      </div>\n    </FormikForm>\n  );\n}\n\nexport default Spectrum2DSetting;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { memo, useCallback } from 'react';\n\nimport { useDispatch } from '../../../../context/DispatchContext';\nimport { CHANGE_SPECTRUM_SETTING } from '../../../../reducer/types/Types';\n\nimport Spectrum1DSetting from './Spectrum1DSetting';\nimport Spectrum2DSetting from './Spectrum2DSetting';\n\nconst style = css`\n  position: fixed;\n  z-index: 999999999;\n  width:100%;\n  height:100%;\n  left:0;\n  top:0;\n  .ineer-conatiner{\n    position:absolute;\n    display: flex;\n    flex-direction: row-reverse;\n    border-radius: 4px;\n    background-color: white;\n    box-shadow: rgba(0, 0, 0, 0.15) 0px 0px 0px 1px,\n      rgba(0, 0, 0, 0.15) 0px 8px 16px;\n      overflow: auto;\n      height: 350px;\n  }\n\n\n  .sketch-picker {\n    border-radius: none !important;\n    box-shadow: none !important;\n  }\n\n\n  .horizontal-slider {\n    width: 80%;\n    height: 15px;\n  }\n\n  .thumb {\n    height: 15px;\n    line-height: 15px;\n    width: 20px;\n    text-align: center;\n    color: black;\n    border-radius: 5px;\n    cursor: grab;\n    font-size: 10px;\n    background-image: -webkit-linear-gradient(top, #f4f1ee, #fff);\n    background-image: linear-gradient(top, #f4f1ee, #fff);\n  }\n\n  .track {\n    top: 0;\n    bottom: 0;\n    background: #eaeaea;\n    border-radius: 999px;\n    border-radius: 5px;\n  }\n\n  .track-1 {\n    background: red;\n  }\n   \n  .label{\n    font-size: 12px;\n    margin: 8px 0;\n    display: block;\n  }\n \n  }\n`;\nfunction SpectrumSetting({ position, data: { id, info, display }, onClose }) {\n  const dispatch = useDispatch();\n\n  const submitHandler = useCallback(\n    (values) => {\n      dispatch({ type: CHANGE_SPECTRUM_SETTING, id, display: values });\n    },\n    [dispatch, id],\n  );\n\n  const clickHandler = useCallback(\n    (e) => {\n      if (e.target === e.currentTarget) {\n        onClose();\n      }\n    },\n    [onClose],\n  );\n\n  const { x, y } = position;\n  return (\n    <div css={style} onClick={clickHandler}>\n      <div\n        className=\"ineer-conatiner\"\n        style={{\n          left: info.dimension === 2 ? x - 450 : x - 220,\n          padding: info.dimension === 2 ? '10px 0' : '',\n          top: y,\n        }}\n      >\n        {info.dimension === 2 ? (\n          <Spectrum2DSetting onSubmit={submitHandler} data={display} />\n        ) : (\n          <Spectrum1DSetting onSubmit={submitHandler} data={display} />\n        )}\n      </div>\n    </div>\n  );\n}\n\nfunction arePropsEqual() {\n  return true;\n}\n\nexport default memo(SpectrumSetting, arePropsEqual);\n","import {\n  useCallback,\n  useState,\n  useMemo,\n  useRef,\n  Fragment,\n  useEffect,\n} from 'react';\n\nimport checkModifierKeyActivated from '../../../data/utilities/checkModifierKeyActivated';\nimport { useDispatch } from '../../context/DispatchContext';\nimport ContextMenu from '../../elements/ContextMenu';\nimport { Tabs } from '../../elements/Tab';\nimport { useAlert } from '../../elements/popup/Alert';\nimport SpectraWraper from '../../hoc/SpectraWraper';\nimport {\n  CHANGE_PEAKS_MARKERS_VISIBILITY,\n  SET_ACTIVE_TAB,\n  CHANGE_VISIBILITY,\n  CHANGE_ACTIVE_SPECTRUM,\n  DELETE_SPECTRA,\n} from '../../reducer/types/Types';\nimport { copyTextToClipboard } from '../../utility/Export';\nimport GroupByInfoKey from '../../utility/GroupByInfoKey';\n\nimport SpectrumListItem from './SpectrumListItem';\nimport SpectrumSetting from './base/setting/SpectrumSetting';\n\nfunction SpectrumsTabs({ data, activeSpectrum, activeTab, onTabChange }) {\n  const contextRef = useRef();\n  const [markersVisible, setMarkersVisible] = useState([]);\n  const [selectedSpectrumData, setSelectedSpectrum] = useState(null);\n  const [settingModalPosition, setSettingModalPosition] = useState(null);\n  const [isSettingModalDisplayed, setIsSettingModalDisplayed] = useState(false);\n\n  const alert = useAlert();\n  const dispatch = useDispatch();\n\n  useEffect(() => {\n    if (data) {\n      const visibleMarkers = data\n        ? data.filter((d) => d.display.isPeaksMarkersVisible === true)\n        : [];\n\n      setMarkersVisible(visibleMarkers);\n    }\n  }, [data, dispatch]);\n\n  const spectrumsGroupByNucleus = useMemo(() => {\n    if (!data) return [];\n    const groupByNucleus = GroupByInfoKey('nucleus');\n    return groupByNucleus(data, true);\n  }, [data]);\n\n  useEffect(() => {\n    onTabChange({\n      tab: activeTab,\n      data: spectrumsGroupByNucleus[activeTab],\n    });\n  }, [activeTab, onTabChange, spectrumsGroupByNucleus]);\n\n  const handleChangeMarkersVisibility = useCallback(\n    (d) => {\n      const currentIndex = markersVisible.findIndex((v) => v.id === d.id);\n      const newChecked = [...markersVisible];\n      if (currentIndex === -1) {\n        newChecked.push({ id: d.id });\n      } else {\n        newChecked.splice(currentIndex, 1);\n      }\n      dispatch({ type: CHANGE_PEAKS_MARKERS_VISIBILITY, data: newChecked });\n      setMarkersVisible(newChecked);\n    },\n    [dispatch, markersVisible],\n  );\n\n  const onTabChangeHandler = useCallback(\n    (tab) => {\n      onTabChange({\n        tab: tab.tabid,\n        data: spectrumsGroupByNucleus[tab.tabid],\n      });\n\n      dispatch({ type: SET_ACTIVE_TAB, tab: tab.tabid });\n    },\n    [dispatch, onTabChange, spectrumsGroupByNucleus],\n  );\n\n  const contextMenu = useMemo(\n    () => [\n      {\n        label: 'Copy to Clipboard',\n        onClick: (spectrumData) => {\n          const { x, y, info } = spectrumData;\n          const success = copyTextToClipboard(\n            JSON.stringify({ x, y, info }, undefined, 2),\n          );\n\n          if (success) {\n            alert.success('Data copied to clipboard');\n          } else {\n            alert.error('Copy to clipboard failed');\n          }\n        },\n      },\n      {\n        label: 'Delete',\n        onClick: (spectrumData) => {\n          setTimeout(() => {\n            dispatch({ type: DELETE_SPECTRA, id: spectrumData.id });\n          }, 0);\n        },\n      },\n    ],\n    [alert, dispatch],\n  );\n\n  const contextMenuHandler = useCallback(\n    (e, rowData) => {\n      if (!checkModifierKeyActivated(e)) {\n        e.preventDefault();\n        contextRef.current.handleContextMenu(e, rowData);\n      }\n    },\n    [contextRef],\n  );\n\n  const openSettingHandler = useCallback((selectedSpectrum, event) => {\n    setSettingModalPosition({\n      x: event.nativeEvent.clientX,\n      y: event.nativeEvent.clientY,\n    });\n    setSelectedSpectrum(selectedSpectrum);\n    setIsSettingModalDisplayed(true);\n  }, []);\n\n  const handleChangeVisibility = useCallback(\n    (d, key) => {\n      dispatch({\n        type: CHANGE_VISIBILITY,\n        id: d.id,\n        key,\n        value: !d.display[key],\n      });\n    },\n    [dispatch],\n  );\n\n  const handleChangeActiveSpectrum = useCallback(\n    (d) => {\n      setTimeout(() => {\n        if (activeSpectrum && activeSpectrum.id === d.id) {\n          dispatch({ type: CHANGE_ACTIVE_SPECTRUM, data: null });\n        } else {\n          dispatch({ type: CHANGE_ACTIVE_SPECTRUM, data: { id: d.id } });\n        }\n      }, 0);\n    },\n    [activeSpectrum, dispatch],\n  );\n\n  const mouseLeaveHandler = useCallback(() => {\n    setIsSettingModalDisplayed(false);\n  }, []);\n\n  return (\n    <Fragment>\n      <Tabs defaultTabID={activeTab} onClick={onTabChangeHandler}>\n        {spectrumsGroupByNucleus &&\n          Object.keys(spectrumsGroupByNucleus).map((group) => (\n            <div\n              tablabel={group}\n              tabid={group}\n              key={group}\n              style={{ overflow: 'auto', height: '100%' }}\n            >\n              {spectrumsGroupByNucleus[group] &&\n                spectrumsGroupByNucleus[group].map((d) => (\n                  <SpectrumListItem\n                    key={d.id}\n                    activeSpectrum={activeSpectrum}\n                    // activated={\n                    //   activeSpectrum && activeSpectrum.id === d.id\n                    //     ? true\n                    //     : false\n                    // }\n                    markersVisible={markersVisible}\n                    data={d}\n                    onChangeVisibility={handleChangeVisibility}\n                    onChangeMarkersVisibility={handleChangeMarkersVisibility}\n                    onChangeActiveSpectrum={handleChangeActiveSpectrum}\n                    onOpenSettingModal={openSettingHandler}\n                    onContextMenu={(e) => contextMenuHandler(e, d)}\n                  />\n                ))}\n            </div>\n          ))}\n      </Tabs>\n      <ContextMenu ref={contextRef} context={contextMenu} />\n\n      {isSettingModalDisplayed ? (\n        <SpectrumSetting\n          onClose={mouseLeaveHandler}\n          data={selectedSpectrumData}\n          position={settingModalPosition}\n        />\n      ) : null}\n    </Fragment>\n  );\n}\n\nexport default SpectraWraper(SpectrumsTabs);\n","import React, { useCallback, memo, useState } from 'react';\n\nimport SpectraPanelHeader from './SpectraPanelHeader';\nimport SpectrumsTabs from './SpectrumsTabs';\n\nconst styles = {\n  overflow: 'hidden',\n  height: '100%',\n  display: 'flex',\n  flexDirection: 'column',\n};\n\nfunction SpectrumListPanel({\n  data,\n  activeSpectrum,\n  activeTab: activeTabState,\n}) {\n  const [spectrums, setSpectrums] = useState([]);\n\n  const tabChangeHandler = useCallback((e) => {\n    setSpectrums(e.data ? e.data : []);\n  }, []);\n\n  return (\n    <div style={styles}>\n      <SpectraPanelHeader spectrums={spectrums} />\n      <SpectrumsTabs\n        onTabChange={tabChangeHandler}\n        data={data}\n        activeSpectrum={activeSpectrum}\n        activeTab={activeTabState}\n      />\n    </div>\n  );\n}\n\nexport default memo(SpectrumListPanel);\n","// error colors in priority order\nconst ErrorColors = [\n  { key: 'outOfLimit', color: 'red' },\n  { key: 'ambiguousAttachment', color: 'orange' },\n  { key: 'notAttached', color: 'blue' },\n  { key: 'incomplete', color: 'red' },\n];\n\nconst Errors = ErrorColors.map((errorColor) => errorColor.key);\n\nconst Hybridizations = [\n  {\n    key: '-',\n    label: '',\n    value: '',\n  },\n  {\n    key: 'sp',\n    label: 'sp',\n    value: 'SP',\n  },\n  {\n    key: 'sp2',\n    label: 'sp2',\n    value: 'SP2',\n  },\n  {\n    key: 'sp3',\n    label: 'sp3',\n    value: 'SP3',\n  },\n];\n\nconst DefaultTolerance = {\n  C: 0.25,\n  H: 0.02,\n  N: 0.25,\n  F: 0.25,\n  Si: 0.25,\n  P: 0.25,\n};\n\nexport { DefaultTolerance, Errors, ErrorColors, Hybridizations };\n","import lodashGet from 'lodash/get';\n\nimport { ErrorColors, Errors } from './CorrelationTable/Constants';\n\nfunction getAtomType(nucleus) {\n  return nucleus.split(/\\d+/)[1];\n}\n\nfunction getLabelColor(correlationData, correlation) {\n  const error = lodashGet(\n    correlationData,\n    `state.${correlation.atomType}.error`,\n    null,\n  );\n  if (error) {\n    for (let errorIndex in Errors) {\n      if (\n        ErrorColors[errorIndex].key !== 'incomplete' && // do not consider this for a single atom type\n        (ErrorColors[errorIndex].key === 'notAttached' ||\n          ErrorColors[errorIndex].key === 'ambiguousAttachment') &&\n        lodashGet(error, `${ErrorColors[errorIndex].key}`, []).some(\n          (index) => correlationData.values[index].id === correlation.id,\n        )\n      ) {\n        return ErrorColors[errorIndex].color;\n      }\n    }\n  }\n\n  return null;\n}\n\nfunction findSpectrum(spectraData, value) {\n  return spectraData.filter(\n    (_spectrum) =>\n      _spectrum.id === value.experimentID &&\n      _spectrum.display.isVisible === true,\n  )[0];\n}\n\nfunction findSignal(spectrum, value) {\n  for (let i = 0; i < spectrum.zones.values.length; i++) {\n    const signalIndex = spectrum.zones.values[i].signal.findIndex(\n      (_signal) => _signal.id === value.signal.id,\n    );\n    if (signalIndex >= 0) {\n      return spectrum.zones.values[i].signal[signalIndex];\n    }\n  }\n}\n\nfunction findRange(spectrum, value) {\n  for (let i = 0; i < spectrum.ranges.values.length; i++) {\n    const signalIndex = spectrum.ranges.values[i].signal.findIndex(\n      (_signal) => _signal.id === value.signal.id,\n    );\n    if (signalIndex >= 0) {\n      return spectrum.ranges.values[i];\n    }\n  }\n}\n\nfunction findZone(spectrum, value) {\n  for (let i = 0; i < spectrum.zones.values.length; i++) {\n    const signalIndex = spectrum.zones.values[i].signal.findIndex(\n      (_signal) => _signal.id === value.signal.id,\n    );\n    if (signalIndex >= 0) {\n      return spectrum.zones.values[i];\n    }\n  }\n}\n\nconst findRangeOrZoneID = (spectraData, value) => {\n  const spectrum = findSpectrum(spectraData, value);\n  if (spectrum) {\n    if (spectrum.info.dimension === 1) {\n      const range = findRange(spectrum, value);\n      if (range) return range.id;\n    } else if (spectrum.info.dimension === 2) {\n      const zone = findZone(spectrum, value);\n      if (zone) return zone.id;\n    }\n  }\n};\n\nfunction findSignalMatch1D(spectrum, link, factor, xDomain0, xDomain1) {\n  if (spectrum && spectrum.info.dimension === 2) {\n    const signal = findSignal(spectrum, link);\n    if (signal) {\n      const otherAxis = link.axis === 'x' ? 'y' : 'x';\n      return (\n        signal[otherAxis].delta * factor >= xDomain0 &&\n        signal[otherAxis].delta * factor <= xDomain1\n      );\n    }\n  }\n  return false;\n}\nfunction findSignalMatch2D(\n  spectrum,\n  value,\n  factor,\n  xDomain0,\n  xDomain1,\n  yDomain0,\n  yDomain1,\n) {\n  if (spectrum && spectrum.info.dimension === 2) {\n    const signal = findSignal(spectrum, value);\n    if (signal) {\n      return (\n        signal.x.delta * factor >= xDomain0 &&\n        signal.x.delta * factor <= xDomain1 &&\n        signal.y.delta * factor >= yDomain0 &&\n        signal.y.delta * factor <= yDomain1\n      );\n    }\n  }\n  return false;\n}\n\nexport {\n  findRange,\n  findRangeOrZoneID,\n  findSignalMatch1D,\n  findSignalMatch2D,\n  findSpectrum,\n  findZone,\n  getAtomType,\n  getLabelColor,\n};\n","/** @jsxImportSource @emotion/react */\nimport { useCallback, useMemo } from 'react';\n\nimport { buildID } from '../../../../data/utilities/Concatenation';\nimport { useHighlight } from '../../../highlight';\nimport { findRangeOrZoneID, getLabelColor } from '../Utilities';\n\nfunction AdditionalColumnHeader({\n  spectraData,\n  correlationsData,\n  correlation,\n}) {\n  const highlightIDsAdditionalColumn = useMemo(() => {\n    if (correlation.pseudo === true) {\n      return [];\n    }\n    const ids = [\n      correlation.signal.id,\n      buildID(correlation.signal.id, 'Crosshair_X'),\n    ];\n    const id = findRangeOrZoneID(spectraData, correlation);\n    if (id) {\n      ids.push(id);\n    }\n    correlation.link.forEach((link) => {\n      if (link.pseudo === false) {\n        ids.push(link.signal.id);\n        ids.push(buildID(link.signal.id, 'Crosshair_X'));\n        const _id = findRangeOrZoneID(spectraData, link);\n        if (_id) {\n          ids.push(_id);\n        }\n      }\n    });\n\n    return ids;\n  }, [correlation, spectraData]);\n  const highlightAdditionalColumn = useHighlight(highlightIDsAdditionalColumn);\n\n  const mouseEnterHandler = useCallback(\n    (event) => {\n      event.currentTarget.focus();\n      highlightAdditionalColumn.show();\n    },\n    [highlightAdditionalColumn],\n  );\n  const mouseLeaveHandler = useCallback(\n    (event) => {\n      event.currentTarget.blur();\n      highlightAdditionalColumn.hide();\n    },\n    [highlightAdditionalColumn],\n  );\n\n  const tableHeaderProps = useMemo(() => {\n    return {\n      style: {\n        ...{ color: getLabelColor(correlationsData, correlation) },\n        backgroundColor: highlightAdditionalColumn.isActive\n          ? '#ff6f0057'\n          : 'inherit',\n      },\n      title:\n        correlation.pseudo === false &&\n        [correlation.experimentType.toUpperCase()]\n          .concat(\n            correlation.link.reduce((arr, link) => {\n              if (\n                link.pseudo === false &&\n                link.experimentType !== correlation.experimentType &&\n                !arr.includes(link.experimentType.toUpperCase())\n              ) {\n                arr.push(link.experimentType.toUpperCase());\n              }\n              return arr;\n            }, []),\n          )\n          .sort()\n          .join('/'),\n      onMouseEnter: mouseEnterHandler,\n      onMouseLeave: mouseLeaveHandler,\n    };\n  }, [\n    correlation,\n    correlationsData,\n    highlightAdditionalColumn.isActive,\n    mouseEnterHandler,\n    mouseLeaveHandler,\n  ]);\n\n  const equivalenceTextStyle = useMemo(() => {\n    return correlation.edited.equivalence\n      ? { backgroundColor: '#F7F2E0' }\n      : {\n          color: Number.isInteger(correlation.equivalence)\n            ? correlation.equivalence === 1\n              ? '#bebebe'\n              : 'black'\n            : 'red',\n        };\n  }, [correlation]);\n\n  return (\n    <th {...tableHeaderProps}>\n      <div style={{ display: 'block' }}>\n        <p>{correlation.label.origin}</p>\n        <p>\n          {correlation && correlation.signal && correlation.signal.delta\n            ? correlation.signal.delta.toFixed(2)\n            : ''}\n        </p>\n        <p style={equivalenceTextStyle}>\n          {Number.isInteger(correlation.equivalence)\n            ? correlation.equivalence\n            : correlation.equivalence.toFixed(2)}\n        </p>\n      </div>\n    </th>\n  );\n}\n\nexport default AdditionalColumnHeader;\n","import lodashCloneDeep from 'lodash/cloneDeep';\nimport {\n  CorrelationUtilities,\n  GeneralUtilities,\n  LinkUtilities,\n} from 'nmr-correlation';\nimport { useCallback, useEffect, useMemo, useRef, useState } from 'react';\n\nimport { buildID } from '../../../../data/utilities/Concatenation';\nimport generateID from '../../../../data/utilities/generateID';\nimport ContextMenu from '../../../elements/ContextMenu';\nimport { useHighlight } from '../../../highlight';\nimport { findRangeOrZoneID } from '../Utilities';\n\nfunction AdditionalColumnField({\n  rowCorrelation,\n  columnCorrelation,\n  commonLinks,\n  correlations,\n  spectraData,\n  onEdit,\n}) {\n  const contextRef = useRef();\n  const [isEdited, setIsEdited] = useState(false);\n\n  const highlightIDsCommonLinks = useMemo(() => {\n    const ids = [];\n    commonLinks.forEach((link) => {\n      if (link.pseudo === false) {\n        ids.push(link.signal.id);\n        ids.push(buildID(link.signal.id, 'Crosshair'));\n        const _id = findRangeOrZoneID(spectraData, link);\n        if (_id) {\n          ids.push(_id);\n        }\n      }\n    });\n\n    return ids;\n  }, [commonLinks, spectraData]);\n  const highlightCommonLinks = useHighlight(highlightIDsCommonLinks);\n\n  const mouseEnterHandler = useCallback(\n    (event) => {\n      event.currentTarget.focus();\n      highlightCommonLinks.show();\n    },\n    [highlightCommonLinks],\n  );\n  const mouseLeaveHandler = useCallback(\n    (event) => {\n      event.currentTarget.blur();\n      highlightCommonLinks.hide();\n    },\n    [highlightCommonLinks],\n  );\n\n  useEffect(() => {\n    if (commonLinks.some((commonLink) => commonLink.pseudo === true)) {\n      setIsEdited(true);\n    } else {\n      setIsEdited(false);\n    }\n  }, [commonLinks]);\n\n  const contextMenuHandler = useCallback(\n    (e, rowData) => {\n      e.preventDefault();\n      contextRef.current.handleContextMenu(e, rowData);\n    },\n    [contextRef],\n  );\n\n  const onEditHandler = useCallback(\n    (experimentType, action, commonLink) => {\n      const _rowCorrelation = lodashCloneDeep(rowCorrelation);\n      const _columnCorrelation = lodashCloneDeep(columnCorrelation);\n      const pseudoLinkCountHSQC = _rowCorrelation.link.filter(\n        (link) =>\n          link.experimentType === 'hsqc' || link.experimentType === 'hmqc',\n      ).length;\n\n      if (action === 'add') {\n        const pseudoLinkID = generateID();\n        const pseudoExperimentID = generateID();\n        const pseudoCommonLink = LinkUtilities.buildLink({\n          experimentType,\n          experimentID: pseudoExperimentID,\n          atomType: [_columnCorrelation.atomType, _rowCorrelation.atomType],\n          id: pseudoLinkID,\n          pseudo: true,\n          signal: { id: generateID(), sign: 0 }, // pseudo signal\n        });\n\n        CorrelationUtilities.addLink(\n          _columnCorrelation,\n          LinkUtilities.buildLink({\n            ...pseudoCommonLink,\n            axis: 'x',\n            match: [\n              GeneralUtilities.getCorrelationIndex(\n                correlations,\n                _rowCorrelation,\n              ),\n            ],\n          }),\n        );\n        CorrelationUtilities.addLink(\n          _rowCorrelation,\n          LinkUtilities.buildLink({\n            ...pseudoCommonLink,\n            axis: 'y',\n            match: [\n              GeneralUtilities.getCorrelationIndex(\n                correlations,\n                _columnCorrelation,\n              ),\n            ],\n          }),\n        );\n        if (!_rowCorrelation.edited.protonsCount) {\n          _rowCorrelation.protonsCount = [pseudoLinkCountHSQC + 1];\n        }\n      } else if (action === 'remove') {\n        CorrelationUtilities.removeLink(_rowCorrelation, commonLink.id);\n        CorrelationUtilities.removeLink(_columnCorrelation, commonLink.id);\n        if (!_rowCorrelation.edited.protonsCount) {\n          _rowCorrelation.protonsCount =\n            pseudoLinkCountHSQC - 1 > 0 ? [pseudoLinkCountHSQC - 1] : [];\n        }\n      }\n\n      onEdit(_rowCorrelation, _columnCorrelation);\n    },\n    [rowCorrelation, onEdit, columnCorrelation, correlations],\n  );\n\n  const contextMenu = useMemo(() => {\n    // allow the edition of pseudo correlations and pseudo HSQC only (for now)\n    // assumption here that only one pseudo HSQC can be added to a pseudo correlation\n    const commonLinkHSQC = commonLinks.find(\n      (commonLink) =>\n        commonLink.experimentType === 'hsqc' && commonLink.pseudo === true,\n    );\n\n    return rowCorrelation.pseudo === true\n      ? commonLinkHSQC\n        ? [\n            {\n              label: 'remove HSQC',\n              onClick: () => {\n                onEditHandler('hsqc', 'remove', commonLinkHSQC);\n              },\n            },\n          ]\n        : [\n            {\n              label: 'add HSQC',\n              onClick: () => {\n                onEditHandler('hsqc', 'add');\n              },\n            },\n          ]\n      : [];\n  }, [commonLinks, onEditHandler, rowCorrelation]);\n\n  const content = useMemo(() => {\n    const linkSet = new Set();\n    commonLinks.forEach((commonLink) => {\n      if (\n        commonLink.experimentType === 'hsqc' ||\n        commonLink.experimentType === 'hmqc'\n      ) {\n        linkSet.add(\n          !commonLink.signal || commonLink.signal.sign === 0\n            ? 'S'\n            : `S${commonLink.signal.sign === 1 ? '+' : '-'}`,\n        );\n      } else if (\n        commonLink.experimentType === 'hmbc' ||\n        commonLink.experimentType === 'cosy' ||\n        commonLink.experimentType === 'tocsy'\n      ) {\n        linkSet.add('M');\n      } else if (\n        commonLink.experimentType === 'noesy' ||\n        commonLink.experimentType === 'roesy'\n      ) {\n        linkSet.add('NOE');\n      }\n    });\n\n    return [...linkSet];\n  }, [commonLinks]);\n\n  const title = useMemo(\n    () =>\n      commonLinks\n        .reduce((arr, link) => {\n          if (!arr.includes(link.experimentType.toUpperCase())) {\n            arr.push(link.experimentType.toUpperCase());\n          }\n          return arr;\n        }, [])\n        .sort()\n        .join('/'),\n    [commonLinks],\n  );\n\n  return (\n    <td\n      onContextMenu={(e) => {\n        if (contextMenu.length > 0) {\n          contextMenuHandler(e, rowCorrelation);\n        }\n      }}\n      style={{\n        backgroundColor: highlightCommonLinks.isActive\n          ? '#ff6f0057'\n          : isEdited\n          ? '#F7F2E0'\n          : 'inherit',\n      }}\n      title={title}\n      onMouseEnter={mouseEnterHandler}\n      onMouseLeave={mouseLeaveHandler}\n    >\n      {content.join('/')}\n      <ContextMenu ref={contextRef} context={contextMenu} />\n    </td>\n  );\n}\n\nexport default AdditionalColumnField;\n","import lodashGet from 'lodash/get';\nimport { LinkUtilities, GeneralUtilities } from 'nmr-correlation';\nimport { useCallback, useMemo } from 'react';\n\nimport { buildID } from '../../../../data/utilities/Concatenation';\nimport EditableColumn from '../../../elements/EditableColumn';\nimport SelectUncontrolled from '../../../elements/SelectUncontrolled';\nimport { useHighlight } from '../../../highlight';\nimport { findRangeOrZoneID } from '../Utilities';\n\nimport AdditionalColumnField from './AdditionalColumnField';\nimport { Hybridizations } from './Constants';\n\nconst selectBoxStyle = {\n  marginLeft: 2,\n  marginRight: 2,\n  border: 'none',\n  height: '20px',\n};\n\nfunction CorrelationTableRow({\n  additionalColumnData,\n  correlations,\n  correlation,\n  styleRow,\n  styleLabel,\n  onSaveEditEquivalences,\n  onChangeHybridization,\n  onSaveEditProtonsCount,\n  onEditAdditionalColumnField,\n  spectraData,\n}) {\n  const highlightIDsRow = useMemo(() => {\n    if (correlation.pseudo === true) {\n      return [];\n    }\n    const ids = [\n      correlation.signal.id,\n      buildID(correlation.signal.id, 'Crosshair_Y'),\n    ];\n    const id = findRangeOrZoneID(spectraData, correlation);\n    if (id) {\n      ids.push(id);\n    }\n    correlation.link.forEach((link) => {\n      if (link.pseudo === false) {\n        ids.push(link.signal.id);\n        ids.push(buildID(link.signal.id, 'Crosshair_Y'));\n        const _id = findRangeOrZoneID(spectraData, link);\n        if (_id) {\n          ids.push(_id);\n        }\n      }\n    });\n\n    return ids;\n  }, [correlation, spectraData]);\n  const highlightRow = useHighlight(highlightIDsRow);\n\n  const onSaveEquivalencesHandler = useCallback(\n    (e) => {\n      onSaveEditEquivalences(correlation, e.target.value);\n    },\n    [correlation, onSaveEditEquivalences],\n  );\n\n  const onSaveProtonsCountHandler = useCallback(\n    (e) => {\n      onSaveEditProtonsCount(correlation, e.target.value);\n    },\n    [correlation, onSaveEditProtonsCount],\n  );\n\n  const additionalColumnFields = useMemo(() => {\n    return additionalColumnData.map((_correlation) => {\n      const commonLinks = [];\n      correlation.link.forEach((link) => {\n        _correlation.link.forEach((_link) => {\n          if (\n            link.axis !== _link.axis &&\n            link.experimentID === _link.experimentID &&\n            link.signal.id === _link.signal.id\n          ) {\n            let experimentLabel = link.experimentType;\n            if (link.signal && link.signal.sign !== 0) {\n              experimentLabel += ' (edited)';\n            }\n            commonLinks.push(\n              LinkUtilities.buildLink({\n                ...link,\n                experimentLabel,\n                axis: undefined,\n              }),\n            );\n          }\n        });\n      });\n\n      return (\n        <AdditionalColumnField\n          key={`addColData_${correlation.id}_${_correlation.id}`}\n          rowCorrelation={correlation}\n          columnCorrelation={_correlation}\n          commonLinks={commonLinks}\n          correlations={correlations}\n          spectraData={spectraData}\n          onEdit={onEditAdditionalColumnField}\n        />\n      );\n    });\n  }, [\n    additionalColumnData,\n    correlation,\n    correlations,\n    onEditAdditionalColumnField,\n    spectraData,\n  ]);\n\n  const onChangeHybridizationHandler = useCallback(\n    (value) => {\n      onChangeHybridization(correlation, value);\n    },\n    [correlation, onChangeHybridization],\n  );\n\n  const equivalenceCellStyle = useMemo(() => {\n    return correlation.edited.equivalence\n      ? { backgroundColor: '#F7F2E0' }\n      : {\n          color: correlation.equivalence === 1 ? '#bebebe' : 'black',\n        };\n  }, [correlation]);\n\n  const mouseEnterHandler = useCallback(\n    (event) => {\n      event.currentTarget.focus();\n      highlightRow.show();\n    },\n    [highlightRow],\n  );\n  const mouseLeaveHandler = useCallback(\n    (event) => {\n      event.currentTarget.blur();\n      highlightRow.hide();\n    },\n    [highlightRow],\n  );\n\n  const tableDataProps = useMemo(() => {\n    return {\n      style: {\n        ...styleRow,\n        backgroundColor: highlightRow.isActive ? '#ff6f0057' : 'inherit',\n      },\n      title:\n        correlation.pseudo === false &&\n        [correlation.experimentType.toUpperCase()]\n          .concat(\n            correlation.link.reduce((arr, link) => {\n              if (\n                link.pseudo === false &&\n                link.experimentType !== correlation.experimentType &&\n                !arr.includes(link.experimentType.toUpperCase())\n              ) {\n                arr.push(link.experimentType.toUpperCase());\n              }\n              return arr;\n            }, []),\n          )\n          .sort()\n          .join('/'),\n      onMouseEnter: mouseEnterHandler,\n      onMouseLeave: mouseLeaveHandler,\n    };\n  }, [\n    correlation.experimentType,\n    correlation.link,\n    correlation.pseudo,\n    highlightRow.isActive,\n    mouseEnterHandler,\n    mouseLeaveHandler,\n    styleRow,\n  ]);\n\n  return (\n    <tr style={styleRow}>\n      <td\n        {...{\n          ...tableDataProps,\n          style: { ...tableDataProps.style, styleLabel },\n        }}\n      >\n        {GeneralUtilities.getLabel(correlations, correlation)}\n      </td>\n      <td {...tableDataProps}>\n        {lodashGet(correlation.signal, 'delta', false)\n          ? correlation.signal.delta.toFixed(2)\n          : ''}\n      </td>\n      <td {...tableDataProps}>\n        {correlation.pseudo === false ? (\n          correlation.atomType !== 'H' ? (\n            <EditableColumn\n              type=\"number\"\n              value={correlation.equivalence}\n              style={equivalenceCellStyle}\n              onSave={onSaveEquivalencesHandler}\n            />\n          ) : (\n            <text style={equivalenceCellStyle}>{correlation.equivalence}</text>\n          )\n        ) : (\n          ''\n        )}\n      </td>\n      <td {...tableDataProps}>\n        {correlation.atomType !== 'H' ? (\n          <EditableColumn\n            type=\"text\"\n            value={correlation.protonsCount.join(',')}\n            style={\n              correlation.edited.protonsCount\n                ? { backgroundColor: '#F7F2E0' }\n                : {}\n            }\n            onSave={onSaveProtonsCountHandler}\n          />\n        ) : (\n          ''\n        )}\n      </td>\n      <td\n        {...{\n          ...tableDataProps,\n          style: { ...tableDataProps.style, borderRight: '1px solid' },\n        }}\n      >\n        {correlation.atomType !== 'H' ? (\n          <SelectUncontrolled\n            onChange={onChangeHybridizationHandler}\n            data={Hybridizations}\n            value={correlation.hybridization}\n            style={{\n              ...selectBoxStyle,\n              backgroundColor: correlation.edited.hybridization\n                ? '#F7F2E0'\n                : styleRow.backgroundColor,\n              width: '50px',\n            }}\n          />\n        ) : (\n          ''\n        )}\n      </td>\n      {additionalColumnFields}\n    </tr>\n  );\n}\n\nexport default CorrelationTableRow;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useMemo } from 'react';\n\nimport { getLabelColor } from '../Utilities';\n\nimport AdditionalColumnHeader from './AdditionalColumnHeader';\nimport CorrelationTableRow from './CorrelationTableRow';\n\nconst tableStyle = css`\n  border-spacing: 0;\n  border: 1px solid #dedede;\n  width: 100%;\n  font-size: 12px;\n  height: 100%;\n  .react-contextmenu-wrapper {\n    display: contents;\n  }\n  tr {\n    :last-child {\n      td {\n        border-bottom: 0;\n      }\n    }\n  }\n  th,\n  td {\n    white-space: nowrap;\n    text-align: center;\n    margin: 0;\n    padding: 0.4rem;\n    border-bottom: 1px solid #dedede;\n    border-right: 1px solid #dedede;\n\n    :last-child {\n      border-right: 0;\n    }\n    button {\n      background-color: transparent;\n      border: none;\n    }\n  }\n`;\n\nfunction CorrelationTable({\n  correlationsData,\n  filteredCorrelationsData,\n  additionalColumnData,\n  editEquivalencesSaveHandler,\n  changeHybridizationSaveHandler,\n  editProtonsCountSaveHandler,\n  editAdditionalColumnFieldSaveHandler,\n  showProtonsAsRows,\n  spectraData,\n}) {\n  const rows = useMemo(() => {\n    if (!filteredCorrelationsData) {\n      return [];\n    }\n\n    return filteredCorrelationsData.values\n      .filter((correlation) =>\n        showProtonsAsRows\n          ? correlation.atomType === 'H'\n          : correlation.atomType !== 'H',\n      )\n      .map((correlation) => (\n        <CorrelationTableRow\n          additionalColumnData={additionalColumnData}\n          correlations={correlationsData.values}\n          correlation={correlation}\n          key={`correlation${correlation.atomType}${correlation.id}`}\n          styleRow={{ backgroundColor: 'mintcream' }}\n          styleLabel={\n            correlation.atomType === 'H'\n              ? {\n                  color: getLabelColor(correlationsData, correlation),\n                }\n              : {}\n          }\n          onSaveEditEquivalences={editEquivalencesSaveHandler}\n          onChangeHybridization={changeHybridizationSaveHandler}\n          onSaveEditProtonsCount={editProtonsCountSaveHandler}\n          onEditAdditionalColumnField={editAdditionalColumnFieldSaveHandler}\n          spectraData={spectraData}\n        />\n      ));\n  }, [\n    filteredCorrelationsData,\n    showProtonsAsRows,\n    additionalColumnData,\n    correlationsData,\n    editEquivalencesSaveHandler,\n    changeHybridizationSaveHandler,\n    editProtonsCountSaveHandler,\n    editAdditionalColumnFieldSaveHandler,\n    spectraData,\n  ]);\n\n  const additionalColumnHeader = useMemo(\n    () =>\n      additionalColumnData.map((correlation) => (\n        <AdditionalColumnHeader\n          key={`additionalCorrelationHeader_${correlation.id}`}\n          spectraData={spectraData}\n          correlationsData={correlationsData}\n          correlation={correlation}\n        />\n      )),\n    [additionalColumnData, correlationsData, spectraData],\n  );\n\n  return (\n    <div className=\"table-container\">\n      <table css={tableStyle}>\n        <thead>\n          <tr>\n            <th>Atom</th>\n            <th> (ppm)</th>\n            <th>Equiv</th>\n            <th>#H</th>\n            <th style={{ borderRight: '1px solid' }}>Hybrid</th>\n            {additionalColumnHeader}\n          </tr>\n        </thead>\n        <tbody>{rows}</tbody>\n      </table>\n    </div>\n  );\n}\n\nexport default CorrelationTable;\n","import { GeneralUtilities } from 'nmr-correlation';\nimport { memo } from 'react';\n\nimport { ErrorColors, Errors } from './CorrelationTable/Constants';\n\nfunction Overview({ correlationsData }) {\n  if (!correlationsData) {\n    return null;\n  }\n  const atoms = GeneralUtilities.getAtomCounts(correlationsData.options.mf);\n\n  return Object.keys(atoms).length > 0 ? (\n    Object.keys(atoms).map((atomType, i) => {\n      const stateAtomType = correlationsData.state[atomType];\n      const error = stateAtomType ? stateAtomType.error : undefined;\n      const errorColorIndex = error\n        ? Errors.findIndex((_error) => error[_error] !== undefined)\n        : 'black';\n\n      return (\n        <span\n          // eslint-disable-next-line react/no-array-index-key\n          key={`molFormulaView_${i}`}\n          style={{\n            color: stateAtomType\n              ? stateAtomType.complete === true &&\n                (!error || Object.keys(error).length === 0)\n                ? 'green'\n                : errorColorIndex >= 0\n                ? ErrorColors[errorColorIndex].color\n                : 'black'\n              : 'black',\n          }}\n        >\n          {`${atomType}: ${stateAtomType ? stateAtomType.current : '-'}/${\n            atoms[atomType]\n          }   `}\n        </span>\n      );\n    })\n  ) : (\n    <p style={{ fontStyle: 'italic', color: 'orange' }}>\n      Molecular formula is not set\n    </p>\n  );\n}\n\nexport default memo(Overview);\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { MF } from 'mf-parser';\nimport { useCallback, useState } from 'react';\n\nconst inputStyle = css`\n  text-align: center;\n\n  input {\n    height: 100%;\n    width: 200px;\n    border-radius: 5px;\n    border: 0.55px solid #c7c7c7;\n    margin: 0px 5px 0px 5px;\n    text-align: center;\n  }\n\n  button {\n    flex: 2;\n    padding: 5px;\n    border: 1px solid gray;\n    border-radius: 5px;\n    height: 36px;\n    margin: 0 auto;\n    margin-top: 15px;\n    display: block;\n    width: 20%;\n\n    color: white;\n    background-color: gray;\n  }\n`;\n\nfunction MolecularFormulaInput({ onSave, previousMF }) {\n  const [mf, setMF] = useState('');\n  const [isValidMF, setIsValidMF] = useState(true);\n  const [hasChanged, setHasChanged] = useState(false);\n\n  const checkMF = useCallback((mf) => {\n    try {\n      new MF(mf);\n      return true;\n    } catch (error) {\n      return false;\n    }\n  }, []);\n\n  const onChangeHandler = useCallback(\n    (e) => {\n      setHasChanged(true);\n      if (checkMF(e.target.value)) {\n        setIsValidMF(true);\n        setMF(e.target.value);\n      } else {\n        setIsValidMF(false);\n        setMF('');\n      }\n    },\n    [checkMF],\n  );\n\n  const onSaveHandler = useCallback(() => {\n    onSave(hasChanged ? mf.trim() : previousMF);\n  }, [hasChanged, mf, onSave, previousMF]);\n\n  return (\n    <div css={inputStyle}>\n      <input type=\"text\" onChange={onChangeHandler} defaultValue={previousMF} />\n      <button type=\"button\" onClick={onSaveHandler} disabled={!isValidMF}>\n        Set\n      </button>\n    </div>\n  );\n}\n\nMolecularFormulaInput.defaultProps = {\n  onSave: () => {\n    return null;\n  },\n};\n\nexport default MolecularFormulaInput;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback, useEffect, useState } from 'react';\n\nimport CloseButton from '../../elements/CloseButton';\nimport MolecularFormulaInput from '../../elements/MolecularFormulaInput';\nimport MoleculeSelection from '../../elements/MoleculeSelection';\n\nconst modalContainer = css`\n  overflow: auto;\n  width: 400px;\n  height: 550px;\n  padding: 5px;\n  button:focus {\n    outline: none;\n  }\n  .header {\n    height: 24px;\n    border-bottom: 1px solid #f0f0f0;\n    display: flex;\n    align-items: center;\n\n    button {\n      height: 36px;\n      margin: 2px;\n      background-color: transparent;\n      border: none;\n      svg {\n        height: 16px;\n      }\n    }\n  }\n\n  button {\n    flex: 2;\n    padding: 5px;\n    border: 1px solid gray;\n    border-radius: 5px;\n    height: 30px;\n    margin: 0 auto;\n    margin-top: 15px;\n    display: block;\n    width: 20%;\n\n    color: white;\n    background-color: gray;\n  }\n\n  .info {\n    margin-top: 0;\n    margin-bottom: 10px;\n    padding: 0px 10px;\n    width: 100%;\n\n    text-align: center;\n  }\n\n  .optional {\n    margin-top: 20px;\n    margin-bottom: 5px;\n    padding: 0px 10px;\n\n    text-align: center;\n    font-size: 18px;\n    font-weight: bold;\n  }\n  .optional2 {\n    margin-top: 5px;\n    margin-bottom: 25px;\n    padding: 0px 10px;\n    width: 100%;\n\n    text-align: center;\n  }\n`;\n\nfunction SetMolecularFormulaModal({ onClose, onSave, molecules, previousMF }) {\n  const [currentIndex, setCurrentIndex] = useState();\n\n  useEffect(() => {\n    if (molecules && molecules.length > 0) {\n      setCurrentIndex(0);\n    }\n  }, [molecules]);\n\n  const onSaveHandlerMolecularFormulaInput = useCallback(\n    (mf) => {\n      onSave(mf);\n      onClose();\n    },\n    [onClose, onSave],\n  );\n\n  const onSaveHandlerMoleculeSelection = useCallback(() => {\n    onSave(molecules[currentIndex].mf);\n    onClose();\n  }, [currentIndex, molecules, onClose, onSave]);\n\n  const onChangeHandlerMoleculeSelection = useCallback((index) => {\n    setCurrentIndex(index);\n  }, []);\n\n  return (\n    <div css={modalContainer}>\n      <div className=\"header\">\n        <CloseButton onClick={onClose} />\n      </div>\n      <div>\n        <p className=\"info\">Please type in a molecular formula!</p>\n      </div>\n      <MolecularFormulaInput\n        onSave={onSaveHandlerMolecularFormulaInput}\n        previousMF={previousMF}\n      />\n      <div>\n        <p className=\"optional\">OR</p>\n        <p className=\"optional2\">Select a molecule as reference!</p>\n      </div>\n      <MoleculeSelection\n        molecules={molecules}\n        onChange={onChangeHandlerMoleculeSelection}\n      />\n      <button type=\"button\" onClick={onSaveHandlerMoleculeSelection}>\n        Set\n      </button>\n    </div>\n  );\n}\n\nSetMolecularFormulaModal.defaultProps = {\n  onSave: () => {\n    return null;\n  },\n  onClose: () => {\n    return null;\n  },\n};\n\nexport default SetMolecularFormulaModal;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback, useEffect, useMemo, useState } from 'react';\n\nimport CloseButton from '../../elements/CloseButton';\n\nconst modalContainer = css`\n  overflow: auto;\n  width: 300px;\n  height: 300px;\n  padding: 5px;\n  button:focus {\n    outline: none;\n  }\n  text-align: center;\n\n  .header {\n    height: 24px;\n    border-bottom: 1px solid #f0f0f0;\n    display: flex;\n    align-items: center;\n\n    button {\n      height: 36px;\n      margin: 2px;\n      background-color: transparent;\n      border: none;\n      svg {\n        height: 16px;\n      }\n    }\n  }\n\n  button {\n    flex: 2;\n    padding: 5px;\n    border: 1px solid gray;\n    border-radius: 5px;\n    height: 30px;\n    margin: 0 auto;\n    margin-top: 15px;\n    display: block;\n    width: 20%;\n\n    color: white;\n    background-color: gray;\n  }\n\n  .info {\n    margin-top: 0;\n    margin-bottom: 10px;\n    padding: 0px 10px;\n    width: 100%;\n\n    text-align: center;\n  }\n\n  input {\n    border-radius: 5px;\n    border: 0.55px solid #c7c7c7;\n    margin: 0px 5px 0px 5px;\n    text-align: center;\n  }\n`;\n\nfunction SetShiftToleranceModal({ onClose, onSave, previousTolerance }) {\n  const [tolerance, setTolerance] = useState();\n\n  useEffect(() => {\n    if (previousTolerance) {\n      setTolerance(previousTolerance);\n    } else {\n      setTolerance(undefined);\n    }\n  }, [previousTolerance]);\n\n  const onSaveHandler = useCallback(() => {\n    onSave(tolerance);\n    onClose();\n  }, [onClose, onSave, tolerance]);\n\n  const onChangeHandler = useCallback(\n    (e, atomType) =>\n      setTolerance({ ...tolerance, [atomType]: Number(e.target.value) }),\n    [tolerance],\n  );\n\n  const inputFields = useMemo(() => {\n    return tolerance\n      ? Object.keys(tolerance).map((atomType) => {\n          return (\n            <div\n              key={`toleranceInputField_${atomType}`}\n              className=\"input-field\"\n            >\n              <span>{atomType}: </span>\n              <input\n                type=\"number\"\n                onChange={(e) => onChangeHandler(e, atomType)}\n                defaultValue={tolerance[atomType]}\n              />\n            </div>\n          );\n        })\n      : undefined;\n  }, [onChangeHandler, tolerance]);\n\n  return (\n    <div css={modalContainer}>\n      <div className=\"header\">\n        <CloseButton onClick={onClose} />\n      </div>\n      <div>\n        <p className=\"info\">Shift tolerances: </p>\n      </div>\n      {inputFields}\n      <button type=\"button\" onClick={onSaveHandler}>\n        Set\n      </button>\n    </div>\n  );\n}\n\nSetShiftToleranceModal.defaultProps = {\n  onSave: () => {\n    return null;\n  },\n  onClose: () => {\n    return null;\n  },\n};\n\nexport default SetShiftToleranceModal;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { memo, useCallback, useEffect, useMemo, useState } from 'react';\nimport { FaFlask, FaSlidersH } from 'react-icons/fa';\n\nimport { useChartData } from '../../context/ChartContext';\nimport { useDispatch } from '../../context/DispatchContext';\nimport SelectUncontrolled from '../../elements/SelectUncontrolled';\nimport ToolTip from '../../elements/ToolTip/ToolTip';\nimport { useModal } from '../../elements/popup/Modal';\nimport { DISPLAYER_MODE } from '../../reducer/core/Constants';\nimport {\n  SET_CORRELATION,\n  SET_CORRELATIONS,\n  SET_CORRELATIONS_MF,\n  SET_CORRELATIONS_TOLERANCE,\n} from '../../reducer/types/Types';\nimport DefaultPanelHeader from '../header/DefaultPanelHeader';\n\nimport CorrelationTable from './CorrelationTable/CorrelationTable';\nimport Overview from './Overview';\nimport SetMolecularFormulaModal from './SetMolecularFormulaModal';\nimport SetShiftToleranceModal from './SetShiftTolerancesModal';\nimport {\n  findSignalMatch1D,\n  findSignalMatch2D,\n  findSpectrum,\n  getAtomType,\n} from './Utilities';\n\nconst panelStyle = css`\n  display: flex;\n  flex-direction: column;\n  text-align: center;\n  height: 100%;\n  width: 100%;\n  justify-content: center,\n  align-items: 'center',\n\n  button {\n    border-radius: 5px;\n    margin-top: 3px;\n    margin-left: 2px;\n    border: none;\n    height: 16px;\n    width: 18px;\n    font-size: 12px;\n    padding: 0;\n    background-color: transparent;\n  }\n\n  .overview-container {\n    width: 100%;\n    margin-left: 15px;\n    white-space: nowrap;\n    span {\n      margin-left: 8px;\n    }\n  }\n\n  .homoHeteroKinds-container {\n    width: 100%;\n    margin-left: 15px;\n    span {\n      margin-left: 7px;\n    }\n  }\n\n  .table-container {\n    overflow: auto;\n  }\n`;\n\nfunction SummaryPanel() {\n  const {\n    molecules,\n    correlations: correlationsData,\n    data: spectraData,\n    xDomain,\n    yDomain,\n    displayerMode,\n    activeTab,\n  } = useChartData();\n\n  const dispatch = useDispatch();\n  const modal = useModal();\n\n  const [additionalColumnData, setAdditionalColumnData] = useState([]);\n  const [\n    selectedAdditionalColumnsAtomType,\n    setSelectedAdditionalColumnsAtomType,\n  ] = useState('-');\n  const [showProtonsAsRows, setShowProtonsAsRows] = useState(false);\n  const [filterIsActive, setFilterIsActive] = useState(false);\n\n  const filteredCorrelationsData = useMemo(() => {\n    const isInView = (value) => {\n      if (value.pseudo === true) {\n        return false;\n      }\n      const atomTypesInView = activeTab\n        .split(',')\n        .map((tab) => getAtomType(tab));\n\n      const factor = 10000;\n      const xDomain0 = xDomain[0] * factor;\n      const xDomain1 = xDomain[1] * factor;\n      const yDomain0 = yDomain[0] * factor;\n      const yDomain1 = yDomain[1] * factor;\n\n      if (displayerMode === DISPLAYER_MODE.DM_1D) {\n        const delta = value.signal.delta * factor;\n        const spectrum = findSpectrum(spectraData, value);\n        if (\n          spectrum &&\n          atomTypesInView[0] === value.atomType &&\n          delta >= xDomain0 &&\n          delta <= xDomain1\n        ) {\n          return true;\n        }\n        // try to find a link which contains the belonging 2D signal in the spectra in view\n        if (\n          value.link.some((link) => {\n            const spectrum = findSpectrum(spectraData, link);\n            return findSignalMatch1D(\n              spectrum,\n              link,\n              factor,\n              xDomain0,\n              xDomain1,\n            );\n          })\n        ) {\n          return true;\n        }\n      } else if (displayerMode === DISPLAYER_MODE.DM_2D) {\n        if (!atomTypesInView.includes(value.atomType)) {\n          return false;\n        }\n        const spectrum = findSpectrum(spectraData, value);\n        // correlation is represented by a 2D signal\n        if (\n          findSignalMatch2D(\n            spectrum,\n            value,\n            factor,\n            xDomain0,\n            xDomain1,\n            yDomain0,\n            yDomain1,\n          )\n        ) {\n          return true;\n        } else {\n          // try to find a link which contains the belonging 2D signal in the spectra in view\n          if (\n            value.link.some((link) => {\n              const spectrum = findSpectrum(spectraData, link);\n              return findSignalMatch2D(\n                spectrum,\n                link,\n                factor,\n                xDomain0,\n                xDomain1,\n                yDomain0,\n                yDomain1,\n              );\n            })\n          ) {\n            return true;\n          }\n        }\n      }\n      // do not show correlation\n      return false;\n    };\n\n    if (correlationsData) {\n      const _values = filterIsActive\n        ? correlationsData.values.filter((value) => isInView(value))\n        : correlationsData.values;\n\n      return { ...correlationsData, values: _values };\n    }\n  }, [\n    activeTab,\n    correlationsData,\n    displayerMode,\n    filterIsActive,\n    spectraData,\n    xDomain,\n    yDomain,\n  ]);\n\n  const handleOnSetMolecularFormula = useCallback(\n    (mf) => {\n      dispatch({\n        type: SET_CORRELATIONS_MF,\n        payload: {\n          mf,\n        },\n      });\n    },\n    [dispatch],\n  );\n\n  const handleOnSetShiftTolerance = useCallback(\n    (tolerance) => {\n      dispatch({\n        type: SET_CORRELATIONS_TOLERANCE,\n        payload: {\n          tolerance,\n        },\n      });\n    },\n    [dispatch],\n  );\n\n  const showSetMolecularFormulaModal = useCallback(() => {\n    modal.show(\n      <SetMolecularFormulaModal\n        onClose={() => modal.close()}\n        onSave={handleOnSetMolecularFormula}\n        molecules={molecules}\n        previousMF={correlationsData.options.mf}\n      />,\n    );\n  }, [correlationsData, handleOnSetMolecularFormula, modal, molecules]);\n\n  const showSetShiftToleranceModal = useCallback(() => {\n    modal.show(\n      <SetShiftToleranceModal\n        onClose={() => modal.close()}\n        onSave={handleOnSetShiftTolerance}\n        previousTolerance={correlationsData.options.tolerance}\n      />,\n    );\n  }, [correlationsData, handleOnSetShiftTolerance, modal]);\n\n  const additionalColumnTypes = useMemo(() => {\n    const columnTypes = ['-'].concat(\n      correlationsData\n        ? correlationsData.values\n            .map((correlation) => correlation.atomType)\n            .filter((atomType, i, array) => array.indexOf(atomType) === i)\n        : [],\n    );\n\n    if (columnTypes.includes('H')) {\n      columnTypes.push('H-H');\n    }\n\n    if (columnTypes.includes('H')) {\n      setSelectedAdditionalColumnsAtomType('H');\n    } else {\n      setSelectedAdditionalColumnsAtomType('-');\n    }\n\n    return columnTypes.map((columnType) => {\n      return {\n        key: columnType,\n        label: columnType,\n        value: columnType,\n      };\n    });\n  }, [correlationsData]);\n\n  useEffect(() => {\n    const _selectedAdditionalColumnsAtomType = selectedAdditionalColumnsAtomType.split(\n      '-',\n    )[0];\n\n    setAdditionalColumnData(\n      filteredCorrelationsData\n        ? filteredCorrelationsData.values\n            .filter(\n              (correlation) =>\n                correlation.atomType === _selectedAdditionalColumnsAtomType,\n            )\n            .reverse()\n        : [],\n    );\n  }, [filteredCorrelationsData, selectedAdditionalColumnsAtomType]);\n\n  const editEquivalencesSaveHandler = useCallback(\n    (correlation, value) => {\n      dispatch({\n        type: SET_CORRELATION,\n        payload: {\n          id: correlation.id,\n          correlation: {\n            ...correlation,\n            equivalence: value,\n            edited: { ...correlation.edited, equivalence: true },\n          },\n        },\n      });\n    },\n    [dispatch],\n  );\n\n  const editProtonsCountSaveHandler = useCallback(\n    (correlation, valuesString) => {\n      let values;\n      // eslint-disable-next-line prefer-named-capture-group\n      if (valuesString.match(/^([0-9],{0,1})+$/g)) {\n        // allow digits followed by optional comma only\n        values = valuesString\n          .split(',')\n          .filter((char) => char.length > 0)\n          .map((char) => Number(char));\n      } else if (valuesString.trim().length === 0) {\n        // set values to default\n        values = [];\n      }\n\n      if (values) {\n        // ignore not supported text input\n        dispatch({\n          type: SET_CORRELATION,\n          payload: {\n            id: correlation.id,\n            correlation: {\n              ...correlation,\n              protonsCount: values,\n              edited: { ...correlation.edited, protonsCount: true },\n            },\n          },\n        });\n      }\n    },\n    [dispatch],\n  );\n\n  const changeHybridizationSaveHandler = useCallback(\n    (correlation, value) => {\n      dispatch({\n        type: SET_CORRELATION,\n        payload: {\n          id: correlation.id,\n          correlation: {\n            ...correlation,\n            hybridization: value,\n            edited: { ...correlation.edited, hybridization: true },\n          },\n        },\n      });\n    },\n    [dispatch],\n  );\n\n  const editAdditionalColumnFieldSaveHandler = useCallback(\n    (rowCorrelation, columnCorrelation) => {\n      dispatch({\n        type: SET_CORRELATIONS,\n        payload: {\n          ids: [rowCorrelation.id, columnCorrelation.id],\n          correlations: [\n            {\n              ...rowCorrelation,\n              edited: {\n                ...rowCorrelation.edited,\n                additionalColumnField: true,\n              },\n            },\n            {\n              ...columnCorrelation,\n              edited: {\n                ...columnCorrelation.edited,\n                additionalColumnField: true,\n              },\n            },\n          ],\n        },\n      });\n    },\n    [dispatch],\n  );\n\n  const handleOnFilter = useCallback(() => {\n    setFilterIsActive(!filterIsActive);\n  }, [filterIsActive]);\n\n  return (\n    <div css={panelStyle}>\n      <DefaultPanelHeader\n        canDelete={false}\n        counter={correlationsData ? correlationsData.values.length : 0}\n        onFilter={handleOnFilter}\n        filterToolTip={\n          filterIsActive\n            ? 'Show all correlations'\n            : 'Hide correlations out of view'\n        }\n        filterIsActive={filterIsActive}\n        counterFiltered={\n          filteredCorrelationsData && filteredCorrelationsData.values.length\n        }\n      >\n        <ToolTip\n          title={`Set molecular formula (${correlationsData.options.mf})`}\n          popupPlacement=\"right\"\n        >\n          <button type=\"button\" onClick={showSetMolecularFormulaModal}>\n            <FaFlask />\n          </button>\n        </ToolTip>\n        <ToolTip title={`Set shift tolerance`} popupPlacement=\"right\">\n          <button type=\"button\" onClick={showSetShiftToleranceModal}>\n            <FaSlidersH />\n          </button>\n        </ToolTip>\n        <div className=\"overview-container\">\n          <Overview correlationsData={correlationsData} />\n        </div>\n        <div className=\"homoHeteroKinds-container\">\n          <SelectUncontrolled\n            onChange={(selection) => {\n              setSelectedAdditionalColumnsAtomType(selection);\n              if (selection === 'H-H') {\n                setShowProtonsAsRows(true);\n              } else {\n                setShowProtonsAsRows(false);\n              }\n            }}\n            data={additionalColumnTypes}\n            value={selectedAdditionalColumnsAtomType}\n            style={{\n              width: '65px',\n              height: '20px',\n              border: '1px solid grey',\n            }}\n          />\n        </div>\n      </DefaultPanelHeader>\n      <CorrelationTable\n        correlationsData={correlationsData}\n        filteredCorrelationsData={filteredCorrelationsData}\n        additionalColumnData={additionalColumnData}\n        editEquivalencesSaveHandler={editEquivalencesSaveHandler}\n        changeHybridizationSaveHandler={changeHybridizationSaveHandler}\n        editProtonsCountSaveHandler={editProtonsCountSaveHandler}\n        editAdditionalColumnFieldSaveHandler={\n          editAdditionalColumnFieldSaveHandler\n        }\n        showProtonsAsRows={showProtonsAsRows}\n        spectraData={spectraData}\n      />\n    </div>\n  );\n}\n\nexport default memo(SummaryPanel);\n","import lodashGet from 'lodash/get';\nimport lodashSet from 'lodash/set';\nimport {\n  useEffect,\n  useState,\n  useCallback,\n  forwardRef,\n  useImperativeHandle,\n  useRef,\n  memo,\n} from 'react';\n\nimport { usePreferences } from '../../context/PreferencesContext';\nimport IsotopesViewer from '../../elements/IsotopesViewer';\nimport { useAlert } from '../../elements/popup/Alert';\nimport ZonesWrapper from '../../hoc/ZonesWrapper';\nimport { SET_PANELS_PREFERENCES } from '../../reducer/preferencesReducer';\nimport {\n  useStateWithLocalStorage,\n  getValue as getValueByKeyPath,\n} from '../../utility/LocalStorage';\nimport ColumnFormatField from '../extra/preferences/ColumnFormatField';\nimport { rangeDefaultValues } from '../extra/preferences/defaultValues';\n\nconst styles = {\n  container: {\n    padding: 10,\n    backgroundColor: '#f1f1f1',\n    height: '100%',\n    flex: 1,\n  },\n  groupContainer: {\n    padding: '5px',\n    borderRadius: '5px',\n    margin: '10px 0px',\n    backgroundColor: 'white',\n  },\n  row: {\n    display: 'flex',\n    margin: '5px 0px',\n  },\n  header: {\n    borderBottom: '1px solid #e8e8e8',\n    paddingBottom: '5px',\n    fontWeight: 'bold',\n    color: '#4a4a4a',\n  },\n  inputLabel: {\n    flex: 2,\n    fontSize: '11px',\n    fontWeight: 'bold',\n    color: '#232323',\n  },\n  input: {\n    width: '30%',\n    textAlign: 'center',\n  },\n};\n\nconst formatFields = [\n  {\n    id: 1,\n    label: 'From :',\n    checkController: 'showFrom',\n    formatController: 'fromFormat',\n    defaultFormat: '0.00',\n  },\n  {\n    id: 2,\n    label: 'To :',\n    checkController: 'showTo',\n    formatController: 'toFormat',\n    defaultFormat: '0.00',\n  },\n  {\n    id: 3,\n    label: 'Absolute :',\n    checkController: 'showAbsolute',\n    formatController: 'absoluteFormat',\n    defaultFormat: '0.00',\n  },\n  {\n    id: 4,\n    label: 'Relative :',\n    checkController: 'showRelative',\n    formatController: 'relativeFormat',\n    defaultFormat: '00.00',\n  },\n];\n\nfunction ZonesPreferences({ nucleus }, ref) {\n  const alert = useAlert();\n  const [, setSettingsData] = useStateWithLocalStorage('nmr-general-settings');\n  const preferences = usePreferences();\n\n  const [settings, setSetting] = useState(null);\n  const formRef = useRef();\n  useEffect(() => {\n    const zonesPreferences = getValueByKeyPath(\n      preferences,\n      'formatting.panels.zones',\n    );\n    if (zonesPreferences) {\n      setSetting(zonesPreferences);\n    }\n  }, [preferences]);\n\n  const saveToLocalStorgate = (values) => {\n    setSettingsData(values, 'formatting.panels.ranges');\n  };\n\n  const saveHandler = useCallback(\n    (values, showMessage = false) => {\n      preferences.dispatch({\n        type: SET_PANELS_PREFERENCES,\n        payload: { key: 'zones', value: values },\n      });\n      if (showMessage) {\n        alert.success('zones preferences saved successfully');\n      }\n    },\n    [alert, preferences],\n  );\n\n  useImperativeHandle(ref, () => ({\n    saveSetting() {\n      if (typeof formRef.current.requestSubmit === 'function') {\n        formRef.current.requestSubmit();\n      } else {\n        formRef.current.dispatchEvent(\n          new Event('submit', { cancelable: true }),\n        );\n      }\n    },\n  }));\n\n  const handleSubmit = async (event) => {\n    event.preventDefault();\n    const form = event.target;\n    const formData = new FormData(form);\n    let values = {};\n    for (const field of formData.entries()) {\n      const keys = field[0].split('-').join('.');\n      const val = ['true', 'false'].includes(field[1])\n        ? field[1] === 'true'\n        : field[1];\n      values = lodashSet(values, keys, val);\n    }\n\n    saveHandler(values, true);\n    saveToLocalStorgate(values);\n  };\n\n  const getValue = useCallback(\n    (...params) => {\n      const keys = params.join('.');\n      if (settings) {\n        const value = lodashGet(settings, keys);\n        return value ? value : null;\n      } else {\n        const keyIndex = params.length - 1;\n        return rangeDefaultValues[params[keyIndex]];\n      }\n    },\n    [settings],\n  );\n\n  return (\n    <div style={styles.container}>\n      <form onSubmit={handleSubmit} ref={formRef}>\n        {nucleus &&\n          nucleus.map((nucleusLabel) => (\n            <div key={nucleusLabel} style={styles.groupContainer}>\n              <IsotopesViewer style={styles.header} value={nucleusLabel} />\n              {formatFields.map((field) => (\n                <ColumnFormatField\n                  key={field.id}\n                  label={field.label}\n                  checked={getValue(nucleusLabel, field.checkController)}\n                  format={getValue(nucleusLabel, field.formatController)}\n                  checkControllerName={field.checkController}\n                  formatControllerName={field.formatController}\n                  groupID={nucleusLabel}\n                />\n              ))}\n            </div>\n          ))}\n      </form>\n    </div>\n  );\n}\n\nexport default ZonesWrapper(memo(forwardRef(ZonesPreferences)));\n","import { Fragment, useCallback } from 'react';\nimport { FaRegTrashAlt, FaSearchPlus } from 'react-icons/fa';\n\nimport { SignalKinds } from '../../../../data/constants/SignalsKinds';\nimport { useAssignmentData } from '../../../assignment';\nimport { useDispatch } from '../../../context/DispatchContext';\nimport SelectUncontrolled from '../../../elements/SelectUncontrolled';\nimport {\n  CHANGE_ZONE_SIGNAL_KIND,\n  DELETE_2D_ZONE,\n  SET_X_DOMAIN,\n  SET_Y_DOMAIN,\n} from '../../../reducer/types/Types';\n\nconst selectBoxStyle = {\n  marginLeft: 2,\n  marginRight: 2,\n  border: 'none',\n  height: '20px',\n};\n\nfunction ActionsColumn({ rowData, rowSpanTags }) {\n  const dispatch = useDispatch();\n  const assignmentData = useAssignmentData();\n\n  const changeSignalKindHandler = useCallback(\n    (value) => {\n      dispatch({\n        type: CHANGE_ZONE_SIGNAL_KIND,\n        payload: {\n          rowData,\n          value,\n        },\n      });\n    },\n    [dispatch, rowData],\n  );\n\n  const deleteZoneHandler = useCallback(() => {\n    dispatch({\n      type: DELETE_2D_ZONE,\n      payload: {\n        id: rowData.id,\n        assignmentData,\n      },\n    });\n  }, [assignmentData, dispatch, rowData]);\n\n  const zoomZoneHandler = useCallback(() => {\n    const xMargin = Math.abs(rowData.x.from - rowData.x.to) * 10;\n    dispatch({\n      type: SET_X_DOMAIN,\n      xDomain:\n        rowData.x.from <= rowData.x.to\n          ? [rowData.x.from - xMargin, rowData.x.to + xMargin]\n          : [rowData.x.to - xMargin, rowData.x.from + xMargin],\n    });\n    const yMargin = Math.abs(rowData.y.from - rowData.y.to) * 10;\n    dispatch({\n      type: SET_Y_DOMAIN,\n      yDomain:\n        rowData.y.from <= rowData.y.to\n          ? [rowData.y.from - yMargin, rowData.y.to + yMargin]\n          : [rowData.y.to - yMargin, rowData.y.from + yMargin],\n    });\n  }, [dispatch, rowData.x.from, rowData.x.to, rowData.y.from, rowData.y.to]);\n\n  return (\n    <Fragment>\n      <td>\n        <SelectUncontrolled\n          onChange={(value) => {\n            changeSignalKindHandler(value);\n          }}\n          data={SignalKinds}\n          value={rowData.tableMetaInfo.signal.kind}\n          style={selectBoxStyle}\n        />\n      </td>\n      <td {...rowSpanTags}>\n        <button\n          type=\"button\"\n          className=\"delete-button\"\n          onClick={deleteZoneHandler}\n        >\n          <FaRegTrashAlt />\n        </button>\n        <button type=\"button\" className=\"zoom-button\" onClick={zoomZoneHandler}>\n          <FaSearchPlus title=\"Zoom to zone in spectrum\" />\n        </button>\n      </td>\n    </Fragment>\n  );\n}\n\nexport default ActionsColumn;\n","import lodashGet from 'lodash/get';\nimport { FaMinusCircle } from 'react-icons/fa';\n\nfunction SignalAssignmentsColumn({\n  rowData,\n  assignment,\n  highlight,\n  onHover,\n  onClick,\n  onUnlink,\n  axis,\n  showUnlinkButton,\n  setShowUnlinkButton,\n}) {\n  return (\n    <td\n      {...onHover}\n      {...{ onClick: (e) => onClick(e, assignment, axis) }}\n      style={\n        highlight.isActive ||\n        (assignment.isActive && assignment.activeAxis === axis)\n          ? {\n              color: 'red',\n              fontWeight: 'bold',\n            }\n          : null\n      }\n    >\n      {lodashGet(rowData, `tableMetaInfo.signal.${axis}.diaID`, []).length >\n      0 ? (\n        <div\n          onMouseEnter={() => setShowUnlinkButton(true)}\n          onMouseLeave={() => setShowUnlinkButton(false)}\n        >\n          {rowData.tableMetaInfo.signal[axis].diaID.length}{' '}\n          <sup>\n            <button\n              type=\"button\"\n              style={{\n                visibility: showUnlinkButton ? 'visible' : 'hidden',\n                padding: 0,\n                margin: 0,\n              }}\n              onClick={(e) => onUnlink(e, false, axis)}\n            >\n              <FaMinusCircle color=\"red\" />\n            </button>\n          </sup>\n        </div>\n      ) : assignment.isActive && assignment.activeAxis === axis ? (\n        '0'\n      ) : (\n        ''\n      )}\n    </td>\n  );\n}\n\nexport default SignalAssignmentsColumn;\n","import { Fragment } from 'react';\n\nimport SignalAssignmentsColumn from './SignalAssignmentsColumn';\n\nfunction SignalAssignmentsColumns({\n  rowData,\n  assignmentSignal,\n  onHoverSignalX,\n  onHoverSignalY,\n  showUnlinkButtonSignalX,\n  showUnlinkButtonSignalY,\n  setShowUnlinkButtonSignalX,\n  setShowUnlinkButtonSignalY,\n  onClick,\n  onUnlink,\n  highlightSignalX,\n  highlightSignalY,\n}) {\n  return (\n    <Fragment>\n      <SignalAssignmentsColumn\n        rowData={rowData}\n        assignment={assignmentSignal}\n        highlight={highlightSignalX}\n        onHover={onHoverSignalX}\n        onClick={onClick}\n        onUnlink={onUnlink}\n        axis={'x'}\n        showUnlinkButton={showUnlinkButtonSignalX}\n        setShowUnlinkButton={setShowUnlinkButtonSignalX}\n      />\n      <SignalAssignmentsColumn\n        rowData={rowData}\n        assignment={assignmentSignal}\n        highlight={highlightSignalY}\n        onHover={onHoverSignalY}\n        onClick={onClick}\n        onUnlink={onUnlink}\n        axis={'y'}\n        showUnlinkButton={showUnlinkButtonSignalY}\n        setShowUnlinkButton={setShowUnlinkButtonSignalY}\n      />\n    </Fragment>\n  );\n}\n\nexport default SignalAssignmentsColumns;\n","import lodashGet from 'lodash/get';\nimport { Fragment, useCallback } from 'react';\n\nimport { useDispatch } from '../../../context/DispatchContext';\nimport EditableColumn from '../../../elements/EditableColumn';\nimport { CHANGE_ZONE_SIGNAL_VALUE } from '../../../reducer/types/Types';\n\nfunction SignalDeltaColumn({ rowData, onHoverSignalX, onHoverSignalY }) {\n  const dispatch = useDispatch();\n\n  const signalDeltaX = lodashGet(rowData, 'tableMetaInfo.signal.x.delta', null);\n  const signalDeltaY = lodashGet(rowData, 'tableMetaInfo.signal.y.delta', null);\n  const id = lodashGet(rowData, 'tableMetaInfo.signal.id', undefined);\n\n  const saveXHandler = useCallback(\n    (event) => {\n      const value = event.target.value;\n      dispatch({\n        type: CHANGE_ZONE_SIGNAL_VALUE,\n        payload: {\n          zoneID: rowData.id,\n          signal: { id, x: value },\n        },\n      });\n    },\n    [dispatch, id, rowData.id],\n  );\n  const saveYHandler = useCallback(\n    (event) => {\n      const value = event.target.value;\n      dispatch({\n        type: CHANGE_ZONE_SIGNAL_VALUE,\n        payload: {\n          zoneID: rowData.id,\n          signal: { id, y: value },\n        },\n      });\n    },\n    [dispatch, id, rowData.id],\n  );\n\n  return (\n    <Fragment>\n      <td {...onHoverSignalX}>\n        {signalDeltaX !== null ? (\n          <EditableColumn\n            value={signalDeltaX.toFixed(2)}\n            onSave={saveXHandler}\n            type=\"number\"\n            style={{ padding: '0.1rem 0.4rem' }}\n          />\n        ) : (\n          ''\n        )}\n      </td>\n      <td {...onHoverSignalY}>\n        {signalDeltaY !== null ? (\n          <EditableColumn\n            value={signalDeltaY.toFixed(2)}\n            onSave={saveYHandler}\n            type=\"number\"\n            style={{ padding: '0.1rem 0.4rem' }}\n          />\n        ) : (\n          ''\n        )}\n      </td>\n    </Fragment>\n  );\n}\n\nexport default SignalDeltaColumn;\n","import lodashGet from 'lodash/get';\nimport { FaMinusCircle } from 'react-icons/fa';\n\nfunction ZoneAssignmentColumn({\n  rowData,\n  assignment,\n  highlight,\n  onHover,\n  onClick,\n  onUnlink,\n  axis,\n  showUnlinkButton,\n  setShowUnlinkButton,\n  rowSpanTags,\n}) {\n  return (\n    <td\n      {...rowSpanTags}\n      {...onHover}\n      {...{ onClick: (e) => onClick(e, assignment, axis) }}\n    >\n      {lodashGet(rowData, `${axis}.pubIntegral`, 0) > 0 ? (\n        lodashGet(rowData, `${axis}.diaID`, []).length > 0 ? (\n          <div\n            onMouseEnter={() => setShowUnlinkButton(true)}\n            onMouseLeave={() => setShowUnlinkButton(false)}\n          >\n            {rowData[axis].pubIntegral} {`(`}\n            <span\n              style={\n                assignment.isActive & (assignment.activeAxis === axis) ||\n                assignment.isOnHover & (assignment.onHoverAxis === axis) ||\n                highlight.isActive\n                  ? {\n                      color: 'red',\n                      fontWeight: 'bold',\n                    }\n                  : { color: 'black', fontWeight: 'normal' }\n              }\n            >\n              {lodashGet(rowData, `${axis}.diaID`, []).length}\n            </span>\n            {`)`}{' '}\n            <sup>\n              <button\n                type=\"button\"\n                style={{\n                  visibility: showUnlinkButton ? 'visible' : 'hidden',\n                  padding: 0,\n                  margin: 0,\n                }}\n                onClick={(e) => onUnlink(e, true, axis)}\n              >\n                <FaMinusCircle color=\"red\" />\n              </button>\n            </sup>\n          </div>\n        ) : assignment.isActive && assignment.activeAxis === axis ? (\n          <div>\n            {`${lodashGet(rowData, `${axis}.pubIntegral`, '')} (`}\n            <span\n              style={{\n                color: 'red',\n                fontWeight: 'bold',\n              }}\n            >\n              0\n            </span>\n            {')'}\n          </div>\n        ) : (\n          rowData[axis].pubIntegral\n        )\n      ) : assignment.isActive && assignment.activeAxis === axis ? (\n        <div>\n          {'0 ('}\n          <span style={{ color: 'red', fontWeight: 'bold' }}>0</span>\n          {')'}\n        </div>\n      ) : (\n        ''\n      )}\n    </td>\n  );\n}\n\nexport default ZoneAssignmentColumn;\n","import { Fragment } from 'react';\n\nimport ZoneAssignmentColumn from './ZoneAssignmentsColumn';\n\nfunction ZoneAssignmentsColumns({\n  rowData,\n  assignmentZone,\n  onHoverZoneX,\n  onHoverZoneY,\n  showUnlinkButtonZoneX,\n  showUnlinkButtonZoneY,\n  setShowUnlinkButtonZoneX,\n  setShowUnlinkButtonZoneY,\n  rowSpanTags,\n  onClick,\n  onUnlink,\n  highlightZoneX,\n  highlightZoneY,\n}) {\n  return (\n    <Fragment>\n      <ZoneAssignmentColumn\n        rowData={rowData}\n        assignment={assignmentZone}\n        highlight={highlightZoneX}\n        onHover={onHoverZoneX}\n        onClick={onClick}\n        onUnlink={onUnlink}\n        axis={'x'}\n        showUnlinkButton={showUnlinkButtonZoneX}\n        setShowUnlinkButton={setShowUnlinkButtonZoneX}\n        rowSpanTags={rowSpanTags}\n      />\n      <ZoneAssignmentColumn\n        rowData={rowData}\n        assignment={assignmentZone}\n        highlight={highlightZoneY}\n        onHover={onHoverZoneY}\n        onClick={onClick}\n        onUnlink={onUnlink}\n        axis={'y'}\n        showUnlinkButton={showUnlinkButtonZoneY}\n        setShowUnlinkButton={setShowUnlinkButtonZoneY}\n        rowSpanTags={rowSpanTags}\n      />\n    </Fragment>\n  );\n}\n\nexport default ZoneAssignmentsColumns;\n","/** @jsxImportSource @emotion/react */\n\nimport lodashGet from 'lodash/get';\nimport { useMemo, useCallback, useState } from 'react';\n\nimport { buildID } from '../../../data/utilities/Concatenation';\nimport { useAssignment } from '../../assignment';\nimport { useHighlight } from '../../highlight';\n\nimport ActionsColumn from './TableColumns/ActionsColumn';\nimport SignalAssignmentsColumns from './TableColumns/SignalAssignmentsColumns';\nimport SignalDeltaColumn from './TableColumns/SignalDeltaColumn';\nimport ZoneAssignmentsColumns from './TableColumns/ZoneAssignmentsColumns';\n\nconst HighlightedRowStyle = { backgroundColor: '#ff6f0057' };\n\nconst ConstantlyHighlightedRowStyle = { backgroundColor: '#f5f5dc' };\n\nfunction ZonesTableRow({ rowData, onUnlink, onContextMenu }) {\n  const assignmentZone = useAssignment(rowData.id);\n  const highlightZone = useHighlight([assignmentZone.id]);\n  const highlightZoneX = useHighlight(\n    [buildID(assignmentZone.id, 'X')].concat(assignmentZone.assigned.x || []),\n  );\n  const highlightZoneY = useHighlight(\n    [buildID(assignmentZone.id, 'Y')].concat(assignmentZone.assigned.y || []),\n  );\n\n  const assignmentSignal = useAssignment(rowData.tableMetaInfo.id);\n  const highlightSignalX = useHighlight(\n    [buildID(assignmentSignal.id, 'X')].concat(\n      assignmentSignal.assigned.x || [],\n      buildID(assignmentSignal.id, 'Crosshair'),\n    ),\n  );\n  const highlightSignalY = useHighlight(\n    [buildID(assignmentSignal.id, 'Y')].concat(\n      assignmentSignal.assigned.y || [],\n      buildID(assignmentSignal.id, 'Crosshair'),\n    ),\n  );\n\n  const [showUnlinkButtonZoneX, setShowUnlinkButtonZoneX] = useState(false);\n  const [showUnlinkButtonZoneY, setShowUnlinkButtonZoneY] = useState(false);\n  const [showUnlinkButtonSignalX, setShowUnlinkButtonSignalX] = useState(false);\n  const [showUnlinkButtonSignalY, setShowUnlinkButtonSignalY] = useState(false);\n\n  const rowSpanTags = useMemo(() => {\n    return {\n      rowSpan: rowData.tableMetaInfo.rowSpan,\n      style:\n        lodashGet(rowData, 'tableMetaInfo.hide', false) === true\n          ? { display: 'none' }\n          : null,\n    };\n  }, [rowData]);\n\n  const unlinkHandler = useCallback(\n    (e, isOnZoneLevel, axis) => {\n      // event handling here in case of unlink button clicked\n      if (e) {\n        e.stopPropagation();\n      }\n      onUnlink(rowData, isOnZoneLevel, rowData.tableMetaInfo.signalIndex, axis);\n      if (axis === 'x') {\n        if (isOnZoneLevel !== undefined) {\n          if (isOnZoneLevel) {\n            setShowUnlinkButtonZoneX(false);\n            assignmentZone.removeAll('x');\n          } else {\n            setShowUnlinkButtonSignalX(false);\n            assignmentSignal.removeAll('x');\n          }\n        } else {\n          setShowUnlinkButtonZoneX(false);\n          setShowUnlinkButtonSignalX(false);\n        }\n      } else if (axis === 'y') {\n        if (isOnZoneLevel !== undefined) {\n          if (isOnZoneLevel) {\n            setShowUnlinkButtonZoneY(false);\n            assignmentZone.removeAll('y');\n          } else {\n            setShowUnlinkButtonSignalY(false);\n            assignmentSignal.removeAll('y');\n          }\n        } else {\n          setShowUnlinkButtonZoneY(false);\n          setShowUnlinkButtonSignalY(false);\n        }\n      } else {\n        setShowUnlinkButtonZoneX(false);\n        assignmentZone.removeAll('x');\n        setShowUnlinkButtonSignalX(false);\n        assignmentSignal.removeAll('x');\n        setShowUnlinkButtonZoneY(false);\n        assignmentZone.removeAll('y');\n        setShowUnlinkButtonSignalY(false);\n        assignmentSignal.removeAll('y');\n      }\n    },\n    [assignmentSignal, assignmentZone, onUnlink, rowData],\n  );\n\n  const clickHandler = useCallback((e, assignment, axis) => {\n    e.stopPropagation();\n    assignment.onClick(axis);\n  }, []);\n\n  const onHoverZoneX = useMemo(() => {\n    return {\n      onMouseEnter: () => {\n        assignmentZone.onMouseEnter('x');\n        highlightZoneX.show();\n      },\n      onMouseLeave: () => {\n        assignmentZone.onMouseLeave('x');\n        highlightZoneX.hide();\n      },\n    };\n  }, [assignmentZone, highlightZoneX]);\n\n  const onHoverZoneY = useMemo(() => {\n    return {\n      onMouseEnter: () => {\n        assignmentZone.onMouseEnter('y');\n        highlightZoneY.show();\n      },\n      onMouseLeave: () => {\n        assignmentZone.onMouseLeave('y');\n        highlightZoneY.hide();\n      },\n    };\n  }, [assignmentZone, highlightZoneY]);\n\n  const onHoverSignalX = useMemo(() => {\n    return {\n      onMouseEnter: () => {\n        assignmentSignal.onMouseEnter('x');\n        highlightSignalX.show();\n      },\n      onMouseLeave: () => {\n        assignmentSignal.onMouseLeave('x');\n        highlightSignalX.hide();\n      },\n    };\n  }, [assignmentSignal, highlightSignalX]);\n\n  const onHoverSignalY = useMemo(() => {\n    return {\n      onMouseEnter: () => {\n        assignmentSignal.onMouseEnter('y');\n        highlightSignalY.show();\n      },\n      onMouseLeave: () => {\n        assignmentSignal.onMouseLeave('y');\n        highlightSignalY.hide();\n      },\n    };\n  }, [assignmentSignal, highlightSignalY]);\n\n  return (\n    <tr\n      onContextMenu={(e) => onContextMenu(e, rowData)}\n      style={\n        highlightZone.isActive || assignmentZone.isActive\n          ? HighlightedRowStyle\n          : lodashGet(\n              rowData,\n              'tableMetaInfo.isConstantlyHighlighted',\n              false,\n            ) === true\n          ? ConstantlyHighlightedRowStyle\n          : null\n      }\n      {...highlightZone.onHover}\n    >\n      <td {...rowSpanTags}>{rowData.tableMetaInfo.rowIndex + 1}</td>\n      <SignalDeltaColumn\n        rowData={rowData}\n        onHoverSignalX={onHoverSignalX}\n        onHoverSignalY={onHoverSignalY}\n      />\n      <SignalAssignmentsColumns\n        rowData={rowData}\n        assignmentSignal={assignmentSignal}\n        onHoverSignalX={onHoverSignalX}\n        onHoverSignalY={onHoverSignalY}\n        showUnlinkButtonSignalX={showUnlinkButtonSignalX}\n        showUnlinkButtonSignalY={showUnlinkButtonSignalY}\n        setShowUnlinkButtonSignalX={(show) => setShowUnlinkButtonSignalX(show)}\n        setShowUnlinkButtonSignalY={(show) => setShowUnlinkButtonSignalY(show)}\n        onClick={clickHandler}\n        onUnlink={unlinkHandler}\n        highlightSignalX={highlightSignalX}\n        highlightSignalY={highlightSignalY}\n      />\n      <ZoneAssignmentsColumns\n        rowData={rowData}\n        assignmentZone={assignmentZone}\n        onHoverZoneX={onHoverZoneX}\n        onHoverZoneY={onHoverZoneY}\n        showUnlinkButtonZoneX={showUnlinkButtonZoneX}\n        showUnlinkButtonZoneY={showUnlinkButtonZoneY}\n        setShowUnlinkButtonZoneX={(show) => setShowUnlinkButtonZoneX(show)}\n        setShowUnlinkButtonZoneY={(show) => setShowUnlinkButtonZoneY(show)}\n        rowSpanTags={rowSpanTags}\n        onClick={clickHandler}\n        onUnlink={unlinkHandler}\n        highlightZoneX={highlightZoneX}\n        highlightZoneY={highlightZoneY}\n      />\n      <ActionsColumn rowData={rowData} rowSpanTags={rowSpanTags} />\n    </tr>\n  );\n}\n\nexport default ZonesTableRow;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useMemo, useCallback, useRef } from 'react';\nimport { FaLink } from 'react-icons/fa';\n\nimport checkModifierKeyActivated from '../../../data/utilities/checkModifierKeyActivated';\nimport ContextMenu from '../../elements/ContextMenu';\n\nimport ZonesTableRow from './ZonesTableRow';\n\nconst tableStyle = css`\n  border-spacing: 0;\n  border: 1px solid #dedede;\n  width: 100%;\n  font-size: 12px;\n  height: 100%;\n  .react-contextmenu-wrapper {\n    display: contents;\n  }\n  tr {\n    :last-child {\n      td {\n        border-bottom: 0;\n      }\n    }\n  }\n  th,\n  td {\n    white-space: nowrap;\n    text-align: center;\n    margin: 0;\n    padding: 0.1rem 0.4rem;\n    border-bottom: 1px solid #dedede;\n    border-right: 1px solid #dedede;\n\n    :last-child {\n      border-right: 0;\n    }\n    button {\n      background-color: transparent;\n      border: none;\n      padding: 0 5px;\n    }\n  }\n`;\n\nfunction ZonesTable({ tableData, onUnlink, context, nuclei, preferences }) {\n  const contextRef = useRef();\n\n  const contextMenuHandler = useCallback(\n    (e, rowData) => {\n      if (!checkModifierKeyActivated(e)) {\n        e.preventDefault();\n        contextRef.current.handleContextMenu(e, rowData);\n      }\n    },\n    [contextRef],\n  );\n\n  const data = useMemo(() => {\n    const _data = [];\n    tableData.forEach((zone, i) => {\n      if (zone.signal.length === 1) {\n        _data.push({\n          ...zone,\n          tableMetaInfo: {\n            ...zone.tableMetaInfo,\n            signal: zone.signal[0],\n            rowIndex: i,\n            signalIndex: 0,\n            id: zone.signal[0].id,\n          },\n        });\n      } else if (zone.signal.length > 1) {\n        zone.signal.forEach((signal, j) => {\n          let hide = false;\n          let rowSpan = null;\n          if (j < zone.signal.length - 1) {\n            if (j === 0) {\n              rowSpan = zone.signal.length;\n            } else {\n              hide = true;\n            }\n          } else {\n            hide = true;\n          }\n          _data.push({\n            ...zone,\n            tableMetaInfo: {\n              ...zone.tableMetaInfo,\n              signal,\n              rowSpan,\n              hide,\n              rowIndex: i,\n              signalIndex: j,\n              id: signal.id,\n            },\n          });\n        });\n      }\n    });\n\n    return _data;\n  }, [tableData]);\n\n  const rows = useMemo(\n    () =>\n      data.map((rowData) => (\n        <ZonesTableRow\n          key={`zonesTableRow_${rowData.tableMetaInfo.id}`}\n          rowData={rowData}\n          onUnlink={onUnlink}\n          onContextMenu={(e, rowData) => contextMenuHandler(e, rowData)}\n          preferences={preferences}\n        />\n      )),\n    [contextMenuHandler, data, onUnlink, preferences],\n  );\n\n  return (\n    <div>\n      <table css={tableStyle}>\n        <tbody>\n          <tr>\n            <th rowSpan={2}>#</th>\n            <th colSpan={2}> (ppm)</th>\n            <th colSpan={2}>\n              <FaLink />\n            </th>\n            <th colSpan={2}></th>\n            <th rowSpan={2}>Kind</th>\n            <th rowSpan={2}>{''}</th>\n          </tr>\n          <tr>\n            <th>{nuclei[0]}</th>\n            <th>{nuclei[1]}</th>\n            <th>{nuclei[0]}</th>\n            <th>{nuclei[1]}</th>\n            <th>{nuclei[0]}</th>\n            <th>{nuclei[1]}</th>\n          </tr>\n          {rows}\n        </tbody>\n      </table>\n      <ContextMenu ref={contextRef} context={context} />\n    </div>\n  );\n}\n\nexport default ZonesTable;\n","import lodashGet from 'lodash/get';\nimport { useState, useMemo, useCallback, useRef, memo } from 'react';\nimport ReactCardFlip from 'react-card-flip';\nimport { FaUnlink } from 'react-icons/fa';\n\nimport { useAssignmentData } from '../../assignment';\nimport { useDispatch } from '../../context/DispatchContext';\nimport ToggleButton from '../../elements/ToggleButton';\nimport ToolTip from '../../elements/ToolTip/ToolTip';\nimport { useModal } from '../../elements/popup/Modal';\nimport ZonesWrapper from '../../hoc/ZonesWrapper';\nimport { DELETE_2D_ZONE, UNLINK_ZONE } from '../../reducer/types/Types';\nimport Events from '../../utility/Events';\nimport NoTableData from '../extra/placeholder/NoTableData';\nimport DefaultPanelHeader from '../header/DefaultPanelHeader';\nimport PreferencesHeader from '../header/PreferencesHeader';\n\nimport ZonesPreferences from './ZonesPreferences';\nimport ZonesTable from './ZonesTable';\n\nconst styles = {\n  container: {\n    flexDirection: 'column',\n    height: '100%',\n    display: 'flex',\n  },\n  removeAssignmentsButton: {\n    borderRadius: '5px',\n    marginTop: '3px',\n    marginLeft: '2px',\n    border: 'none',\n    height: '16px',\n    width: '18px',\n    fontSize: '12px',\n    padding: 0,\n    backgroundColor: 'transparent',\n  },\n  button: {\n    backgroundColor: 'transparent',\n    border: 'none',\n  },\n  toggle: {\n    width: '22px',\n    height: '22px',\n    marginLeft: '2px',\n    display: 'flex',\n    justifyContent: 'center',\n    alignItems: 'center',\n  },\n};\n\nfunction ZonesPanel({ zones, activeTab, preferences, xDomain, yDomain }) {\n  const [filterIsActive, setFilterIsActive] = useState(false);\n\n  const assignmentData = useAssignmentData();\n\n  const dispatch = useDispatch();\n  const modal = useModal();\n  const [isFlipped, setFlipStatus] = useState(false);\n  const settingRef = useRef();\n\n  const tableData = useMemo(() => {\n    const isInView = (xFrom, xTo, yFrom, yTo) => {\n      const factor = 10000;\n      xFrom = xFrom * factor;\n      xTo = xTo * factor;\n      yFrom = yFrom * factor;\n      yTo = yTo * factor;\n      return (\n        ((xTo >= xDomain[0] * factor && xFrom <= xDomain[1] * factor) ||\n          (xFrom <= xDomain[0] * factor && xTo >= xDomain[1] * factor)) &&\n        ((yTo >= yDomain[0] * factor && yFrom <= yDomain[1] * factor) ||\n          (yFrom <= yDomain[0] * factor && yTo >= yDomain[1] * factor))\n      );\n    };\n\n    const getFilteredZones = (zones) => {\n      return zones.filter((zone) => {\n        return isInView(zone.x.from, zone.x.to, zone.y.from, zone.y.to);\n      });\n    };\n    if (zones.values) {\n      const _zones = filterIsActive\n        ? getFilteredZones(zones.values)\n        : zones.values;\n\n      return _zones.map((zone) => {\n        return {\n          ...zone,\n          tableMetaInfo: {\n            isConstantlyHighlighted: isInView(\n              zone.x.from,\n              zone.x.to,\n              zone.y.from,\n              zone.y.to,\n            ),\n          },\n        };\n      });\n    }\n  }, [zones, filterIsActive, xDomain, yDomain]);\n\n  const handleOnFilter = useCallback(() => {\n    setFilterIsActive(!filterIsActive);\n  }, [filterIsActive]);\n\n  const unlinkZoneHandler = useCallback(\n    (zoneData, isOnZoneLevel, signalIndex, axis) => {\n      dispatch({\n        type: UNLINK_ZONE,\n        payload: {\n          zoneData,\n          assignmentData,\n          isOnZoneLevel,\n          signalIndex,\n          axis,\n        },\n      });\n    },\n    [assignmentData, dispatch],\n  );\n\n  const removeAssignments = useCallback(() => {\n    zones.values.forEach((zone) => unlinkZoneHandler(zone));\n  }, [zones.values, unlinkZoneHandler]);\n\n  const handleOnRemoveAssignments = useCallback(() => {\n    modal.showConfirmDialog('All assignments will be removed. Are you sure?', {\n      onYes: removeAssignments,\n    });\n  }, [removeAssignments, modal]);\n\n  const handleDeleteAll = useCallback(() => {\n    modal.showConfirmDialog('All zones will be deleted. Are You sure?', {\n      onYes: () => {\n        dispatch({ type: DELETE_2D_ZONE, payload: { assignmentData } });\n      },\n    });\n  }, [assignmentData, dispatch, modal]);\n\n  const zonesPreferences = useMemo(() => {\n    const _preferences = lodashGet(preferences, `panels.zones.[${activeTab}]`);\n\n    return _preferences;\n  }, [activeTab, preferences]);\n\n  const settingsPanelHandler = useCallback(() => {\n    setFlipStatus(!isFlipped);\n  }, [isFlipped]);\n\n  const saveSettingHandler = useCallback(() => {\n    settingRef.current.saveSetting();\n    setFlipStatus(false);\n  }, []);\n\n  const visibilityHandler = useCallback((key) => {\n    Events.emit('onZonesVisibilityChange', { key });\n  }, []);\n\n  return (\n    <>\n      <div style={styles.container}>\n        {!isFlipped && (\n          <DefaultPanelHeader\n            counter={zones.values ? zones.values.length : 0}\n            onDelete={handleDeleteAll}\n            deleteToolTip=\"Delete All Zones\"\n            onFilter={handleOnFilter}\n            filterToolTip={\n              filterIsActive ? 'Show all zones' : 'Hide zones out of view'\n            }\n            filterIsActive={filterIsActive}\n            counterFiltered={tableData && tableData.length}\n            showSettingButton=\"true\"\n            onSettingClick={settingsPanelHandler}\n          >\n            <ToolTip title={`Remove all Assignments`} popupPlacement=\"right\">\n              <button\n                style={styles.removeAssignmentsButton}\n                type=\"button\"\n                onClick={handleOnRemoveAssignments}\n                disabled={!zones.values || zones.values.length === 0}\n              >\n                <FaUnlink />\n              </button>\n            </ToolTip>\n            <ToggleButton\n              popupTitle=\"show/hide zones\"\n              popupPlacement=\"right\"\n              style={styles.toggle}\n              defaultValue\n              onClick={() => visibilityHandler('zones')}\n            >\n              <span style={{ fontSize: '12px', pointerEvents: 'none' }}>z</span>\n            </ToggleButton>\n            <ToggleButton\n              popupTitle=\"show/hide signals\"\n              popupPlacement=\"right\"\n              style={styles.toggle}\n              defaultValue\n              onClick={() => visibilityHandler('signals')}\n            >\n              <span style={{ fontSize: '12px', pointerEvents: 'none' }}>s</span>\n            </ToggleButton>\n            <ToggleButton\n              popupTitle=\"show/hide peaks\"\n              popupPlacement=\"right\"\n              style={styles.toggle}\n              defaultValue\n              onClick={() => visibilityHandler('peaks')}\n            >\n              <span style={{ fontSize: '12px', pointerEvents: 'none' }}>p</span>\n            </ToggleButton>\n          </DefaultPanelHeader>\n        )}\n        {isFlipped && (\n          <PreferencesHeader\n            onSave={saveSettingHandler}\n            onClose={settingsPanelHandler}\n          />\n        )}\n        <div style={{ height: '100%', overflow: 'auto' }}>\n          <ReactCardFlip\n            isFlipped={isFlipped}\n            infinite\n            containerStyle={{ overflow: 'hidden' }}\n          >\n            <div>\n              {tableData && tableData.length > 0 ? (\n                <ZonesTable\n                  tableData={tableData}\n                  onUnlink={unlinkZoneHandler}\n                  preferences={zonesPreferences}\n                  nuclei={\n                    activeTab && activeTab.split(',').length === 2\n                      ? activeTab.split(',')\n                      : ['?', '?']\n                  }\n                />\n              ) : (\n                <NoTableData />\n              )}\n            </div>\n            <ZonesPreferences ref={settingRef} />\n          </ReactCardFlip>\n        </div>\n      </div>\n    </>\n  );\n}\n\nexport default ZonesWrapper(memo(ZonesPanel));\n","import { memo } from 'react';\n\nconst styles = {\n  width: '100%',\n  height: '100%',\n  padding: '0px',\n  display: 'flex',\n  flexDirection: 'column',\n};\nfunction Table({ children, className, style }) {\n  return (\n    <div className={className} style={{ ...styles, ...style }}>\n      {children}\n    </div>\n  );\n}\n\nexport default memo(Table);\n","import { useMemo, memo, Children, cloneElement } from 'react';\n\nconst styles = {\n  width: '100%',\n  overflowY: 'auto',\n  display: 'flex',\n  flexDirection: 'column',\n  padding: '5px 0px',\n  color: 'gray',\n};\nfunction TableBody({ children, className, style }) {\n  const mappedChildren = useMemo(() => {\n    return Children.map(children, (child) =>\n      cloneElement(child, {\n        style: { borderBottom: '0.55px solid #d8d8d8', ...child.props.style },\n      }),\n    );\n  }, [children]);\n\n  return (\n    <div className={className} style={{ ...styles, style }}>\n      {mappedChildren}\n    </div>\n  );\n}\n\nexport default memo(TableBody);\n","import { memo } from 'react';\n\nconst styles = {\n  width: '100%',\n  display: 'flex',\n  alignItems: 'flex-start',\n};\n\nfunction getVAlign(align) {\n  if (align.toLowerCase() === 'top') {\n    return 'flex-start';\n  } else if (align.toLowerCase() === 'bottom') {\n    return 'flex-end';\n  }\n  return 'center';\n}\nfunction TableHeader({\n  children,\n  className,\n  style,\n  align = 'center',\n  vAlign = 'center',\n  size = 1,\n  onClick,\n}) {\n  return (\n    <div\n      className={className}\n      style={{\n        ...styles,\n        alignItems: getVAlign(vAlign),\n        textAlign: align,\n        flex: size,\n        ...style,\n      }}\n      onClick={onClick}\n    >\n      {children}\n    </div>\n  );\n}\n\nTableHeader.defaultProps = {\n  onClick: () => null,\n};\n\nexport default memo(TableHeader);\n","import { memo } from 'react';\n\nconst styles = {\n  width: '100%',\n  display: 'flex',\n  padding: '0px 5px',\n  color: '#424242',\n  backgroundColor: '#d8d8d8',\n  borderBottom: '0.55px solid #d8d8d8',\n  fontSize: 11,\n  fontWeight: 'bold',\n};\nfunction TableHead({ children, className, style }) {\n  return (\n    <div className={className} style={{ ...styles, ...style }}>\n      {children}\n    </div>\n  );\n}\n\nexport default memo(TableHead);\n","import { memo } from 'react';\n\nconst styles = {\n  width: '100%',\n  display: 'flex',\n  padding: '5px 0px',\n};\nfunction TableHeader({ children, className, style, onClick }) {\n  return (\n    <div\n      className={className}\n      style={{ ...styles, ...style }}\n      onClick={onClick}\n    >\n      {children}\n    </div>\n  );\n}\n\nTableHeader.defaultProps = {\n  onClick: () => null,\n};\n\nexport default memo(TableHeader);\n","import { forwardRef, useMemo } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\n\nfunction FiltersWrapper(WrappedComponent) {\n  const Wrapper = (props) => {\n    const { data, activeSpectrum } = useChartData();\n\n    const { filters = [] } = useMemo(() => {\n      if (data && activeSpectrum && activeSpectrum.id) {\n        const datum = data.find((datum) => datum.id === activeSpectrum.id) || {\n          filters: [],\n        };\n        return datum;\n      }\n      return {};\n    }, [activeSpectrum, data]);\n    const { forwardedRef, ...rest } = props;\n    return <WrappedComponent {...rest} filters={filters} ref={forwardedRef} />;\n  };\n\n  return forwardRef((props, ref) => {\n    return <Wrapper {...props} forwardedRef={ref} />;\n  });\n}\nexport default FiltersWrapper;\n","import { useMemo, useCallback, memo, useState } from 'react';\nimport { FaRegTrashAlt } from 'react-icons/fa';\nimport { ObjectInspector } from 'react-inspector';\n\nimport { useDispatch } from '../../context/DispatchContext';\nimport CheckBox from '../../elements/CheckBox';\nimport { TableCell, TableRow } from '../../elements/Table';\nimport {\n  ENABLE_FILTER,\n  DELETE_FILTER,\n  SET_FILTER_SNAPSHOT,\n} from '../../reducer/types/Types';\n\nconst styles = {\n  button: {\n    backgroundColor: 'transparent',\n    border: 'none',\n    height: 25,\n    width: 25,\n    padding: '5px',\n  },\n  active: {\n    backgroundColor: '#fbfbfb',\n    borderTop: '1px solid #817066',\n    borderBottom: '1px solid #817066',\n  },\n};\nfunction FiltersTableRow({ filters }) {\n  const dispatch = useDispatch();\n  const [selectedFilterID, setSelectedFilter] = useState();\n\n  const handelFilterCheck = useCallback(\n    (id, checked) => {\n      dispatch({ type: ENABLE_FILTER, id, checked });\n    },\n    [dispatch],\n  );\n  const handelDeleteFilter = useCallback(\n    (id) => {\n      dispatch({ type: DELETE_FILTER, id });\n    },\n    [dispatch],\n  );\n  const filterSnapShotHandler = useCallback(\n    (newID) => {\n      setSelectedFilter((prevId) => {\n        const id = prevId === newID ? null : newID;\n        dispatch({ type: SET_FILTER_SNAPSHOT, id });\n        return id;\n      });\n    },\n    [dispatch],\n  );\n  const filtersTableRow = useMemo(() => {\n    return (\n      filters &&\n      filters.map((d) => (\n        <TableRow\n          key={d.id}\n          style={d.id === selectedFilterID ? { ...styles.active } : {}}\n        >\n          <TableCell\n            align=\"center\"\n            size=\"2\"\n            onClick={() => filterSnapShotHandler(d.id)}\n          >\n            {d.label}\n          </TableCell>\n          <TableCell align=\"left\" size=\"3\">\n            <div onClick={(e) => e.stopPropagation()}>\n              <ObjectInspector data={d.error ? d.error : d.value} />\n            </div>\n          </TableCell>\n          <TableCell align=\"center\" vAlign=\"center\" size=\"1\">\n            <CheckBox\n              checked={d.flag}\n              onChange={(event) =>\n                handelFilterCheck(d.id, event.target.checked)\n              }\n            />\n            {d.isDeleteAllow && (\n              <button\n                style={styles.button}\n                type=\"button\"\n                onClick={() => handelDeleteFilter(d.id)}\n              >\n                <FaRegTrashAlt />\n              </button>\n            )}\n          </TableCell>\n        </TableRow>\n      ))\n    );\n  }, [\n    filterSnapShotHandler,\n    filters,\n    handelDeleteFilter,\n    handelFilterCheck,\n    selectedFilterID,\n  ]);\n  return filtersTableRow;\n}\n\nexport default memo(FiltersTableRow);\n","import { useMemo, memo } from 'react';\n\nimport {\n  Table,\n  TableHead,\n  TableCell,\n  TableBody,\n  TableRow,\n} from '../../elements/Table';\nimport FiltersWrapper from '../../hoc/FiltersWrapper';\nimport NoTableData from '../extra/placeholder/NoTableData';\n\nimport FiltersTableRow from './FiltersTableRow';\n\nfunction FilterPanel({ filters }) {\n  const filtersTable = useMemo(() => {\n    return filters ? (\n      <Table>\n        <TableHead>\n          <TableRow>\n            <TableCell align=\"center\" size=\"1\">\n              Label\n            </TableCell>\n            <TableCell align=\"center\" size=\"2\">\n              Properties\n            </TableCell>\n          </TableRow>\n        </TableHead>\n        <TableBody>\n          <FiltersTableRow filters={filters} />\n        </TableBody>\n      </Table>\n    ) : (\n      <NoTableData />\n    );\n  }, [filters]);\n\n  return filtersTable;\n}\n\nexport default FiltersWrapper(memo(FilterPanel));\n","import lodashGet from 'lodash/get';\nimport { useCallback, useState, useEffect, memo } from 'react';\n\nimport { usePreferences } from '../context/PreferencesContext';\nimport { Accordion, AccordionItem } from '../elements/accordion';\nimport { DISPLAYER_MODE } from '../reducer/core/Constants';\nimport { options } from '../toolbar/ToolTypes';\n\nimport InformationPanel from './InformationPanel';\nimport IntegralPanel from './IntegralsPanel/IntegralPanel';\nimport MoleculePanel from './MoleculesPanel/MoleculePanel';\nimport MultipleSpectraAnalysisPanel from './MultipleSpectraAnalysisPanel/MultipleSpectraAnalysisPanel';\nimport PeaksPanel from './PeaksPanel/PeaksPanel';\nimport RangesPanel from './RangesPanel/RangesPanel';\nimport SpectrumListPanel from './SpectrumsPanel/SpectrumListPanel';\nimport SummaryPanel from './SummaryPanel/SummaryPanel';\nimport ZonesPanel from './ZonesPanel/ZonesPanel';\nimport FilterPanel from './filtersPanel/FilterPanel';\n\nconst accordionItems = [\n  {\n    title: 'Spectra',\n    component: <SpectrumListPanel />,\n    openWhen: null,\n    style: '',\n    hidePreferenceKey: 'hideSpectraPanel',\n    mode: null,\n  },\n  {\n    title: 'Information',\n    component: <InformationPanel />,\n    openWhen: null,\n    style: { overflow: 'hidden' },\n    hidePreferenceKey: 'hideInformationPanel',\n    mode: null,\n  },\n  {\n    title: 'Peaks',\n    component: <PeaksPanel />,\n    openWhen: [options.peakPicking.id],\n    style: '',\n    hidePreferenceKey: 'hidePeaksPanel',\n    mode: null,\n  },\n  {\n    title: 'Filters',\n    component: <FilterPanel />,\n    openWhen: null,\n    style: '',\n    hidePreferenceKey: 'hideFiltersPanel',\n    mode: null,\n  },\n  {\n    title: 'Integrals',\n    component: <IntegralPanel />,\n    openWhen: [options.integral.id],\n    style: '',\n    hidePreferenceKey: 'hideIntegralsPanel',\n    mode: null,\n  },\n  {\n    title: 'Ranges',\n    component: <RangesPanel />,\n    openWhen: [options.rangesPicking.id],\n    style: '',\n    hidePreferenceKey: 'hideRangesPanel',\n    mode: DISPLAYER_MODE.DM_1D,\n  },\n  {\n    title: 'Multiple Spectra Analysis',\n    component: <MultipleSpectraAnalysisPanel />,\n    openWhen: [options.multipleSpectraAnalysis.id],\n    style: '',\n    hidePreferenceKey: 'hideMultipleSpectraAnalysisPanel',\n    mode: null,\n  },\n  {\n    title: 'Zones',\n    component: <ZonesPanel />,\n    openWhen: [options.zone2D.id],\n    style: '',\n    hidePreferenceKey: 'hideZonesPanel',\n    mode: DISPLAYER_MODE.DM_2D,\n  },\n  {\n    title: 'Summary',\n    component: <SummaryPanel />,\n    openWhen: [],\n    style: '',\n    hidePreferenceKey: 'hideSummaryPanel',\n    mode: null,\n  },\n  {\n    title: 'Structures',\n    component: <MoleculePanel />,\n    openWhen: [options.rangesPicking.id],\n    style: '',\n    hidePreferenceKey: 'hideStructuresPanel',\n    mode: null,\n  },\n];\n\nfunction Panels({ selectedTool, displayerMode }) {\n  const [panelIndex, setSelectedPanelIndex] = useState(0);\n  const preferences = usePreferences();\n\n  useEffect(() => {\n    function getDefaultIndex() {\n      const index = accordionItems.findIndex(\n        (item) => item.openWhen && item.openWhen.includes(selectedTool),\n      );\n      return index !== -1 ? index : null;\n    }\n    const index = getDefaultIndex();\n    if (selectedTool) {\n      setSelectedPanelIndex(index);\n    }\n  }, [selectedTool]);\n\n  const check = useCallback(\n    (item) => {\n      return (\n        !lodashGet(preferences, `display.panels.${item.hidePreferenceKey}`) &&\n        (item.mode == null || item.mode === displayerMode)\n      );\n    },\n    [displayerMode, preferences],\n  );\n\n  return (\n    <Accordion defaultOpenIndex={panelIndex}>\n      {accordionItems.map((item) => {\n        return (\n          check(item) && (\n            <AccordionItem\n              key={item.title}\n              title={item.title}\n              style={item.style}\n            >\n              {item.component}\n            </AccordionItem>\n          )\n        );\n      })}\n    </Accordion>\n  );\n}\n\nexport default memo(Panels);\n","import * as types from './types/Types';\n\nconst ignoreActions = [\n  types.APPLY_KEY_PREFERENCES,\n  types.BRUSH_END,\n  types.EXPORT_DATA,\n  types.RESET_DOMAIN,\n  types.RESET_SELECTED_TOOL,\n  types.SET_KEY_PREFERENCES,\n  types.SET_LOADING_FLAG,\n  types.SET_ORIGINAL_DOMAIN,\n  types.SET_SELECTED_FILTER,\n  types.SET_SELECTED_OPTIONS_PANEL,\n  types.SET_SELECTED_TOOL,\n  types.SET_SPECTRUMS_VERTICAL_ALIGN,\n  types.SET_VERTICAL_INDICATOR_X_POSITION,\n  types.SET_WIDTH,\n  types.SET_DIMENSIONS,\n  types.SET_X_DOMAIN,\n  types.SET_Y_DOMAIN,\n  types.SET_ZOOM_FACTOR,\n  types.TOGGLE_REAL_IMAGINARY_VISIBILITY,\n  types.CALCULATE_MANUAL_PHASE_CORRECTION_FILTER,\n  types.CHANGE_SPECTRUM_DISPLAY_VIEW_MODE,\n  types.FULL_ZOOM_OUT,\n  types.SAVE_AS_SVG,\n  types.SAVE_DATA_AS_JSON,\n  types.SET_ACTIVE_TAB,\n  types.CHANGE_VISIBILITY,\n  types.CHANGE_PEAKS_MARKERS_VISIBILITY,\n  types.CHANGE_ACTIVE_SPECTRUM,\n  types.CHANGE_INTEGRAL_ZOOM,\n  types.CHANGE_SPECTRUM_COLOR,\n];\n\nfunction checkActionType(type: string): boolean {\n  if (!ignoreActions.includes(type)) return true;\n  return false;\n}\n\nexport default checkActionType;\n","import { initiateDatum1D } from './Datum1D';\n\nexport function fromBruker(result, options = {}) {\n  const { dependentVariables, info, meta } = result;\n  let data = getData(dependentVariables[0].components);\n  if (data.im) info.isComplex = true;\n\n  if (Array.isArray(info.nucleus)) info.nucleus = info.nucleus[0];\n\n  const datum1D = initiateDatum1D({\n    ...options,\n    info,\n    meta,\n    data,\n    source: {\n      jcamp: null,\n      jcampURL: null,\n      original: data,\n    },\n  });\n\n  return datum1D;\n}\n\nexport function fromCSD(result, options = {}) {\n  let dimension = result.dimensions[0];\n  let dependentVariables = result.dependentVariables;\n\n  let quantityName = dimension.quantityName;\n  let n = dimension.count;\n  let incr = dimension.increment.magnitude;\n  let origin = dimension.originOffset.magnitude;\n  let offset = dimension.coordinatesOffset.magnitude;\n\n  let buffer = dependentVariables[0].components[0];\n  let re = [];\n  let im = [];\n  for (let i = buffer.length - 1; i > 0; i -= 2) {\n    re.push(buffer[i - 1]);\n    im.push(buffer[i]);\n  }\n\n  let data = {};\n  let i, x0;\n  switch (quantityName) {\n    case 'frequency':\n      x0 = 0 + (offset / origin) * 1000000;\n      i = (incr / origin) * 1000000;\n      data.re = re;\n      data.im = im;\n      break;\n    case 'time':\n      x0 = origin;\n      i = incr;\n      data.re = re.reverse();\n      data.im = im.reverse().map((z) => -z);\n      break;\n    default:\n      break;\n  }\n\n  let scale = [];\n  for (let x = 0; x < n; x++) {\n    scale.push(x0 + x * i);\n  }\n\n  data.x = scale;\n\n  const datum1D = initiateDatum1D({\n    ...options,\n    meta: options.meta,\n    data,\n    source: {\n      jcamp: null,\n      jcampURL: null,\n      original: data,\n    },\n  });\n  return datum1D;\n}\n\nexport function fromParsedJcamp(parsedJcamp, options = {}) {\n  const { dependentVariables, info, meta } = parsedJcamp;\n  let data = getData(dependentVariables[0].components);\n  if (Array.isArray(info.nucleus)) info.nucleus = info.nucleus[0];\n  const datum1D = initiateDatum1D({\n    ...options,\n    info,\n    meta,\n    data,\n    source: {\n      jcamp: null,\n      jcampURL:\n        options.source && options.source.jcampURL\n          ? options.source.jcampURL\n          : null,\n      original: data,\n    },\n  });\n\n  return datum1D;\n}\n\nfunction getData(spectra) {\n  let x =\n    spectra[0] && spectra[0].data && spectra[0].data.x ? spectra[0].data.x : [];\n  let re =\n    spectra[0] && spectra[0].data && spectra[0].data.y ? spectra[0].data.y : [];\n  let im =\n    spectra[1] && spectra[1].data && spectra[1].data.y\n      ? spectra[1].data.y\n      : null;\n\n  if (x[0] > x[1]) {\n    x.reverse();\n    re.reverse();\n    if (im) im.reverse();\n  }\n  return { x, re, im };\n}\n","import { initiateDatum2D } from './Datum2D';\n\nexport function fromParsedJcamp(parsedJcamp, options = {}) {\n  const { dependentVariables, info, meta } = parsedJcamp;\n  let data = dependentVariables[0].components;\n  const ob = initiateDatum2D({\n    ...options,\n    info,\n    meta,\n    data,\n    source: {\n      jcamp: null,\n      jcampURL:\n        options.source && options.source.jcampURL\n          ? options.source.jcampURL\n          : null,\n      original: data,\n    },\n  });\n  return ob;\n}\n\nexport function fromBruker(result, options = {}) {\n  const { dependentVariables, meta } = result;\n  let data = dependentVariables[0].components;\n  const datum2D = initiateDatum2D({\n    ...options,\n    meta,\n    data,\n    source: {\n      jcamp: null,\n      jcampURL: null,\n      original: data,\n    },\n  });\n\n  return datum2D;\n}\n\n// eslint-disable-next-line no-unused-vars\nexport function fromCSD(result, options = {}) {\n  const datum2D = initiateDatum2D({});\n  return datum2D;\n}\n","import { fromJEOL, fromJCAMP, fromBruker } from 'nmr-parser';\n\nimport * as Data1DManager from './data1d/Data1DManager';\nimport * as Datum1D from './data1d/Datum1D';\nimport * as Data2DManager from './data2d/Data2DManager';\nimport * as Datum2D from './data2d/Datum2D';\n\nexport function addJcampFromURL(spectra, jcampURL, options) {\n  // { credentials: 'include' }\n  return fetch(jcampURL)\n    .then((response) => response.text())\n    .then((jcamp) => {\n      addJcamp(spectra, jcamp, options);\n    });\n}\n\nexport function addJcamp(spectra, jcamp, options = {}) {\n  // need to parse the jcamp\n  let entries = fromJCAMP(jcamp, {\n    noContour: true,\n    xy: true,\n    keepRecordsRegExp: /.*/,\n    profiling: true,\n  });\n  if (entries.length === 0) return;\n  // Should be improved when we have a more complex case\n  for (let entry of entries) {\n    let { dependentVariables } = entry;\n    if (\n      dependentVariables[0].components &&\n      (dependentVariables[0].components.length > 0 ||\n        dependentVariables[0].components.z.length)\n    ) {\n      addJcampSS(spectra, entry, options);\n    }\n  }\n}\n\nfunction addJcampSS(spectra, entry, options) {\n  const dimension = entry.info.dimension;\n  if (dimension === 1) {\n    spectra.push(Data1DManager.fromParsedJcamp(entry, options));\n  }\n  if (dimension === 2) {\n    spectra.push(Data2DManager.fromParsedJcamp(entry, options));\n  }\n}\n\nfunction addData(spectra, datum) {\n  const dimension = datum.info.dimension;\n  if (dimension === 1) {\n    spectra.push(\n      Datum1D.initiateDatum1D({ ...datum, data: datum.source.original }),\n    );\n  }\n  if (dimension === 2) {\n    spectra.push(\n      Datum2D.initiateDatum2D({ ...datum, data: datum.source.original }),\n    );\n  }\n}\n\nexport function addJDF(spectra, jdf, options = {}) {\n  // need to parse the jcamp\n  let converted = fromJEOL(jdf, {});\n  let info = converted.description;\n  let metadata = info.metadata;\n  delete info.metadata;\n  info.acquisitionMode = 0;\n  info.experiment = info.dimension === 1 ? '1d' : '2d';\n  info.type = 'NMR SPECTRUM';\n  info.nucleus = info.nucleus[0];\n  info.numberOfPoints = info.numberOfPoints[0];\n  info.acquisitionTime = info.acquisitionTime[0];\n\n  info.baseFrequency = info.baseFrequency[0];\n  info.frequencyOffset = info.frequencyOffset[0];\n\n  info.spectralWidthClipped = converted.application.spectralWidthClipped;\n\n  if (info.dimension === 1) {\n    if (converted.dependentVariables) {\n      spectra.push(\n        Data1DManager.fromCSD(converted, {\n          ...options,\n          display: { ...options.display },\n          info: info,\n          meta: metadata,\n        }),\n      );\n    }\n  }\n  if (info.dimension === 2 && info.isFt) {\n    spectra.push(\n      Data2DManager.fromCSD(converted, {\n        ...options,\n        display: { ...options.display },\n        info,\n      }),\n    );\n  }\n}\n\nexport async function fromJSON(data = []) {\n  const spectra = [];\n  let promises = [];\n\n  for (let datum of data) {\n    if (datum.source.jcamp != null) {\n      addJcamp(spectra, datum.source.jcamp, datum);\n    } else if (datum.source.jcampURL != null) {\n      promises.push(addJcampFromURL(spectra, datum.source.jcampURL, datum));\n    } else {\n      addData(spectra, datum);\n    }\n  }\n  await Promise.all(promises);\n  return spectra;\n}\n\nexport async function addBruker(options, data) {\n  const spectra = [];\n  let result = await fromBruker(data, { xy: true, noContours: true });\n  let entries = result;\n  for (let entry of entries) {\n    let { info, dependentVariables } = entry;\n    if (info.dimension === 1) {\n      if (dependentVariables[0].components) {\n        spectra.push(\n          Data1DManager.fromBruker(entry, {\n            ...options,\n            display: { ...options.display },\n          }),\n        );\n      }\n    } else if (info.dimension === 2) {\n      if (info.isFt) {\n        spectra.push(\n          Data2DManager.fromBruker(entry, {\n            ...options,\n            info,\n            display: { ...options.display },\n          }),\n        );\n      } else {\n        // in case of 2D FID spectrum\n      }\n    }\n  }\n  return spectra;\n}\n\n// handle zip files\nexport async function fromZip(zipFiles) {\n  const spectra = [];\n  for (let zipFile of zipFiles) {\n    await addBruker(\n      spectra,\n      { display: { name: zipFile.name } },\n      zipFile.binary,\n    );\n  }\n  return spectra;\n}\n\nexport function addJDFs(files) {\n  const spectra = [];\n  for (let i = 0; i < files.length; i++) {\n    addJDF(spectra, files[i].binary, {\n      display: {\n        name: files[i].name,\n      },\n      source: {\n        jcampURL: files[i].jcampURL ? files[i].jcampURL : null,\n      },\n    });\n  }\n  return spectra;\n}\n\nexport function addJcamps(files) {\n  const spectra = [];\n  for (let i = 0; i < files.length; i++) {\n    addJcamp(spectra, files[i].binary.toString(), {\n      display: {\n        name: files[i].name,\n      },\n      source: {\n        jcampURL: files[i].jcampURL ? files[i].jcampURL : null,\n      },\n    });\n  }\n  return spectra;\n}\n\nexport async function addMolfileFromURL(molfileURL) {\n  let molfile = await fetch(molfileURL).then((response) => response.text());\n  this.addMolfile(molfile);\n}\n\n/**\n *\n * @param {object} state\n */\nexport function toJSON(state) {\n  const {\n    data,\n    molecules,\n    preferences,\n    correlations,\n    multipleAnalysis,\n  } = state || {\n    data: [],\n    molecules: [],\n    preferences: {},\n    correlations: {},\n    multipleAnalysis: {},\n  };\n  const spectra = data.map((ob) => {\n    return ob.info.dimension === 1 ? Datum1D.toJSON(ob) : Datum2D.toJSON(ob);\n  });\n\n  return {\n    spectra,\n    molecules,\n    preferences,\n    correlations,\n    multipleAnalysis,\n  };\n}\n","import { original, Draft } from 'immer';\nimport lodashCloneDeep from 'lodash/cloneDeep';\nimport { Build, CorrelationUtilities, Types } from 'nmr-correlation';\n\nimport { State } from '../Reducer';\n\nfunction handleUpdateCorrelations(draft: Draft<State>) {\n  const { data: spectra, correlations } = draft;\n  draft.correlations = Build.build(\n    spectra as Types.Spectra,\n    correlations.options,\n    lodashCloneDeep(correlations.values),\n  );\n}\n\nfunction handleSetMF(draft: Draft<State>, payload: { mf: string }) {\n  const state = original(draft) as State;\n  const { data: spectra, correlations } = state;\n  const { mf } = payload;\n  // update of correlation data is needed only if the following is true\n  if (correlations.options.mf === '' || correlations.options.mf !== mf) {\n    draft.correlations = Build.build(\n      spectra as Types.Spectra,\n      { ...correlations.options, mf },\n      lodashCloneDeep(correlations.values),\n    );\n  }\n}\n\nfunction handleSetTolerance(\n  draft: Draft<State>,\n  payload: { tolerance: Types.Tolerance },\n) {\n  const state = original(draft) as State;\n  const { data: spectra, correlations } = state;\n  const { tolerance } = payload;\n  draft.correlations = Build.build(\n    spectra as Types.Spectra,\n    { ...correlations.options, tolerance },\n    lodashCloneDeep(correlations.values),\n  );\n}\n\nfunction handleSetCorrelation(\n  draft: Draft<State>,\n  payload: { id: string; correlation: Types.Correlation },\n) {\n  const state = original(draft) as State;\n  const { correlations } = state;\n  const { id, correlation } = payload;\n  draft.correlations = CorrelationUtilities.setCorrelation(\n    correlations,\n    id,\n    correlation,\n  );\n  handleUpdateCorrelations(draft);\n}\n\nfunction handleSetCorrelations(\n  draft: Draft<State>,\n  payload: { ids: Array<string>; correlations: Types.Values },\n) {\n  const { ids, correlations } = payload;\n  ids.forEach((id, i) => {\n    const { correlations: correlationsData } = draft;\n    draft.correlations = CorrelationUtilities.setCorrelation(\n      correlationsData,\n      id,\n      correlations[i],\n    );\n  });\n  handleUpdateCorrelations(draft);\n}\n\nexport {\n  handleUpdateCorrelations,\n  handleSetCorrelation,\n  handleSetCorrelations,\n  handleSetMF,\n  handleSetTolerance,\n};\n","import { extent } from 'd3';\nimport { Draft } from 'immer';\nimport { xyIntegral } from 'ml-spectra-processing';\n\nimport { Datum1D } from '../../../data/data1d/Datum1D';\nimport { Datum2D } from '../../../data/data2d/Datum2D';\nimport GroupByInfoKey from '../../utility/GroupByInfoKey';\nimport { State } from '../Reducer';\nimport { DISPLAYER_MODE } from '../core/Constants';\n\nfunction getActiveData(draft: Draft<State>) {\n  if (draft.activeTab) {\n    const groupByNucleus = GroupByInfoKey('nucleus');\n    let data = groupByNucleus(draft.data)[draft.activeTab];\n    if (draft.displayerMode === DISPLAYER_MODE.DM_2D) {\n      return data;\n    } else {\n      if (draft.activeSpectrum && data) {\n        const activeSpectrumIndex = data.findIndex(\n          (datum) => datum.id === draft.activeSpectrum.id,\n        );\n        if (activeSpectrumIndex !== -1) {\n          const isFid = data[activeSpectrumIndex].info.isFid || false;\n          data = data.filter((datum) => datum.info.isFid === isFid);\n        }\n      } else {\n        data = data ? data.filter((datum) => datum.info.isFid === false) : [];\n      }\n\n      for (let datum of draft.data) {\n        if (data.some((activeData: any) => activeData.id === datum.id)) {\n          // AnalysisObj.getDatum(datum.id).isVisibleInDomain = true;\n          (datum as Datum2D | Datum1D).display.isVisibleInDomain = true;\n        } else {\n          // AnalysisObj.getDatum(datum.id).isVisibleInDomain = false;\n          (datum as Datum2D | Datum1D).display.isVisibleInDomain = false;\n        }\n      }\n      return draft.data;\n    }\n  } else {\n    return draft.data;\n  }\n}\n\nfunction getDomain(data) {\n  let xArray = [];\n  let yArray = [];\n  let yDomains = {};\n  let xDomains = {};\n  let integralYDomain = {};\n  try {\n    xArray = data.reduce((acc, d: Datum1D) => {\n      const { display, data } = d;\n      if (display.isVisibleInDomain) {\n        const domain = [data.x[0], data.x[data.x.length - 1]];\n        xDomains[d.id] = domain;\n        if (display.isVisible) {\n          acc = acc.concat(domain);\n        }\n        return acc;\n      } else {\n        return acc.concat([]);\n      }\n    }, []);\n\n    yArray = data.reduce((acc, d: Datum1D) => {\n      const { display, data, integrals } = d;\n      if (display.isVisibleInDomain) {\n        const _extent = extent(data.y);\n        yDomains[d.id] = _extent;\n        if (integrals.values && integrals.values.length > 0) {\n          const values = integrals.values;\n          const { from, to } = values[0];\n          const { x, y } = data;\n          const integralResult = xyIntegral(\n            { x: x, y: y },\n            {\n              from: from,\n              to: to,\n              reverse: true,\n            },\n          );\n          integralYDomain[d.id] = extent(integralResult.y);\n        }\n        if (display.isVisible) {\n          acc = acc.concat(_extent);\n        }\n        return acc;\n      } else {\n        return acc.concat([]);\n      }\n    }, []);\n  } catch (e) {\n    // eslint-disable-next-line no-console\n    console.log(e);\n  }\n\n  return {\n    xDomain: extent(xArray),\n    yDomain: extent(yArray),\n    yDomains,\n    xDomains,\n    integralYDomain,\n  };\n}\nfunction get2DDomain(state) {\n  let xArray = [];\n  let yArray = [];\n  let yDomains = {};\n  let xDomains = {};\n\n  const { activeTab, tabActiveSpectrum, data } = state;\n\n  const nucleus = activeTab.split(',');\n\n  try {\n    xArray = data.reduce((acc, datum: Datum1D | Datum2D) => {\n      if (datum.info.dimension === 2) {\n        acc = acc.concat([\n          (datum as Datum2D).data.minX,\n          (datum as Datum2D).data.maxX,\n        ]);\n      }\n      return acc;\n    }, []);\n\n    yArray = data.reduce((acc, datum: Datum1D | Datum2D) => {\n      if (\n        datum.info.dimension === 2 &&\n        datum.info.nucleus?.join(',') === activeTab\n      ) {\n        acc = acc.concat([\n          (datum as Datum2D).data.minY,\n          (datum as Datum2D).data.maxY,\n        ]);\n      }\n      return acc;\n    }, []);\n  } catch (e) {\n    // eslint-disable-next-line no-console\n    console.log(e);\n  }\n\n  const spectrumsIDs = nucleus.map((n) => tabActiveSpectrum[n]?.id);\n\n  const filteredData = data.reduce((acc, datum: Datum1D | Datum2D) => {\n    return spectrumsIDs.includes(datum.id) && datum.info.dimension === 1\n      ? acc.concat(datum)\n      : acc.concat([]);\n  }, []);\n  try {\n    xDomains = filteredData.reduce((acc, d: Datum1D) => {\n      const { x } = d.data;\n      const domain = [x[0], x[x.length - 1]];\n      acc[d.id] = domain;\n      return acc;\n    }, {});\n\n    yDomains = filteredData.reduce((acc, d: Datum1D) => {\n      const _extent = extent(d.data.y);\n      acc[d.id] = _extent;\n      return acc;\n    }, {});\n  } catch (e) {\n    // eslint-disable-next-line no-console\n    console.log(e);\n  }\n\n  return {\n    xDomain: extent(xArray),\n    yDomain: extent(yArray),\n    yDomains,\n    xDomains,\n  };\n}\n\nfunction setDomain(draft: Draft<State>, isYDomainChanged = true) {\n  let domain;\n  const data = getActiveData(draft);\n\n  if (\n    draft.activeTab &&\n    [DISPLAYER_MODE.DM_1D, DISPLAYER_MODE.DM_2D].includes(draft.displayerMode)\n  ) {\n    domain =\n      draft.displayerMode === DISPLAYER_MODE.DM_1D\n        ? getDomain(data)\n        : get2DDomain(draft);\n    draft.xDomain = domain.xDomain;\n    draft.xDomains = domain.xDomains;\n    if (isYDomainChanged) {\n      draft.yDomain = domain.yDomain;\n\n      if (draft.displayerMode === DISPLAYER_MODE.DM_1D) {\n        draft.yDomains = Object.keys(domain.yDomains).reduce((acc, key) => {\n          acc[key] = domain.yDomain;\n          return acc;\n        }, {});\n        draft.originDomain = {\n          ...domain,\n          yDomains: draft.yDomains,\n          originYDomains: domain.yDomains,\n        };\n      } else {\n        draft.yDomains = domain.yDomains;\n        draft.originDomain = domain;\n      }\n\n      draft.integralsYDomains =\n        domain.integralYDomain && domain.integralYDomain;\n      draft.originIntegralYDomain =\n        domain.integralYDomain && domain.integralYDomain;\n    } else {\n      draft.originDomain = {\n        ...draft.originDomain,\n        xDomain: domain.xDomain,\n        xDomains: domain.xDomains,\n      };\n    }\n  }\n}\n\nfunction setOriginalDomain(draft: Draft<State>, originDomain) {\n  draft.originDomain = originDomain;\n}\n\nfunction setXDomain(draft: Draft<State>, xDomain) {\n  draft.xDomain = xDomain;\n}\n\nfunction setYDomain(draft: Draft<State>, yDomain) {\n  draft.yDomain = yDomain;\n}\n\nfunction handelResetDomain(draft: Draft<State>) {\n  const { xDomain, yDomain, xDomains, yDomains } = draft.originDomain;\n  draft.xDomain = xDomain;\n  draft.yDomain = yDomain;\n  draft.xDomains = xDomains;\n  draft.yDomains = yDomains;\n}\n\nfunction setMode(draft) {\n  const data = getActiveData(draft).filter(\n    (datum) => datum.display.isVisibleInDomain === true,\n  );\n  draft.mode = (data[0] as Datum1D)?.info.isFid ? 'LTR' : 'RTL';\n}\n\nfunction handleChangeIntegralYDomain(draft, newYDomain) {\n  const activeSpectrum = draft.activeSpectrum;\n  if (activeSpectrum) {\n    draft.integralsYDomains[activeSpectrum.id] = newYDomain;\n  }\n}\n\nexport {\n  getDomain,\n  setOriginalDomain,\n  setXDomain,\n  setYDomain,\n  handelResetDomain,\n  setDomain,\n  setMode,\n  handleChangeIntegralYDomain,\n};\n","function getClosestNumber(array = [], goal = 0) {\n  const closest = array.reduce((prev, curr) => {\n    return Math.abs(curr - goal) < Math.abs(prev - goal) ? curr : prev;\n  });\n  return closest;\n}\n\nexport default getClosestNumber;\n","export default class ZoomHistory {\n  constructor() {\n    this.stack = [];\n  }\n\n  static getInstance(ZoomHistoryInstances, nucleus) {\n    if (\n      ZoomHistoryInstances[nucleus] &&\n      ZoomHistoryInstances[nucleus] instanceof ZoomHistory\n    ) {\n      return ZoomHistoryInstances[nucleus];\n    }\n    ZoomHistoryInstances[nucleus] = new ZoomHistory();\n    return ZoomHistoryInstances[nucleus];\n  }\n\n  push(val) {\n    this.stack.push(val);\n  }\n\n  pop() {\n    const val = this.stack.pop();\n    return val ? this.stack[this.stack.length - 1] : null;\n  }\n\n  getLast() {\n    if (this.stack.length === 0) return null;\n    return this.stack[this.stack.length - 1];\n  }\n}\n","import { Draft, original } from 'immer';\nimport cloneDeep from 'lodash/cloneDeep';\nimport lodashGet from 'lodash/get';\n\nimport { Datum1D } from '../../../data/data1d/Datum1D';\nimport { Datum2D } from '../../../data/data2d/Datum2D';\nimport GroupByInfoKey from '../../utility/GroupByInfoKey';\nimport { State } from '../Reducer';\nimport { DEFAULT_YAXIS_SHIFT_VALUE, DISPLAYER_MODE } from '../core/Constants';\n\nimport { setDomain } from './DomainActions';\nimport { setZoom } from './Zoom';\n\nfunction handelSetPreferences(draft: Draft<State>, action) {\n  const { type, values } = action;\n  const panelsPreferences = lodashGet(draft.preferences, 'panels', {});\n  draft.preferences.panels = { ...panelsPreferences, [type]: values };\n}\n\nfunction changeSpectrumVerticalAlignment(\n  draft: Draft<State>,\n  center,\n  checkData = false,\n) {\n  if (draft.data && draft.data.length > 0) {\n    if (\n      center ||\n      (checkData &&\n        (draft.data[0] as Datum1D).info.isFid &&\n        !(draft.data as Datum1D[]).some((d) => d.info.isFid === false))\n    ) {\n      const YAxisShift = draft.height / 2;\n      draft.verticalAlign.flag = true;\n      draft.verticalAlign.value = YAxisShift;\n      draft.verticalAlign.stacked = false;\n    } else {\n      draft.verticalAlign.flag = false;\n      draft.verticalAlign.value = DEFAULT_YAXIS_SHIFT_VALUE;\n      draft.verticalAlign.stacked = false;\n    }\n  }\n}\n\nfunction setKeyPreferencesHandler(draft: Draft<State>, keyCode) {\n  const state = original(draft) as State;\n  const {\n    activeTab,\n    data,\n    activeSpectrum,\n    zoomFactor,\n    xDomain,\n    xDomains,\n    yDomain,\n    yDomains,\n    originDomain,\n    margin,\n    displayerMode,\n    tabActiveSpectrum,\n  } = state;\n  if (activeTab) {\n    const groupByNucleus = GroupByInfoKey('nucleus');\n\n    const spectrumsGroupsList = groupByNucleus(data);\n\n    const level =\n      displayerMode === DISPLAYER_MODE.DM_2D\n        ? spectrumsGroupsList[activeTab].reduce((acc, datum) => {\n            acc[datum.id] = datum.processingController.getLevel();\n            return acc;\n          }, {})\n        : null;\n\n    draft.keysPreferences[keyCode] = {\n      activeTab,\n      activeSpectrum,\n      displayerMode,\n      tabActiveSpectrum,\n      zoomFactor,\n      xDomain,\n      xDomains,\n      yDomain,\n      yDomains,\n      originDomain,\n      level,\n      margin,\n      data: spectrumsGroupsList[activeTab].reduce((acc, datum) => {\n        acc[datum.id] = {\n          display: {\n            color: datum.display.color,\n            isVisible: datum.display.isVisible,\n            isPeaksMarkersVisible: datum.display.isPeaksMarkersVisible,\n          },\n        };\n        return acc;\n      }, {}),\n    };\n  }\n}\n\nfunction nucluesToString(nuclues) {\n  return typeof nuclues === 'string' ? nuclues : nuclues.join(',');\n}\n\nfunction applyKeyPreferencesHandler(draft: Draft<State>, keyCode) {\n  const state = original(draft) as State;\n\n  const preferences = state.keysPreferences[keyCode];\n  if (preferences) {\n    draft.activeTab = preferences.activeTab;\n    (state.data as Datum1D[] | Datum2D[]).forEach((datum, index) => {\n      if (nucluesToString(datum.info.nucleus) === preferences.activeTab) {\n        draft.data[index].display = Object.assign(\n          cloneDeep(datum.display),\n          preferences.data[datum.id].display,\n        );\n      }\n    });\n    draft.displayerMode = preferences.displayerMode;\n    draft.tabActiveSpectrum = preferences.tabActiveSpectrum;\n    draft.activeSpectrum = preferences.activeSpectrum;\n\n    draft.margin = preferences.margin;\n\n    setDomain(draft);\n\n    draft.xDomain = preferences.xDomain;\n    draft.xDomains = preferences.xDomains;\n    draft.yDomain = preferences.yDomain;\n    draft.originDomain = preferences.originDomain;\n    draft.yDomains = preferences.yDomains;\n\n    if (draft.displayerMode === DISPLAYER_MODE.DM_2D) {\n      // draft.yDomains = preferences.yDomains;\n\n      for (const datumID of Object.keys(preferences.level)) {\n        const { levelPositive, levelNegative } = preferences.level[datumID];\n        const index = state.data.findIndex((datum) => datum.id === datumID);\n        const processController = (draft.data[index] as Datum2D)\n          .processingController;\n        processController.setLevel(levelPositive, levelNegative);\n        draft.contours[datumID] = processController.drawContours();\n      }\n    } else {\n      setZoom(\n        // {\n        //   ...state,\n        //   activeSpectrum: draft.activeSpectrum,\n        //   activeTab: draft.activeTab,\n        // },\n        draft,\n        preferences.zoomFactor.scale,\n      );\n    }\n  }\n}\n\nexport {\n  changeSpectrumVerticalAlignment,\n  handelSetPreferences,\n  setKeyPreferencesHandler,\n  applyKeyPreferencesHandler,\n};\n","import { Draft } from 'immer';\n\nimport { Filters } from '../../../data/Filters';\nimport * as FiltersManager from '../../../data/FiltersManager';\nimport { Datum1D, updateXShift } from '../../../data/data1d/Datum1D';\nimport { apply as autoPhaseCorrection } from '../../../data/data1d/filter1d/autoPhaseCorrection';\nimport { apply as phaseCorrection } from '../../../data/data1d/filter1d/phaseCorrection';\nimport {\n  Datum2D,\n  updateShift as update2dShift,\n} from '../../../data/data2d/Datum2D';\nimport { options } from '../../toolbar/ToolTypes';\nimport { State } from '../Reducer';\nimport getClosestNumber from '../helper/GetClosestNumber';\nimport ZoomHistory from '../helper/ZoomHistory';\n\nimport { setDomain, setMode } from './DomainActions';\nimport { changeSpectrumVerticalAlignment } from './PreferencesActions';\n\nfunction setDataByFilters(draft: Draft<State>, hideOptionPanel = true) {\n  if (hideOptionPanel) {\n    draft.selectedOptionPanel = null;\n    draft.selectedTool = options.zoom.id;\n  }\n  const datum = draft.data[draft.activeSpectrum.index] as Datum1D;\n  datum.data.y = datum.data.re;\n}\n\nfunction shiftSpectrumAlongXAxis(draft: Draft<State>, shiftValue) {\n  //apply filter into the spectrum\n  if (draft.activeSpectrum?.id) {\n    const index = draft.activeSpectrum.index;\n\n    FiltersManager.applyFilter(draft.data[index], [\n      { name: Filters.shiftX.id, options: shiftValue },\n    ]);\n    updateXShift(draft.data[index] as Datum1D);\n    setDataByFilters(draft);\n    setDomain(draft);\n  }\n}\n\nfunction applyZeroFillingFilter(draft: Draft<State>, filterOptions) {\n  if (draft.activeSpectrum?.id) {\n    const index = draft.activeSpectrum.index;\n    // const activeObject = AnalysisObj.getDatum(activeSpectrumId);\n    const filters = [\n      { name: Filters.zeroFilling.id, options: filterOptions.zeroFillingSize },\n      {\n        name: Filters.lineBroadening.id,\n        options: filterOptions.lineBroadeningValue,\n      },\n    ];\n    FiltersManager.applyFilter(draft.data[index], filters);\n    setDataByFilters(draft);\n    setDomain(draft);\n    setMode(draft);\n  }\n}\nfunction applyFFTFilter(draft: Draft<State>) {\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n\n    // const activeObject = AnalysisObj.getDatum(activeSpectrumId);\n\n    //apply filter into the spectrum\n    FiltersManager.applyFilter(draft.data[index], [\n      { name: Filters.fft.id, options: {} },\n    ]);\n    setDataByFilters(draft);\n    changeSpectrumVerticalAlignment(draft, false, true);\n\n    setDomain(draft);\n    setMode(draft);\n  }\n}\nfunction applyManualPhaseCorrectionFilter(draft: Draft<State>, filterOptions) {\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n    let { ph0, ph1 } = filterOptions;\n    const datum = draft.data[index] as Datum1D;\n    const closest = getClosestNumber(datum.data.x, draft.pivot);\n    const pivotIndex = datum.data.x.indexOf(closest);\n\n    ph0 = ph0 - (ph1 * pivotIndex) / datum.data.y.length;\n\n    FiltersManager.applyFilter(draft.data[index], [\n      { name: Filters.phaseCorrection.id, options: { ph0, ph1 } },\n    ]);\n\n    setDataByFilters(draft);\n    draft.tempData = null;\n    setDomain(draft);\n  }\n}\nfunction applyAbsoluteFilter(draft: Draft<State>) {\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n    FiltersManager.applyFilter(draft.data[index], [\n      { name: Filters.absolute.id, options: {} },\n    ]);\n    setDataByFilters(draft);\n    draft.tempData = null;\n    setDomain(draft);\n  }\n}\n\nfunction applyAutoPhaseCorrectionFilter(draft: Draft<State>) {\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n\n    const {\n      data: { x, y, im },\n      info,\n    } = draft.tempData[index];\n\n    let _data = { data: { x, re: y, im }, info };\n    const { data, ph0, ph1 } = autoPhaseCorrection(_data);\n\n    const { im: newIm, re: newRe } = data;\n    draft.tempData[index].data.im = newIm;\n    draft.tempData[index].data.y = newRe;\n    FiltersManager.applyFilter(draft.data[index], [\n      { name: Filters.phaseCorrection.id, options: { ph0, ph1 } },\n    ]);\n    setDataByFilters(draft);\n    draft.tempData = null;\n    setDomain(draft);\n  }\n}\n\nfunction calculateManualPhaseCorrection(draft: Draft<State>, filterOptions) {\n  const { tempData } = draft;\n  const { index } = draft.activeSpectrum;\n  const {\n    data: { x, y, im },\n    info,\n  } = tempData[index];\n\n  let { ph0, ph1 } = filterOptions;\n  const closest = getClosestNumber(tempData[index].data.x, draft.pivot);\n  const pivotIndex = tempData[index].data.x.indexOf(closest);\n\n  ph0 = ph0 - (ph1 * pivotIndex) / y.length;\n\n  let _data = { data: { x, re: y, im }, info };\n  phaseCorrection(_data, { ph0, ph1 });\n  const { im: newIm, re: newRe } = _data.data;\n  draft.tempData[index].data.im = newIm;\n  draft.tempData[index].data.y = newRe;\n}\n\nfunction enableFilter(draft: Draft<State>, filterID, checked) {\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n\n    //apply filter into the spectrum\n    FiltersManager.enableFilter(draft.data[index], filterID, checked);\n\n    if (draft.data[index].info?.dimension === 1) {\n      updateXShift(draft.data[index] as Datum1D);\n    } else if (draft.data[index].info?.dimension === 2) {\n      update2dShift(draft.data[index] as Datum2D);\n    }\n\n    setDataByFilters(draft, false);\n    setDomain(draft);\n    setMode(draft);\n\n    const zoomHistory = ZoomHistory.getInstance(\n      draft.ZoomHistory,\n      draft.activeTab,\n    );\n    const zoomValue = zoomHistory.getLast();\n    if (zoomValue) {\n      draft.xDomain = zoomValue.xDomain;\n      draft.yDomain = zoomValue.yDomain;\n    }\n  }\n}\n\nfunction deleteFilter(draft: Draft<State>, filterID) {\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n\n    //apply filter into the spectrum\n    FiltersManager.deleteFilter(draft.data[index], filterID);\n\n    if (draft.data[index].info?.dimension === 1) {\n      updateXShift(draft.data[index] as Datum1D);\n    } else if (draft.data[index].info?.dimension === 2) {\n      update2dShift(draft.data[index] as Datum2D);\n    }\n\n    setDataByFilters(draft, false);\n    setDomain(draft);\n    setMode(draft);\n  }\n}\n\nfunction handleBaseLineCorrectionFilter(draft: Draft<State>, action) {\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n\n    FiltersManager.applyFilter(draft.data[index], [\n      {\n        name: Filters.baselineCorrection.id,\n        options: { zones: draft.baseLineZones, ...action.options },\n      },\n    ]);\n\n    draft.baseLineZones = [];\n    const xDomainSnapshot = draft.xDomain.slice();\n\n    setDataByFilters(draft);\n    setDomain(draft);\n    draft.xDomain = xDomainSnapshot;\n  }\n}\n\nfunction filterSnapshotHandler(draft: Draft<State>, action) {\n  if (draft.activeSpectrum?.id) {\n    const index = draft.activeSpectrum.index;\n\n    if (action.id) {\n      const filterIndex = (draft.data[index] as Datum1D).filters.findIndex(\n        (f) => f.id === action.id,\n      );\n      const filters = (draft.data[index] as Datum1D).filters.slice(\n        0,\n        filterIndex + 1,\n      );\n      FiltersManager.reapplyFilters(draft.data[index], filters);\n    } else {\n      //close filter snapshot mode and replay all enabled filters\n      FiltersManager.reapplyFilters(draft.data[index]);\n    }\n    // const activeObject = AnalysisObj.getDatum(id);\n\n    setDataByFilters(draft);\n    setDomain(draft);\n    setMode(draft);\n  }\n}\n\nexport {\n  shiftSpectrumAlongXAxis,\n  applyZeroFillingFilter,\n  applyFFTFilter,\n  applyManualPhaseCorrectionFilter,\n  applyAutoPhaseCorrectionFilter,\n  applyAbsoluteFilter,\n  calculateManualPhaseCorrection,\n  enableFilter,\n  deleteFilter,\n  handleBaseLineCorrectionFilter,\n  filterSnapshotHandler,\n};\n","import { getXScale } from '../../1d/utilities/scale';\n\nexport default function getRange(draft, options) {\n  const { startX, endX } = options;\n  const scaleX = getXScale(draft);\n\n  const start = scaleX.invert(startX);\n  const end = scaleX.invert(endX);\n  const range: number[] = [];\n  if (start > end) {\n    range[0] = end;\n    range[1] = start;\n  } else {\n    range[0] = start;\n    range[1] = end;\n  }\n  return range;\n}\n","import { extent } from 'd3';\nimport { Draft, original } from 'immer';\nimport { xyIntegral, xyIntegration } from 'ml-spectra-processing';\n\nimport {\n  updateIntegralIntegrals,\n  changeIntegralsRealtive,\n  Datum1D,\n  getShiftX,\n} from '../../../data/data1d/Datum1D';\nimport generateID from '../../../data/utilities/generateID';\nimport { State } from '../Reducer';\nimport getRange from '../helper/getRange';\n\nimport { setIntegralZoom, integralZoomHanlder } from './Zoom';\n\nfunction handleChangeIntegralSum(draft: Draft<State>, value) {\n  if (draft.activeSpectrum?.id) {\n    const { index, id } = draft.activeSpectrum;\n    (draft.data[index] as Datum1D).integrals.options.sum = value;\n    updateIntegralIntegrals((draft.data[index] as Datum1D).integrals);\n\n    if (!draft.integralsYDomains) {\n      draft.integralsYDomains[id] = draft.yDomains[id];\n    }\n  }\n}\n\nfunction handleChangeIntegralZoom(draft: Draft<State>, action) {\n  const { deltaY, deltaMode } = action;\n  integralZoomHanlder.wheel(deltaY, deltaMode);\n  setIntegralZoom(integralZoomHanlder.getScale(), draft);\n}\n\nfunction addIntegral(draft: Draft<State>, action) {\n  const state = original(draft);\n  const { startX, endX } = action;\n  const [from, to] = getRange(draft, { startX, endX });\n\n  if (draft.activeSpectrum?.id && state) {\n    const { id, index } = draft.activeSpectrum;\n    const datum = draft.data[index] as Datum1D;\n\n    const { x, re } = datum.data;\n\n    const shiftX = getShiftX(datum);\n\n    const integral = {\n      id: generateID(),\n      originFrom: from - shiftX,\n      originTo: to - shiftX,\n      from,\n      to,\n      absolute: xyIntegration({ x, y: re }, { from, to, reverse: true }), // the real value\n      kind: 'signal',\n    };\n    datum.integrals.values.push(integral);\n    updateIntegralIntegrals(datum.integrals);\n    if (datum.integrals.values.length === 1) {\n      const { from, to } = datum.integrals.values[0];\n      const { x, y } = datum.data;\n      const integralResult = xyIntegral(\n        { x: x, y: y },\n        {\n          from: from,\n          to: to,\n          reverse: true,\n        },\n      );\n      const integralYDomain = extent(integralResult.y);\n      draft.integralsYDomains[id] = integralYDomain;\n      draft.originIntegralYDomain[id] = integralYDomain;\n      setIntegralZoom(draft.integralZoomFactor.scale, draft);\n    }\n  }\n}\n\nfunction deleteIntegral(draft: Draft<State>, action) {\n  const state = original(draft) as State;\n  const { index } = draft.activeSpectrum;\n  const { integralID } = action;\n\n  const datum = draft.data[index] as Datum1D;\n\n  if (integralID == null) {\n    datum.integrals.values = [];\n  } else {\n    const peakIndex = (state.data[index] as Datum1D).integrals.values.findIndex(\n      (p) => p.id === integralID,\n    );\n    datum.integrals.values.splice(peakIndex, 1);\n    updateIntegralIntegrals(datum.integrals);\n  }\n}\n\nfunction changeIntegral(draft: Draft<State>, action) {\n  const state = original(draft) as State;\n  const integral = action.data;\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n\n    const orignalDatum = state.data[index] as Datum1D;\n    const datum = draft.data[index] as Datum1D;\n\n    const { x, re } = orignalDatum.data;\n    const integralIndex = orignalDatum.integrals.values.findIndex(\n      (i) => i.id === integral.id,\n    );\n    if (integralIndex !== -1) {\n      datum.integrals.values[integralIndex] = {\n        // ...draft.data[index].integrals.values[integralIndex],\n        originFrom: integral.from,\n        originTo: integral.to,\n        ...integral,\n        absolute: xyIntegration(\n          { x, y: re },\n          { from: integral.from, to: integral.to, reverse: true },\n        ),\n      };\n      updateIntegralIntegrals(datum.integrals);\n    }\n  }\n}\n\nfunction handleChangeIntegralsRaltiveValue(draft: Draft<State>, action) {\n  const { id, value } = action;\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n    changeIntegralsRealtive(\n      (draft.data[index] as Datum1D).integrals,\n      id,\n      value,\n    );\n  }\n}\n\nexport {\n  handleChangeIntegralSum,\n  handleChangeIntegralZoom,\n  addIntegral,\n  deleteIntegral,\n  changeIntegral,\n  handleChangeIntegralsRaltiveValue,\n};\n","import { MF } from 'mf-parser';\nimport { Molecule as OCLMolecule } from 'openchemlib/full';\n\nimport generateID from '../utilities/generateID';\n\n/**\n * @param {object} [options={}]\n * @param {object} [options.molfile='']\n * @param {object} [options.key=Math.random()] Optional unique identifier\n */\nexport function initMolecule(options = {}) {\n  const molecule = {};\n  molecule.key = options.key || generateID();\n  molecule.molfile = options.molfile || '';\n  const mol = new OCLMolecule.fromMolfile(molecule.molfile);\n  const mfInfo = mol.getMolecularFormula();\n  molecule.mf = mfInfo.formula;\n  molecule.em = mfInfo.absoluteWeight;\n  molecule.mw = mfInfo.relativeWeight;\n  molecule.svg = mol.toSVG(50, 50);\n\n  const mf = new MF(molecule.mf);\n  molecule.atoms = mf.getInfo().atoms;\n  return molecule;\n}\n\nexport function toJSON(molecule) {\n  return {\n    molfile: molecule.molfile,\n  };\n}\n","import { Molecule, Molecule as OCLMolecule } from 'openchemlib/full';\n\nimport { initMolecule } from './Molecule';\n\nexport function fromJSON(mols = []) {\n  const molecules = [];\n  for (let i = 0; i < mols.length; i++) {\n    const molecule = OCLMolecule.fromMolfile(mols[i].molfile);\n    const fragments = molecule.getFragments();\n    for (let fragment of fragments) {\n      molecules.push(\n        initMolecule({\n          molfile: fragment.toMolfileV3(),\n        }),\n      );\n    }\n  }\n\n  return molecules;\n}\n\nexport function addMolfile(molecules, molfile) {\n  // try to parse molfile\n  // this will throw if the molecule can not be parsed !\n  const molecule = Molecule.fromMolfile(molfile);\n  let fragments = molecule.getFragments();\n  for (let fragment of fragments) {\n    const {\n      formula,\n      absoluteWeight,\n      relativeWeight,\n    } = fragment.getMolecularFormula();\n    molecules.push(\n      initMolecule({\n        molfile: fragment.toMolfileV3(),\n        svg: fragment.toSVG(150, 150),\n        mf: formula,\n        em: absoluteWeight,\n        mw: relativeWeight,\n      }),\n    );\n  }\n  // we will split if we have many fragments\n}\n\nexport function setMolfile(molecules, molfile, key) {\n  // try to parse molfile\n  // this will throw if the molecule can not be parsed !\n  let molecule = Molecule.fromMolfile(molfile);\n  let fragments = molecule.getFragments();\n\n  if (fragments.length > 1) {\n    molecules = this.molecules.filter((m) => m.key !== key);\n\n    for (let fragment of fragments) {\n      const {\n        formula,\n        absoluteWeight,\n        relativeWeight,\n      } = fragment.getMolecularFormula();\n\n      molecules.push(\n        new initMolecule({\n          molfile: fragment.toMolfileV3(),\n          svg: fragment.toSVG(150, 150),\n          mf: formula,\n          em: absoluteWeight,\n          mw: relativeWeight,\n        }),\n      );\n    }\n  } else if (fragments.length === 1) {\n    const fragment = fragments[0];\n    const {\n      formula,\n      absoluteWeight,\n      relativeWeight,\n    } = fragment.getMolecularFormula();\n    const _mol = initMolecule({\n      molfile: fragment.toMolfileV3(),\n      svg: fragment.toSVG(150, 150),\n      mf: formula,\n      em: absoluteWeight,\n      mw: relativeWeight,\n      key: key,\n    });\n    let molIndex = molecules.findIndex((m) => m.key === key);\n    molecules.splice(molIndex, 1, _mol);\n  }\n\n  // we will split if we have many fragments\n}\n","import { max } from 'd3';\nimport { original, Draft } from 'immer';\n\nimport { Filters } from '../../../data/Filters';\nimport { Data1D, Datum1D } from '../../../data/data1d/Datum1D';\n// import { Datum2D } from '../../../data/data2d/Datum2D';\nimport { Datum2D } from '../../../data/data2d/Datum2D';\nimport generateID from '../../../data/utilities/generateID';\nimport { getYScale, getXScale } from '../../1d/utilities/scale';\nimport { LAYOUT } from '../../2d/utilities/DimensionLayout';\nimport { get2DYScale } from '../../2d/utilities/scale';\nimport { options } from '../../toolbar/ToolTypes';\nimport GroupByInfoKey from '../../utility/GroupByInfoKey';\nimport { State } from '../Reducer';\nimport {\n  DEFAULT_YAXIS_SHIFT_VALUE,\n  DISPLAYER_MODE,\n  MARGIN,\n} from '../core/Constants';\nimport ZoomHistory from '../helper/ZoomHistory';\n\nimport { setDomain, setMode } from './DomainActions';\nimport { changeSpectrumVerticalAlignment } from './PreferencesActions';\nimport { setZoom1D, setZoom, ZoomType, wheel } from './Zoom';\n\nfunction getStrongestPeak(draft: Draft<State>) {\n  const { activeSpectrum, data } = draft;\n  const activeData = data[activeSpectrum.index].data as Data1D;\n  const strongestPeakValue = max(activeData.y);\n  const index = activeData.y.findIndex((val) => val === strongestPeakValue);\n  return {\n    xValue: activeData.x[index],\n    yValue: strongestPeakValue,\n    index: index,\n  };\n}\n\nfunction setFilterChanges(draft: Draft<State>, selectedFilter) {\n  const activeSpectrumId = draft.activeSpectrum.id;\n\n  //save reduced snapshot\n  //select the equalizer tool when you enable manual phase correction filter\n  if (selectedFilter === Filters.phaseCorrection.id) {\n    draft.tempData = draft.data;\n\n    const { xValue } = getStrongestPeak(draft);\n    draft.pivot = xValue;\n  } else {\n    if (draft.selectedTool === options.phaseCorrection.id) {\n      const spectrumIndex = draft.data.findIndex(\n        (spectrum) => spectrum.id === activeSpectrumId,\n      );\n\n      draft.data[spectrumIndex].data = draft.tempData[spectrumIndex].data;\n    }\n  }\n}\n\nfunction resetTool(draft: Draft<State>, setDefaultTool = true) {\n  draft.selectedOptionPanel = null;\n  if (setDefaultTool) {\n    draft.selectedTool = options.zoom.id;\n  }\n  draft.baseLineZones = [];\n  if (draft.tempData) {\n    draft.tempData = null;\n    setDomain(draft);\n  }\n}\n\nfunction resetSelectedTool(draft: Draft<State>, filterOnly = false) {\n  if (\n    (draft.selectedTool && options[draft.selectedTool].isFilter) ||\n    !filterOnly\n  ) {\n    resetTool(draft);\n  }\n}\n\nfunction setSelectedTool(draft: Draft<State>, selectedTool) {\n  if (draft?.data.length > 0) {\n    if (selectedTool) {\n      if (selectedTool !== draft.selectedTool) {\n        resetTool(draft, false);\n      }\n      draft.selectedTool = selectedTool;\n      if (options[selectedTool].hasOptionPanel) {\n        draft.selectedOptionPanel = selectedTool;\n      }\n\n      if (options[selectedTool].isFilter) {\n        setFilterChanges(draft, selectedTool);\n      }\n    } else {\n      resetTool(draft, false);\n    }\n    setMargin(draft);\n  }\n}\n\nfunction setSelectedOptionPanel(draft: Draft<State>, selectedOptionPanel) {\n  draft.selectedOptionPanel = selectedOptionPanel;\n}\n\nfunction setSpectrumsVerticalAlign(draft: Draft<State>) {\n  changeSpectrumVerticalAlignment(draft, !draft.verticalAlign.flag);\n}\n\nfunction handleChangeSpectrumDisplayMode(draft: Draft<State>, { flag }) {\n  const state = original(draft) as State;\n  const { activeSpectrum, height, activeTab } = draft;\n  let YAxisShift = DEFAULT_YAXIS_SHIFT_VALUE;\n  if (activeSpectrum) {\n    const { index } = activeSpectrum;\n    if ((state.data[index] as Datum1D).info.isFid) {\n      YAxisShift = height / 2;\n    }\n  }\n  draft.verticalAlign.flag = flag;\n  draft.verticalAlign.stacked = flag;\n\n  if (flag) {\n    const count = (state.data as Datum1D[]).filter(\n      (datum) => datum.info.nucleus === activeTab,\n    ).length;\n    draft.verticalAlign.value = Math.floor(height / (count + 2));\n  } else {\n    draft.verticalAlign.value = YAxisShift;\n  }\n}\n\nfunction handleAddBaseLineZone(draft: Draft<State>, { from, to }) {\n  const scaleX = getXScale(draft);\n\n  let start = scaleX.invert(from);\n  const end = scaleX.invert(to);\n\n  let zone: any = [];\n  if (start > end) {\n    zone = [end, start];\n  } else {\n    zone = [start, end];\n  }\n\n  const zones = draft.baseLineZones.slice();\n  zones.push({\n    id: generateID(),\n    from: zone[0],\n    to: zone[1],\n  });\n  draft.baseLineZones = zones;\n}\n\nfunction handleDeleteBaseLineZone(draft: Draft<State>, id) {\n  const state = original(draft) as State;\n  draft.baseLineZones = state.baseLineZones.filter((zone) => zone.id !== id);\n}\n\nfunction handleToggleRealImaginaryVisibility(draft) {\n  if (draft.activeSpectrum != null) {\n    const { index } = draft.activeSpectrum;\n\n    draft.data[index].display.isRealSpectrumVisible = !draft.data[index].display\n      .isRealSpectrumVisible;\n    if (draft.data[index].display.isRealSpectrumVisible) {\n      const re = draft.data[index].data.re;\n      if (re !== null && re !== undefined) {\n        draft.data[index].data.y = re;\n      }\n    } else {\n      const im = draft.data[index].data.im;\n\n      if (im !== null && im !== undefined) {\n        draft.data[index].data.y = im;\n      }\n    }\n\n    setDomain(draft);\n  }\n}\n\nfunction handleBrushEnd(draft: Draft<State>, action) {\n  const is2D = draft.displayerMode === DISPLAYER_MODE.DM_2D;\n  const xScale = getXScale(draft);\n\n  const yScale = is2D ? get2DYScale(draft) : getYScale(draft);\n\n  const startX = xScale.invert(action.startX);\n  const endX = xScale.invert(action.endX);\n  const startY = yScale.invert(action.startY);\n  const endY = yScale.invert(action.endY);\n  const domainX = startX > endX ? [endX, startX] : [startX, endX];\n  const domainY = startY > endY ? [endY, startY] : [startY, endY];\n  const brushHistory = ZoomHistory.getInstance(\n    draft.ZoomHistory,\n    draft.activeTab,\n  );\n\n  if (draft.displayerMode === DISPLAYER_MODE.DM_2D) {\n    switch (action.trackID) {\n      case LAYOUT.CENTER_2D:\n        draft.xDomain = domainX;\n        draft.yDomain = domainY;\n        break;\n      case LAYOUT.TOP_1D:\n        draft.xDomain = domainX;\n        break;\n      case LAYOUT.LEFT_1D:\n        draft.yDomain = domainY;\n        break;\n      default:\n        break;\n    }\n    if (brushHistory) {\n      brushHistory.push({ xDomain: domainX, yDomain: domainY });\n    }\n  } else {\n    draft.xDomain = domainX;\n    if (brushHistory) {\n      brushHistory.push({ xDomain: domainX, yDomain: domainY });\n    }\n  }\n}\nfunction setVerticalIndicatorXPosition(draft: Draft<State>, position) {\n  const scaleX = getXScale(draft);\n  draft.pivot = scaleX.invert(position);\n}\n\nfunction getSpectrumID(draft: Draft<State>, index) {\n  return draft.tabActiveSpectrum[draft.activeTab.split(',')[index]].id;\n}\n\nfunction handleZoom(draft: Draft<State>, action) {\n  const { deltaY, deltaMode, trackID } = action;\n  if (trackID) {\n    switch (trackID) {\n      case LAYOUT.TOP_1D: {\n        const id = getSpectrumID(draft, 0);\n        wheel(deltaY, deltaMode, draft, id);\n        setZoom1D(draft, draft.margin.top, 10, 0);\n        break;\n      }\n      case LAYOUT.LEFT_1D: {\n        const id = getSpectrumID(draft, 1);\n        wheel(deltaY, deltaMode, draft, id);\n        setZoom1D(draft, draft.margin.left, 10, 1);\n        break;\n      }\n      default:\n        break;\n    }\n  } else {\n    wheel(deltaY, deltaMode, draft);\n    setZoom(draft);\n  }\n}\n\nfunction zoomOut(draft: Draft<State>, action) {\n  if (draft?.data.length > 0) {\n    const { zoomType, trackID } = action;\n    const zoomHistory = ZoomHistory.getInstance(\n      draft.ZoomHistory,\n      draft.activeTab,\n    );\n\n    if (draft.displayerMode === DISPLAYER_MODE.DM_1D) {\n      switch (zoomType) {\n        case ZoomType.HORIZONTAL: {\n          draft.xDomain = draft.originDomain.xDomain;\n          break;\n        }\n        case ZoomType.VERTICAL:\n          setZoom(draft, 0.8);\n          break;\n        case ZoomType.STEP_HROZENTAL: {\n          const zoomValue = zoomHistory.pop();\n          draft.xDomain = zoomValue\n            ? zoomValue.xDomain\n            : draft.originDomain.xDomain;\n          setZoom(draft, 0.8);\n          break;\n        }\n        default: {\n          draft.xDomain = draft.originDomain.xDomain;\n          setZoom(draft, 0.8);\n          break;\n        }\n      }\n    } else {\n      const { xDomain, yDomain, yDomains } = draft.originDomain;\n      switch (trackID) {\n        case LAYOUT.TOP_1D: {\n          const { id } = draft.tabActiveSpectrum[draft.activeTab.split(',')[0]];\n          draft.xDomain = xDomain;\n          draft.yDomains[id] = yDomains[id];\n          break;\n        }\n        case LAYOUT.LEFT_1D: {\n          const { id } = draft.tabActiveSpectrum[draft.activeTab.split(',')[1]];\n          draft.yDomain = yDomain;\n          draft.yDomains[id] = yDomains[id];\n\n          break;\n        }\n        case LAYOUT.CENTER_2D: {\n          const zoomValue = zoomHistory.pop();\n          draft.xDomain = zoomValue ? zoomValue.xDomain : xDomain;\n          draft.yDomain = zoomValue ? zoomValue.yDomain : yDomain;\n          break;\n        }\n        default:\n          draft.xDomain = xDomain;\n          draft.yDomain = yDomain;\n          draft.yDomains = yDomains;\n          break;\n      }\n    }\n  }\n}\n\nfunction hasAcceptedSpectrum(draft: Draft<State>, index) {\n  const nucleuses = draft.activeTab.split(',');\n  return (\n    draft.tabActiveSpectrum[nucleuses[index]] &&\n    !(draft.data[draft.tabActiveSpectrum[nucleuses[index]].index] as Datum1D)\n      .info.isFid\n  );\n}\n\nfunction setMargin(draft: Draft<State>) {\n  if (\n    draft.displayerMode === DISPLAYER_MODE.DM_2D &&\n    draft.selectedTool !== options.slicingTool.id\n  ) {\n    const top = hasAcceptedSpectrum(draft, 0)\n      ? MARGIN['2D'].top\n      : MARGIN['1D'].top;\n    const left = hasAcceptedSpectrum(draft, 1)\n      ? MARGIN['2D'].left\n      : MARGIN['1D'].left;\n    draft.margin = { ...MARGIN['2D'], top, left };\n  } else if (draft.selectedTool === options.slicingTool.id) {\n    draft.margin = MARGIN['2D'];\n  } else if (draft.displayerMode === DISPLAYER_MODE.DM_1D) {\n    draft.margin = MARGIN['1D'];\n  }\n}\n\nfunction Processing2DData(draft: Draft<State>, data) {\n  if (draft.displayerMode === DISPLAYER_MODE.DM_2D) {\n    let _data = {};\n    for (const datum of data[draft.activeTab]) {\n      _data[datum.id] = datum.processingController.drawContours();\n    }\n    draft.contours = _data;\n  }\n}\n\nfunction setDisplayerMode(draft: Draft<State>, data) {\n  draft.displayerMode =\n    data && (data as Datum1D[] | Datum2D[]).some((d) => d.info.dimension === 2)\n      ? DISPLAYER_MODE.DM_2D\n      : DISPLAYER_MODE.DM_1D;\n}\n\nfunction setTabActiveSpectrum(draft: Draft<State>, dataGroupByTab) {\n  let tabs2D: any[] = [];\n  const tabActiveSpectrum = {};\n\n  const tabkeys = Object.keys(dataGroupByTab).sort((a, b) =>\n    a.split(',').length > b.split(',').length ? -1 : 1,\n  );\n  for (let tabKey of tabkeys) {\n    const data = dataGroupByTab[tabKey];\n    const nucleusLength = tabKey.split(',').length;\n    if (nucleusLength === 2) {\n      tabs2D.push(tabKey);\n    }\n\n    if (data.length === 1) {\n      const index = draft.data.findIndex((datum) => datum.id === data[0].id);\n      tabActiveSpectrum[tabKey] = { id: data[0].id, index };\n    } else {\n      const tabSpectra = dataGroupByTab[tabKey];\n      const tabSpectraLength = tabSpectra.length;\n      if (tabSpectraLength >= 2) {\n        const FTSpectrums = tabSpectra.filter((d) => !d.info.isFid);\n        if (\n          FTSpectrums.length > 0 &&\n          (nucleusLength === 2 ||\n            (nucleusLength === 1 && tabSpectraLength !== FTSpectrums.length))\n        ) {\n          const index = draft.data.findIndex(\n            (datum) => datum.id === FTSpectrums[0].id,\n          );\n          tabActiveSpectrum[tabKey] = { id: FTSpectrums[0].id, index };\n        } else {\n          tabActiveSpectrum[tabKey] = null;\n        }\n      } else {\n        tabActiveSpectrum[tabKey] = null;\n      }\n    }\n  }\n  draft.tabActiveSpectrum = tabActiveSpectrum;\n  return tabs2D;\n}\n\nfunction setTab(draft: Draft<State>, dataGroupByTab, tab, refresh = false) {\n  const groupByTab = Object.keys(dataGroupByTab).sort((a, b) =>\n    a.split(',').length > b.split(',').length ? -1 : 1,\n  );\n\n  if (\n    JSON.stringify(groupByTab) !==\n      JSON.stringify(Object.keys(draft.tabActiveSpectrum)) ||\n    refresh\n  ) {\n    const tabs2D = setTabActiveSpectrum(draft, dataGroupByTab);\n\n    if (tabs2D.length > 0 && tab == null) {\n      draft.activeSpectrum = draft.tabActiveSpectrum[tabs2D[0]];\n      draft.activeTab = tabs2D[0];\n    } else {\n      draft.activeSpectrum = tab ? draft.tabActiveSpectrum[tab] : tab;\n      draft.activeTab = tab;\n    }\n  } else {\n    draft.activeTab = tab;\n    draft.activeSpectrum = draft.tabActiveSpectrum[tab];\n  }\n\n  setDisplayerMode(draft, dataGroupByTab[draft.activeTab]);\n  setMargin(draft);\n}\n\nfunction setActiveTab(\n  draft: Draft<State>,\n  tab = null,\n  refreshTabActiveSpectrums = false,\n) {\n  const groupByNucleus = GroupByInfoKey('nucleus');\n  const dataGroupByNucleus = groupByNucleus(draft.data);\n  const tabs = Object.keys(dataGroupByNucleus);\n  const currentTab = !tab || !tabs.includes(tab ?? '') ? tabs[0] : tab;\n  setTab(draft, dataGroupByNucleus, currentTab, refreshTabActiveSpectrums);\n  resetTool(draft);\n  // resetFilterTool(draft);\n\n  Processing2DData(draft, dataGroupByNucleus);\n  setDomain(draft);\n\n  const zoomHistory = ZoomHistory.getInstance(\n    draft.ZoomHistory,\n    draft.activeTab,\n  );\n  const zoomValue = zoomHistory.getLast();\n  if (zoomValue) {\n    draft.xDomain = zoomValue.xDomain;\n    draft.yDomain = zoomValue.yDomain;\n  }\n  setMode(draft);\n}\n\nfunction handelSetActiveTab(draft: Draft<State>, tab) {\n  if (tab) {\n    setActiveTab(draft, tab);\n  }\n}\n\nfunction levelChangeHandler(draft: Draft<State>, { deltaY, shiftKey }) {\n  try {\n    if (draft.activeSpectrum?.id) {\n      const { index, id } = draft.activeSpectrum;\n      // const datum2dObject = AnalysisObj.getDatum(id);\n      // if (datum2dObject instanceof Datum2D) {\n      const processingController = (draft.data[index] as Datum2D)\n        .processingController;\n      // const processing2dController = processingController.drawContours;\n      if (shiftKey) {\n        processingController.shiftWheel(deltaY);\n      } else {\n        processingController.wheel(deltaY);\n      }\n      const contours = Object.freeze(processingController.drawContours());\n      draft.contours[id] = contours;\n      // }\n    }\n  } catch (e) {\n    // eslint-disable-next-line no-console\n    console.log(e);\n  }\n}\n\nfunction setSpectraSameTopHandler(draft: Draft<State>) {\n  if (draft.displayerMode === DISPLAYER_MODE.DM_1D) {\n    draft.originDomain.yDomains = draft.originDomain.originYDomains;\n    setZoom(draft, 0.8);\n  }\n}\nfunction resetSpectraScale(draft: Draft<State>) {\n  if (draft.displayerMode === DISPLAYER_MODE.DM_1D) {\n    draft.yDomains = Object.keys(draft.yDomains).reduce((acc, key) => {\n      acc[key] = draft.originDomain.yDomain;\n      return acc;\n    }, {});\n    draft.originDomain.yDomains = draft.yDomains;\n    draft.yDomain = draft.originDomain.yDomain;\n  }\n}\n\nexport {\n  resetSelectedTool,\n  setSelectedTool,\n  setSelectedOptionPanel,\n  setSpectrumsVerticalAlign,\n  handleChangeSpectrumDisplayMode,\n  handleAddBaseLineZone,\n  handleDeleteBaseLineZone,\n  handleToggleRealImaginaryVisibility,\n  handleBrushEnd,\n  setVerticalIndicatorXPosition,\n  handleZoom,\n  zoomOut,\n  handelSetActiveTab,\n  levelChangeHandler,\n  setActiveTab,\n  setTab,\n  setSpectraSameTopHandler,\n  resetSpectraScale,\n};\n","import { Draft } from 'immer';\nimport lodashGet from 'lodash/get';\nimport { Build, Types } from 'nmr-correlation';\n\nimport { addJcamps, addJDFs } from '../../../data/SpectraManager';\nimport { initiateDatum1D } from '../../../data/data1d/Datum1D';\nimport { initiateDatum2D } from '../../../data/data2d/Datum2D';\nimport * as MoleculeManager from '../../../data/molecules/MoleculeManager';\nimport generateID from '../../../data/utilities/generateID';\nimport { Molecules, NMRiumPreferences, Spectra } from '../../NMRium';\nimport { DefaultTolerance } from '../../panels/SummaryPanel/CorrelationTable/Constants';\nimport { State } from '../Reducer';\n\nimport { changeSpectrumVerticalAlignment } from './PreferencesActions';\nimport { setActiveTab } from './ToolsActions';\nimport { initZoom1DHandler } from './Zoom';\n\nfunction setIsLoading(draft: Draft<State>, isLoading: boolean) {\n  draft.isLoading = isLoading;\n}\n\nfunction setData(\n  draft: Draft<State>,\n  data: {\n    spectra: Spectra;\n    molecules: Molecules;\n    preferences: NMRiumPreferences;\n    correlations: Types.CorrelationData;\n  },\n) {\n  const {\n    spectra,\n    molecules,\n    preferences,\n    correlations,\n    // multipleAnalysis,\n  } = data || {\n    spectra: [],\n    molecules: [],\n    preferences: {},\n    correlations: {},\n    multipleAnalysis: {},\n  };\n  draft.data = spectra;\n  draft.molecules = MoleculeManager.fromJSON(molecules);\n  draft.preferences = preferences;\n\n  if (!correlations || Object.keys(correlations).length === 0) {\n    draft.correlations = Build.init({\n      values: [],\n      options: { tolerance: DefaultTolerance, mf: '' },\n      state: {},\n    });\n  } else {\n    draft.correlations = Build.init(correlations);\n  }\n\n  // const spectraAnalysis = AnalysisObj.getMultipleAnalysis();\n}\n\nfunction initiate(draft: Draft<State>, action) {\n  draft.displayerKey = generateID();\n  setData(draft, action.payload);\n  initZoom1DHandler(draft.data);\n  const alignCenter = lodashGet(draft.preferences, 'display.center', null);\n  changeSpectrumVerticalAlignment(draft, alignCenter, true);\n  setActiveTab(draft);\n  draft.isLoading = false;\n}\n\nfunction loadJDFFile(draft: Draft<State>, files) {\n  const spectra = addJDFs(files);\n  for (const spectrum of spectra) {\n    draft.data.push(spectrum);\n  }\n\n  setActiveTab(draft);\n  initZoom1DHandler(draft.data);\n\n  draft.isLoading = false;\n}\n\nfunction loadJcampFile(draft: Draft<State>, files) {\n  const spectra = addJcamps(files);\n  for (const spectrum of spectra) {\n    draft.data.push(spectrum);\n  }\n  changeSpectrumVerticalAlignment(draft, false, true);\n  setActiveTab(draft);\n  initZoom1DHandler(draft.data);\n\n  draft.isLoading = false;\n}\n\nfunction handleLoadJsonFile(draft: Draft<State>, files) {\n  const data = JSON.parse(files[0].binary.toString());\n\n  for (const i in data.spectra) {\n    if (data.spectra[i].info?.dimension === 1) {\n      data.spectra[i] = initiateDatum1D(data.spectra[i]);\n    } else if (data.spectra[i].info?.dimension === 2) {\n      data.spectra[i] = initiateDatum2D(data.spectra[i]);\n    }\n  }\n\n  setData(draft, data);\n  const alignCenter = lodashGet(draft.preferences, 'display.center', null);\n\n  changeSpectrumVerticalAlignment(draft, alignCenter, true);\n\n  setActiveTab(draft);\n  initZoom1DHandler(draft.data);\n\n  draft.isLoading = false;\n}\n\nfunction handleLoadMOLFile(draft: Draft<State>, files) {\n  for (let file of files) {\n    MoleculeManager.addMolfile(draft.molecules, file.binary.toString());\n  }\n  draft.isLoading = false;\n}\n\nfunction handleLoadZIPFile(draft: Draft<State>, action) {\n  draft.data = action.payload;\n  setActiveTab(draft);\n  initZoom1DHandler(draft.data);\n  draft.isLoading = false;\n}\n\nexport {\n  setIsLoading,\n  initiate,\n  loadJcampFile,\n  loadJDFFile,\n  handleLoadJsonFile,\n  handleLoadMOLFile,\n  handleLoadZIPFile,\n};\n","import { Draft, original } from 'immer';\nimport cloneDeep from 'lodash/cloneDeep';\n\nimport { Filters } from '../../../data/Filters';\nimport * as FiltersManager from '../../../data/FiltersManager';\nimport {\n  DatumKind,\n  SignalKindsToInclude,\n} from '../../../data/constants/SignalsKinds';\nimport {\n  addRange,\n  changeRangeSignal,\n  detectRanges,\n  updateIntegralRanges,\n  changeRange,\n  changeRangesRealtive,\n  Datum1D,\n  Range,\n  Signal,\n  updateXShift,\n} from '../../../data/data1d/Datum1D';\nimport {\n  getPubIntegral,\n  unlink,\n  unlinkInAssignmentData,\n} from '../../../data/utilities/RangeUtilities';\nimport { State } from '../Reducer';\nimport getRange from '../helper/getRange';\n\nimport { handleUpdateCorrelations } from './CorrelationsActions';\nimport { setDomain } from './DomainActions';\n\nfunction handleAutoRangesDetection(draft: Draft<State>, detectionOptions) {\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n    detectRanges(draft.data[index], detectionOptions);\n    handleOnChangeRangesData(draft);\n  }\n}\n\nfunction getRangeIndex(state: State, spectrumIndex, rangeID) {\n  return (state.data[spectrumIndex] as Datum1D).ranges.values.findIndex(\n    (range) => range.id === rangeID,\n  );\n}\n\nfunction handleDeleteRange(draft: Draft<State>, action) {\n  const state = original(draft) as State;\n  if (state.activeSpectrum?.id) {\n    const { index } = state.activeSpectrum;\n    const { id, assignmentData } = action.payload;\n    const datum = draft.data[index] as Datum1D;\n    if (id) {\n      const range = datum.ranges.values.find((range) => range.id === id);\n      unlinkInAssignmentData(assignmentData, [range]);\n      const rangeIndex = getRangeIndex(state, index, id);\n      datum.ranges.values.splice(rangeIndex, 1);\n    } else {\n      unlinkInAssignmentData(assignmentData, datum.ranges.values);\n      datum.ranges.values = [];\n    }\n    updateIntegralRanges(draft.data[index]);\n    handleOnChangeRangesData(draft);\n  }\n}\n\nfunction handleChangeRangeSignalKind(draft: Draft<State>, action) {\n  const state = original(draft) as State;\n  if (state.activeSpectrum?.id) {\n    const { index } = state.activeSpectrum;\n    const { rowData, value } = action.payload;\n    const rangeIndex = getRangeIndex(state, index, rowData.id);\n    const _range = (draft.data[index] as Datum1D).ranges.values[\n      rangeIndex\n    ] as Range;\n    if (_range?.signal) {\n      (_range.signal[rowData.tableMetaInfo.signalIndex] as Signal).kind = value;\n      _range.kind = SignalKindsToInclude.includes(value)\n        ? DatumKind.signal\n        : DatumKind.mixed;\n      updateIntegralRanges(draft.data[index]);\n      handleOnChangeRangesData(draft);\n    }\n  }\n}\n\nfunction handleSaveEditedRange(draft: Draft<State>, action) {\n  const state = original(draft) as State;\n  if (state.activeSpectrum?.id) {\n    const { index } = state.activeSpectrum;\n    const { editedRowData, assignmentData } = action.payload;\n    // remove assignments in global state\n    const _editedRowData = unlink(editedRowData);\n    delete _editedRowData.tableMetaInfo;\n    // remove assignments in assignment hook data\n    // for now: clear all assignments for this range because signals or levels to store might have changed\n    unlinkInAssignmentData(assignmentData, _editedRowData);\n\n    const rangeIndex = getRangeIndex(state, index, _editedRowData.id);\n    (draft.data[index] as Datum1D).ranges.values[rangeIndex] = _editedRowData;\n    updateIntegralRanges(draft.data[index]);\n    handleOnChangeRangesData(draft);\n  }\n}\n\nfunction handleUnlinkRange(draft: Draft<State>, action) {\n  const state = original(draft) as State;\n  if (state.activeSpectrum?.id) {\n    const { index } = state.activeSpectrum;\n    const {\n      rangeData,\n      assignmentData,\n      isOnRangeLevel,\n      signalIndex,\n    } = action.payload;\n    // remove assignments in global state\n    for (let range of rangeData\n      ? [rangeData]\n      : (state.data[index] as Datum1D).ranges.values) {\n      const _rangeData = unlink(cloneDeep(range), isOnRangeLevel, signalIndex);\n      // remove assignments in assignment hook data\n      if (isOnRangeLevel) {\n        unlinkInAssignmentData(assignmentData, [{ id: _rangeData.id }]);\n      } else {\n        unlinkInAssignmentData(assignmentData, [\n          { id: _rangeData.signal[signalIndex].id },\n        ]);\n      }\n\n      const rangeIndex = getRangeIndex(state, index, _rangeData.id);\n      (draft.data[index] as Datum1D).ranges.values[rangeIndex] = _rangeData;\n    }\n  }\n}\n\nfunction handleSetDiaIDRange(draft, action) {\n  const state = original(draft);\n  if (state.activeSpectrum?.id) {\n    const { index } = state.activeSpectrum;\n    const { rangeData, diaID, signalIndex } = action.payload;\n\n    const rangeIndex = getRangeIndex(state, index, rangeData.id);\n    const _range = draft.data[index].ranges.values[rangeIndex];\n    if (signalIndex === undefined) {\n      _range.diaID = diaID;\n    } else {\n      _range.signal[signalIndex].diaID = diaID;\n    }\n    _range.pubIntegral = getPubIntegral(_range);\n  }\n}\n\nfunction handleResizeRange(draft: Draft<State>, action) {\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n    changeRange(draft.data[index], action.data);\n  }\n}\n\nfunction handleChangeRangeSum(draft: Draft<State>, value) {\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n    (draft.data[index] as Datum1D).ranges.options.sum = value;\n    updateIntegralRanges(draft.data[index]);\n  }\n}\nfunction handleAddRange(draft: Draft<State>, action) {\n  const { startX, endX } = action;\n  const range = getRange(draft, { startX, endX });\n\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n    const [from, to] = range;\n    addRange(draft.data[index], { from, to });\n    handleOnChangeRangesData(draft);\n  }\n}\n\nfunction handleChangeRangeRaltiveValue(draft, action) {\n  const { id: rangeID, value } = action;\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n    changeRangesRealtive(draft.data[index], rangeID, value);\n  }\n}\n\nfunction handleChangeRangeSignalValue(draft, action) {\n  const { rangeID, signalID, value } = action.payload;\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n\n    const shift = changeRangeSignal(\n      draft.data[index],\n      rangeID,\n      signalID,\n      value,\n    );\n    FiltersManager.applyFilter(draft.data[index], [\n      { name: Filters.shiftX.id, options: shift },\n    ]);\n\n    updateXShift(draft.data[index] as Datum1D);\n\n    handleOnChangeRangesData(draft);\n    setDomain(draft);\n  }\n}\n\nfunction handleOnChangeRangesData(draft) {\n  handleUpdateCorrelations(draft);\n}\n\nexport {\n  handleAutoRangesDetection,\n  handleDeleteRange,\n  handleChangeRangeSum,\n  handleAddRange,\n  handleResizeRange,\n  handleChangeRangeRaltiveValue,\n  handleChangeRangeSignalValue,\n  handleChangeRangeSignalKind,\n  handleSaveEditedRange,\n  handleUnlinkRange,\n  handleSetDiaIDRange,\n};\n","import { Draft, original } from 'immer';\nimport cloneDeep from 'lodash/cloneDeep';\n\nimport { Filters } from '../../../data/Filters';\nimport * as FiltersManager from '../../../data/FiltersManager';\nimport {\n  DatumKind,\n  SignalKindsToInclude,\n} from '../../../data/constants/SignalsKinds';\nimport {\n  changeZoneSignal,\n  Datum2D,\n  detectZones,\n  detectZonesManual,\n  updateShift,\n  Zone,\n} from '../../../data/data2d/Datum2D';\nimport {\n  getPubIntegral,\n  unlink,\n  unlinkInAssignmentData,\n} from '../../../data/utilities/ZoneUtilities';\nimport Events from '../../utility/Events';\nimport { State } from '../Reducer';\nimport get2DRange from '../helper/get2DRange';\n\n// eslint-disable-next-line import/order\nimport { handleUpdateCorrelations } from './CorrelationsActions';\n// import { AnalysisObj } from '../core/Analysis';\n\nimport { setDomain } from './DomainActions';\n\nlet noiseFactor = 1;\n\nEvents.on('noiseFactorChanged', (val) => {\n  noiseFactor = val;\n});\n\nfunction add2dZoneHandler(draft: Draft<State>, action) {\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n    const drawnZone = get2DRange(draft, action);\n    detectZonesManual(draft.data[index], {\n      selectedZone: drawnZone,\n      thresholdFactor: noiseFactor,\n      convolutionByFFT: false,\n    });\n    handleOnChangeZonesData(draft);\n  }\n}\n\nfunction handleAutoZonesDetection(draft: Draft<State>, detectionOptions) {\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n    detectZones(draft.data[index], detectionOptions);\n    handleOnChangeZonesData(draft);\n  }\n}\n\nfunction changeZoneSignalDelta(draft: Draft<State>, action) {\n  const { zoneID, signal } = action.payload;\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n    const { xShift, yShift } = changeZoneSignal(\n      draft.data[index],\n      zoneID,\n      signal,\n    );\n    let filters: any = [];\n    if (xShift !== 0) {\n      filters.push({ name: Filters.shift2DX.id, options: xShift });\n    }\n    if (yShift !== 0) {\n      filters.push({ name: Filters.shift2DY.id, options: yShift });\n    }\n\n    FiltersManager.applyFilter(draft.data[index], filters);\n\n    updateShift(draft.data[index] as Datum2D);\n\n    setDomain(draft);\n    handleOnChangeZonesData(draft);\n  }\n}\n\nfunction getZoneIndex(state, spectrumIndex, zoneID) {\n  return state.data[spectrumIndex].zones.values.findIndex(\n    (zone) => zone.id === zoneID,\n  );\n}\n\nfunction handleChangeZoneSignalKind(draft: Draft<State>, action) {\n  const state = original(draft) as State;\n  if (state.activeSpectrum?.id) {\n    const { index } = state.activeSpectrum;\n    const { rowData, value } = action.payload;\n    const zoneIndex = getZoneIndex(state, index, rowData.id);\n    const _zone = (draft.data[index] as Datum2D).zones.values[\n      zoneIndex\n    ] as Zone;\n    _zone.signal[rowData.tableMetaInfo.signalIndex].kind = value;\n    _zone.kind = SignalKindsToInclude.includes(value)\n      ? DatumKind.signal\n      : DatumKind.mixed;\n    handleOnChangeZonesData(draft);\n  }\n}\n\nfunction handleDeleteZone(draft: Draft<State>, action) {\n  const state = original(draft) as State;\n  if (state.activeSpectrum?.id) {\n    const { index } = state.activeSpectrum;\n    const { id, assignmentData } = action.payload;\n    if (id) {\n      const zone = (draft.data[index] as Datum2D).zones.values.find(\n        (zone) => zone.id === id,\n      );\n      unlinkInAssignmentData(assignmentData, [zone]);\n      const zoneIndex = getZoneIndex(state, index, id);\n      (draft.data[index] as Datum2D).zones.values.splice(zoneIndex, 1);\n    } else {\n      unlinkInAssignmentData(\n        assignmentData,\n        (draft.data[index] as Datum2D).zones.values,\n      );\n      (draft.data[index] as Datum2D).zones.values = [];\n    }\n    handleOnChangeZonesData(draft);\n  }\n}\n\nfunction handleUnlinkZone(draft: Draft<State>, action) {\n  const state = original(draft) as State;\n  if (state.activeSpectrum?.id) {\n    const { index } = state.activeSpectrum;\n    const {\n      zoneData,\n      assignmentData,\n      isOnZoneLevel,\n      signalIndex,\n      axis,\n    } = action.payload;\n\n    for (let zone of zoneData\n      ? [zoneData]\n      : (state.data[index] as Datum2D).zones.values) {\n      // remove assignments in global state\n      const _zoneData = unlink(\n        cloneDeep(zone),\n        isOnZoneLevel,\n        signalIndex,\n        axis,\n      );\n      // remove assignments in assignment hook data\n      if (isOnZoneLevel) {\n        unlinkInAssignmentData(assignmentData, [{ id: _zoneData.id }], axis);\n      } else {\n        unlinkInAssignmentData(\n          assignmentData,\n          [{ id: _zoneData.signal[signalIndex].id }],\n          axis,\n        );\n      }\n\n      const zoneIndex = getZoneIndex(state, index, _zoneData.id);\n      (draft.data[index] as Datum2D).zones.values[zoneIndex] = _zoneData;\n    }\n  }\n}\n\nfunction handleSetDiaIDZone(draft: Draft<State>, action) {\n  const state = original(draft) as State;\n  if (state.activeSpectrum?.id) {\n    const { index } = state.activeSpectrum;\n    const { zoneData, diaID, axis, signalIndex } = action.payload;\n\n    const zoneIndex = getZoneIndex(state, index, zoneData.id);\n    const _zone = (draft.data[index] as Datum2D).zones.values[\n      zoneIndex\n    ] as Zone;\n    if (signalIndex === undefined) {\n      _zone[axis].diaID = diaID;\n    } else {\n      _zone.signal[signalIndex][axis].diaID = diaID;\n    }\n    _zone[axis].pubIntegral = getPubIntegral(_zone, axis);\n  }\n}\n\nfunction handleOnChangeZonesData(draft) {\n  handleUpdateCorrelations(draft);\n}\n\nexport {\n  add2dZoneHandler,\n  handleAutoZonesDetection,\n  handleDeleteZone,\n  changeZoneSignalDelta,\n  handleChangeZoneSignalKind,\n  handleUnlinkZone,\n  handleSetDiaIDZone,\n};\n","import { get2DXScale, get2DYScale } from '../../2d/utilities/scale';\n\nexport default function get2DRange(draft, options) {\n  const { startX, startY, endX, endY } = options;\n  const scaleX = get2DXScale(draft);\n  const scaleY = get2DYScale(draft);\n  const x1 = startX * 1000000 > endX * 1000000 ? endX : startX;\n  const x2 = startX * 1000000 > endX * 1000000 ? startX : endX;\n  const y1 = startY * 1000000 > endY * 1000000 ? endY : startY;\n  const y2 = startY * 1000000 > endY * 1000000 ? startY : endY;\n\n  const fromY = scaleY.invert(y1);\n  const fromX = scaleX.invert(x1);\n  const toY = scaleY.invert(y2);\n  const toX = scaleX.invert(x2);\n  return { fromX, fromY, toX, toY };\n}\n","import { Draft } from 'immer';\nimport { signalsToXY } from 'nmr-processing';\n\nimport {\n  initiateDatum1D,\n  mapRanges,\n  updateIntegralRanges,\n} from '../../../data/data1d/Datum1D';\nimport * as MoleculeManager from '../../../data/molecules/MoleculeManager';\nimport { State } from '../Reducer';\nimport { DISPLAYER_MODE } from '../core/Constants';\n\nimport { handleUnlinkRange } from './RangesActions';\nimport { setActiveTab } from './ToolsActions';\nimport { handleUnlinkZone } from './ZonesActions';\nimport { initZoom1DHandler, setZoom } from './Zoom';\n\nfunction addMoleculeHandler(draft: Draft<State>, molfile) {\n  MoleculeManager.addMolfile(draft.molecules, molfile);\n}\n\nfunction setMoleculeHandler(draft: Draft<State>, molfile, key) {\n  MoleculeManager.setMolfile(draft.molecules, molfile, key);\n}\n\nfunction deleteMoleculeHandler(draft: Draft<State>, action) {\n  const { key, assignmentData } = action.payload;\n  if (draft.displayerMode === DISPLAYER_MODE.DM_1D) {\n    handleUnlinkRange(draft, { payload: { assignmentData, rangeData: null } });\n  }\n  if (draft.displayerMode === DISPLAYER_MODE.DM_2D) {\n    handleUnlinkZone(draft, { payload: { assignmentData, zoneData: null } });\n  }\n  const moleculeIndex = draft.molecules.findIndex(\n    (molecule) => molecule.key === key,\n  );\n\n  draft.molecules.splice(moleculeIndex, 1);\n}\n\nfunction predictSpectraFromMolculeHandler(draft: Draft<State>, action) {\n  const { fromMolfile, options } = action.payload;\n  const { x, y } = signalsToXY(fromMolfile.signals, {});\n  let id: any = null;\n  if (options.spectra['1h']) {\n    const datum = initiateDatum1D({\n      data: { x, im: null, re: y },\n      info: { nucleus: '1H' },\n    });\n    id = datum.id;\n    datum.ranges.values = mapRanges(fromMolfile.ranges, datum);\n    updateIntegralRanges(datum);\n    draft.data.push(datum);\n    const activeSpectrum = { id, index: draft.data.length - 1 };\n    draft.tabActiveSpectrum['1H'] = activeSpectrum;\n    draft.activeSpectrum = activeSpectrum;\n  }\n  setActiveTab(draft);\n  initZoom1DHandler(draft.data);\n  setZoom(draft, 0.9, id);\n\n  draft.isLoading = false;\n}\n\nexport {\n  addMoleculeHandler,\n  setMoleculeHandler,\n  deleteMoleculeHandler,\n  predictSpectraFromMolculeHandler,\n};\n","import { Draft, original } from 'immer';\n\nimport { lookupPeak, Datum1D, getShiftX } from '../../../data/data1d/Datum1D';\nimport autoPeakPicking from '../../../data/data1d/autoPeakPicking';\nimport generateID from '../../../data/utilities/generateID';\nimport { options } from '../../toolbar/ToolTypes';\nimport { State } from '../Reducer';\nimport getRange from '../helper/getRange';\n\n// import { AnalysisObj } from '../core/Analysis';\n\nfunction addPeak(draft: Draft<State>, mouseCoordinates) {\n  const state = original(draft) as State;\n  if (draft.activeSpectrum?.id && state) {\n    const { index } = draft.activeSpectrum;\n    const xShift = 10;\n    const startX = mouseCoordinates.x - xShift;\n    const endX = mouseCoordinates.x + xShift;\n    const [from, to] = getRange(draft, { startX, endX });\n    const candidatePeak = lookupPeak(state.data[index].data, { from, to });\n\n    const shiftX = getShiftX(draft.data[index] as Datum1D);\n\n    if (candidatePeak) {\n      const peak = {\n        id: generateID(),\n        originDelta: candidatePeak.x - shiftX,\n        delta: candidatePeak.x,\n        intensity: candidatePeak.y,\n      };\n      (draft.data[index] as Datum1D).peaks.values.push(peak);\n    }\n  }\n}\n\nfunction addPeaks(draft: Draft<State>, action) {\n  const state = original(draft) as State;\n\n  if (draft.activeSpectrum) {\n    const { index } = draft.activeSpectrum;\n    const datumOriginal = state.data[index] as Datum1D;\n\n    const { startX, endX } = action;\n    const [from, to] = getRange(draft, { startX, endX });\n\n    if (from !== to) {\n      const peak = lookupPeak(datumOriginal.data, { from, to });\n\n      const shiftX = getShiftX(draft.data[index] as Datum1D);\n\n      if (peak && !datumOriginal.peaks.values.some((p) => p.delta === peak.x)) {\n        const newPeak = {\n          id: generateID(),\n          originDelta: peak.x - shiftX,\n          delta: peak.x,\n          intensity: peak.y,\n        };\n        (draft.data[index] as Datum1D).peaks.values.push(newPeak);\n      }\n    }\n  }\n}\n\nfunction deletePeak(draft: Draft<State>, peakData) {\n  const { index } = draft.activeSpectrum;\n  const state = original(draft) as State;\n\n  if (peakData == null) {\n    (draft.data[index] as Datum1D).peaks.values = [];\n  } else {\n    const peakIndex = (state.data[index] as Datum1D).peaks.values.findIndex(\n      (p) => p.id === peakData.id,\n    );\n    (draft.data[index] as Datum1D).peaks.values.splice(peakIndex, 1);\n  }\n}\n\nfunction handleAutoPeakPicking(draft: Draft<State>, autOptions) {\n  if (draft.activeSpectrum?.id) {\n    draft.selectedTool = options.zoom.id;\n    draft.selectedOptionPanel = null;\n    const { index } = draft.activeSpectrum;\n    const peaks = autoPeakPicking(draft.data[index], autOptions);\n    (draft.data[index] as Datum1D).peaks.values = peaks;\n  }\n}\n\nexport { addPeak, addPeaks, deletePeak, handleAutoPeakPicking };\n","import median from 'ml-array-median';\nimport { xyAutoPeaksPicking } from 'nmr-processing';\n\nimport { getShiftX } from '../data1d/Datum1D';\nimport generateID from '../utilities/generateID';\n\nexport default function autoPeakPicking(datum1D, options) {\n  const { minMaxRatio, maxNumberOfPeaks, noiseFactor, lookNegative } = options;\n  // we calculate the noise but this could be improved\n  const noise = median(datum1D.data.re.map((y) => Math.abs(y)));\n\n  const { re, x } = datum1D.data;\n  let peaks = xyAutoPeaksPicking(\n    { x, y: re },\n    {\n      lookNegative,\n      noiseLevel: noise * noiseFactor,\n      minMaxRatio: minMaxRatio, // Threshold to determine if a given peak should be considered as a noise\n      realTopDetection: true,\n      maxCriteria: true,\n      smoothY: false,\n      sgOptions: { windowSize: 15, polynomial: 3 },\n    },\n  );\n  peaks.sort((a, b) => b.y - a.y);\n  if (maxNumberOfPeaks < peaks.length) peaks = peaks.slice(0, maxNumberOfPeaks);\n\n  const shiftX = getShiftX(datum1D);\n\n  return peaks.map((peak) => {\n    return {\n      id: generateID(),\n      originDelta: peak.x - shiftX,\n      delta: peak.x,\n      intensity: peak.y,\n      width: peak.width,\n    };\n  });\n}\n","import { Draft } from 'immer';\n\nimport * as MulitpleAnalysis from '../../../data/data1d/MulitpleAnalysis';\nimport { State } from '../Reducer';\nimport getRange from '../helper/getRange';\n\nfunction analyzeSpectra(draft: Draft<State>, action) {\n  const [from, to] = getRange(draft, action);\n  MulitpleAnalysis.analyzeSpectra(draft.data, draft.spectraAnalysis, {\n    from,\n    to,\n    nucleus: draft.activeTab,\n  });\n}\n\nfunction handleDeleteSpectraRanges(draft: Draft<State>, action) {\n  const { colKey } = action;\n  MulitpleAnalysis.deleteSpectraAnalysis(\n    draft.spectraAnalysis,\n    colKey,\n    draft.activeTab,\n  );\n}\nfunction handleResizeSpectraRange(draft: Draft<State>, action) {\n  const { columnKey, from, to } = action.payload;\n  MulitpleAnalysis.analyzeSpectra(draft.data, draft.spectraAnalysis, {\n    from,\n    to,\n    nucleus: draft.activeTab,\n    columnKey,\n  });\n}\nfunction handleSetcolumns(draft: Draft<State>, action) {\n  const data = action.payload;\n  MulitpleAnalysis.setColumn(draft.spectraAnalysis, draft.activeTab, data);\n}\nfunction handleFiltercolumn(draft: Draft<State>, action) {\n  const { columnKey, valueKey } = action.payload;\n  MulitpleAnalysis.changeColumnValueKey(\n    draft.spectraAnalysis,\n    draft.activeTab,\n    columnKey,\n    valueKey,\n  );\n}\n\nexport {\n  analyzeSpectra,\n  handleDeleteSpectraRanges,\n  handleResizeSpectraRange,\n  handleSetcolumns,\n  handleFiltercolumn,\n};\n","import { xyCalibrate } from 'ml-spectra-processing';\n\nimport { getRange } from '../constants/References';\n/**\n *\n * @param {*} datum1D\n * @param {object} [options={}]\n * @param {number} [options.from]\n * @param {number} [options.to] Define the from zone where the reference is expected to be found\n * @param {number} [options.from]\n * @param {number} [options.nbPeaks]\n * @param {number} [options.targetX]\n * @param {string} [options.reference]\n */\n\nexport default function getReferenceShift(datum1D, options) {\n  let { from, to, nbPeaks, targetX, reference } = options;\n  if (reference) {\n    let data = getRange({ reference: reference, nucleus: datum1D.nucleus });\n    from = data.from;\n    to = data.to;\n    nbPeaks = data.nbPeaks;\n    targetX = data.delta;\n  }\n\n  const { re, x } = datum1D.data;\n  return xyCalibrate({ x, y: re }, { from, to }, { nbPeaks, targetX });\n}\n","import { Draft, original } from 'immer';\n\nimport { Filters } from '../../../data/Filters';\nimport { applyFilter } from '../../../data/FiltersManager';\nimport { Datum1D } from '../../../data/data1d/Datum1D';\nimport getReferenceShift from '../../../data/data1d/getReferenceShift';\nimport { getMissingProjection, Datum2D } from '../../../data/data2d/Datum2D';\nimport GroupByInfoKey from '../../utility/GroupByInfoKey';\nimport { State } from '../Reducer';\n\nimport { setDomain, setMode } from './DomainActions';\nimport { setTab, setActiveTab } from './ToolsActions';\n\nfunction checkIsVisible2D(datum: Datum2D): boolean {\n  if (\n    datum.display.isPositiveVisible === false &&\n    datum.display.isNegativeVisible === false\n  ) {\n    return false;\n  }\n  return true;\n}\n\nfunction setVisible(datum, flag) {\n  if (datum.info.dimension === 2) {\n    (datum as Datum2D).display.isPositiveVisible = flag;\n    (datum as Datum2D).display.isNegativeVisible = flag;\n    (datum as Datum2D).display.isVisible = checkIsVisible2D(datum as Datum2D);\n  } else {\n    (datum as Datum1D).display.isVisible = flag;\n  }\n}\n\nfunction handleSpectrumVisibility(draft: Draft<State>, action) {\n  if (Array.isArray(action.id)) {\n    const IDs = action.id;\n    if (IDs.length === 0) {\n      for (const datum of draft.data) {\n        setVisible(datum, false);\n      }\n    } else {\n      for (const datum of draft.data) {\n        if (IDs.includes(datum.id)) {\n          setVisible(datum, true);\n        } else {\n          setVisible(datum, false);\n        }\n      }\n    }\n  } else {\n    const index = draft.data.findIndex((d) => d.id === action.id);\n    (draft.data[index] as Datum1D | Datum2D).display[action.key] = action.value;\n\n    if ((draft.data[index] as Datum1D | Datum2D).info.dimension === 2) {\n      (draft.data[index] as Datum2D).display.isVisible = checkIsVisible2D(\n        draft.data[index] as Datum2D,\n      );\n    }\n  }\n}\n\nfunction handleChangePeaksMarkersVisibility(draft: Draft<State>, data) {\n  for (let datum of draft.data) {\n    if (\n      datum.info?.dimension === 1 &&\n      data.some((activeData) => activeData.id === datum.id)\n    ) {\n      (datum as Datum1D).display.isPeaksMarkersVisible = true;\n    } else {\n      (datum as Datum1D).display.isPeaksMarkersVisible = false;\n    }\n  }\n}\n\nfunction handleChangeActiveSpectrum(draft: Draft<State>, activeSpectrum) {\n  // const state = original(draft);\n\n  let refreshDomain = false;\n  if (activeSpectrum) {\n    // AnalysisObj.getDatum(activeSpectrum.id).setDisplay({ isVisible: true });\n    const newIndex = draft.data.findIndex((d) => d.id === activeSpectrum.id);\n    const oldIndex = draft.data.findIndex(\n      (d) => d.id === draft.activeSpectrum?.id,\n    );\n    if (newIndex !== -1) {\n      const newActiveSpectrum = draft.data[newIndex] as Datum1D | Datum2D;\n\n      newActiveSpectrum.display.isVisible = true;\n\n      if (oldIndex !== -1) {\n        refreshDomain =\n          (draft.data[oldIndex] as Datum1D | Datum2D).info.isFid ===\n          newActiveSpectrum.info.isFid\n            ? false\n            : true;\n      } else {\n        refreshDomain = newActiveSpectrum.info.isFid || false;\n      }\n    }\n    activeSpectrum = { ...activeSpectrum, index: newIndex };\n    draft.activeSpectrum = activeSpectrum;\n    draft.tabActiveSpectrum[draft.activeTab] = activeSpectrum;\n  } else {\n    draft.activeSpectrum = null;\n    draft.tabActiveSpectrum[draft.activeTab] = null;\n    refreshDomain = false;\n  }\n\n  /**\n   * if the active spectrum not is FID then dont refresh the domain and the mode when the first time you activate soectrum\n   * if the new active spectrum different than the previous active spectrum fid then refresh the domain andf the mode.\n   */\n  if (refreshDomain) {\n    setDomain(draft);\n    // const tab = draft.activeTab;\n    // delete draft.tabActiveSpectrum[tab];\n    setMode(draft);\n  }\n}\n\nfunction changeSpectrumSetting(draft: Draft<State>, { id, display }) {\n  const state = original(draft) as State;\n  const index = state.data.findIndex((d) => d.id === id);\n  if (index !== -1) {\n    draft.data[index].display = display;\n  }\n}\nfunction handleChangeSpectrumColor(draft: Draft<State>, { id, color, key }) {\n  const state = original(draft) as State;\n  const index = state.data.findIndex((d) => d.id === id);\n  if (index !== -1) {\n    (draft.data[index] as Datum1D | Datum2D).display[key] = color;\n  }\n}\n\nfunction handleDeleteSpectra(draft: Draft<State>, action) {\n  const { activeTab } = draft;\n  const state = original(draft) as State;\n  if (action.id) {\n    const index = state.data.findIndex((d) => d.id === action.id);\n    draft.data.splice(index, 1);\n  } else {\n    draft.data.forEach((datum, index) => {\n      draft.data.splice(index, 1);\n    });\n  }\n  draft.activeSpectrum = null;\n  setActiveTab(draft, activeTab, true);\n}\nfunction addMissingProjectionHander(draft, action) {\n  const state = original(draft);\n  const nucleus = action.nucleus;\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n    for (let n of nucleus) {\n      const datum1D = getMissingProjection(state.data[index], n);\n      draft.data.push(datum1D);\n    }\n    const groupByNucleus = GroupByInfoKey('nucleus');\n    const dataGroupByNucleus = groupByNucleus(draft.data);\n    setTab(draft, dataGroupByNucleus, draft.activeTab, true);\n    setDomain(draft);\n    setMode(draft);\n  }\n}\nfunction alignSpectraHandler(draft: Draft<State>, action) {\n  if (draft.data && draft.data.length > 0) {\n    for (let datum of draft.data) {\n      if (\n        datum.info?.dimension === 1 &&\n        datum.info.nucleus === draft.activeTab &&\n        !datum.info?.isFid\n      ) {\n        const shift = getReferenceShift(datum, { ...action.payload });\n        applyFilter(datum, [\n          {\n            name: Filters.shiftX.id,\n            options: shift,\n          },\n        ]);\n      }\n    }\n  }\n\n  setDomain(draft);\n  setMode(draft);\n}\n\nexport {\n  handleSpectrumVisibility,\n  handleChangePeaksMarkersVisibility,\n  handleChangeActiveSpectrum,\n  handleChangeSpectrumColor,\n  changeSpectrumSetting,\n  handleDeleteSpectra,\n  addMissingProjectionHander,\n  alignSpectraHandler,\n};\n","export const UNDO = 'undo';\nexport const REDO = 'redo';\nexport const SET = 'set';\nexport const RESET = 'reset';\n","import { produce } from 'immer';\nimport { Build, Types } from 'nmr-correlation';\nimport { predictionProton } from 'nmr-processing';\nimport OCL from 'openchemlib/full';\n\nimport * as SpectraManager from '../../data/SpectraManager';\nimport { Spectra } from '../NMRium';\nimport { DefaultTolerance } from '../panels/SummaryPanel/CorrelationTable/Constants';\nimport { options } from '../toolbar/ToolTypes';\n\nimport * as CorrelationsActions from './actions/CorrelationsActions';\nimport { setWidth, handleSetDimensions } from './actions/DimensionsActions';\nimport * as DomainActions from './actions/DomainActions';\nimport { exportData } from './actions/ExportActions';\nimport * as FiltersActions from './actions/FiltersActions';\nimport * as GlobalActions from './actions/GlobalActions';\nimport {\n  handleHistoryUndo,\n  handleHistoryRedo,\n  handleHistoryReset,\n} from './actions/HistoryActions';\nimport * as IntegralsActions from './actions/IntegralsActions';\nimport * as LoadActions from './actions/LoadActions';\nimport * as MoleculeActions from './actions/MoleculeActions';\nimport * as PeaksActions from './actions/PeaksActions';\nimport {\n  handelSetPreferences,\n  setKeyPreferencesHandler,\n  applyKeyPreferencesHandler,\n} from './actions/PreferencesActions';\nimport * as RangesActions from './actions/RangesActions';\nimport * as SpectraAanalysisActions from './actions/SpectraAanalysisAction';\nimport * as SpectrumsActions from './actions/SpectrumsActions';\nimport * as ToolsActions from './actions/ToolsActions';\nimport * as ZonesActions from './actions/ZonesActions';\nimport { DEFAULT_YAXIS_SHIFT_VALUE, DISPLAYER_MODE } from './core/Constants';\nimport { UNDO, REDO, RESET } from './types/HistoryTypes';\nimport * as types from './types/Types';\n\nexport const initialState = {\n  data: null,\n  contours: null,\n  tempData: null,\n  xDomain: [],\n  yDomain: [],\n  yDomains: {},\n  xDomains: {},\n  originDomain: {},\n  integralsYDomains: {},\n  originIntegralYDomain: {},\n  selectedTool: options.zoom.id,\n  selectedFilter: null,\n  selectedOptionPanel: null,\n  activeTab: null,\n  width: 0,\n  height: 0,\n  margin: {\n    top: 10,\n    right: 20,\n    bottom: 70,\n    left: 0,\n  },\n  activeSpectrum: null,\n  mode: 'RTL',\n  zoomFactor: { scale: 1 },\n  integralZoomFactor: { scale: 0.5 },\n  molecules: [],\n  verticalAlign: {\n    flag: false,\n    stacked: false,\n    value: DEFAULT_YAXIS_SHIFT_VALUE,\n  },\n  history: {\n    past: [],\n    present: null,\n    future: [],\n    hasUndo: false,\n    hasRedo: false,\n  },\n  pivot: 0,\n  isLoading: false,\n  preferences: {},\n  baseLineZones: [],\n  keysPreferences: {},\n  displayerMode: DISPLAYER_MODE.DM_1D,\n  tabActiveSpectrum: {},\n  spectraAnalysis: {},\n  correlations: Build.init({\n    values: [],\n    options: { tolerance: DefaultTolerance, mf: '' },\n    state: {},\n  }),\n  displayerKey: '',\n  ZoomHistory: {},\n  overDisplayer: false,\n};\n\nexport interface State {\n  data: Spectra;\n  contours: any;\n  tempData: any;\n  xDomain: Array<number>;\n  yDomain: Array<number>;\n  yDomains: any;\n  xDomains: any;\n  originDomain: any;\n  integralsYDomains: any;\n  originIntegralYDomain: any;\n  selectedTool: any;\n  selectedFilter: any;\n  selectedOptionPanel: any;\n  activeTab: any;\n  width: any;\n  height: any;\n  margin: Partial<{ top: number; right: number; bottom: number; left: number }>;\n  activeSpectrum: any;\n  mode: string;\n  zoomFactor: Partial<{ scale: number }>;\n  integralZoomFactor: Partial<{ scale: number }>;\n  molecules: Array<any>;\n  verticalAlign: Partial<{\n    flag: boolean;\n    stacked: boolean;\n    value: number;\n  }>;\n  history: Partial<{\n    past: Array<any>;\n    present: any;\n    future: Array<any>;\n    hasUndo: boolean;\n    hasRedo: boolean;\n  }>;\n  pivot: number;\n  isLoading: boolean;\n  preferences: any;\n  baseLineZones: any;\n  keysPreferences: any;\n  displayerMode: any;\n  tabActiveSpectrum: any;\n  spectraAnalysis: any;\n  displayerKey: any;\n  correlations: Types.CorrelationData;\n  actionType: null;\n  ZoomHistory: any;\n  overDisplayer: boolean;\n}\n\nexport function dispatchMiddleware(dispatch) {\n  return (action) => {\n    switch (action.type) {\n      case types.INITIATE: {\n        if (action.payload) {\n          const { spectra, ...res } = action.payload;\n          void SpectraManager.fromJSON(spectra).then((data) => {\n            action.payload = { spectra: data, ...res };\n            dispatch(action);\n          });\n        } else {\n          dispatch(action);\n        }\n        break;\n      }\n      case types.LOAD_ZIP_FILE: {\n        for (let zipFile of action.files) {\n          void SpectraManager.addBruker(\n            { display: { name: zipFile.name } },\n            zipFile.binary,\n          ).then((data) => {\n            action.payload = data;\n            dispatch(action);\n          });\n        }\n        break;\n      }\n      case types.PREDICT_SPECTRA: {\n        const molecule = OCL.Molecule.fromMolfile(action.payload.mol.molfile);\n        void predictionProton(molecule, {}).then((result) => {\n          action.payload.fromMolfile = result;\n          dispatch(action);\n        });\n\n        break;\n      }\n\n      default:\n        dispatch(action);\n\n        break;\n    }\n  };\n}\n\nfunction innerSpectrumReducer(draft, action) {\n  draft.actionType = action.type;\n  switch (action.type) {\n    case types.INITIATE:\n      return LoadActions.initiate(draft, action);\n    case types.SET_LOADING_FLAG:\n      return LoadActions.setIsLoading(draft, action.isLoading);\n    case types.LOAD_JSON_FILE:\n      return LoadActions.handleLoadJsonFile(draft, action.files);\n    case types.LOAD_JCAMP_FILE:\n      return LoadActions.loadJcampFile(draft, action.files);\n    case types.LOAD_JDF_FILE:\n      return LoadActions.loadJDFFile(draft, action.files);\n    case types.LOAD_MOL_FILE:\n      return LoadActions.handleLoadMOLFile(draft, action.files);\n    case types.LOAD_ZIP_FILE:\n      return LoadActions.handleLoadZIPFile(draft, action);\n    case types.EXPORT_DATA:\n      return exportData(draft, action);\n    case types.ADD_PEAK:\n      return PeaksActions.addPeak(draft, action.mouseCoordinates);\n    case types.ADD_PEAKS:\n      return PeaksActions.addPeaks(draft, action);\n\n    case types.DELETE_PEAK_NOTATION:\n      return PeaksActions.deletePeak(draft, action.data);\n\n    case types.ADD_INTEGRAL:\n      return IntegralsActions.addIntegral(draft, action);\n    case types.DELETE_INTEGRAL:\n      return IntegralsActions.deleteIntegral(draft, action);\n    case types.CHANGE_INTEGRAL_DATA:\n      return IntegralsActions.changeIntegral(draft, action);\n    case types.RESIZE_INTEGRAL:\n      return IntegralsActions.changeIntegral(draft, action);\n    case types.CHANGE_INTEGRAL_ZOOM:\n      return IntegralsActions.handleChangeIntegralZoom(draft, action);\n    case types.CHANGE_INTEGRAL_SUM:\n      return IntegralsActions.handleChangeIntegralSum(draft, action.value);\n    case types.CHANGE_INTEGRAL_RELATIVE:\n      return IntegralsActions.handleChangeIntegralsRaltiveValue(draft, action);\n\n    case types.SET_ORIGINAL_DOMAIN:\n      return DomainActions.setOriginalDomain(draft, action.domain);\n\n    case types.SET_X_DOMAIN:\n      return DomainActions.setXDomain(draft, action.xDomain);\n\n    case types.SET_Y_DOMAIN:\n      return DomainActions.setYDomain(draft, action.yDomain);\n\n    case types.SET_WIDTH:\n      return setWidth(draft, action.width);\n\n    case types.SET_DIMENSIONS:\n      return handleSetDimensions(draft, action.width, action.height);\n\n    case types.SET_SELECTED_TOOL:\n      return ToolsActions.setSelectedTool(draft, action.selectedTool);\n    case types.RESET_SELECTED_TOOL:\n      return ToolsActions.resetSelectedTool(draft);\n    case types.SET_SELECTED_OPTIONS_PANEL:\n      return ToolsActions.setSelectedOptionPanel(\n        draft,\n        action.selectedOptionPanel,\n      );\n    case types.FULL_ZOOM_OUT:\n      return ToolsActions.zoomOut(draft, action);\n    case types.SHIFT_SPECTRUM:\n      return FiltersActions.shiftSpectrumAlongXAxis(draft, action.shiftValue);\n    case types.APPLY_ZERO_FILLING_FILTER:\n      return FiltersActions.applyZeroFillingFilter(draft, action.value);\n    case types.APPLY_FFT_FILTER:\n      return FiltersActions.applyFFTFilter(draft);\n    case types.APPLY_MANUAL_PHASE_CORRECTION_FILTER:\n      return FiltersActions.applyManualPhaseCorrectionFilter(\n        draft,\n        action.value,\n      );\n    case types.APPLY_AUTO_PHASE_CORRECTION_FILTER:\n      return FiltersActions.applyAutoPhaseCorrectionFilter(draft);\n    case types.APPLY_ABSOLUTE_FILTER:\n      return FiltersActions.applyAbsoluteFilter(draft);\n    case types.CALCULATE_MANUAL_PHASE_CORRECTION_FILTER:\n      return FiltersActions.calculateManualPhaseCorrection(draft, action.value);\n    case types.ENABLE_FILTER:\n      return FiltersActions.enableFilter(draft, action.id, action.checked);\n    case types.DELETE_FILTER:\n      return FiltersActions.deleteFilter(draft, action.id);\n    case types.SET_FILTER_SNAPSHOT:\n      return FiltersActions.filterSnapshotHandler(draft, action);\n\n    case types.CHANGE_VISIBILITY:\n      return SpectrumsActions.handleSpectrumVisibility(draft, action);\n\n    case types.CHANGE_PEAKS_MARKERS_VISIBILITY:\n      return SpectrumsActions.handleChangePeaksMarkersVisibility(\n        draft,\n        action.data,\n      );\n    case types.CHANGE_ACTIVE_SPECTRUM:\n      return SpectrumsActions.handleChangeActiveSpectrum(draft, action.data);\n    case types.CHANGE_SPECTRUM_COLOR:\n      return SpectrumsActions.handleChangeSpectrumColor(draft, action.data);\n    case types.CHANGE_SPECTRUM_SETTING:\n      return SpectrumsActions.changeSpectrumSetting(draft, action);\n    case types.ALIGN_SPECTRA:\n      return SpectrumsActions.alignSpectraHandler(draft, action);\n    case types.TOGGLE_REAL_IMAGINARY_VISIBILITY:\n      return ToolsActions.handleToggleRealImaginaryVisibility(draft);\n    case types.SET_ZOOM_FACTOR:\n      return ToolsActions.handleZoom(draft, action);\n    case types.SET_SPECTRA_SAME_TOP:\n      return ToolsActions.setSpectraSameTopHandler(draft);\n    case types.RESET_SPECTRA_SCALE:\n      return ToolsActions.resetSpectraScale(draft);\n\n    case types.CHANGE_SPECTRUM_DISPLAY_VIEW_MODE:\n      return ToolsActions.handleChangeSpectrumDisplayMode(draft, action);\n\n    case types.ADD_MOLECULE:\n      return MoleculeActions.addMoleculeHandler(draft, action.molfile);\n\n    case types.SET_MOLECULE:\n      return MoleculeActions.setMoleculeHandler(\n        draft,\n        action.molfile,\n        action.key,\n      );\n\n    case types.DELETE_MOLECULE:\n      return MoleculeActions.deleteMoleculeHandler(draft, action);\n\n    case types.PREDICT_SPECTRA:\n      return MoleculeActions.predictSpectraFromMolculeHandler(draft, action);\n\n    case types.SET_CORRELATIONS_MF:\n      return CorrelationsActions.handleSetMF(draft, action.payload);\n\n    case types.SET_CORRELATIONS_TOLERANCE:\n      return CorrelationsActions.handleSetTolerance(draft, action.payload);\n\n    case types.SET_CORRELATION:\n      return CorrelationsActions.handleSetCorrelation(draft, action.payload);\n\n    case types.SET_CORRELATIONS:\n      return CorrelationsActions.handleSetCorrelations(draft, action.payload);\n\n    case types.DELETE_SPECTRA:\n      return SpectrumsActions.handleDeleteSpectra(draft, action);\n\n    case types.SET_INTEGRAL_Y_DOMAIN:\n      return DomainActions.handleChangeIntegralYDomain(draft, action.yDomain);\n\n    case types.BRUSH_END:\n      return ToolsActions.handleBrushEnd(draft, action);\n\n    case types.SET_VERTICAL_INDICATOR_X_POSITION:\n      return ToolsActions.setVerticalIndicatorXPosition(draft, action.position);\n    case types.SET_SPECTRUMS_VERTICAL_ALIGN:\n      return ToolsActions.setSpectrumsVerticalAlign(draft);\n\n    case types.AUTO_PEAK_PICKING:\n      return PeaksActions.handleAutoPeakPicking(draft, action.options);\n\n    case types.AUTO_ZONES_DETECTION:\n      return ZonesActions.handleAutoZonesDetection(draft, action.options);\n    case types.AUTO_RANGES_DETECTION:\n      return RangesActions.handleAutoRangesDetection(draft, action.options);\n    case types.ADD_RANGE:\n      return RangesActions.handleAddRange(draft, action);\n    case types.DELETE_RANGE:\n      return RangesActions.handleDeleteRange(draft, action);\n    case types.RESIZE_RANGE:\n      return RangesActions.handleResizeRange(draft, action);\n    case types.CHANGE_RANGE_SUM:\n      return RangesActions.handleChangeRangeSum(draft, action.value);\n    case types.CHANGE_RANGE_RELATIVE:\n      return RangesActions.handleChangeRangeRaltiveValue(draft, action);\n    case types.CHANGE_RANGE_SIGNAL_VALUE:\n      return RangesActions.handleChangeRangeSignalValue(draft, action);\n    case types.CHANGE_RANGE_SIGNAL_KIND:\n      return RangesActions.handleChangeRangeSignalKind(draft, action);\n    case types.SAVE_EDITED_RANGE:\n      return RangesActions.handleSaveEditedRange(draft, action);\n    case types.UNLINK_RANGE:\n      return RangesActions.handleUnlinkRange(draft, action);\n    case types.SET_DIAID_RANGE:\n      return RangesActions.handleSetDiaIDRange(draft, action);\n\n    case types.SET_PREFERENCES:\n      return handelSetPreferences(draft, action.data);\n    case types.SET_ACTIVE_TAB:\n      return ToolsActions.handelSetActiveTab(draft, action.tab);\n    case types.ADD_BASE_LINE_ZONE:\n      return ToolsActions.handleAddBaseLineZone(draft, action.zone);\n    case types.DELETE_BASE_LINE_ZONE:\n      return ToolsActions.handleDeleteBaseLineZone(draft, action.id);\n    case types.APPLY_BASE_LINE_CORRECTION_FILTER:\n      return FiltersActions.handleBaseLineCorrectionFilter(draft, action);\n    case types.SET_KEY_PREFERENCES:\n      return setKeyPreferencesHandler(draft, action.keyCode);\n    case types.APPLY_KEY_PREFERENCES:\n      return applyKeyPreferencesHandler(draft, action.keyCode);\n    case types.SET_2D_LEVEL:\n      return ToolsActions.levelChangeHandler(draft, action);\n    case types.ADD_2D_ZONE:\n      return ZonesActions.add2dZoneHandler(draft, action);\n    case types.DELETE_2D_ZONE:\n      return ZonesActions.handleDeleteZone(draft, action);\n    case types.ADD_MISSING_PROJECTION:\n      return SpectrumsActions.addMissingProjectionHander(draft, action);\n    case types.RESET_DOMAIN:\n      return DomainActions.handelResetDomain(draft);\n    case types.CHANGE_ZONE_SIGNAL_VALUE:\n      return ZonesActions.changeZoneSignalDelta(draft, action);\n    case types.CHANGE_ZONE_SIGNAL_KIND:\n      return ZonesActions.handleChangeZoneSignalKind(draft, action);\n    case types.UNLINK_ZONE:\n      return ZonesActions.handleUnlinkZone(draft, action);\n    case types.SET_DIAID_ZONE:\n      return ZonesActions.handleSetDiaIDZone(draft, action);\n\n    case types.ANALYZE_SPECTRA:\n      return SpectraAanalysisActions.analyzeSpectra(draft, action);\n    case types.DELETE_ANALYZE_SPECTRA_RANGE:\n      return SpectraAanalysisActions.handleDeleteSpectraRanges(draft, action);\n    case types.RESIZE_ANALYZE_SPECTRA_RANGE:\n      return SpectraAanalysisActions.handleResizeSpectraRange(draft, action);\n    case types.SET_ANALYZE_SPECTRA_COLUMNS:\n      return SpectraAanalysisActions.handleSetcolumns(draft, action);\n    case types.FILTER_SPECTRA_COLUMN:\n      return SpectraAanalysisActions.handleFiltercolumn(draft, action);\n\n    case UNDO:\n      return handleHistoryUndo(draft);\n\n    case REDO:\n      return handleHistoryRedo(draft);\n\n    case RESET:\n      return handleHistoryReset(draft, action);\n\n    case types.SET_MOUSE_OVER_DISPLAYER:\n      return GlobalActions.setIsOverDisplayer(draft, action);\n\n    default:\n      return;\n  }\n}\n\nexport const spectrumReducer = produce(innerSpectrumReducer);\n","import { current, Draft } from 'immer';\n\nimport { toJSON } from '../../../data/SpectraManager';\nimport {\n  exportAsJSON,\n  exportAsNMRE,\n  exportAsSVG,\n  exportAsPng,\n  copyPNGToClipboard,\n} from '../../utility/Export';\nimport { State } from '../Reducer';\n\nfunction exportData(draft: Draft<State>, { exportType, spaceIndent }) {\n  const state = current(draft) as State;\n  //check if there is data to export it\n  if (state.data.length > 0) {\n    //exported file name by default will be the first spectrum name\n    const fileName = state.data[0]?.display?.name;\n\n    switch (exportType) {\n      case 'json': {\n        const exportedData = toJSON(state);\n        exportAsJSON(exportedData, fileName, spaceIndent);\n        break;\n      }\n      case 'nmre': {\n        const exportedData = toJSON(state);\n        exportAsNMRE(exportedData, fileName);\n        break;\n      }\n      case 'svg': {\n        exportAsSVG(fileName, 'nmrSVG');\n        break;\n      }\n      case 'png': {\n        exportAsPng(fileName, 'nmrSVG');\n        break;\n      }\n      case 'copy': {\n        copyPNGToClipboard('nmrSVG');\n        break;\n      }\n      default:\n        break;\n    }\n  }\n}\n\nexport { exportData };\n","import { Draft } from 'immer';\n\nimport { State } from '../Reducer';\n\nfunction setWidth(draft: Draft<State>, width) {\n  draft.width = width;\n}\n\nfunction handleSetDimensions(draft: Draft<State>, width, height) {\n  draft.width = width;\n  draft.height = height;\n}\n\nexport { setWidth, handleSetDimensions };\n","import { setDomain, getDomain } from './DomainActions';\n\nfunction handleHistoryUndo(draft) {\n  const { past, present, future } = draft.history;\n  const previous = past[past.length - 1];\n  const newPast = past.slice(0, past.length - 1);\n  const newfuture = [present, ...future];\n\n  const hasRedo = newfuture.length !== 0;\n  const hasUndo = past.length !== 0;\n\n  // AnalysisObj.undoFilter(past);\n  // let resultData = AnalysisObj.getSpectraData();\n\n  const domain = getDomain(draft.data);\n  // const domain = getDomain(resultData);\n  const history = {\n    past: newPast,\n    present: previous,\n    future: newfuture,\n    hasRedo,\n    hasUndo,\n  };\n\n  // draft.data = resultData;\n  draft.xDomain = domain.xDomain;\n  draft.yDomain = domain.yDomain;\n  draft.originDomain = domain;\n  draft.history = history;\n}\n\nfunction handleHistoryRedo(draft) {\n  const { history } = draft;\n  // eslint-disable-next-line no-unused-vars\n  const next = history.future[0];\n  const newPresent = history.future.shift();\n  history.past.push(history.present);\n  history.present = newPresent;\n  history.hasUndo = true;\n  history.hasRedo = history.future.length > 0;\n\n  // AnalysisObj.redoFilter(next);\n  // draft.data = AnalysisObj.getSpectraData();\n  setDomain(draft.data);\n}\n\nfunction handleHistoryReset(draft, action) {\n  draft.history = {\n    past: [],\n    present: action,\n    future: [],\n    hasRedo: false,\n    hasUndo: false,\n  };\n}\n\nexport { handleHistoryUndo, handleHistoryRedo, handleHistoryReset };\n","import { Draft } from 'immer';\n\nimport { State } from '../Reducer';\n\nfunction setIsOverDisplayer(draft: Draft<State>, actions) {\n  draft.overDisplayer = actions.payload;\n}\nexport { setIsOverDisplayer };\n","import { useMemo, memo, forwardRef } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\n\nfunction ToolBarWrapper(WrappedComponent) {\n  const Wrapper = (props) => {\n    const {\n      data,\n      activeSpectrum,\n      verticalAlign,\n      displayerMode,\n    } = useChartData();\n\n    const { info = {} } = useMemo(() => {\n      if (data && activeSpectrum && activeSpectrum.id) {\n        const result = data.find((datum) => datum.id === activeSpectrum.id);\n        return result !== null && result !== undefined\n          ? { info: result.info, spectrumsCount: result.length }\n          : {};\n      }\n      return {};\n    }, [activeSpectrum, data]);\n\n    const { forwardedRef, ...rest } = props;\n    return (\n      <WrappedComponent\n        {...rest}\n        info={info}\n        activeSpectrum={activeSpectrum}\n        verticalAlign={verticalAlign}\n        displayerMode={displayerMode}\n        ref={forwardedRef}\n      />\n    );\n  };\n\n  return memo(\n    forwardRef((props, ref) => {\n      return <Wrapper {...props} forwardedRef={ref} />;\n    }),\n  );\n}\nexport default ToolBarWrapper;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useRef, useCallback } from 'react';\n\nimport CloseButton from '../elements/CloseButton';\nimport { loadFile, extractFileMetaFromPath } from '../utility/FileUtility';\n\nconst styles = css`\n  display: flex;\n  flex-direction: column;\n  width: 450px;\n  padding: 5px;\n  button:focus {\n    outline: none;\n  }\n  .header {\n    height: 24px;\n    border-bottom: 1px solid #f0f0f0;\n    display: flex;\n    span {\n      color: #464646;\n      font-size: 15px;\n      flex: 1;\n    }\n\n    button {\n      background-color: transparent;\n      border: none;\n      svg {\n        height: 16px;\n      }\n    }\n  }\n  .container {\n    display: flex;\n    margin: 30px 5px;\n    input,\n    button {\n      padding: 5px;\n      border: 1px solid gray;\n      border-radius: 5px;\n      height: 36px;\n      margin: 2px;\n    }\n    input {\n      flex: 10;\n    }\n    button {\n      flex: 2;\n      color: white;\n      background-color: gray;\n    }\n  }\n`;\nconst allowedExtensions = ['dx', 'jdx'];\n\nfunction LoadJCAMPModal({ onLoadClick, onClose, startLoading }) {\n  const pathReft = useRef();\n\n  const loadJCAMPHandler = useCallback(() => {\n    // ./data/xtc/XTC-814d_zg30.jdx\n    const path = pathReft.current.value;\n    const meta = extractFileMetaFromPath(path);\n    if (allowedExtensions.includes(meta.extension)) {\n      startLoading();\n      loadFile(path).then((data) => {\n        const file = {\n          binary: data,\n          name: meta.name,\n          jcampURL: path,\n        };\n        onLoadClick(file);\n      });\n    } else {\n      onLoadClick(null);\n    }\n  }, [onLoadClick, startLoading]);\n  return (\n    <div css={styles}>\n      <div className=\"header handle\">\n        <span>Load JCAMP Dialog</span>\n\n        <CloseButton onClick={onClose} />\n      </div>\n      <div className=\"container\">\n        <input\n          ref={pathReft}\n          type=\"text\"\n          placeholder=\"Enter URL to JCAMP-DX file\"\n        />\n        <button type=\"button\" onClick={loadJCAMPHandler}>\n          Load\n        </button>\n      </div>\n    </div>\n  );\n}\n\nLoadJCAMPModal.defaultProps = {\n  onLoadButtonClick: () => {\n    return null;\n  },\n  onClose: () => {\n    return null;\n  },\n  startLoading: () => {\n    return null;\n  },\n};\nexport default LoadJCAMPModal;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport {\n  SvgNmrRealImag,\n  SvgNmrOverlay3,\n  SvgNmrOverlay3Aligned,\n  SvgNmrAlignBottom,\n  SvgNmrAlignCenter,\n} from 'cheminfo-font';\nimport lodashGet from 'lodash/get';\nimport { Fragment, useCallback, memo } from 'react';\nimport {\n  FaDownload,\n  FaFileDownload,\n  FaFileImage,\n  FaCopy,\n  FaFileExport,\n  FaFile,\n  FaFileImport,\n} from 'react-icons/fa';\n\nimport { useDispatch } from '../context/DispatchContext';\nimport { usePreferences } from '../context/PreferencesContext';\nimport MenuButton from '../elements/MenuButton';\nimport ToolTip from '../elements/ToolTip/ToolTip';\nimport { useAlert } from '../elements/popup/Alert';\nimport { useModal } from '../elements/popup/Modal';\nimport ToolBarWrapper from '../hoc/ToolBarWrapper';\nimport { DropZoneRef } from '../loader/DropZone';\nimport LoadJCAMPModal from '../modal/LoadJCAMPModal';\nimport { DISPLAYER_MODE } from '../reducer/core/Constants';\nimport { LOAD_JCAMP_FILE, SET_LOADING_FLAG } from '../reducer/types/Types';\n\nimport useToolsFunctions from './useToolsFunctions';\n\nconst styles = css`\n  background-color: transparent;\n  border: none;\n  width: 35px;\n  height: 35px;\n  min-height: 35px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  outline: outline;\n  :focus {\n    outline: none !important;\n  }\n\n  &.fa {\n    svg {\n      font-size: 14px;\n    }\n  }\n  &.cheminfo {\n    svg {\n      font-size: 24px;\n    }\n  }\n`;\n\nconst menuButton = css`\n  background-color: transparent;\n  border: none;\n  border-bottom: 0.55px solid whitesmoke;\n  height: 35px;\n  outline: outline;\n  display: table-cell;\n  vertical-align: middle;\n  text-align: left;\n  padding: 0 10px;\n\n  svg {\n    display: inline-block;\n  }\n\n  :focus {\n    outline: none !important;\n  }\n  span {\n    font-size: 10px;\n    padding: 0px 10px;\n  }\n`;\n\nfunction BasicToolBar({ info, verticalAlign, displayerMode }) {\n  const dispatch = useDispatch();\n  const preferences = usePreferences();\n  const alert = useAlert();\n  const modal = useModal();\n  const {\n    isStacked,\n    isRealSpectrumShown,\n    saveAsSVGHandler,\n    saveAsPNGHandler,\n    saveAsJSONHandler,\n    saveAsNMREHandler,\n    saveToClipboardHandler,\n    changeSpectrumViewHandler,\n    handleChangeDisplayViewMode,\n    alignSpectrumsVerticallyHandler,\n  } = useToolsFunctions(dispatch, alert);\n\n  const selectedSpectrumInfo = { isComplex: false, isFid: false, ...info };\n\n  const LoadJacmpHandler = useCallback(\n    (file) => {\n      if (file) {\n        dispatch({ type: LOAD_JCAMP_FILE, files: [file] });\n        modal.close();\n      } else {\n        alert.error('you file must be one of those extensions [ .jdx, dx ] ');\n      }\n    },\n    [alert, dispatch, modal],\n  );\n\n  const startLoadingHandler = useCallback(() => {\n    modal.close();\n    dispatch({ type: SET_LOADING_FLAG, isLoading: true });\n  }, [dispatch, modal]);\n\n  const importJCAMPFile = useCallback(() => {\n    modal.show(\n      <LoadJCAMPModal\n        onLoadClick={LoadJacmpHandler}\n        onClose={() => modal.close()}\n        startLoading={startLoadingHandler}\n      />,\n      {},\n    );\n  }, [LoadJacmpHandler, modal, startLoadingHandler]);\n\n  const isButtonVisible = useCallback(\n    (key) => {\n      return !lodashGet(preferences, `display.toolBarButtons.${key}`);\n    },\n    [preferences],\n  );\n  const importFromFileSystemHandler = useCallback(() => {\n    DropZoneRef.current.open();\n  }, []);\n\n  return (\n    <Fragment>\n      {isButtonVisible('hideImport') && (\n        <MenuButton\n          style={styles}\n          className=\"fa\"\n          component={<FaFileImport />}\n          toolTip=\"Import\"\n        >\n          <button\n            type=\"button\"\n            css={menuButton}\n            onClick={importFromFileSystemHandler}\n          >\n            <FaFile />\n            <span>Import from file system</span>\n          </button>\n          <button type=\"button\" css={menuButton} onClick={importJCAMPFile}>\n            <FaFile />\n            <span>Add JCAMP-DX from URL</span>\n          </button>\n        </MenuButton>\n      )}\n      {isButtonVisible('hideExportAs') && (\n        <MenuButton\n          style={styles}\n          className=\"fa\"\n          component={<FaFileExport />}\n          toolTip=\"Export As\"\n        >\n          <button type=\"button\" css={menuButton} onClick={saveAsSVGHandler}>\n            <FaDownload />\n            <span>Export as SVG</span>\n          </button>\n          <button type=\"button\" css={menuButton} onClick={saveAsPNGHandler}>\n            <FaFileImage />\n            <span>Export as PNG</span>\n          </button>\n          <button type=\"button\" css={menuButton} onClick={saveAsJSONHandler}>\n            <FaFileDownload />\n            <span>Save data ( Press Ctrl + S )</span>\n          </button>\n          <button type=\"button\" css={menuButton} onClick={saveAsNMREHandler}>\n            <FaFileDownload />\n            <span>Save NMRE data </span>\n          </button>\n          <button\n            type=\"button\"\n            css={menuButton}\n            onClick={saveToClipboardHandler}\n          >\n            <FaCopy />\n            <span>Copy image to Clipboard ( Press Ctrl + C )</span>\n          </button>\n        </MenuButton>\n      )}\n\n      {displayerMode === DISPLAYER_MODE.DM_1D &&\n        isButtonVisible('hideSpectraStackAlignments') && (\n          <button\n            type=\"button\"\n            css={styles}\n            className=\"cheminfo\"\n            onClick={handleChangeDisplayViewMode}\n          >\n            <ToolTip title=\"Spectra alignment\" popupPlacement=\"right\">\n              {!isStacked ? <SvgNmrOverlay3Aligned /> : <SvgNmrOverlay3 />}\n            </ToolTip>\n          </button>\n        )}\n      {displayerMode === DISPLAYER_MODE.DM_1D &&\n        isButtonVisible('hideRealImaginary') &&\n        selectedSpectrumInfo &&\n        selectedSpectrumInfo.isComplex && (\n          <button\n            css={styles}\n            className=\"cheminfo\"\n            type=\"button\"\n            onClick={changeSpectrumViewHandler}\n          >\n            <ToolTip\n              title={\n                isRealSpectrumShown ? 'Display Real ' : 'Display Imaginary '\n              }\n              popupPlacement=\"right\"\n            >\n              <SvgNmrRealImag />\n            </ToolTip>\n          </button>\n        )}\n      {displayerMode === DISPLAYER_MODE.DM_1D &&\n        isButtonVisible('hideSpectraCenterAlignments') && (\n          <button\n            css={styles}\n            className=\"cheminfo\"\n            type=\"button\"\n            onClick={alignSpectrumsVerticallyHandler}\n          >\n            <ToolTip\n              title={\n                !verticalAlign.flag ? 'Baseline  Center' : 'Baseline  Bottom'\n              }\n              popupPlacement=\"right\"\n            >\n              {!verticalAlign.flag ? (\n                <SvgNmrAlignCenter />\n              ) : (\n                <SvgNmrAlignBottom />\n              )}\n            </ToolTip>\n          </button>\n        )}\n    </Fragment>\n  );\n}\n\nexport default ToolBarWrapper(memo(BasicToolBar));\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback, useState, useEffect, cloneElement } from 'react';\n\nconst styles = css`\n  width: 35px;\n  height: 35px;\n  background-color: white;\n  padding: 5px;\n  margin: 0px;\n  border: none;\n  outline: none;\n\n  :focus {\n    outline: none !important;\n  }\n`;\nconst activeStyles = css`\n  color: black;\n  background-color: #f3f3f3 !important;\n`;\n\nfunction ToggleButton({\n  children,\n  value,\n  disabled,\n  isActive,\n  onChange,\n  className,\n  style,\n  isVisible,\n  onMouseEnter,\n  onMouseLeave,\n  helpID,\n}) {\n  const [active, setActive] = useState(isActive);\n  const toggleButton = useCallback(() => {\n    const _isActive = !active;\n    setActive(_isActive);\n    if (_isActive) {\n      onChange(value);\n    } else {\n      onChange(null);\n    }\n  }, [active, onChange, value]);\n\n  useEffect(() => {\n    setActive(isActive);\n  }, [isActive]);\n\n  if (!isVisible) {\n    return null;\n  }\n  return (\n    <button\n      type=\"button\"\n      onClick={toggleButton}\n      css={[styles, active && activeStyles]}\n      style={style}\n      className={active ? ` ${className}  active` : ` ${className} `}\n      disabled={disabled}\n      onMouseEnter={onMouseEnter}\n      onMouseLeave={onMouseLeave}\n      data-helpid={helpID}\n    >\n      {cloneElement(children, { style: { fontSize: '10px' } })}\n    </button>\n  );\n}\nToggleButton.displayName = 'ToggleButton';\n\nToggleButton.defaultProps = {\n  isActive: false,\n  disabled: false,\n  isVisible: true,\n  value: null,\n  className: '',\n  onChange: function () {\n    return null;\n  },\n  onValueReady: function () {\n    return null;\n  },\n};\n\nexport default ToggleButton;\n","import {\n  useCallback,\n  useState,\n  useMemo,\n  useEffect,\n  Children,\n  cloneElement,\n} from 'react';\n\nconst style = { display: 'flex', flexDirection: 'column' };\n\nfunction ToggleButtonGroup({ children, value, onChange }) {\n  const [toggleButtons, setToggleButtons] = useState([]);\n  const handleOnChange = useCallback(\n    (val) => {\n      const _toggles = [...toggleButtons];\n      const toggles = _toggles.map((toggle) => {\n        return {\n          value: toggle.value,\n          isActive: toggle.value === val ? true : false,\n        };\n      });\n      setToggleButtons(toggles);\n      onChange(val);\n    },\n    [onChange, toggleButtons],\n  );\n\n  const mappedChildren = useMemo(() => {\n    let index = 0;\n    return Children.map(children, (child) => {\n      if (child) {\n        if (child.type.displayName === 'ToggleButton') {\n          const _child = cloneElement(child, {\n            onChange: handleOnChange,\n            isActive:\n              toggleButtons[index] &&\n              toggleButtons[index].isActive &&\n              toggleButtons[index].isActive,\n            index,\n          });\n          index++;\n          return _child;\n        } else {\n          return cloneElement(child);\n        }\n      }\n    });\n  }, [children, handleOnChange, toggleButtons]);\n\n  useEffect(() => {\n    const val = Children.map(children, (child) => {\n      if (child && child.type.displayName === 'ToggleButton') {\n        return {\n          value: child.props.value,\n          isActive: child.props.value === value ? true : false,\n        };\n      }\n    });\n    setToggleButtons(val);\n  }, [children, value]);\n\n  return <div style={style}> {mappedChildren} </div>;\n}\n\nToggleButtonGroup.defaultProps = {\n  onChange: function () {\n    return null;\n  },\n};\nexport default ToggleButtonGroup;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport {\n  SvgNmrBaselineCorrection,\n  SvgNmrFourierTransform,\n  SvgNmrIntegrate,\n  SvgNmrMultipleAnalysis,\n  SvgNmrPeakPicking,\n  SvgNmrPhaseCorrection,\n  SvgNmrRangePicking,\n  SvgNmrZeroFilling,\n} from 'cheminfo-font';\nimport lodashGet from 'lodash/get';\nimport { useState, useEffect, useCallback, memo } from 'react';\nimport { FaSearchPlus, FaExpand, FaDiceFour } from 'react-icons/fa';\n\nimport { Filters } from '../../data/Filters';\nimport { useDispatch } from '../context/DispatchContext';\nimport { usePreferences } from '../context/PreferencesContext';\nimport ToolTip from '../elements/ToolTip/ToolTip';\nimport { useAlert } from '../elements/popup/Alert';\nimport { useHelp } from '../elements/popup/Help/Context';\nimport { ToggleButton, ToggleButtonGroup } from '../elements/toggle';\nimport ToolBarWrapper from '../hoc/ToolBarWrapper';\nimport { DISPLAYER_MODE } from '../reducer/core/Constants';\nimport { APPLY_FFT_FILTER, SET_SELECTED_FILTER } from '../reducer/types/Types';\n\nimport { options } from './ToolTypes';\nimport useToolsFunctions from './useToolsFunctions';\n\nconst styles = css`\n  button {\n    background-color: transparent;\n    border: none;\n    width: 35px;\n    height: 35px;\n    min-height: 35px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    outline: outline;\n    :focus {\n      outline: none !important;\n    }\n\n    &.fa {\n      svg {\n        font-size: 14px;\n      }\n    }\n    &.cheminfo {\n      svg {\n        font-size: 18px;\n      }\n    }\n  }\n`;\n\n// let debounceClickEvents = [];\n\nfunction FunctionToolBar({\n  defaultValue,\n  activeSpectrum,\n  info,\n  displayerMode,\n}) {\n  const [option, setOption] = useState();\n  const help = useHelp();\n  const alert = useAlert();\n  const preferences = usePreferences();\n\n  const dispatch = useDispatch();\n\n  const selectedSpectrumInfo = {\n    info: { isComplex: false, isFid: false, ...info },\n  };\n  const { handleChangeOption, handleFullZoomOut } = useToolsFunctions(\n    dispatch,\n    alert,\n  );\n\n  const handleChange = useCallback(\n    (selectedOption) => {\n      setOption(selectedOption);\n      handleChangeOption(selectedOption);\n    },\n    [handleChangeOption],\n  );\n\n  useEffect(() => {\n    setOption(defaultValue);\n  }, [defaultValue]);\n\n  const handleOnFFTFilter = useCallback(() => {\n    dispatch({\n      type: APPLY_FFT_FILTER,\n      value: '',\n    });\n    dispatch({ type: SET_SELECTED_FILTER, selectedFilter: null });\n  }, [dispatch]);\n\n  const isButtonVisible = useCallback(\n    (key) => {\n      return !lodashGet(preferences, `display.toolBarButtons.${key}`);\n    },\n    [preferences],\n  );\n\n  return (\n    <div css={styles}>\n      <ToggleButtonGroup value={option} onChange={handleChange}>\n        {isButtonVisible('hideZoomTool') && (\n          <ToggleButton\n            key={options.zoom.id}\n            value={options.zoom.id}\n            {...help.onHover}\n            helpID=\"zoomIn\"\n            className=\"fa\"\n          >\n            <ToolTip\n              title={`${options.zoom.label} ( Press z )`}\n              popupPlacement=\"right\"\n              offset={{ x: 10, y: 0 }}\n              style={{ display: 'flex' }}\n            >\n              <FaSearchPlus />\n            </ToolTip>\n          </ToggleButton>\n        )}\n\n        {isButtonVisible('hideZoomOutTool') && (\n          <button className=\"fa\" type=\"button\" onClick={handleFullZoomOut}>\n            <ToolTip\n              title=\"Horizontal zoom out ( Press f ), Horizontal and Vertical zoom out, double click ( Press ff )\"\n              popupPlacement=\"right\"\n            >\n              <FaExpand />\n            </ToolTip>\n          </button>\n        )}\n\n        {displayerMode === DISPLAYER_MODE.DM_1D &&\n          isButtonVisible('hidePeakTool') && (\n            <ToggleButton\n              key={options.peakPicking.id}\n              value={options.peakPicking.id}\n              className=\"cheminfo\"\n              isVisible={\n                activeSpectrum &&\n                selectedSpectrumInfo &&\n                !selectedSpectrumInfo.info.isFid\n              }\n              {...help.onHover}\n              helpID=\"peakPicking\"\n            >\n              <ToolTip\n                title={`${options.peakPicking.label} ( Press p )`}\n                popupPlacement=\"right\"\n                offset={{ x: 10, y: 0 }}\n              >\n                <SvgNmrPeakPicking />\n              </ToolTip>\n            </ToggleButton>\n          )}\n        {displayerMode === DISPLAYER_MODE.DM_1D &&\n          isButtonVisible('hideIntegralTool') && (\n            <ToggleButton\n              key={options.integral.id}\n              value={options.integral.id}\n              className=\"cheminfo\"\n              isVisible={\n                activeSpectrum &&\n                selectedSpectrumInfo &&\n                !selectedSpectrumInfo.info.isFid\n              }\n              {...help.onHover}\n              helpID=\"integralPicking\"\n            >\n              <ToolTip\n                title={`${options.integral.label} ( Press i )`}\n                popupPlacement=\"right\"\n                offset={{ x: 10, y: 0 }}\n              >\n                <SvgNmrIntegrate />\n              </ToolTip>\n            </ToggleButton>\n          )}\n        {displayerMode === DISPLAYER_MODE.DM_2D &&\n          isButtonVisible('hideIntegralTool') && (\n            <ToggleButton\n              key={options.zone2D.id}\n              value={options.zone2D.id}\n              className=\"fa\"\n              isVisible={activeSpectrum}\n            >\n              <ToolTip\n                title={`${options.zone2D.label} ( Press i  )`}\n                popupPlacement=\"right\"\n                offset={{ x: 10, y: 0 }}\n              >\n                <FaDiceFour />\n              </ToolTip>\n            </ToggleButton>\n          )}\n        {displayerMode === DISPLAYER_MODE.DM_2D && (\n          <ToggleButton\n            key={options.slicingTool.id}\n            value={options.slicingTool.id}\n            style={styles.icon}\n            isVisible={activeSpectrum}\n          >\n            <ToolTip\n              title={`${options.slicingTool.label}`}\n              popupPlacement=\"right\"\n              offset={{ x: 10, y: 0 }}\n            >\n              Slic\n            </ToolTip>\n          </ToggleButton>\n        )}\n        {displayerMode === DISPLAYER_MODE.DM_1D &&\n          isButtonVisible('hideAutoRangesTool') && (\n            <ToggleButton\n              key={options.rangesPicking.id}\n              value={options.rangesPicking.id}\n              className=\"cheminfo\"\n              isVisible={\n                activeSpectrum &&\n                selectedSpectrumInfo &&\n                !selectedSpectrumInfo.info.isFid\n              }\n            >\n              <ToolTip\n                title={options.rangesPicking.label}\n                popupPlacement=\"right\"\n                offset={{ x: 10, y: 0 }}\n              >\n                <SvgNmrRangePicking />\n              </ToolTip>\n            </ToggleButton>\n          )}\n        {displayerMode === DISPLAYER_MODE.DM_1D &&\n          isButtonVisible('hideMultipleSpectraAnalysisTool') && (\n            <ToggleButton\n              key={options.multipleSpectraAnalysis.id}\n              value={options.multipleSpectraAnalysis.id}\n              className=\"cheminfo\"\n            >\n              <ToolTip\n                title={options.multipleSpectraAnalysis.label}\n                popupPlacement=\"right\"\n                offset={{ x: 10, y: 0 }}\n              >\n                <SvgNmrMultipleAnalysis />\n              </ToolTip>\n            </ToggleButton>\n          )}\n        {displayerMode === DISPLAYER_MODE.DM_1D &&\n          isButtonVisible('hideZeroFillingTool') && (\n            <ToggleButton\n              key={options.zeroFilling.id}\n              value={options.zeroFilling.id}\n              className=\"cheminfo\"\n              isVisible={\n                selectedSpectrumInfo &&\n                Filters.zeroFilling.isApplicable(selectedSpectrumInfo)\n              }\n            >\n              <ToolTip\n                title={options.zeroFilling.label}\n                popupPlacement=\"right\"\n                offset={{ x: 10, y: 0 }}\n              >\n                <SvgNmrZeroFilling />\n              </ToolTip>\n            </ToggleButton>\n          )}\n        {displayerMode === DISPLAYER_MODE.DM_1D &&\n          isButtonVisible('hidePhaseCorrectionTool') && (\n            <ToggleButton\n              key={options.phaseCorrection.id}\n              value={options.phaseCorrection.id}\n              className=\"cheminfo\"\n              style={styles.icon}\n              isVisible={\n                activeSpectrum &&\n                selectedSpectrumInfo &&\n                Filters.phaseCorrection.isApplicable(selectedSpectrumInfo)\n              }\n            >\n              <ToolTip\n                title={options.phaseCorrection.label}\n                popupPlacement=\"right\"\n                offset={{ x: 10, y: 0 }}\n              >\n                <SvgNmrPhaseCorrection />\n              </ToolTip>\n            </ToggleButton>\n          )}\n\n        {displayerMode === DISPLAYER_MODE.DM_1D &&\n          isButtonVisible('hideBaseLineCorrectionTool') && (\n            <ToggleButton\n              key={options.baseLineCorrection.id}\n              value={options.baseLineCorrection.id}\n              className=\"cheminfo\"\n              isVisible={\n                activeSpectrum &&\n                selectedSpectrumInfo &&\n                Filters.baselineCorrection.isApplicable(selectedSpectrumInfo)\n              }\n            >\n              <ToolTip\n                title={options.baseLineCorrection.label}\n                popupPlacement=\"right\"\n                offset={{ x: 10, y: 0 }}\n              >\n                <SvgNmrBaselineCorrection />\n              </ToolTip>\n            </ToggleButton>\n          )}\n      </ToggleButtonGroup>\n\n      {displayerMode === DISPLAYER_MODE.DM_1D &&\n        isButtonVisible('hideFFTTool') &&\n        selectedSpectrumInfo &&\n        Filters.fft.isApplicable(selectedSpectrumInfo) && (\n          <button\n            className=\"cheminfo\"\n            type=\"button\"\n            onClick={handleOnFFTFilter}\n          >\n            <ToolTip\n              title={`FFT Filter`}\n              popupPlacement=\"right\"\n              offset={{ x: 10, y: 0 }}\n            >\n              <SvgNmrFourierTransform />\n            </ToolTip>\n          </button>\n        )}\n    </div>\n  );\n}\n\nexport default ToolBarWrapper(memo(FunctionToolBar));\n\nFunctionToolBar.defaultProps = {\n  defaultValue: options.zoom.id,\n};\n","import { memo } from 'react';\n\nimport BasicToolBar from './BasicToolBar';\nimport FunctionToolBar from './FunctionToolBar';\n\nconst styles = {\n  display: 'flex',\n  flexDirection: 'column',\n  alignItems: 'start',\n  borderRight: '0.55px solid #f7f7f7',\n  paddingRight: '1px',\n  overflowY: 'auto',\n  height: '100%',\n};\nfunction ToolBar({ selectedTool }) {\n  return (\n    <div style={{ ...styles }}>\n      <FunctionToolBar defaultValue={selectedTool} />\n      {/* <HistoryToolBar /> */}\n      <BasicToolBar />\n    </div>\n  );\n}\n\nexport default memo(ToolBar);\n","/** @jsxImportSource @emotion/react */\n\nimport { css } from '@emotion/react';\nimport lodashGet from 'lodash/get';\nimport PropTypes from 'prop-types';\nimport {\n  useEffect,\n  useCallback,\n  useReducer,\n  useState,\n  useMemo,\n  useRef,\n  memo,\n  Reducer,\n  CSSProperties,\n  ReactElement,\n} from 'react';\nimport SplitPane from 'react-split-pane';\nimport { useToggle, useFullscreen } from 'react-use';\n\nimport { Datum1D } from '../data/data1d/Datum1D';\nimport { Datum2D } from '../data/data2d/Datum2D';\nimport checkModifierKeyActivated from '../data/utilities/checkModifierKeyActivated';\n\nimport Viewer1D from './1d/Viewer1D';\nimport Viewer2D from './2d/Viewer2D';\nimport ErrorBoundary from './ErrorBoundary';\nimport KeysListenerTracker from './EventsTrackers/KeysListenerTracker';\nimport { AssignmentProvider } from './assignment';\nimport helpList, { setBaseUrl } from './constants/help';\nimport { ChartDataProvider } from './context/ChartContext';\nimport { DispatchProvider } from './context/DispatchContext';\nimport { GlobalProvider } from './context/GlobalContext';\nimport { PreferencesProvider } from './context/PreferencesContext';\nimport { AlertProvider } from './elements/popup/Alert';\nimport { HelpProvider } from './elements/popup/Help';\nimport { ModalProvider } from './elements/popup/Modal';\nimport Header from './header/Header';\nimport { HighlightProvider } from './highlight';\nimport DropZone from './loader/DropZone';\nimport { defaultGetSpinner, SpinnerProvider } from './loader/SpinnerContext';\nimport Panels from './panels/Panels';\nimport checkActionType from './reducer/IgnoreActions';\nimport {\n  spectrumReducer,\n  initialState,\n  dispatchMiddleware,\n} from './reducer/Reducer';\nimport { DISPLAYER_MODE } from './reducer/core/Constants';\nimport {\n  preferencesInitialState,\n  preferencesReducer,\n  INIT_PREFERENCES,\n} from './reducer/preferencesReducer';\nimport {\n  INITIATE,\n  SET_WIDTH,\n  SET_LOADING_FLAG,\n  SET_MOUSE_OVER_DISPLAYER,\n} from './reducer/types/Types';\nimport ToolBar from './toolbar/ToolBar';\n\nconst splitPaneStyles: Record<\n  'container' | 'resizer' | 'pane',\n  CSSProperties\n> = {\n  container: {\n    position: 'relative',\n    height: 'none',\n  },\n  resizer: {\n    width: 10,\n    backgroundColor: '#f7f7f7',\n    cursor: 'ew-resize',\n  },\n  pane: { overflow: 'hidden' },\n};\n\nconst containerStyles = css`\n  background-color: white;\n  width: 100%;\n  display: block;\n  height: 100%;\n  font-size: 14px;\n\n  div:focus {\n    outline: none !important;\n  }\n\n  button {\n    cursor: pointer;\n    color: black;\n    &:disabled {\n      cursor: default;\n    }\n  }\n\n  button:active,\n  button:hover,\n  button:focus,\n  [type='button']:focus,\n  button {\n    outline: none !important;\n  }\n  * {\n    -webkit-user-drag: none;\n    -moz-user-drag: none;\n    -o-user-drag: none;\n    user-drag: none;\n    -moz-user-select: none;\n    -webkit-user-select: none;\n    -ms-user-select: none;\n    user-select: none;\n  }\n\n  .SplitPane {\n    height: 100%;\n  }\n\n  .Resizer.vertical:after {\n    content: '\\\\22EE';\n    top: 50%;\n    color: black;\n    position: absolute;\n    font-size: 14px;\n  }\n\n  .Resizer.vertical {\n    padding: 2px;\n  }\n\n  .Resizer.vertical:hover {\n    background-color: #dfdfdf !important;\n    border-left: 0.55px #bbbbbb solid;\n    border-right: 0.55px #bbbbbb solid;\n  }\n`;\n\nexport interface NMRiumProps {\n  data?: NMRiumData;\n  docsBaseUrl?: string;\n  onDataChange?: (data: any) => void;\n  preferences?: NMRiumPreferences;\n  /**\n   * Returns a custom spinner that will be rendered while loading data.\n   */\n  getSpinner?: () => ReactElement;\n}\n\nexport type NMRiumPreferences = Partial<{\n  general: Partial<{\n    disableMultipletAnalysis: boolean;\n    hideSetSumFromMolecule: boolean;\n  }>;\n  panels: Partial<{\n    hideSpectraPanel: boolean;\n    hideInformationPanel: boolean;\n    hidePeaksPanel: boolean;\n    hideIntegralsPanel: boolean;\n    hideRangesPanel: boolean;\n    hideStructuresPanel: boolean;\n    hideFiltersPanel: boolean;\n    hideZonesPanel: boolean;\n    hideSummaryPanel: boolean;\n    hideMultipleSpectraAnalysisPanel: boolean;\n  }>;\n  toolBarButtons: Partial<{\n    hideZoomTool: boolean;\n    hideZoomOutTool: boolean;\n    hideImport: boolean;\n    hideExportAs: boolean;\n    hideSpectraStackAlignments: boolean;\n    hideSpectraCenterAlignments: boolean;\n    hideRealImaginary: boolean;\n    hidePeakTool: boolean;\n    hideIntegralTool: boolean;\n    hideAutoRangesTool: boolean;\n    hideZeroFillingTool: boolean;\n    hidePhaseCorrectionTool: boolean;\n    hideBaseLineCorrectionTool: boolean;\n    hideFFTTool: boolean;\n    hideMultipleSpectraAnalysisTool: boolean;\n  }>;\n}>;\n\nexport type Molecules = Array<{ molfile: string }>;\nexport type Spectra = Array<Partial<Datum1D> | Partial<Datum2D>>;\n\nexport interface NMRiumData {\n  molecules?: Molecules;\n  spectra: Spectra;\n}\n\nfunction NMRium({\n  data: dataProp,\n  onDataChange,\n  docsBaseUrl,\n  preferences,\n  getSpinner = defaultGetSpinner,\n}: NMRiumProps) {\n  const rootRef = useRef<HTMLDivElement>(null);\n  const elementsWraperRef = useRef<HTMLDivElement>(null);\n  const [show, toggle] = useToggle(false);\n  const isFullscreen = useFullscreen(rootRef, show, {\n    onClose: () => {\n      toggle(false);\n    },\n  });\n  const [isRightPanelHide, hideRightPanel] = useState(false);\n  const [isResizeEventStart, setResizeEventStart] = useState(false);\n  const [helpData, setHelpData] = useState(helpList);\n\n  const [state, dispatch] = useReducer<Reducer<any, any>>(\n    spectrumReducer,\n    initialState,\n  );\n  const [preferencesState, dispatchPreferences] = useReducer<Reducer<any, any>>(\n    preferencesReducer,\n    preferencesInitialState,\n  );\n\n  const { selectedTool, displayerMode, data: spectraData } = state;\n\n  useEffect(() => {\n    if (checkActionType(state.actionType)) {\n      onDataChange?.(state);\n    }\n  }, [onDataChange, state]);\n\n  const dispatchMiddleWare = useMemo(() => {\n    return dispatchMiddleware(dispatch);\n  }, []);\n\n  useEffect(() => {\n    rootRef.current?.focus();\n  }, [isFullscreen]);\n\n  useEffect(() => {\n    dispatchPreferences({\n      type: INIT_PREFERENCES,\n      payload: { display: preferences, dispatch: dispatchPreferences },\n    });\n  }, [preferences]);\n\n  useEffect(() => {\n    dispatchMiddleWare({ type: SET_LOADING_FLAG, isLoading: true });\n    dispatchMiddleWare({ type: INITIATE, payload: dataProp });\n  }, [dataProp, dispatchMiddleWare]);\n\n  useEffect(() => {\n    setBaseUrl(docsBaseUrl);\n    setHelpData(helpList());\n  }, [docsBaseUrl]);\n\n  const handleSplitPanelDragFinished = useCallback(\n    (size) => {\n      if (size && !isRightPanelHide) {\n        setResizeEventStart(false);\n        dispatch({ type: SET_WIDTH, width: size });\n      }\n    },\n    [isRightPanelHide],\n  );\n\n  const preventAutoHelp = useMemo(() => {\n    return lodashGet(\n      preferencesState,\n      'controllers.help.preventAutoHelp',\n      false,\n    );\n  }, [preferencesState]);\n\n  const rightPanelHandler = useCallback((e) => {\n    e.stopPropagation();\n    hideRightPanel((prevFlag) => !prevFlag);\n  }, []);\n\n  const preventContextMenuHandler = useCallback((e) => {\n    if (!checkModifierKeyActivated(e)) {\n      e.preventDefault();\n    }\n  }, []);\n  const mouseEnterHandler = useCallback(() => {\n    dispatchMiddleWare({ type: SET_MOUSE_OVER_DISPLAYER, payload: true });\n  }, [dispatchMiddleWare]);\n  const mouseLeaveHandler = useCallback(() => {\n    dispatchMiddleWare({ type: SET_MOUSE_OVER_DISPLAYER, payload: false });\n  }, [dispatchMiddleWare]);\n\n  return (\n    <ErrorBoundary>\n      <GlobalProvider\n        value={{\n          rootRef: rootRef.current,\n          elementsWraperRef: elementsWraperRef.current,\n        }}\n      >\n        <PreferencesProvider value={preferencesState}>\n          <div\n            onMouseEnter={mouseEnterHandler}\n            onMouseLeave={mouseLeaveHandler}\n            style={{ height: '100%', position: 'relative' }}\n          >\n            {/* @ts-expect-error: TODO remove when HelpProvider is migrated */}\n            <HelpProvider\n              data={helpData}\n              wrapperRef={elementsWraperRef.current}\n              preventAutoHelp={preventAutoHelp}\n            >\n              {/* @ts-expect-error: TODO remove when AlertProvider is migrated */}\n              <AlertProvider wrapperRef={elementsWraperRef.current}>\n                <DispatchProvider value={dispatchMiddleWare}>\n                  <ChartDataProvider value={{ ...state, isResizeEventStart }}>\n                    <ModalProvider wrapperRef={elementsWraperRef.current}>\n                      <HighlightProvider>\n                        <AssignmentProvider spectraData={spectraData}>\n                          <SpinnerProvider value={getSpinner}>\n                            <div\n                              ref={rootRef}\n                              css={containerStyles}\n                              onContextMenu={preventContextMenuHandler}\n                            >\n                              <KeysListenerTracker />\n\n                              <Header\n                                isFullscreen={isFullscreen}\n                                onMaximize={toggle}\n                              />\n\n                              <div\n                                style={{\n                                  height: 'calc(100% - 36px)',\n                                  width: '100%',\n                                  backgroundColor: 'white',\n                                }}\n                              >\n                                <DropZone>\n                                  <ToolBar selectedTool={selectedTool} />\n                                  <SplitPane\n                                    style={splitPaneStyles.container}\n                                    resizerStyle={splitPaneStyles.resizer}\n                                    paneStyle={splitPaneStyles.pane}\n                                    pane1Style={\n                                      isRightPanelHide\n                                        ? {\n                                            maxWidth: '100%',\n                                            width: 'calc(100% - 10px)',\n                                          }\n                                        : { maxWidth: '80%' }\n                                    }\n                                    split=\"vertical\"\n                                    defaultSize={\n                                      isRightPanelHide\n                                        ? '99%'\n                                        : 'calc(100% - 600px)'\n                                    }\n                                    minSize=\"80%\"\n                                    onDragFinished={\n                                      handleSplitPanelDragFinished\n                                    }\n                                    onResizerDoubleClick={rightPanelHandler}\n                                    onDragStarted={() => {\n                                      setResizeEventStart(true);\n                                    }}\n                                  >\n                                    {displayerMode === DISPLAYER_MODE.DM_1D ? (\n                                      <Viewer1D />\n                                    ) : (\n                                      <Viewer2D />\n                                    )}\n                                    {!isRightPanelHide ? (\n                                      <Panels\n                                        selectedTool={selectedTool}\n                                        displayerMode={displayerMode}\n                                      />\n                                    ) : null}\n                                  </SplitPane>\n                                </DropZone>\n                              </div>\n                              <div\n                                ref={elementsWraperRef}\n                                key={String(isFullscreen)}\n                                id=\"main-wrapper\"\n                                style={{\n                                  position: 'absolute',\n                                  pointerEvents: 'none',\n                                  zIndex: 0,\n                                  left: 0,\n                                  right: 0,\n                                  top: 0,\n                                  bottom: 0,\n                                }}\n                              />\n                            </div>\n                          </SpinnerProvider>\n                        </AssignmentProvider>\n                      </HighlightProvider>\n                    </ModalProvider>\n                  </ChartDataProvider>\n                </DispatchProvider>\n              </AlertProvider>\n            </HelpProvider>\n          </div>\n        </PreferencesProvider>\n      </GlobalProvider>\n    </ErrorBoundary>\n  );\n}\n\nNMRium.propTypes = {\n  docsBaseUrl: PropTypes.string,\n  onDataChange: PropTypes.func,\n  preferences: PropTypes.shape({\n    general: PropTypes.shape({\n      disableMultipletAnalysis: PropTypes.bool,\n      hideSetSumFromMolecule: PropTypes.bool,\n    }),\n    panels: PropTypes.shape({\n      hideSpectraPanel: PropTypes.bool,\n      hideInformationPanel: PropTypes.bool,\n      hidePeaksPanel: PropTypes.bool,\n      hideIntegralsPanel: PropTypes.bool,\n      hideRangesPanel: PropTypes.bool,\n      hideStructuresPanel: PropTypes.bool,\n      hideFiltersPanel: PropTypes.bool,\n    }),\n    toolBarButtons: PropTypes.shape({\n      hideZoomTool: PropTypes.bool,\n      hideZoomOutTool: PropTypes.bool,\n      hideImport: PropTypes.bool,\n      hideExportAs: PropTypes.bool,\n      hideSpectraStackAlignments: PropTypes.bool,\n      hideSpectraCenterAlignments: PropTypes.bool,\n      hideRealImaginary: PropTypes.bool,\n      hidePeakTool: PropTypes.bool,\n      hideIntegralTool: PropTypes.bool,\n      hideAutoRangesTool: PropTypes.bool,\n      hideZeroFillingTool: PropTypes.bool,\n      hidePhaseCorrectionTool: PropTypes.bool,\n      hideBaseLineCorrectionTool: PropTypes.bool,\n      hideFFTTool: PropTypes.bool,\n    }),\n  }),\n};\n\nNMRium.defaultProps = {\n  docsBaseUrl: 'https://dev.nmrium.org/docs/v0',\n  onDataChange: () => null,\n  preferences: {\n    general: {\n      disableMultipletAnalysis: false,\n      hideSetSumFromMolecule: false,\n    },\n\n    panels: {\n      hideSpectraPanel: false,\n      hideInformationPanel: false,\n      hidePeaksPanel: false,\n      hideIntegralsPanel: false,\n      hideRangesPanel: false,\n      hideStructuresPanel: false,\n      hideFiltersPanel: false,\n      hideZonesPanel: false,\n      hideSummaryPanel: false,\n      hideMultipleSpectraAnalysisPanel: false,\n    },\n\n    toolBarButtons: {\n      hideZoomTool: false,\n      hideZoomOutTool: false,\n      hideImport: false,\n      hideExportAs: false,\n      hideSpectraStackAlignments: false,\n      hideSpectraCenterAlignments: false,\n      hideRealImaginary: false,\n      hidePeakTool: false,\n      hideIntegralTool: false,\n      hideAutoRangesTool: false,\n      hideZeroFillingTool: false,\n      hidePhaseCorrectionTool: false,\n      hideBaseLineCorrectionTool: false,\n      hideFFTTool: false,\n      hideMultipleSpectraAnalysisTool: false,\n    },\n  },\n};\n\nexport default memo(NMRium);\n"],"sourceRoot":""}