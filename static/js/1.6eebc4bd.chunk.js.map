{"version":3,"sources":["component/highlight/index.js","component/utility/Export.js","data/utilities/checkModifierKeyActivated.js","component/EventsTrackers/BrushTracker.js","component/EventsTrackers/MouseTracker.js","component/context/ChartContext.jsx","component/context/DispatchContext.jsx","component/context/PreferencesContext.jsx","component/context/ScaleContext.jsx","component/elements/popup/options.js","component/elements/popup/Modal/Context.js","component/elements/popup/Modal/Modal.jsx","component/elements/popup/Transition.js","component/elements/popup/Wrapper.js","component/elements/popup/Modal/ConfirmDialog.jsx","component/elements/popup/Modal/Provider.js","component/context/LoaderContext.tsx","component/loader/NoData.jsx","component/loader/DefaultSpinnerComponent.tsx","component/loader/SpinnerContext.tsx","component/loader/Spinner.jsx","component/context/GlobalContext.jsx","component/elements/ToolTip/ToolTip.jsx","component/elements/CloseButton.jsx","component/modal/MultipletAnalysisModal.jsx","component/constants/InitSetting.js","component/utility/LocalStorage.js","component/reducer/helper/Spectrum1DZoomHelper.js","component/reducer/actions/Zoom.js","component/1d/utilities/scale.js","component/reducer/scaleReducer.js","component/reducer/types/Types.js","data/data1d/filter1d/absolute.js","data/data1d/filter1d/autoPhaseCorrection.js","data/data1d/filter1d/baselineCorrection.js","data/data1d/filter1d/centerMean.js","data/data1d/filter1d/digitalFilter.js","data/data1d/filter1d/equallySpaced.js","data/data1d/filter1d/fft.js","data/data1d/filter1d/fromTo.js","data/data1d/filter1d/lineBroadening.js","data/data1d/filter1d/pareto.js","data/data1d/filter1d/phaseCorrection.js","data/data1d/filter1d/shiftX.js","data/data1d/filter1d/standardDeviation.js","data/data1d/filter1d/zeroFilling.js","data/data2d/filter2d/shiftX.js","data/data2d/filter2d/shiftY.js","data/Filters.js","component/toolbar/ToolTypes.js","component/tool/BrushXY.jsx","component/tool/CrossLinePointer.jsx","component/utility/Events.js","component/elements/DeleteButton.jsx","component/1d/BaseLineZones.jsx","component/hoc/ExclusionZonesWrapper.js","component/1d/ExclusionZones.jsx","component/panels/extra/preferences/defaultValues.js","component/1d/Resizable.jsx","component/1d/IntegralResizable.jsx","component/1d/Integral.jsx","component/1d/IntegralsSeries.jsx","component/1d/Line.jsx","component/1d/LinesSeries.jsx","component/utility/FormatNumber.js","component/1d/PeakNotation.jsx","component/1d/PeaksNotations.jsx","component/1d/XAxis.jsx","component/hoc/MultiAnalysisWrapper.js","component/1d/multiAnalysis/AnalysisRange.jsx","component/1d/multiAnalysis/MultiAnalysisRanges.jsx","component/hoc/RangesWrapper.js","data/constants/SignalsKinds.js","data/utilities/RangeUtilities.js","component/assignment/index.js","data/constants/Multiplets.js","component/panels/extra/utilities/MultiplicityUtilities.js","component/1d/multiplicityTree/TreeColors.js","component/1d/multiplicityTree/LevelNode.jsx","component/1d/multiplicityTree/StringNode.jsx","component/1d/multiplicityTree/TreeNodes.jsx","component/1d/multiplicityTree/buildTreeNode.js","component/1d/multiplicityTree/MultiplicityTree.jsx","component/1d/ranges/Range.jsx","component/1d/ranges/Ranges.jsx","component/1d/Chart1D.jsx","component/elements/popup/Help/Context.js","component/elements/popup/helpers.js","component/elements/popup/Help/Reducer.js","component/elements/popup/Help/Provider.js","component/hoc/FooterWarpper.js","component/1d/FooterBanner.jsx","component/1d/SpectraTracker.jsx","component/1d/tool/PeakPointer.jsx","component/1d/tool/VerticalIndicator.jsx","component/1d/tool/XLabelPointer.jsx","component/1d/Viewer1D.jsx","component/hoc/ContoursWrapper.js","component/2d/utilities/DimensionLayout.js","component/2d/utilities/scale.js","component/2d/Contours.jsx","component/reducer/core/Constants.js","component/2d/IndicationLines.jsx","component/2d/Left1DChart.jsx","component/2d/Top1DChart.jsx","component/2d/XAxis.jsx","component/2d/YAxis.jsx","component/hoc/ZonesWrapper.js","data/utilities/ZoneUtilities.js","data/utilities/Concatenation.js","component/2d/SignalDeltaLine.jsx","component/2d/zones/SignalCrosshair.jsx","component/2d/zones/Signal.jsx","component/2d/zones/Zone.jsx","component/2d/zones/Zones.jsx","component/2d/Chart2D.jsx","component/2d/FooterBanner.jsx","component/2d/tools/XYLabelPointer.jsx","data/utilities/generateID.js","data/FiltersManager.ts","data/utilities/getColor.js","data/data1d/autoRangesDetection.js","data/data1d/detectSignal.js","data/data1d/Datum1D.ts","data/data2d/Processing2D.js","data/data2d/Datum2D.ts","data/data2d/autoZonesDetection.js","component/2d/tools/slicing/SliceScale.js","component/2d/tools/slicing/HorizontalSliceChart.jsx","component/2d/tools/slicing/VerticalSliceChart.jsx","component/2d/tools/slicing/SlicingView.jsx","component/2d/Viewer2D.jsx","component/ErrorBoundary.tsx","component/elements/popup/Alert/Context.js","component/elements/popup/Alert/ProgressIndicator.js","component/elements/popup/Alert/Provider.js","data/data1d/Data1DManager.js","data/data2d/Data2DManager.js","data/molecules/Molecule.js","data/SpectraManager.js","component/elements/CheckBox.jsx","component/elements/formik/FormikCheckBox.jsx","component/elements/formik/FormikForm.jsx","component/elements/Input.jsx","component/elements/formik/FormikInput.jsx","component/modal/ModalStyle.js","component/modal/SaveAsModal.jsx","component/utility/util/nmredata/addSource.js","component/utility/util/nmredata/getToFix.js","component/utility/util/nmredata/get1DSignals.js","component/utility/util/nmredata/getCouplingObserved.js","component/utility/util/nmredata/get2DSignals.js","component/utility/util/nmredata/flat2DSignals.js","component/utility/util/nmredata/getLabels.js","component/utility/nmriumToNmredata.js","component/hooks/useExport.js","component/hooks/useToolsFunctions.js","component/EventsTrackers/KeysListenerTracker.js","component/constants/help.js","component/elements/ButtonToolTip.jsx","component/elements/Logo.jsx","component/modal/AboutUsModal.jsx","component/modal/UserManualModal.jsx","component/elements/Tab/DeleteButton.jsx","component/elements/Tab/Tab.jsx","component/elements/Tab/options.js","component/elements/Tab/Tabs.jsx","component/reducer/preferencesReducer.js","component/modal/setting/ControllersTabContent.jsx","component/modal/setting/DisplayTabContent.jsx","component/modal/setting/FormattingTabContent.jsx","component/modal/setting/GeneralSettings.jsx","component/elements/NumberInput.jsx","component/header/AutoPeakPickingOptionPanel.jsx","component/elements/Select.jsx","component/header/BaseLineCorrectionPanel.jsx","component/elements/InputRange.jsx","component/header/ManualPhaseCorrectionPanel.jsx","component/header/RangesPickingOptionPanel.jsx","component/header/ZeroFillingOptionsPanel.jsx","component/header/Zones2DOptionPanel.jsx","component/header/Header.jsx","component/utility/FileUtility.js","component/loader/DropZone.jsx","component/elements/accordion/AccordionItem.jsx","component/elements/accordion/Accordion.jsx","component/elements/ReactTable/Style.js","component/elements/ReactTable/ReactTableFlexLayout.jsx","component/hoc/InfoWrapper.js","component/panels/InformationPanel.jsx","component/hoc/IntegralsWrapper.js","component/modal/changeSum/NumberInput.jsx","component/elements/NextPrev.jsx","component/elements/MoleculeSelection.jsx","component/modal/changeSum/SelectMolecule.jsx","component/modal/changeSum/ChangeSumModal.jsx","component/elements/ToggleButton.jsx","component/panels/header/DefaultPanelHeader.jsx","component/elements/SaveButton.jsx","component/panels/header/PreferencesHeader.jsx","component/elements/EditableColumn.jsx","component/elements/ContextMenu.jsx","component/elements/ReactTable/Elements/ReactTableHeader.js","component/elements/ReactTable/Elements/ReactTableRow.js","component/elements/ReactTable/ReactTable.jsx","component/panels/extra/placeholder/NoTableData.jsx","component/panels/IntegralsPanel/IntegralTable.jsx","component/elements/ColorInput.jsx","component/panels/extra/preferences/ColumnFormatField.jsx","component/panels/IntegralsPanel/IntegralsPreferences.jsx","component/panels/IntegralsPanel/IntegralPanel.jsx","component/elements/MenuButton.jsx","component/hoc/MoleculeWrapper.js","component/modal/MoleculeStructureEditorModal.jsx","component/elements/IsotopesViewer.jsx","component/elements/formik/FormikSelect.jsx","component/modal/PredictSpectraModal.jsx","component/panels/MoleculesPanel/Utilities.js","component/panels/MoleculesPanel/MoleculePanel.jsx","data/data1d/MulitpleAnalysis.js","data/utilities/generateChar.js","data/constants/References.js","component/modal/AlignSpectraModal.jsx","component/modal/ExportAsMatrixModal.jsx","component/modal/MultipleSpectraFiltersModal/EquallySpacedFilter.jsx","component/modal/MultipleSpectraFiltersModal/FromToFilter.jsx","component/modal/MultipleSpectraFiltersModal/index.jsx","component/elements/styles/prism.js","component/utility/Evaluate.js","component/panels/MultipleSpectraAnalysisPanel/MulipleAnalysisCodeEditor.jsx","component/panels/MultipleSpectraAnalysisPanel/MultipleSpectraAnalysisPreferences.jsx","component/elements/dropDownButton/DropDownList.jsx","component/elements/dropDownButton/DropDownButton.jsx","component/panels/MultipleSpectraAnalysisPanel/ColumnHeader.jsx","component/panels/MultipleSpectraAnalysisPanel/MultipleSpectraAnalysisTable.jsx","component/panels/MultipleSpectraAnalysisPanel/MultipleSpectraAnalysisPanel.jsx","component/hoc/PeaksWrapper.js","component/panels/PeaksPanel/PeaksPreferences.jsx","component/panels/PeaksPanel/PeaksTable.jsx","component/panels/PeaksPanel/PeaksPanel.jsx","component/modal/CopyClipboardModal.jsx","component/panels/RangesPanel/RangesHeader.jsx","component/panels/RangesPanel/RangesPreferences.jsx","component/panels/extra/utilities/UseToggleStatus.js","component/panels/extra/preferences/ColumnsHelper.js","component/panels/RangesPanel/TableColumns/AbsoluteColumn.jsx","component/elements/Button.jsx","component/elements/formik/ErrorMessage.jsx","component/elements/formik/Input.jsx","component/modal/editRange/forms/components/AddSignalFormTab.jsx","component/elements/formik/SelectBox.jsx","component/modal/editRange/forms/components/CouplingsTable.jsx","component/modal/editRange/forms/components/SignalFormTab.jsx","component/modal/editRange/forms/components/SignalsForm.jsx","component/modal/editRange/forms/validation/EditRangeValidation.js","component/modal/editRange/EditRangeModal.jsx","component/panels/RangesPanel/TableColumns/ActionsColumn.jsx","component/panels/RangesPanel/TableColumns/CouplingColumn.jsx","component/panels/RangesPanel/TableColumns/RangeAssignmentsColumn.jsx","component/panels/RangesPanel/TableColumns/RangeColumn.jsx","component/panels/RangesPanel/TableColumns/RelativeColumn.jsx","component/panels/RangesPanel/TableColumns/SignalAssignmentsColumn.jsx","component/panels/RangesPanel/TableColumns/format.js","component/panels/RangesPanel/TableColumns/SignalDeltaColumn.jsx","component/panels/RangesPanel/RangesTableRow.jsx","component/panels/RangesPanel/useMapRanges.js","component/panels/RangesPanel/RangesTable.jsx","component/panels/RangesPanel/RangesPanel.jsx","component/hoc/SpectraWraper.js","component/panels/SpectrumsPanel/SpectraPanelHeader.jsx","component/utility/GroupByInfoKey.js","component/panels/SpectrumsPanel/base/ColorIndicator.jsx","component/panels/SpectrumsPanel/base/ShowHideMarkersButton.jsx","component/panels/SpectrumsPanel/base/ShowHideSpectrumButton.jsx","component/panels/SpectrumsPanel/SpectrumListItem.jsx","component/elements/formik/FormikColorPicker.jsx","component/panels/SpectrumsPanel/base/setting/Spectrum1DHistogram.jsx","component/panels/SpectrumsPanel/base/setting/Spectrum1DSetting.jsx","component/elements/formik/FormikSlider.jsx","component/panels/SpectrumsPanel/base/setting/Spectrum2DHistogram.jsx","component/panels/SpectrumsPanel/base/setting/Spectrum2DSetting.jsx","component/panels/SpectrumsPanel/base/setting/SpectrumSetting.jsx","component/panels/SpectrumsPanel/SpectrumsTabs.jsx","component/panels/SpectrumsPanel/SpectrumListPanel.jsx","component/panels/SummaryPanel/CorrelationTable/Constants.js","component/panels/SummaryPanel/Utilities.js","component/panels/SummaryPanel/CorrelationTable/AdditionalColumnHeader.jsx","component/panels/SummaryPanel/CorrelationTable/AdditionalColumnField.jsx","component/panels/SummaryPanel/CorrelationTable/CorrelationTableRow.jsx","component/panels/SummaryPanel/CorrelationTable/CorrelationTable.jsx","component/panels/SummaryPanel/Overview.jsx","component/elements/MolecularFormulaInput.jsx","component/panels/SummaryPanel/SetMolecularFormulaModal.jsx","component/panels/SummaryPanel/SetShiftTolerancesModal.jsx","component/panels/SummaryPanel/SummaryPanel.jsx","component/panels/ZonesPanel/ZonesPreferences.jsx","component/panels/ZonesPanel/TableColumns/ActionsColumn.jsx","component/panels/ZonesPanel/TableColumns/SignalAssignmentsColumn.jsx","component/panels/ZonesPanel/TableColumns/SignalAssignmentsColumns.jsx","component/panels/ZonesPanel/TableColumns/SignalDeltaColumn.jsx","component/panels/ZonesPanel/TableColumns/ZoneAssignmentsColumn.jsx","component/panels/ZonesPanel/TableColumns/ZoneAssignmentsColumns.jsx","component/panels/ZonesPanel/ZonesTableRow.jsx","component/panels/ZonesPanel/ZonesTable.jsx","component/panels/ZonesPanel/ZonesPanel.jsx","component/elements/Table/Table.jsx","component/elements/Table/TableBody.jsx","component/elements/Table/TableCell.jsx","component/elements/Table/TableHead.jsx","component/elements/Table/TableRow.jsx","component/hoc/FiltersWrapper.js","component/panels/filtersPanel/FiltersTableRow.jsx","component/panels/filtersPanel/FilterPanel.jsx","component/panels/Panels.jsx","component/reducer/IgnoreActions.ts","component/utility/util/nmredata/addRanges.js","component/utility/util/nmredata/addZones.js","component/utility/nmredataToNmrium.js","component/reducer/actions/CorrelationsActions.ts","component/reducer/actions/DomainActions.ts","component/utility/nucluesToString.js","component/reducer/helper/GetClosestNumber.js","component/reducer/helper/ZoomHistory.js","component/reducer/actions/PreferencesActions.ts","component/reducer/actions/ToolsActions.ts","component/reducer/actions/FiltersActions.ts","component/reducer/helper/getRange.ts","component/reducer/actions/IntegralsActions.ts","data/molecules/MoleculeManager.js","component/reducer/actions/LoadActions.ts","component/reducer/actions/RangesActions.ts","component/reducer/actions/ZonesActions.ts","component/reducer/helper/get2DRange.ts","component/reducer/actions/MoleculeActions.ts","component/reducer/actions/PeaksActions.ts","data/data1d/autoPeakPicking.js","component/reducer/actions/SpectraAanalysisAction.ts","data/data1d/getReferenceShift.js","component/reducer/actions/SpectrumsActions.ts","component/reducer/types/HistoryTypes.js","component/reducer/Reducer.ts","component/reducer/actions/DimensionsActions.ts","component/reducer/actions/HistoryActions.js","component/reducer/actions/GlobalActions.ts","component/hoc/ToolBarWrapper.js","component/modal/LoadJCAMPModal.jsx","component/toolbar/BasicToolBar.jsx","component/elements/toggle/ToggleButton.jsx","component/elements/toggle/ToggleButtonGroup.jsx","component/toolbar/FunctionToolBar.jsx","component/toolbar/ToolBar.jsx","component/NMRium.tsx"],"names":["TYPES","PEAK","INTEGRAL","RANGE","ZONE","EXCLUSION_ZONE","highlightContext","createContext","highlightReducer","state","action","type","payload","convertedHighlights","newState","highlights","value","highlighted","Object","keys","highlightedPermanently","Error","emptyState","HighlightProvider","props","useReducer","highlight","dispatch","contextValue","useMemo","Provider","children","useHighlightData","useContext","useHighlight","Array","isArray","context","newHighlights","push","String","useEffect","isActive","some","key","includes","isActivePermanently","show","useCallback","hide","add","id","remove","click","e","preventDefault","stopPropagation","onHover","onMouseEnter","onMouseLeave","onClick","copyFormattedHtml","html","container","document","createElement","innerHTML","style","position","pointerEvents","opacity","activeSheets","prototype","slice","call","styleSheets","filter","sheet","disabled","body","appendChild","window","getSelection","removeAllRanges","range","createRange","selectNode","addRange","execCommand","i","length","removeChild","copyHTMLToClipboard","data","a","copyTextToClipboard","navigator","clipboard","writeText","exportAsJSON","fileName","spaceIndent","isCompressed","fileData","JSON","stringify","ArrayBuffer","isView","from","blob","Blob","saveAs","zip","JSZip","file","generateAsync","compression","compressionOptions","level","console","log","exportAsMatrix","options","columnsLables","to","nbPoints","x","matrix","join","spectrum","re","experiment","info","name","display","cellsValues","exportAsNMRE","then","content","exportAsSVG","elementID","getBlob","exportAsPng","width","height","canvas","getContext","fillStyle","fillRect","img","Image","url","URL","createObjectURL","onload","drawImage","png","toDataURL","revokeObjectURL","src","copyDataURLCliboard","image","copyBlobToCliboard","toBlob","b","clip","ClipboardItem","write","err","copyPNGToClipboard","ReferenceError","alert","_svg","getElementById","cloneNode","getAttribute","replace","querySelectorAll","forEach","element","head","svg","checkModifierKeyActivated","event","getModifierState","BrushContext","initialState","step","brush","start","end","debounceClickEvents","BrushTracker","className","onBrush","onZoom","onDoubleClick","noPropagation","reducer","useState","mouseDownTime","setMouseDownTime","mouseDownHandler","button","shiftKey","altKey","screenX","screenY","clientX","clientY","boundingRect","currentTarget","getBoundingClientRect","timeStamp","clickHandler","persist","y","callback","lodashDebounce","lodashMap","debounce","cancel","handleMouseWheel","deltaY","deltaX","deltaMode","startX","endX","Math","abs","moveCallback","upCallback","onMouseDown","onMouseUp","onMouseMove","onWheel","endY","startY","startScreenX","startScreenY","startClientX","startClientY","defaultProps","MouseContext","MouseaProvider","MouseTracker","mouseTrackerState","setMouseTrackerState","mouseMoveHandler","mouseLeaveHandler","ChartContext","ChartDataProvider","useChartData","dispatchContext","DispatchProvider","useDispatch","PreferencesConext","PreferencesProvider","usePreferences","scaleContext","ScaleProvider","useScale","positions","TOP_LEFT","TOP_CENTER","TOP_RIGHT","MIDDLE_LEFT","MIDDLE","MIDDLE_RIGHT","BOTTOM_LEFT","BOTTOM_CENTER","BOTTOM_RIGHT","types","transitions","ModalContext","ModalProvider","useModal","styles","outerContainer","top","right","bottom","left","backgroundColor","justifyContent","alignItems","zIndex","innerContainer","boxSizing","boxShadow","flexDirection","minWidth","minHeight","borderRadius","Modal","open","onClose","handleClose","defaultStyle","transition","transform","defaultTransitionStyles","entering","entered","exiting","exited","Transtion","transitionStyles","ref","useRef","nodeRef","timeout","default","Wrapper","getStyles","initialStyles","overflow","containerStyle","css","ConfirmationDialog","buttons","message","optionsHandler","handler","map","option","text","offset","wrapperRef","root","modal","setModal","current","parentStyle","innerWidth","innerHeight","closeHandler","component","_modal","isBackgroundBlur","enableResizing","onOpen","showConfirmDialog","dialogOptions","ConfirmDialog","keyHandler","addEventListener","removeEventListener","outerStyle","close","createPortal","TransitionGroup","appear","margin","userSelect","dragHandleClassName","enableUserSelectHack","cloneElement","cursor","CENTER","LoaderContext","LoaderProvider","useLoader","NoData","isEmpty","emptyText","loader","openFileDialogHadnler","DefaultSpinnerComponent","xmlns","viewBox","fill","d","defaultGetSpinner","spinnerContext","SpinnerProvider","Spinner","isLoading","undefined","checkEmpty","startCheckEmpty","timeour","setTimeout","clearTimeout","getSpinner","GlobalConetxt","GlobalProvider","useGlobal","padding","color","whiteSpace","fontSize","fontFamily","textShadow","ToolTip","popupPlacement","title","refChild","refContent","placement","setPlacement","showToolTip","elementsWraperRef","useLayoutEffect","pl","getPopupPlacement","childBounding","contentBounding","mouseOverHandler","mainContainer","onMouseOver","onMouseOut","popup","memo","CloseButton","popupTitle","loaderStyles","MultipletAnalysisModal","activeSpectrum","scaleX","analysisData","setAnalysisData","calcStart","setCalcStartStatus","isCalcFinished","setCalcFinished","index","invert","xGetFromToIndex","fromIndex","toIndex","analysesProps","result","analyseMultiplet","frequency","originFrequency","takeBestPartMultiplet","symmetrizeEachStep","debug","steps","chart","series","multiplet","j","multiplicity","coupling","toFixed","errorFunction","initSetting","controllers","mws","low","high","formatting","nucleus","useStateWithLocalStorage","localStorageKey","localStorage","getItem","setValue","setItem","setData","castData","parse","lodashSet","lodashGet","getLocalStorage","isJson","settings","getValue","object","keyPath","defaultValue","zoomDefaultValues","lowStep","highStep","speedThreshold","Spectrum1DZoomHelper","scale","this","slowZoomStep","fastZoomStep","wheel","deltaYValue","toString","_slowZoomStep","_fastZoomStep","LOW_STEP","FAST_STEP","ZOOM_STEP","_scale","sign","getScale","setScale","spectraZoomHanlders","integralZoomHanlder","ZoomType","initZoom1DHandler","datum","dimension","activeTab","getScaleByID","reduce","acc","setZoom","draft","defaultScale","spectrumID","zoomFactor","yDomains","scaleLinear","originDomain","min","max","scalePoint","yDomain","zoomIdentity","translate","rescaleY","domain","spectrumId","t","setZoom1D","tabActiveSpectrum","split","setIntegralZoom","originIntegralYDomain","scaleValue","newYDomain","integralZoomFactor","integralsYDomains","getXScale","xDomains","xDomain","mode","getYScale","verticalAlign","_height","flag","stacked","domainY","SET_SCALE","scaleInitialState","scaleY","scaleReducer","produce","INITIATE","LOAD_JSON_FILE","LOAD_JCAMP_FILE","LOAD_NMREDATA_FILE","LOAD_MOL_FILE","LOAD_ZIP_FILE","LOAD_JDF_FILE","ADD_PEAK","ADD_PEAKS","DELETE_PEAK_NOTATION","SHIFT_SPECTRUM","SET_X_DOMAIN","SET_Y_DOMAIN","SET_ORIGINAL_DOMAIN","SET_WIDTH","SET_DIMENSIONS","SET_SELECTED_TOOL","SET_SELECTED_FILTER","CHANGE_SPECTRUM_SETTING","FULL_ZOOM_OUT","CHANGE_VISIBILITY","CHANGE_PEAKS_MARKERS_VISIBILITY","CHANGE_ACTIVE_SPECTRUM","CHANGE_SPECTRUM_COLOR","ADD_INTEGRAL","DELETE_INTEGRAL","TOGGLE_REAL_IMAGINARY_VISIBILITY","SET_ZOOM_FACTOR","ADD_MOLECULE","SET_MOLECULE","DELETE_MOLECULE","SET_CORRELATION","SET_CORRELATIONS","SET_CORRELATIONS_MF","SET_CORRELATIONS_TOLERANCE","DELETE_SPECTRA","CHANGE_SPECTRUM_DISPLAY_VIEW_MODE","RESIZE_INTEGRAL","BRUSH_END","RESET_DOMAIN","CHANGE_INTEGRAL_ZOOM","ENABLE_FILTER","DELETE_FILTER","DELETE_SPECTRA_FILTER","APPLY_ZERO_FILLING_FILTER","APPLY_FFT_FILTER","CALCULATE_MANUAL_PHASE_CORRECTION_FILTER","APPLY_MANUAL_PHASE_CORRECTION_FILTER","APPLY_AUTO_PHASE_CORRECTION_FILTER","APPLY_ABSOLUTE_FILTER","SET_VERTICAL_INDICATOR_X_POSITION","AUTO_PEAK_PICKING","AUTO_RANGES_DETECTION","AUTO_ZONES_DETECTION","DELETE_RANGE","SET_SELECTED_OPTIONS_PANEL","SET_LOADING_FLAG","RESET_SELECTED_TOOL","SET_SPECTRUMS_VERTICAL_ALIGN","CHANGE_INTEGRAL_DATA","SET_ACTIVE_TAB","CHANGE_INTEGRAL_SUM","ADD_BASE_LINE_ZONE","DELETE_BASE_LINE_ZONE","APPLY_BASE_LINE_CORRECTION_FILTER","SET_KEY_PREFERENCES","APPLY_KEY_PREFERENCES","RESIZE_RANGE","CHANGE_RANGE_SUM","ADD_RANGE","SET_2D_LEVEL","ADD_2D_ZONE","DELETE_2D_ZONE","ADD_MISSING_PROJECTION","SET_FILTER_SNAPSHOT","CHANGE_RANGE_RELATIVE","CHANGE_RANGE_SIGNAL_VALUE","CHANGE_RANGE_SIGNAL_KIND","SAVE_EDITED_RANGE","UNLINK_RANGE","SET_DIAID_RANGE","CHANGE_INTEGRAL_RELATIVE","ANALYZE_SPECTRA","DELETE_ANALYZE_SPECTRA_RANGE","RESIZE_ANALYZE_SPECTRA_RANGE","SET_ANALYZE_SPECTRA_COLUMNS","FILTER_SPECTRA_COLUMN","ALIGN_SPECTRA","CHANGE_ZONE_SIGNAL_VALUE","CHANGE_ZONE_SIGNAL_KIND","UNLINK_ZONE","SET_DIAID_ZONE","PREDICT_SPECTRA","SET_SPECTRA_SAME_TOP","RESET_SPECTRA_SCALE","SET_MOUSE_OVER_DISPLAYER","APPLY_MULTIPLE_SPECTRA_FILTER","ADD_EXCLUSION_ZONE","DELETE_EXCLUSION_ZONE","apply","datum1D","isApplicable","reimAbsolute","im","Float64Array","isComplex","isFid","once","defaultOptions","magnitudeMode","minRegSize","maxDistanceToJoin","assign","reimAutoPhaseCorrection","previousValue","newValue","reduced","k","baselineAlgorithms","airpls","polynomial","corrected","algorithm","zones","airPLS","equallySpaced","numberOfPoints","baselineRegression","regression","predict","polynomialRegression","PolynomialRegression","degree","reMean","mean","imMean","digitalFilterValue","pointsToShift","floor","skip","newRe","newIm","set","exclusions","XREdata","XIMdata","digitalFilterApplied","filters","reimFFT","applyZeroShift","digitalFilter","ph1","PI","reimPhaseCorrection","generateXAxis","baseFrequency","parseFloat","frequencyOffset","spectralWidth","spectralHalfWidth","firstPoint","dx","xAxis","grpdly","newRE","newIM","dw","em","exp","coefExp","curFactor","xParetoNormalization","ph0","shiftValue","val","reStd","standardDeviation","imStd","size","newX","diff","currentX","_previousValue","datum2D","minX","maxX","minY","maxY","Filters","absolute","baselineCorrection","lineBroadening","fft","phaseCorrection","autoPhaseCorrection","shiftX","zeroFilling","fromTo","centerMean","pareto","shift2DX","shift2DY","zoom","label","hasOptionPanel","isFilter","peakPicking","integral","zone2D","slicingTool","HMove","equalizerTool","rangesPicking","baseLineCorrection","generalSelector","editRange","multipleSpectraAnalysis","exclusionZones","transformOrigin","allowTools","BRUSH_TYPE","BrushXY","brushType","dimensionBorder","widthProps","heightProps","selectedTool","willChange","line","stroke","strokeOpacity","shapeRendering","strokeWidth","CrossLinePointer","brushState","x1","y1","x2","y2","eventEmitter","EventEmitter","Emitter","on","fn","off","emit","freeze","DeleteButton","onDelete","data-no-export","rx","BaseLineZones","baseLineZones","deleteRangeHandler","zone","ExclusionZonesWrapper","WrappedComponent","ExclusionZone","ExclusionZones","integralDefaultValues","showAbsolute","absoluteFormat","showRelative","relativeFormat","rangeDefaultValues","showFrom","fromFormat","showTo","toFormat","peaksDefaultValues","showPeakNumber","peakNumberFormat","showPeakIndex","peakIndexFormat","showDeltaPPM","deltaPPMFormat","showDeltaHz","deltaHzFormat","showPeakWidth","peakWidthFormat","showIntensity","intensityFormat","Resizable","onDrag","onDrop","rightDragVisibility","setRightDragVisibility","leftDragVisibility","setLeftDragVisibility","enable","setEnable","draggableRightRef","draggableLeftRef","handleRightStart","handleRightDrag","layerX","handleRightStop","_range","handleLeftStart","handleLeftDrag","handleLeftStop","mouseDownCaptureHandler","mouseUpCaptureHandler","target","axis","defaultPosition","handle","onStart","onStop","fillOpacity","onMouseDownCapture","onMouseUpCapture","stylesOnHover","stylesHighlighted","IntegralResizable","integralData","setIntgral","handleOnStopResizing","resized","handleOnEnterNotation","handleOnMouseLeaveNotation","dragHandler","boundary","x0","fontWeight","Integral","preferences","integralSettings","xyIntegral","reverse","makePath","pathPoints","xyReduce","optimize","path","accumulator","point","IntegralsSeries","displayerKey","getIntegralYScale","Integrals","IsActive","isVisible","isVisibleInDomain","integrals","values","clipPath","Line","vAlign","paths","_scaleX","_scaleY","get","LinesSeries","tempData","_data","useFormatNumberByNucleus","nucleusByKey","ppm","hz","formatFun","n","formatKey","prefix","suffix","Numeral","Number","format","toLowerCase","getNumberOfDecimals","lastIndex","trim","lastIndexOf","substr","FormatNumber","PeakNotation","refText","isSelected","setIsSelected","_value","containerSize","setContainerSize","handleOnPeakChange","textBox","getBBox","handleKeyDown","oldValue","blur","keyCode","handleChange","handleSelectPeakNotation","outline","dy","paddingRight","border","onKeyDown","onChange","PeaksNotations","Peaks","getVerticalAlign","findIndex","reSortData","sort","peaks","isPeaksMarkersVisible","delta","intensity","axisStyles","gridStyles","XAxis","showGrid","refAxis","refGrid","d3","ticks","tickFormat","grid","tickSize","Axis","textAnchor","Grid","propTypes","PropTypes","bool","string","MultiAnalysisWrapper","spectraAnalysis","forwardedRef","rest","forwardRef","AnalysisRange","rangeData","columnKey","deleteHandler","colKey","MultiAnalysisRanges","columns","ranges","RangesWrapper","molecules","find","SignalKinds","SignalKindsToInclude","DatumKind","getPubIntegral","getDiaIDs","concat","diaID","signal","_signal","flat","setPubIntegral","pubIntegral","resetDiaIDs","unlink","unlinkType","signalIndex","checkRangeKind","kind","unlinkInAssignmentData","assignmentData","ids","assignmentContext","assignmentReducer","assignment","_id","activeID","activeAxis","isOnHover","onHoverID","onHoverAxis","AssignmentProvider","spectraData","initAssignmentDataRanges","_contextValue","_diaID","initAssignmentDataZones","useAssignmentData","useAssignment","assigned","removeAll","toggle","deleteRecord","setIsOnHover","Multiplets","checkMultiplet","rejected","_multiplet","m","checkMultiplicity","translateMultiplet","hasCouplingConstant","TREE_LEVEL_COLORS","LevelNode","levelHeight","StringNode","showLabels","lengthAdjust","visibility","TreeNodes","nodesData","signalID","labelOptions","buildTreeNodeAndEdge","_startX","ratio","multiplicityIndex","edgeLevel","_startYEdge","_startYNode","distance","node","createTreeNodes","spectrumData","buildTreeNodesData","jIndices","treeNodesData","jIndex","_jIndex","pascal","getPascal","spin","mult","previousLine","_line","getMultiplicityNumber","charAt","MultiplicityTree","rangeFrom","rangeTo","xRange","setXRange","treeProps","setTreeProps","drawInFullRange","setDrawInFullRange","setShowLabels","_drawInFullRange","_treeWidth","_treeHeight","_treeLevelHeight","yMax","_x","_mult","_i","_xRange","_treeNodeData","multiplicityTree","firstLevelStartY","_startY","secondLevelStartY","_rangeFrom","_rangeTo","pathData","Range","showMultiplicityTrees","assignmentRange","highlightRange","rangeBoundary","setRangeBoundary","reduceOpacity","setReduceOpacity","isBlockedByEditing","setIsBlockedByEditing","mouseEnterHandler","assignHandler","Ranges","isMultiplicityTreesVisibile","Events","Chart1D","HelpContext","HelpProvider","useHelp","preventAutoHelp","ctrlKey","delay","clear","groupBy","array","item","initState","helpText","helpObject","helpReducer","closeButton","dealyTimeOut","multiple","timersId","modals","setModals","timersIdRef","currentModals","lengthBeforeRemove","filteredModals","helpid","random","modalOptions","startModal","timerId","splice","indexOf","helpState","modalsByPosition","_position","filePath","frameBorder","scrolling","FooterWarpper","helpStyles","FooterBanner","useHelptData","getYValue","xPosition","xIndex","xFindClosestIndex","toPrecision","MIN_VALUE","colorIndicator","borderBottom","marginBottom","YTracker","SpectraTracker","ToggleVisiblility","trackers","borderColor","PeakPointer","closePeakPosition","setPosition","candidatePeakPosition","getClosePeak","xShift","mouseCoordinates","maxIndex","number","minIndex","yDataRange","yValue","xValue","cx","cy","r","VerticalIndicator","pivot","XLabelPointer","activeSpectrumData","getXValue","xVal","xInvert","Viewer1D","general","widthProp","heightProp","scaleState","dispatchScale","handelBrushEnd","brushData","disableMultipletAnalysis","propagateEvent","startXPPM","endXPPM","handelOnDoubleClick","zoomType","handleZoom","mouseClick","xPPM","useSize","sizedNMRChart","finalSize","setFinalSize","useDebounce","isFinite","ContoursWrapper","LAYOUT","TOP_1D","LEFT_1D","CENTER_2D","getLayoutID","get2DXScale","get2DYScale","get1DYScale","ContoursPaths","contours","buildContourPath","lines","Contours","isPositiveVisible","positiveColor","isNegativeVisible","negativeColor","DISPLAYER_MODE","DM_1D","DM_2D","MARGIN","lineStyle","IndicationLines","displayerMode","deltas1D","setDeltas1D","deltas","_datum","_kind","indicationLines","_delta","Left1DChart","marignValue","originHeight","lastXIndex","lastYIndex","reduceRight","mainHeight","Top1DChart","marginProps","originMargin","shape","isRequired","YAxis","ZonesWrapper","isOnZoneLevel","buildID","SignalDeltaLine","SignalCrosshair","highlightIDsX","highlightIDsY","highlightX","highlightY","Signal","buildIDs","highlightData","isHighlighted","setIsHighlighted","_highlighted","signals","peak","Zone","zoneData","assignmentZone","highlightZone","checkZoneKind","Zones","setVisibility","prevVisiblity","Chart2D","onDimensionChange","propsTypes","PropsTypes","func","layout","data1D","trackID","nucleuses","formatX","formatY","getRealYValue","cordinate","getLabel","label2d","labelld","mf","getZValue","z","xStep","yStep","yIndex","getDeltaX","getRation","textAlign","XYLabelPointer","generateID","applyFilter","isReduced","filterOption","previousFilter","lookupForFilter","reduceResult","replaceFilter","addFilter","hasOwnProperty","isDeleteAllow","isLastFilter","reapplyFilters","f","filterName","_filters","enableFilter","checked","originalData","originalInfo","filterIndex","error","deleteFilter","isSnapshot","filterID","COLORS","color2D","cosy","roesy","noesy","tocsy","hsqc","hmbc","percentToHex","p","percent","hexValue","round","padStart","adjustAlpha","factor","getColor","isRandom","usedColors","resetColors","c","lum","hex","toUpperCase","rgb","parseInt","defaultPeakPickingOptions","minMaxRatio","realTopDetection","maxCriteria","smoothY","nH","compile","frequencyCluster","clean","keepPeaks","sgOptions","windowSize","detectSignal","chemShift","usedColors1D","initiateDatum1D","source","jcampURL","binary","extension","get1dColor","isRealSpectrumVisible","meta","sum","FiltersManager","preprocessing","FiltersTypes","toJSON","forceIncludeData","lookupPeak","dataRange","updateIntegralIntegrals","updateRelatives","countingCondition","storageKey","currentSum","previous","updateIntegralRanges","checkSignalKinds","kinds","mapRanges","getShiftX","newRange","xyIntegration","originDelta","originFrom","originTo","detectRanges","impurities","solvent","autoRangesDetection","noiseLevel","xAbsoluteMedian","windowFromIndex","windowToIndex","peakPickingOptions","rangesOptions","xyAutoRangesPicking","updateXShift","updatePeaksXShift","updateRangesXShift","s","updateIntegralXShift","defaultContourOptions","positive","contourLevels","numberOfLayers","negative","Processing2D","minMax","defaultLevel","currentLevelPositive","currentLevelNegative","xs","getRange","ys","conrec","Conrec","swapAxes","median","noise","getLevel","levelPositive","levelNegative","setLevel","setOptions","positiveBoundary","negativeBoundary","shiftWheel","drawContours","zoomPositive","zoomNegative","numberOfPositiveLayer","numberOfNegativeLayer","getContours","nbLevels","zoomLevel","maxZ","minZ","pow","drawContour","contourDrawer","levels","factors","lastFactor","usedColors2D","initiateDatum2D","jcamp","original","get2DColor","colors","contourOptions","processingController","getShift","shift","yShift","updateShift","updateZonesShift","getMissingProjection","projection","zoneToX","getDetectionZones","dataMatrix","selectedZone","getSubMatrix","fromX","toX","fromY","toY","xIndexFrom","yIndexFrom","xIndexTo","yIndexTo","MIN_SAFE_INTEGER","MAX_SAFE_INTEGER","nbXPoints","row","Float32Array","rowValue","autoZonesDetection","thresholdFactor","maxPercentCutOff","enhanceSymmetry","convolutionByFFT","isHomoNuclear","xyzAutoPeaksPicking","observeFrequencies","extent","HorizontalSliceChart","VerticalSliceChart","SlicingView","spectra","useMouseTracker","chart2d","scale2dX","scale2dY","getSlice","infoX","dataX","infoY","dataY","horizontal","vertical","Viewer2D","DIMENSION","get2DDimensionLayout","wheelData","header","ErrorBoundary","errorInfo","setState","componentStack","Component","AlertContext","AlertProvider","useAlert","ProgressIndicator","alertContext","alerts","setAlerts","currentAlerts","filteredAlerts","alertOptions","success","showLoading","Promise","resolve","alertsByPosition","fromBruker","dependentVariables","getData","components","fromCSD","dimensions","quantityName","count","incr","increment","magnitude","origin","originOffset","coordinatesOffset","buffer","initMolecule","molecule","molfile","mol","OCLMolecule","fromMolfile","mfInfo","getMolecularFormula","formula","absoluteWeight","mw","relativeWeight","toSVG","MF","atoms","getInfo","addJcampFromURL","fetch","response","arrayBuffer","addJcamp","entries","fromJCAMP","noContour","xy","keepRecordsRegExp","profiling","entry","addJcampSS","fromParsedJcamp","parsedJcamp","Data1DManager","Data2DManager","addData","Datum1D","Datum2D","addJDF","jdf","converted","fromJEOL","description","metadata","acquisitionMode","acquisitionTime","spectralWidthClipped","application","isFt","fromJSON","promises","all","addBruker","noContours","keepOriginal","addJcamps","files","correlations","multipleAnalysis","mols","ob","Molecule","CheckBox","checkProps","setCheck","handleCheck","defaultChecked","FormikCheckBox","resProps","useFormikContext","setFieldValue","changeHandler","htmlFor","FormikForm","initialValues","onSubmit","validationSchema","innerRef","lineHeight","Input","checkValue","enableAutoSelect","prop","setVal","select","formatValue","onChangeHandler","check","test","preventPropagate","input","onKeyPress","FormikInput","errors","touched","isInvalid","ModalStyles","INITIAL_VALUE","compressed","pretty","includeData","SaveAsModal","onSave","refForm","handleSave","submitForm","submitHandler","jszip","Jszip","addSource","nmrRecord","tag","loadAsync","endsWith","async","getPathFromZip","relativePath","match","getToFix","nucleusArray","toFix","chooseDecimal","get1DSignals","labels","str","partTag","counter","subfix","signalLabel","arr","separator","byDiaID","jCoupling","jCouple","putIntegral","nbAtoms","getCouplingObserved","get2DSignals","nucleusRecorded","pulseSequence","couplingObserved","xLabel","getAssignment","yLabel","flat2DSignals","flattedSignal","getLabels","groupedDiaIDs","connections","getShortestPaths","toLabel","maxLength","byAssignNumber","roiKey","flatSignals","rois","roi","diaIDs","groupedOclID","dia","oclID","atom","atomLabel","createLabel","pLabel","hLabel","getAtomLabel","tags","temperature","nmriumToNmredata","addNMReDATA","filename","sdfResult","toMolfile","addImplicitHydrogens","getGroupedDiastereotopicAtomIDs","putTag","formatAssignments","l","useExport","saveToClipboardHandler","hideLoading","saveAsJSONHandler","exportedData","saveAsNMREHandler","saveAsSVGHandler","saveAsPNGHandler","saveHandler","saveAsHandler","useToolsFunctions","isRealSpectrumShown","setIsRealSpectrumShown","debounceClickEventsRef","clicks","handleChangeOption","handleFullZoomOut","changeDisplayViewModeHandler","changeSpectrumViewHandler","alignSpectrumsVerticallyHandler","KeysListenerTracker","keysPreferences","overDisplayer","allow1DTool","allow2DTool","integralID","activeKey","keysPreferencesListenerHandler","num","toolsListenerHandler","metaKey","toolID","handleOnKeyDown","localName","code","baseURL","getHelpList","zoomIn","integralPicking","fullScreen","loadSpectrum","ButtonToolTip","Logo","fillRule","points","json","AboutUsModal","setInfo","href","rel","UserManualModal","getHelpData","Tab","tabid","tablabel","canDelete","tabstyles","topStyles","leftStyles","Tabs","defaultTabID","setActiveTab","onClickTabHandler","tab","tabs","Children","child","candelete","deleteFlag","tabsContent","INIT_PREFERENCES","SET_PREFERENCES","SET_PANELS_PREFERENCES","preferencesInitialState","basePreferences","hideSetSumFromMolecule","panels","hideSpectraPanel","hideInformationPanel","hidePeaksPanel","hideIntegralsPanel","hideRangesPanel","hideStructuresPanel","hideFiltersPanel","hideZonesPanel","hideSummaryPanel","hideMultipleSpectraAnalysisPanel","toolBarButtons","hideZoomTool","hideZoomOutTool","hideImport","hideExportAs","hideSpectraStackAlignments","hideSpectraCenterAlignments","hideRealImaginary","hidePeakTool","hideIntegralTool","hideAutoRangesTool","hideZeroFillingTool","hidePhaseCorrectionTool","hideBaseLineCorrectionTool","hideFFTTool","hideMultipleSpectraAnalysisTool","help","dimmedSpectraTransparency","mapNucleus","preferencesReducer","nmrLocalStorageVersion","removeData","removeItem","storeData","localData","resPreferences","v","lodashMerge","ControllersTabContent","marginTop","LIST","DisplayTabContent","FormattingTabContent","nucleusesObject","addNewNucleusFormatHandler","newFormat","newNucleuses","GeneralSettings","setSettingsData","resValues","tabChangeHandler","flex","NumberInput","onInput","pattern","localRef","changeHander","checkValidity","inputContainer","actionButton","AutoPeakPickingOptionPanel","minMaxRatioRef","maxNumberOfPeaksRef","noiseFactor","lookNegativeRef","handleApplyFilter","maxNumberOfPeaks","lookNegative","handleCancelFilter","justifyItems","marginRight","Select","handleOnChanged","isNaN","BaseLineCorrectionPanel","algorithmRef","maxIterationsRef","toleranceRef","degreeRef","setAlgorithm","maxIterations","tolerance","getAlgorithmsList","changeAlgorithmHandler","marginLeft","textOverflow","maxWidth","stateValues","speedX","oldX","firstCalc","calcSpeed","setToZero","InputRange","minValue","maxValue","valueProps","mouseMoveCallback","valueRange","positionDiff","mouseUpCallback","phaseCorrectionTypes","algorithms","ManualPhaseCorrectionPanel","pivotIndex","phaseCorrectionType","setPhaseCorrectionType","handleInput","fieldName","inputValue","prevValue","handleRangeChange","hint","RangesPickingOptionPanel","formatNumber","Sizes","generateSizes","ZeroFillingOptionsPanel","sizeTextInputRef","lineBroadeningValue","setLineBroadeningValue","zeroFillingSize","getDefaultValue","log2","validity","valid","Zones2DOptionPanel","headerStyle","Header","isFullscreen","onMaximize","selectedOptionPanel","selectedPanel","openGeneralSettingsHandler","openUserManual","openAboutUs","data-helpid","FILES_TYPES","MOL","NMRIUM","DX","JDX","JDF","ZIP","NMREDATA","FILES_SIGNATURES","asBuffer","checkStatus","ok","status","statusText","getFileExtension","getFileName","loadFiles","acceptedFiles","reject","reader","FileReader","onabort","onerror","readAsArrayBuffer","readAsBinaryString","loadFilesFromZip","DropZone","loadsubFilesfromZip","extractedfiles","uniqueFileExtensions","selectedFilesByExtensions","decoder","TextDecoder","decode","loadFilesHandler","Set","fileArrayBuffer","Uint8Array","byte","Zip","unzipResult","zipFile","ex","droppedFiles","useDropzone","noClick","getRootProps","getInputProps","isDragActive","openImportDialog","timer","prevent","background","textDecoration","borderTop","buttonTitle","maxHeight","triggerSource","AccordionItem","isOpen","active","setActiveState","refContainer","toggleAccordion","dbClickHandler","forcedOpenedElements","alwaysOpen","Accordion","defaultOpenIndex","elements","setElements","handleOpen","trigger","el","mappedChildren","prevState","HighlightedRowStyle","ConstantlyHighlightedRowStyle","ReactTableStyle","ReactTableFlexLayout","useTable","useSortBy","useFlexLayout","getTableProps","getTableBodyProps","headerGroups","rows","prepareRow","headerGroup","getHeaderGroupProps","headers","column","getHeaderProps","getSortByToggleProps","render","isSorted","isSortedDesc","overflowY","getRowProps","cells","cell","getCellProps","InfoWrapper","tableContainer","searchInput","InformationPanel","information","setInformation","matches","setMatchesData","searchRef","handleSearch","sortType","Cell","resizable","placeholder","IntegralsWrapper","valueReft","Arrow","direction","NextPrev","loop","defaultIndex","useMeasure","activeIndex","setActiveIndex","Sliders","nextHandler","preActiveIndex","nextIndex","prevHandler","prevIndex","toolbarStyle","moleculeContainerStyle","MoleculeSelection","currentIndex","setCurrentIndex","slideIndex","selectMoleculeContainerStyle","optionalTextStyle","SelectMolecule","newSum","saveSelectMoleculeHandler","onChangeMoleculeSelectionHandler","modalContainer","ChangeSumModal","saveInputValueHandler","ToggleButton","Toggle","toggleHandler","DefaultPanelHeader","deleteToolTip","onFilter","filterToolTip","filterIsActive","counterFiltered","onSettingClick","showSettingButton","SaveButton","PreferencesHeader","EditableColumn","onEditStart","editStatus","enabled","enableEdit","refInput","useImperativeHandle","startEdit","closeEdit","editModeHandler","ContextMenu","lef","rootRef","sourceElement","setSourceElement","handleContextMenu","contextMenuHandler","parentElement","clickX","clickY","_handleGlobalClick","isSameNode","ReactTableHeader","ReactTableRow","onContextMenu","isConstantlyHighlighted","ReactTable","contextRef","NoTableData","selectStyle","IntegralTable","relativeRefs","deleteIntegralHandler","params","changeIntegralDataHandler","defaultColumns","orderIndex","accessor","saveRealtiveHandler","editStartHander","tableColumns","setCustomColumn","columnLabel","cellHandler","integralsPreferences","cols","formattedNumber","object1","object2","tableData","isInRange","ColorInput","onColorChange","displayColorPicker","showColorPicker","setColor","handleClick","handleOnColorChanged","colorEvent","onChangeComplete","inputLabel","ColumnFormatField","checkControllerName","formatControllerName","inputChangeHandler","groupID","Boolean","_checked","setChecked","groupContainer","paddingBottom","formatFields","checkController","formatController","defaultFormat","IntegralsPreferences","setSetting","formRef","getValueByKeyPath","saveToLocalStorgate","showMessage","saveSetting","requestSubmit","dispatchEvent","Event","cancelable","handleSubmit","form","formData","FormData","field","keyIndex","nucleusLabel","IntegralPanel","setFilterIsActive","integralsCounter","setIntegralsCounter","isFlipped","setFlipStatus","settingRef","yesHandler","handleDeleteAll","changeIntegralSumHandler","showChangeIntegralSumModal","settingsPanelHandler","saveSettingHandler","handleOnFilter","changedHandler","infinite","menuStyles","MenuItem","icon","MenuList","items","boxBounding","MenuButton","toolTip","menuButtonRef","isShown","showMenu","closeMenuButton","MoleculeWrapper","modalButtonStyle","MoleculeStructureEditorModal","selectedMolecule","setMolfile","cb","newMolfile","initialMolfile","svgMenu","fragment","IsotopesViewer","othersProps","dangerouslySetInnerHTML","__html","FormikSelect","FREQUENCIES","PredictSpectraModal","extractFromAtom","dim","oclIDs","hydrogenOCLIDs","nbHydrogens","findDatumAndSignalIndex","panelContainerStyle","MOL_EXPORT_MENU","MoleculePanel","setOpen","currentMolfile","setCurrentMolfile","onAtomHoverHighlights","setOnAtomHoverHighlights","onAtomHoverAction","setOnAtomHoverAction","activeAssignment","assignedDiaIDs","assignedDiaID","assignedDiaIDsMerged","toggleAssignment","atomInformation","_oclID","toggleDiaIDs","handleOnClickAtom","currentDiaIDsToHighlight","getCurrentDiaIDsToHighlight","assignmentOnHover","axisOnHover","handleOnAtomHover","getHighlightsOnHover","stop","_assigned","handlePaste","readText","handleDelete","saveAsMolHandler","handleReplaceMolecule","openPredicSpectraModal","exportHandler","OCLnmr","OCL","setSelectedAtom","atomHighlightColor","atomHighlightOpacity","setHoverAtom","COLUMNS_TYPES","reservedColumnsNames","addColumnKey","columnProps","getChar","aPotions","charCodeAt","len","chartResult","fromCharCode","generateChar","getSpectraAnalysis","detectRange","xyMinYPoint","xyMaxYPoint","SID","init","refreshCalculation","refreshByRow","calculate","analyzeSpectra","valueKey","spectraSum","prevNucleusData","relative","variables","Function","REFERENCES","tms","nbPeaks","tsp","glucose","baseList","AlignSpectraModal","List","list","setValues","optionChangeHandler","targetX","ExportAsMatrixModal","EquallySpacedFilter","FromToFilter","MultipleSpectraFiltersModal","setFilter","filterChangeHandler","filterOptions","args","MulipleAnalysisCodeEditor","setCode","setResult","evalResult","Eval","valueChangeHandler","highlightHandler","languages","js","prismStyles","onValueChange","MultipleSpectraAnalysisPreferences","onAfterSave","setColumns","tempKey","columnsKeys","preferncesSchema","Yup","columnSchema","required","colmnName","addNewColumn","prevData","DropDownList","onSelect","DropDownButton","selectedKey","formatSelectedValue","drop","closest","selectHandler","columnsFilters","ColumnHeader","charLabel","rangeLabel","onColumnFilter","MultipleSpectraAnalysisTable","codeEvaluation","columnFilterHandler","initColumns","columnIndex","columnData","MultipleSpectraAnalysisPanel","afterSaveHandler","showTrackerHandler","openAlignSpectra","openFiltersModal","copyToClipboardHandler","getDataAsString","letter","openExportAsMatrixModal","PeaksWrapper","PeaksPreferences","peaksPreferences","PeaksTable","deltaPPMRefs","deletePeakHandler","initialColumns","saveDeltaPPMRefsHandler","extraParams","valueHz","peakWidth","PeaksPanel","peaksCounter","setPeaksCounter","CopyClipboardModal","onCopyClick","toolbar","center","removeAssignmentsButton","RangesHeader","onUnlink","onFilterActivated","isFilterActive","filterCounter","isMultiplicityTreesVisible","changeRangesSumHandler","showChangeRangesSumModal","removeAssignments","handleOnRemoveAssignments","handleSetShowMultiplicityTrees","saveAsHTMLHandler","observedFrequency","nbDecimalDelta","nbDecimalJ","rangesToACS","RangesPreferences","oldId","useToggleStatus","setStatus","statusflags","newStatus","isColumnVisible","lodash","AbsoluteColumn","rowSpanTags","onHoverRange","Button","ErrorMessage","useField","onFocus","onBlur","enableErrorMessage","AddSignalFormTabStyle","AddSignalFormTab","disableAddButton","setDisableAddButton","onAddSignal","newSignal","newSignalDelta","_signals","SelectBox","as","protoTypes","valuePath","instanceOf","valueSelectionTemplate","CouplingsTableStyle","errorStyle","CouplingsTable","_coupling","hasMissingCouplingValue","_error","colSpan","SignalFormTabStyle","SignalFormTab","textStyles","tabStylesAddition","SignalsForm","activeField","setActiveField","setFrequency","handleOnFocus","tapClickHandler","handleDeleteSignal","tabContainsErrors","signalFormTabs","signalTabs","addSignalTab","editSignalInfoText","addSignalInfoText","noSignals","noCouplings","EditRangeValidation","createSignalsError","missingCouplings","EditRangeModal","onSaveEditRangeModal","onCloseEditRangeModal","onZoomEditRangeModal","handleOnZoom","handleOnClose","getCouplings","couplings","getSignals","handleOnSave","formValues","initialStateSignals","counterJ","_multiplicity","isSaveButtonDisabled","errorKeys","validate","setSubmitting","selectBoxStyle","ActionsColumn","rowData","onHoverSignal","zoomRangeHandler","changeRangeSignalKindHandler","saveEditRangeHandler","editedRowData","closeEditRangeHandler","openEditRangeHandler","CENTER_RIGHT","tableMetaInfo","CouplingColumn","spanStyle","RangeAssignmentsColumn","onUnlinkVisibilityChange","unlinkVisibility","onLink","visibilityChangeHandler","spanCss","RangeColumn","RelativeColumn","integralVal","formattedValue","SignalAssignmentsColumn","tdCss","useFormat","keysPath","SignalDeltaColumn","rangeID","editStartHandler","RangesTableRow","onColumnEditStart","editFlags","relativeFlags","signalFlags","assignmentSignal","highlightSignal","unlinkRangeButtonVisibility","showUnlinkRangeButton","unlinkSignalButtonVisibility","showUnlinkSignalButton","getFormat","rowSpan","unlinkHandler","isOnRangeLevel","linkHandler","trCss","rowIndex","signalId","useMapRanges","_rangesData","tableStyle","RangesTable","onChangeKind","onEdit","toggleRelativeColumn","toggleSignalColumn","columnEditStartHandler","handleEditStart","sumButton","setShowMultiplicityTreesButton","RangesTablePanel","rangesData","isInView","getFilteredRanges","unlinkRangeHandler","saveJSONToClipboardHandler","dataToClipboard","rangesPreferences","contextMenu","filterHandler","SpectraWraper","SpectraPanelHeader","spectrums","showAllSpectrumsHandler","spectrumsPerTab","hideAllSpectrumsHandler","addMissingProjectionHandler","missingNucleus","SpectrumsData","setSameTopHandler","resetScaleHandler","getNucleusSum","additions","GroupByInfoKey","orderByNucleus","unorderedGroup","objectsByKeyValue","obj","ColorIndicator1D","activated","ColorIndicator2D","ColorIndicator","ShowHideMarkersButton","onChangeMarkersVisibility","markersVisible","isMarkerVisible","ShowHideSpectrumButton","onChangeVisibility","alignContent","SpectrumListItem","onChangeActiveSpectrum","onOpenSettingModal","formatValueAsHTML","borderLeft","pulse","FormikColorPicker","colorchangeHandler","presetColors","Spectrum2DHistogram","histogramData","prepareData","xAbsolute","xMinMaxValues","xHistogram","logBaseX","logBaseY","nbSlots","paddingTop","yAxis","markerStyle","displayGridLines","tickStyle","hidden","Spectrum1DSetting","SpectrumData","triggerSubmitHandler","Spectrum1DHistogram","FormikSlider","onAfterChange","ReactSlider","thumbClassName","trackClassName","renderThumb","valueNow","pearling","minDistance","existingMatrix","matrixMinMaxZ","matrixHistogram","Spectrum2DSetting","SpectrumSetting","arePropsEqual","SpectrumsTabs","onTabChange","setMarkersVisible","selectedSpectrumData","setSelectedSpectrum","settingModalPosition","setSettingModalPosition","isSettingModalDisplayed","setIsSettingModalDisplayed","visibleMarkers","spectrumsGroupByNucleus","groupByNucleus","handleChangeMarkersVisibility","newChecked","onTabChangeHandler","openSettingHandler","selectedSpectrum","nativeEvent","handleChangeVisibility","handleChangeActiveSpectrum","group","SpectrumListPanel","activeTabState","setSpectrums","ErrorColors","Errors","errorColor","Hybridizations","DefaultTolerance","C","H","N","F","Si","P","getLabelColor","correlationData","correlation","atomType","errorIndex","findSpectrum","_spectrum","experimentID","findSignal","findRangeOrZoneID","findRange","findZone","findSignalMatch2D","xDomain0","xDomain1","yDomain0","yDomain1","AdditionalColumnHeader","correlationsData","highlightIDsAdditionalColumn","pseudo","link","highlightAdditionalColumn","focus","tableHeaderProps","experimentType","equivalenceTextStyle","edited","equivalence","isInteger","AdditionalColumnField","rowCorrelation","columnCorrelation","commonLinks","isEdited","setIsEdited","highlightIDsCommonLinks","highlightCommonLinks","commonLink","onEditHandler","_rowCorrelation","lodashCloneDeep","_columnCorrelation","pseudoLinkCountHSQC","pseudoLinkID","pseudoExperimentID","pseudoCommonLink","buildLink","addLink","getCorrelationIndex","protonsCount","removeLink","commonLinkHSQC","linkSet","CorrelationTableRow","additionalColumnData","styleRow","styleLabel","onSaveEditEquivalences","onChangeHybridization","onSaveEditProtonsCount","onEditAdditionalColumnField","highlightIDsRow","highlightRow","onSaveEquivalencesHandler","onSaveProtonsCountHandler","additionalColumnFields","_correlation","_link","experimentLabel","onChangeHybridizationHandler","equivalenceCellStyle","tableDataProps","borderRight","hybridization","CorrelationTable","filteredCorrelationsData","editEquivalencesSaveHandler","changeHybridizationSaveHandler","editProtonsCountSaveHandler","editAdditionalColumnFieldSaveHandler","showProtonsAsRows","additionalColumnHeader","Overview","getAtomCounts","stateAtomType","errorColorIndex","complete","fontStyle","inputStyle","MolecularFormulaInput","previousMF","setMF","isValidMF","setIsValidMF","hasChanged","setHasChanged","checkMF","onSaveHandler","SetMolecularFormulaModal","onSaveHandlerMolecularFormulaInput","onSaveHandlerMoleculeSelection","onChangeHandlerMoleculeSelection","SetShiftToleranceModal","previousTolerance","setTolerance","inputFields","panelStyle","SummaryPanel","setAdditionalColumnData","selectedAdditionalColumnsAtomType","setSelectedAdditionalColumnsAtomType","setShowProtonsAsRows","atomTypesInView","getAtomType","findSignalMatch1D","otherAxis","_values","handleOnSetMolecularFormula","handleOnSetShiftTolerance","showSetMolecularFormulaModal","showSetShiftToleranceModal","additionalColumnTypes","columnTypes","columnType","_selectedAdditionalColumnsAtomType","valuesString","char","additionalColumnField","selection","ZonesPreferences","zonesPreferences","changeSignalKindHandler","deleteZoneHandler","zoomZoneHandler","xMargin","yMargin","showUnlinkButton","setShowUnlinkButton","SignalAssignmentsColumns","onHoverSignalX","onHoverSignalY","showUnlinkButtonSignalX","showUnlinkButtonSignalY","setShowUnlinkButtonSignalX","setShowUnlinkButtonSignalY","highlightSignalX","highlightSignalY","signalDeltaX","signalDeltaY","saveXHandler","zoneID","saveYHandler","ZoneAssignmentColumn","ZoneAssignmentsColumns","onHoverZoneX","onHoverZoneY","showUnlinkButtonZoneX","showUnlinkButtonZoneY","setShowUnlinkButtonZoneX","setShowUnlinkButtonZoneY","highlightZoneX","highlightZoneY","ZonesTableRow","ZonesTable","nuclei","ZonesPanel","xFrom","xTo","yFrom","yTo","getFilteredZones","unlinkZoneHandler","visibilityHandler","Table","TableBody","getVAlign","align","TableHeader","TableHead","FiltersWrapper","FiltersTableRow","selectedFilterID","setSelectedFilter","handelFilterCheck","handelDeleteFilter","filterType","filterSnapShotHandler","newID","prevId","TableRow","TableCell","FilterPanel","accordionItems","openWhen","hidePreferenceKey","RangesPanel","Panels","panelIndex","setSelectedPanelIndex","getDefaultIndex","ignoreActions","checkActionType","addRanges","computeFromTo","joinRanges","axisLabels","addZones","signalFormated","activeCoupling","getSDF","sdfFiles","NmrRecord","sdf","zipFiles","jsonData","nmrium","getSpectra","pathFile","parserResult","parseSDF","mixedEOL","handleUpdateCorrelations","buildCorrelationData","getActiveData","activeSpectrumIndex","activeData","getDomain","xArray","yArray","integralYDomain","_extent","integralResult","get2DDomain","spectrumsIDs","filteredData","setDomain","isYDomainChanged","originYDomains","setMode","nucluesToString","nuclues","getClosestNumber","goal","prev","curr","ZoomHistory","stack","pop","getLast","ZoomHistoryInstances","changeSpectrumVerticalAlignment","checkData","YAxisShift","setFilterChanges","selectedFilter","activeSpectrumId","getStrongestPeak","strongestPeakValue","spectrumIndex","resetTool","setDefaultTool","resetSelectedTool","filterOnly","getSpectrumID","hasAcceptedSpectrum","setMargin","Processing2DData","setDisplayerMode","setTabActiveSpectrum","dataGroupByTab","tabs2D","tabkeys","tabKey","nucleusLength","tabSpectra","tabSpectraLength","FTSpectrums","setTab","refresh","groupByTab","refreshTabActiveSpectrums","dataGroupByNucleus","currentTab","zoomHistory","getInstance","zoomValue","setDataBy1DFilter","changeIntegral","orignalDatum","integralIndex","handleChangeIntegralsRaltiveValue","changeIntegralsRealtive","newIntegralValue","addMolfile","fragments","getFragments","toMolfileV3","MoleculeManager","loadJDFFile","addJDFs","getRangeIndex","drfat","handleUnlinkRange","rangeIndex","cloneDeep","handleResizeRange","changeRange","handleAddRange","handleOnChangeRangesData","handleChangeRangeRaltiveValue","changeRangesRealtive","newRealtiveValue","add2dZoneHandler","drawnZone","get2DRange","detectZonesManual","shiftY","handleOnChangeZonesData","handleAutoZonesDetection","detectionOptions","detectZones","xError","yError","formattedZones","newXRange","newYRange","getZoneIndex","handleUnlinkZone","_zoneData","zoneIndex","setMoleculeHandler","_mol","molIndex","handleAutoPeakPicking","autOptions","autoPeakPicking","xyAutoPeaksPicking","newPeak","handleDeleteSpectraRanges","deleteSpectraAnalysis","MulitpleAnalysis","handleSetcolumns","setColumn","inputColumns","newColumns","outerAcc","spectraKey","newKey","isFormula","handleFiltercolumn","changeColumnValueKey","getReferenceShift","reference","xyCalibrate","checkIsVisible2D","setVisible","history","past","present","future","hasUndo","hasRedo","dispatchMiddleware","res","SpectraManager","nmredataToNmrium","predictionProton","spectrumReducer","innerSpectrumReducer","actionType","initiate","LoadActions","setIsLoading","handleLoadJsonFile","actions","loadJcampFile","handleLoadMOLFile","handleLoadZIPFile","handleLoadNmredata","addPeak","candidatePeak","PeaksActions","addPeaks","datumOriginal","deletePeak","peakData","peakIndex","addIntegral","IntegralsActions","deleteIntegral","handleChangeIntegralZoom","handleChangeIntegralSum","setOriginalDomain","DomainActions","setXDomain","setYDomain","setWidth","handleSetDimensions","setSelectedTool","ToolsActions","setSelectedOptionPanel","zoomOut","shiftSpectrumAlongXAxis","FiltersActions","applyZeroFillingFilter","applyFFTFilter","applyManualPhaseCorrectionFilter","applyAutoPhaseCorrectionFilter","applyAbsoluteFilter","calculateManualPhaseCorrection","update2dShift","deleteSpectraFilter","filterSnapshotHandler","handleMultipleSpectraFilter","handleSpectrumVisibility","IDs","SpectrumsActions","handleChangePeaksMarkersVisibility","refreshDomain","newIndex","oldIndex","newActiveSpectrum","handleChangeSpectrumColor","changeSpectrumSetting","alignSpectraHandler","handleToggleRealImaginaryVisibility","setSpectraSameTopHandler","resetSpectraScale","handleChangeSpectrumDisplayMode","addMoleculeHandler","MoleculeActions","deleteMoleculeHandler","moleculeIndex","predictSpectraFromMolculeHandler","signalsToXY","handleSetMF","CorrelationsActions","handleSetTolerance","handleSetCorrelation","setCorrelation","handleSetCorrelations","handleDeleteSpectra","handleChangeIntegralYDomain","handleBrushEnd","is2D","xScale","yScale","domainX","brushHistory","setVerticalIndicatorXPosition","setSpectrumsVerticalAlign","ZonesActions","handleAutoRangesDetection","RangesActions","handleDeleteRange","handleChangeRangeSum","handleChangeRangeSignalValue","changeRangeSignal","newSignalValue","handleChangeRangeSignalKind","handleSaveEditedRange","_editedRowData","handleSetDiaIDRange","handelSetPreferences","panelsPreferences","handelSetActiveTab","handleAddBaseLineZone","handleDeleteBaseLineZone","handleAddExclusionZone","newExclusionZone","handleDeleteExclusionZone","handleBaseLineCorrectionFilter","xDomainSnapshot","setKeyPreferencesHandler","spectrumsGroupsList","applyKeyPreferencesHandler","datumID","processController","levelChangeHandler","handleDeleteZone","addMissingProjectionHander","handelResetDomain","changeZoneSignalDelta","changeZoneSignal","originalSignal","handleChangeZoneSignalKind","_zone","handleSetDiaIDZone","SpectraAanalysisActions","handleResizeSpectraRange","handleHistoryUndo","newPast","newfuture","handleHistoryRedo","newPresent","handleHistoryReset","setIsOverDisplayer","GlobalActions","ToolBarWrapper","spectrumsCount","allowedExtensions","LoadJCAMPModal","onLoadClick","startLoading","pathReft","loadJCAMPHandler","extractFileMetaFromPath","loadFile","onLoadButtonClick","IMPORT_MENU","EXPORT_MENU","BasicToolBar","selectedSpectrumInfo","LoadJacmpHandler","startLoadingHandler","importJCAMPFile","isButtonVisible","importFromFileSystemHandler","ImportHandler","activeStyles","helpID","setActive","toggleButton","_isActive","displayName","onValueReady","ToggleButtonGroup","toggleButtons","setToggleButtons","handleOnChange","toggles","_child","FunctionToolBar","setOption","selectedOption","handleOnFFTFilter","ToolBar","splitPaneStyles","resizer","pane","containerStyles","NMRium","dataProp","onDataChange","docsBaseUrl","useToggle","useFullscreen","isRightPanelHide","hideRightPanel","isResizeEventStart","setResizeEventStart","helpList","helpData","setHelpData","preferencesState","dispatchPreferences","dispatchMiddleWare","setBaseUrl","newBaseUrl","handleSplitPanelDragFinished","rightPanelHandler","prevFlag","preventContextMenuHandler","resizerStyle","paneStyle","pane1Style","defaultSize","minSize","onDragFinished","onResizerDoubleClick","onDragStarted","hideExclusionZonesTool"],"mappings":"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","file":"static/js/1.6eebc4bd.chunk.js","sourcesContent":["import {\n  createContext,\n  useReducer,\n  useMemo,\n  useContext,\n  useCallback,\n  useEffect,\n} from 'react';\n\nexport const TYPES = {\n  PEAK: 'PEAK',\n  INTEGRAL: 'INTEGRAL',\n  RANGE: 'RANGE',\n  ZONE: 'ZONE',\n  EXCLUSION_ZONE: 'EXCLUSION_ZONE',\n};\n\nconst highlightContext = createContext();\n\nfunction highlightReducer(state, action) {\n  switch (action.type) {\n    case 'SHOW': {\n      const { convertedHighlights, type } = action.payload;\n      const newState = {\n        ...state,\n        highlights: { ...state.highlights },\n        type,\n      };\n      for (const value of convertedHighlights) {\n        if (!(value in newState.highlights)) {\n          newState.highlights[value] = 1;\n        }\n      }\n      newState.highlighted = Object.keys(newState.highlights);\n\n      return newState;\n    }\n    case 'HIDE': {\n      const { convertedHighlights } = action.payload;\n\n      const newState = {\n        ...state,\n        highlights: { ...state.highlights },\n        type: null,\n      };\n      for (const value of convertedHighlights) {\n        if (value in newState.highlights) {\n          delete newState.highlights[value];\n        }\n      }\n      newState.highlighted = Object.keys(newState.highlights);\n      return newState;\n    }\n    case 'SET_PERMANENT': {\n      const newState = {\n        ...state,\n        // allow just one permanent highlights group at same time\n        highlightedPermanently: action.payload,\n      };\n\n      return newState;\n    }\n    case 'UNSET_PERMANENT': {\n      const newState = {\n        ...state,\n        highlightedPermanently: [],\n      };\n\n      return newState;\n    }\n    default: {\n      throw new Error(`unknown action type: ${action.type}`);\n    }\n  }\n}\n\nconst emptyState = {\n  highlights: {},\n  highlighted: [],\n  highlightedPermanently: [],\n  type: null,\n};\n\nexport function HighlightProvider(props) {\n  const [highlight, dispatch] = useReducer(highlightReducer, emptyState);\n  const contextValue = useMemo(() => ({ highlight, dispatch }), [highlight]);\n  return (\n    <highlightContext.Provider value={contextValue}>\n      {props.children}\n    </highlightContext.Provider>\n  );\n}\n\nexport function useHighlightData() {\n  return useContext(highlightContext);\n}\n\nexport function useHighlight(highlights, type = null) {\n  if (!Array.isArray(highlights)) {\n    throw new Error('highlights must be an array');\n  }\n\n  const context = useHighlightData();\n\n  const convertedHighlights = useMemo(() => {\n    const newHighlights = [];\n    for (const highlight of highlights) {\n      if (typeof highlight !== 'string' && typeof highlight !== 'number') {\n        throw new Error(`highlight key must be a string or number`);\n      }\n      if (highlight !== '') {\n        newHighlights.push(String(highlight));\n      }\n    }\n    return newHighlights;\n  }, [highlights]);\n\n  useEffect(() => {\n    // if deletion of component then also delete its highlight information -> componentWillUnmount\n    return () => {\n      context.dispatch({\n        type: 'HIDE',\n        payload: { convertedHighlights },\n      });\n      context.dispatch({\n        type: 'UNSET_PERMANENT',\n      });\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  const isActive = useMemo(() => {\n    return context.highlight.highlighted.some((key) =>\n      convertedHighlights.includes(key),\n    );\n  }, [context.highlight.highlighted, convertedHighlights]);\n\n  const isActivePermanently = useMemo(() => {\n    return context.highlight.highlightedPermanently.some((key) =>\n      convertedHighlights.includes(key),\n    );\n  }, [context.highlight.highlightedPermanently, convertedHighlights]);\n\n  const show = useCallback(() => {\n    context.dispatch({\n      type: 'SHOW',\n      payload: {\n        convertedHighlights,\n        type,\n      },\n    });\n  }, [context, convertedHighlights, type]);\n\n  const hide = useCallback(() => {\n    context.dispatch({\n      type: 'HIDE',\n      payload: {\n        convertedHighlights,\n      },\n    });\n  }, [context, convertedHighlights]);\n\n  const add = useCallback(\n    (id) => {\n      context.dispatch({\n        type: 'SHOW',\n        payload: { convertedHighlights: [], id },\n      });\n    },\n    [context],\n  );\n\n  const remove = useCallback(\n    (id) => {\n      context.dispatch({\n        type: 'HIDE',\n        payload: { convertedHighlights: [], id },\n      });\n    },\n    [context],\n  );\n\n  const click = useCallback(\n    (e) => {\n      if (e) {\n        e.preventDefault();\n        e.stopPropagation();\n      }\n\n      if (!isActivePermanently) {\n        context.dispatch({\n          type: 'SET_PERMANENT',\n          payload: convertedHighlights,\n        });\n      } else {\n        context.dispatch({\n          type: 'UNSET_PERMANENT',\n        });\n      }\n    },\n    [context, convertedHighlights, isActivePermanently],\n  );\n\n  const onHover = {\n    onMouseEnter: show,\n    onMouseLeave: hide,\n  };\n\n  const onClick = {\n    onClick: click,\n  };\n\n  return {\n    isActive,\n    show,\n    hide,\n    onHover,\n    onClick,\n    isActivePermanently,\n    click,\n    add,\n    remove,\n  };\n}\n","/* eslint-disable default-param-last */\nimport { saveAs } from 'file-saver';\nimport JSZip from 'jszip';\n\nfunction copyFormattedHtml(html) {\n  // Create an iframe (isolated container) for the HTML\n  let container = document.createElement('div');\n  container.innerHTML = html;\n\n  // Hide element\n  container.style.position = 'fixed';\n  container.style.pointerEvents = 'none';\n  container.style.opacity = 0;\n\n  // Detect all style sheets of the page\n  let activeSheets = Array.prototype.slice\n    .call(document.styleSheets)\n    .filter(function (sheet) {\n      return !sheet.disabled;\n    });\n\n  // Mount the iframe to the DOM to make `contentWindow` available\n  document.body.appendChild(container);\n\n  // Copy to clipboard\n  window.getSelection().removeAllRanges();\n\n  let range = document.createRange();\n  range.selectNode(container);\n  window.getSelection().addRange(range);\n\n  document.execCommand('copy');\n  for (let i = 0; i < activeSheets.length; i++) {\n    activeSheets[i].disabled = true;\n  }\n  document.execCommand('copy');\n  for (let i = 0; i < activeSheets.length; i++) {\n    activeSheets[i].disabled = false;\n  }\n\n  // Remove the iframe\n  document.body.removeChild(container);\n}\n\nasync function copyHTMLToClipboard(data) {\n  try {\n    copyFormattedHtml(data);\n    return true;\n  } catch (err) {\n    return false;\n  }\n}\nasync function copyTextToClipboard(data) {\n  try {\n    await navigator.clipboard.writeText(data);\n    return true;\n  } catch (err) {\n    return false;\n  }\n}\n/**\n * export the experiments result in JSON format\n * @param {*} data\n */\nasync function exportAsJSON(\n  data,\n  fileName = 'experiment',\n  spaceIndent = 0,\n  isCompressed = false,\n) {\n  const fileData = JSON.stringify(\n    data,\n    (key, value) => (ArrayBuffer.isView(value) ? Array.from(value) : value),\n    spaceIndent,\n  );\n  if (!isCompressed) {\n    const blob = new Blob([fileData], { type: 'text/plain' });\n    saveAs(blob, `${fileName}.nmrium`);\n  } else {\n    try {\n      const zip = new JSZip();\n      zip.file(`${fileName}.nmrium`, fileData);\n      const blob = await zip.generateAsync({\n        type: 'blob',\n        compression: 'DEFLATE',\n        compressionOptions: {\n          level: 9,\n        },\n      });\n      saveAs(blob, `${fileName}.nmrium`);\n    } catch (e) {\n      // eslint-disable-next-line no-console\n      console.log(e);\n    }\n  }\n}\n\nfunction exportAsMatrix(data, options, fileName = 'experiment') {\n  // eslint-disable-next-line no-unused-vars\n  const { from, to, nbPoints } = options;\n\n  //columns labels\n  const columnsLables = ['name', 'experiment'];\n  for (const value of data[0].data.x) {\n    columnsLables.push(value);\n  }\n  let matrix = `${columnsLables.join('\\t')}\\n`;\n\n  for (const spectrum of data) {\n    const {\n      data: { re },\n      info: { experiment },\n      display: { name },\n    } = spectrum;\n    const cellsValues = [name, experiment];\n    for (const value of re) {\n      cellsValues.push(value);\n    }\n    matrix += `${cellsValues.join('\\t')}\\n`;\n  }\n\n  const blob = new Blob([matrix], { type: 'text/tab-separated-values' });\n  saveAs(blob, `${fileName}.tsv`);\n}\n\nfunction exportAsNMRE(data, fileName = 'experiment') {\n  data.generateAsync({ type: 'blob' }).then((content) => {\n    saveAs(content, `${fileName}.nmredata`);\n  });\n}\n\nfunction exportAsMol(data, fileName = 'mol') {\n  const blob = new Blob([data], { type: 'text/plain' });\n  saveAs(blob, `${fileName}.mol`);\n}\n/**\n * export the vitalization result as SVG, if you need to remove some content during exportation process enclose the the content with <!-- export-remove --> ${content} <!-- export-remove -->\n */\nfunction exportAsSVG(fileName = 'experiment', elementID) {\n  const { blob } = getBlob(elementID);\n  saveAs(blob, `${fileName}.svg`);\n}\n\nfunction exportAsPng(fileName = 'experiment', elementID) {\n  const { blob, width, height } = getBlob(elementID);\n  try {\n    let canvas = document.createElement('canvas');\n    canvas.width = width;\n    canvas.height = height;\n    let context = canvas.getContext('2d');\n    context.fillStyle = 'white';\n    context.fillRect(0, 0, canvas.width, canvas.height);\n    let img = new Image();\n    let url = URL.createObjectURL(blob);\n    img.onload = async function () {\n      context.drawImage(img, 0, 0);\n      let png = canvas.toDataURL('image/png', 1);\n      saveAs(png, `${fileName}.png`);\n      URL.revokeObjectURL(png);\n    };\n    img.src = url;\n  } catch (e) {\n    // eslint-disable-next-line no-console\n    console.log(e);\n  }\n}\n\nfunction copyDataURLCliboard(image) {\n  const img = document.createElement('img');\n  img.src = image;\n\n  img.style.position = 'fixed';\n  img.style.pointerEvents = 'none';\n  img.style.opacity = 0;\n\n  document.body.appendChild(img);\n  const range = document.createRange();\n  range.selectNode(img);\n  window.getSelection().addRange(range);\n  document.execCommand('Copy');\n  document.body.removeChild(img);\n}\n\nfunction copyBlobToCliboard(canvas) {\n  canvas.toBlob((b) => {\n    //eslint-disable-next-line no-undef\n    const clip = new ClipboardItem({\n      [b.type]: b,\n    });\n    navigator.clipboard.write([clip]).then(\n      () => {\n        // eslint-disable-next-line no-console\n        console.log('experiment copied.');\n      },\n      (err) => {\n        // eslint-disable-next-line no-console\n        console.log(err);\n      },\n    );\n  });\n}\n\nfunction copyPNGToClipboard(elementID) {\n  const { blob, width, height } = getBlob(elementID);\n  try {\n    let canvas = document.createElement('canvas');\n    canvas.width = width;\n    canvas.height = height;\n    let context = canvas.getContext('2d');\n    context.fillStyle = 'white';\n    context.fillRect(0, 0, canvas.width, canvas.height);\n    let img = new Image();\n    const url = URL.createObjectURL(blob);\n    img.onload = async function () {\n      context.drawImage(img, 0, 0);\n      const png = canvas.toDataURL('image/png', 1);\n      if (navigator.clipboard.write) {\n        copyBlobToCliboard(canvas);\n      } else {\n        copyDataURLCliboard(png);\n      }\n\n      URL.revokeObjectURL(png);\n    };\n    img.src = url;\n  } catch (e) {\n    if (e instanceof ReferenceError) {\n      // eslint-disable-next-line no-alert\n      alert(\n        'Your browser does not support this feature, please use Google Chrome',\n      );\n    }\n    // eslint-disable-next-line no-console\n    console.log(e);\n  }\n}\n\nfunction getBlob(elementID) {\n  // nmrSVG\n  let _svg = document.getElementById(elementID).cloneNode(true);\n  const width = _svg.getAttribute('width').replace('px', '');\n  const height = _svg.getAttribute('height').replace('px', '');\n  _svg\n    .querySelectorAll('[data-no-export=\"true\"]')\n    .forEach((element) => element.remove());\n  const head = `<svg class=\"nmr-svg\"  viewBox='0 0 ${width} ${height}' width=\"${width}\"  height=\"${height}\"  version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\">`;\n  const style = `<style>.grid line,.grid path{stroke:none;} .peaks-text{fill:#730000} .x path{stroke-width:1px} .x text{\n    font-size: 12px;\n    font-weight: bold;\n  } \n \n  .nmr-svg,.contours{\n    background-color:white;\n    fill:white;\n  }\n  \n\n  \n  </style>`;\n  const svg = `${head + style + _svg.innerHTML}</svg>`;\n  const blob = new Blob([svg], { type: 'image/svg+xml' });\n  return { blob, width, height };\n}\n\nexport {\n  exportAsSVG,\n  exportAsJSON,\n  exportAsNMRE,\n  exportAsPng,\n  copyPNGToClipboard,\n  copyTextToClipboard,\n  copyHTMLToClipboard,\n  exportAsMol,\n  exportAsMatrix,\n};\n","export default function checkModifierKeyActivated(event) {\n  const modifiersKeys = [\n    'Alt',\n    'AltGraph',\n    'CapsLock',\n    'Control',\n    'Meta',\n    'NumLocK',\n    'ScrollLock',\n    'Shift',\n    'OS',\n  ];\n  for (const key of modifiersKeys) {\n    if (event.getModifierState(key)) {\n      return true;\n    }\n  }\n  return false;\n}\n","import lodashDebounce from 'lodash/debounce';\nimport lodashMap from 'lodash/map';\nimport {\n  createContext,\n  useCallback,\n  useEffect,\n  useReducer,\n  useState,\n} from 'react';\n\nexport const BrushContext = createContext();\n\nconst initialState = {\n  step: 'initial',\n  brush: {\n    start: null,\n    end: null,\n  },\n};\n\nlet debounceClickEvents = [];\n\nexport function BrushTracker({\n  children,\n  className,\n  style,\n  onBrush,\n  onZoom,\n  onDoubleClick,\n  onClick,\n  noPropagation,\n}) {\n  const [state, dispatch] = useReducer(reducer, initialState);\n  const [mouseDownTime, setMouseDownTime] = useState();\n\n  const mouseDownHandler = useCallback(\n    (event) => {\n      if (event.button === 0) {\n        if (noPropagation) {\n          event.stopPropagation();\n        }\n        dispatch({\n          type: 'DOWN',\n          shiftKey: event.shiftKey,\n          altKey: event.altKey,\n          screenX: event.screenX,\n          screenY: event.screenY,\n          clientX: event.clientX,\n          clientY: event.clientY,\n          boundingRect: event.currentTarget.getBoundingClientRect(),\n        });\n\n        setMouseDownTime(event.timeStamp);\n      }\n      return false;\n    },\n    [noPropagation],\n  );\n\n  const clickHandler = useCallback(\n    (e) => {\n      e.persist();\n      const timeStamp = e.timeStamp;\n      const boundingRect = e.currentTarget.getBoundingClientRect();\n      const x = e.clientX - boundingRect.x;\n      const y = e.clientY - boundingRect.y;\n\n      const callback = lodashDebounce(() => {\n        if (\n          timeStamp - mouseDownTime <= 150 &&\n          debounceClickEvents.length === 1\n        ) {\n          onClick({ ...e, x, y });\n        }\n        debounceClickEvents = [];\n      }, 200);\n      debounceClickEvents.push(callback);\n\n      callback();\n\n      if (debounceClickEvents.length > 1) {\n        lodashMap(debounceClickEvents, (debounce) => debounce.cancel());\n        debounceClickEvents = [];\n        onDoubleClick({ ...e, x, y });\n      }\n    },\n    [mouseDownTime, onClick, onDoubleClick],\n  );\n\n  const handleMouseWheel = useCallback(\n    (event) => {\n      const boundingRect = event.currentTarget.getBoundingClientRect();\n      const x = event.clientX - boundingRect.x;\n      const y = event.clientY - boundingRect.y;\n\n      const { deltaY, deltaX, shiftKey, deltaMode } = event;\n      onZoom({ deltaY: deltaY || deltaX, shiftKey, deltaMode, x, y });\n    },\n    [onZoom],\n  );\n\n  useEffect(() => {\n    const { step, startX, endX } = state;\n    if (step === 'end' && Math.abs(startX - endX) > 5) {\n      onBrush(state);\n      dispatch({\n        type: 'DONE',\n      });\n    }\n  }, [onBrush, state]);\n\n  const moveCallback = useCallback((event) => {\n    dispatch({\n      type: 'MOVE',\n      screenX: event.screenX,\n      screenY: event.screenY,\n      clientX: event.clientX,\n      clientY: event.clientY,\n    });\n  }, []);\n\n  const upCallback = useCallback((event) => {\n    dispatch({\n      type: 'UP',\n      clientX: event.clientX,\n      clientY: event.clientY,\n    });\n    return false;\n  }, []);\n\n  return (\n    <BrushContext.Provider value={state}>\n      <div\n        className={className}\n        style={style}\n        onMouseDown={mouseDownHandler}\n        onMouseUp={upCallback}\n        onMouseMove={moveCallback}\n        onClick={clickHandler}\n        onWheel={handleMouseWheel}\n      >\n        {children}\n      </div>\n    </BrushContext.Provider>\n  );\n}\n\nBrushTracker.defaultProps = {\n  onBrush: () => null,\n  onZoom: () => null,\n  onDoubleClick: () => null,\n  onClick: () => null,\n};\n\nfunction reducer(state, action) {\n  switch (action.type) {\n    case 'UP':\n      if (state.step === 'brushing' || state.step === 'start') {\n        const { clientX, clientY } = action;\n\n        return {\n          ...state,\n          endX: clientX - state.boundingRect.x,\n          endY: clientY - state.boundingRect.y,\n\n          step: state.step === 'start' ? 'initial' : 'end',\n        };\n      }\n      return state;\n    case 'DOWN':\n      if (state.step === 'initial' || state.step === 'end') {\n        const {\n          screenX,\n          screenY,\n          clientX,\n          clientY,\n          boundingRect,\n          shiftKey,\n          altKey,\n        } = action;\n        const x = clientX - boundingRect.x;\n        const y = clientY - boundingRect.y;\n\n        return {\n          ...state,\n          shiftKey,\n          altKey,\n          startX: x,\n          startY: y,\n          startScreenX: screenX,\n          startScreenY: screenY,\n          startClientX: clientX,\n          startClientY: clientY,\n          boundingRect,\n          step: 'start',\n        };\n      }\n      return state;\n    case 'MOVE':\n      if (state.step === 'start' || state.step === 'brushing') {\n        const { clientX, clientY } = action;\n\n        return {\n          ...state,\n          step: 'brushing',\n          endX: clientX - state.boundingRect.x,\n          endY: clientY - state.boundingRect.y,\n        };\n      }\n      return state;\n    case 'DONE':\n      if (state.step === 'end') {\n        return {\n          ...state,\n          step: 'initial',\n        };\n      }\n      break;\n    default:\n      return state;\n  }\n}\n","import { createContext, useCallback, useState, useContext } from 'react';\n\nexport const MouseContext = createContext();\nconst MouseaProvider = MouseContext.Provider;\n\nexport function useMouseTracker() {\n  return useContext(MouseContext);\n}\n\nexport function MouseTracker({ children, className, style, noPropagation }) {\n  const [mouseTrackerState, setMouseTrackerState] = useState(null);\n  const mouseMoveHandler = useCallback(\n    (e) => {\n      const boundingRect = e.currentTarget.getBoundingClientRect();\n      const x = e.clientX - boundingRect.x;\n      const y = e.clientY - boundingRect.y;\n      setMouseTrackerState({ x, y });\n      if (noPropagation) {\n        e.stopPropagation();\n      }\n    },\n    [noPropagation],\n  );\n\n  const mouseLeaveHandler = useCallback(\n    (e) => {\n      setMouseTrackerState(null);\n      if (noPropagation) {\n        e.stopPropagation();\n      }\n    },\n    [noPropagation],\n  );\n\n  return (\n    <MouseaProvider value={mouseTrackerState}>\n      <div\n        className={className}\n        style={style}\n        onMouseMove={mouseMoveHandler}\n        onMouseLeave={mouseLeaveHandler}\n      >\n        {children}\n      </div>\n    </MouseaProvider>\n  );\n}\n","import { createContext, useContext } from 'react';\n\nexport const ChartContext = createContext();\n\nexport const ChartDataProvider = ChartContext.Provider;\n\nexport function useChartData() {\n  return useContext(ChartContext);\n}\n","import { createContext, useContext } from 'react';\n\nexport const dispatchContext = createContext();\n\nexport const DispatchProvider = dispatchContext.Provider;\n\nexport function useDispatch() {\n  return useContext(dispatchContext);\n}\n","import { createContext, useContext } from 'react';\n\nexport const PreferencesConext = createContext();\n\nexport const PreferencesProvider = PreferencesConext.Provider;\n\nexport function usePreferences() {\n  return useContext(PreferencesConext);\n}\n","import { createContext, useContext } from 'react';\n\nexport const scaleContext = createContext();\n\nexport const ScaleProvider = scaleContext.Provider;\n\nexport function useScale() {\n  return useContext(scaleContext);\n}\n","export const positions = {\n  TOP_LEFT: 'top left',\n  TOP_CENTER: 'top center',\n  TOP_RIGHT: 'top right',\n  MIDDLE_LEFT: 'middle left',\n  MIDDLE: 'middle',\n  MIDDLE_RIGHT: 'middle right',\n  BOTTOM_LEFT: 'bottom left',\n  BOTTOM_CENTER: 'bottom center',\n  BOTTOM_RIGHT: 'bottom right',\n};\n\nexport const types = {\n  INFO: 'info',\n  SUCCESS: 'success',\n  ERROR: 'error',\n  PROGRESS_INDICATOR: 'progress_indicator',\n};\n\nexport const transitions = {\n  FADE: 'fade',\n  SCALE: 'scale',\n  SLIDE_RIGHT: 'slide_right',\n  SLIDE_LEFT: 'slide_left',\n  SLIDE_TOP: 'slide_top',\n  SLIDE_BOTTOM: 'slide_bottom',\n};\n","import { createContext, useContext } from 'react';\n\nconst ModalContext = createContext();\nexport const ModalProvider = ModalContext.Provider;\n\nexport const useModal = () => {\n  return useContext(ModalContext);\n};\n","import { useEffect, useCallback } from 'react';\n\nconst styles = {\n  outerContainer: {\n    position: 'fixed',\n    top: 0,\n    right: 0,\n    bottom: 0,\n    left: 0,\n    backgroundColor: 'rgba(255,255,255,0.8)',\n    display: 'flex',\n    justifyContent: 'center',\n    alignItems: 'center',\n    zIndex: 1,\n  },\n  innerContainer: {\n    boxSizing: 'initial',\n    backgroundColor: '#fff',\n    boxShadow: '0 0 0 0, 0 8px 16px rgba(0,0,0,.30)',\n    display: 'flex',\n    flexDirection: 'column',\n    minWidth: '300px',\n    minHeight: '140px',\n    justifyContent: 'space-between',\n    borderRadius: '5px',\n  },\n};\n\nconst Modal = ({ children, open, onClose, style }) => {\n  const handleClose = useCallback(\n    (e) => {\n      onClose(e);\n    },\n    [onClose],\n  );\n\n  useEffect(() => {\n    if (open === false) {\n      handleClose();\n    }\n  }, [handleClose, open]);\n\n  return (\n    open && (\n      <div style={styles.outerContainer} onClick={handleClose}>\n        <div\n          style={{ ...styles.innerContainer, ...style }}\n          onClick={(e) => {\n            e.preventDefault();\n            e.stopPropagation();\n          }}\n        >\n          {children}\n        </div>\n      </div>\n    )\n  );\n};\n\nModal.defaultProps = {\n  onClose: function () {\n    return null;\n  },\n  open: false,\n};\n\nexport default Modal;\n","import { useRef } from 'react';\nimport { Transition as ContainerTransition } from 'react-transition-group';\n\nimport { transitions } from './options';\n\nconst duration = 250;\n\nconst defaultStyle = {\n  [transitions.FADE]: {\n    transition: `opacity ${duration}ms ease`,\n    opacity: 0,\n  },\n  [transitions.SCALE]: {\n    transform: 'scale(1)',\n    transition: `all ${duration}ms ease-in-out`,\n  },\n};\n\nconst defaultTransitionStyles = {\n  [transitions.FADE]: {\n    entering: { opacity: 0 },\n    entered: { opacity: 1 },\n  },\n  [transitions.SCALE]: {\n    entering: { transform: 'scale(0)' },\n    entered: { transform: 'scale(1)' },\n    exiting: { transform: 'scale(0)' },\n    exited: { transform: 'scale(1)' },\n  },\n};\n\nconst Transtion = ({ children, type, transitionStyles, ...props }) => {\n  const ref = useRef(null);\n  return (\n    <ContainerTransition nodeRef={ref} {...props} timeout={duration}>\n      {(state) => (\n        <div\n          ref={ref}\n          style={{\n            ...defaultStyle[type],\n            ...transitionStyles[type][state],\n            ...transitionStyles.default,\n          }}\n        >\n          {children}\n        </div>\n      )}\n    </ContainerTransition>\n  );\n};\n\nTranstion.defaultProps = {\n  transitionStyles: defaultTransitionStyles,\n};\n\nexport default Transtion;\n","import { useMemo } from 'react';\n\nimport { positions } from './options';\n\nexport const getStyles = (position, props) => {\n  const initialStyles = {\n    // left: 0,\n    position: 'fixed',\n    display: 'flex',\n    justifyContent: 'center',\n    alignItems: 'center',\n    flexDirection: 'column',\n    // width: '100%',\n    pointerEvents: 'none',\n    overflow: 'visible',\n    ...(props.containerStyle\n      ? {\n          top: `${props.containerStyle.top}px`,\n          left: `${props.containerStyle.left}px`,\n          height: `${props.containerStyle.height}px`,\n          width: `${props.containerStyle.width}px`,\n        }\n      : { width: '100%', height: '100%' }),\n  };\n\n  switch (position) {\n    case positions.TOP_LEFT:\n      return {\n        ...initialStyles,\n        // top: 0,\n        justifyContent: 'flex-start',\n        alignItems: 'flex-start',\n      };\n    case positions.TOP_CENTER:\n      return {\n        ...initialStyles,\n        justifyContent: 'flex-start',\n\n        // top: 0,\n      };\n    case positions.TOP_RIGHT:\n      return {\n        ...initialStyles,\n        // top: 0,\n        justifyContent: 'flex-start',\n        alignItems: 'flex-end',\n      };\n    case positions.MIDDLE_LEFT:\n      return {\n        ...initialStyles,\n        // top: '50%',\n        justifyContent: 'center',\n        alignItems: 'flex-start',\n      };\n    case positions.MIDDLE: {\n      return {\n        ...initialStyles,\n        // top: '50%',\n        justifyContent: 'center',\n      };\n    }\n    case positions.MIDDLE_RIGHT:\n      return {\n        ...initialStyles,\n        // top: '50%',\n        justifyContent: 'center',\n\n        alignItems: 'flex-end',\n      };\n\n    case positions.BOTTOM_LEFT:\n      return {\n        ...initialStyles,\n        // bottom: 0,\n        justifyContent: 'flex-end',\n\n        alignItems: 'flex-start',\n      };\n    case positions.BOTTOM_CENTER:\n      return {\n        ...initialStyles,\n        // bottom: 0,\n        justifyContent: 'flex-end',\n      };\n    case positions.BOTTOM_RIGHT:\n      return {\n        ...initialStyles,\n        // bottom: 0,\n        justifyContent: 'flex-end',\n\n        alignItems: 'flex-end',\n      };\n\n    default: {\n      return initialStyles;\n    }\n  }\n};\n\nfunction Wrapper({ children, options: { position }, ...props }) {\n  const styles = useMemo(() => getStyles(position, props), [position, props]);\n\n  return (\n    children.length > 0 && (\n      <div style={styles} {...props}>\n        {children}\n      </div>\n    )\n  );\n}\n\nexport default Wrapper;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport PropTypes from 'prop-types';\nimport { useCallback } from 'react';\n\nconst styles = css`\n  display: flex;\n  flex-direction: column;\n  border-top: 10px solid #ed0000;\n  flex: 1;\n  border-radius: 5px;\n\n  .message {\n    font-weight: bold;\n    font-size: 14px;\n    text-align: center;\n    color: #af0000;\n    text-align: center;\n    padding: 35px;\n    flex: 1;\n  }\n  .buttons-container {\n    display: flex;\n    align-items: flex-end;\n    justify-content: flex-end;\n    padding: 5px;\n    border-top: 1px solid #efefef;\n\n    button:first-of-type {\n      border-radius: 5px 0 0 5px;\n      border-weight: 0 1px 0 0;\n    }\n    button:last-child {\n      border-radius: 0px 5px 5px 0px;\n      border-weight: 0 0 0 1px;\n    }\n    button {\n      border: 1px solid #dcdcdc;\n      background-color: white;\n      display: inline-block;\n      cursor: pointer;\n      color: #363636;\n      font-weight: bold;\n      padding: 6px 24px;\n      text-decoration: none;\n    }\n    button:hover {\n      background: -webkit-gradient(\n        linear,\n        left top,\n        left bottom,\n        color-stop(0.05, #f6f6f6),\n        color-stop(1, #ffffff)\n      );\n      background: -moz-linear-gradient(top, #f6f6f6 5%, #ffffff 100%);\n      background: -webkit-linear-gradient(top, #f6f6f6 5%, #ffffff 100%);\n      background: -o-linear-gradient(top, #f6f6f6 5%, #ffffff 100%);\n      background: -ms-linear-gradient(top, #f6f6f6 5%, #ffffff 100%);\n      background: linear-gradient(to bottom, #f6f6f6 5%, #ffffff 100%);\n      filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#f6f6f6', endColorstr='#ffffff',GradientType=0);\n      background-color: #f6f6f6;\n    }\n  }\n`;\n\nconst ConfirmationDialog = ({ style, buttons, onClose, message }) => {\n  const optionsHandler = useCallback(\n    (e, { handler = () => null }) => {\n      handler(e);\n      onClose();\n    },\n    [onClose],\n  );\n\n  return (\n    <div style={style} css={styles}>\n      <p className=\"message\">{message}</p>\n      <div className=\"buttons-container\">\n        {buttons.map((option) => (\n          <button\n            key={option.text}\n            type=\"button\"\n            onClick={(e) => optionsHandler(e, option)}\n            style={option.style && option.style}\n          >\n            {option.text}\n          </button>\n        ))}\n      </div>\n    </div>\n  );\n};\n\nConfirmationDialog.defaultProps = {\n  buttons: [],\n  style: {},\n};\n\nConfirmationDialog.propTypes = {\n  style: PropTypes.object,\n  buttons: PropTypes.arrayOf(\n    PropTypes.shape({\n      handler: PropTypes.func,\n      text: PropTypes.string,\n      style: PropTypes.object,\n    }),\n  ),\n};\n\nexport default ConfirmationDialog;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport {\n  useRef,\n  useState,\n  useEffect,\n  useCallback,\n  Fragment,\n  cloneElement,\n  useMemo,\n} from 'react';\nimport { createPortal } from 'react-dom';\nimport { Rnd } from 'react-rnd';\nimport { TransitionGroup } from 'react-transition-group';\n\nimport Transition from '../Transition';\nimport Wrapper from '../Wrapper';\nimport { positions, transitions } from '../options';\n\nimport ConfirmDialog from './ConfirmDialog';\nimport { ModalProvider } from './Context';\n\nconst transitionStyles = {\n  [transitions.FADE]: {\n    entering: { opacity: 0 },\n    entered: { opacity: 1 },\n  },\n  [transitions.SCALE]: {\n    entering: { transform: 'scale(0)' },\n    entered: { transform: 'scale(1)' },\n    exiting: { transform: 'scale(0)' },\n    exited: { transform: 'scale(0)' },\n  },\n};\n\nfunction Provider({\n  children,\n  style,\n  offset,\n  position,\n  transition,\n  wrapperRef,\n}) {\n  const root = useRef();\n  const [modal, setModal] = useState();\n\n  useEffect(() => {\n    root.current = document.createElement('div');\n    const ref = root.current;\n    if (wrapperRef) {\n      wrapperRef.appendChild(ref);\n    }\n    return () => {\n      if (ref) {\n        if (wrapperRef) {\n          wrapperRef.removeChild(ref);\n        }\n      }\n    };\n  }, [wrapperRef]);\n\n  const remove = () => {\n    setModal(null);\n  };\n\n  const parentStyle = useMemo(() => {\n    return wrapperRef\n      ? wrapperRef.getBoundingClientRect()\n      : {\n          top: 0,\n          left: 0,\n          width: window.innerWidth,\n          height: window.innerHeight,\n        };\n  }, [wrapperRef]);\n\n  const closeHandler = useCallback(() => {\n    remove();\n  }, []);\n  /**\n   *\n   * @param {*} component  <component />\n   * @param {object} options    {onYest:()=>{}, prop1, .... etc}\n   * @param {transitions} options.transition\n   * @param {positions} options.position\n   * @param {boolean} options.isBackgroundBlur\n   * @param {boolean} options.enableResizing\n   */\n  const show = useCallback((component, options = {}) => {\n    const _modal = {\n      component,\n      options: { isBackgroundBlur: true, enableResizing: false, ...options },\n    };\n\n    _modal.close = () => remove();\n\n    setModal(_modal);\n    if (_modal.options.onOpen) _modal.options.onOpen();\n    return _modal;\n  }, []);\n\n  /**\n   * @param {object} dialogOptions\n   * @param {object} dialogOptions.message\n   * @param {Array<{ handler: Function,text: string,style: object}>} dialogOptions.buttons\n   * @param {object} dialogOptions.tyle\n   */\n  const showConfirmDialog = useCallback(\n    (dialogOptions, options = { enableResizing: false }) => {\n      const _modal = {\n        component: <ConfirmDialog {...dialogOptions} />,\n        options: { isBackgroundBlur: true, ...options },\n      };\n\n      _modal.close = () => remove();\n\n      setModal(_modal);\n      if (_modal.options.onOpen) _modal.options.onOpen();\n\n      return _modal;\n    },\n    [],\n  );\n\n  const close = () => {\n    closeHandler();\n  };\n\n  useEffect(() => {\n    const keyHandler = (e) => {\n      if (['Escape', 'Esc'].includes(e.key)) {\n        closeHandler();\n      }\n    };\n    document.addEventListener('keydown', keyHandler, false);\n    return () => document.removeEventListener('keydown', keyHandler, false);\n  }, [closeHandler]);\n\n  const styles = css`\n    position: absolute;\n    left: 0;\n    top: 0;\n    bottom: 0;\n    right: 0;\n    z-index: 0;\n    pointer-events: all;\n    .handle {\n      cursor: move;\n    }\n\n    .rnd-container {\n      box-sizing: initial;\n      background-color: #fff;\n      box-shadow: 0 0 0 0, 0 8px 16px rgba(0, 0, 0, 0.3);\n      border-radius: 5px;\n    }\n  `;\n\n  const outerStyle =\n    modal && modal.options.isBackgroundBlur\n      ? { backgroundColor: 'rgba(255,255,255,0.8)' }\n      : { pointerEvents: 'none' };\n\n  return (\n    <ModalProvider value={{ show, close, modal, showConfirmDialog }}>\n      {children}\n      {root.current &&\n        createPortal(\n          <Fragment>\n            {modal ? (\n              <div\n                css={styles}\n                style={{\n                  ...outerStyle,\n                }}\n              >\n                <TransitionGroup\n                  appear\n                  key={\n                    positions[\n                      modal.options.transition\n                        ? modal.options.transition\n                        : transition\n                    ]\n                  }\n                  options={{\n                    position: modal.options.position\n                      ? modal.options.position\n                      : position,\n                  }}\n                  containerStyle={parentStyle}\n                  component={Wrapper}\n                >\n                  <Transition\n                    type={\n                      modal.options.transition\n                        ? modal.options.transition\n                        : transition\n                    }\n                    transitionStyles={{\n                      ...transitionStyles,\n                      default: {\n                        width: modal.options.width\n                          ? `${modal.options.width}px`\n                          : 'auto',\n                      },\n                      height: modal.options.height\n                        ? `${modal.options.height}px`\n                        : 'auto',\n                    }}\n                    key={modal.id}\n                  >\n                    <Rnd\n                      default={{\n                        width: modal.options.width\n                          ? modal.options.width\n                          : 'auto',\n                        height: modal.options.height\n                          ? modal.options.height\n                          : 'auto',\n                        x: 0,\n                        y: 0,\n                      }}\n                      className=\"rnd-container\"\n                      style={{\n                        ...style,\n                        margin: offset,\n                        pointerEvents: 'all',\n                        position: 'none',\n                        userSelect: 'none',\n                      }}\n                      enableResizing={modal.options.enableResizing}\n                      dragHandleClassName=\"handle\"\n                      enableUserSelectHack={false}\n                    >\n                      {modal.options &&\n                        cloneElement(modal.component, {\n                          ...modal.options,\n                          onClose: closeHandler,\n                          style: { cursor: 'default' },\n                        })}\n                    </Rnd>\n                  </Transition>\n                </TransitionGroup>\n              </div>\n            ) : null}\n          </Fragment>,\n          root.current,\n        )}\n    </ModalProvider>\n  );\n}\n\nProvider.defaultProps = {\n  offset: '0px',\n  position: positions.CENTER,\n  transition: transitions.SCALE,\n  wrapperRef: null,\n  style: {},\n};\n\nexport default Provider;\n","import { createContext, useContext } from 'react';\n\ninterface Loader {\n  open: () => void;\n}\n\nconst LoaderContext = createContext<Loader>({ open: () => null });\n\nexport const LoaderProvider = LoaderContext.Provider;\n\nexport function useLoader() {\n  return useContext(LoaderContext);\n}\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback } from 'react';\n\nimport { useLoader } from '../context/LoaderContext';\n\nconst styles = css`\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background-color: rgba(255, 255, 255, 0.25);\n  height: 100%;\n  flex-direction: column;\n  user-select: none;\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  outline: 10px dashed rgba(0, 0, 0, 0.3);\n  outline-offset: -10px;\n  padding-left: 20px;\n  padding-right: 20px;\n\n  p {\n    padding: 15px 30px;\n    background-color:rgba(0, 0, 0, 0.5);\n    border-radius: 39px;\n    color: white;\n    font-size: x-large;\n    font-weight: bold;\n\n  }\n}\n`;\n\nfunction NoData({\n  isEmpty = true,\n  emptyText = 'Drag and drop here a JCAMP-DX, zipped Bruker folder, Jeol jdf or NMRium file',\n}) {\n  const loader = useLoader();\n\n  const openFileDialogHadnler = useCallback(() => {\n    loader.open();\n  }, [loader]);\n\n  if (!isEmpty) {\n    return null;\n  }\n\n  return (\n    <div css={styles} onClick={openFileDialogHadnler}>\n      <p>{emptyText}</p>\n    </div>\n  );\n}\n\nexport default NoData;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\n\nconst styles = css`\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background-color: rgba(255, 255, 255, 0.25);\n  height: 100%;\n  flex-direction: column;\n  user-select: none;\n  position: absolute;\n  width: 100%;\n\n  svg {\n    animation-duration: 0.5s;\n    animation-name: spinAnimation;\n    animation-iteration-count: infinite;\n    animation-fill-mode: forwards;\n    animation-direction: inherit;\n    animation-timing-function: linear;\n    animation-duration: 1s;\n    width: 100px;\n    height: 100px;\n  }\n\n  @keyframes spinAnimation {\n    from {\n      transform: rotate(0deg);\n    }\n\n    to {\n      transform: rotate(360deg);\n    }\n  }\n`;\n\nexport default function DefaultSpinnerComponent() {\n  return (\n    <div css={styles}>\n      <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 841.9 595.3\">\n        <g fill=\"#61DAFB\">\n          <path d=\"M666.3 296.5c0-32.5-40.7-63.3-103.1-82.4 14.4-63.6 8-114.2-20.2-130.4-6.5-3.8-14.1-5.6-22.4-5.6v22.3c4.6 0 8.3.9 11.4 2.6 13.6 7.8 19.5 37.5 14.9 75.7-1.1 9.4-2.9 19.3-5.1 29.4-19.6-4.8-41-8.5-63.5-10.9-13.5-18.5-27.5-35.3-41.6-50 32.6-30.3 63.2-46.9 84-46.9V78c-27.5 0-63.5 19.6-99.9 53.6-36.4-33.8-72.4-53.2-99.9-53.2v22.3c20.7 0 51.4 16.5 84 46.6-14 14.7-28 31.4-41.3 49.9-22.6 2.4-44 6.1-63.6 11-2.3-10-4-19.7-5.2-29-4.7-38.2 1.1-67.9 14.6-75.8 3-1.8 6.9-2.6 11.5-2.6V78.5c-8.4 0-16 1.8-22.6 5.6-28.1 16.2-34.4 66.7-19.9 130.1-62.2 19.2-102.7 49.9-102.7 82.3 0 32.5 40.7 63.3 103.1 82.4-14.4 63.6-8 114.2 20.2 130.4 6.5 3.8 14.1 5.6 22.5 5.6 27.5 0 63.5-19.6 99.9-53.6 36.4 33.8 72.4 53.2 99.9 53.2 8.4 0 16-1.8 22.6-5.6 28.1-16.2 34.4-66.7 19.9-130.1 62-19.1 102.5-49.9 102.5-82.3zm-130.2-66.7c-3.7 12.9-8.3 26.2-13.5 39.5-4.1-8-8.4-16-13.1-24-4.6-8-9.5-15.8-14.4-23.4 14.2 2.1 27.9 4.7 41 7.9zm-45.8 106.5c-7.8 13.5-15.8 26.3-24.1 38.2-14.9 1.3-30 2-45.2 2-15.1 0-30.2-.7-45-1.9-8.3-11.9-16.4-24.6-24.2-38-7.6-13.1-14.5-26.4-20.8-39.8 6.2-13.4 13.2-26.8 20.7-39.9 7.8-13.5 15.8-26.3 24.1-38.2 14.9-1.3 30-2 45.2-2 15.1 0 30.2.7 45 1.9 8.3 11.9 16.4 24.6 24.2 38 7.6 13.1 14.5 26.4 20.8 39.8-6.3 13.4-13.2 26.8-20.7 39.9zm32.3-13c5.4 13.4 10 26.8 13.8 39.8-13.1 3.2-26.9 5.9-41.2 8 4.9-7.7 9.8-15.6 14.4-23.7 4.6-8 8.9-16.1 13-24.1zM421.2 430c-9.3-9.6-18.6-20.3-27.8-32 9 .4 18.2.7 27.5.7 9.4 0 18.7-.2 27.8-.7-9 11.7-18.3 22.4-27.5 32zm-74.4-58.9c-14.2-2.1-27.9-4.7-41-7.9 3.7-12.9 8.3-26.2 13.5-39.5 4.1 8 8.4 16 13.1 24 4.7 8 9.5 15.8 14.4 23.4zM420.7 163c9.3 9.6 18.6 20.3 27.8 32-9-.4-18.2-.7-27.5-.7-9.4 0-18.7.2-27.8.7 9-11.7 18.3-22.4 27.5-32zm-74 58.9c-4.9 7.7-9.8 15.6-14.4 23.7-4.6 8-8.9 16-13 24-5.4-13.4-10-26.8-13.8-39.8 13.1-3.1 26.9-5.8 41.2-7.9zm-90.5 125.2c-35.4-15.1-58.3-34.9-58.3-50.6 0-15.7 22.9-35.6 58.3-50.6 8.6-3.7 18-7 27.7-10.1 5.7 19.6 13.2 40 22.5 60.9-9.2 20.8-16.6 41.1-22.2 60.6-9.9-3.1-19.3-6.5-28-10.2zM310 490c-13.6-7.8-19.5-37.5-14.9-75.7 1.1-9.4 2.9-19.3 5.1-29.4 19.6 4.8 41 8.5 63.5 10.9 13.5 18.5 27.5 35.3 41.6 50-32.6 30.3-63.2 46.9-84 46.9-4.5-.1-8.3-1-11.3-2.7zm237.2-76.2c4.7 38.2-1.1 67.9-14.6 75.8-3 1.8-6.9 2.6-11.5 2.6-20.7 0-51.4-16.5-84-46.6 14-14.7 28-31.4 41.3-49.9 22.6-2.4 44-6.1 63.6-11 2.3 10.1 4.1 19.8 5.2 29.1zm38.5-66.7c-8.6 3.7-18 7-27.7 10.1-5.7-19.6-13.2-40-22.5-60.9 9.2-20.8 16.6-41.1 22.2-60.6 9.9 3.1 19.3 6.5 28.1 10.2 35.4 15.1 58.3 34.9 58.3 50.6-.1 15.7-23 35.6-58.4 50.6zM320.8 78.4z\" />\n          <path d=\"M520.5 78.1z\" />\n        </g>\n      </svg>\n      <p>Loading ...</p>\n    </div>\n  );\n}\n","import { createContext, ReactElement } from 'react';\n\nimport DefaultSpinnerComponent from './DefaultSpinnerComponent';\n\nexport function defaultGetSpinner() {\n  return <DefaultSpinnerComponent />;\n}\n\nexport const spinnerContext = createContext<() => ReactElement>(\n  defaultGetSpinner,\n);\n\nexport const SpinnerProvider = spinnerContext.Provider;\n","import { useState, Fragment, useEffect, useContext } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\n\nimport NoData from './NoData';\nimport { spinnerContext } from './SpinnerContext';\n\nfunction Spinner({ isLoading = true, emptyText = undefined }) {\n  const { data } = useChartData();\n  const [checkEmpty, startCheckEmpty] = useState(false);\n\n  useEffect(() => {\n    let timeour = null;\n    if (!isLoading) {\n      timeour = setTimeout(() => {\n        startCheckEmpty(true);\n      }, 500);\n    }\n    return () => {\n      clearTimeout(timeour);\n    };\n  }, [isLoading]);\n\n  const getSpinner = useContext(spinnerContext);\n\n  return (\n    <Fragment>\n      {isLoading && getSpinner()}\n      {checkEmpty && !isLoading && (\n        <NoData isEmpty={data && data.length === 0} emptyText={emptyText} />\n      )}\n    </Fragment>\n  );\n}\n\nexport default Spinner;\n","import { createContext, useContext } from 'react';\n\nexport const GlobalConetxt = createContext();\n\nexport const GlobalProvider = GlobalConetxt.Provider;\n\nexport function useGlobal() {\n  return useContext(GlobalConetxt);\n}\n","import {\n  useRef,\n  useLayoutEffect,\n  useCallback,\n  useState,\n  memo,\n  Fragment,\n} from 'react';\nimport { createPortal } from 'react-dom';\n\nimport { useGlobal } from '../../context/GlobalContext';\n\nconst styles = {\n  popup: {\n    position: 'fixed',\n    top: 0,\n    left: 0,\n    pointerEvents: 'none',\n    backgroundColor: 'gray',\n    padding: '3px',\n    borderRadius: '2px',\n    color: 'white',\n    whiteSpace: 'nowrap',\n    fontSize: '10px',\n    fontFamily: 'tahoma',\n    textShadow: 'none',\n  },\n};\n\nfunction ToolTip({\n  style,\n  className,\n  popupPlacement = 'right',\n  children,\n  title,\n  offset = { x: 0, y: 0 },\n}) {\n  const refChild = useRef();\n  const refContent = useRef();\n  const [placement, setPlacement] = useState({ x: 0, y: 0 });\n  const [show, showToolTip] = useState(false);\n  const { elementsWraperRef } = useGlobal();\n\n  useLayoutEffect(() => {\n    const getPopupPlacement = () => {\n      let x;\n      let y;\n      const childBounding = refChild.current.getBoundingClientRect();\n      const contentBounding = refContent.current.getBoundingClientRect();\n      switch (popupPlacement) {\n        case 'left':\n          x = -contentBounding.width;\n          y =\n            childBounding.height / 2 -\n            ((childBounding.height / 2) * contentBounding.height) /\n              childBounding.height;\n          break;\n        case 'right':\n          x = childBounding.width;\n          y =\n            childBounding.height / 2 -\n            ((childBounding.height / 2) * contentBounding.height) /\n              childBounding.height;\n          break;\n        case 'top':\n          x =\n            childBounding.width / 2 -\n            ((childBounding.width / 2) * contentBounding.width) /\n              childBounding.width;\n          y = -childBounding.height;\n          break;\n        case 'bottom':\n          x =\n            childBounding.width / 2 -\n            ((childBounding.width / 2) * contentBounding.width) /\n              childBounding.width;\n          y = childBounding.height;\n          break;\n        default:\n          x = 0;\n          y = 0;\n          break;\n      }\n      return { x: x + childBounding.x, y: y + childBounding.y };\n    };\n    if (show) {\n      const pl = getPopupPlacement();\n      setPlacement(pl);\n    }\n  }, [popupPlacement, show]);\n\n  const mouseOverHandler = useCallback(() => {\n    showToolTip(true);\n  }, []);\n\n  const mouseLeaveHandler = useCallback(() => {\n    showToolTip(false);\n  }, []);\n\n  return (\n    <Fragment>\n      <div\n        style={{\n          position: 'relative',\n          height: '100%',\n          display: 'flex',\n          justifyContent: 'center',\n          alignItems: 'center',\n          ...style.mainContainer,\n        }}\n        ref={refChild}\n        onMouseOver={mouseOverHandler}\n        onMouseOut={mouseLeaveHandler}\n      >\n        {children}\n      </div>\n      {show &&\n        createPortal(\n          <div\n            ref={refContent}\n            style={{\n              ...styles.popup,\n              transform: `translate(${placement.x + offset.x}px,${\n                placement.y + offset.y\n              }px)`,\n              zIndex: 999999999,\n              ...style.popup,\n            }}\n            className={className}\n          >\n            <span style={{ pointerEvents: 'none' }}>{title}</span>\n          </div>,\n          elementsWraperRef,\n        )}\n    </Fragment>\n  );\n}\n\nToolTip.defaultProps = {\n  style: {\n    popup: {},\n    mainContainer: {},\n  },\n};\n\nexport default memo(ToolTip);\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport PropTypes from 'prop-types';\nimport { memo } from 'react';\nimport { FaTimes } from 'react-icons/fa';\n\nimport ToolTip from './ToolTip/ToolTip';\n\nconst styles = css`\n  background-color: transparent;\n  border: none;\n  height: 100%;\n  display:flex,\n  justify-content:center;\n  align-items:center;\n\n  svg {\n    fill: #ca0000;\n    font-size: 16px;\n  }\n`;\nfunction CloseButton({ onClick, popupTitle, popupPlacement, className }) {\n  return (\n    <div className={className}>\n      <ToolTip title={popupTitle} popupPlacement={popupPlacement}>\n        <button css={styles} type=\"button\" onClick={onClick}>\n          <FaTimes />\n        </button>\n      </ToolTip>\n    </div>\n  );\n}\n\nCloseButton.defaultProps = {\n  onClick: () => null,\n  popupTitle: 'Close',\n  popupPlacement: 'left',\n  className: '',\n};\nCloseButton.propTypes = {\n  onClick: PropTypes.func,\n  popupTitle: PropTypes.string,\n  popupPlacement: PropTypes.string,\n  className: PropTypes.string,\n};\n\nexport default memo(CloseButton);\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { xGetFromToIndex } from 'ml-spectra-processing';\nimport { analyseMultiplet } from 'multiplet-analysis';\nimport { useState, useEffect } from 'react';\nimport { Chart } from 'react-jsgraph';\n\nimport CloseButton from '../elements/CloseButton';\n\nconst styles = css`\n  display: flex;\n  flex-direction: column;\n  width: 900px;\n  height: 400px;\n  padding: 5px;\n  button:focus {\n    outline: none;\n  }\n  .header {\n    height: 24px;\n    border-bottom: 1px solid #f0f0f0;\n    display: flex;\n    span {\n      color: #464646;\n      font-size: 15px;\n      flex: 1;\n    }\n\n    button {\n      background-color: transparent;\n      border: none;\n      svg {\n        height: 16px;\n      }\n    }\n  }\n  .container {\n    overflow-y: auto;\n    background-color: white;\n    padding-top: 10px;\n\n    .row {\n      outline: none;\n      display: flex !important;\n      flex-direction: row;\n      margin: 0;\n      div {\n        flex: 4;\n      }\n      .multiplicity {\n        flex: 2;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n      }\n    }\n\n    .row:nth-child(odd) {\n      background: #fafafa;\n    }\n  }\n`;\n\nconst loaderStyles = css`\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  flex-direction: column;\n  user-select: none;\n  width: 900px;\n  height: 400px;\n\n  svg {\n    animation-duration: 0.5s;\n    animation-name: spinAnimation;\n    animation-iteration-count: infinite;\n    animation-fill-mode: forwards;\n    animation-direction: inherit;\n    animation-timing-function: linear;\n    animation-duration: 1s;\n    width: 100px;\n    height: 100px;\n  }\n\n  @keyframes spinAnimation {\n    from {\n      transform: rotate(0deg);\n    }\n\n    to {\n      transform: rotate(360deg);\n    }\n  }\n`;\n\nfunction MultipletAnalysisModal({\n  data,\n  activeSpectrum,\n  scaleX,\n  startX,\n  endX,\n  onClose,\n}) {\n  const [analysisData, setAnalysisData] = useState();\n  const [calcStart, setCalcStartStatus] = useState(false);\n  const [isCalcFinished, setCalcFinished] = useState(false);\n\n  useEffect(() => {\n    setTimeout(() => {\n      setCalcStartStatus(true);\n    }, 400);\n  }, []);\n\n  useEffect(() => {\n    if (activeSpectrum && startX && endX && calcStart) {\n      const {\n        data: { x, y },\n        info,\n      } = data[activeSpectrum.index];\n\n      const from = scaleX().invert(startX);\n      const to = scaleX().invert(endX);\n\n      const { fromIndex, toIndex } = xGetFromToIndex(x, {\n        from,\n        to,\n      });\n      const analysesProps = {\n        x: x.slice(fromIndex, toIndex),\n        y: y.slice(fromIndex, toIndex),\n      };\n      try {\n        const result = analyseMultiplet(analysesProps, {\n          frequency: info.originFrequency,\n          takeBestPartMultiplet: true,\n          symmetrizeEachStep: true,\n          debug: true,\n        });\n        setCalcFinished(true);\n        setAnalysisData(result);\n      } catch (err) {\n        // eslint-disable-next-line no-console\n        console.log(err);\n      }\n    }\n  }, [startX, endX, data, scaleX, activeSpectrum, calcStart]);\n\n  if (!isCalcFinished) {\n    return (\n      <div css={loaderStyles}>\n        <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 841.9 595.3\">\n          <g fill=\"#61DAFB\">\n            <path d=\"M666.3 296.5c0-32.5-40.7-63.3-103.1-82.4 14.4-63.6 8-114.2-20.2-130.4-6.5-3.8-14.1-5.6-22.4-5.6v22.3c4.6 0 8.3.9 11.4 2.6 13.6 7.8 19.5 37.5 14.9 75.7-1.1 9.4-2.9 19.3-5.1 29.4-19.6-4.8-41-8.5-63.5-10.9-13.5-18.5-27.5-35.3-41.6-50 32.6-30.3 63.2-46.9 84-46.9V78c-27.5 0-63.5 19.6-99.9 53.6-36.4-33.8-72.4-53.2-99.9-53.2v22.3c20.7 0 51.4 16.5 84 46.6-14 14.7-28 31.4-41.3 49.9-22.6 2.4-44 6.1-63.6 11-2.3-10-4-19.7-5.2-29-4.7-38.2 1.1-67.9 14.6-75.8 3-1.8 6.9-2.6 11.5-2.6V78.5c-8.4 0-16 1.8-22.6 5.6-28.1 16.2-34.4 66.7-19.9 130.1-62.2 19.2-102.7 49.9-102.7 82.3 0 32.5 40.7 63.3 103.1 82.4-14.4 63.6-8 114.2 20.2 130.4 6.5 3.8 14.1 5.6 22.5 5.6 27.5 0 63.5-19.6 99.9-53.6 36.4 33.8 72.4 53.2 99.9 53.2 8.4 0 16-1.8 22.6-5.6 28.1-16.2 34.4-66.7 19.9-130.1 62-19.1 102.5-49.9 102.5-82.3zm-130.2-66.7c-3.7 12.9-8.3 26.2-13.5 39.5-4.1-8-8.4-16-13.1-24-4.6-8-9.5-15.8-14.4-23.4 14.2 2.1 27.9 4.7 41 7.9zm-45.8 106.5c-7.8 13.5-15.8 26.3-24.1 38.2-14.9 1.3-30 2-45.2 2-15.1 0-30.2-.7-45-1.9-8.3-11.9-16.4-24.6-24.2-38-7.6-13.1-14.5-26.4-20.8-39.8 6.2-13.4 13.2-26.8 20.7-39.9 7.8-13.5 15.8-26.3 24.1-38.2 14.9-1.3 30-2 45.2-2 15.1 0 30.2.7 45 1.9 8.3 11.9 16.4 24.6 24.2 38 7.6 13.1 14.5 26.4 20.8 39.8-6.3 13.4-13.2 26.8-20.7 39.9zm32.3-13c5.4 13.4 10 26.8 13.8 39.8-13.1 3.2-26.9 5.9-41.2 8 4.9-7.7 9.8-15.6 14.4-23.7 4.6-8 8.9-16.1 13-24.1zM421.2 430c-9.3-9.6-18.6-20.3-27.8-32 9 .4 18.2.7 27.5.7 9.4 0 18.7-.2 27.8-.7-9 11.7-18.3 22.4-27.5 32zm-74.4-58.9c-14.2-2.1-27.9-4.7-41-7.9 3.7-12.9 8.3-26.2 13.5-39.5 4.1 8 8.4 16 13.1 24 4.7 8 9.5 15.8 14.4 23.4zM420.7 163c9.3 9.6 18.6 20.3 27.8 32-9-.4-18.2-.7-27.5-.7-9.4 0-18.7.2-27.8.7 9-11.7 18.3-22.4 27.5-32zm-74 58.9c-4.9 7.7-9.8 15.6-14.4 23.7-4.6 8-8.9 16-13 24-5.4-13.4-10-26.8-13.8-39.8 13.1-3.1 26.9-5.8 41.2-7.9zm-90.5 125.2c-35.4-15.1-58.3-34.9-58.3-50.6 0-15.7 22.9-35.6 58.3-50.6 8.6-3.7 18-7 27.7-10.1 5.7 19.6 13.2 40 22.5 60.9-9.2 20.8-16.6 41.1-22.2 60.6-9.9-3.1-19.3-6.5-28-10.2zM310 490c-13.6-7.8-19.5-37.5-14.9-75.7 1.1-9.4 2.9-19.3 5.1-29.4 19.6 4.8 41 8.5 63.5 10.9 13.5 18.5 27.5 35.3 41.6 50-32.6 30.3-63.2 46.9-84 46.9-4.5-.1-8.3-1-11.3-2.7zm237.2-76.2c4.7 38.2-1.1 67.9-14.6 75.8-3 1.8-6.9 2.6-11.5 2.6-20.7 0-51.4-16.5-84-46.6 14-14.7 28-31.4 41.3-49.9 22.6-2.4 44-6.1 63.6-11 2.3 10.1 4.1 19.8 5.2 29.1zm38.5-66.7c-8.6 3.7-18 7-27.7 10.1-5.7-19.6-13.2-40-22.5-60.9 9.2-20.8 16.6-41.1 22.2-60.6 9.9 3.1 19.3 6.5 28.1 10.2 35.4 15.1 58.3 34.9 58.3 50.6-.1 15.7-23 35.6-58.4 50.6zM320.8 78.4z\" />\n            <path d=\"M520.5 78.1z\" />\n          </g>\n        </svg>\n        <p>Analyse Multiplet in progress. Please wait ...</p>\n      </div>\n    );\n  }\n\n  return (\n    <div css={styles}>\n      <div className=\"header handle\">\n        <span>Analyse Multiplet</span>\n\n        <CloseButton onClick={onClose} />\n      </div>\n      <div className=\"container\">\n        {analysisData &&\n          analysisData.debug &&\n          analysisData.debug.steps.map((d, index) => (\n            // eslint-disable-next-line react/no-array-index-key\n            <div key={index} className=\"row\">\n              <Chart\n                chart={{\n                  series: {\n                    type: 'line',\n                    data: d.multiplet,\n                  },\n                }}\n                style={{ height: 200, width: 400, overflow: 'auto' }}\n              />\n              <div className=\"multiplicity\">\n                <p>\n                  {analysisData.j[index]\n                    ? `${analysisData.j[index]?.multiplicity}: ${analysisData.j[\n                        index\n                      ]?.coupling.toFixed(3)} Hz`\n                    : ''}\n                </p>\n              </div>\n              <Chart\n                chart={{\n                  series: {\n                    type: 'line',\n                    data: d.errorFunction,\n                  },\n                }}\n                style={{ height: 200, width: 400, overflow: 'auto' }}\n              />\n            </div>\n          ))}\n      </div>\n    </div>\n  );\n}\n\nMultipletAnalysisModal.defaultProps = {\n  onClose: () => {\n    return null;\n  },\n};\nexport default MultipletAnalysisModal;\n","const initSetting = {\n  controllers: {\n    mws: { low: 2, high: 20 },\n  },\n  formatting: {\n    nucleus: [\n      { key: '1H', name: '1H', value: '0.00' },\n      { key: '13C', name: '13C', value: '0.00' },\n      { key: '15N', name: '15N', value: '0.00' },\n      { key: '19F', name: '19F', value: '0.00' },\n      { key: '29Si', name: '29Si', value: '0.00' },\n      { key: '31P', name: '31P', value: '0.00' },\n    ],\n  },\n};\n\nexport default initSetting;\n","import lodashGet from 'lodash/get';\nimport lodashSet from 'lodash/set';\nimport { useCallback, useEffect, useState } from 'react';\n\nfunction useStateWithLocalStorage(localStorageKey, key = null) {\n  const [value, setValue] = useState(\n    localStorage.getItem(localStorageKey) || '{}',\n  );\n  useEffect(() => {\n    localStorage.setItem(localStorageKey, value);\n  }, [localStorageKey, value]);\n\n  const setData = useCallback(\n    (data, key = null) => {\n      let castData = JSON.parse(value);\n      if (key) {\n        lodashSet(castData, key, data);\n      } else {\n        castData = { ...castData, ...data };\n      }\n      setValue(JSON.stringify(castData));\n    },\n    [value],\n  );\n  return [\n    key ? lodashGet(JSON.parse(value), key, {}) : JSON.parse(value),\n    setData,\n  ];\n}\n\nconst getLocalStorage = (localStorageKey, isJson = true) => {\n  const settings = localStorage.getItem(localStorageKey);\n  return settings && isJson ? JSON.parse(settings) : settings;\n};\n\nconst storeData = (localStorageKey, value) => {\n  localStorage.setItem(localStorageKey, value);\n};\nconst removeData = (localStorageKey) => {\n  localStorage.removeItem(localStorageKey);\n};\n\nconst getValue = (object, keyPath, defaultValue = null) => {\n  return lodashGet(object, keyPath, defaultValue);\n};\n\nexport {\n  useStateWithLocalStorage,\n  getLocalStorage,\n  getValue,\n  storeData,\n  removeData,\n};\n","import initSetting from '../../constants/InitSetting';\nimport { getLocalStorage, getValue } from '../../utility/LocalStorage';\n\nexport const zoomDefaultValues = {\n  lowStep: initSetting.controllers.mws.low,\n  highStep: initSetting.controllers.mws.high,\n  speedThreshold: 3,\n};\n\nexport default class Spectrum1DZoomHelper {\n  constructor(scale = 1, options = {}) {\n    this.scale = scale;\n    this.speedThreshold =\n      options.speedThreshold || zoomDefaultValues.speedThreshold;\n    this.slowZoomStep = options.slowZoomStep || zoomDefaultValues.lowStep;\n    this.fastZoomStep = options.fastZoomStep || zoomDefaultValues.highStep;\n  }\n\n  // eslint-disable-next-line no-unused-vars\n  wheel(deltaY, deltaMode) {\n    const deltaYValue =\n      Math.abs(deltaY).toString().length === 1\n        ? Math.abs(deltaY)\n        : Math.abs(deltaY) / 100;\n    const settings = getLocalStorage('nmr-general-settings');\n\n    const _slowZoomStep = getValue(settings, 'general.controllers.mws.low');\n    const _fastZoomStep = getValue(settings, 'general.controllers.mws.high');\n\n    const LOW_STEP = _slowZoomStep\n      ? 0.01 * _slowZoomStep\n      : 0.01 * this.slowZoomStep;\n    const FAST_STEP = _fastZoomStep\n      ? 0.05 * _fastZoomStep\n      : 0.05 * this.fastZoomStep;\n\n    let ZOOM_STEP = deltaYValue <= this.speedThreshold ? LOW_STEP : FAST_STEP;\n\n    const direction = Math.sign(deltaY);\n    const _scale =\n      direction === -1 ? this.scale + ZOOM_STEP : this.scale - ZOOM_STEP;\n    if (_scale >= 0 || _scale === 0) {\n      this.scale = _scale;\n    } else {\n      this.scale = 0;\n    }\n  }\n\n  getScale() {\n    return this.scale;\n  }\n\n  setScale(scale) {\n    this.scale = scale;\n  }\n}\n","import { zoomIdentity, scaleLinear } from 'd3';\n\nimport Spectrum1DZoomHelper from '../helper/Spectrum1DZoomHelper';\n\nexport const spectraZoomHanlders = {};\nexport const integralZoomHanlder = new Spectrum1DZoomHelper(0.5);\n\nexport const ZoomType = {\n  HORIZONTAL: 'HORIZONTAL',\n  VERTICAL: 'VERTICAL',\n  STEP_HROZENTAL: 'STEP_HROZENTAL',\n  FULL: 'FULL',\n};\n\nexport function initZoom1DHandler(data) {\n  data.forEach((datum) => {\n    if (!spectraZoomHanlders[datum.id] && datum.info.dimension === 1) {\n      spectraZoomHanlders[datum.id] = new Spectrum1DZoomHelper();\n    }\n  });\n}\n\nexport function wheel(\n  deltaY,\n  deltaMode,\n  { data, activeSpectrum, activeTab },\n  id = null,\n) {\n  if (activeSpectrum || id) {\n    spectraZoomHanlders[id ? id : activeSpectrum.id].wheel(deltaY, deltaMode);\n  } else {\n    data.forEach((datum) => {\n      if (datum.info.dimension === 1 && activeTab === datum.info.nucleus) {\n        spectraZoomHanlders[datum.id].wheel(deltaY, deltaMode);\n      }\n    });\n  }\n}\nexport function getScaleByID(id) {\n  return { [id]: spectraZoomHanlders[id].getScale(id) };\n}\n\nexport function getScale({ data, activeTab }) {\n  return data.reduce((acc, datum) => {\n    if (datum.info.dimension === 1 && activeTab === datum.info.nucleus) {\n      acc[datum.id] = spectraZoomHanlders[datum.id].getScale();\n    }\n    return acc;\n  }, {});\n}\n\nexport function setScale(scale) {\n  if (typeof scale === 'number') {\n    Object.keys(spectraZoomHanlders).forEach((id) => {\n      spectraZoomHanlders[id].setScale(scale);\n    });\n  } else if (typeof scale === 'object') {\n    Object.keys(scale).forEach((id) => {\n      spectraZoomHanlders[id].setScale(scale[id]);\n    });\n  } else {\n    throw Error('scale must be number or Object');\n  }\n}\n/**\n *\n * @param {Draft} draft\n * @param {number} defaultScale\n * @param {string | null } [spectrumID = null]\n * @param {boolean} [useOrigin = false]\n */\nfunction setZoom(draft, defaultScale = null, spectrumID = null) {\n  const { height, margin, activeSpectrum } = draft;\n  if (defaultScale) {\n    setScale(defaultScale);\n  }\n  const scale = getScale(draft);\n  draft.zoomFactor = { scale };\n\n  if (activeSpectrum === null && spectrumID === null) {\n    draft.yDomains = Object.keys(draft.yDomains).reduce((acc, id) => {\n      const _scale = scaleLinear(draft.originDomain.yDomains[id], [\n        height - margin.bottom,\n        margin.top,\n      ]);\n      const [min, max] = draft.originDomain.yDomains[id];\n      const maxPoint = Math.max(Math.abs(max), Math.abs(min));\n      const scalePoint = maxPoint === max ? 0 : min;\n      const t = zoomIdentity\n        .translate(\n          0,\n          Math.sign(scalePoint) >= 0 ? _scale(scalePoint) : _scale(scalePoint),\n        )\n        .scale(scale[id])\n        .translate(0, -_scale(0));\n      const yDomain = t.rescaleY(_scale).domain();\n      acc[id] = yDomain;\n      return acc;\n    }, {});\n  } else {\n    const spectrumId = spectrumID ? spectrumID : activeSpectrum.id;\n    const _scale = scaleLinear(draft.originDomain.yDomains[spectrumId], [\n      height - margin.bottom,\n      margin.top,\n    ]);\n\n    const t = zoomIdentity\n      .translate(0, _scale(0))\n      .scale(scale[spectrumId])\n      .translate(0, -_scale(0));\n\n    const yDomain = t.rescaleY(_scale).domain();\n    draft.yDomains = {\n      ...draft.yDomains,\n      [spectrumId]: yDomain,\n    };\n  }\n}\n\nfunction setZoom1D(draft, height, margin, index, defaultScale = null) {\n  const { originDomain, tabActiveSpectrum, activeTab } = draft;\n\n  const { id } = tabActiveSpectrum[activeTab.split(',')[index]];\n  if (defaultScale) {\n    setScale(defaultScale);\n  }\n  const scale = getScaleByID(id);\n  draft.zoomFactor = { scale };\n\n  const _scale = scaleLinear(originDomain.yDomains[id], [\n    height - margin,\n    margin,\n  ]);\n  const t = zoomIdentity\n    .translate(0, _scale(0))\n    .scale(scale[id])\n    .translate(0, -_scale(0));\n  let yDomain = t.rescaleY(_scale).domain();\n  draft.yDomains[id] = yDomain;\n}\n\nfunction setIntegralZoom(scale, draft) {\n  if (draft.activeSpectrum) {\n    const { height, margin } = draft;\n    if (draft.originIntegralYDomain[draft.activeSpectrum.id]) {\n      const _scale = scaleLinear(\n        draft.originIntegralYDomain[draft.activeSpectrum.id],\n        [height - margin.bottom, margin.top],\n      );\n\n      const scaleValue = scale < 0.1 ? 0.05 : scale;\n\n      const t = zoomIdentity\n        .translate(0, _scale(0))\n        .scale(scaleValue)\n        .translate(0, -_scale(0));\n\n      const newYDomain = t.rescaleY(_scale).domain();\n\n      draft.integralZoomFactor = { scale };\n      const activeSpectrum = draft.activeSpectrum;\n      draft.integralsYDomains[activeSpectrum.id] = newYDomain;\n    }\n  }\n}\n\nexport { setZoom, setZoom1D, setIntegralZoom };\n","import { scaleLinear } from 'd3';\n\nfunction getXScale(state, spectrumId = null) {\n  const { width, margin, xDomains, xDomain, mode } = state;\n  const range =\n    mode === 'RTL'\n      ? [width - margin.right, margin.left]\n      : [margin.left, width - margin.right];\n  return scaleLinear(spectrumId ? xDomains[spectrumId] : xDomain, range);\n}\n\nfunction getYScale(state, spectrumId = null) {\n  const { height, margin, verticalAlign, yDomain, yDomains } = state;\n  const _height =\n    verticalAlign.flag && !verticalAlign.stacked\n      ? (height - 30) / 2\n      : height - margin.bottom - 30;\n\n  let domainY = [];\n  if (spectrumId === null || yDomains[spectrumId] === undefined) {\n    domainY = [0, yDomain[1]];\n  } else {\n    domainY = [0, yDomains[spectrumId][1]];\n  }\n  return scaleLinear(domainY, [_height, margin.top]);\n}\n\nfunction getIntegralYScale(state, spectrumId) {\n  const { height, margin, verticalAlign, integralsYDomains } = state;\n  const _height =\n    verticalAlign.flag && !verticalAlign.stacked ? height / 2 : height;\n\n  return scaleLinear(integralsYDomains[spectrumId], [\n    _height - (margin.bottom + _height * 0.3),\n    margin.top,\n  ]);\n}\n\nexport { getXScale, getYScale, getIntegralYScale };\n","import { produce } from 'immer';\n\nimport { getXScale, getYScale } from '../1d/utilities/scale';\n\nexport const SET_X_SCALE = 'SET_X_SCALE';\nexport const SET_Y_SCALE = 'SET_Y_SCALE';\nexport const SET_SCALE = 'SET_SCALE';\n\nexport const scaleInitialState = {\n  scaleX: null,\n  scaleY: null,\n};\n\nexport function scaleReducer(state, action) {\n  switch (action.type) {\n    case SET_X_SCALE:\n      return produce(state, (draft) => {\n        draft.scaleX = (spectrumId = null) => getXScale(action, spectrumId);\n      });\n    case SET_Y_SCALE:\n      return produce(state, (draft) => {\n        draft.scaleY = (spectrumId = null) => getYScale(action, spectrumId);\n      });\n    case SET_SCALE:\n      return produce(state, (draft) => {\n        draft.scaleX = (spectrumId = null) =>\n          getXScale(action.payload, spectrumId);\n        draft.scaleY = (spectrumId = null) =>\n          getYScale(action.payload, spectrumId);\n      });\n\n    default:\n      return state;\n  }\n}\n","export const INITIATE = 'INITIATE';\nexport const SAVE_DATA_AS_JSON = 'SAVE_DATA_AS_JSON';\nexport const LOAD_JSON_FILE = 'LOAD_JSON_FILE';\nexport const LOAD_JCAMP_FILE = 'LOAD_JCAMP_FILE';\nexport const LOAD_NMREDATA_FILE = 'LOAD_NMREDATA_FILE';\nexport const LOAD_MOL_FILE = 'LOAD_MOL_FILE';\nexport const LOAD_ZIP_FILE = 'LOAD_ZIP_FILE';\nexport const LOAD_JDF_FILE = 'LOAD_JDF_FILE';\nexport const ADD_PEAK = 'ADD_PEAK';\nexport const ADD_PEAKS = 'ADD_PEAKS';\nexport const DELETE_PEAK_NOTATION = 'DELETE_PEAK_NOTATION';\nexport const SHIFT_SPECTRUM = 'SHIFT_SPECTRUM';\nexport const SET_X_DOMAIN = 'SET_X_DOMAIN';\nexport const SET_Y_DOMAIN = 'SET_Y_DOMAIN';\nexport const SET_ORIGINAL_DOMAIN = 'SET_ORIGINAL_DOMAIN';\nexport const SET_WIDTH = 'SET_WIDTH';\nexport const SET_DIMENSIONS = 'SET_DIMENSIONS';\nexport const SET_SELECTED_TOOL = 'SET_SELECTED_TOOL';\nexport const SET_SELECTED_FILTER = 'SET_SELECTED_FILTER';\nexport const CHANGE_SPECTRUM_SETTING = 'CHANGE_SPECTRUM_SETTING';\nexport const CHANGE_SPECTRUM_TYPE = 'CHANGE_SPECTRUM_TYPE';\nexport const FULL_ZOOM_OUT = 'FULL_ZOOM_OUT';\nexport const CHANGE_VISIBILITY = 'CHANGE_VISIBILITY';\nexport const CHANGE_PEAKS_MARKERS_VISIBILITY =\n  'CHANGE_PEAKS_MARKERS_VISIBILITY';\nexport const CHANGE_ACTIVE_SPECTRUM = 'CHANGE_ACTIVE_SPECTRUM';\nexport const CHANGE_SPECTRUM_COLOR = 'CHANGE_SPECTRUM_COLOR';\nexport const ADD_INTEGRAL = 'ADD_INTEGRAL';\nexport const DELETE_INTEGRAL = 'DELETE_INTEGRAL';\nexport const TOGGLE_REAL_IMAGINARY_VISIBILITY =\n  'TOGGLE_REAL_IMAGINARY_VISIBILITY';\nexport const SET_ZOOM_FACTOR = 'SET_ZOOM_FACTOR';\nexport const ADD_MOLECULE = 'ADD_MOLECULE';\nexport const SET_MOLECULE = 'SET_MOLECULE';\nexport const DELETE_MOLECULE = 'DELETE_MOLECULE';\nexport const SET_CORRELATION = 'SET_CORRELATION';\nexport const SET_CORRELATIONS = 'SET_CORRELATIONS';\nexport const SET_CORRELATIONS_MF = 'SET_CORRELATIONS_MF';\nexport const SET_CORRELATIONS_TOLERANCE = 'SET_CORRELATIONS_TOLERANCE';\nexport const DELETE_SPECTRA = 'DELETE_SPECTRA';\nexport const CHANGE_SPECTRUM_DISPLAY_VIEW_MODE =\n  'CHANGE_SPECTRUM_DISPLAY_VIEW_MODE';\nexport const SET_INTEGRAL_Y_DOMAIN = 'SET_INTEGRAL_Y_DOMAIN';\nexport const RESIZE_INTEGRAL = 'RESIZE_INTEGRAL';\nexport const BRUSH_END = 'BRUSH_END';\nexport const RESET_DOMAIN = 'RESET_X_DOMAIN';\nexport const CHANGE_INTEGRAL_ZOOM = 'CHANGE_INTEGRAL_ZOOM';\nexport const ENABLE_FILTER = 'ENABLE_FILTER';\nexport const DELETE_FILTER = 'DELETE_FILTER';\nexport const DELETE_SPECTRA_FILTER = 'DELETE_SPECTRA_FILTER';\nexport const APPLY_ZERO_FILLING_FILTER = 'APPLY_ZERO_FILLING_FILTER';\nexport const APPLY_FFT_FILTER = 'APPLY_FFT_FILTER';\nexport const CALCULATE_MANUAL_PHASE_CORRECTION_FILTER =\n  'CALCULATE_MANUAL_PHASE_CORRECTION_FILTER';\nexport const APPLY_MANUAL_PHASE_CORRECTION_FILTER =\n  'APPLY_MANUAL_PHASE_CORRECTION_FILTER';\nexport const APPLY_AUTO_PHASE_CORRECTION_FILTER =\n  'APPLY_AUTO_PHASE_CORRECTION_FILTER';\nexport const APPLY_ABSOLUTE_FILTER = 'APPLY_ABSOLUTE_FILTER';\nexport const SET_VERTICAL_INDICATOR_X_POSITION =\n  'SET_VERTICAL_INDICATOR_X_POSITION';\nexport const AUTO_PEAK_PICKING = 'AUTO_PEAK_PICKING';\nexport const AUTO_RANGES_DETECTION = 'AUTO_RANGES_DETECTION';\nexport const AUTO_ZONES_DETECTION = 'AUTO_ZONES_DETECTION';\nexport const DELETE_RANGE = 'DELETE_RANGE';\nexport const SET_SELECTED_OPTIONS_PANEL = 'SET_SELECTED_OPTIONS_PANEL';\nexport const SET_LOADING_FLAG = 'SET_LOADING_FLAG';\nexport const RESET_SELECTED_TOOL = 'RESET_SELECTED_TOOL';\nexport const SET_SPECTRUMS_VERTICAL_ALIGN = 'SET_SPECTRUMS_VERTICAL_AlIGN';\nexport const SAVE_AS_SVG = 'SAVE_AS_SVG';\nexport const CHANGE_INTEGRAL_DATA = 'CHANGE_INTEGRAL_DATA';\nexport const SET_PREFERENCES = 'SET_PREFERENCES';\nexport const SET_ACTIVE_TAB = 'SET_ACTIVE_TAB';\nexport const CHANGE_INTEGRAL_SUM = 'CHANGE_INTEGRAL_SUM';\nexport const ADD_BASE_LINE_ZONE = 'ADD_BASE_LINE_ZONE';\nexport const DELETE_BASE_LINE_ZONE = 'DELETE_BASE_LINE_ZONE';\nexport const APPLY_BASE_LINE_CORRECTION_FILTER =\n  'APPLY_BASE_LINE_CORRECTION_FILTER';\nexport const SET_KEY_PREFERENCES = 'SET_KEY_PREFERENCES';\nexport const APPLY_KEY_PREFERENCES = 'APPLY_KEY_PREFERENCES';\nexport const RESIZE_RANGE = 'RESIZE_RANGE';\nexport const CHANGE_RANGE_SUM = 'CHANGE_RANGE_SUM';\nexport const ADD_RANGE = 'ADD_RANGE';\nexport const SET_2D_LEVEL = 'SET_2D_LEVEL';\nexport const ADD_2D_ZONE = 'ADD_2D_ZONE';\nexport const DELETE_2D_ZONE = 'DELETE_2D_ZONE';\nexport const ADD_MISSING_PROJECTION = 'ADD_MISSING_PROJECTION';\nexport const SET_FILTER_SNAPSHOT = 'SET_FILTER_SNAPSHOT';\nexport const CHANGE_RANGE_RELATIVE = 'CHANGE_RANGE_RELATIVE';\nexport const CHANGE_RANGE_SIGNAL_VALUE = 'CHANGE_RANGE_SIGNAL_VALUE';\nexport const CHANGE_RANGE_SIGNAL_KIND = 'CHANGE_RANGE_SIGNAL_KIND';\nexport const SAVE_EDITED_RANGE = 'SAVE_EDITED_RANGE';\nexport const UNLINK_RANGE = 'UNLINK_RANGE';\nexport const SET_DIAID_RANGE = 'SET_DIAID_RANGE';\nexport const CHANGE_INTEGRAL_RELATIVE = 'CHANGE_INTEGRAL_RELATIVE';\nexport const ANALYZE_SPECTRA = 'ANALYZE_SPECTRA';\nexport const DELETE_ANALYZE_SPECTRA_RANGE = 'DELETE_ANALYZE_SPECTRA_RANGE';\nexport const RESIZE_ANALYZE_SPECTRA_RANGE = 'RESIZE_ANALYZE_SPECTRA_RANGE';\nexport const SET_ANALYZE_SPECTRA_COLUMNS = 'SET_ANALYZE_SPECTRA_COLUMNS';\nexport const FILTER_SPECTRA_COLUMN = 'FILTER_SPECTRA_COLUMN';\nexport const ALIGN_SPECTRA = 'ALIGN_SPECTRA';\nexport const CHANGE_ZONE_SIGNAL_VALUE = 'CHANGE_ZONE_SIGNAL_VALUE';\nexport const CHANGE_ZONE_SIGNAL_KIND = 'CHANGE_ZONE_SIGNAL_KIND';\nexport const UNLINK_ZONE = 'UNLINK_ZONE';\nexport const SET_DIAID_ZONE = 'SET_DIAID_ZONE';\nexport const PREDICT_SPECTRA = 'PREDICT_SPECTRA';\nexport const SET_SPECTRA_SAME_TOP = 'SET_SPECTRA_SAME_TOP';\nexport const RESET_SPECTRA_SCALE = 'RESET_SPECTRA_SCALE';\nexport const SET_MOUSE_OVER_DISPLAYER = 'SET_MOUSE_OVER_DISPLAYER';\nexport const APPLY_MULTIPLE_SPECTRA_FILTER = 'APPLY_MULTIPLE_SPECTRA_FILTER';\nexport const ADD_EXCLUSION_ZONE = 'ADD_EXCLUSION_ZONE';\nexport const DELETE_EXCLUSION_ZONE = 'DELETE_EXCLUSION_ZONE';\n","import { reimAbsolute } from 'ml-spectra-processing';\n\nexport const id = 'absolute';\nexport const name = 'Absolute';\n\n/**\n *\n * @param {Datum1d} datum1d\n */\n\nexport function apply(datum1D) {\n  if (!isApplicable(datum1D)) {\n    throw new Error('absolute not applicable on this data');\n  }\n\n  datum1D.data.re = reimAbsolute(datum1D.data);\n  datum1D.data.im = new Float64Array(0);\n  datum1D.info = { ...datum1D.info, isComplex: false };\n}\n\nexport function isApplicable(datum1D) {\n  if (datum1D.info.isComplex && !datum1D.info.isFid) return true;\n  return false;\n}\n\nexport function reduce() {\n  return {\n    once: false,\n    reduce: null,\n  };\n}\n","import { reimAutoPhaseCorrection } from 'ml-spectra-processing';\n\nexport const id = 'autoPhaseCorrection';\nexport const name = 'Automatic phase correction';\n\n/**\n *\n * @param {Datum1d} datum1d\n * @param {Object} [options={}]\n * @param {number} [options.ph0=0]\n * @param {number} [options.ph1=0]\n */\n\nconst defaultOptions = {\n  magnitudeMode: false,\n  minRegSize: 30,\n  maxDistanceToJoin: 256,\n};\n\nexport function apply(datum1D, options = {}) {\n  if (!isApplicable(datum1D)) {\n    throw new Error('phaseCorrection not applicable on this data');\n  }\n  options = Object.assign({}, defaultOptions, options);\n\n  return reimAutoPhaseCorrection(datum1D.data, options);\n}\n\nexport function isApplicable(datum1D) {\n  if (datum1D.info.isComplex && !datum1D.info.isFid) return true;\n  return false;\n}\n\nexport function reduce(previousValue, newValue) {\n  let reduced = Object.assign({}, previousValue);\n  for (const k in reduced) {\n    reduced[k] += newValue[k];\n  }\n  return {\n    once: true,\n    reduce: reduced,\n  };\n}\n","import airPLS from 'ml-airpls';\nimport equallySpaced from 'ml-array-xy-equally-spaced';\nimport baselineRegression from 'ml-baseline-correction-regression';\nimport PolynomialRegression from 'ml-regression-polynomial';\n\nexport const id = 'baselineCorrection';\nexport const name = 'Baseline correction';\n\n/**\n *\n * @param {Datum1d} datum1d\n */\n\nexport const baselineAlgorithms = {\n  airpls: 'airPLS',\n  polynomial: 'Polynomial',\n};\n\nexport function apply(datum1D, options = {}) {\n  if (!isApplicable(datum1D)) {\n    throw new Error('baselineCorrection not applicable on this data');\n  }\n  const { algorithm, zones } = options;\n  let { x, re } = datum1D.data;\n\n  let corrected;\n  switch (algorithm) {\n    case 'airpls':\n      corrected = airPLS(x, re, options).corrected;\n      break;\n    case 'polynomial':\n      {\n        let reduced = equallySpaced(\n          { x, y: re },\n          { numberOfPoints: 4096, zones },\n        );\n        if (zones.length === 0) {\n          let { regression } = baselineRegression(\n            reduced.x,\n            reduced.y,\n            options,\n          );\n          corrected = new Float64Array(x.length);\n          for (let i = 0; i < re.length; i++) {\n            corrected[i] = re[i] - regression.predict(x[i]);\n          }\n        } else {\n          let polynomialRegression = new PolynomialRegression(\n            x,\n            re,\n            options.degree,\n          );\n          corrected = new Float64Array(x.length);\n          for (let i = 0; i < re.length; i++) {\n            corrected[i] = re[i] - polynomialRegression.predict(x[i]);\n          }\n        }\n      }\n\n      break;\n    default:\n      throw new Error(`baselineCorrection: algorithm unknown: ${algorithm}`);\n  }\n\n  Object.assign(datum1D.data, { re: corrected });\n}\n\nexport function isApplicable(datum1D) {\n  if (!datum1D.info.isFid) return true;\n  return false;\n}\n\nexport function reduce() {\n  return {\n    once: false,\n    reduce: null,\n  };\n}\n\n/**\n * Will extract x/y points based on zones\n * @param {*} x\n * @param {*} re\n * @param {*} zones\n */\n// eslint-disable-next-line no-unused-vars,no-empty-function\nfunction getZones(x, re, zones = []) {}\n","import { mean } from 'ml-stat/array';\n\nexport const id = 'centerMean';\nexport const name = 'Center Mean';\n\n/**\n * Computes the arithmetic mean of the given values\n * @param {Datum1d} datum1d\n */\n\nexport function apply(datum1D) {\n  if (!isApplicable(datum1D)) {\n    throw new Error('Center Mean is not applicable on this data');\n  }\n\n  const re = datum1D.data.re.slice(0);\n  const im = datum1D.data.im?.slice(0);\n\n  const reMean = mean(re);\n  const imMean = mean(im || []);\n\n  for (let i = 0; i < re.length; i++) {\n    re[i] -= reMean;\n    if (im) {\n      im[i] -= imMean;\n    }\n  }\n\n  datum1D.data.re = re;\n\n  if (im) {\n    datum1D.data.im = im;\n  }\n}\n\nexport function isApplicable(datum1D) {\n  if (datum1D.info.isComplex && !datum1D.info.isFid) return true;\n  return false;\n}\n\nexport function reduce() {\n  return {\n    once: false,\n    reduce: null,\n  };\n}\n","export const id = 'digitalFilter';\nexport const name = 'Digital Filter';\n\n/**\n * Move points from the beginning to the end of FID and performs a first order phase correction\n * @param {Datum1d} datum1d\n */\n\nexport function apply(datum1D, options = {}) {\n  if (!isApplicable(datum1D)) {\n    throw new Error('Digital Filter is not applicable on this data');\n  }\n\n  let { digitalFilterValue = 0 } = options;\n  let re = new Float64Array(datum1D.data.re);\n  let im = new Float64Array(datum1D.data.im);\n\n  let pointsToShift = Math.floor(digitalFilterValue);\n\n  const skip = 0;\n  pointsToShift += 0;\n\n  const newRe = new Float64Array(re.length);\n  const newIm = new Float64Array(im.length);\n  newRe.set(re.slice(pointsToShift));\n  newRe.set(re.slice(skip, pointsToShift), re.length - pointsToShift);\n  newIm.set(im.slice(pointsToShift));\n  newIm.set(im.slice(skip, pointsToShift), im.length - pointsToShift);\n\n  datum1D.data.re = newRe;\n  datum1D.data.im = newIm;\n}\n\nexport function isApplicable(datum1D) {\n  if (datum1D.info.isComplex && datum1D.info.isFid) return true;\n  return false;\n}\n\nexport function reduce() {\n  return {\n    once: true,\n    reduce: undefined,\n  };\n}\n","import equallySpaced from 'ml-array-xy-equally-spaced';\n\nexport const id = 'equallySpaced';\nexport const name = 'Equally Spaced';\n\n/**\n * Equally Spaced\n * **\n * Function that returns a Number array of equally spaced numberOfPoints\n * containing a representation of intensities of the spectra arguments x\n * and y.\n *\n * The options parameter contains an object in the following form:\n * from: starting point\n * to: last point\n * numberOfPoints: number of points between from and to\n * variant: \"slot\" or \"smooth\" - smooth is the default option\n *\n * The slot variant consist that each point in the new array is calculated\n * averaging the existing points between the slot that belongs to the current\n * value. The smooth variant is the same but takes the integral of the range\n * of the slot and divide by the step size between two points in the new array.\n *\n * @param {Datum1d} datum1d\n * @param {Object} options.from\n * @param {number} options.to\n * @param {number} options.numberOfPoints\n * @param {Array<{from:number;to:number}>} options.exclusions\n */\n\nexport function apply(datum1D, options = {}) {\n  if (!isApplicable(datum1D)) {\n    throw new Error('Equally Spaced is not applicable on this data');\n  }\n  const { from, to, numberOfPoints, exclusions } = options;\n  const { x, re, im } = datum1D.data;\n  const XREdata = equallySpaced(\n    { x, y: re },\n    { from, to, numberOfPoints, exclusions },\n  );\n\n  datum1D.data.x = XREdata.x;\n  datum1D.data.re = XREdata.y;\n  if (im) {\n    const XIMdata = equallySpaced(\n      { x, y: re },\n      { from, to, numberOfPoints, exclusions },\n    );\n    datum1D.data.im = XIMdata.y;\n  }\n}\n\nexport function isApplicable(datum1D) {\n  if (datum1D.info.isComplex && !datum1D.info.isFid) return true;\n  return false;\n}\n\nexport function reduce() {\n  return {\n    once: false,\n    reduce: null,\n  };\n}\n","import { reimFFT, reimPhaseCorrection } from 'ml-spectra-processing';\n\nexport const id = 'fft';\nexport const name = 'FFT';\n\n/**\n *\n * @param {Datum1d} datum1d\n */\n\nexport function apply(datum1D) {\n  if (!isApplicable(datum1D)) {\n    throw new Error('fft not applicable on this data');\n  }\n\n  let digitalFilterApplied = datum1D.filters.some(\n    (e) => e.name === 'digitalFilter' && e.flag,\n  );\n\n  Object.assign(datum1D.data, reimFFT(datum1D.data, { applyZeroShift: true }));\n\n  if (digitalFilterApplied) {\n    let { digitalFilter } = datum1D.info;\n    let ph1 = (digitalFilter - Math.floor(digitalFilter)) * Math.PI * 2;\n    Object.assign(datum1D.data, reimPhaseCorrection(datum1D.data, 0, ph1));\n  }\n\n  datum1D.data.x = generateXAxis(datum1D);\n  datum1D.info = { ...datum1D.info, isFid: false };\n}\n\nexport function isApplicable(datum1D) {\n  if (datum1D.info.isComplex && datum1D.info.isFid) return true;\n  return false;\n}\n\nexport function reduce() {\n  return {\n    once: true,\n    reduce: undefined,\n  };\n}\n\nfunction generateXAxis(datum1D) {\n  const info = datum1D.info;\n  const baseFrequency = parseFloat(info.baseFrequency);\n  const frequencyOffset = parseFloat(info.frequencyOffset);\n  const spectralWidth = parseFloat(info.spectralWidth);\n  const offset = frequencyOffset / baseFrequency;\n  let spectralHalfWidth = 0.5 * spectralWidth;\n  let nbPoints = datum1D.data.x.length;\n  let firstPoint = offset - spectralHalfWidth;\n  let dx = spectralWidth / (nbPoints - 1);\n  const xAxis = new Array(nbPoints);\n  for (let i = 0; i < nbPoints; i++) {\n    xAxis[i] = firstPoint;\n    firstPoint += dx;\n  }\n  return xAxis;\n}\n","import { xGetFromToIndex } from 'ml-spectra-processing';\n\nexport const id = 'fromTo';\nexport const name = 'From/To';\n\n/**\n *\n * @param {Datum1d} datum1d\n */\n\nexport function apply(datum1D, options = {}) {\n  if (!isApplicable(datum1D)) {\n    throw new Error('From/To filter not applicable on this data');\n  }\n  const { x, re, im } = datum1D.data;\n  const { from, to } = options;\n  const { fromIndex, toIndex } = xGetFromToIndex(x, { from, to });\n\n  datum1D.data.x = x.slice(fromIndex, toIndex);\n  datum1D.data.re = re.slice(fromIndex, toIndex);\n  if (im) {\n    datum1D.data.im = im.slice(fromIndex, toIndex);\n  }\n}\n\nexport function isApplicable(datum1D) {\n  if (datum1D.info.isComplex && !datum1D.info.isFid) return true;\n  return false;\n}\n\nexport function reduce(previousValue, newValue) {\n  return {\n    once: true,\n    reduce: newValue,\n  };\n}\n","export const id = 'lineBroadening';\nexport const name = 'Line broadening';\n\n/**\n *\n * @param {Datum1d} datum1d\n * @param {Object} [value]\n */\n\nexport function apply(datum1D, value) {\n  if (!isApplicable(datum1D)) {\n    throw new Error('lineBroadening not applicable on this data');\n  }\n\n  let grpdly = datum1D.info.digitalFilter;\n  let pointsToShift;\n  if (grpdly > 0) {\n    pointsToShift = Math.floor(grpdly);\n  } else {\n    pointsToShift = 0;\n  }\n\n  const re = datum1D.data.re;\n  const im = datum1D.data.im;\n  const t = datum1D.data.x;\n\n  const length = re.length;\n\n  const newRE = new Float64Array(length); // I don't think we need a new array... here\n  const newIM = new Float64Array(length);\n  //if (value !== 0) {// is it OK to skip this line if \"value\" is zero?\n  //please check this test of zero is correct !== or != ...\n  const dw = (t[length - 1] - t[0]) / (length - 1); //REPLACE CONSTANT with calculated value... : for this we need AQ or DW to set it right...\n  // convert line broadening in Hz into exponential coefficient:\n  const em = -value * Math.exp(1);\n\n  const coefExp = Math.exp(em * dw);\n  let curFactor = Math.exp(em * t[0]); // in case does not start at zero\n  for (let i = 0; i < length - pointsToShift; i++) {\n    newRE[i] = re[i] * curFactor;\n    newIM[i] = im[i] * curFactor;\n    curFactor = curFactor * coefExp;\n  }\n  curFactor = Math.exp(em * t[0]);\n  for (let i = length; i > length - pointsToShift; i--) {\n    newRE[i] = re[i] * curFactor;\n    newIM[i] = im[i] * curFactor;\n    curFactor = curFactor * coefExp;\n  }\n  datum1D.data = { ...datum1D.data, ...{ re: newRE, im: newIM } };\n  //}\n}\nexport function isApplicable(datum1D) {\n  if (datum1D.info.isComplex && datum1D.info.isFid) return true;\n  return false;\n}\n\nexport function reduce(previousValue, newValue) {\n  return {\n    once: true,\n    reduce: previousValue + newValue,\n  };\n}\n","import { xParetoNormalization } from 'ml-spectra-processing';\n\nexport const id = 'pareto';\nexport const name = 'Pareto';\n\n/**\n * Computes the arithmetic mean of the given values\n * @param {Datum1d} datum1d\n */\n\nexport function apply(datum1D) {\n  if (!isApplicable(datum1D)) {\n    throw new Error('Pareto is not applicable on this data');\n  }\n\n  const re = datum1D.data.re.slice(0);\n  const im = datum1D.data.im?.slice(0);\n\n  datum1D.data.re = xParetoNormalization(re);\n  if (im) {\n    datum1D.data.im = xParetoNormalization(im);\n  }\n}\n\nexport function isApplicable(datum1D) {\n  if (datum1D.info.isComplex && !datum1D.info.isFid) return true;\n  return false;\n}\n\nexport function reduce() {\n  return {\n    once: false,\n    reduce: null,\n  };\n}\n","import { reimPhaseCorrection } from 'ml-spectra-processing';\n\nexport const id = 'phaseCorrection';\nexport const name = 'Phase correction';\n\n/**\n *\n * @param {Datum1d} datum1d\n * @param {Object} [options={}]\n * @param {number} [options.ph0=0]\n * @param {number} [options.ph1=0]\n */\n\nexport function apply(datum1D, options = {}) {\n  if (!isApplicable(datum1D)) {\n    throw new Error('phaseCorrection not applicable on this data');\n  }\n  let { ph0, ph1 } = options;\n  ph0 *= Math.PI / 180.0;\n  ph1 *= Math.PI / 180.0;\n  Object.assign(datum1D.data, reimPhaseCorrection(datum1D.data, ph0, ph1));\n}\n\nexport function isApplicable(datum1D) {\n  if (datum1D.info.isComplex && !datum1D.info.isFid) return true;\n  return false;\n}\n\nexport function reduce(previousValue, newValue) {\n  let reduced = Object.assign({}, previousValue);\n  for (const k in reduced) {\n    reduced[k] += newValue[k];\n  }\n  return {\n    once: true,\n    reduce: reduced,\n  };\n}\n","/**\n *\n * @param {Object} datum1d\n * @param {number} [shiftValue=0]\n */\n\nexport const id = 'shiftX';\nexport const name = 'Shift X';\n\nexport function apply(datum1D, shiftValue = 0) {\n  if (!isApplicable(datum1D)) {\n    throw new Error('shiftX not applicable on this data');\n  }\n\n  datum1D.data.x = datum1D.data.x.map((val) => val + shiftValue);\n}\n\nexport function isApplicable() {\n  return true;\n}\n\nexport function reduce(previousValue, newValue) {\n  return {\n    once: true,\n    reduce: previousValue + newValue,\n  };\n}\n","import { standardDeviation } from 'ml-stat/array';\n\nexport const id = 'standardDeviation';\nexport const name = 'Standard Deviation';\n\n/**\n * Computes the standard deviation of the given values\n * @param {Datum1d} datum1d\n */\n\nexport function apply(datum1D) {\n  if (!isApplicable(datum1D)) {\n    throw new Error('Standard Deviation is not applicable on this data');\n  }\n\n  const re = datum1D.data.re.slice(0);\n  const im = datum1D.data.im?.slice(0);\n\n  const reStd = standardDeviation(re);\n  const imStd = standardDeviation(im || []);\n\n  for (let i = 0; i < re.length; i++) {\n    re[i] /= reStd;\n    if (im) {\n      im[i] /= imStd;\n    }\n  }\n\n  datum1D.data.re = re;\n\n  if (im) {\n    datum1D.data.im = im;\n  }\n}\n\nexport function isApplicable(datum1D) {\n  if (datum1D.info.isComplex && !datum1D.info.isFid) return true;\n  return false;\n}\n\nexport function reduce() {\n  return {\n    once: false,\n    reduce: null,\n  };\n}\n","export const id = 'zeroFilling';\nexport const name = 'Zero Filling';\n/**\n *\n * @param {Datum1d} datum1d\n * @param {Object} [size]\n */\nexport function apply(datum1D, size) {\n  if (!isApplicable(datum1D)) {\n    throw new Error('zeroFilling not applicable on this data');\n  }\n\n  let digitalFilterApplied = datum1D.filters.some(\n    (e) => e.name === 'digitalFilter' && e.flag,\n  );\n\n  let grpdly = datum1D.info.digitalFilter;\n  let pointsToShift;\n  if (grpdly > 0 && digitalFilterApplied) {\n    pointsToShift = Math.floor(grpdly);\n  } else {\n    pointsToShift = 0;\n  }\n\n  const { re, im, x } = datum1D.data;\n\n  let newRE = new Float64Array(size);\n  let newIM = new Float64Array(size);\n  let newX = new Float64Array(size);\n\n  const length = Math.min(size, re.length);\n\n  newRE.set(re.slice(0, length - pointsToShift));\n  newIM.set(im.slice(0, length - pointsToShift));\n  newX.set(x.slice(0, length - pointsToShift));\n\n  let diff = x[1] - x[0];\n  let currentX = x[length - pointsToShift - 1];\n  for (let i = length - pointsToShift; i < size; i++) {\n    currentX += diff;\n    newX[i] = currentX;\n  }\n\n  if (pointsToShift > 0 && pointsToShift < size) {\n    newRE.set(re.slice(re.length - pointsToShift), size - pointsToShift);\n    newIM.set(im.slice(re.length - pointsToShift), size - pointsToShift);\n  }\n\n  datum1D.data = { ...datum1D.data, ...{ re: newRE, im: newIM, x: newX } };\n}\n\nexport function isApplicable(datum1D) {\n  if (datum1D.info.isComplex && datum1D.info.isFid) return true;\n  return false;\n}\n\nexport function reduce(_previousValue, newValue) {\n  return {\n    once: true,\n    reduce: newValue,\n  };\n}\n","/**\n *\n * @param {Object} datum2d\n * @param {number} [shiftValue=0]\n */\n\nexport const id = 'shift2DX';\nexport const name = 'Shift 2D X';\n\nexport function apply(datum2D, shiftValue = 0) {\n  if (!isApplicable(datum2D)) {\n    throw new Error('shiftX not applicable on this data');\n  }\n  datum2D.data.minX += shiftValue;\n  datum2D.data.maxX += shiftValue;\n}\n\nexport function isApplicable() {\n  return true;\n}\n\nexport function reduce(previousValue, newValue) {\n  return {\n    once: true,\n    reduce: previousValue + newValue,\n  };\n}\n","/**\n *\n * @param {Object} datum2d\n * @param {number} [shiftValue=0]\n */\n\nexport const id = 'shift2DY';\nexport const name = 'Shift 2D Y';\n\nexport function apply(datum2D, shiftValue = 0) {\n  if (!isApplicable(datum2D)) {\n    throw new Error('shiftY not applicable on this data');\n  }\n  datum2D.data.minY += shiftValue;\n  datum2D.data.maxY += shiftValue;\n}\n\nexport function isApplicable() {\n  return true;\n}\n\nexport function reduce(previousValue, newValue) {\n  return {\n    once: true,\n    reduce: previousValue + newValue,\n  };\n}\n","import * as absolute from './data1d/filter1d/absolute';\nimport * as autoPhaseCorrection from './data1d/filter1d/autoPhaseCorrection';\nimport * as baselineCorrection from './data1d/filter1d/baselineCorrection';\nimport * as centerMean from './data1d/filter1d/centerMean';\nimport * as digitalFilter from './data1d/filter1d/digitalFilter';\nimport * as equallySpaced from './data1d/filter1d/equallySpaced';\nimport * as fft from './data1d/filter1d/fft';\nimport * as fromTo from './data1d/filter1d/fromTo';\nimport * as lineBroadening from './data1d/filter1d/lineBroadening';\nimport * as pareto from './data1d/filter1d/pareto';\nimport * as phaseCorrection from './data1d/filter1d/phaseCorrection';\nimport * as shiftX from './data1d/filter1d/shiftX';\nimport * as standardDeviation from './data1d/filter1d/standardDeviation';\nimport * as zeroFilling from './data1d/filter1d/zeroFilling';\nimport * as shift2DX from './data2d/filter2d/shiftX';\nimport * as shift2DY from './data2d/filter2d/shiftY';\n\nexport const Filters = {\n  absolute,\n  baselineCorrection,\n  lineBroadening,\n  fft,\n  phaseCorrection,\n  autoPhaseCorrection,\n  shiftX,\n  zeroFilling,\n  digitalFilter,\n  fromTo,\n  equallySpaced,\n  standardDeviation,\n  centerMean,\n  pareto,\n  shift2DX,\n  shift2DY,\n};\n","import { Filters } from '../../data/Filters';\n\nexport const options = {\n  zoom: {\n    id: 'zoom',\n    label: 'Zoom',\n    hasOptionPanel: false,\n    isFilter: false,\n  },\n  peakPicking: {\n    id: 'peakPicking',\n    label: 'Peaks Picking',\n    hasOptionPanel: true,\n    isFilter: false,\n  },\n  integral: {\n    id: 'integral',\n    label: 'integral Tool',\n    hasOptionPanel: false,\n    isFilter: false,\n  },\n  zone2D: {\n    id: 'zone2D',\n    label: 'Zone Tool',\n    hasOptionPanel: true,\n    isFilter: false,\n  },\n  slicingTool: {\n    id: 'slicingTool',\n    label: 'Slicing Tool',\n    hasOptionPanel: false,\n    isFilter: false,\n  },\n  HMove: {\n    id: 'HMove',\n    label: 'Move spectrum horizontally',\n    hasOptionPanel: false,\n    isFilter: false,\n  },\n  equalizerTool: {\n    id: 'equalizerTool',\n    label: 'Equalizer Tool',\n    hasOptionPanel: false,\n    isFilter: false,\n  },\n  rangesPicking: {\n    id: 'rangesPicking',\n    label: 'Ranges Picking ( Press r )',\n    hasOptionPanel: true,\n    isFilter: false,\n  },\n  zeroFilling: {\n    id: Filters.zeroFilling.id,\n    label: Filters.zeroFilling.name,\n    hasOptionPanel: true,\n    isFilter: true,\n  },\n  phaseCorrection: {\n    id: Filters.phaseCorrection.id,\n    label: `${Filters.phaseCorrection.name} ( Press a )`,\n    hasOptionPanel: true,\n    isFilter: true,\n  },\n  baseLineCorrection: {\n    id: 'baseLineCorrection',\n    label: 'baseline correction ( Press b )',\n    hasOptionPanel: true,\n    isFilter: true,\n  },\n  generalSelector: {\n    id: 'generalSelector',\n    label: 'range general selecttor',\n    hasOptionPanel: false,\n    isFilter: false,\n  },\n\n  editRange: {\n    id: 'editRange',\n    label: 'edit range',\n    hasOptionPanel: false,\n    isFilter: false,\n  },\n\n  multipleSpectraAnalysis: {\n    id: 'multipleSpectraAnalysis',\n    label: 'Multiple Spectra Analysis',\n    hasOptionPanel: false,\n    isFilter: false,\n  },\n  exclusionZones: {\n    id: 'exclusionZones',\n    label: 'Exclusion Zones',\n    hasOptionPanel: false,\n    isFilter: false,\n  },\n};\n","import { useContext } from 'react';\n\nimport { BrushContext } from '../EventsTrackers/BrushTracker';\nimport { useChartData } from '../context/ChartContext';\nimport { options } from '../toolbar/ToolTypes';\n\nconst styles = {\n  container: {\n    transformOrigin: 'top left',\n    position: 'absolute',\n    top: '0px',\n    left: '0px',\n    zoom: '100%',\n  },\n};\n\nconst allowTools = [\n  options.zoom.id,\n  options.zeroFilling.id,\n  options.peakPicking.id,\n  options.integral.id,\n  options.phaseCorrection.id,\n  options.baseLineCorrection.id,\n  options.rangesPicking.id,\n  options.zone2D.id,\n  options.slicingTool.id,\n  options.editRange.id,\n  options.multipleSpectraAnalysis.id,\n  options.exclusionZones.id,\n];\n\nexport const BRUSH_TYPE = {\n  X: 1,\n  Y: 2,\n  XY: 3,\n};\n\nfunction BrushXY({\n  brushType,\n  dimensionBorder,\n  width: widthProps,\n  height: heightProps,\n}) {\n  let { width, height, selectedTool } = useChartData();\n  let { startX, endX, startY, endY, step } = useContext(BrushContext);\n\n  if (\n    !allowTools.includes(selectedTool) ||\n    step !== 'brushing' ||\n    !dimensionBorder ||\n    (dimensionBorder.startX && startX < dimensionBorder.startX) ||\n    (dimensionBorder.startY && startY < dimensionBorder.startY) ||\n    ((dimensionBorder.endX && Math.sign(endX - startX) === 1\n      ? endX > dimensionBorder.endX\n      : endX < dimensionBorder.startX) &&\n      (dimensionBorder.endX && Math.sign(endY - startY) === 1\n        ? endY > dimensionBorder.endY\n        : endY < dimensionBorder.startY))\n  ) {\n    return null;\n  }\n\n  width = widthProps ? widthProps : width;\n\n  height = heightProps ? heightProps : height;\n\n  endX =\n    dimensionBorder.endX && endX > dimensionBorder.endX\n      ? dimensionBorder.endX\n      : dimensionBorder.startX && endX < dimensionBorder.startX\n      ? dimensionBorder.startX\n      : endX;\n  endY =\n    dimensionBorder.endY && endY > dimensionBorder.endY\n      ? dimensionBorder.endY\n      : dimensionBorder.startY && endY < dimensionBorder.startY\n      ? dimensionBorder.startY\n      : endY;\n\n  const scaleX =\n    brushType === BRUSH_TYPE.X || brushType === BRUSH_TYPE.XY\n      ? (endX - startX) / width\n      : 1;\n  startX =\n    brushType === BRUSH_TYPE.X || brushType === BRUSH_TYPE.XY ? startX : 0;\n\n  const scaleY =\n    brushType === BRUSH_TYPE.Y || brushType === BRUSH_TYPE.XY\n      ? (endY - startY) / height\n      : 1;\n  startY =\n    brushType === BRUSH_TYPE.Y || brushType === BRUSH_TYPE.XY ? startY : 0;\n  return (\n    <div\n      style={{\n        ...styles.container,\n        transform: `translate(${startX}px, ${startY}px) scale(${scaleX},${scaleY})`,\n        willChange: 'transform',\n      }}\n    >\n      <svg width={width} height={height}>\n        <rect\n          x=\"0\"\n          y=\"0\"\n          width={width}\n          height={height}\n          fill=\"gray\"\n          opacity=\"0.2\"\n        />\n      </svg>\n    </div>\n  );\n}\n\nBrushXY.defaultProps = {\n  brushType: BRUSH_TYPE.XY,\n  dimensionBorder: {\n    startX: 0,\n    startY: 0,\n  },\n  width: null,\n  height: null,\n};\n\nexport default BrushXY;\n","import { useContext } from 'react';\n\nimport { BrushContext } from '../EventsTrackers/BrushTracker';\nimport { MouseContext } from '../EventsTrackers/MouseTracker';\nimport { useChartData } from '../context/ChartContext';\nimport { options } from '../toolbar/ToolTypes';\n\nconst styles = {\n  line: {\n    stroke: 'black',\n    strokeOpacity: '1',\n    shapeRendering: 'crispEdges',\n    strokeWidth: '1',\n    willChange: 'transform',\n  },\n};\n\nconst allowTools = [\n  options.zoom.id,\n  options.equalizerTool.id,\n  options.baseLineCorrection.id,\n  options.zone2D.id,\n  options.slicingTool.id,\n  options.integral.id,\n  options.rangesPicking.id,\n  options.editRange.id,\n  options.multipleSpectraAnalysis.id,\n  options.exclusionZones.id,\n];\n\nfunction CrossLinePointer() {\n  const { height, width, margin, selectedTool } = useChartData();\n  let position = useContext(MouseContext);\n  const brushState = useContext(BrushContext);\n\n  if (\n    !allowTools.includes(selectedTool) ||\n    brushState.step === 'brushing' ||\n    !position ||\n    position.x > width - margin.right ||\n    position.y > height - margin.bottom ||\n    !width ||\n    !height\n  ) {\n    return null;\n  }\n  return (\n    <div\n      key=\"crossLine\"\n      style={{\n        willChange: 'transform',\n        cursor: 'crosshair',\n        transform: `translate(${-width + position.x}px, ${\n          -height + position.y\n        }px)`,\n        position: 'absolute',\n        top: 0,\n        left: 0,\n        pointerEvents: 'none',\n        overflow: 'visible',\n        width: 2 * width,\n        height: 2 * height,\n      }}\n    >\n      <svg width={2 * width} height={2 * height}>\n        <line\n          style={styles.line}\n          x1={width}\n          y1=\"0\"\n          x2={width}\n          y2={height * 2}\n          key=\"vertical_line\"\n        />\n        <line\n          style={styles.line}\n          x1=\"0\"\n          y1={height}\n          x2={width * 2}\n          y2={height}\n          key=\"horizontal_line\"\n        />\n      </svg>\n    </div>\n  );\n}\n\nexport default CrossLinePointer;\n","import EventEmitter from 'eventemitter3';\n\nconst eventEmitter = new EventEmitter();\n\nconst Emitter = {\n  on: (event, fn) => eventEmitter.on(event, fn),\n  once: (event, fn) => eventEmitter.once(event, fn),\n  off: (event, fn) => eventEmitter.off(event, fn),\n  emit: (event, payload) => eventEmitter.emit(event, payload),\n};\n\nObject.freeze(Emitter);\n\nexport default Emitter;\n","function DeleteButton({ x, y, onDelete, fill }) {\n  return (\n    <svg\n      className=\"delete-button\"\n      x={x}\n      y={y}\n      onClick={onDelete}\n      data-no-export=\"true\"\n    >\n      <rect rx=\"5\" width=\"16\" height=\"16\" fill={fill} />\n      <line x1=\"5\" x2=\"10\" y1=\"8\" y2=\"8\" stroke=\"white\" strokeWidth=\"2\" />\n    </svg>\n  );\n}\n\nDeleteButton.defaultProps = {\n  onDelete: () => null,\n  fill: '#c81121',\n  x: 'initial',\n  y: 'initial',\n};\n\nexport default DeleteButton;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\nimport { useDispatch } from '../context/DispatchContext';\nimport { useScale } from '../context/ScaleContext';\nimport DeleteButton from '../elements/DeleteButton';\nimport { DELETE_BASE_LINE_ZONE } from '../reducer/types/Types';\n\nconst styles = css`\n  pointer-events: bounding-box;\n  user-select: 'none';\n  -webkit-user-select: none; /* Chrome all / Safari all */\n  -moz-user-select: none; /* Firefox all */\n\n  .zone-area {\n    height: 100%;\n    fill: #b8b8b857;\n    cursor: pointer;\n  }\n  .delete-button {\n    display: none;\n    cursor: pointer;\n  }\n  :hover .delete-button {\n    display: block;\n  }\n`;\n\nfunction BaseLineZones() {\n  const { baseLineZones } = useChartData();\n\n  const { scaleX } = useScale();\n  const dispatch = useDispatch();\n\n  const deleteRangeHandler = useCallback(\n    (id) => {\n      dispatch({ type: DELETE_BASE_LINE_ZONE, id });\n    },\n    [dispatch],\n  );\n\n  return (\n    baseLineZones &&\n    Array.isArray(baseLineZones) &&\n    baseLineZones.length > 0 && (\n      <g>\n        {baseLineZones.map((zone) => (\n          <g\n            key={zone.id}\n            transform={`translate(${scaleX()(zone.to)},0)`}\n            css={styles}\n          >\n            <DeleteButton\n              x={-20}\n              y={10}\n              onDelete={() => deleteRangeHandler(zone.id)}\n            />\n            <rect\n              x=\"0\"\n              width={`${scaleX()(zone.from) - scaleX()(zone.to)}`}\n              className=\"zone-area\"\n            />\n          </g>\n        ))}\n      </g>\n    )\n  );\n}\n\nexport default BaseLineZones;\n","import { useChartData } from '../context/ChartContext';\n\nfunction ExclusionZonesWrapper(WrappedComponent) {\n  const Wrapper = (props) => {\n    const { exclusionZones, activeTab } = useChartData();\n\n    return (\n      <WrappedComponent\n        {...props}\n        exclusionZones={\n          exclusionZones[activeTab] ? exclusionZones[activeTab] : null\n        }\n      />\n    );\n  };\n\n  return (props) => {\n    return <Wrapper {...props} />;\n  };\n}\nexport default ExclusionZonesWrapper;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\n\nimport { useScale } from '../context/ScaleContext';\nimport { TYPES, useHighlight } from '../highlight';\nimport ExclusionZonesWrapper from '../hoc/ExclusionZonesWrapper';\n\nconst styles = css`\n  pointer-events: bounding-box;\n  user-select: 'none';\n  -webkit-user-select: none; /* Chrome all / Safari all */\n  -moz-user-select: none; /* Firefox all */\n\n  .zone-area {\n    height: 100%;\n    fill: #dddddd;\n    cursor: pointer;\n  }\n  .zone-area.active {\n    fill: #ff6f0057;\n  }\n`;\n\nconst ExclusionZone = ({ zone }) => {\n  const { scaleX } = useScale();\n  const highlight = useHighlight([zone.id], TYPES.EXCLUSION_ZONE);\n  return (\n    <g\n      key={zone.id}\n      transform={`translate(${scaleX()(zone.to)},0)`}\n      css={styles}\n      {...highlight.onHover}\n    >\n      <rect\n        x=\"0\"\n        width={`${scaleX()(zone.from) - scaleX()(zone.to)}`}\n        className={`zone-area ${highlight.isActive && 'active'}`}\n      />\n    </g>\n  );\n};\n\nfunction ExclusionZones({ exclusionZones }) {\n  if (!exclusionZones) return null;\n\n  return (\n    <g className=\"exclusionZones\">\n      {exclusionZones.map((zone) => (\n        <ExclusionZone key={zone.id} zone={zone} />\n      ))}\n    </g>\n  );\n}\n\nexport default ExclusionZonesWrapper(ExclusionZones);\n","const integralDefaultValues = {\n  showAbsolute: false,\n  absoluteFormat: '0.00',\n  showRelative: true,\n  relativeFormat: '0.00',\n  color: '#000000',\n  strokeWidth: 1,\n};\n\nconst rangeDefaultValues = {\n  showFrom: false,\n  fromFormat: '0.00',\n  showTo: false,\n  toFormat: '0.00',\n  showAbsolute: false,\n  absoluteFormat: '0.00',\n  showRelative: true,\n  relativeFormat: '0.00',\n};\n\nconst peaksDefaultValues = {\n  showPeakNumber: true,\n  peakNumberFormat: '0',\n  showPeakIndex: false,\n  peakIndexFormat: '0.00',\n  showDeltaPPM: true,\n  deltaPPMFormat: '0.00',\n  showDeltaHz: false,\n  deltaHzFormat: '0.00',\n  showPeakWidth: false,\n  peakWidthFormat: '00.0000',\n  showIntensity: true,\n  intensityFormat: '0.00',\n};\n\nexport { peaksDefaultValues, integralDefaultValues, rangeDefaultValues };\n","/** @jsxImportSource @emotion/react */\nimport { Fragment, useCallback, useRef, useState } from 'react';\nimport Draggable from 'react-draggable';\n\nimport { useChartData } from '../context/ChartContext';\nimport { useScale } from '../context/ScaleContext';\n\nfunction Resizable({ from, to, onDrag = () => null, onDrop }) {\n  const { height, margin, mode } = useChartData();\n  const [rightDragVisibility, setRightDragVisibility] = useState(false);\n  const [leftDragVisibility, setLeftDragVisibility] = useState(false);\n  const [enable, setEnable] = useState(true);\n  const draggableRightRef = useRef(null);\n  const draggableLeftRef = useRef(null);\n\n  const { scaleX } = useScale();\n\n  const handleRightStart = useCallback((e) => {\n    e.preventDefault();\n    e.stopPropagation();\n    setRightDragVisibility(true);\n  }, []);\n  const handleRightDrag = useCallback(\n    (e) => {\n      onDrag({ from: scaleX().invert(e.layerX) });\n    },\n    [onDrag, scaleX],\n  );\n  const handleRightStop = useCallback(\n    (e) => {\n      e.preventDefault();\n      e.stopPropagation();\n\n      setRightDragVisibility(false);\n\n      const _range =\n        mode === 'RTL'\n          ? [scaleX().invert(e.layerX), to]\n          : [to, scaleX().invert(e.layerX)];\n\n      let resized;\n      if (_range[1] > _range[0]) {\n        resized = {\n          from: _range[0],\n          to: _range[1],\n        };\n      } else {\n        resized = {\n          from,\n          to,\n        };\n      }\n\n      onDrop(resized);\n    },\n    [from, mode, onDrop, scaleX, to],\n  );\n\n  const handleLeftStart = useCallback((e) => {\n    e.preventDefault();\n    e.stopPropagation();\n    setLeftDragVisibility(true);\n  }, []);\n  const handleLeftDrag = useCallback(\n    (e) => {\n      onDrag({ to: scaleX().invert(e.layerX) });\n    },\n    [onDrag, scaleX],\n  );\n  const handleLeftStop = useCallback(\n    (e) => {\n      e.preventDefault();\n      e.stopPropagation();\n\n      setLeftDragVisibility(false);\n      const _range =\n        mode === 'RTL'\n          ? [from, scaleX().invert(e.layerX)]\n          : [scaleX().invert(e.layerX), from];\n\n      let resized;\n      if (_range[1] > _range[0]) {\n        resized = {\n          from: _range[0],\n          to: _range[1],\n        };\n      } else {\n        resized = {\n          from,\n          to,\n        };\n      }\n\n      onDrop(resized);\n    },\n    [from, mode, onDrop, scaleX, to],\n  );\n\n  const mouseDownCaptureHandler = useCallback(({ shiftKey }) => {\n    if (shiftKey) {\n      setEnable(false);\n    }\n  }, []);\n  const mouseUpCaptureHandler = useCallback(() => {\n    setEnable(true);\n  }, []);\n  const mouseOverHandler = useCallback(({ target, shiftKey }) => {\n    if (shiftKey) {\n      target.style.cursor = 'crosshair';\n    } else {\n      target.style.cursor = 'ew-resize';\n    }\n  }, []);\n\n  return (\n    <Fragment>\n      <Draggable\n        axis=\"x\"\n        defaultPosition={{\n          x: scaleX()(from),\n          y: 0,\n        }}\n        position={{\n          x: scaleX()(from),\n          y: 0,\n        }}\n        scale={1}\n        handle=\".handle\"\n        onStart={handleRightStart}\n        onDrag={handleRightDrag}\n        onStop={handleRightStop}\n        nodeRef={draggableRightRef}\n      >\n        <rect\n          ref={draggableRightRef}\n          className={enable ? 'handle' : ''}\n          width={rightDragVisibility ? 1 : 6}\n          fill=\"red\"\n          height={height + margin.top}\n          style={{ fillOpacity: rightDragVisibility ? 1 : 0 }}\n          onMouseDownCapture={mouseDownCaptureHandler}\n          onMouseUpCapture={mouseUpCaptureHandler}\n          onMouseEnter={mouseOverHandler}\n        />\n      </Draggable>\n\n      <Draggable\n        axis=\"x\"\n        defaultPosition={{\n          x: scaleX()(to),\n          y: 0,\n        }}\n        position={{\n          x: scaleX()(to),\n          y: 0,\n        }}\n        handle=\".handle\"\n        scale={1}\n        onStart={handleLeftStart}\n        onDrag={handleLeftDrag}\n        onStop={handleLeftStop}\n        nodeRef={draggableLeftRef}\n      >\n        <rect\n          ref={draggableLeftRef}\n          className={enable ? 'handle' : ''}\n          width={leftDragVisibility ? 1 : 6}\n          fill=\"red\"\n          height={height + margin.top}\n          style={{ fillOpacity: leftDragVisibility ? 1 : 0 }}\n          onMouseDownCapture={mouseDownCaptureHandler}\n          onMouseUpCapture={mouseUpCaptureHandler}\n          onMouseEnter={mouseOverHandler}\n        />\n      </Draggable>\n    </Fragment>\n  );\n}\n\nexport default Resizable;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback, Fragment, useState } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\nimport { useDispatch } from '../context/DispatchContext';\nimport { useScale } from '../context/ScaleContext';\nimport { TYPES, useHighlight } from '../highlight/index';\nimport { RESIZE_INTEGRAL } from '../reducer/types/Types';\n\nimport Resizable from './Resizable';\n\nconst stylesOnHover = css`\n  pointer-events: bounding-box;\n  @-moz-document url-prefix() {\n    pointer-events: fill;\n  }\n  // // disabled because Resizable component appears now when hovering over it\n  // :hover .target {\n  //   visibility: visible !important;\n  //   cursor: pointer;\n  // }\n  .highlight {\n    fill: transparent;\n  }\n  .target {\n    visibility: hidden;\n  }\n`;\n\nconst stylesHighlighted = css`\n  pointer-events: bounding-box;\n\n  @-moz-document url-prefix() {\n    pointer-events: fill;\n  }\n  fill: #ff6f0057;\n\n  .target {\n    visibility: visible;\n  }\n`;\n\nfunction IntegralResizable({ integralData }) {\n  const { height, margin } = useChartData();\n  const { scaleX } = useScale();\n\n  const [{ id, integral, from, to }, setIntgral] = useState(integralData);\n\n  const highlight = useHighlight([id], TYPES.INTEGRAL);\n\n  const dispatch = useDispatch();\n\n  const handleOnStopResizing = useCallback(\n    (resized) => {\n      dispatch({\n        type: RESIZE_INTEGRAL,\n        data: { ...integralData, ...resized },\n      });\n    },\n    [dispatch, integralData],\n  );\n\n  const handleOnEnterNotation = useCallback(() => {\n    highlight.show();\n  }, [highlight]);\n\n  const handleOnMouseLeaveNotation = useCallback(() => {\n    highlight.hide();\n  }, [highlight]);\n\n  const dragHandler = useCallback((boundary) => {\n    setIntgral((integral) => ({ ...integral, ...boundary }));\n  }, []);\n\n  const x0 = from ? scaleX()(from) : 0;\n  const x1 = to ? scaleX()(to) : 0;\n\n  return (\n    <Fragment>\n      <g\n        css={highlight.isActive ? stylesHighlighted : stylesOnHover}\n        onMouseEnter={handleOnEnterNotation}\n        onMouseLeave={handleOnMouseLeaveNotation}\n      >\n        <rect\n          data-no-export=\"true\"\n          x={`${x1}`}\n          y=\"0\"\n          width={`${x0 - x1}`}\n          height={height - margin.bottom}\n          className=\"highlight\"\n        />\n        {/* {highlight.isActive && ( */}\n        <text\n          x={x1}\n          y={height - margin.bottom + 30}\n          fill=\"black\"\n          style={{ fontSize: '12px', fontWeight: 'bold' }}\n        >\n          {integral !== undefined ? integral.toFixed(2) : ''}\n        </text>\n        {/* )} */}\n        <Resizable\n          from={integralData.from}\n          to={integralData.to}\n          onDrag={dragHandler}\n          onDrop={handleOnStopResizing}\n          data-no-export=\"true\"\n        />\n      </g>\n    </Fragment>\n  );\n}\n\nexport default IntegralResizable;\n","import { xyReduce, xyIntegral } from 'ml-spectra-processing';\nimport { useCallback, Fragment, useMemo } from 'react';\n\nimport { usePreferences } from '../context/PreferencesContext';\nimport { integralDefaultValues } from '../panels/extra/preferences/defaultValues';\nimport { getValue } from '../utility/LocalStorage';\n\nimport IntegralResizable from './IntegralResizable';\n\nfunction Integral({\n  integralData,\n  x,\n  y,\n  xDomain,\n  isActive,\n  spectrumID,\n  scaleY,\n  scaleX,\n}) {\n  const { from, to } = integralData;\n  // const { preferences } = useChartData();\n  const preferences = usePreferences();\n\n  const integralSettings = useMemo(() => {\n    let {\n      color = integralDefaultValues.color,\n      strokeWidth = integralDefaultValues.strokeWidth,\n    } = getValue(preferences, 'formatting.panels.integrals') || {};\n    return { color, strokeWidth };\n  }, [preferences]);\n\n  const integral = useMemo(() => {\n    return xyIntegral(\n      { x: x, y: y },\n      {\n        from: from,\n        to: to,\n        reverse: true,\n      },\n    );\n  }, [from, to, x, y]);\n\n  const makePath = useCallback(() => {\n    if (integral && scaleY) {\n      const pathPoints = xyReduce(integral, {\n        from: xDomain[0],\n        to: xDomain[1],\n        nbPoints: 200,\n        optimize: true,\n      });\n\n      let path = `M ${scaleX()(pathPoints.x[0])} ${scaleY(pathPoints.y[0])}`;\n      path += pathPoints.x.slice(1).reduce((accumulator, point, i) => {\n        accumulator += ` L ${scaleX()(point)} ${scaleY(pathPoints.y[i + 1])}`;\n        return accumulator;\n      }, '');\n\n      return path;\n    } else {\n      return '';\n    }\n  }, [integral, scaleX, scaleY, xDomain]);\n\n  return (\n    <Fragment>\n      <path\n        className=\"line\"\n        stroke={integralSettings.color}\n        strokeWidth={integralSettings.strokeWidth}\n        fill=\"none\"\n        style={{\n          transformOrigin: 'center top',\n          opacity: isActive ? 1 : 0.2,\n        }}\n        d={makePath()}\n        // vectorEffect=\"non-scaling-stroke\"\n      />\n\n      <IntegralResizable\n        spectrumID={spectrumID}\n        integralData={integralData}\n        scaleY={scaleY}\n      />\n    </Fragment>\n  );\n}\n\nexport default Integral;\n","import { useMemo } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\nimport { useScale } from '../context/ScaleContext';\n\nimport Integral from './Integral';\nimport { getIntegralYScale } from './utilities/scale';\n\nfunction IntegralsSeries() {\n  const {\n    xDomain,\n    activeSpectrum,\n    data,\n    height,\n    margin,\n    verticalAlign,\n    integralsYDomains,\n    displayerKey,\n  } = useChartData();\n  const { scaleX } = useScale();\n\n  const scaleY = useMemo(() => {\n    if (activeSpectrum && integralsYDomains[activeSpectrum.id]) {\n      return getIntegralYScale(\n        { height, margin, verticalAlign, integralsYDomains },\n        activeSpectrum.id,\n      );\n    } else {\n      return null;\n    }\n  }, [activeSpectrum, height, integralsYDomains, margin, verticalAlign]);\n\n  const Integrals = useMemo(() => {\n    const IsActive = (id) => {\n      return activeSpectrum === null\n        ? true\n        : id === activeSpectrum.id\n        ? true\n        : false;\n    };\n\n    return (\n      data &&\n      data[0] &&\n      data\n        .filter(\n          (d) =>\n            d.display.isVisible === true &&\n            d.display.isVisibleInDomain === true,\n        )\n        .map(\n          (spectrum) =>\n            spectrum.integrals &&\n            spectrum.integrals.values &&\n            spectrum.integrals.values.map((integral) => (\n              <Integral\n                key={integral.id}\n                spectrumID={spectrum.id}\n                integralData={integral}\n                x={spectrum.data.x}\n                y={spectrum.data.y}\n                isActive={IsActive(spectrum.id)}\n                xDomain={xDomain}\n                scaleY={scaleY}\n                scaleX={scaleX}\n              />\n            )),\n        )\n    );\n  }, [activeSpectrum, data, scaleX, scaleY, xDomain]);\n\n  return <g clipPath={`url(#${displayerKey}clip-chart-1d)`}>{Integrals}</g>;\n}\n\nexport default IntegralsSeries;\n","import get from 'lodash/get';\nimport { xyReduce } from 'ml-spectra-processing';\nimport { useMemo } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\nimport { usePreferences } from '../context/PreferencesContext';\nimport { useScale } from '../context/ScaleContext';\n\nfunction Line({ data, id, display, index }) {\n  const { xDomain, activeSpectrum, verticalAlign } = useChartData();\n  const preferences = usePreferences();\n  const { scaleX, scaleY } = useScale();\n\n  const isActive = useMemo(() => {\n    return activeSpectrum === null\n      ? true\n      : id === activeSpectrum.id\n      ? true\n      : false;\n  }, [activeSpectrum, id]);\n\n  const vAlign = useMemo(() => {\n    return verticalAlign.flag\n      ? verticalAlign.stacked\n        ? index * verticalAlign.value\n        : 0\n      : 0;\n  }, [index, verticalAlign.flag, verticalAlign.stacked, verticalAlign.value]);\n\n  const paths = useMemo(() => {\n    const _scaleX = scaleX();\n    const _scaleY = scaleY(id);\n    if (data?.x && data?.y && _scaleX(0)) {\n      const pathPoints = xyReduce(\n        { x: data.x, y: data.y },\n        {\n          from: xDomain[0],\n          to: xDomain[1],\n        },\n      );\n\n      let path = `M ${_scaleX(pathPoints.x[0])} ${_scaleY(pathPoints.y[0])} `;\n      path += pathPoints.x.slice(1).reduce((accumulator, point, i) => {\n        accumulator += ` L ${_scaleX(point)} ${_scaleY(pathPoints.y[i + 1])}`;\n        return accumulator;\n      }, '');\n      return path;\n    } else {\n      return '';\n    }\n  }, [id, scaleX, scaleY, data, xDomain]);\n\n  return (\n    <path\n      className=\"line\"\n      key={id}\n      stroke={display.color}\n      fill=\"none\"\n      style={{\n        opacity: isActive\n          ? 1\n          : get(preferences, 'controllers.dimmedSpectraTransparency', 0.1),\n      }}\n      d={paths}\n      transform={`translate(0,-${vAlign})`}\n    />\n  );\n}\n\nexport default Line;\n","import { useChartData } from '../context/ChartContext';\n\nimport Line from './Line';\n\nfunction LinesSeries() {\n  const { data, tempData, displayerKey } = useChartData();\n\n  const _data = tempData ? tempData : data;\n\n  return (\n    <g clipPath={`url(#${displayerKey}clip-chart-1d)`}>\n      {_data &&\n        _data\n          .filter(\n            (d) =>\n              d.display.isVisible === true &&\n              d.display.isVisibleInDomain === true,\n          )\n          .map((d, i) => <Line key={d.id} {...d} index={i} />)}\n    </g>\n  );\n}\n\nexport default LinesSeries;\n","import lodashGet from 'lodash/get';\nimport Numeral from 'numeral';\n\nimport { usePreferences } from '../context/PreferencesContext';\n// let getNuclusFormat = memoize(getDefaultNuclusFormat);\n\nfunction FormatNumber(value, format, prefix = '', suffix = '') {\n  return prefix + Numeral(value).format(format) + suffix;\n}\n\n/**\n *\n * @param {string|Array} nucleus\n */\nexport function useFormatNumberByNucleus(nucleus) {\n  const preferences = usePreferences();\n  const nucleusByKey = lodashGet(preferences, `formatting.nucleusByKey`, {\n    ppm: '0.0',\n    hz: '0.0',\n  });\n\n  const formatFun = (n) => (\n    value,\n    formatKey = 'ppm',\n    prefix = '',\n    suffix = '',\n  ) => {\n    return (\n      prefix +\n      Numeral(Number(value)).format(\n        lodashGet(nucleusByKey, `${n.toLowerCase()}.${formatKey}`, '0.0'),\n      ) +\n      suffix\n    );\n  };\n\n  if (!nucleus) {\n    return;\n  }\n\n  if (typeof nucleus === 'string') {\n    return formatFun(nucleus);\n  } else if (Array.isArray(nucleus)) {\n    return nucleus.map((n) => formatFun(n));\n  } else {\n    throw Error('nuclus must be string or array of string');\n  }\n}\n\n/**\n * @param {number|string} value\n */\nexport function getNumberOfDecimals(value) {\n  value = String(value).trim();\n  const lastIndex = value.lastIndexOf('.');\n  return lastIndex > 0 ? value.substr(lastIndex).split('').length - 1 : 0;\n}\n\nexport default FormatNumber;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport {\n  useRef,\n  useState,\n  useCallback,\n  useLayoutEffect,\n  useEffect,\n  Fragment,\n  useMemo,\n} from 'react';\n\nimport { useDispatch } from '../context/DispatchContext';\nimport { TYPES, useHighlight } from '../highlight';\nimport { SHIFT_SPECTRUM } from '../reducer/types/Types';\nimport { useFormatNumberByNucleus } from '../utility/FormatNumber';\n\nconst styles = css`\n  text,\n  input {\n    -webkit-user-select: none; /* Safari 3.1+ */\n    -moz-user-select: none; /* Firefox 2+ */\n    -ms-user-select: none; /* IE 10+ */\n    user-select: none; /* Standard syntax */\n  }\n\n  input[type='number']::-webkit-outer-spin-button,\n  input[type='number']::-webkit-inner-spin-button {\n    -webkit-appearance: none;\n    margin: 0;\n  }\n\n  input[type='number'] {\n    -moz-appearance: textfield;\n  }\n\n  .notification-input {\n    width: calc(100% - 10px) !important;\n    user-select: 'none';\n    -webkit-user-select: none; /* Chrome all / Safari all */\n    -moz-user-select: none; /* Firefox all */\n  }\n\n  .notification-input-normal {\n    opacity: 1;\n    left: 4px;\n    position: absolute;\n    font-size: 10px;\n    outline: none;\n    user-select: 'none';\n    -webkit-user-select: none; /* Chrome all / Safari all */\n    -moz-user-select: none; /* Firefox all */\n    background-color: transparent;\n  }\n\n  .notification-input-normal input:focus {\n    outline: none;\n    background-color: white;\n  }\n\n  .input-over {\n    background-color: white;\n    outline: none;\n  }\n\n  .notification-label {\n    display: none;\n  }\n\n  .notification-group-over {\n    z-index: 9999999999;\n  }\n\n  .notification-group {\n    z-index: 1;\n  }\n\n  .notifcate-selected {\n    opacity: 0;\n  }\n\n  input[type='number']::-webkit-inner-spin-button,\n  input[type='number']::-webkit-outer-spin-button {\n    -webkit-appearance: none;\n    margin: 0;\n  }\n`;\n\nfunction PeakNotation({\n  id,\n  x,\n  y,\n  sign, // 1 positive -1 negative\n  value,\n  color,\n  isActive,\n  nucleus,\n}) {\n  const refText = useRef();\n  const [isSelected, setIsSelected] = useState(false);\n  const [_value, setValue] = useState(value);\n  const [containerSize, setContainerSize] = useState({ width: 0, height: 0 });\n  const format = useFormatNumberByNucleus(nucleus);\n  const highlight = useHighlight([id], TYPES.PEAK);\n\n  const dispatch = useDispatch();\n\n  const handleOnPeakChange = useCallback(\n    (e) => dispatch({ type: SHIFT_SPECTRUM, shiftValue: e.shiftValue }),\n    [dispatch],\n  );\n\n  useLayoutEffect(() => {\n    const textBox = refText.current.getBBox();\n    setContainerSize({ width: textBox.width, height: textBox.height });\n  }, [isSelected]);\n\n  useEffect(() => {\n    setValue(value);\n  }, [value]);\n\n  const handleKeyDown = useCallback(\n    (event) => {\n      if (event.key === 'Enter') {\n        const newValue = parseFloat(event.target.value);\n        const oldValue = parseFloat(value);\n        const shiftValue = parseFloat(event.target.value) - parseFloat(value);\n\n        handleOnPeakChange({\n          id,\n          value: newValue,\n          oldValue: oldValue,\n          shiftValue: shiftValue,\n        });\n\n        event.target.blur();\n        setIsSelected(false);\n      } else if (event.keyCode === 27) {\n        setValue(value);\n        event.target.blur();\n        setIsSelected(false);\n      }\n    },\n    [value, handleOnPeakChange, id],\n  );\n\n  const handleChange = useCallback((event) => {\n    setValue(event.target.value);\n  }, []);\n\n  const handleSelectPeakNotation = useCallback((e) => {\n    e.preventDefault();\n    e.stopPropagation();\n    setIsSelected(true);\n    return false;\n  }, []);\n\n  const handleOnEnterNotation = useCallback(() => {\n    highlight.show();\n  }, [highlight]);\n\n  const handleOnMouseLeaveNotation = useCallback(() => {\n    highlight.hide();\n  }, [highlight]);\n\n  const newValue = useMemo(() => (isSelected ? value : format(value)), [\n    format,\n    isSelected,\n    value,\n  ]);\n  const oldValue = useMemo(() => (isSelected ? _value : format(_value)), [\n    _value,\n    format,\n    isSelected,\n  ]);\n\n  return (\n    <Fragment>\n      <g\n        css={styles}\n        id={id}\n        style={{ outline: 'none' }}\n        transform={`translate(${x}, ${y})`}\n        onMouseEnter={handleOnEnterNotation}\n        onMouseLeave={handleOnMouseLeaveNotation}\n        // onKeyDown={keyDownHandler}\n      >\n        <line\n          x1=\"0\"\n          x2=\"0\"\n          y1={sign === -1 ? 10 : 0}\n          y2={sign === -1 ? 28 : -18}\n          stroke={color}\n          strokeWidth={highlight.isActive ? '7px' : '1px'}\n        />\n        <text\n          ref={refText}\n          className=\"peaks-text\"\n          x=\"0\"\n          y={sign === -1 ? 28 : -12}\n          dy=\"0\"\n          dx=\"0.35em\"\n          fill=\"transparent\"\n          fontSize=\"10px\"\n          fontWeight=\"100\"\n          style={{\n            position: 'absolute',\n          }}\n        >\n          {newValue}\n        </text>\n        <foreignObject\n          x=\"0\"\n          y={sign === -1 ? 16 : -22}\n          dy=\"0.1em\"\n          dx=\"0.35em\"\n          width={containerSize.width + 20}\n          height=\"40px\"\n          data-no-export=\"true\"\n        >\n          <div\n            style={{\n              width: containerSize.width + 20,\n              height: '100%',\n              paddingRight: 5,\n            }}\n            xmlns=\"http://www.w3.org/1999/xhtml\"\n          >\n            <input\n              onClick={handleSelectPeakNotation}\n              className={\n                isSelected\n                  ? 'notification-input input-over'\n                  : 'notification-input-normal'\n              }\n              style={{\n                width: 'inherit',\n                border: isSelected ? `1px solid ${color}` : `0`,\n                opacity: isActive ? 1 : 0.2,\n                userSelect: 'none',\n                color: color,\n              }}\n              value={oldValue}\n              onKeyDown={handleKeyDown}\n              onChange={handleChange}\n              type=\"number\"\n              disabled={!isActive}\n            />\n          </div>\n        </foreignObject>\n      </g>\n    </Fragment>\n  );\n}\n\nexport default PeakNotation;\n","import { useMemo } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\nimport { useScale } from '../context/ScaleContext';\n\nimport PeakNotation from './PeakNotation';\n\nfunction PeaksNotations() {\n  const { data, activeSpectrum, verticalAlign, displayerKey } = useChartData();\n  const { scaleX, scaleY } = useScale();\n\n  const Peaks = useMemo(() => {\n    const getVerticalAlign = (id) => {\n      const i = data.findIndex((d) => d.id === id);\n      return verticalAlign.flag\n        ? verticalAlign.stacked\n          ? (i + 1) * verticalAlign.value\n          : 0\n        : 0;\n    };\n\n    const reSortData = () => {\n      const _data = [...data];\n      return activeSpectrum\n        ? _data.sort(function (x, y) {\n            return x.id === activeSpectrum.id\n              ? 1\n              : y.id === activeSpectrum.id\n              ? -1\n              : 0;\n          })\n        : _data;\n    };\n\n    return (\n      data &&\n      reSortData()\n        .filter(\n          (d) =>\n            d.display.isVisible === true &&\n            d.display.isVisibleInDomain === true,\n        )\n        .map((d) => {\n          return (\n            d.peaks &&\n            d.peaks.values &&\n            d.display.isPeaksMarkersVisible && (\n              <g\n                key={d.id}\n                transform={`translate(0,-${getVerticalAlign(d.id)})`}\n              >\n                {d.peaks.values.map(({ delta, intensity, id }) => (\n                  <PeakNotation\n                    key={id}\n                    x={scaleX()(delta)}\n                    y={scaleY(d.id)(intensity) - 5}\n                    sign={Math.sign(intensity)}\n                    id={id}\n                    spectrumID={d.id}\n                    value={delta}\n                    color=\"#730000\"\n                    nucleus={d.info.nucleus}\n                    isActive={\n                      activeSpectrum == null\n                        ? false\n                        : activeSpectrum.id === d.id\n                        ? true\n                        : false\n                    }\n                  />\n                ))}\n              </g>\n            )\n          );\n        })\n    );\n  }, [\n    data,\n    verticalAlign.flag,\n    verticalAlign.stacked,\n    verticalAlign.value,\n    activeSpectrum,\n    scaleX,\n    scaleY,\n  ]);\n\n  return (\n    <g className=\"peaks\" clipPath={`url(#${displayerKey}clip-chart-1d)`}>\n      {Peaks}\n    </g>\n  );\n}\n\nexport default PeaksNotations;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport * as d3 from 'd3';\nimport PropTypes from 'prop-types';\nimport { useEffect, useRef, useMemo } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\nimport { useScale } from '../context/ScaleContext';\n\nconst axisStyles = css`\n  user-select: none;\n\n  path,\n  line {\n    fill: none;\n    stroke: black;\n    stroke-width: 1;\n    shape-rendering: crispEdges;\n    user-select: none;\n  }\n`;\n\nconst gridStyles = css`\n  user-select: none;\n\n  line {\n    stroke: rgb(104, 104, 104);\n    stroke-opacity: 0.2;\n    shape-rendering: crispEdges;\n    stroke-dasharray: 3;\n    stroke-width: 1;\n    user-select: none;\n  }\n\n  path {\n    stroke-width: 0;\n  }\n`;\n\nfunction XAxis({ label, show, showGrid, mode }) {\n  const { xDomain, height, width, margin } = useChartData();\n  const { scaleX } = useScale();\n\n  const refAxis = useRef();\n  const refGrid = useRef();\n\n  label = label ? label : mode === 'RTL' ? ' [ppm]' : 'time [s]';\n\n  useEffect(() => {\n    const xAxis = d3.axisBottom().ticks(8).tickFormat(d3.format('0'));\n    const grid = d3\n      .axisBottom()\n      .ticks(50)\n      .tickSize(-(height - margin.top - margin.bottom))\n      .tickFormat('');\n    if (show && scaleX) {\n      d3.select(refAxis.current).call(xAxis.scale(scaleX().domain(xDomain)));\n      d3.select(refGrid.current).call(grid.scale(scaleX().domain(xDomain)));\n    }\n  }, [height, margin.bottom, margin.top, scaleX, show, xDomain]);\n\n  const Axis = useMemo(\n    () =>\n      show &&\n      show === true && (\n        <g\n          className=\"x\"\n          css={axisStyles}\n          transform={`translate(0,${height - margin.bottom})`}\n          ref={refAxis}\n        >\n          <text fill=\"#000\" x={width - 10} y=\"30\" dy=\"0.70em\" textAnchor=\"end\">\n            {label}\n          </text>\n        </g>\n      ),\n\n    [height, label, margin.bottom, show, width],\n  );\n\n  const Grid = useMemo(\n    () =>\n      showGrid &&\n      showGrid === true && (\n        <g\n          css={gridStyles}\n          className=\"grid\"\n          ref={refGrid}\n          transform={`translate(0,${height - margin.bottom})`}\n        />\n      ),\n\n    [showGrid, height, margin.bottom],\n  );\n  if (!width || !height || !scaleX) {\n    return null;\n  }\n\n  return (\n    <>\n      {Axis}\n      {Grid}\n    </>\n  );\n}\n\nXAxis.propTypes = {\n  showGrid: PropTypes.bool,\n  show: PropTypes.bool,\n  label: PropTypes.string,\n};\n\nXAxis.defaultProps = {\n  showGrid: false,\n  show: true,\n  label: '',\n};\n\nexport default XAxis;\n","import { forwardRef } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\n\nfunction MultiAnalysisWrapper(WrappedComponent) {\n  const Wrapper = (props) => {\n    const { activeTab, spectraAnalysis, displayerKey } = useChartData();\n    const { forwardedRef, ...rest } = props;\n\n    return (\n      <WrappedComponent\n        {...rest}\n        activeTab={activeTab}\n        spectraAnalysis={spectraAnalysis}\n        displayerKey={displayerKey}\n        ref={forwardedRef}\n      />\n    );\n  };\n  return forwardRef((props, ref) => {\n    return <Wrapper {...props} forwardedRef={ref} />;\n  });\n}\nexport default MultiAnalysisWrapper;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback } from 'react';\n\nimport { useDispatch } from '../../context/DispatchContext';\nimport { useScale } from '../../context/ScaleContext';\nimport DeleteButton from '../../elements/DeleteButton';\nimport { useHighlight } from '../../highlight';\nimport {\n  DELETE_ANALYZE_SPECTRA_RANGE,\n  RESIZE_ANALYZE_SPECTRA_RANGE,\n} from '../../reducer/types/Types';\nimport Resizable from '../Resizable';\n\nconst stylesOnHover = css`\n  pointer-events: bounding-box;\n  @-moz-document url-prefix() {\n    pointer-events: fill;\n  }\n  user-select: 'none';\n  -webkit-user-select: none; /* Chrome all / Safari all */\n  -moz-user-select: none; /* Firefox all */\n\n  .delete-button {\n    visibility: hidden;\n  }\n`;\n\nconst stylesHighlighted = css`\n  pointer-events: bounding-box;\n\n  @-moz-document url-prefix() {\n    pointer-events: fill;\n  }\n  .range-area {\n    height: 100%;\n    fill: #ff6f0057;\n  }\n  .delete-button {\n    visibility: visible;\n    cursor: pointer;\n  }\n`;\n\nfunction AnalysisRange({ rangeData, columnKey }) {\n  const { from, to } = rangeData;\n  const highlight = useHighlight([columnKey]);\n  const { scaleX } = useScale();\n  const dispatch = useDispatch();\n\n  const deleteHandler = useCallback(() => {\n    dispatch({ type: DELETE_ANALYZE_SPECTRA_RANGE, colKey: columnKey });\n  }, [columnKey, dispatch]);\n\n  const handleOnStopResizing = useCallback(\n    (resized) => {\n      dispatch({\n        type: RESIZE_ANALYZE_SPECTRA_RANGE,\n        payload: { ...rangeData, ...resized, columnKey },\n      });\n    },\n    [columnKey, dispatch, rangeData],\n  );\n\n  return (\n    <g\n      {...highlight.onHover}\n      css={highlight.isActive ? stylesHighlighted : stylesOnHover}\n    >\n      <g transform={`translate(${scaleX()(to)},25)`}>\n        <rect\n          x=\"0\"\n          width={scaleX()(from) - scaleX()(to)}\n          height=\"6\"\n          className=\"range-area\"\n          fill=\"green\"\n        />\n        <text\n          textAnchor=\"middle\"\n          x={(scaleX()(from) - scaleX()(to)) / 2}\n          y=\"-5\"\n          fontSize=\"12\"\n          fill=\"red\"\n          fontWeight=\"bolder\"\n          fillOpacity={highlight.isActive ? 1 : 0.6}\n        >\n          {columnKey}\n        </text>\n      </g>\n      <Resizable\n        from={rangeData.from}\n        to={rangeData.to}\n        onDrop={handleOnStopResizing}\n      />\n      <DeleteButton x={scaleX()(to) - 20} y={10} onDelete={deleteHandler} />\n    </g>\n  );\n}\n\nexport default AnalysisRange;\n","import { memo, useMemo } from 'react';\n\nimport MultiAnalysisWrapper from '../../hoc/MultiAnalysisWrapper';\n\nimport AnalysisRange from './AnalysisRange';\n\nfunction MultiAnalysisRanges({ activeTab, spectraAnalysis, displayerKey }) {\n  const columns = useMemo(() => {\n    const {\n      options: { columns },\n    } = spectraAnalysis[activeTab] || {\n      options: { columns: {} },\n    };\n    return columns;\n  }, [activeTab, spectraAnalysis]);\n\n  const ranges = useMemo(() => {\n    return Object.keys(columns).map((key) => key, []);\n  }, [columns]);\n\n  if (!ranges || ranges.length === 0) {\n    return null;\n  }\n\n  return (\n    <g clipPath={`url(#${displayerKey}clip-chart-1d)`}>\n      {ranges.map((columnKey) => (\n        <AnalysisRange\n          key={columnKey}\n          columnKey={columnKey}\n          rangeData={columns[columnKey]}\n        />\n      ))}\n    </g>\n  );\n}\n\nexport default MultiAnalysisWrapper(memo(MultiAnalysisRanges));\n","import { useMemo, memo, forwardRef } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\nimport { usePreferences } from '../context/PreferencesContext';\n\nfunction RangesWrapper(WrappedComponent) {\n  const Wrapper = (props) => {\n    const {\n      data,\n      activeSpectrum,\n      xDomain,\n      activeTab,\n      molecules,\n      tabActiveSpectrum,\n      displayerKey,\n      selectedTool,\n    } = useChartData();\n    const preferences = usePreferences();\n\n    const { ranges = {}, x = [], y = [], info = {} } = useMemo(() => {\n      if (data && activeSpectrum && activeSpectrum.id) {\n        const datum = data.find((datum) => datum.id === activeSpectrum.id) || {\n          ranges: {},\n          x: [],\n          y: [],\n          info: {},\n        };\n        return datum;\n      }\n      return {};\n    }, [activeSpectrum, data]);\n\n    const nucleus = useMemo(() => {\n      if (tabActiveSpectrum && Object.keys(tabActiveSpectrum).length > 0) {\n        return Object.keys(tabActiveSpectrum);\n      }\n      return null;\n    }, [tabActiveSpectrum]);\n\n    const { forwardedRef, ...rest } = props;\n    return (\n      <WrappedComponent\n        {...rest}\n        ranges={ranges}\n        x={x}\n        y={y}\n        info={info}\n        xDomain={xDomain}\n        preferences={preferences}\n        activeTab={activeTab}\n        molecules={molecules}\n        nucleus={nucleus}\n        displayerKey={displayerKey}\n        selectedTool={selectedTool}\n        ref={forwardedRef}\n      />\n    );\n  };\n\n  return memo(\n    forwardRef((props, ref) => {\n      return <Wrapper {...props} forwardedRef={ref} />;\n    }),\n  );\n}\nexport default RangesWrapper;\n","const SignalKinds = [\n  {\n    key: 'signal',\n    label: 'Signal',\n    value: 'signal',\n  },\n  {\n    key: 'reference',\n    label: 'Reference',\n    value: 'reference',\n  },\n  {\n    key: 'solvent',\n    label: 'Solvent',\n    value: 'solvent',\n  },\n  {\n    key: 'impurity',\n    label: 'Impurity',\n    value: 'impurity',\n  },\n  {\n    key: 'standard',\n    label: 'Standard',\n    value: 'standard',\n  },\n  {\n    key: 'p1',\n    label: 'P1',\n    value: 'p1',\n  },\n  {\n    key: 'p2',\n    label: 'P2',\n    value: 'p2',\n  },\n  {\n    key: 'p3',\n    label: 'P3',\n    value: 'p3',\n  },\n];\n\nconst SignalKindsToInclude = ['signal'];\nconst DatumKind = { signal: 'signal', mixed: 'mixed' };\n\nexport { SignalKinds, SignalKindsToInclude, DatumKind };\n","import { DatumKind } from '../constants/SignalsKinds';\n\nconst getDiaIDs = (range) => {\n  return [].concat(\n    range.diaID || [],\n    range.signal\n      ? range.signal.map((_signal) => _signal.diaID || []).flat()\n      : [],\n  );\n};\n\nconst getPubIntegral = (range) => {\n  return getDiaIDs(range).length;\n};\n\nconst setPubIntegral = (range) => {\n  range.pubIntegral = getPubIntegral(range);\n  if (range.pubIntegral === 0) {\n    delete range.pubIntegral;\n  }\n};\n\nconst resetDiaIDs = (range) => {\n  delete range.diaID;\n  range.signal.forEach((_signal) => {\n    delete _signal.diaID;\n  });\n  delete range.pubIntegral;\n};\n/**\n *\n * @param {object} range\n * @param {String('both' | 'range' | 'signal')} unlinkType\n * @param {object} options\n * @param {number} [options.signalIndex]\n * @returns {object}\n */\nconst unlink = (range, unlinkType = 'both', options = {}) => {\n  switch (unlinkType) {\n    case 'both':\n      resetDiaIDs(range);\n\n      break;\n    case 'range':\n      delete range.diaID;\n\n      break;\n    case 'signal':\n      delete range.signal[options.signalIndex].diaID;\n\n      break;\n\n    default:\n      break;\n  }\n\n  setPubIntegral(range);\n\n  return range;\n};\n\nconst addDefaultSignal = (range) => {\n  range.signal.push({\n    multiplicity: 'm',\n    kind: 'signal',\n    delta: (range.to + range.from) / 2,\n  });\n};\n\nconst checkRangeKind = (range) => {\n  return range.kind === DatumKind.signal;\n};\n\nconst checkSignalKinds = (range, kinds) => {\n  return !range.signal.some(\n    (_signal) => _signal.kind === undefined || !kinds.includes(_signal.kind),\n  );\n};\n\nconst unlinkInAssignmentData = (assignmentData, ranges) => {\n  const ids = ranges.reduce((acc, range) => {\n    acc.push(range.id);\n    if (range.signal) {\n      acc = acc.concat(range.signal.map((signal) => signal.id, []));\n    }\n    return acc;\n  }, []);\n  assignmentData.dispatch({\n    type: 'REMOVE_ALL',\n    payload: { id: ids, axis: 'x' },\n  });\n};\n\nexport {\n  addDefaultSignal,\n  checkRangeKind,\n  checkSignalKinds,\n  getDiaIDs,\n  getPubIntegral,\n  resetDiaIDs,\n  unlink,\n  unlinkInAssignmentData,\n};\n","import {\n  createContext,\n  useReducer,\n  useMemo,\n  useContext,\n  useCallback,\n  useEffect,\n} from 'react';\n\nconst assignmentContext = createContext();\n\nfunction assignmentReducer(state, action) {\n  switch (action.type) {\n    case 'ADD': {\n      const newState = {\n        ...state,\n        assignment: { ...state.assignment },\n      };\n      if (newState.assignment[action.payload.id[0]] === undefined) {\n        newState.assignment[action.payload.id[0]] = {};\n      }\n      if (\n        newState.assignment[action.payload.id[0]][action.payload.axis] ===\n        undefined\n      ) {\n        newState.assignment[action.payload.id[0]][action.payload.axis] = [];\n      }\n      // avoid duplicates\n      if (\n        !newState.assignment[action.payload.id[0]][\n          action.payload.axis\n        ].includes(action.payload.id[1])\n      ) {\n        newState.assignment[action.payload.id[0]][action.payload.axis].push(\n          action.payload.id[1],\n        );\n      }\n\n      return newState;\n    }\n    case 'REMOVE': {\n      const newState = {\n        ...state,\n        assignment: { ...state.assignment },\n      };\n      if (\n        newState.assignment[action.payload.id[0]] !== undefined &&\n        newState.assignment[action.payload.id[0]][action.payload.axis] !==\n          undefined\n      ) {\n        newState.assignment[action.payload.id[0]][\n          action.payload.axis\n        ] = newState.assignment[action.payload.id[0]][\n          action.payload.axis\n        ].filter((_id) => _id !== action.payload.id[1]);\n\n        if (\n          newState.assignment[action.payload.id[0]][action.payload.axis]\n            .length === 0\n        ) {\n          delete newState.assignment[action.payload.id[0]][action.payload.axis];\n        }\n        if (\n          Object.keys(newState.assignment[action.payload.id[0]]).length === 0\n        ) {\n          delete newState.assignment[action.payload.id[0]];\n        }\n      }\n\n      return newState;\n    }\n    case 'REMOVE_ALL': {\n      const newState = {\n        ...state,\n        assignment: { ...state.assignment },\n      };\n      // takes an array now to delete multiple identifiers\n      action.payload.id.forEach((_id) => {\n        if (\n          newState.assignment[_id] !== undefined &&\n          newState.assignment[_id][action.payload.axis] !== undefined\n        ) {\n          delete newState.assignment[_id][action.payload.axis];\n          if (Object.keys(newState.assignment[_id]).length === 0) {\n            delete newState.assignment[_id];\n          }\n        }\n      });\n\n      return newState;\n    }\n    case 'SET_IS_ACTIVE': {\n      return {\n        ...state,\n        isActive:\n          action.payload.id !== undefined && action.payload.axis !== undefined,\n        activeID: action.payload.id,\n        activeAxis: action.payload.axis,\n      };\n    }\n    case 'SET_IS_ON_HOVER': {\n      return {\n        ...state,\n        isOnHover: action.payload.id !== undefined,\n        onHoverID: action.payload.id,\n        onHoverAxis: action.payload.axis,\n      };\n    }\n    case 'DELETE_RECORD': {\n      const newState = {\n        ...state,\n        assignment: { ...state.assignment },\n      };\n      delete newState.assignment[action.payload.id];\n\n      if (newState.isActive && newState.activeID === action.payload.id) {\n        newState.isActive = false;\n        newState.activeID = undefined;\n        newState.activeAxis = undefined;\n      }\n      if (newState.isOnHover && newState.onHoverID === action.payload.id) {\n        newState.isOnHover = false;\n        newState.onHoverID = undefined;\n        newState.onHoverAxis = undefined;\n      }\n\n      return newState;\n    }\n    default: {\n      throw new Error(`unknown action type: ${action.type}`);\n    }\n  }\n}\n\nconst emptyState = {\n  assignment: {},\n  isActive: false,\n  activeID: undefined,\n  activeAxis: undefined,\n  isOnHover: false,\n  onHoverID: undefined,\n  onHoverAxis: undefined,\n};\n\nexport function AssignmentProvider(props) {\n  const { spectraData } = props;\n  const [assignment, dispatch] = useReducer(assignmentReducer, emptyState);\n  const contextValue = useMemo(() => ({ assignment, dispatch }), [assignment]);\n\n  const initAssignmentDataRanges = (range, _contextValue) => {\n    _contextValue.dispatch({\n      type: 'DELETE_RECORD',\n      payload: { id: range.id },\n    });\n    (range.diaID || []).forEach((_diaID) =>\n      _contextValue.dispatch({\n        type: 'ADD',\n        payload: { id: [range.id, _diaID], axis: 'x' },\n      }),\n    );\n    range.signal.forEach((signal) =>\n      (signal.diaID || []).forEach((_diaID) =>\n        _contextValue.dispatch({\n          type: 'ADD',\n          payload: { id: [signal.id, _diaID], axis: 'x' },\n        }),\n      ),\n    );\n  };\n\n  const initAssignmentDataZones = (zone, _contextValue) => {\n    _contextValue.dispatch({\n      type: 'DELETE_RECORD',\n      payload: { id: zone.id },\n    });\n    (zone.y.diaID || []).forEach((_diaID) =>\n      _contextValue.dispatch({\n        type: 'ADD',\n        payload: { id: [zone.id, _diaID], axis: 'y' },\n      }),\n    );\n    (zone.x.diaID || []).forEach((_diaID) =>\n      _contextValue.dispatch({\n        type: 'ADD',\n        payload: { id: [zone.id, _diaID], axis: 'x' },\n      }),\n    );\n    zone.signal.forEach((signal) => {\n      (signal.x.diaID || []).forEach((_diaID) =>\n        _contextValue.dispatch({\n          type: 'ADD',\n          payload: { id: [signal.id, _diaID], axis: 'x' },\n        }),\n      );\n      (signal.y.diaID || []).forEach((_diaID) =>\n        _contextValue.dispatch({\n          type: 'ADD',\n          payload: { id: [signal.id, _diaID], axis: 'y' },\n        }),\n      );\n    });\n  };\n\n  useEffect(() => {\n    if (spectraData) {\n      spectraData.forEach((spectrum) => {\n        if (spectrum.info.dimension === 1) {\n          spectrum.ranges.values.forEach((range) =>\n            initAssignmentDataRanges(range, contextValue),\n          );\n        } else if (spectrum.info.dimension === 2) {\n          spectrum.zones.values.forEach((zone) =>\n            initAssignmentDataZones(zone, contextValue),\n          );\n        }\n      });\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [spectraData]);\n\n  return (\n    <assignmentContext.Provider value={contextValue}>\n      {props.children}\n    </assignmentContext.Provider>\n  );\n}\n\nexport function useAssignmentData() {\n  return useContext(assignmentContext);\n}\n\nexport function useAssignment(key) {\n  const context = useAssignmentData();\n\n  if ((typeof key !== 'string' && typeof key !== 'number') || key === '') {\n    throw new Error(`assignment key must be a non-empty string or number`);\n  }\n  const id = String(key);\n\n  const isActive = useMemo(() => {\n    return context.assignment.isActive && context.assignment.activeID === id;\n  }, [context.assignment.activeID, context.assignment.isActive, id]);\n\n  const activeAxis = useMemo(() => {\n    return isActive ? context.assignment.activeAxis : undefined;\n  }, [context.assignment.activeAxis, isActive]);\n\n  const assigned = useMemo(() => {\n    return context.assignment.assignment[id]\n      ? context.assignment.assignment[id]\n      : [];\n  }, [context.assignment.assignment, id]);\n\n  const isOnHover = useMemo(() => {\n    return context.assignment.isOnHover && context.assignment.onHoverID === id;\n  }, [context.assignment.isOnHover, context.assignment.onHoverID, id]);\n\n  const onHoverAxis = useMemo(() => {\n    return isOnHover ? context.assignment.onHoverAxis : undefined;\n  }, [context.assignment.onHoverAxis, isOnHover]);\n\n  const add = useCallback(\n    (_id) => {\n      context.dispatch({\n        type: 'ADD',\n        payload: { id: [id, _id], axis: activeAxis },\n      });\n    },\n    [activeAxis, context, id],\n  );\n\n  const remove = useCallback(\n    (_id) => {\n      context.dispatch({\n        type: 'REMOVE',\n        payload: { id: [id, _id], axis: activeAxis },\n      });\n    },\n    [activeAxis, context, id],\n  );\n\n  const removeAll = useCallback(\n    (axis) => {\n      context.dispatch({\n        type: 'REMOVE_ALL',\n        payload: { id: [id], axis },\n      });\n    },\n    [context, id],\n  );\n\n  const toggle = useCallback(\n    (_id) => {\n      if (\n        assigned[activeAxis] === undefined ||\n        !assigned[activeAxis].includes(_id)\n      ) {\n        add(_id);\n      } else {\n        remove(_id);\n      }\n    },\n    [activeAxis, add, assigned, remove],\n  );\n\n  // totally deletion of a record from assignment storage\n  const deleteRecord = useCallback(() => {\n    context.dispatch({\n      type: 'DELETE_RECORD',\n      payload: { id },\n    });\n  }, [context, id]);\n\n  const onClick = useCallback(\n    (axis) => {\n      context.dispatch({\n        type: 'SET_IS_ACTIVE',\n        payload: {\n          id: !isActive ? id : undefined,\n          axis: !isActive && id !== undefined ? axis : undefined,\n        },\n      });\n    },\n    [context, id, isActive],\n  );\n\n  const setIsOnHover = useCallback(\n    (action, axis) => {\n      if (action === 'enter') {\n        context.dispatch({\n          type: 'SET_IS_ON_HOVER',\n          payload: {\n            id: id,\n            axis: id !== undefined ? axis : undefined,\n          },\n        });\n      } else if (action === 'leave') {\n        context.dispatch({\n          type: 'SET_IS_ON_HOVER',\n          payload: {},\n        });\n      }\n    },\n    [context, id],\n  );\n\n  const onMouseEnter = useCallback((axis) => setIsOnHover('enter', axis), [\n    setIsOnHover,\n  ]);\n\n  const onMouseLeave = useCallback((axis) => setIsOnHover('leave', axis), [\n    setIsOnHover,\n  ]);\n\n  return {\n    id,\n    isActive,\n    activeAxis,\n    assigned,\n    add,\n    remove,\n    removeAll,\n    toggle,\n    deleteRecord,\n    onClick,\n    isOnHover,\n    onHoverAxis,\n    onMouseEnter,\n    onMouseLeave,\n  };\n}\n","const Multiplets = [\n  { label: 'massive (m)', value: 'm', multiplicity: null },\n  { label: 'singlet (s)', value: 's', multiplicity: 1 },\n  { label: 'doublet (d)', value: 'd', multiplicity: 2 },\n  { label: 'triplet (t)', value: 't', multiplicity: 3 },\n  { label: 'quartet (q)', value: 'q', multiplicity: 4 },\n  { label: 'quintet (i)', value: 'i', multiplicity: 5 },\n  { label: 'sextet (x)', value: 'x', multiplicity: 6 },\n  { label: 'septet (p)', value: 'p', multiplicity: 7 },\n  { label: 'octet (o)', value: 'o', multiplicity: 8 },\n  { label: 'nonet (n)', value: 'n', multiplicity: 9 },\n];\n\nexport { Multiplets };\n","import { Multiplets } from '../../../../data/constants/Multiplets';\n\nfunction getMultiplicityNumber(string) {\n  const multiplet = Multiplets.find(\n    (_multiplet) => string === _multiplet.label || string === _multiplet.value,\n  );\n\n  return multiplet ? multiplet.multiplicity : null;\n}\n\nfunction checkMultiplet(multiplet, rejected = []) {\n  // options to determine whether a massive (m), for example, should be considered as rejected multiplet\n  if (multiplet === undefined || multiplet.length === 0) {\n    return false;\n  }\n  const _multiplet = Multiplets.find(\n    (m) => m.value === multiplet || m.label === multiplet,\n  );\n  return (\n    _multiplet &&\n    !rejected.includes(_multiplet.value) &&\n    !rejected.includes(_multiplet.label)\n  );\n}\n\nfunction checkMultiplicity(multiplicity, rejected = []) {\n  // options to determine whether a massive (m), for example, should be considered as rejected multiplicity\n  if (multiplicity === undefined || multiplicity.length === 0) {\n    return false;\n  }\n  return !multiplicity\n    .split('')\n    .find((_multiplet) => !checkMultiplet(_multiplet, rejected));\n}\n\nfunction translateMultiplet(multiplet) {\n  return multiplet.length === 1\n    ? Multiplets.find((_multiplet) => _multiplet.value === multiplet).label\n    : Multiplets.find((_multiplet) => _multiplet.label === multiplet).value;\n}\n\nfunction hasCouplingConstant(multiplet) {\n  if (multiplet.length > 1) {\n    multiplet = translateMultiplet(multiplet);\n  }\n  // with the pre-set rejected ones, we check the given multiplicity for the need of having a coupling constant (massive and singlet do not)\n  return checkMultiplicity(multiplet, ['m', 's']);\n}\n\nfunction getPascal(n, spin) {\n  if (n === undefined || n === 0 || spin === undefined) return [1];\n  let mult = 2 * spin + 1;\n  let previousLine = [];\n  for (let j = 0; j < mult - 1; j++) previousLine.push(1);\n  // complete with \"1 1\" or \"1 1 1\" for spin 1/2 and 1 respectively\n  for (let i = 0; i < n - 1; i++) {\n    // copy the line\n    let _line = previousLine.slice();\n    for (let j = 1; j < mult; j++) {\n      for (let k = 0; k < previousLine.length - 1; k++) {\n        _line[k + j] += previousLine[k];\n      } // add the previous line\n      _line.push(1); // complete the line\n    }\n    previousLine = _line.slice();\n  }\n  return previousLine;\n}\n\nexport {\n  checkMultiplet,\n  checkMultiplicity,\n  getMultiplicityNumber,\n  getPascal,\n  hasCouplingConstant,\n  translateMultiplet,\n};\n","export const TREE_LEVEL_COLORS = ['red', 'green', 'blue', 'magenta'];\n","import { useScale } from '../../context/ScaleContext';\n\nimport { TREE_LEVEL_COLORS } from './TreeColors';\n\nfunction LevelNode({ signal, startY, levelHeight }) {\n  const { scaleX } = useScale();\n  return (\n    <line\n      key={`startLevelNode_${signal.id}`}\n      x1={scaleX()(signal.delta)}\n      y1={startY}\n      x2={scaleX()(signal.delta)}\n      y2={startY + levelHeight}\n      stroke={TREE_LEVEL_COLORS[0]}\n    />\n  );\n}\n\nexport default LevelNode;\n","import { useScale } from '../../context/ScaleContext';\n\nfunction StringNode({ signal, startY, levelHeight, fontSize, showLabels }) {\n  const { scaleX } = useScale();\n  return (\n    <text\n      key={`multiplicityString_${signal.id}`}\n      textAnchor=\"middle\"\n      x={scaleX()(signal.delta)}\n      y={startY + levelHeight / 2}\n      fontSize={fontSize}\n      lengthAdjust=\"spacing\"\n      fill=\"black\"\n      visibility={showLabels ? 'visible' : 'hidden'}\n    >\n      {signal.multiplicity}\n    </text>\n  );\n}\n\nexport default StringNode;\n","import { useCallback } from 'react';\n\nimport { useScale } from '../../context/ScaleContext';\n\nfunction TreeNodes({\n  nodesData,\n  levelHeight,\n  startY,\n  signalID,\n  labelOptions,\n  showLabels,\n}) {\n  const { scaleX } = useScale();\n  const buildTreeNodeAndEdge = useCallback(\n    ({ startX, _startX, ratio, multiplicityIndex, color }) => {\n      const edgeLevel = 2 * multiplicityIndex + 2;\n      const _startYEdge = startY + edgeLevel * levelHeight;\n      const _startYNode = startY + (edgeLevel + 1) * levelHeight;\n\n      return (\n        <g key={`treeNode_${signalID}_${startX}_${_startX}_${ratio}`}>\n          {/* ratio text */}\n          <text\n            textAnchor=\"middle\"\n            x={scaleX()(_startX) + labelOptions.distance}\n            y={_startYNode + 2 * (levelHeight / 3)}\n            fontSize={labelOptions.fontSize}\n            fill={color}\n            visibility={showLabels ? 'visible' : 'hidden'}\n          >\n            {ratio}\n          </text>\n          {/* edge line */}\n          <line\n            x1={scaleX()(startX)}\n            y1={_startYEdge}\n            x2={scaleX()(_startX)}\n            y2={_startYNode}\n            stroke={color}\n          />\n          {/* node line */}\n          <line\n            x1={scaleX()(_startX)}\n            y1={_startYNode}\n            x2={scaleX()(_startX)}\n            y2={_startYNode + levelHeight}\n            stroke={color}\n          />\n        </g>\n      );\n    },\n    [\n      signalID,\n      labelOptions.distance,\n      labelOptions.fontSize,\n      scaleX,\n      showLabels,\n      startY,\n      levelHeight,\n    ],\n  );\n\n  return nodesData && nodesData.map((node) => buildTreeNodeAndEdge(node));\n}\n\nexport default TreeNodes;\n","import lodashGet from 'lodash/get';\n\nimport {\n  getMultiplicityNumber,\n  getPascal,\n} from '../../panels/extra/utilities/MultiplicityUtilities';\n\nimport { TREE_LEVEL_COLORS } from './TreeColors';\n\nconst createTreeNodes = (signal, spectrumData) => {\n  function buildTreeNodesData(\n    multiplicityIndex,\n    jIndices,\n    treeNodesData,\n    startX,\n  ) {\n    if (multiplicityIndex >= signal.multiplicity.length) {\n      return treeNodesData;\n    }\n    // re-use colors if needed\n    const color =\n      TREE_LEVEL_COLORS[multiplicityIndex % TREE_LEVEL_COLORS.length];\n\n    const jIndex = jIndices.findIndex(\n      (_jIndex) => _jIndex === multiplicityIndex,\n    );\n\n    const frequency = lodashGet(spectrumData, 'info.originFrequency', 0);\n    const coupling =\n      jIndex >= 0 && frequency > 0\n        ? signal.j[jIndex].coupling / frequency // convert to ppm\n        : null;\n\n    // in case of \"s\": no coupling constant and build one tree node only\n    if (!coupling) {\n      treeNodesData.push({\n        startX,\n        _startX: startX,\n        ratio: 1,\n        multiplicityIndex,\n        color,\n      });\n      // go to next multiplet in multiplicity string\n      buildTreeNodesData(\n        multiplicityIndex + 1,\n        jIndices,\n        treeNodesData,\n        startX,\n      );\n    } else {\n      // in case of other multiplets\n      const pascal = getPascal(\n        getMultiplicityNumber(signal.multiplicity.charAt(multiplicityIndex)),\n        0.5,\n      ); // @TODO for now we use the default spin of 1 / 2 only\n\n      let _startX =\n        pascal.length % 2 === 0\n          ? startX - (pascal.length / 2) * coupling + coupling / 2 // in case of even number of nodes\n          : startX - (pascal.length / 2 - 0.5) * coupling; // in case of odd number of nodes\n\n      pascal.forEach((ratio, k) => {\n        if (k > 0) {\n          _startX += coupling;\n        }\n        treeNodesData.push({\n          startX,\n          _startX,\n          ratio,\n          multiplicityIndex,\n          color,\n        });\n        // go to next multiplet in multiplicity string\n        buildTreeNodesData(\n          multiplicityIndex + 1,\n          jIndices,\n          treeNodesData,\n          _startX,\n        );\n      });\n    }\n\n    return treeNodesData;\n  }\n  return buildTreeNodesData;\n};\n//   [signal.multiplicity, signal.j, spectrumData],\n\nexport default createTreeNodes;\n","/** @jsxImportSource @emotion/react */\nimport lodashGet from 'lodash/get';\nimport { useMemo, useState, useEffect } from 'react';\n\nimport { useAssignment } from '../../assignment';\nimport { useChartData } from '../../context/ChartContext';\nimport { useScale } from '../../context/ScaleContext';\nimport { useHighlight } from '../../highlight';\nimport {\n  hasCouplingConstant,\n  checkMultiplicity,\n} from '../../panels/extra/utilities/MultiplicityUtilities';\nimport { options } from '../../toolbar/ToolTypes';\n\nimport LevelNode from './LevelNode';\nimport StringNode from './StringNode';\nimport TreeNodes from './TreeNodes';\nimport createTreeNodes from './buildTreeNode';\n\nconst styles = {\n  cursor: 'default',\n  opacity: 0.6,\n  strokeWidth: 1,\n};\n\nfunction MultiplicityTree({\n  rangeFrom,\n  rangeTo,\n  signal,\n  labelOptions = {\n    distance: 10,\n    fontSize: 11,\n  },\n}) {\n  const { scaleX, scaleY } = useScale();\n  const {\n    data: spectraData,\n    activeSpectrum,\n    selectedTool,\n    width,\n  } = useChartData();\n  const assignment = useAssignment(signal.id);\n  const highlight = useHighlight(\n    [assignment.id].concat(assignment.assigned.x || []),\n  );\n\n  const spectrumData = useMemo(\n    () => lodashGet(spectraData, `${activeSpectrum.index}`, null),\n    [activeSpectrum, spectraData],\n  );\n\n  const [xRange, setXRange] = useState({ x1: signal.delta, x2: signal.delta });\n  const [treeProps, setTreeProps] = useState({\n    width: 0,\n    height: 0,\n    levelHeight: 0,\n  });\n  const [drawInFullRange, setDrawInFullRange] = useState(false);\n  const [showLabels, setShowLabels] = useState(false);\n\n  useEffect(() => {\n    const _drawInFullRange = !checkMultiplicity(signal.multiplicity, ['m']);\n    const _treeWidth = _drawInFullRange\n      ? Math.abs(scaleX()(xRange.x1) - scaleX()(xRange.x2))\n      : Math.abs(scaleX()(xRange.x1) - scaleX()(xRange.x2)) +\n        labelOptions.distance;\n    const _treeHeight = _drawInFullRange ? _treeWidth / 3 : _treeWidth / 2;\n    // +2 because of multiplicity text and start level node before the actual tree starts\n    // 2* for levels between nodes (edges)\n    const _treeLevelHeight = _drawInFullRange\n      ? _treeHeight / (signal.multiplicity.length + 2)\n      : _treeHeight / (2 * signal.multiplicity.length + 2);\n\n    setTreeProps({\n      width: _treeWidth,\n      height: _treeHeight,\n      levelHeight: _treeLevelHeight,\n    });\n    setDrawInFullRange(_drawInFullRange);\n  }, [\n    labelOptions.distance,\n    scaleX,\n    signal.multiplicity,\n    xRange.x1,\n    xRange.x2,\n  ]);\n\n  useEffect(() => {\n    if (treeProps.width / width >= 0.1) {\n      setShowLabels(true);\n    } else {\n      setShowLabels(false);\n    }\n  }, [treeProps.width, width]);\n\n  const startY = useMemo(() => {\n    let yMax;\n    spectrumData.data.x.forEach((_x, i) => {\n      if (\n        _x >= rangeFrom &&\n        _x <= rangeTo &&\n        (!yMax || spectrumData.data.y[i] > yMax)\n      ) {\n        yMax = spectrumData.data.y[i];\n      }\n    });\n\n    return scaleY(spectrumData.id)(yMax) - treeProps.height - 30;\n  }, [\n    spectrumData.data.x,\n    spectrumData.data.y,\n    spectrumData.id,\n    scaleY,\n    treeProps.height,\n    rangeFrom,\n    rangeTo,\n  ]);\n\n  const treeNodesData = useMemo(() => {\n    const buildTreeNodesData = createTreeNodes(signal, spectrumData);\n    const jIndices = signal.multiplicity\n      .split('')\n      .map((_mult, i) => (hasCouplingConstant(_mult) ? i : undefined))\n      .filter((_i) => _i !== undefined);\n\n    return buildTreeNodesData(0, jIndices, [], signal.delta);\n  }, [signal, spectrumData]);\n\n  useEffect(() => {\n    if (drawInFullRange) {\n      setXRange({ x1: rangeFrom, x2: rangeTo });\n    } else {\n      const _xRange = { x1: signal.delta, x2: signal.delta };\n      treeNodesData.forEach((_treeNodeData) => {\n        if (_treeNodeData.startX < _xRange.x1) {\n          _xRange.x1 = _treeNodeData.startX;\n        }\n        if (_treeNodeData.startX > _xRange.x2) {\n          _xRange.x2 = _treeNodeData.startX;\n        }\n        if (_treeNodeData._startX < _xRange.x1) {\n          _xRange.x1 = _treeNodeData._startX;\n        }\n        if (_treeNodeData._startX > _xRange.x2) {\n          _xRange.x2 = _treeNodeData._startX;\n        }\n      });\n      setXRange(_xRange);\n    }\n  }, [\n    drawInFullRange,\n    rangeFrom,\n    rangeTo,\n    signal.delta,\n    signal.multiplicity,\n    treeNodesData,\n  ]);\n\n  const multiplicityTree = useMemo(() => {\n    const { levelHeight } = treeProps;\n    // first tree level\n    const firstLevelStartY = startY;\n    let _startY = firstLevelStartY;\n    // second tree level\n    const secondLevelStartY = startY + levelHeight;\n    _startY = secondLevelStartY;\n\n    // third tree level\n    _startY += levelHeight;\n\n    if (drawInFullRange) {\n      const _rangeFrom = scaleX()(rangeFrom);\n      const _rangeTo = scaleX()(rangeTo);\n\n      const pathData = `M ${_rangeFrom} ${\n        _startY + levelHeight\n      } ${_rangeFrom} ${_startY} ${scaleX()(\n        signal.delta,\n      )} ${_startY} ${_rangeTo} ${_startY} ${_rangeTo} ${\n        _startY + levelHeight\n      }`;\n\n      return (\n        <g>\n          <StringNode\n            signal={signal}\n            startY={firstLevelStartY}\n            levelHeight={levelHeight}\n            fontSize={labelOptions.fontSize}\n            showLabels={showLabels}\n          />\n          <LevelNode\n            signal={signal}\n            startY={secondLevelStartY}\n            levelHeight={levelHeight}\n          />\n          <path d={pathData} stroke=\"blue\" fill=\"none\" />\n        </g>\n      );\n    }\n\n    return (\n      <g>\n        <StringNode\n          signal={signal}\n          startY={firstLevelStartY}\n          levelHeight={levelHeight}\n          fontSize={labelOptions.fontSize}\n          showLabels={showLabels}\n        />\n        <LevelNode\n          signal={signal}\n          startY={secondLevelStartY}\n          levelHeight={levelHeight}\n        />\n        <TreeNodes\n          nodesData={treeNodesData}\n          signalID={treeNodesData}\n          showLabels={showLabels}\n          startY={startY}\n          labelOptions={labelOptions}\n          levelHeight={levelHeight}\n        />\n      </g>\n    );\n  }, [\n    treeProps,\n    startY,\n    drawInFullRange,\n    signal,\n    labelOptions,\n    showLabels,\n    treeNodesData,\n    scaleX,\n    rangeFrom,\n    rangeTo,\n  ]);\n\n  return (\n    <g\n      css={\n        highlight.isActive || assignment.isActive\n          ? { ...styles, opacity: 1, strokeWidth: 1.5 }\n          : styles\n      }\n      {...{\n        onMouseEnter: () => {\n          assignment.onMouseEnter('x');\n          highlight.show();\n        },\n        onMouseLeave: () => {\n          assignment.onMouseLeave('x');\n          highlight.hide();\n        },\n      }}\n      {...{\n        onClick:\n          selectedTool && selectedTool === options.editRange.id\n            ? null\n            : (e) => {\n                if (e.shiftKey) {\n                  e.stopPropagation();\n                  assignment.onClick('x');\n                }\n              },\n      }}\n    >\n      {multiplicityTree}\n    </g>\n  );\n}\n\nexport default MultiplicityTree;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback, useState, useEffect } from 'react';\n\nimport { checkRangeKind } from '../../../data/utilities/RangeUtilities';\nimport { useAssignment } from '../../assignment';\nimport { useDispatch } from '../../context/DispatchContext';\nimport { useScale } from '../../context/ScaleContext';\nimport { TYPES, useHighlight } from '../../highlight';\nimport { RESIZE_RANGE } from '../../reducer/types/Types';\nimport { options } from '../../toolbar/ToolTypes';\nimport Resizable from '../Resizable';\nimport MultiplicityTree from '../multiplicityTree/MultiplicityTree';\n\nconst stylesOnHover = css`\n  pointer-events: bounding-box;\n  @-moz-document url-prefix() {\n    pointer-events: fill;\n  }\n  user-select: 'none';\n  -webkit-user-select: none; /* Chrome all / Safari all */\n  -moz-user-select: none; /* Firefox all */\n\n  // // disabled because Resizable component appears now when hovering over it\n  // :hover .range-area {\n  //   height: 100%;\n  //   fill: #ff6f0057;\n  //   cursor: pointer;\n  // }\n\n  .delete-button {\n    visibility: hidden;\n  }\n`;\n\nconst stylesHighlighted = css`\n  pointer-events: bounding-box;\n\n  @-moz-document url-prefix() {\n    pointer-events: fill;\n  }\n  .range-area {\n    height: 100%;\n    fill: #ff6f0057;\n  }\n  .delete-button {\n    visibility: visible;\n    cursor: pointer;\n  }\n`;\n\nfunction Range({ rangeData, showMultiplicityTrees, selectedTool }) {\n  const { id, from: rangeFrom, to: rangeTo, integral, signal } = rangeData;\n  const assignmentRange = useAssignment(id);\n  const highlightRange = useHighlight(\n    [assignmentRange.id].concat(assignmentRange.assigned.x || []),\n    TYPES.RANGE,\n  );\n  const [rangeBoundary, setRangeBoundary] = useState({\n    from: rangeFrom,\n    to: rangeTo,\n  });\n\n  const { scaleX } = useScale();\n  const dispatch = useDispatch();\n\n  const [reduceOpacity, setReduceOpacity] = useState(false);\n  const [isBlockedByEditing, setIsBlockedByEditing] = useState(false);\n\n  useEffect(() => {\n    if (selectedTool && selectedTool === options.editRange.id) {\n      setIsBlockedByEditing(true);\n    } else {\n      setIsBlockedByEditing(false);\n    }\n  }, [selectedTool]);\n\n  useEffect(() => {\n    setReduceOpacity(!checkRangeKind(rangeData));\n  }, [rangeData]);\n\n  const handleOnStopResizing = useCallback(\n    (resized) => {\n      dispatch({\n        type: RESIZE_RANGE,\n        data: { ...rangeData, ...resized },\n      });\n    },\n    [dispatch, rangeData],\n  );\n\n  const mouseEnterHandler = useCallback(() => {\n    assignmentRange.onMouseEnter('x');\n    highlightRange.show();\n  }, [assignmentRange, highlightRange]);\n  const mouseLeaveHandler = useCallback(() => {\n    assignmentRange.onMouseLeave('x');\n    highlightRange.hide();\n  }, [assignmentRange, highlightRange]);\n\n  const assignHandler = useCallback(\n    (e) => {\n      if (\n        selectedTool === options.rangesPicking.id &&\n        e.shiftKey &&\n        !isBlockedByEditing\n      ) {\n        assignmentRange.onClick('x');\n      }\n    },\n    [assignmentRange, isBlockedByEditing, selectedTool],\n  );\n\n  const dragHandler = useCallback((boundary) => {\n    setRangeBoundary((range) => ({ ...range, ...boundary }));\n  }, []);\n\n  const { from, to } = rangeBoundary;\n\n  return (\n    <g\n      // tabIndex=\"0\"\n      style={{ outline: 'none' }}\n      css={\n        isBlockedByEditing ||\n        highlightRange.isActive ||\n        assignmentRange.isActive\n          ? stylesHighlighted\n          : stylesOnHover\n      }\n      key={id}\n      onMouseEnter={mouseEnterHandler}\n      onMouseLeave={mouseLeaveHandler}\n      onClick={assignHandler}\n    >\n      <g transform={`translate(${scaleX()(to)},10)`}>\n        <rect\n          x=\"0\"\n          width={Math.abs(scaleX()(from) - scaleX()(to))}\n          height=\"6\"\n          className=\"range-area\"\n          fill=\"green\"\n          fillOpacity={\n            !reduceOpacity ||\n            highlightRange.isActive ||\n            assignmentRange.isActive\n              ? 1\n              : 0.4\n          }\n        />\n        <text\n          textAnchor=\"middle\"\n          x={Math.abs(scaleX()(from) - scaleX()(to)) / 2}\n          y=\"20\"\n          fontSize=\"10\"\n          fill=\"red\"\n          fillOpacity={\n            !reduceOpacity ||\n            highlightRange.isActive ||\n            assignmentRange.isActive\n              ? 1\n              : 0.6\n          }\n        >\n          {integral !== undefined ? integral.toFixed(2) : ''}\n        </text>\n      </g>\n      <Resizable\n        from={rangeData.from}\n        to={rangeData.to}\n        onDrop={handleOnStopResizing}\n        onDrag={dragHandler}\n      />\n      {showMultiplicityTrees && signal && signal.length > 0\n        ? signal.map((_signal) => (\n            <MultiplicityTree\n              rangeFrom={from}\n              rangeTo={to}\n              signal={_signal}\n              key={signal.id}\n            />\n          ))\n        : null}\n    </g>\n  );\n}\n\nexport default Range;\n","import { memo, useEffect, useState } from 'react';\n\nimport RangesWrapper from '../../hoc/RangesWrapper';\nimport Events from '../../utility/Events';\n\nimport Range from './Range';\n\nfunction Ranges({ ranges, displayerKey, selectedTool }) {\n  const [isMultiplicityTreesVisibile, showMultiplicityTrees] = useState(false);\n\n  useEffect(() => {\n    Events.on('showMultiplicityTrees', (flag) => {\n      showMultiplicityTrees(flag);\n    });\n  }, []);\n\n  return (\n    <g clipPath={`url(#${displayerKey}clip-chart-1d)`}>\n      {ranges &&\n        ranges.values &&\n        ranges.values.map((range) => (\n          <Range\n            key={range.id}\n            rangeData={range}\n            selectedTool={selectedTool}\n            showMultiplicityTrees={isMultiplicityTreesVisibile}\n          />\n        ))}\n    </g>\n  );\n}\n\nexport default RangesWrapper(memo(Ranges));\n","import BaseLineZones from './BaseLineZones';\nimport ExclusionZones from './ExclusionZones';\nimport IntegralsSeries from './IntegralsSeries';\nimport LinesSeries from './LinesSeries';\nimport PeaksNotations from './PeaksNotations';\nimport XAxis from './XAxis';\nimport MultiAnalysisRanges from './multiAnalysis/MultiAnalysisRanges';\nimport Ranges from './ranges/Ranges';\n\nfunction Chart1D({ mode, width, height, margin, displayerKey }) {\n  return (\n    <svg\n      viewBox={`0 0 ${width} ${height}`}\n      width={width}\n      height={height}\n      id=\"nmrSVG\"\n    >\n      <defs>\n        <clipPath id={`${displayerKey}clip-chart-1d`}>\n          <rect\n            width={`${width - margin.left - margin.right}`}\n            height={`${height}`}\n            x={`${margin.left}`}\n            y={`${0}`}\n          />\n        </clipPath>\n      </defs>\n\n      <LinesSeries />\n      <IntegralsSeries />\n      <PeaksNotations />\n      <Ranges />\n      <MultiAnalysisRanges />\n      <BaseLineZones />\n      <ExclusionZones />\n\n      <g className=\"container\" style={{ pointerEvents: 'none' }}>\n        <XAxis showGrid mode={mode} />\n        {/* <YAxis label=\"PPM\" show /> */}\n      </g>\n    </svg>\n  );\n}\n\nexport default Chart1D;\n","import { createContext, useCallback, useContext } from 'react';\n\nconst HelpContext = createContext();\n\nexport const HelpProvider = HelpContext.Provider;\n\nexport function useHelptData() {\n  return useContext(HelpContext).helpState;\n}\nexport function useHelp() {\n  const context = useContext(HelpContext);\n\n  const show = useCallback(\n    (e) => {\n      const id = e.target.getAttribute('data-helpid');\n      if (id) {\n        e.target.style.cursor =\n          !context.preventAutoHelp || e.ctrlKey ? 'help' : 'pointer';\n        context.dispatch({ type: 'SHOW', id });\n        context.show(id, { delay: e.ctrlKey ? 0 : null });\n      }\n    },\n    [context],\n  );\n\n  const hide = useCallback(() => {\n    context.dispatch({ type: 'HIDE' });\n    context.clear();\n  }, [context]);\n\n  const onHover = {\n    onMouseEnter: show,\n    onMouseLeave: hide,\n  };\n\n  return { show, hide, onHover };\n}\n","export const groupBy = (array, fn) =>\n  array.reduce((result, item) => {\n    const key = fn(item);\n    if (!result[key]) result[key] = [];\n    result[key].push(item);\n    return result;\n  }, {});\n","export const initState = {\n  helpText: null,\n  helpObject: null,\n};\nexport default function helpReducer(state, action) {\n  switch (action.type) {\n    case 'SHOW': {\n      const helpText = state.data[action.id].text;\n      return { ...state, helpText };\n    }\n    case 'HIDE': {\n      return { ...state, helpText: null };\n    }\n    default: {\n      throw new Error(`unknown action type: ${action.type}`);\n    }\n  }\n}\n","import {\n  useReducer,\n  useRef,\n  useEffect,\n  useCallback,\n  Fragment,\n  useState,\n  memo,\n  useMemo,\n} from 'react';\nimport { createPortal } from 'react-dom';\nimport { FaTimes } from 'react-icons/fa';\nimport { Rnd } from 'react-rnd';\nimport { TransitionGroup } from 'react-transition-group';\n\nimport Transition from '../Transition';\nimport Wrapper from '../Wrapper';\nimport { groupBy } from '../helpers';\nimport { positions, transitions } from '../options';\n\nimport { HelpProvider } from './Context';\nimport helpReducer, { initState } from './Reducer';\n\nconst transitionStyles = {\n  [transitions.FADE]: {\n    entering: { opacity: 0 },\n    entered: { opacity: 1 },\n  },\n  [transitions.SCALE]: {\n    entering: { transform: 'scale(0)' },\n    entered: { transform: 'scale(1)' },\n    exiting: { transform: 'scale(0)' },\n    exited: { transform: 'scale(0)' },\n  },\n};\n\nconst styles = {\n  innerContainer: {\n    display: 'flex',\n    flexDirection: 'column',\n    width: '100%',\n    height: '100%',\n    borderRadius: '5px',\n    padding: '10px',\n  },\n  outerContainer: {\n    boxSizing: 'initial',\n    backgroundColor: 'rgba(255, 255, 255, 1)',\n    boxShadow: '0px 0px 0px 0px, rgba(0, 0, 0, 0.1) 0px 3px 5px',\n    pointerEvents: 'all',\n  },\n  closeButton: {\n    border: 'none',\n    color: 'red',\n    backgroundColor: 'transparent',\n    outline: 'none',\n  },\n};\n\nlet dealyTimeOut = null;\n\nfunction Provider({\n  children,\n  data,\n  offset,\n  position,\n  timeout,\n  delay,\n  type,\n  transition,\n  containerStyle,\n  wrapperRef,\n  multiple,\n  preventAutoHelp,\n}) {\n  const root = useRef();\n  const timersId = useRef([]);\n  const [modals, setModals] = useState([]);\n\n  useEffect(() => {\n    root.current = document.createElement('div');\n    const ref = root.current;\n    if (wrapperRef) {\n      wrapperRef.appendChild(ref);\n    }\n\n    const timersIdRef = timersId.current;\n\n    return () => {\n      timersIdRef.forEach(clearTimeout);\n      if (wrapperRef) {\n        wrapperRef.removeChild(ref);\n      }\n    };\n  }, [wrapperRef]);\n\n  const remove = useCallback((modal) => {\n    setModals((currentModals) => {\n      const lengthBeforeRemove = currentModals.length;\n      const filteredModals = currentModals.filter((a) => a.id !== modal.id);\n\n      if (lengthBeforeRemove > filteredModals.length && modal.options.onClose) {\n        modal.options.onClose();\n      }\n\n      return filteredModals;\n    });\n  }, []);\n\n  const show = useCallback(\n    async (helpid, options = { delay: null }) => {\n      if (!modals.some((m) => m.helpid === helpid)) {\n        try {\n          const id = Math.random().toString(36).substr(2, 9);\n\n          const modalOptions = {\n            position: options.position || position,\n            timeout,\n            type,\n            ...options,\n          };\n\n          const modal = {\n            helpid,\n            id,\n            options: modalOptions,\n          };\n\n          modal.close = () => remove(modal);\n\n          const startModal = () => {\n            if (modal.options.timeout) {\n              const timerId = setTimeout(() => {\n                remove(modal);\n                timersId.current.splice(timersId.current.indexOf(timerId), 1);\n              }, modal.options.timeout);\n\n              timersId.current.push(timerId);\n            }\n\n            setModals((state) => (multiple ? state.concat(modal) : [modal]));\n\n            if (modal.options.onOpen) modal.options.onOpen();\n          };\n\n          if (options.delay === 0) {\n            startModal();\n          } else if (!preventAutoHelp) {\n            dealyTimeOut = setTimeout(\n              () => {\n                startModal();\n              },\n              options.delay > 0 ? options.delay : delay,\n            );\n          }\n          return modal;\n        } catch (e) {\n          // eslint-disable-next-line no-console\n          console.log(e);\n        }\n      }\n    },\n    [delay, modals, multiple, position, preventAutoHelp, remove, timeout, type],\n  );\n\n  const clear = useCallback(() => {\n    clearTimeout(dealyTimeOut);\n  }, []);\n\n  const parentStyle = useMemo(() => {\n    return wrapperRef\n      ? wrapperRef.getBoundingClientRect()\n      : {\n          top: 0,\n          left: 0,\n          width: window.innerWidth,\n          height: window.innerHeight,\n        };\n  }, [wrapperRef]);\n\n  const [helpState, dispatch] = useReducer(helpReducer, {\n    ...initState,\n    data,\n  });\n\n  const modalsByPosition = groupBy(\n    modals,\n    (modal) => modal.options && modal.options.position,\n  );\n\n  return (\n    <HelpProvider value={{ helpState, dispatch, show, clear, preventAutoHelp }}>\n      {children}\n      {root.current &&\n        createPortal(\n          <Fragment>\n            {Object.keys(positions).map((key) => {\n              const _position = positions[key];\n\n              return (\n                <TransitionGroup\n                  appear\n                  key={_position}\n                  options={{ position, containerStyle }}\n                  containerStyle={parentStyle}\n                  component={Wrapper}\n                >\n                  {modalsByPosition[_position]\n                    ? modalsByPosition[_position].map((modal) => (\n                        <Transition\n                          type={transition}\n                          key={modal.id}\n                          transitionStyles={{\n                            ...transitionStyles,\n                            default: { width: '400px', height: '400px' },\n                          }}\n                        >\n                          <Rnd\n                            style={{\n                              margin: offset,\n                              ...styles.outerContainer,\n                            }}\n                            default={{\n                              x: 0,\n                              y: 0,\n                              width: 400,\n                              height: 400,\n                            }}\n                          >\n                            <div style={styles.innerContainer}>\n                              <div>\n                                <button\n                                  type=\"button\"\n                                  onClick={() => remove(modal)}\n                                  style={styles.closeButton}\n                                >\n                                  <FaTimes />\n                                </button>\n                              </div>\n                              {data[modal.helpid].filePath && (\n                                <div\n                                  style={{\n                                    cursor: 'default',\n                                    width: '100%',\n                                    height: '100%',\n                                  }}\n                                >\n                                  <iframe\n                                    title=\"Tool User Manual\"\n                                    src={data[modal.helpid].filePath}\n                                    frameBorder=\"0\"\n                                    scrolling=\"auto\"\n                                    style={{ width: '100%', height: '100%' }}\n                                  />\n                                </div>\n                              )}\n                            </div>\n                          </Rnd>\n                        </Transition>\n                      ))\n                    : null}\n                </TransitionGroup>\n              );\n            })}\n          </Fragment>,\n          root.current,\n        )}\n    </HelpProvider>\n  );\n}\n\nProvider.defaultProps = {\n  offset: '10px',\n  position: positions.TOP_RIGHT,\n  timeout: 0,\n  delay: 2000,\n  transition: transitions.SCALE,\n  containerStyle: {\n    zIndex: 100,\n  },\n  wrapperRef: null,\n  multiple: false,\n  preventAutoHelp: false,\n};\n\nexport default memo(Provider);\n","import { forwardRef } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\n\nfunction FooterWarpper(WrappedComponent) {\n  const Wrapper = (props) => {\n    const {\n      margin,\n      width,\n      height,\n      activeSpectrum,\n      data,\n      activeTab,\n    } = useChartData();\n\n    const { forwardedRef, ...rest } = props;\n    return (\n      <WrappedComponent\n        {...rest}\n        data={data}\n        activeSpectrum={activeSpectrum}\n        activeTab={activeTab}\n        margin={margin}\n        width={width}\n        height={height}\n        ref={forwardedRef}\n      />\n    );\n  };\n\n  return forwardRef((props, ref) => {\n    return <Wrapper {...props} forwardedRef={ref} />;\n  });\n}\nexport default FooterWarpper;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { xFindClosestIndex } from 'ml-spectra-processing';\nimport { useContext, useCallback, Fragment, memo } from 'react';\nimport { BsCursor } from 'react-icons/bs';\nimport { IoPulseSharp } from 'react-icons/io5';\n\nimport { BrushContext } from '../EventsTrackers/BrushTracker';\nimport { MouseContext } from '../EventsTrackers/MouseTracker';\nimport { useScale } from '../context/ScaleContext';\nimport { useHelptData } from '../elements/popup/Help';\nimport FooterWarpper from '../hoc/FooterWarpper';\nimport { useFormatNumberByNucleus } from '../utility/FormatNumber';\n\nconst styles = css`\n  display: flex;\n  flex-firection: row;\n  align-items: center;\n  pointer-events: bounding-box;\n  user-select: 'none';\n  -webkit-user-select: none; /* Chrome all / Safari all */\n  -moz-user-select: none; /* Firefox all */\n  background-color: #f7f7f7;\n  height: 30px;\n  padding: 6px;\n  color: #8d0018;\n  position: absolute;\n  width: 100%;\n  bottom: 0;\n\n  .help {\n    font-size: 6px;\n    color: black;\n  }\n\n  div {\n    margin: 0px 10px;\n    display: inline-block;\n\n    .label {\n      font-size: 12px;\n      color: #4d4d4d;\n      font-weight: bold;\n    }\n    .value {\n      font-weight: bold;\n      font-size: 14px;\n      display: inline-block;\n    }\n    .unit {\n      font-weight: bold;\n      font-size: 10px;\n    }\n    .xvalue {\n      min-width: 50px;\n    }\n    .yvalue {\n      min-width: 80px;\n    }\n  }\n\n  .separator {\n    border-left: 2px solid gray;\n    margin: 0 20px;\n    width: 1px;\n    height: 100%;\n  }\n`;\n\nconst helpStyles = css`\n  pointer-events: bounding-box;\n  user-select: 'none';\n  -webkit-user-select: none; /* Chrome all / Safari all */\n  -moz-user-select: none; /* Firefox all */\n  background-color: #f7f7f7;\n  height: 30px;\n  padding: 6px;\n  color: #8d0018;\n  position: absolute;\n  width: 100%;\n  bottom: 0;\n  span {\n    font-size: 10px;\n    color: black;\n    display: inline-block;\n    text-overflow: ellipsis;\n    width: 100%;\n    white-space: nowrap;\n    overflow: hidden;\n  }\n`;\n\nfunction FooterBanner({\n  margin,\n  width,\n  height,\n  activeSpectrum,\n  data,\n  activeTab,\n}) {\n  let position = useContext(MouseContext);\n  const { startX, endX, step } = useContext(BrushContext);\n  const { scaleX } = useScale();\n  const { helpText } = useHelptData();\n  const { originFrequency: frequency } = activeSpectrum\n    ? data[activeSpectrum.index].info\n    : {};\n\n  const format = useFormatNumberByNucleus(activeTab);\n\n  const getYValue = useCallback(\n    (xPosition) => {\n      if (activeSpectrum) {\n        const xIndex = xFindClosestIndex(\n          data[activeSpectrum.index].data.x,\n          scaleX().invert(xPosition),\n        );\n        return data[activeSpectrum.index].data.y[xIndex];\n      }\n      return 1;\n    },\n    [activeSpectrum, data, scaleX],\n  );\n\n  if (helpText) {\n    return (\n      <div css={helpStyles}>\n        <span className=\"help\">{helpText}</span>\n      </div>\n    );\n  }\n\n  if (\n    !position ||\n    position.y < margin.top ||\n    position.x < margin.left ||\n    position.x > width - margin.right ||\n    position.y > height - margin.bottom\n  ) {\n    return <div css={styles} />;\n  }\n\n  return (\n    <div css={styles}>\n      <BsCursor />\n      <div>\n        <span className=\"label\"> X :</span>\n        <span className=\"value\">{format(scaleX().invert(position.x))}</span>\n        <span className=\"unit\">ppm</span>\n      </div>\n      {activeSpectrum && frequency && (\n        <div>\n          <span className=\"label\"> X :</span>\n          <span className=\"value xvalue\">\n            {format(scaleX().invert(position.x) * frequency, 'hz')}\n          </span>\n          <span className=\"unit\">Hz</span>\n        </div>\n      )}\n\n      {step === 'brushing' && (\n        <div>\n          <span className=\"label\"> ppm :</span>\n          <span className=\"value\">\n            {(scaleX().invert(startX) - scaleX().invert(endX)).toPrecision(6)}\n          </span>\n        </div>\n      )}\n      {activeSpectrum && (\n        <Fragment>\n          {frequency && step === 'brushing' && (\n            <div>\n              <span className=\"label\"> Hz :</span>\n              <span className=\"value\">\n                {(\n                  (scaleX().invert(startX) - scaleX().invert(endX)) *\n                  frequency\n                ).toPrecision(5)}\n              </span>\n            </div>\n          )}\n          {step === 'brushing' && (\n            <div>\n              <span className=\"label\"> ratio :</span>\n              <span className=\"value\">\n                {(\n                  (getYValue(startX) / (getYValue(endX) || Number.MIN_VALUE)) *\n                  100\n                ).toFixed(2)}\n                %\n              </span>\n            </div>\n          )}\n        </Fragment>\n      )}\n      {activeSpectrum && (\n        <Fragment>\n          <div className=\"separator\" />\n          <IoPulseSharp />\n          <div>\n            <span className=\"label\"> Y :</span>\n            <span className=\"value yvalue\">\n              {format(getYValue(position.x))}\n            </span>\n          </div>\n        </Fragment>\n      )}\n    </div>\n  );\n}\n\nexport default FooterWarpper(memo(FooterBanner));\n","import { xFindClosestIndex } from 'ml-spectra-processing';\nimport { useContext, useEffect, useMemo, useState } from 'react';\n\nimport { MouseContext } from '../EventsTrackers/MouseTracker';\nimport { useChartData } from '../context/ChartContext';\nimport { useScale } from '../context/ScaleContext';\nimport Events from '../utility/Events';\n\nconst styles = {\n  container: {\n    position: 'absolute',\n    left: '10px',\n    top: '10px',\n  },\n  value: {\n    width: '67px',\n    display: 'inline-block',\n    margin: '0 5px',\n    fontSize: '12px',\n  },\n  colorIndicator: {\n    width: '10px',\n    height: '1px',\n    borderBottom: `2px solid`,\n    display: 'inline-block',\n    marginBottom: '3px',\n  },\n  name: {\n    fontSize: '12px',\n  },\n};\n\nfunction YTracker({ datum }) {\n  const { scaleX } = useScale();\n  const position = useContext(MouseContext);\n\n  if (!scaleX || !position) {\n    return null;\n  }\n\n  const xIndex = xFindClosestIndex(datum.x, scaleX().invert(position.x));\n\n  return <span style={styles.value}>{datum.y[xIndex]}</span>;\n}\n\nfunction SpectraTracker() {\n  const { data, activeTab } = useChartData();\n  const [isVisible, ToggleVisiblility] = useState(false);\n  useEffect(() => {\n    Events.on('showYSpectraTrackers', (flag) => {\n      ToggleVisiblility(flag);\n    });\n\n    return () => Events.off('showYSpectraTrackers');\n  }, []);\n\n  const trackers = useMemo(() => {\n    return (\n      isVisible &&\n      data.map(\n        (datum) =>\n          datum.display.isVisible &&\n          datum.display.isVisibleInDomain &&\n          datum.info.nucleus === activeTab && (\n            <div style={{ display: 'block' }} key={datum.id}>\n              <span\n                style={{\n                  ...styles.colorIndicator,\n                  borderColor: datum.display.color,\n                }}\n              />\n              <YTracker datum={datum.data} />\n              <span style={styles.value}>{datum.display.name}</span>\n            </div>\n          ),\n        [],\n      )\n    );\n  }, [activeTab, data, isVisible]);\n\n  if (!isVisible) return null;\n\n  return <div style={styles.container}>{trackers}</div>;\n}\n\nexport default SpectraTracker;\n","import max from 'ml-array-max';\nimport { useContext, useEffect, useState } from 'react';\n\nimport { BrushContext } from '../../EventsTrackers/BrushTracker';\nimport { MouseContext } from '../../EventsTrackers/MouseTracker';\nimport { useChartData } from '../../context/ChartContext';\nimport { useScale } from '../../context/ScaleContext';\nimport { options } from '../../toolbar/ToolTypes';\n\nconst styles = {\n  radius: 10,\n  borderColor: '#1f1f1f',\n  strokeWidth: 1,\n  fillOpacity: 0,\n  SVGPadding: 1,\n};\n\nfunction PeakPointer() {\n  const {\n    height,\n    width,\n    margin,\n    activeSpectrum,\n    data,\n    mode,\n    selectedTool,\n    verticalAlign,\n  } = useChartData();\n  const { scaleX, scaleY } = useScale();\n\n  let position = useContext(MouseContext);\n  const brushState = useContext(BrushContext);\n  const [closePeakPosition, setPosition] = useState();\n\n  useEffect(() => {\n    function getVerticalAlign() {\n      if (activeSpectrum) {\n        return verticalAlign.flag\n          ? verticalAlign.stacked\n            ? (activeSpectrum.index + 1) * verticalAlign.value\n            : 0\n          : 0;\n      }\n      return 0;\n    }\n\n    const getClosePeak = (xShift, mouseCoordinates) => {\n      if (\n        activeSpectrum &&\n        position &&\n        selectedTool === options.peakPicking.id\n      ) {\n        const range = [\n          scaleX().invert(mouseCoordinates.x - xShift),\n          scaleX().invert(mouseCoordinates.x + xShift),\n        ].sort(function (a, b) {\n          return a - b;\n        });\n\n        //get the active sepectrum data by looking for it by id\n        const spectrumData = data.find((d) => d.id === activeSpectrum.id);\n\n        const maxIndex =\n          spectrumData.data.x.findIndex((number) => number >= range[1]) - 1;\n        const minIndex = spectrumData.data.x.findIndex(\n          (number) => number >= range[0],\n        );\n\n        const yDataRange = spectrumData.data.y.slice(minIndex, maxIndex);\n        if (yDataRange && yDataRange.length > 0) {\n          const yValue = max(yDataRange);\n          const xIndex = yDataRange.findIndex((value) => value === yValue);\n          const xValue = spectrumData.data.x[minIndex + xIndex];\n          return {\n            x: scaleX()(xValue),\n            y: scaleY(activeSpectrum.id)(yValue) - getVerticalAlign(),\n            xIndex: minIndex + xIndex,\n          };\n        }\n      }\n      return null;\n    };\n\n    const candidatePeakPosition = getClosePeak(10, position);\n    setPosition(candidatePeakPosition);\n  }, [\n    activeSpectrum,\n    data,\n    mode,\n    position,\n    scaleX,\n    scaleY,\n    selectedTool,\n    verticalAlign,\n  ]);\n\n  if (\n    selectedTool !== options.peakPicking.id ||\n    !closePeakPosition ||\n    !activeSpectrum ||\n    brushState.step === 'brushing' ||\n    !position ||\n    position.y < margin.top ||\n    position.left < margin.left ||\n    position.x > width - margin.right ||\n    position.y > height - margin.bottom\n  ) {\n    return null;\n  }\n\n  return (\n    <div\n      key=\"peakPointer\"\n      style={{\n        cursor: 'crosshair',\n        transform: `translate(${closePeakPosition.x}px, ${closePeakPosition.y}px)`,\n        transformOrigin: 'top left',\n        position: 'absolute',\n        top: -(styles.radius + styles.SVGPadding),\n        left: -(styles.radius + styles.SVGPadding),\n        pointerEvents: 'none',\n        overflow: 'visible',\n      }}\n    >\n      <svg\n        width={styles.radius * 2 + styles.SVGPadding * 2}\n        height={styles.radius * 2 + styles.SVGPadding * 2}\n      >\n        <circle\n          cx={styles.radius + styles.SVGPadding}\n          cy={styles.radius + styles.SVGPadding}\n          r={styles.radius}\n          stroke={styles.borderColor}\n          strokeWidth={styles.strokeWidth}\n          fillOpacity={styles.fillOpacity}\n        />\n        <line\n          x1={styles.radius + styles.SVGPadding}\n          y1={styles.SVGPadding}\n          x2={styles.radius + styles.SVGPadding}\n          y2={styles.radius * 2 + styles.SVGPadding}\n          stroke={styles.borderColor}\n          strokeWidth={styles.strokeWidth}\n        />\n        <line\n          x1={styles.SVGPadding}\n          y1={styles.radius + styles.SVGPadding}\n          x2={styles.radius * 2 + styles.SVGPadding}\n          y2={styles.radius + styles.SVGPadding}\n          stroke={styles.borderColor}\n          strokeWidth={styles.strokeWidth}\n        />\n      </svg>\n    </div>\n  );\n}\n\nexport default PeakPointer;\n","import { useChartData } from '../../context/ChartContext';\nimport { useScale } from '../../context/ScaleContext';\nimport { options } from '../../toolbar/ToolTypes';\n\nconst styles = {\n  container: {\n    transformOrigin: 'top left',\n    position: 'absolute',\n    top: '0px',\n    left: '0px',\n    width: 1,\n    backgroundColor: 'red',\n  },\n};\n\nfunction VerticalIndicator() {\n  const { height, selectedTool, pivot } = useChartData();\n  const { scaleX } = useScale();\n\n  if (options.phaseCorrection.id !== selectedTool) return null;\n  return (\n    <div\n      style={{\n        ...styles.container,\n        transform: `translate(${scaleX()(pivot)}px, 0px)`,\n        height: height,\n      }}\n    />\n  );\n}\n\nexport default VerticalIndicator;\n","import { useContext, useCallback, useMemo } from 'react';\n\nimport { BrushContext } from '../../EventsTrackers/BrushTracker';\nimport { MouseContext } from '../../EventsTrackers/MouseTracker';\nimport { useChartData } from '../../context/ChartContext';\nimport { useScale } from '../../context/ScaleContext';\nimport { useFormatNumberByNucleus } from '../../utility/FormatNumber';\n\nconst style = {\n  cursor: 'crosshair',\n  transformOrigin: 'bottom right',\n  position: 'absolute',\n  top: '-18px',\n  left: '-30px',\n  pointerEvents: 'none',\n  overflow: 'visible',\n  userSelect: 'none',\n};\n\nfunction XLabelPointer() {\n  const { height, width, margin, data, activeSpectrum } = useChartData();\n  const { scaleX } = useScale();\n\n  const position = useContext(MouseContext);\n  const brushState = useContext(BrushContext);\n  const activeSpectrumData = useMemo(() => {\n    const spectrumData = activeSpectrum\n      ? data.find((d) => d.id === activeSpectrum.id)\n      : null;\n    return spectrumData;\n  }, [activeSpectrum, data]);\n  const format = useFormatNumberByNucleus(\n    activeSpectrumData && activeSpectrumData.info.nucleus,\n  );\n\n  const getXValue = useCallback(\n    (xVal) => {\n      if (activeSpectrumData) {\n        const xInvert = scaleX().invert(xVal);\n        return format(xInvert);\n      }\n    },\n    [activeSpectrumData, format, scaleX],\n  );\n\n  if (\n    !activeSpectrum ||\n    brushState.step === 'brushing' ||\n    !position ||\n    position.y < margin.top ||\n    position.x < margin.left ||\n    position.x > width - margin.right ||\n    position.y > height - margin.bottom\n  ) {\n    return null;\n  }\n  return (\n    <div\n      key=\"xLabelPointer\"\n      style={{\n        ...style,\n        transform: `translate(${position.x}px, ${position.y}px)`,\n      }}\n    >\n      <span>{getXValue(position.x)}</span>\n    </div>\n  );\n}\n\nexport default XLabelPointer;\n","import { useCallback, Fragment, useEffect, useState, useReducer } from 'react';\nimport { useSize, useDebounce } from 'react-use';\n\nimport { BrushTracker } from '../EventsTrackers/BrushTracker';\nimport { MouseTracker } from '../EventsTrackers/MouseTracker';\nimport { useChartData } from '../context/ChartContext';\nimport { useDispatch } from '../context/DispatchContext';\nimport { usePreferences } from '../context/PreferencesContext';\nimport { ScaleProvider } from '../context/ScaleContext';\nimport { useModal } from '../elements/popup/Modal';\nimport Spinner from '../loader/Spinner';\nimport MultipletAnalysisModal from '../modal/MultipletAnalysisModal';\nimport { ZoomType } from '../reducer/actions/Zoom';\nimport {\n  scaleInitialState,\n  scaleReducer,\n  SET_SCALE,\n} from '../reducer/scaleReducer';\nimport {\n  ADD_INTEGRAL,\n  ADD_PEAKS,\n  ADD_BASE_LINE_ZONE,\n  BRUSH_END,\n  FULL_ZOOM_OUT,\n  CHANGE_INTEGRAL_ZOOM,\n  SET_ZOOM_FACTOR,\n  ADD_PEAK,\n  SET_VERTICAL_INDICATOR_X_POSITION,\n  SET_DIMENSIONS,\n  ADD_RANGE,\n  ANALYZE_SPECTRA,\n  ADD_EXCLUSION_ZONE,\n} from '../reducer/types/Types';\nimport BrushXY, { BRUSH_TYPE } from '../tool/BrushXY';\nimport CrossLinePointer from '../tool/CrossLinePointer';\nimport { options } from '../toolbar/ToolTypes';\nimport Events from '../utility/Events';\n\nimport Chart1D from './Chart1D';\nimport FooterBanner from './FooterBanner';\nimport SpectraTracker from './SpectraTracker';\nimport PeakPointer from './tool/PeakPointer';\nimport VerticalIndicator from './tool/VerticalIndicator';\nimport XLabelPointer from './tool/XLabelPointer';\n\nfunction Viewer1D({ emptyText = undefined }) {\n  const {\n    display: { general },\n  } = usePreferences();\n  const state = useChartData();\n  const {\n    selectedTool,\n    isLoading,\n    data,\n    mode,\n    width: widthProp,\n    height: heightProp,\n    margin,\n    activeSpectrum,\n    xDomain,\n    xDomains,\n    yDomain,\n    yDomains,\n    verticalAlign,\n    displayerKey,\n  } = state;\n  const dispatch = useDispatch();\n  const modal = useModal();\n  const [scaleState, dispatchScale] = useReducer(\n    scaleReducer,\n    scaleInitialState,\n  );\n\n  useEffect(() => {\n    if (xDomain.length > 0 && yDomain.length > 0 && widthProp && heightProp) {\n      dispatchScale({\n        type: SET_SCALE,\n        payload: {\n          yDomain,\n          yDomains,\n          xDomain,\n          xDomains,\n          margin,\n          height: heightProp,\n          width: widthProp,\n          verticalAlign,\n          mode,\n        },\n      });\n    }\n  }, [\n    heightProp,\n    margin,\n    mode,\n    verticalAlign,\n    widthProp,\n    xDomain,\n    xDomains,\n    yDomain,\n    yDomains,\n  ]);\n\n  const handelBrushEnd = useCallback(\n    (brushData) => {\n      const propagateEvent = () => {\n        const { startX, endX } = brushData;\n        const startXPPM = scaleState.scaleX().invert(startX);\n        const endXPPM = scaleState.scaleX().invert(endX);\n        Events.emit('brushEnd', {\n          ...brushData,\n          range: [startXPPM, endXPPM].sort(),\n        });\n      };\n\n      if (brushData.altKey) {\n        switch (selectedTool) {\n          case options.rangesPicking.id: {\n            if (!general.disableMultipletAnalysis) {\n              modal.show(\n                <MultipletAnalysisModal\n                  data={data}\n                  activeSpectrum={activeSpectrum}\n                  scaleX={scaleState.scaleX}\n                  {...brushData}\n                />,\n                {\n                  onClose: () => {\n                    modal.close();\n                  },\n                },\n              );\n            }\n            break;\n          }\n          default:\n            break;\n        }\n      } else if (brushData.shiftKey) {\n        switch (selectedTool) {\n          case options.integral.id:\n            dispatch({\n              type: ADD_INTEGRAL,\n              ...brushData,\n            });\n            break;\n          case options.rangesPicking.id:\n            dispatch({\n              type: ADD_RANGE,\n              ...brushData,\n            });\n            break;\n          case options.multipleSpectraAnalysis.id:\n            dispatch({\n              type: ANALYZE_SPECTRA,\n              ...brushData,\n            });\n            break;\n\n          case options.peakPicking.id:\n            dispatch({\n              type: ADD_PEAKS,\n              ...brushData,\n            });\n            break;\n\n          case options.baseLineCorrection.id:\n            dispatch({\n              type: ADD_BASE_LINE_ZONE,\n              zone: { from: brushData.startX, to: brushData.endX },\n            });\n            break;\n\n          case options.exclusionZones.id:\n            dispatch({\n              type: ADD_EXCLUSION_ZONE,\n              payload: { from: brushData.startX, to: brushData.endX },\n            });\n            break;\n\n          default:\n            propagateEvent(brushData);\n\n            break;\n        }\n      } else {\n        switch (selectedTool) {\n          default:\n            if (selectedTool != null) {\n              dispatch({ type: BRUSH_END, ...brushData });\n            }\n            break;\n        }\n      }\n    },\n    [scaleState, selectedTool, general, modal, data, activeSpectrum, dispatch],\n  );\n\n  const handelOnDoubleClick = useCallback(() => {\n    dispatch({ type: FULL_ZOOM_OUT, zoomType: ZoomType.STEP_HROZENTAL });\n  }, [dispatch]);\n\n  const handleZoom = useCallback(\n    (event) => {\n      switch (selectedTool) {\n        case options.integral.id:\n          dispatch({ type: CHANGE_INTEGRAL_ZOOM, ...event });\n          break;\n\n        default:\n          dispatch({ type: SET_ZOOM_FACTOR, ...event });\n\n          return;\n      }\n    },\n    [dispatch, selectedTool],\n  );\n\n  const mouseClick = useCallback(\n    (position) => {\n      const propagateEvent = () => {\n        const xPPM = scaleState.scaleX().invert(position.x);\n        Events.emit('mouseClick', {\n          ...position,\n          xPPM,\n        });\n      };\n\n      if (position.shiftKey) {\n        switch (selectedTool) {\n          case options.peakPicking.id:\n            dispatch({\n              type: ADD_PEAK,\n              mouseCoordinates: position,\n            });\n            break;\n          default:\n            break;\n        }\n      } else {\n        switch (selectedTool) {\n          case options.phaseCorrection.id:\n            dispatch({\n              type: SET_VERTICAL_INDICATOR_X_POSITION,\n              position: position.x,\n            });\n            break;\n          case 'editRange':\n            if (position.shiftKey) {\n              propagateEvent();\n            }\n            break;\n\n          default:\n        }\n      }\n    },\n    [dispatch, scaleState, selectedTool],\n  );\n\n  const [sizedNMRChart, { width, height }] = useSize(() => {\n    return (\n      <Fragment>\n        <Spinner isLoading={isLoading} emptyText={emptyText} />\n\n        {scaleState.scaleX && scaleState.scaleY && data && data.length > 0 && (\n          <BrushTracker\n            onBrush={handelBrushEnd}\n            onDoubleClick={handelOnDoubleClick}\n            onClick={mouseClick}\n            onZoom={handleZoom}\n            style={{\n              width: '100%',\n              height: '100%',\n              margin: 'auto',\n              position: 'relative',\n              overflow: 'hidden',\n            }}\n          >\n            <MouseTracker\n              style={{ width: '100%', height: `100%`, position: 'absolute' }}\n            >\n              <SpectraTracker />\n              <CrossLinePointer />\n              <BrushXY brushType={BRUSH_TYPE.X} />\n              <XLabelPointer />\n              <PeakPointer />\n              <VerticalIndicator />\n              <FooterBanner />\n              <Chart1D\n                width={widthProp}\n                height={heightProp}\n                margin={margin}\n                mode={mode}\n                displayerKey={displayerKey}\n              />\n            </MouseTracker>\n          </BrushTracker>\n        )}\n      </Fragment>\n    );\n  }, []);\n\n  const [finalSize, setFinalSize] = useState();\n  useDebounce(() => setFinalSize({ width, height }), 400, [width, height]);\n  useEffect(() => {\n    if (finalSize && isFinite(finalSize.width) && isFinite(finalSize.height)) {\n      dispatch({\n        type: SET_DIMENSIONS,\n        ...finalSize,\n      });\n    }\n  }, [dispatch, finalSize]);\n\n  return <ScaleProvider value={scaleState}>{sizedNMRChart}</ScaleProvider>;\n}\n\nexport default Viewer1D;\n","import { useChartData } from '../context/ChartContext';\n\nfunction ContoursWrapper(WrappedComponent) {\n  const Wrapper = (props) => {\n    const { data, displayerKey } = useChartData();\n\n    const { forwardedRef, ...rest } = props;\n    return (\n      <WrappedComponent\n        {...rest}\n        data={data}\n        displayerKey={displayerKey}\n        ref={forwardedRef}\n      />\n    );\n  };\n\n  return (props) => {\n    return <Wrapper {...props} />;\n  };\n}\nexport default ContoursWrapper;\n","const LAYOUT = {\n  TOP_1D: 'TOP_1D',\n  LEFT_1D: 'LEFT_1D',\n  CENTER_2D: 'CENTER_2D',\n};\n\nfunction get2DDimensionLayout({ width, height, margin }) {\n  return {\n    CENTER_2D: {\n      startX: margin.left,\n      startY: margin.top,\n      endX: width - margin.right,\n      endY: height - margin.bottom,\n    },\n    TOP_1D: {\n      startX: margin.left,\n      startY: 0,\n      endX: width - margin.right,\n      endY: margin.top,\n    },\n    LEFT_1D: {\n      startX: 0,\n      startY: margin.top,\n      endX: margin.left,\n      endY: height - margin.bottom,\n    },\n  };\n}\n\nfunction getLayoutID(dimension, brushData) {\n  for (const key of Object.keys(dimension)) {\n    if (\n      brushData.startX >= dimension[key].startX &&\n      brushData.startX <= dimension[key].endX &&\n      brushData.startY >= dimension[key].startY &&\n      brushData.startY <= dimension[key].endY\n    ) {\n      return key;\n    }\n  }\n  return null;\n}\n\nexport { LAYOUT, get2DDimensionLayout, getLayoutID };\n","import { scaleLinear } from 'd3';\n\nimport { LAYOUT } from './DimensionLayout';\n\n/***\n * @param {object} props\n * @param {number}  props.width\n * @param {number}  props.margin\n * @param {number}  props.xDomain\n */\n\nfunction get2DXScale(props) {\n  const { width, margin, xDomain } = props;\n  return scaleLinear(xDomain, [width - margin.right, margin.left]);\n}\n\n/***\n * props {height,margin,yDomain}\n */\n/***\n * @param {any} props\n * @param {number}  props.height\n * @param {number}  props.margin\n * @param {number}  props.yDomain\n */\nfunction get2DYScale(props, reverse = false) {\n  const { height, margin, yDomain } = props;\n  return scaleLinear(\n    yDomain,\n    reverse\n      ? [height - margin.bottom, margin.top]\n      : [margin.top, height - margin.bottom],\n  );\n}\n\nfunction get1DXScale(props, layout) {\n  if (![LAYOUT.TOP_1D, LAYOUT.LEFT_1D].includes(layout)) {\n    throw new Error(\n      `layout is required and must be ${LAYOUT.TOP_1D} or ${LAYOUT.LEFT_1D}  `,\n    );\n  }\n\n  switch (layout) {\n    case LAYOUT.TOP_1D: {\n      const { width, margin, xDomain } = props;\n      return scaleLinear(xDomain, [width - margin.right, margin.left]);\n    }\n    case LAYOUT.LEFT_1D: {\n      const { height, margin, yDomain } = props;\n      return scaleLinear(yDomain, [height - margin.bottom, margin.top]);\n    }\n    default:\n      break;\n  }\n}\n\nfunction get1DYScale(yDomain, height, margin = 10) {\n  return scaleLinear(yDomain, [height - margin, margin]);\n}\n\nexport { get2DXScale, get2DYScale, get1DXScale, get1DYScale };\n","import get from 'lodash/get';\nimport { memo, useMemo } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\nimport { usePreferences } from '../context/PreferencesContext';\nimport ContoursWrapper from '../hoc/ContoursWrapper';\n\nimport { get2DXScale, get2DYScale } from './utilities/scale';\n\nfunction ContoursPaths({ id: spectrumID, sign, color }) {\n  const {\n    margin,\n    width,\n    height,\n    xDomain,\n    yDomain,\n    contours,\n    activeSpectrum,\n  } = useChartData();\n\n  const preferences = usePreferences();\n\n  const isActive = useMemo(() => {\n    return activeSpectrum === null\n      ? true\n      : spectrumID === activeSpectrum.id\n      ? true\n      : false;\n  }, [activeSpectrum, spectrumID]);\n\n  function buildContourPath(data) {\n    const _scaleX = get2DXScale({ margin, width, xDomain });\n    const _scaleY = get2DYScale({ margin, height, yDomain });\n    let path = '';\n    for (let i = 0; i < data.length; i++) {\n      if (data[i].lines) {\n        const lines = data[i].lines;\n        if (lines.length < 1e6) {\n          for (let i = 0; i < lines.length; i += 4) {\n            path += `M${_scaleX(lines[i])} ${_scaleY(lines[i + 1])} `;\n            path += `L${_scaleX(lines[i + 2])} ${_scaleY(lines[i + 3])} `;\n          }\n        }\n      } else {\n        path += `M${_scaleX(data[i][0].x)} ${_scaleY(data[i][0].y)} `;\n        for (let j = 1; j < data[i].length; j++) {\n          path += `L${_scaleX(data[i][j].x)} ${_scaleY(data[i][j].y)} `;\n        }\n      }\n    }\n    if (!path) path = 'M0 0 ';\n    path += 'Z';\n\n    return path;\n  }\n  const data = useMemo(() => {\n    return get(contours, `${spectrumID}.${sign}`, []);\n  }, [contours, sign, spectrumID]);\n  return (\n    <path\n      fill=\"none\"\n      stroke={color}\n      strokeWidth=\"1\"\n      style={{\n        opacity: isActive\n          ? 1\n          : get(preferences, 'controllers.dimmedSpectraTransparency', 0.1),\n      }}\n      d={buildContourPath(data)}\n    />\n  );\n}\n\nfunction Contours({ data, displayerKey }) {\n  return (\n    <g clipPath={`url(#${displayerKey}clip-chart-2d)`} className=\"contours\">\n      {data\n        .filter((datum) => datum.info.dimension === 2)\n        .map((datum, index) => (\n          <g key={`${datum.id + index}`}>\n            {datum.display.isPositiveVisible && (\n              <ContoursPaths\n                id={datum.id}\n                sign=\"positive\"\n                color={datum.display.positiveColor}\n              />\n            )}\n            {datum.display.isNegativeVisible && (\n              <ContoursPaths\n                id={datum.id}\n                sign=\"negative\"\n                color={datum.display.negativeColor}\n              />\n            )}\n          </g>\n        ))}\n    </g>\n  );\n}\n\nexport default ContoursWrapper(memo(Contours));\n","export const DEFAULT_YAXIS_SHIFT_VALUE = 20;\n\nexport const DISPLAYER_MODE = {\n  DM_1D: '1D',\n  DM_2D: '2D',\n};\n\nexport const MARGIN = {\n  '2D': { top: 100, right: 50, bottom: 70, left: 100 },\n  '1D': {\n    top: 10,\n    right: 10,\n    bottom: 70,\n    left: 10,\n  },\n};\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useState, useEffect, useMemo } from 'react';\n\nimport { SignalKindsToInclude } from '../../data/constants/SignalsKinds';\nimport { useChartData } from '../context/ChartContext';\nimport { DISPLAYER_MODE } from '../reducer/core/Constants';\n\nimport { get2DXScale, get2DYScale } from './utilities/scale';\n\nconst lineStyle = css`\n  stroke: lightgrey;\n  opacity: 0.7;\n`;\n\nfunction IndicationLines({ axis, show }) {\n  const {\n    data,\n    activeTab,\n    margin,\n    width,\n    height,\n    xDomain,\n    yDomain,\n    displayerMode,\n  } = useChartData();\n  const [deltas1D, setDeltas1D] = useState([]);\n\n  const scaleX = get2DXScale({ margin, width, xDomain });\n  const scaleY = get2DYScale({ margin, height, yDomain });\n\n  useEffect(() => {\n    const split = activeTab.split(',');\n    if (displayerMode === DISPLAYER_MODE.DM_2D && split.length === 2) {\n      const nucleus = axis === 'X' ? split[0] : axis === 'Y' ? split[1] : null;\n      if (nucleus !== null) {\n        const ranges = data\n          .filter(\n            (_datum) =>\n              _datum.info.dimension === 1 &&\n              _datum.display.isVisible === true &&\n              _datum.info.nucleus === nucleus &&\n              _datum.info.experiment === '1d',\n          )\n          .map((_datum) => _datum.ranges.values)\n          .flat();\n        const deltas = ranges\n          .map((_range) =>\n            _range.signal\n              .filter((_signal) =>\n                SignalKindsToInclude.some((_kind) => _signal.kind === _kind),\n              )\n              .map((_signal) => _signal.delta),\n          )\n          .flat();\n        setDeltas1D(deltas);\n      } else {\n        setDeltas1D([]);\n      }\n    } else {\n      setDeltas1D([]);\n    }\n  }, [activeTab, axis, data, displayerMode]);\n\n  const indicationLines = useMemo(() => {\n    if (show === true && deltas1D.length > 0) {\n      const lines = deltas1D.map((_delta, i) => {\n        return axis === 'X' ? (\n          <line\n            css={lineStyle}\n            // eslint-disable-next-line react/no-array-index-key\n            key={`indicationLine${axis}${i}`}\n            x1={scaleX(_delta)}\n            x2={scaleX(_delta)}\n            y1={scaleY(yDomain[0])}\n            y2={scaleY(yDomain[1])}\n          />\n        ) : axis === 'Y' ? (\n          <line\n            css={lineStyle}\n            // eslint-disable-next-line react/no-array-index-key\n            key={`indicationLine${axis}${i}`}\n            x1={scaleX(xDomain[0])}\n            x2={scaleX(xDomain[1])}\n            y1={scaleY(_delta)}\n            y2={scaleY(_delta)}\n          />\n        ) : null;\n      });\n      return lines;\n    }\n  }, [axis, deltas1D, scaleX, scaleY, show, xDomain, yDomain]);\n\n  return <g>{indicationLines}</g>;\n}\n\nexport default IndicationLines;\n","import { xyReduce } from 'ml-spectra-processing';\nimport { useMemo, memo } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\n\nimport { get1DYScale, get2DYScale } from './utilities/scale';\n\nfunction Left1DChart({ margin: marignValue, data: spectrum }) {\n  const {\n    height: originHeight,\n    margin,\n    yDomain,\n    yDomains,\n    displayerKey,\n  } = useChartData();\n\n  const height = margin.left;\n\n  const paths = useMemo(() => {\n    if (spectrum) {\n      const scaleX = get2DYScale({\n        height: originHeight,\n        yDomain: [yDomain[0], yDomain[1]],\n        margin,\n      });\n      const scaleY = get1DYScale(yDomains[spectrum.id], height, marignValue);\n\n      const { x, y } = spectrum.data;\n      const pathPoints = xyReduce(\n        { x, y },\n        {\n          from: yDomain[0],\n          to: yDomain[1],\n        },\n      );\n      const lastXIndex = pathPoints.x.length - 1;\n      const lastYIndex = pathPoints.y.length - 1;\n      let path = `M  ${scaleY(pathPoints.y[lastYIndex])} ${scaleX(\n        lastXIndex,\n      )} `;\n      path += pathPoints.x\n        .slice(0, lastXIndex)\n        .reduceRight((accumulator, point, index) => {\n          accumulator += ` L  ${scaleY(pathPoints.y[index])} ${scaleX(point)}`;\n          return accumulator;\n        }, '');\n      return path;\n    } else {\n      return null;\n    }\n  }, [height, margin, marignValue, originHeight, spectrum, yDomain, yDomains]);\n\n  const mainHeight = originHeight - margin.bottom - margin.top;\n\n  if (!mainHeight || !height) return null;\n\n  return (\n    <svg\n      viewBox={`0 0 ${height} ${mainHeight + margin.top}`}\n      width={height}\n      height={mainHeight + margin.top}\n    >\n      <defs>\n        <clipPath id={`${displayerKey}clip-left`}>\n          <rect width={height} height={mainHeight} x=\"0\" y={margin.top} />\n        </clipPath>\n      </defs>\n      <g clipPath={`url(#${displayerKey}clip-left)`}>\n        <path className=\"line\" stroke=\"black\" fill=\"none\" d={paths} />\n      </g>\n    </svg>\n  );\n}\n\nLeft1DChart.defaultProps = {\n  margin: 10,\n};\n\nexport default memo(Left1DChart);\n","import { xyReduce } from 'ml-spectra-processing';\nimport { useMemo, memo } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\n\nimport { get1DYScale, get2DXScale } from './utilities/scale';\n\nfunction Top1DChart({ margin: marginProps, data: spectrum }) {\n  const {\n    width,\n    margin: originMargin,\n    xDomain,\n    yDomains,\n    displayerKey,\n  } = useChartData();\n  const height = originMargin.top;\n\n  const paths = useMemo(() => {\n    if (spectrum) {\n      const scaleX = get2DXScale({ width, xDomain, margin: originMargin });\n\n      const scaleY = get1DYScale(yDomains[spectrum.id], height, marginProps);\n\n      const { x, y } = spectrum.data;\n      const pathPoints = xyReduce(\n        { x, y },\n        {\n          from: xDomain[0],\n          to: xDomain[1],\n        },\n      );\n\n      let path = `M ${scaleX(pathPoints.x[0])} ${scaleY(pathPoints.y[0])} `;\n      path += pathPoints.x.slice(1).reduce((accumulator, point, i) => {\n        accumulator += ` L ${scaleX(point)} ${scaleY(pathPoints.y[i + 1])}`;\n        return accumulator;\n      }, '');\n      return path;\n    } else {\n      return null;\n    }\n  }, [height, marginProps, originMargin, spectrum, width, xDomain, yDomains]);\n\n  if (!width || !height) {\n    return null;\n  }\n\n  return (\n    <svg viewBox={`0 0 ${width} ${height}`} width={width} height={height}>\n      <defs>\n        <clipPath id={`${displayerKey}clip-top`}>\n          <rect\n            width={width - originMargin.left - originMargin.right}\n            height={height}\n            x={originMargin.left}\n            y={`${0}`}\n          />\n        </clipPath>\n      </defs>\n      <g clipPath={`url(#${displayerKey}clip-top)`}>\n        <path\n          className=\"line\"\n          stroke=\"red\"\n          fill=\"none\"\n          strokeWidth=\"1px\"\n          d={paths}\n        />\n      </g>\n    </svg>\n  );\n}\n\nTop1DChart.defaultProps = {\n  margin: 10,\n};\n\nexport default memo(Top1DChart);\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport * as d3 from 'd3';\nimport PropTypes from 'prop-types';\nimport { useEffect, useRef, useMemo, memo } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\n\nimport { get2DXScale } from './utilities/scale';\n\nconst axisStyles = css`\n  user-select: none;\n\n  path,\n  line {\n    fill: none;\n    stroke: black;\n    stroke-width: 1;\n    shape-rendering: crispEdges;\n    user-select: none;\n  }\n`;\n\nfunction XAxis({ show, label, margin: marginProps }) {\n  const state = useChartData();\n  const {\n    xDomain,\n    height,\n    width,\n    margin,\n    tabActiveSpectrum,\n    activeTab,\n  } = state;\n\n  const refAxis = useRef();\n\n  useEffect(() => {\n    const xAxis = d3.axisBottom().ticks(8).tickFormat(d3.format('0'));\n\n    if (show) {\n      const scaleX = get2DXScale({ width, margin, xDomain });\n      d3.select(refAxis.current).call(xAxis.scale(scaleX));\n    }\n  }, [\n    activeTab,\n    height,\n    margin,\n    margin.bottom,\n    margin.left,\n    margin.right,\n    margin.top,\n    show,\n    tabActiveSpectrum,\n    width,\n    xDomain,\n  ]);\n\n  const Axis = useMemo(\n    () =>\n      show &&\n      show === true && (\n        <g\n          className=\"x\"\n          css={axisStyles}\n          transform={`translate(0,${\n            height - (margin.bottom + marginProps.bottom)\n          })`}\n          ref={refAxis}\n        >\n          <text fill=\"#000\" x={width - 60} y=\"20\" dy=\"0.71em\" textAnchor=\"end\">\n            {label}\n          </text>\n        </g>\n      ),\n\n    [height, label, margin.bottom, marginProps.bottom, show, width],\n  );\n\n  if (!width || !height) {\n    return null;\n  }\n\n  return Axis;\n}\n\nXAxis.propTypes = {\n  margin: PropTypes.shape({\n    top: PropTypes.number.isRequired,\n    right: PropTypes.number.isRequired,\n    bottom: PropTypes.number.isRequired,\n    left: PropTypes.number.isRequired,\n  }),\n  show: PropTypes.bool,\n  label: PropTypes.string,\n};\n\nXAxis.defaultProps = {\n  show: true,\n  label: ' [ppm]',\n  margin: { right: 100, top: 0, left: 0, bottom: 0 },\n};\n\nexport default memo(XAxis);\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport * as d3 from 'd3';\nimport { Fragment, useEffect, useRef, useMemo, memo } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\n\nimport { get2DYScale } from './utilities/scale';\n\nconst axisStyles = css`\n  user-select: 'none';\n  -webkit-user-select: none; /* Chrome all / Safari all */\n  -moz-user-select: none; /* Firefox all */\n\n  path,\n  line {\n    fill: none;\n    stroke: black;\n    stroke-width: 1;\n    shape-rendering: crispEdges;\n    user-select: 'none';\n    -webkit-user-select: none; /* Chrome all / Safari all */\n    -moz-user-select: none; /* Firefox all */\n  }\n`;\n\nfunction YAxis({ show, label, margin: marginProps }) {\n  const refAxis = useRef();\n  const state = useChartData();\n  const {\n    yDomain,\n    width,\n    height,\n    activeTab,\n    tabActiveSpectrum,\n    margin,\n  } = state;\n\n  useEffect(() => {\n    const axis = d3.axisRight().ticks(8).tickFormat(d3.format('0'));\n\n    if (show && yDomain) {\n      const scaleY = get2DYScale({ height, yDomain, margin });\n\n      d3.select(refAxis.current).call(axis.scale(scaleY));\n    }\n  }, [show, yDomain, activeTab, tabActiveSpectrum, height, margin]);\n\n  const Axis = useMemo(\n    () =>\n      show &&\n      show === true && (\n        <Fragment>\n          <g\n            className=\"y\"\n            css={axisStyles}\n            transform={`translate(${width - marginProps.right})`}\n            ref={refAxis}\n          >\n            <text\n              fill=\"#000\"\n              x={-marginProps.top}\n              y={-(marginProps.right - 5)}\n              dy=\"0.71em\"\n              transform=\"rotate(-90)\"\n              textAnchor=\"end\"\n            >\n              {label}\n            </text>\n          </g>\n        </Fragment>\n      ),\n\n    [label, marginProps.right, marginProps.top, show, width],\n  );\n\n  if (!width || !height) {\n    return null;\n  }\n\n  return Axis;\n}\n\nYAxis.defaultProps = {\n  show: true,\n  label: '',\n  margin: { right: 50, top: 0, bottom: 0, left: 0 },\n};\n\nexport default memo(YAxis);\n","import { useMemo, memo, forwardRef } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\nimport { usePreferences } from '../context/PreferencesContext';\n\nfunction ZonesWrapper(WrappedComponent) {\n  const Wrapper = (props) => {\n    const {\n      data,\n      activeSpectrum,\n      xDomain,\n      yDomain,\n      activeTab,\n      tabActiveSpectrum,\n      displayerKey,\n    } = useChartData();\n    const preferences = usePreferences();\n\n    const { zones = {}, info = {}, display = {} } = useMemo(() => {\n      if (data && activeSpectrum && activeSpectrum.id) {\n        const datum = data.find((datum) => datum.id === activeSpectrum.id) || {\n          zones: {},\n          info: {},\n          display: {},\n        };\n        return datum;\n      }\n      return {};\n    }, [activeSpectrum, data]);\n\n    const nucleus = useMemo(() => {\n      if (tabActiveSpectrum && Object.keys(tabActiveSpectrum).length > 0) {\n        return Object.keys(tabActiveSpectrum);\n      }\n      return null;\n    }, [tabActiveSpectrum]);\n\n    const { forwardedRef, ...rest } = props;\n    return (\n      <WrappedComponent\n        {...rest}\n        zones={zones}\n        display={display}\n        info={info}\n        xDomain={xDomain}\n        yDomain={yDomain}\n        preferences={preferences}\n        activeTab={activeTab}\n        nucleus={nucleus}\n        displayerKey={displayerKey}\n        ref={forwardedRef}\n      />\n    );\n  };\n\n  return memo(\n    forwardRef((props, ref) => {\n      return <Wrapper {...props} forwardedRef={ref} />;\n    }),\n  );\n}\nexport default ZonesWrapper;\n","import { DatumKind } from '../constants/SignalsKinds';\n\nconst getDiaIDs = (zone, axis) => {\n  return [].concat(\n    zone[axis].diaID || [],\n    zone.signal\n      ? zone.signal.map((_signal) => _signal[axis].diaID || []).flat()\n      : [],\n  );\n};\n\nconst getPubIntegral = (zone, axis) => {\n  return getDiaIDs(zone, axis).length;\n};\n\nconst setPubIntegral = (zone, axis) => {\n  zone[axis].pubIntegral = getPubIntegral(zone, axis);\n  if (zone[axis].pubIntegral === 0) {\n    delete zone[axis].pubIntegral;\n  }\n};\n\nconst resetDiaIDs = (zone, axis) => {\n  delete zone[axis].diaID;\n  delete zone.pubIntegral;\n  zone.signal.forEach((_signal) => {\n    delete _signal[axis].diaID;\n  });\n  return zone;\n};\n\nconst checkZoneKind = (zone) => {\n  return zone.kind === DatumKind.signal;\n};\n\nconst checkSignalKinds = (zone, kinds) => {\n  return !zone.signal.some(\n    (_signal) => _signal.kind === undefined || !kinds.includes(_signal.kind),\n  );\n};\n\nconst unlink = (zone, isOnZoneLevel, signalIndex, axis) => {\n  if (isOnZoneLevel !== undefined && axis !== undefined) {\n    if (isOnZoneLevel === true) {\n      delete zone[axis].diaID;\n    } else if (signalIndex !== undefined) {\n      delete zone.signal[signalIndex][axis].diaID;\n    }\n    setPubIntegral(zone, axis);\n  } else if (axis !== undefined) {\n    resetDiaIDs(zone, axis);\n    setPubIntegral(zone, axis);\n  } else {\n    ['x', 'y'].forEach((key) => {\n      resetDiaIDs(zone, key);\n      setPubIntegral(zone, key);\n    });\n  }\n  return zone;\n};\n\nconst unlinkInAssignmentData = (assignmentData, zones, axis) => {\n  const ids = zones.reduce((acc, zone) => {\n    acc.push(zone.id);\n    if (zone.signal) {\n      acc.concat(zone.signal.map((signal) => signal.id, []));\n    }\n    return acc;\n  }, []);\n\n  if (axis) {\n    assignmentData.dispatch({\n      type: 'REMOVE_ALL',\n      payload: { id: ids, axis },\n    });\n  } else {\n    assignmentData.dispatch({\n      type: 'REMOVE_ALL',\n      payload: { id: ids, axis: 'x' },\n    });\n    assignmentData.dispatch({\n      type: 'REMOVE_ALL',\n      payload: { id: ids, axis: 'y' },\n    });\n  }\n};\n\nexport {\n  checkSignalKinds,\n  checkZoneKind,\n  getDiaIDs,\n  getPubIntegral,\n  resetDiaIDs,\n  unlink,\n  unlinkInAssignmentData,\n};\n","const ConcatenationString = '___';\n\nconst buildID = (prefix, suffix) => {\n  return `${prefix}${ConcatenationString}${suffix}`;\n};\n\nexport { buildID, ConcatenationString };\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useMemo } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\n\nimport { get2DXScale, get2DYScale } from './utilities/scale';\n\nconst lineStyle = css`\n  stroke: green;\n  stroke-width: 2;\n  opacity: 0.5;\n`;\n\nfunction SignalDeltaLine({ delta, axis, show }) {\n  const { margin, width, height, xDomain, yDomain } = useChartData();\n  const scaleX = get2DXScale({ margin, width, xDomain });\n  const scaleY = get2DYScale({ margin, height, yDomain });\n\n  const line = useMemo(() => {\n    return show === true ? (\n      axis === 'X' ? (\n        <line\n          css={lineStyle}\n          key={`signalLine_${delta}_X`}\n          x1={scaleX(delta)}\n          x2={scaleX(delta)}\n          y1={scaleY(yDomain[0])}\n          y2={scaleY(yDomain[1])}\n        />\n      ) : axis === 'Y' ? (\n        <line\n          css={lineStyle}\n          key={`signalLine_${delta}_Y`}\n          x1={scaleX(xDomain[0])}\n          x2={scaleX(xDomain[1])}\n          y1={scaleY(delta)}\n          y2={scaleY(delta)}\n        />\n      ) : null\n    ) : null;\n  }, [axis, delta, scaleX, scaleY, show, xDomain, yDomain]);\n\n  return <g>{line}</g>;\n}\n\nexport default SignalDeltaLine;\n","/** @jsxImportSource @emotion/react */\n\nimport { useMemo } from 'react';\n\nimport { buildID } from '../../../data/utilities/Concatenation';\nimport { useHighlight } from '../../highlight';\nimport SignalDeltaLine from '../SignalDeltaLine';\n\nfunction SignalCrosshair({ signal }) {\n  const highlightIDsX = useMemo(() => {\n    return [buildID(signal.id, 'Crosshair'), buildID(signal.id, 'Crosshair_X')];\n  }, [signal.id]);\n  const highlightIDsY = useMemo(() => {\n    return [buildID(signal.id, 'Crosshair'), buildID(signal.id, 'Crosshair_Y')];\n  }, [signal.id]);\n  const highlightX = useHighlight(highlightIDsX);\n  const highlightY = useHighlight(highlightIDsY);\n\n  return (\n    <g>\n      <SignalDeltaLine\n        delta={signal.x.delta}\n        axis=\"X\"\n        show={highlightX.isActive}\n      />\n      <SignalDeltaLine\n        delta={signal.y.delta}\n        axis=\"Y\"\n        show={highlightY.isActive}\n      />\n    </g>\n  );\n}\n\nexport default SignalCrosshair;\n","/** @jsxImportSource @emotion/react */\n\nimport { memo, useState, useEffect, useCallback } from 'react';\n\nimport { buildID } from '../../../data/utilities/Concatenation';\nimport { useAssignment } from '../../assignment';\nimport { useChartData } from '../../context/ChartContext';\nimport { useHighlightData, useHighlight } from '../../highlight';\nimport { get2DXScale, get2DYScale } from '../utilities/scale';\n\nimport SignalCrosshair from './SignalCrosshair';\n\nconst Signal = memo(({ signal, isVisible }) => {\n  const { margin, width, height, xDomain, yDomain } = useChartData();\n  const scaleX = get2DXScale({ margin, width, xDomain });\n  const scaleY = get2DYScale({ margin, height, yDomain });\n\n  const buildIDs = useCallback((id) => {\n    return [id].concat(buildID(id, 'X'), buildID(id, 'Y'));\n  }, []);\n\n  const assignment = useAssignment(signal.id);\n  const highlight = useHighlight(buildIDs(assignment.id));\n  const highlightData = useHighlightData();\n\n  const [isHighlighted, setIsHighlighted] = useState(false);\n\n  useEffect(() => {\n    if (\n      highlightData.highlight.highlighted.some((_highlighted) =>\n        buildIDs(signal.id).includes(_highlighted),\n      ) ||\n      assignment.isActive\n    ) {\n      setIsHighlighted(true);\n    } else {\n      setIsHighlighted(false);\n    }\n  }, [\n    assignment.isActive,\n    buildIDs,\n    highlightData.highlight.highlighted,\n    signal.id,\n  ]);\n\n  if (!signal) return null;\n\n  return (\n    <g\n      className=\"zone-signal\"\n      onMouseEnter={() => {\n        assignment.onMouseEnter();\n        highlight.show();\n      }}\n      onMouseLeave={() => {\n        assignment.onMouseLeave();\n        highlight.hide();\n      }}\n    >\n      {isVisible.signals && (\n        <g>\n          <circle\n            key={signal.id}\n            cx={scaleX(signal.x.delta)}\n            cy={scaleY(signal.y.delta)}\n            r={isHighlighted ? 6 : 4}\n            fill={isHighlighted ? 'green' : 'darkgreen'}\n          />\n          <SignalCrosshair signal={signal} />\n        </g>\n      )}\n      <g className=\"zone-signal-peak\">\n        {isVisible.peaks &&\n          signal.peak.map((peak, i) => (\n            <circle\n              key={`${signal.id + i}`}\n              cx={scaleX(peak.x)}\n              cy={scaleY(peak.y)}\n              r={2}\n              fill=\"black\"\n            />\n          ))}\n      </g>\n    </g>\n  );\n});\n\nexport default Signal;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useState, useEffect } from 'react';\n\nimport { checkZoneKind } from '../../../data/utilities/ZoneUtilities';\nimport { useAssignment } from '../../assignment';\nimport { useChartData } from '../../context/ChartContext';\nimport { TYPES, useHighlight } from '../../highlight';\nimport { get2DXScale, get2DYScale } from '../utilities/scale';\n\nimport Signal from './Signal';\n\nconst stylesOnHover = css`\n  pointer-events: bounding-box;\n  @-moz-document url-prefix() {\n    pointer-events: fill;\n  }\n  user-select: 'none';\n  -webkit-user-select: none; /* Chrome all / Safari all */\n  -moz-user-select: none; /* Firefox all */\n\n  // // disabled because Resizable component appears now when hovering over it\n  // :hover .range-area {\n  //   height: 100%;\n  //   fill: #ff6f0057;\n  //   cursor: pointer;\n  // }\n\n  .delete-button {\n    visibility: hidden;\n  }\n`;\n\nconst stylesHighlighted = css`\n  pointer-events: bounding-box;\n\n  @-moz-document url-prefix() {\n    pointer-events: fill;\n  }\n  .Integral-area {\n    // height: 100%;\n    fill: #ff6f0057;\n  }\n  .delete-button {\n    visibility: visible;\n    cursor: pointer;\n  }\n`;\n\nconst Zone = ({ zoneData, isVisible }) => {\n  const { x, y, id, signal } = zoneData;\n  const assignmentZone = useAssignment(id);\n  const highlightZone = useHighlight([assignmentZone.id], TYPES.ZONE);\n  const { margin, width, height, xDomain, yDomain } = useChartData();\n  const scaleX = get2DXScale({ margin, width, xDomain });\n  const scaleY = get2DYScale({ margin, height, yDomain });\n  const { from: x1, to: x2 } = x;\n  const { from: y1, to: y2 } = y;\n\n  const [reduceOpacity, setReduceOpacity] = useState(false);\n\n  useEffect(() => {\n    setReduceOpacity(!checkZoneKind(zoneData));\n  }, [zoneData]);\n\n  return (\n    <g\n      css={\n        highlightZone.isActive || assignmentZone.isActive\n          ? stylesHighlighted\n          : stylesOnHover\n      }\n      key={id}\n      onMouseEnter={() => {\n        assignmentZone.onMouseEnter();\n        highlightZone.show();\n      }}\n      onMouseLeave={() => {\n        assignmentZone.onMouseLeave();\n        highlightZone.hide();\n      }}\n    >\n      {isVisible.zones && (\n        <g transform={`translate(${scaleX(x2)},${scaleY(y1)})`}>\n          <rect\n            x=\"0\"\n            width={scaleX(x1) - scaleX(x2)}\n            height={scaleY(y2) - scaleY(y1)}\n            className=\"Integral-area\"\n            fill=\"#0000000f\"\n            stroke={reduceOpacity ? '#343a40' : 'darkgreen'}\n            strokeWidth={reduceOpacity ? '0' : '1'}\n          />\n        </g>\n      )}\n      {signal.map((_signal, i) => (\n        <Signal key={`${id + i}`} signal={_signal} isVisible={isVisible} />\n      ))}\n    </g>\n  );\n};\n\nZone.defaultProps = {\n  onDelete: () => null,\n};\n\nexport default Zone;\n","import { useEffect, useState } from 'react';\n\nimport ZonesWrapper from '../../hoc/ZonesWrapper';\nimport Events from '../../utility/Events';\n\nimport Zone from './Zone';\n\nconst Zones = ({ zones, display, displayerKey }) => {\n  const [isVisible, setVisibility] = useState({\n    zones: true,\n    signals: true,\n    peaks: true,\n  });\n  useEffect(() => {\n    Events.on('onZonesVisibilityChange', ({ key }) => {\n      setVisibility((prevVisiblity) => ({\n        ...prevVisiblity,\n        [key]: !prevVisiblity[key],\n      }));\n    });\n  }, []);\n  return (\n    <g clipPath={`url(#${displayerKey}clip-chart-2d)`} className=\"2D-Zones\">\n      {display.isVisible &&\n        zones.values.map((zone) => (\n          <g className=\"zone\" key={zone.id}>\n            <Zone zoneData={zone} isVisible={isVisible} />\n          </g>\n        ))}\n    </g>\n  );\n};\n\nexport default ZonesWrapper(Zones);\n","import PropsTypes from 'prop-types';\nimport { useMemo } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\n\nimport Contours from './Contours';\nimport IndicationLines from './IndicationLines';\nimport Left1DChart from './Left1DChart';\nimport Top1DChart from './Top1DChart';\nimport XAxis from './XAxis';\nimport YAxis from './YAxis';\nimport Zones from './zones/Zones';\n\nfunction Chart2D({ data }) {\n  const { width, height, margin, displayerKey } = useChartData();\n\n  const chart2d = useMemo(() => {\n    return (\n      <svg\n        viewBox={`0 0 ${width} ${height}`}\n        width={width}\n        height={height}\n        id=\"nmrSVG\"\n      >\n        <defs>\n          <clipPath id={`${displayerKey}clip-chart-2d`}>\n            <rect\n              width={width - margin.left - margin.right}\n              height={height - margin.top - margin.bottom}\n              x={margin.left}\n              y={margin.top}\n            />\n          </clipPath>\n        </defs>\n        <rect\n          width={width - margin.left - margin.right}\n          height={height - margin.top - margin.bottom}\n          x={margin.left}\n          y={margin.top}\n          stroke=\"black\"\n          strokeWidth=\"1\"\n          fill=\"transparent\"\n        />\n        {data && data[0] && <Top1DChart data={data[0]} />}\n        {data && data[1] && <Left1DChart data={data[1]} />}\n        <Contours />\n        <Zones />\n        <IndicationLines axis=\"X\" show />\n        <IndicationLines axis=\"Y\" show />\n\n        <g className=\"container\" style={{ pointerEvents: 'none' }}>\n          <XAxis />\n          <YAxis />\n        </g>\n      </svg>\n    );\n  }, [\n    width,\n    height,\n    displayerKey,\n    margin.left,\n    margin.right,\n    margin.top,\n    margin.bottom,\n    data,\n  ]);\n\n  return chart2d;\n}\nChart2D.defaultProps = {\n  onDimensionChange: () => null,\n};\n\nChart2D.propsTypes = {\n  onDimensionChange: PropsTypes.func.isRequired,\n};\n\nexport default Chart2D;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { xFindClosestIndex } from 'ml-spectra-processing';\nimport { useContext, useMemo, Fragment } from 'react';\nimport { MF } from 'react-mf';\n\nimport { BrushContext } from '../EventsTrackers/BrushTracker';\nimport { MouseContext } from '../EventsTrackers/MouseTracker';\nimport { useChartData } from '../context/ChartContext';\nimport { options } from '../toolbar/ToolTypes';\nimport { useFormatNumberByNucleus } from '../utility/FormatNumber';\n\nimport { getLayoutID, LAYOUT } from './utilities/DimensionLayout';\nimport { get2DXScale, get1DYScale, get2DYScale } from './utilities/scale';\n\nconst styles = css`\n  display: flex;\n  flex-firection: row;\n  align-items: center;\n  pointer-events: bounding-box;\n  user-select: 'none';\n  -webkit-user-select: none; /* Chrome all / Safari all */\n  -moz-user-select: none; /* Firefox all */\n  background-color: #f7f7f7;\n  height: 30px;\n  padding: 6px;\n  color: #8d0018;\n  position: absolute;\n  width: 100%;\n  bottom: 0;\n  div {\n    margin: 0px 10px;\n    display: inline-block;\n\n    .label {\n      font-size: 12px;\n      color: #4d4d4d;\n      font-weight: bold;\n    }\n    .value {\n      font-weight: bold;\n      font-size: 14px;\n    }\n    .unit {\n      font-weight: bold;\n      font-size: 10px;\n    }\n  }\n`;\nfunction FooterBanner({ layout, data1D }) {\n  const position = useContext(MouseContext);\n  const { startX, endX, startY, endY, step } = useContext(BrushContext);\n  const {\n    margin,\n    width,\n    height,\n    activeSpectrum,\n    xDomain,\n    yDomain,\n    yDomains,\n    activeTab,\n    data,\n    selectedTool,\n  } = useChartData();\n\n  const trackID =\n    position &&\n    getLayoutID(layout, {\n      startX: position.x,\n      startY: position.y,\n    });\n\n  const nucleuses = activeTab.split(',');\n  const [formatX, formatY] = useFormatNumberByNucleus(nucleuses);\n\n  const scaleX = useMemo(() => {\n    if (!data1D || data1D.length === 0) {\n      return get2DXScale({ width, margin, xDomain });\n    }\n    if (selectedTool !== options.slicingTool.id) {\n      switch (trackID) {\n        case LAYOUT.TOP_1D:\n        case LAYOUT.CENTER_2D: {\n          return get2DXScale({ width, margin, xDomain });\n        }\n        case LAYOUT.LEFT_1D: {\n          return get2DYScale({ height, margin, yDomain });\n        }\n        default:\n          return null;\n      }\n    }\n    return null;\n  }, [data1D, height, margin, selectedTool, trackID, width, xDomain, yDomain]);\n\n  const scaleY = useMemo(() => {\n    if (!data1D || data1D.length === 0) {\n      return get2DYScale({ height, margin, yDomain });\n    }\n    if (selectedTool !== options.slicingTool.id) {\n      switch (trackID) {\n        case LAYOUT.CENTER_2D: {\n          return get2DYScale({ height, margin, yDomain });\n        }\n        case LAYOUT.TOP_1D: {\n          return data1D[0]\n            ? get1DYScale(yDomains[data1D[0].id], margin.top)\n            : null;\n        }\n        case LAYOUT.LEFT_1D: {\n          return data1D[1]\n            ? get1DYScale(yDomains[data1D[1].id], margin.left)\n            : null;\n        }\n        default:\n          return null;\n      }\n    }\n    return null;\n  }, [data1D, height, margin, selectedTool, trackID, yDomain, yDomains]);\n\n  if (\n    !activeSpectrum ||\n    !position ||\n    position.y < 10 ||\n    position.x < 10 ||\n    position.x > width - margin.right ||\n    position.y > height - margin.bottom\n  ) {\n    return <div css={styles} />;\n  }\n  const getRealYValue = (cordinate) => {\n    let index = null;\n    if (trackID === LAYOUT.TOP_1D) {\n      index = 0;\n    } else if (trackID === LAYOUT.LEFT_1D) {\n      index = 1;\n    }\n    if (index != null && scaleX != null) {\n      const xIndex = xFindClosestIndex(\n        data1D[index].data.x,\n        scaleX.invert(cordinate),\n      );\n      return data1D[index].data.y[xIndex];\n    }\n    return 1;\n  };\n\n  const getXValue = (x = null) => {\n    if (scaleX != null) {\n      switch (trackID) {\n        case LAYOUT.CENTER_2D:\n        case LAYOUT.TOP_1D: {\n          return scaleX.invert(x ? x : position.x);\n        }\n        case LAYOUT.LEFT_1D: {\n          return scaleX.invert(x ? x : position.y);\n        }\n        default:\n          return 0;\n      }\n    }\n    return 0;\n  };\n\n  const getYValue = () => {\n    if (scaleY != null) {\n      switch (trackID) {\n        case LAYOUT.CENTER_2D:\n        case LAYOUT.TOP_1D: {\n          return scaleY.invert(position.y);\n        }\n        case LAYOUT.LEFT_1D: {\n          return scaleY.invert(position.x);\n        }\n        default:\n          return 0;\n      }\n    }\n    return 0;\n  };\n\n  const getRation = () => {\n    switch (trackID) {\n      case LAYOUT.TOP_1D: {\n        return (\n          (getRealYValue(startX) / (getRealYValue(endX) || Number.MIN_VALUE)) *\n          100\n        ).toFixed(2);\n      }\n      case LAYOUT.LEFT_1D: {\n        return (\n          (getRealYValue(startY) / (getRealYValue(endY) || Number.MIN_VALUE)) *\n          100\n        ).toFixed(2);\n      }\n      default:\n        return 0;\n    }\n  };\n\n  const getDeltaX = () => {\n    switch (trackID) {\n      case LAYOUT.TOP_1D: {\n        return (getXValue(startX) - getXValue(endX)).toPrecision(6);\n      }\n      case LAYOUT.LEFT_1D: {\n        return (getXValue(startY) - getXValue(endY)).toPrecision(6);\n      }\n      default:\n        return 0;\n    }\n  };\n\n  const getLabel = (label2d, labelld, nucleus) => {\n    return trackID === LAYOUT.CENTER_2D ? (\n      <Fragment>\n        {label2d} ( <MF mf={nucleus} /> )\n      </Fragment>\n    ) : (\n      labelld\n    );\n  };\n\n  const getZValue = () => {\n    if (trackID === LAYOUT.CENTER_2D) {\n      const { maxX, maxY, minX, minY, z } = data[activeSpectrum.index].data;\n\n      const xStep = (maxX - minX) / (z[0].length - 1);\n      const yStep = (maxY - minY) / (z.length - 1);\n      const xIndex = Math.floor((getXValue() - minX) / xStep);\n      const yIndex = Math.floor((getYValue() - minY) / yStep);\n\n      if (xIndex < 0 || xIndex >= z[0].length) return 0;\n      if (yIndex < 0 || yIndex >= z.length) return 0;\n\n      return z[yIndex][xIndex];\n    }\n    return 0;\n  };\n\n  return (\n    <div css={styles}>\n      <div>\n        <span className=\"label\">{getLabel('F2', 'X', nucleuses[0])} :</span>\n        <span className=\"value\">{formatX(getXValue())}</span>\n        <span className=\"unit\">ppm</span>\n      </div>\n\n      <div>\n        <span className=\"label\">{getLabel('F1', 'Y', nucleuses[1])} :</span>\n        <span className=\"value\">{formatY(getYValue())}</span>\n        <span className=\"unit\">ppm</span>\n      </div>\n      <div>\n        <span className=\"label\">Intensity :</span>\n        <span className=\"value\">{getZValue()}</span>\n      </div>\n      {step === 'brushing' && (\n        <div>\n          <span className=\"label\"> ppm :</span>\n          <span className=\"value\">{getDeltaX()}</span>\n        </div>\n      )}\n\n      {step === 'brushing' && (\n        <div>\n          <span className=\"label\"> ratio :</span>\n          <span className=\"value\">{getRation()}%</span>\n        </div>\n      )}\n    </div>\n  );\n}\n\nexport default FooterBanner;\n","import { useContext, useMemo } from 'react';\n\nimport { BrushContext } from '../../EventsTrackers/BrushTracker';\nimport { MouseContext } from '../../EventsTrackers/MouseTracker';\nimport { useChartData } from '../../context/ChartContext';\nimport { useFormatNumberByNucleus } from '../../utility/FormatNumber';\nimport { getLayoutID, LAYOUT } from '../utilities/DimensionLayout';\nimport { get2DXScale, get2DYScale, get1DYScale } from '../utilities/scale';\n\nconst style = {\n  cursor: 'crosshair',\n  transformOrigin: 'bottom right',\n  position: 'absolute',\n  top: '-18px',\n  left: '-88px',\n  fontWeight: 'bold',\n  pointerEvents: 'none',\n  overflow: 'visible',\n  userSelect: 'none',\n  width: '85px',\n  textAlign: 'right',\n};\n\nfunction XYLabelPointer({ layout, data1D }) {\n  const position = useContext(MouseContext);\n  const { step } = useContext(BrushContext);\n  const {\n    margin,\n    width,\n    height,\n    activeSpectrum,\n    xDomain,\n    yDomain,\n    yDomains,\n    activeTab,\n  } = useChartData();\n\n  const trackID =\n    position &&\n    getLayoutID(layout, {\n      startX: position.x,\n      startY: position.y,\n    });\n\n  const nucleuses = activeTab.split(',');\n  const [formatX, formatY] = useFormatNumberByNucleus(nucleuses);\n\n  const scaleX = useMemo(() => {\n    if (!data1D || data1D.length === 0) {\n      return get2DXScale({ width, margin, xDomain });\n    }\n    switch (trackID) {\n      case LAYOUT.TOP_1D:\n      case LAYOUT.CENTER_2D: {\n        return get2DXScale({ width, margin, xDomain });\n      }\n      case LAYOUT.LEFT_1D: {\n        return get2DYScale({ height, margin, yDomain });\n      }\n      default:\n        return null;\n    }\n  }, [data1D, height, margin, trackID, width, xDomain, yDomain]);\n\n  const scaleY = useMemo(() => {\n    if (!data1D || data1D.length === 0) {\n      return get2DYScale({ height, margin, yDomain });\n    }\n\n    switch (trackID) {\n      case LAYOUT.CENTER_2D: {\n        return get2DYScale({ height, margin, yDomain });\n      }\n      case LAYOUT.TOP_1D: {\n        return data1D[0]\n          ? get1DYScale(yDomains[data1D[0].id], margin.top)\n          : null;\n      }\n      case LAYOUT.LEFT_1D: {\n        return data1D[1]\n          ? get1DYScale(yDomains[data1D[1].id], margin.left)\n          : null;\n      }\n      default:\n        return null;\n    }\n  }, [data1D, height, margin, trackID, yDomain, yDomains]);\n\n  if (\n    !activeSpectrum ||\n    step === 'brushing' ||\n    !position ||\n    position.y < margin.top ||\n    position.x < margin.left ||\n    position.x > width - margin.right ||\n    position.y > height - margin.bottom\n  ) {\n    return null;\n  }\n\n  const getXValue = (x = null) => {\n    switch (trackID) {\n      case LAYOUT.CENTER_2D:\n      case LAYOUT.TOP_1D: {\n        return scaleX.invert(x ? x : position.x);\n      }\n      case LAYOUT.LEFT_1D: {\n        return scaleX.invert(x ? x : position.y);\n      }\n      default:\n        return 0;\n    }\n  };\n\n  const getYValue = () => {\n    switch (trackID) {\n      case LAYOUT.CENTER_2D:\n      case LAYOUT.TOP_1D: {\n        return scaleY.invert(position.y);\n      }\n      case LAYOUT.LEFT_1D: {\n        return scaleY.invert(position.x);\n      }\n      default:\n        return 0;\n    }\n  };\n\n  return (\n    <div\n      key=\"xLabelPointer\"\n      style={{\n        ...style,\n        transform: `translate(${position.x}px, ${position.y}px)`,\n      }}\n    >\n      <span>{formatY(getYValue())}</span>\n      <span style={{ color: 'gray' }}>{','}</span>\n      <span style={{ color: 'red' }}>{formatX(getXValue())}</span>\n    </div>\n  );\n}\n\nexport default XYLabelPointer;\n","const BASE62 = '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ';\n\nconst LENGTH = 8;\n\nexport default function generateID() {\n  let id = '';\n  for (let i = 0; i < LENGTH; i++) {\n    id += BASE62.charAt(Math.floor(Math.random() * 62));\n  }\n  return id;\n}\n","import { Filters } from './Filters';\nimport generateID from './utilities/generateID';\n\nexport interface Filter {\n  id: string;\n  name: string;\n  label: string;\n  isDeleteAllow: boolean;\n  flag: boolean;\n  value: any;\n}\n\n/***\n * @param {object} Filters [{name:'',options:{}},{...}]\n */\nfunction applyFilter(datum, filters: any[] = []) {\n  let isReduced = false;\n  for (let filter of filters) {\n    const filterOption = {\n      name: filter.name,\n      label: Filters[filter.name].name,\n      value: filter.options,\n    };\n    const previousFilter = lookupForFilter(datum, filter.name);\n    if (previousFilter) {\n      const reduceResult = Filters[filter.name].reduce(\n        previousFilter.value,\n        filterOption.value,\n      );\n      if (reduceResult.once) {\n        if (!isReduced) {\n          isReduced = true;\n        }\n        if (reduceResult.reduce != null && reduceResult.reduce !== undefined) {\n          replaceFilter(datum, previousFilter.id, reduceResult.reduce);\n        }\n      } else {\n        addFilter(\n          datum,\n          filterOption,\n          Object.prototype.hasOwnProperty.call(filter, 'isDeleteAllow')\n            ? filter.isDeleteAllow\n            : true,\n        );\n      }\n    } else {\n      addFilter(\n        datum,\n        filterOption,\n        Object.prototype.hasOwnProperty.call(filter, 'isDeleteAllow')\n          ? filter.isDeleteAllow\n          : true,\n      );\n    }\n  }\n  if (isReduced) {\n    if (filters.length === 1 && isLastFilter(datum, filters[0].name)) {\n      Filters[filters[0].name].apply(datum, filters[0].options);\n    } else {\n      reapplyFilters(datum);\n    }\n  } else {\n    for (let filter of filters) {\n      Filters[filter.name].apply(datum, filter.options);\n    }\n  }\n}\n\nfunction isLastFilter(datum, id) {\n  const index = datum.filters.findIndex((f) => f.name === id);\n  if (datum.filters.length === index + 1) {\n    return true;\n  }\n  return false;\n}\n\nfunction lookupForFilter(datum, filterName) {\n  return datum.filters.find((f) => f.name === filterName);\n}\n\nfunction reapplyFilters(datum, filters: any = null) {\n  const _filters = filters ? filters : datum.filters;\n  enableFilter(datum, null, null, _filters);\n}\n\n// id filter id\nfunction enableFilter(datum, id, checked, filters = null) {\n  datum.filters = datum.filters.slice(0);\n  if (id) {\n    datum.filters = datum.filters.map((filter) => {\n      return { ...filter, flag: filter.id === id ? checked : filter.flag };\n    }, []);\n  }\n  datum.data = { ...datum.data, ...datum.originalData };\n  datum.info = { ...datum.info, ...datum.originalInfo };\n  const _filters = filters ? filters : datum.filters;\n  for (let filterIndex in _filters) {\n    const filter = datum.filters[filterIndex];\n    datum.filters[filterIndex] = {\n      ...datum.filters[filterIndex],\n      error: null,\n    };\n\n    if (filter.flag) {\n      try {\n        Filters[filter.name].apply(datum, filter.value);\n      } catch (error) {\n        datum.filters[filterIndex] = {\n          ...datum.filters[filterIndex],\n          error: error.message,\n        };\n      }\n    }\n  }\n}\nfunction deleteFilter(datum, id) {\n  datum.filters = datum.filters.slice(0);\n  datum.filters = datum.filters.filter((filter) => filter.id !== id);\n  datum.data = { ...datum.data, ...datum.originalData };\n  datum.info = { ...datum.info, ...datum.originalInfo };\n\n  for (let filterIndex in datum.filters) {\n    const filter = datum.filters[filterIndex];\n    datum.filters[filterIndex] = {\n      ...datum.filters[filterIndex],\n      error: null,\n    };\n\n    if (filter.flag) {\n      try {\n        Filters[filter.name].apply(datum, filter.value);\n      } catch (error) {\n        datum.filters[filterIndex] = {\n          ...datum.filters[filterIndex],\n          error: error.message,\n        };\n      }\n    }\n  }\n}\n\nfunction addFilter(datum, filter, isDeleteAllow = true) {\n  const id = generateID();\n  datum.filters = datum.filters.slice(0);\n  delete filter.isSnapshot;\n  datum.filters.push({\n    ...filter,\n    id: id,\n    flag: true,\n    isDeleteAllow,\n  });\n}\n\nfunction replaceFilter(datum, filterID, value) {\n  datum.filters = datum.filters.slice(0);\n  const index = datum.filters.findIndex((f) => f.id === filterID);\n  delete datum.filters[index].isSnapshot;\n  datum.filters[index] = {\n    ...datum.filters[index],\n    value,\n  };\n}\n\nexport { applyFilter, reapplyFilters, enableFilter, addFilter, deleteFilter };\n","export const COLORS = [\n  '#C10020',\n  '#007D34',\n  '#803E75',\n  '#FF6800',\n  '#B32851',\n  '#7F180D',\n  '#232C16',\n  '#A6BDD7',\n  '#CEA262',\n  '#817066',\n  '#FF8E00',\n  '#F6768E',\n  '#00538A',\n  '#FF7A5C',\n  '#53377A',\n  '#FFB300',\n  '#F4C800',\n  '#93AA00',\n  '#593315',\n  '#F13A13',\n];\n\nconst color2D = {\n  cosy: { positiveColor: 'darkblue', negativeColor: 'blue' },\n  roesy: { positiveColor: '#e75480', negativeColor: 'yellow' },\n  noesy: { positiveColor: '#e75480', negativeColor: 'yellow' },\n  tocsy: { positiveColor: 'green', negativeColor: 'yellow' },\n  hsqc: { positiveColor: 'black', negativeColor: 'yellow' },\n  hmbc: { positiveColor: 'darkviolet', negativeColor: 'yellow' },\n};\n\nconst hasPredefine2DColor = (experiment) => {\n  return color2D[experiment] ? true : false;\n};\n\nconst get2DColor = (experiment, colors = []) => {\n  if (!color2D[experiment]) {\n    const positiveColor = getColor(false, colors);\n    const negativeColor = adjustAlpha(positiveColor, 50);\n    return { positiveColor, negativeColor };\n  }\n  return color2D[experiment];\n};\n\nconst percentToHex = (p) => {\n  const percent = Math.max(0, Math.min(100, p));\n  const intValue = Math.round((percent / 100) * 255);\n  const hexValue = intValue.toString(16);\n  return percent === 100 ? '' : hexValue.padStart(2, '0');\n};\n\nconst adjustAlpha = (color, factor) => {\n  return color + percentToHex(factor);\n};\n\nconst getColor = (isRandom = false, usedColors = [], opacity = 100) => {\n  const resetColors = COLORS.filter((c) => !usedColors.includes(c));\n  if (resetColors.length > 0 && !isRandom) {\n    return resetColors[0] + percentToHex(opacity);\n  } else {\n    const lum = -0.25;\n    let hex = String(\n      `#${Math.random().toString(16).slice(2, 8).toUpperCase()}`,\n    ).replace(/[^0-9a-f]/gi, '');\n    if (hex.length < 6) {\n      hex = hex[0] + hex[0] + hex[1] + hex[1] + hex[2] + hex[2];\n    }\n    let rgb = '#';\n    let c;\n    let i;\n    for (i = 0; i < 3; i++) {\n      c = parseInt(hex.substr(i * 2, 2), 16);\n      c = Math.round(Math.min(Math.max(0, c + c * lum), 255)).toString(16);\n      rgb += `00${c}`.substr(c.length);\n    }\n\n    return rgb + percentToHex(opacity);\n  }\n};\nexport { percentToHex, adjustAlpha, hasPredefine2DColor, get2DColor };\nexport default getColor;\n","import { xAbsoluteMedian } from 'ml-spectra-processing';\nimport { xyAutoRangesPicking } from 'nmr-processing';\n\nlet defaultPeakPickingOptions = {\n  minMaxRatio: 0.05,\n  realTopDetection: true,\n  maxCriteria: true,\n  smoothY: false,\n  nH: 100,\n  compile: true,\n  frequencyCluster: 16,\n  clean: true,\n  keepPeaks: true,\n  sgOptions: { windowSize: 7, polynomial: 3 },\n};\n\nexport default function autoRangesDetection(datum1D, options = {}) {\n  // we calculate the noise but this could be improved\n  let noiseLevel = xAbsoluteMedian(datum1D.data.re);\n\n  let { re, x } = datum1D.data;\n\n  const { originFrequency, nucleus } = datum1D.info;\n\n  const { windowFromIndex, windowToIndex, peakPicking } = options;\n\n  const peakPickingOptions = {\n    ...defaultPeakPickingOptions,\n    ...peakPicking,\n  };\n\n  const rangesOptions = {\n    frequency: originFrequency,\n    nucleus,\n    noiseLevel: 3 * noiseLevel,\n  };\n\n  if (windowFromIndex !== undefined && windowToIndex !== undefined) {\n    x = x.slice(windowFromIndex, windowToIndex);\n    re = re.slice(windowFromIndex, windowToIndex);\n  }\n\n  const ranges = xyAutoRangesPicking(\n    { x, y: re },\n    {\n      peakPicking: peakPickingOptions,\n      ranges: rangesOptions,\n    },\n  );\n  return ranges;\n}\n","import { xGetFromToIndex } from 'ml-spectra-processing';\nimport { analyseMultiplet } from 'multiplet-analysis';\n\nconst detectSignal = (x, re, from, to, frequency) => {\n  const { fromIndex, toIndex } = xGetFromToIndex(x, {\n    from: from,\n    to: to,\n  });\n  const data = {\n    x: x.slice(fromIndex, toIndex),\n    y: re.slice(fromIndex, toIndex),\n  };\n\n  const result = analyseMultiplet(data, {\n    frequency: frequency,\n    takeBestPartMultiplet: true,\n    symmetrizeEachStep: true,\n  });\n\n  return {\n    multiplicity: result.j.map((j) => j.multiplicity).join(''),\n    kind: 'signal',\n    delta: result.chemShift,\n    j: result.j,\n  };\n};\n\nexport default detectSignal;\n","import max from 'ml-array-max';\nimport { xyIntegration, xyMinYPoint, xyMaxYPoint } from 'ml-spectra-processing';\n\nimport { Filters as FiltersTypes } from '../Filters';\nimport * as FiltersManager from '../FiltersManager';\nimport { DatumKind, SignalKindsToInclude } from '../constants/SignalsKinds';\nimport { checkSignalKinds } from '../utilities/RangeUtilities';\nimport generateID from '../utilities/generateID';\nimport get1dColor from '../utilities/getColor';\n\nimport autoRangesDetection from './autoRangesDetection';\nimport detectSignal from './detectSignal';\n\nexport const usedColors1D: Array<string> = [];\n\nexport interface File {\n  binary: ArrayBuffer;\n  name: string;\n  extension?: string;\n}\n\nexport interface Data1D {\n  y: Array<number>;\n  x: Array<number>;\n  re: Array<number>;\n  im: Array<number>;\n}\n\nexport interface Display {\n  name: string;\n  color: string;\n  isVisible: boolean;\n  isPeaksMarkersVisible: boolean;\n  isRealSpectrumVisible: boolean;\n  isVisibleInDomain: boolean;\n}\n\nexport interface Info {\n  nucleus: Array<string>;\n  isFid: boolean;\n  isComplex: boolean;\n  dimension: number;\n  isFt: boolean;\n}\nexport interface Peak {\n  id: string;\n  delta: number;\n  originDelta: number;\n  width: number;\n}\nexport interface Peaks {\n  values: Array<Partial<Peak>>;\n  options: any;\n}\nexport interface Integral {\n  id: string;\n  originFrom: number;\n  originTo: number;\n  from: number;\n  to: number;\n  absolute: number;\n  integral: number;\n  kind: string;\n}\nexport interface Integrals {\n  values: Array<Partial<Integral>>;\n  options: Partial<{ sum: number }>;\n}\n\nexport interface Signal {\n  id: string;\n  kind: string;\n  originDelta?: number;\n  delta: number;\n  multiplicity: string;\n  peak?: Array<Partial<{ x: number; intensity: number; width: number }>>;\n}\nexport interface Range {\n  id: string;\n  originFrom?: number;\n  originTo?: number;\n  from: number;\n  to: number;\n  absolute: number;\n  integral: number;\n  kind: string;\n  signal?: Array<Partial<Signal>>;\n}\n\nexport interface Ranges {\n  values: Array<Partial<Range>>;\n  options: Partial<{ sum: number }>;\n}\n\nexport interface Source {\n  jcampURL: string;\n  file: File;\n}\n\nexport interface Datum1D {\n  id: string | number;\n  source: Partial<Source>;\n  display: Partial<Display>;\n  info: Partial<Info>;\n  originalInfo?: Partial<Info>;\n  meta: any;\n  data: Data1D;\n  originalData?: Data1D;\n  peaks: Peaks;\n  integrals: Integrals;\n  ranges: Ranges;\n  filters: Array<Partial<FiltersManager.Filter>>;\n}\n\nexport function initiateDatum1D(options: any): Datum1D {\n  const datum: any = {};\n  datum.shiftX = options.shiftX || 0;\n  datum.id = options.id || generateID();\n  datum.source = Object.assign(\n    {\n      jcampURL: null,\n      file: {\n        binary: null,\n        name: '',\n        extension: '',\n      },\n    },\n    options.source,\n  );\n\n  datum.display = Object.assign(\n    {\n      name: options.display?.name ? options.display.name : generateID(),\n      color: 'black',\n      ...getColor(options),\n      isVisible: true,\n      isPeaksMarkersVisible: true,\n      isRealSpectrumVisible: true,\n      isVisibleInDomain: true,\n    },\n    options.display,\n  );\n\n  datum.info = Object.assign(\n    {\n      nucleus: '1H', // 1H, 13C, 19F, ...\n      isFid: false,\n      isComplex: false, // if isComplex is true that mean it contains real/ imaginary  x set, if not hid re/im button .\n      dimension: 1,\n    },\n    options.info,\n  );\n\n  datum.originalInfo = datum.info;\n\n  datum.meta = Object.assign({}, options.meta);\n  datum.data = Object.assign(\n    {\n      x: [],\n      re: [],\n      im: [],\n      y: [],\n    },\n    options.data,\n  );\n  datum.originalData = datum.data;\n\n  datum.peaks = Object.assign({ values: [], options: {} }, options.peaks);\n  // array of object {index: xIndex, xShift}\n  // in case the peak does not exactly correspond to the point value\n  // we can think about a second attributed `xShift`\n  datum.integrals = Object.assign(\n    { values: [], options: { sum: 100 } },\n    options.integrals,\n  ); // array of object (from: xIndex, to: xIndex)\n  datum.filters = Object.assign([], options.filters); //array of object {name: \"FilterName\", options: FilterOptions = {value | object} }\n  datum.ranges = Object.assign(\n    { values: [], options: { sum: 100 } },\n    options.ranges,\n  );\n\n  //reapply filters after load the original data\n  FiltersManager.reapplyFilters(datum);\n\n  preprocessing(datum);\n  (datum.data as Data1D).y = datum.data.re;\n  return datum;\n}\n\nfunction preprocessing(datum) {\n  if (\n    datum.info.isFid &&\n    datum.filters.findIndex((f) => f.name === FiltersTypes.digitalFilter.id) ===\n      -1\n  ) {\n    FiltersManager.applyFilter(datum, [\n      {\n        name: FiltersTypes.digitalFilter.id,\n        options: {\n          digitalFilterValue: datum.info.digitalFilter,\n        },\n        isDeleteAllow: false,\n      },\n    ]);\n  }\n}\n\nexport function toJSON(datum1D: Datum1D, forceIncludeData = false) {\n  return {\n    id: datum1D.id,\n    source: {\n      jcampURL: datum1D.source.jcampURL,\n    },\n    display: datum1D.display,\n    ...(!datum1D.source.jcampURL || forceIncludeData\n      ? {\n          data: datum1D.originalData,\n          info: datum1D.originalInfo,\n          meta: datum1D.meta,\n        }\n      : {}),\n    peaks: datum1D.peaks,\n    integrals: datum1D.integrals,\n    ranges: datum1D.ranges,\n    filters: datum1D.filters,\n  };\n}\n\nfunction getColor(options) {\n  if (options.display === undefined || options.display.color === undefined) {\n    const color = get1dColor(false, usedColors1D);\n    usedColors1D.push(color);\n    return { color };\n  }\n  return {};\n}\n\n// with mouse move\n/**\n *\n * @param {object<{x:Array<number>,re:Array<number>}>} data\n * @param  {object<{from:number,to:number}>} options\n */\nexport function lookupPeak(data, options) {\n  const { from, to } = options;\n  let minIndex = data.x.findIndex((number) => number >= from);\n  let maxIndex = data.x.findIndex((number) => number >= to) - 1;\n\n  if (minIndex > maxIndex) {\n    minIndex = maxIndex;\n    maxIndex = minIndex;\n  }\n  const dataRange = data.re.slice(minIndex, maxIndex);\n  if (dataRange && dataRange.length > 0) {\n    const yValue = max(dataRange);\n    const xIndex = dataRange.findIndex((value) => value === yValue);\n    const xValue = data.x[minIndex + xIndex];\n\n    return { x: xValue, y: yValue, xIndex: minIndex + xIndex };\n  }\n  return null;\n}\n\nexport function updateIntegralIntegrals(integrals) {\n  if (integrals.options.sum === undefined) {\n    integrals.options = { ...integrals.options, sum: 100 };\n  }\n  const countingCondition = (integral) => {\n    return integral.kind && SignalKindsToInclude.includes(integral.kind);\n  };\n  integrals.values = updateRelatives(\n    integrals.values,\n    integrals.options.sum,\n    'integral',\n    countingCondition,\n  );\n}\n\nexport function changeIntegralsRealtive(integrals, id, newIntegralValue) {\n  const integral = integrals.values.find((integral) => integral.id === id);\n  if (integral) {\n    const ratio = integral.absolute / newIntegralValue;\n    const { values, sum } = integrals.values.reduce(\n      (acc, integral, index) => {\n        const newIntegralValue = integral.absolute / ratio;\n        acc.sum += newIntegralValue;\n        acc.values[index] = {\n          ...integral,\n          integral: newIntegralValue,\n        };\n\n        return acc;\n      },\n      { values: [], sum: 0 },\n    );\n\n    integrals.values = values;\n    integrals.options.sum = sum;\n  }\n}\n\nfunction updateRelatives(values, sum, storageKey, countingCondition) {\n  const currentSum = values.reduce((previous, current) => {\n    return countingCondition && countingCondition(current) === true\n      ? (previous += Math.abs(current.absolute))\n      : previous;\n  }, 0);\n  const factor = currentSum > 0 ? sum / currentSum : 0.0;\n  return values.map((value) => {\n    return { ...value, [storageKey]: value.absolute * factor };\n  });\n}\n\nexport function updateIntegralRanges(datum) {\n  if (datum.ranges.options.sum === undefined) {\n    datum.ranges.options.sum = 100;\n  }\n  const countingCondition = (range) => {\n    return range.signal && checkSignalKinds(range, SignalKindsToInclude);\n  };\n  datum.ranges.values = updateRelatives(\n    datum.ranges.values,\n    datum.ranges.options.sum,\n    'integral',\n    countingCondition,\n  );\n}\n\nexport function detectRange(datum, options) {\n  const { from, to } = options;\n  const { x, re: y } = datum.data;\n\n  const absolute = xyIntegration({ x, y }, { from, to, reverse: true });\n  const min = xyMinYPoint({ x, y }, { from, to }).y;\n  const max = xyMaxYPoint({ x, y }, { from, to }).y;\n\n  const shiftX = getShiftX(datum);\n\n  return {\n    id: generateID(),\n    originFrom: from - shiftX,\n    originTo: to - shiftX,\n    from,\n    to,\n    absolute, // the real value,\n    min,\n    max,\n  };\n}\n\nexport function mapRanges(ranges, datum) {\n  const { x, re } = datum.data;\n  const shiftX = getShiftX(datum);\n\n  const error = (x[x.length - 1] - x[0]) / 10000;\n\n  return ranges.reduce((acc, newRange) => {\n    // check if the range is already exists\n    for (const { from, to } of datum.ranges.values) {\n      if (\n        Math.abs(newRange.from - from) < error &&\n        Math.abs(newRange.to - to) < error\n      ) {\n        return acc;\n      }\n    }\n\n    const absolute = xyIntegration(\n      { x, y: re },\n      { from: newRange.from, to: newRange.to, reverse: true },\n    );\n    const signal = newRange.signal.map((_signal) => {\n      return {\n        kind: 'signal',\n        id: generateID(),\n        originDelta: _signal.delta - shiftX,\n        ..._signal,\n      };\n    });\n    acc.push({\n      kind: newRange.signal[0].kind || DatumKind.signal,\n      originFrom: newRange.from - shiftX,\n      originTo: newRange.to - shiftX,\n      ...newRange,\n      id: generateID(),\n      absolute,\n      signal,\n    });\n\n    return acc;\n  }, []);\n}\n\nexport function detectRanges(datum, options) {\n  options.impurities = { solvent: datum.info.solvent };\n  const ranges = autoRangesDetection(datum, options);\n\n  datum.ranges.values = datum.ranges.values.concat(mapRanges(ranges, datum));\n  updateIntegralRanges(datum);\n}\n\nexport function changeRange(datum, range) {\n  const { from, to } = range;\n  const { x, re } = datum.data;\n\n  const index = datum.ranges.values.findIndex((i) => i.id === range.id);\n  const absolute = xyIntegration({ x, y: re }, { from, to, reverse: true });\n\n  if (index !== -1) {\n    datum.ranges.values[index] = {\n      ...datum.ranges.values[index],\n      originFrom: from,\n      originTo: to,\n      ...range,\n      absolute,\n    };\n    updateIntegralRanges(datum);\n  }\n}\n\nexport function addRange(datum, options) {\n  const { from, to } = options;\n  const { x, re } = datum.data;\n  const absolute = xyIntegration({ x, y: re }, { from, to, reverse: true });\n\n  const signals = detectSignal(x, re, from, to, datum.info.originFrequency);\n\n  try {\n    const range = {\n      id: generateID(),\n      from,\n      to,\n      absolute, // the real value,\n      signal: [{ id: generateID(), ...signals }],\n      kind: DatumKind.signal,\n    };\n    datum.ranges.values = datum.ranges.values.concat(mapRanges([range], datum));\n    updateIntegralRanges(datum);\n  } catch (e) {\n    throw new Error('Could not calculate the multiplicity');\n  }\n}\n\nexport function updateXShift(datum: Datum1D) {\n  const shiftX = getShiftX(datum);\n  updatePeaksXShift(datum, shiftX);\n  updateRangesXShift(datum, shiftX);\n  updateIntegralXShift(datum, shiftX);\n}\n\nexport function getShiftX(datum: Datum1D) {\n  const filter =\n    datum?.filters &&\n    datum?.filters.find((filter) => filter.name === FiltersTypes.shiftX.id);\n\n  return filter?.flag ? filter.value : 0;\n}\n\nexport function updatePeaksXShift(datum: Datum1D, shiftValue) {\n  datum.peaks.values = datum.peaks.values.map((peak) => ({\n    ...peak,\n    delta: peak.originDelta + shiftValue,\n  }));\n}\nexport function updateRangesXShift(datum: Datum1D, shiftValue) {\n  datum.ranges.values = datum.ranges.values.map((range) => ({\n    ...range,\n    from: range.originFrom + shiftValue,\n    to: range.originTo + shiftValue,\n    signal:\n      range?.signal &&\n      range.signal.map((s) => ({ ...s, delta: s.originDelta + shiftValue })),\n  }));\n}\nexport function updateIntegralXShift(datum: Datum1D, shiftValue) {\n  datum.integrals.values = datum.integrals.values.map((integral) => ({\n    ...integral,\n    from: integral.originFrom + shiftValue,\n    to: integral.originTo + shiftValue,\n  }));\n}\n\nexport function changeRangesRealtive(datum, rangeID, newRealtiveValue) {\n  const range = datum.ranges.values.find((range) => range.id === rangeID);\n  if (range) {\n    const ratio = range.absolute / newRealtiveValue;\n    datum.ranges.options.sum =\n      (newRealtiveValue / range.integral) * datum.ranges.options.sum;\n    datum.ranges.values = datum.ranges.values.map((range) => {\n      return {\n        ...range,\n        integral: range.absolute / ratio,\n      };\n    });\n  }\n}\n\nexport function changeRangeSignal(datum, rangeID, signalID, newSignalValue) {\n  let shiftValue = 0;\n  const rangeIndex = datum.ranges.values.findIndex(\n    (range) => range.id === rangeID,\n  );\n  if (rangeIndex !== -1) {\n    const signalIndex = datum.ranges.values[rangeIndex].signal.findIndex(\n      (signal) => signal.id === signalID,\n    );\n    shiftValue =\n      newSignalValue -\n      datum.ranges.values[rangeIndex].signal[signalIndex].delta;\n    datum.ranges.values[rangeIndex].signal[signalIndex].delta = newSignalValue;\n  }\n  return shiftValue;\n}\n","import { Conrec } from 'ml-conrec';\n\nexport const defaultContourOptions = {\n  positive: {\n    contourLevels: [0, 21],\n    numberOfLayers: 10,\n  },\n  negative: {\n    contourLevels: [0, 21],\n    numberOfLayers: 10,\n  },\n};\n\nexport default class Processing2D {\n  constructor(\n    minMax,\n    options = defaultContourOptions,\n    defaultLevel = {\n      positive: 10,\n      negative: 10,\n    },\n  ) {\n    this.options = options;\n    const { positive, negative } = defaultLevel;\n\n    this.currentLevelPositive = positive;\n    this.currentLevelNegative = negative;\n\n    const xs = getRange(minMax.minX, minMax.maxX, minMax.z[0].length);\n\n    const ys = getRange(minMax.minY, minMax.maxY, minMax.z.length);\n\n    this.conrec = new Conrec(minMax.z, { xs, ys, swapAxes: false });\n\n    this.median = minMax.noise;\n\n    this.minMax = minMax;\n  }\n\n  getLevel() {\n    return {\n      levelPositive: this.currentLevelPositive,\n      levelNegative: this.currentLevelNegative,\n    };\n  }\n\n  setLevel(levelPositive, levelNegative) {\n    this.currentLevelPositive = levelPositive;\n    this.currentLevelNegative = levelNegative;\n  }\n\n  setOptions(options) {\n    const positiveBoundary = options.positive.contourLevels;\n    const negativeBoundary = options.negative.contourLevels;\n\n    if (this.currentLevelPositive >= positiveBoundary[1]) {\n      this.currentLevelPositive = positiveBoundary[1];\n    } else if (this.currentLevelPositive <= positiveBoundary[0]) {\n      this.currentLevelPositive = positiveBoundary[0];\n    }\n\n    if (this.currentLevelNegative >= negativeBoundary[1]) {\n      this.currentLevelNegative = negativeBoundary[1];\n    } else if (this.currentLevelNegative <= negativeBoundary[0]) {\n      this.currentLevelNegative = negativeBoundary[0];\n    }\n\n    this.options = options;\n  }\n\n  wheel(value) {\n    const sign = Math.sign(value);\n    const positiveBoundary = this.options.positive.contourLevels;\n    const negativeBoundary = this.options.negative.contourLevels;\n\n    if (\n      (this.currentLevelPositive > positiveBoundary[0] && sign === -1) ||\n      (this.currentLevelPositive < positiveBoundary[1] && sign === 1)\n    ) {\n      this.currentLevelPositive += sign;\n    }\n\n    if (\n      (this.currentLevelNegative > negativeBoundary[0] && sign === -1) ||\n      (this.currentLevelNegative < negativeBoundary[1] && sign === 1)\n    ) {\n      this.currentLevelNegative += sign;\n    }\n  }\n\n  shiftWheel(value) {\n    const sign = Math.sign(value);\n    const [min, max] = this.options.positive.contourLevels;\n    if (\n      (this.currentLevelPositive === min && sign === -1) ||\n      (this.currentLevelPositive >= max && sign === 1)\n    ) {\n      return;\n    }\n\n    this.currentLevelPositive += sign;\n    return [];\n  }\n\n  drawContours() {\n    const zoomPositive = this.currentLevelPositive / 2 + 1;\n    const zoomNegative = this.currentLevelNegative / 2 + 1;\n    const {\n      positive: { numberOfLayers: numberOfPositiveLayer },\n      negative: { numberOfLayers: numberOfNegativeLayer },\n    } = this.options;\n    return {\n      positive: this.getContours(zoomPositive, {\n        nbLevels: numberOfPositiveLayer,\n      }),\n      negative: this.getContours(zoomNegative, {\n        negative: true,\n        nbLevels: numberOfNegativeLayer,\n      }),\n    };\n  }\n\n  getContours(zoomLevel, options = {}) {\n    const { negative = false, timeout = 2000, nbLevels = 10 } = options;\n\n    const max = Math.max(\n      Math.abs(this.minMax.maxZ),\n      Math.abs(this.minMax.minZ),\n    );\n\n    let _range = getRange(\n      this.median * 1 * Math.pow(2, zoomLevel),\n      max,\n      nbLevels,\n      2,\n    );\n\n    if (negative) {\n      _range = _range.map((value) => -value);\n    }\n    let contours = [];\n    try {\n      contours = this.conrec.drawContour({\n        contourDrawer: 'basic', // shape or basic\n        levels: _range,\n        timeout: timeout,\n      });\n    } catch (e) {\n      // eslint-disable-next-line no-console\n      console.log(e);\n      throw e;\n    }\n\n    return contours;\n  }\n}\n\nfunction getRange(min, max, length, exp) {\n  if (exp) {\n    let factors = [];\n\n    factors[0] = 0;\n\n    for (let i = 1; i <= length; i++) {\n      factors[i] = factors[i - 1] + (exp - 1) / Math.pow(exp, i);\n    }\n\n    const lastFactor = factors[length];\n\n    const result = new Array(length);\n\n    for (let i = 0; i < length; i++) {\n      result[i] = (max - min) * (1 - factors[i + 1] / lastFactor) + min;\n    }\n\n    return result;\n  } else {\n    const step = (max - min) / (length - 1);\n\n    return range(min, max + step / 2, step);\n  }\n}\n\nfunction range(from, to, step) {\n  const result = [];\n\n  for (let i = from; i < to; i += step) {\n    result.push(i);\n  }\n\n  return result;\n}\n","import { zoneToX } from 'ml-spectra-processing';\n\nimport { Filters } from '../Filters';\nimport * as FiltersManager from '../FiltersManager';\nimport { DatumKind } from '../constants/SignalsKinds';\nimport { initiateDatum1D } from '../data1d/Datum1D';\nimport generateID from '../utilities/generateID';\nimport { get2DColor } from '../utilities/getColor';\n\nimport Processing2D, { defaultContourOptions } from './Processing2D';\nimport autoZonesDetection from './autoZonesDetection';\n\nexport const usedColors2D: Array<string> = [];\n\nexport interface File {\n  binary: ArrayBuffer;\n  name: string;\n  extension?: string;\n}\n\nexport interface Source {\n  jcampURL: string;\n  file: File;\n}\n\nexport interface Data2D {\n  z: Array<Array<number>>;\n  minX: number;\n  minY: number;\n  maxX: number;\n  maxY: number;\n}\n\nexport interface ContourOptions {\n  positive: {\n    contourLevels: [number, number];\n    numberOfLayers: number;\n  };\n  negative: {\n    contourLevels: [number, number];\n    numberOfLayers: number;\n  };\n}\n\nexport interface Display {\n  name: string;\n  positiveColor: string;\n  negativeColor: string;\n  isVisible: boolean;\n  isPositiveVisible: boolean;\n  isNegativeVisible: boolean;\n  contourOptions: ContourOptions;\n  isVisibleInDomain: boolean;\n}\n\nexport interface Info {\n  nucleus: Array<string>;\n  isFid: boolean;\n  isComplex: boolean;\n  dimension: number;\n  isFt: boolean;\n}\n\nexport interface Signal {\n  id: number;\n  peak: any;\n  x: Partial<{\n    originDelta: number;\n    delta: number;\n    diaID: any;\n  }>;\n  y: Partial<{\n    originDelta: number;\n    delta: number;\n    diaID: any;\n  }>;\n  kind: string;\n}\n\nexport interface Zone {\n  id: number;\n  x: Partial<{ from: number; to: number }>;\n  y: Partial<{ from: number; to: number }>;\n  signal: Array<Signal>;\n  kind: string;\n}\n\nexport interface Zones {\n  values: Array<Partial<Zone>>;\n  options?: Partial<{ sum: number }>;\n}\n\nexport interface Datum2D {\n  id: string;\n  source: Partial<Source>;\n  display: Display;\n  info: Partial<Info>;\n  originalInfo?: Partial<Info>;\n  meta: any;\n  data: Data2D;\n  originalData?: Data2D;\n  zones: Zones;\n  filters: Array<Partial<FiltersManager.Filter>>;\n  processingController: Processing2D;\n}\n\nexport function initiateDatum2D(options: any): Datum2D {\n  const datum: any = {};\n\n  datum.id = options.id || generateID();\n  datum.source = Object.assign(\n    {\n      jcamp: null,\n      jcampURL: null,\n      original: [],\n    },\n    options.source,\n  );\n  datum.display = Object.assign(\n    {\n      name: options.display?.name ? options.display.name : generateID(),\n      positiveColor: 'red',\n      negativeColor: 'blue',\n      ...getColor(options),\n      isPositiveVisible: true,\n      isNegativeVisible: true,\n      isVisible: true,\n      contourOptions: defaultContourOptions,\n      dimension: 2,\n    },\n    options.display,\n  );\n\n  datum.info = Object.assign(\n    {\n      nucleus: ['1H', '1H'],\n      isFid: false,\n      isComplex: false, // if isComplex is true that mean it contains real/ imaginary  x set, if not hid re/im button .\n    },\n    options.info,\n  );\n\n  datum.originalInfo = datum.info;\n  datum.meta = Object.assign({}, options.meta);\n  datum.data = Object.assign(\n    {\n      z: [],\n      minX: 0,\n      minY: 0,\n      maxX: 0,\n      maxY: 0,\n    },\n    options.data,\n  );\n  datum.originalData = datum.data;\n  datum.filters = Object.assign([], options.filters);\n\n  datum.zones = Object.assign({ values: [], options: {} }, options.zones);\n\n  datum.processingController = new Processing2D(\n    datum.data,\n    datum.display.contourOptions,\n  );\n\n  //reapply filters after load the original data\n  FiltersManager.reapplyFilters(datum);\n\n  return datum;\n}\n\nexport function getShift(datum: Datum2D): { xShift: number; yShift: number } {\n  let shift: any = { xShift: 0, yShift: 0 };\n  if (datum?.filters) {\n    shift = datum.filters.reduce(\n      (acc, filter) => {\n        if (filter.name === Filters.shift2DX.id) {\n          acc.xShift = filter?.flag ? filter.value : 0;\n        }\n        if (filter.name === Filters.shift2DY.id) {\n          acc.yShift = filter?.flag ? filter.value : 0;\n        }\n        return acc;\n      },\n      { xShift: 0, yShift: 0 },\n    );\n  }\n\n  return shift;\n}\n\nfunction getColor(options) {\n  if (\n    options.display === undefined ||\n    options.display.negativeColor === undefined ||\n    options.display.positiveColor === undefined\n  ) {\n    const color = get2DColor(options.info.experiment, usedColors2D);\n    usedColors2D.push(color.positiveColor);\n    return color;\n  }\n  return {};\n}\n\nexport function toJSON(datum: Datum2D, forceIncludeData = false) {\n  return {\n    id: datum.id,\n    source: {\n      jcampURL: datum.source.jcampURL,\n    },\n    ...(!datum.source.jcampURL || forceIncludeData\n      ? {\n          data: datum.originalData,\n          info: datum.originalInfo,\n          meta: datum.meta,\n        }\n      : {}),\n    zones: datum.zones,\n    filters: datum.filters,\n    display: datum.display,\n  };\n}\n\n/** get 2d projection\n * @param {number} x in ppm\n * @param {number} y in ppm\n */\nexport function getSlice(spectrum, position) {\n  const data = spectrum.data;\n  const xStep = (data.maxX - data.minX) / (data.z[0].length - 1);\n  const yStep = (data.maxY - data.minY) / (data.z.length - 1);\n  const xIndex = Math.floor((position.x - data.minX) / xStep);\n  const yIndex = Math.floor((position.y - data.minY) / yStep);\n\n  if (xIndex < 0 || xIndex >= data.z[0].length) return;\n  if (yIndex < 0 || yIndex >= data.z.length) return;\n\n  let infoX = {\n    nucleus: spectrum.info.nucleus[0], // 1H, 13C, 19F, ...\n    isFid: false,\n    isComplex: false, // if isComplex is true that mean it contains real/ imaginary  x set, if not hid re/im button .\n    dimension: 1,\n  };\n\n  let dataX = {\n    x: zoneToX(\n      { from: spectrum.data.minX, to: spectrum.data.maxX },\n      spectrum.data.z[0].length,\n    ),\n    re: new Float64Array(spectrum.data.z[0].length),\n  };\n\n  for (let i = 0; i < spectrum.data.z[0].length; i++) {\n    dataX.re[i] += spectrum.data.z[yIndex][i];\n  }\n\n  let infoY = {\n    nucleus: spectrum.info.nucleus[1], // 1H, 13C, 19F, ...\n    isFid: false,\n    isComplex: false, // if isComplex is true that mean it contains real/ imaginary  x set, if not hid re/im button .\n    dimension: 1,\n  };\n\n  let dataY = {\n    x: zoneToX(\n      { from: spectrum.data.minY, to: spectrum.data.maxY },\n      spectrum.data.z.length,\n    ),\n    re: new Float64Array(spectrum.data.z.length),\n  };\n\n  let index = spectrum.data.z.length - 1;\n  for (let i = 0; i < spectrum.data.z.length; i++) {\n    dataY.re[i] += spectrum.data.z[index--][xIndex];\n  }\n\n  const horizontal = initiateDatum1D({ info: infoX, data: dataX });\n  const vertical = initiateDatum1D({ info: infoY, data: dataY });\n  return { horizontal, vertical };\n}\n\nexport function updateShift(datum: Datum2D) {\n  const { xShift, yShift } = getShift(datum);\n  updateZonesShift(datum, {\n    xShift,\n    yShift,\n  });\n}\n\nexport function updateZonesShift(datum: Datum2D, { xShift, yShift }) {\n  datum.zones.values = datum.zones.values.map((zone) => ({\n    ...zone,\n    signal: zone.signal?.map((signal) => ({\n      ...signal,\n      x: { ...signal.x, delta: signal.x.originDelta + xShift },\n      y: { ...signal.y, delta: signal.y.originDelta + yShift },\n    })),\n  }));\n}\n\n/**\n *\n * @param {number} zoneID\n * @param {object} signal\n * @param {number} signal.x\n * @param {number} signal.y\n * @param {string} signal.id\n */\nexport function changeZoneSignal(\n  datum,\n  zoneID,\n  newSignal,\n): { xShift: number; yShift: number } {\n  const zoneIndex = datum.zones.values.findIndex((zone) => zone.id === zoneID);\n  if (zoneIndex !== -1) {\n    const signalIndex = datum.zones.values[zoneIndex].signal.findIndex(\n      (s) => s.id === newSignal.id,\n    );\n    if (signalIndex !== -1) {\n      const originalSignal = datum.zones.values[zoneIndex].signal[signalIndex];\n      const xShift =\n        newSignal?.x || newSignal?.x === 0\n          ? newSignal.x - originalSignal.x.delta\n          : 0;\n      const yShift =\n        newSignal?.y || newSignal?.y === 0\n          ? newSignal.y - originalSignal.y.delta\n          : 0;\n\n      // if (newSignal.x) {\n      //   datum.zones.values[zoneIndex].signal[signalIndex].x.delta = newSignal.x;\n      // }\n      // if (newSignal.y) {\n      //   datum.zones.values[zoneIndex].signal[signalIndex].y.delta = newSignal.y;\n      // }\n      return { xShift, yShift };\n    }\n  }\n  return { xShift: 0, yShift: 0 };\n}\n\n/**\n *\n * @param {object} options\n * @param {object} options.selectedZone\n * @param {number} options.selectedZone.fromX\n * @param {number} options.selectedZone.fromY\n * @param {number} options.selectedZone.toX\n * @param {number} options.selectedZone.toY\n * @param {number} options.thresholdFactor\n * @param {boolean} options.convolutionByFFT\n */\nexport function detectZonesManual(datum, options) {\n  const signals = getDetectionZones(datum, options);\n  const { xShift, yShift } = getShift(datum);\n  for (let signal of signals) {\n    let { fromTo } = signal;\n    datum.zones.values.push({\n      id: generateID(),\n      x: fromTo[0],\n      y: fromTo[1],\n      signal: [\n        {\n          id: generateID(),\n          peak: signal.peaks,\n          x: {\n            originDelta: signal.shiftX - xShift,\n            delta: signal.shiftX,\n            diaID: [],\n          },\n          y: {\n            originDelta: signal.shiftY - yShift,\n            delta: signal.shiftY,\n            diaID: [],\n          },\n          kind: 'signal',\n        },\n      ],\n      kind: DatumKind.signal,\n    });\n  }\n}\n\n/** calculate the missing projection\n * @param {string[]} nucleus\n */\nexport function getMissingProjection(datum, nucleus) {\n  let index = datum.info.nucleus.indexOf(nucleus);\n  // temporary because nuclus was undefined;\n  if (index === -1) index = 0;\n\n  let info = {\n    nucleus: datum.info.nucleus[index], // 1H, 13C, 19F, ...\n    isFid: false,\n    isComplex: false, // if isComplex is true that mean it contains real/ imaginary  x set, if not hid re/im button .\n    dimension: 1,\n  };\n\n  let from = index === 0 ? datum.data.minX : datum.data.minY;\n  let to = index === 0 ? datum.data.maxX : datum.data.maxY;\n  let nbPoints = index === 0 ? datum.data.z.length : datum.data.z[0].length;\n\n  let projection = new Float64Array(nbPoints);\n  if (index === 1) {\n    for (let i = 0; i < datum.data.z.length; i++) {\n      for (let j = 0; j < datum.data.z[0].length; j++) {\n        projection[i] += datum.data.z[i][j];\n      }\n    }\n  } else {\n    for (let i = 0; i < datum.data.z[0].length; i++) {\n      // eslint-disable-next-line @typescript-eslint/prefer-for-of\n      for (let j = 0; j < datum.data.z.length; j++) {\n        projection[i] += datum.data.z[j][i];\n      }\n    }\n  }\n\n  let data = {\n    x: zoneToX({ from, to }, nbPoints),\n    re: projection,\n  };\n  const datum1D = initiateDatum1D({ info, data });\n  return datum1D;\n}\n/**\n *\n * @param {object} options\n * @param {object} options.selectedZone\n * @param {number} options.selectedZone.fromX\n * @param {number} options.selectedZone.fromY\n * @param {number} options.selectedZone.toX\n * @param {number} options.selectedZone.toY\n * @param {number} options.thresholdFactor\n * @param {boolean} options.convolutionByFFT\n */\nexport function getDetectionZones(datum, options) {\n  let dataMatrix = {};\n  if (options.selectedZone) {\n    dataMatrix = getSubMatrix(datum, options.selectedZone);\n  } else {\n    dataMatrix = datum.data;\n  }\n  options.info = datum.info;\n  return autoZonesDetection(dataMatrix, options);\n}\n/**\n *\n * @param {object} options\n * @param {object} options.selectedZone\n * @param {number} options.selectedZone.fromX\n * @param {number} options.selectedZone.fromY\n * @param {number} options.selectedZone.toX\n * @param {number} options.selectedZone.toY\n * @param {number} options.thresholdFactor\n * @param {boolean} options.convolutionByFFT\n */\nexport function detectZones(datum, options) {\n  const zones = getDetectionZones(datum, options);\n  const { xShift, yShift } = getShift(datum);\n\n  const { minX, maxX, minY, maxY } = datum.data;\n  const xError = Math.abs(maxX - minX) / 10000;\n  const yError = Math.abs(maxY - minY) / 10000;\n\n  const formattedZones = zones.reduce((acc, zone) => {\n    const [newXRange, newYRange] = zone.fromTo;\n\n    // check if the zone is already exists\n    for (const { x, y } of datum.zones.values) {\n      if (\n        Math.abs(newXRange.from - x.from) < xError &&\n        Math.abs(newXRange.to - x.to) < xError &&\n        Math.abs(newYRange.from - y.from) < yError &&\n        Math.abs(newYRange.to - y.to) < yError\n      ) {\n        return acc;\n      }\n    }\n\n    acc.push({\n      id: generateID(),\n      x: { from: newXRange.from, to: newXRange.to },\n      y: { from: newYRange.from, to: newYRange.to },\n      signal: [\n        {\n          id: generateID(),\n          peak: zone.peaks,\n          x: {\n            originDelta: zone.shiftX - xShift,\n            delta: zone.shiftX,\n            diaID: [],\n          },\n          y: {\n            originDelta: zone.shiftY - yShift,\n            delta: zone.shiftY,\n            diaID: [],\n          },\n          kind: 'signal',\n        },\n      ],\n      kind: DatumKind.signal,\n    });\n\n    return acc;\n  }, []);\n  datum.zones.values = datum.zones.values.concat(formattedZones);\n}\n\nexport function getSubMatrix(datum, selectedZone) {\n  const { fromX, toX, fromY, toY } = selectedZone;\n  const data = datum.data;\n  const xStep = (data.maxX - data.minX) / (data.z[0].length - 1);\n  const yStep = (data.maxY - data.minY) / (data.z.length - 1);\n  let xIndexFrom = Math.floor((fromX - data.minX) / xStep);\n  let yIndexFrom = Math.floor((fromY - data.minY) / yStep);\n  let xIndexTo = Math.floor((toX - data.minX) / xStep);\n  let yIndexTo = Math.floor((toY - data.minY) / yStep);\n\n  if (xIndexFrom > xIndexTo) [xIndexFrom, xIndexTo] = [xIndexTo, xIndexFrom];\n  if (yIndexFrom > yIndexTo) [yIndexFrom, yIndexTo] = [yIndexTo, yIndexFrom];\n\n  let dataMatrix: any = {\n    z: [],\n    maxX: data.minX + xIndexTo * xStep,\n    minX: data.minX + xIndexFrom * xStep,\n    maxY: data.minY + yIndexTo * yStep,\n    minY: data.minY + yIndexFrom * yStep,\n  };\n  let maxZ = Number.MIN_SAFE_INTEGER;\n  let minZ = Number.MAX_SAFE_INTEGER;\n\n  let nbXPoints = xIndexTo - xIndexFrom + 1;\n  for (let j = yIndexFrom; j < yIndexTo; j++) {\n    let row = new Float32Array(nbXPoints);\n    let xIndex = xIndexFrom;\n    for (let i = 0; i < nbXPoints; i++) {\n      row[i] = data.z[j][xIndex++];\n    }\n    for (let rowValue of row) {\n      if (maxZ < rowValue) maxZ = rowValue;\n      if (minZ > rowValue) minZ = rowValue;\n    }\n    dataMatrix.z.push(Array.from(row));\n  }\n  dataMatrix.minZ = minZ;\n  dataMatrix.maxZ = maxZ;\n  return dataMatrix;\n}\n","import { xyzAutoPeaksPicking } from 'nmr-processing';\n\nexport default function autoZonesDetection(data, options) {\n  const {\n    thresholdFactor,\n    clean,\n    maxPercentCutOff,\n    enhanceSymmetry,\n    convolutionByFFT,\n  } = options;\n\n  const { nucleus, originFrequency } = options.info;\n  const isHomoNuclear = nucleus[0] === nucleus[1];\n\n  let zones = xyzAutoPeaksPicking(data, {\n    isHomoNuclear,\n    nucleus,\n    observeFrequencies: originFrequency,\n    thresholdFactor,\n    clean,\n    maxPercentCutOff,\n    enhanceSymmetry,\n    convolutionByFFT,\n  });\n\n  return zones;\n}\n","import { extent, scaleLinear } from 'd3';\n/***\n * @param {number} width\n * @param {object} margin\n * @param {number} margin.right\n * @param {number} margin.left\n * @param {number[]} x\n * @returns {object={somain.scaleX}}\n\n */\nfunction getTopXScale(width, margin, x) {\n  const xDomain = extent(x);\n  const scaleX = scaleLinear(extent(x), [width - margin.right, margin.left]);\n  return {\n    xDomain,\n    scaleX,\n  };\n}\n/***\n * @param {number} width\n * @param {object} margin\n * @param {number} margin.bottom\n * @param {number} margin.top\n * @param {number[]} x\n * @returns {object={somain.scaleX}}\n */\nfunction getLeftXScale(height, margin, x) {\n  const xDomain = extent(x);\n  const scaleX = scaleLinear(extent(x), [height - margin.bottom, margin.top]);\n\n  return {\n    xDomain,\n    scaleX,\n  };\n}\n\n/***\n * @param {number} height\n * @param {number} margin\n * @param {number[]} y\n */\nfunction getYScale(height, y, margin = 10) {\n  return scaleLinear(extent(y), [height - margin, margin]);\n}\n\nexport { getTopXScale, getLeftXScale, getYScale };\n","import { xyReduce } from 'ml-spectra-processing';\nimport { useMemo, memo } from 'react';\n\nimport { useChartData } from '../../../context/ChartContext';\nimport { get2DXScale } from '../../utilities/scale';\n\nimport { getYScale } from './SliceScale';\n\nfunction HorizontalSliceChart({ margin: marginProps, data }) {\n  const { width, margin: originMargin, xDomain, displayerKey } = useChartData();\n\n  const height = originMargin.top;\n\n  const paths = useMemo(() => {\n    if (data) {\n      const { x, re: y } = data;\n      const scaleX = get2DXScale({ margin: originMargin, width, xDomain });\n\n      const scaleY = getYScale(height, y, marginProps);\n      const pathPoints = xyReduce(\n        { x, y },\n        {\n          from: xDomain[0],\n          to: xDomain[1],\n        },\n      );\n\n      let path = `M ${scaleX(pathPoints.x[0])} ${scaleY(pathPoints.y[0])} `;\n      path += pathPoints.x.slice(1).reduce((accumulator, point, i) => {\n        accumulator += ` L ${scaleX(point)} ${scaleY(pathPoints.y[i + 1])}`;\n        return accumulator;\n      }, '');\n      return path;\n    } else {\n      return null;\n    }\n  }, [data, height, marginProps, originMargin, width, xDomain]);\n\n  if (!width || !height) {\n    return null;\n  }\n\n  return (\n    <svg viewBox={`0 0 ${width} ${height}`} width={width} height={height}>\n      <defs>\n        <clipPath id={`${displayerKey}clip-top`}>\n          <rect\n            width={width - originMargin.left - originMargin.right}\n            height={height}\n            x={originMargin.left}\n            y={`${0}`}\n          />\n        </clipPath>\n      </defs>\n      <g clipPath={`url(#${displayerKey}clip-top)`}>\n        <rect\n          width={width - originMargin.left - originMargin.right}\n          height={height}\n          x={originMargin.left}\n          y={`${0}`}\n          fillOpacity=\"0\"\n        />\n        <path className=\"line\" stroke=\"red\" fill=\"none\" d={paths} />\n      </g>\n    </svg>\n  );\n}\n\nHorizontalSliceChart.defaultProps = {\n  margin: 10,\n};\n\nexport default memo(HorizontalSliceChart);\n","import { xyReduce } from 'ml-spectra-processing';\nimport { useMemo, memo } from 'react';\n\nimport { useChartData } from '../../../context/ChartContext';\nimport { get2DYScale } from '../../utilities/scale';\n\nimport { getYScale } from './SliceScale';\n\nfunction VerticalSliceChart({ margin: marignValue, data }) {\n  const {\n    height: originHeight,\n    margin,\n    yDomain,\n    displayerKey,\n  } = useChartData();\n\n  const height = margin.left;\n\n  const paths = useMemo(() => {\n    if (data) {\n      const { x, re: y } = data;\n      const scaleX = get2DYScale({ height: originHeight, margin, yDomain });\n\n      const scaleY = getYScale(height, y, marignValue);\n\n      const pathPoints = xyReduce(\n        { x, y },\n        {\n          from: yDomain[0],\n          to: yDomain[1],\n        },\n      );\n      const lastXIndex = pathPoints.x.length - 1;\n      const lastYIndex = pathPoints.y.length - 1;\n      let path = `M  ${scaleY(pathPoints.y[lastYIndex])} ${scaleX(\n        lastXIndex,\n      )} `;\n      path += pathPoints.x\n        .slice(0, lastXIndex)\n        .reduceRight((accumulator, point, index) => {\n          accumulator += ` L  ${scaleY(pathPoints.y[index])} ${scaleX(point)}`;\n          return accumulator;\n        }, '');\n      return path;\n    } else {\n      return null;\n    }\n  }, [data, height, margin, marignValue, originHeight, yDomain]);\n\n  const mainHeight = originHeight - margin.bottom - margin.top;\n\n  if (!mainHeight || !height) return null;\n\n  return (\n    <svg\n      viewBox={`0 0 ${height} ${mainHeight + margin.top}`}\n      width={height}\n      height={mainHeight + margin.top}\n    >\n      <defs>\n        <clipPath id={`${displayerKey}clip-left`}>\n          <rect width={height} height={mainHeight} x=\"0\" y={margin.top} />\n        </clipPath>\n      </defs>\n      <g clipPath={`url(#${displayerKey}clip-left)`}>\n        <path className=\"line\" stroke=\"red\" fill=\"none\" d={paths} />\n      </g>\n    </svg>\n  );\n}\n\nVerticalSliceChart.defaultProps = {\n  margin: 10,\n};\n\nexport default memo(VerticalSliceChart);\n","import PropsTypes from 'prop-types';\nimport { useMemo } from 'react';\n\nimport { getSlice } from '../../../../data/data2d/Datum2D';\nimport { useMouseTracker } from '../../../EventsTrackers/MouseTracker';\nimport { useChartData } from '../../../context/ChartContext';\nimport { get2DXScale, get2DYScale } from '../../utilities/scale';\n\nimport HorizontalSliceChart from './HorizontalSliceChart';\nimport VerticalSliceChart from './VerticalSliceChart';\n\nfunction SlicingView() {\n  const {\n    width,\n    height,\n    margin,\n    activeSpectrum,\n    data: spectra,\n    xDomain,\n    yDomain,\n  } = useChartData();\n  const position = useMouseTracker();\n\n  const chart2d = useMemo(() => {\n    if (position && activeSpectrum.id) {\n      const { x, y } = position;\n      const scale2dX = get2DXScale({ margin, width, xDomain });\n      const scale2dY = get2DYScale({ margin, height, yDomain });\n      const data = getSlice(spectra[activeSpectrum.index], {\n        x: scale2dX.invert(x),\n        y: scale2dY.invert(y),\n      });\n      return (\n        <svg\n          viewBox={`0 0 ${width} ${height}`}\n          width={width}\n          height={height}\n          style={{\n            position: 'absolute',\n            backgroundColor: 'rgba(255,255,255,0.8)',\n          }}\n        >\n          {data && data.horizontal && (\n            <HorizontalSliceChart data={data.horizontal.data} />\n          )}\n          {data && data.vertical && (\n            <VerticalSliceChart data={data.vertical.data} />\n          )}\n        </svg>\n      );\n    }\n    return null;\n  }, [\n    position,\n    activeSpectrum.id,\n    activeSpectrum.index,\n    margin,\n    width,\n    xDomain,\n    height,\n    yDomain,\n    spectra,\n  ]);\n\n  if (!position) {\n    return null;\n  }\n\n  return chart2d;\n}\nSlicingView.defaultProps = {\n  onDimensionChange: () => null,\n};\n\nSlicingView.propsTypes = {\n  onDimensionChange: PropsTypes.func.isRequired,\n};\n\nexport default SlicingView;\n","import { useCallback, Fragment, useEffect, useState, useMemo } from 'react';\nimport { useSize, useDebounce } from 'react-use';\n\nimport { BrushTracker } from '../EventsTrackers/BrushTracker';\nimport { MouseTracker } from '../EventsTrackers/MouseTracker';\nimport { useChartData } from '../context/ChartContext';\nimport { useDispatch } from '../context/DispatchContext';\nimport Spinner from '../loader/Spinner';\nimport {\n  BRUSH_END,\n  FULL_ZOOM_OUT,\n  SET_DIMENSIONS,\n  SET_2D_LEVEL,\n  SET_ZOOM_FACTOR,\n  ADD_2D_ZONE,\n} from '../reducer/types/Types';\nimport BrushXY, { BRUSH_TYPE } from '../tool/BrushXY';\nimport CrossLinePointer from '../tool/CrossLinePointer';\nimport { options } from '../toolbar/ToolTypes';\n\nimport Chart2D from './Chart2D';\nimport FooterBanner from './FooterBanner';\nimport XYLabelPointer from './tools/XYLabelPointer';\nimport SlicingView from './tools/slicing/SlicingView';\nimport { get2DDimensionLayout, getLayoutID } from './utilities/DimensionLayout';\n\nfunction Viewer2D({ emptyText = undefined }) {\n  const state = useChartData();\n  const {\n    selectedTool,\n    isLoading,\n    data,\n    margin,\n    tabActiveSpectrum,\n    activeTab,\n  } = state;\n\n  const dispatch = useDispatch();\n\n  const spectrumData = useMemo(() => {\n    const nucleuses = activeTab.split(',');\n    return nucleuses.reduce((acc, n) => {\n      if (tabActiveSpectrum[n] && tabActiveSpectrum[n].id) {\n        const id = tabActiveSpectrum[n].id;\n        const spectrum = data.find(\n          (datum) => datum.id === id && !datum.info.isFid,\n        );\n        if (spectrum) {\n          acc.push(spectrum);\n        }\n      } else {\n        acc.push(null);\n      }\n      return acc;\n    }, []);\n  }, [activeTab, data, tabActiveSpectrum]);\n\n  const DIMENSION = get2DDimensionLayout(state);\n\n  const handelBrushEnd = useCallback(\n    (brushData) => {\n      const trackID = getLayoutID(DIMENSION, brushData);\n      if (trackID) {\n        if (brushData.altKey) {\n          switch (selectedTool) {\n            default:\n              break;\n          }\n        } else if (brushData.shiftKey) {\n          switch (selectedTool) {\n            case options.zone2D.id:\n              dispatch({ type: ADD_2D_ZONE, ...brushData });\n              break;\n            default:\n              break;\n          }\n        } else {\n          switch (selectedTool) {\n            default:\n              if (selectedTool != null) {\n                return dispatch({\n                  type: BRUSH_END,\n                  ...brushData,\n                  trackID: getLayoutID(DIMENSION, brushData),\n                });\n              }\n          }\n        }\n      }\n    },\n    [selectedTool, dispatch, DIMENSION],\n  );\n\n  const handelOnDoubleClick = useCallback(\n    (e) => {\n      const { x: startX, y: startY } = e;\n      const trackID = getLayoutID(DIMENSION, { startX, startY });\n      if (trackID) {\n        dispatch({ type: FULL_ZOOM_OUT, trackID });\n      }\n    },\n    [DIMENSION, dispatch],\n  );\n\n  const handleZoom = (wheelData) => {\n    const { x: startX, y: startY } = wheelData;\n    const trackID = getLayoutID(DIMENSION, { startX, startY });\n\n    if (trackID) {\n      if (trackID === 'CENTER_2D') {\n        dispatch({ type: SET_2D_LEVEL, ...wheelData });\n      } else {\n        dispatch({ type: SET_ZOOM_FACTOR, ...wheelData, trackID });\n      }\n    }\n  };\n\n  const mouseClick = useCallback(\n    (position) => {\n      // eslint-disable-next-line no-unused-vars\n      const { x, y } = position;\n      switch (selectedTool) {\n        default:\n          break;\n      }\n    },\n    [selectedTool],\n  );\n\n  const [sizedNMRChart, { width, height }] = useSize(() => {\n    return (\n      <Fragment>\n        <Spinner isLoading={isLoading} emptyText={emptyText} />\n\n        {data && data.length > 0 && (\n          <BrushTracker\n            onBrush={handelBrushEnd}\n            onDoubleClick={handelOnDoubleClick}\n            onClick={mouseClick}\n            onZoom={handleZoom}\n            style={{\n              width: '100%',\n              height: '100%',\n              margin: 'auto',\n              position: 'relative',\n              overflow: 'hidden',\n            }}\n          >\n            <MouseTracker\n              style={{ width: '100%', height: `100%`, position: 'absolute' }}\n            >\n              {selectedTool && selectedTool === options.slicingTool.id && (\n                <SlicingView />\n              )}\n\n              <CrossLinePointer />\n              {spectrumData && (\n                <XYLabelPointer data1D={spectrumData} layout={DIMENSION} />\n              )}\n\n              <BrushXY\n                brushType={BRUSH_TYPE.XY}\n                dimensionBorder={DIMENSION.CENTER_2D}\n              />\n              <>\n                {spectrumData && spectrumData[0] && (\n                  <BrushXY\n                    brushType={BRUSH_TYPE.X}\n                    dimensionBorder={DIMENSION.TOP_1D}\n                    height={margin.top}\n                  />\n                )}\n                {spectrumData && spectrumData[1] && (\n                  <BrushXY\n                    brushType={BRUSH_TYPE.Y}\n                    dimensionBorder={DIMENSION.LEFT_1D}\n                    width={margin.left}\n                  />\n                )}\n              </>\n              {spectrumData && (\n                <FooterBanner data1D={spectrumData} layout={DIMENSION} />\n              )}\n\n              <Chart2D data={spectrumData} />\n            </MouseTracker>\n          </BrushTracker>\n        )}\n      </Fragment>\n    );\n  }, []);\n\n  const [finalSize, setFinalSize] = useState();\n  useDebounce(() => setFinalSize({ width, height }), 400, [width, height]);\n  useEffect(() => {\n    if (finalSize && isFinite(finalSize.width) && isFinite(finalSize.height)) {\n      dispatch({\n        type: SET_DIMENSIONS,\n        ...finalSize,\n      });\n    }\n  }, [dispatch, finalSize]);\n\n  return sizedNMRChart;\n}\n\nexport default Viewer2D;\n","import { Component, CSSProperties, ErrorInfo } from 'react';\n\nconst styles: Record<string, CSSProperties> = {\n  container: {\n    margin: '25px',\n  },\n  header: {\n    backgroundColor: '#ffffff',\n    padding: '20px',\n    borderRadius: '10px',\n    fontSize: '30px',\n    textAlign: 'center',\n  },\n\n  body: {\n    whiteSpace: 'pre-wrap',\n    backgroundColor: 'white',\n    padding: '20px',\n    borderRadius: '10px',\n    color: 'red',\n  },\n};\n\nexport default class ErrorBoundary extends Component<\n  unknown,\n  { error: Error | null; errorInfo: ErrorInfo | null }\n> {\n  public constructor(props: unknown) {\n    super(props);\n    this.state = { error: null, errorInfo: null };\n  }\n\n  public componentDidCatch(error: Error, errorInfo: ErrorInfo) {\n    // Catch errors in any components below and re-render with error message\n    this.setState({\n      error: error,\n      errorInfo: errorInfo,\n    });\n    // You can also log error messages to an error reporting service here\n  }\n\n  public render() {\n    if (this.state.errorInfo && process.env.NODE_ENV === 'production') {\n      // Error path\n      return (\n        <div style={styles.container}>\n          <p style={styles.header}>Something went wrong.</p>\n          <details style={styles.body}>\n            {this.state.error}\n            <br />\n            {this.state.errorInfo.componentStack}\n          </details>\n        </div>\n      );\n    }\n    // Normally, just render children\n    return this.props.children;\n  }\n}\n","import { createContext, useContext } from 'react';\n\nconst AlertContext = createContext();\n\nexport const AlertProvider = AlertContext.Provider;\n\nexport const useAlert = () => {\n  return useContext(AlertContext);\n};\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\n\nconst styles = css`\n  width: 40px;\n  height: 40px;\n  margin: 0 auto;\n  :after {\n    content: ' ';\n    display: block;\n    width: 30px;\n    height: 30px;\n    margin-top: 10px;\n    border-radius: 50%;\n    border: 4px solid;\n    border-color: #fff transparent #fff transparent;\n    animation: ring-animation 1s linear infinite;\n  }\n  @keyframes ring-animation {\n    0% {\n      transform: rotate(0deg);\n    }\n    100% {\n      transform: rotate(360deg);\n    }\n  }\n`;\n\nconst ProgressIndicator = () => {\n  return <div css={styles} />;\n};\n\nexport default ProgressIndicator;\n","import PropTypes from 'prop-types';\nimport {\n  Fragment,\n  useState,\n  useRef,\n  useEffect,\n  useCallback,\n  useMemo,\n} from 'react';\nimport { createPortal } from 'react-dom';\nimport { FaTimes } from 'react-icons/fa';\nimport { TransitionGroup } from 'react-transition-group';\n\nimport Transition from '../Transition';\nimport Wrapper from '../Wrapper';\nimport { groupBy } from '../helpers';\nimport { positions, transitions, types } from '../options';\n\nimport { AlertProvider } from './Context';\nimport ProgressIndicator from './ProgressIndicator';\n\nfunction Provider({\n  children,\n  wrapperRef,\n  offset,\n  position,\n  timeout,\n  type,\n  transition,\n  ...props\n}) {\n  const root = useRef(null);\n  const alertContext = useRef(null);\n  const timersId = useRef([]);\n  const [alerts, setAlerts] = useState([]);\n\n  useEffect(() => {\n    root.current = document.createElement('div');\n    const ref = root.current;\n    const timersIdRef = timersId.current;\n\n    if (wrapperRef) {\n      wrapperRef.appendChild(ref);\n    }\n    return () => {\n      if (ref) {\n        if (wrapperRef) {\n          timersIdRef.forEach(clearTimeout);\n\n          wrapperRef.removeChild(ref);\n        }\n      }\n    };\n  }, [wrapperRef]);\n\n  const remove = useCallback((alert) => {\n    setAlerts((currentAlerts) => {\n      const lengthBeforeRemove = currentAlerts.length;\n      const filteredAlerts = currentAlerts.filter((a) => a.id !== alert.id);\n\n      if (lengthBeforeRemove > filteredAlerts.length && alert.options.onClose) {\n        alert.options.onClose();\n      }\n\n      return filteredAlerts;\n    });\n  }, []);\n\n  const removeAll = useCallback(() => {\n    alertContext.current.alerts.forEach(remove);\n  }, [remove]);\n\n  const show = useCallback(\n    (message = '', options = {}) => {\n      const id = Math.random().toString(36).substr(2, 9);\n\n      const alertOptions = {\n        position: options.position || position,\n        timeout,\n        type,\n        backgroundColor: 'black',\n        color: 'white',\n        ...options,\n      };\n\n      const alert = {\n        id,\n        message,\n        options: alertOptions,\n      };\n\n      alert.close = () => remove(alert);\n\n      if (alert.options.timeout) {\n        const timerId = setTimeout(() => {\n          remove(alert);\n\n          timersId.current.splice(timersId.current.indexOf(timerId), 1);\n        }, alert.options.timeout);\n\n        timersId.current.push(timerId);\n      }\n\n      setAlerts((state) => state.concat(alert));\n      if (alert.options.onOpen) alert.options.onOpen();\n\n      return alert;\n    },\n    [position, remove, timeout, type],\n  );\n\n  const success = useCallback(\n    (message = '', options = {}) => {\n      options.type = types.SUCCESS;\n      options = { backgroundColor: '#28ba62', color: 'white', ...options };\n\n      return show(message, options);\n    },\n    [show],\n  );\n\n  const error = useCallback(\n    (message = '', options = {}) => {\n      options.type = types.ERROR;\n      options = { backgroundColor: '#cf3c4f', color: 'white', ...options };\n      return show(message, options);\n    },\n    [show],\n  );\n\n  const info = useCallback(\n    (message = '', options = {}) => {\n      options.type = types.INFO;\n      options.color = '#28ba62';\n      return show(message, options);\n    },\n    [show],\n  );\n\n  const showLoading = useCallback(\n    (message = 'Process in progress', options = {}) => {\n      options.type = types.PROGRESS_INDICATOR;\n      options.timeout = 0;\n      options.backgroundColor = '#232323';\n\n      return new Promise((resolve) => {\n        const alert = show(message, options);\n        setTimeout(() => {\n          resolve(() => remove(alert));\n        }, 500);\n      });\n    },\n    [remove, show],\n  );\n\n  const closeHandler = useCallback(\n    (alert) => {\n      remove(alert);\n    },\n    [remove],\n  );\n\n  const alertsByPosition = groupBy(alerts, (alert) => alert.options.position);\n\n  const parentStyle = useMemo(() => {\n    return wrapperRef\n      ? wrapperRef.getBoundingClientRect()\n      : {\n          top: 0,\n          left: 0,\n          width: window.innerWidth,\n          height: window.innerHeight,\n        };\n  }, [wrapperRef]);\n\n  return (\n    <AlertProvider\n      value={{\n        alerts,\n        show,\n        remove,\n        removeAll,\n        success,\n        error,\n        info,\n        showLoading,\n      }}\n    >\n      {children}\n      {root.current &&\n        createPortal(\n          <Fragment>\n            {Object.keys(positions).map((key) => {\n              const position = positions[key];\n\n              return (\n                <TransitionGroup\n                  appear\n                  key={position}\n                  options={{ position, zIndex: 999999 }}\n                  component={Wrapper}\n                  containerStyle={parentStyle}\n                  {...props}\n                >\n                  {alertsByPosition[position]\n                    ? alertsByPosition[position].map((alert) => (\n                        <Transition type={transition} key={alert.id}>\n                          <div\n                            style={{\n                              margin: offset,\n                              padding: '25px',\n                              borderRadius: '10px',\n                              pointerEvents: 'all',\n                              backgroundColor: alert.options.backgroundColor,\n                              color: alert.options.color,\n                              minHeight: '60px',\n                              position: 'relative',\n                            }}\n                            key={alert.id}\n                          >\n                            <button\n                              style={{\n                                position: 'absolute',\n                                right: '5px',\n                                top: '5px',\n                                border: 'none',\n                                backgroundColor: 'transparent',\n                                color: 'white',\n                              }}\n                              type=\"button\"\n                              onClick={() => closeHandler(alert)}\n                            >\n                              <FaTimes />\n                            </button>\n\n                            <span>{alert.message}</span>\n                            {alert.options.type ===\n                              types.PROGRESS_INDICATOR && <ProgressIndicator />}\n                          </div>\n                        </Transition>\n                      ))\n                    : null}\n                </TransitionGroup>\n              );\n            })}\n          </Fragment>,\n          root.current,\n        )}\n    </AlertProvider>\n  );\n}\n\nProvider.propTypes = {\n  offset: PropTypes.string,\n  position: PropTypes.oneOf(\n    Object.keys(positions).map((position) => positions[position]),\n  ),\n  timeout: PropTypes.number,\n  type: PropTypes.oneOf(Object.keys(types).map((type) => types[type])),\n  transition: PropTypes.oneOf(\n    Object.keys(transitions).map((transition) => transitions[transition]),\n  ),\n  containerStyle: PropTypes.object,\n  wrapperRef: PropTypes.object,\n  context: PropTypes.shape({\n    Provider: PropTypes.object,\n    Consumer: PropTypes.object,\n  }),\n};\n\nProvider.defaultProps = {\n  offset: '5px',\n  position: positions.BOTTOM_CENTER,\n  transition: transitions.FADE,\n  wrapperRef: null,\n  timeout: 3000,\n};\n\nexport default Provider;\n","import { initiateDatum1D } from './Datum1D';\n\nexport function fromBruker(result, options = {}) {\n  const { dependentVariables, info, meta, source } = result;\n  let data = getData(dependentVariables[0].components);\n  if (data.im) info.isComplex = true;\n\n  if (Array.isArray(info.nucleus)) info.nucleus = info.nucleus[0];\n\n  const datum1D = initiateDatum1D({\n    ...options,\n    source,\n    info,\n    meta,\n    data,\n  });\n\n  return datum1D;\n}\n\nexport function fromCSD(result, options = {}) {\n  let dimension = result.dimensions[0];\n  let dependentVariables = result.dependentVariables;\n\n  let quantityName = dimension.quantityName;\n  let n = dimension.count;\n  let incr = dimension.increment.magnitude;\n  let origin = dimension.originOffset.magnitude;\n  let offset = dimension.coordinatesOffset.magnitude;\n\n  let buffer = dependentVariables[0].components[0];\n  let re = [];\n  let im = [];\n  for (let i = buffer.length - 1; i > 0; i -= 2) {\n    re.push(buffer[i - 1]);\n    im.push(buffer[i]);\n  }\n\n  let data = {};\n  let i, x0;\n  switch (quantityName) {\n    case 'frequency':\n      x0 = 0 + (offset / origin) * 1000000;\n      i = (incr / origin) * 1000000;\n      data.re = re;\n      data.im = im;\n      break;\n    case 'time':\n      x0 = origin;\n      i = incr;\n      data.re = re.reverse();\n      data.im = im.reverse().map((z) => -z);\n      break;\n    default:\n      break;\n  }\n\n  let scale = [];\n  for (let x = 0; x < n; x++) {\n    scale.push(x0 + x * i);\n  }\n\n  data.x = scale;\n\n  const datum1D = initiateDatum1D({\n    ...options,\n    data,\n  });\n  return datum1D;\n}\n\nexport function fromParsedJcamp(parsedJcamp, options = {}) {\n  const { dependentVariables, info, meta } = parsedJcamp;\n  let data = getData(dependentVariables[0].components);\n  if (Array.isArray(info.nucleus)) info.nucleus = info.nucleus[0];\n\n  const datum1D = initiateDatum1D({\n    ...options,\n    info,\n    meta,\n    data,\n  });\n\n  return datum1D;\n}\n\nfunction getData(spectra) {\n  let x =\n    spectra[0] && spectra[0].data && spectra[0].data.x ? spectra[0].data.x : [];\n  let re =\n    spectra[0] && spectra[0].data && spectra[0].data.y ? spectra[0].data.y : [];\n  let im =\n    spectra[1] && spectra[1].data && spectra[1].data.y\n      ? spectra[1].data.y\n      : null;\n\n  if (x[0] > x[1]) {\n    x.reverse();\n    re.reverse();\n    if (im) im.reverse();\n  }\n  return { x, re, im };\n}\n","import { initiateDatum2D } from './Datum2D';\n\nexport function fromParsedJcamp(parsedJcamp, options = {}) {\n  const { dependentVariables, info, meta } = parsedJcamp;\n  let data = dependentVariables[0].components;\n  const ob = initiateDatum2D({\n    ...options,\n    info,\n    meta,\n    data,\n  });\n  return ob;\n}\n\nexport function fromBruker(result, options = {}) {\n  const { dependentVariables, meta, source } = result;\n  let data = dependentVariables[0].components;\n  const datum2D = initiateDatum2D({\n    ...options,\n    source,\n    meta,\n    data,\n  });\n\n  return datum2D;\n}\n\n// eslint-disable-next-line no-unused-vars\nexport function fromCSD(result, options = {}) {\n  const datum2D = initiateDatum2D({});\n  return datum2D;\n}\n","import { MF } from 'mf-parser';\nimport { Molecule as OCLMolecule } from 'openchemlib/full';\n\nimport generateID from '../utilities/generateID';\n\n/**\n * @param {object} [options={}]\n * @param {object} [options.molfile='']\n * @param {object} [options.key=Math.random()] Optional unique identifier\n */\nexport function initMolecule(options = {}) {\n  const molecule = {};\n  molecule.key = options.key || generateID();\n  molecule.molfile = options.molfile || '';\n  const mol = new OCLMolecule.fromMolfile(molecule.molfile);\n  const mfInfo = mol.getMolecularFormula();\n  molecule.mf = mfInfo.formula;\n  molecule.em = mfInfo.absoluteWeight;\n  molecule.mw = mfInfo.relativeWeight;\n  molecule.svg = mol.toSVG(50, 50);\n\n  const mf = new MF(molecule.mf);\n  molecule.atoms = mf.getInfo().atoms;\n  return molecule;\n}\n\nexport function toJSON(molecule) {\n  return {\n    molfile: molecule.molfile,\n  };\n}\n","import { fromJEOL, fromJCAMP, fromBruker } from 'nmr-parser';\n\nimport * as Data1DManager from './data1d/Data1DManager';\nimport * as Datum1D from './data1d/Datum1D';\nimport * as Data2DManager from './data2d/Data2DManager';\nimport * as Datum2D from './data2d/Datum2D';\nimport * as Molecule from './molecules/Molecule';\n\nexport function addJcampFromURL(spectra, jcampURL, options) {\n  // { credentials: 'include' }\n  return fetch(jcampURL)\n    .then((response) => response.arrayBuffer())\n    .then((jcamp) => {\n      addJcamp(spectra, jcamp, options);\n    });\n}\n\nexport function addJcamp(spectra, jcamp, options = {}) {\n  const entries = fromJCAMP(jcamp, {\n    noContour: true,\n    xy: true,\n    keepRecordsRegExp: /.*/,\n    profiling: true,\n  });\n  if (entries.length === 0) return;\n  // Should be improved when we have a more complex case\n  for (let entry of entries) {\n    let { dependentVariables } = entry;\n    if (\n      dependentVariables[0].components &&\n      (dependentVariables[0].components.length > 0 ||\n        dependentVariables[0].components.z.length)\n    ) {\n      addJcampSS(spectra, entry, options);\n    }\n  }\n}\n\nfunction addJcampSS(spectra, entry, options) {\n  const dimension = entry.info.dimension;\n  if (dimension === 1) {\n    spectra.push(Data1DManager.fromParsedJcamp(entry, options));\n  }\n  if (dimension === 2) {\n    spectra.push(Data2DManager.fromParsedJcamp(entry, options));\n  }\n}\n\nfunction addData(spectra, datum) {\n  const dimension = datum.info.dimension;\n  if (dimension === 1) {\n    spectra.push(Datum1D.initiateDatum1D(datum));\n  }\n  if (dimension === 2) {\n    spectra.push(Datum2D.initiateDatum2D(datum));\n  }\n}\n\nexport function addJDF(spectra, jdf, options = {}) {\n  // need to parse the jcamp\n  let converted = fromJEOL(jdf, {});\n  let info = converted.description;\n  let metadata = info.metadata;\n  delete info.metadata;\n  info.acquisitionMode = 0;\n  info.experiment = info.dimension === 1 ? '1d' : '2d';\n  info.type = 'NMR SPECTRUM';\n  info.nucleus = info.nucleus[0];\n  info.numberOfPoints = info.numberOfPoints[0];\n  info.acquisitionTime = info.acquisitionTime[0];\n\n  info.baseFrequency = info.baseFrequency[0];\n  info.frequencyOffset = info.frequencyOffset[0];\n\n  info.spectralWidthClipped = converted.application.spectralWidthClipped;\n\n  if (info.dimension === 1) {\n    if (converted.dependentVariables) {\n      spectra.push(\n        Data1DManager.fromCSD(converted, {\n          ...options,\n          display: { ...options.display },\n          info: info,\n          meta: metadata,\n        }),\n      );\n    }\n  }\n  if (info.dimension === 2 && info.isFt) {\n    spectra.push(\n      Data2DManager.fromCSD(converted, {\n        ...options,\n        display: { ...options.display },\n        info,\n      }),\n    );\n  }\n}\n\nexport async function fromJSON(data = []) {\n  const spectra = [];\n  let promises = [];\n\n  for (let datum of data) {\n    if (datum.source.jcampURL != null) {\n      promises.push(addJcampFromURL(spectra, datum.source.jcampURL, datum));\n    } else {\n      addData(spectra, datum);\n    }\n  }\n  await Promise.all(promises);\n  return spectra;\n}\n\nexport async function addBruker(options, data) {\n  const spectra = [];\n  let result = await fromBruker(data, {\n    xy: true,\n    noContours: true,\n    keepOriginal: true,\n  });\n  let entries = result;\n  for (let entry of entries) {\n    let { info, dependentVariables } = entry;\n    if (info.dimension === 1) {\n      if (dependentVariables[0].components) {\n        spectra.push(\n          Data1DManager.fromBruker(entry, {\n            ...options,\n            display: { ...options.display },\n          }),\n        );\n      }\n    } else if (info.dimension === 2) {\n      if (info.isFt) {\n        spectra.push(\n          Data2DManager.fromBruker(entry, {\n            ...options,\n            info,\n            display: { ...options.display },\n          }),\n        );\n      } else {\n        // in case of 2D FID spectrum\n      }\n    }\n  }\n  return spectra;\n}\n\n// handle zip files\nexport async function fromZip(zipFiles) {\n  const spectra = [];\n  for (let zipFile of zipFiles) {\n    await addBruker(\n      spectra,\n      { display: { name: zipFile.name } },\n      zipFile.binary,\n    );\n  }\n  return spectra;\n}\n\nexport function addJDFs(files) {\n  const spectra = [];\n  for (const file of files) {\n    addJDF(spectra, file.binary, {\n      display: {\n        name: file.name,\n      },\n      source: {\n        jcampURL: file.jcampURL ? file.jcampURL : null,\n        file,\n      },\n    });\n  }\n  return spectra;\n}\n\nexport function addJcamps(files) {\n  const spectra = [];\n  for (const file of files) {\n    addJcamp(spectra, file.binary, {\n      display: {\n        name: file.name,\n      },\n      source: {\n        jcampURL: file.jcampURL ? file.jcampURL : null,\n        file,\n      },\n    });\n  }\n  return spectra;\n}\n\nexport async function addMolfileFromURL(molfileURL) {\n  let molfile = await fetch(molfileURL).then((response) => response.text());\n  this.addMolfile(molfile);\n}\n\n/**\n *\n * @param {object} state\n */\nexport function toJSON(state, forceIncludeData = false) {\n  const {\n    data,\n    molecules: mols,\n    preferences,\n    correlations,\n    multipleAnalysis,\n    exclusionZones,\n  } = state || {\n    data: [],\n    molecules: [],\n    preferences: {},\n    correlations: {},\n    multipleAnalysis: {},\n    exclusionZones: {},\n  };\n  const spectra = data.map((ob) => {\n    return ob.info.dimension === 1\n      ? Datum1D.toJSON(ob, forceIncludeData)\n      : Datum2D.toJSON(ob, forceIncludeData);\n  });\n\n  const molecules = mols.map((mol) => Molecule.toJSON(mol));\n\n  return {\n    spectra,\n    molecules,\n    preferences,\n    correlations,\n    multipleAnalysis,\n    exclusionZones,\n  };\n}\n","import { useState, useCallback, forwardRef } from 'react';\n\nconst CheckBox = forwardRef(function CheckBox(\n  { name = '', checked: checkProps, onChange = () => null, disabled },\n  ref,\n) {\n  const [checked, setCheck] = useState(checkProps);\n\n  const handleCheck = useCallback(\n    (e) => {\n      const _checked = !checked;\n      setCheck(_checked);\n      onChange(e);\n    },\n    [checked, onChange],\n  );\n\n  return (\n    <input\n      ref={ref}\n      type=\"checkbox\"\n      name={name}\n      id={name}\n      onChange={handleCheck}\n      defaultChecked={checkProps}\n      disabled={disabled}\n    />\n  );\n});\n\nCheckBox.defaultProps = {\n  onChange: function () {\n    return null;\n  },\n  name: '',\n  disabled: false,\n};\n\nexport default CheckBox;\n","import { useFormikContext } from 'formik';\nimport lodashGet from 'lodash/get';\nimport PropTypes from 'prop-types';\nimport { useCallback } from 'react';\n\nimport CheckBox from '../CheckBox';\n\nfunction FormikCheckBox({\n  label,\n  name,\n  onChange,\n  className,\n  reverse,\n  ...resProps\n}) {\n  const { values, setFieldValue } = useFormikContext();\n  const value = reverse ? !lodashGet(values, name) : lodashGet(values, name);\n\n  const changeHandler = useCallback(\n    (e) => {\n      e.persist();\n      onChange(e);\n      setFieldValue(name, reverse ? value : !value);\n    },\n    [name, onChange, reverse, setFieldValue, value],\n  );\n  return (\n    <div className={`${className} check-${value}`}>\n      <label htmlFor={name} className=\"checkbox-lable\">\n        {label}\n      </label>\n      <CheckBox\n        id={name}\n        name={name}\n        checked={value}\n        onChange={changeHandler}\n        className=\"checkbox\"\n        {...resProps}\n      />\n    </div>\n  );\n}\n\nFormikCheckBox.propTypes = {\n  label: PropTypes.string,\n  name: PropTypes.string,\n  className: PropTypes.string,\n  onChange: PropTypes.func,\n  reverse: PropTypes.bool,\n};\n\nFormikCheckBox.defaultProps = {\n  className: '',\n  onChange: () => null,\n  reverse: false,\n};\n\nexport default FormikCheckBox;\n","import { Formik } from 'formik';\nimport PropTypes from 'prop-types';\nimport { forwardRef } from 'react';\n\nconst FormikForm = forwardRef(function FormikForm(\n  { initialValues, onSubmit, validationSchema, children },\n  ref,\n) {\n  return (\n    <Formik\n      innerRef={ref}\n      initialValues={initialValues}\n      onSubmit={onSubmit}\n      validationSchema={validationSchema}\n    >\n      {() => <>{children}</>}\n    </Formik>\n  );\n});\n\nFormikForm.defaultProps = {\n  initialValues: {},\n  onSubmit: () => null,\n  validationSchema: null,\n};\nFormikForm.propTypes = {\n  initialValues: PropTypes.object,\n  onSubmit: PropTypes.func,\n  validationSchema: PropTypes.object,\n};\n\nexport default FormikForm;\n","import PropTypes from 'prop-types';\nimport { forwardRef, useState, useEffect, useCallback } from 'react';\n\nconst styles = {\n  label: {\n    lineHeight: 2,\n    userSelect: 'none',\n  },\n  input: {\n    height: '100%',\n    width: '100px',\n    borderRadius: '5px',\n    border: '0.55px solid #c7c7c7',\n    margin: '0px 5px 0px 5px',\n    textAlign: 'center',\n  },\n};\n\nconst Input = forwardRef(function Input(\n  {\n    label,\n    value,\n    name,\n    style,\n    onChange,\n    onKeyDown,\n    checkValue,\n    type,\n    enableAutoSelect,\n    className,\n    format,\n    ...prop\n  },\n  ref,\n) {\n  const [val, setVal] = useState(value);\n  useEffect(() => {\n    setVal(value);\n  }, [value]);\n\n  useEffect(() => {\n    if (enableAutoSelect) {\n      ref.current.select();\n    }\n  }, [enableAutoSelect, ref]);\n\n  const getValue = useCallback(\n    (value) => {\n      const formatValue = format();\n      return formatValue(\n        type === 'number'\n          ? String(value).trim() === '-'\n            ? Number(0)\n            : Number(value)\n          : value,\n      );\n    },\n    [format, type],\n  );\n\n  const onChangeHandler = useCallback(\n    (e) => {\n      e.persist();\n      e.stopPropagation();\n      e.preventDefault();\n      function check(value) {\n        if (type === 'number') {\n          const pattern = /^(?:-?[0-9]*|[0-9]\\d*)(?:\\.\\d{0,20})?$/;\n          if (value.trim() === '' || pattern.test(value)) {\n            return true;\n          }\n          return false;\n        }\n        return true;\n      }\n      const _value = e.target.value;\n      if (check(_value) && checkValue(_value)) {\n        const formatValue = format();\n\n        setVal(formatValue(_value));\n        onChange({\n          ...e,\n          target: { name: e.target.name, value: getValue(_value) },\n        });\n      }\n    },\n    [checkValue, format, getValue, onChange, type],\n  );\n\n  const handleKeyDown = useCallback(\n    (event) => {\n      event.persist();\n      onKeyDown({\n        ...event,\n        target: { name: event.target.name, value: getValue(val) },\n      });\n    },\n    [getValue, onKeyDown, val],\n  );\n  const preventPropagate = useCallback((event) => {\n    event.stopPropagation();\n  }, []);\n\n  return (\n    <div\n      style={{\n        display: 'flex',\n        flexDirection: 'row',\n        alignItems: 'center',\n        ...(style && style.container ? style.container : {}),\n      }}\n    >\n      {label && (\n        <span\n          style={{\n            ...styles.label,\n            ...(style && style.label ? style.label : {}),\n          }}\n          className=\"label\"\n        >\n          {label}\n        </span>\n      )}\n      <input\n        {...prop}\n        ref={ref}\n        name={name}\n        style={{\n          ...styles.input,\n          ...(style && style.input ? style.input : {}),\n        }}\n        type=\"text\"\n        value={val}\n        onChange={onChangeHandler}\n        onKeyDown={handleKeyDown}\n        onKeyPress={preventPropagate}\n        onDoubleClick={(e) => e.stopPropagation()}\n        className={`input ${className}`}\n      />\n    </div>\n  );\n});\n\nInput.propTypes = {\n  label: PropTypes.string,\n  name: PropTypes.string,\n  value: PropTypes.any,\n  style: PropTypes.shape({\n    label: PropTypes.object,\n    input: PropTypes.object,\n    container: PropTypes.object,\n  }),\n  onChange: PropTypes.func,\n  checkValue: PropTypes.func,\n  onKeyDown: PropTypes.func,\n  className: PropTypes.string,\n  format: PropTypes.func,\n  type: PropTypes.oneOf(['text', 'number']),\n  enableAutoSelect: PropTypes.bool,\n};\n\nInput.defaultProps = {\n  style: {\n    label: {},\n    input: {},\n    container: {},\n  },\n  value: '',\n  onChange: () => {\n    return null;\n  },\n  checkValue: () => true,\n  onKeyDown: () => null,\n  type: 'text',\n  className: '',\n  enableAutoSelect: false,\n  format: () => (val) => val,\n};\n\nexport default Input;\n","import { useFormikContext } from 'formik';\nimport lodashGet from 'lodash/get';\nimport PropTypes from 'prop-types';\nimport { useCallback, useEffect, useMemo } from 'react';\n\nimport Input from '../Input';\n\nfunction FormikInput({\n  label,\n  name,\n  style,\n  onChange,\n  checkValue,\n  type,\n  className,\n  value,\n  format,\n  ...resProps\n}) {\n  const {\n    values,\n    handleChange,\n    setFieldValue,\n    errors,\n    touched,\n  } = useFormikContext();\n  const changeHandler = useCallback(\n    (e) => {\n      onChange(e);\n      handleChange(e);\n    },\n    [handleChange, onChange],\n  );\n\n  useEffect(() => {\n    if (value) {\n      setFieldValue(name, value);\n    }\n  }, [name, setFieldValue, value]);\n\n  const isInvalid = useMemo(() => {\n    return lodashGet(errors, name) && lodashGet(touched, name);\n  }, [errors, name, touched]);\n  return (\n    <Input\n      label={label}\n      name={name}\n      value={value ? value : lodashGet(values, name)}\n      onChange={changeHandler}\n      type={type}\n      style={{\n        ...style,\n        input: { ...style.input, ...(isInvalid && { borderColor: 'red' }) },\n      }}\n      checkValue={checkValue}\n      className={className}\n      format={format}\n      {...resProps}\n    />\n  );\n}\n\nFormikInput.propTypes = {\n  label: PropTypes.string,\n  name: PropTypes.string,\n  style: PropTypes.shape({\n    label: PropTypes.object,\n    input: PropTypes.object,\n  }),\n  onChange: PropTypes.func,\n  checkValue: PropTypes.func,\n  type: PropTypes.oneOf(['text', 'number']),\n  className: PropTypes.string,\n  value: PropTypes.any,\n  format: PropTypes.func,\n};\n\nFormikInput.defaultProps = {\n  style: {\n    label: {},\n    input: {},\n  },\n  onChange: () => {\n    return null;\n  },\n  checkValue: () => true,\n  type: 'text',\n  className: '',\n  value: null,\n  format: () => (val) => val,\n};\n\nexport default FormikInput;\n","import { css } from '@emotion/react';\n\nexport const ModalStyles = css`\n  overflow: auto;\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n\n  .header {\n    text-align: center;\n    padding: 10px 0 10px 0px;\n    margin: 0px;\n    color: #005d9e;\n    place-items: normal;\n    text-transform: none;\n    background-color: #fcfcfc;\n  }\n\n  .tab-content {\n    width: 100%;\n  }\n  .row {\n    display: flex;\n  }\n\n  .inner-content {\n    padding: 15px 30px;\n    width: 100%;\n    overflow: auto;\n  }\n\n  button:focus {\n    outline: none;\n  }\n  button:hover {\n    color: #007bff;\n  }\n  .save-button:hover {\n    background-color: #ffffff;\n  }\n  .save-button {\n    border: none;\n    padding: 0 15px;\n    background-color: #ffffff5e;\n    border-radius: 5px;\n    height: 25px;\n  }\n\n  .footer-container {\n    display: flex;\n    align-items: flex-end;\n    justify-content: flex-end;\n    background: rgb(242, 242, 242);\n    background: -moz-linear-gradient(\n      0deg,\n      rgba(242, 242, 242, 1) 0%,\n      rgba(245, 245, 245, 1) 37%,\n      rgba(255, 255, 255, 1) 90%\n    );\n    background: -webkit-linear-gradient(\n      0deg,\n      rgba(242, 242, 242, 1) 0%,\n      rgba(245, 245, 245, 1) 37%,\n      rgba(255, 255, 255, 1) 90%\n    );\n    background: linear-gradient(\n      0deg,\n      rgba(242, 242, 242, 1) 0%,\n      rgba(245, 245, 245, 1) 37%,\n      rgba(255, 255, 255, 1) 90%\n    );\n    filter: progid:DXImageTransform.Microsoft.gradient(startColorstr=\"#f2f2f2\",endColorstr=\"#ffffff\",GradientType=1);\n    padding: 6px 15px;\n    height: 55px;\n  }\n\n  .section-header {\n    font-size: 13px;\n    color: #2ca8ff;\n    margin-bottom: 10px;\n    border-bottom: 0.55px solid #f9f9f9;\n    padding: 6px 2px;\n  }\n\n  .custom-label {\n    font-size: 12px;\n    font-weight: bold;\n    margin-right: 10px;\n    width: 120px;\n  }\n  .margin-10 {\n    margin: 10px 0;\n  }\n\n  .input {\n    font-size: 14px;\n    border-radius: 5px;\n    border: 1px solid #cccccc;\n    padding: 5px;\n    width: 100px;\n    margin-right: 10px;\n    height: initial !important;\n  }\n\n  .close-bt {\n    border: none;\n    color: red;\n    background-color: transparent;\n    outline: none;\n    position: absolute;\n    right: 10px;\n    top: 2px;\n    width: 30px;\n    height: 30px;\n  }\n`;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback, useRef } from 'react';\n\nimport CloseButton from '../elements/CloseButton';\nimport FormikCheckBox from '../elements/formik/FormikCheckBox';\nimport FormikForm from '../elements/formik/FormikForm';\nimport FormikInput from '../elements/formik/FormikInput';\n\nimport { ModalStyles } from './ModalStyle';\n\nconst styles = css`\n  .row {\n    align-items: center;\n  }\n\n  .inner-content {\n    flex: 1;\n  }\n\n  .custom-label {\n    width: 80px;\n  }\n\n  .name {\n    width: 100% !important;\n    text-align: left !important;\n  }\n`;\n\nconst INITIAL_VALUE = {\n  name: '',\n  compressed: false,\n  pretty: false,\n  includeData: false,\n};\n\nfunction SaveAsModal({ onClose, onSave, name }) {\n  const refForm = useRef();\n\n  const handleSave = useCallback(() => {\n    refForm.current.submitForm();\n  }, []);\n\n  const submitHandler = useCallback(\n    (values) => {\n      onSave(values);\n      onClose();\n    },\n    [onClose, onSave],\n  );\n\n  return (\n    <div css={[ModalStyles, styles]}>\n      <div className=\"header handle\">\n        <span>Save as ... </span>\n        <CloseButton onClick={onClose} className=\"close-bt\" />\n      </div>\n      <div className=\"inner-content\">\n        <FormikForm\n          ref={refForm}\n          initialValues={{ ...INITIAL_VALUE, name }}\n          onSubmit={submitHandler}\n        >\n          <div className=\"row margin-10\">\n            <span className=\"custom-label\">Name</span>\n            <FormikInput\n              label=\"\"\n              name=\"name\"\n              className=\"name\"\n              style={{\n                container: { width: '100%' },\n              }}\n            />\n          </div>\n\n          <div className=\"row margin-10\">\n            <span className=\"custom-label\">Compressed</span>\n            <FormikCheckBox name=\"compressed\" />\n          </div>\n          <div className=\"row margin-10\">\n            <span className=\"custom-label\">Pretty Format</span>\n            <FormikCheckBox name=\"pretty\" />\n          </div>\n          <div className=\"row margin-10\">\n            <span className=\"custom-label\">Include Data</span>\n            <FormikCheckBox name=\"includeData\" />\n          </div>\n        </FormikForm>\n      </div>\n      <div className=\"footer-container\">\n        <button type=\"button\" onClick={handleSave} className=\"save-button\">\n          Save\n        </button>\n        <button type=\"button\" onClick={onClose} className=\"save-button\">\n          Close\n        </button>\n      </div>\n    </div>\n  );\n}\n\nexport default SaveAsModal;\n","import Jszip from 'jszip';\n\nconst jszip = new Jszip();\nexport async function addSource(nmrRecord, options = {}) {\n  const { spectrum, source } = options;\n  const { file = {}, jcampURL } = source;\n  let tag = '';\n  const dimension = `${spectrum.info.dimension}d`;\n  switch (file.extension) {\n    case 'jdx':\n    case 'dx':\n      tag += `\\nJcamp_Location=file:jcamp/${dimension}/${spectrum.display.name}\\\\`;\n      nmrRecord.file(\n        `jcamp/${dimension}/${spectrum.display.name}`,\n        file.binary,\n      );\n      break;\n    case 'zip':\n      if (!file.binary) return;\n      void jszip.loadAsync(file.binary).then(async (zip) => {\n        for (const file in zip.files) {\n          if (file.endsWith('/')) continue;\n          nmrRecord.file(\n            `Bruker/${file}`,\n            await zip.file(file).async('arraybuffer'),\n          );\n        }\n        tag += `\\nSpectrum_Location=file:Bruker/${getPathFromZip(zip)}\\\\`;\n      });\n      break;\n    default:\n      if (!jcampURL) break;\n      void (await fetch(jcampURL).then(async (jcamp) => {\n        if (!jcamp) return;\n        let name = jcampURL.split('/').slice(-1);\n        const path = `jcamp/${dimension}/${name}`;\n        tag += `\\nJcamp_Location=file:${path}\\\\`;\n        nmrRecord.file(path, await jcamp.arrayBuffer());\n      }));\n  }\n\n  return tag;\n}\n\nfunction getPathFromZip(zip) {\n  let files = zip.filter(function (relativePath) {\n    if (relativePath.match('__MACOSX')) return false;\n    if (\n      relativePath.endsWith('fid') ||\n      relativePath.endsWith('1r') ||\n      relativePath.endsWith('ser') ||\n      relativePath.endsWith('2rr')\n    ) {\n      return true;\n    }\n    return false;\n  });\n  const index = files.findIndex(\n    (file) => file.name.endsWith('1r') || file.name.endsWith('2rr'),\n  );\n  return index > -1 ? files[index].name : files[0].name;\n}\n","export function getToFix(nucleusArray) {\n  if (!Array.isArray(nucleusArray)) nucleusArray = [nucleusArray];\n  let toFix = [];\n  for (let nucleus of nucleusArray) {\n    toFix.push(chooseDecimal(nucleus));\n  }\n  return toFix;\n}\n\nfunction chooseDecimal(nucleus) {\n  switch (nucleus.toUpperCase()) {\n    case '1H':\n      return 2;\n    case '13C':\n      return 1;\n    default:\n      return 1;\n  }\n}\n","import { addSource } from './addSource';\nimport { getToFix } from './getToFix';\n\nexport async function get1DSignals(data, nmrRecord, options = {}) {\n  let { prefix, labels } = options;\n  let str = '';\n  let nucleusArray = [];\n  for (let spectrum of data) {\n    const { info } = spectrum;\n    if (info.isFid || info.dimension > 1) continue;\n    let partTag = '';\n    let ranges = spectrum.ranges.values || [];\n\n    let nucleus = spectrum.info.nucleus;\n    let counter = 1;\n    let subfix = '';\n    nucleusArray.forEach((e) => {\n      if (e === nucleus) counter++;\n    });\n    nucleusArray.push(nucleus);\n\n    if (counter > 1) subfix = `#${counter}`;\n\n    partTag += `${prefix}1D_${nucleus.toUpperCase()}${subfix}>`;\n\n    if (spectrum.info.baseFrequency) {\n      partTag += `\\nLarmor=${Number(spectrum.info.baseFrequency).toFixed(2)}\\\\`;\n    }\n\n    const { source = {} } = spectrum;\n\n    partTag += await addSource(nmrRecord, {\n      spectrum,\n      tag: partTag,\n      source,\n    });\n\n    let toFix = getToFix(nucleus)[0];\n\n    for (let range of ranges) {\n      let signals = range.signal;\n\n      for (let signal of signals) {\n        let { multiplicity } = signal;\n        if ((!multiplicity || multiplicity === 'm') && nucleus === '1H') {\n          partTag += `\\n${Number(range.from).toFixed(toFix)}-${Number(\n            range.to,\n          ).toFixed(toFix)}`;\n        } else if (signal.delta) {\n          partTag += `\\n${Number(signal.delta).toFixed(toFix)}`;\n        } else {\n          continue;\n        }\n\n        let signalLabel = '';\n\n        if (signal.diaID && signal.diaID.length > 0) {\n          signal.diaID.forEach((diaID, i, arr) => {\n            let separator = ', ';\n            if (i === arr.length - 1) separator = '';\n            let label = labels.byDiaID[diaID].label || diaID;\n            signalLabel += `${label}${separator}`;\n          });\n          partTag += `, L=${signalLabel}`;\n        }\n\n        if (nucleus === '1H') {\n          if (signal.multiplicity) partTag += `, S=${signal.multiplicity}`;\n\n          let jCoupling = signal.j;\n          if (Array.isArray(jCoupling) && jCoupling.length) {\n            let separator = ', J=';\n            for (let i = 0; i < jCoupling.length; i++) {\n              partTag += `${separator}${Number(jCoupling[i].coupling).toFixed(\n                3,\n              )}`;\n              if (jCoupling[i].diaID) {\n                let { diaID } = jCoupling[i];\n                if (!Array.isArray(diaID)) diaID = [diaID];\n                if (!diaID.length) continue;\n                let jCouple =\n                  labels.byDiaID[diaID[0]].label || String(diaID[0]);\n                partTag += `(${jCouple})`;\n              }\n              separator = ', ';\n            }\n          }\n          if (range.integral) {\n            partTag += `, E=${Number(range.integral).toFixed(toFix)}`;\n          } else if (range.pubIntegral) {\n            partTag += `, E=${range.putIntegral.toFixed(toFix)}`;\n          } else if (range.signal[0].nbAtoms !== undefined) {\n            partTag += `, E=${range.signal[0].nbAtoms}`;\n          }\n        }\n      }\n      if (signals.length) partTag += '\\\\';\n    }\n    partTag += '\\n';\n\n    if (partTag.match('\\\\\\n')) str += partTag;\n  }\n  return str;\n}\n","export function getCouplingObserved(experiment) {\n  switch (experiment.toLowerCase()) {\n    case 'hsqc':\n    case 'cosy':\n      return '1J';\n    case 'hmbc':\n      return 'NJ';\n    default:\n      return 'NJ';\n  }\n}\n","import { addSource } from './addSource';\nimport { getCouplingObserved } from './getCouplingObserved';\nimport { getToFix } from './getToFix';\n\nconst isArray = Array.isArray;\n\nexport async function get2DSignals(data, nmrRecord, options = {}) {\n  const { byDiaID } = options.labels;\n  let str = '';\n  let nucleusRecorded = [];\n  const prefix = `\\n> <NMREDATA_2D_`;\n  for (let spectrum of data) {\n    if (spectrum.info.dimension < 2) continue;\n    let partTag = '';\n    const { info, source } = spectrum;\n    let { nucleus, experiment, pulseSequence } = info;\n\n    nucleusRecorded.push(nucleus);\n\n    let couplingObserved = getCouplingObserved(experiment);\n    if (nucleus) {\n      partTag += `${prefix}${nucleus[1]}_${couplingObserved}_${nucleus[0]}>`;\n    }\n    let toFix = getToFix(nucleus);\n\n    partTag += await addSource(nmrRecord, {\n      spectrum,\n      tag: partTag,\n      source,\n    });\n\n    if (experiment) partTag += `\\nCorType=${experiment} \\\\`;\n    if (pulseSequence) partTag += `\\nPulseProgram=${pulseSequence} \\\\`;\n\n    if (spectrum.info.baseFrequency) {\n      partTag += `\\nLarmor=${Number(spectrum.info.baseFrequency[0]).toFixed(\n        2,\n      )}\\\\`;\n    }\n\n    let zones = spectrum.zones.values || [];\n    for (let zone of zones) {\n      let signals = zone.signal;\n      for (let signal of signals) {\n        let { x, y, peak } = signal;\n        let xLabel = getAssignment(x, byDiaID, toFix[0]);\n        let yLabel = getAssignment(y, byDiaID, toFix[1]);\n        let intensity = Math.max(...peak.map((e) => e.z));\n        partTag += `\\n${xLabel}/${yLabel}, I=${intensity.toFixed(2)}\\\\`;\n      }\n    }\n    str += partTag;\n  }\n  return str.length > 0 ? `${str}\\n` : '';\n}\n\nfunction getAssignment(axis, labels, toFix) {\n  let { diaID, delta } = axis;\n  if (diaID) {\n    if (!isArray(diaID)) diaID = [diaID];\n    if (diaID.length < 1) return Number(delta).toFixed(toFix);\n    let label = diaID.map((diaID) => labels[diaID].label).join(',');\n    return diaID.length > 1 ? `(${label})` : label;\n  }\n  return Number(delta).toFixed(toFix);\n}\n","export function flat2DSignals(signals) {\n  let flattedSignal = [];\n  for (let i = 0; i < signals.length; i++) {\n    let { x, y } = signals[i];\n    flattedSignal.push(x, y);\n  }\n  return flattedSignal;\n}\n","import { getShortestPaths } from 'openchemlib-utils';\n\nimport { flat2DSignals } from './flat2DSignals';\nimport { getToFix } from './getToFix';\n\nexport function getLabels(data, options = {}) {\n  const { groupedDiaIDs, molecule } = options;\n\n  let connections = getShortestPaths(molecule, { toLabel: 'H', maxLength: 1 });\n\n  let byDiaID = {};\n  let byAssignNumber = {};\n  for (let spectrum of data) {\n    let { dimension, nucleus } = spectrum.info;\n    let toFix = getToFix(nucleus);\n\n    let [roiKey, flatSignals] =\n      dimension > 1 ? ['zones', flat2DSignals] : ['ranges', (s) => s || []];\n\n    let rois = spectrum[roiKey].values || [];\n    for (let roi of rois) {\n      let signals = flatSignals(roi.signal);\n      for (let i = 0; i < signals.length; i++) {\n        let diaIDs = signals[i].diaID || [];\n        for (let diaID of diaIDs) {\n          let delta = Number(signals[i].delta).toFixed(toFix[i % dimension]);\n          // get atomLabel\n          let groupedOclID = groupedDiaIDs.find((dia) => {\n            if (dia.oclID === diaID) return true;\n            return false;\n          });\n          // the addition of one in atom number it is because the atoms enumeration starts from zero\n\n          let labelOptions = {\n            atom: groupedOclID.atoms[0],\n            molecule,\n            connections,\n            atomLabel: groupedOclID.atomLabel,\n          };\n\n          byDiaID[diaID] = {\n            atoms: groupedOclID.atoms.map((e) => e + 1),\n            shift: delta,\n            label: createLabel(labelOptions),\n          };\n\n          for (let atom of groupedOclID.atoms) {\n            labelOptions.atom = atom;\n            byAssignNumber[atom] = {\n              shift: delta,\n              diaID,\n              label: createLabel(labelOptions),\n            };\n          }\n        }\n      }\n    }\n  }\n  return { byAssignNumber, byDiaID };\n}\n\nfunction createLabel(options) {\n  const { atom, molecule, atomLabel, connections } = options;\n  let label = '';\n  if (atomLabel !== 'C') {\n    let connectedTo = connections[atom];\n    let path = connectedTo.find((e) => e && e.length > 1);\n    let pLabel = `${atomLabel}${path[0] + 1}`;\n    let hLabel = `${molecule.getAtomLabel(path[1])}${path[1] + 1}`;\n    label = `${pLabel}${hLabel}`;\n  } else {\n    label = `${atomLabel}${atom + 1}`;\n  }\n  return label;\n}\n","import jszip from 'jszip';\nimport { getGroupedDiastereotopicAtomIDs } from 'openchemlib-utils';\nimport { Molecule as OCLMolecule } from 'openchemlib/full';\n\nimport { get1DSignals } from './util/nmredata/get1DSignals';\nimport { get2DSignals } from './util/nmredata/get2DSignals';\nimport { getLabels } from './util/nmredata/getLabels';\n\nconst tags = {\n  solvent: 'SOLVENT',\n  temperature: 'TEMPERATURE',\n  assignment: 'ASSIGNMENT',\n  j: 'J',\n  signals: 'SIGNALS',\n  id: 'ID',\n};\n\nexport async function nmriumToNmredata(state, options = {}) {\n  const {\n    data, // it would be changed depending of the final location\n    molecules,\n  } = state || {\n    data: [], // it would be changed depending of the final location\n    molecules: [],\n  };\n\n  let nmrRecord = new jszip();\n\n  for (const molecule of molecules) {\n    await addNMReDATA(data, nmrRecord, {\n      ...options,\n      molecule,\n    });\n  }\n\n  if (!molecules.length) await addNMReDATA(data, nmrRecord, options);\n  return nmrRecord;\n}\n\nasync function addNMReDATA(data, nmrRecord, options = {}) {\n  let {\n    id,\n    prefix = '\\n> <NMREDATA_',\n    filename = 'nmredata',\n    molecule,\n  } = options;\n\n  let sdfResult = '';\n\n  let groupedDiaIDs;\n  if (molecule) {\n    molecule = OCLMolecule.fromMolfile(molecule.molfile);\n    sdfResult += molecule.toMolfile();\n    molecule.addImplicitHydrogens();\n    groupedDiaIDs = getGroupedDiastereotopicAtomIDs(molecule);\n  }\n\n  let labels = molecule ? getLabels(data, { groupedDiaIDs, molecule }) : {};\n\n  sdfResult += `${prefix}VERSION>\\n1.1\\\\\\n`;\n  sdfResult += putTag(data, 'temperature', { prefix });\n  sdfResult += putTag(data, 'solvent', { prefix });\n\n  if (id) sdfResult += `${prefix + tags.id}>\\nid\\\\\\n`;\n  sdfResult += formatAssignments(labels.byDiaID, { prefix });\n  sdfResult += await get1DSignals(data, nmrRecord, { prefix, labels });\n  sdfResult += await get2DSignals(data, nmrRecord, { prefix, labels });\n  sdfResult += '\\n$$$$\\n';\n  nmrRecord.file(`${filename}.sdf`, sdfResult);\n}\n\nfunction formatAssignments(labels, options) {\n  if (!labels) return '';\n  const { prefix } = options;\n  let str = `${prefix + tags.assignment}>\\n`;\n  for (let l in labels) {\n    let atoms = labels[l].atoms;\n    str += `${labels[l].label}, ${labels[l].shift}`; // change to add label\n    for (let atom of atoms) str += `, ${atom}`;\n    str += '\\\\\\n';\n  }\n  return str;\n}\n\nfunction putTag(spectra, tag, options = {}) {\n  const { prefix } = options;\n  let str = '';\n  for (let spectrum of spectra) {\n    if (spectrum.info[tag]) {\n      str += `${prefix + tags[tag]}>\\n${String(spectrum.info[tag])}\\\\\\n`;\n      break;\n    }\n  }\n  return str;\n}\n","import { useCallback } from 'react';\n\nimport { toJSON } from '../../data/SpectraManager';\nimport { useChartData } from '../context/ChartContext';\nimport { useAlert } from '../elements/popup/Alert';\nimport { positions, useModal } from '../elements/popup/Modal';\nimport SaveAsModal from '../modal/SaveAsModal';\nimport {\n  copyPNGToClipboard,\n  exportAsJSON,\n  exportAsNMRE,\n  exportAsPng,\n  exportAsSVG,\n} from '../utility/Export';\nimport { nmriumToNmredata } from '../utility/nmriumToNmredata';\n\nexport default function useExport() {\n  const modal = useModal();\n  const alert = useAlert();\n  const state = useChartData();\n\n  const saveToClipboardHandler = useCallback(async () => {\n    if (state.data.length > 0) {\n      const hideLoading = await alert.showLoading(\n        'Exporting as numrium process in progress',\n      );\n      setTimeout(() => {\n        copyPNGToClipboard('nmrSVG');\n        hideLoading();\n        alert.success('Image copied to clipboard');\n      }, 0);\n    }\n  }, [alert, state]);\n\n  const saveAsJSONHandler = useCallback(\n    async (spaceIndent = 0, isCompressed = true) => {\n      if (state.data.length > 0) {\n        const hideLoading = await alert.showLoading(\n          'Exporting as numrium process in progress',\n        );\n        setTimeout(async () => {\n          //exported file name by default will be the first spectrum name\n          const fileName = state.data[0]?.display?.name;\n          const exportedData = toJSON(state);\n          await exportAsJSON(exportedData, fileName, spaceIndent, isCompressed);\n          hideLoading();\n        }, 0);\n      }\n    },\n    [alert, state],\n  );\n\n  const saveAsNMREHandler = useCallback(async () => {\n    if (state.data.length > 0) {\n      const hideLoading = await alert.showLoading(\n        'Exporting as NMRE process in progress',\n      );\n      setTimeout(async () => {\n        const fileName = state.data[0]?.display?.name;\n        const exportedData = await nmriumToNmredata(state);\n        exportAsNMRE(exportedData, fileName);\n        hideLoading();\n      }, 0);\n    }\n  }, [alert, state]);\n\n  const saveAsSVGHandler = useCallback(async () => {\n    if (state.data.length > 0) {\n      const hideLoading = await alert.showLoading(\n        'Exporting as SVG process in progress',\n      );\n      setTimeout(() => {\n        const fileName = state.data[0]?.display?.name;\n        exportAsSVG(fileName, 'nmrSVG');\n        hideLoading();\n      }, 0);\n    }\n  }, [alert, state.data]);\n\n  const saveAsPNGHandler = useCallback(async () => {\n    if (state.data.length > 0) {\n      const hideLoading = await alert.showLoading(\n        'Exporting as PNG process in progress',\n      );\n      setTimeout(() => {\n        const fileName = state.data[0]?.display?.name;\n        exportAsPng(fileName, 'nmrSVG');\n        hideLoading();\n      }, 0);\n    }\n  }, [alert, state.data]);\n\n  const saveHandler = useCallback(\n    async (options) => {\n      const { name, pretty, compressed, includeData } = options;\n      const hideLoading = await alert.showLoading(\n        `Exporting as ${name}.numrium process in progress`,\n      );\n      setTimeout(async () => {\n        const exportedData = toJSON(state, includeData);\n        const spaceIndent = pretty ? 2 : 0;\n        await exportAsJSON(exportedData, name, spaceIndent, compressed);\n        hideLoading();\n      }, 0);\n    },\n    [alert, state],\n  );\n  const saveAsHandler = useCallback(async () => {\n    if (state.data.length > 0) {\n      const fileName = state.data[0]?.display?.name;\n      modal.show(<SaveAsModal name={fileName} onSave={saveHandler} />, {\n        isBackgroundBlur: false,\n        position: positions.TOP_CENTER,\n        width: 400,\n        height: 280,\n      });\n\n      // const hideLoading = await alert.showLoading(\n      //   'Exporting as PNG process in progress',\n      // );\n      // setTimeout(() => {\n      //   const fileName = state.data[0]?.display?.name;\n      //   exportAsPng(fileName, 'nmrSVG');\n      //   hideLoading();\n      // }, 0);\n    }\n  }, [modal, saveHandler, state.data]);\n\n  return {\n    saveToClipboardHandler,\n    saveAsJSONHandler,\n    saveAsNMREHandler,\n    saveAsSVGHandler,\n    saveAsPNGHandler,\n    saveAsHandler,\n  };\n}\n","import lodashDebounce from 'lodash/debounce';\nimport lodashMap from 'lodash/map';\nimport { useCallback, useRef, useState } from 'react';\n\nimport { useDispatch } from '../context/DispatchContext';\nimport { useAlert } from '../elements/popup/Alert';\nimport { ZoomType } from '../reducer/actions/Zoom';\nimport {\n  CHANGE_SPECTRUM_DISPLAY_VIEW_MODE,\n  FULL_ZOOM_OUT,\n  SET_SELECTED_TOOL,\n  SET_SPECTRUMS_VERTICAL_ALIGN,\n  TOGGLE_REAL_IMAGINARY_VISIBILITY,\n} from '../reducer/types/Types';\nimport { options } from '../toolbar/ToolTypes';\n\nexport default function useToolsFunctions() {\n  const dispatch = useDispatch();\n  const alert = useAlert();\n  const [isRealSpectrumShown, setIsRealSpectrumShown] = useState(false);\n\n  const debounceClickEventsRef = useRef({ clicks: [] });\n  const handleChangeOption = useCallback(\n    (selectedTool) => {\n      if (\n        [\n          options.peakPicking.id,\n          options.integral.id,\n          options.zone2D.id,\n        ].includes(selectedTool)\n      ) {\n        alert.show(\n          'Press Shift + Left Mouse button to select zone for integral and peak picking',\n        );\n      }\n      dispatch({ type: SET_SELECTED_TOOL, selectedTool });\n    },\n    [alert, dispatch],\n  );\n\n  const handleFullZoomOut = useCallback(() => {\n    if (debounceClickEventsRef.current.clicks.length === 0) {\n      dispatch({\n        type: FULL_ZOOM_OUT,\n        zoomType: ZoomType.HORIZONTAL,\n      });\n    }\n    const callback = lodashDebounce(() => {\n      debounceClickEventsRef.current.clicks = [];\n    }, 500);\n    debounceClickEventsRef.current.clicks.push(callback);\n\n    callback();\n\n    if (debounceClickEventsRef.current.clicks.length > 1) {\n      lodashMap(debounceClickEventsRef.current.clicks, (debounce) =>\n        debounce.cancel(),\n      );\n      debounceClickEventsRef.current.clicks = [];\n      dispatch({\n        type: FULL_ZOOM_OUT,\n      });\n    }\n  }, [dispatch, debounceClickEventsRef]);\n\n  const changeDisplayViewModeHandler = useCallback(() => {\n    dispatch({\n      type: CHANGE_SPECTRUM_DISPLAY_VIEW_MODE,\n    });\n  }, [dispatch]);\n\n  const changeSpectrumViewHandler = useCallback(() => {\n    dispatch({\n      type: TOGGLE_REAL_IMAGINARY_VISIBILITY,\n      isRealSpectrumVisible: !isRealSpectrumShown,\n    });\n    setIsRealSpectrumShown(!isRealSpectrumShown);\n  }, [dispatch, isRealSpectrumShown]);\n\n  const alignSpectrumsVerticallyHandler = useCallback(() => {\n    dispatch({\n      type: SET_SPECTRUMS_VERTICAL_ALIGN,\n    });\n  }, [dispatch]);\n\n  return {\n    handleChangeOption,\n    handleFullZoomOut,\n    changeDisplayViewModeHandler,\n    changeSpectrumViewHandler,\n    alignSpectrumsVerticallyHandler,\n    isRealSpectrumShown,\n  };\n}\n","import { useCallback, useEffect, useMemo } from 'react';\n\nimport checkModifierKeyActivated from '../../data/utilities/checkModifierKeyActivated';\nimport { useAssignmentData } from '../assignment';\nimport { useChartData } from '../context/ChartContext';\nimport { useDispatch } from '../context/DispatchContext';\nimport { useLoader } from '../context/LoaderContext';\nimport { useAlert } from '../elements/popup/Alert';\nimport { TYPES, useHighlightData } from '../highlight/index';\nimport useExport from '../hooks/useExport';\nimport useToolsFunctions from '../hooks/useToolsFunctions';\nimport { DISPLAYER_MODE } from '../reducer/core/Constants';\nimport {\n  SET_KEY_PREFERENCES,\n  APPLY_KEY_PREFERENCES,\n  DELETE_INTEGRAL,\n  DELETE_PEAK_NOTATION,\n  DELETE_RANGE,\n  DELETE_2D_ZONE,\n  DELETE_EXCLUSION_ZONE,\n} from '../reducer/types/Types';\nimport { options } from '../toolbar/ToolTypes';\n\nfunction KeysListenerTracker() {\n  const {\n    keysPreferences,\n    displayerMode,\n    overDisplayer,\n    data,\n  } = useChartData();\n  const dispatch = useDispatch();\n  const alert = useAlert();\n  const loader = useLoader();\n\n  const {\n    handleChangeOption,\n    handleFullZoomOut,\n    alignSpectrumsVerticallyHandler,\n    changeDisplayViewModeHandler,\n  } = useToolsFunctions();\n\n  const {\n    saveToClipboardHandler,\n    saveAsJSONHandler,\n    saveAsHandler,\n  } = useExport();\n\n  const { highlight } = useHighlightData();\n  const assignmentData = useAssignmentData();\n\n  const allow1DTool = useMemo(() => {\n    return displayerMode === DISPLAYER_MODE.DM_1D && data && data.length > 0;\n  }, [data, displayerMode]);\n\n  const allow2DTool = useMemo(() => {\n    return displayerMode === DISPLAYER_MODE.DM_2D && data && data.length > 0;\n  }, [data, displayerMode]);\n\n  const deleteHandler = useCallback(\n    (type, data) => {\n      switch (type) {\n        case TYPES.INTEGRAL: {\n          dispatch({\n            type: DELETE_INTEGRAL,\n            integralID: data.activeKey,\n          });\n          break;\n        }\n        case TYPES.PEAK: {\n          dispatch({\n            type: DELETE_PEAK_NOTATION,\n            data: { id: data.activeKey },\n          });\n          break;\n        }\n        case TYPES.RANGE: {\n          dispatch({\n            type: DELETE_RANGE,\n            payload: {\n              id: data.activeKey,\n              assignmentData,\n            },\n          });\n          break;\n        }\n        case TYPES.ZONE: {\n          dispatch({\n            type: DELETE_2D_ZONE,\n            payload: {\n              id: data.activeKey,\n              assignmentData,\n            },\n          });\n          break;\n        }\n        case TYPES.EXCLUSION_ZONE: {\n          dispatch({\n            type: DELETE_EXCLUSION_ZONE,\n            payload: {\n              id: data.activeKey,\n            },\n          });\n          break;\n        }\n        default:\n          break;\n      }\n    },\n    [assignmentData, dispatch],\n  );\n\n  const keysPreferencesListenerHandler = useCallback(\n    (e, num) => {\n      if (data && data.length > 0 && num >= 1 && num <= 9) {\n        if (e.shiftKey) {\n          dispatch({\n            type: SET_KEY_PREFERENCES,\n            keyCode: num,\n          });\n          alert.show(`Configuration Reset, press '${num}' again to reload it.`);\n        } else {\n          if (!checkModifierKeyActivated(e)) {\n            if (keysPreferences && keysPreferences[num]) {\n              dispatch({\n                type: APPLY_KEY_PREFERENCES,\n                keyCode: num,\n              });\n            } else {\n              dispatch({\n                type: SET_KEY_PREFERENCES,\n                keyCode: num,\n              });\n              alert.show(\n                `Configuration saved, press '${num}' again to reload it.`,\n              );\n            }\n          }\n        }\n      }\n    },\n    [alert, data, dispatch, keysPreferences],\n  );\n\n  const toolsListenerHandler = useCallback(\n    (e) => {\n      if (!e.shiftKey && !e.metaKey) {\n        switch (e.key) {\n          case 'f':\n            handleFullZoomOut();\n            break;\n          case 'z':\n          case 'Escape':\n            handleChangeOption(options.zoom.id);\n            break;\n          case 'r': {\n            if (allow1DTool) {\n              handleChangeOption(options.rangesPicking.id);\n            }\n            break;\n          }\n          case 'b': {\n            if (allow1DTool) {\n              handleChangeOption(options.baseLineCorrection.id);\n            }\n            break;\n          }\n          case 'p': {\n            if (allow1DTool) {\n              handleChangeOption(options.peakPicking.id);\n            }\n            break;\n          }\n          case 'i': {\n            const toolID = allow2DTool\n              ? options.zone2D.id\n              : allow1DTool\n              ? options.integral.id\n              : '';\n            handleChangeOption(toolID);\n            break;\n          }\n          case 'a': {\n            if (allow1DTool) {\n              handleChangeOption(options.phaseCorrection.id);\n            }\n            break;\n          }\n          default:\n        }\n      }\n\n      if (!e.shiftKey && !e.metaKey && !e.ctrlKey) {\n        switch (e.key) {\n          case 'c': {\n            if (allow1DTool) {\n              alignSpectrumsVerticallyHandler();\n            }\n            break;\n          }\n          case 's': {\n            if (allow1DTool) {\n              changeDisplayViewModeHandler();\n            }\n            break;\n          }\n          default:\n        }\n      }\n\n      if (!e.shiftKey && (e.metaKey || e.ctrlKey)) {\n        switch (e.key) {\n          case 'c':\n            saveToClipboardHandler();\n            e.preventDefault();\n            break;\n          case 's':\n            saveAsJSONHandler();\n            e.preventDefault();\n            break;\n          case 'o':\n            loader.open();\n            e.preventDefault();\n            break;\n          default:\n        }\n      }\n      if (e.shiftKey && (e.metaKey || e.ctrlKey)) {\n        switch (e.key) {\n          case 'S':\n            saveAsHandler();\n            e.preventDefault();\n            break;\n          default:\n        }\n      }\n    },\n    [\n      alignSpectrumsVerticallyHandler,\n      allow1DTool,\n      allow2DTool,\n      changeDisplayViewModeHandler,\n      handleChangeOption,\n      handleFullZoomOut,\n      loader,\n      saveAsHandler,\n      saveAsJSONHandler,\n      saveToClipboardHandler,\n    ],\n  );\n\n  const handleOnKeyDown = useCallback(\n    (e) => {\n      const {\n        highlighted: [activeKey],\n        type,\n      } = highlight;\n      if (\n        !['input', 'textarea'].includes(e.target.localName) &&\n        overDisplayer\n      ) {\n        const num = Number(e.code.substr(e.code.length - 1)) || 0;\n        if (num > 0) {\n          keysPreferencesListenerHandler(e, num);\n        } else {\n          if ([('Escape', 'Esc', 'Backspace')].includes(e.key) && type) {\n            deleteHandler(type, { activeKey });\n          } else {\n            toolsListenerHandler(e);\n          }\n        }\n      }\n    },\n    [\n      deleteHandler,\n      highlight,\n      keysPreferencesListenerHandler,\n      overDisplayer,\n      toolsListenerHandler,\n    ],\n  );\n\n  useEffect(() => {\n    document.addEventListener('keydown', handleOnKeyDown, true);\n\n    return () => document.removeEventListener('keydown', handleOnKeyDown, true);\n  }, [handleOnKeyDown]);\n\n  return null;\n}\n\nexport default KeysListenerTracker;\n","let baseURL = '';\n\nexport function setBaseUrl(newBaseUrl) {\n  baseURL = newBaseUrl;\n}\n\nfunction getHelpList() {\n  return {\n    zoomIn: {\n      text: 'Zoom Tool',\n      filePath: `${baseURL}/help/zoom-and-scale`,\n    },\n    peakPicking: {\n      text: 'peak picking tool',\n      filePath: `${baseURL}/help/peaks`,\n    },\n    integralPicking: {\n      text: 'integral tool',\n      filePath: `${baseURL}/help/integrations`,\n    },\n    fullScreen: {\n      text: 'Full Screen mode',\n      filePath: `${baseURL}/help/general`,\n    },\n    loadSpectrum: {\n      text: 'load spectrums',\n      filePath: `${baseURL}/help/loading-a-spectrum`,\n    },\n  };\n}\nexport default getHelpList;\n","import React from 'react';\n\nimport ToolTip from './ToolTip/ToolTip';\n\nfunction ButtonToolTip({\n  children,\n  style,\n  onClick,\n  popupTitle,\n  popupPlacement,\n  ...props\n}) {\n  return (\n    <ToolTip title={popupTitle} popupPlacement={popupPlacement}>\n      <button style={style} type=\"button\" onClick={onClick} {...props}>\n        {children}\n      </button>\n    </ToolTip>\n  );\n}\n\nButtonToolTip.defaultProps = {\n  popupTitle: '',\n  popupPlacement: 'right',\n  style: {},\n  onClick: () => null,\n  disabled: false,\n};\n\nexport default ButtonToolTip;\n","import React from 'react';\n\nfunction Logo({ width = 100, height = 100 }) {\n  return (\n    <svg\n      style={{ width: width, height: height }}\n      xmlns=\"http://www.w3.org/2000/svg\"\n      viewBox=\"0 0 752.34 221.73\"\n    >\n      <path\n        fill=\"#ea580c\"\n        fillRule=\"evenodd\"\n        d=\"M.64,31.7A31.67,31.67,0,0,1,54.72,9.29l0,0A31.66,31.66,0,0,1,64,31.7V190a13.39,13.39,0,0,0,26.77,0V54a31.7,31.7,0,0,1,31.7-31.7V40.58A13.38,13.38,0,0,0,109.13,54V190a31.71,31.71,0,0,1-63.41,0V31.7a13.29,13.29,0,0,0-3.88-9.46l0,0A13.41,13.41,0,0,0,19,31.7V164.82H.64Z\"\n      />\n      <path\n        fill=\"#2b143e\"\n        fillRule=\"evenodd\"\n        d=\"M154.21,54v68.17a13.34,13.34,0,0,0,3.89,9.47h0A13.39,13.39,0,0,0,181,122.14V99.32h-.06a31.63,31.63,0,0,1,9.29-22.38l0,0a31.65,31.65,0,0,1,44.8,0l0,0a31.58,31.58,0,0,1,9.3,22.39V118H226V99.32a13.3,13.3,0,0,0-3.89-9.46h0a13.44,13.44,0,0,0-18.93,0l0,0a13.3,13.3,0,0,0-3.83,8.19v24.09a31.7,31.7,0,0,1-54.11,22.42v0a31.66,31.66,0,0,1-9.3-22.4V54Z\"\n      />\n      <path\n        fill=\"#2b143e\"\n        fillRule=\"evenodd\"\n        d=\"M729.19,96.34c-8.65,0-14.26,3.17-17.67,8-3.41-5.12-8.78-8-16-8-8.16,0-13.52,3.17-16.32,7.31v-5.6H661V159h18.28V124.62c0-7.19,3.41-11.46,9.5-11.46,5.85,0,8.78,3.9,8.78,10V159h18.27V124.62c0-7.19,3.42-11.46,9.51-11.46,5.85,0,8.77,3.9,8.77,10V159h18.28V121.57C752.34,106.33,743.2,96.34,729.19,96.34Z\"\n      />\n      <path\n        fill=\"#2b143e\"\n        fillRule=\"evenodd\"\n        d=\"M629.26,98.05v33.26c0,8.66-4.63,12.56-11.33,12.56-5.85,0-10.6-3.54-10.6-11.09V98.05H589.05v37.41c0,16.45,10.48,25.22,22.79,25.22,8,0,14.13-2.92,17.42-7.43V159h18.28V98.05Z\"\n      />\n      <rect fill=\"#2b143e\" x=\"558.22\" y=\"98.05\" width=\"18.28\" height=\"60.93\" />\n      <path\n        fill=\"#2b143e\"\n        fillRule=\"evenodd\"\n        d=\"M567.36,92.68a11,11,0,1,0-11-11A11.08,11.08,0,0,0,567.36,92.68Z\"\n      />\n      <path\n        fill=\"#ea580c\"\n        fillRule=\"evenodd\"\n        d=\"M478.77,159H498V116.57L525.66,159H549.2l-22.3-34.75c5.45-2.13,8.12-4.14,11.48-8.86a31.07,31.07,0,0,0,6.07-18.26V94.62c0-10.61-3.45-15.93-9.28-21.78S520.75,63.09,510,63.09H478.71l.06,95.89Zm33.1-50.27h-6.46v-.06H498V82.19h10.87c4.67,0,9.44,1.38,11.94,3.81a12.84,12.84,0,0,1,3.81,9.2C524.58,102.52,518.92,108.71,511.87,108.71Z\"\n      />\n      <polygon\n        fill=\"#ea580c\"\n        fillRule=\"evenodd\"\n        points=\"372.91 60.8 372.91 158.98 392.16 158.98 392.16 119.23 419.91 157.41 447.61 119.23 447.61 158.98 466.87 158.98 466.87 60.8 419.91 125.22 372.91 60.8\"\n      />\n      <polygon\n        fill=\"#ea580c\"\n        fillRule=\"evenodd\"\n        points=\"283.89 61.04 283.89 159.1 303.14 159.1 303.14 105.85 361.01 160.93 361.01 62.83 341.67 62.83 341.67 116.08 283.89 61.04\"\n      />\n    </svg>\n  );\n}\n\nexport default Logo;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useEffect, useState } from 'react';\n\nimport CloseButton from '../elements/CloseButton';\nimport Logo from '../elements/Logo';\n\nasync function getData(url) {\n  try {\n    const response = await fetch(url);\n    return response.json();\n  } catch (e) {\n    return null;\n  }\n}\n\nconst baseUrl = 'https://api.github.com/repos/cheminfo/nmrium';\n\nconst styles = css`\n  display: flex;\n  flex-direction: column;\n  user-select:\n  button:focus {\n    outline: none;\n  }\n  .header {\n    height: 34px;\n    border-bottom: 1px solid #f0f0f0;\n    display: flex;\n    padding: 5px;\n\n    span {\n      color: #464646;\n      font-size: 15px;\n      flex: 1;\n      user-select: none;\n\n    }\n\n    button {\n      background-color: transparent;\n      border: none;\n      svg {\n        height: 16px;\n      }\n    }\n  }\n  .container {\n    width: 100%;\n    height: 100%;\n    padding: 20px;\n  }\n\n  .center-container {\n    width: 100%;\n    height: 100%;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n  }\n  ul {\n    list-style-type: disc;\n    margin-left:20px;\n    }\n  span,li{\n    user-select: text;\n  }\n  span.title {\n    font-weight: bold;\n    color: #ea580c;\n  }\n  span.content {\n    color: #2b143e;\n    font-size: 14px;\n    text-align: left;\n  }\n\n  img {\n    width: 100px;\n  }\n\n  a {\n    color: #969696;\n  }\n\n  a:hover,\n  a:focus {\n    color: #00bcd4;\n  }\n\n  .separator {\n    border-bottom: 1px solid gray;\n    width: 15px;\n    height: 1px;\n    margin: 10px 0px;\n  }\n`;\n\nfunction AboutUsModal({ onClose }) {\n  const [info, setInfo] = useState();\n  useEffect(() => {\n    getData(`${baseUrl}/tags`).then((data) => {\n      setInfo(data);\n    });\n  }, []);\n\n  return (\n    <div css={styles}>\n      <div className=\"header handle\">\n        <span>About Us</span>\n\n        <CloseButton onClick={onClose} />\n      </div>\n      <div className=\"container\">\n        <div className=\"center-container\">\n          <Logo width={160} height={50} />\n          <span> {info && info[0].name}</span>\n\n          <span className=\"separator\" />\n\n          <a href=\"https://git.nmrium.org\" target=\"_blank\" rel=\"noreferrer\">\n            GitHub ( https://git.nmrium.org )\n          </a>\n        </div>\n        <div className=\"center-container\">\n          <span className=\"separator\" />\n          <span className=\"title\">About Us</span>\n          <span className=\"separator\" />\n        </div>\n\n        <span className=\"content\">\n          This project is developed by Zakodium Srl (Switzerland), the\n          University of Cologne (Germany), Johannes Gutenberg University Mainz\n          (Germany) and Universidad del Valle (Colombia).\n        </span>\n        <div className=\"center-container\">\n          <span className=\"separator\" />\n          <span className=\"title\">Funding is provided by</span>\n          <span className=\"separator\" />\n        </div>\n\n        <div className=\"content\">\n          <ul>\n            <li>\n              IDNMR grant, which part of the Scientific Library Services and\n              Information Systems (LIS) initiative of the DFG.\n            </li>\n            <li>Zakodium Srl (Switzerland).</li>\n            <li>Universidad del Valle (Cali, Colombia).</li>\n          </ul>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nAboutUsModal.defaultProps = {\n  onClose: () => {\n    return null;\n  },\n};\nexport default AboutUsModal;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\n\nimport getHelpData from '../constants/help';\nimport CloseButton from '../elements/CloseButton';\n\nconst styles = css`\n  width: 100%;\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  .manual-header {\n    .title {\n      text-align: center;\n      padding: 10px 0 10px 0px;\n      margin: 0px;\n      color: #000000;\n      place-items: normal;\n      text-transform: none;\n      background-color: #fafafa;\n    }\n\n    .close-bt {\n      border: none;\n      color: red;\n      background-color: transparent;\n      outline: none;\n      position: absolute;\n      right: 15px;\n      top: 10px;\n    }\n  }\n  .main-content {\n    width: 100%;\n    height: 100%;\n    border: none;\n    padding-left: 5px;\n  }\n\n  .inner-container {\n    padding: 5px;\n    width: 100%;\n    height: 100%;\n  }\n\n  .tab-content {\n    width: 100%;\n  }\n`;\n\nfunction UserManualModal({ onClose }) {\n  const filePath = getHelpData().loadSpectrum.filePath;\n\n  return (\n    <div css={styles}>\n      <div className=\"manual-header handle\">\n        <h6 className=\"title\">User Manual</h6>\n        <CloseButton onClick={onClose} className=\"close-bt\" />\n      </div>\n      <div className=\"main-content\">\n        <div className=\"inner-container\">\n          <iframe\n            title=\"General User Manual \"\n            src={filePath}\n            frameBorder=\"0\"\n            scrolling=\"auto\"\n            style={{ width: '100%', height: '100%' }}\n          />\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default UserManualModal;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { FaTimes } from 'react-icons/fa';\n\nconst styles = css`\n  border-radius: 50%;\n  width: 16px;\n  height: 16px;\n  background-color: transparent;\n  border: none;\n  padding: 0;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n\n  :hover {\n    background-color: red;\n    border-radius: 50%;\n\n    .icon {\n      color: white;\n    }\n  }\n\n  .icon {\n    color: #252525;\n    width: 8px;\n  }\n`;\n\nfunction DeleteButton({ onDelete, className = 'delete' }) {\n  return (\n    <button css={styles} className={className} type=\"button\" onClick={onDelete}>\n      <FaTimes className=\"icon\" />\n    </button>\n  );\n}\n\nexport default DeleteButton;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport PropTypes from 'prop-types';\nimport { memo, useCallback } from 'react';\n\nimport DeleteButton from './DeleteButton';\n\nconst styles = (styles) => css`\n  position: relative;\n\n  .delete {\n    position: absolute;\n    top: 2px;\n    left: 2px;\n  }\n\n  ${styles}\n`;\n\nfunction Tab({\n  tabid,\n  tablabel,\n  activeTab,\n  onClick,\n  canDelete,\n  onDelete,\n  tabstyles,\n}) {\n  let className = 'tab-list-item';\n\n  // use tab identifier if given (higher priority)\n  if (activeTab === tabid) {\n    className += ' tab-list-active';\n  }\n\n  const clickHandler = useCallback(\n    (e) => {\n      onClick({ ...e, tablabel, tabid });\n    },\n    [onClick, tablabel, tabid],\n  );\n  const deleteHandler = useCallback(\n    (e) => {\n      // stop propagation here to not have set it\n      // as active tab too (via tab click event triggering)\n      e.stopPropagation();\n      onDelete({ ...e, tablabel, tabid });\n    },\n    [onDelete, tablabel, tabid],\n  );\n  return (\n    <li className={className} onClick={clickHandler} css={styles(tabstyles)}>\n      {canDelete && <DeleteButton onDelete={deleteHandler} />}\n      {tablabel}\n    </li>\n  );\n}\n\nTab.propTypes = {\n  activeTab: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n  tablabel: PropTypes.string.isRequired,\n  onClick: PropTypes.func.isRequired,\n  tabid: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n  canDelete: PropTypes.bool,\n};\n\nexport default memo(Tab);\n","export const positions = {\n  TOP: 'TOP',\n  LEFT: 'LEFT',\n};\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport PropTypes from 'prop-types';\nimport {\n  useState,\n  useCallback,\n  useEffect,\n  useMemo,\n  Children,\n  cloneElement,\n  memo,\n} from 'react';\n\nimport Tab from './Tab';\nimport { positions } from './options';\n\nconst topStyles = css`\n  height: 100%;\n  width: 100%;\n  display: flex;\n  flex-direction: column;\n\n  .tab-list {\n    border-bottom: 1px solid #ccc;\n    padding-left: 0;\n    margin: 0;\n  }\n\n  .tab-list li:first-of-type {\n    margin-left: 5px;\n  }\n\n  .tab-list li:hover {\n    background-color: #f7f7f7;\n  }\n\n  .tab-list-item {\n    display: inline-block;\n    list-style: none;\n    margin-bottom: -1px;\n    padding: 0.5rem 2rem;\n  }\n\n  .tab-list-active {\n    background-color: white;\n    border: solid #ccc;\n    border-width: 1px 1px 0 1px;\n  }\n\n  .tab-content {\n    height: 100%;\n    overflow: auto;\n  }\n`;\n\nconst leftStyles = css`\n  display: flex;\n  height: 100%;\n  width: 100%;\n  .tab-list {\n    border-right: 1px solid #ccc;\n    padding-left: 0;\n    margin: 0;\n  }\n\n  .tab-list li:hover {\n    background-color: #f7f7f7;\n  }\n\n  .tab-list li:first-of-type {\n    margin-top: 10px;\n  }\n\n  .tab-list-item {\n    display: block;\n    list-style: none;\n    margin-right: -1px;\n    padding: 0.5rem 0.75rem;\n  }\n\n  .tab-list-active {\n    background-color: white;\n    border: solid #ccc;\n    border-width: 1px 0px 1px 1px;\n  }\n\n  .tab-content {\n    height: 100%;\n    overflow: auto;\n  }\n`;\n\nfunction Tabs({\n  children,\n  onClick,\n  defaultTabID,\n  position,\n  canDelete,\n  onDelete,\n}) {\n  const [activeTab, setActiveTab] = useState();\n\n  useEffect(() => {\n    setActiveTab(defaultTabID);\n  }, [defaultTabID]);\n\n  const onClickTabHandler = useCallback(\n    (tab) => {\n      const { tablabel, tabid } = tab;\n      onClick({ tablabel, tabid });\n      // use tab identifier if given (higher priority)\n      setActiveTab(tabid);\n    },\n    [onClick],\n  );\n\n  const tabs = useMemo(() => {\n    return Children.map(children, (child) => {\n      const { tablabel, tabid, candelete, tabstyles } = child.props;\n      const deleteFlag = candelete\n        ? candelete.toLowerCase() === 'true'\n        : canDelete;\n      return (\n        <Tab\n          activeTab={activeTab}\n          key={tabid}\n          tablabel={tablabel}\n          onClick={onClickTabHandler}\n          tabid={tabid}\n          canDelete={deleteFlag}\n          onDelete={onDelete}\n          tabstyles={tabstyles}\n        />\n      );\n    });\n  }, [activeTab, canDelete, children, onClickTabHandler, onDelete]);\n\n  const tabsContent = useMemo(() => {\n    return Children.map(children, (child) => {\n      const { tabid, style } = child.props;\n      if (tabid !== activeTab) {\n        return cloneElement(child, { style: { display: 'none' } });\n      }\n      return cloneElement(child, {\n        style: { display: 'block', ...style },\n      });\n    });\n  }, [activeTab, children]);\n\n  const styles = useMemo(() => {\n    switch (position) {\n      case positions.TOP:\n        return topStyles;\n      case positions.LEFT:\n        return leftStyles;\n      default:\n        return topStyles;\n    }\n  }, [position]);\n\n  return (\n    <div className=\"tabs\" css={styles}>\n      <ol className=\"tab-list\">{tabs}</ol>\n      <div className=\"tab-content\">{tabsContent}</div>\n    </div>\n  );\n}\n\nTabs.defaultProps = {\n  onClick: () => null,\n  onDelete: () => null,\n  position: 'TOP',\n  canDelete: false,\n};\n\nTabs.propTypes = {\n  children: PropTypes.array.isRequired,\n  onClick: PropTypes.func,\n  position: PropTypes.oneOf(['TOP', 'LEFT']),\n  canDelete: PropTypes.bool,\n  onDelete: PropTypes.func,\n};\n\nexport default memo(Tabs);\n","import { produce } from 'immer';\nimport lodashMerge from 'lodash/merge';\n\nimport {\n  getLocalStorage,\n  removeData,\n  storeData,\n} from '../utility/LocalStorage';\n\nexport const INIT_PREFERENCES = 'INIT_PREFERENCES';\nexport const SET_PREFERENCES = 'SET_PREFERENCES';\nexport const SET_PANELS_PREFERENCES = 'SET_PANELS_PREFERENCES';\nconst LOCAL_STORGAE_VERSION = '1';\nexport const preferencesInitialState = {\n  basePreferences: {},\n  display: {\n    general: {\n      disableMultipletAnalysis: false,\n      hideSetSumFromMolecule: false,\n    },\n\n    panels: {\n      hideSpectraPanel: false,\n      hideInformationPanel: false,\n      hidePeaksPanel: false,\n      hideIntegralsPanel: false,\n      hideRangesPanel: false,\n      hideStructuresPanel: false,\n      hideFiltersPanel: false,\n      hideZonesPanel: false,\n      hideSummaryPanel: false,\n      hideMultipleSpectraAnalysisPanel: false,\n    },\n\n    toolBarButtons: {\n      hideZoomTool: false,\n      hideZoomOutTool: false,\n      hideImport: false,\n      hideExportAs: false,\n      hideSpectraStackAlignments: false,\n      hideSpectraCenterAlignments: false,\n      hideRealImaginary: false,\n      hidePeakTool: false,\n      hideIntegralTool: false,\n      hideAutoRangesTool: false,\n      hideZeroFillingTool: false,\n      hidePhaseCorrectionTool: false,\n      hideBaseLineCorrectionTool: false,\n      hideFFTTool: false,\n      hideMultipleSpectraAnalysisTool: false,\n    },\n  },\n  controllers: {\n    mws: { low: 2, high: 20 },\n    help: {\n      preventAutoHelp: true,\n    },\n    dimmedSpectraTransparency: 0.1,\n  },\n  formatting: {\n    nucleus: [\n      { key: '1H', name: '1H', ppm: '0.00', hz: '0.00' },\n      { key: '13C', name: '13C', ppm: '0.00', hz: '0.00' },\n      { key: '15N', name: '15N', ppm: '0.00', hz: '0.00' },\n      { key: '19F', name: '19F', ppm: '0.00', hz: '0.00' },\n      { key: '29Si', name: '29Si', ppm: '0.00', hz: '0.00' },\n      { key: '31P', name: '31P', ppm: '0.00', hz: '0.00' },\n    ],\n    nucleusByKey: {},\n    panels: {},\n  },\n  dispatch: null,\n};\n\nconst mapNucleus = (draft) => {\n  if (draft.formatting.nucleus && Array.isArray(draft.formatting.nucleus)) {\n    draft.formatting.nucleusByKey = draft.formatting.nucleus.reduce(\n      (acc, item) => {\n        acc[item.name.toLowerCase()] = item;\n        return { ...acc };\n      },\n      {},\n    );\n  }\n};\n\nexport function preferencesReducer(state, action) {\n  switch (action.type) {\n    case INIT_PREFERENCES: {\n      const nmrLocalStorageVersion = getLocalStorage(\n        'nmr-local-storage-version',\n        false,\n      );\n      if (\n        !nmrLocalStorageVersion ||\n        nmrLocalStorageVersion !== LOCAL_STORGAE_VERSION\n      ) {\n        removeData('nmr-general-settings');\n        storeData('nmr-local-storage-version', LOCAL_STORGAE_VERSION);\n      }\n\n      const localData = getLocalStorage('nmr-general-settings');\n\n      return produce(state, (draft) => {\n        if (action.payload) {\n          const { dispatch, ...resPreferences } = action.payload;\n          draft.basePreferences = resPreferences;\n          draft.display = resPreferences.display;\n          draft.dispatch = dispatch;\n          if (localData) {\n            Object.entries(localData).forEach(([k, v]) => {\n              draft[k] = lodashMerge(\n                v,\n                resPreferences[k] ? resPreferences[k] : {},\n              );\n            });\n            mapNucleus(draft, state);\n          }\n        }\n      });\n    }\n    case SET_PREFERENCES:\n      return produce(state, (draft) => {\n        if (action.payload) {\n          const data = action.payload;\n          draft.controllers = data.controllers;\n          draft.formatting = data.formatting;\n          draft.display.panels = data.display.panels;\n          mapNucleus(draft, data);\n        }\n      });\n    case SET_PANELS_PREFERENCES:\n      return produce(state, (draft) => {\n        if (action.payload) {\n          const { key, value } = action.payload;\n          draft.formatting.panels[key] = value;\n        }\n      });\n    default:\n      return state;\n  }\n}\n","import FormikCheckBox from '../../elements/formik/FormikCheckBox';\nimport FormikInput from '../../elements/formik/FormikInput';\n\nfunction ControllersTabContent() {\n  return (\n    <>\n      <p className=\"section-header\">Mouse Scroll Wheel Sensitivity</p>\n      <FormikInput type=\"number\" label=\"Low\" name=\"controllers.mws.low\" />\n      <FormikInput type=\"number\" label=\"high\" name=\"controllers.mws.high\" />\n      <p className=\"section-header\" style={{ marginTop: '40px' }}>\n        Show / Hide Panels\n      </p>\n      <FormikCheckBox\n        className=\"help-checkbox-element\"\n        label=\"Prevent automatic show help \"\n        name=\"controllers.help.preventAutoHelp\"\n      />\n\n      <p className=\"section-header\" style={{ marginTop: '40px' }}>\n        Spectra\n      </p>\n      <FormikInput\n        type=\"number\"\n        label=\"Transparency of Dimmed Spectra [ 0 - 1 ]\"\n        name=\"controllers.dimmedSpectraTransparency\"\n        checkValue={(value) => value >= 0 && value <= 1}\n      />\n    </>\n  );\n}\n\nexport default ControllersTabContent;\n","import lodashGet from 'lodash/get';\n\nimport FormikCheckBox from '../../elements/formik/FormikCheckBox';\n\nconst LIST = [\n  {\n    label: 'Spectra Panel',\n    name: 'display.panels.hideSpectraPanel',\n  },\n  {\n    label: 'Information Panel',\n    name: 'display.panels.hideInformationPanel',\n  },\n  {\n    label: 'Peaks Panel',\n    name: 'display.panels.hidePeaksPanel',\n  },\n  {\n    label: 'Integrals Panel',\n    name: 'display.panels.hideIntegralsPanel',\n  },\n  {\n    label: 'Ranges Panel',\n    name: 'display.panels.hideRangesPanel',\n  },\n  {\n    label: 'Structures Panel',\n    name: 'display.panels.hideStructuresPanel',\n  },\n  {\n    label: 'Filters Panel',\n    name: 'display.panels.hideFiltersPanel',\n  },\n  {\n    label: 'Zones Panel',\n    name: 'display.panels.hideZonesPanel',\n  },\n  {\n    label: 'Summary Panel',\n    name: 'display.panels.hideSummaryPanel',\n  },\n  {\n    label: 'Multiple Spectra Analysis Panel',\n    name: 'display.panels.hideMultipleSpectraAnalysisPanel',\n  },\n];\n\nfunction DisplayTabContent({ preferences }) {\n  return (\n    <>\n      <p className=\"section-header\">Show / Hide Panels</p>\n      {LIST.map(\n        (item) =>\n          !lodashGet(preferences, `basePreferences.${item.name}`, false) && (\n            <FormikCheckBox\n              key={item.name}\n              className=\"checkbox-element\"\n              label={item.label}\n              name={item.name}\n              reverse\n            />\n          ),\n      )}\n    </>\n  );\n}\n\nexport default DisplayTabContent;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useFormikContext } from 'formik';\nimport lodashGet from 'lodash/get';\nimport { Fragment, useCallback, useMemo } from 'react';\nimport { FaPlus } from 'react-icons/fa';\n\nimport generateID from '../../../data/utilities/generateID';\nimport CloseButton from '../../elements/CloseButton';\nimport FormikInput from '../../elements/formik/FormikInput';\n\nconst styles = css`\n  .counter-col {\n    width: 30px;\n  }\n  .nucleus-label-col {\n    display: flex;\n    justify-content: center;\n    width: 80px;\n  }\n\n  .width-100 {\n    width: 100% !important;\n    margin: 0px !important;\n  }\n\n  .nucleus-format-input-col {\n    text-align: center;\n    width: 100px;\n  }\n\n  th {\n    font-size: 11px;\n    font-weight: 600;\n  }\n  .operation-container {\n    display: flex;\n  }\n  .add {\n    background-color: transparent;\n    border: 0;\n    outline: none;\n    svg {\n      font-szie: 14px;\n      fill: green;\n    }\n  }\n`;\nfunction FormattingTabContent() {\n  const { values, setFieldValue } = useFormikContext();\n  const nucleuses = useMemo(() => lodashGet(values, 'formatting.nucleus', []), [\n    values,\n  ]);\n\n  const deleteHandler = useCallback(\n    (index) => {\n      const nucleusesObject = nucleuses.splice(0, index);\n      setFieldValue('formatting.nucleus', nucleusesObject);\n    },\n    [nucleuses, setFieldValue],\n  );\n\n  const addNewNucleusFormatHandler = useCallback(() => {\n    const newFormat = {\n      key: generateID(),\n      name: '',\n      ppm: '0.00',\n      hz: '0.00',\n    };\n    const newNucleuses = [...nucleuses, newFormat];\n    setFieldValue('formatting.nucleus', newNucleuses);\n  }, [nucleuses, setFieldValue]);\n\n  return (\n    <Fragment>\n      <p className=\"section-header\">Formating according to Nucleus</p>\n      <div css={styles}>\n        <table>\n          <thead>\n            <tr>\n              <th className=\"counter-col\">#</th>\n              <th className=\"nucleus-label-col\">Nucleus </th>\n              <th className=\"nucleus-format-input-col\"> (ppm)</th>\n              <th className=\"nucleus-format-input-col\">Coupling (Hz)</th>\n              <th className=\"nucleus-format-input-col\" />\n            </tr>\n          </thead>\n          <tbody>\n            {nucleuses &&\n              nucleuses.map((nucleus, index) => {\n                const num = index + 1;\n                return (\n                  <tr key={`${nucleus.key}`}>\n                    <td className=\"counter-col\">\n                      <span>{num} - </span>{' '}\n                    </td>\n                    <td className=\"nucleus-label-col\">\n                      <FormikInput\n                        name={`formatting.nucleus.${index}.name`}\n                        className=\"width-100\"\n                      />\n                    </td>\n                    <td className=\"nucleus-format-input-col\">\n                      <FormikInput\n                        name={`formatting.nucleus.${index}.ppm`}\n                        className=\"width-100\"\n                      />\n                    </td>\n                    <td className=\"nucleus-format-input-col\">\n                      <FormikInput\n                        name={`formatting.nucleus.${index}.hz`}\n                        className=\"width-100\"\n                      />\n                    </td>\n                    <td className=\"operation-container\">\n                      <CloseButton\n                        onClick={() => deleteHandler(index)}\n                        popupTitle={`remove ${nucleus.name}`}\n                        popupPlacement=\"right\"\n                      />\n                      {nucleuses.length === index + 1 && (\n                        <button\n                          className=\"add\"\n                          type=\"button\"\n                          onClick={addNewNucleusFormatHandler}\n                        >\n                          <FaPlus />\n                        </button>\n                      )}\n                    </td>\n                  </tr>\n                );\n              })}\n          </tbody>\n        </table>\n      </div>\n    </Fragment>\n  );\n}\n\nexport default FormattingTabContent;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback, useRef, useState } from 'react';\n\nimport { usePreferences } from '../../context/PreferencesContext';\nimport CloseButton from '../../elements/CloseButton';\nimport { Tabs } from '../../elements/Tab';\nimport FormikForm from '../../elements/formik/FormikForm';\nimport { SET_PREFERENCES } from '../../reducer/preferencesReducer';\nimport { useStateWithLocalStorage } from '../../utility/LocalStorage';\n\nimport ControllersTabContent from './ControllersTabContent';\nimport DisplayTabContent from './DisplayTabContent';\nimport FormattingTabContent from './FormattingTabContent';\n\nconst styles = css`\n  overflow: auto;\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n\n  .header {\n    text-align: center;\n    padding: 10px 0 10px 0px;\n    margin: 0px;\n    color: #005d9e;\n    place-items: normal;\n    text-transform: none;\n    background-color: #fcfcfc;\n  }\n  .main-content {\n    width: 100%;\n    flex: 1;\n    overflow: auto;\n    border: none;\n  }\n\n  .tab-content {\n    width: 100%;\n  }\n\n  .inner-content {\n    padding: 15px 30px;\n    width: 100%;\n    overflow: auto;\n  }\n\n  button:focus {\n    outline: none;\n  }\n  button:hover {\n    color: #007bff;\n  }\n  .save-button:hover {\n    background-color: #ffffff;\n  }\n  .save-button {\n    border: none;\n    padding: 0 15px;\n    background-color: #ffffff5e;\n    border-radius: 5px;\n    height: 25px;\n  }\n\n  .footer-container {\n    display: flex;\n    align-items: flex-end;\n    justify-content: flex-end;\n    background: rgb(242, 242, 242);\n    background: -moz-linear-gradient(\n      0deg,\n      rgba(242, 242, 242, 1) 0%,\n      rgba(245, 245, 245, 1) 37%,\n      rgba(255, 255, 255, 1) 90%\n    );\n    background: -webkit-linear-gradient(\n      0deg,\n      rgba(242, 242, 242, 1) 0%,\n      rgba(245, 245, 245, 1) 37%,\n      rgba(255, 255, 255, 1) 90%\n    );\n    background: linear-gradient(\n      0deg,\n      rgba(242, 242, 242, 1) 0%,\n      rgba(245, 245, 245, 1) 37%,\n      rgba(255, 255, 255, 1) 90%\n    );\n    filter: progid:DXImageTransform.Microsoft.gradient(startColorstr=\"#f2f2f2\",endColorstr=\"#ffffff\",GradientType=1);\n    padding: 6px 15px;\n    height: 55px;\n  }\n\n  .section-header {\n    font-size: 13px;\n    color: #2ca8ff;\n    margin-bottom: 10px;\n    border-bottom: 0.55px solid #f9f9f9;\n    padding: 6px 2px;\n  }\n\n  .label {\n    font-size: 12px;\n    font-weight: bold;\n    margin-right: 10px;\n  }\n\n  .input {\n    font-size: 14px;\n    border-radius: 5px;\n    border: 1px solid #cccccc;\n    padding: 5px;\n    width: 100px;\n    margin-right: 10px;\n    height: initial !important;\n  }\n\n  .close-bt {\n    border: none;\n    color: red;\n    background-color: transparent;\n    outline: none;\n    position: absolute;\n    right: 10px;\n    top: 2px;\n    width: 30px;\n    height: 30px;\n  }\n\n  .checkbox-lable {\n    min-width: 300px;\n    display: inline-block;\n  }\n\n  .help-checkbox-element {\n    .checkbox-lable {\n      width: 260px;\n    }\n  }\n  .checkbox-element {\n    margin-bottom: 5px;\n  }\n`;\n\nfunction GeneralSettings({ onClose, onSave }) {\n  const [activeTab, setActiveTab] = useState('controllers');\n  const preferences = usePreferences();\n  const [, setSettingsData] = useStateWithLocalStorage('nmr-general-settings');\n  const refForm = useRef();\n\n  const handleSave = useCallback(() => {\n    refForm.current.submitForm();\n  }, []);\n\n  const submitHandler = useCallback(\n    (values) => {\n      // eslint-disable-next-line no-unused-vars\n      const { dispatch, basePreferences, ...resValues } = values;\n      setSettingsData(resValues);\n      preferences.dispatch({ type: SET_PREFERENCES, payload: values });\n      onSave();\n    },\n    [onSave, preferences, setSettingsData],\n  );\n\n  const tabChangeHandler = useCallback((tab) => {\n    setActiveTab(tab.tabid);\n  }, []);\n\n  return (\n    <div css={styles}>\n      <div className=\"header handle\">\n        <span>General Settings</span>\n        <CloseButton onClick={onClose} className=\"close-bt\" />\n      </div>\n      <div className=\"main-content\">\n        <FormikForm\n          ref={refForm}\n          initialValues={preferences}\n          onSubmit={submitHandler}\n        >\n          <Tabs\n            position=\"LEFT\"\n            defaultTabID={activeTab}\n            onClick={tabChangeHandler}\n          >\n            <div\n              className=\"inner-content\"\n              tablabel=\"Controllers\"\n              tabid=\"controllers\"\n            >\n              <ControllersTabContent />\n            </div>\n            <div\n              className=\"inner-content\"\n              tablabel=\"Formatting\"\n              tabid=\"formatting\"\n            >\n              <FormattingTabContent />\n            </div>\n            <div className=\"inner-content\" tablabel=\"Display\" tabid=\"display\">\n              <DisplayTabContent preferences={preferences} />\n            </div>\n          </Tabs>\n        </FormikForm>\n      </div>\n      <div className=\"footer-container\">\n        <button type=\"button\" onClick={handleSave} className=\"save-button\">\n          Save\n        </button>\n      </div>\n    </div>\n  );\n}\n\nexport default GeneralSettings;\n","import PropTypes from 'prop-types';\nimport { forwardRef, useCallback, useRef } from 'react';\n\nconst styles = {\n  container: {\n    display: 'flex',\n  },\n  label: {\n    lineHeight: 2,\n    userSelect: 'none',\n    flex: '2',\n  },\n  inputContainer: {\n    flex: '4',\n    display: 'flex',\n    justifyContent: 'flex-start',\n  },\n  input: {\n    height: '100%',\n    width: '100px',\n    borderRadius: '5px',\n    border: '0.55px solid #c7c7c7',\n    margin: '0px 5px 0px 5px',\n    textAlign: 'center',\n  },\n};\n\nconst NumberInput = forwardRef(function NumberInput(\n  { label, name, defaultValue, style, onChange, onInput, pattern, step, min },\n  ref,\n) {\n  const localRef = useRef();\n  const changeHander = useCallback(\n    (e) => {\n      if (e.target.checkValidity()) {\n        if (e.target.value === '') {\n          onChange({ ...e, target: { ...e.target, value: defaultValue } });\n        } else {\n          onChange(e);\n        }\n      } else {\n        const _ref = ref ? ref : localRef;\n        _ref.current.value = defaultValue;\n      }\n    },\n    [defaultValue, onChange, ref],\n  );\n  return (\n    <div style={{ ...styles.container, ...style.container }}>\n      <span style={{ ...styles.label, ...style.label }}>{label}</span>\n      <div style={{ ...styles.inputContainer, ...style.inputContainer }}>\n        <input\n          ref={ref ? ref : localRef}\n          name={name}\n          style={{ ...styles.input, ...style.input }}\n          type=\"number\"\n          pattern={pattern}\n          defaultValue={defaultValue}\n          step={step}\n          onChange={changeHander}\n          onInput={onInput}\n          min={min}\n          key={defaultValue}\n        />\n      </div>\n    </div>\n  );\n});\n\nNumberInput.propTypes = {\n  pattern: PropTypes.string,\n  label: PropTypes.string,\n  name: PropTypes.string,\n  step: PropTypes.any,\n  min: PropTypes.any,\n  defaultValue: PropTypes.number,\n  style: PropTypes.shape({\n    container: PropTypes.object,\n    label: PropTypes.object,\n    inputContainer: PropTypes.object,\n    input: PropTypes.object,\n  }),\n  onChange: PropTypes.func,\n  onInput: PropTypes.func,\n};\n\nNumberInput.defaultProps = {\n  pattern: '^d*(.d{0,2})?$',\n  step: 'any',\n  min: 'any',\n  style: {\n    label: {},\n    input: {},\n    container: {},\n    inputContainer: {},\n  },\n  defaultValue: 0,\n  onChange: () => {\n    return null;\n  },\n  onInput: () => {\n    return null;\n  },\n};\n\nexport default NumberInput;\n","import { useCallback, useRef } from 'react';\n\nimport { useDispatch } from '../context/DispatchContext';\nimport CheckBox from '../elements/CheckBox';\nimport NumberInput from '../elements/NumberInput';\nimport { AUTO_PEAK_PICKING, RESET_SELECTED_TOOL } from '../reducer/types/Types';\n\nconst styles = {\n  container: {\n    padding: '5px',\n    height: '100%',\n    display: 'flex',\n    fontSize: '12px',\n  },\n  input: {\n    width: '50px',\n  },\n  inputContainer: {\n    flex: '2',\n  },\n  label: {\n    flex: '5',\n  },\n  actionButton: {\n    height: '100%',\n    width: '60px',\n    borderRadius: '5px',\n    border: '0.55px solid #c7c7c7',\n    margin: '0px 5px',\n    userSelect: 'none',\n  },\n};\n\nfunction AutoPeakPickingOptionPanel() {\n  const dispatch = useDispatch();\n  const minMaxRatioRef = useRef();\n  const maxNumberOfPeaksRef = useRef();\n  const noiseFactor = useRef();\n  const lookNegativeRef = useRef();\n\n  const handleApplyFilter = useCallback(() => {\n    dispatch({\n      type: AUTO_PEAK_PICKING,\n      options: {\n        maxNumberOfPeaks: maxNumberOfPeaksRef.current.value,\n        minMaxRatio: minMaxRatioRef.current.value,\n        noiseFactor: noiseFactor.current.value,\n        lookNegative: lookNegativeRef.current.checked,\n      },\n    });\n  }, [dispatch]);\n\n  const handleCancelFilter = useCallback(() => {\n    dispatch({\n      type: RESET_SELECTED_TOOL,\n    });\n  }, [dispatch]);\n\n  return (\n    <div style={styles.container}>\n      <NumberInput\n        ref={maxNumberOfPeaksRef}\n        label=\"Max Number Of Peaks:\"\n        name=\"maxNumberOfPeaks\"\n        style={{\n          input: styles.input,\n          inputContainer: styles.inputContainer,\n          label: styles.label,\n        }}\n        defaultValue={50}\n      />\n      <NumberInput\n        ref={noiseFactor}\n        label=\"Noise factor\"\n        name=\"noiseFactor\"\n        style={{\n          input: styles.input,\n          inputContainer: styles.inputContainer,\n          label: styles.label,\n        }}\n        defaultValue={3}\n      />\n      <NumberInput\n        ref={minMaxRatioRef}\n        label=\"Min Max Ratio:\"\n        name=\"minMaxRatio\"\n        style={{\n          input: styles.input,\n          inputContainer: styles.inputContainer,\n          label: styles.label,\n        }}\n        defaultValue={0.1}\n        step=\"0.01\"\n      />\n\n      <div style={{ justifyItems: 'baseline', marginRight: '3px' }}>\n        <label\n          style={{ marginRight: '2px', lineHeight: 2, userSelect: 'none' }}\n          htmlFor=\"lookNegative\"\n        >\n          Detect Negative:\n        </label>\n        <CheckBox name=\"lookNegative\" ref={lookNegativeRef} />\n      </div>\n\n      <button\n        type=\"button\"\n        style={styles.actionButton}\n        onClick={handleApplyFilter}\n      >\n        Apply\n      </button>\n      <button\n        type=\"button\"\n        style={styles.actionButton}\n        onClick={handleCancelFilter}\n      >\n        Cancel\n      </button>\n    </div>\n  );\n}\n\nexport default AutoPeakPickingOptionPanel;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport PropTypes from 'prop-types';\nimport { forwardRef, useCallback } from 'react';\n\nconst arrowDownIcon = `url('data:image/svg+xml;utf8,<svg  xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\" width=\"960px\" height=\"560px\" viewBox=\"0 0 960 560\" enable-background=\"new 0 0 960 560\" xml:space=\"preserve\"><g id=\"Rounded_Rectangle_33_copy_4_1_\"><path d=\"M480,344.181L268.869,131.889c-15.756-15.859-41.3-15.859-57.054,0c-15.754,15.857-15.754,41.57,0,57.431l237.632,238.937c8.395,8.451,19.562,12.254,30.553,11.698c10.993,0.556,22.159-3.247,30.555-11.698l237.631-238.937c15.756-15.86,15.756-41.571,0-57.431s-41.299-15.859-57.051,0L480,344.181z\"/></g></svg>')`;\n\nconst Select = forwardRef(function Select(\n  { data, style, onChange, defaultValue, name },\n  ref,\n) {\n  const handleOnChanged = useCallback(\n    (e) => {\n      let value = e.target.value;\n      if (!isNaN(value)) {\n        value = Number(value);\n      }\n      onChange(value);\n    },\n    [onChange],\n  );\n\n  const styles = css`\n    padding: 0px 5px;\n    border: 0.55px solid #cacaca;\n    font-size: 14px;\n    width: ${style.width ? style.width - 5 : 115}px;\n    margin: 0;\n    height: 100%;\n    background: ${arrowDownIcon} no-repeat right white;\n    -webkit-appearance: none;\n    background-position-x: ${style.width ? style.width - 18 : 115 - 18}px;\n    background-size: 15px 15px;\n    border-radius: 5px;\n    margin: 0px 5px;\n    :focus,\n    input:focus {\n      outline: none;\n    }\n  `;\n\n  return (\n    <select\n      css={[styles, style]}\n      ref={ref}\n      name={name}\n      onChange={handleOnChanged}\n      defaultValue={defaultValue}\n    >\n      {data.map((d) => (\n        <option key={`${d.key}`} value={d.value}>\n          {d.label}\n        </option>\n      ))}\n    </select>\n  );\n});\n\nSelect.propTypes = {\n  onChange: PropTypes.func,\n  data: PropTypes.array.isRequired,\n  style: PropTypes.any,\n  defaultValue: PropTypes.any,\n  name: PropTypes.string,\n};\n\nSelect.defaultProps = {\n  onChange: function () {\n    return null;\n  },\n  style: { width: 100 },\n  name: '',\n};\n\nexport default Select;\n","import { useCallback, useRef, useState, Fragment } from 'react';\n\nimport { baselineAlgorithms } from '../../data/data1d/filter1d/baselineCorrection';\nimport { useDispatch } from '../context/DispatchContext';\nimport NumberInput from '../elements/NumberInput';\nimport Select from '../elements/Select';\nimport {\n  RESET_SELECTED_TOOL,\n  APPLY_BASE_LINE_CORRECTION_FILTER,\n} from '../reducer/types/Types';\n\nconst styles = {\n  container: {\n    padding: '5px',\n    height: '100%',\n    display: 'flex',\n  },\n  label: {\n    lineHeight: 2,\n    userSelect: 'none',\n  },\n  actionButton: {\n    height: '100%',\n    width: '60px',\n    borderRadius: '5px',\n    border: '0.55px solid #c7c7c7',\n    margin: '0px 5px',\n    userSelect: 'none',\n  },\n};\n\nfunction BaseLineCorrectionPanel() {\n  const dispatch = useDispatch();\n  const algorithmRef = useRef();\n  const maxIterationsRef = useRef();\n  const toleranceRef = useRef();\n  const degreeRef = useRef();\n  const [algorithm, setAlgorithm] = useState('polynomial');\n\n  const handleApplyFilter = useCallback(() => {\n    let options = {};\n    switch (algorithm) {\n      case 'airpls':\n        options = {\n          algorithm: algorithmRef.current.value,\n          maxIterations: maxIterationsRef.current.value,\n          tolerance: toleranceRef.current.value,\n        };\n        break;\n      case 'polynomial':\n        options = {\n          algorithm: algorithmRef.current.value,\n          degree: degreeRef.current.value,\n        };\n        break;\n      default:\n        break;\n    }\n    dispatch({\n      type: APPLY_BASE_LINE_CORRECTION_FILTER,\n      options,\n    });\n  }, [algorithm, dispatch]);\n\n  const handleCancelFilter = useCallback(() => {\n    dispatch({\n      type: RESET_SELECTED_TOOL,\n    });\n  }, [dispatch]);\n\n  const getAlgorithmsList = useCallback(() => {\n    return Object.keys(baselineAlgorithms).map((val) => {\n      return { key: val, label: baselineAlgorithms[val], value: val };\n    });\n  }, []);\n\n  const changeAlgorithmHandler = useCallback((val) => {\n    setAlgorithm(val);\n  }, []);\n\n  return (\n    <div style={styles.container}>\n      <span style={styles.label}>Algorithm: </span>\n      <Select\n        ref={algorithmRef}\n        data={getAlgorithmsList()}\n        style={{ marginLeft: 10, marginRight: 10 }}\n        onChange={changeAlgorithmHandler}\n        defaultValue=\"polynomial\"\n      />\n      {algorithm && algorithm === 'airpls' && (\n        <Fragment>\n          <NumberInput\n            label=\"maxIterations:\"\n            ref={maxIterationsRef}\n            name=\"maxIterations\"\n            defaultValue={100}\n          />\n          <NumberInput\n            label=\"tolerance:\"\n            ref={toleranceRef}\n            name=\"tolerance\"\n            defaultValue={0.001}\n          />\n        </Fragment>\n      )}\n\n      {algorithm && algorithm === 'autoPolynomial' && (\n        <NumberInput\n          label=\"degree:\"\n          ref={degreeRef}\n          name=\"degree\"\n          defaultValue={3}\n        />\n      )}\n\n      {algorithm && algorithm === 'polynomial' && (\n        <NumberInput\n          label=\"degree:\"\n          ref={degreeRef}\n          name=\"degree\"\n          defaultValue={3}\n        />\n      )}\n\n      <button\n        type=\"button\"\n        style={styles.actionButton}\n        onClick={handleApplyFilter}\n      >\n        Apply\n      </button>\n\n      <button\n        type=\"button\"\n        style={styles.actionButton}\n        onClick={handleCancelFilter}\n      >\n        Cancel\n      </button>\n    </div>\n  );\n}\n\nexport default BaseLineCorrectionPanel;\n","import { useCallback } from 'react';\n\nconst styles = {\n  container: {\n    width: '100%',\n    height: '100%',\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'center',\n    border: '0.55px solid #c7c7c7',\n    borderRadius: '5px',\n    userSelect: 'none',\n    backgroundColor: '#18ce0f14',\n    fontSize: '10px',\n    color: '#00801d',\n    margin: '0px 5px',\n    cursor: 'ew-resize',\n  },\n  label: {\n    whiteSpace: 'nowrap',\n    textOverflow: 'ellipsis',\n    overflow: 'hidden',\n    maxWidth: '100%',\n  },\n};\n\nlet stateValues = {\n  step: 'initial',\n};\n\nlet timerId = null;\nlet speedX = 1;\nlet oldX = 0;\nlet firstCalc = true;\nfunction calcSpeed(e) {\n  if (!firstCalc) {\n    speedX = e.clientX - oldX;\n    oldX = e.clientX;\n    setToZero();\n  } else {\n    oldX = e.clientX;\n    firstCalc = false;\n  }\n}\n\nfunction setToZero() {\n  clearTimeout(timerId);\n  timerId = setTimeout(() => {\n    speedX = 0;\n  }, 50);\n}\n\nfunction InputRange({\n  name,\n  minValue,\n  maxValue,\n  value: valueProps,\n  onChange,\n  label,\n  style,\n  className,\n  noPropagation,\n}) {\n  const mouseEnterHandler = useCallback(() => {\n    if (stateValues.step === 'moving' || stateValues.step === 'start') {\n      stateValues = {\n        ...stateValues,\n        step: stateValues.step === 'start' ? 'initial' : 'end',\n      };\n    }\n  }, []);\n\n  const mouseDownHandler = useCallback(\n    (event) => {\n      if (noPropagation) {\n        event.stopPropagation();\n      }\n\n      const boundingRect = event.currentTarget.getBoundingClientRect();\n      const x = event.clientX - boundingRect.x;\n      const y = event.clientY - boundingRect.y;\n      if (stateValues.step === 'initial' || stateValues.step === 'end') {\n        stateValues = {\n          startX: x,\n          startY: y,\n          startScreenX: event.screenX,\n          startScreenY: event.screenY,\n          boundingRect: event.currentTarget.getBoundingClientRect(),\n          step: 'start',\n          clientX: event.clientX,\n          clientY: event.clientY,\n        };\n      }\n\n      return false;\n    },\n    [noPropagation],\n  );\n\n  const mouseMoveCallback = (event) => {\n    if (stateValues.step === 'start' || stateValues.step === 'moving') {\n      const { screenX, screenY } = event;\n      stateValues = {\n        ...stateValues,\n        step: 'moving',\n        endX: stateValues.startX + screenX - stateValues.startScreenX,\n        endY: stateValues.startY + screenY - stateValues.startScreenY,\n      };\n      calcSpeed(event);\n      const valueRange = maxValue - minValue;\n      const positionDiff = stateValues.endX - stateValues.startX;\n      const value =\n        (Math.abs(positionDiff) * (Math.abs(speedX) > 3 ? valueRange : 5)) /\n        stateValues.boundingRect.width;\n\n      onChange({\n        value: speedX >= 0 ? valueProps + Math.abs(value) : valueProps - value,\n        name,\n      });\n    }\n  };\n\n  const mouseUpCallback = () => {\n    if (stateValues.step === 'moving' || stateValues.step === 'start') {\n      stateValues = {\n        ...stateValues,\n        step: stateValues.step === 'start' ? 'initial' : 'end',\n      };\n    }\n  };\n\n  return (\n    <div\n      style={{ ...styles.container, ...style }}\n      className={className}\n      onMouseMove={mouseMoveCallback}\n      onMouseUp={mouseUpCallback}\n      onMouseDown={mouseDownHandler}\n      onMouseEnter={mouseEnterHandler}\n    >\n      <span style={styles.label}>{label}</span>\n    </div>\n  );\n}\n\nInputRange.defaultProps = {\n  name: '',\n  minValue: 0,\n  maxValue: 50,\n  value: 0,\n  onChange: () => {\n    return null;\n  },\n  label: 'Drag to Change the value',\n  noPropagation: true,\n};\n\nexport default InputRange;\n","import { useCallback, useState } from 'react';\n\nimport { useDispatch } from '../context/DispatchContext';\nimport Input from '../elements/Input';\nimport InputRange from '../elements/InputRange';\nimport Select from '../elements/Select';\nimport {\n  APPLY_MANUAL_PHASE_CORRECTION_FILTER,\n  APPLY_AUTO_PHASE_CORRECTION_FILTER,\n  CALCULATE_MANUAL_PHASE_CORRECTION_FILTER,\n  RESET_SELECTED_TOOL,\n  APPLY_ABSOLUTE_FILTER,\n} from '../reducer/types/Types';\n\nconst styles = {\n  container: {\n    padding: '5px',\n    height: '100%',\n    display: 'flex',\n  },\n  input: {\n    width: '100px',\n  },\n  actionButton: {\n    height: '100%',\n    width: '60px',\n    borderRadius: '5px',\n    border: '0.55px solid #c7c7c7',\n    margin: '0px 5px',\n    userSelect: 'none',\n  },\n  select: {\n    marginLeft: '5px',\n    marginRight: '10px',\n    border: 'none',\n    height: '20px',\n  },\n};\n\nconst phaseCorrectionTypes = {\n  manual: 'manual',\n  automatic: 'automatic',\n  absolute: 'absolute',\n};\n\nconst algorithms = [\n  {\n    key: phaseCorrectionTypes.manual,\n    label: 'Manual',\n    value: phaseCorrectionTypes.manual,\n  },\n  {\n    key: phaseCorrectionTypes.automatic,\n    label: 'Automatic',\n    value: phaseCorrectionTypes.automatic,\n  },\n  {\n    key: phaseCorrectionTypes.absolute,\n    label: 'Absolute',\n    value: phaseCorrectionTypes.absolute,\n  },\n];\n\nfunction ManualPhaseCorrectionPanel() {\n  const dispatch = useDispatch();\n  const [value, setValue] = useState({ ph0: 0, ph1: 0, pivotIndex: 1 });\n  const [phaseCorrectionType, setPhaseCorrectionType] = useState(\n    phaseCorrectionTypes.manual,\n  );\n\n  const handleApplyFilter = useCallback(() => {\n    switch (phaseCorrectionType) {\n      case phaseCorrectionTypes.automatic: {\n        dispatch({\n          type: APPLY_AUTO_PHASE_CORRECTION_FILTER,\n        });\n        break;\n      }\n\n      case phaseCorrectionTypes.manual: {\n        dispatch({\n          type: APPLY_MANUAL_PHASE_CORRECTION_FILTER,\n          value: value,\n        });\n        break;\n      }\n      case phaseCorrectionTypes.absolute: {\n        dispatch({\n          type: APPLY_ABSOLUTE_FILTER,\n        });\n        break;\n      }\n      default:\n        break;\n    }\n  }, [dispatch, phaseCorrectionType, value]);\n\n  const handleInput = useCallback(\n    (e) => {\n      const fieldName = e.target.name;\n      if (e.target) {\n        const inputValue = e.target.value;\n\n        setValue((prevValue) => {\n          const _value = {\n            ...prevValue,\n            [fieldName]: inputValue,\n          };\n\n          if (inputValue !== '-') {\n            const newValue = {\n              ...value,\n              [fieldName]: inputValue - prevValue[fieldName],\n            };\n            for (let key in prevValue) {\n              if (prevValue[key] === newValue[key]) {\n                newValue[key] -= prevValue[key];\n              }\n            }\n\n            dispatch({\n              type: CALCULATE_MANUAL_PHASE_CORRECTION_FILTER,\n              value: newValue,\n            });\n          }\n\n          return _value;\n        });\n      }\n    },\n    [dispatch, value],\n  );\n\n  const handleRangeChange = useCallback(\n    (e) => {\n      const _value = { ...value, [e.name]: e.value };\n      let diff = {};\n      for (let key in value) {\n        diff[key] = _value[key] - value[key];\n      }\n      dispatch({\n        type: CALCULATE_MANUAL_PHASE_CORRECTION_FILTER,\n        value: diff,\n      });\n      setValue(_value);\n    },\n    [dispatch, value],\n  );\n\n  const handleCancelFilter = useCallback(() => {\n    dispatch({\n      type: RESET_SELECTED_TOOL,\n    });\n  }, [dispatch]);\n\n  const onChangeHandler = useCallback((val) => {\n    setPhaseCorrectionType(val);\n  }, []);\n\n  return (\n    <div style={styles.container}>\n      <Select\n        onChange={onChangeHandler}\n        data={algorithms}\n        value={phaseCorrectionTypes.manual}\n        style={styles.select}\n      />\n\n      {phaseCorrectionType === phaseCorrectionTypes.manual && (\n        <>\n          <Input\n            label=\"PH0:\"\n            name=\"ph0\"\n            style={{ input: styles.input }}\n            onChange={handleInput}\n            value={value.ph0}\n            type=\"number\"\n          />\n          <Input\n            label=\"PH1:\"\n            name=\"ph1\"\n            style={{ input: styles.input }}\n            onChange={handleInput}\n            value={value.ph1}\n            type=\"number\"\n          />\n\n          <InputRange\n            name=\"ph0\"\n            value={value.ph0}\n            label=\"Change Ph0 By mouse click and drag\"\n            style={{ width: '20%' }}\n            onChange={handleRangeChange}\n          />\n          <InputRange\n            name=\"ph1\"\n            value={value.ph1}\n            label=\"Change Ph1 By mouse click and drag\"\n            style={{ width: '20%' }}\n            onChange={handleRangeChange}\n          />\n        </>\n      )}\n\n      <button\n        type=\"button\"\n        style={styles.actionButton}\n        onClick={handleApplyFilter}\n      >\n        Apply\n      </button>\n      <button\n        type=\"button\"\n        style={styles.actionButton}\n        onClick={handleCancelFilter}\n      >\n        Cancel\n      </button>\n      {/* <button\n        type=\"button\"\n        style={styles.actionButton}\n        onClick={handleAutoFilter}\n      >\n        Auto\n      </button> */}\n    </div>\n  );\n}\n\nexport default ManualPhaseCorrectionPanel;\n","import { useCallback, useRef } from 'react';\n\nimport { useDispatch } from '../context/DispatchContext';\nimport CheckBox from '../elements/CheckBox';\nimport {\n  AUTO_RANGES_DETECTION,\n  RESET_SELECTED_TOOL,\n} from '../reducer/types/Types';\n\nconst styles = {\n  container: {\n    padding: '5px',\n    height: '100%',\n    display: 'flex',\n    fontSize: '12px',\n    alignItems: 'baseline',\n  },\n  input: {\n    height: '100%',\n    width: '50px',\n    borderRadius: '5px',\n    border: '0.55px solid #c7c7c7',\n    margin: '0px 5px 0px 5px',\n    textAlign: 'center',\n  },\n  actionButton: {\n    height: '100%',\n    minWidth: '60px',\n    borderRadius: '5px',\n    border: '0.55px solid #c7c7c7',\n    margin: '0px 5px',\n    userSelect: 'none',\n  },\n  hint: {\n    lineHeight: 2,\n    userSelect: 'none',\n    fontSize: '11px',\n  },\n};\n\nfunction RangesPickingOptionPanel() {\n  const dispatch = useDispatch();\n  const lookNegativeRef = useRef();\n\n  const handleApplyFilter = useCallback(() => {\n    dispatch({\n      type: AUTO_RANGES_DETECTION,\n      options: {\n        peakPicking: {\n          minMaxRatio: 0.05,\n          nH: 100,\n          compile: true,\n          frequencyCluster: 16,\n          clean: true,\n          keepPeaks: true,\n          lookNegative: lookNegativeRef.current.checked,\n        },\n      },\n    });\n  }, [dispatch]);\n\n  const handleCancelFilter = useCallback(() => {\n    dispatch({\n      type: RESET_SELECTED_TOOL,\n    });\n  }, [dispatch]);\n\n  return (\n    <div style={styles.container}>\n      <div style={{ justifyItems: 'baseline', margin: '0 10px' }}>\n        <label\n          style={{ marginRight: '2px', lineHeight: 2, userSelect: 'none' }}\n          htmlFor=\"lookNegative\"\n        >\n          Detect negative:\n        </label>\n        <CheckBox name=\"lookNegative\" ref={lookNegativeRef} />\n      </div>\n      <button\n        type=\"button\"\n        style={styles.actionButton}\n        onClick={handleApplyFilter}\n      >\n        Auto ranges picking\n      </button>\n      <button\n        type=\"button\"\n        style={styles.actionButton}\n        onClick={handleCancelFilter}\n      >\n        Cancel\n      </button>\n      <span style={styles.hint}>\n        Manual selection using SHIFT + select zone or click on Auto peak picking\n      </span>\n    </div>\n  );\n}\n\nexport default RangesPickingOptionPanel;\n","import { useCallback, useRef, useState } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\nimport { useDispatch } from '../context/DispatchContext';\nimport Select from '../elements/Select';\nimport {\n  APPLY_ZERO_FILLING_FILTER,\n  RESET_SELECTED_TOOL,\n} from '../reducer/types/Types';\n\nconst styles = {\n  container: {\n    padding: '5px',\n    height: '100%',\n    display: 'flex',\n  },\n\n  input: {\n    height: '100%',\n    width: '80px',\n    borderRadius: '5px',\n    border: '0.55px solid #c7c7c7',\n    margin: '0px 5px 0px 5px',\n    textAlign: 'center',\n  },\n  actionButton: {\n    height: '100%',\n    width: '60px',\n    borderRadius: '5px',\n    border: '0.55px solid #c7c7c7',\n    margin: '0px 5px',\n    userSelect: 'none',\n  },\n  label: {\n    lineHeight: 2,\n    userSelect: 'none',\n  },\n};\n\nfunction generateSizes(start = 8, end = 21) {\n  let values = [];\n  for (let i = start; i <= end; i++) {\n    const result = 2 ** i;\n    values.push({\n      key: result,\n      label: formatNumber(result),\n      value: result,\n    });\n  }\n  return values;\n}\nfunction formatNumber(number) {\n  if (number >= 1024 * 1024) {\n    return `${number / (1024 * 1024)}M`;\n  } else if (number >= 1024) {\n    return `${number / 1024}K`;\n  } else {\n    return number;\n  }\n}\n\nconst Sizes = generateSizes();\n\nfunction ZeroFillingOptionsPanel() {\n  const dispatch = useDispatch();\n  const { data, activeSpectrum } = useChartData();\n  const sizeTextInputRef = useRef();\n  const [lineBroadeningValue, setLineBroadeningValue] = useState(1);\n\n  const handleApplyFilter = useCallback(() => {\n    dispatch({\n      type: APPLY_ZERO_FILLING_FILTER,\n      value: {\n        zeroFillingSize: Number(sizeTextInputRef.current.value),\n        lineBroadeningValue: lineBroadeningValue,\n      },\n    });\n  }, [dispatch, lineBroadeningValue]);\n\n  const getDefaultValue = useCallback(() => {\n    if (data && activeSpectrum?.id) {\n      return (\n        2 ** Math.round(Math.log2(data[activeSpectrum.index].data.x.length))\n      );\n    }\n    return '';\n  }, [activeSpectrum, data]);\n\n  const handleInput = useCallback(\n    (e) => {\n      if (e.target) {\n        const _value = e.target.validity.valid\n          ? Number(e.target.value)\n          : lineBroadeningValue;\n        setLineBroadeningValue(_value);\n      }\n    },\n    [lineBroadeningValue],\n  );\n\n  const handleCancelFilter = useCallback(() => {\n    dispatch({\n      type: RESET_SELECTED_TOOL,\n    });\n  }, [dispatch]);\n\n  return (\n    <div style={styles.container}>\n      <span style={styles.label}>Size: </span>\n      <Select\n        ref={sizeTextInputRef}\n        data={Sizes}\n        style={{ marginLeft: 10, marginRight: 10 }}\n        defaultValue={getDefaultValue()}\n      />\n      <span style={styles.label}>Line Broadening: </span>\n      <input\n        name=\"line-broadening\"\n        style={styles.input}\n        type=\"number\"\n        defaultValue={lineBroadeningValue}\n        onInput={handleInput}\n        pattern=\"^\\d*(\\.\\d{0,2})?$\"\n        step=\"any\"\n      />\n\n      <button\n        type=\"button\"\n        style={styles.actionButton}\n        onClick={handleApplyFilter}\n      >\n        Apply\n      </button>\n\n      <button\n        type=\"button\"\n        style={styles.actionButton}\n        onClick={handleCancelFilter}\n      >\n        Cancel\n      </button>\n    </div>\n  );\n}\n\nexport default ZeroFillingOptionsPanel;\n","import { useCallback, useRef } from 'react';\n\nimport { useDispatch } from '../context/DispatchContext';\nimport NumberInput from '../elements/NumberInput';\nimport {\n  RESET_SELECTED_TOOL,\n  AUTO_ZONES_DETECTION,\n} from '../reducer/types/Types';\nimport Events from '../utility/Events';\n\nconst styles = {\n  container: {\n    padding: '5px',\n    height: '100%',\n    display: 'flex',\n    fontSize: '12px',\n  },\n  input: {\n    width: '50px',\n  },\n  inputContainer: {\n    flex: '2',\n  },\n  label: {\n    flex: '5',\n  },\n  actionButton: {\n    height: '100%',\n    borderRadius: '5px',\n    border: '0.55px solid #c7c7c7',\n    margin: '0px 5px',\n    userSelect: 'none',\n  },\n};\n\nfunction Zones2DOptionPanel() {\n  const dispatch = useDispatch();\n  const thresholdFactor = useRef();\n\n  const handleApplyFilter = useCallback(() => {\n    dispatch({\n      type: AUTO_ZONES_DETECTION,\n      options: {\n        thresholdFactor: thresholdFactor.current.value,\n      },\n    });\n  }, [dispatch]);\n\n  const handleCancelFilter = useCallback(() => {\n    dispatch({\n      type: RESET_SELECTED_TOOL,\n    });\n  }, [dispatch]);\n\n  const handleInput = useCallback((e) => {\n    if (e.target) {\n      const val = e.target.value;\n      Events.emit('noiseFactorChanged', val);\n    }\n  }, []);\n\n  return (\n    <div style={styles.container}>\n      <NumberInput\n        ref={thresholdFactor}\n        label=\"NoiseFactor\"\n        name=\"noiseFactor\"\n        style={{\n          input: styles.input,\n          inputContainer: styles.inputContainer,\n          label: styles.label,\n        }}\n        defaultValue={1}\n        onChange={handleInput}\n      />\n      <button\n        type=\"button\"\n        style={styles.actionButton}\n        onClick={handleApplyFilter}\n      >\n        Auto Zones Picking\n      </button>\n      <button\n        type=\"button\"\n        style={styles.actionButton}\n        onClick={handleCancelFilter}\n      >\n        Cancel\n      </button>\n    </div>\n  );\n}\n\nexport default Zones2DOptionPanel;\n","/** @jsxImportSource @emotion/react */\n\nimport { css } from '@emotion/react';\nimport { SvgLogoNmrium } from 'cheminfo-font';\nimport { useMemo, useCallback } from 'react';\nimport {\n  FaRegWindowMaximize,\n  FaWrench,\n  FaQuestionCircle,\n} from 'react-icons/fa';\n\nimport { useChartData } from '../context/ChartContext';\nimport Button from '../elements/ButtonToolTip';\nimport { useAlert } from '../elements/popup/Alert';\nimport { useHelp } from '../elements/popup/Help';\nimport { useModal, positions } from '../elements/popup/Modal';\nimport AboutUsModal from '../modal/AboutUsModal';\nimport UserManualModal from '../modal/UserManualModal';\nimport GeneralSettings from '../modal/setting/GeneralSettings';\nimport { options } from '../toolbar/ToolTypes';\n\nimport AutoPeakPickingOptionPanel from './AutoPeakPickingOptionPanel';\nimport BaseLineCorrectionPanel from './BaseLineCorrectionPanel';\nimport ManualPhaseCorrectionPanel from './ManualPhaseCorrectionPanel';\nimport RangesPickingOptionPanel from './RangesPickingOptionPanel';\nimport ZeroFillingOptionsPanel from './ZeroFillingOptionsPanel';\nimport Zones2DOptionPanel from './Zones2DOptionPanel';\n\nconst headerStyle = css`\n  display: flex;\n  align-items: flex-start;\n  justify-content: flex-start;\n  height: 36px;\n  min-height: 36px;\n  border-width: 1px 1px 0px 1px;\n  border-style: solid;\n  border-color: rgb(213, 213, 213);\n  outline: none;\n  transition: background-color 0.2s ease-in 0s;\n  box-shadow: rgb(255, 255, 255) 0px 1px 0px 0px inset;\n  background: linear-gradient(rgb(255, 255, 255) 5%, rgb(246, 246, 246) 100%)\n    rgb(255, 255, 255);\n  color: rgb(102, 102, 102);\n  font-family: Arial;\n  font-weight: bold;\n  text-decoration: none;\n  text-shadow: rgb(255, 255, 255) 0px 1px 0px;\n\n  .toolOptionsPanel {\n    flex: 10;\n    padding: 0px;\n    margin: 0px;\n    height: 100%;\n  }\n\n  .windowButtonsContainer {\n    flex: 0.5;\n    display: flex;\n    align-items: center;\n    justify-content: flex-end;\n    height: 100%;\n  }\n\n  .windowButton {\n    width: 30px;\n    height: 30px;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    background-color: transparent;\n    border: none;\n  }\n  button:focus {\n    outline: 0;\n  }\n`;\n\nfunction Header({ isFullscreen, onMaximize }) {\n  const { selectedOptionPanel } = useChartData();\n  const modal = useModal();\n  const alert = useAlert();\n  const help = useHelp();\n\n  const selectedPanel = useMemo(() => {\n    switch (selectedOptionPanel) {\n      case options.zeroFilling.id:\n        return <ZeroFillingOptionsPanel />;\n      case options.phaseCorrection.id:\n        return <ManualPhaseCorrectionPanel />;\n      case options.peakPicking.id:\n        return <AutoPeakPickingOptionPanel />;\n      case options.rangesPicking.id:\n        return <RangesPickingOptionPanel />;\n      case options.baseLineCorrection.id:\n        return <BaseLineCorrectionPanel />;\n      case options.zone2D.id:\n        return <Zones2DOptionPanel />;\n      default:\n        break;\n    }\n  }, [selectedOptionPanel]);\n\n  const openGeneralSettingsHandler = useCallback(() => {\n    modal.show(\n      <GeneralSettings\n        onSave={() => {\n          alert.success('Settings saved successfully');\n          modal.close();\n        }}\n      />,\n      {\n        position: positions.TOP_CENTER,\n        enableResizing: true,\n        width: 600,\n        height: 400,\n      },\n    );\n  }, [alert, modal]);\n  const openUserManual = useCallback(() => {\n    modal.show(<UserManualModal />, {\n      isBackgroundBlur: false,\n      position: positions.MIDDLE,\n      enableResizing: true,\n      width: 1020,\n      height: 500,\n    });\n  }, [modal]);\n\n  const openAboutUs = useCallback(() => {\n    modal.show(<AboutUsModal />, {\n      isBackgroundBlur: false,\n      position: positions.MIDDLE,\n      width: 500,\n      height: 480,\n    });\n  }, [modal]);\n\n  return (\n    <div css={headerStyle}>\n      <Button\n        popupTitle=\"About Us\"\n        popupPlacement=\"right\"\n        style={{ width: '36px' }}\n        onClick={openAboutUs}\n        className=\"windowButton\"\n      >\n        <SvgLogoNmrium />\n      </Button>\n      <div className=\"toolOptionsPanel\">{selectedPanel}</div>\n      <div className=\"windowButtonsContainer\">\n        <Button\n          popupTitle=\"User Manual\"\n          popupPlacement=\"left\"\n          onClick={openUserManual}\n          className=\"windowButton\"\n        >\n          <FaQuestionCircle />\n        </Button>\n        <Button\n          popupTitle=\"General Settings\"\n          popupPlacement=\"left\"\n          onClick={openGeneralSettingsHandler}\n          className=\"windowButton\"\n        >\n          <FaWrench />\n        </Button>\n        {!isFullscreen ? (\n          <Button\n            popupTitle=\"Full Screen\"\n            popupPlacement=\"left\"\n            onClick={onMaximize}\n            className=\"windowButton\"\n            data-helpid=\"fullScreen\"\n            {...help.onHover}\n          >\n            <FaRegWindowMaximize />\n          </Button>\n        ) : (\n          ''\n        )}\n      </div>\n    </div>\n  );\n}\n\nHeader.defaultProps = {\n  onMaximize: function () {\n    return null;\n  },\n};\n\nexport default Header;\n","export const FILES_TYPES = {\n  MOL: 'mol',\n  NMRIUM: 'nmrium',\n  JSON: 'json',\n  DX: 'dx',\n  JDX: 'jdx',\n  JDF: 'jdf',\n  ZIP: 'zip',\n  NMREDATA: 'nmredata',\n};\nexport const FILES_SIGNATURES = {\n  ZIP: '504b0304',\n};\n\nfunction getFileSignature(fileArrayBuffer) {\n  return new Uint8Array(fileArrayBuffer)\n    .slice(0, 4)\n    .reduce((acc, byte) => (acc += byte.toString(16).padStart(2, '0')), '');\n}\n\nasync function loadFile(file, options = { asBuffer: false }) {\n  const response = await fetch(file);\n  checkStatus(response);\n  const data = (await options.asBuffer)\n    ? response.arrayBuffer()\n    : response.text();\n  return data;\n}\n\nfunction checkStatus(response) {\n  if (!response.ok) {\n    throw new Error(`HTTP ${response.status} - ${response.statusText}`);\n  }\n  return response;\n}\n\nfunction getFileExtension(name) {\n  return name.replace(/^.*\\./, '').toLowerCase();\n}\n\nfunction getFileName(name) {\n  return name.substr(0, name.lastIndexOf('.'));\n}\n\nfunction extractFileMetaFromPath(path) {\n  const meta = path\n    // eslint-disable-next-line no-useless-escape\n    .replace(/^.*[\\\\\\/]/, '')\n    .split('.');\n\n  return { name: meta[0].toLowerCase(), extension: meta[1].toLowerCase() };\n}\n/**\n *\n * @param {Array<File>} acceptedFiles\n * @param {object} options\n * @param {boolean} options.asBuffer\n * @returns\n */\nfunction loadFiles(acceptedFiles, options = {}) {\n  return Promise.all(\n    [].map.call(acceptedFiles, (file) => {\n      return new Promise((resolve, reject) => {\n        const reader = new FileReader();\n        reader.onabort = (e) => reject(e);\n        reader.onerror = (e) => reject(e);\n        reader.onload = () => {\n          if (reader.result) {\n            const binary = reader.result;\n            const name = getFileName(file.name);\n            const extension = getFileExtension(file.name);\n            resolve({ binary, name, extension });\n          }\n        };\n        if (options.asBuffer) {\n          reader.readAsArrayBuffer(file);\n        } else {\n          reader.readAsBinaryString(file);\n        }\n      });\n    }),\n  );\n}\n\nasync function loadFilesFromZip(files, options = {}) {\n  const result = [];\n  for (const file of files) {\n    try {\n      const binary = await file.async(options.asBuffer ? 'uint8array' : 'text');\n      const name = getFileName(file.name);\n      const extension = getFileExtension(file.name);\n      result.push({ binary, name, extension });\n    } catch (e) {\n      // eslint-disable-next-line no-console\n      console.log(e);\n    }\n  }\n  return result;\n}\n\nexport {\n  loadFiles,\n  loadFilesFromZip,\n  loadFile,\n  getFileExtension,\n  getFileName,\n  extractFileMetaFromPath,\n  getFileSignature,\n};\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport Zip from 'jszip';\nimport { useCallback } from 'react';\nimport { useDropzone } from 'react-dropzone';\nimport { FaUpload } from 'react-icons/fa';\n\nimport { useChartData } from '../context/ChartContext';\nimport { useDispatch } from '../context/DispatchContext';\nimport { LoaderProvider } from '../context/LoaderContext';\nimport {\n  LOAD_MOL_FILE,\n  LOAD_JSON_FILE,\n  LOAD_JCAMP_FILE,\n  SET_LOADING_FLAG,\n  LOAD_ZIP_FILE,\n  LOAD_JDF_FILE,\n  LOAD_NMREDATA_FILE,\n} from '../reducer/types/Types';\nimport {\n  FILES_TYPES,\n  FILES_SIGNATURES,\n  getFileExtension,\n  getFileSignature,\n  loadFiles,\n  loadFilesFromZip,\n} from '../utility/FileUtility';\n\nconst style = css`\n  height: 100%;\n  background-color: #b5b5b599;\n  position: absolute;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  flex-flow: column;\n  z-index: 99999;\n\n  p {\n    color: white;\n    background-color: rgb(104, 104, 104);\n    padding: 1.5%;\n    border-radius: 30px;\n    margin: 0px;\n  }\n\n  svg {\n    stroke-width: 0;\n    font-size: 3rem !important;\n    fill: white;\n  }\n`;\n\nconst containerStyle = css`\n  border: 0.55px #e6e6e6 solid;\n  display: flex;\n  flex: 1;\n  flex-direction: 'column';\n  height: 100%;\n`;\n\nfunction DropZone(props) {\n  const { width, height } = useChartData();\n  const dispatch = useDispatch();\n  const loadsubFilesfromZip = useCallback(\n    (extractedfiles, uniqueFileExtensions) => {\n      for (let extension of uniqueFileExtensions) {\n        const selectedFilesByExtensions = extractedfiles.filter(\n          (file) => getFileExtension(file.name) === extension,\n        );\n\n        switch (extension) {\n          case FILES_TYPES.MOL:\n            loadFilesFromZip(selectedFilesByExtensions).then((files) =>\n              dispatch({ type: LOAD_MOL_FILE, files }),\n            );\n            break;\n          case FILES_TYPES.NMRIUM:\n          case FILES_TYPES.JSON:\n            loadFilesFromZip(selectedFilesByExtensions, {\n              asBuffer: true,\n            }).then((files) => {\n              if (selectedFilesByExtensions.length === 1) {\n                const decoder = new TextDecoder('utf8');\n                files[0].binary = decoder.decode(files[0].binary);\n                dispatch({ type: LOAD_JSON_FILE, files });\n              } else {\n                dispatch({ type: SET_LOADING_FLAG, isLoading: false });\n                // eslint-disable-next-line no-alert\n                alert('You can add only one json file');\n              }\n            });\n            break;\n          case FILES_TYPES.JDX:\n          case FILES_TYPES.DX:\n            loadFilesFromZip(selectedFilesByExtensions, {\n              asBuffer: true,\n            }).then((files) => dispatch({ type: LOAD_JCAMP_FILE, files }));\n\n            break;\n          case FILES_TYPES.JDF:\n            loadFilesFromZip(selectedFilesByExtensions, {\n              asBuffer: true,\n            }).then((files) => dispatch({ type: LOAD_JDF_FILE, files }));\n            break;\n          default:\n            break;\n        }\n      }\n    },\n    [dispatch],\n  );\n\n  const loadFilesHandler = useCallback(\n    (files) => {\n      const uniqueFileExtensions = [\n        ...new Set(files.map((file) => getFileExtension(file.name))),\n      ];\n\n      for (let extension of uniqueFileExtensions) {\n        const selectedFilesByExtensions = files.filter(\n          (file) => getFileExtension(file.name) === extension,\n        );\n\n        switch (extension) {\n          case FILES_TYPES.MOL:\n            loadFiles(selectedFilesByExtensions).then(\n              (files) => {\n                dispatch({ type: LOAD_MOL_FILE, files });\n              },\n              (err) => {\n                // eslint-disable-next-line no-alert\n                alert(err);\n              },\n            );\n            break;\n          case FILES_TYPES.NMRIUM:\n          case FILES_TYPES.JSON:\n            if (selectedFilesByExtensions.length === 1) {\n              loadFiles(selectedFilesByExtensions, { asBuffer: true }).then(\n                async (files) => {\n                  const fileSignature = getFileSignature(files[0].binary);\n                  if (fileSignature === FILES_SIGNATURES.ZIP) {\n                    const unzipResult = await Zip.loadAsync(files[0].binary);\n                    loadsubFilesfromZip(Object.values(unzipResult.files), [\n                      FILES_TYPES.NMRIUM,\n                    ]);\n                  } else {\n                    const decoder = new TextDecoder('utf8');\n                    files[0].binary = decoder.decode(files[0].binary);\n                    dispatch({ type: LOAD_JSON_FILE, files });\n                  }\n                },\n                (err) => {\n                  // eslint-disable-next-line no-alert\n                  alert(err);\n                },\n              );\n            } else {\n              // eslint-disable-next-line no-alert\n              alert('You can add only one json file');\n            }\n\n            break;\n          case FILES_TYPES.JDX:\n          case FILES_TYPES.DX:\n            loadFiles(selectedFilesByExtensions, { asBuffer: true }).then(\n              (files) => {\n                dispatch({ type: LOAD_JCAMP_FILE, files });\n              },\n              (err) => {\n                // eslint-disable-next-line no-alert\n                alert(err);\n              },\n            );\n            break;\n          case FILES_TYPES.JDF:\n            loadFiles(selectedFilesByExtensions, { asBuffer: true }).then(\n              (files) => {\n                dispatch({ type: LOAD_JDF_FILE, files });\n              },\n              (err) => {\n                // eslint-disable-next-line no-alert\n                alert(err);\n              },\n            );\n            break;\n          case FILES_TYPES.ZIP:\n            loadFiles(selectedFilesByExtensions, { asBuffer: true }).then(\n              async (files) => {\n                for (const zipFile of files) {\n                  const unzipResult = await Zip.loadAsync(zipFile.binary);\n\n                  const uniqueFileExtensions = [\n                    ...new Set(\n                      Object.values(unzipResult.files).map((file) =>\n                        getFileExtension(file.name),\n                      ),\n                    ),\n                  ];\n                  const isNotZip = uniqueFileExtensions.some(\n                    (ex) =>\n                      FILES_TYPES[ex.toUpperCase()] && ex !== FILES_TYPES.ZIP,\n                  );\n                  if (isNotZip) {\n                    loadsubFilesfromZip(\n                      Object.values(unzipResult.files),\n                      uniqueFileExtensions,\n                    );\n                  } else {\n                    dispatch({ type: LOAD_ZIP_FILE, files });\n                  }\n                }\n              },\n              (err) => {\n                // eslint-disable-next-line no-alert\n                alert(err);\n              },\n            );\n            break;\n          case FILES_TYPES.NMREDATA:\n            loadFiles(selectedFilesByExtensions, { asBuffer: true }).then(\n              async (files) => {\n                for (const zipFile of files) {\n                  dispatch({\n                    type: LOAD_NMREDATA_FILE,\n                    file: zipFile,\n                  });\n                }\n              },\n            );\n            break;\n          default:\n            dispatch({ type: SET_LOADING_FLAG, isLoading: false });\n            // eslint-disable-next-line no-alert\n            alert(\n              'The file extension must be zip, dx, jdx, json, mol, nmredata or nmrium.',\n            );\n            break;\n        }\n      }\n    },\n    [dispatch, loadsubFilesfromZip],\n  );\n\n  const onDrop = useCallback(\n    (droppedFiles) => {\n      dispatch({ type: SET_LOADING_FLAG, isLoading: true });\n      loadFilesHandler(droppedFiles);\n    },\n    [dispatch, loadFilesHandler],\n  );\n\n  const {\n    getRootProps,\n    getInputProps,\n    isDragActive,\n    open: openImportDialog,\n  } = useDropzone({\n    onDrop,\n    noClick: true,\n  });\n\n  const open = useCallback(() => {\n    openImportDialog();\n  }, [openImportDialog]);\n\n  return (\n    <LoaderProvider value={{ open }}>\n      <div {...getRootProps()} css={containerStyle}>\n        <input {...getInputProps()} />\n        {isDragActive && (\n          <div\n            css={style}\n            style={{ width: `${width + 41}px`, height: `${height}px` }}\n          >\n            <FaUpload />\n            <p>Drop your files here</p>\n          </div>\n        )}\n        {props.children}\n      </div>\n    </LoaderProvider>\n  );\n}\n\nexport default DropZone;\n","import { useState, useRef, useEffect, useCallback } from 'react';\n\nlet timer = 0;\nlet delay = 200;\nlet prevent = false;\n\nconst styles = {\n  container: {\n    display: 'flex',\n    flexDirection: 'column',\n    margin: '0px',\n    userSelect: 'none',\n  },\n  button: {\n    cursor: 'pointer',\n    padding: '5px 12px',\n    display: 'flex',\n    alignItems: 'center',\n    fontSize: '11px',\n    border: 'none',\n    outline: 'none',\n    transition: 'background-color 0.2s ease-in',\n\n    boxShadow: 'inset 0px 1px 0px 0px #ffffff',\n    background: 'linear-gradient(to bottom, #f0f0f0 5%, #e1e1e1 100%)',\n    filter:\n      'progid:DXImageTransform.Microsoft.gradient(startColorstr=\"#f0f0f0\", endColorstr=\"#e1e1e1\",GradientType=0)',\n    backgroundColor: '#ffffff',\n    color: '#2d2d2d',\n    fontFamily: 'Arial',\n    fontWeight: 'bold',\n    textDecoration: 'none',\n    textShadow: '0px 1px 0px #ffffff',\n    borderTop: '0.55px  solid #d5d5d5',\n  },\n  buttonTitle: {\n    padding: 0,\n    margin: 0,\n  },\n  content: {\n    backgroundColor: 'white',\n    maxHeight: '0',\n    overflow: 'hidden',\n    flex: '1 1 1px',\n  },\n};\n\nexport const triggerSource = {\n  click: 1,\n  dbClick: 2,\n};\n\nfunction AccordionItem({ title, children, index, isOpen, onOpen, style }) {\n  const [active, setActiveState] = useState(null);\n\n  const refContent = useRef();\n  const refContainer = useRef();\n  const toggleAccordion = useCallback(\n    (e) => {\n      timer = setTimeout(function () {\n        if (!prevent) {\n          onOpen(index, { source: triggerSource.click, shiftKey: e.shiftKey });\n        }\n        prevent = false;\n      }, delay);\n    },\n    [index, onOpen],\n  );\n\n  const dbClickHandler = useCallback(\n    (e) => {\n      e.persist();\n      clearTimeout(timer);\n      prevent = true;\n      onOpen(index, { source: triggerSource.dbClick, shiftKey: e.shiftKey });\n    },\n    [index, onOpen],\n  );\n\n  useEffect(() => {\n    setActiveState(isOpen ? { backgroundColor: '#ccc' } : null);\n  }, [isOpen]);\n\n  return (\n    <div\n      ref={refContainer}\n      style={{\n        ...styles.container,\n        flex: active == null ? 0 : '1 1 1px',\n        transition: isOpen ? 'flex 0.2s ease' : '',\n      }}\n      className=\"custom-accordion\"\n    >\n      <button\n        type=\"button\"\n        style={styles.button}\n        onClick={toggleAccordion}\n        onDoubleClick={dbClickHandler}\n      >\n        <p style={styles.buttonTitle}>{title}</p>\n      </button>\n      <div\n        ref={refContent}\n        style={{\n          ...styles.content,\n          maxHeight: active == null ? 0 : '100%',\n          ...style,\n        }}\n      >\n        {children}\n      </div>\n    </div>\n  );\n}\n\nAccordionItem.defaultProps = {\n  onOpen: function () {\n    return null;\n  },\n};\n\nexport default AccordionItem;\n","import {\n  useState,\n  useRef,\n  useCallback,\n  useMemo,\n  useEffect,\n  Children,\n  cloneElement,\n} from 'react';\n\nimport { triggerSource } from './AccordionItem';\n\nconst styles = {\n  container: {\n    height: '100%',\n    width: '100%',\n    display: 'flex',\n    flexDirection: 'column',\n  },\n};\nlet forcedOpenedElements = [];\nlet alwaysOpen = null;\nfunction Accordion({ children, defaultOpenIndex = 0 }) {\n  const [elements, setElements] = useState([]);\n  const refContainer = useRef();\n\n  const handleOpen = useCallback(\n    (index, trigger) => {\n      let el = elements.slice();\n      if (trigger.source === triggerSource.click) {\n        el = el.map((e, i) => (i === index && alwaysOpen !== index ? !e : e));\n      } else {\n        el = el.map((e, i) => (i === index ? true : false));\n        if (trigger.shiftKey) {\n          if (alwaysOpen === index) {\n            alwaysOpen = null;\n          } else {\n            alwaysOpen = index;\n          }\n        } else {\n          alwaysOpen = null;\n        }\n      }\n\n      forcedOpenedElements = el;\n      setElements(el);\n    },\n    [elements],\n  );\n\n  const mappedChildren = useMemo(() => {\n    return Children.map(children, (child, index) => {\n      return (\n        child &&\n        cloneElement(child, {\n          onOpen: handleOpen,\n          index,\n          isOpen: elements && elements[index],\n        })\n      );\n    });\n  }, [children, elements, handleOpen]);\n\n  useEffect(() => {\n    if (defaultOpenIndex != null) {\n      setElements((prevState) => {\n        if (prevState.length > 0) {\n          return prevState.map((e, i) =>\n            !forcedOpenedElements[i]\n              ? i === defaultOpenIndex\n                ? true\n                : false\n              : e,\n          );\n        }\n        forcedOpenedElements = Array(children.length)\n          .fill(false)\n          .map((e) => e);\n\n        return Array(children.length)\n          .fill(false)\n          .map((e, i) => (i === defaultOpenIndex ? true : e));\n      });\n    }\n  }, [children.length, defaultOpenIndex]);\n\n  return (\n    <div ref={refContainer} style={styles.container}>\n      {mappedChildren}\n    </div>\n  );\n}\n\nexport default Accordion;\n","import { css } from '@emotion/react';\n\nconst HighlightedRowStyle = css`\n  background-color: #ff6f0057;\n`;\n\nconst ConstantlyHighlightedRowStyle = css`\n  background-color: #f5f5dc;\n`;\n\nconst ReactTableStyle = css`\n  border-spacing: 0;\n  border: 1px solid #dedede;\n  width: 100%;\n  // height: 100%;\n  font-size: 12px;\n\n  .react-contextmenu-wrapper {\n    display: contents;\n  }\n\n  tr {\n    :last-child {\n      td {\n        border-bottom: 0;\n      }\n    }\n  }\n\n  th {\n    position: sticky;\n    background-color: white;\n    z-index: 2;\n    top: 0;\n  }\n  th,\n  td {\n    margin: 0;\n    padding: 0.15rem 0.4rem;\n    border-bottom: 1px solid #dedede;\n    border-right: 1px solid #dedede;\n\n    :last-child {\n      border-right: 0;\n    }\n    button {\n      background-color: transparent;\n      border: none;\n    }\n  }\n`;\n\nexport { ReactTableStyle, HighlightedRowStyle, ConstantlyHighlightedRowStyle };\n","/** @jsxImportSource @emotion/react */\n\nimport { memo } from 'react';\nimport { useTable, useSortBy, useFlexLayout } from 'react-table';\n\nimport { ReactTableStyle } from './Style';\n\nfunction ReactTableFlexLayout({ data, columns, onMouseDown }) {\n  const {\n    getTableProps,\n    getTableBodyProps,\n    headerGroups,\n    rows,\n    prepareRow,\n  } = useTable(\n    {\n      columns,\n      data,\n    },\n    useSortBy,\n    useFlexLayout,\n  );\n  return (\n    <table {...getTableProps()} css={ReactTableStyle}>\n      <thead>\n        {headerGroups.map((headerGroup) => (\n          <tr\n            key={headerGroup.getHeaderGroupProps().key}\n            {...headerGroup.getHeaderGroupProps()}\n          >\n            {headerGroup.headers.map((column) => (\n              <th\n                key={column.getHeaderProps().key}\n                {...column.getHeaderProps(column.getSortByToggleProps())}\n              >\n                {column.render('Header')}\n                <span>\n                  {column.isSorted ? (column.isSortedDesc ? ' ' : ' ') : ''}\n                </span>\n              </th>\n            ))}\n          </tr>\n        ))}\n      </thead>\n      <tbody\n        {...getTableBodyProps()}\n        style={{ display: 'block', height: '100%', overflowY: 'auto' }}\n      >\n        {rows.map((row) => {\n          prepareRow(row);\n          return (\n            <tr\n              key={row.getRowProps().key}\n              {...row.getRowProps()}\n              onMouseDown={onMouseDown}\n            >\n              {row.cells.map((cell) => {\n                return (\n                  <td\n                    key={cell.getCellProps().key}\n                    {...cell.getCellProps()}\n                    style={{ ...cell.getCellProps().style, padding: '0px' }}\n                  >\n                    {cell.render('Cell')}\n                  </td>\n                );\n              })}\n            </tr>\n          );\n        })}\n      </tbody>\n    </table>\n  );\n}\n\nReactTableFlexLayout.defaultProps = {\n  onMouseDown: () => {\n    return null;\n  },\n};\n\nexport default memo(ReactTableFlexLayout);\n","import { forwardRef, useMemo } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\n\nfunction InfoWrapper(WrappedComponent) {\n  const Wrapper = (props) => {\n    const { data, activeSpectrum } = useChartData();\n\n    const { info = {}, meta = {} } = useMemo(() => {\n      if (data && activeSpectrum && activeSpectrum.id) {\n        const datum = data.find((datum) => datum.id === activeSpectrum.id) || {\n          info: {},\n          meta: {},\n        };\n        return datum;\n      }\n      return {};\n    }, [activeSpectrum, data]);\n\n    const { forwardedRef, ...rest } = props;\n    return (\n      <WrappedComponent {...rest} info={info} meta={meta} ref={forwardedRef} />\n    );\n  };\n\n  return forwardRef((props, ref) => {\n    return <Wrapper {...props} forwardedRef={ref} />;\n  });\n}\nexport default InfoWrapper;\n","import { useState, useCallback, useEffect, memo, useMemo, useRef } from 'react';\n\nimport ReactTableFlexLayout from '../elements/ReactTable/ReactTableFlexLayout';\nimport InfoWrapper from '../hoc/InfoWrapper';\n\nconst styles = {\n  container: {\n    height: '100%',\n  },\n  tableContainer: {\n    height: 'calc(100% - 30px)',\n    overflow: 'auto',\n    display: 'block',\n  },\n\n  searchInput: {\n    width: '100%',\n    borderRadius: '5px',\n    border: '0.55px solid gray',\n    padding: '5px',\n    marginBottom: '2px',\n  },\n};\n\n// information panel\nfunction InformationPanel({ info, meta }) {\n  const [information, setInformation] = useState({});\n  const [matches, setMatchesData] = useState([]);\n  const searchRef = useRef();\n\n  const handleSearch = useCallback(\n    (e) => {\n      const values = Object.keys(information).filter((key) =>\n        key\n          .toLowerCase()\n          .includes(e.target ? e.target.value.toLowerCase() : e.toLowerCase()),\n      );\n      setMatchesData(values);\n    },\n    [information],\n  );\n\n  useEffect(() => {\n    if (searchRef.current) {\n      handleSearch(searchRef.current.value);\n    }\n  }, [handleSearch, searchRef]);\n\n  useEffect(() => {\n    if (info && meta) {\n      const keys = Object.keys(info).concat(Object.keys(meta));\n      setMatchesData(keys);\n      setInformation({\n        ...info,\n        ...meta,\n      });\n    }\n  }, [info, meta]);\n\n  const columns = useMemo(\n    () => [\n      {\n        Header: 'Parameter',\n        sortType: 'basic',\n        minWidth: 100,\n        width: 20,\n        maxWidth: 20,\n        Cell: ({ row }) => (\n          <p style={{ padding: '5px', backgroundColor: 'white' }}>\n            {row.original}\n          </p>\n        ),\n      },\n      {\n        Header: 'Value',\n        sortType: 'basic',\n        resizable: true,\n        Cell: ({ row }) => (\n          <p\n            style={{\n              backgroundColor: '#efefef',\n              height: '100%',\n              padding: '5px',\n              fontFamily: 'monospace',\n              whiteSpace: 'pre',\n              overflow: 'hidden',\n            }}\n          >\n            {information[row.original].toString()}\n          </p>\n        ),\n      },\n    ],\n    [information],\n  );\n\n  return (\n    <div style={styles.container}>\n      <div>\n        <input\n          type=\"text\"\n          style={styles.searchInput}\n          placeholder=\"Search for parameter...\"\n          onChange={handleSearch}\n          ref={searchRef}\n        />\n      </div>\n      <div style={styles.tableContainer}>\n        <ReactTableFlexLayout data={matches} columns={columns} />\n      </div>\n    </div>\n  );\n}\n\nexport default InfoWrapper(memo(InformationPanel));\n","import { forwardRef, useMemo } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\nimport { usePreferences } from '../context/PreferencesContext';\n\nfunction IntegralsWrapper(WrappedComponent) {\n  const Wrapper = (props) => {\n    const {\n      data,\n      activeSpectrum,\n      xDomain,\n      activeTab,\n      tabActiveSpectrum,\n      molecules,\n    } = useChartData();\n    const preferences = usePreferences();\n\n    const { integrals = {}, info = {} } = useMemo(() => {\n      if (data && activeSpectrum && activeSpectrum.id) {\n        const datum = data.find((datum) => datum.id === activeSpectrum.id) || {\n          integrals: {},\n          info: {},\n        };\n        return datum;\n      }\n      return {};\n    }, [activeSpectrum, data]);\n\n    const nucleus = useMemo(() => {\n      if (tabActiveSpectrum && Object.keys(tabActiveSpectrum).length > 0) {\n        return Object.keys(tabActiveSpectrum);\n      }\n      return null;\n    }, [tabActiveSpectrum]);\n\n    const { forwardedRef, ...rest } = props;\n    return (\n      <WrappedComponent\n        {...rest}\n        integrals={integrals}\n        info={info}\n        xDomain={xDomain}\n        preferences={preferences}\n        activeTab={activeTab}\n        nucleus={nucleus}\n        molecules={molecules}\n        ref={forwardedRef}\n      />\n    );\n  };\n\n  return forwardRef((props, ref) => {\n    return <Wrapper {...props} forwardedRef={ref} />;\n  });\n}\nexport default IntegralsWrapper;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useRef, useCallback } from 'react';\n\nimport CloseButton from '../../elements/CloseButton';\n\nconst styles = css`\n  display: flex;\n  flex-direction: column;\n  width: 450px;\n  padding: 5px;\n  button:focus {\n    outline: none;\n  }\n  .header {\n    height: 24px;\n    border-bottom: 1px solid #f0f0f0;\n    display: flex;\n    span {\n      color: #464646;\n      font-size: 15px;\n      flex: 1;\n    }\n\n    button {\n      background-color: transparent;\n      border: none;\n      svg {\n        height: 16px;\n      }\n    }\n  }\n  .container {\n    display: flex;\n    margin: 30px 5px;\n    input,\n    button {\n      padding: 5px;\n      border: 1px solid gray;\n      border-radius: 5px;\n      height: 36px;\n      margin: 2px;\n    }\n    input {\n      flex: 10;\n    }\n    button {\n      flex: 2;\n      color: white;\n      background-color: gray;\n    }\n  }\n`;\n\nfunction NumberInput({ onSave, onClose, header }) {\n  const valueReft = useRef();\n\n  const saveHandler = useCallback(() => {\n    onSave(valueReft.current.value);\n  }, [onSave]);\n\n  const handleKeyDown = useCallback(\n    (event) => {\n      if (event.key === 'Enter') {\n        onSave(valueReft.current.value);\n      }\n    },\n    [onSave],\n  );\n\n  return (\n    <div css={styles}>\n      <div className=\"header handle\">\n        <span>{header}</span>\n\n        <CloseButton onClick={onClose} />\n      </div>\n      <div className=\"container\">\n        <input\n          ref={valueReft}\n          type=\"number\"\n          placeholder=\"Enter the new value\"\n          onKeyDown={handleKeyDown}\n        />\n        <button type=\"button\" onClick={saveHandler}>\n          Set\n        </button>\n      </div>\n    </div>\n  );\n}\n\nNumberInput.defaultProps = {\n  onSave: () => {\n    return null;\n  },\n  onClose: () => {\n    return null;\n  },\n};\nexport default NumberInput;\n","/** @jsxImportSource @emotion/react */\n\nimport { css } from '@emotion/react';\nimport {\n  useState,\n  Children,\n  useMemo,\n  useEffect,\n  useCallback,\n  memo,\n} from 'react';\nimport { FaAngleLeft } from 'react-icons/fa';\nimport { useMeasure } from 'react-use';\n\nfunction Arrow({ direction, onClick }) {\n  return (\n    <div\n      onClick={onClick}\n      css={css`\n        display: flex;\n        position: absolute;\n        top: calc(50% - 18px);\n        ${direction === 'right' ? `right: 25px` : `left: 25px`};\n        height: 36px;\n        width: 36px;\n        justify-content: center;\n        background: white;\n        border-radius: 50%;\n        cursor: pointer;\n        align-items: center;\n        border: none;\n        transition: transform ease-in 0.1s;\n        &:hover {\n          transform: scale(1.2);\n          background-color: #607d8b;\n          color: white;\n        }\n        img {\n          transform: translateX(${direction === 'left' ? '-2' : '2'}px);\n          &:focus {\n            outline: 0;\n          }\n        }\n      `}\n    >\n      <FaAngleLeft\n        style={{ transform: `scaleX(${direction === 'right' ? '-1' : '1'})` }}\n      />\n    </div>\n  );\n}\n\nconst transition = 0.45;\n\nfunction NextPrev({ children, loop, defaultIndex, onChange }) {\n  const [ref, { width }] = useMeasure();\n  const [activeIndex, setActiveIndex] = useState(0);\n  useEffect(() => {\n    setActiveIndex(defaultIndex);\n  }, [defaultIndex]);\n\n  const Sliders = useMemo(\n    () =>\n      Children.map(children, (child) => {\n        return (\n          <div\n            key={child.key}\n            css={css`\n              width: ${width}px;\n              height: 100%;\n            `}\n          >\n            {child}\n          </div>\n        );\n      }),\n    [children, width],\n  );\n\n  const nextHandler = useCallback(() => {\n    setActiveIndex((preActiveIndex) => {\n      if (preActiveIndex === Sliders.length - 1) {\n        onChange(preActiveIndex);\n\n        if (loop) {\n          return 0;\n        } else {\n          return preActiveIndex;\n        }\n      }\n\n      const nextIndex = preActiveIndex + 1;\n      onChange(nextIndex);\n\n      return nextIndex;\n    });\n  }, [Sliders.length, loop, onChange]);\n\n  const prevHandler = useCallback(() => {\n    setActiveIndex((preActiveIndex) => {\n      if (preActiveIndex === 0) {\n        onChange(preActiveIndex);\n        if (loop) {\n          return 0;\n        } else {\n          return preActiveIndex;\n        }\n      }\n      const prevIndex = preActiveIndex - 1;\n\n      onChange(prevIndex);\n\n      return prevIndex;\n    });\n  }, [loop, onChange]);\n\n  if (!width && !Sliders) return null;\n  return (\n    <div\n      css={css`\n        position: relative;\n        height: 100%;\n        width: 100%;\n        margin: 0 auto;\n        overflow: hidden;\n        display: block;\n      `}\n      ref={ref}\n    >\n      <div\n        css={css`\n          transform: translateX(-${width * activeIndex}px);\n          transition: transform ease-out ${transition}s;\n          height: 100%;\n          width: ${width * Sliders.length}px;\n          display: flex;\n        `}\n      >\n        {Sliders}\n      </div>\n\n      {activeIndex !== 0 && <Arrow direction=\"left\" onClick={prevHandler} />}\n      {activeIndex !== Sliders.length - 1 && (\n        <Arrow direction=\"right\" onClick={nextHandler} />\n      )}\n    </div>\n  );\n}\n\nNextPrev.defaultProps = {\n  loop: false,\n  defaultIndex: 0,\n  onChange: () => null,\n};\nexport default memo(NextPrev);\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback, useEffect, useState } from 'react';\nimport MF from 'react-mf/lib/components/MF';\nimport { MolfileSvgRenderer } from 'react-ocl/full';\n\nimport NextPrev from './NextPrev';\n\nconst toolbarStyle = css`\n  display: flex;\n  flex-direction: row;\n  border-top: 0.55px solid rgb(240, 240, 240);\n  border-bottom: 0.55px solid rgb(240, 240, 240);\n  padding: 0px 5px;\n\n  p {\n    margin: 0;\n    text-align: right;\n    width: 100%;\n    line-height: 22px;\n    padding: 0px 10px;\n  }\n`;\n\nconst moleculeContainerStyle = css`\n  width: 100%;\n  position: relative;\n  .slider {\n    height: 180px;\n    width: 100%;\n    padding: 0px;\n    padding: 0px;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    flex-direction: column;\n  }\n  .slider p {\n    width: 100%;\n    margin: 0 auto;\n    display: block;\n    position: relative;\n    text-align: center;\n  }\n  .slider svg polygon {\n    fill: gray !important;\n  }\n  button {\n    flex: 2;\n    padding: 5px;\n    border: 1px solid gray;\n    border-radius: 5px;\n    height: 36px;\n    margin: 0 auto;\n    margin-top: 15px;\n    display: block;\n    width: 20%;\n\n    color: white;\n    background-color: gray;\n  }\n`;\n\nfunction MoleculeSelection({ molecules, onChange }) {\n  const [currentIndex, setCurrentIndex] = useState();\n\n  useEffect(() => {\n    if (molecules && molecules.length > 0) {\n      setCurrentIndex(0);\n    }\n  }, [molecules]);\n\n  const onChangeHandler = useCallback(\n    (slideIndex) => {\n      setCurrentIndex(slideIndex);\n      onChange(slideIndex);\n    },\n    [onChange],\n  );\n\n  return (\n    <div>\n      <div css={toolbarStyle}>\n        <p>\n          {molecules &&\n            molecules.length > 0 &&\n            `${+(currentIndex + 1)} / ${molecules.length}`}{' '}\n        </p>\n      </div>\n      <div css={moleculeContainerStyle}>\n        <NextPrev onChange={onChangeHandler}>\n          {molecules &&\n            molecules.map((mol, index) => (\n              <div key={mol.key} className=\"slider\">\n                <div>\n                  <MolfileSvgRenderer\n                    id={`molSVG${index}`}\n                    width={120}\n                    molfile={mol.molfile}\n                  />\n                </div>\n                <p>\n                  <MF mf={mol.mf} /> - {mol.mw.toFixed(2)}\n                </p>\n              </div>\n            ))}\n        </NextPrev>\n      </div>\n    </div>\n  );\n}\n\nMoleculeSelection.defaultProps = {\n  onChange: () => {\n    return null;\n  },\n};\n\nexport default MoleculeSelection;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback, useState, useEffect, useMemo } from 'react';\n\nimport { usePreferences } from '../../context/PreferencesContext';\nimport MoleculeSelection from '../../elements/MoleculeSelection';\n\nconst selectMoleculeContainerStyle = css`\n  display: flex;\n  flex-direction: column;\n  flex-grow: 1;\n`;\n\nconst optionalTextStyle = css`\n  display: flex;\n  flex-direction: column;\n  padding: 5px;\n\n  .optional {\n    margin-top: 5px;\n    margin-bottom: 5px;\n    padding: 0px 10px;\n\n    text-align: center;\n    font-size: 18px;\n    font-weight: bold;\n  }\n  .optional2 {\n    margin-top: 5px;\n    margin-bottom: 25px;\n    padding: 0px 10px;\n    width: 100%;\n\n    text-align: center;\n  }\n`;\n\nconst moleculeContainerStyle = css`\n  button {\n    flex: 2;\n    padding: 5px;\n    border: 1px solid gray;\n    border-radius: 5px;\n    height: 36px;\n    margin: 0 auto;\n    margin-top: 15px;\n    display: block;\n    width: 20%;\n\n    color: white;\n    background-color: gray;\n  }\n\n  .newSumText {\n    margin-top: 15px;\n    padding: 0px 10px;\n    width: 100%;\n\n    text-align: center;\n  }\n`;\n\nfunction SelectMolecule({ onSave, molecules, element }) {\n  const [currentIndex, setCurrentIndex] = useState();\n  const {\n    display: { general, panels },\n  } = usePreferences();\n\n  const newSum = useMemo(() => {\n    return element &&\n      molecules &&\n      molecules.length > 0 &&\n      currentIndex !== undefined &&\n      molecules[currentIndex].atoms[element]\n      ? molecules[currentIndex].atoms[element]\n      : 0;\n  }, [currentIndex, element, molecules]);\n\n  useEffect(() => {\n    if (molecules && molecules.length > 0) {\n      setCurrentIndex(0);\n    }\n  }, [molecules]);\n\n  const saveSelectMoleculeHandler = useCallback(\n    (e) => {\n      e.preventDefault();\n      onSave(newSum);\n    },\n    [newSum, onSave],\n  );\n\n  const onChangeMoleculeSelectionHandler = useCallback((index) => {\n    setCurrentIndex(index);\n  }, []);\n\n  return !general.hideSetSumFromMolecule &&\n    !panels.hideStructuresPanel &&\n    element &&\n    molecules &&\n    molecules.length > 0 ? (\n    <div css={selectMoleculeContainerStyle}>\n      <div css={optionalTextStyle}>\n        <p className=\"optional\">OR</p>\n        <p className=\"optional2\">Select a molecule as reference!</p>\n      </div>\n      <div css={moleculeContainerStyle}>\n        <MoleculeSelection\n          molecules={molecules}\n          onChange={onChangeMoleculeSelectionHandler}\n        />\n        <button type=\"button\" onClick={saveSelectMoleculeHandler}>\n          Set\n        </button>\n        <p className=\"newSumText\">\n          New sum for {element} will be {newSum}!\n        </p>\n      </div>\n    </div>\n  ) : null;\n}\n\nSelectMolecule.defaultProps = {\n  onSave: () => {\n    return null;\n  },\n};\nexport default SelectMolecule;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback } from 'react';\n\nimport NumberInput from './NumberInput';\nimport SelectMolecule from './SelectMolecule';\n\nconst modalContainer = css`\n  display: flex;\n  flex-direction: column;\n  padding: 5px;\n`;\n\nfunction ChangeSumModal({ onSave, onClose, header, molecules, element }) {\n  const saveInputValueHandler = useCallback(\n    (inputValue) => {\n      onSave(inputValue);\n    },\n    [onSave],\n  );\n\n  const saveSelectMoleculeHandler = useCallback(\n    (sum) => {\n      onSave(sum);\n    },\n    [onSave],\n  );\n\n  return (\n    <div css={modalContainer}>\n      <NumberInput\n        onSave={saveInputValueHandler}\n        onClose={onClose}\n        header={header}\n      />\n\n      <SelectMolecule\n        onSave={saveSelectMoleculeHandler}\n        molecules={molecules}\n        element={element}\n      />\n    </div>\n  );\n}\n\nChangeSumModal.defaultProps = {\n  onSave: () => {\n    return null;\n  },\n  onClose: () => {\n    return null;\n  },\n};\nexport default ChangeSumModal;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { memo, useCallback, useState } from 'react';\n\nimport ToolTip from './ToolTip/ToolTip';\n\nconst styles = css`\n  background-color: transparent;\n  border: none;\n  border-radius: 5px;\n\n  &:hover {\n    background-color: lightgray;\n  }\n\n  &.toggle-active {\n    background-color: gray;\n    color: white;\n  }\n`;\n\nfunction ToggleButton({\n  children,\n  style,\n  onClick,\n  popupTitle,\n  popupPlacement,\n  defaultValue,\n  disabled,\n}) {\n  const [flag, Toggle] = useState(defaultValue);\n\n  const toggleHandler = useCallback(() => {\n    onClick(!flag);\n\n    Toggle(!flag);\n  }, [onClick, flag]);\n  return (\n    <ToolTip title={popupTitle} popupPlacement={popupPlacement}>\n      <button\n        disabled={disabled}\n        css={styles}\n        style={style}\n        className={flag ? 'toogle toggle-active' : 'toggle'}\n        type=\"button\"\n        onClick={toggleHandler}\n      >\n        {children}\n      </button>\n    </ToolTip>\n  );\n}\n\nToggleButton.defaultProps = {\n  popupTitle: '',\n  popupPlacement: 'right',\n  style: {},\n  defaultValue: false,\n  onClick: () => null,\n  disabled: false,\n};\n\nexport default memo(ToggleButton);\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { memo } from 'react';\nimport { FaRegTrashAlt, FaCog, FaFilter } from 'react-icons/fa';\n\nimport ToggleButton from '../../elements/ToggleButton';\nimport ToolTip from '../../elements/ToolTip/ToolTip';\n\nconst styles = css`\n  \n  display: flex;\n  flex-direction: row;\n  border-bottom: 0.55px solid rgb(240, 240, 240);\n  padding: 0px 5px;\n\n  button {\n    background-color: transparent;\n    border: none;\n    padding: 5px;\n  }\n\n  button:disabled{\n    opacity:0.6;\n  }\n  \n  .counter-label {\n    margin: 0;\n    text-align: right;\n    width: 100%;\n    line-height: 22px;\n    padding: 0px 10px;\n  }\n\n  filter-button{\n    borderRadius: 5px;\n    marginTop: 3px;\n    marginLeft: 5px;\n    color: black;\n    backgroundColor: transparent;\n    border: none;\n    height: 16px;\n    width: 18px;\n    fontSize: 12px;\n    padding: 0;\n  },\n\n`;\n\nfunction DefaultPanelHeader({\n  counter,\n  onDelete,\n  deleteToolTip,\n  onFilter,\n  filterToolTip,\n  filterIsActive,\n  counterFiltered,\n  children,\n  onSettingClick,\n  showSettingButton,\n  canDelete,\n}) {\n  return (\n    <div css={styles}>\n      {canDelete && (\n        <ToolTip title={deleteToolTip} popupPlacement=\"right\">\n          <button type=\"button\" onClick={onDelete} disabled={counter === 0}>\n            <FaRegTrashAlt />\n          </button>\n        </ToolTip>\n      )}\n\n      {/* Optional if there is no filter needed, e.g. in spectra panel */}\n      {onFilter && filterToolTip ? (\n        <ToggleButton\n          popupTitle={filterToolTip}\n          popupPlacement=\"right\"\n          onClick={onFilter}\n          // defaultValue={filterIsActive && filterIsActive === true}\n        >\n          <FaFilter style={{ pointerEvents: 'none', fontSize: '12px' }} />\n        </ToggleButton>\n      ) : null}\n\n      {children}\n\n      {counter ? (\n        <p className=\"counter-label\">\n          [{' '}\n          {filterIsActive &&\n          filterIsActive === true &&\n          counterFiltered !== undefined\n            ? `${counterFiltered}/${counter}`\n            : counter}{' '}\n          ]\n        </p>\n      ) : (\n        <p style={{ flex: 1 }} />\n      )}\n      {showSettingButton && (\n        <ToolTip title=\"preferences\" popupPlacement=\"left\">\n          <button type=\"button\" onClick={onSettingClick}>\n            <FaCog />\n          </button>\n        </ToolTip>\n      )}\n    </div>\n  );\n}\n\nDefaultPanelHeader.defaultProps = {\n  counter: 0,\n  onDelete: () => null,\n  deleteToolTip: 'Delete',\n  onFilter: () => null,\n  filterToolTip: '',\n  filterIsActive: false,\n  counterFiltered: 0,\n  onSettingClick: () => null,\n  showSettingButton: false,\n  canDelete: true,\n};\n\nexport default memo(DefaultPanelHeader);\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport PropTypes from 'prop-types';\nimport { memo } from 'react';\nimport { FaCheck } from 'react-icons/fa';\n\nimport ToolTip from './ToolTip/ToolTip';\n\nconst styles = css`\n  background-color: transparent;\n  border: none;\n  height: 100%;\n  svg {\n    fill: green;\n    font-size: 16px;\n  }\n`;\nfunction SaveButton({\n  onClick,\n  popupTitle,\n  popupPlacement,\n  disabled,\n  className,\n}) {\n  return (\n    <div className={className}>\n      <ToolTip title={popupTitle} popupPlacement={popupPlacement}>\n        <button\n          css={styles}\n          type=\"button\"\n          onClick={onClick}\n          disabled={disabled}\n          className={className}\n        >\n          <FaCheck />\n        </button>\n      </ToolTip>\n    </div>\n  );\n}\n\nSaveButton.defaultProps = {\n  onClick: () => null,\n  popupTitle: 'Save',\n  popupPlacement: 'left',\n  disabled: false,\n  className: '',\n};\nSaveButton.propTypes = {\n  onClick: PropTypes.func,\n  popupTitle: PropTypes.string,\n  popupPlacement: PropTypes.string,\n  disabled: PropTypes.bool,\n  className: PropTypes.string,\n};\n\nexport default memo(SaveButton);\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { memo } from 'react';\n\nimport CloseButton from '../../elements/CloseButton';\nimport SaveButton from '../../elements/SaveButton';\n\nconst styles = css`\n  display: flex;\n  flex-direction: row-reverse;\n  border-bottom: 0.55px solid rgb(240, 240, 240);\n\n  button {\n    background-color: transparent;\n    border: none;\n    padding: 5px;\n  }\n  button:disabled {\n    opacity: 0.6;\n  }\n`;\nfunction PreferencesHeader({ onClose, onSave }) {\n  return (\n    <div css={styles}>\n      <CloseButton onClick={onClose} popupTitle=\"close Preferences\" />\n      <SaveButton onClick={onSave} popupTitle=\"save Preferences\" />\n    </div>\n  );\n}\n\nexport default memo(PreferencesHeader);\n","import {\n  forwardRef,\n  useCallback,\n  useEffect,\n  useImperativeHandle,\n  useRef,\n  useState,\n} from 'react';\n\nimport Input from './Input';\n\nconst EditableColumn = forwardRef(function EditableColumn(\n  { onSave, value, type, style, onEditStart, editStatus },\n  ref,\n) {\n  const [enabled, enableEdit] = useState();\n  const refInput = useRef();\n\n  useEffect(() => {\n    enableEdit(editStatus);\n  }, [editStatus]);\n\n  useImperativeHandle(ref, () => ({\n    startEdit: () => {\n      enableEdit(true);\n    },\n    closeEdit: () => {\n      enableEdit(false);\n    },\n  }));\n\n  const editModeHandler = useCallback(\n    (flag, event = null) => {\n      if (!flag) {\n        if (event.keyCode === 13) {\n          // when press Enter\n          onSave(event);\n          enableEdit(flag);\n        } else if (event.keyCode === 27) {\n          // when press Escape\n          enableEdit(flag);\n        }\n      } else {\n        onEditStart(event);\n        enableEdit(flag);\n      }\n    },\n    [onEditStart, onSave],\n  );\n\n  return (\n    <div\n      style={{ display: 'table', width: '100%', height: '100%', ...style }}\n      onDoubleClick={(event) => editModeHandler(true, event)}\n    >\n      {!enabled && (\n        <span style={{ display: 'table-cell', verticalAlign: 'middle' }}>\n          {value}\n        </span>\n      )}\n      {enabled && (\n        <div style={{ display: 'table-cell', verticalAlign: 'middle' }}>\n          <Input\n            enableAutoSelect\n            ref={refInput}\n            value={value}\n            type={type}\n            onKeyDown={(e) => editModeHandler(false, e)}\n          />\n        </div>\n      )}\n    </div>\n  );\n});\n\nEditableColumn.defaultProps = {\n  onSave: () => null,\n  onEditStart: () => null,\n  type: 'text',\n  editStatus: false,\n};\n\nexport default EditableColumn;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport {\n  forwardRef,\n  useState,\n  useImperativeHandle,\n  useCallback,\n  useRef,\n  useEffect,\n} from 'react';\nimport { createPortal } from 'react-dom';\n\nimport { useGlobal } from '../context/GlobalContext';\n\nconst styles = css`\n  box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.25);\n  padding: 0px;\n  margin: 0px;\n  border-radius: 2px;\n  display: flex;\n  flex-direction: column;\n  position: fixed;\n  z-index: 99999;\n  padding: 2px;\n  background-color: white;\n  width: 150px;\n  pointer-events: all;\n\n  button {\n    background-color: transparent;\n    border: none;\n    border-bottom: 0.55px solid #f0f0f0;\n    font-size: 11px;\n    padding: 5px;\n    text-align: left;\n    outline: none;\n  }\n  button:hover {\n    background-color: #fafafa;\n    outline: none;\n  }\n\n  button:active {\n    background-color: #eaeaea;\n    outline: none;\n  }\n\n  button:last-of-type {\n    border: none;\n  }\n`;\nfunction ContextMenu({ context }, ref) {\n  const [position, setPosition] = useState({ lef: 0, top: 0 });\n  const { rootRef, elementsWraperRef } = useGlobal();\n  const [data, setData] = useState();\n  const [isVisible, show] = useState();\n  const [sourceElement, setSourceElement] = useState(null);\n  const root = useRef();\n\n  useEffect(() => {\n    root.current = document.createElement('div');\n    if (elementsWraperRef) {\n      elementsWraperRef.appendChild(root.current);\n    }\n    return () => {\n      if (root.current && elementsWraperRef) {\n        elementsWraperRef.removeChild(root.current);\n      }\n    };\n  }, [elementsWraperRef]);\n\n  const contextMenuHandler = (event) => {\n    event.preventDefault();\n    setSourceElement(event.target.parentElement);\n    show(true);\n    const clickX = event.clientX;\n    const clickY = event.clientY;\n\n    const screenW = window.innerWidth;\n    const screenH = window.innerHeight;\n    const rootW = 150;\n    const rootH = 0;\n\n    const right = screenW - clickX > rootW;\n    let left = !right;\n    let top = screenH - clickY > rootH;\n    const bottom = !top;\n    if (right) {\n      left = `${clickX + 5}px`;\n    }\n\n    if (left) {\n      left = `${clickX - rootW - 5}px`;\n    }\n\n    if (top) {\n      top = `${clickY + 5}px`;\n    }\n\n    if (bottom) {\n      top = `${clickY - rootH - 5}px`;\n    }\n\n    setPosition({ left, top });\n  };\n\n  useImperativeHandle(ref, () => ({\n    handleContextMenu: (e, _data) => {\n      setData(_data);\n      contextMenuHandler(e);\n    },\n  }));\n\n  const clickHandler = useCallback(\n    (event, click) => {\n      event.preventDefault();\n      click(data);\n      show(false);\n    },\n    [data],\n  );\n\n  useEffect(() => {\n    const _handleGlobalClick = (event) => {\n      const wasOutside =\n        sourceElement &&\n        event.target.parentElement &&\n        !event.target.parentElement.isSameNode(sourceElement);\n      if (wasOutside && isVisible) show(false);\n    };\n    if (rootRef) {\n      rootRef.addEventListener('click', _handleGlobalClick);\n    }\n    return () => {\n      if (rootRef) {\n        rootRef.removeEventListener('click', _handleGlobalClick);\n      }\n    };\n  }, [isVisible, ref, rootRef, sourceElement]);\n\n  if (!isVisible) {\n    return null;\n  }\n\n  return (\n    root.current &&\n    createPortal(\n      context && (\n        <div ref={ref} css={[styles, position]}>\n          {context.map((c, index) => (\n            <button\n              // eslint-disable-next-line react/no-array-index-key\n              key={index}\n              type=\"button\"\n              onClick={(e) => clickHandler(e, c.onClick)}\n            >\n              {c.label}\n            </button>\n          ))}\n        </div>\n      ),\n      root.current,\n    )\n  );\n}\n\nexport default forwardRef(ContextMenu);\n","const ReactTableHeader = ({ headerGroups }) => {\n  return (\n    <thead>\n      {headerGroups.map((headerGroup) => (\n        <tr\n          key={headerGroup.getHeaderGroupProps().key}\n          {...headerGroup.getHeaderGroupProps()}\n        >\n          {headerGroup.headers.map((column) => (\n            <th\n              key={column.getHeaderProps().key}\n              {...column.getHeaderProps(column.getSortByToggleProps())}\n            >\n              {column.render('Header')}\n              <span>\n                {column.isSorted ? (column.isSortedDesc ? ' ' : ' ') : ''}\n              </span>\n            </th>\n          ))}\n        </tr>\n      ))}\n    </thead>\n  );\n};\n\nexport default ReactTableHeader;\n","/** @jsxImportSource @emotion/react */\n\nimport { useHighlight } from '../../../highlight/index';\nimport { HighlightedRowStyle, ConstantlyHighlightedRowStyle } from '../Style';\n\nconst ReactTableRow = ({ row, onContextMenu }) => {\n  const highlight = useHighlight([\n    Object.prototype.hasOwnProperty.call(row.original, 'id')\n      ? row.original.id\n      : '',\n  ]);\n\n  return (\n    <tr\n      onContextMenu={onContextMenu}\n      key={row.getRowProps().key}\n      css={\n        highlight.isActive\n          ? HighlightedRowStyle\n          : Object.prototype.hasOwnProperty.call(\n              row.original,\n              'isConstantlyHighlighted',\n            ) && row.original.isConstantlyHighlighted === true\n          ? ConstantlyHighlightedRowStyle\n          : null\n      }\n      {...row.getRowProps()}\n      {...highlight.onHover}\n    >\n      {row.cells.map((cell) => {\n        const { minWidth, maxWidth, width, padding } = cell.column;\n        return (\n          <td\n            key={cell.key}\n            {...cell.getCellProps()}\n            onContextMenu={(e) => {\n              e.preventDefault();\n\n              return false;\n            }}\n            style={{ minWidth, maxWidth, width, padding }}\n          >\n            {cell.render('Cell')}\n          </td>\n        );\n      })}\n    </tr>\n  );\n};\n\nexport default ReactTableRow;\n","/** @jsxImportSource @emotion/react */\n\nimport PropTypes from 'prop-types';\nimport { Fragment, useRef, useCallback, memo } from 'react';\nimport { useTable, useSortBy } from 'react-table';\n\nimport checkModifierKeyActivated from '../../../data/utilities/checkModifierKeyActivated';\nimport ContextMenu from '../ContextMenu';\n\nimport ReactTableHeader from './Elements/ReactTableHeader';\nimport ReactTableRow from './Elements/ReactTableRow';\nimport { ReactTableStyle } from './Style';\n\nfunction ReactTable({ data, columns, context }) {\n  const contextRef = useRef();\n  const {\n    getTableProps,\n    getTableBodyProps,\n    headerGroups,\n    rows,\n    prepareRow,\n  } = useTable(\n    {\n      columns,\n      data,\n    },\n    useSortBy,\n  );\n\n  const contextMenuHandler = useCallback(\n    (e, row) => {\n      if (!checkModifierKeyActivated(e)) {\n        e.preventDefault();\n        contextRef.current.handleContextMenu(e, row.original);\n      }\n    },\n    [contextRef],\n  );\n  return (\n    <Fragment>\n      <table {...getTableProps()} css={ReactTableStyle}>\n        <ReactTableHeader headerGroups={headerGroups} />\n        <tbody {...getTableBodyProps()}>\n          {rows.map((row) => {\n            prepareRow(row);\n            return (\n              <ReactTableRow\n                key={row.key}\n                row={row}\n                {...row.getRowProps()}\n                onContextMenu={(e) => contextMenuHandler(e, row)}\n              />\n            );\n          })}\n        </tbody>\n      </table>\n      <ContextMenu ref={contextRef} context={context} />\n    </Fragment>\n  );\n}\n\nReactTable.propTypes = {\n  context: PropTypes.arrayOf(\n    PropTypes.shape({\n      label: PropTypes.string,\n      onClick: PropTypes.func,\n    }),\n  ),\n};\nReactTable.defaultProps = {\n  context: null,\n};\n\nexport default memo(ReactTable);\n","// placeholder for empty tables if no data is available to show (e.g. peaks, integrals, ranges)\nfunction NoTableData() {\n  return (\n    <p\n      style={{\n        textAlign: 'center',\n        width: '100%',\n        fontSize: '11px',\n        padding: '5px',\n        color: 'gray',\n      }}\n    >\n      No Data\n    </p>\n  );\n}\nexport default NoTableData;\n","import lodashGet from 'lodash/get';\nimport { useCallback, useMemo, memo, useRef, useEffect } from 'react';\nimport { FaRegTrashAlt } from 'react-icons/fa';\n\nimport { SignalKinds } from '../../../data/constants/SignalsKinds';\nimport { useDispatch } from '../../context/DispatchContext';\nimport { useGlobal } from '../../context/GlobalContext';\nimport EditableColumn from '../../elements/EditableColumn';\nimport ReactTable from '../../elements/ReactTable/ReactTable';\nimport Select from '../../elements/Select';\nimport IntegralsWrapper from '../../hoc/IntegralsWrapper';\nimport {\n  DELETE_INTEGRAL,\n  CHANGE_INTEGRAL_DATA,\n  CHANGE_INTEGRAL_RELATIVE,\n} from '../../reducer/types/Types';\nimport formatNumber from '../../utility/FormatNumber';\nimport { getValue } from '../../utility/LocalStorage';\nimport NoTableData from '../extra/placeholder/NoTableData';\nimport { integralDefaultValues } from '../extra/preferences/defaultValues';\n\nconst selectStyle = { marginLeft: 10, marginRight: 10, border: 'none' };\n\nfunction IntegralTable({\n  integrals,\n  info,\n  activeTab,\n  xDomain,\n  enableFilter,\n  onFilter,\n  preferences,\n}) {\n  const dispatch = useDispatch();\n  const relativeRefs = useRef([]);\n  const { rootRef } = useGlobal();\n  const deleteIntegralHandler = useCallback(\n    (e, row) => {\n      e.preventDefault();\n      e.stopPropagation();\n      const params = row.original;\n      dispatch({\n        type: DELETE_INTEGRAL,\n        integralID: params.id,\n      });\n    },\n    [dispatch],\n  );\n  const changeIntegralDataHandler = useCallback(\n    (value, row) => {\n      const data = { ...row.original, kind: value };\n      dispatch({\n        type: CHANGE_INTEGRAL_DATA,\n        data,\n      });\n    },\n    [dispatch],\n  );\n  const defaultColumns = useMemo(\n    () => [\n      {\n        orderIndex: 1,\n        Header: '#',\n        Cell: ({ row }) => row.index + 1,\n        width: 10,\n      },\n\n      {\n        orderIndex: 2,\n        Header: 'From',\n        accessor: 'from',\n        sortType: 'basic',\n        resizable: true,\n        Cell: ({ row }) => row.original.from.toFixed(2),\n      },\n      {\n        orderIndex: 3,\n        Header: 'To',\n        accessor: 'to',\n        sortType: 'basic',\n        resizable: true,\n        Cell: ({ row }) => row.original.to.toFixed(2),\n      },\n      {\n        orderIndex: 6,\n        Header: 'Kind',\n        accessor: 'kind',\n        sortType: 'basic',\n        resizable: true,\n        Cell: ({ row }) => (\n          <Select\n            onChange={(value) => changeIntegralDataHandler(value, row)}\n            data={SignalKinds}\n            style={selectStyle}\n            defaultValue={row.original.kind}\n          />\n        ),\n      },\n      {\n        orderIndex: 7,\n        Header: '',\n        width: '1%',\n        maxWidth: '24px',\n        minWidth: '24px',\n        id: 'delete-button',\n        Cell: ({ row }) => (\n          <button\n            type=\"button\"\n            className=\"delete-button\"\n            onClick={(e) => deleteIntegralHandler(e, row)}\n          >\n            <FaRegTrashAlt />\n          </button>\n        ),\n      },\n    ],\n    [changeIntegralDataHandler, deleteIntegralHandler],\n  );\n\n  const saveRealtiveHandler = useCallback(\n    (event, row) => {\n      dispatch({\n        type: CHANGE_INTEGRAL_RELATIVE,\n        value: event.target.value,\n        id: row.id,\n      });\n    },\n    [dispatch],\n  );\n  const editStartHander = useCallback((index) => {\n    relativeRefs.current.forEach((ref, i) => {\n      if (index !== i && ref) {\n        ref.closeEdit();\n      }\n    });\n  }, []);\n\n  useEffect(() => {\n    if (rootRef) {\n      rootRef.addEventListener('mousedown', editStartHander);\n    }\n    return () => {\n      if (rootRef) {\n        rootRef.removeEventListener('mousedown', editStartHander);\n      }\n    };\n  }, [editStartHander, rootRef]);\n\n  const tableColumns = useMemo(() => {\n    const setCustomColumn = (array, index, columnLabel, cellHandler) => {\n      array.push({\n        orderIndex: index,\n        Header: columnLabel,\n        sortType: 'basic',\n        Cell: ({ row }) => cellHandler(row),\n      });\n    };\n\n    const integralsPreferences = getValue(\n      preferences,\n      `formatting.panels.integrals.[${activeTab}]`,\n    );\n    let cols = [...defaultColumns];\n    if (\n      lodashGet(\n        integralsPreferences,\n        'showAbsolute',\n        integralDefaultValues.showAbsolute,\n      )\n    ) {\n      setCustomColumn(cols, 4, 'Absolute', (row) =>\n        formatNumber(\n          row.original.absolute,\n          lodashGet(\n            integralsPreferences,\n            'absoluteFormat',\n            integralDefaultValues.absoluteFormat,\n          ),\n        ),\n      );\n    }\n    if (\n      lodashGet(\n        integralsPreferences,\n        'showRelative',\n        integralDefaultValues.showRelative,\n      )\n    ) {\n      const n = activeTab && activeTab.replace(/[0-9]/g, '');\n      setCustomColumn(cols, 5, `Relative ${n}`, (row) => {\n        const formattedNumber = formatNumber(\n          row.original.integral,\n          lodashGet(\n            integralsPreferences,\n            'relativeFormat',\n            integralDefaultValues.relativeFormat,\n          ),\n        );\n        return (\n          <EditableColumn\n            onEditStart={() => editStartHander(row.index)}\n            ref={(ref) => (relativeRefs.current[row.index] = ref)}\n            value={formattedNumber}\n            onSave={(event) => saveRealtiveHandler(event, row.original)}\n            type=\"number\"\n          />\n        );\n      });\n    }\n\n    return cols.sort(\n      (object1, object2) => object1.orderIndex - object2.orderIndex,\n    );\n  }, [\n    activeTab,\n    defaultColumns,\n    editStartHander,\n    preferences,\n    saveRealtiveHandler,\n  ]);\n\n  const tableData = useMemo(() => {\n    function isInRange(from, to) {\n      const factor = 10000;\n      to = to * factor;\n      from = from * factor;\n      return (\n        (to >= xDomain[0] * factor && from <= xDomain[1] * factor) ||\n        (from <= xDomain[0] * factor && to >= xDomain[1] * factor)\n      );\n    }\n    if (info.dimension === 1 && integrals && integrals.values) {\n      const _integrals = enableFilter\n        ? integrals.values.filter((integral) =>\n            isInRange(integral.from, integral.to),\n          )\n        : integrals.values;\n\n      return _integrals.map((integral) => {\n        return {\n          ...integral,\n          isConstantlyHighlighted: isInRange(integral.from, integral.to),\n        };\n      });\n    }\n    return [];\n  }, [enableFilter, info.dimension, integrals, xDomain]);\n\n  useEffect(() => {\n    onFilter(tableData.length);\n  }, [tableData, onFilter]);\n\n  return tableData && tableData.length > 0 ? (\n    <ReactTable data={tableData} columns={tableColumns} />\n  ) : (\n    <NoTableData />\n  );\n}\n\nexport default IntegralsWrapper(memo(IntegralTable));\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback, memo, useState } from 'react';\nimport { ChromePicker } from 'react-color';\n\nconst style = css`\n  display: flex;\n  margin: 5px 0px;\n\n.inputLabel{\n  flex: 2;\n  font-size: 11px;\n  font-weight: bold;\n  color: #232323;\n}\n\n.input {\n  width: '60%',\n  text-align: 'center',\n}\n\n.color{\n  width: 36px;\n  height: 14px;\n  border-radius: 2px;\n}\n\n.swatch{\n  padding: 5px;\n  background: #fff;\n  border-radius: 1px;\n  box-shadow: 0 0 0 1px rgba(0,0,0,.1);\n  display: inline-block;\n  cursor: pointer;\n}\n.color-popover {\n  position: absolute;\n  z-index: 2;\n}\n\n.cover {\n  position: fixed;\n  top: 0px;\n  right: 0px;\n  bottom: 0px;\n  left: 0px;\n}\n  .chrome-picker {\n    border-radius: none !important;\n    width: 200px !important;\n    height: 60px !important;\n    display: flex;\n\n\n  }\n  .chrome-picker > div:first-of-type {\n    padding: 0px !important;\n\n  }\n  .chrome-picker > div:last-child >  div:first-of-type {\n    width: 120px;\n\n  }\n  .chrome-picker > div:last-child >  div:last-child {\n    display:none !important;\n  }\n`;\n\nfunction ColorInput({ label, onColorChange, name, value }) {\n  const [displayColorPicker, showColorPicker] = useState(false);\n  const [color, setColor] = useState(value);\n\n  const handleClick = useCallback(() => {\n    showColorPicker(!displayColorPicker);\n  }, [displayColorPicker]);\n\n  const handleClose = useCallback(() => {\n    showColorPicker(false);\n  }, []);\n\n  const handleOnColorChanged = useCallback(\n    (colorEvent) => {\n      const hex = `${colorEvent.hex}${Math.round(\n        colorEvent.rgb.a * 255,\n      ).toString(16)}`;\n      setColor(hex);\n      onColorChange({ ...colorEvent, hex, name });\n    },\n    [name, onColorChange],\n  );\n\n  return (\n    <div css={style}>\n      <span className=\"inputLabel\">{label}</span>\n      <div style={{ flex: 4 }}>\n        <div className=\"swatch\" onClick={handleClick}>\n          <div className=\"color\" style={{ backgroundColor: color }} />\n          <input type=\"hidden\" value={color} name={name} />\n        </div>\n        {displayColorPicker ? (\n          <div className=\"color-popover\">\n            <div className=\"cover\" onClick={handleClose} />\n            <ChromePicker\n              color={{ hex: color }}\n              onChangeComplete={handleOnColorChanged}\n            />\n          </div>\n        ) : null}\n      </div>\n    </div>\n  );\n}\n\nColorInput.defaultProps = {\n  value: '#000000',\n  label: 'Color: ',\n  onColorChange: () => null,\n};\n\nexport default memo(ColorInput);\n","import { memo, useState } from 'react';\n\nimport Input from '../../../elements/Input';\n\nconst styles = {\n  row: {\n    display: 'flex',\n    margin: '5px 0px',\n    alignItems: 'center',\n  },\n  inputLabel: {\n    flex: 2,\n    fontSize: '11px',\n    fontWeight: 'bold',\n    color: '#232323',\n  },\n  input: {\n    width: '60%',\n    textAlign: 'center',\n  },\n};\n\nfunction ColumnFormatField({\n  label,\n  checkControllerName,\n  checked,\n  format,\n  formatControllerName,\n  inputChangeHandler,\n  groupID,\n}) {\n  const [_checked, setChecked] = useState(Boolean(checked));\n\n  return (\n    <div style={styles.row}>\n      <span style={styles.inputLabel}>{label}</span>\n      <div\n        style={{\n          flex: 4,\n          display: 'flex',\n          flexDirection: 'row',\n          alignItems: 'center',\n        }}\n      >\n        <input\n          type=\"checkbox\"\n          onChange={(e) => setChecked(e.target.checked)}\n          style={{ margin: '0px 5px' }}\n          defaultChecked={_checked}\n        />\n        <input\n          name={`${groupID}-${checkControllerName}`}\n          type=\"hidden\"\n          value={_checked}\n        />\n        <Input\n          style={{ container: styles.input }}\n          name={`${groupID}-${formatControllerName}`}\n          type=\"text\"\n          onChange={inputChangeHandler}\n          value={format ? format : ''}\n        />\n      </div>\n    </div>\n  );\n}\n\nexport default memo(ColumnFormatField);\n","import lodashGet from 'lodash/get';\nimport lodashSet from 'lodash/set';\nimport {\n  useEffect,\n  useState,\n  useCallback,\n  forwardRef,\n  useImperativeHandle,\n  useRef,\n} from 'react';\nimport { MF } from 'react-mf';\n\nimport ColorInput from '../../elements/ColorInput';\nimport NumberInput from '../../elements/NumberInput';\nimport { useAlert } from '../../elements/popup/Alert';\nimport IntegralsWrapper from '../../hoc/IntegralsWrapper';\nimport { SET_PANELS_PREFERENCES } from '../../reducer/preferencesReducer';\nimport {\n  useStateWithLocalStorage,\n  getValue as getValueByKeyPath,\n} from '../../utility/LocalStorage';\nimport ColumnFormatField from '../extra/preferences/ColumnFormatField';\nimport { integralDefaultValues } from '../extra/preferences/defaultValues';\n\nconst styles = {\n  container: {\n    padding: 10,\n    backgroundColor: '#f1f1f1',\n    height: '100%',\n    flex: 1,\n  },\n  groupContainer: {\n    padding: '5px',\n    borderRadius: '5px',\n    margin: '10px 0px',\n    backgroundColor: 'white',\n  },\n  row: {\n    display: 'flex',\n    margin: '5px 0px',\n  },\n  header: {\n    borderBottom: '1px solid #e8e8e8',\n    paddingBottom: '5px',\n    fontWeight: 'bold',\n    color: '#4a4a4a',\n  },\n  inputLabel: {\n    flex: 2,\n    fontSize: '11px',\n    fontWeight: 'bold',\n    color: '#232323',\n  },\n  input: {\n    width: '30%',\n    textAlign: 'center',\n  },\n};\n\nconst formatFields = [\n  {\n    id: 1,\n    label: 'Absolute :',\n    checkController: 'showAbsolute',\n    formatController: 'absoluteFormat',\n    defaultFormat: '0.00',\n  },\n  {\n    id: 2,\n    label: 'Relative :',\n    checkController: 'showRelative',\n    formatController: 'relativeFormat',\n    defaultFormat: '00.00',\n  },\n];\nfunction IntegralsPreferences({ nucleus, preferences }, ref) {\n  const alert = useAlert();\n  const [, setSettingsData] = useStateWithLocalStorage('nmr-general-settings');\n\n  const [settings, setSetting] = useState(null);\n  const formRef = useRef();\n\n  useEffect(() => {\n    const integralsPreferences = getValueByKeyPath(\n      preferences,\n      'formatting.panels.integrals',\n    );\n\n    if (integralsPreferences) {\n      setSetting(integralsPreferences);\n    }\n  }, [preferences]);\n\n  const saveToLocalStorgate = (values) => {\n    setSettingsData(values, 'formatting.panels.integrals');\n  };\n\n  const saveHandler = useCallback(\n    (values, showMessage = false) => {\n      preferences.dispatch({\n        type: SET_PANELS_PREFERENCES,\n        payload: { key: 'integrals', value: values },\n      });\n      if (showMessage) {\n        alert.success('Integrals preferences saved successfully');\n      }\n    },\n    [alert, preferences],\n  );\n\n  useImperativeHandle(ref, () => ({\n    saveSetting() {\n      if (typeof formRef.current.requestSubmit === 'function') {\n        formRef.current.requestSubmit();\n      } else {\n        formRef.current.dispatchEvent(\n          new Event('submit', { cancelable: true }),\n        );\n      }\n    },\n  }));\n\n  const handleSubmit = async (event) => {\n    event.preventDefault();\n    const form = event.target;\n    const formData = new FormData(form);\n    let values = {};\n    for (const field of formData.entries()) {\n      const keys = field[0].split('-').join('.');\n      const val = ['true', 'false'].includes(field[1])\n        ? field[1] === 'true'\n        : field[1];\n      values = lodashSet(values, keys, val);\n    }\n    saveHandler(values, true);\n    saveToLocalStorgate(values);\n  };\n\n  const getValue = useCallback(\n    (...params) => {\n      if (settings) {\n        const value =\n          params[0] === null\n            ? settings[params[1]]\n            : lodashGet(settings, params.join('.'));\n        return value ? value : null;\n      } else {\n        const keyIndex = params.length - 1;\n        return integralDefaultValues[params[keyIndex]];\n      }\n    },\n    [settings],\n  );\n  return (\n    <div style={styles.container}>\n      <form onSubmit={handleSubmit} ref={formRef}>\n        <div style={styles.groupContainer}>\n          <p style={styles.header}>General</p>\n          <ColorInput name=\"color\" value={`${getValue(null, 'color')}`} />\n          <NumberInput\n            name=\"strokeWidth\"\n            label=\"stroke width :\"\n            style={{\n              label: { fontSize: '11px', fontWeight: 'bold', color: '#232323' },\n              input: {\n                width: '60%',\n                textAlign: 'center',\n                borderRadius: '5px',\n              },\n            }}\n            defaultValue={Number(getValue(null, 'strokeWidth'))}\n            min={1}\n            pattern=\"[1-9]*\"\n          />\n        </div>\n\n        {nucleus &&\n          nucleus.map((nucleusLabel) => (\n            <div key={nucleusLabel} style={styles.groupContainer}>\n              <p style={styles.header}>\n                <MF mf={nucleusLabel} />\n              </p>\n              {formatFields.map((field) => (\n                <ColumnFormatField\n                  key={field.id}\n                  label={field.label}\n                  checked={getValue(nucleusLabel, field.checkController)}\n                  format={getValue(nucleusLabel, field.formatController)}\n                  checkControllerName={field.checkController}\n                  formatControllerName={field.formatController}\n                  groupID={nucleusLabel}\n                />\n              ))}\n            </div>\n          ))}\n      </form>\n    </div>\n  );\n}\n\nexport default IntegralsWrapper(forwardRef(IntegralsPreferences));\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { SvgNmrSum } from 'cheminfo-font';\nimport lodashGet from 'lodash/get';\nimport { useCallback, useMemo, useState, useRef, memo, Fragment } from 'react';\nimport ReactCardFlip from 'react-card-flip';\n\nimport { useDispatch } from '../../context/DispatchContext';\nimport ToolTip from '../../elements/ToolTip/ToolTip';\nimport { useModal } from '../../elements/popup/Modal';\nimport IntegralsWrapper from '../../hoc/IntegralsWrapper';\nimport ChangeSumModal from '../../modal/changeSum/ChangeSumModal';\nimport {\n  DELETE_INTEGRAL,\n  CHANGE_INTEGRAL_SUM,\n} from '../../reducer/types/Types';\nimport DefaultPanelHeader from '../header/DefaultPanelHeader';\nimport PreferencesHeader from '../header/PreferencesHeader';\n\nimport IntegralTable from './IntegralTable';\nimport IntegralsPreferences from './IntegralsPreferences';\n\nconst styles = css`\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n\n  .sum-button {\n    width: 22px;\n    height: 22px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n  }\n`;\n\nfunction IntegralPanel({ integrals, activeTab, molecules }) {\n  const [filterIsActive, setFilterIsActive] = useState(false);\n  const [integralsCounter, setIntegralsCounter] = useState(0);\n\n  const dispatch = useDispatch();\n  const modal = useModal();\n  const [isFlipped, setFlipStatus] = useState(false);\n  const settingRef = useRef();\n\n  const yesHandler = useCallback(() => {\n    dispatch({ type: DELETE_INTEGRAL, integralID: null });\n  }, [dispatch]);\n\n  const handleDeleteAll = useCallback(() => {\n    modal.showConfirmDialog({\n      message: 'All records will be deleted, Are You sure?',\n      buttons: [{ text: 'Yes', handler: yesHandler }, { text: 'No' }],\n    });\n  }, [modal, yesHandler]);\n\n  const changeIntegralSumHandler = useCallback(\n    (value) => {\n      if (value !== undefined) {\n        dispatch({ type: CHANGE_INTEGRAL_SUM, value });\n      }\n\n      modal.close();\n    },\n    [dispatch, modal],\n  );\n\n  const currentSum = useMemo(() => {\n    return lodashGet(integrals, 'options.sum', null);\n  }, [integrals]);\n\n  const showChangeIntegralSumModal = useCallback(() => {\n    modal.show(\n      <ChangeSumModal\n        onClose={() => modal.close()}\n        onSave={changeIntegralSumHandler}\n        header={\n          currentSum\n            ? `Set new Integrals Sum (Current: ${Number(currentSum).toFixed(\n                2,\n              )})`\n            : 'Set new Integrals Sum'\n        }\n        molecules={molecules}\n        element={activeTab ? activeTab.replace(/[0-9]/g, '') : null}\n      />,\n    );\n  }, [activeTab, changeIntegralSumHandler, currentSum, modal, molecules]);\n\n  const settingsPanelHandler = useCallback(() => {\n    setFlipStatus(!isFlipped);\n  }, [isFlipped]);\n\n  const saveSettingHandler = useCallback(() => {\n    settingRef.current.saveSetting();\n    setFlipStatus(false);\n  }, []);\n\n  const handleOnFilter = useCallback(() => {\n    setFilterIsActive(!filterIsActive);\n  }, [filterIsActive]);\n\n  const changedHandler = useCallback((val) => {\n    setIntegralsCounter(val);\n  }, []);\n\n  return (\n    <Fragment>\n      <div css={styles}>\n        {!isFlipped && (\n          <DefaultPanelHeader\n            counter={integralsCounter}\n            onDelete={handleDeleteAll}\n            deleteToolTip=\"Delete All Integrals\"\n            onFilter={handleOnFilter}\n            filterToolTip={\n              filterIsActive\n                ? 'Show all integrals'\n                : 'Hide integrals out of view'\n            }\n            filterIsActive={filterIsActive}\n            counterFiltered={integralsCounter}\n            showSettingButton=\"true\"\n            onSettingClick={settingsPanelHandler}\n          >\n            <ToolTip\n              title={\n                currentSum\n                  ? `Change Integrals Sum (${Number(currentSum).toFixed(2)})`\n                  : 'Change Integrals Sum'\n              }\n              popupPlacement=\"right\"\n            >\n              <button\n                className=\"sum-button\"\n                type=\"button\"\n                onClick={showChangeIntegralSumModal}\n              >\n                <SvgNmrSum />\n              </button>\n            </ToolTip>\n          </DefaultPanelHeader>\n        )}\n        {isFlipped && (\n          <PreferencesHeader\n            onSave={saveSettingHandler}\n            onClose={settingsPanelHandler}\n          />\n        )}\n        <div style={{ height: '100%', overflow: 'hidden' }}>\n          <ReactCardFlip\n            isFlipped={isFlipped}\n            infinite\n            containerStyle={{ overflow: 'hidden', height: '100%' }}\n          >\n            <div style={{ overflow: 'auto', height: '100%', display: 'block' }}>\n              <IntegralTable\n                enableFilter={filterIsActive}\n                onFilter={changedHandler}\n              />\n            </div>\n            <IntegralsPreferences ref={settingRef} />\n          </ReactCardFlip>\n        </div>\n      </div>\n    </Fragment>\n  );\n}\n\nexport default IntegralsWrapper(memo(IntegralPanel));\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useState, useCallback, useRef } from 'react';\n\nimport ToolTip from './ToolTip/ToolTip';\n\nconst menuStyles = css`\n  .menu {\n    box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.5);\n    padding: 0px;\n    margin: 0px;\n    border-radius: 5px;\n    display: flex;\n    flex-direction: column;\n    position: absolute;\n    z-index: 99999;\n    padding: 2px;\n    background-color: white;\n\n    button:hover {\n      background-color: #fafafa;\n    }\n  }\n\n  .menu-cover {\n    position: fixed;\n    width: 100%;\n    height: 100%;\n    top: 0;\n    left: 0;\n    z-index: 1;\n  }\n\n  .menu-item {\n    background-color: transparent;\n    border: none;\n    border-bottom: 0.55px solid whitesmoke;\n    height: 35px;\n    outline: outline;\n    display: table-cell;\n    vertical-align: middle;\n    text-align: left;\n    padding: 0 10px;\n\n    svg {\n      display: inline-block;\n    }\n\n    :focus {\n      outline: none !important;\n    }\n    span {\n      font-size: 10px;\n      padding: 0px 10px;\n    }\n  }\n`;\n\nfunction MenuItem({ icon, label, onClick }) {\n  return (\n    <button type=\"button\" className=\"menu-item\" onClick={onClick}>\n      {icon}\n      <span>{label}</span>\n    </button>\n  );\n}\n\nfunction MenuList({ items, boxBounding, onClick }) {\n  return (\n    <div\n      className=\"menu\"\n      style={{\n        transform: `translate(${boxBounding.width}px, -${boxBounding.height}px) `,\n      }}\n    >\n      {items &&\n        items.map((item) => {\n          return (\n            <MenuItem\n              key={`${item.id}`}\n              {...item}\n              onClick={() => onClick(item)}\n            />\n          );\n        })}\n    </div>\n  );\n}\n\nfunction MenuButton({\n  style,\n  component,\n  toolTip = '',\n  className,\n  items = [],\n  onClick = () => null,\n}) {\n  const menuButtonRef = useRef();\n  const [isShown, showMenu] = useState(false);\n\n  const closeMenuButton = useCallback(() => {\n    showMenu(false);\n  }, []);\n\n  const handleClick = useCallback(() => {\n    showMenu((flag) => !flag);\n  }, []);\n  const clickHandler = useCallback(\n    (e) => {\n      showMenu(false);\n      onClick(e);\n    },\n    [onClick],\n  );\n\n  return (\n    <div style={{ height: 'auto' }} css={menuStyles}>\n      <button\n        ref={menuButtonRef}\n        type=\"button\"\n        css={style}\n        onClick={handleClick}\n        className={className}\n        style={{ boxSizing: 'border-box' }}\n      >\n        <ToolTip title={toolTip} popupPlacement=\"right\">\n          {component}\n        </ToolTip>\n      </button>\n      {isShown && (\n        <MenuList\n          items={items}\n          boxBounding={menuButtonRef.current.getBoundingClientRect()}\n          onClick={clickHandler}\n        />\n      )}\n\n      {isShown && <div className=\"menu-cover\" onClick={closeMenuButton} />}\n    </div>\n  );\n}\n\nexport default MenuButton;\n","import { useMemo, memo, forwardRef } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\n\nfunction MoleculeWrapper(WrappedComponent) {\n  const Wrapper = (props) => {\n    const {\n      data,\n      activeSpectrum,\n      molecules,\n      displayerMode,\n      activeTab,\n    } = useChartData();\n\n    const { ranges = {}, zones = {} } = useMemo(() => {\n      if (data && activeSpectrum && activeSpectrum.id) {\n        const datum = data.find((datum) => datum.id === activeSpectrum.id) || {\n          ranges: {},\n          zones: {},\n        };\n        return datum;\n      }\n      return {};\n    }, [activeSpectrum, data]);\n\n    const { forwardedRef, ...rest } = props;\n    return (\n      <WrappedComponent\n        {...rest}\n        ranges={ranges}\n        zones={zones}\n        molecules={molecules}\n        displayerMode={displayerMode}\n        activeTab={activeTab}\n        ref={forwardedRef}\n      />\n    );\n  };\n\n  return memo(\n    forwardRef((props, ref) => {\n      return <Wrapper {...props} forwardedRef={ref} />;\n    }),\n  );\n}\nexport default MoleculeWrapper;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useState, useEffect, useCallback } from 'react';\nimport { StructureEditor } from 'react-ocl/full';\n\nimport { useDispatch } from '../context/DispatchContext';\nimport { Modal } from '../elements/popup/Modal';\nimport { SET_MOLECULE, ADD_MOLECULE } from '../reducer/types/Types';\n\nconst modalButtonStyle = css`\n  -moz-box-shadow: inset 0px 1px 0px 0px #ffffff;\n  -webkit-box-shadow: inset 0px 1px 0px 0px #ffffff;\n  box-shadow: inset 0px 1px 0px 0px #ffffff;\n  background: -webkit-gradient(\n    linear,\n    left top,\n    left bottom,\n    color-stop(0.05, #ffffff),\n    color-stop(1, #f6f6f6)\n  );\n  background: -moz-linear-gradient(top, #ffffff 5%, #f6f6f6 100%);\n  background: -webkit-linear-gradient(top, #ffffff 5%, #f6f6f6 100%);\n  background: -o-linear-gradient(top, #ffffff 5%, #f6f6f6 100%);\n  background: -ms-linear-gradient(top, #ffffff 5%, #f6f6f6 100%);\n  background: linear-gradient(to bottom, #ffffff 5%, #f6f6f6 100%);\n  filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#ffffff', endColorstr='#f6f6f6',GradientType=0);\n  background-color: #ffffff;\n  border: 0.55px solid #dcdcdc;\n  display: inline-block;\n  cursor: pointer;\n  color: #666666;\n  font-weight: bold;\n  padding: 6px 24px;\n  text-decoration: none;\n  text-shadow: 0px 1px 0px #ffffff;\n\n  :hover {\n    background: -webkit-gradient(\n      linear,\n      left top,\n      left bottom,\n      color-stop(0.05, #f6f6f6),\n      color-stop(1, #ffffff)\n    );\n    background: -moz-linear-gradient(top, #f6f6f6 5%, #ffffff 100%);\n    background: -webkit-linear-gradient(top, #f6f6f6 5%, #ffffff 100%);\n    background: -o-linear-gradient(top, #f6f6f6 5%, #ffffff 100%);\n    background: -ms-linear-gradient(top, #f6f6f6 5%, #ffffff 100%);\n    background: linear-gradient(to bottom, #f6f6f6 5%, #ffffff 100%);\n    filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#f6f6f6', endColorstr='#ffffff',GradientType=0);\n    background-color: #f6f6f6;\n  }\n`;\n\nfunction MoleculeStructureEditorModal(props) {\n  const { onClose, open, selectedMolecule } = props;\n  const [molfile, setMolfile] = useState(null);\n  const dispatch = useDispatch();\n\n  useEffect(() => {\n    if (selectedMolecule) {\n      setMolfile(selectedMolecule.molfile);\n    } else {\n      setMolfile(null);\n    }\n  }, [selectedMolecule, open]);\n\n  const cb = useCallback(\n    (newMolfile) => {\n      setMolfile(newMolfile);\n    },\n    [setMolfile],\n  );\n\n  const handleClose = useCallback(() => {\n    onClose();\n  }, [onClose]);\n\n  const handleSave = useCallback(() => {\n    if (selectedMolecule) {\n      dispatch({ type: SET_MOLECULE, molfile, key: selectedMolecule.key });\n      onClose('replace');\n    } else {\n      dispatch({ type: ADD_MOLECULE, molfile });\n      onClose('new');\n    }\n  }, [dispatch, selectedMolecule, molfile, onClose]);\n\n  const styles = {\n    footer: {\n      display: 'flex',\n      alignItems: 'flex-end',\n      justifyContent: 'flex-end',\n      margin: 5,\n    },\n  };\n\n  return (\n    <Modal open={open} onClose={handleClose}>\n      <StructureEditor\n        initialMolfile={selectedMolecule && selectedMolecule.molfile}\n        svgMenu\n        fragment={false}\n        onChange={cb}\n      />\n      <div style={styles.footer}>\n        <button type=\"button\" css={modalButtonStyle} onClick={handleClose}>\n          Close\n        </button>\n        <button type=\"button\" css={modalButtonStyle} onClick={handleSave}>\n          Save\n        </button>\n      </div>\n    </Modal>\n  );\n}\n\nexport default MoleculeStructureEditorModal;\n","/* eslint-disable prefer-named-capture-group */\n/* eslint-disable react/no-danger */\n\nfunction IsotopesViewer({ value = '', ...othersProps }) {\n  return (\n    <div\n      {...othersProps}\n      dangerouslySetInnerHTML={{\n        __html: value.replace(/([0-9]+)/g, '<sup>$1</sup>'),\n      }}\n    />\n  );\n}\n\nexport default IsotopesViewer;\n","import { useFormikContext } from 'formik';\nimport lodashGet from 'lodash/get';\nimport { useCallback, useEffect } from 'react';\n\nimport Select from '../Select';\n\nconst FormikSelect = function FormikSelect({\n  name,\n  value,\n  onChange,\n  ...resProps\n}) {\n  const { values, setFieldValue } = useFormikContext();\n  const changeHandler = useCallback(\n    (value) => {\n      onChange(value);\n      setFieldValue(name, value);\n    },\n    [name, onChange, setFieldValue],\n  );\n\n  useEffect(() => {\n    if (value) {\n      setFieldValue(name, value);\n    }\n  }, [name, setFieldValue, value]);\n\n  return (\n    <Select\n      name={name}\n      defaultValue={value ? value : lodashGet(values, name)}\n      onChange={changeHandler}\n      {...resProps}\n    />\n  );\n};\n// eslint-disable-next-line react/forbid-foreign-prop-types\nFormikSelect.propTypes = Select.propTypes;\nFormikSelect.defaultProps = Select.defaultProps;\n\nexport default FormikSelect;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback, useRef } from 'react';\n\nimport { useDispatch } from '../context/DispatchContext';\nimport CloseButton from '../elements/CloseButton';\nimport IsotopesViewer from '../elements/IsotopesViewer';\nimport FormikCheckBox from '../elements/formik/FormikCheckBox';\nimport FormikForm from '../elements/formik/FormikForm';\nimport FormikInput from '../elements/formik/FormikInput';\nimport FormikSelect from '../elements/formik/FormikSelect';\nimport { PREDICT_SPECTRA, SET_LOADING_FLAG } from '../reducer/types/Types';\n\nimport { ModalStyles } from './ModalStyle';\n\nconst styles = css`\n  .row {\n    align-items: center;\n  }\n\n  .inner-content {\n    flex: 1;\n  }\n\n  .custom-label {\n    width: 155px;\n  }\n`;\n\nconst FREQUENCIES = [\n  { key: 1, value: 60, label: '60 MHz' },\n  { key: 2, value: 100, label: '100 MHz' },\n  { key: 3, value: 200, label: '200 MHz' },\n  { key: 4, value: 300, label: '300 MHz' },\n  { key: 5, value: 400, label: '400 MHz' },\n  { key: 6, value: 500, label: '500 MHz' },\n  { key: 7, value: 600, label: '600 MHz' },\n  { key: 8, value: 800, label: '800 MHz' },\n  { key: 9, value: 1000, label: '1000 MHz' },\n  { key: 10, value: 1200, label: '1200 MHz' },\n];\n\nconst INITIAL_VALUE = {\n  '1h': { from: -1, to: 12 },\n  '13c': { from: -5, to: 220 },\n  frequency: 400,\n  spectra: {\n    '1h': true,\n    '13c': false,\n    cosy: false,\n    hsqc: false,\n    hmbc: false,\n  },\n};\n\nfunction PredictSpectraModal({ onClose, molfile }) {\n  const refForm = useRef();\n  const dispatch = useDispatch();\n\n  const handleSave = useCallback(() => {\n    refForm.current.submitForm();\n  }, []);\n\n  const submitHandler = useCallback(\n    (values) => {\n      dispatch({\n        type: SET_LOADING_FLAG,\n        isLoading: true,\n      });\n      dispatch({\n        type: PREDICT_SPECTRA,\n        payload: { mol: molfile, options: values },\n      });\n      onClose();\n    },\n    [dispatch, molfile, onClose],\n  );\n\n  return (\n    <div css={[ModalStyles, styles]}>\n      <div className=\"header handle\">\n        <span>Predict Spectra</span>\n        <CloseButton onClick={onClose} className=\"close-bt\" />\n      </div>\n      <div className=\"inner-content\">\n        <FormikForm\n          ref={refForm}\n          initialValues={INITIAL_VALUE}\n          onSubmit={submitHandler}\n        >\n          <div className=\"row margin-10\">\n            <span className=\"custom-label\">Spectrometer Frequency :</span>\n\n            <FormikSelect\n              data={FREQUENCIES}\n              style={{ width: 290, height: 30, margin: 0 }}\n              name=\"frequency\"\n            />\n          </div>\n          <div className=\"row margin-10\">\n            <IsotopesViewer value=\"1H\" className=\"custom-label\" />\n            <FormikInput\n              label=\"From\"\n              name=\"1h.from\"\n              type=\"number\"\n              style={{ label: { padding: '0 10px 0 0' } }}\n            />\n            <FormikInput\n              label=\"To\"\n              name=\"1h.to\"\n              type=\"number\"\n              style={{ label: { padding: '0 10px' } }}\n            />\n          </div>\n          <div className=\"row margin-10\">\n            <IsotopesViewer value=\"13C\" className=\"custom-label\" />\n            <FormikInput\n              label=\"From\"\n              name=\"13c.from\"\n              type=\"number\"\n              style={{ label: { padding: '0 10px 0 0' } }}\n            />\n            <FormikInput\n              label=\"To\"\n              name=\"13c.to\"\n              type=\"number\"\n              style={{ label: { padding: '0 10px' } }}\n            />\n          </div>\n          <div className=\"row margin-10\">\n            <span className=\"custom-label\">Spectra </span>\n          </div>\n          <div\n            className=\"row margin-10\"\n            style={{ justifyContent: 'space-between' }}\n          >\n            <div className=\"row\">\n              <FormikCheckBox name=\"spectra.1h\" />\n              <IsotopesViewer value=\"1H\" style={{ padding: ' 0 10px' }} />\n            </div>\n            <div className=\"row\">\n              <FormikCheckBox disabled name=\"spectra.13c\" />\n              <IsotopesViewer value=\"13C\" style={{ padding: ' 0 10px' }} />\n            </div>\n            <div className=\"row\">\n              <FormikCheckBox disabled name=\"spectra.cosy\" />\n              <IsotopesViewer value=\"cosy\" style={{ padding: ' 0 10px' }} />\n            </div>\n            <div className=\"row\">\n              <FormikCheckBox disabled name=\"spectra.hsqc\" />\n              <IsotopesViewer value=\"HSQC\" style={{ padding: ' 0 10px' }} />\n            </div>\n            <div className=\"row\">\n              <FormikCheckBox disabled name=\"spectra.hmbc\" />\n              <IsotopesViewer value=\"HMBC\" style={{ padding: ' 0 10px' }} />\n            </div>\n          </div>\n        </FormikForm>\n      </div>\n      <div className=\"footer-container\">\n        <button type=\"button\" onClick={handleSave} className=\"save-button\">\n          Start Predicting\n        </button>\n      </div>\n    </div>\n  );\n}\n\nexport default PredictSpectraModal;\n","import { DISPLAYER_MODE } from '../../reducer/core/Constants';\n\nconst extractFromAtom = (atom, elements, activeAxis) => {\n  if (elements.length > 0 && Object.keys(atom).length > 0) {\n    const dim = activeAxis === 'x' ? 0 : activeAxis === 'y' ? 1 : undefined;\n    if (dim !== undefined) {\n      if (elements[dim] === atom.atomLabel) {\n        // take always oclID if atom type is same as element of activeTab)\n        return { oclIDs: [atom.oclID], nbAtoms: atom.nbAtoms };\n      }\n      if (elements[dim] === 'H') {\n        // if we are in proton spectrum and use then the IDs of attached hydrogens of an atom\n        return {\n          oclIDs: atom.hydrogenOCLIDs,\n          nbAtoms: atom.nbAtoms * atom.nbHydrogens,\n        };\n      }\n    } else {\n      return {\n        oclIDs: [atom.oclID].concat(atom.hydrogenOCLIDs),\n        nbAtoms: atom.nbAtoms + atom.nbAtoms * atom.nbHydrogens,\n      };\n    }\n  }\n\n  return { oclIDs: [], nbAtoms: 0 };\n};\n\nconst findDatumAndSignalIndex = (spectraData, id) => {\n  // if datum could be found then the id is on range/zone level\n  let datum = spectraData.find((_datum) => _datum.id === id);\n  let signalIndex;\n  if (!datum) {\n    // figure out the datum via id\n    for (let i = 0; i < spectraData.length; i++) {\n      signalIndex = spectraData[i].signal.findIndex(\n        (_signal) => _signal.id === id,\n      );\n      if (signalIndex >= 0) {\n        datum = spectraData[i];\n        break;\n      }\n    }\n  }\n\n  return { datum, signalIndex };\n};\n\nconst getHighlightsOnHover = (assignmentData, oclIDs, spectraData) => {\n  // set all IDs to highlight when hovering over an atom from assignment data\n  let highlights = [];\n  for (let key in assignmentData.assignment.assignment) {\n    let datum, signalIndex;\n    let stop = false;\n    if (\n      assignmentData.assignment.assignment[key].x &&\n      assignmentData.assignment.assignment[key].x.some((_assigned) =>\n        oclIDs.includes(_assigned),\n      )\n    ) {\n      highlights = highlights.concat(\n        assignmentData.assignment.assignment[key].x,\n      );\n      const result = findDatumAndSignalIndex(spectraData, key);\n      datum = result.datum;\n      signalIndex = result.signalIndex;\n      stop = true;\n    }\n    if (\n      assignmentData.assignment.assignment[key].y &&\n      assignmentData.assignment.assignment[key].y.some((_assigned) =>\n        oclIDs.includes(_assigned),\n      )\n    ) {\n      highlights = highlights.concat(\n        assignmentData.assignment.assignment[key].y,\n      );\n      const result = findDatumAndSignalIndex(spectraData, key);\n      datum = result.datum;\n      signalIndex = result.signalIndex;\n      stop = true;\n    }\n    if (datum) {\n      highlights.push(datum.id);\n      if (signalIndex !== undefined) {\n        highlights.push(datum.signal[signalIndex].id);\n      }\n    }\n    if (stop) {\n      break;\n    }\n  }\n  return highlights;\n};\n\nconst getCurrentDiaIDsToHighlight = (assignmentData, displayerMode) => {\n  const assignmentOnHover = assignmentData.assignment.isOnHover\n    ? assignmentData.assignment.assignment[assignmentData.assignment.onHoverID]\n    : null;\n\n  const axisOnHover = assignmentData.assignment.isOnHover\n    ? assignmentData.assignment.onHoverAxis\n    : null;\n\n  return assignmentOnHover\n    ? displayerMode === DISPLAYER_MODE.DM_1D\n      ? assignmentOnHover.x || []\n      : displayerMode === DISPLAYER_MODE.DM_2D\n      ? axisOnHover\n        ? axisOnHover === 'x'\n          ? assignmentOnHover.x || []\n          : axisOnHover === 'y'\n          ? assignmentOnHover.y || []\n          : (assignmentOnHover.x || []).concat(assignmentOnHover.y || [])\n        : (assignmentOnHover.x || []).concat(assignmentOnHover.y || [])\n      : []\n    : [];\n};\n\nconst toggleDiaIDs = (diaID, atomInformation) => {\n  let _diaID = diaID ? diaID.slice() : [];\n  if (atomInformation.oclIDs.length === 1) {\n    if (_diaID.includes(atomInformation.oclIDs[0])) {\n      _diaID = _diaID.filter((_id) => _id !== atomInformation.oclIDs[0]);\n    } else {\n      for (let i = 0; i < atomInformation.nbAtoms; i++) {\n        _diaID.push(atomInformation.oclIDs[0]);\n      }\n    }\n  } else if (atomInformation.oclIDs.length > 1) {\n    atomInformation.oclIDs.forEach((_oclID) => {\n      if (_diaID.includes(_oclID)) {\n        _diaID = _diaID.filter((_id) => _id !== _oclID);\n      } else {\n        _diaID.push(_oclID);\n      }\n    });\n  }\n  return _diaID;\n};\n\nexport {\n  extractFromAtom,\n  findDatumAndSignalIndex,\n  getCurrentDiaIDsToHighlight,\n  getHighlightsOnHover,\n  toggleDiaIDs,\n};\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { SvgNmrFt } from 'cheminfo-font';\nimport OCL from 'openchemlib/full';\nimport { useState, useCallback, useMemo, useEffect, memo } from 'react';\nimport {\n  FaPlus,\n  FaPaste,\n  FaRegTrashAlt,\n  FaFileExport,\n  FaDownload,\n  FaFileImage,\n  FaCopy,\n} from 'react-icons/fa';\nimport { MF } from 'react-mf';\nimport OCLnmr from 'react-ocl-nmr';\nimport { useMeasure } from 'react-use';\n\nimport { ConcatenationString } from '../../../data/utilities/Concatenation';\nimport { useAssignmentData, useAssignment } from '../../assignment';\nimport { useDispatch } from '../../context/DispatchContext';\nimport ButtonToolTip from '../../elements/ButtonToolTip';\nimport MenuButton from '../../elements/MenuButton';\nimport NextPrev from '../../elements/NextPrev';\nimport ToolTip from '../../elements/ToolTip/ToolTip';\nimport { positions, useAlert } from '../../elements/popup/Alert';\nimport { useModal } from '../../elements/popup/Modal';\nimport { useHighlightData } from '../../highlight';\nimport MoleculeWrapper from '../../hoc/MoleculeWrapper';\nimport MoleculeStructureEditorModal from '../../modal/MoleculeStructureEditorModal';\nimport PredictSpectraModal from '../../modal/PredictSpectraModal';\nimport { DISPLAYER_MODE } from '../../reducer/core/Constants';\nimport {\n  ADD_MOLECULE,\n  DELETE_MOLECULE,\n  SET_DIAID_RANGE,\n  SET_DIAID_ZONE,\n  SET_MOLECULE,\n} from '../../reducer/types/Types';\nimport {\n  copyTextToClipboard,\n  copyPNGToClipboard,\n  exportAsSVG,\n} from '../../utility/Export';\n\nimport {\n  extractFromAtom,\n  findDatumAndSignalIndex,\n  getCurrentDiaIDsToHighlight,\n  getHighlightsOnHover,\n  toggleDiaIDs,\n} from './Utilities';\n\nconst panelContainerStyle = css`\n  display: flex;\n  flex-direction: column;\n  flex-grow: 1;\n  width: 100%;\n  height: 100%;\n`;\n\nconst toolbarStyle = css`\n  display: flex;\n  flex-direction: row;\n  border-bottom: 0.55px solid rgb(240, 240, 240);\n  padding: 0px 5px;\n\n  button svg {\n    fill: #4e4e4e;\n  }\n\n  button {\n    background-color: transparent;\n    border: none;\n    padding: 5px;\n  }\n\n  p {\n    margin: 0;\n    text-align: right;\n    width: 100%;\n    line-height: 22px;\n    padding: 0px 10px;\n  }\n`;\n\nconst moleculeContainerStyle = css`\n  width: 100%;\n  height: 100%;\n\n  .slider {\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    align-items: center;\n    height: 100%;\n    padding: 0px;\n    .mol-svg-container {\n      height: calc(100% - 25px);\n      width: 100%;\n      div {\n        width: 100%;\n        height: 100%;\n      }\n    }\n\n    p {\n      width: 100%;\n      margin: 0 auto;\n      display: block;\n      position: relative;\n      text-align: center;\n    }\n\n    svg polygon {\n      fill: gray !important;\n    }\n  }\n`;\n\nconst MOL_EXPORT_MENU = [\n  {\n    id: 'molfile',\n    icon: <FaCopy />,\n    label: 'Copy as molfile',\n  },\n  {\n    id: 'png',\n    icon: <FaFileImage />,\n    label: 'Copy as PNG',\n  },\n  {\n    id: 'svg',\n    icon: <FaDownload />,\n    label: 'Export as SVG',\n  },\n];\n\nfunction MoleculePanel({ zones, ranges, molecules, activeTab, displayerMode }) {\n  const [refContainer, { width, height }] = useMeasure();\n  const [open, setOpen] = useState(false);\n  const [currentMolfile, setCurrentMolfile] = useState();\n  const [currentIndex, setCurrentIndex] = useState(0);\n  const [onAtomHoverHighlights, setOnAtomHoverHighlights] = useState([]);\n  const [onAtomHoverAction, setOnAtomHoverAction] = useState(null);\n\n  const dispatch = useDispatch();\n  const alert = useAlert();\n  const modal = useModal();\n\n  const highlightData = useHighlightData();\n  const assignmentData = useAssignmentData();\n  const [elements, setElements] = useState([]);\n\n  useEffect(() => {\n    if (activeTab) {\n      const split = activeTab.split(',');\n      if (split.length === 1) {\n        setElements([activeTab.replace(/[0-9]/g, '')]);\n      } else if (split.length === 2) {\n        setElements(split.map((nucleus) => nucleus.replace(/[0-9]/g, '')));\n      }\n    } else {\n      setElements([]);\n    }\n  }, [activeTab]);\n\n  const activeAssignment = useAssignment(\n    assignmentData.assignment.activeID !== undefined\n      ? assignmentData.assignment.activeID\n      : ConcatenationString, // dummy value\n  );\n\n  const data = useMemo(() => {\n    if (zones || ranges) {\n      if (displayerMode === DISPLAYER_MODE.DM_1D && ranges && ranges.values) {\n        return ranges.values;\n      } else if (\n        displayerMode === DISPLAYER_MODE.DM_2D &&\n        zones &&\n        zones.values\n      ) {\n        return zones.values;\n      }\n    }\n    return [];\n  }, [displayerMode, ranges, zones]);\n\n  const assignedDiaIDs = useMemo(() => {\n    const assignedDiaID = { x: [], y: [] };\n    for (let id in assignmentData.assignment.assignment) {\n      if (assignmentData.assignment.assignment[id].x) {\n        assignedDiaID.x.push(...assignmentData.assignment.assignment[id].x);\n      }\n      if (assignmentData.assignment.assignment[id].y) {\n        assignedDiaID.y.push(...assignmentData.assignment.assignment[id].y);\n      }\n    }\n    // with its structure it's prepared for showing assigned IDs per axis\n    return assignedDiaID;\n  }, [assignmentData.assignment]);\n\n  // used for atom highlighting for now, until we would like to highlight atoms per axis separately\n  const assignedDiaIDsMerged = useMemo(\n    () => assignedDiaIDs.x.concat(assignedDiaIDs.y),\n    [assignedDiaIDs.x, assignedDiaIDs.y],\n  );\n\n  const toggleAssignment = useCallback(\n    (diaID, atomInformation) => {\n      // 1. one atom can only be assigned to one range/zone/signal\n      // 2. check whether an atom is already assigned to a range to allow toggling the assignment\n      if (\n        assignedDiaIDsMerged.some((_oclID) =>\n          atomInformation.oclIDs.includes(_oclID),\n        ) &&\n        !diaID.some((_oclID) => atomInformation.oclIDs.includes(_oclID))\n      ) {\n        alert.info('Atom is already assigned to another signal!');\n        return diaID;\n      }\n\n      return toggleDiaIDs(diaID, atomInformation);\n    },\n    [alert, assignedDiaIDsMerged],\n  );\n\n  const handleOnClickAtom = useCallback(\n    (atom) => {\n      if (activeAssignment.isActive) {\n        const atomInformation = extractFromAtom(\n          atom,\n          elements,\n          activeAssignment.activeAxis,\n        );\n        if (atomInformation.nbAtoms > 0) {\n          // save assignment in assignment hook\n          atomInformation.oclIDs.forEach((_oclID) => {\n            activeAssignment.toggle(_oclID);\n          });\n          // save assignment (diaIDs) in range/zone data\n          const { datum, signalIndex } = findDatumAndSignalIndex(\n            data,\n            activeAssignment.id,\n          );\n          if (datum) {\n            // determine the level of setting the diaID array (range vs. signal level) and save there\n            let _diaID = [];\n            // on range/zone level\n            if (signalIndex === undefined) {\n              if (displayerMode === DISPLAYER_MODE.DM_1D) {\n                _diaID = toggleAssignment(datum.diaID || [], atomInformation);\n              } else if (displayerMode === DISPLAYER_MODE.DM_2D) {\n                _diaID = toggleAssignment(\n                  datum[activeAssignment.activeAxis].diaID || [],\n                  atomInformation,\n                );\n              }\n            } else if (datum.signal && datum.signal[signalIndex]) {\n              // on signal level\n              if (displayerMode === DISPLAYER_MODE.DM_1D) {\n                _diaID = toggleAssignment(\n                  datum.signal[signalIndex].diaID || [],\n                  atomInformation,\n                );\n              } else if (displayerMode === DISPLAYER_MODE.DM_2D) {\n                _diaID = toggleAssignment(\n                  datum.signal[signalIndex][activeAssignment.activeAxis]\n                    .diaID || [],\n                  atomInformation,\n                );\n              }\n            }\n            if (displayerMode === DISPLAYER_MODE.DM_1D) {\n              dispatch({\n                type: SET_DIAID_RANGE,\n                payload: {\n                  rangeData: datum,\n                  diaID: _diaID,\n                  signalIndex,\n                },\n              });\n            } else if (displayerMode === DISPLAYER_MODE.DM_2D) {\n              dispatch({\n                type: SET_DIAID_ZONE,\n                payload: {\n                  zoneData: datum,\n                  diaID: _diaID,\n                  axis: activeAssignment.activeAxis,\n                  signalIndex,\n                },\n              });\n            }\n          }\n        } else {\n          alert.info(\n            'Not assigned! Different atom type or no attached hydrogens found!',\n          );\n        }\n      }\n    },\n    [\n      activeAssignment,\n      alert,\n      data,\n      dispatch,\n      displayerMode,\n      elements,\n      toggleAssignment,\n    ],\n  );\n\n  const currentDiaIDsToHighlight = useMemo(() => {\n    return getCurrentDiaIDsToHighlight(assignmentData, displayerMode);\n  }, [assignmentData, displayerMode]);\n\n  useEffect(() => {\n    if (onAtomHoverAction) {\n      if (onAtomHoverAction === 'show') {\n        highlightData.dispatch({\n          type: 'SHOW',\n          payload: { convertedHighlights: onAtomHoverHighlights },\n        });\n      } else if (onAtomHoverAction === 'hide') {\n        highlightData.dispatch({\n          type: 'HIDE',\n          payload: { convertedHighlights: onAtomHoverHighlights },\n        });\n        setOnAtomHoverHighlights([]);\n      }\n      setOnAtomHoverAction(null);\n    }\n  }, [onAtomHoverAction, onAtomHoverHighlights, highlightData]);\n\n  const handleOnAtomHover = useCallback(\n    (atom) => {\n      const oclIDs = extractFromAtom(\n        atom,\n        elements,\n        activeAssignment.activeAxis,\n      ).oclIDs;\n      // on enter the atom\n      if (oclIDs.length > 0) {\n        // set all IDs to highlight when hovering over an atom from assignment data\n        const highlights = getHighlightsOnHover(assignmentData, oclIDs, data);\n        setOnAtomHoverHighlights(highlights);\n        setOnAtomHoverAction('show');\n      } else {\n        // on leave the atom\n        setOnAtomHoverAction('hide');\n      }\n    },\n    [activeAssignment.activeAxis, assignmentData, data, elements],\n  );\n\n  const handleClose = useCallback(\n    (e) => {\n      setOpen(false);\n      if (e === 'new') {\n        setCurrentIndex(molecules.length);\n      }\n    },\n    [molecules.length],\n  );\n\n  const handleOpen = useCallback((event, key, molfile) => {\n    if (molfile) {\n      setCurrentMolfile({ molfile, key });\n    } else {\n      setCurrentMolfile(null);\n    }\n    setOpen(true);\n  }, []);\n\n  const handlePaste = useCallback(() => {\n    navigator.clipboard.readText().then((molfile) => {\n      dispatch({ type: ADD_MOLECULE, molfile });\n    });\n  }, [dispatch]);\n\n  const handleDelete = useCallback(() => {\n    if (molecules[currentIndex] && molecules[currentIndex].key) {\n      setCurrentIndex(0);\n      dispatch({\n        type: DELETE_MOLECULE,\n        payload: { key: molecules[currentIndex].key, assignmentData },\n      });\n    }\n  }, [molecules, currentIndex, assignmentData, dispatch]);\n\n  const saveAsSVGHandler = useCallback(() => {\n    exportAsSVG('molFile', `molSVG${currentIndex}`);\n  }, [currentIndex]);\n\n  const saveAsPNGHandler = useCallback(() => {\n    copyPNGToClipboard(`molSVG${currentIndex}`);\n    alert.success('MOL copied as PNG to clipboard');\n  }, [alert, currentIndex]);\n\n  const saveAsMolHandler = useCallback(() => {\n    if (molecules[currentIndex]) {\n      const flag = copyTextToClipboard(molecules[currentIndex].molfile);\n      if (flag) {\n        alert.success('MOLFile copied to clipboard');\n      } else {\n        alert.error('copied not completed');\n      }\n    }\n  }, [alert, currentIndex, molecules]);\n\n  const handleReplaceMolecule = useCallback(\n    (key, molfile) => {\n      dispatch({ type: SET_MOLECULE, molfile, key });\n    },\n    [dispatch],\n  );\n\n  const openPredicSpectraModal = useCallback(() => {\n    modal.show(\n      <PredictSpectraModal\n        onSave={() => {\n          modal.close();\n        }}\n        molfile={molecules[currentIndex]}\n      />,\n      {\n        position: positions.TOP_CENTER,\n        enableResizing: true,\n        width: 600,\n        height: 350,\n      },\n    );\n  }, [modal, molecules, currentIndex]);\n\n  const exportHandler = useCallback(\n    ({ id }) => {\n      switch (id) {\n        case 'molfile':\n          saveAsMolHandler();\n          break;\n        case 'png':\n          saveAsPNGHandler();\n          break;\n        case 'svg':\n          saveAsSVGHandler();\n          break;\n        default:\n          break;\n      }\n    },\n    [saveAsMolHandler, saveAsPNGHandler, saveAsSVGHandler],\n  );\n\n  return (\n    <div css={panelContainerStyle}>\n      <div css={toolbarStyle}>\n        <MenuButton\n          component={<FaFileExport />}\n          toolTip=\"Export As\"\n          items={MOL_EXPORT_MENU}\n          onClick={exportHandler}\n        />\n\n        <ToolTip title=\"Paste molfile\" popupPlacement=\"left\">\n          <button className=\"bar-button\" type=\"button\" onClick={handlePaste}>\n            <FaPaste />\n          </button>\n        </ToolTip>\n        <ToolTip title=\"Add Molecule\" popupPlacement=\"left\">\n          <button className=\"bar-button\" type=\"button\" onClick={handleOpen}>\n            <FaPlus />\n          </button>\n        </ToolTip>\n        <ToolTip title=\"Delete Molecule\" popupPlacement=\"left\">\n          <button className=\"bar-button\" type=\"button\" onClick={handleDelete}>\n            <FaRegTrashAlt />\n          </button>\n        </ToolTip>\n        <ButtonToolTip\n          popupTitle=\"Predict Spectra\"\n          popupPlacement=\"left\"\n          onClick={openPredicSpectraModal}\n          disabled={!molecules || molecules.length === 0}\n        >\n          <SvgNmrFt />\n        </ButtonToolTip>\n        <p>\n          {molecules &&\n            molecules.length > 0 &&\n            `${+(currentIndex + 1)} / ${molecules.length}`}{' '}\n        </p>\n      </div>\n      <div css={moleculeContainerStyle}>\n        <NextPrev\n          onChange={(slideIndex) => setCurrentIndex(slideIndex)}\n          defaultIndex={currentIndex}\n        >\n          {molecules && molecules.length > 0 ? (\n            molecules.map((mol, index) => (\n              <div\n                className=\"slider\"\n                key={mol.key}\n                onDoubleClick={(event) =>\n                  handleOpen(event, mol.key, mol.molfile)\n                }\n                style={{\n                  backgroundColor: (index + 1) % 2 !== 0 ? '#fafafa' : 'white',\n                }}\n              >\n                <div className=\"mol-svg-container\" ref={refContainer}>\n                  <OCLnmr\n                    OCL={OCL}\n                    id={`molSVG${index}`}\n                    width={width > 0 ? width : 100}\n                    height={height > 0 ? height : 100}\n                    molfile={mol.molfile}\n                    setMolfile={(molfile) =>\n                      handleReplaceMolecule(mol.key, molfile)\n                    }\n                    setSelectedAtom={handleOnClickAtom}\n                    atomHighlightColor={\n                      currentDiaIDsToHighlight &&\n                      currentDiaIDsToHighlight.length > 0\n                        ? 'red'\n                        : '#FFD700'\n                    }\n                    atomHighlightOpacity={0.35}\n                    highlights={\n                      currentDiaIDsToHighlight &&\n                      currentDiaIDsToHighlight.length > 0\n                        ? currentDiaIDsToHighlight\n                        : assignedDiaIDsMerged\n                    }\n                    setHoverAtom={handleOnAtomHover}\n                  />\n                </div>\n                <p>\n                  <MF mf={mol.mf} /> - {mol.mw.toFixed(2)}\n                </p>\n              </div>\n            ))\n          ) : (\n            <div\n              style={{ width: '100%', height: '100%' }}\n              onClick={handleOpen}\n            />\n          )}\n        </NextPrev>\n\n        <MoleculeStructureEditorModal\n          open={open}\n          onClose={handleClose}\n          selectedMolecule={currentMolfile}\n        />\n      </div>\n    </div>\n  );\n}\n\nexport default MoleculeWrapper(memo(MoleculePanel));\n","import lodashGet from 'lodash/get';\nimport isEmpty from 'lodash/isEmpty';\n\nimport generateChar from '../utilities/generateChar';\n\nimport { detectRange } from './Datum1D';\n\nexport const COLUMNS_TYPES = {\n  NORMAL: 'NORMAL',\n  FORMULA: 'FORMULA',\n};\n\nlet reservedColumnsNames = {};\n\nfunction addColumnKey(spectraAnalysis, nucleus, columnProps, columnKey) {\n  const index = Object.keys(spectraAnalysis[nucleus].options.columns).length;\n  const key = columnKey ? columnKey : generateChar(index).toUpperCase();\n  spectraAnalysis[nucleus].options.columns[key] = columnProps;\n  return key;\n}\n\nexport function getColumns(spectraAnalysis, nucleus) {\n  return spectraAnalysis[nucleus].options.columns;\n}\n\nexport function getValue(colKey, columns, data) {\n  return data[columns[colKey].valueKey];\n}\n\nexport function getSpectraAnalysis(spectra, options) {\n  const { from, to, nucleus } = options;\n  return spectra.reduce(\n    (acc, datum) => {\n      if (\n        datum.info.dimension === 1 &&\n        datum.info.nucleus === nucleus &&\n        !datum.info.isFid\n      ) {\n        const range = detectRange(datum, { from, to });\n        acc.sum += range.absolute;\n        acc.values.push({ SID: datum.id, ...range });\n      }\n      return acc;\n    },\n    { values: [], sum: 0 },\n  );\n}\n\nfunction init(spectraAnalysis, nucleus) {\n  if (spectraAnalysis[nucleus] === undefined) {\n    spectraAnalysis[nucleus] = {\n      options: {\n        sum: 100,\n        code: null,\n        columns: {},\n      },\n      values: {},\n    };\n  }\n}\n\nexport function changeColumnValueKey(\n  spectraAnalysis,\n  nucleus,\n  columnKey,\n  newKey,\n) {\n  spectraAnalysis[nucleus].options.columns[columnKey].valueKey = newKey;\n\n  spectraAnalysis[nucleus].values = refreshCalculation(\n    spectraAnalysis,\n    nucleus,\n  );\n}\n\nexport function setColumn(\n  spectraAnalysis,\n  nucleus,\n  { columns: inputColumns, code },\n) {\n  init(spectraAnalysis, nucleus);\n  spectraAnalysis[nucleus].options.code = code;\n  spectraAnalysis[nucleus].options.columns = Object.values(inputColumns).reduce(\n    (acc, value) => {\n      const data = { ...value };\n      delete data.tempKey;\n      acc[value.tempKey] = data;\n      return acc;\n    },\n    {},\n  );\n\n  const { columns: newColumns } = spectraAnalysis[nucleus].options;\n\n  let data = Object.entries(spectraAnalysis[nucleus].values).reduce(\n    (outerAcc, [spectraKey, spectra]) => {\n      outerAcc[spectraKey] = Object.keys(inputColumns).reduce((acc, key) => {\n        const newKey = inputColumns[key].tempKey;\n        if (spectra[key]) {\n          acc[newKey] = spectra[key];\n        }\n        return acc;\n      }, {});\n      return outerAcc;\n    },\n    {},\n  );\n\n  data = Object.entries(data).reduce((acc, spectra) => {\n    acc[spectra[0]] = Object.keys(newColumns).reduce((acc, key) => {\n      const isFormula = newColumns[key].type === COLUMNS_TYPES.FORMULA;\n      acc[key] = isFormula\n        ? {\n            colKey: key,\n            value: calculate(\n              newColumns,\n              data[spectra[0]],\n              newColumns[key].formula,\n            ),\n          }\n        : { ...spectra[1][key], colKey: key };\n\n      return acc;\n    }, {});\n\n    return acc;\n  }, {});\n  spectraAnalysis[nucleus].values = data;\n}\n\nfunction refreshByRow(row, columns) {\n  return Object.keys(columns).reduce((acc, key) => {\n    if (columns[key].type === COLUMNS_TYPES.FORMULA) {\n      acc[key] = {\n        colKey: key,\n        ...row,\n        value: calculate(columns, row, columns[key].formula),\n      };\n    }\n\n    return acc;\n  }, {});\n}\n\nfunction refreshCalculation(spectraAnalysis, nucleus) {\n  const { columns } = spectraAnalysis[nucleus].options;\n\n  const data = Object.entries(spectraAnalysis[nucleus].values).reduce(\n    (acc, spectra) => {\n      const [id, row] = spectra;\n      acc[id] = {\n        ...row,\n        ...refreshByRow(row, columns),\n      };\n      return acc;\n    },\n    {},\n  );\n\n  return data;\n}\n\nexport function analyzeSpectra(spectra, spectraAnalysis, options) {\n  const { from, to, nucleus, columnKey = null } = options;\n  init(spectraAnalysis, nucleus);\n  const colKey = addColumnKey(\n    spectraAnalysis,\n    nucleus,\n    {\n      type: COLUMNS_TYPES.NORMAL,\n      valueKey: 'relative',\n      from,\n      to,\n      index: 1,\n    },\n    columnKey,\n  );\n\n  const { sum } = spectraAnalysis[nucleus].options;\n\n  const { values: result, sum: spectraSum } = getSpectraAnalysis(spectra, {\n    from,\n    to,\n    nucleus,\n  });\n\n  const prevNucleusData = lodashGet(spectraAnalysis, `${nucleus}.values`, {});\n\n  let data = result.reduce((acc, row) => {\n    const factor = spectraSum > 0 ? sum / spectraSum : 0.0;\n\n    acc[row.SID] = {\n      ...prevNucleusData[row.SID],\n      [colKey]: {\n        colKey,\n        ...row,\n        relative: Math.abs(row.absolute) * factor,\n      },\n    };\n    return acc;\n  }, {});\n\n  spectraAnalysis[nucleus].values = data;\n  spectraAnalysis[nucleus].values = refreshCalculation(\n    spectraAnalysis,\n    nucleus,\n  );\n}\n\nexport function deleteSpectraAnalysis(spectraAnalysis, colKey, nucleus) {\n  const result = Object.entries(spectraAnalysis[nucleus].values).reduce(\n    (acc, item) => {\n      delete item[1][colKey];\n      if (item[1] && Object.keys(item[1]).length > 0) {\n        acc[item[0]] = item[1];\n        return acc;\n      }\n      return acc;\n    },\n    {},\n  );\n\n  delete spectraAnalysis[nucleus].options.columns[colKey];\n  spectraAnalysis[nucleus].values = result;\n  spectraAnalysis[nucleus].values = refreshCalculation(\n    spectraAnalysis,\n    nucleus,\n  );\n\n  if (isEmpty(spectraAnalysis[nucleus].values)) {\n    reservedColumnsNames[nucleus] = [];\n  }\n}\n\nfunction calculate(columns, data, formula = 'A+B') {\n  const array = formula.split(/\\+|-|\\*|\\/|%|\\(|\\)/);\n\n  const variables = [];\n\n  for (let i of array) {\n    const l = i.trim();\n    if (columns[l]) {\n      variables.push(l);\n    }\n  }\n\n  const params = variables.map((key) =>\n    data[key] ? data[key][columns[key].valueKey] : null,\n  );\n\n  let result;\n  try {\n    // eslint-disable-next-line no-new-func\n    result = new Function(...variables, `return ${formula}`)(...params);\n  } catch (e) {\n    // eslint-disable-next-line no-console\n    console.log(e);\n    result = new Error(`Invalid Formula ( ${formula} ) `);\n  }\n  return result;\n}\nexport function getDataAsString(spectraAnalysis, nucleus) {\n  if (spectraAnalysis && spectraAnalysis[nucleus]) {\n    const {\n      values,\n      options: { columns },\n    } = spectraAnalysis[nucleus];\n\n    let result = '';\n\n    for (const letter in columns) {\n      result += `${letter}\\t`;\n    }\n    result += '\\n';\n\n    for (const spectrum of Object.values(values)) {\n      for (const letter in columns) {\n        result += `${spectrum[letter][columns[letter].valueKey]}\\t`;\n      }\n      result += '\\n';\n    }\n    return result;\n  }\n  return null;\n}\n","export default function getChar(index) {\n  const aPotions = 'a'.charCodeAt(0);\n  const zPostion = 'z'.charCodeAt(0);\n  const len = zPostion - aPotions + 1;\n\n  let chartResult = '';\n  while (index >= 0) {\n    chartResult = String.fromCharCode((index % len) + aPotions) + chartResult;\n    index = Math.floor(index / len) - 1;\n  }\n  return chartResult;\n}\n","const REFERENCES = {\n  '1H': {\n    tms: {\n      from: -0.1,\n      to: 0.1,\n      nbPeaks: 1,\n      delta: 0,\n    },\n    tsp: {\n      from: -0.1,\n      to: 0.1,\n      nbPeaks: 1,\n      delta: 0,\n    },\n    glucose: {\n      from: 5.18,\n      to: 5.28,\n      nbPeaks: 2,\n      delta: 5.23,\n    },\n  },\n  '13C': {},\n};\n\nfunction getRange(options = {}) {\n  const { nucleus = '1H', reference = 'tms' } = options;\n\n  if (!REFERENCES[nucleus]) {\n    throw new Error('Nucleus not found: ', nucleus);\n  }\n\n  let info = REFERENCES[nucleus][reference.toLowerCase()];\n\n  if (!info) {\n    throw new Error('Reference not found: ', reference);\n  }\n\n  return {\n    from: info.delta - 0.05,\n    to: info.delta + 0.05,\n    delta: info.delta,\n    nbPeaks: info.nbPeaks,\n  };\n}\n\nexport { REFERENCES, getRange };\n","/** @jsxImportSource @emotion/react */\nimport { useCallback, useEffect, useMemo, useRef } from 'react';\n\nimport { REFERENCES } from '../../data/constants/References';\nimport { useDispatch } from '../context/DispatchContext';\nimport CloseButton from '../elements/CloseButton';\nimport Select from '../elements/Select';\nimport FormikForm from '../elements/formik/FormikForm';\nimport FormikInput from '../elements/formik/FormikInput';\nimport { ALIGN_SPECTRA } from '../reducer/types/Types';\nimport Events from '../utility/Events';\n\nimport { ModalStyles } from './ModalStyle';\n\nconst baseList = [{ key: 1, value: 'manual', label: 'Manual' }];\n\nfunction AlignSpectraModal({ onClose, nucleus }) {\n  const refForm = useRef();\n  const dispatch = useDispatch();\n  const List = useMemo(() => {\n    const list = REFERENCES[nucleus]\n      ? Object.entries(REFERENCES[nucleus]).map(\n          (item) => ({\n            key: item[0],\n            value: item[0],\n            label: item[0],\n          }),\n          [],\n        )\n      : [];\n\n    return baseList.concat(list);\n  }, [nucleus]);\n  const handleSave = useCallback(() => {\n    refForm.current.submitForm();\n  }, []);\n\n  const submitHandler = useCallback(\n    (values) => {\n      dispatch({ type: ALIGN_SPECTRA, payload: values });\n      onClose();\n    },\n    [dispatch, onClose],\n  );\n\n  useEffect(() => {\n    Events.on('brushEnd', (event) => {\n      const [from, to] = event.range;\n      refForm.current.setValues({ ...refForm.current.values, from, to });\n    });\n\n    return () => {\n      Events.off('brushEnd');\n    };\n  }, []);\n\n  const optionChangeHandler = useCallback(\n    (id) => {\n      const value = REFERENCES[nucleus][id];\n      const { delta = 0, ...resValues } = value || { delta: 0 };\n      refForm.current.setValues({\n        ...refForm.current.values,\n        targetX: delta,\n        ...resValues,\n      });\n    },\n    [nucleus],\n  );\n\n  return (\n    <div css={ModalStyles}>\n      <div className=\"header handle\">\n        <span>Spectra calibration</span>\n        <CloseButton onClick={onClose} className=\"close-bt\" />\n      </div>\n      <div className=\"inner-content\">\n        <FormikForm\n          ref={refForm}\n          initialValues={{ from: -1, to: 1, nbPeaks: 1, targetX: 0 }}\n          onSubmit={submitHandler}\n        >\n          <div className=\"row margin-10\">\n            <span className=\"custom-label\">Options :</span>\n\n            <Select\n              data={List}\n              style={{ width: 270, height: 30, marginBottom: '20px' }}\n              onChange={optionChangeHandler}\n            />\n          </div>\n          <div className=\"row margin-10\">\n            <span className=\"custom-label\">Range :</span>\n            <FormikInput label=\"From : \" name=\"from\" type=\"number\" />\n            <FormikInput label=\"To :\" name=\"to\" type=\"number\" />\n          </div>\n          <div className=\"row margin-10\">\n            <span className=\"custom-label\">Number of Peaks : </span>\n            <FormikInput name=\"nbPeaks\" type=\"number\" />\n          </div>\n          <div className=\"row margin-10\">\n            <span className=\"custom-label\">Target PPM :</span>\n            <FormikInput name=\"targetX\" type=\"number\" />\n          </div>\n        </FormikForm>\n      </div>\n      <div className=\"footer-container\">\n        <button type=\"button\" onClick={handleSave} className=\"save-button\">\n          Done\n        </button>\n      </div>\n    </div>\n  );\n}\n\nexport default AlignSpectraModal;\n","/** @jsxImportSource @emotion/react */\nimport { useCallback, useEffect, useRef } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\nimport CloseButton from '../elements/CloseButton';\nimport FormikForm from '../elements/formik/FormikForm';\nimport FormikInput from '../elements/formik/FormikInput';\nimport Events from '../utility/Events';\nimport { exportAsMatrix } from '../utility/Export';\n\nimport { ModalStyles } from './ModalStyle';\n\nconst INITIAL_VALUE = { from: -1, to: 1, nbPoints: 1024 };\n\nfunction ExportAsMatrixModal({ onClose }) {\n  const refForm = useRef();\n  const { data } = useChartData();\n\n  const handleSave = useCallback(() => {\n    refForm.current.submitForm();\n  }, []);\n\n  const submitHandler = useCallback(\n    (options) => {\n      exportAsMatrix(data, options, 'fileName');\n      onClose();\n    },\n    [data, onClose],\n  );\n\n  useEffect(() => {\n    Events.on('brushEnd', (event) => {\n      const [from, to] = event.range;\n      refForm.current.setValues({ ...refForm.current.values, from, to });\n    });\n\n    return () => {\n      Events.off('brushEnd');\n    };\n  }, []);\n\n  return (\n    <div css={ModalStyles}>\n      <div className=\"header handle\">\n        <span>Export spectra as a Matrix</span>\n        <CloseButton onClick={onClose} className=\"close-bt\" />\n      </div>\n      <div className=\"inner-content\">\n        <FormikForm\n          ref={refForm}\n          initialValues={INITIAL_VALUE}\n          onSubmit={submitHandler}\n        >\n          <div className=\"row margin-10\">\n            <span className=\"custom-label\">Range :</span>\n            <FormikInput label=\"From : \" name=\"from\" type=\"number\" />\n            <FormikInput label=\"To :\" name=\"to\" type=\"number\" />\n          </div>\n          <div className=\"row margin-10\">\n            <span className=\"custom-label\">Number of Points : </span>\n            <FormikInput name=\"nbPoints\" type=\"number\" />\n          </div>\n        </FormikForm>\n      </div>\n      <div className=\"footer-container\">\n        <button type=\"button\" onClick={handleSave} className=\"save-button\">\n          Export Now\n        </button>\n      </div>\n    </div>\n  );\n}\n\nexport default ExportAsMatrixModal;\n","import React, { forwardRef } from 'react';\n\nimport { useChartData } from '../../context/ChartContext';\nimport FormikForm from '../../elements/formik/FormikForm';\nimport FormikInput from '../../elements/formik/FormikInput';\n\nfunction EquallySpacedFilter({ onSubmit }, ref) {\n  const { xDomain } = useChartData();\n  return (\n    <FormikForm\n      ref={ref}\n      initialValues={{\n        from: xDomain[0],\n        to: xDomain[1],\n        numberOfPoints: 1024,\n      }}\n      onSubmit={onSubmit}\n    >\n      <div className=\"row margin-10\">\n        <span className=\"custom-label\">Range :</span>\n        <FormikInput label=\"From : \" name=\"from\" type=\"number\" />\n        <FormikInput label=\"To :\" name=\"to\" type=\"number\" />\n      </div>\n      <div className=\"row margin-10\">\n        <span className=\"custom-label\">Number of points :</span>\n        <FormikInput label=\"\" name=\"numberOfPoints\" type=\"number\" />\n      </div>\n    </FormikForm>\n  );\n}\n\nexport default forwardRef(EquallySpacedFilter);\n","import React, { forwardRef } from 'react';\n\nimport { useChartData } from '../../context/ChartContext';\nimport FormikForm from '../../elements/formik/FormikForm';\nimport FormikInput from '../../elements/formik/FormikInput';\n\nfunction FromToFilter({ onSubmit }, ref) {\n  const { xDomain } = useChartData();\n  return (\n    <FormikForm\n      ref={ref}\n      initialValues={{ from: xDomain[0], to: xDomain[1] }}\n      onSubmit={onSubmit}\n    >\n      <div className=\"row margin-10\">\n        <span className=\"custom-label\">Range :</span>\n        <FormikInput label=\"From : \" name=\"from\" type=\"number\" />\n        <FormikInput label=\"To :\" name=\"to\" type=\"number\" />\n      </div>\n    </FormikForm>\n  );\n}\n\nexport default forwardRef(FromToFilter);\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback, useEffect, useMemo, useRef, useState } from 'react';\n\nimport { Filters } from '../../../data/Filters';\nimport { REFERENCES } from '../../../data/constants/References';\nimport { useDispatch } from '../../context/DispatchContext';\nimport CloseButton from '../../elements/CloseButton';\nimport Select from '../../elements/Select';\nimport FormikForm from '../../elements/formik/FormikForm';\nimport { APPLY_MULTIPLE_SPECTRA_FILTER } from '../../reducer/types/Types';\nimport Events from '../../utility/Events';\nimport { ModalStyles } from '../ModalStyle';\n\nimport EquallySpacedFilter from './EquallySpacedFilter';\nimport FromToFilter from './FromToFilter';\n\nconst baseList = [\n  { key: 0, value: 0, label: 'Select Filter' },\n  {\n    key: Filters.fromTo.id,\n    value: Filters.fromTo.id,\n    label: Filters.fromTo.name,\n  },\n  {\n    key: Filters.equallySpaced.id,\n    value: Filters.equallySpaced.id,\n    label: Filters.equallySpaced.name,\n  },\n  {\n    key: Filters.standardDeviation.id,\n    value: Filters.standardDeviation.id,\n    label: Filters.standardDeviation.name,\n  },\n  {\n    key: Filters.centerMean.id,\n    value: Filters.centerMean.id,\n    label: Filters.centerMean.name,\n  },\n  {\n    key: Filters.pareto.id,\n    value: Filters.pareto.id,\n    label: Filters.pareto.name,\n  },\n];\n\nconst styles = css`\n  .row {\n    align-items: center;\n  }\n`;\n\nfunction MultipleSpectraFiltersModal({ onClose, nucleus }) {\n  const refForm = useRef();\n  const dispatch = useDispatch();\n  const [filter, setFilter] = useState(0);\n  const List = useMemo(() => {\n    const list = REFERENCES[nucleus]\n      ? Object.entries(REFERENCES[nucleus]).map(\n          (item) => ({\n            key: item[0],\n            value: item[0],\n            label: item[0],\n          }),\n          [],\n        )\n      : [];\n\n    return baseList.concat(list);\n  }, [nucleus]);\n  const handleSave = useCallback(() => {\n    if (refForm.current) {\n      refForm.current.submitForm();\n    }\n  }, []);\n\n  const submitHandler = useCallback(\n    (options) => {\n      dispatch({\n        type: APPLY_MULTIPLE_SPECTRA_FILTER,\n        payload: [{ name: filter, options }],\n      });\n\n      onClose();\n    },\n    [dispatch, filter, onClose],\n  );\n\n  useEffect(() => {\n    Events.on('brushEnd', (event) => {\n      const [from, to] = event.range;\n      if (refForm.current) {\n        refForm.current.setValues({ ...refForm.current.values, from, to });\n      }\n    });\n\n    return () => {\n      Events.off('brushEnd');\n    };\n  }, []);\n\n  const filterChangeHandler = useCallback((id) => {\n    setFilter(id);\n  }, []);\n\n  const filterOptions = useMemo(() => {\n    switch (filter) {\n      case Filters.fromTo.id:\n        return <FromToFilter onSubmit={submitHandler} ref={refForm} />;\n      case Filters.equallySpaced.id:\n        return <EquallySpacedFilter onSubmit={submitHandler} ref={refForm} />;\n      default:\n        break;\n    }\n  }, [filter, submitHandler]);\n\n  return (\n    <div css={[ModalStyles, styles]}>\n      <div className=\"header handle\">\n        <span>Spectra calibration</span>\n        <CloseButton onClick={onClose} className=\"close-bt\" />\n      </div>\n      <div className=\"inner-content\">\n        <div className=\"row margin-10\">\n          <span className=\"custom-label\">Filter :</span>\n\n          <Select\n            data={List}\n            style={{ width: 275, height: 30, margin: 0 }}\n            onChange={filterChangeHandler}\n          />\n        </div>\n        {filterOptions || (\n          <FormikForm\n            ref={refForm}\n            initialValues={{}}\n            onSubmit={submitHandler}\n          />\n        )}\n      </div>\n      <div className=\"footer-container\">\n        <button type=\"button\" onClick={handleSave} className=\"save-button\">\n          Done\n        </button>\n      </div>\n    </div>\n  );\n}\n\nexport default MultipleSpectraFiltersModal;\n","import { css } from '@emotion/react';\n\nexport default css`\n  code[class*='language-'],\n  pre[class*='language-'] {\n    color: black;\n    background: none;\n    text-shadow: 0 1px white;\n    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;\n    font-size: 1em;\n    text-align: left;\n    white-space: pre;\n    word-spacing: normal;\n    word-break: normal;\n    word-wrap: normal;\n    line-height: 1.5;\n\n    -moz-tab-size: 4;\n    -o-tab-size: 4;\n    tab-size: 4;\n\n    -webkit-hyphens: none;\n    -moz-hyphens: none;\n    -ms-hyphens: none;\n    hyphens: none;\n  }\n\n  pre[class*='language-']::-moz-selection,\n  pre[class*='language-'] ::-moz-selection,\n  code[class*='language-']::-moz-selection,\n  code[class*='language-'] ::-moz-selection {\n    text-shadow: none;\n    background: #b3d4fc;\n  }\n\n  pre[class*='language-']::selection,\n  pre[class*='language-'] ::selection,\n  code[class*='language-']::selection,\n  code[class*='language-'] ::selection {\n    text-shadow: none;\n    background: #b3d4fc;\n  }\n\n  @media print {\n    code[class*='language-'],\n    pre[class*='language-'] {\n      text-shadow: none;\n    }\n  }\n\n  /* Code blocks */\n  pre[class*='language-'] {\n    padding: 1em;\n    margin: 0.5em 0;\n    overflow: auto;\n  }\n\n  :not(pre) > code[class*='language-'],\n  pre[class*='language-'] {\n    background: #f5f2f0;\n  }\n\n  /* Inline code */\n  :not(pre) > code[class*='language-'] {\n    padding: 0.1em;\n    border-radius: 0.3em;\n    white-space: normal;\n  }\n\n  .token.comment,\n  .token.prolog,\n  .token.doctype,\n  .token.cdata {\n    color: slategray;\n  }\n\n  .token.punctuation {\n    color: #999;\n  }\n\n  .token.namespace {\n    opacity: 0.7;\n  }\n\n  .token.property,\n  .token.tag,\n  .token.boolean,\n  .token.number,\n  .token.constant,\n  .token.symbol,\n  .token.deleted {\n    color: #905;\n  }\n\n  .token.selector,\n  .token.attr-name,\n  .token.string,\n  .token.char,\n  .token.builtin,\n  .token.inserted {\n    color: #690;\n  }\n\n  .token.operator,\n  .token.entity,\n  .token.url,\n  .language-css .token.string,\n  .style .token.string {\n    color: #9a6e3a;\n    /* This background color was intended by the author of this theme. */\n    background: hsla(0, 0%, 100%, 0.5);\n  }\n\n  .token.atrule,\n  .token.attr-value,\n  .token.keyword {\n    color: #07a;\n  }\n\n  .token.function,\n  .token.class-name {\n    color: #dd4a68;\n  }\n\n  .token.regex,\n  .token.important,\n  .token.variable {\n    color: #e90;\n  }\n\n  .token.important,\n  .token.bold {\n    font-weight: bold;\n  }\n  .token.italic {\n    font-style: italic;\n  }\n\n  .token.entity {\n    cursor: help;\n  }\n`;\n","export default function calculate(code, args = null) {\n  try {\n    // eslint-disable-next-line no-new-func\n    return new Function('args', `return ${code}`)(args);\n  } catch (e) {\n    return e;\n  }\n}\n","/** @jsxImportSource @emotion/react */\nimport { useFormikContext } from 'formik';\nimport { highlight, languages } from 'prismjs/components/prism-core';\n// eslint-disable-next-line import/no-unassigned-import\nimport 'prismjs/components/prism-clike';\n// eslint-disable-next-line import/no-unassigned-import\nimport 'prismjs/components/prism-javascript';\nimport { memo, useCallback, useEffect, useState } from 'react';\nimport Editor from 'react-simple-code-editor';\n\nimport prismStyles from '../../elements/styles/prism';\nimport Eval from '../../utility/Evaluate';\n\nconst initCode = `function run(data) {\n\n  return JSON.stringify(data,undefined, 2);\n  \n}(args);\n`;\n\nfunction MulipleAnalysisCodeEditor({ data }) {\n  const { values, setFieldValue } = useFormikContext();\n  const [code, setCode] = useState(values.code ? values.code : initCode);\n  const [result, setResult] = useState('');\n\n  useEffect(() => {\n    const evalResult = Eval(code, data);\n    if (evalResult instanceof Error) {\n      setResult(evalResult.message);\n    } else {\n      setFieldValue('code', code);\n      setResult(evalResult);\n    }\n  }, [code, data, setFieldValue]);\n\n  const valueChangeHandler = useCallback((code) => {\n    setCode(code);\n  }, []);\n  const highlightHandler = useCallback((code) => {\n    try {\n      return highlight(code, languages.js);\n    } catch (e) {\n      return null;\n    }\n  }, []);\n\n  return (\n    <div style={{ marginTop: '20px' }} css={prismStyles}>\n      <Editor\n        value={code}\n        onValueChange={valueChangeHandler}\n        highlight={highlightHandler}\n        padding={10}\n        style={{\n          fontFamily: '\"Fira code\", \"Fira Mono\", monospace',\n          fontSize: 12,\n          backgroundColor: '#fcfcfc',\n          marginBottom: '10px',\n          minHeight: '100px',\n          overflow: 'auto',\n          maxHeight: '200px',\n        }}\n      />\n      <p style={{ marginBottom: '5px' }}>Result:</p>\n\n      <Editor\n        value={result}\n        onValueChange={(code) => code}\n        highlight={highlightHandler}\n        padding={10}\n        style={{\n          border: '0.55px solid #f3f3f3',\n          fontFamily: '\"Fira code\", \"Fira Mono\", monospace',\n          fontSize: 12,\n          marginBottom: '10px',\n          minHeight: '100px',\n          overflow: 'auto',\n          maxHeight: '200px',\n        }}\n      />\n    </div>\n  );\n}\n\nexport default memo(MulipleAnalysisCodeEditor);\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport {\n  forwardRef,\n  useCallback,\n  useEffect,\n  useImperativeHandle,\n  useMemo,\n  useRef,\n  useState,\n} from 'react';\nimport { FaPlus } from 'react-icons/fa';\nimport * as Yup from 'yup';\n\nimport { COLUMNS_TYPES } from '../../../data/data1d/MulitpleAnalysis';\nimport { useDispatch } from '../../context/DispatchContext';\nimport FormikForm from '../../elements/formik/FormikForm';\nimport FormikInput from '../../elements/formik/FormikInput';\nimport { SET_ANALYZE_SPECTRA_COLUMNS } from '../../reducer/types/Types';\n\nimport MulipleAnalysisCodeEditor from './MulipleAnalysisCodeEditor';\n\nconst styles = css`\n  width: 100%;\n  thead {\n    border-bottom: 1px solid lightgray;\n    background-color: #fafafa;\n    font-size: 12px;\n  }\n\n  td,\n  th {\n    padding: 3px 5px;\n    text-align: center;\n  }\n\n  .operation-col {\n    width: 30px;\n  }\n\n  .input {\n    // border: 0.55px solid rgb(237 237 237) !important;\n    height: 25px !important;\n    width: 100% !important;\n    margin: 0 !important;\n    // text-transform: uppercase;\n  }\n\n  .input.disbale {\n    background-color: #e8e8e8;\n    border-radius: 5px;\n  }\n\n  .label,\n  .index {\n    width: 100px;\n  }\n\n  .counter {\n    width: 50px;\n  }\n\n  .add {\n    background-color: transparent;\n    border: 0;\n    outline: none;\n    svg {\n      font-szie: 14px;\n      fill: green;\n    }\n  }\n`;\nconst MultipleSpectraAnalysisPreferences = forwardRef(\n  function MultipleSpectraAnalysisPreferences({ data, onAfterSave }, ref) {\n    const dispatch = useDispatch();\n    const refForm = useRef();\n    const [columns, setColumns] = useState({});\n\n    useImperativeHandle(ref, () => ({\n      saveSetting() {\n        refForm.current.submitForm();\n      },\n    }));\n\n    useEffect(() => {\n      const result = Object.keys(data.columns).reduce((acc, key) => {\n        acc[key] = { ...data.columns[key], tempKey: key };\n        return acc;\n      }, {});\n      setColumns(result);\n      refForm.current.setValues({ columns: result, code: data.code });\n    }, [data]);\n\n    const columnsKeys = useMemo(() => {\n      return Object.keys(columns);\n    }, [columns]);\n\n    const preferncesSchema = useMemo(() => {\n      function columnSchema() {\n        return columnsKeys.reduce((acc, key) => {\n          acc[key] = Yup.object().shape({\n            tempKey: Yup.string()\n              .required()\n              .test('unique', 'must be unique column name', (colmnName) => {\n                const formData = refForm.current.values.columns;\n                return (\n                  Object.keys(formData).reduce((acc, colKey) => {\n                    if (formData[colKey].tempKey === colmnName) {\n                      acc.push(colmnName);\n                    }\n                    return acc;\n                  }, []).length === 1\n                );\n              }),\n            ...(columns[key].type === COLUMNS_TYPES.FORMULA\n              ? { formula: Yup.string().required() }\n              : {}),\n            index: Yup.string().required(),\n          });\n          return acc;\n        }, {});\n      }\n\n      //   console.log(columnSchema());\n\n      return Yup.object().shape({\n        columns: Yup.object().shape(columnSchema()),\n      });\n    }, [columns, columnsKeys, refForm]);\n\n    const submitHandler = useCallback(\n      (values) => {\n        onAfterSave(true);\n        const result = Object.entries(values.columns).reduce(\n          (acc, [key, value]) => {\n            acc[key] = { ...columns[key], ...value };\n            return acc;\n          },\n          {},\n        );\n        dispatch({\n          type: SET_ANALYZE_SPECTRA_COLUMNS,\n          payload: { code: values.code, columns: result },\n        });\n      },\n      [columns, dispatch, onAfterSave],\n    );\n\n    const addNewColumn = useCallback((index) => {\n      setColumns((prevData) => {\n        return {\n          ...prevData,\n          [`temp${index}`]: {\n            tempKey: '',\n            type: 'FORMULA',\n            valueKey: 'value',\n            formula: '',\n            index: index,\n          },\n        };\n      });\n    }, []);\n\n    return (\n      <FormikForm\n        ref={refForm}\n        initialValues={{ columns, code: null }}\n        validationSchema={preferncesSchema}\n        onSubmit={submitHandler}\n      >\n        {columnsKeys && (\n          <table css={styles}>\n            <thead>\n              <tr>\n                <th className=\"counter\">#</th>\n                <th className=\"label\">Label</th>\n                <th>value</th>\n                <th className=\"index\">index</th>\n              </tr>\n            </thead>\n            <tbody>\n              {columnsKeys.map((key, index) => {\n                return (\n                  <tr key={key}>\n                    <td className=\"counter\">{index + 1}</td>\n                    <td className=\"label\">\n                      <FormikInput\n                        key={key}\n                        name={`columns.${key}.tempKey`}\n                        value={columns[key].tempKey}\n                      />\n                    </td>\n                    <td>\n                      {columns[key].type === COLUMNS_TYPES.FORMULA ? (\n                        <FormikInput\n                          name={`columns.${key}.formula`}\n                          value={columns[key].formula}\n                        />\n                      ) : (\n                        <div className=\"input disbale\" />\n                      )}\n                    </td>\n                    <td className=\"index\">\n                      <FormikInput\n                        name={`columns.${key}.index`}\n                        value={columns[key].index}\n                      />\n                    </td>\n                    <td className=\"operation-col\">\n                      {columnsKeys.length === index + 1 && (\n                        <button\n                          className=\"add\"\n                          type=\"button\"\n                          onClick={() => addNewColumn(index + 1)}\n                        >\n                          <FaPlus />\n                        </button>\n                      )}\n                    </td>\n                  </tr>\n                );\n              })}\n            </tbody>\n          </table>\n        )}\n        <MulipleAnalysisCodeEditor data={data} />\n      </FormikForm>\n    );\n  },\n);\n\nMultipleSpectraAnalysisPreferences.defaultProps = {\n  onAfterSave: () => false,\n};\nexport default MultipleSpectraAnalysisPreferences;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\n\nconst styles = css`\n  background-color: white;\n  position: absolute;\n  height: auto;\n  z-index: 99999999999999;\n  box-shadow: 0 19px 38px rgba(0, 0, 0, 0.3), 0 15px 12px rgba(0, 0, 0, 0.22);\n  border-radius: 10px;\n  margin-bottom: 20px;\n\n  ul {\n    list-style-type: none;\n    padding: 0;\n    margin: 0;\n\n    li {\n      padding: 10px 30px;\n      text-align: center;\n      color: black;\n      border-bottom: 0.55px solid lightgoldenrodyellow;\n      min-width: 150px;\n    }\n\n    li:last-of-type {\n      border-bottom: none;\n    }\n\n    li:hover {\n      background-color: gray;\n      color: white;\n    }\n  }\n`;\n\nfunction DropDownList({ data = [], onSelect }) {\n  return (\n    <div css={styles}>\n      <ul>\n        {data.map((item, i) => (\n          <li key={item.key} onClick={() => onSelect(i)}>\n            {item.label}\n          </li>\n        ))}\n      </ul>\n    </div>\n  );\n}\n\nexport default DropDownList;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback, useEffect, useRef, useState } from 'react';\nimport { FaEllipsisH } from 'react-icons/fa';\n\nimport { useGlobal } from '../../context/GlobalContext';\n\nimport DropDownList from './DropDownList';\n\nconst styles = css`\n  // position: absolute;\n  padding: 2px;\n  border-radius: 10px;\n  width: auto;\n  display: inline-block;\n  border: 0.55px solid lightgray;\n  font-size: 10px;\n\n  button {\n    text-transform: Capitalize;\n  }\n`;\n\nfunction DropDownButton({ data, selectedKey, onSelect, formatSelectedValue }) {\n  const [open, setOpen] = useState(false);\n  const [value, setValue] = useState(selectedKey);\n  const { rootRef } = useGlobal();\n\n  const drop = useRef(null);\n  const handleClick = useCallback(\n    (e) => {\n      if (!e.target.closest(`.${drop.current.className}`) && open) {\n        setTimeout(() => {\n          setOpen(false);\n        }, 0);\n      }\n    },\n    [open],\n  );\n  useEffect(() => {\n    if (rootRef) {\n      rootRef.addEventListener('click', handleClick);\n    }\n    return () => rootRef.removeEventListener('click', handleClick);\n  }, [handleClick, open, rootRef]);\n\n  const selectHandler = useCallback(\n    (index) => {\n      setValue(data[index].label);\n      onSelect(data[index].key);\n    },\n    [data, onSelect],\n  );\n\n  return (\n    <div className=\"dropdown\" ref={drop} css={styles}>\n      <button type=\"button\" onClick={() => setOpen((open) => !open)}>\n        {!value ? <FaEllipsisH /> : formatSelectedValue(value)}\n      </button>\n      {open && <DropDownList data={data} onSelect={selectHandler} />}\n    </div>\n  );\n}\n\nDropDownButton.defaultProps = {\n  data: null,\n  formatSelectedValue: (val) => val,\n  value: null,\n};\n\nexport default DropDownButton;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback } from 'react';\n\nimport { COLUMNS_TYPES } from '../../../data/data1d/MulitpleAnalysis';\nimport { useDispatch } from '../../context/DispatchContext';\nimport DeleteButton from '../../elements/Tab/DeleteButton';\nimport DropDownButton from '../../elements/dropDownButton/DropDownButton';\nimport { DELETE_ANALYZE_SPECTRA_RANGE } from '../../reducer/types/Types';\n\nconst styles = (styles) => css`\n  position: relative;\n\n  .delete {\n    position: absolute;\n    right: 0px;\n    top: 0px;\n  }\n\n  .container {\n    display: flex;\n    flex-direction: column;\n    padding: 0;\n    margin: 0;\n  }\n  .dropDown-container {\n    justify-content: flex-start;\n    align-items: flex-start;\n  }\n  .label-container {\n    flex: 1;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    flex-direction: column;\n    min-height: 45px;\n  }\n\n  .label {\n    text-align: center;\n  }\n\n  ${styles}\n`;\n\nconst columnsFilters = [\n  { key: 'relative', label: 'Relative' },\n  { key: 'absolute', label: 'Absolute' },\n  { key: 'min', label: 'Min Intensity' },\n  { key: 'max', label: 'Max Intensity' },\n];\n\nfunction ColumnHeader({ charLabel, rangeLabel, data, onColumnFilter }) {\n  const dispatch = useDispatch();\n\n  const deleteHandler = useCallback(() => {\n    dispatch({ type: DELETE_ANALYZE_SPECTRA_RANGE, colKey: charLabel });\n  }, [charLabel, dispatch]);\n\n  return (\n    <div css={styles}>\n      <div className=\"container\">\n        {data.type === COLUMNS_TYPES.NORMAL && (\n          <div className=\"dropDown-container\">\n            <DropDownButton\n              data={columnsFilters}\n              formatSelectedValue={(value) =>\n                value ? value.substr(0, 3) : value\n              }\n              selectedKey={data.valueKey}\n              onSelect={onColumnFilter}\n            />\n          </div>\n        )}\n        <div className=\"label-container\">\n          <span className=\"label\"> {charLabel}</span>\n          <span className=\"label\">{rangeLabel}</span>\n        </div>\n      </div>\n      <DeleteButton onDelete={deleteHandler} />\n    </div>\n  );\n}\n\nexport default ColumnHeader;\n","import lodashGet from 'lodash/get';\nimport { useMemo, memo, useCallback, Fragment } from 'react';\n\nimport { useDispatch } from '../../context/DispatchContext';\nimport ReactTable from '../../elements/ReactTable/ReactTable';\nimport { FILTER_SPECTRA_COLUMN } from '../../reducer/types/Types';\nimport Eval from '../../utility/Evaluate';\nimport { useFormatNumberByNucleus } from '../../utility/FormatNumber';\nimport NoTableData from '../extra/placeholder/NoTableData';\n\nimport ColumnHeader from './ColumnHeader';\n\nfunction MultipleSpectraAnalysisTable({ data, activeTab }) {\n  const format = useFormatNumberByNucleus(activeTab);\n\n  const codeEvaluation = useMemo(() => {\n    const code = lodashGet(data, 'code', '');\n    return Eval(code, data);\n  }, [data]);\n\n  const dispatch = useDispatch();\n\n  const columnFilterHandler = useCallback(\n    (columnKey, valueKey) => {\n      dispatch({\n        type: FILTER_SPECTRA_COLUMN,\n        payload: {\n          columnKey,\n          valueKey,\n        },\n      });\n    },\n    [dispatch],\n  );\n\n  const tableColumns = useMemo(() => {\n    const initColumns = [\n      {\n        Header: '#',\n        index: 0,\n        Cell: ({ row }) => row.index + 1,\n      },\n    ];\n\n    const columns = initColumns;\n    const setCustomColumn = (array, index, columnLabel, cellHandler) => {\n      const columnData = data.columns[columnLabel];\n      array.push({\n        index: index,\n        Header: () => (\n          <ColumnHeader\n            charLabel={columnLabel}\n            data={columnData}\n            onColumnFilter={(valueKey) =>\n              columnFilterHandler(columnLabel, valueKey)\n            }\n            rangeLabel={\n              columnData.from && columnData.to\n                ? `${format(columnData.from)} - ${format(columnData.to)}`\n                : ''\n            }\n          />\n        ),\n        id: columnLabel,\n        sortType: 'basic',\n        Cell: ({ row }) => cellHandler(row),\n      });\n    };\n    if (data.columns) {\n      Object.keys(data.columns).forEach((key) => {\n        const { valueKey, index: columnIndex } = data.columns[key];\n        setCustomColumn(columns, columnIndex + 1, key, (row) => {\n          const value = row.original[key][valueKey];\n          const result =\n            value instanceof Error ? (\n              <span style={{ color: 'red' }}>{value.message}</span>\n            ) : (\n              format(value)\n            );\n          return result;\n        });\n      });\n    }\n    const resultColumns = columns ? columns : initColumns;\n    return resultColumns.sort(\n      (object1, object2) => object1.index - object2.index,\n    );\n  }, [columnFilterHandler, data.columns, format]);\n\n  return data.values && data.values.length > 0 ? (\n    <Fragment>\n      <ReactTable data={data.values} columns={tableColumns} />\n      <div\n        style={{\n          width: '100%',\n          padding: '10px',\n        }}\n        // eslint-disable-next-line react/no-danger\n        dangerouslySetInnerHTML={{ __html: codeEvaluation }}\n      />\n    </Fragment>\n  ) : (\n    <NoTableData />\n  );\n}\n\nexport default memo(MultipleSpectraAnalysisTable);\n","import {\n  SvgNmrOverlay,\n  SvgNmrAddFilter,\n  SvgNmrExportAsMatrix,\n} from 'cheminfo-font';\nimport { useCallback, useState, useRef, memo, useMemo } from 'react';\nimport ReactCardFlip from 'react-card-flip';\nimport { FaFileExport } from 'react-icons/fa';\nimport { IoPulseOutline } from 'react-icons/io5';\n\nimport { getDataAsString } from '../../../data/data1d/MulitpleAnalysis';\nimport { useDispatch } from '../../context/DispatchContext';\nimport Button from '../../elements/ButtonToolTip';\nimport ToggleButton from '../../elements/ToggleButton';\nimport { positions, useAlert } from '../../elements/popup/Alert';\nimport { useModal } from '../../elements/popup/Modal';\nimport MultiAnalysisWrapper from '../../hoc/MultiAnalysisWrapper';\nimport AlignSpectraModal from '../../modal/AlignSpectraModal';\nimport ExportAsMatrixModal from '../../modal/ExportAsMatrixModal';\nimport MultipleSpectraFiltersModal from '../../modal/MultipleSpectraFiltersModal';\nimport { RESET_SELECTED_TOOL } from '../../reducer/types/Types';\nimport Events from '../../utility/Events';\nimport { copyTextToClipboard } from '../../utility/Export';\nimport DefaultPanelHeader from '../header/DefaultPanelHeader';\nimport PreferencesHeader from '../header/PreferencesHeader';\n\nimport MultipleSpectraAnalysisPreferences from './MultipleSpectraAnalysisPreferences';\nimport MultipleSpectraAnalysisTable from './MultipleSpectraAnalysisTable';\n\nconst styles = {\n  container: {\n    display: 'flex',\n    flexDirection: 'column',\n    height: '100%',\n  },\n  button: {\n    backgroundColor: 'transparent',\n    border: 'none',\n  },\n};\n\nfunction MultipleSpectraAnalysisPanel({ spectraAnalysis, activeTab }) {\n  const [isFlipped, setFlipStatus] = useState(false);\n  const settingRef = useRef();\n  const alert = useAlert();\n  const modal = useModal();\n  const dispatch = useDispatch();\n\n  const data = useMemo(() => {\n    const {\n      values,\n      options: { columns, code },\n    } = spectraAnalysis[activeTab] || {\n      values: {},\n      options: { columns: {}, code: null },\n    };\n    return { values: Object.values(values), columns, code };\n  }, [activeTab, spectraAnalysis]);\n\n  const settingsPanelHandler = useCallback(() => {\n    setFlipStatus(!isFlipped);\n  }, [isFlipped]);\n\n  const saveSettingHandler = useCallback(() => {\n    settingRef.current.saveSetting();\n  }, []);\n\n  const afterSaveHandler = useCallback(() => {\n    setFlipStatus(false);\n  }, []);\n\n  const showTrackerHandler = useCallback((flag) => {\n    Events.emit('showYSpectraTrackers', flag);\n  }, []);\n  const openAlignSpectra = useCallback(() => {\n    dispatch({ type: RESET_SELECTED_TOOL });\n    modal.show(<AlignSpectraModal nucleus={activeTab} />, {\n      isBackgroundBlur: false,\n      position: positions.TOP_CENTER,\n      // enableResizing: false,\n      width: 500,\n      // height: 600,\n    });\n  }, [activeTab, modal, dispatch]);\n  const openFiltersModal = useCallback(() => {\n    dispatch({ type: RESET_SELECTED_TOOL });\n    modal.show(<MultipleSpectraFiltersModal />, {\n      isBackgroundBlur: false,\n      position: positions.TOP_CENTER,\n      // enableResizing: false,\n      width: 500,\n      // height: 600,\n    });\n  }, [modal, dispatch]);\n\n  const copyToClipboardHandler = useCallback(() => {\n    const data = getDataAsString(spectraAnalysis, activeTab);\n    const success = copyTextToClipboard(data);\n    if (success) {\n      alert.success('Data copied to clipboard');\n    } else {\n      alert.error('copy to clipboard failed');\n    }\n  }, [activeTab, alert, spectraAnalysis]);\n\n  const openExportAsMatrixModal = useCallback(() => {\n    dispatch({ type: RESET_SELECTED_TOOL });\n    modal.show(<ExportAsMatrixModal />, {\n      isBackgroundBlur: false,\n      position: positions.TOP_CENTER,\n      width: 500,\n    });\n  }, [modal, dispatch]);\n\n  return (\n    <div style={styles.container}>\n      {!isFlipped && (\n        <DefaultPanelHeader\n          deleteToolTip=\"Delete All Peaks\"\n          showSettingButton=\"true\"\n          canDelete={false}\n          onSettingClick={settingsPanelHandler}\n        >\n          <Button\n            popupTitle=\"Copy To Clipboard\"\n            style={styles.button}\n            onClick={copyToClipboardHandler}\n          >\n            <FaFileExport />\n          </Button>\n          <Button\n            popupTitle=\"Spectra calibration\"\n            style={styles.button}\n            onClick={openAlignSpectra}\n          >\n            <SvgNmrOverlay style={{ fontSize: '18px' }} />\n          </Button>\n          <ToggleButton\n            popupTitle=\"Y Spectra Tracker\"\n            popupPlacement=\"right\"\n            onClick={showTrackerHandler}\n          >\n            <IoPulseOutline />\n          </ToggleButton>\n\n          <Button\n            popupTitle=\"Add Filter\"\n            style={styles.button}\n            onClick={openFiltersModal}\n          >\n            <SvgNmrAddFilter style={{ fontSize: '18px' }} />\n          </Button>\n          <Button\n            popupTitle=\"Export spectra as a Matrix\"\n            onClick={openExportAsMatrixModal}\n          >\n            <SvgNmrExportAsMatrix />\n          </Button>\n        </DefaultPanelHeader>\n      )}\n      {isFlipped && (\n        <PreferencesHeader\n          onSave={saveSettingHandler}\n          onClose={settingsPanelHandler}\n        />\n      )}\n      <div style={{ height: '100%', overflow: 'auto' }}>\n        <ReactCardFlip\n          isFlipped={isFlipped}\n          infinite\n          containerStyle={{ overflow: 'hidden' }}\n        >\n          <MultipleSpectraAnalysisTable data={data} activeTab={activeTab} />\n          <MultipleSpectraAnalysisPreferences\n            data={data}\n            onAfterSave={afterSaveHandler}\n            ref={settingRef}\n          />\n        </ReactCardFlip>\n      </div>\n    </div>\n  );\n}\n\nexport default MultiAnalysisWrapper(memo(MultipleSpectraAnalysisPanel));\n","import { forwardRef, useMemo } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\nimport { usePreferences } from '../context/PreferencesContext';\n\nfunction PeaksWrapper(WrappedComponent) {\n  const Wrapper = (props) => {\n    const {\n      data: spectra,\n      activeSpectrum,\n      xDomain,\n      activeTab,\n      tabActiveSpectrum,\n    } = useChartData();\n    const preferences = usePreferences();\n\n    const { peaks = {}, info = {}, data = {} } = useMemo(() => {\n      if (spectra && activeSpectrum && activeSpectrum.id) {\n        const datum = spectra.find(\n          (datum) => datum.id === activeSpectrum.id,\n        ) || {\n          peaks: {},\n          info: {},\n          data: {},\n        };\n        return datum;\n      }\n      return {};\n    }, [activeSpectrum, spectra]);\n\n    const nucleus = useMemo(() => {\n      if (tabActiveSpectrum && Object.keys(tabActiveSpectrum).length > 0) {\n        return Object.keys(tabActiveSpectrum);\n      }\n      return null;\n    }, [tabActiveSpectrum]);\n\n    const { forwardedRef, ...rest } = props;\n\n    return (\n      <WrappedComponent\n        {...rest}\n        peaks={peaks}\n        info={info}\n        x={data.x}\n        y={data.y}\n        xDomain={xDomain}\n        preferences={preferences}\n        activeTab={activeTab}\n        nucleus={nucleus}\n        ref={forwardedRef}\n      />\n    );\n  };\n  return forwardRef((props, ref) => {\n    return <Wrapper {...props} forwardedRef={ref} />;\n  });\n}\nexport default PeaksWrapper;\n","import lodashGet from 'lodash/get';\nimport lodashSet from 'lodash/set';\nimport {\n  useEffect,\n  useState,\n  useCallback,\n  forwardRef,\n  useImperativeHandle,\n  useRef,\n} from 'react';\n\nimport IsotopesViewer from '../../elements/IsotopesViewer';\nimport { useAlert } from '../../elements/popup/Alert';\nimport PeaksWrapper from '../../hoc/PeaksWrapper';\nimport { SET_PANELS_PREFERENCES } from '../../reducer/preferencesReducer';\nimport {\n  useStateWithLocalStorage,\n  getValue as getValueByKeyPath,\n} from '../../utility/LocalStorage';\nimport ColumnFormatField from '../extra/preferences/ColumnFormatField';\nimport { peaksDefaultValues } from '../extra/preferences/defaultValues';\n\nconst styles = {\n  container: { padding: 10, backgroundColor: '#f1f1f1', height: '100%' },\n  groupContainer: {\n    padding: '5px',\n    borderRadius: '5px',\n    margin: '10px 0px',\n    backgroundColor: 'white',\n  },\n  row: {\n    display: 'flex',\n    margin: '5px 0px',\n  },\n  header: {\n    borderBottom: '1px solid #e8e8e8',\n    paddingBottom: '5px',\n    fontWeight: 'bold',\n    color: '#4a4a4a',\n  },\n  inputLabel: {\n    flex: 2,\n    fontSize: '11px',\n    fontWeight: 'bold',\n    color: '#232323',\n  },\n  input: {\n    width: '30%',\n    textAlign: 'center',\n  },\n};\n\nconst formatFields = [\n  {\n    id: 1,\n    label: 'Peak Number :',\n    checkController: 'showPeakNumber',\n    formatController: 'peakNumberFormat',\n    defaultFormat: '',\n  },\n  {\n    id: 2,\n    label: 'Peak Index : ',\n    checkController: 'showPeakIndex',\n    formatController: 'peakIndexFormat',\n    defaultFormat: '',\n  },\n  {\n    id: 3,\n    label: ' (ppm) :',\n    checkController: 'showDeltaPPM',\n    formatController: 'deltaPPMFormat',\n    defaultFormat: '00.00',\n  },\n  {\n    id: 4,\n    label: ' (Hz) :',\n    checkController: 'showDeltaHz',\n    formatController: 'deltaHzFormat',\n    defaultFormat: '00.00',\n  },\n  {\n    id: 5,\n    label: 'Peak Width',\n    checkController: 'showPeakWidth',\n    formatController: 'peakWidthFormat',\n    defaultFormat: '00.0000',\n  },\n  {\n    id: 6,\n    label: 'Intensity :',\n    checkController: 'showIntensity',\n    formatController: 'intensityFormat',\n    defaultFormat: '00.00',\n  },\n];\n\nfunction PeaksPreferences({ nucleus, preferences }, ref) {\n  const alert = useAlert();\n  const [, setSettingsData] = useStateWithLocalStorage('nmr-general-settings');\n  const [settings, setSetting] = useState(null);\n  const formRef = useRef();\n\n  useEffect(() => {\n    const peaksPreferences = getValueByKeyPath(\n      preferences,\n      `formatting.panels.peaks`,\n    );\n    if (peaksPreferences) {\n      setSetting(peaksPreferences);\n    }\n  }, [preferences]);\n\n  const saveHandler = useCallback(\n    (values, showMessage = false) => {\n      preferences.dispatch({\n        type: SET_PANELS_PREFERENCES,\n        payload: { key: 'peaks', value: values },\n      });\n      if (showMessage) alert.success('Peaks preferences saved successfully');\n    },\n    [alert, preferences],\n  );\n\n  useImperativeHandle(ref, () => ({\n    saveSetting() {\n      if (typeof formRef.current.requestSubmit === 'function') {\n        formRef.current.requestSubmit();\n      } else {\n        formRef.current.dispatchEvent(\n          new Event('submit', { cancelable: true }),\n        );\n      }\n    },\n  }));\n\n  const handleSubmit = useCallback(\n    (event) => {\n      event.preventDefault();\n      const form = event.target;\n      const formData = new FormData(form);\n      let values = {};\n      for (let field of formData.entries()) {\n        const keys = field[0].split('-').join('.');\n        const val = ['true', 'false'].includes(field[1])\n          ? field[1] === 'true'\n          : field[1];\n        values = lodashSet(values, keys, val);\n      }\n      saveHandler(values, true);\n      setSettingsData(values, 'formatting.panels.peaks');\n    },\n    [saveHandler, setSettingsData],\n  );\n\n  const getValue = useCallback(\n    (...params) => {\n      const keys = params.join('.');\n      if (settings) {\n        const value = lodashGet(settings, keys);\n        return value ? value : null;\n      } else {\n        const keyIndex = params.length - 1;\n        return peaksDefaultValues[params[keyIndex]];\n      }\n    },\n    [settings],\n  );\n\n  return (\n    <div style={styles.container}>\n      <form onSubmit={handleSubmit} ref={formRef}>\n        {nucleus &&\n          nucleus.map((nucleusLabel) => (\n            <div key={nucleusLabel} style={styles.groupContainer}>\n              <IsotopesViewer style={styles.header} value={nucleusLabel} />\n              {formatFields.map((field) => (\n                <ColumnFormatField\n                  key={field.id}\n                  label={field.label}\n                  checked={getValue(nucleusLabel, field.checkController)}\n                  format={getValue(nucleusLabel, field.formatController)}\n                  checkControllerName={field.checkController}\n                  formatControllerName={field.formatController}\n                  groupID={nucleusLabel}\n                />\n              ))}\n            </div>\n          ))}\n      </form>\n    </div>\n  );\n}\n\nexport default PeaksWrapper(forwardRef(PeaksPreferences));\n","import { useCallback, useMemo, memo, useEffect, useRef } from 'react';\nimport { FaRegTrashAlt } from 'react-icons/fa';\n\nimport { useDispatch } from '../../context/DispatchContext';\nimport EditableColumn from '../../elements/EditableColumn';\nimport ReactTable from '../../elements/ReactTable/ReactTable';\nimport PeaksWrapper from '../../hoc/PeaksWrapper';\nimport {\n  DELETE_PEAK_NOTATION,\n  SHIFT_SPECTRUM,\n} from '../../reducer/types/Types';\nimport formatNumber, {\n  useFormatNumberByNucleus,\n} from '../../utility/FormatNumber';\nimport { getValue } from '../../utility/LocalStorage';\nimport NoTableData from '../extra/placeholder/NoTableData';\nimport { peaksDefaultValues } from '../extra/preferences/defaultValues';\n\nfunction PeaksTable({\n  peaks,\n  info,\n  xDomain,\n  activeTab,\n  enableFilter,\n  onFilter,\n  preferences,\n}) {\n  const dispatch = useDispatch();\n  const deltaPPMRefs = useRef([]);\n  const format = useFormatNumberByNucleus(info.nucleus);\n  const deletePeakHandler = useCallback(\n    (e, row) => {\n      e.preventDefault();\n      e.stopPropagation();\n      const params = row.original;\n      dispatch({\n        type: DELETE_PEAK_NOTATION,\n        data: { id: params.id, xIndex: params.xIndex },\n      });\n    },\n    [dispatch],\n  );\n\n  const initialColumns = useMemo(\n    () => [\n      {\n        index: 20,\n        Header: '',\n        width: '1%',\n        maxWidth: '24px',\n        minWidth: '24px',\n        id: 'delete-button',\n        Cell: ({ row }) => (\n          <button\n            type=\"button\"\n            className=\"delete-button\"\n            onClick={(e) => deletePeakHandler(e, row)}\n          >\n            <FaRegTrashAlt />\n          </button>\n        ),\n      },\n    ],\n    [deletePeakHandler],\n  );\n\n  const editStartHander = useCallback((index) => {\n    deltaPPMRefs.current.forEach((ref, i) => {\n      if (index !== i && ref) {\n        ref.closeEdit();\n      }\n    });\n  }, []);\n\n  const saveDeltaPPMRefsHandler = useCallback(\n    (event, row) => {\n      const shiftValue = parseFloat(event.target.value) - parseFloat(row.value);\n      dispatch({ type: SHIFT_SPECTRUM, shiftValue });\n    },\n    [dispatch],\n  );\n\n  const tableColumns = useMemo(() => {\n    const setCustomColumn = (\n      array,\n      index,\n      columnLabel,\n      cellHandler,\n      extraParams,\n    ) => {\n      array.push({\n        ...extraParams,\n        index: index,\n        Header: columnLabel,\n        sortType: 'basic',\n        Cell: ({ row }) => cellHandler(row),\n      });\n    };\n\n    const peaksPreferences = getValue(\n      preferences,\n      `formatting.panels.peaks.[${activeTab}]`,\n      peaksDefaultValues,\n    );\n\n    let cols = [...initialColumns];\n    if (peaksPreferences.showPeakNumber) {\n      setCustomColumn(\n        cols,\n        1,\n        '#',\n        (row) => formatNumber(row.index + 1, peaksPreferences.peakNumberFormat),\n        { width: '1%', maxWidth: '40px', minWidth: '40px' },\n      );\n    }\n    if (peaksPreferences.showPeakIndex) {\n      setCustomColumn(cols, 2, 'index', (row) =>\n        formatNumber(row.original.xIndex, peaksPreferences.peakIndexFormat),\n      );\n    }\n    if (peaksPreferences.showDeltaPPM) {\n      setCustomColumn(cols, 3, ' (ppm)', (row) => (\n        <EditableColumn\n          onEditStart={() => editStartHander(row.index)}\n          ref={(ref) => (deltaPPMRefs.current[row.index] = ref)}\n          value={formatNumber(\n            row.original.value,\n            peaksPreferences.deltaPPMFormat,\n          )}\n          onSave={(event) => saveDeltaPPMRefsHandler(event, row.original)}\n          type=\"number\"\n        />\n      ));\n    }\n    if (peaksPreferences.showDeltaHz) {\n      setCustomColumn(cols, 4, ' (Hz)', (row) =>\n        formatNumber(row.original.valueHz, peaksPreferences.deltaHzFormat),\n      );\n    }\n    if (peaksPreferences.showIntensity) {\n      setCustomColumn(cols, 5, 'Intensity', (row) =>\n        formatNumber(row.original.intensity, peaksPreferences.intensityFormat),\n      );\n    }\n    if (peaksPreferences.showPeakWidth) {\n      setCustomColumn(cols, 5, 'Peak Width', (row) =>\n        formatNumber(row.original.peakWidth, peaksPreferences.peakWidthFormat),\n      );\n    }\n    return cols.sort((object1, object2) => object1.index - object2.index);\n  }, [\n    activeTab,\n    editStartHander,\n    initialColumns,\n    preferences,\n    saveDeltaPPMRefsHandler,\n  ]);\n\n  const _data = useMemo(() => {\n    function isInRange(value) {\n      const factor = 100000;\n      return (\n        value * factor >= xDomain[0] * factor &&\n        value * factor <= xDomain[1] * factor\n      );\n    }\n    if (peaks && peaks.values) {\n      const _peaks = enableFilter\n        ? peaks.values.filter((peak) => isInRange(peak.delta))\n        : peaks.values;\n\n      return _peaks.map((peak) => {\n        const value = format(peak.delta);\n        return {\n          value: value,\n          valueHz:\n            info && info.originFrequency ? value * info.originFrequency : '',\n          id: peak.id,\n          intensity: peak.intensity,\n          peakWidth: peak.width ? peak.width : '',\n          isConstantlyHighlighted: isInRange(value),\n        };\n      });\n    }\n\n    return [];\n  }, [enableFilter, format, info, peaks, xDomain]);\n\n  useEffect(() => {\n    onFilter(_data.length);\n  }, [_data, onFilter]);\n\n  return _data && _data.length > 0 ? (\n    <ReactTable data={_data} columns={tableColumns} />\n  ) : (\n    <NoTableData />\n  );\n}\n\nexport default PeaksWrapper(memo(PeaksTable));\n","import { useCallback, useState, useRef, memo } from 'react';\nimport ReactCardFlip from 'react-card-flip';\n\nimport { useDispatch } from '../../context/DispatchContext';\nimport { useModal } from '../../elements/popup/Modal';\nimport { DELETE_PEAK_NOTATION } from '../../reducer/types/Types';\nimport DefaultPanelHeader from '../header/DefaultPanelHeader';\nimport PreferencesHeader from '../header/PreferencesHeader';\n\nimport PeaksPreferences from './PeaksPreferences';\nimport PeaksTable from './PeaksTable';\n\nconst styles = {\n  container: {\n    display: 'flex',\n    flexDirection: 'column',\n    height: '100%',\n  },\n};\n\nfunction PeaksPanel() {\n  const [filterIsActive, setFilterIsActive] = useState(false);\n  const [peaksCounter, setPeaksCounter] = useState(0);\n\n  const dispatch = useDispatch();\n  const modal = useModal();\n  const [isFlipped, setFlipStatus] = useState(false);\n  const settingRef = useRef();\n  const yesHandler = useCallback(() => {\n    dispatch({ type: DELETE_PEAK_NOTATION, data: null });\n  }, [dispatch]);\n\n  const handleDeleteAll = useCallback(() => {\n    modal.showConfirmDialog({\n      message: 'All records will be deleted, Are You sure?',\n      buttons: [{ text: 'Yes', handler: yesHandler }, { text: 'No' }],\n    });\n  }, [modal, yesHandler]);\n\n  const settingsPanelHandler = useCallback(() => {\n    setFlipStatus(!isFlipped);\n  }, [isFlipped]);\n\n  const saveSettingHandler = useCallback(() => {\n    settingRef.current.saveSetting();\n    setFlipStatus(false);\n  }, []);\n\n  const handleOnFilter = useCallback(() => {\n    setFilterIsActive(!filterIsActive);\n  }, [filterIsActive]);\n  const changedHandler = useCallback((val) => {\n    setPeaksCounter(val);\n  }, []);\n\n  return (\n    <div style={styles.container}>\n      {!isFlipped && (\n        <DefaultPanelHeader\n          counter={peaksCounter}\n          onDelete={handleDeleteAll}\n          deleteToolTip=\"Delete All Peaks\"\n          onFilter={handleOnFilter}\n          filterToolTip={\n            filterIsActive ? 'Show all peaks' : 'Hide peaks out of view'\n          }\n          filterIsActive={filterIsActive}\n          counterFiltered={peaksCounter}\n          showSettingButton=\"true\"\n          onSettingClick={settingsPanelHandler}\n        />\n      )}\n      {isFlipped && (\n        <PreferencesHeader\n          onSave={saveSettingHandler}\n          onClose={settingsPanelHandler}\n        />\n      )}\n      <div style={{ height: '100%', overflow: 'hidden' }}>\n        <ReactCardFlip\n          isFlipped={isFlipped}\n          infinite\n          containerStyle={{ overflow: 'hidden', height: '100%' }}\n        >\n          <div style={{ overflow: 'auto', height: '100%', display: 'block' }}>\n            <PeaksTable\n              enableFilter={filterIsActive}\n              onFilter={changedHandler}\n            />\n          </div>\n\n          <PeaksPreferences ref={settingRef} />\n        </ReactCardFlip>\n      </div>\n    </div>\n  );\n}\n\nexport default memo(PeaksPanel);\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { FaCopy } from 'react-icons/fa';\n\nimport CloseButton from '../elements/CloseButton';\n\nconst styles = css`\n  overflow: auto;\n  width: 400px;\n  .innerContainer {\n    padding: 5px;\n    width: 100%;\n    height: 180px;\n    border: none;\n  }\n\n  .mainButtonsContainer {\n    padding: 5px 0px;\n    border-bottom: 0.55px solid #ebebeb;\n    display: flex;\n    justify-content: space-between;\n  }\n\n  button {\n    background-color: transparent;\n    border: none;\n    padding: 0 5px;\n  }\n\n  button:disabled {\n    opacity: 0.6;\n  }\n`;\n\nfunction CopyClipboardModal({ text, onClose, onCopyClick }) {\n  return (\n    <div css={styles}>\n      <div className=\"mainButtonsContainer handle\">\n        <button type=\"button\" onClick={() => onCopyClick(text)}>\n          <FaCopy />\n        </button>\n\n        <CloseButton onClick={onClose} />\n      </div>\n      <div\n        className=\"innerContainer\"\n        // eslint-disable-next-line react/no-danger\n        dangerouslySetInnerHTML={{ __html: text }}\n      />\n    </div>\n  );\n}\n\nexport default CopyClipboardModal;\n","import { SvgNmrSum } from 'cheminfo-font';\nimport lodashGet from 'lodash/get';\nimport { rangesToACS } from 'nmr-processing';\nimport { useCallback, useState } from 'react';\nimport { FaFileExport, FaUnlink, FaSitemap } from 'react-icons/fa';\n\nimport { useAssignmentData } from '../../assignment';\nimport { useDispatch } from '../../context/DispatchContext';\nimport { usePreferences } from '../../context/PreferencesContext';\nimport ToggleButton from '../../elements/ToggleButton';\nimport ToolTip from '../../elements/ToolTip/ToolTip';\nimport { useAlert } from '../../elements/popup/Alert';\nimport { useModal } from '../../elements/popup/Modal';\nimport CopyClipboardModal from '../../modal/CopyClipboardModal';\nimport ChangeSumModal from '../../modal/changeSum/ChangeSumModal';\nimport { CHANGE_RANGE_SUM, DELETE_RANGE } from '../../reducer/types/Types';\nimport Events from '../../utility/Events';\nimport { copyHTMLToClipboard } from '../../utility/Export';\nimport { getNumberOfDecimals } from '../../utility/FormatNumber';\nimport DefaultPanelHeader from '../header/DefaultPanelHeader';\n\nconst styles = {\n  toolbar: {\n    display: 'flex',\n    flexDirection: 'row',\n    borderBottom: '0.55px solid rgb(240, 240, 240)',\n  },\n  center: {\n    display: 'flex',\n    justifyContent: 'center',\n    alignItems: 'center',\n    padding: '5px',\n  },\n  removeAssignmentsButton: {\n    border: 'none',\n    height: '16px',\n    // width: '18px',\n    fontSize: '12px',\n    backgroundColor: 'transparent',\n  },\n  button: {\n    backgroundColor: 'transparent',\n    border: 'none',\n  },\n};\n\nfunction RangesHeader({\n  ranges,\n  info,\n  activeTab,\n  molecules,\n  onUnlink,\n  onFilterActivated,\n  onSettingClick,\n  isFilterActive,\n  filterCounter,\n}) {\n  const dispatch = useDispatch();\n  const modal = useModal();\n  const alert = useAlert();\n  const preferences = usePreferences();\n  const assignmentData = useAssignmentData();\n  const [isMultiplicityTreesVisible, showMultiplicityTrees] = useState(false);\n\n  const currentSum = lodashGet(ranges, 'options.sum', null);\n\n  const changeRangesSumHandler = useCallback(\n    (value) => {\n      if (value !== undefined) {\n        dispatch({ type: CHANGE_RANGE_SUM, value });\n      }\n\n      modal.close();\n    },\n    [dispatch, modal],\n  );\n\n  const showChangeRangesSumModal = useCallback(() => {\n    modal.show(\n      <ChangeSumModal\n        onClose={() => modal.close()}\n        onSave={changeRangesSumHandler}\n        header={\n          currentSum\n            ? `Set new Ranges Sum (Current: ${Number(currentSum).toFixed(2)})`\n            : 'Set new Ranges Sum'\n        }\n        molecules={molecules}\n        element={activeTab ? activeTab.replace(/[0-9]/g, '') : null}\n      />,\n    );\n  }, [activeTab, changeRangesSumHandler, currentSum, modal, molecules]);\n\n  const removeAssignments = useCallback(() => {\n    onUnlink();\n  }, [onUnlink]);\n\n  const handleOnRemoveAssignments = useCallback(() => {\n    modal.showConfirmDialog({\n      message: 'All assignments will be removed. Are you sure?',\n      buttons: [{ text: 'Yes', handler: removeAssignments }, { text: 'No' }],\n    });\n  }, [removeAssignments, modal]);\n\n  const handleDeleteAll = useCallback(() => {\n    modal.showConfirmDialog({\n      message: 'All ranges will be deleted. Are You sure?',\n      buttons: [\n        {\n          text: 'Yes',\n          handler: () => {\n            dispatch({ type: DELETE_RANGE, payload: { assignmentData } });\n          },\n        },\n        { text: 'No' },\n      ],\n    });\n  }, [assignmentData, dispatch, modal]);\n\n  const handleSetShowMultiplicityTrees = useCallback((flag) => {\n    Events.emit('showMultiplicityTrees', flag);\n    showMultiplicityTrees(flag);\n  }, []);\n\n  const saveToClipboardHandler = useCallback(\n    (value) => {\n      const success = copyHTMLToClipboard(value);\n      if (success) {\n        alert.success('Data copied to clipboard');\n      } else {\n        alert.error('copy to clipboard failed');\n      }\n    },\n    [alert],\n  );\n\n  const saveAsHTMLHandler = useCallback(() => {\n    const { originFrequency: observedFrequency, nucleus } = info;\n    const format = lodashGet(\n      preferences,\n      `formatting.nucleusByKey[${nucleus.toLowerCase()}]`,\n    );\n    const nbDecimalDelta = getNumberOfDecimals(format.ppm);\n    const nbDecimalJ = getNumberOfDecimals(format.hz);\n\n    const result = rangesToACS(ranges.values, {\n      nucleus, // '19f'\n      nbDecimalDelta, // 2\n      nbDecimalJ, // 1\n      observedFrequency, //400\n    });\n    modal.show(\n      <CopyClipboardModal\n        text={result}\n        onCopyClick={saveToClipboardHandler}\n        onClose={() => modal.close()}\n      />,\n      {},\n    );\n  }, [info, modal, preferences, ranges.values, saveToClipboardHandler]);\n\n  return (\n    <DefaultPanelHeader\n      counter={ranges && ranges.values && ranges.values.length}\n      onDelete={handleDeleteAll}\n      deleteToolTip=\"Delete All Ranges\"\n      onFilter={onFilterActivated}\n      filterToolTip={\n        isFilterActive ? 'Show all ranges' : 'Hide ranges out of view'\n      }\n      filterIsActive={isFilterActive}\n      counterFiltered={filterCounter}\n      showSettingButton=\"true\"\n      onSettingClick={onSettingClick}\n    >\n      <ToolTip title=\"Preview publication string\" popupPlacement=\"right\">\n        <button style={styles.button} type=\"button\" onClick={saveAsHTMLHandler}>\n          <FaFileExport />\n        </button>\n      </ToolTip>\n      <ToolTip\n        title={\n          currentSum\n            ? `Change Ranges Sum (${Number(currentSum).toFixed(2)})`\n            : 'Change Ranges Sum'\n        }\n        popupPlacement=\"right\"\n      >\n        <button\n          css={styles.button}\n          type=\"button\"\n          onClick={showChangeRangesSumModal}\n        >\n          <SvgNmrSum />\n        </button>\n      </ToolTip>\n      <ToolTip title={`Remove all Assignments`} popupPlacement=\"right\">\n        <button\n          style={{ ...styles.center, ...styles.removeAssignmentsButton }}\n          type=\"button\"\n          onClick={handleOnRemoveAssignments}\n          disabled={!ranges || !ranges.values || ranges.values.length === 0}\n        >\n          <FaUnlink />\n        </button>\n      </ToolTip>\n\n      <ToggleButton\n        popupTitle={\n          isMultiplicityTreesVisible\n            ? 'Hide Multiplicity Trees in Spectrum'\n            : 'Show Multiplicity Trees in Spectrum'\n        }\n        popupPlacement=\"right\"\n        onClick={handleSetShowMultiplicityTrees}\n        disabled={!ranges || !ranges.values || ranges.values.length === 0}\n      >\n        <FaSitemap style={{ pointerEvents: 'none', fontSize: '12px' }} />\n      </ToggleButton>\n    </DefaultPanelHeader>\n  );\n}\n\nexport default RangesHeader;\n","import lodashGet from 'lodash/get';\nimport lodashSet from 'lodash/set';\nimport {\n  useEffect,\n  useState,\n  useCallback,\n  forwardRef,\n  useImperativeHandle,\n  useRef,\n  memo,\n} from 'react';\n\nimport IsotopesViewer from '../../elements/IsotopesViewer';\nimport { useAlert } from '../../elements/popup/Alert';\nimport { SET_PANELS_PREFERENCES } from '../../reducer/preferencesReducer';\nimport {\n  useStateWithLocalStorage,\n  getValue as getValueByKeyPath,\n} from '../../utility/LocalStorage';\nimport ColumnFormatField from '../extra/preferences/ColumnFormatField';\nimport { rangeDefaultValues } from '../extra/preferences/defaultValues';\n\nconst styles = {\n  container: {\n    padding: 10,\n    backgroundColor: '#f1f1f1',\n    height: '100%',\n    flex: 1,\n  },\n  groupContainer: {\n    padding: '5px',\n    borderRadius: '5px',\n    margin: '10px 0px',\n    backgroundColor: 'white',\n  },\n  row: {\n    display: 'flex',\n    margin: '5px 0px',\n  },\n  header: {\n    borderBottom: '1px solid #e8e8e8',\n    paddingBottom: '5px',\n    fontWeight: 'bold',\n    color: '#4a4a4a',\n  },\n  inputLabel: {\n    flex: 2,\n    fontSize: '11px',\n    fontWeight: 'bold',\n    color: '#232323',\n  },\n  input: {\n    width: '30%',\n    textAlign: 'center',\n  },\n};\n\nfunction RangesPreferences({ nucleus, preferences }, ref) {\n  const alert = useAlert();\n  const [, setSettingsData] = useStateWithLocalStorage('nmr-general-settings');\n  const [settings, setSetting] = useState(null);\n  const formRef = useRef();\n\n  useEffect(() => {\n    const integralsPreferences = getValueByKeyPath(\n      preferences,\n      'formatting.panels.ranges',\n    );\n    if (integralsPreferences) {\n      setSetting(integralsPreferences);\n    }\n  }, [preferences]);\n\n  const saveToLocalStorgate = (values) => {\n    setSettingsData(values, 'formatting.panels.ranges');\n  };\n\n  const saveHandler = useCallback(\n    (values, showMessage = false) => {\n      preferences.dispatch({\n        type: SET_PANELS_PREFERENCES,\n        payload: { key: 'ranges', value: values },\n      });\n      if (showMessage) {\n        alert.success('ranges preferences saved successfully');\n      }\n    },\n    [alert, preferences],\n  );\n\n  useImperativeHandle(ref, () => ({\n    saveSetting() {\n      if (typeof formRef.current.requestSubmit === 'function') {\n        formRef.current.requestSubmit();\n      } else {\n        formRef.current.dispatchEvent(\n          new Event('submit', { cancelable: true }),\n        );\n      }\n    },\n  }));\n\n  const formatFields = [\n    {\n      id: 1,\n      label: 'From :',\n      checkController: 'showFrom',\n      formatController: 'fromFormat',\n      defaultFormat: '0.00',\n    },\n    {\n      id: 2,\n      label: 'To :',\n      checkController: 'showTo',\n      formatController: 'toFormat',\n      defaultFormat: '0.00',\n    },\n    {\n      id: 3,\n      label: 'Absolute :',\n      checkController: 'showAbsolute',\n      formatController: 'absoluteFormat',\n      defaultFormat: '0.00',\n    },\n    {\n      id: 4,\n      label: 'Relative :',\n      checkController: 'showRelative',\n      formatController: 'relativeFormat',\n      defaultFormat: '00.00',\n    },\n  ];\n\n  const handleSubmit = async (event) => {\n    event.preventDefault();\n    const form = event.target;\n    const formData = new FormData(form);\n    let values = {};\n    for (const field of formData.entries()) {\n      const keys = field[0].split('-').join('.');\n      const val = ['true', 'false'].includes(field[1])\n        ? field[1] === 'true'\n        : field[1];\n      values = lodashSet(values, keys, val);\n    }\n\n    saveHandler(values, true);\n    saveToLocalStorgate(values);\n  };\n\n  const getValue = useCallback(\n    (...params) => {\n      const keys = params.join('.');\n      if (settings) {\n        const value = lodashGet(settings, keys);\n        return value ? value : null;\n      } else {\n        const keyIndex = params.length - 1;\n        return rangeDefaultValues[params[keyIndex]];\n      }\n    },\n    [settings],\n  );\n\n  return (\n    <div style={styles.container}>\n      <form onSubmit={handleSubmit} ref={formRef}>\n        {nucleus &&\n          nucleus.map((nucleusLabel) => (\n            <div key={nucleusLabel} style={styles.groupContainer}>\n              <IsotopesViewer style={styles.header} value={nucleusLabel} />\n              {formatFields.map((field) => (\n                <ColumnFormatField\n                  key={field.id}\n                  label={field.label}\n                  checked={getValue(nucleusLabel, field.checkController)}\n                  format={getValue(nucleusLabel, field.formatController)}\n                  checkControllerName={field.checkController}\n                  formatControllerName={field.formatController}\n                  groupID={nucleusLabel}\n                />\n              ))}\n            </div>\n          ))}\n      </form>\n    </div>\n  );\n}\n\nexport default memo(forwardRef(RangesPreferences));\n","import { useCallback, useEffect, useState } from 'react';\n\n/**\n *\n * @param {string} key\n * @param {Array} data\n */\n\nlet oldId = null;\n\nfunction useToggleStatus(key, data) {\n  const [status, setStatus] = useState({});\n\n  useEffect(() => {\n    let statusflags = {};\n    if (data && Array.isArray(data)) {\n      for (let i = 0; i < data.length; i++) {\n        statusflags[data[i][key]] = false;\n      }\n      setStatus(statusflags);\n    }\n  }, [data, key]);\n\n  const toggle = useCallback(\n    (id) => {\n      const newStatus = { ...status };\n      if (oldId) {\n        newStatus[oldId] = false;\n      }\n      if (id != null) {\n        oldId = id;\n        newStatus[id] = true;\n      }\n      setStatus(newStatus);\n    },\n    [status],\n  );\n\n  return [status, toggle];\n}\n\nexport default useToggleStatus;\n","import lodash from 'lodash';\n\nimport FormatNumber from '../../../utility/FormatNumber';\n\nexport default class ColumnsHelper {\n  constructor(preferences, defaultPreference) {\n    this.preferences = preferences;\n    this.defaultPreference = defaultPreference;\n  }\n\n  checkPreferences(preferencesToCheck, key) {\n    const val =\n      preferencesToCheck === undefined ||\n      Object.keys(preferencesToCheck).length === 0 ||\n      (preferencesToCheck && preferencesToCheck[key] === true)\n        ? true\n        : false;\n    return val;\n  }\n\n  setCustomColumn(array, index, columnLabel, cellHandler) {\n    array.push({\n      orderIndex: index,\n      Header: columnLabel,\n      sortType: 'basic',\n      Cell: ({ row }) => cellHandler(row),\n    });\n  }\n  /**\n   * @callback hasPrefix\n   * @param {...any}\n   * @returns {boolean}\n   */\n\n  /**\n   *\n   * @param {string} columns\n   * @param {string} flagKey\n   * @param {string} formatKey\n   * @param {string} columnKey\n   * @param {string} columnLabel\n   * @param {string} columnIndex\n   * @param {Object=} [option = {}]\n   * @param {string} [option.formatPrefix = '']\n   * @param {string} [option.formatSuffix = '']\n   * @param {hasPrefix}   [option.showPrefixSuffixCallback = ()=>true]\n   */\n  addColumn(\n    columns,\n    flagKey,\n    formatKey,\n    columnKey,\n    columnLabel,\n    columnIndex,\n    options = {},\n  ) {\n    const preferences = this.preferences || this.defaultPreference;\n\n    if (this.checkPreferences(preferences, flagKey)) {\n      this.setCustomColumn(columns, columnIndex, columnLabel, (row) => {\n        const format =\n          preferences &&\n          Object.prototype.hasOwnProperty.call(preferences, formatKey)\n            ? preferences[formatKey]\n            : this.defaultPreference[formatKey];\n\n        const {\n          formatPrefix = '',\n          formatSuffix = '',\n          showPrefixSuffixCallback = () => true,\n        } = options;\n\n        if (showPrefixSuffixCallback(row)) {\n          return FormatNumber(\n            row.original[columnKey],\n            format,\n            formatPrefix,\n            formatSuffix,\n          );\n        } else {\n          return FormatNumber(row.original[columnKey], format, '', '');\n        }\n      });\n    }\n  }\n}\n\nexport function isColumnVisible(preferences, key) {\n  return lodash.get(preferences, key, false);\n}\n","import FormatNumber from '../../../utility/FormatNumber';\n\nfunction AbsoluteColumn({ rowSpanTags, value, onHoverRange, format }) {\n  return (\n    <td {...rowSpanTags} {...onHoverRange}>\n      {FormatNumber(value, format)}\n    </td>\n  );\n}\n\nexport default AbsoluteColumn;\n","/** @jsxImportSource @emotion/react */\nimport { Fragment } from 'react';\n\nfunction Button({ onClick, ...props }) {\n  return (\n    <Fragment>\n      <button type=\"button\" onClick={onClick} {...props} />\n    </Fragment>\n  );\n}\n\nexport default Button;\n","/** @jsxImportSource @emotion/react */\nimport { useField } from 'formik';\n\nfunction ErrorMessage({ style, ...props }) {\n  const meta = useField(props)[1];\n\n  return (\n    <div>\n      {meta.error ? (\n        <p style={{ color: 'red', margin: '0.5px', ...style }}>{meta.error}</p>\n      ) : null}\n    </div>\n  );\n}\n\nexport default ErrorMessage;\n","import { useField } from 'formik';\n\nimport ErrorMessage from './ErrorMessage';\n\nfunction Input({ onFocus, onBlur, enableErrorMessage, ...props }) {\n  const [field] = useField(props);\n  return (\n    <div>\n      <input\n        {...field}\n        {...props}\n        onFocus={() => onFocus(field.name)}\n        onBlur={() => onBlur(field.name)}\n      />\n      {enableErrorMessage && enableErrorMessage === true ? (\n        <ErrorMessage {...props} />\n      ) : null}\n    </div>\n  );\n}\n\nInput.defaultProps = {\n  onFocus: () => null,\n  onBlur: () => null,\n};\n\nexport default Input;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useFormikContext } from 'formik';\nimport { memo, useState, useCallback, useEffect } from 'react';\nimport { FaPlus } from 'react-icons/fa';\n\nimport Button from '../../../../elements/Button';\nimport Input from '../../../../elements/formik/Input';\nimport { translateMultiplet } from '../../../../panels/extra/utilities/MultiplicityUtilities';\n\nconst AddSignalFormTabStyle = css`\n  text-align: center;\n  width: 100%;\n  height: 100%;\n\n  .infoText {\n    margin-top: 20px;\n    font-size: 12px;\n  }\n\n  input {\n    background-color: transparent;\n    border: 0.5px solid #dedede;\n    width: 50%;\n    text-align: center;\n  }\n\n  .addSignalButton {\n    margin-top: 15px;\n    margin-top: 20px;\n    background-color: transparent;\n    border: none;\n    padding: 0.3rem;\n    border-radius: 25%;\n  }\n`;\n\nfunction AddSignalFormTab({ onFocus, onBlur }) {\n  const { values, setFieldValue, errors } = useFormikContext();\n\n  const [disableAddButton, setDisableAddButton] = useState(false);\n\n  const onAddSignal = useCallback(() => {\n    const newSignal = {\n      multiplicity: 'm',\n      kind: 'signal',\n      delta: Number(values.newSignalDelta),\n      j: [{ multiplicity: translateMultiplet('m'), coupling: '' }],\n    };\n    const _signals = values.signals.slice().concat(newSignal);\n\n    setFieldValue('signals', _signals);\n    setFieldValue('activeTab', String(_signals.length - 1));\n  }, [setFieldValue, values.newSignalDelta, values.signals]);\n\n  useEffect(() => {\n    if (errors.newSignalDelta) {\n      setDisableAddButton(true);\n    } else {\n      setDisableAddButton(false);\n    }\n  }, [errors.newSignalDelta, values.signals]);\n\n  return (\n    <div css={AddSignalFormTabStyle}>\n      <div>\n        <p className=\"infoText\">\n          Edit or select a delta value of new signal (ppm):\n        </p>\n        <Input\n          name=\"newSignalDelta\"\n          type=\"number\"\n          placeholder={`${'\\u0394'} (ppm)`}\n          onFocus={onFocus}\n          onBlur={onBlur}\n        />\n      </div>\n\n      <div>\n        <Button\n          className=\"addSignalButton\"\n          onClick={onAddSignal}\n          disabled={disableAddButton}\n          css={{\n            color: disableAddButton ? 'grey' : 'blue',\n            width: '100%',\n          }}\n        >\n          <FaPlus title=\"Add new signal\" />\n        </Button>\n      </div>\n    </div>\n  );\n}\n\nexport default memo(AddSignalFormTab);\n","/** @jsxImportSource @emotion/react */\nimport { Field, useField } from 'formik';\nimport PropTypes from 'prop-types';\n\nimport ErrorMessage from './ErrorMessage';\n\nfunction SelectBox({ values, ...props }) {\n  const [field] = useField(props);\n\n  return values && values.length > 0 ? (\n    <div>\n      <Field as=\"select\" {...field} {...props}>\n        {values.map((value, i) => {\n          return (\n            <option\n              // eslint-disable-next-line react/no-array-index-key\n              key={i}\n            >\n              {value}\n            </option>\n          );\n        })}\n      </Field>\n      <ErrorMessage {...props} />\n    </div>\n  ) : null;\n}\n\nSelectBox.protoTypes = {\n  valuePath: PropTypes.instanceOf(Array).isRequired,\n  valueSelectionTemplate: PropTypes.func,\n};\n\nexport default SelectBox;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useFormikContext } from 'formik';\nimport lodashGet from 'lodash/get';\nimport { memo, useEffect, useCallback } from 'react';\nimport { FaMinus, FaPlus } from 'react-icons/fa';\n\nimport { Multiplets } from '../../../../../data/constants/Multiplets';\nimport Button from '../../../../elements/Button';\nimport Input from '../../../../elements/formik/Input';\nimport SelectBox from '../../../../elements/formik/SelectBox';\nimport {\n  hasCouplingConstant,\n  translateMultiplet,\n} from '../../../../panels/extra/utilities/MultiplicityUtilities';\n\nconst CouplingsTableStyle = css`\n  border-spacing: 0;\n  border: 1px solid #dedede;\n  width: 100%;\n  height: 100%;\n  font-size: 12px;\n\n  th,\n  td {\n    text-align: center;\n    margin: 0;\n    padding: 0.4rem;\n    border-bottom: 1px solid #dedede;\n    border-right: 1px solid #dedede;\n\n    button {\n      background-color: transparent;\n      border: none;\n    }\n\n    .add-button {\n      color: blue;\n    }\n\n    .delete-button {\n      border-radius: 25%;\n      padding: 0;\n      padding-left: 0.3rem;\n      padding-right: 0.3rem;\n    }\n    .delete-button:hover {\n      background-color: red;\n      .icon {\n        color: white;\n      }\n    }\n\n    input {\n      background-color: transparent;\n      border: 0.5px solid #dedede;\n      height: 100%;\n      width: 100%;\n      text-align: center;\n    }\n    .selectBox {\n      background-color: transparent;\n      border: 0.5px solid #dedede;\n      height: 100%;\n      width: 100%;\n      text-align: center;\n    }\n  }\n\n  tr {\n    :last-child {\n      border-top: 3px solid #dedede;\n    }\n  }\n`;\n\nconst errorStyle = {\n  border: '1px solid red',\n};\n\nfunction CouplingsTable({ push, remove, onFocus, onBlur }) {\n  const { values, setFieldValue, errors } = useFormikContext();\n\n  useEffect(() => {\n    if (values.signals[values.activeTab]) {\n      values.signals[values.activeTab].j.forEach((_coupling, i) => {\n        if (!hasCouplingConstant(_coupling.multiplicity)) {\n          setFieldValue(`signals.${values.activeTab}.j.${i}.coupling`, '');\n        }\n      });\n    }\n  }, [setFieldValue, values.activeTab, values.signals]);\n\n  const hasMissingCouplingValue = useCallback(\n    (i) =>\n      lodashGet(\n        errors,\n        `signals[${values.activeTab}].missingCouplings`,\n        [],\n      ).some((_error) => _error.index === i),\n    [errors, values.activeTab],\n  );\n\n  return (\n    <table css={CouplingsTableStyle}>\n      <tbody>\n        <tr>\n          <th>#</th>\n          <th>Multiplicity</th>\n          <th>J (Hz)</th>\n          <th>{''}</th>\n        </tr>\n        {lodashGet(values, `signals[${values.activeTab}].j`, []).map(\n          (_coupling, i) => (\n            <tr\n              // eslint-disable-next-line react/no-array-index-key\n              key={`editCouplings${values.activeTab}${i}`}\n            >\n              <td>{i + 1}</td>\n              <td>\n                <SelectBox\n                  className=\"selectBox\"\n                  name={`signals.${values.activeTab}.j.${i}.multiplicity`}\n                  values={Multiplets.map((_multiplet) => _multiplet.label)}\n                />\n              </td>\n              <td>\n                <Input\n                  name={`signals.${values.activeTab}.j.${i}.coupling`}\n                  type=\"number\"\n                  placeholder={'J (Hz)'}\n                  disabled={!hasCouplingConstant(_coupling.multiplicity)}\n                  onFocus={onFocus}\n                  onBlur={onBlur}\n                  style={hasMissingCouplingValue(i) ? errorStyle : null}\n                />\n              </td>\n              <td>\n                <Button\n                  className=\"delete-button\"\n                  onClick={() => {\n                    remove(i);\n                  }}\n                >\n                  <FaMinus className=\"icon\" title=\"Delete coupling\" />\n                </Button>\n              </td>\n            </tr>\n          ),\n        )}\n        <tr />\n        <tr>\n          <td colSpan={4}>\n            <Button\n              className=\"add-button\"\n              onClick={() =>\n                push({\n                  multiplicity: translateMultiplet('m'),\n                  coupling: '',\n                })\n              }\n            >\n              <FaPlus title=\"Add new coupling\" />\n            </Button>\n          </td>\n        </tr>\n      </tbody>\n    </table>\n  );\n}\n\nexport default memo(CouplingsTable);\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useFormikContext, FieldArray } from 'formik';\nimport { memo } from 'react';\n\nimport CouplingsTable from './CouplingsTable';\n\nconst SignalFormTabStyle = css`\n  border-spacing: 0;\n  border: 1px solid #dedede;\n  width: 100%;\n  font-size: 12px;\n  height: 100%;\n\n  margin: 0;\n  padding: 0.4rem;\n  text-align: center;\n`;\n\nfunction SignalFormTab({ onFocus, onBlur }) {\n  const { values } = useFormikContext();\n\n  return (\n    <div css={SignalFormTabStyle}>\n      <FieldArray\n        name={`signals.${values.activeTab}.j`}\n        render={({ push, remove }) => (\n          <div>\n            <CouplingsTable\n              push={push}\n              remove={remove}\n              onFocus={onFocus}\n              onBlur={onBlur}\n            />\n          </div>\n        )}\n      />\n    </div>\n  );\n}\n\nexport default memo(SignalFormTab);\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useFormikContext } from 'formik';\nimport lodashGet from 'lodash/get';\nimport { useCallback, useMemo, memo, useEffect, useState } from 'react';\n\nimport { useChartData } from '../../../../context/ChartContext';\nimport { Tabs } from '../../../../elements/Tab';\nimport { translateMultiplet } from '../../../../panels/extra/utilities/MultiplicityUtilities';\nimport Events from '../../../../utility/Events';\n\nimport AddSignalFormTab from './AddSignalFormTab';\nimport SignalFormTab from './SignalFormTab';\n\nconst textStyles = css`\n  text-align: center;\n  width: 100%;\n\n  .errorText {\n    color: red;\n  }\n\n  .infoText {\n    margin-bottom: 20px;\n    font-size: 11px;\n  }\n`;\n\nconst tabStylesAddition = css`\n  color: red;\n`;\n\nfunction SignalsForm() {\n  const { values, setFieldValue, errors } = useFormikContext();\n\n  const { data: spectraData, activeSpectrum } = useChartData();\n  const [activeField, setActiveField] = useState(null);\n  const [frequency, setFrequency] = useState(null);\n\n  useEffect(() => {\n    if (\n      spectraData &&\n      activeSpectrum &&\n      lodashGet(\n        spectraData,\n        `[${activeSpectrum.index}].info.originFrequency`,\n        undefined,\n      )\n    ) {\n      setFrequency(spectraData[activeSpectrum.index].info.originFrequency);\n    } else {\n      setFrequency(null);\n    }\n  }, [activeSpectrum, spectraData]);\n\n  useEffect(() => {\n    Events.on('brushEnd', (event) => {\n      if (activeField && frequency) {\n        setFieldValue(\n          activeField,\n          Math.abs(event.range[0] - event.range[1]) * frequency,\n        );\n      }\n    });\n\n    return () => {\n      Events.off('brushEnd');\n    };\n  }, [activeField, setFieldValue, frequency, values.activeTab]);\n\n  useEffect(() => {\n    Events.on('mouseClick', (event) => {\n      if (values.activeTab === 'addSignalTab' && activeField) {\n        setFieldValue(activeField, event.xPPM);\n      }\n    });\n\n    return () => {\n      Events.off('mouseClick');\n    };\n  }, [values.activeTab, activeField, setFieldValue]);\n\n  const handleOnFocus = useCallback(\n    (name) => {\n      setActiveField(name);\n    },\n    [setActiveField],\n  );\n\n  const tapClickHandler = useCallback(\n    ({ tabid }) => {\n      setFieldValue('activeTab', tabid);\n      setActiveField(null);\n    },\n    [setFieldValue],\n  );\n\n  const handleDeleteSignal = useCallback(\n    ({ tabid }) => {\n      const _signals = values.signals.filter(\n        (_signal, i) => i !== Number(tabid),\n      );\n      setFieldValue('signals', _signals);\n    },\n    [setFieldValue, values.signals],\n  );\n\n  useEffect(() => {\n    setFieldValue(\n      'activeTab',\n      values.signals.length > 0\n        ? (values.signals.length - 1).toString()\n        : 'addSignalTab',\n    );\n  }, [setFieldValue, values.signals.length]);\n\n  const tabContainsErrors = useCallback(\n    (i) => {\n      return (\n        errors.signals &&\n        (lodashGet(errors, 'signals.noCouplings', []).some(\n          (_error) => _error.index === i,\n        ) ||\n          lodashGet(errors, `signals[${i}].missingCouplings`, []).length > 0)\n      );\n    },\n    [errors],\n  );\n\n  const signalFormTabs = useMemo(() => {\n    const signalTabs =\n      values.signals.length > 0\n        ? values.signals.map((signal, i) => (\n            <div\n              // eslint-disable-next-line react/no-array-index-key\n              key={`signalForm${i}`}\n              tabid={`${i}`}\n              tablabel={`${'\\u0394'}: ${signal.delta.toFixed(\n                5,\n              )} (${signal.j\n                .map((_coupling) => translateMultiplet(_coupling.multiplicity))\n                .join('')})`}\n              tabstyles={tabContainsErrors(i) ? tabStylesAddition : null}\n            >\n              <SignalFormTab onFocus={handleOnFocus} />\n            </div>\n          ))\n        : [];\n\n    const addSignalTab = (\n      <div\n        tablabel={'\\u002B'}\n        tabid=\"addSignalTab\"\n        candelete=\"false\"\n        key=\"addSignalTab\"\n      >\n        <AddSignalFormTab onFocus={handleOnFocus} />\n      </div>\n    );\n\n    return signalTabs.concat(addSignalTab);\n  }, [handleOnFocus, tabContainsErrors, values.signals]);\n\n  const editSignalInfoText = (\n    <p className=\"infoText\">\n      Focus on an input field and press Shift + Drag &#38; Drop to draw a\n      coupling constant in spectrum view.\n    </p>\n  );\n\n  const addSignalInfoText = (\n    <p className=\"infoText\">\n      Focus on the input field and press Shift + Left mouse click to select new\n      signal delta value in spectrum view.\n    </p>\n  );\n\n  return (\n    <div>\n      <div css={textStyles}>\n        {errors.signals &&\n        (errors.signals.noSignals || errors.signals.noCouplings) ? (\n          <div>\n            <p className=\"errorText\">\n              {errors.signals.noSignals ||\n                errors.signals.noCouplings[0].message}\n            </p>\n            {errors.signals.noSignals ? addSignalInfoText : null}\n          </div>\n        ) : values.activeTab === 'addSignalTab' ? (\n          addSignalInfoText\n        ) : (\n          editSignalInfoText\n        )}\n      </div>\n      <Tabs\n        defaultTabID={values.activeTab}\n        onClick={tapClickHandler}\n        canDelete\n        onDelete={handleDeleteSignal}\n      >\n        {signalFormTabs}\n      </Tabs>\n    </div>\n  );\n}\n\nexport default memo(SignalsForm);\n","import { hasCouplingConstant } from '../../../../panels/extra/utilities/MultiplicityUtilities';\n\nfunction EditRangeValidation(values, rangeData) {\n  const errors = {};\n\n  if (!values.newSignalDelta) {\n    errors.newSignalDelta = 'required';\n  } else if (\n    values.newSignalDelta < rangeData.from ||\n    values.newSignalDelta > rangeData.to\n  ) {\n    errors.newSignalDelta = ` ${values.newSignalDelta.toFixed(\n      5,\n    )} ppm out of the range`;\n  }\n\n  const createSignalsError = (i) => {\n    if (!errors.signals) {\n      errors.signals = {};\n    }\n    if (i !== undefined && !errors.signals[`${i}`]) {\n      errors.signals[`${i}`] = { missingCouplings: [] };\n    }\n  };\n\n  if (values.signals.length === 0) {\n    createSignalsError();\n    errors.signals.noSignals = 'There must be at least one signal in a range!';\n  } else {\n    values.signals.forEach((_signal, i) => {\n      if (_signal.j.length === 0) {\n        createSignalsError(i);\n        if (!errors.signals.noCouplings) {\n          errors.signals.noCouplings = [];\n        }\n        errors.signals.noCouplings.push({\n          index: i,\n          message: `There must be at least one coupling in signal ${i + 1}!`,\n        });\n      }\n      _signal.j.forEach((_coupling, j) => {\n        if (\n          hasCouplingConstant(_coupling.multiplicity) &&\n          _coupling.coupling === ''\n        ) {\n          createSignalsError(i);\n          errors.signals[`${i}`].missingCouplings.push({\n            index: j,\n            message: `There are coupling values missing in signal ${i + 1}!`,\n          });\n        }\n      });\n    });\n  }\n\n  return errors;\n}\n\nexport default EditRangeValidation;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { Form, Formik } from 'formik';\nimport { useCallback, useEffect, useMemo } from 'react';\nimport { FaSearchPlus } from 'react-icons/fa';\n\nimport generateID from '../../../data/utilities/generateID';\nimport Button from '../../elements/Button';\nimport CloseButton from '../../elements/CloseButton';\nimport SaveButton from '../../elements/SaveButton';\nimport {\n  hasCouplingConstant,\n  translateMultiplet,\n} from '../../panels/extra/utilities/MultiplicityUtilities';\n\nimport SignalsForm from './forms/components/SignalsForm';\nimport EditRangeValidation from './forms/validation/EditRangeValidation';\n\nconst styles = css`\n  overflow: auto;\n  width: 600px;\n  height: 500px;\n  padding: 5px;\n  button:focus {\n    outline: none;\n  }\n  .header {\n    height: 24px;\n    border-bottom: 1px solid #f0f0f0;\n    display: flex;\n    align-items: center;\n    span {\n      color: #464646;\n      font-size: 15px;\n      flex: 1;\n      border-left: 1px solid #ececec;\n      padding-left: 6px;\n    }\n\n    button {\n      background-color: transparent;\n      border: none;\n      padding: 5px;\n\n      svg {\n        height: 16px;\n      }\n    }\n  }\n  .container {\n    display: flex;\n    margin: 30px 5px;\n    input,\n    button {\n      padding: 5px;\n      border: 1px solid gray;\n      border-radius: 5px;\n      height: 36px;\n      margin: 2px;\n    }\n    input {\n      flex: 10;\n    }\n    button {\n      flex: 2;\n      color: white;\n      background-color: gray;\n    }\n  }\n`;\n\nfunction EditRangeModal({\n  onSaveEditRangeModal,\n  onCloseEditRangeModal,\n  onZoomEditRangeModal,\n  rangeData,\n}) {\n  const handleOnZoom = useCallback(() => {\n    onZoomEditRangeModal(rangeData);\n  }, [onZoomEditRangeModal, rangeData]);\n\n  useEffect(() => {\n    handleOnZoom();\n  }, [handleOnZoom]);\n\n  const handleOnClose = useCallback(() => {\n    onCloseEditRangeModal();\n  }, [onCloseEditRangeModal]);\n\n  const getCouplings = useCallback(\n    (couplings) =>\n      couplings\n        .filter((coupling) => coupling.coupling !== '')\n        .map((coupling) => {\n          return {\n            ...coupling,\n            multiplicity: translateMultiplet(coupling.multiplicity),\n          };\n        }),\n    [],\n  );\n\n  const getSignals = useCallback(\n    (signals) => {\n      return signals.map((_signal) => {\n        return {\n          id: generateID(),\n          ..._signal,\n          multiplicity: _signal.j\n            .map((_coupling) => translateMultiplet(_coupling.multiplicity))\n            .join(''),\n          j: getCouplings(_signal.j),\n        };\n      });\n    },\n    [getCouplings],\n  );\n\n  const handleOnSave = useCallback(\n    async (formValues) => {\n      const _range = { ...rangeData };\n      _range.signal = getSignals(formValues.signals);\n      await onSaveEditRangeModal(_range);\n      handleOnClose();\n    },\n    [getSignals, handleOnClose, onSaveEditRangeModal, rangeData],\n  );\n\n  const initialStateSignals = useMemo(() => {\n    return rangeData.signal.map((_signal) => {\n      // counter within j array to access to right j values\n      let counterJ = 0;\n      const couplings = [];\n      let coupling;\n      _signal.multiplicity.split('').forEach((_multiplicity) => {\n        if (hasCouplingConstant(_multiplicity)) {\n          coupling = { ..._signal.j[counterJ] };\n          counterJ++;\n        } else {\n          coupling = { multiplicity: _multiplicity, coupling: '' };\n        }\n        coupling.multiplicity = translateMultiplet(coupling.multiplicity);\n        couplings.push(coupling);\n      });\n      return { ..._signal, j: couplings };\n    });\n  }, [rangeData.signal]);\n\n  const isSaveButtonDisabled = useCallback((errors) => {\n    const errorKeys = Object.keys(errors);\n    if (errorKeys.length > 0) {\n      if (\n        // ignore non-relevant newSignalDelta field\n        errorKeys.length === 1 &&\n        errorKeys[0] === 'newSignalDelta'\n      ) {\n        return false;\n      }\n      return true;\n    }\n    return false;\n  }, []);\n\n  return (\n    <div css={styles}>\n      {rangeData && (\n        <Formik\n          initialValues={{\n            signals: initialStateSignals,\n            newSignalDelta: (rangeData.from + rangeData.to) / 2,\n            activeTab: '0',\n          }}\n          validate={(values) => EditRangeValidation(values, rangeData)}\n          onSubmit={(values, { setSubmitting }) => {\n            handleOnSave(values);\n            setSubmitting(false);\n          }}\n        >\n          {({ values, errors }) => {\n            return (\n              <Form>\n                <div className=\"header handle\">\n                  <Button onClick={handleOnZoom} className=\"zoom-button\">\n                    <FaSearchPlus title=\"Set to default view on range in spectrum\" />\n                  </Button>\n                  <span>Range Information and Editing</span>\n                  <SaveButton\n                    onClick={() => handleOnSave(values)}\n                    disabled={isSaveButtonDisabled(errors)}\n                    popupTitle=\"Save and exit\"\n                  />\n\n                  <CloseButton onClick={handleOnClose} />\n                </div>\n                <SignalsForm />\n              </Form>\n            );\n          }}\n        </Formik>\n      )}\n    </div>\n  );\n}\n\nEditRangeModal.defaultProps = {\n  onSave: () => {\n    return null;\n  },\n  onClose: () => {\n    return null;\n  },\n  onZoom: () => {\n    return null;\n  },\n};\n\nexport default EditRangeModal;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { Fragment, useCallback } from 'react';\nimport { FaRegTrashAlt, FaSearchPlus, FaEdit } from 'react-icons/fa';\n\nimport { SignalKinds } from '../../../../data/constants/SignalsKinds';\nimport { useAssignmentData } from '../../../assignment';\nimport { useDispatch } from '../../../context/DispatchContext';\nimport Select from '../../../elements/Select';\nimport {\n  useModal,\n  positions,\n  transitions,\n} from '../../../elements/popup/Modal';\nimport EditRangeModal from '../../../modal/editRange/EditRangeModal';\nimport {\n  SET_X_DOMAIN,\n  RESET_SELECTED_TOOL,\n  SET_SELECTED_TOOL,\n  CHANGE_RANGE_SIGNAL_KIND,\n  SAVE_EDITED_RANGE,\n  DELETE_RANGE,\n} from '../../../reducer/types/Types';\n\nconst styles = css`\n  width: 66px;\n  padding: 0 !important;\n  button {\n    background-color: transparent;\n    border: none;\n    padding: 5px;\n  }\n\n  button:disabled {\n    opacity: 0.6;\n  }\n`;\nconst selectBoxStyle = {\n  marginLeft: 2,\n  marginRight: 2,\n  border: 'none',\n  height: '20px',\n};\n\nfunction ActionsColumn({ rowData, onHoverSignal, rowSpanTags }) {\n  const dispatch = useDispatch();\n  const modal = useModal();\n  const assignmentData = useAssignmentData();\n\n  const zoomRangeHandler = useCallback(() => {\n    const margin = Math.abs(rowData.from - rowData.to);\n    dispatch({\n      type: SET_X_DOMAIN,\n      xDomain: [rowData.from - margin, rowData.to + margin],\n    });\n  }, [dispatch, rowData.from, rowData.to]);\n\n  const deleteRangeHandler = useCallback(() => {\n    dispatch({\n      type: DELETE_RANGE,\n      payload: {\n        id: rowData.id,\n        assignmentData,\n      },\n    });\n  }, [assignmentData, dispatch, rowData]);\n\n  const changeRangeSignalKindHandler = useCallback(\n    (value) => {\n      dispatch({\n        type: CHANGE_RANGE_SIGNAL_KIND,\n        payload: {\n          rowData,\n          value,\n        },\n      });\n    },\n    [dispatch, rowData],\n  );\n\n  const saveEditRangeHandler = useCallback(\n    (editedRowData) => {\n      dispatch({\n        type: SAVE_EDITED_RANGE,\n        payload: {\n          editedRowData,\n          assignmentData,\n        },\n      });\n    },\n    [assignmentData, dispatch],\n  );\n\n  const closeEditRangeHandler = useCallback(() => {\n    dispatch({ type: RESET_SELECTED_TOOL });\n    modal.close();\n  }, [dispatch, modal]);\n\n  const openEditRangeHandler = useCallback(() => {\n    dispatch({ type: SET_SELECTED_TOOL, selectedTool: 'editRange' });\n    modal.show(\n      <EditRangeModal\n        onCloseEditRangeModal={closeEditRangeHandler}\n        onSaveEditRangeModal={saveEditRangeHandler}\n        onZoomEditRangeModal={zoomRangeHandler}\n        rangeData={rowData}\n      />,\n      {\n        position: positions.CENTER_RIGHT,\n        transition: transitions.SCALE,\n        isBackgroundBlur: false,\n      },\n    );\n  }, [\n    closeEditRangeHandler,\n    dispatch,\n    modal,\n    rowData,\n    saveEditRangeHandler,\n    zoomRangeHandler,\n  ]);\n\n  return (\n    <Fragment>\n      <td {...onHoverSignal}>\n        <Select\n          onChange={changeRangeSignalKindHandler}\n          data={SignalKinds}\n          defaultValue={rowData.tableMetaInfo.signal.kind}\n          style={selectBoxStyle}\n        />\n      </td>\n      <td {...rowSpanTags} css={styles}>\n        <button\n          type=\"button\"\n          className=\"delete-button\"\n          onClick={deleteRangeHandler}\n        >\n          <FaRegTrashAlt />\n        </button>\n        <button\n          type=\"button\"\n          className=\"zoom-button\"\n          onClick={zoomRangeHandler}\n        >\n          <FaSearchPlus title=\"Zoom to range in spectrum\" />\n        </button>\n        <button\n          type=\"button\"\n          className=\"edit-button\"\n          onClick={openEditRangeHandler}\n        >\n          <FaEdit color=\"blue\" />\n        </button>\n      </td>\n    </Fragment>\n  );\n}\n\nexport default ActionsColumn;\n","import lodashGet from 'lodash/get';\n\nfunction CouplingColumn({ rowData, onHoverSignal }) {\n  const result = lodashGet(rowData, 'tableMetaInfo.signal.j');\n  return (\n    <td {...onHoverSignal}>\n      {result &&\n        result.map((coupling) => coupling.coupling.toFixed(1)).join(',')}\n    </td>\n  );\n}\n\nexport default CouplingColumn;\n","import lodashGet from 'lodash/get';\nimport { useMemo, useCallback, memo } from 'react';\nimport { FaMinusCircle } from 'react-icons/fa';\n\nconst spanStyle = {\n  color: 'red',\n  fontWeight: 'bold',\n};\n\nfunction RangeAssignmentsColumn({\n  rowData,\n  assignment,\n  highlight,\n  onUnlinkVisibilityChange,\n  unlinkVisibility,\n  onLink,\n  onUnlink,\n  rowSpanTags,\n  onHover,\n  highlightData,\n}) {\n  const diaIDs = useMemo(() => {\n    return lodashGet(rowData, 'diaID', []);\n  }, [rowData]);\n\n  const visibilityChangeHandler = useCallback(\n    (flag) => {\n      onUnlinkVisibilityChange(flag);\n    },\n    [onUnlinkVisibilityChange],\n  );\n\n  const spanCss = useMemo(() => {\n    const flag =\n      assignment.isActive ||\n      assignment.isOnHover ||\n      (highlight.isActive &&\n        !highlightData.highlight.highlighted.find((_highlighted) => {\n          return _highlighted === assignment.id;\n        }));\n\n    return flag\n      ? {\n          color: 'red',\n          fontWeight: 'bold',\n        }\n      : { color: 'black', fontWeight: 'normal' };\n  }, [\n    assignment.id,\n    assignment.isActive,\n    assignment.isOnHover,\n    highlight.isActive,\n    highlightData.highlight.highlighted,\n  ]);\n\n  return (\n    <td\n      {...rowSpanTags}\n      {...onHover}\n      {...{ onClick: (e) => onLink(e, assignment) }}\n    >\n      {rowData.pubIntegral !== undefined && rowData.pubIntegral > 0 ? (\n        rowData.diaID && rowData.diaID.length > 0 ? (\n          <div\n            onMouseEnter={() => visibilityChangeHandler(true)}\n            onMouseLeave={() => visibilityChangeHandler(false)}\n          >\n            {rowData.pubIntegral} {' ( '}\n            <span style={spanCss}>{diaIDs.length}</span>\n            {' ) '}\n            <sup>\n              <button\n                type=\"button\"\n                style={{\n                  visibility: unlinkVisibility ? 'visible' : 'hidden',\n                  padding: 0,\n                  margin: 0,\n                }}\n                onClick={(e) => onUnlink(e, true)}\n              >\n                <FaMinusCircle color=\"red\" />\n              </button>\n            </sup>\n          </div>\n        ) : assignment.isActive ? (\n          <div>\n            {`${rowData.pubIntegral} (`}\n            <span style={spanStyle}>0</span>\n            {')'}\n          </div>\n        ) : (\n          rowData.pubIntegral\n        )\n      ) : assignment.isActive ? (\n        <div>\n          {'0 ('}\n          <span style={spanStyle}>0</span>\n          {')'}\n        </div>\n      ) : (\n        ''\n      )}\n    </td>\n  );\n}\n\nRangeAssignmentsColumn.defaultProps = {\n  onHover: () => null,\n  onUnlinkVisibilityChange: () => null,\n  onLink: () => null,\n  onUnlink: () => null,\n};\n\nexport default memo(RangeAssignmentsColumn);\n","import { memo } from 'react';\n\nimport FormatNumber from '../../../utility/FormatNumber';\n\nfunction RangeColumn({ value, rowSpanTags, onHoverRange, format }) {\n  return (\n    <td {...rowSpanTags} {...onHoverRange}>\n      {FormatNumber(value, format)}\n    </td>\n  );\n}\n\nexport default memo(RangeColumn);\n","import { forwardRef, useCallback, useMemo } from 'react';\n\nimport { checkRangeKind } from '../../../../data/utilities/RangeUtilities';\nimport { useDispatch } from '../../../context/DispatchContext';\nimport EditableColumn from '../../../elements/EditableColumn';\nimport { CHANGE_RANGE_RELATIVE } from '../../../reducer/types/Types';\nimport FormatNumber from '../../../utility/FormatNumber';\n\nfunction RelativeColumn(\n  { rowData, rowSpanTags, onHoverRange, format, onEditStart, editStatus },\n  ref,\n) {\n  const dispatch = useDispatch();\n  const integralVal = useMemo(() => {\n    const flag = checkRangeKind(rowData);\n    const formattedValue = FormatNumber(rowData.integral, format);\n    return flag ? formattedValue : `[ ${formattedValue} ]`;\n  }, [format, rowData]);\n\n  const saveHandler = useCallback(\n    (event) => {\n      dispatch({\n        type: CHANGE_RANGE_RELATIVE,\n        value: event.target.value,\n        id: rowData.id,\n      });\n    },\n    [dispatch, rowData.id],\n  );\n\n  return (\n    <td {...rowSpanTags} {...onHoverRange}>\n      <EditableColumn\n        ref={ref}\n        onEditStart={onEditStart}\n        value={integralVal}\n        onSave={saveHandler}\n        type=\"number\"\n        style={{ padding: '0.1rem 0.4rem' }}\n        editStatus={editStatus}\n      />\n    </td>\n  );\n}\n\nexport default forwardRef(RelativeColumn);\n","import lodashGet from 'lodash/get';\nimport { useMemo, useCallback, memo } from 'react';\nimport { FaMinusCircle } from 'react-icons/fa';\n\nfunction SignalAssignmentsColumn({\n  rowData,\n  onHover,\n  assignment,\n  highlight,\n  onUnlinkVisibilityChange,\n  unlinkVisibility,\n  onLink,\n  onUnlink,\n}) {\n  const diaIDs = useMemo(() => {\n    return lodashGet(rowData, 'tableMetaInfo.signal.diaID', []);\n  }, [rowData]);\n\n  const tdCss = useMemo(() => {\n    return assignment.isActive || highlight.isActive\n      ? {\n          color: 'red',\n          fontWeight: 'bold',\n        }\n      : null;\n  }, [assignment.isActive, highlight.isActive]);\n\n  const visibilityChangeHandler = useCallback(\n    (flag) => {\n      onUnlinkVisibilityChange(flag);\n    },\n    [onUnlinkVisibilityChange],\n  );\n  const assignHandler = useCallback(\n    (e) => {\n      onLink(e, assignment);\n    },\n    [assignment, onLink],\n  );\n\n  return (\n    <td {...onHover} onClick={assignHandler} style={tdCss}>\n      {diaIDs && diaIDs.length > 0 ? (\n        <div\n          onMouseEnter={() => visibilityChangeHandler(true)}\n          onMouseLeave={() => visibilityChangeHandler(false)}\n        >\n          {diaIDs.length}{' '}\n          <sup>\n            <button\n              type=\"button\"\n              style={{\n                visibility: unlinkVisibility ? 'visible' : 'hidden',\n                padding: 0,\n                margin: 0,\n              }}\n              onClick={(e) => onUnlink(e, false)}\n            >\n              <FaMinusCircle color=\"red\" />\n            </button>\n          </sup>\n        </div>\n      ) : assignment.isActive ? (\n        '0'\n      ) : (\n        ''\n      )}\n    </td>\n  );\n}\n\nSignalAssignmentsColumn.defaultProps = {\n  onHover: () => null,\n  onUnlinkVisibilityChange: () => null,\n  onLink: () => null,\n  onUnlink: () => null,\n};\n\nexport default memo(SignalAssignmentsColumn);\n","import lodashGet from 'lodash/get';\n\nimport FormatNumber from '../../../utility/FormatNumber';\n\nexport default function useFormat(preferences) {\n  return (value, keysPath, prefix = '', suffix = '') => {\n    const format = lodashGet(preferences, keysPath, '0.000');\n    return FormatNumber(value, format, prefix, suffix);\n  };\n}\n","import { useCallback } from 'react';\n\nimport { useDispatch } from '../../../context/DispatchContext';\nimport EditableColumn from '../../../elements/EditableColumn';\nimport { CHANGE_RANGE_SIGNAL_VALUE } from '../../../reducer/types/Types';\nimport { checkMultiplicity } from '../../extra/utilities/MultiplicityUtilities';\n\nimport useFormat from './format';\n\nfunction SignalDeltaColumn({\n  rowData,\n  onHoverSignal,\n  preferences,\n  onEditStart,\n  editStatus,\n}) {\n  const dispatch = useDispatch();\n  const signal = rowData.tableMetaInfo.signal;\n  const format = useFormat(preferences);\n\n  const saveHandler = useCallback(\n    (event) => {\n      dispatch({\n        type: CHANGE_RANGE_SIGNAL_VALUE,\n        payload: {\n          value: event.target.value,\n          rangeID: rowData.id,\n          signalID: signal.id,\n        },\n      });\n    },\n    [dispatch, rowData, signal.id],\n  );\n  const editStartHandler = useCallback(() => {\n    onEditStart(signal.id);\n  }, [onEditStart, signal.id]);\n\n  if (!signal) return <td>{''}</td>;\n\n  return (\n    <td {...onHoverSignal}>\n      {!checkMultiplicity(signal.multiplicity, ['m']) ? (\n        `${format(rowData.from, 'fromFormat')} - ${format(\n          rowData.to,\n          'toFormat',\n        )}`\n      ) : (\n        <EditableColumn\n          onEditStart={editStartHandler}\n          value={signal.delta.toFixed(3)}\n          onSave={saveHandler}\n          type=\"number\"\n          style={{ padding: '0.1rem 0.4rem' }}\n          editStatus={editStatus}\n        />\n      )}\n    </td>\n  );\n}\n\nexport default SignalDeltaColumn;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport lodashGet from 'lodash/get';\nimport { useMemo, useCallback, useState } from 'react';\n\nimport { useAssignment } from '../../assignment';\nimport { useHighlight, useHighlightData } from '../../highlight';\nimport { isColumnVisible } from '../extra/preferences/ColumnsHelper';\n\nimport AbsoluteColumn from './TableColumns/AbsoluteColumn';\nimport ActionsColumn from './TableColumns/ActionsColumn';\nimport CouplingColumn from './TableColumns/CouplingColumn';\nimport RangeAssignmentsColumn from './TableColumns/RangeAssignmentsColumn';\nimport RangeColumn from './TableColumns/RangeColumn';\nimport RelativeColumn from './TableColumns/RelativeColumn';\nimport SignalAssignmentsColumn from './TableColumns/SignalAssignmentsColumn';\nimport SignalDeltaColumn from './TableColumns/SignalDeltaColumn';\nimport useFormat from './TableColumns/format';\n\nconst HighlightedRowStyle = css`\n  background-color: #ff6f0057;\n`;\n\nconst ConstantlyHighlightedRowStyle = css`\n  background-color: #f5f5dc;\n`;\n\nfunction RangesTableRow({\n  rowData,\n  onUnlink,\n  onContextMenu,\n  onColumnEditStart,\n  preferences,\n  editFlags: { relativeFlags, signalFlags },\n}) {\n  const assignmentRange = useAssignment(rowData.id);\n  const highlightRange = useHighlight(\n    [assignmentRange.id].concat(assignmentRange.assigned.x || []),\n  );\n  const assignmentSignal = useAssignment(rowData.tableMetaInfo.id);\n  const highlightSignal = useHighlight(\n    [assignmentSignal.id].concat(assignmentSignal.assigned.x || []),\n  );\n  const highlightData = useHighlightData();\n\n  const [unlinkRangeButtonVisibility, showUnlinkRangeButton] = useState(false);\n  const [unlinkSignalButtonVisibility, showUnlinkSignalButton] = useState(\n    false,\n  );\n\n  const getFormat = useFormat(preferences);\n\n  const rowSpanTags = useMemo(() => {\n    return {\n      rowSpan: rowData.tableMetaInfo.rowSpan,\n      style: lodashGet(rowData.tableMetaInfo, 'hide', false)\n        ? { display: 'none' }\n        : null,\n    };\n  }, [rowData.tableMetaInfo]);\n\n  const unlinkHandler = useCallback(\n    (e, isOnRangeLevel) => {\n      // stop propagation here to prevent enabling/disabling the assignment mode at the same time\n      if (e) {\n        e.stopPropagation();\n      }\n\n      if (isOnRangeLevel !== undefined) {\n        if (isOnRangeLevel) {\n          onUnlink(rowData);\n          showUnlinkRangeButton(false);\n          assignmentRange.removeAll('x');\n        } else {\n          onUnlink(\n            rowData,\n            lodashGet(rowData, 'tableMetaInfo.signalIndex', undefined),\n          );\n          showUnlinkSignalButton(false);\n          assignmentSignal.removeAll('x');\n        }\n      } else {\n        showUnlinkRangeButton(false);\n        showUnlinkSignalButton(false);\n      }\n    },\n    [assignmentRange, assignmentSignal, onUnlink, rowData],\n  );\n\n  const linkHandler = useCallback((e, assignment) => {\n    e.stopPropagation();\n    assignment.onClick('x');\n  }, []);\n\n  const onHoverRange = useMemo(() => {\n    return {\n      onMouseEnter: () => {\n        assignmentRange.onMouseEnter('x');\n        highlightRange.show();\n      },\n      onMouseLeave: () => {\n        assignmentRange.onMouseLeave('x');\n        highlightRange.hide();\n      },\n    };\n  }, [assignmentRange, highlightRange]);\n\n  const onHoverSignal = useMemo(() => {\n    return {\n      onMouseEnter: () => {\n        assignmentSignal.onMouseEnter('x');\n        highlightSignal.show();\n      },\n      onMouseLeave: () => {\n        assignmentSignal.onMouseLeave('x');\n        highlightSignal.hide();\n      },\n    };\n  }, [assignmentSignal, highlightSignal]);\n\n  const trCss = useMemo(() => {\n    return highlightRange.isActive || assignmentRange.isActive\n      ? HighlightedRowStyle\n      : lodashGet(rowData, 'tableMetaInfo.isConstantlyHighlighted', false)\n      ? ConstantlyHighlightedRowStyle\n      : null;\n  }, [assignmentRange.isActive, highlightRange.isActive, rowData]);\n\n  return (\n    <tr\n      onContextMenu={(e) => onContextMenu(e, rowData)}\n      css={trCss}\n      {...highlightRange.onHover}\n    >\n      <td {...rowSpanTags} {...onHoverRange}>\n        {rowData.tableMetaInfo.rowIndex + 1}\n      </td>\n\n      {isColumnVisible(preferences, 'showFrom') && (\n        <RangeColumn\n          value={rowData.from}\n          rowSpanTags={rowSpanTags}\n          onHoverRange={onHoverRange}\n          format={getFormat('showFrom')}\n        />\n      )}\n      {isColumnVisible(preferences, 'showTo') && (\n        <RangeColumn\n          value={rowData.to}\n          rowSpanTags={rowSpanTags}\n          onHoverRange={onHoverRange}\n          format={getFormat('toFormat')}\n        />\n      )}\n\n      <SignalDeltaColumn\n        rowData={rowData}\n        onHoverSignal={onHoverSignal}\n        preferences={preferences}\n        onEditStart={(signalId) => onColumnEditStart('signal', `${signalId}`)}\n        editStatus={signalFlags[rowData.tableMetaInfo.signal.id]}\n      />\n\n      {isColumnVisible(preferences, 'showRelative') && (\n        <RelativeColumn\n          rowData={rowData}\n          rowSpanTags={rowSpanTags}\n          onHoverRange={onHoverRange}\n          format={getFormat('relativeFormat')}\n          onEditStart={() => onColumnEditStart('relative', rowData.id)}\n          editStatus={relativeFlags[rowData.id]}\n        />\n      )}\n\n      {isColumnVisible(preferences, 'showAbsolute') && (\n        <AbsoluteColumn\n          value={rowData.absolute}\n          rowSpanTags={rowSpanTags}\n          onHoverRange={onHoverRange}\n          format={getFormat('absoluteFormat')}\n        />\n      )}\n\n      <td {...onHoverSignal}>\n        {lodashGet(rowData, 'tableMetaInfo.signal.multiplicity', '')}\n      </td>\n\n      <CouplingColumn rowData={rowData} onHoverSignal={onHoverSignal} />\n\n      <SignalAssignmentsColumn\n        rowData={rowData}\n        assignment={assignmentSignal}\n        highlight={highlightSignal}\n        onHover={onHoverSignal}\n        unlinkVisibility={unlinkSignalButtonVisibility}\n        onUnlinkVisibilityChange={(flag) => showUnlinkSignalButton(flag)}\n        onLink={linkHandler}\n        onUnlink={unlinkHandler}\n      />\n\n      <RangeAssignmentsColumn\n        rowData={rowData}\n        assignment={assignmentRange}\n        highlight={highlightRange}\n        onHover={onHoverRange}\n        unlinkVisibility={unlinkRangeButtonVisibility}\n        onUnlinkVisibilityChange={(flag) => showUnlinkRangeButton(flag)}\n        onLink={linkHandler}\n        onUnlink={unlinkHandler}\n        rowSpanTags={rowSpanTags}\n        highlightData={highlightData}\n      />\n\n      <ActionsColumn\n        rowData={rowData}\n        onHoverSignal={onHoverSignal}\n        onHoverRange={onHoverRange}\n        rowSpanTags={rowSpanTags}\n      />\n    </tr>\n  );\n}\n\nexport default RangesTableRow;\n","import { useMemo } from 'react';\n\nfunction useMapRanges(data) {\n  return useMemo(() => {\n    const _rangesData = [];\n    data.forEach((range, i) => {\n      if (range.signal.length === 1) {\n        _rangesData.push({\n          ...range,\n          tableMetaInfo: {\n            ...range.tableMetaInfo,\n            signal: range.signal[0],\n            rowIndex: i,\n            signalIndex: 0,\n            id: range.signal[0].id,\n          },\n        });\n      } else if (range.signal.length > 1) {\n        range.signal.forEach((signal, j) => {\n          let hide = false;\n          let rowSpan = null;\n          if (j < range.signal.length - 1) {\n            if (j === 0) {\n              rowSpan = range.signal.length;\n            } else {\n              hide = true;\n            }\n          } else {\n            hide = true;\n          }\n\n          _rangesData.push({\n            ...range,\n            tableMetaInfo: {\n              ...range.tableMetaInfo,\n              signal,\n              rowSpan,\n              hide,\n              rowIndex: i,\n              signalIndex: j,\n              id: signal.id,\n            },\n          });\n        });\n      }\n    });\n\n    return _rangesData;\n  }, [data]);\n}\n\nexport default useMapRanges;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport lodashGet from 'lodash/get';\nimport { Fragment, useCallback, useEffect, useRef } from 'react';\nimport { FaLink } from 'react-icons/fa';\n\nimport checkModifierKeyActivated from '../../../data/utilities/checkModifierKeyActivated';\nimport { useGlobal } from '../../context/GlobalContext';\nimport ContextMenu from '../../elements/ContextMenu';\nimport useToggleStatus from '../extra/utilities/UseToggleStatus';\n\nimport RangesTableRow from './RangesTableRow';\nimport useMapRanges from './useMapRanges';\n\nconst tableStyle = css`\n  border-spacing: 0;\n  border: 1px solid #dedede;\n  width: 100%;\n  font-size: 12px;\n  // height: 100%;\n  .react-contextmenu-wrapper {\n    display: contents;\n  }\n  tr {\n    :last-child {\n      td {\n        border-bottom: 0;\n      }\n    }\n  }\n  th {\n    position: sticky;\n    top: 0;\n    background-color: white;\n    z-index: 1;\n  }\n  th,\n  td {\n    white-space: nowrap;\n    text-align: center;\n    margin: 0;\n    padding: 0.1rem 0.4rem;\n    border-bottom: 1px solid #dedede;\n    border-right: 1px solid #dedede;\n\n    :last-child {\n      border-right: 0;\n    }\n    button {\n      background-color: transparent;\n      border: none;\n    }\n  }\n`;\n\nfunction RangesTable({\n  tableData,\n  onChangeKind,\n  onDelete,\n  onUnlink,\n  onZoom,\n  onEdit,\n  context,\n  activeTab,\n  preferences,\n}) {\n  const element = activeTab && activeTab.replace(/[0-9]/g, '');\n  const contextRef = useRef();\n  const data = useMapRanges(tableData);\n  const [relativeFlags, toggleRelativeColumn] = useToggleStatus('id', data);\n  const [signalFlags, toggleSignalColumn] = useToggleStatus('id', data);\n  const { rootRef } = useGlobal();\n\n  const isVisible = (key) => {\n    return lodashGet(preferences, key, false);\n  };\n\n  const contextMenuHandler = useCallback(\n    (e, rowData) => {\n      if (!checkModifierKeyActivated(e)) {\n        e.preventDefault();\n        contextRef.current.handleContextMenu(e, rowData);\n      }\n    },\n    [contextRef],\n  );\n\n  const columnEditStartHandler = useCallback(\n    (columnKey, id) => {\n      if (columnKey === 'relative') {\n        toggleRelativeColumn(id);\n      } else if (columnKey === 'signal') {\n        toggleSignalColumn(id);\n      }\n    },\n    [toggleRelativeColumn, toggleSignalColumn],\n  );\n\n  useEffect(() => {\n    const handleEditStart = () => {\n      columnEditStartHandler('realtive', null);\n      columnEditStartHandler('signal', null);\n    };\n    if (rootRef) {\n      rootRef.addEventListener('mousedown', handleEditStart);\n    }\n    return () => {\n      if (rootRef) {\n        rootRef.removeEventListener('mousedown', handleEditStart);\n      }\n    };\n  }, [columnEditStartHandler, rootRef]);\n\n  return (\n    <Fragment>\n      <table css={tableStyle}>\n        <thead>\n          <tr>\n            <th>#</th>\n            {isVisible('showFrom') ? <th>From</th> : null}\n            {isVisible('showTo') ? <th>To</th> : null}\n            <th> (ppm)</th>\n            {isVisible('showRelative') ? <th>Rel. {element}</th> : null}\n            {isVisible('showAbsolute') ? <th>Absolute</th> : null}\n            <th>Mult.</th>\n            <th>J (Hz)</th>\n            <th>\n              <FaLink style={{ fontSize: 10 }} />\n            </th>\n            <th></th>\n            <th>Kind</th>\n            <th>{''}</th>\n          </tr>\n        </thead>\n        <tbody>\n          {data &&\n            data.map((range, i) => {\n              return (\n                <RangesTableRow\n                  // eslint-disable-next-line react/no-array-index-key\n                  key={`rangesTableRow${i}`}\n                  rowData={data[i]}\n                  onChangeKind={onChangeKind}\n                  onDelete={onDelete}\n                  onUnlink={onUnlink}\n                  onZoom={onZoom}\n                  onEdit={onEdit}\n                  onContextMenu={(e, rowData) => contextMenuHandler(e, rowData)}\n                  preferences={preferences}\n                  onColumnEditStart={columnEditStartHandler}\n                  editFlags={{ relativeFlags, signalFlags }}\n                />\n              );\n            })}\n        </tbody>\n      </table>\n      <ContextMenu ref={contextRef} context={context} />\n    </Fragment>\n  );\n}\n\nexport default RangesTable;\n","import lodashGet from 'lodash/get';\nimport { xGetFromToIndex } from 'ml-spectra-processing';\nimport { useCallback, useMemo, memo, useState, useRef } from 'react';\nimport ReactCardFlip from 'react-card-flip';\n\nimport { useAssignmentData } from '../../assignment';\nimport { useDispatch } from '../../context/DispatchContext';\nimport { useAlert } from '../../elements/popup/Alert';\nimport RangesWrapper from '../../hoc/RangesWrapper';\nimport { UNLINK_RANGE } from '../../reducer/types/Types';\nimport { copyTextToClipboard } from '../../utility/Export';\nimport NoTableData from '../extra/placeholder/NoTableData';\nimport { rangeDefaultValues } from '../extra/preferences/defaultValues';\nimport PreferencesHeader from '../header/PreferencesHeader';\n\nimport RangesHeader from './RangesHeader';\nimport RangesPreferences from './RangesPreferences';\nimport RangesTable from './RangesTable';\n\nconst styles = {\n  toolbar: {\n    display: 'flex',\n    flexDirection: 'row',\n    borderBottom: '0.55px solid rgb(240, 240, 240)',\n  },\n  container: {\n    flexDirection: 'column',\n    height: '100%',\n    display: 'flex',\n  },\n  sumButton: {\n    borderRadius: '5px',\n    marginTop: '3px',\n    color: 'white',\n    backgroundColor: '#6d6d6d',\n    border: 'none',\n    height: '16px',\n    width: '18px',\n    fontSize: '12px',\n    padding: 0,\n  },\n  removeAssignmentsButton: {\n    borderRadius: '5px',\n    marginTop: '3px',\n    marginLeft: '2px',\n    border: 'none',\n    height: '16px',\n    width: '18px',\n    fontSize: '12px',\n    padding: 0,\n  },\n  setShowMultiplicityTreesButton: {\n    borderRadius: '5px',\n    marginTop: '3px',\n    marginLeft: '5px',\n    color: 'black',\n    backgroundColor: 'transparent',\n    border: 'none',\n    height: '16px',\n    width: '18px',\n    fontSize: '12px',\n    padding: 0,\n  },\n  button: {\n    backgroundColor: 'transparent',\n    border: 'none',\n  },\n};\n\nfunction RangesTablePanel({\n  ranges,\n  x,\n  y,\n  info,\n  xDomain,\n  preferences,\n  activeTab,\n  molecules,\n  nucleus,\n}) {\n  const [isFilterActive, setFilterIsActive] = useState(false);\n  const assignmentData = useAssignmentData();\n\n  const dispatch = useDispatch();\n  const alert = useAlert();\n  const [isFlipped, setFlipStatus] = useState(false);\n  const settingRef = useRef();\n\n  const rangesData = useMemo(() => {\n    const isInView = (from, to) => {\n      const factor = 10000;\n      to = to * factor;\n      from = from * factor;\n      return (\n        (to >= xDomain[0] * factor && from <= xDomain[1] * factor) ||\n        (from <= xDomain[0] * factor && to >= xDomain[1] * factor)\n      );\n    };\n\n    const getFilteredRanges = (ranges) => {\n      return ranges.filter((range) => isInView(range.from, range.to));\n    };\n\n    if (ranges.values) {\n      const _ranges = isFilterActive\n        ? getFilteredRanges(ranges.values)\n        : ranges.values;\n\n      return _ranges.map((range) => {\n        return {\n          ...range,\n          tableMetaInfo: {\n            isConstantlyHighlighted: isInView(range.from, range.to),\n          },\n        };\n      });\n    }\n    return [];\n  }, [isFilterActive, ranges.values, xDomain]);\n\n  const unlinkRangeHandler = useCallback(\n    (rangeData, signalIndex = -1) => {\n      dispatch({\n        type: UNLINK_RANGE,\n        payload: {\n          rangeData,\n          assignmentData,\n          signalIndex,\n        },\n      });\n    },\n    [assignmentData, dispatch],\n  );\n\n  const saveJSONToClipboardHandler = useCallback(\n    (value) => {\n      if (x && y) {\n        const { from, to } = value;\n        const { fromIndex, toIndex } = xGetFromToIndex(x, {\n          from,\n          to,\n        });\n\n        const dataToClipboard = {\n          x: x.slice(fromIndex, toIndex),\n          y: y.slice(fromIndex, toIndex),\n          ...value,\n        };\n\n        const success = copyTextToClipboard(\n          JSON.stringify(dataToClipboard, undefined, 2),\n        );\n\n        if (success) {\n          alert.show('Data copied to clipboard');\n        } else {\n          alert.error('copy to clipboard failed');\n        }\n      }\n    },\n    [x, y, alert],\n  );\n\n  const rangesPreferences = useMemo(() => {\n    const _preferences =\n      lodashGet(preferences, `formatting.panels.ranges.[${activeTab}]`) ||\n      rangeDefaultValues;\n\n    return _preferences;\n  }, [activeTab, preferences]);\n\n  const contextMenu = useMemo(\n    () => [\n      {\n        label: 'Copy to clipboard',\n        onClick: saveJSONToClipboardHandler,\n      },\n    ],\n    [saveJSONToClipboardHandler],\n  );\n\n  const filterHandler = useCallback(() => {\n    setFilterIsActive(!isFilterActive);\n  }, [isFilterActive]);\n\n  const settingsPanelHandler = useCallback(() => {\n    setFlipStatus(!isFlipped);\n  }, [isFlipped]);\n\n  const saveSettingHandler = useCallback(() => {\n    settingRef.current.saveSetting();\n    setFlipStatus(false);\n  }, []);\n\n  return (\n    <>\n      <div style={styles.container}>\n        {!isFlipped && (\n          <RangesHeader\n            ranges={ranges}\n            info={info}\n            activeTab={activeTab}\n            molecules={molecules}\n            onUnlink={unlinkRangeHandler}\n            onFilterActivated={filterHandler}\n            onSettingClick={settingsPanelHandler}\n            isFilterActive={isFilterActive}\n            filterCounter={rangesData.length}\n          />\n        )}\n        {isFlipped && (\n          <PreferencesHeader\n            onSave={saveSettingHandler}\n            onClose={settingsPanelHandler}\n          />\n        )}\n        <div style={{ height: '100%', overflow: 'hidden' }}>\n          <ReactCardFlip\n            isFlipped={isFlipped}\n            infinite\n            containerStyle={{ overflow: 'hidden', height: '100%' }}\n          >\n            <div style={{ overflow: 'auto', height: '100%', display: 'block' }}>\n              {rangesData && rangesData.length > 0 ? (\n                <RangesTable\n                  activeTab={activeTab}\n                  tableData={rangesData}\n                  onUnlink={unlinkRangeHandler}\n                  context={contextMenu}\n                  preferences={rangesPreferences}\n                />\n              ) : (\n                <NoTableData />\n              )}\n            </div>\n            <RangesPreferences\n              ranges={ranges}\n              ref={settingRef}\n              nucleus={nucleus}\n              preferences={preferences}\n            />\n          </ReactCardFlip>\n        </div>\n      </div>\n    </>\n  );\n}\n\nexport default RangesWrapper(memo(RangesTablePanel));\n","import { forwardRef } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\n\nfunction SpectraWraper(WrappedComponent) {\n  const Wrapper = (props) => {\n    const { data, activeSpectrum, activeTab, displayerMode } = useChartData();\n\n    const { forwardedRef, ...rest } = props;\n    return (\n      <WrappedComponent\n        {...rest}\n        data={data}\n        activeSpectrum={activeSpectrum}\n        activeTab={activeTab}\n        displayerMode={displayerMode}\n        ref={forwardedRef}\n      />\n    );\n  };\n\n  return forwardRef((props, ref) => {\n    return <Wrapper {...props} forwardedRef={ref} />;\n  });\n}\nexport default SpectraWraper;\n","import { SvgNmrSameTop, SvgNmrResetScale } from 'cheminfo-font';\nimport { memo, useCallback } from 'react';\nimport {\n  FaCreativeCommonsSamplingPlus,\n  FaEye,\n  FaEyeSlash,\n} from 'react-icons/fa';\n\nimport { useDispatch } from '../../context/DispatchContext';\nimport Button from '../../elements/ButtonToolTip';\nimport { useAlert } from '../../elements/popup/Alert';\nimport { useModal } from '../../elements/popup/Modal';\nimport SpectraWraper from '../../hoc/SpectraWraper';\nimport { DISPLAYER_MODE } from '../../reducer/core/Constants';\nimport {\n  ADD_MISSING_PROJECTION,\n  CHANGE_VISIBILITY,\n  DELETE_SPECTRA,\n  RESET_SPECTRA_SCALE,\n  SET_SPECTRA_SAME_TOP,\n} from '../../reducer/types/Types';\nimport DefaultPanelHeader from '../header/DefaultPanelHeader';\n\nfunction SpectraPanelHeader({\n  data,\n  activeSpectrum,\n  activeTab,\n  displayerMode,\n  spectrums,\n}) {\n  const modal = useModal();\n  const alert = useAlert();\n  const dispatch = useDispatch();\n\n  const handleDelete = useCallback(() => {\n    modal.showConfirmDialog({\n      message: 'All records will be deleted, Are You sure?',\n      buttons: [\n        {\n          text: 'Yes',\n          handler: () => {\n            dispatch({ type: DELETE_SPECTRA });\n          },\n        },\n        { text: 'No' },\n      ],\n    });\n  }, [dispatch, modal]);\n\n  const showAllSpectrumsHandler = useCallback(() => {\n    const spectrumsPerTab = spectrums.map((datum) => {\n      return datum.id;\n    });\n    dispatch({ type: CHANGE_VISIBILITY, id: spectrumsPerTab });\n  }, [dispatch, spectrums]);\n\n  const hideAllSpectrumsHandler = useCallback(() => {\n    dispatch({ type: CHANGE_VISIBILITY, id: [] });\n  }, [dispatch]);\n\n  const addMissingProjectionHandler = useCallback(() => {\n    function getMissingProjection(SpectrumsData) {\n      let nucleus = activeTab.split(',');\n      nucleus = nucleus[0] === nucleus[1] ? [nucleus[0]] : nucleus;\n      const missingNucleus = [];\n      for (const n of nucleus) {\n        const hasSpectrums = SpectrumsData.some((d) => d.info.nucleus === n);\n        if (!hasSpectrums) {\n          missingNucleus.push(n);\n        }\n      }\n      return missingNucleus;\n    }\n    const missingNucleus = getMissingProjection(data);\n    if (missingNucleus.length > 0) {\n      dispatch({ type: ADD_MISSING_PROJECTION, nucleus: missingNucleus });\n    } else {\n      alert.error('Nothing to calculate');\n    }\n  }, [activeTab, alert, data, dispatch]);\n\n  const setSameTopHandler = useCallback(() => {\n    dispatch({ type: SET_SPECTRA_SAME_TOP });\n  }, [dispatch]);\n  const resetScaleHandler = useCallback(() => {\n    dispatch({ type: RESET_SPECTRA_SCALE });\n  }, [dispatch]);\n\n  return (\n    <DefaultPanelHeader\n      onDelete={handleDelete}\n      counter={spectrums && spectrums.length}\n      deleteToolTip=\"Delete all spectra\"\n    >\n      <Button popupTitle=\"Hide all spectra\" onClick={hideAllSpectrumsHandler}>\n        <FaEyeSlash />\n      </Button>\n      <Button popupTitle=\"Show all spectra\" onClick={showAllSpectrumsHandler}>\n        <FaEye />\n      </Button>\n      {activeSpectrum && activeTab && activeTab.split(',').length > 1 && (\n        <Button\n          popupTitle=\"Add missing projection\"\n          onClick={addMissingProjectionHandler}\n        >\n          <FaCreativeCommonsSamplingPlus />\n        </Button>\n      )}\n      {displayerMode === DISPLAYER_MODE.DM_1D && (\n        <>\n          <Button popupTitle=\"Reset Scale\" onClick={resetScaleHandler}>\n            <SvgNmrResetScale />\n          </Button>\n          <Button popupTitle=\"Same Top\" onClick={setSameTopHandler}>\n            <SvgNmrSameTop />\n          </Button>\n        </>\n      )}\n    </DefaultPanelHeader>\n  );\n}\n\nexport default SpectraWraper(memo(SpectraPanelHeader));\n","function getNucleusSum(input) {\n  const nucleus = input.split(',');\n  return nucleus.reduce((acc, i) => {\n    const additions = nucleus.length === 2 ? 100 : 0;\n    acc += Number(i.replace(/\\D/g, '')) + additions;\n    return acc;\n  }, 0);\n}\nconst GroupByInfoKey = (key) => (array, orderByNucleus = false) => {\n  const unorderedGroup = array.reduce((objectsByKeyValue, obj) => {\n    const value = obj.info[key];\n    objectsByKeyValue[value] = (objectsByKeyValue[value] || []).concat(obj);\n    return objectsByKeyValue;\n  }, {});\n\n  if (!orderByNucleus) {\n    return unorderedGroup;\n  } else {\n    return Object.keys(unorderedGroup)\n      .sort((a, b) => getNucleusSum(a) - getNucleusSum(b))\n      .reduce((acc, key) => {\n        acc[key] = unorderedGroup[key];\n        return acc;\n      }, {});\n  }\n};\n\nexport default GroupByInfoKey;\n","import { memo } from 'react';\n\nfunction ColorIndicator1D({ color, activated }) {\n  return (\n    <div\n      style={{\n        backgroundColor: color,\n        height: '12px',\n        width: '12px',\n        opacity: activated ? 1 : 0.1,\n        display: 'inline-block',\n      }}\n    />\n  );\n}\nfunction ColorIndicator2D({ positiveColor, negativeColor, activated }) {\n  return (\n    <svg\n      width=\"12\"\n      height=\"12\"\n      viewBox=\"0 0 12 12\"\n      opacity={activated ? 1 : 0.1}\n    >\n      <g>\n        <path d=\"M0,0H12L0,12Z\" fill={positiveColor} strokeWidth=\"0\" />\n        <path d=\"M12,12H0L12,0Z\" fill={negativeColor} strokeWidth=\"0\" />\n      </g>\n    </svg>\n  );\n}\n\nfunction ColorIndicator({ dimension, color, activated, onClick, style }) {\n  return (\n    <button style={style} type=\"button\" onClick={onClick}>\n      {dimension === 2 ? (\n        <ColorIndicator2D {...color} activated={activated} />\n      ) : (\n        <ColorIndicator1D activated={activated} {...color} />\n      )}\n    </button>\n  );\n}\n\nexport default memo(ColorIndicator);\n","import { SvgNmrPeaks } from 'cheminfo-font';\nimport React from 'react';\n\nfunction ShowHideMarkersButton({\n  data,\n  onChangeMarkersVisibility,\n  markersVisible,\n  style,\n}) {\n  const isMarkerVisible = (id) => {\n    return markersVisible.findIndex((v) => v.id === id) !== -1 ? true : false;\n  };\n\n  return (\n    <button\n      style={{\n        ...style,\n        opacity:\n          isMarkerVisible(data.id) && data.peaks && data.peaks.values.length > 0\n            ? 1\n            : 0.1,\n      }}\n      type=\"button\"\n      onClick={() => onChangeMarkersVisibility(data)}\n      disabled={data.peaks && data.peaks.values.length === 0}\n    >\n      <SvgNmrPeaks />\n    </button>\n  );\n}\n\nexport default ShowHideMarkersButton;\n","import React from 'react';\nimport { FaEye } from 'react-icons/fa';\n\nfunction ShowHideSpectrumButton({ data, onChangeVisibility, style }) {\n  const isVisible = (id, key) => {\n    return data ? data.display[key] : true;\n  };\n  return (\n    <>\n      {data.info.dimension === 1 && (\n        <button\n          style={style}\n          type=\"button\"\n          onClick={() => onChangeVisibility(data, 'isVisible')}\n        >\n          <FaEye\n            style={{\n              fill: data.display.color,\n\n              ...(isVisible(data.id, 'isVisible')\n                ? {\n                    opacity: 1,\n                    strokeWidth: '1px',\n                    fill: data.display.color,\n                  }\n                : {\n                    opacity: 0.1,\n                    fill: data.display.color,\n                  }),\n            }}\n          />\n        </button>\n      )}\n      {data.info.dimension === 2 && (\n        <div style={{ minWidth: '40px' }}>\n          <button\n            style={{ ...style, width: '20px', minWidth: '20px' }}\n            type=\"button\"\n            onClick={() => onChangeVisibility(data, 'isPositiveVisible')}\n          >\n            <FaEye\n              style={{\n                fill: data.display.positiveColor,\n                ...(isVisible(data.id, 'isPositiveVisible')\n                  ? {\n                      opacity: 1,\n                      strokeWidth: '1px',\n                      fill: data.display.positiveColor,\n                    }\n                  : {\n                      opacity: 0.1,\n                      fill: data.display.positiveColor,\n                    }),\n              }}\n            />\n          </button>\n          <button\n            style={{ ...style, width: '20px', minWidth: '20px' }}\n            type=\"button\"\n            onClick={() => onChangeVisibility(data, 'isNegativeVisible')}\n          >\n            <FaEye\n              style={{\n                fill: data.display.negativeColor,\n                ...(isVisible(data.id, 'isNegativeVisible')\n                  ? {\n                      opacity: 1,\n                      strokeWidth: '1px',\n                      fill: data.display.negativeColor,\n                    }\n                  : {\n                      opacity: 0.1,\n                      fill: data.display.negativeColor,\n                    }),\n              }}\n            />\n          </button>\n        </div>\n      )}\n    </>\n  );\n}\n\nexport default ShowHideSpectrumButton;\n","import { SvgNmrFid, SvgNmrFt, SvgNmr2D } from 'cheminfo-font';\nimport { memo } from 'react';\n\nimport ColorIndicator from './base/ColorIndicator';\nimport ShowHideMarkersButton from './base/ShowHideMarkersButton';\nimport ShowHideSpectrumButton from './base/ShowHideSpectrumButton';\n\nconst styles = {\n  button: {\n    backgroundColor: 'transparent',\n    border: 'none',\n    width: '26px',\n    minWidth: '26px',\n  },\n  row: {\n    display: 'flex',\n    alignContent: 'center',\n    height: '25px',\n    borderBottom: '0.55px solid #f1f1f1',\n  },\n  name: {\n    flex: 1,\n    height: '100%',\n    display: 'flex',\n  },\n  info: {\n    flex: '1 1 1px',\n    height: '100%',\n    display: 'block',\n    alignItems: 'center',\n    overflow: 'hidden',\n    textOverflow: 'ellipsis',\n    whiteSpace: 'nowrap',\n    lineHeight: '24px',\n  },\n  icon: {\n    display: 'flex',\n    margin: 'auto',\n    justifyContent: 'center',\n  },\n};\n\nfunction SpectrumListItem({\n  activeSpectrum,\n  markersVisible,\n  data,\n  onChangeVisibility,\n  onChangeMarkersVisibility,\n  onChangeActiveSpectrum,\n  onOpenSettingModal,\n  onContextMenu,\n}) {\n  const formatValueAsHTML = (value) => {\n    if (value) {\n      // eslint-disable-next-line prefer-named-capture-group\n      value = value.replace(/([0-9]+)/g, '<sub>$1</sub>');\n    }\n    return value;\n  };\n  const activated = activeSpectrum && activeSpectrum.id === data.id;\n  const { color, name, positiveColor, negativeColor } = data.display;\n  return (\n    <div\n      style={{\n        ...styles.row,\n        ...(activated\n          ? { backgroundColor: '#fafafa' }\n          : { opacity: activeSpectrum ? 0.2 : 1 }),\n      }}\n      onContextMenu={onContextMenu}\n    >\n      <ShowHideSpectrumButton\n        data={data}\n        onChangeVisibility={onChangeVisibility}\n        style={styles.button}\n      />\n\n      <div style={styles.name} onClick={() => onChangeActiveSpectrum(data)}>\n        <div style={{ ...styles.icon, width: '16px' }}>\n          {data.info.isFid ? (\n            <SvgNmrFid />\n          ) : data.info.dimension === 2 ? (\n            <SvgNmr2D />\n          ) : (\n            <SvgNmrFt />\n          )}\n        </div>\n        <span style={styles.info}>{name}</span>\n        <div\n          style={styles.info}\n          // eslint-disable-next-line react/no-danger\n          dangerouslySetInnerHTML={{\n            __html: data.info && formatValueAsHTML(data.info.solvent),\n          }}\n        />\n        <span style={styles.info}>\n          <span\n            style={{\n              borderLeft: '0.55px solid #e5e5e5',\n              paddingRight: '5px',\n            }}\n          />\n          {data.info && data.info.experiment}\n        </span>\n\n        {/* {data.info && data.info.solvent} */}\n        {/* </div> */}\n        <span style={styles.info}>{data.info && data.info.pulse}</span>\n      </div>\n\n      <ShowHideMarkersButton\n        data={data}\n        style={{\n          ...styles.icon,\n          ...styles.button,\n        }}\n        onChangeMarkersVisibility={onChangeMarkersVisibility}\n        markersVisible={markersVisible}\n      />\n      <ColorIndicator\n        style={styles.button}\n        dimension={data.info.dimension}\n        color={{ positiveColor, color, negativeColor }}\n        activated={activated}\n        onClick={(event) => onOpenSettingModal(data, event)}\n      />\n    </div>\n  );\n}\n\nSpectrumListItem.defaultProps = {\n  onContextMenu: () => null,\n};\n\nexport default memo(SpectrumListItem);\n","import { useFormikContext } from 'formik';\nimport lodashGet from 'lodash/get';\nimport { useCallback, memo } from 'react';\nimport { SketchPicker } from 'react-color';\n\nimport { COLORS } from '../../../data/utilities/getColor';\n\nfunction FormikColorPicker({ onColorChange, name, ...props }) {\n  const { values, setFieldValue } = useFormikContext();\n\n  const colorchangeHandler = useCallback(\n    (color) => {\n      onColorChange(color);\n      setFieldValue(\n        name,\n        `${color.hex}${Math.round(color.rgb.a * 255).toString(16)}`,\n      );\n    },\n    [name, onColorChange, setFieldValue],\n  );\n\n  return (\n    <SketchPicker\n      color={{ hex: lodashGet(values, name, '#000') }}\n      presetColors={COLORS}\n      onChangeComplete={(e) => colorchangeHandler(e)}\n      {...props}\n    />\n  );\n}\n\nFormikColorPicker.defaultProps = {\n  onColorChange: () => null,\n};\n\nexport default memo(FormikColorPicker);\n","import { xHistogram, xAbsolute, xMinMaxValues } from 'ml-spectra-processing';\nimport { memo, useMemo } from 'react';\nimport { Axis, BarSeries, Heading, Plot } from 'react-plot';\n\nconst Spectrum2DHistogram = memo(({ color = 'red', data }) => {\n  const histogramData = useMemo(() => {\n    const array = prepareData(data.re);\n    const result = xHistogram(array, {\n      logBaseX: 10,\n      logBaseY: 2,\n      nbSlots: 100,\n    });\n    return result.x.reduce((acc, value, index) => {\n      acc.push({ x: value, y: result.y[index] });\n      return acc;\n    }, []);\n  }, [data.re]);\n\n  return (\n    <div\n      style={{\n        borderTop: '1px solid #ededed',\n        marginTop: '10px',\n        paddingTop: '10px',\n      }}\n    >\n      <Plot\n        width={220}\n        height={200}\n        margin={{ bottom: 50, left: 10, top: 30, right: 10 }}\n        // seriesViewportStyle={{ stroke: 'gray' }}\n      >\n        <Heading title=\"Histogram\" />\n        <BarSeries\n          data={histogramData}\n          xAxis=\"x\"\n          yAxis=\"y\"\n          lineStyle={{\n            stroke: color,\n          }}\n          markerStyle={{\n            fill: color,\n            stroke: color,\n          }}\n        />\n        <Axis\n          id=\"x\"\n          position=\"bottom\"\n          displayGridLines\n          tickStyle={{ fontSize: '0.7rem' }}\n        />\n        <Axis id=\"y\" position=\"left\" displayGridLines hidden />\n      </Plot>\n    </div>\n  );\n});\n\nexport default Spectrum2DHistogram;\n\nfunction prepareData(array) {\n  array = xAbsolute(array);\n  // we will shift of the minValue that is not 0\n  let { min, max } = xMinMaxValues(array);\n  if (min < 1) {\n    if (max > 1e6) min = 1;\n  }\n  for (let i = 0; i < array.length; i++) {\n    array[i] += min;\n  }\n  return array;\n}\n","import { useCallback, useRef } from 'react';\n\nimport FormikColorPicker from '../../../../elements/formik/FormikColorPicker';\nimport FormikForm from '../../../../elements/formik/FormikForm';\n\nimport Spectrum1DHistogram from './Spectrum1DHistogram';\n\nfunction Spectrum1DSetting({ data: SpectrumData, onSubmit }) {\n  const refForm = useRef();\n\n  const triggerSubmitHandler = useCallback(() => {\n    if (refForm.current) {\n      refForm.current.submitForm();\n    }\n  }, []);\n\n  return (\n    <FormikForm\n      ref={refForm}\n      initialValues={SpectrumData.display}\n      onSubmit={onSubmit}\n    >\n      <div>\n        <FormikColorPicker name=\"color\" onColorChange={triggerSubmitHandler} />\n        <Spectrum1DHistogram color=\"red\" data={SpectrumData.data} />\n      </div>\n    </FormikForm>\n  );\n}\n\nexport default Spectrum1DSetting;\n","import { useFormikContext } from 'formik';\nimport lodashGet from 'lodash/get';\nimport { useCallback, memo } from 'react';\nimport ReactSlider from 'react-slider';\n\nfunction FormikSlider({ onAfterChange, name, ...props }) {\n  const { values, setFieldValue } = useFormikContext();\n\n  const changeHandler = useCallback(\n    (value) => {\n      onAfterChange(value);\n      setFieldValue(name, value);\n    },\n    [name, onAfterChange, setFieldValue],\n  );\n\n  return (\n    <ReactSlider\n      className=\"horizontal-slider\"\n      thumbClassName=\"thumb\"\n      trackClassName=\"track\"\n      defaultValue={lodashGet(values, name, [0, 100])}\n      onAfterChange={changeHandler}\n      // ariaLabel={['Lower thumb', 'Upper thumb']}\n      // ariaValuetext={(state) => ` ${state.valueNow}`}\n      renderThumb={(props, state) => (\n        <div {...props}>\n          <span>{state.valueNow}</span>\n        </div>\n      )}\n      pearling\n      minDistance={10}\n      {...props}\n    />\n  );\n}\n\nFormikSlider.defaultProps = {\n  onColorChange: () => null,\n};\n\nexport default memo(FormikSlider);\n","import {\n  matrixHistogram,\n  xAbsolute,\n  matrixMinMaxZ,\n} from 'ml-spectra-processing';\nimport { memo, useMemo } from 'react';\nimport { Axis, BarSeries, Heading, Plot } from 'react-plot';\n\nconst Spectrum1DHistogram = memo(({ color = 'red', data }) => {\n  const histogramData = useMemo(() => {\n    let matrix = prepareData(data.z);\n\n    const result = matrixHistogram(matrix, {\n      logBaseX: 10,\n      logBaseY: 2,\n      nbSlots: 256,\n    });\n    return result.x.reduce((acc, value, index) => {\n      acc.push({ x: value, y: result.y[index] });\n      return acc;\n    }, []);\n  }, [data.z]);\n\n  return (\n    <div\n      style={{\n        borderTop: '1px solid #ededed',\n        marginTop: '10px',\n        paddingTop: '10px',\n      }}\n    >\n      <Plot\n        width={450}\n        height={200}\n        margin={{ bottom: 50, left: 10, top: 30, right: 10 }}\n        // seriesViewportStyle={{ stroke: 'gray' }}\n      >\n        <Heading title=\"Histogram\" />\n        <BarSeries\n          data={histogramData}\n          xAxis=\"x\"\n          yAxis=\"y\"\n          lineStyle={{\n            stroke: color,\n          }}\n          markerStyle={{\n            fill: color,\n            stroke: color,\n          }}\n        />\n        <Axis\n          id=\"x\"\n          position=\"bottom\"\n          displayGridLines\n          tickStyle={{ fontSize: '0.7rem' }}\n        />\n        <Axis id=\"y\" position=\"left\" displayGridLines hidden />\n      </Plot>\n    </div>\n  );\n});\n\nexport default Spectrum1DHistogram;\n\nfunction prepareData(existingMatrix) {\n  const matrix = [];\n  for (let row of existingMatrix) {\n    matrix.push(xAbsolute(row));\n  }\n  // we will shift the minValue that is not 0\n  let { min, max } = matrixMinMaxZ(matrix);\n  if (min < 1) {\n    if (max > 1e6) min = 1;\n  }\n\n  for (let row of matrix) {\n    for (let i = 0; i < row.length; i++) {\n      row[i] += min;\n    }\n  }\n\n  return matrix;\n}\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback, useRef } from 'react';\n\nimport FormikColorPicker from '../../../../elements/formik/FormikColorPicker';\nimport FormikForm from '../../../../elements/formik/FormikForm';\nimport FormikInput from '../../../../elements/formik/FormikInput';\nimport FormikSlider from '../../../../elements/formik/FormikSlider';\n\nimport Spectrum2DHistogram from './Spectrum2DHistogram';\n\nfunction Spectrum2DSetting({ data: SpectrumData, onSubmit }) {\n  const refForm = useRef();\n\n  const style = css`\n    .positive {\n      display: inline-block;\n      .track-1 {\n        background-color: ${SpectrumData.display.positiveColor} !important;\n      }\n    }\n    .negative {\n      display: inline-block;\n\n      .track-1 {\n        background-color: ${SpectrumData.display.negativeColor} !important;\n      }\n    }\n  `;\n\n  const triggerSubmitHandler = useCallback(() => {\n    refForm.current.submitForm();\n  }, []);\n\n  return (\n    <FormikForm\n      ref={refForm}\n      initialValues={SpectrumData.display}\n      onSubmit={onSubmit}\n    >\n      <div css={style}>\n        <div className=\"positive\">\n          <span style={{ padding: '0 10px' }}>Positive</span>\n          <FormikColorPicker\n            name=\"positiveColor\"\n            onColorChange={triggerSubmitHandler}\n          />\n          <div style={{ padding: '5px' }}>\n            <span className=\"label\">contour Levels [ min - max ]</span>\n            <FormikSlider\n              name=\"contourOptions.positive.contourLevels\"\n              onAfterChange={triggerSubmitHandler}\n            />\n            <span className=\"label\">number of Layers </span>\n            <FormikInput\n              name=\"contourOptions.positive.numberOfLayers\"\n              onChange={triggerSubmitHandler}\n              type=\"number\"\n            />\n          </div>\n        </div>\n        <div className=\"negative\">\n          <span style={{ padding: '0 10px' }}>Negative</span>\n          <FormikColorPicker\n            name=\"negativeColor\"\n            onColorChange={triggerSubmitHandler}\n          />\n          <div style={{ padding: '5px' }}>\n            <span className=\"label\">contour Levels [ min - max ]</span>\n            <FormikSlider\n              name=\"contourOptions.negative.contourLevels\"\n              onAfterChange={triggerSubmitHandler}\n            />\n            <span className=\"label\">number of Layers </span>\n            <FormikInput\n              name=\"contourOptions.negative.numberOfLayers\"\n              onChange={triggerSubmitHandler}\n              type=\"number\"\n            />\n          </div>\n        </div>\n        <Spectrum2DHistogram data={SpectrumData.data} />\n      </div>\n    </FormikForm>\n  );\n}\n\nexport default Spectrum2DSetting;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { memo, useCallback } from 'react';\n\nimport { useDispatch } from '../../../../context/DispatchContext';\nimport { CHANGE_SPECTRUM_SETTING } from '../../../../reducer/types/Types';\n\nimport Spectrum1DSetting from './Spectrum1DSetting';\nimport Spectrum2DSetting from './Spectrum2DSetting';\n\nconst style = css`\n  position: fixed;\n  z-index: 999999999;\n  width:100%;\n  height:100%;\n  left:0;\n  top:0;\n  .ineer-conatiner{\n    position:absolute;\n    display: flex;\n    flex-direction: row-reverse;\n    border-radius: 4px;\n    background-color: white;\n    box-shadow: rgba(0, 0, 0, 0.15) 0px 0px 0px 1px,\n      rgba(0, 0, 0, 0.15) 0px 8px 16px;\n      overflow: auto;\n      height: 350px;\n  }\n\n\n  .sketch-picker {\n    border-radius: none !important;\n    box-shadow: none !important;\n  }\n\n\n  .horizontal-slider {\n    width: 80%;\n    height: 15px;\n  }\n\n  .thumb {\n    height: 15px;\n    line-height: 15px;\n    width: 20px;\n    text-align: center;\n    color: black;\n    border-radius: 5px;\n    cursor: grab;\n    font-size: 10px;\n    background-image: -webkit-linear-gradient(top, #f4f1ee, #fff);\n    background-image: linear-gradient(top, #f4f1ee, #fff);\n  }\n\n  .track {\n    top: 0;\n    bottom: 0;\n    background: #eaeaea;\n    border-radius: 999px;\n    border-radius: 5px;\n  }\n\n  .track-1 {\n    background: red;\n  }\n   \n  .label{\n    font-size: 12px;\n    margin: 8px 0;\n    display: block;\n  }\n \n  }\n`;\nfunction SpectrumSetting({ position, data, onClose }) {\n  const dispatch = useDispatch();\n  const { id, info } = data;\n  const submitHandler = useCallback(\n    (values) => {\n      dispatch({ type: CHANGE_SPECTRUM_SETTING, id, display: values });\n    },\n    [dispatch, id],\n  );\n\n  const clickHandler = useCallback(\n    (e) => {\n      if (e.target === e.currentTarget) {\n        onClose();\n      }\n    },\n    [onClose],\n  );\n\n  const { x, y } = position;\n  return (\n    <div css={style} onClick={clickHandler}>\n      <div\n        className=\"ineer-conatiner\"\n        style={{\n          left: info.dimension === 2 ? x - 450 : x - 220,\n          padding: info.dimension === 2 ? '10px 0' : '',\n          top: y,\n        }}\n      >\n        {info.dimension === 2 ? (\n          <Spectrum2DSetting onSubmit={submitHandler} data={data} />\n        ) : (\n          <Spectrum1DSetting onSubmit={submitHandler} data={data} />\n        )}\n      </div>\n    </div>\n  );\n}\n\nfunction arePropsEqual() {\n  return true;\n}\n\nexport default memo(SpectrumSetting, arePropsEqual);\n","import {\n  useCallback,\n  useState,\n  useMemo,\n  useRef,\n  Fragment,\n  useEffect,\n} from 'react';\n\nimport checkModifierKeyActivated from '../../../data/utilities/checkModifierKeyActivated';\nimport { useDispatch } from '../../context/DispatchContext';\nimport ContextMenu from '../../elements/ContextMenu';\nimport { Tabs } from '../../elements/Tab';\nimport { useAlert } from '../../elements/popup/Alert';\nimport SpectraWraper from '../../hoc/SpectraWraper';\nimport {\n  CHANGE_PEAKS_MARKERS_VISIBILITY,\n  SET_ACTIVE_TAB,\n  CHANGE_VISIBILITY,\n  CHANGE_ACTIVE_SPECTRUM,\n  DELETE_SPECTRA,\n} from '../../reducer/types/Types';\nimport { copyTextToClipboard } from '../../utility/Export';\nimport GroupByInfoKey from '../../utility/GroupByInfoKey';\n\nimport SpectrumListItem from './SpectrumListItem';\nimport SpectrumSetting from './base/setting/SpectrumSetting';\n\nfunction SpectrumsTabs({ data, activeSpectrum, activeTab, onTabChange }) {\n  const contextRef = useRef();\n  const [markersVisible, setMarkersVisible] = useState([]);\n  const [selectedSpectrumData, setSelectedSpectrum] = useState(null);\n  const [settingModalPosition, setSettingModalPosition] = useState(null);\n  const [isSettingModalDisplayed, setIsSettingModalDisplayed] = useState(false);\n\n  const alert = useAlert();\n  const dispatch = useDispatch();\n\n  useEffect(() => {\n    if (data) {\n      const visibleMarkers = data\n        ? data.filter((d) => d.display.isPeaksMarkersVisible === true)\n        : [];\n\n      setMarkersVisible(visibleMarkers);\n    }\n  }, [data, dispatch]);\n\n  const spectrumsGroupByNucleus = useMemo(() => {\n    if (!data) return [];\n    const groupByNucleus = GroupByInfoKey('nucleus');\n    return groupByNucleus(data, true);\n  }, [data]);\n\n  useEffect(() => {\n    onTabChange({\n      tab: activeTab,\n      data: spectrumsGroupByNucleus[activeTab],\n    });\n  }, [activeTab, onTabChange, spectrumsGroupByNucleus]);\n\n  const handleChangeMarkersVisibility = useCallback(\n    (d) => {\n      const currentIndex = markersVisible.findIndex((v) => v.id === d.id);\n      const newChecked = [...markersVisible];\n      if (currentIndex === -1) {\n        newChecked.push({ id: d.id });\n      } else {\n        newChecked.splice(currentIndex, 1);\n      }\n      dispatch({ type: CHANGE_PEAKS_MARKERS_VISIBILITY, data: newChecked });\n      setMarkersVisible(newChecked);\n    },\n    [dispatch, markersVisible],\n  );\n\n  const onTabChangeHandler = useCallback(\n    (tab) => {\n      onTabChange({\n        tab: tab.tabid,\n        data: spectrumsGroupByNucleus[tab.tabid],\n      });\n\n      dispatch({ type: SET_ACTIVE_TAB, tab: tab.tabid });\n    },\n    [dispatch, onTabChange, spectrumsGroupByNucleus],\n  );\n\n  const contextMenu = useMemo(\n    () => [\n      {\n        label: 'Copy to Clipboard',\n        onClick: (spectrumData) => {\n          const { x, y, info } = spectrumData;\n          const success = copyTextToClipboard(\n            JSON.stringify({ x, y, info }, undefined, 2),\n          );\n\n          if (success) {\n            alert.success('Data copied to clipboard');\n          } else {\n            alert.error('Copy to clipboard failed');\n          }\n        },\n      },\n      {\n        label: 'Delete',\n        onClick: (spectrumData) => {\n          setTimeout(() => {\n            dispatch({ type: DELETE_SPECTRA, id: spectrumData.id });\n          }, 0);\n        },\n      },\n    ],\n    [alert, dispatch],\n  );\n\n  const contextMenuHandler = useCallback(\n    (e, rowData) => {\n      if (!checkModifierKeyActivated(e)) {\n        e.preventDefault();\n        contextRef.current.handleContextMenu(e, rowData);\n      }\n    },\n    [contextRef],\n  );\n\n  const openSettingHandler = useCallback((selectedSpectrum, event) => {\n    setSettingModalPosition({\n      x: event.nativeEvent.clientX,\n      y: event.nativeEvent.clientY,\n    });\n    setSelectedSpectrum(selectedSpectrum);\n    setIsSettingModalDisplayed(true);\n  }, []);\n\n  const handleChangeVisibility = useCallback(\n    (d, key) => {\n      dispatch({\n        type: CHANGE_VISIBILITY,\n        id: d.id,\n        key,\n        value: !d.display[key],\n      });\n    },\n    [dispatch],\n  );\n\n  const handleChangeActiveSpectrum = useCallback(\n    (d) => {\n      setTimeout(() => {\n        if (activeSpectrum && activeSpectrum.id === d.id) {\n          dispatch({ type: CHANGE_ACTIVE_SPECTRUM, data: null });\n        } else {\n          dispatch({ type: CHANGE_ACTIVE_SPECTRUM, data: { id: d.id } });\n        }\n      }, 0);\n    },\n    [activeSpectrum, dispatch],\n  );\n\n  const mouseLeaveHandler = useCallback(() => {\n    setIsSettingModalDisplayed(false);\n  }, []);\n\n  return (\n    <Fragment>\n      <Tabs defaultTabID={activeTab} onClick={onTabChangeHandler}>\n        {spectrumsGroupByNucleus &&\n          Object.keys(spectrumsGroupByNucleus).map((group) => (\n            <div\n              tablabel={group}\n              tabid={group}\n              key={group}\n              style={{ overflow: 'auto', height: '100%' }}\n            >\n              {spectrumsGroupByNucleus[group] &&\n                spectrumsGroupByNucleus[group].map((d) => (\n                  <SpectrumListItem\n                    key={d.id}\n                    activeSpectrum={activeSpectrum}\n                    // activated={\n                    //   activeSpectrum && activeSpectrum.id === d.id\n                    //     ? true\n                    //     : false\n                    // }\n                    markersVisible={markersVisible}\n                    data={d}\n                    onChangeVisibility={handleChangeVisibility}\n                    onChangeMarkersVisibility={handleChangeMarkersVisibility}\n                    onChangeActiveSpectrum={handleChangeActiveSpectrum}\n                    onOpenSettingModal={openSettingHandler}\n                    onContextMenu={(e) => contextMenuHandler(e, d)}\n                  />\n                ))}\n            </div>\n          ))}\n      </Tabs>\n      <ContextMenu ref={contextRef} context={contextMenu} />\n\n      {isSettingModalDisplayed ? (\n        <SpectrumSetting\n          onClose={mouseLeaveHandler}\n          data={selectedSpectrumData}\n          position={settingModalPosition}\n        />\n      ) : null}\n    </Fragment>\n  );\n}\n\nexport default SpectraWraper(SpectrumsTabs);\n","import React, { useCallback, memo, useState } from 'react';\n\nimport SpectraPanelHeader from './SpectraPanelHeader';\nimport SpectrumsTabs from './SpectrumsTabs';\n\nconst styles = {\n  overflow: 'hidden',\n  height: '100%',\n  display: 'flex',\n  flexDirection: 'column',\n};\n\nfunction SpectrumListPanel({\n  data,\n  activeSpectrum,\n  activeTab: activeTabState,\n}) {\n  const [spectrums, setSpectrums] = useState([]);\n\n  const tabChangeHandler = useCallback((e) => {\n    setSpectrums(e.data ? e.data : []);\n  }, []);\n\n  return (\n    <div style={styles}>\n      <SpectraPanelHeader spectrums={spectrums} />\n      <SpectrumsTabs\n        onTabChange={tabChangeHandler}\n        data={data}\n        activeSpectrum={activeSpectrum}\n        activeTab={activeTabState}\n      />\n    </div>\n  );\n}\n\nexport default memo(SpectrumListPanel);\n","// error colors in priority order\nconst ErrorColors = [\n  { key: 'outOfLimit', color: 'red' },\n  { key: 'ambiguousAttachment', color: 'orange' },\n  { key: 'notAttached', color: 'blue' },\n  { key: 'incomplete', color: 'red' },\n];\n\nconst Errors = ErrorColors.map((errorColor) => errorColor.key);\n\nconst Hybridizations = [\n  {\n    key: '-',\n    label: '',\n    value: '',\n  },\n  {\n    key: 'sp',\n    label: 'sp',\n    value: 'SP',\n  },\n  {\n    key: 'sp2',\n    label: 'sp2',\n    value: 'SP2',\n  },\n  {\n    key: 'sp3',\n    label: 'sp3',\n    value: 'SP3',\n  },\n];\n\nconst DefaultTolerance = {\n  C: 0.25,\n  H: 0.02,\n  N: 0.25,\n  F: 0.25,\n  Si: 0.25,\n  P: 0.25,\n};\n\nexport { DefaultTolerance, Errors, ErrorColors, Hybridizations };\n","import lodashGet from 'lodash/get';\n\nimport { ErrorColors, Errors } from './CorrelationTable/Constants';\n\nfunction getAtomType(nucleus) {\n  return nucleus.split(/\\d+/)[1];\n}\n\nfunction getLabelColor(correlationData, correlation) {\n  const error = lodashGet(\n    correlationData,\n    `state.${correlation.atomType}.error`,\n    null,\n  );\n  if (error) {\n    for (let errorIndex in Errors) {\n      if (\n        ErrorColors[errorIndex].key !== 'incomplete' && // do not consider this for a single atom type\n        (ErrorColors[errorIndex].key === 'notAttached' ||\n          ErrorColors[errorIndex].key === 'ambiguousAttachment') &&\n        lodashGet(error, `${ErrorColors[errorIndex].key}`, []).some(\n          (index) => correlationData.values[index].id === correlation.id,\n        )\n      ) {\n        return ErrorColors[errorIndex].color;\n      }\n    }\n  }\n\n  return null;\n}\n\nfunction findSpectrum(spectraData, value) {\n  return spectraData.filter(\n    (_spectrum) =>\n      _spectrum.id === value.experimentID &&\n      _spectrum.display.isVisible === true,\n  )[0];\n}\n\nfunction findSignal(spectrum, value) {\n  for (let i = 0; i < spectrum.zones.values.length; i++) {\n    const signalIndex = spectrum.zones.values[i].signal.findIndex(\n      (_signal) => _signal.id === value.signal.id,\n    );\n    if (signalIndex >= 0) {\n      return spectrum.zones.values[i].signal[signalIndex];\n    }\n  }\n}\n\nfunction findRange(spectrum, value) {\n  for (let i = 0; i < spectrum.ranges.values.length; i++) {\n    const signalIndex = spectrum.ranges.values[i].signal.findIndex(\n      (_signal) => _signal.id === value.signal.id,\n    );\n    if (signalIndex >= 0) {\n      return spectrum.ranges.values[i];\n    }\n  }\n}\n\nfunction findZone(spectrum, value) {\n  for (let i = 0; i < spectrum.zones.values.length; i++) {\n    const signalIndex = spectrum.zones.values[i].signal.findIndex(\n      (_signal) => _signal.id === value.signal.id,\n    );\n    if (signalIndex >= 0) {\n      return spectrum.zones.values[i];\n    }\n  }\n}\n\nconst findRangeOrZoneID = (spectraData, value) => {\n  const spectrum = findSpectrum(spectraData, value);\n  if (spectrum) {\n    if (spectrum.info.dimension === 1) {\n      const range = findRange(spectrum, value);\n      if (range) return range.id;\n    } else if (spectrum.info.dimension === 2) {\n      const zone = findZone(spectrum, value);\n      if (zone) return zone.id;\n    }\n  }\n};\n\nfunction findSignalMatch1D(spectrum, link, factor, xDomain0, xDomain1) {\n  if (spectrum && spectrum.info.dimension === 2) {\n    const signal = findSignal(spectrum, link);\n    if (signal) {\n      const otherAxis = link.axis === 'x' ? 'y' : 'x';\n      return (\n        signal[otherAxis].delta * factor >= xDomain0 &&\n        signal[otherAxis].delta * factor <= xDomain1\n      );\n    }\n  }\n  return false;\n}\nfunction findSignalMatch2D(\n  spectrum,\n  value,\n  factor,\n  xDomain0,\n  xDomain1,\n  yDomain0,\n  yDomain1,\n) {\n  if (spectrum && spectrum.info.dimension === 2) {\n    const signal = findSignal(spectrum, value);\n    if (signal) {\n      return (\n        signal.x.delta * factor >= xDomain0 &&\n        signal.x.delta * factor <= xDomain1 &&\n        signal.y.delta * factor >= yDomain0 &&\n        signal.y.delta * factor <= yDomain1\n      );\n    }\n  }\n  return false;\n}\n\nexport {\n  findRange,\n  findRangeOrZoneID,\n  findSignalMatch1D,\n  findSignalMatch2D,\n  findSpectrum,\n  findZone,\n  getAtomType,\n  getLabelColor,\n};\n","/** @jsxImportSource @emotion/react */\nimport { useCallback, useMemo } from 'react';\n\nimport { buildID } from '../../../../data/utilities/Concatenation';\nimport { useHighlight } from '../../../highlight';\nimport { findRangeOrZoneID, getLabelColor } from '../Utilities';\n\nfunction AdditionalColumnHeader({\n  spectraData,\n  correlationsData,\n  correlation,\n}) {\n  const highlightIDsAdditionalColumn = useMemo(() => {\n    if (correlation.pseudo === true) {\n      return [];\n    }\n    const ids = [\n      correlation.signal.id,\n      buildID(correlation.signal.id, 'Crosshair_X'),\n    ];\n    const id = findRangeOrZoneID(spectraData, correlation);\n    if (id) {\n      ids.push(id);\n    }\n    correlation.link.forEach((link) => {\n      if (link.pseudo === false) {\n        ids.push(link.signal.id);\n        ids.push(buildID(link.signal.id, 'Crosshair_X'));\n        const _id = findRangeOrZoneID(spectraData, link);\n        if (_id) {\n          ids.push(_id);\n        }\n      }\n    });\n\n    return ids;\n  }, [correlation, spectraData]);\n  const highlightAdditionalColumn = useHighlight(highlightIDsAdditionalColumn);\n\n  const mouseEnterHandler = useCallback(\n    (event) => {\n      event.currentTarget.focus();\n      highlightAdditionalColumn.show();\n    },\n    [highlightAdditionalColumn],\n  );\n  const mouseLeaveHandler = useCallback(\n    (event) => {\n      event.currentTarget.blur();\n      highlightAdditionalColumn.hide();\n    },\n    [highlightAdditionalColumn],\n  );\n\n  const tableHeaderProps = useMemo(() => {\n    return {\n      style: {\n        ...{ color: getLabelColor(correlationsData, correlation) },\n        backgroundColor: highlightAdditionalColumn.isActive\n          ? '#ff6f0057'\n          : 'inherit',\n      },\n      title:\n        correlation.pseudo === false &&\n        [correlation.experimentType.toUpperCase()]\n          .concat(\n            correlation.link.reduce((arr, link) => {\n              if (\n                link.pseudo === false &&\n                link.experimentType !== correlation.experimentType &&\n                !arr.includes(link.experimentType.toUpperCase())\n              ) {\n                arr.push(link.experimentType.toUpperCase());\n              }\n              return arr;\n            }, []),\n          )\n          .sort()\n          .join('/'),\n      onMouseEnter: mouseEnterHandler,\n      onMouseLeave: mouseLeaveHandler,\n    };\n  }, [\n    correlation,\n    correlationsData,\n    highlightAdditionalColumn.isActive,\n    mouseEnterHandler,\n    mouseLeaveHandler,\n  ]);\n\n  const equivalenceTextStyle = useMemo(() => {\n    return correlation.edited.equivalence\n      ? { backgroundColor: '#F7F2E0' }\n      : {\n          color: Number.isInteger(correlation.equivalence)\n            ? correlation.equivalence === 1\n              ? '#bebebe'\n              : 'black'\n            : 'red',\n        };\n  }, [correlation]);\n\n  return (\n    <th {...tableHeaderProps}>\n      <div style={{ display: 'block' }}>\n        <p>{correlation.label.origin}</p>\n        <p>\n          {correlation && correlation.signal && correlation.signal.delta\n            ? correlation.signal.delta.toFixed(2)\n            : ''}\n        </p>\n        <p style={equivalenceTextStyle}>\n          {Number.isInteger(correlation.equivalence)\n            ? correlation.equivalence\n            : correlation.equivalence.toFixed(2)}\n        </p>\n      </div>\n    </th>\n  );\n}\n\nexport default AdditionalColumnHeader;\n","import lodashCloneDeep from 'lodash/cloneDeep';\nimport {\n  addLink,\n  buildLink,\n  getCorrelationIndex,\n  removeLink,\n} from 'nmr-correlation';\nimport { useCallback, useEffect, useMemo, useRef, useState } from 'react';\n\nimport { buildID } from '../../../../data/utilities/Concatenation';\nimport generateID from '../../../../data/utilities/generateID';\nimport ContextMenu from '../../../elements/ContextMenu';\nimport { useHighlight } from '../../../highlight';\nimport { findRangeOrZoneID } from '../Utilities';\n\nfunction AdditionalColumnField({\n  rowCorrelation,\n  columnCorrelation,\n  commonLinks,\n  correlations,\n  spectraData,\n  onEdit,\n}) {\n  const contextRef = useRef();\n  const [isEdited, setIsEdited] = useState(false);\n\n  const highlightIDsCommonLinks = useMemo(() => {\n    const ids = [];\n    commonLinks.forEach((link) => {\n      if (link.pseudo === false) {\n        ids.push(link.signal.id);\n        ids.push(buildID(link.signal.id, 'Crosshair'));\n        const _id = findRangeOrZoneID(spectraData, link);\n        if (_id) {\n          ids.push(_id);\n        }\n      }\n    });\n\n    return ids;\n  }, [commonLinks, spectraData]);\n  const highlightCommonLinks = useHighlight(highlightIDsCommonLinks);\n\n  const mouseEnterHandler = useCallback(\n    (event) => {\n      event.currentTarget.focus();\n      highlightCommonLinks.show();\n    },\n    [highlightCommonLinks],\n  );\n  const mouseLeaveHandler = useCallback(\n    (event) => {\n      event.currentTarget.blur();\n      highlightCommonLinks.hide();\n    },\n    [highlightCommonLinks],\n  );\n\n  useEffect(() => {\n    if (commonLinks.some((commonLink) => commonLink.pseudo === true)) {\n      setIsEdited(true);\n    } else {\n      setIsEdited(false);\n    }\n  }, [commonLinks]);\n\n  const contextMenuHandler = useCallback(\n    (e, rowData) => {\n      e.preventDefault();\n      contextRef.current.handleContextMenu(e, rowData);\n    },\n    [contextRef],\n  );\n\n  const onEditHandler = useCallback(\n    (experimentType, action, commonLink) => {\n      const _rowCorrelation = lodashCloneDeep(rowCorrelation);\n      const _columnCorrelation = lodashCloneDeep(columnCorrelation);\n      const pseudoLinkCountHSQC = _rowCorrelation.link.filter(\n        (link) =>\n          link.experimentType === 'hsqc' || link.experimentType === 'hmqc',\n      ).length;\n\n      if (action === 'add') {\n        const pseudoLinkID = generateID();\n        const pseudoExperimentID = generateID();\n        const pseudoCommonLink = buildLink({\n          experimentType,\n          experimentID: pseudoExperimentID,\n          atomType: [_columnCorrelation.atomType, _rowCorrelation.atomType],\n          id: pseudoLinkID,\n          pseudo: true,\n          signal: { id: generateID(), sign: 0 }, // pseudo signal\n        });\n\n        addLink(\n          _columnCorrelation,\n          buildLink({\n            ...pseudoCommonLink,\n            axis: 'x',\n            match: [getCorrelationIndex(correlations, _rowCorrelation)],\n          }),\n        );\n        addLink(\n          _rowCorrelation,\n          buildLink({\n            ...pseudoCommonLink,\n            axis: 'y',\n            match: [getCorrelationIndex(correlations, _columnCorrelation)],\n          }),\n        );\n        if (!_rowCorrelation.edited.protonsCount) {\n          _rowCorrelation.protonsCount = [pseudoLinkCountHSQC + 1];\n        }\n      } else if (action === 'remove') {\n        removeLink(_rowCorrelation, commonLink.id);\n        removeLink(_columnCorrelation, commonLink.id);\n        if (!_rowCorrelation.edited.protonsCount) {\n          _rowCorrelation.protonsCount =\n            pseudoLinkCountHSQC - 1 > 0 ? [pseudoLinkCountHSQC - 1] : [];\n        }\n      }\n\n      onEdit(_rowCorrelation, _columnCorrelation);\n    },\n    [rowCorrelation, onEdit, columnCorrelation, correlations],\n  );\n\n  const contextMenu = useMemo(() => {\n    // allow the edition of pseudo correlations and pseudo HSQC only (for now)\n    // assumption here that only one pseudo HSQC can be added to a pseudo correlation\n    const commonLinkHSQC = commonLinks.find(\n      (commonLink) =>\n        commonLink.experimentType === 'hsqc' && commonLink.pseudo === true,\n    );\n\n    return rowCorrelation.pseudo === true\n      ? commonLinkHSQC\n        ? [\n            {\n              label: 'remove HSQC',\n              onClick: () => {\n                onEditHandler('hsqc', 'remove', commonLinkHSQC);\n              },\n            },\n          ]\n        : [\n            {\n              label: 'add HSQC',\n              onClick: () => {\n                onEditHandler('hsqc', 'add');\n              },\n            },\n          ]\n      : [];\n  }, [commonLinks, onEditHandler, rowCorrelation]);\n\n  const content = useMemo(() => {\n    const linkSet = new Set();\n    commonLinks.forEach((commonLink) => {\n      if (\n        commonLink.experimentType === 'hsqc' ||\n        commonLink.experimentType === 'hmqc'\n      ) {\n        linkSet.add(\n          !commonLink.signal || commonLink.signal.sign === 0\n            ? 'S'\n            : `S${commonLink.signal.sign === 1 ? '+' : '-'}`,\n        );\n      } else if (\n        commonLink.experimentType === 'hmbc' ||\n        commonLink.experimentType === 'cosy' ||\n        commonLink.experimentType === 'tocsy'\n      ) {\n        linkSet.add('M');\n      } else if (\n        commonLink.experimentType === 'noesy' ||\n        commonLink.experimentType === 'roesy'\n      ) {\n        linkSet.add('NOE');\n      }\n    });\n\n    return [...linkSet];\n  }, [commonLinks]);\n\n  const title = useMemo(\n    () =>\n      commonLinks\n        .reduce((arr, link) => {\n          if (!arr.includes(link.experimentType.toUpperCase())) {\n            arr.push(link.experimentType.toUpperCase());\n          }\n          return arr;\n        }, [])\n        .sort()\n        .join('/'),\n    [commonLinks],\n  );\n\n  return (\n    <td\n      onContextMenu={(e) => {\n        if (contextMenu.length > 0) {\n          contextMenuHandler(e, rowCorrelation);\n        }\n      }}\n      style={{\n        backgroundColor: highlightCommonLinks.isActive\n          ? '#ff6f0057'\n          : isEdited\n          ? '#F7F2E0'\n          : 'inherit',\n      }}\n      title={title}\n      onMouseEnter={mouseEnterHandler}\n      onMouseLeave={mouseLeaveHandler}\n    >\n      {content.join('/')}\n      <ContextMenu ref={contextRef} context={contextMenu} />\n    </td>\n  );\n}\n\nexport default AdditionalColumnField;\n","import lodashGet from 'lodash/get';\nimport { buildLink, getLabel } from 'nmr-correlation';\nimport { useCallback, useMemo } from 'react';\n\nimport { buildID } from '../../../../data/utilities/Concatenation';\nimport EditableColumn from '../../../elements/EditableColumn';\nimport Select from '../../../elements/Select';\nimport { useHighlight } from '../../../highlight';\nimport { findRangeOrZoneID } from '../Utilities';\n\nimport AdditionalColumnField from './AdditionalColumnField';\nimport { Hybridizations } from './Constants';\n\nconst selectBoxStyle = {\n  marginLeft: 2,\n  marginRight: 2,\n  border: 'none',\n  height: '20px',\n};\n\nfunction CorrelationTableRow({\n  additionalColumnData,\n  correlations,\n  correlation,\n  styleRow,\n  styleLabel,\n  onSaveEditEquivalences,\n  onChangeHybridization,\n  onSaveEditProtonsCount,\n  onEditAdditionalColumnField,\n  spectraData,\n}) {\n  const highlightIDsRow = useMemo(() => {\n    if (correlation.pseudo === true) {\n      return [];\n    }\n    const ids = [\n      correlation.signal.id,\n      buildID(correlation.signal.id, 'Crosshair_Y'),\n    ];\n    const id = findRangeOrZoneID(spectraData, correlation);\n    if (id) {\n      ids.push(id);\n    }\n    correlation.link.forEach((link) => {\n      if (link.pseudo === false) {\n        ids.push(link.signal.id);\n        ids.push(buildID(link.signal.id, 'Crosshair_Y'));\n        const _id = findRangeOrZoneID(spectraData, link);\n        if (_id) {\n          ids.push(_id);\n        }\n      }\n    });\n\n    return ids;\n  }, [correlation, spectraData]);\n  const highlightRow = useHighlight(highlightIDsRow);\n\n  const onSaveEquivalencesHandler = useCallback(\n    (e) => {\n      onSaveEditEquivalences(correlation, e.target.value);\n    },\n    [correlation, onSaveEditEquivalences],\n  );\n\n  const onSaveProtonsCountHandler = useCallback(\n    (e) => {\n      onSaveEditProtonsCount(correlation, e.target.value);\n    },\n    [correlation, onSaveEditProtonsCount],\n  );\n\n  const additionalColumnFields = useMemo(() => {\n    return additionalColumnData.map((_correlation) => {\n      const commonLinks = [];\n      correlation.link.forEach((link) => {\n        _correlation.link.forEach((_link) => {\n          if (\n            link.axis !== _link.axis &&\n            link.experimentID === _link.experimentID &&\n            link.signal.id === _link.signal.id\n          ) {\n            let experimentLabel = link.experimentType;\n            if (link.signal && link.signal.sign !== 0) {\n              experimentLabel += ' (edited)';\n            }\n            commonLinks.push(\n              buildLink({\n                ...link,\n                experimentLabel,\n                axis: undefined,\n              }),\n            );\n          }\n        });\n      });\n\n      return (\n        <AdditionalColumnField\n          key={`addColData_${correlation.id}_${_correlation.id}`}\n          rowCorrelation={correlation}\n          columnCorrelation={_correlation}\n          commonLinks={commonLinks}\n          correlations={correlations}\n          spectraData={spectraData}\n          onEdit={onEditAdditionalColumnField}\n        />\n      );\n    });\n  }, [\n    additionalColumnData,\n    correlation,\n    correlations,\n    onEditAdditionalColumnField,\n    spectraData,\n  ]);\n\n  const onChangeHybridizationHandler = useCallback(\n    (value) => {\n      onChangeHybridization(correlation, value);\n    },\n    [correlation, onChangeHybridization],\n  );\n\n  const equivalenceCellStyle = useMemo(() => {\n    return correlation.edited.equivalence\n      ? { backgroundColor: '#F7F2E0' }\n      : {\n          color: correlation.equivalence === 1 ? '#bebebe' : 'black',\n        };\n  }, [correlation]);\n\n  const mouseEnterHandler = useCallback(\n    (event) => {\n      event.currentTarget.focus();\n      highlightRow.show();\n    },\n    [highlightRow],\n  );\n  const mouseLeaveHandler = useCallback(\n    (event) => {\n      event.currentTarget.blur();\n      highlightRow.hide();\n    },\n    [highlightRow],\n  );\n\n  const tableDataProps = useMemo(() => {\n    return {\n      style: {\n        ...styleRow,\n        backgroundColor: highlightRow.isActive ? '#ff6f0057' : 'inherit',\n      },\n      title:\n        correlation.pseudo === false &&\n        [correlation.experimentType.toUpperCase()]\n          .concat(\n            correlation.link.reduce((arr, link) => {\n              if (\n                link.pseudo === false &&\n                link.experimentType !== correlation.experimentType &&\n                !arr.includes(link.experimentType.toUpperCase())\n              ) {\n                arr.push(link.experimentType.toUpperCase());\n              }\n              return arr;\n            }, []),\n          )\n          .sort()\n          .join('/'),\n      onMouseEnter: mouseEnterHandler,\n      onMouseLeave: mouseLeaveHandler,\n    };\n  }, [\n    correlation.experimentType,\n    correlation.link,\n    correlation.pseudo,\n    highlightRow.isActive,\n    mouseEnterHandler,\n    mouseLeaveHandler,\n    styleRow,\n  ]);\n\n  return (\n    <tr style={styleRow}>\n      <td\n        {...{\n          ...tableDataProps,\n          style: { ...tableDataProps.style, styleLabel },\n        }}\n      >\n        {getLabel(correlations, correlation)}\n      </td>\n      <td {...tableDataProps}>\n        {lodashGet(correlation.signal, 'delta', false)\n          ? correlation.signal.delta.toFixed(2)\n          : ''}\n      </td>\n      <td {...tableDataProps}>\n        {correlation.pseudo === false ? (\n          correlation.atomType !== 'H' ? (\n            <EditableColumn\n              type=\"number\"\n              value={correlation.equivalence}\n              style={equivalenceCellStyle}\n              onSave={onSaveEquivalencesHandler}\n            />\n          ) : (\n            <text style={equivalenceCellStyle}>{correlation.equivalence}</text>\n          )\n        ) : (\n          ''\n        )}\n      </td>\n      <td {...tableDataProps}>\n        {correlation.atomType !== 'H' ? (\n          <EditableColumn\n            type=\"text\"\n            value={correlation.protonsCount.join(',')}\n            style={\n              correlation.edited.protonsCount\n                ? { backgroundColor: '#F7F2E0' }\n                : {}\n            }\n            onSave={onSaveProtonsCountHandler}\n          />\n        ) : (\n          ''\n        )}\n      </td>\n      <td\n        {...{\n          ...tableDataProps,\n          style: { ...tableDataProps.style, borderRight: '1px solid' },\n        }}\n      >\n        {correlation.atomType !== 'H' ? (\n          <Select\n            onChange={onChangeHybridizationHandler}\n            data={Hybridizations}\n            defaultValue={correlation.hybridization}\n            style={{\n              ...selectBoxStyle,\n              backgroundColor: correlation.edited.hybridization\n                ? '#F7F2E0'\n                : styleRow.backgroundColor,\n              width: '50px',\n            }}\n          />\n        ) : (\n          ''\n        )}\n      </td>\n      {additionalColumnFields}\n    </tr>\n  );\n}\n\nexport default CorrelationTableRow;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useMemo } from 'react';\n\nimport { getLabelColor } from '../Utilities';\n\nimport AdditionalColumnHeader from './AdditionalColumnHeader';\nimport CorrelationTableRow from './CorrelationTableRow';\n\nconst tableStyle = css`\n  overflow: auto;\n  height: 100%;\n  display: block;\n  table {\n    border-spacing: 0;\n    border: 1px solid #dedede;\n    width: 100%;\n    font-size: 12px;\n    height: 100%;\n  }\n  // .react-contextmenu-wrapper {\n  //   display: contents;\n  // }\n  tr {\n    :last-child {\n      td {\n        border-bottom: 0;\n      }\n    }\n  }\n  thead tr {\n    background-color: white !important;\n  }\n  th {\n    position: sticky;\n    background-color: white;\n    top: 0;\n  }\n\n  th,\n  td {\n    white-space: nowrap;\n    text-align: center;\n    margin: 0;\n    padding: 0.4rem;\n    border-bottom: 1px solid #dedede;\n    border-right: 1px solid #dedede;\n\n    :last-child {\n      border-right: 0;\n    }\n    button {\n      background-color: transparent;\n      border: none;\n    }\n  }\n`;\n\nfunction CorrelationTable({\n  correlationsData,\n  filteredCorrelationsData,\n  additionalColumnData,\n  editEquivalencesSaveHandler,\n  changeHybridizationSaveHandler,\n  editProtonsCountSaveHandler,\n  editAdditionalColumnFieldSaveHandler,\n  showProtonsAsRows,\n  spectraData,\n}) {\n  const rows = useMemo(() => {\n    if (!filteredCorrelationsData) {\n      return [];\n    }\n\n    return filteredCorrelationsData.values\n      .filter((correlation) =>\n        showProtonsAsRows\n          ? correlation.atomType === 'H'\n          : correlation.atomType !== 'H',\n      )\n      .map((correlation) => (\n        <CorrelationTableRow\n          additionalColumnData={additionalColumnData}\n          correlations={correlationsData.values}\n          correlation={correlation}\n          key={`correlation${correlation.atomType}${correlation.id}`}\n          styleRow={{ backgroundColor: 'mintcream' }}\n          styleLabel={\n            correlation.atomType === 'H'\n              ? {\n                  color: getLabelColor(correlationsData, correlation),\n                }\n              : {}\n          }\n          onSaveEditEquivalences={editEquivalencesSaveHandler}\n          onChangeHybridization={changeHybridizationSaveHandler}\n          onSaveEditProtonsCount={editProtonsCountSaveHandler}\n          onEditAdditionalColumnField={editAdditionalColumnFieldSaveHandler}\n          spectraData={spectraData}\n        />\n      ));\n  }, [\n    filteredCorrelationsData,\n    showProtonsAsRows,\n    additionalColumnData,\n    correlationsData,\n    editEquivalencesSaveHandler,\n    changeHybridizationSaveHandler,\n    editProtonsCountSaveHandler,\n    editAdditionalColumnFieldSaveHandler,\n    spectraData,\n  ]);\n\n  const additionalColumnHeader = useMemo(\n    () =>\n      additionalColumnData.map((correlation) => (\n        <AdditionalColumnHeader\n          key={`additionalCorrelationHeader_${correlation.id}`}\n          spectraData={spectraData}\n          correlationsData={correlationsData}\n          correlation={correlation}\n        />\n      )),\n    [additionalColumnData, correlationsData, spectraData],\n  );\n\n  return (\n    <div css={tableStyle}>\n      <table>\n        <thead>\n          <tr>\n            <th>Atom</th>\n            <th> (ppm)</th>\n            <th>Equiv</th>\n            <th>#H</th>\n            <th style={{ borderRight: '1px solid' }}>Hybrid</th>\n            {additionalColumnHeader}\n          </tr>\n        </thead>\n        <tbody>{rows}</tbody>\n      </table>\n    </div>\n  );\n}\n\nexport default CorrelationTable;\n","import { getAtomCounts } from 'nmr-correlation';\nimport { memo } from 'react';\n\nimport { ErrorColors, Errors } from './CorrelationTable/Constants';\n\nfunction Overview({ correlationsData }) {\n  if (!correlationsData) {\n    return null;\n  }\n  const atoms = getAtomCounts(correlationsData.options.mf);\n\n  return Object.keys(atoms).length > 0 ? (\n    Object.keys(atoms).map((atomType, i) => {\n      const stateAtomType = correlationsData.state[atomType];\n      const error = stateAtomType ? stateAtomType.error : undefined;\n      const errorColorIndex = error\n        ? Errors.findIndex((_error) => error[_error] !== undefined)\n        : 'black';\n\n      return (\n        <span\n          // eslint-disable-next-line react/no-array-index-key\n          key={`molFormulaView_${i}`}\n          style={{\n            color: stateAtomType\n              ? stateAtomType.complete === true &&\n                (!error || Object.keys(error).length === 0)\n                ? 'green'\n                : errorColorIndex >= 0\n                ? ErrorColors[errorColorIndex].color\n                : 'black'\n              : 'black',\n          }}\n        >\n          {`${atomType}: ${stateAtomType ? stateAtomType.current : '-'}/${\n            atoms[atomType]\n          }   `}\n        </span>\n      );\n    })\n  ) : (\n    <p style={{ fontStyle: 'italic', color: 'orange' }}>\n      Molecular formula is not set\n    </p>\n  );\n}\n\nexport default memo(Overview);\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { MF } from 'mf-parser';\nimport { useCallback, useState } from 'react';\n\nconst inputStyle = css`\n  text-align: center;\n\n  input {\n    height: 100%;\n    width: 200px;\n    border-radius: 5px;\n    border: 0.55px solid #c7c7c7;\n    margin: 0px 5px 0px 5px;\n    text-align: center;\n  }\n\n  button {\n    flex: 2;\n    padding: 5px;\n    border: 1px solid gray;\n    border-radius: 5px;\n    height: 36px;\n    margin: 0 auto;\n    margin-top: 15px;\n    display: block;\n    width: 20%;\n\n    color: white;\n    background-color: gray;\n  }\n`;\n\nfunction MolecularFormulaInput({ onSave, previousMF }) {\n  const [mf, setMF] = useState('');\n  const [isValidMF, setIsValidMF] = useState(true);\n  const [hasChanged, setHasChanged] = useState(false);\n\n  const checkMF = useCallback((mf) => {\n    try {\n      new MF(mf);\n      return true;\n    } catch (error) {\n      return false;\n    }\n  }, []);\n\n  const onChangeHandler = useCallback(\n    (e) => {\n      setHasChanged(true);\n      if (checkMF(e.target.value)) {\n        setIsValidMF(true);\n        setMF(e.target.value);\n      } else {\n        setIsValidMF(false);\n        setMF('');\n      }\n    },\n    [checkMF],\n  );\n\n  const onSaveHandler = useCallback(() => {\n    onSave(hasChanged ? mf.trim() : previousMF);\n  }, [hasChanged, mf, onSave, previousMF]);\n\n  return (\n    <div css={inputStyle}>\n      <input type=\"text\" onChange={onChangeHandler} defaultValue={previousMF} />\n      <button type=\"button\" onClick={onSaveHandler} disabled={!isValidMF}>\n        Set\n      </button>\n    </div>\n  );\n}\n\nMolecularFormulaInput.defaultProps = {\n  onSave: () => {\n    return null;\n  },\n};\n\nexport default MolecularFormulaInput;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback, useEffect, useState } from 'react';\n\nimport CloseButton from '../../elements/CloseButton';\nimport MolecularFormulaInput from '../../elements/MolecularFormulaInput';\nimport MoleculeSelection from '../../elements/MoleculeSelection';\n\nconst modalContainer = css`\n  overflow: auto;\n  width: 400px;\n  height: 550px;\n  padding: 5px;\n  button:focus {\n    outline: none;\n  }\n  .header {\n    height: 24px;\n    border-bottom: 1px solid #f0f0f0;\n    display: flex;\n    align-items: center;\n\n    button {\n      height: 36px;\n      margin: 2px;\n      background-color: transparent;\n      border: none;\n      svg {\n        height: 16px;\n      }\n    }\n  }\n\n  button {\n    flex: 2;\n    padding: 5px;\n    border: 1px solid gray;\n    border-radius: 5px;\n    height: 30px;\n    margin: 0 auto;\n    margin-top: 15px;\n    display: block;\n    width: 20%;\n\n    color: white;\n    background-color: gray;\n  }\n\n  .info {\n    margin-top: 0;\n    margin-bottom: 10px;\n    padding: 0px 10px;\n    width: 100%;\n\n    text-align: center;\n  }\n\n  .optional {\n    margin-top: 20px;\n    margin-bottom: 5px;\n    padding: 0px 10px;\n\n    text-align: center;\n    font-size: 18px;\n    font-weight: bold;\n  }\n  .optional2 {\n    margin-top: 5px;\n    margin-bottom: 25px;\n    padding: 0px 10px;\n    width: 100%;\n\n    text-align: center;\n  }\n`;\n\nfunction SetMolecularFormulaModal({ onClose, onSave, molecules, previousMF }) {\n  const [currentIndex, setCurrentIndex] = useState();\n\n  useEffect(() => {\n    if (molecules && molecules.length > 0) {\n      setCurrentIndex(0);\n    }\n  }, [molecules]);\n\n  const onSaveHandlerMolecularFormulaInput = useCallback(\n    (mf) => {\n      onSave(mf);\n      onClose();\n    },\n    [onClose, onSave],\n  );\n\n  const onSaveHandlerMoleculeSelection = useCallback(() => {\n    onSave(molecules[currentIndex].mf);\n    onClose();\n  }, [currentIndex, molecules, onClose, onSave]);\n\n  const onChangeHandlerMoleculeSelection = useCallback((index) => {\n    setCurrentIndex(index);\n  }, []);\n\n  return (\n    <div css={modalContainer}>\n      <div className=\"header handle\">\n        <CloseButton onClick={onClose} />\n      </div>\n      <div>\n        <p className=\"info\">Please type in a molecular formula!</p>\n      </div>\n      <MolecularFormulaInput\n        onSave={onSaveHandlerMolecularFormulaInput}\n        previousMF={previousMF}\n      />\n      <div>\n        <p className=\"optional\">OR</p>\n        <p className=\"optional2\">Select a molecule as reference!</p>\n      </div>\n      <MoleculeSelection\n        molecules={molecules}\n        onChange={onChangeHandlerMoleculeSelection}\n      />\n      <button type=\"button\" onClick={onSaveHandlerMoleculeSelection}>\n        Set\n      </button>\n    </div>\n  );\n}\n\nSetMolecularFormulaModal.defaultProps = {\n  onSave: () => {\n    return null;\n  },\n  onClose: () => {\n    return null;\n  },\n};\n\nexport default SetMolecularFormulaModal;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback, useEffect, useMemo, useState } from 'react';\n\nimport CloseButton from '../../elements/CloseButton';\n\nconst modalContainer = css`\n  overflow: auto;\n  width: 300px;\n  height: 300px;\n  padding: 5px;\n  button:focus {\n    outline: none;\n  }\n  text-align: center;\n\n  .header {\n    height: 24px;\n    border-bottom: 1px solid #f0f0f0;\n    display: flex;\n    align-items: center;\n\n    button {\n      height: 36px;\n      margin: 2px;\n      background-color: transparent;\n      border: none;\n      svg {\n        height: 16px;\n      }\n    }\n  }\n\n  button {\n    flex: 2;\n    padding: 5px;\n    border: 1px solid gray;\n    border-radius: 5px;\n    height: 30px;\n    margin: 0 auto;\n    margin-top: 15px;\n    display: block;\n    width: 20%;\n\n    color: white;\n    background-color: gray;\n  }\n\n  .info {\n    margin-top: 0;\n    margin-bottom: 10px;\n    padding: 0px 10px;\n    width: 100%;\n\n    text-align: center;\n  }\n\n  input {\n    border-radius: 5px;\n    border: 0.55px solid #c7c7c7;\n    margin: 0px 5px 0px 5px;\n    text-align: center;\n  }\n`;\n\nfunction SetShiftToleranceModal({ onClose, onSave, previousTolerance }) {\n  const [tolerance, setTolerance] = useState();\n\n  useEffect(() => {\n    if (previousTolerance) {\n      setTolerance(previousTolerance);\n    } else {\n      setTolerance(undefined);\n    }\n  }, [previousTolerance]);\n\n  const onSaveHandler = useCallback(() => {\n    onSave(tolerance);\n    onClose();\n  }, [onClose, onSave, tolerance]);\n\n  const onChangeHandler = useCallback(\n    (e, atomType) =>\n      setTolerance({ ...tolerance, [atomType]: Number(e.target.value) }),\n    [tolerance],\n  );\n\n  const inputFields = useMemo(() => {\n    return tolerance\n      ? Object.keys(tolerance).map((atomType) => {\n          return (\n            <div\n              key={`toleranceInputField_${atomType}`}\n              className=\"input-field\"\n            >\n              <span>{atomType}: </span>\n              <input\n                type=\"number\"\n                onChange={(e) => onChangeHandler(e, atomType)}\n                defaultValue={tolerance[atomType]}\n              />\n            </div>\n          );\n        })\n      : undefined;\n  }, [onChangeHandler, tolerance]);\n\n  return (\n    <div css={modalContainer}>\n      <div className=\"header handle\">\n        <CloseButton onClick={onClose} />\n      </div>\n      <div>\n        <p className=\"info\">Shift tolerances: </p>\n      </div>\n      {inputFields}\n      <button type=\"button\" onClick={onSaveHandler}>\n        Set\n      </button>\n    </div>\n  );\n}\n\nSetShiftToleranceModal.defaultProps = {\n  onSave: () => {\n    return null;\n  },\n  onClose: () => {\n    return null;\n  },\n};\n\nexport default SetShiftToleranceModal;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { memo, useCallback, useEffect, useMemo, useState } from 'react';\nimport { FaFlask, FaSlidersH } from 'react-icons/fa';\n\nimport { useChartData } from '../../context/ChartContext';\nimport { useDispatch } from '../../context/DispatchContext';\nimport Select from '../../elements/Select';\nimport ToolTip from '../../elements/ToolTip/ToolTip';\nimport { useModal } from '../../elements/popup/Modal';\nimport { DISPLAYER_MODE } from '../../reducer/core/Constants';\nimport {\n  SET_CORRELATION,\n  SET_CORRELATIONS,\n  SET_CORRELATIONS_MF,\n  SET_CORRELATIONS_TOLERANCE,\n} from '../../reducer/types/Types';\nimport DefaultPanelHeader from '../header/DefaultPanelHeader';\n\nimport CorrelationTable from './CorrelationTable/CorrelationTable';\nimport Overview from './Overview';\nimport SetMolecularFormulaModal from './SetMolecularFormulaModal';\nimport SetShiftToleranceModal from './SetShiftTolerancesModal';\nimport {\n  findSignalMatch1D,\n  findSignalMatch2D,\n  findSpectrum,\n  getAtomType,\n} from './Utilities';\n\nconst panelStyle = css`\n  display: flex;\n  flex-direction: column;\n  text-align: center;\n  height: 100%;\n  width: 100%;\n  justify-content: center,\n  align-items: 'center',\n\n  button {\n    border-radius: 5px;\n    margin-top: 3px;\n    margin-left: 2px;\n    border: none;\n    height: 16px;\n    width: 18px;\n    font-size: 12px;\n    padding: 0;\n    background-color: transparent;\n  }\n\n  .overview-container {\n    width: 100%;\n    margin-left: 15px;\n    white-space: nowrap;\n    span {\n      margin-left: 8px;\n    }\n  }\n\n  .homoHeteroKinds-container {\n    width: 100%;\n    margin-left: 15px;\n    span {\n      margin-left: 7px;\n    }\n  }\n\n\n`;\n\nfunction SummaryPanel() {\n  const {\n    molecules,\n    correlations: correlationsData,\n    data: spectraData,\n    xDomain,\n    yDomain,\n    displayerMode,\n    activeTab,\n  } = useChartData();\n\n  const dispatch = useDispatch();\n  const modal = useModal();\n\n  const [additionalColumnData, setAdditionalColumnData] = useState([]);\n  const [\n    selectedAdditionalColumnsAtomType,\n    setSelectedAdditionalColumnsAtomType,\n  ] = useState('-');\n  const [showProtonsAsRows, setShowProtonsAsRows] = useState(false);\n  const [filterIsActive, setFilterIsActive] = useState(false);\n\n  const filteredCorrelationsData = useMemo(() => {\n    const isInView = (value) => {\n      if (value.pseudo === true) {\n        return false;\n      }\n      const atomTypesInView = activeTab\n        .split(',')\n        .map((tab) => getAtomType(tab));\n\n      const factor = 10000;\n      const xDomain0 = xDomain[0] * factor;\n      const xDomain1 = xDomain[1] * factor;\n      const yDomain0 = yDomain[0] * factor;\n      const yDomain1 = yDomain[1] * factor;\n\n      if (displayerMode === DISPLAYER_MODE.DM_1D) {\n        const delta = value.signal.delta * factor;\n        const spectrum = findSpectrum(spectraData, value);\n        if (\n          spectrum &&\n          atomTypesInView[0] === value.atomType &&\n          delta >= xDomain0 &&\n          delta <= xDomain1\n        ) {\n          return true;\n        }\n        // try to find a link which contains the belonging 2D signal in the spectra in view\n        if (\n          value.link.some((link) => {\n            const spectrum = findSpectrum(spectraData, link);\n            return findSignalMatch1D(\n              spectrum,\n              link,\n              factor,\n              xDomain0,\n              xDomain1,\n            );\n          })\n        ) {\n          return true;\n        }\n      } else if (displayerMode === DISPLAYER_MODE.DM_2D) {\n        if (!atomTypesInView.includes(value.atomType)) {\n          return false;\n        }\n        const spectrum = findSpectrum(spectraData, value);\n        // correlation is represented by a 2D signal\n        if (\n          findSignalMatch2D(\n            spectrum,\n            value,\n            factor,\n            xDomain0,\n            xDomain1,\n            yDomain0,\n            yDomain1,\n          )\n        ) {\n          return true;\n        } else {\n          // try to find a link which contains the belonging 2D signal in the spectra in view\n          if (\n            value.link.some((link) => {\n              const spectrum = findSpectrum(spectraData, link);\n              return findSignalMatch2D(\n                spectrum,\n                link,\n                factor,\n                xDomain0,\n                xDomain1,\n                yDomain0,\n                yDomain1,\n              );\n            })\n          ) {\n            return true;\n          }\n        }\n      }\n      // do not show correlation\n      return false;\n    };\n\n    if (correlationsData) {\n      const _values = filterIsActive\n        ? correlationsData.values.filter((value) => isInView(value))\n        : correlationsData.values;\n\n      return { ...correlationsData, values: _values };\n    }\n  }, [\n    activeTab,\n    correlationsData,\n    displayerMode,\n    filterIsActive,\n    spectraData,\n    xDomain,\n    yDomain,\n  ]);\n\n  const handleOnSetMolecularFormula = useCallback(\n    (mf) => {\n      dispatch({\n        type: SET_CORRELATIONS_MF,\n        payload: {\n          mf,\n        },\n      });\n    },\n    [dispatch],\n  );\n\n  const handleOnSetShiftTolerance = useCallback(\n    (tolerance) => {\n      dispatch({\n        type: SET_CORRELATIONS_TOLERANCE,\n        payload: {\n          tolerance,\n        },\n      });\n    },\n    [dispatch],\n  );\n\n  const showSetMolecularFormulaModal = useCallback(() => {\n    modal.show(\n      <SetMolecularFormulaModal\n        onClose={() => modal.close()}\n        onSave={handleOnSetMolecularFormula}\n        molecules={molecules}\n        previousMF={correlationsData.options.mf}\n      />,\n    );\n  }, [correlationsData, handleOnSetMolecularFormula, modal, molecules]);\n\n  const showSetShiftToleranceModal = useCallback(() => {\n    modal.show(\n      <SetShiftToleranceModal\n        onClose={() => modal.close()}\n        onSave={handleOnSetShiftTolerance}\n        previousTolerance={correlationsData.options.tolerance}\n      />,\n    );\n  }, [correlationsData, handleOnSetShiftTolerance, modal]);\n\n  const additionalColumnTypes = useMemo(() => {\n    const columnTypes = ['-'].concat(\n      correlationsData\n        ? correlationsData.values\n            .map((correlation) => correlation.atomType)\n            .filter((atomType, i, array) => array.indexOf(atomType) === i)\n        : [],\n    );\n\n    if (columnTypes.includes('H')) {\n      columnTypes.push('H-H');\n    }\n\n    if (columnTypes.includes('H')) {\n      setSelectedAdditionalColumnsAtomType('H');\n    } else {\n      setSelectedAdditionalColumnsAtomType('-');\n    }\n\n    return columnTypes.map((columnType) => {\n      return {\n        key: columnType,\n        label: columnType,\n        value: columnType,\n      };\n    });\n  }, [correlationsData]);\n\n  useEffect(() => {\n    const _selectedAdditionalColumnsAtomType = selectedAdditionalColumnsAtomType.split(\n      '-',\n    )[0];\n\n    setAdditionalColumnData(\n      filteredCorrelationsData\n        ? filteredCorrelationsData.values\n            .filter(\n              (correlation) =>\n                correlation.atomType === _selectedAdditionalColumnsAtomType,\n            )\n            .reverse()\n        : [],\n    );\n  }, [filteredCorrelationsData, selectedAdditionalColumnsAtomType]);\n\n  const editEquivalencesSaveHandler = useCallback(\n    (correlation, value) => {\n      dispatch({\n        type: SET_CORRELATION,\n        payload: {\n          id: correlation.id,\n          correlation: {\n            ...correlation,\n            equivalence: value,\n            edited: { ...correlation.edited, equivalence: true },\n          },\n        },\n      });\n    },\n    [dispatch],\n  );\n\n  const editProtonsCountSaveHandler = useCallback(\n    (correlation, valuesString) => {\n      let values;\n      // eslint-disable-next-line prefer-named-capture-group\n      if (valuesString.match(/^([0-9],{0,1})+$/g)) {\n        // allow digits followed by optional comma only\n        values = valuesString\n          .split(',')\n          .filter((char) => char.length > 0)\n          .map((char) => Number(char));\n      } else if (valuesString.trim().length === 0) {\n        // set values to default\n        values = [];\n      }\n\n      if (values) {\n        // ignore not supported text input\n        dispatch({\n          type: SET_CORRELATION,\n          payload: {\n            id: correlation.id,\n            correlation: {\n              ...correlation,\n              protonsCount: values,\n              edited: { ...correlation.edited, protonsCount: true },\n            },\n          },\n        });\n      }\n    },\n    [dispatch],\n  );\n\n  const changeHybridizationSaveHandler = useCallback(\n    (correlation, value) => {\n      dispatch({\n        type: SET_CORRELATION,\n        payload: {\n          id: correlation.id,\n          correlation: {\n            ...correlation,\n            hybridization: value,\n            edited: { ...correlation.edited, hybridization: true },\n          },\n        },\n      });\n    },\n    [dispatch],\n  );\n\n  const editAdditionalColumnFieldSaveHandler = useCallback(\n    (rowCorrelation, columnCorrelation) => {\n      dispatch({\n        type: SET_CORRELATIONS,\n        payload: {\n          ids: [rowCorrelation.id, columnCorrelation.id],\n          correlations: [\n            {\n              ...rowCorrelation,\n              edited: {\n                ...rowCorrelation.edited,\n                additionalColumnField: true,\n              },\n            },\n            {\n              ...columnCorrelation,\n              edited: {\n                ...columnCorrelation.edited,\n                additionalColumnField: true,\n              },\n            },\n          ],\n        },\n      });\n    },\n    [dispatch],\n  );\n\n  const handleOnFilter = useCallback(() => {\n    setFilterIsActive(!filterIsActive);\n  }, [filterIsActive]);\n\n  return (\n    <div css={panelStyle}>\n      <DefaultPanelHeader\n        canDelete={false}\n        counter={correlationsData ? correlationsData.values.length : 0}\n        onFilter={handleOnFilter}\n        filterToolTip={\n          filterIsActive\n            ? 'Show all correlations'\n            : 'Hide correlations out of view'\n        }\n        filterIsActive={filterIsActive}\n        counterFiltered={\n          filteredCorrelationsData && filteredCorrelationsData.values.length\n        }\n      >\n        <ToolTip\n          title={`Set molecular formula (${correlationsData.options.mf})`}\n          popupPlacement=\"right\"\n        >\n          <button type=\"button\" onClick={showSetMolecularFormulaModal}>\n            <FaFlask />\n          </button>\n        </ToolTip>\n        <ToolTip title={`Set shift tolerance`} popupPlacement=\"right\">\n          <button type=\"button\" onClick={showSetShiftToleranceModal}>\n            <FaSlidersH />\n          </button>\n        </ToolTip>\n        <div className=\"overview-container\">\n          <Overview correlationsData={correlationsData} />\n        </div>\n        <div className=\"homoHeteroKinds-container\">\n          <Select\n            onChange={(selection) => {\n              setSelectedAdditionalColumnsAtomType(selection);\n              if (selection === 'H-H') {\n                setShowProtonsAsRows(true);\n              } else {\n                setShowProtonsAsRows(false);\n              }\n            }}\n            data={additionalColumnTypes}\n            defaultValue={selectedAdditionalColumnsAtomType}\n            style={{\n              width: '65px',\n              height: '20px',\n              border: '1px solid grey',\n            }}\n          />\n        </div>\n      </DefaultPanelHeader>\n      <CorrelationTable\n        correlationsData={correlationsData}\n        filteredCorrelationsData={filteredCorrelationsData}\n        additionalColumnData={additionalColumnData}\n        editEquivalencesSaveHandler={editEquivalencesSaveHandler}\n        changeHybridizationSaveHandler={changeHybridizationSaveHandler}\n        editProtonsCountSaveHandler={editProtonsCountSaveHandler}\n        editAdditionalColumnFieldSaveHandler={\n          editAdditionalColumnFieldSaveHandler\n        }\n        showProtonsAsRows={showProtonsAsRows}\n        spectraData={spectraData}\n      />\n    </div>\n  );\n}\n\nexport default memo(SummaryPanel);\n","import lodashGet from 'lodash/get';\nimport lodashSet from 'lodash/set';\nimport {\n  useEffect,\n  useState,\n  useCallback,\n  forwardRef,\n  useImperativeHandle,\n  useRef,\n  memo,\n} from 'react';\n\nimport { usePreferences } from '../../context/PreferencesContext';\nimport IsotopesViewer from '../../elements/IsotopesViewer';\nimport { useAlert } from '../../elements/popup/Alert';\nimport ZonesWrapper from '../../hoc/ZonesWrapper';\nimport { SET_PANELS_PREFERENCES } from '../../reducer/preferencesReducer';\nimport {\n  useStateWithLocalStorage,\n  getValue as getValueByKeyPath,\n} from '../../utility/LocalStorage';\nimport ColumnFormatField from '../extra/preferences/ColumnFormatField';\nimport { rangeDefaultValues } from '../extra/preferences/defaultValues';\n\nconst styles = {\n  container: {\n    padding: 10,\n    backgroundColor: '#f1f1f1',\n    height: '100%',\n    flex: 1,\n  },\n  groupContainer: {\n    padding: '5px',\n    borderRadius: '5px',\n    margin: '10px 0px',\n    backgroundColor: 'white',\n  },\n  row: {\n    display: 'flex',\n    margin: '5px 0px',\n  },\n  header: {\n    borderBottom: '1px solid #e8e8e8',\n    paddingBottom: '5px',\n    fontWeight: 'bold',\n    color: '#4a4a4a',\n  },\n  inputLabel: {\n    flex: 2,\n    fontSize: '11px',\n    fontWeight: 'bold',\n    color: '#232323',\n  },\n  input: {\n    width: '30%',\n    textAlign: 'center',\n  },\n};\n\nconst formatFields = [\n  {\n    id: 1,\n    label: 'From :',\n    checkController: 'showFrom',\n    formatController: 'fromFormat',\n    defaultFormat: '0.00',\n  },\n  {\n    id: 2,\n    label: 'To :',\n    checkController: 'showTo',\n    formatController: 'toFormat',\n    defaultFormat: '0.00',\n  },\n  {\n    id: 3,\n    label: 'Absolute :',\n    checkController: 'showAbsolute',\n    formatController: 'absoluteFormat',\n    defaultFormat: '0.00',\n  },\n  {\n    id: 4,\n    label: 'Relative :',\n    checkController: 'showRelative',\n    formatController: 'relativeFormat',\n    defaultFormat: '00.00',\n  },\n];\n\nfunction ZonesPreferences({ nucleus }, ref) {\n  const alert = useAlert();\n  const [, setSettingsData] = useStateWithLocalStorage('nmr-general-settings');\n  const preferences = usePreferences();\n\n  const [settings, setSetting] = useState(null);\n  const formRef = useRef();\n  useEffect(() => {\n    const zonesPreferences = getValueByKeyPath(\n      preferences,\n      'formatting.panels.zones',\n    );\n    if (zonesPreferences) {\n      setSetting(zonesPreferences);\n    }\n  }, [preferences]);\n\n  const saveToLocalStorgate = (values) => {\n    setSettingsData(values, 'formatting.panels.ranges');\n  };\n\n  const saveHandler = useCallback(\n    (values, showMessage = false) => {\n      preferences.dispatch({\n        type: SET_PANELS_PREFERENCES,\n        payload: { key: 'zones', value: values },\n      });\n      if (showMessage) {\n        alert.success('zones preferences saved successfully');\n      }\n    },\n    [alert, preferences],\n  );\n\n  useImperativeHandle(ref, () => ({\n    saveSetting() {\n      if (typeof formRef.current.requestSubmit === 'function') {\n        formRef.current.requestSubmit();\n      } else {\n        formRef.current.dispatchEvent(\n          new Event('submit', { cancelable: true }),\n        );\n      }\n    },\n  }));\n\n  const handleSubmit = async (event) => {\n    event.preventDefault();\n    const form = event.target;\n    const formData = new FormData(form);\n    let values = {};\n    for (const field of formData.entries()) {\n      const keys = field[0].split('-').join('.');\n      const val = ['true', 'false'].includes(field[1])\n        ? field[1] === 'true'\n        : field[1];\n      values = lodashSet(values, keys, val);\n    }\n\n    saveHandler(values, true);\n    saveToLocalStorgate(values);\n  };\n\n  const getValue = useCallback(\n    (...params) => {\n      const keys = params.join('.');\n      if (settings) {\n        const value = lodashGet(settings, keys);\n        return value ? value : null;\n      } else {\n        const keyIndex = params.length - 1;\n        return rangeDefaultValues[params[keyIndex]];\n      }\n    },\n    [settings],\n  );\n\n  return (\n    <div style={styles.container}>\n      <form onSubmit={handleSubmit} ref={formRef}>\n        {nucleus &&\n          nucleus.map((nucleusLabel) => (\n            <div key={nucleusLabel} style={styles.groupContainer}>\n              <IsotopesViewer style={styles.header} value={nucleusLabel} />\n              {formatFields.map((field) => (\n                <ColumnFormatField\n                  key={field.id}\n                  label={field.label}\n                  checked={getValue(nucleusLabel, field.checkController)}\n                  format={getValue(nucleusLabel, field.formatController)}\n                  checkControllerName={field.checkController}\n                  formatControllerName={field.formatController}\n                  groupID={nucleusLabel}\n                />\n              ))}\n            </div>\n          ))}\n      </form>\n    </div>\n  );\n}\n\nexport default ZonesWrapper(memo(forwardRef(ZonesPreferences)));\n","import { Fragment, useCallback } from 'react';\nimport { FaRegTrashAlt, FaSearchPlus } from 'react-icons/fa';\n\nimport { SignalKinds } from '../../../../data/constants/SignalsKinds';\nimport { useAssignmentData } from '../../../assignment';\nimport { useDispatch } from '../../../context/DispatchContext';\nimport Select from '../../../elements/Select';\nimport {\n  CHANGE_ZONE_SIGNAL_KIND,\n  DELETE_2D_ZONE,\n  SET_X_DOMAIN,\n  SET_Y_DOMAIN,\n} from '../../../reducer/types/Types';\n\nconst selectBoxStyle = {\n  marginLeft: 2,\n  marginRight: 2,\n  border: 'none',\n  height: '20px',\n};\n\nfunction ActionsColumn({ rowData, rowSpanTags }) {\n  const dispatch = useDispatch();\n  const assignmentData = useAssignmentData();\n\n  const changeSignalKindHandler = useCallback(\n    (value) => {\n      dispatch({\n        type: CHANGE_ZONE_SIGNAL_KIND,\n        payload: {\n          rowData,\n          value,\n        },\n      });\n    },\n    [dispatch, rowData],\n  );\n\n  const deleteZoneHandler = useCallback(() => {\n    dispatch({\n      type: DELETE_2D_ZONE,\n      payload: {\n        id: rowData.id,\n        assignmentData,\n      },\n    });\n  }, [assignmentData, dispatch, rowData]);\n\n  const zoomZoneHandler = useCallback(() => {\n    const xMargin = Math.abs(rowData.x.from - rowData.x.to) * 10;\n    dispatch({\n      type: SET_X_DOMAIN,\n      xDomain:\n        rowData.x.from <= rowData.x.to\n          ? [rowData.x.from - xMargin, rowData.x.to + xMargin]\n          : [rowData.x.to - xMargin, rowData.x.from + xMargin],\n    });\n    const yMargin = Math.abs(rowData.y.from - rowData.y.to) * 10;\n    dispatch({\n      type: SET_Y_DOMAIN,\n      yDomain:\n        rowData.y.from <= rowData.y.to\n          ? [rowData.y.from - yMargin, rowData.y.to + yMargin]\n          : [rowData.y.to - yMargin, rowData.y.from + yMargin],\n    });\n  }, [dispatch, rowData.x.from, rowData.x.to, rowData.y.from, rowData.y.to]);\n\n  return (\n    <Fragment>\n      <td>\n        <Select\n          onChange={(value) => {\n            changeSignalKindHandler(value);\n          }}\n          data={SignalKinds}\n          defaultValue={rowData.tableMetaInfo.signal.kind}\n          style={selectBoxStyle}\n        />\n      </td>\n      <td {...rowSpanTags}>\n        <button\n          type=\"button\"\n          className=\"delete-button\"\n          onClick={deleteZoneHandler}\n        >\n          <FaRegTrashAlt />\n        </button>\n        <button type=\"button\" className=\"zoom-button\" onClick={zoomZoneHandler}>\n          <FaSearchPlus title=\"Zoom to zone in spectrum\" />\n        </button>\n      </td>\n    </Fragment>\n  );\n}\n\nexport default ActionsColumn;\n","import lodashGet from 'lodash/get';\nimport { FaMinusCircle } from 'react-icons/fa';\n\nfunction SignalAssignmentsColumn({\n  rowData,\n  assignment,\n  highlight,\n  onHover,\n  onClick,\n  onUnlink,\n  axis,\n  showUnlinkButton,\n  setShowUnlinkButton,\n}) {\n  return (\n    <td\n      {...onHover}\n      {...{ onClick: (e) => onClick(e, assignment, axis) }}\n      style={\n        highlight.isActive ||\n        (assignment.isActive && assignment.activeAxis === axis)\n          ? {\n              color: 'red',\n              fontWeight: 'bold',\n            }\n          : null\n      }\n    >\n      {lodashGet(rowData, `tableMetaInfo.signal.${axis}.diaID`, []).length >\n      0 ? (\n        <div\n          onMouseEnter={() => setShowUnlinkButton(true)}\n          onMouseLeave={() => setShowUnlinkButton(false)}\n        >\n          {rowData.tableMetaInfo.signal[axis].diaID.length}{' '}\n          <sup>\n            <button\n              type=\"button\"\n              style={{\n                visibility: showUnlinkButton ? 'visible' : 'hidden',\n                padding: 0,\n                margin: 0,\n              }}\n              onClick={(e) => onUnlink(e, false, axis)}\n            >\n              <FaMinusCircle color=\"red\" />\n            </button>\n          </sup>\n        </div>\n      ) : assignment.isActive && assignment.activeAxis === axis ? (\n        '0'\n      ) : (\n        ''\n      )}\n    </td>\n  );\n}\n\nexport default SignalAssignmentsColumn;\n","import { Fragment } from 'react';\n\nimport SignalAssignmentsColumn from './SignalAssignmentsColumn';\n\nfunction SignalAssignmentsColumns({\n  rowData,\n  assignmentSignal,\n  onHoverSignalX,\n  onHoverSignalY,\n  showUnlinkButtonSignalX,\n  showUnlinkButtonSignalY,\n  setShowUnlinkButtonSignalX,\n  setShowUnlinkButtonSignalY,\n  onClick,\n  onUnlink,\n  highlightSignalX,\n  highlightSignalY,\n}) {\n  return (\n    <Fragment>\n      <SignalAssignmentsColumn\n        rowData={rowData}\n        assignment={assignmentSignal}\n        highlight={highlightSignalX}\n        onHover={onHoverSignalX}\n        onClick={onClick}\n        onUnlink={onUnlink}\n        axis={'x'}\n        showUnlinkButton={showUnlinkButtonSignalX}\n        setShowUnlinkButton={setShowUnlinkButtonSignalX}\n      />\n      <SignalAssignmentsColumn\n        rowData={rowData}\n        assignment={assignmentSignal}\n        highlight={highlightSignalY}\n        onHover={onHoverSignalY}\n        onClick={onClick}\n        onUnlink={onUnlink}\n        axis={'y'}\n        showUnlinkButton={showUnlinkButtonSignalY}\n        setShowUnlinkButton={setShowUnlinkButtonSignalY}\n      />\n    </Fragment>\n  );\n}\n\nexport default SignalAssignmentsColumns;\n","import lodashGet from 'lodash/get';\nimport { Fragment, useCallback } from 'react';\n\nimport { useDispatch } from '../../../context/DispatchContext';\nimport EditableColumn from '../../../elements/EditableColumn';\nimport { CHANGE_ZONE_SIGNAL_VALUE } from '../../../reducer/types/Types';\n\nfunction SignalDeltaColumn({ rowData, onHoverSignalX, onHoverSignalY }) {\n  const dispatch = useDispatch();\n\n  const signalDeltaX = lodashGet(rowData, 'tableMetaInfo.signal.x.delta', null);\n  const signalDeltaY = lodashGet(rowData, 'tableMetaInfo.signal.y.delta', null);\n  const id = lodashGet(rowData, 'tableMetaInfo.signal.id', undefined);\n\n  const saveXHandler = useCallback(\n    (event) => {\n      const value = event.target.value;\n      dispatch({\n        type: CHANGE_ZONE_SIGNAL_VALUE,\n        payload: {\n          zoneID: rowData.id,\n          signal: { id, x: value },\n        },\n      });\n    },\n    [dispatch, id, rowData.id],\n  );\n  const saveYHandler = useCallback(\n    (event) => {\n      const value = event.target.value;\n      dispatch({\n        type: CHANGE_ZONE_SIGNAL_VALUE,\n        payload: {\n          zoneID: rowData.id,\n          signal: { id, y: value },\n        },\n      });\n    },\n    [dispatch, id, rowData.id],\n  );\n\n  return (\n    <Fragment>\n      <td {...onHoverSignalX}>\n        {signalDeltaX !== null ? (\n          <EditableColumn\n            value={signalDeltaX.toFixed(2)}\n            onSave={saveXHandler}\n            type=\"number\"\n            style={{ padding: '0.1rem 0.4rem' }}\n          />\n        ) : (\n          ''\n        )}\n      </td>\n      <td {...onHoverSignalY}>\n        {signalDeltaY !== null ? (\n          <EditableColumn\n            value={signalDeltaY.toFixed(2)}\n            onSave={saveYHandler}\n            type=\"number\"\n            style={{ padding: '0.1rem 0.4rem' }}\n          />\n        ) : (\n          ''\n        )}\n      </td>\n    </Fragment>\n  );\n}\n\nexport default SignalDeltaColumn;\n","import lodashGet from 'lodash/get';\nimport { FaMinusCircle } from 'react-icons/fa';\n\nfunction ZoneAssignmentColumn({\n  rowData,\n  assignment,\n  highlight,\n  onHover,\n  onClick,\n  onUnlink,\n  axis,\n  showUnlinkButton,\n  setShowUnlinkButton,\n  rowSpanTags,\n}) {\n  return (\n    <td\n      {...rowSpanTags}\n      {...onHover}\n      {...{ onClick: (e) => onClick(e, assignment, axis) }}\n    >\n      {lodashGet(rowData, `${axis}.pubIntegral`, 0) > 0 ? (\n        lodashGet(rowData, `${axis}.diaID`, []).length > 0 ? (\n          <div\n            onMouseEnter={() => setShowUnlinkButton(true)}\n            onMouseLeave={() => setShowUnlinkButton(false)}\n          >\n            {rowData[axis].pubIntegral} {`(`}\n            <span\n              style={\n                assignment.isActive & (assignment.activeAxis === axis) ||\n                assignment.isOnHover & (assignment.onHoverAxis === axis) ||\n                highlight.isActive\n                  ? {\n                      color: 'red',\n                      fontWeight: 'bold',\n                    }\n                  : { color: 'black', fontWeight: 'normal' }\n              }\n            >\n              {lodashGet(rowData, `${axis}.diaID`, []).length}\n            </span>\n            {`)`}{' '}\n            <sup>\n              <button\n                type=\"button\"\n                style={{\n                  visibility: showUnlinkButton ? 'visible' : 'hidden',\n                  padding: 0,\n                  margin: 0,\n                }}\n                onClick={(e) => onUnlink(e, true, axis)}\n              >\n                <FaMinusCircle color=\"red\" />\n              </button>\n            </sup>\n          </div>\n        ) : assignment.isActive && assignment.activeAxis === axis ? (\n          <div>\n            {`${lodashGet(rowData, `${axis}.pubIntegral`, '')} (`}\n            <span\n              style={{\n                color: 'red',\n                fontWeight: 'bold',\n              }}\n            >\n              0\n            </span>\n            {')'}\n          </div>\n        ) : (\n          rowData[axis].pubIntegral\n        )\n      ) : assignment.isActive && assignment.activeAxis === axis ? (\n        <div>\n          {'0 ('}\n          <span style={{ color: 'red', fontWeight: 'bold' }}>0</span>\n          {')'}\n        </div>\n      ) : (\n        ''\n      )}\n    </td>\n  );\n}\n\nexport default ZoneAssignmentColumn;\n","import { Fragment } from 'react';\n\nimport ZoneAssignmentColumn from './ZoneAssignmentsColumn';\n\nfunction ZoneAssignmentsColumns({\n  rowData,\n  assignmentZone,\n  onHoverZoneX,\n  onHoverZoneY,\n  showUnlinkButtonZoneX,\n  showUnlinkButtonZoneY,\n  setShowUnlinkButtonZoneX,\n  setShowUnlinkButtonZoneY,\n  rowSpanTags,\n  onClick,\n  onUnlink,\n  highlightZoneX,\n  highlightZoneY,\n}) {\n  return (\n    <Fragment>\n      <ZoneAssignmentColumn\n        rowData={rowData}\n        assignment={assignmentZone}\n        highlight={highlightZoneX}\n        onHover={onHoverZoneX}\n        onClick={onClick}\n        onUnlink={onUnlink}\n        axis={'x'}\n        showUnlinkButton={showUnlinkButtonZoneX}\n        setShowUnlinkButton={setShowUnlinkButtonZoneX}\n        rowSpanTags={rowSpanTags}\n      />\n      <ZoneAssignmentColumn\n        rowData={rowData}\n        assignment={assignmentZone}\n        highlight={highlightZoneY}\n        onHover={onHoverZoneY}\n        onClick={onClick}\n        onUnlink={onUnlink}\n        axis={'y'}\n        showUnlinkButton={showUnlinkButtonZoneY}\n        setShowUnlinkButton={setShowUnlinkButtonZoneY}\n        rowSpanTags={rowSpanTags}\n      />\n    </Fragment>\n  );\n}\n\nexport default ZoneAssignmentsColumns;\n","/** @jsxImportSource @emotion/react */\n\nimport lodashGet from 'lodash/get';\nimport { useMemo, useCallback, useState } from 'react';\n\nimport { buildID } from '../../../data/utilities/Concatenation';\nimport { useAssignment } from '../../assignment';\nimport { useHighlight } from '../../highlight';\n\nimport ActionsColumn from './TableColumns/ActionsColumn';\nimport SignalAssignmentsColumns from './TableColumns/SignalAssignmentsColumns';\nimport SignalDeltaColumn from './TableColumns/SignalDeltaColumn';\nimport ZoneAssignmentsColumns from './TableColumns/ZoneAssignmentsColumns';\n\nconst HighlightedRowStyle = { backgroundColor: '#ff6f0057' };\n\nconst ConstantlyHighlightedRowStyle = { backgroundColor: '#f5f5dc' };\n\nfunction ZonesTableRow({ rowData, onUnlink, onContextMenu }) {\n  const assignmentZone = useAssignment(rowData.id);\n  const highlightZone = useHighlight([assignmentZone.id]);\n  const highlightZoneX = useHighlight(\n    [buildID(assignmentZone.id, 'X')].concat(assignmentZone.assigned.x || []),\n  );\n  const highlightZoneY = useHighlight(\n    [buildID(assignmentZone.id, 'Y')].concat(assignmentZone.assigned.y || []),\n  );\n\n  const assignmentSignal = useAssignment(rowData.tableMetaInfo.id);\n  const highlightSignalX = useHighlight(\n    [buildID(assignmentSignal.id, 'X')].concat(\n      assignmentSignal.assigned.x || [],\n      buildID(assignmentSignal.id, 'Crosshair'),\n    ),\n  );\n  const highlightSignalY = useHighlight(\n    [buildID(assignmentSignal.id, 'Y')].concat(\n      assignmentSignal.assigned.y || [],\n      buildID(assignmentSignal.id, 'Crosshair'),\n    ),\n  );\n\n  const [showUnlinkButtonZoneX, setShowUnlinkButtonZoneX] = useState(false);\n  const [showUnlinkButtonZoneY, setShowUnlinkButtonZoneY] = useState(false);\n  const [showUnlinkButtonSignalX, setShowUnlinkButtonSignalX] = useState(false);\n  const [showUnlinkButtonSignalY, setShowUnlinkButtonSignalY] = useState(false);\n\n  const rowSpanTags = useMemo(() => {\n    return {\n      rowSpan: rowData.tableMetaInfo.rowSpan,\n      style:\n        lodashGet(rowData, 'tableMetaInfo.hide', false) === true\n          ? { display: 'none' }\n          : null,\n    };\n  }, [rowData]);\n\n  const unlinkHandler = useCallback(\n    (e, isOnZoneLevel, axis) => {\n      // event handling here in case of unlink button clicked\n      if (e) {\n        e.stopPropagation();\n      }\n      onUnlink(rowData, isOnZoneLevel, rowData.tableMetaInfo.signalIndex, axis);\n      if (axis === 'x') {\n        if (isOnZoneLevel !== undefined) {\n          if (isOnZoneLevel) {\n            setShowUnlinkButtonZoneX(false);\n            assignmentZone.removeAll('x');\n          } else {\n            setShowUnlinkButtonSignalX(false);\n            assignmentSignal.removeAll('x');\n          }\n        } else {\n          setShowUnlinkButtonZoneX(false);\n          setShowUnlinkButtonSignalX(false);\n        }\n      } else if (axis === 'y') {\n        if (isOnZoneLevel !== undefined) {\n          if (isOnZoneLevel) {\n            setShowUnlinkButtonZoneY(false);\n            assignmentZone.removeAll('y');\n          } else {\n            setShowUnlinkButtonSignalY(false);\n            assignmentSignal.removeAll('y');\n          }\n        } else {\n          setShowUnlinkButtonZoneY(false);\n          setShowUnlinkButtonSignalY(false);\n        }\n      } else {\n        setShowUnlinkButtonZoneX(false);\n        assignmentZone.removeAll('x');\n        setShowUnlinkButtonSignalX(false);\n        assignmentSignal.removeAll('x');\n        setShowUnlinkButtonZoneY(false);\n        assignmentZone.removeAll('y');\n        setShowUnlinkButtonSignalY(false);\n        assignmentSignal.removeAll('y');\n      }\n    },\n    [assignmentSignal, assignmentZone, onUnlink, rowData],\n  );\n\n  const clickHandler = useCallback((e, assignment, axis) => {\n    e.stopPropagation();\n    assignment.onClick(axis);\n  }, []);\n\n  const onHoverZoneX = useMemo(() => {\n    return {\n      onMouseEnter: () => {\n        assignmentZone.onMouseEnter('x');\n        highlightZoneX.show();\n      },\n      onMouseLeave: () => {\n        assignmentZone.onMouseLeave('x');\n        highlightZoneX.hide();\n      },\n    };\n  }, [assignmentZone, highlightZoneX]);\n\n  const onHoverZoneY = useMemo(() => {\n    return {\n      onMouseEnter: () => {\n        assignmentZone.onMouseEnter('y');\n        highlightZoneY.show();\n      },\n      onMouseLeave: () => {\n        assignmentZone.onMouseLeave('y');\n        highlightZoneY.hide();\n      },\n    };\n  }, [assignmentZone, highlightZoneY]);\n\n  const onHoverSignalX = useMemo(() => {\n    return {\n      onMouseEnter: () => {\n        assignmentSignal.onMouseEnter('x');\n        highlightSignalX.show();\n      },\n      onMouseLeave: () => {\n        assignmentSignal.onMouseLeave('x');\n        highlightSignalX.hide();\n      },\n    };\n  }, [assignmentSignal, highlightSignalX]);\n\n  const onHoverSignalY = useMemo(() => {\n    return {\n      onMouseEnter: () => {\n        assignmentSignal.onMouseEnter('y');\n        highlightSignalY.show();\n      },\n      onMouseLeave: () => {\n        assignmentSignal.onMouseLeave('y');\n        highlightSignalY.hide();\n      },\n    };\n  }, [assignmentSignal, highlightSignalY]);\n\n  return (\n    <tr\n      onContextMenu={(e) => onContextMenu(e, rowData)}\n      style={\n        highlightZone.isActive || assignmentZone.isActive\n          ? HighlightedRowStyle\n          : lodashGet(\n              rowData,\n              'tableMetaInfo.isConstantlyHighlighted',\n              false,\n            ) === true\n          ? ConstantlyHighlightedRowStyle\n          : null\n      }\n      {...highlightZone.onHover}\n    >\n      <td {...rowSpanTags}>{rowData.tableMetaInfo.rowIndex + 1}</td>\n      <SignalDeltaColumn\n        rowData={rowData}\n        onHoverSignalX={onHoverSignalX}\n        onHoverSignalY={onHoverSignalY}\n      />\n      <SignalAssignmentsColumns\n        rowData={rowData}\n        assignmentSignal={assignmentSignal}\n        onHoverSignalX={onHoverSignalX}\n        onHoverSignalY={onHoverSignalY}\n        showUnlinkButtonSignalX={showUnlinkButtonSignalX}\n        showUnlinkButtonSignalY={showUnlinkButtonSignalY}\n        setShowUnlinkButtonSignalX={(show) => setShowUnlinkButtonSignalX(show)}\n        setShowUnlinkButtonSignalY={(show) => setShowUnlinkButtonSignalY(show)}\n        onClick={clickHandler}\n        onUnlink={unlinkHandler}\n        highlightSignalX={highlightSignalX}\n        highlightSignalY={highlightSignalY}\n      />\n      <ZoneAssignmentsColumns\n        rowData={rowData}\n        assignmentZone={assignmentZone}\n        onHoverZoneX={onHoverZoneX}\n        onHoverZoneY={onHoverZoneY}\n        showUnlinkButtonZoneX={showUnlinkButtonZoneX}\n        showUnlinkButtonZoneY={showUnlinkButtonZoneY}\n        setShowUnlinkButtonZoneX={(show) => setShowUnlinkButtonZoneX(show)}\n        setShowUnlinkButtonZoneY={(show) => setShowUnlinkButtonZoneY(show)}\n        rowSpanTags={rowSpanTags}\n        onClick={clickHandler}\n        onUnlink={unlinkHandler}\n        highlightZoneX={highlightZoneX}\n        highlightZoneY={highlightZoneY}\n      />\n      <ActionsColumn rowData={rowData} rowSpanTags={rowSpanTags} />\n    </tr>\n  );\n}\n\nexport default ZonesTableRow;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useMemo, useCallback, useRef } from 'react';\nimport { FaLink } from 'react-icons/fa';\n\nimport checkModifierKeyActivated from '../../../data/utilities/checkModifierKeyActivated';\nimport ContextMenu from '../../elements/ContextMenu';\n\nimport ZonesTableRow from './ZonesTableRow';\n\nconst tableStyle = css`\n  border-spacing: 0;\n  border: 1px solid #dedede;\n  width: 100%;\n  font-size: 12px;\n  // height: 100%;\n  .react-contextmenu-wrapper {\n    display: contents;\n  }\n  tr {\n    :last-child {\n      td {\n        border-bottom: 0;\n      }\n    }\n  }\n  thead tr:nth-of-type(1) th {\n    top: 0;\n  }\n  thead tr:nth-of-type(2) th {\n    top: 21px;\n  }\n  th {\n    position: sticky;\n    background-color: white;\n    z-index: 2;\n  }\n  th,\n  td {\n    white-space: nowrap;\n    text-align: center;\n    margin: 0;\n    padding: 0.1rem 0.4rem;\n    border-bottom: 1px solid #dedede;\n    border-right: 1px solid #dedede;\n\n    :last-child {\n      border-right: 0;\n    }\n    button {\n      background-color: transparent;\n      border: none;\n      padding: 0 5px;\n    }\n  }\n`;\n\nfunction ZonesTable({ tableData, onUnlink, context, nuclei, preferences }) {\n  const contextRef = useRef();\n\n  const contextMenuHandler = useCallback(\n    (e, rowData) => {\n      if (!checkModifierKeyActivated(e)) {\n        e.preventDefault();\n        contextRef.current.handleContextMenu(e, rowData);\n      }\n    },\n    [contextRef],\n  );\n\n  const data = useMemo(() => {\n    const _data = [];\n    tableData.forEach((zone, i) => {\n      if (zone.signal.length === 1) {\n        _data.push({\n          ...zone,\n          tableMetaInfo: {\n            ...zone.tableMetaInfo,\n            signal: zone.signal[0],\n            rowIndex: i,\n            signalIndex: 0,\n            id: zone.signal[0].id,\n          },\n        });\n      } else if (zone.signal.length > 1) {\n        zone.signal.forEach((signal, j) => {\n          let hide = false;\n          let rowSpan = null;\n          if (j < zone.signal.length - 1) {\n            if (j === 0) {\n              rowSpan = zone.signal.length;\n            } else {\n              hide = true;\n            }\n          } else {\n            hide = true;\n          }\n          _data.push({\n            ...zone,\n            tableMetaInfo: {\n              ...zone.tableMetaInfo,\n              signal,\n              rowSpan,\n              hide,\n              rowIndex: i,\n              signalIndex: j,\n              id: signal.id,\n            },\n          });\n        });\n      }\n    });\n\n    return _data;\n  }, [tableData]);\n\n  const rows = useMemo(\n    () =>\n      data.map((rowData) => (\n        <ZonesTableRow\n          key={`zonesTableRow_${rowData.tableMetaInfo.id}`}\n          rowData={rowData}\n          onUnlink={onUnlink}\n          onContextMenu={(e, rowData) => contextMenuHandler(e, rowData)}\n          preferences={preferences}\n        />\n      )),\n    [contextMenuHandler, data, onUnlink, preferences],\n  );\n\n  return (\n    <div>\n      <table css={tableStyle}>\n        <thead>\n          <tr>\n            <th rowSpan={2}>#</th>\n            <th colSpan={2}> (ppm)</th>\n            <th colSpan={2}>\n              <FaLink />\n            </th>\n            <th colSpan={2}></th>\n            <th rowSpan={2}>Kind</th>\n            <th rowSpan={2}>{''}</th>\n          </tr>\n          <tr>\n            <th>{nuclei[0]}</th>\n            <th>{nuclei[1]}</th>\n            <th>{nuclei[0]}</th>\n            <th>{nuclei[1]}</th>\n            <th>{nuclei[0]}</th>\n            <th>{nuclei[1]}</th>\n          </tr>\n        </thead>\n        <tbody>{rows}</tbody>\n      </table>\n      <ContextMenu ref={contextRef} context={context} />\n    </div>\n  );\n}\n\nexport default ZonesTable;\n","import lodashGet from 'lodash/get';\nimport { useState, useMemo, useCallback, useRef, memo } from 'react';\nimport ReactCardFlip from 'react-card-flip';\nimport { FaUnlink } from 'react-icons/fa';\n\nimport { useAssignmentData } from '../../assignment';\nimport { useDispatch } from '../../context/DispatchContext';\nimport ToggleButton from '../../elements/ToggleButton';\nimport ToolTip from '../../elements/ToolTip/ToolTip';\nimport { useModal } from '../../elements/popup/Modal';\nimport ZonesWrapper from '../../hoc/ZonesWrapper';\nimport { DELETE_2D_ZONE, UNLINK_ZONE } from '../../reducer/types/Types';\nimport Events from '../../utility/Events';\nimport NoTableData from '../extra/placeholder/NoTableData';\nimport DefaultPanelHeader from '../header/DefaultPanelHeader';\nimport PreferencesHeader from '../header/PreferencesHeader';\n\nimport ZonesPreferences from './ZonesPreferences';\nimport ZonesTable from './ZonesTable';\n\nconst styles = {\n  container: {\n    flexDirection: 'column',\n    height: '100%',\n    display: 'flex',\n  },\n  removeAssignmentsButton: {\n    borderRadius: '5px',\n    marginTop: '3px',\n    marginLeft: '2px',\n    border: 'none',\n    height: '16px',\n    width: '18px',\n    fontSize: '12px',\n    padding: 0,\n    backgroundColor: 'transparent',\n  },\n  button: {\n    backgroundColor: 'transparent',\n    border: 'none',\n  },\n  toggle: {\n    width: '22px',\n    height: '22px',\n    marginLeft: '2px',\n    display: 'flex',\n    justifyContent: 'center',\n    alignItems: 'center',\n  },\n};\n\nfunction ZonesPanel({ zones, activeTab, preferences, xDomain, yDomain }) {\n  const [filterIsActive, setFilterIsActive] = useState(false);\n\n  const assignmentData = useAssignmentData();\n\n  const dispatch = useDispatch();\n  const modal = useModal();\n  const [isFlipped, setFlipStatus] = useState(false);\n  const settingRef = useRef();\n\n  const tableData = useMemo(() => {\n    const isInView = (xFrom, xTo, yFrom, yTo) => {\n      const factor = 10000;\n      xFrom = xFrom * factor;\n      xTo = xTo * factor;\n      yFrom = yFrom * factor;\n      yTo = yTo * factor;\n      return (\n        ((xTo >= xDomain[0] * factor && xFrom <= xDomain[1] * factor) ||\n          (xFrom <= xDomain[0] * factor && xTo >= xDomain[1] * factor)) &&\n        ((yTo >= yDomain[0] * factor && yFrom <= yDomain[1] * factor) ||\n          (yFrom <= yDomain[0] * factor && yTo >= yDomain[1] * factor))\n      );\n    };\n\n    const getFilteredZones = (zones) => {\n      return zones.filter((zone) => {\n        return isInView(zone.x.from, zone.x.to, zone.y.from, zone.y.to);\n      });\n    };\n    if (zones.values) {\n      const _zones = filterIsActive\n        ? getFilteredZones(zones.values)\n        : zones.values;\n\n      return _zones.map((zone) => {\n        return {\n          ...zone,\n          tableMetaInfo: {\n            isConstantlyHighlighted: isInView(\n              zone.x.from,\n              zone.x.to,\n              zone.y.from,\n              zone.y.to,\n            ),\n          },\n        };\n      });\n    }\n  }, [zones, filterIsActive, xDomain, yDomain]);\n\n  const handleOnFilter = useCallback(() => {\n    setFilterIsActive(!filterIsActive);\n  }, [filterIsActive]);\n\n  const unlinkZoneHandler = useCallback(\n    (zoneData, isOnZoneLevel, signalIndex, axis) => {\n      dispatch({\n        type: UNLINK_ZONE,\n        payload: {\n          zoneData,\n          assignmentData,\n          isOnZoneLevel,\n          signalIndex,\n          axis,\n        },\n      });\n    },\n    [assignmentData, dispatch],\n  );\n\n  const removeAssignments = useCallback(() => {\n    zones.values.forEach((zone) => unlinkZoneHandler(zone));\n  }, [zones.values, unlinkZoneHandler]);\n\n  const handleOnRemoveAssignments = useCallback(() => {\n    modal.showConfirmDialog({\n      message: 'All assignments will be removed. Are you sure?',\n      buttons: [{ text: 'Yes', handler: removeAssignments }, { text: 'No' }],\n    });\n  }, [removeAssignments, modal]);\n\n  const handleDeleteAll = useCallback(() => {\n    modal.showConfirmDialog({\n      message: 'All zones will be deleted. Are You sure?',\n      buttons: [\n        {\n          text: 'Yes',\n          handler: () => {\n            dispatch({ type: DELETE_2D_ZONE, payload: { assignmentData } });\n          },\n        },\n        { text: 'No' },\n      ],\n    });\n  }, [assignmentData, dispatch, modal]);\n\n  const zonesPreferences = useMemo(() => {\n    const _preferences = lodashGet(preferences, `panels.zones.[${activeTab}]`);\n\n    return _preferences;\n  }, [activeTab, preferences]);\n\n  const settingsPanelHandler = useCallback(() => {\n    setFlipStatus(!isFlipped);\n  }, [isFlipped]);\n\n  const saveSettingHandler = useCallback(() => {\n    settingRef.current.saveSetting();\n    setFlipStatus(false);\n  }, []);\n\n  const visibilityHandler = useCallback((key) => {\n    Events.emit('onZonesVisibilityChange', { key });\n  }, []);\n\n  return (\n    <>\n      <div style={styles.container}>\n        {!isFlipped && (\n          <DefaultPanelHeader\n            counter={zones.values ? zones.values.length : 0}\n            onDelete={handleDeleteAll}\n            deleteToolTip=\"Delete All Zones\"\n            onFilter={handleOnFilter}\n            filterToolTip={\n              filterIsActive ? 'Show all zones' : 'Hide zones out of view'\n            }\n            filterIsActive={filterIsActive}\n            counterFiltered={tableData && tableData.length}\n            showSettingButton=\"true\"\n            onSettingClick={settingsPanelHandler}\n          >\n            <ToolTip title={`Remove all Assignments`} popupPlacement=\"right\">\n              <button\n                style={styles.removeAssignmentsButton}\n                type=\"button\"\n                onClick={handleOnRemoveAssignments}\n                disabled={!zones.values || zones.values.length === 0}\n              >\n                <FaUnlink />\n              </button>\n            </ToolTip>\n            <ToggleButton\n              popupTitle=\"show/hide zones\"\n              popupPlacement=\"right\"\n              style={styles.toggle}\n              defaultValue\n              onClick={() => visibilityHandler('zones')}\n            >\n              <span style={{ fontSize: '12px', pointerEvents: 'none' }}>z</span>\n            </ToggleButton>\n            <ToggleButton\n              popupTitle=\"show/hide signals\"\n              popupPlacement=\"right\"\n              style={styles.toggle}\n              defaultValue\n              onClick={() => visibilityHandler('signals')}\n            >\n              <span style={{ fontSize: '12px', pointerEvents: 'none' }}>s</span>\n            </ToggleButton>\n            <ToggleButton\n              popupTitle=\"show/hide peaks\"\n              popupPlacement=\"right\"\n              style={styles.toggle}\n              defaultValue\n              onClick={() => visibilityHandler('peaks')}\n            >\n              <span style={{ fontSize: '12px', pointerEvents: 'none' }}>p</span>\n            </ToggleButton>\n          </DefaultPanelHeader>\n        )}\n        {isFlipped && (\n          <PreferencesHeader\n            onSave={saveSettingHandler}\n            onClose={settingsPanelHandler}\n          />\n        )}\n        <div style={{ height: '100%', overflow: 'hidden' }}>\n          <ReactCardFlip\n            isFlipped={isFlipped}\n            infinite\n            containerStyle={{ overflow: 'hidden', height: '100%' }}\n          >\n            <div style={{ overflow: 'auto', height: '100%', display: 'block' }}>\n              {tableData && tableData.length > 0 ? (\n                <ZonesTable\n                  tableData={tableData}\n                  onUnlink={unlinkZoneHandler}\n                  preferences={zonesPreferences}\n                  nuclei={\n                    activeTab && activeTab.split(',').length === 2\n                      ? activeTab.split(',')\n                      : ['?', '?']\n                  }\n                />\n              ) : (\n                <NoTableData />\n              )}\n            </div>\n            <ZonesPreferences ref={settingRef} />\n          </ReactCardFlip>\n        </div>\n      </div>\n    </>\n  );\n}\n\nexport default ZonesWrapper(memo(ZonesPanel));\n","import { memo } from 'react';\n\nconst styles = {\n  width: '100%',\n  height: '100%',\n  padding: '0px',\n  display: 'flex',\n  flexDirection: 'column',\n};\nfunction Table({ children, className, style }) {\n  return (\n    <div className={className} style={{ ...styles, ...style }}>\n      {children}\n    </div>\n  );\n}\n\nexport default memo(Table);\n","import { useMemo, memo, Children, cloneElement } from 'react';\n\nconst styles = {\n  width: '100%',\n  overflowY: 'auto',\n  display: 'flex',\n  flexDirection: 'column',\n  padding: '5px 0px',\n  color: 'gray',\n};\nfunction TableBody({ children, className, style }) {\n  const mappedChildren = useMemo(() => {\n    return Children.map(children, (child) =>\n      cloneElement(child, {\n        style: { borderBottom: '0.55px solid #d8d8d8', ...child.props.style },\n      }),\n    );\n  }, [children]);\n\n  return (\n    <div className={className} style={{ ...styles, style }}>\n      {mappedChildren}\n    </div>\n  );\n}\n\nexport default memo(TableBody);\n","import { memo } from 'react';\n\nconst styles = {\n  width: '100%',\n  display: 'flex',\n  alignItems: 'flex-start',\n};\n\nfunction getVAlign(align) {\n  if (align.toLowerCase() === 'top') {\n    return 'flex-start';\n  } else if (align.toLowerCase() === 'bottom') {\n    return 'flex-end';\n  }\n  return 'center';\n}\nfunction TableHeader({\n  children,\n  className,\n  style,\n  align = 'center',\n  vAlign = 'center',\n  size = 1,\n  onClick,\n}) {\n  return (\n    <div\n      className={className}\n      style={{\n        ...styles,\n        alignItems: getVAlign(vAlign),\n        textAlign: align,\n        flex: size,\n        ...style,\n      }}\n      onClick={onClick}\n    >\n      {children}\n    </div>\n  );\n}\n\nTableHeader.defaultProps = {\n  onClick: () => null,\n};\n\nexport default memo(TableHeader);\n","import { memo } from 'react';\n\nconst styles = {\n  width: '100%',\n  display: 'flex',\n  padding: '0px 5px',\n  color: '#424242',\n  backgroundColor: '#d8d8d8',\n  borderBottom: '0.55px solid #d8d8d8',\n  fontSize: 11,\n  fontWeight: 'bold',\n};\nfunction TableHead({ children, className, style }) {\n  return (\n    <div className={className} style={{ ...styles, ...style }}>\n      {children}\n    </div>\n  );\n}\n\nexport default memo(TableHead);\n","import { memo } from 'react';\n\nconst styles = {\n  width: '100%',\n  display: 'flex',\n  padding: '5px 0px',\n};\nfunction TableHeader({ children, className, style, onClick }) {\n  return (\n    <div\n      className={className}\n      style={{ ...styles, ...style }}\n      onClick={onClick}\n    >\n      {children}\n    </div>\n  );\n}\n\nTableHeader.defaultProps = {\n  onClick: () => null,\n};\n\nexport default memo(TableHeader);\n","import { forwardRef, useMemo } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\n\nfunction FiltersWrapper(WrappedComponent) {\n  const Wrapper = (props) => {\n    const { data, activeSpectrum } = useChartData();\n\n    const { filters = [] } = useMemo(() => {\n      if (data && activeSpectrum && activeSpectrum.id) {\n        const datum = data.find((datum) => datum.id === activeSpectrum.id) || {\n          filters: [],\n        };\n        return datum;\n      }\n      return {};\n    }, [activeSpectrum, data]);\n    const { forwardedRef, ...rest } = props;\n    return <WrappedComponent {...rest} filters={filters} ref={forwardedRef} />;\n  };\n\n  return forwardRef((props, ref) => {\n    return <Wrapper {...props} forwardedRef={ref} />;\n  });\n}\nexport default FiltersWrapper;\n","import { useMemo, useCallback, memo, useState } from 'react';\nimport { FaRegTrashAlt } from 'react-icons/fa';\nimport { ObjectInspector } from 'react-inspector';\n\nimport { useDispatch } from '../../context/DispatchContext';\nimport CheckBox from '../../elements/CheckBox';\nimport { TableCell, TableRow } from '../../elements/Table';\nimport { useAlert } from '../../elements/popup/Alert';\nimport { useModal } from '../../elements/popup/Modal';\nimport {\n  ENABLE_FILTER,\n  DELETE_FILTER,\n  SET_FILTER_SNAPSHOT,\n  DELETE_SPECTRA_FILTER,\n} from '../../reducer/types/Types';\n\nconst styles = {\n  button: {\n    backgroundColor: 'transparent',\n    border: 'none',\n    height: 25,\n    width: 25,\n    padding: '5px',\n  },\n  active: {\n    backgroundColor: '#fbfbfb',\n    borderTop: '1px solid #817066',\n    borderBottom: '1px solid #817066',\n  },\n};\nfunction FiltersTableRow({ filters }) {\n  const dispatch = useDispatch();\n  const modal = useModal();\n  const alert = useAlert();\n  const [selectedFilterID, setSelectedFilter] = useState();\n\n  const handelFilterCheck = useCallback(\n    async (id, checked) => {\n      const hideLoading = await alert.showLoading(\n        `${checked ? 'Enable' : 'Disable'} filter in progress`,\n      );\n      setTimeout(() => {\n        dispatch({ type: ENABLE_FILTER, id, checked });\n        hideLoading();\n      }, 0);\n    },\n    [alert, dispatch],\n  );\n  const handelDeleteFilter = useCallback(\n    ({ id, name }) => {\n      modal.showConfirmDialog({\n        message: 'Filter/s will be deleted, Are You sure?',\n        buttons: [\n          {\n            text: 'Yes,All spectra',\n            handler: async () => {\n              const hideLoading = await alert.showLoading(\n                'Delete all spectra filter processs in progress',\n              );\n              dispatch({\n                type: DELETE_SPECTRA_FILTER,\n                payload: { filterType: name },\n              });\n              hideLoading();\n            },\n          },\n          {\n            text: 'Yes ',\n            handler: async () => {\n              const hideLoading = await alert.showLoading(\n                'Delete filter processs in progress',\n              );\n              dispatch({ type: DELETE_FILTER, payload: { id } });\n              hideLoading();\n            },\n          },\n          { text: 'No' },\n        ],\n      });\n    },\n    [alert, dispatch, modal],\n  );\n  const filterSnapShotHandler = useCallback(\n    async (newID) => {\n      const hideLoading = await alert.showLoading(\n        'Filter snapshot processs in progress',\n      );\n      setTimeout(() => {\n        setSelectedFilter((prevId) => {\n          const id = prevId === newID ? null : newID;\n          dispatch({ type: SET_FILTER_SNAPSHOT, id });\n          return id;\n        });\n        hideLoading();\n      }, 0);\n    },\n    [alert, dispatch],\n  );\n  const filtersTableRow = useMemo(() => {\n    return (\n      filters &&\n      filters.map((d) => (\n        <TableRow\n          key={d.id}\n          style={d.id === selectedFilterID ? { ...styles.active } : {}}\n        >\n          <TableCell\n            align=\"center\"\n            size=\"2\"\n            onClick={() => filterSnapShotHandler(d.id)}\n          >\n            {d.label}\n          </TableCell>\n          <TableCell align=\"left\" size=\"3\">\n            <div onClick={(e) => e.stopPropagation()}>\n              <ObjectInspector data={d.error ? d.error : d.value} />\n            </div>\n          </TableCell>\n          <TableCell align=\"center\" vAlign=\"center\" size=\"1\">\n            <CheckBox\n              checked={d.flag}\n              onChange={(event) =>\n                handelFilterCheck(d.id, event.target.checked)\n              }\n            />\n            {d.isDeleteAllow && (\n              <button\n                style={styles.button}\n                type=\"button\"\n                onClick={() => handelDeleteFilter(d)}\n              >\n                <FaRegTrashAlt />\n              </button>\n            )}\n          </TableCell>\n        </TableRow>\n      ))\n    );\n  }, [\n    filterSnapShotHandler,\n    filters,\n    handelDeleteFilter,\n    handelFilterCheck,\n    selectedFilterID,\n  ]);\n  return filtersTableRow;\n}\n\nexport default memo(FiltersTableRow);\n","import { useMemo, memo } from 'react';\n\nimport {\n  Table,\n  TableHead,\n  TableCell,\n  TableBody,\n  TableRow,\n} from '../../elements/Table';\nimport FiltersWrapper from '../../hoc/FiltersWrapper';\nimport NoTableData from '../extra/placeholder/NoTableData';\n\nimport FiltersTableRow from './FiltersTableRow';\n\nfunction FilterPanel({ filters }) {\n  const filtersTable = useMemo(() => {\n    return filters ? (\n      <Table>\n        <TableHead>\n          <TableRow>\n            <TableCell align=\"center\" size=\"1\">\n              Label\n            </TableCell>\n            <TableCell align=\"center\" size=\"2\">\n              Properties\n            </TableCell>\n          </TableRow>\n        </TableHead>\n        <TableBody>\n          <FiltersTableRow filters={filters} />\n        </TableBody>\n      </Table>\n    ) : (\n      <NoTableData />\n    );\n  }, [filters]);\n\n  return filtersTable;\n}\n\nexport default FiltersWrapper(memo(FilterPanel));\n","import lodashGet from 'lodash/get';\nimport { useCallback, useState, useEffect, memo } from 'react';\n\nimport { usePreferences } from '../context/PreferencesContext';\nimport { Accordion, AccordionItem } from '../elements/accordion';\nimport { DISPLAYER_MODE } from '../reducer/core/Constants';\nimport { options } from '../toolbar/ToolTypes';\n\nimport InformationPanel from './InformationPanel';\nimport IntegralPanel from './IntegralsPanel/IntegralPanel';\nimport MoleculePanel from './MoleculesPanel/MoleculePanel';\nimport MultipleSpectraAnalysisPanel from './MultipleSpectraAnalysisPanel/MultipleSpectraAnalysisPanel';\nimport PeaksPanel from './PeaksPanel/PeaksPanel';\nimport RangesPanel from './RangesPanel/RangesPanel';\nimport SpectrumListPanel from './SpectrumsPanel/SpectrumListPanel';\nimport SummaryPanel from './SummaryPanel/SummaryPanel';\nimport ZonesPanel from './ZonesPanel/ZonesPanel';\nimport FilterPanel from './filtersPanel/FilterPanel';\n\nconst accordionItems = [\n  {\n    title: 'Spectra',\n    component: <SpectrumListPanel />,\n    openWhen: null,\n    style: '',\n    hidePreferenceKey: 'hideSpectraPanel',\n    mode: null,\n  },\n  {\n    title: 'Information',\n    component: <InformationPanel />,\n    openWhen: null,\n    style: { overflow: 'hidden' },\n    hidePreferenceKey: 'hideInformationPanel',\n    mode: null,\n  },\n  {\n    title: 'Peaks',\n    component: <PeaksPanel />,\n    openWhen: [options.peakPicking.id],\n    style: '',\n    hidePreferenceKey: 'hidePeaksPanel',\n    mode: null,\n  },\n  {\n    title: 'Filters',\n    component: <FilterPanel />,\n    openWhen: null,\n    style: '',\n    hidePreferenceKey: 'hideFiltersPanel',\n    mode: null,\n  },\n  {\n    title: 'Integrals',\n    component: <IntegralPanel />,\n    openWhen: [options.integral.id],\n    style: '',\n    hidePreferenceKey: 'hideIntegralsPanel',\n    mode: null,\n  },\n  {\n    title: 'Ranges',\n    component: <RangesPanel />,\n    openWhen: [options.rangesPicking.id],\n    style: '',\n    hidePreferenceKey: 'hideRangesPanel',\n    mode: DISPLAYER_MODE.DM_1D,\n  },\n  {\n    title: 'Multiple Spectra Analysis',\n    component: <MultipleSpectraAnalysisPanel />,\n    openWhen: [options.multipleSpectraAnalysis.id],\n    style: '',\n    hidePreferenceKey: 'hideMultipleSpectraAnalysisPanel',\n    mode: null,\n  },\n  {\n    title: 'Zones',\n    component: <ZonesPanel />,\n    openWhen: [options.zone2D.id],\n    style: '',\n    hidePreferenceKey: 'hideZonesPanel',\n    mode: DISPLAYER_MODE.DM_2D,\n  },\n  {\n    title: 'Summary',\n    component: <SummaryPanel />,\n    openWhen: [],\n    style: '',\n    hidePreferenceKey: 'hideSummaryPanel',\n    mode: null,\n  },\n  {\n    title: 'Structures',\n    component: <MoleculePanel />,\n    openWhen: [options.rangesPicking.id],\n    style: '',\n    hidePreferenceKey: 'hideStructuresPanel',\n    mode: null,\n  },\n];\n\nfunction Panels({ selectedTool, displayerMode }) {\n  const [panelIndex, setSelectedPanelIndex] = useState(0);\n  const preferences = usePreferences();\n\n  useEffect(() => {\n    function getDefaultIndex() {\n      const index = accordionItems.findIndex(\n        (item) => item.openWhen && item.openWhen.includes(selectedTool),\n      );\n      return index !== -1 ? index : null;\n    }\n    const index = getDefaultIndex();\n    if (selectedTool) {\n      setSelectedPanelIndex(index);\n    }\n  }, [selectedTool]);\n\n  const check = useCallback(\n    (item) => {\n      return (\n        !lodashGet(preferences, `display.panels.${item.hidePreferenceKey}`) &&\n        (item.mode == null || item.mode === displayerMode)\n      );\n    },\n    [displayerMode, preferences],\n  );\n\n  return (\n    <Accordion defaultOpenIndex={panelIndex}>\n      {accordionItems.map((item) => {\n        return (\n          check(item) && (\n            <AccordionItem\n              key={item.title}\n              title={item.title}\n              style={item.style}\n            >\n              {item.component}\n            </AccordionItem>\n          )\n        );\n      })}\n    </Accordion>\n  );\n}\n\nexport default memo(Panels);\n","import * as types from './types/Types';\n\nconst ignoreActions = [\n  types.APPLY_KEY_PREFERENCES,\n  types.BRUSH_END,\n  types.RESET_DOMAIN,\n  types.RESET_SELECTED_TOOL,\n  types.SET_KEY_PREFERENCES,\n  types.SET_LOADING_FLAG,\n  types.SET_ORIGINAL_DOMAIN,\n  types.SET_SELECTED_FILTER,\n  types.SET_SELECTED_OPTIONS_PANEL,\n  types.SET_SELECTED_TOOL,\n  types.SET_SPECTRUMS_VERTICAL_ALIGN,\n  types.SET_VERTICAL_INDICATOR_X_POSITION,\n  types.SET_WIDTH,\n  types.SET_DIMENSIONS,\n  types.SET_X_DOMAIN,\n  types.SET_Y_DOMAIN,\n  types.SET_ZOOM_FACTOR,\n  types.TOGGLE_REAL_IMAGINARY_VISIBILITY,\n  types.CALCULATE_MANUAL_PHASE_CORRECTION_FILTER,\n  types.CHANGE_SPECTRUM_DISPLAY_VIEW_MODE,\n  types.FULL_ZOOM_OUT,\n  types.SAVE_AS_SVG,\n  types.SAVE_DATA_AS_JSON,\n  types.SET_ACTIVE_TAB,\n  types.CHANGE_VISIBILITY,\n  types.CHANGE_PEAKS_MARKERS_VISIBILITY,\n  types.CHANGE_ACTIVE_SPECTRUM,\n  types.CHANGE_INTEGRAL_ZOOM,\n  types.CHANGE_SPECTRUM_COLOR,\n];\n\nfunction checkActionType(type: string): boolean {\n  if (!ignoreActions.includes(type)) return true;\n  return false;\n}\n\nexport default checkActionType;\n","import { mapRanges } from '../../../../data/data1d/Datum1D';\n\nexport function addRanges(signals, datum) {\n  let ranges = [];\n  const { baseFrequency: frequency = 500 } = datum;\n  for (const signal of signals) {\n    const { jCoupling: j, delta, diaID = [], multiplicity, integral } = signal;\n    const fromTo = computeFromTo({ delta, j, frequency });\n    ranges.push({\n      ...fromTo,\n      integral,\n      signal: [\n        {\n          j,\n          delta,\n          diaID,\n          multiplicity,\n        },\n      ],\n    });\n  }\n  datum.ranges.values = mapRanges(joinRanges(ranges), datum);\n}\n\nfunction computeFromTo(options = {}) {\n  const { delta, j: couplings = [], frequency } = options;\n  let width = 0.5;\n  for (let j of couplings) {\n    width += j.coupling;\n  }\n  width /= frequency;\n  return { from: delta - width, to: delta + width };\n}\n\nfunction joinRanges(ranges) {\n  ranges.sort((a, b) => a.from - b.from);\n  for (let i = 0; i < ranges.length - 1; i++) {\n    if (ranges[i].to > ranges[i + 1].from) {\n      ranges[i].to = Math.max(ranges[i + 1].to, ranges[i].to);\n      ranges[i].signal = ranges[i].signal.concat(ranges[i + 1].signal);\n      ranges[i].integral += ranges[i + 1].integral;\n      ranges.splice(i + 1, 1);\n      i--;\n    }\n  }\n  return ranges;\n}\n","import { getShift } from '../../../../data/data2d/Datum2D';\nimport generateID from '../../../../data/utilities/generateID';\n\nconst axisLabels = ['x', 'y'];\n\nexport function addZones(signals, datum) {\n  let zones = [];\n  const shift = getShift(datum);\n  const { baseFrequency } = datum.info;\n  const frequency = { x: baseFrequency[0], y: baseFrequency[1] };\n\n  for (const signal of signals) {\n    let zone = { x: {}, y: {}, id: generateID(), kind: 'signal' };\n    let signalFormated = { id: generateID(), kind: 'signal', peak: [] };\n    let width = { x: 10, y: 10 };\n    for (let axis of axisLabels) {\n      let { coupling = [], delta, diaID = [] } = signal[axis];\n      for (let j of coupling) {\n        width[axis] += j.coupling;\n      }\n      if (signal.activeCoupling) {\n        const { activeCoupling = [] } = signal;\n        for (let j of activeCoupling) {\n          width[axis] += j.coupling;\n        }\n      }\n      width[axis] /= frequency[axis];\n\n      zone[axis] = {\n        from: delta - width[axis],\n        to: delta + width[axis],\n      };\n\n      signalFormated[axis] = {\n        delta,\n        diaID,\n        originDelta: delta - shift[`${axis}Shift`],\n      };\n    }\n    zones.push({\n      ...zone,\n      signal: [signalFormated],\n    });\n  }\n  datum.zones.values = zones;\n}\n","import Jszip from 'jszip';\nimport { NmrRecord, parseSDF } from 'nmredata';\n\nimport { addBruker, addJcamps } from '../../data/SpectraManager';\n\nimport { addRanges } from './util/nmredata/addRanges';\nimport { addZones } from './util/nmredata/addZones';\n\nexport async function nmredataToNmrium(file) {\n  const jszip = new Jszip();\n  const zip = await jszip.loadAsync(file.binary);\n  const sdfFiles = await getSDF(zip.files);\n  const jsonData = await NmrRecord.toJSON({\n    sdf: sdfFiles[0],\n    zipFiles: zip.files,\n  });\n\n  let { spectra, molecules = [] } = jsonData;\n\n  let nmrium = {\n    spectra: [],\n    molecules,\n  };\n\n  for (const data of spectra) {\n    const { file, jcampURL } = data.source;\n\n    let spectrum = await getSpectra(file, { jcampURL });\n\n    for (let i = 0; i < spectrum.length; i++) {\n      const { info } = spectrum[i];\n\n      if (info.isFid) continue;\n\n      if (info.dimension > 1) {\n        addZones(data.signals, spectrum[i]);\n      } else {\n        addRanges(data.signals, spectrum[i]);\n      }\n    }\n    nmrium.spectra.push(...spectrum);\n  }\n\n  return nmrium;\n}\n\nasync function getSpectra(file, options = {}) {\n  const {\n    xy = true,\n    noContours = true,\n    keepOriginal = true,\n    jcampURL,\n  } = options;\n  switch (file.extension) {\n    case 'jdx':\n    case 'dx':\n      return addJcamps([file]);\n    case 'zip':\n      return addBruker({ xy, noContours, keepOriginal }, file.binary);\n    default:\n      if (!jcampURL) {\n        new Error('file extension is not supported');\n        return;\n      }\n  }\n}\n\nasync function getSDF(zipFiles) {\n  let result = [];\n  for (const file in zipFiles) {\n    const pathFile = file.split('/');\n    if (pathFile[pathFile.length - 1].match(/^[^.].+sdf$/)) {\n      const filename = pathFile[pathFile.length - 1].replace(/\\.sdf/, '');\n      const root = pathFile.slice(0, pathFile.length - 1).join('/');\n      const sdf = await zipFiles[file].async('string');\n      let parserResult = parseSDF(`${sdf}`, { mixedEOL: true });\n      parserResult.filename = filename;\n      parserResult.root = root !== '' ? `${root}/` : '';\n      result.push(parserResult);\n    }\n  }\n  return result;\n}\n","import { original, Draft } from 'immer';\nimport lodashCloneDeep from 'lodash/cloneDeep';\nimport { buildCorrelationData, setCorrelation, Types } from 'nmr-correlation';\n\nimport { State } from '../Reducer';\n\nfunction handleUpdateCorrelations(draft: Draft<State>) {\n  const { data: spectra, correlations } = draft;\n  draft.correlations = buildCorrelationData(spectra as Types.Spectra, {\n    ...correlations.options,\n    values: lodashCloneDeep(correlations.values),\n  });\n}\n\nfunction handleSetMF(draft: Draft<State>, payload: { mf: string }) {\n  const state = original(draft) as State;\n  const { data: spectra, correlations } = state;\n  const { mf } = payload;\n  // update of correlation data is needed only if the following is true\n  if (correlations.options.mf === '' || correlations.options.mf !== mf) {\n    draft.correlations = buildCorrelationData(spectra as Types.Spectra, {\n      ...correlations.options,\n      mf,\n      values: lodashCloneDeep(correlations.values),\n    });\n  }\n}\n\nfunction handleSetTolerance(\n  draft: Draft<State>,\n  payload: { tolerance: Types.Tolerance },\n) {\n  const state = original(draft) as State;\n  const { data: spectra, correlations } = state;\n  const { tolerance } = payload;\n  draft.correlations = buildCorrelationData(spectra as Types.Spectra, {\n    ...correlations.options,\n    tolerance,\n    values: lodashCloneDeep(correlations.values),\n  });\n}\n\nfunction handleSetCorrelation(\n  draft: Draft<State>,\n  payload: { id: string; correlation: Types.Correlation },\n) {\n  const state = original(draft) as State;\n  const { correlations } = state;\n  const { id, correlation } = payload;\n  draft.correlations = setCorrelation(correlations, id, correlation);\n  handleUpdateCorrelations(draft);\n}\n\nfunction handleSetCorrelations(\n  draft: Draft<State>,\n  payload: { ids: Array<string>; correlations: Types.Values },\n) {\n  const { ids, correlations } = payload;\n  ids.forEach((id, i) => {\n    const { correlations: correlationsData } = draft;\n    draft.correlations = setCorrelation(correlationsData, id, correlations[i]);\n  });\n  handleUpdateCorrelations(draft);\n}\n\nexport {\n  handleUpdateCorrelations,\n  handleSetCorrelation,\n  handleSetCorrelations,\n  handleSetMF,\n  handleSetTolerance,\n};\n","import { extent } from 'd3';\nimport { Draft } from 'immer';\nimport { xyIntegral } from 'ml-spectra-processing';\n\nimport { Datum1D } from '../../../data/data1d/Datum1D';\nimport { Datum2D } from '../../../data/data2d/Datum2D';\nimport GroupByInfoKey from '../../utility/GroupByInfoKey';\nimport { State } from '../Reducer';\nimport { DISPLAYER_MODE } from '../core/Constants';\n\nfunction getActiveData(draft: Draft<State>) {\n  if (draft.activeTab) {\n    const groupByNucleus = GroupByInfoKey('nucleus');\n    let data = groupByNucleus(draft.data)[draft.activeTab];\n    if (draft.displayerMode === DISPLAYER_MODE.DM_2D) {\n      return data;\n    } else {\n      if (draft.activeSpectrum && data) {\n        const activeSpectrumIndex = data.findIndex(\n          (datum) => datum.id === draft.activeSpectrum.id,\n        );\n        if (activeSpectrumIndex !== -1) {\n          const isFid = data[activeSpectrumIndex].info.isFid || false;\n          data = data.filter((datum) => datum.info.isFid === isFid);\n        }\n      } else {\n        data = data ? data.filter((datum) => datum.info.isFid === false) : [];\n      }\n\n      for (let datum of draft.data) {\n        if (data.some((activeData: any) => activeData.id === datum.id)) {\n          // AnalysisObj.getDatum(datum.id).isVisibleInDomain = true;\n          (datum as Datum2D | Datum1D).display.isVisibleInDomain = true;\n        } else {\n          // AnalysisObj.getDatum(datum.id).isVisibleInDomain = false;\n          (datum as Datum2D | Datum1D).display.isVisibleInDomain = false;\n        }\n      }\n      return draft.data;\n    }\n  } else {\n    return draft.data;\n  }\n}\n\nfunction getDomain(data) {\n  let xArray = [];\n  let yArray = [];\n  let yDomains = {};\n  let xDomains = {};\n  let integralYDomain = {};\n  try {\n    xArray = data.reduce((acc, d: Datum1D) => {\n      const { display, data } = d;\n      if (display.isVisibleInDomain) {\n        const domain = [data.x[0], data.x[data.x.length - 1]];\n        xDomains[d.id] = domain;\n        if (display.isVisible) {\n          acc = acc.concat(domain);\n        }\n        return acc;\n      } else {\n        return acc.concat([]);\n      }\n    }, []);\n\n    yArray = data.reduce((acc, d: Datum1D) => {\n      const { display, data, integrals } = d;\n      if (display.isVisibleInDomain) {\n        const _extent = extent(data.y);\n        yDomains[d.id] = _extent;\n        if (integrals.values && integrals.values.length > 0) {\n          const values = integrals.values;\n          const { from = 0, to = 0 } = values[0];\n          const { x, y } = data;\n          const integralResult = xyIntegral(\n            { x: x, y: y },\n            {\n              from: from,\n              to: to,\n              reverse: true,\n            },\n          );\n          integralYDomain[d.id] = extent(integralResult.y);\n        }\n        if (display.isVisible) {\n          acc = acc.concat(_extent);\n        }\n        return acc;\n      } else {\n        return acc.concat([]);\n      }\n    }, []);\n  } catch (e) {\n    // eslint-disable-next-line no-console\n    console.log(e);\n  }\n\n  return {\n    xDomain: extent(xArray),\n    yDomain: extent(yArray),\n    yDomains,\n    xDomains,\n    integralYDomain,\n  };\n}\nfunction get2DDomain(state) {\n  let xArray = [];\n  let yArray = [];\n  let yDomains = {};\n  let xDomains = {};\n\n  const { activeTab, tabActiveSpectrum, data } = state;\n\n  const nucleus = activeTab.split(',');\n\n  try {\n    xArray = data.reduce((acc, datum: Datum1D | Datum2D) => {\n      if (\n        datum.info.dimension === 2 &&\n        datum.info.nucleus?.join(',') === activeTab &&\n        datum.info.isFt\n      ) {\n        acc = acc.concat([\n          (datum as Datum2D).data.minX,\n          (datum as Datum2D).data.maxX,\n        ]);\n      }\n      return acc;\n    }, []);\n\n    yArray = data.reduce((acc, datum: Datum1D | Datum2D) => {\n      if (\n        datum.info.dimension === 2 &&\n        datum.info.nucleus?.join(',') === activeTab &&\n        datum.info.isFt\n      ) {\n        acc = acc.concat([\n          (datum as Datum2D).data.minY,\n          (datum as Datum2D).data.maxY,\n        ]);\n      }\n      return acc;\n    }, []);\n  } catch (e) {\n    // eslint-disable-next-line no-console\n    console.log(e);\n  }\n\n  const spectrumsIDs = nucleus.map((n) => tabActiveSpectrum[n]?.id);\n\n  const filteredData = data.reduce((acc, datum: Datum1D | Datum2D) => {\n    return spectrumsIDs.includes(datum.id) && datum.info.dimension === 1\n      ? acc.concat(datum)\n      : acc.concat([]);\n  }, []);\n  try {\n    xDomains = filteredData.reduce((acc, d: Datum1D) => {\n      const { x } = d.data;\n      const domain = [x[0], x[x.length - 1]];\n      acc[d.id] = domain;\n      return acc;\n    }, {});\n\n    yDomains = filteredData.reduce((acc, d: Datum1D) => {\n      const _extent = extent(d.data.y);\n      acc[d.id] = _extent;\n      return acc;\n    }, {});\n  } catch (e) {\n    // eslint-disable-next-line no-console\n    console.log(e);\n  }\n\n  return {\n    xDomain: extent(xArray),\n    yDomain: extent(yArray),\n    yDomains,\n    xDomains,\n  };\n}\n\nfunction setDomain(draft: Draft<State>, isYDomainChanged = true) {\n  let domain;\n  const data = getActiveData(draft);\n\n  if (\n    draft.activeTab &&\n    [DISPLAYER_MODE.DM_1D, DISPLAYER_MODE.DM_2D].includes(draft.displayerMode)\n  ) {\n    domain =\n      draft.displayerMode === DISPLAYER_MODE.DM_1D\n        ? getDomain(data)\n        : get2DDomain(draft);\n    draft.xDomain = domain.xDomain;\n    draft.xDomains = domain.xDomains;\n    if (isYDomainChanged) {\n      draft.yDomain = domain.yDomain;\n\n      if (draft.displayerMode === DISPLAYER_MODE.DM_1D) {\n        draft.yDomains = Object.keys(domain.yDomains).reduce((acc, key) => {\n          acc[key] = domain.yDomain;\n          return acc;\n        }, {});\n        draft.originDomain = {\n          ...domain,\n          yDomains: draft.yDomains,\n          originYDomains: domain.yDomains,\n        };\n      } else {\n        draft.yDomains = domain.yDomains;\n        draft.originDomain = domain;\n      }\n\n      draft.integralsYDomains =\n        domain.integralYDomain && domain.integralYDomain;\n      draft.originIntegralYDomain =\n        domain.integralYDomain && domain.integralYDomain;\n    } else {\n      draft.originDomain = {\n        ...draft.originDomain,\n        xDomain: domain.xDomain,\n        xDomains: domain.xDomains,\n      };\n    }\n  }\n}\n\nfunction setOriginalDomain(draft: Draft<State>, originDomain) {\n  draft.originDomain = originDomain;\n}\n\nfunction setXDomain(draft: Draft<State>, xDomain) {\n  draft.xDomain = xDomain;\n}\n\nfunction setYDomain(draft: Draft<State>, yDomain) {\n  draft.yDomain = yDomain;\n}\n\nfunction handelResetDomain(draft: Draft<State>) {\n  const { xDomain, yDomain, xDomains, yDomains } = draft.originDomain;\n  draft.xDomain = xDomain;\n  draft.yDomain = yDomain;\n  draft.xDomains = xDomains;\n  draft.yDomains = yDomains;\n}\n\nfunction setMode(draft) {\n  const data = getActiveData(draft).filter(\n    (datum) => datum.display.isVisibleInDomain === true,\n  );\n  draft.mode = (data[0] as Datum1D)?.info.isFid ? 'LTR' : 'RTL';\n}\n\nfunction handleChangeIntegralYDomain(draft, newYDomain) {\n  const activeSpectrum = draft.activeSpectrum;\n  if (activeSpectrum) {\n    draft.integralsYDomains[activeSpectrum.id] = newYDomain;\n  }\n}\n\nexport {\n  getDomain,\n  setOriginalDomain,\n  setXDomain,\n  setYDomain,\n  handelResetDomain,\n  setDomain,\n  setMode,\n  handleChangeIntegralYDomain,\n};\n","export default function nucluesToString(nuclues) {\n  return typeof nuclues === 'string' ? nuclues : nuclues.join(',');\n}\n","function getClosestNumber(array = [], goal = 0) {\n  const closest = array.reduce((prev, curr) => {\n    return Math.abs(curr - goal) < Math.abs(prev - goal) ? curr : prev;\n  });\n  return closest;\n}\n\nexport default getClosestNumber;\n","export default class ZoomHistory {\n  constructor() {\n    this.stack = [];\n  }\n\n  static getInstance(ZoomHistoryInstances, nucleus) {\n    if (\n      ZoomHistoryInstances[nucleus] &&\n      ZoomHistoryInstances[nucleus] instanceof ZoomHistory\n    ) {\n      return ZoomHistoryInstances[nucleus];\n    }\n    ZoomHistoryInstances[nucleus] = new ZoomHistory();\n    return ZoomHistoryInstances[nucleus];\n  }\n\n  push(val) {\n    this.stack.push(val);\n  }\n\n  pop() {\n    const val = this.stack.pop();\n    return val ? this.stack[this.stack.length - 1] : null;\n  }\n\n  getLast() {\n    if (this.stack.length === 0) return null;\n    return this.stack[this.stack.length - 1];\n  }\n}\n","import { Draft, original } from 'immer';\nimport cloneDeep from 'lodash/cloneDeep';\nimport lodashGet from 'lodash/get';\n\nimport { Datum1D } from '../../../data/data1d/Datum1D';\nimport { Datum2D } from '../../../data/data2d/Datum2D';\nimport GroupByInfoKey from '../../utility/GroupByInfoKey';\nimport nucluesToString from '../../utility/nucluesToString';\nimport { State } from '../Reducer';\nimport { DEFAULT_YAXIS_SHIFT_VALUE, DISPLAYER_MODE } from '../core/Constants';\n\nimport { setDomain } from './DomainActions';\nimport { setZoom } from './Zoom';\n\nfunction handelSetPreferences(draft: Draft<State>, action) {\n  const { type, values } = action;\n  const panelsPreferences = lodashGet(draft.preferences, 'panels', {});\n  draft.preferences.panels = { ...panelsPreferences, [type]: values };\n}\n\nfunction changeSpectrumVerticalAlignment(\n  draft: Draft<State>,\n  center,\n  checkData = false,\n) {\n  if (draft.data && draft.data.length > 0) {\n    if (\n      center ||\n      (checkData &&\n        (draft.data[0] as Datum1D).info.isFid &&\n        !(draft.data as Datum1D[]).some((d) => d.info.isFid === false))\n    ) {\n      const YAxisShift = draft.height / 2;\n      draft.verticalAlign.flag = true;\n      draft.verticalAlign.value = YAxisShift;\n      draft.verticalAlign.stacked = false;\n    } else {\n      draft.verticalAlign.flag = false;\n      draft.verticalAlign.value = DEFAULT_YAXIS_SHIFT_VALUE;\n      draft.verticalAlign.stacked = false;\n    }\n  }\n}\n\nfunction setKeyPreferencesHandler(draft: Draft<State>, keyCode) {\n  const state = original(draft) as State;\n  const {\n    activeTab,\n    data,\n    activeSpectrum,\n    zoomFactor,\n    xDomain,\n    xDomains,\n    yDomain,\n    yDomains,\n    originDomain,\n    margin,\n    displayerMode,\n    tabActiveSpectrum,\n  } = state;\n  if (activeTab) {\n    const groupByNucleus = GroupByInfoKey('nucleus');\n\n    const spectrumsGroupsList = groupByNucleus(data);\n\n    const level =\n      displayerMode === DISPLAYER_MODE.DM_2D\n        ? spectrumsGroupsList[activeTab].reduce((acc, datum) => {\n            acc[datum.id] = datum.processingController.getLevel();\n            return acc;\n          }, {})\n        : null;\n\n    draft.keysPreferences[keyCode] = {\n      activeTab,\n      activeSpectrum,\n      displayerMode,\n      tabActiveSpectrum,\n      zoomFactor,\n      xDomain,\n      xDomains,\n      yDomain,\n      yDomains,\n      originDomain,\n      level,\n      margin,\n      data: spectrumsGroupsList[activeTab].reduce((acc, datum) => {\n        acc[datum.id] = {\n          display: {\n            color: datum.display.color,\n            isVisible: datum.display.isVisible,\n            isPeaksMarkersVisible: datum.display.isPeaksMarkersVisible,\n          },\n        };\n        return acc;\n      }, {}),\n    };\n  }\n}\n\nfunction applyKeyPreferencesHandler(draft: Draft<State>, keyCode) {\n  const state = original(draft) as State;\n\n  const preferences = state.keysPreferences[keyCode];\n  if (preferences) {\n    draft.activeTab = preferences.activeTab;\n    (state.data as Datum1D[] | Datum2D[]).forEach((datum, index) => {\n      if (nucluesToString(datum.info.nucleus) === preferences.activeTab) {\n        draft.data[index].display = Object.assign(\n          cloneDeep(datum.display),\n          preferences.data[datum.id].display,\n        );\n      }\n    });\n    draft.displayerMode = preferences.displayerMode;\n    draft.tabActiveSpectrum = preferences.tabActiveSpectrum;\n    draft.activeSpectrum = preferences.activeSpectrum;\n\n    draft.margin = preferences.margin;\n\n    setDomain(draft);\n\n    draft.xDomain = preferences.xDomain;\n    draft.xDomains = preferences.xDomains;\n    draft.yDomain = preferences.yDomain;\n    draft.originDomain = preferences.originDomain;\n    draft.yDomains = preferences.yDomains;\n\n    if (draft.displayerMode === DISPLAYER_MODE.DM_2D) {\n      // draft.yDomains = preferences.yDomains;\n\n      for (const datumID of Object.keys(preferences.level)) {\n        const { levelPositive, levelNegative } = preferences.level[datumID];\n        const index = state.data.findIndex((datum) => datum.id === datumID);\n        const processController = (draft.data[index] as Datum2D)\n          .processingController;\n        processController.setLevel(levelPositive, levelNegative);\n        draft.contours[datumID] = processController.drawContours();\n      }\n    } else {\n      setZoom(\n        // {\n        //   ...state,\n        //   activeSpectrum: draft.activeSpectrum,\n        //   activeTab: draft.activeTab,\n        // },\n        draft,\n        preferences.zoomFactor.scale,\n      );\n    }\n  }\n}\n\nexport {\n  changeSpectrumVerticalAlignment,\n  handelSetPreferences,\n  setKeyPreferencesHandler,\n  applyKeyPreferencesHandler,\n};\n","import { max } from 'd3';\nimport { original, Draft } from 'immer';\n\nimport { Filters } from '../../../data/Filters';\nimport { Data1D, Datum1D } from '../../../data/data1d/Datum1D';\n// import { Datum2D } from '../../../data/data2d/Datum2D';\nimport { Datum2D } from '../../../data/data2d/Datum2D';\nimport generateID from '../../../data/utilities/generateID';\nimport { getYScale, getXScale } from '../../1d/utilities/scale';\nimport { LAYOUT } from '../../2d/utilities/DimensionLayout';\nimport { get2DYScale } from '../../2d/utilities/scale';\nimport { options } from '../../toolbar/ToolTypes';\nimport GroupByInfoKey from '../../utility/GroupByInfoKey';\nimport { State } from '../Reducer';\nimport {\n  DEFAULT_YAXIS_SHIFT_VALUE,\n  DISPLAYER_MODE,\n  MARGIN,\n} from '../core/Constants';\nimport ZoomHistory from '../helper/ZoomHistory';\n\nimport { setDomain, setMode } from './DomainActions';\nimport { changeSpectrumVerticalAlignment } from './PreferencesActions';\nimport { setZoom1D, setZoom, ZoomType, wheel } from './Zoom';\n\nfunction getStrongestPeak(draft: Draft<State>) {\n  const { activeSpectrum, data } = draft;\n  const activeData = data[activeSpectrum.index].data as Data1D;\n  const strongestPeakValue = max(activeData.y);\n  const index = activeData.y.findIndex((val) => val === strongestPeakValue);\n  return {\n    xValue: activeData.x[index],\n    yValue: strongestPeakValue,\n    index: index,\n  };\n}\n\nfunction setFilterChanges(draft: Draft<State>, selectedFilter) {\n  const activeSpectrumId = draft.activeSpectrum.id;\n\n  //save reduced snapshot\n  //select the equalizer tool when you enable manual phase correction filter\n  if (selectedFilter === Filters.phaseCorrection.id) {\n    draft.tempData = draft.data;\n\n    const { xValue } = getStrongestPeak(draft);\n    draft.pivot = xValue;\n  } else {\n    if (draft.selectedTool === options.phaseCorrection.id) {\n      const spectrumIndex = draft.data.findIndex(\n        (spectrum) => spectrum.id === activeSpectrumId,\n      );\n\n      draft.data[spectrumIndex].data = draft.tempData[spectrumIndex].data;\n    }\n  }\n}\n\nfunction resetTool(draft: Draft<State>, setDefaultTool = true) {\n  draft.selectedOptionPanel = null;\n  if (setDefaultTool) {\n    draft.selectedTool = options.zoom.id;\n  }\n  draft.baseLineZones = [];\n  if (draft.tempData) {\n    draft.tempData = null;\n    setDomain(draft);\n  }\n}\n\nfunction resetSelectedTool(draft: Draft<State>, filterOnly = false) {\n  if (\n    (draft.selectedTool && options[draft.selectedTool].isFilter) ||\n    !filterOnly\n  ) {\n    resetTool(draft);\n  }\n}\n\nfunction setSelectedTool(draft: Draft<State>, selectedTool) {\n  if (draft?.data.length > 0) {\n    if (selectedTool) {\n      if (selectedTool !== draft.selectedTool) {\n        resetTool(draft, false);\n      }\n      draft.selectedTool = selectedTool;\n      if (options[selectedTool].hasOptionPanel) {\n        draft.selectedOptionPanel = selectedTool;\n      }\n\n      if (options[selectedTool].isFilter) {\n        setFilterChanges(draft, selectedTool);\n      }\n    } else {\n      resetTool(draft, false);\n    }\n    setMargin(draft);\n  }\n}\n\nfunction setSelectedOptionPanel(draft: Draft<State>, selectedOptionPanel) {\n  draft.selectedOptionPanel = selectedOptionPanel;\n}\n\nfunction setSpectrumsVerticalAlign(draft: Draft<State>) {\n  changeSpectrumVerticalAlignment(draft, !draft.verticalAlign.flag);\n}\n\nfunction handleChangeSpectrumDisplayMode(draft: Draft<State>) {\n  const state = original(draft) as State;\n  const { activeSpectrum, height, activeTab } = draft;\n  let YAxisShift = DEFAULT_YAXIS_SHIFT_VALUE;\n  if (activeSpectrum) {\n    const { index } = activeSpectrum;\n    if ((state.data[index] as Datum1D).info.isFid) {\n      YAxisShift = height / 2;\n    }\n  }\n  draft.verticalAlign.flag = !draft.verticalAlign.stacked;\n  draft.verticalAlign.stacked = !draft.verticalAlign.stacked;\n\n  if (draft.verticalAlign.stacked) {\n    const count = (state.data as Datum1D[]).filter(\n      (datum) => datum.info.nucleus === activeTab,\n    ).length;\n    draft.verticalAlign.value = Math.floor(height / (count + 2));\n  } else {\n    draft.verticalAlign.value = YAxisShift;\n  }\n}\n\nfunction handleAddBaseLineZone(draft: Draft<State>, { from, to }) {\n  const scaleX = getXScale(draft);\n\n  let start = scaleX.invert(from);\n  const end = scaleX.invert(to);\n\n  let zone: any = [];\n  if (start > end) {\n    zone = [end, start];\n  } else {\n    zone = [start, end];\n  }\n\n  const zones = draft.baseLineZones.slice();\n  zones.push({\n    id: generateID(),\n    from: zone[0],\n    to: zone[1],\n  });\n  draft.baseLineZones = zones;\n}\n\nfunction handleDeleteBaseLineZone(draft: Draft<State>, id) {\n  const state = original(draft) as State;\n  draft.baseLineZones = state.baseLineZones.filter((zone) => zone.id !== id);\n}\n\nfunction handleToggleRealImaginaryVisibility(draft) {\n  if (draft.activeSpectrum != null) {\n    const { index } = draft.activeSpectrum;\n\n    draft.data[index].display.isRealSpectrumVisible = !draft.data[index].display\n      .isRealSpectrumVisible;\n    if (draft.data[index].display.isRealSpectrumVisible) {\n      const re = draft.data[index].data.re;\n      if (re !== null && re !== undefined) {\n        draft.data[index].data.y = re;\n      }\n    } else {\n      const im = draft.data[index].data.im;\n\n      if (im !== null && im !== undefined) {\n        draft.data[index].data.y = im;\n      }\n    }\n\n    setDomain(draft);\n  }\n}\n\nfunction handleBrushEnd(draft: Draft<State>, action) {\n  const is2D = draft.displayerMode === DISPLAYER_MODE.DM_2D;\n  const xScale = getXScale(draft);\n\n  const yScale = is2D ? get2DYScale(draft) : getYScale(draft);\n\n  const startX = xScale.invert(action.startX);\n  const endX = xScale.invert(action.endX);\n  const startY = yScale.invert(action.startY);\n  const endY = yScale.invert(action.endY);\n  const domainX = startX > endX ? [endX, startX] : [startX, endX];\n  const domainY = startY > endY ? [endY, startY] : [startY, endY];\n  const brushHistory = ZoomHistory.getInstance(\n    draft.ZoomHistory,\n    draft.activeTab,\n  );\n\n  if (draft.displayerMode === DISPLAYER_MODE.DM_2D) {\n    switch (action.trackID) {\n      case LAYOUT.CENTER_2D:\n        draft.xDomain = domainX;\n        draft.yDomain = domainY;\n        break;\n      case LAYOUT.TOP_1D:\n        draft.xDomain = domainX;\n        break;\n      case LAYOUT.LEFT_1D:\n        draft.yDomain = domainY;\n        break;\n      default:\n        break;\n    }\n    if (brushHistory) {\n      brushHistory.push({ xDomain: domainX, yDomain: domainY });\n    }\n  } else {\n    draft.xDomain = domainX;\n    if (brushHistory) {\n      brushHistory.push({ xDomain: domainX, yDomain: domainY });\n    }\n  }\n}\nfunction setVerticalIndicatorXPosition(draft: Draft<State>, position) {\n  const scaleX = getXScale(draft);\n  draft.pivot = scaleX.invert(position);\n}\n\nfunction getSpectrumID(draft: Draft<State>, index) {\n  return draft.tabActiveSpectrum[draft.activeTab.split(',')[index]].id;\n}\n\nfunction handleZoom(draft: Draft<State>, action) {\n  const { deltaY, deltaMode, trackID } = action;\n  if (trackID) {\n    switch (trackID) {\n      case LAYOUT.TOP_1D: {\n        const id = getSpectrumID(draft, 0);\n        wheel(deltaY, deltaMode, draft, id);\n        setZoom1D(draft, draft.margin.top, 10, 0);\n        break;\n      }\n      case LAYOUT.LEFT_1D: {\n        const id = getSpectrumID(draft, 1);\n        wheel(deltaY, deltaMode, draft, id);\n        setZoom1D(draft, draft.margin.left, 10, 1);\n        break;\n      }\n      default:\n        break;\n    }\n  } else {\n    wheel(deltaY, deltaMode, draft);\n    setZoom(draft);\n  }\n}\n\nfunction zoomOut(draft: Draft<State>, action) {\n  if (draft?.data.length > 0) {\n    const { zoomType, trackID } = action;\n    const zoomHistory = ZoomHistory.getInstance(\n      draft.ZoomHistory,\n      draft.activeTab,\n    );\n\n    if (draft.displayerMode === DISPLAYER_MODE.DM_1D) {\n      switch (zoomType) {\n        case ZoomType.HORIZONTAL: {\n          draft.xDomain = draft.originDomain.xDomain;\n          break;\n        }\n        case ZoomType.VERTICAL:\n          setZoom(draft, 0.8);\n          break;\n        case ZoomType.STEP_HROZENTAL: {\n          const zoomValue = zoomHistory.pop();\n          draft.xDomain = zoomValue\n            ? zoomValue.xDomain\n            : draft.originDomain.xDomain;\n          setZoom(draft, 0.8);\n          break;\n        }\n        default: {\n          draft.xDomain = draft.originDomain.xDomain;\n          setZoom(draft, 0.8);\n          break;\n        }\n      }\n    } else {\n      const { xDomain, yDomain, yDomains } = draft.originDomain;\n      switch (trackID) {\n        case LAYOUT.TOP_1D: {\n          const { id } = draft.tabActiveSpectrum[draft.activeTab.split(',')[0]];\n          draft.xDomain = xDomain;\n          draft.yDomains[id] = yDomains[id];\n          break;\n        }\n        case LAYOUT.LEFT_1D: {\n          const { id } = draft.tabActiveSpectrum[draft.activeTab.split(',')[1]];\n          draft.yDomain = yDomain;\n          draft.yDomains[id] = yDomains[id];\n\n          break;\n        }\n        case LAYOUT.CENTER_2D: {\n          const zoomValue = zoomHistory.pop();\n          draft.xDomain = zoomValue ? zoomValue.xDomain : xDomain;\n          draft.yDomain = zoomValue ? zoomValue.yDomain : yDomain;\n          break;\n        }\n        default:\n          draft.xDomain = xDomain;\n          draft.yDomain = yDomain;\n          draft.yDomains = yDomains;\n          break;\n      }\n    }\n  }\n}\n\nfunction hasAcceptedSpectrum(draft: Draft<State>, index) {\n  const nucleuses = draft.activeTab.split(',');\n  return (\n    draft.tabActiveSpectrum[nucleuses[index]] &&\n    !(draft.data[draft.tabActiveSpectrum[nucleuses[index]].index] as Datum1D)\n      .info.isFid\n  );\n}\n\nfunction setMargin(draft: Draft<State>) {\n  if (\n    draft.displayerMode === DISPLAYER_MODE.DM_2D &&\n    draft.selectedTool !== options.slicingTool.id\n  ) {\n    const top = hasAcceptedSpectrum(draft, 0)\n      ? MARGIN['2D'].top\n      : MARGIN['1D'].top;\n    const left = hasAcceptedSpectrum(draft, 1)\n      ? MARGIN['2D'].left\n      : MARGIN['1D'].left;\n    draft.margin = { ...MARGIN['2D'], top, left };\n  } else if (draft.selectedTool === options.slicingTool.id) {\n    draft.margin = MARGIN['2D'];\n  } else if (draft.displayerMode === DISPLAYER_MODE.DM_1D) {\n    draft.margin = MARGIN['1D'];\n  }\n}\n\nfunction Processing2DData(draft: Draft<State>, data) {\n  if (draft.displayerMode === DISPLAYER_MODE.DM_2D) {\n    let _data = {};\n    for (const datum of data[draft.activeTab]) {\n      _data[datum.id] = datum.processingController.drawContours();\n    }\n    draft.contours = _data;\n  }\n}\n\nfunction setDisplayerMode(draft: Draft<State>, data) {\n  draft.displayerMode =\n    data && (data as Datum1D[] | Datum2D[]).some((d) => d.info.dimension === 2)\n      ? DISPLAYER_MODE.DM_2D\n      : DISPLAYER_MODE.DM_1D;\n}\n\nfunction setTabActiveSpectrum(draft: Draft<State>, dataGroupByTab) {\n  let tabs2D: any[] = [];\n  const tabActiveSpectrum = {};\n\n  const tabkeys = Object.keys(dataGroupByTab).sort((a, b) =>\n    a.split(',').length > b.split(',').length ? -1 : 1,\n  );\n  for (let tabKey of tabkeys) {\n    const data = dataGroupByTab[tabKey];\n    const nucleusLength = tabKey.split(',').length;\n    if (nucleusLength === 2) {\n      tabs2D.push(tabKey);\n    }\n\n    if (data.length === 1) {\n      const index = draft.data.findIndex((datum) => datum.id === data[0].id);\n      tabActiveSpectrum[tabKey] = { id: data[0].id, index };\n    } else {\n      const tabSpectra = dataGroupByTab[tabKey];\n      const tabSpectraLength = tabSpectra.length;\n      if (tabSpectraLength >= 2) {\n        const FTSpectrums = tabSpectra.filter((d) => !d.info.isFid);\n        if (\n          FTSpectrums.length > 0 &&\n          (nucleusLength === 2 ||\n            (nucleusLength === 1 && tabSpectraLength !== FTSpectrums.length))\n        ) {\n          const index = draft.data.findIndex(\n            (datum) => datum.id === FTSpectrums[0].id,\n          );\n          tabActiveSpectrum[tabKey] = { id: FTSpectrums[0].id, index };\n        } else {\n          tabActiveSpectrum[tabKey] = null;\n        }\n      } else {\n        tabActiveSpectrum[tabKey] = null;\n      }\n    }\n  }\n  draft.tabActiveSpectrum = tabActiveSpectrum;\n  return tabs2D;\n}\n\nfunction setTab(draft: Draft<State>, dataGroupByTab, tab, refresh = false) {\n  const groupByTab = Object.keys(dataGroupByTab).sort((a, b) =>\n    a.split(',').length > b.split(',').length ? -1 : 1,\n  );\n\n  if (\n    JSON.stringify(groupByTab) !==\n      JSON.stringify(Object.keys(draft.tabActiveSpectrum)) ||\n    refresh\n  ) {\n    const tabs2D = setTabActiveSpectrum(draft, dataGroupByTab);\n\n    if (tabs2D.length > 0 && tab == null) {\n      draft.activeSpectrum = draft.tabActiveSpectrum[tabs2D[0]];\n      draft.activeTab = tabs2D[0];\n    } else {\n      draft.activeSpectrum = tab ? draft.tabActiveSpectrum[tab] : tab;\n      draft.activeTab = tab;\n    }\n  } else {\n    draft.activeTab = tab;\n    draft.activeSpectrum = draft.tabActiveSpectrum[tab];\n  }\n\n  setDisplayerMode(draft, dataGroupByTab[draft.activeTab]);\n  setMargin(draft);\n}\n\nfunction setActiveTab(\n  draft: Draft<State>,\n  tab = null,\n  refreshTabActiveSpectrums = false,\n) {\n  const groupByNucleus = GroupByInfoKey('nucleus');\n  const dataGroupByNucleus = groupByNucleus(draft.data);\n  const tabs = Object.keys(dataGroupByNucleus);\n  const currentTab = !tab || !tabs.includes(tab ?? '') ? tabs[0] : tab;\n  setTab(draft, dataGroupByNucleus, currentTab, refreshTabActiveSpectrums);\n  resetTool(draft);\n  // resetFilterTool(draft);\n\n  Processing2DData(draft, dataGroupByNucleus);\n  setDomain(draft);\n\n  const zoomHistory = ZoomHistory.getInstance(\n    draft.ZoomHistory,\n    draft.activeTab,\n  );\n  const zoomValue = zoomHistory.getLast();\n  if (zoomValue) {\n    draft.xDomain = zoomValue.xDomain;\n    draft.yDomain = zoomValue.yDomain;\n  }\n  setMode(draft);\n}\n\nfunction handelSetActiveTab(draft: Draft<State>, tab) {\n  if (tab) {\n    setActiveTab(draft, tab);\n  }\n}\n\nfunction levelChangeHandler(draft: Draft<State>, { deltaY, shiftKey }) {\n  try {\n    if (draft.activeSpectrum?.id) {\n      const { index, id } = draft.activeSpectrum;\n      // const datum2dObject = AnalysisObj.getDatum(id);\n      // if (datum2dObject instanceof Datum2D) {\n      const processingController = (draft.data[index] as Datum2D)\n        .processingController;\n      // const processing2dController = processingController.drawContours;\n      if (shiftKey) {\n        processingController.shiftWheel(deltaY);\n      } else {\n        processingController.wheel(deltaY);\n      }\n      const contours = Object.freeze(processingController.drawContours());\n      draft.contours[id] = contours;\n      // }\n    }\n  } catch (e) {\n    // eslint-disable-next-line no-console\n    console.log(e);\n  }\n}\n\nfunction setSpectraSameTopHandler(draft: Draft<State>) {\n  if (draft.displayerMode === DISPLAYER_MODE.DM_1D) {\n    draft.originDomain.yDomains = draft.originDomain.originYDomains;\n    setZoom(draft, 0.8);\n  }\n}\nfunction resetSpectraScale(draft: Draft<State>) {\n  if (draft.displayerMode === DISPLAYER_MODE.DM_1D) {\n    draft.yDomains = Object.keys(draft.yDomains).reduce((acc, key) => {\n      acc[key] = draft.originDomain.yDomain;\n      return acc;\n    }, {});\n    draft.originDomain.yDomains = draft.yDomains;\n    draft.yDomain = draft.originDomain.yDomain;\n  }\n}\n\nfunction handleAddExclusionZone(draft: Draft<State>, action) {\n  const { from, to } = action.payload;\n  const scaleX = getXScale(draft);\n\n  const start = scaleX.invert(from);\n  const end = scaleX.invert(to);\n\n  let zone: any = [];\n  if (start > end) {\n    zone = [end, start];\n  } else {\n    zone = [start, end];\n  }\n  const newExclusionZone = {\n    id: generateID(),\n    from: zone[0],\n    to: zone[1],\n  };\n  if (draft.exclusionZones[draft.activeTab]) {\n    draft.exclusionZones[draft.activeTab].push(newExclusionZone);\n  } else {\n    draft.exclusionZones[draft.activeTab] = [newExclusionZone];\n  }\n}\n\nfunction handleDeleteExclusionZone(draft: Draft<State>, action) {\n  const id = action.payload.id;\n  const index = draft.exclusionZones[draft.activeTab].findIndex(\n    (zone) => zone.id === id,\n  );\n  draft.exclusionZones[draft.activeTab].splice(index, 1);\n}\n\nexport {\n  resetSelectedTool,\n  setSelectedTool,\n  setSelectedOptionPanel,\n  setSpectrumsVerticalAlign,\n  handleChangeSpectrumDisplayMode,\n  handleAddBaseLineZone,\n  handleDeleteBaseLineZone,\n  handleToggleRealImaginaryVisibility,\n  handleBrushEnd,\n  setVerticalIndicatorXPosition,\n  handleZoom,\n  zoomOut,\n  handelSetActiveTab,\n  levelChangeHandler,\n  setActiveTab,\n  setTab,\n  setSpectraSameTopHandler,\n  resetSpectraScale,\n  handleAddExclusionZone,\n  handleDeleteExclusionZone,\n};\n","import { Draft } from 'immer';\n\nimport { Filters } from '../../../data/Filters';\nimport * as FiltersManager from '../../../data/FiltersManager';\nimport { Datum1D, updateXShift } from '../../../data/data1d/Datum1D';\nimport { apply as autoPhaseCorrection } from '../../../data/data1d/filter1d/autoPhaseCorrection';\nimport { apply as phaseCorrection } from '../../../data/data1d/filter1d/phaseCorrection';\nimport {\n  Datum2D,\n  updateShift as update2dShift,\n} from '../../../data/data2d/Datum2D';\nimport nucluesToString from '../../utility/nucluesToString';\nimport { State } from '../Reducer';\nimport getClosestNumber from '../helper/GetClosestNumber';\nimport ZoomHistory from '../helper/ZoomHistory';\n\nimport { setDomain, setMode } from './DomainActions';\nimport { changeSpectrumVerticalAlignment } from './PreferencesActions';\nimport { resetSelectedTool } from './ToolsActions';\n\nfunction setDataBy1DFilter(datum: Datum1D) {\n  datum.data.y = datum.data.re;\n}\n\nfunction shiftSpectrumAlongXAxis(draft: Draft<State>, shiftValue) {\n  //apply filter into the spectrum\n  if (draft.activeSpectrum?.id) {\n    const index = draft.activeSpectrum.index;\n\n    FiltersManager.applyFilter(draft.data[index], [\n      { name: Filters.shiftX.id, options: shiftValue },\n    ]);\n    updateXShift(draft.data[index] as Datum1D);\n    resetSelectedTool(draft);\n    setDataBy1DFilter(draft.data[index] as Datum1D);\n    setDomain(draft);\n  }\n}\n\nfunction applyZeroFillingFilter(draft: Draft<State>, filterOptions) {\n  if (draft.activeSpectrum?.id) {\n    const index = draft.activeSpectrum.index;\n    // const activeObject = AnalysisObj.getDatum(activeSpectrumId);\n    const filters = [\n      { name: Filters.zeroFilling.id, options: filterOptions.zeroFillingSize },\n      {\n        name: Filters.lineBroadening.id,\n        options: filterOptions.lineBroadeningValue,\n      },\n    ];\n    FiltersManager.applyFilter(draft.data[index], filters);\n    resetSelectedTool(draft);\n    setDataBy1DFilter(draft.data[index] as Datum1D);\n    setDomain(draft);\n    setMode(draft);\n  }\n}\nfunction applyFFTFilter(draft: Draft<State>) {\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n\n    // const activeObject = AnalysisObj.getDatum(activeSpectrumId);\n\n    //apply filter into the spectrum\n    FiltersManager.applyFilter(draft.data[index], [\n      { name: Filters.fft.id, options: {} },\n    ]);\n    resetSelectedTool(draft);\n    setDataBy1DFilter(draft.data[index] as Datum1D);\n    changeSpectrumVerticalAlignment(draft, false, true);\n\n    setDomain(draft);\n    setMode(draft);\n  }\n}\nfunction applyManualPhaseCorrectionFilter(draft: Draft<State>, filterOptions) {\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n    let { ph0, ph1 } = filterOptions;\n    const datum = draft.data[index] as Datum1D;\n    const closest = getClosestNumber(datum.data.x, draft.pivot);\n    const pivotIndex = datum.data.x.indexOf(closest);\n\n    ph0 = ph0 - (ph1 * pivotIndex) / datum.data.y.length;\n\n    FiltersManager.applyFilter(draft.data[index], [\n      { name: Filters.phaseCorrection.id, options: { ph0, ph1 } },\n    ]);\n\n    resetSelectedTool(draft);\n    setDataBy1DFilter(draft.data[index] as Datum1D);\n    draft.tempData = null;\n    setDomain(draft);\n  }\n}\nfunction applyAbsoluteFilter(draft: Draft<State>) {\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n    FiltersManager.applyFilter(draft.data[index], [\n      { name: Filters.absolute.id, options: {} },\n    ]);\n    resetSelectedTool(draft);\n    setDataBy1DFilter(draft.data[index] as Datum1D);\n    draft.tempData = null;\n    setDomain(draft);\n  }\n}\n\nfunction applyAutoPhaseCorrectionFilter(draft: Draft<State>) {\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n\n    const {\n      data: { x, y, im },\n      info,\n    } = draft.tempData[index];\n\n    let _data = { data: { x, re: y, im }, info };\n    const { data, ph0, ph1 } = autoPhaseCorrection(_data);\n\n    const { im: newIm, re: newRe } = data;\n    draft.tempData[index].data.im = newIm;\n    draft.tempData[index].data.y = newRe;\n    FiltersManager.applyFilter(draft.data[index], [\n      { name: Filters.phaseCorrection.id, options: { ph0, ph1 } },\n    ]);\n    resetSelectedTool(draft);\n    setDataBy1DFilter(draft.data[index] as Datum1D);\n    draft.tempData = null;\n    setDomain(draft);\n  }\n}\n\nfunction calculateManualPhaseCorrection(draft: Draft<State>, filterOptions) {\n  const { tempData } = draft;\n  const { index } = draft.activeSpectrum;\n  const {\n    data: { x, y, im },\n    info,\n  } = tempData[index];\n\n  let { ph0, ph1 } = filterOptions;\n  const closest = getClosestNumber(tempData[index].data.x, draft.pivot);\n  const pivotIndex = tempData[index].data.x.indexOf(closest);\n\n  ph0 = ph0 - (ph1 * pivotIndex) / y.length;\n\n  let _data = { data: { x, re: y, im }, info };\n  phaseCorrection(_data, { ph0, ph1 });\n  const { im: newIm, re: newRe } = _data.data;\n  draft.tempData[index].data.im = newIm;\n  draft.tempData[index].data.y = newRe;\n}\n\nfunction enableFilter(draft: Draft<State>, filterID, checked) {\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n\n    //apply filter into the spectrum\n    FiltersManager.enableFilter(draft.data[index], filterID, checked);\n\n    if (draft.data[index].info?.dimension === 1) {\n      updateXShift(draft.data[index] as Datum1D);\n      setDataBy1DFilter(draft.data[index] as Datum1D);\n    } else if (draft.data[index].info?.dimension === 2) {\n      update2dShift(draft.data[index] as Datum2D);\n    }\n\n    resetSelectedTool(draft);\n    setDomain(draft);\n    setMode(draft);\n\n    const zoomHistory = ZoomHistory.getInstance(\n      draft.ZoomHistory,\n      draft.activeTab,\n    );\n    const zoomValue = zoomHistory.getLast();\n    if (zoomValue) {\n      draft.xDomain = zoomValue.xDomain;\n      draft.yDomain = zoomValue.yDomain;\n    }\n  }\n}\n\nfunction deleteFilter(draft: Draft<State>, actions) {\n  const filterID = actions.payload.id;\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n    //apply filter into the spectrum\n    FiltersManager.deleteFilter(draft.data[index], filterID);\n\n    if (draft.data[index].info?.dimension === 1) {\n      updateXShift(draft.data[index] as Datum1D);\n      setDataBy1DFilter(draft.data[index] as Datum1D);\n    } else if (draft.data[index].info?.dimension === 2) {\n      update2dShift(draft.data[index] as Datum2D);\n    }\n\n    resetSelectedTool(draft);\n    setDomain(draft);\n    setMode(draft);\n  }\n}\nfunction deleteSpectraFilter(draft: Draft<State>, actions) {\n  const filterType = actions.payload.filterType;\n\n  if (draft.activeTab) {\n    for (const datum of draft.data) {\n      if (nucluesToString(datum?.info?.nucleus) === draft.activeTab) {\n        const filtersResult =\n          datum.filters?.filter((filter) => filter.name === filterType) || [];\n\n        filtersResult.forEach((filter) => {\n          FiltersManager.deleteFilter(datum, filter.id);\n\n          if (datum.info?.dimension === 1) {\n            updateXShift(datum as Datum1D);\n            setDataBy1DFilter(datum as Datum1D);\n          } else if (datum.info?.dimension === 2) {\n            update2dShift(datum as Datum2D);\n          }\n        });\n      }\n    }\n\n    resetSelectedTool(draft);\n    setDomain(draft);\n    setMode(draft);\n  }\n}\n\nfunction handleBaseLineCorrectionFilter(draft: Draft<State>, action) {\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n\n    FiltersManager.applyFilter(draft.data[index], [\n      {\n        name: Filters.baselineCorrection.id,\n        options: { zones: draft.baseLineZones, ...action.options },\n      },\n    ]);\n\n    draft.baseLineZones = [];\n    const xDomainSnapshot = draft.xDomain.slice();\n\n    resetSelectedTool(draft);\n    setDataBy1DFilter(draft.data[index] as Datum1D);\n    setDomain(draft);\n    draft.xDomain = xDomainSnapshot;\n  }\n}\n\nfunction filterSnapshotHandler(draft: Draft<State>, action) {\n  if (draft.activeSpectrum?.id) {\n    const index = draft.activeSpectrum.index;\n    const datum = draft.data[index] as Datum1D | Datum2D;\n    if (action.id) {\n      const filterIndex = datum.filters.findIndex((f) => f.id === action.id);\n      const filters = datum.filters.slice(0, filterIndex + 1);\n      FiltersManager.reapplyFilters(datum, filters);\n    } else {\n      //close filter snapshot mode and replay all enabled filters\n      FiltersManager.reapplyFilters(datum);\n    }\n\n    if (datum.info?.dimension === 1) {\n      updateXShift(datum as Datum1D);\n      setDataBy1DFilter(datum as Datum1D);\n    } else if (datum.info?.dimension === 2) {\n      update2dShift(datum as Datum2D);\n    }\n    // const activeObject = AnalysisObj.getDatum(id);\n\n    resetSelectedTool(draft);\n    setDomain(draft);\n    setMode(draft);\n  }\n}\n\nfunction handleMultipleSpectraFilter(draft: Draft<State>, action) {\n  if (draft.data && draft.data.length > 0) {\n    for (let datum of draft.data) {\n      if (\n        datum.info?.dimension === 1 &&\n        datum.info.nucleus === draft.activeTab &&\n        Array.isArray(action.payload)\n      ) {\n        const filters = action.payload.map((filter) => {\n          if (filter.name === Filters.equallySpaced.id) {\n            const exclusions = draft.exclusionZones[draft.activeTab] || [];\n            return {\n              ...filter,\n              options: { ...filter.options, exclusions },\n            };\n          }\n          return filter;\n        });\n\n        FiltersManager.applyFilter(datum, filters);\n        (datum as Datum1D).data.y = (datum as Datum1D).data.re;\n      }\n    }\n  }\n  setDomain(draft);\n}\n\nexport {\n  shiftSpectrumAlongXAxis,\n  applyZeroFillingFilter,\n  applyFFTFilter,\n  applyManualPhaseCorrectionFilter,\n  applyAutoPhaseCorrectionFilter,\n  applyAbsoluteFilter,\n  calculateManualPhaseCorrection,\n  handleMultipleSpectraFilter,\n  enableFilter,\n  deleteFilter,\n  deleteSpectraFilter,\n  handleBaseLineCorrectionFilter,\n  filterSnapshotHandler,\n};\n","import { getXScale } from '../../1d/utilities/scale';\n\nexport default function getRange(draft, options) {\n  const { startX, endX } = options;\n  const scaleX = getXScale(draft);\n\n  const start = scaleX.invert(startX);\n  const end = scaleX.invert(endX);\n  const range: number[] = [];\n  if (start > end) {\n    range[0] = end;\n    range[1] = start;\n  } else {\n    range[0] = start;\n    range[1] = end;\n  }\n  return range;\n}\n","import { extent } from 'd3';\nimport { Draft, original } from 'immer';\nimport { xyIntegral, xyIntegration } from 'ml-spectra-processing';\n\nimport {\n  updateIntegralIntegrals,\n  changeIntegralsRealtive,\n  Datum1D,\n  getShiftX,\n} from '../../../data/data1d/Datum1D';\nimport generateID from '../../../data/utilities/generateID';\nimport { State } from '../Reducer';\nimport getRange from '../helper/getRange';\n\nimport { setIntegralZoom, integralZoomHanlder } from './Zoom';\n\nfunction handleChangeIntegralSum(draft: Draft<State>, value) {\n  if (draft.activeSpectrum?.id) {\n    const { index, id } = draft.activeSpectrum;\n    (draft.data[index] as Datum1D).integrals.options.sum = value;\n    updateIntegralIntegrals((draft.data[index] as Datum1D).integrals);\n\n    if (!draft.integralsYDomains) {\n      draft.integralsYDomains[id] = draft.yDomains[id];\n    }\n  }\n}\n\nfunction handleChangeIntegralZoom(draft: Draft<State>, action) {\n  const { deltaY, deltaMode } = action;\n  integralZoomHanlder.wheel(deltaY, deltaMode);\n  setIntegralZoom(integralZoomHanlder.getScale(), draft);\n}\n\nfunction addIntegral(draft: Draft<State>, action) {\n  const state = original(draft);\n  const { startX, endX } = action;\n  const [from, to] = getRange(draft, { startX, endX });\n\n  if (draft.activeSpectrum?.id && state) {\n    const { id, index } = draft.activeSpectrum;\n    const datum = draft.data[index] as Datum1D;\n\n    const { x, re } = datum.data;\n\n    const shiftX = getShiftX(datum);\n\n    const integral = {\n      id: generateID(),\n      originFrom: from - shiftX,\n      originTo: to - shiftX,\n      from,\n      to,\n      absolute: xyIntegration({ x, y: re }, { from, to, reverse: true }), // the real value\n      kind: 'signal',\n    };\n    datum.integrals.values.push(integral);\n    updateIntegralIntegrals(datum.integrals);\n    if (datum.integrals.values.length === 1) {\n      const { from = 0, to = 0 } = datum.integrals.values[0];\n      const { x, y } = datum.data;\n      const integralResult = xyIntegral(\n        { x: x, y: y },\n        {\n          from: from,\n          to: to,\n          reverse: true,\n        },\n      );\n      const integralYDomain = extent(integralResult.y);\n      draft.integralsYDomains[id] = integralYDomain;\n      draft.originIntegralYDomain[id] = integralYDomain;\n      setIntegralZoom(draft.integralZoomFactor.scale, draft);\n    }\n  }\n}\n\nfunction deleteIntegral(draft: Draft<State>, action) {\n  const state = original(draft) as State;\n  const { index } = draft.activeSpectrum;\n  const { integralID } = action;\n\n  const datum = draft.data[index] as Datum1D;\n\n  if (integralID == null) {\n    datum.integrals.values = [];\n  } else {\n    const peakIndex = (state.data[index] as Datum1D).integrals.values.findIndex(\n      (p) => p.id === integralID,\n    );\n    datum.integrals.values.splice(peakIndex, 1);\n    updateIntegralIntegrals(datum.integrals);\n  }\n}\n\nfunction changeIntegral(draft: Draft<State>, action) {\n  const state = original(draft) as State;\n  const integral = action.data;\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n\n    const orignalDatum = state.data[index] as Datum1D;\n    const datum = draft.data[index] as Datum1D;\n\n    const { x, re } = orignalDatum.data;\n    const integralIndex = orignalDatum.integrals.values.findIndex(\n      (i) => i.id === integral.id,\n    );\n    if (integralIndex !== -1) {\n      datum.integrals.values[integralIndex] = {\n        // ...draft.data[index].integrals.values[integralIndex],\n        originFrom: integral.from,\n        originTo: integral.to,\n        ...integral,\n        absolute: xyIntegration(\n          { x, y: re },\n          { from: integral.from, to: integral.to, reverse: true },\n        ),\n      };\n      updateIntegralIntegrals(datum.integrals);\n    }\n  }\n}\n\nfunction handleChangeIntegralsRaltiveValue(draft: Draft<State>, action) {\n  const { id, value } = action;\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n    changeIntegralsRealtive(\n      (draft.data[index] as Datum1D).integrals,\n      id,\n      value,\n    );\n  }\n}\n\nexport {\n  handleChangeIntegralSum,\n  handleChangeIntegralZoom,\n  addIntegral,\n  deleteIntegral,\n  changeIntegral,\n  handleChangeIntegralsRaltiveValue,\n};\n","import { Molecule, Molecule as OCLMolecule } from 'openchemlib/full';\n\nimport { initMolecule } from './Molecule';\n\nexport function fromJSON(mols = []) {\n  const molecules = [];\n  for (let i = 0; i < mols.length; i++) {\n    const molecule = OCLMolecule.fromMolfile(mols[i].molfile);\n    const fragments = molecule.getFragments();\n    for (let fragment of fragments) {\n      molecules.push(\n        initMolecule({\n          molfile: fragment.toMolfileV3(),\n        }),\n      );\n    }\n  }\n\n  return molecules;\n}\n\nexport function addMolfile(molecules, molfile) {\n  // try to parse molfile\n  // this will throw if the molecule can not be parsed !\n  const molecule = Molecule.fromMolfile(molfile);\n  let fragments = molecule.getFragments();\n  for (let fragment of fragments) {\n    const {\n      formula,\n      absoluteWeight,\n      relativeWeight,\n    } = fragment.getMolecularFormula();\n    molecules.push(\n      initMolecule({\n        molfile: fragment.toMolfileV3(),\n        svg: fragment.toSVG(150, 150),\n        mf: formula,\n        em: absoluteWeight,\n        mw: relativeWeight,\n      }),\n    );\n  }\n  // we will split if we have many fragments\n}\n\nexport function setMolfile(molecules, molfile, key) {\n  // try to parse molfile\n  // this will throw if the molecule can not be parsed !\n  let molecule = Molecule.fromMolfile(molfile);\n  let fragments = molecule.getFragments();\n\n  if (fragments.length > 1) {\n    molecules = this.molecules.filter((m) => m.key !== key);\n\n    for (let fragment of fragments) {\n      const {\n        formula,\n        absoluteWeight,\n        relativeWeight,\n      } = fragment.getMolecularFormula();\n\n      molecules.push(\n        new initMolecule({\n          molfile: fragment.toMolfileV3(),\n          svg: fragment.toSVG(150, 150),\n          mf: formula,\n          em: absoluteWeight,\n          mw: relativeWeight,\n        }),\n      );\n    }\n  } else if (fragments.length === 1) {\n    const fragment = fragments[0];\n    const {\n      formula,\n      absoluteWeight,\n      relativeWeight,\n    } = fragment.getMolecularFormula();\n    const _mol = initMolecule({\n      molfile: fragment.toMolfileV3(),\n      svg: fragment.toSVG(150, 150),\n      mf: formula,\n      em: absoluteWeight,\n      mw: relativeWeight,\n      key: key,\n    });\n    let molIndex = molecules.findIndex((m) => m.key === key);\n    molecules.splice(molIndex, 1, _mol);\n  }\n\n  // we will split if we have many fragments\n}\n","import { Draft } from 'immer';\nimport lodashGet from 'lodash/get';\nimport { buildCorrelationData, Types } from 'nmr-correlation';\n\nimport { addJcamps, addJDFs } from '../../../data/SpectraManager';\nimport * as MoleculeManager from '../../../data/molecules/MoleculeManager';\nimport generateID from '../../../data/utilities/generateID';\nimport { Molecules, NMRiumPreferences, Spectra } from '../../NMRium';\nimport { DefaultTolerance } from '../../panels/SummaryPanel/CorrelationTable/Constants';\nimport { State } from '../Reducer';\n\nimport { changeSpectrumVerticalAlignment } from './PreferencesActions';\nimport { setActiveTab } from './ToolsActions';\nimport { initZoom1DHandler } from './Zoom';\n\nfunction setIsLoading(draft: Draft<State>, isLoading: boolean) {\n  draft.isLoading = isLoading;\n}\n\nfunction setData(\n  draft: Draft<State>,\n  data: {\n    spectra: Spectra;\n    molecules: Molecules;\n    preferences: NMRiumPreferences;\n    correlations: Types.CorrelationData;\n    exclusionZones: any;\n  },\n) {\n  const {\n    spectra,\n    molecules,\n    preferences,\n    correlations,\n    exclusionZones = {},\n  } = data || {\n    spectra: [],\n    molecules: [],\n    preferences: {},\n    correlations: {},\n    multipleAnalysis: {},\n    exclusionZones: {},\n  };\n  draft.data = spectra;\n  draft.molecules = MoleculeManager.fromJSON(molecules);\n  draft.preferences = preferences;\n  draft.exclusionZones = exclusionZones;\n\n  if (!correlations || Object.keys(correlations).length === 0) {\n    draft.correlations = buildCorrelationData([], {\n      tolerance: DefaultTolerance,\n    });\n  } else {\n    draft.correlations = correlations;\n  }\n\n  // const spectraAnalysis = AnalysisObj.getMultipleAnalysis();\n}\n\nfunction initiate(draft: Draft<State>, action) {\n  draft.displayerKey = generateID();\n  setData(draft, action.payload);\n  initZoom1DHandler(draft.data);\n  const alignCenter = lodashGet(draft.preferences, 'display.center', null);\n  changeSpectrumVerticalAlignment(draft, alignCenter, true);\n  setActiveTab(draft);\n  draft.isLoading = false;\n}\n\nfunction loadJDFFile(draft: Draft<State>, files) {\n  const spectra = addJDFs(files);\n  for (const spectrum of spectra) {\n    draft.data.push(spectrum);\n  }\n\n  setActiveTab(draft);\n  initZoom1DHandler(draft.data);\n\n  draft.isLoading = false;\n}\n\nfunction loadJcampFile(draft: Draft<State>, files) {\n  const spectra = addJcamps(files);\n  for (const spectrum of spectra) {\n    draft.data.push(spectrum);\n  }\n  changeSpectrumVerticalAlignment(draft, false, true);\n  setActiveTab(draft);\n  initZoom1DHandler(draft.data);\n\n  draft.isLoading = false;\n}\n\nfunction handleLoadJsonFile(draft: Draft<State>, actions) {\n  const data = actions.payload;\n  setData(draft, data);\n\n  const alignCenter = lodashGet(draft.preferences, 'display.center', null);\n\n  changeSpectrumVerticalAlignment(draft, alignCenter, true);\n\n  setActiveTab(draft);\n  initZoom1DHandler(draft.data);\n\n  draft.isLoading = false;\n}\n\nfunction handleLoadMOLFile(draft: Draft<State>, files) {\n  for (let file of files) {\n    MoleculeManager.addMolfile(draft.molecules, file.binary.toString());\n  }\n  draft.isLoading = false;\n}\n\nfunction handleLoadZIPFile(draft: Draft<State>, action) {\n  draft.data = action.payload;\n  setActiveTab(draft);\n  initZoom1DHandler(draft.data);\n  draft.isLoading = false;\n}\n\nfunction handleLoadNmredata(draft: Draft<State>, action) {\n  setData(draft, action.payload);\n  changeSpectrumVerticalAlignment(draft, false, true);\n  setActiveTab(draft);\n  initZoom1DHandler(draft.data);\n  draft.isLoading = false;\n}\n\nexport {\n  setIsLoading,\n  initiate,\n  loadJcampFile,\n  loadJDFFile,\n  handleLoadJsonFile,\n  handleLoadNmredata,\n  handleLoadMOLFile,\n  handleLoadZIPFile,\n};\n","import { Draft, original } from 'immer';\nimport cloneDeep from 'lodash/cloneDeep';\nimport { xFindClosestIndex } from 'ml-spectra-processing';\n\nimport { Filters } from '../../../data/Filters';\nimport * as FiltersManager from '../../../data/FiltersManager';\nimport {\n  DatumKind,\n  SignalKindsToInclude,\n} from '../../../data/constants/SignalsKinds';\nimport {\n  addRange,\n  changeRangeSignal,\n  detectRanges,\n  updateIntegralRanges,\n  changeRange,\n  changeRangesRealtive,\n  Datum1D,\n  Range,\n  Signal,\n  updateXShift,\n} from '../../../data/data1d/Datum1D';\nimport {\n  getPubIntegral,\n  unlink,\n  unlinkInAssignmentData,\n} from '../../../data/utilities/RangeUtilities';\nimport { State } from '../Reducer';\nimport getRange from '../helper/getRange';\n\nimport { handleUpdateCorrelations } from './CorrelationsActions';\nimport { setDomain } from './DomainActions';\n\nfunction handleAutoRangesDetection(draft: Draft<State>, detectionOptions) {\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n    const datum = draft.data[index] as Datum1D;\n\n    const [from, to] = draft.xDomain;\n    const windowFromIndex = xFindClosestIndex(datum.data.x, from);\n    const windowToIndex = xFindClosestIndex(datum.data.x, to);\n\n    detectRanges(datum, {\n      ...detectionOptions,\n      windowFromIndex,\n      windowToIndex,\n    });\n    handleOnChangeRangesData(draft);\n  }\n}\n\nfunction getRangeIndex(drfat: Draft<State>, spectrumIndex, rangeID) {\n  return (drfat.data[spectrumIndex] as Datum1D).ranges.values.findIndex(\n    (range) => range.id === rangeID,\n  );\n}\n\nfunction handleDeleteRange(draft: Draft<State>, action) {\n  const state = original(draft) as State;\n  if (state.activeSpectrum?.id) {\n    const { index } = state.activeSpectrum;\n    const { id, assignmentData } = action.payload;\n    const datum = draft.data[index] as Datum1D;\n    if (id) {\n      const range = datum.ranges.values.find((range) => range.id === id);\n      unlinkInAssignmentData(assignmentData, [range]);\n      const rangeIndex = getRangeIndex(state, index, id);\n      datum.ranges.values.splice(rangeIndex, 1);\n    } else {\n      unlinkInAssignmentData(assignmentData, datum.ranges.values);\n      datum.ranges.values = [];\n    }\n    updateIntegralRanges(draft.data[index]);\n    handleOnChangeRangesData(draft);\n  }\n}\n\nfunction handleChangeRangeSignalKind(draft: Draft<State>, action) {\n  const state = original(draft) as State;\n  if (state.activeSpectrum?.id) {\n    const { index } = state.activeSpectrum;\n    const { rowData, value } = action.payload;\n    const rangeIndex = getRangeIndex(state, index, rowData.id);\n    const _range = (draft.data[index] as Datum1D).ranges.values[\n      rangeIndex\n    ] as Range;\n    if (_range?.signal) {\n      (_range.signal[rowData.tableMetaInfo.signalIndex] as Signal).kind = value;\n      _range.kind = SignalKindsToInclude.includes(value)\n        ? DatumKind.signal\n        : DatumKind.mixed;\n      updateIntegralRanges(draft.data[index]);\n      handleOnChangeRangesData(draft);\n    }\n  }\n}\n\nfunction handleSaveEditedRange(draft: Draft<State>, action) {\n  const state = original(draft) as State;\n  if (state.activeSpectrum?.id) {\n    const { index } = state.activeSpectrum;\n    const { editedRowData, assignmentData } = action.payload;\n    // remove assignments in global state\n    const _editedRowData = unlink(editedRowData);\n    delete _editedRowData.tableMetaInfo;\n    // remove assignments in assignment hook data\n    // for now: clear all assignments for this range because signals or levels to store might have changed\n    unlinkInAssignmentData(assignmentData, _editedRowData);\n\n    const rangeIndex = getRangeIndex(state, index, _editedRowData.id);\n    (draft.data[index] as Datum1D).ranges.values[rangeIndex] = _editedRowData;\n    updateIntegralRanges(draft.data[index]);\n    handleOnChangeRangesData(draft);\n  }\n}\n\nfunction handleUnlinkRange(draft: Draft<State>, action) {\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n    const {\n      assignmentData,\n      rangeData = null,\n      signalIndex = -1,\n    } = action.payload;\n\n    // remove assignments in global state\n    if (rangeData) {\n      const rangeIndex = getRangeIndex(draft, index, rangeData.id);\n      const range = cloneDeep(\n        (draft.data[index] as Datum1D).ranges.values[rangeIndex],\n      );\n\n      let newRange: any = {};\n      let id = rangeData.id;\n      if (rangeData && signalIndex === -1) {\n        newRange = unlink(range, 'range');\n      } else {\n        newRange = unlink(range, 'signal', { signalIndex });\n        id = rangeData.signal[signalIndex].id;\n      }\n      // remove assignments in assignment hook data\n      unlinkInAssignmentData(assignmentData, [\n        {\n          id,\n        },\n      ]);\n      (draft.data[index] as Datum1D).ranges.values[rangeIndex] = newRange;\n    } else {\n      const ranges = (draft.data[index] as Datum1D).ranges.values.map(\n        (range) => {\n          return unlink(range);\n        },\n      );\n      (draft.data[index] as Datum1D).ranges.values = ranges;\n\n      unlinkInAssignmentData(assignmentData, ranges);\n    }\n  }\n}\n\nfunction handleSetDiaIDRange(draft, action) {\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n    const { rangeData, diaID, signalIndex } = action.payload;\n\n    const rangeIndex = getRangeIndex(draft, index, rangeData.id);\n    const _range = draft.data[index].ranges.values[rangeIndex];\n    if (signalIndex === undefined) {\n      _range.diaID = diaID;\n    } else {\n      _range.signal[signalIndex].diaID = diaID;\n    }\n    _range.pubIntegral = getPubIntegral(_range);\n  }\n}\n\nfunction handleResizeRange(draft: Draft<State>, action) {\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n    changeRange(draft.data[index], action.data);\n  }\n}\n\nfunction handleChangeRangeSum(draft: Draft<State>, value) {\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n    (draft.data[index] as Datum1D).ranges.options.sum = value;\n    updateIntegralRanges(draft.data[index]);\n  }\n}\nfunction handleAddRange(draft: Draft<State>, action) {\n  const { startX, endX } = action;\n  const range = getRange(draft, { startX, endX });\n\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n    const [from, to] = range;\n    addRange(draft.data[index], { from, to });\n    handleOnChangeRangesData(draft);\n  }\n}\n\nfunction handleChangeRangeRaltiveValue(draft, action) {\n  const { id: rangeID, value } = action;\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n    changeRangesRealtive(draft.data[index], rangeID, value);\n  }\n}\n\nfunction handleChangeRangeSignalValue(draft, action) {\n  const { rangeID, signalID, value } = action.payload;\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n\n    const shift = changeRangeSignal(\n      draft.data[index],\n      rangeID,\n      signalID,\n      value,\n    );\n    FiltersManager.applyFilter(draft.data[index], [\n      { name: Filters.shiftX.id, options: shift },\n    ]);\n\n    updateXShift(draft.data[index] as Datum1D);\n\n    handleOnChangeRangesData(draft);\n    setDomain(draft);\n  }\n}\n\nfunction handleOnChangeRangesData(draft) {\n  handleUpdateCorrelations(draft);\n}\n\nexport {\n  handleAutoRangesDetection,\n  handleDeleteRange,\n  handleChangeRangeSum,\n  handleAddRange,\n  handleResizeRange,\n  handleChangeRangeRaltiveValue,\n  handleChangeRangeSignalValue,\n  handleChangeRangeSignalKind,\n  handleSaveEditedRange,\n  handleUnlinkRange,\n  handleSetDiaIDRange,\n};\n","import { Draft, original } from 'immer';\nimport cloneDeep from 'lodash/cloneDeep';\n\nimport { Filters } from '../../../data/Filters';\nimport * as FiltersManager from '../../../data/FiltersManager';\nimport {\n  DatumKind,\n  SignalKindsToInclude,\n} from '../../../data/constants/SignalsKinds';\nimport {\n  changeZoneSignal,\n  Datum2D,\n  detectZones,\n  detectZonesManual,\n  updateShift,\n  Zone,\n} from '../../../data/data2d/Datum2D';\nimport {\n  getPubIntegral,\n  unlink,\n  unlinkInAssignmentData,\n} from '../../../data/utilities/ZoneUtilities';\nimport Events from '../../utility/Events';\nimport { State } from '../Reducer';\nimport get2DRange from '../helper/get2DRange';\n\n// eslint-disable-next-line import/order\nimport { handleUpdateCorrelations } from './CorrelationsActions';\n// import { AnalysisObj } from '../core/Analysis';\n\nimport { setDomain } from './DomainActions';\n\nlet noiseFactor = 1;\n\nEvents.on('noiseFactorChanged', (val) => {\n  noiseFactor = val;\n});\n\nfunction add2dZoneHandler(draft: Draft<State>, action) {\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n    const drawnZone = get2DRange(draft, action);\n    detectZonesManual(draft.data[index], {\n      selectedZone: drawnZone,\n      thresholdFactor: noiseFactor,\n      convolutionByFFT: false,\n    });\n    handleOnChangeZonesData(draft);\n  }\n}\nfunction handleAutoZonesDetection(draft: Draft<State>, detectionOptions) {\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n\n    const [fromX, toX] = draft.xDomain;\n    const [fromY, toY] = draft.yDomain;\n    detectionOptions.selectedZone = { fromX, toX, fromY, toY };\n\n    detectZones(draft.data[index], detectionOptions);\n    handleOnChangeZonesData(draft);\n  }\n}\n\nfunction changeZoneSignalDelta(draft: Draft<State>, action) {\n  const { zoneID, signal } = action.payload;\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n    const { xShift, yShift } = changeZoneSignal(\n      draft.data[index],\n      zoneID,\n      signal,\n    );\n    let filters: any = [];\n    if (xShift !== 0) {\n      filters.push({ name: Filters.shift2DX.id, options: xShift });\n    }\n    if (yShift !== 0) {\n      filters.push({ name: Filters.shift2DY.id, options: yShift });\n    }\n\n    FiltersManager.applyFilter(draft.data[index], filters);\n\n    updateShift(draft.data[index] as Datum2D);\n\n    setDomain(draft);\n    handleOnChangeZonesData(draft);\n  }\n}\n\nfunction getZoneIndex(state, spectrumIndex, zoneID) {\n  return state.data[spectrumIndex].zones.values.findIndex(\n    (zone) => zone.id === zoneID,\n  );\n}\n\nfunction handleChangeZoneSignalKind(draft: Draft<State>, action) {\n  const state = original(draft) as State;\n  if (state.activeSpectrum?.id) {\n    const { index } = state.activeSpectrum;\n    const { rowData, value } = action.payload;\n    const zoneIndex = getZoneIndex(state, index, rowData.id);\n    const _zone = (draft.data[index] as Datum2D).zones.values[\n      zoneIndex\n    ] as Zone;\n    _zone.signal[rowData.tableMetaInfo.signalIndex].kind = value;\n    _zone.kind = SignalKindsToInclude.includes(value)\n      ? DatumKind.signal\n      : DatumKind.mixed;\n    handleOnChangeZonesData(draft);\n  }\n}\n\nfunction handleDeleteZone(draft: Draft<State>, action) {\n  const state = original(draft) as State;\n  if (state.activeSpectrum?.id) {\n    const { index } = state.activeSpectrum;\n    const { id, assignmentData } = action.payload;\n    if (id) {\n      const zone = (draft.data[index] as Datum2D).zones.values.find(\n        (zone) => zone.id === id,\n      );\n      unlinkInAssignmentData(assignmentData, [zone]);\n      const zoneIndex = getZoneIndex(state, index, id);\n      (draft.data[index] as Datum2D).zones.values.splice(zoneIndex, 1);\n    } else {\n      unlinkInAssignmentData(\n        assignmentData,\n        (draft.data[index] as Datum2D).zones.values,\n      );\n      (draft.data[index] as Datum2D).zones.values = [];\n    }\n    handleOnChangeZonesData(draft);\n  }\n}\n\nfunction handleUnlinkZone(draft: Draft<State>, action) {\n  const state = original(draft) as State;\n  if (state.activeSpectrum?.id) {\n    const { index } = state.activeSpectrum;\n    const {\n      zoneData,\n      assignmentData,\n      isOnZoneLevel,\n      signalIndex,\n      axis,\n    } = action.payload;\n\n    for (let zone of zoneData\n      ? [zoneData]\n      : (state.data[index] as Datum2D).zones.values) {\n      // remove assignments in global state\n      const _zoneData = unlink(\n        cloneDeep(zone),\n        isOnZoneLevel,\n        signalIndex,\n        axis,\n      );\n      // remove assignments in assignment hook data\n      if (isOnZoneLevel) {\n        unlinkInAssignmentData(assignmentData, [{ id: _zoneData.id }], axis);\n      } else {\n        unlinkInAssignmentData(\n          assignmentData,\n          [{ id: _zoneData.signal[signalIndex].id }],\n          axis,\n        );\n      }\n\n      const zoneIndex = getZoneIndex(state, index, _zoneData.id);\n      (draft.data[index] as Datum2D).zones.values[zoneIndex] = _zoneData;\n    }\n  }\n}\n\nfunction handleSetDiaIDZone(draft: Draft<State>, action) {\n  const state = original(draft) as State;\n  if (state.activeSpectrum?.id) {\n    const { index } = state.activeSpectrum;\n    const { zoneData, diaID, axis, signalIndex } = action.payload;\n\n    const zoneIndex = getZoneIndex(state, index, zoneData.id);\n    const _zone = (draft.data[index] as Datum2D).zones.values[\n      zoneIndex\n    ] as Zone;\n    if (signalIndex === undefined) {\n      _zone[axis].diaID = diaID;\n    } else {\n      _zone.signal[signalIndex][axis].diaID = diaID;\n    }\n    _zone[axis].pubIntegral = getPubIntegral(_zone, axis);\n  }\n}\n\nfunction handleOnChangeZonesData(draft) {\n  handleUpdateCorrelations(draft);\n}\n\nexport {\n  add2dZoneHandler,\n  handleAutoZonesDetection,\n  handleDeleteZone,\n  changeZoneSignalDelta,\n  handleChangeZoneSignalKind,\n  handleUnlinkZone,\n  handleSetDiaIDZone,\n};\n","import { get2DXScale, get2DYScale } from '../../2d/utilities/scale';\n\nexport default function get2DRange(draft, options) {\n  const { startX, startY, endX, endY } = options;\n  const scaleX = get2DXScale(draft);\n  const scaleY = get2DYScale(draft);\n  const x1 = startX * 1000000 > endX * 1000000 ? endX : startX;\n  const x2 = startX * 1000000 > endX * 1000000 ? startX : endX;\n  const y1 = startY * 1000000 > endY * 1000000 ? endY : startY;\n  const y2 = startY * 1000000 > endY * 1000000 ? startY : endY;\n\n  const fromY = scaleY.invert(y1);\n  const fromX = scaleX.invert(x1);\n  const toY = scaleY.invert(y2);\n  const toX = scaleX.invert(x2);\n  return { fromX, fromY, toX, toY };\n}\n","import { Draft } from 'immer';\nimport { signalsToXY } from 'nmr-processing';\n\nimport {\n  initiateDatum1D,\n  mapRanges,\n  updateIntegralRanges,\n} from '../../../data/data1d/Datum1D';\nimport * as MoleculeManager from '../../../data/molecules/MoleculeManager';\nimport { State } from '../Reducer';\nimport { DISPLAYER_MODE } from '../core/Constants';\n\nimport { handleUnlinkRange } from './RangesActions';\nimport { setActiveTab } from './ToolsActions';\nimport { handleUnlinkZone } from './ZonesActions';\nimport { initZoom1DHandler, setZoom } from './Zoom';\n\nfunction addMoleculeHandler(draft: Draft<State>, molfile) {\n  MoleculeManager.addMolfile(draft.molecules, molfile);\n}\n\nfunction setMoleculeHandler(draft: Draft<State>, molfile, key) {\n  MoleculeManager.setMolfile(draft.molecules, molfile, key);\n}\n\nfunction deleteMoleculeHandler(draft: Draft<State>, action) {\n  const { key, assignmentData } = action.payload;\n  if (draft.displayerMode === DISPLAYER_MODE.DM_1D) {\n    handleUnlinkRange(draft, { payload: { assignmentData, rangeData: null } });\n  }\n  if (draft.displayerMode === DISPLAYER_MODE.DM_2D) {\n    handleUnlinkZone(draft, { payload: { assignmentData, zoneData: null } });\n  }\n  const moleculeIndex = draft.molecules.findIndex(\n    (molecule) => molecule.key === key,\n  );\n\n  draft.molecules.splice(moleculeIndex, 1);\n}\n\nfunction predictSpectraFromMolculeHandler(draft: Draft<State>, action) {\n  const { fromMolfile, options } = action.payload;\n  const { x, y } = signalsToXY(fromMolfile.signals, {});\n  let id: any = null;\n  if (options.spectra['1h']) {\n    const datum = initiateDatum1D({\n      data: { x, im: null, re: y },\n      info: { nucleus: '1H' },\n    });\n    id = datum.id;\n    datum.ranges.values = mapRanges(fromMolfile.ranges, datum);\n    updateIntegralRanges(datum);\n    draft.data.push(datum);\n    const activeSpectrum = { id, index: draft.data.length - 1 };\n    draft.tabActiveSpectrum['1H'] = activeSpectrum;\n    draft.activeSpectrum = activeSpectrum;\n  }\n  setActiveTab(draft);\n  initZoom1DHandler(draft.data);\n  setZoom(draft, 0.9, id);\n\n  draft.isLoading = false;\n}\n\nexport {\n  addMoleculeHandler,\n  setMoleculeHandler,\n  deleteMoleculeHandler,\n  predictSpectraFromMolculeHandler,\n};\n","import { Draft, original } from 'immer';\nimport { xFindClosestIndex } from 'ml-spectra-processing';\n\nimport { lookupPeak, Datum1D, getShiftX } from '../../../data/data1d/Datum1D';\nimport autoPeakPicking from '../../../data/data1d/autoPeakPicking';\nimport generateID from '../../../data/utilities/generateID';\nimport { options } from '../../toolbar/ToolTypes';\nimport { State } from '../Reducer';\nimport getRange from '../helper/getRange';\n\n// import { AnalysisObj } from '../core/Analysis';\n\nfunction addPeak(draft: Draft<State>, mouseCoordinates) {\n  const state = original(draft) as State;\n  if (draft.activeSpectrum?.id && state) {\n    const { index } = draft.activeSpectrum;\n    const xShift = 10;\n    const startX = mouseCoordinates.x - xShift;\n    const endX = mouseCoordinates.x + xShift;\n    const [from, to] = getRange(draft, { startX, endX });\n    const candidatePeak = lookupPeak(state.data[index].data, { from, to });\n\n    const shiftX = getShiftX(draft.data[index] as Datum1D);\n\n    if (candidatePeak) {\n      const peak = {\n        id: generateID(),\n        originDelta: candidatePeak.x - shiftX,\n        delta: candidatePeak.x,\n        intensity: candidatePeak.y,\n      };\n      (draft.data[index] as Datum1D).peaks.values.push(peak);\n    }\n  }\n}\n\nfunction addPeaks(draft: Draft<State>, action) {\n  const state = original(draft) as State;\n\n  if (draft.activeSpectrum) {\n    const { index } = draft.activeSpectrum;\n    const datumOriginal = state.data[index] as Datum1D;\n\n    const { startX, endX } = action;\n    const [from, to] = getRange(draft, { startX, endX });\n\n    if (from !== to) {\n      const peak = lookupPeak(datumOriginal.data, { from, to });\n\n      const shiftX = getShiftX(draft.data[index] as Datum1D);\n\n      if (peak && !datumOriginal.peaks.values.some((p) => p.delta === peak.x)) {\n        const newPeak = {\n          id: generateID(),\n          originDelta: peak.x - shiftX,\n          delta: peak.x,\n          intensity: peak.y,\n        };\n        (draft.data[index] as Datum1D).peaks.values.push(newPeak);\n      }\n    }\n  }\n}\n\nfunction deletePeak(draft: Draft<State>, peakData) {\n  const { index } = draft.activeSpectrum;\n  const state = original(draft) as State;\n\n  if (peakData == null) {\n    (draft.data[index] as Datum1D).peaks.values = [];\n  } else {\n    const peakIndex = (state.data[index] as Datum1D).peaks.values.findIndex(\n      (p) => p.id === peakData.id,\n    );\n    (draft.data[index] as Datum1D).peaks.values.splice(peakIndex, 1);\n  }\n}\n\nfunction handleAutoPeakPicking(draft: Draft<State>, autOptions) {\n  if (draft.activeSpectrum?.id) {\n    draft.selectedTool = options.zoom.id;\n    draft.selectedOptionPanel = null;\n    const { index } = draft.activeSpectrum;\n    const datum = draft.data[index] as Datum1D;\n\n    const [from, to] = draft.xDomain;\n    const windowFromIndex = xFindClosestIndex(datum.data.x, from);\n    const windowToIndex = xFindClosestIndex(datum.data.x, to);\n\n    const peaks = autoPeakPicking(draft.data[index], {\n      ...autOptions,\n      windowFromIndex,\n      windowToIndex,\n    });\n\n    datum.peaks.values = datum.peaks.values.concat(peaks);\n  }\n}\n\nexport { addPeak, addPeaks, deletePeak, handleAutoPeakPicking };\n","import median from 'ml-array-median';\nimport { xyAutoPeaksPicking } from 'nmr-processing';\n\nimport { getShiftX } from '../data1d/Datum1D';\nimport generateID from '../utilities/generateID';\n\nexport default function autoPeakPicking(datum1D, options) {\n  const {\n    minMaxRatio,\n    maxNumberOfPeaks,\n    noiseFactor,\n    lookNegative,\n    windowFromIndex,\n    windowToIndex,\n  } = options;\n  // we calculate the noise but this could be improved\n  const noise = median(datum1D.data.re.map((y) => Math.abs(y)));\n\n  let { re, x } = datum1D.data;\n\n  if (windowFromIndex !== undefined && windowToIndex !== undefined) {\n    x = x.slice(windowFromIndex, windowToIndex);\n    re = re.slice(windowFromIndex, windowToIndex);\n  }\n\n  let peaks = xyAutoPeaksPicking(\n    { x, y: re },\n    {\n      lookNegative,\n      noiseLevel: noise * noiseFactor,\n      minMaxRatio: minMaxRatio, // Threshold to determine if a given peak should be considered as a noise\n      realTopDetection: true,\n      maxCriteria: true,\n      smoothY: false,\n      sgOptions: { windowSize: 15, polynomial: 3 },\n    },\n  );\n  peaks.sort((a, b) => b.y - a.y);\n  if (maxNumberOfPeaks < peaks.length) peaks = peaks.slice(0, maxNumberOfPeaks);\n\n  const shiftX = getShiftX(datum1D);\n\n  const error = (x[x.length - 1] - x[0]) / 10000;\n\n  return peaks.reduce((acc, newPeak) => {\n    // check if the peak is already exists\n    for (const { delta } of datum1D.peaks.values) {\n      if (Math.abs(newPeak.x - delta) < error) {\n        return acc;\n      }\n    }\n\n    acc.push({\n      id: generateID(),\n      originDelta: newPeak.x - shiftX,\n      delta: newPeak.x,\n      intensity: newPeak.y,\n      width: newPeak.width,\n    });\n\n    return acc;\n  }, []);\n}\n","import { Draft } from 'immer';\n\nimport * as MulitpleAnalysis from '../../../data/data1d/MulitpleAnalysis';\nimport { State } from '../Reducer';\nimport getRange from '../helper/getRange';\n\nfunction analyzeSpectra(draft: Draft<State>, action) {\n  const [from, to] = getRange(draft, action);\n  MulitpleAnalysis.analyzeSpectra(draft.data, draft.spectraAnalysis, {\n    from,\n    to,\n    nucleus: draft.activeTab,\n  });\n}\n\nfunction handleDeleteSpectraRanges(draft: Draft<State>, action) {\n  const { colKey } = action;\n  MulitpleAnalysis.deleteSpectraAnalysis(\n    draft.spectraAnalysis,\n    colKey,\n    draft.activeTab,\n  );\n}\nfunction handleResizeSpectraRange(draft: Draft<State>, action) {\n  const { columnKey, from, to } = action.payload;\n  MulitpleAnalysis.analyzeSpectra(draft.data, draft.spectraAnalysis, {\n    from,\n    to,\n    nucleus: draft.activeTab,\n    columnKey,\n  });\n}\nfunction handleSetcolumns(draft: Draft<State>, action) {\n  const data = action.payload;\n  MulitpleAnalysis.setColumn(draft.spectraAnalysis, draft.activeTab, data);\n}\nfunction handleFiltercolumn(draft: Draft<State>, action) {\n  const { columnKey, valueKey } = action.payload;\n  MulitpleAnalysis.changeColumnValueKey(\n    draft.spectraAnalysis,\n    draft.activeTab,\n    columnKey,\n    valueKey,\n  );\n}\n\nexport {\n  analyzeSpectra,\n  handleDeleteSpectraRanges,\n  handleResizeSpectraRange,\n  handleSetcolumns,\n  handleFiltercolumn,\n};\n","import { xyCalibrate } from 'ml-spectra-processing';\n\nimport { getRange } from '../constants/References';\n/**\n *\n * @param {*} datum1D\n * @param {object} [options={}]\n * @param {number} [options.from]\n * @param {number} [options.to] Define the from zone where the reference is expected to be found\n * @param {number} [options.from]\n * @param {number} [options.nbPeaks]\n * @param {number} [options.targetX]\n * @param {string} [options.reference]\n */\n\nexport default function getReferenceShift(datum1D, options) {\n  let { from, to, nbPeaks, targetX, reference } = options;\n  if (reference) {\n    let data = getRange({ reference: reference, nucleus: datum1D.nucleus });\n    from = data.from;\n    to = data.to;\n    nbPeaks = data.nbPeaks;\n    targetX = data.delta;\n  }\n\n  const { re, x } = datum1D.data;\n  return xyCalibrate({ x, y: re }, { from, to }, { nbPeaks, targetX });\n}\n","import { Draft, original } from 'immer';\n\nimport { Filters } from '../../../data/Filters';\nimport { applyFilter } from '../../../data/FiltersManager';\nimport { Datum1D } from '../../../data/data1d/Datum1D';\nimport getReferenceShift from '../../../data/data1d/getReferenceShift';\nimport { getMissingProjection, Datum2D } from '../../../data/data2d/Datum2D';\nimport GroupByInfoKey from '../../utility/GroupByInfoKey';\nimport { State } from '../Reducer';\n\nimport { setDomain, setMode } from './DomainActions';\nimport { setTab, setActiveTab } from './ToolsActions';\n\nfunction checkIsVisible2D(datum: Datum2D): boolean {\n  if (\n    datum.display.isPositiveVisible === false &&\n    datum.display.isNegativeVisible === false\n  ) {\n    return false;\n  }\n  return true;\n}\n\nfunction setVisible(datum, flag) {\n  if (datum.info.dimension === 2) {\n    (datum as Datum2D).display.isPositiveVisible = flag;\n    (datum as Datum2D).display.isNegativeVisible = flag;\n    (datum as Datum2D).display.isVisible = checkIsVisible2D(datum as Datum2D);\n  } else {\n    (datum as Datum1D).display.isVisible = flag;\n  }\n}\n\nfunction handleSpectrumVisibility(draft: Draft<State>, action) {\n  if (Array.isArray(action.id)) {\n    const IDs = action.id;\n    if (IDs.length === 0) {\n      for (const datum of draft.data) {\n        setVisible(datum, false);\n      }\n    } else {\n      for (const datum of draft.data) {\n        if (IDs.includes(datum.id)) {\n          setVisible(datum, true);\n        } else {\n          setVisible(datum, false);\n        }\n      }\n    }\n  } else {\n    const index = draft.data.findIndex((d) => d.id === action.id);\n    (draft.data[index] as Datum1D | Datum2D).display[action.key] = action.value;\n\n    if ((draft.data[index] as Datum1D | Datum2D).info.dimension === 2) {\n      (draft.data[index] as Datum2D).display.isVisible = checkIsVisible2D(\n        draft.data[index] as Datum2D,\n      );\n    }\n  }\n}\n\nfunction handleChangePeaksMarkersVisibility(draft: Draft<State>, data) {\n  for (let datum of draft.data) {\n    if (\n      datum.info?.dimension === 1 &&\n      data.some((activeData) => activeData.id === datum.id)\n    ) {\n      (datum as Datum1D).display.isPeaksMarkersVisible = true;\n    } else {\n      (datum as Datum1D).display.isPeaksMarkersVisible = false;\n    }\n  }\n}\n\nfunction handleChangeActiveSpectrum(draft: Draft<State>, activeSpectrum) {\n  // const state = original(draft);\n\n  let refreshDomain = false;\n  if (activeSpectrum) {\n    // AnalysisObj.getDatum(activeSpectrum.id).setDisplay({ isVisible: true });\n    const newIndex = draft.data.findIndex((d) => d.id === activeSpectrum.id);\n    const oldIndex = draft.data.findIndex(\n      (d) => d.id === draft.activeSpectrum?.id,\n    );\n    if (newIndex !== -1) {\n      const newActiveSpectrum = draft.data[newIndex] as Datum1D | Datum2D;\n\n      newActiveSpectrum.display.isVisible = true;\n\n      if (oldIndex !== -1) {\n        refreshDomain =\n          (draft.data[oldIndex] as Datum1D | Datum2D).info.isFid ===\n          newActiveSpectrum.info.isFid\n            ? false\n            : true;\n      } else {\n        refreshDomain = newActiveSpectrum.info.isFid || false;\n      }\n    }\n    activeSpectrum = { ...activeSpectrum, index: newIndex };\n    draft.activeSpectrum = activeSpectrum;\n    draft.tabActiveSpectrum[draft.activeTab] = activeSpectrum;\n  } else {\n    draft.activeSpectrum = null;\n    draft.tabActiveSpectrum[draft.activeTab] = null;\n    refreshDomain = false;\n  }\n\n  /**\n   * if the active spectrum not is FID then dont refresh the domain and the mode when the first time you activate soectrum\n   * if the new active spectrum different than the previous active spectrum fid then refresh the domain andf the mode.\n   */\n  if (refreshDomain) {\n    setDomain(draft);\n    // const tab = draft.activeTab;\n    // delete draft.tabActiveSpectrum[tab];\n    setMode(draft);\n  }\n}\n\nfunction changeSpectrumSetting(draft: Draft<State>, { id, display }) {\n  const state = original(draft) as State;\n  const index = state.data.findIndex((d) => d.id === id);\n  if (index !== -1) {\n    draft.data[index].display = display;\n  }\n}\nfunction handleChangeSpectrumColor(draft: Draft<State>, { id, color, key }) {\n  const state = original(draft) as State;\n  const index = state.data.findIndex((d) => d.id === id);\n  if (index !== -1) {\n    (draft.data[index] as Datum1D | Datum2D).display[key] = color;\n  }\n}\n\nfunction handleDeleteSpectra(draft: Draft<State>, action) {\n  const { activeTab } = draft;\n  const state = original(draft) as State;\n  if (action.id) {\n    const index = state.data.findIndex((d) => d.id === action.id);\n    draft.data.splice(index, 1);\n  } else {\n    draft.data.forEach((datum, index) => {\n      draft.data.splice(index, 1);\n    });\n  }\n  draft.activeSpectrum = null;\n  setActiveTab(draft, activeTab, true);\n}\nfunction addMissingProjectionHander(draft, action) {\n  const state = original(draft);\n  const nucleus = action.nucleus;\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n    for (let n of nucleus) {\n      const datum1D = getMissingProjection(state.data[index], n);\n      draft.data.push(datum1D);\n    }\n    const groupByNucleus = GroupByInfoKey('nucleus');\n    const dataGroupByNucleus = groupByNucleus(draft.data);\n    setTab(draft, dataGroupByNucleus, draft.activeTab, true);\n    setDomain(draft);\n    setMode(draft);\n  }\n}\nfunction alignSpectraHandler(draft: Draft<State>, action) {\n  if (draft.data && draft.data.length > 0) {\n    for (let datum of draft.data) {\n      if (\n        datum.info?.dimension === 1 &&\n        datum.info.nucleus === draft.activeTab &&\n        !datum.info?.isFid\n      ) {\n        const shift = getReferenceShift(datum, { ...action.payload });\n        applyFilter(datum, [\n          {\n            name: Filters.shiftX.id,\n            options: shift,\n          },\n        ]);\n      }\n    }\n  }\n\n  setDomain(draft);\n  setMode(draft);\n}\n\nexport {\n  handleSpectrumVisibility,\n  handleChangePeaksMarkersVisibility,\n  handleChangeActiveSpectrum,\n  handleChangeSpectrumColor,\n  changeSpectrumSetting,\n  handleDeleteSpectra,\n  addMissingProjectionHander,\n  alignSpectraHandler,\n};\n","export const UNDO = 'undo';\nexport const REDO = 'redo';\nexport const SET = 'set';\nexport const RESET = 'reset';\n","import { produce } from 'immer';\nimport { buildCorrelationData, Types } from 'nmr-correlation';\nimport { predictionProton } from 'nmr-processing';\nimport OCL from 'openchemlib/full';\n\nimport * as SpectraManager from '../../data/SpectraManager';\nimport { Spectra } from '../NMRium';\nimport { DefaultTolerance } from '../panels/SummaryPanel/CorrelationTable/Constants';\nimport { options } from '../toolbar/ToolTypes';\nimport { nmredataToNmrium } from '../utility/nmredataToNmrium';\n\nimport * as CorrelationsActions from './actions/CorrelationsActions';\nimport { setWidth, handleSetDimensions } from './actions/DimensionsActions';\nimport * as DomainActions from './actions/DomainActions';\nimport * as FiltersActions from './actions/FiltersActions';\nimport * as GlobalActions from './actions/GlobalActions';\nimport {\n  handleHistoryUndo,\n  handleHistoryRedo,\n  handleHistoryReset,\n} from './actions/HistoryActions';\nimport * as IntegralsActions from './actions/IntegralsActions';\nimport * as LoadActions from './actions/LoadActions';\nimport * as MoleculeActions from './actions/MoleculeActions';\nimport * as PeaksActions from './actions/PeaksActions';\nimport {\n  handelSetPreferences,\n  setKeyPreferencesHandler,\n  applyKeyPreferencesHandler,\n} from './actions/PreferencesActions';\nimport * as RangesActions from './actions/RangesActions';\nimport * as SpectraAanalysisActions from './actions/SpectraAanalysisAction';\nimport * as SpectrumsActions from './actions/SpectrumsActions';\nimport * as ToolsActions from './actions/ToolsActions';\nimport * as ZonesActions from './actions/ZonesActions';\nimport { DEFAULT_YAXIS_SHIFT_VALUE, DISPLAYER_MODE } from './core/Constants';\nimport { UNDO, REDO, RESET } from './types/HistoryTypes';\nimport * as types from './types/Types';\n\nexport const initialState = {\n  data: null,\n  contours: null,\n  tempData: null,\n  xDomain: [],\n  yDomain: [],\n  yDomains: {},\n  xDomains: {},\n  originDomain: {},\n  integralsYDomains: {},\n  originIntegralYDomain: {},\n  selectedTool: options.zoom.id,\n  selectedFilter: null,\n  selectedOptionPanel: null,\n  activeTab: null,\n  width: 0,\n  height: 0,\n  margin: {\n    top: 10,\n    right: 20,\n    bottom: 70,\n    left: 0,\n  },\n  activeSpectrum: null,\n  mode: 'RTL',\n  zoomFactor: { scale: 1 },\n  integralZoomFactor: { scale: 0.5 },\n  molecules: [],\n  verticalAlign: {\n    flag: false,\n    stacked: false,\n    value: DEFAULT_YAXIS_SHIFT_VALUE,\n  },\n  history: {\n    past: [],\n    present: null,\n    future: [],\n    hasUndo: false,\n    hasRedo: false,\n  },\n  pivot: 0,\n  isLoading: false,\n  preferences: {},\n  baseLineZones: [],\n  keysPreferences: {},\n  displayerMode: DISPLAYER_MODE.DM_1D,\n  tabActiveSpectrum: {},\n  spectraAnalysis: {},\n  correlations: buildCorrelationData([], {\n    tolerance: DefaultTolerance,\n  }),\n  displayerKey: '',\n  ZoomHistory: {},\n  overDisplayer: false,\n  exclusionZones: {},\n};\n\nexport interface State {\n  data: Spectra;\n  contours: any;\n  tempData: any;\n  xDomain: Array<number>;\n  yDomain: Array<number>;\n  yDomains: any;\n  xDomains: any;\n  originDomain: any;\n  integralsYDomains: any;\n  originIntegralYDomain: any;\n  selectedTool: any;\n  selectedFilter: any;\n  selectedOptionPanel: any;\n  activeTab: any;\n  width: any;\n  height: any;\n  margin: Partial<{ top: number; right: number; bottom: number; left: number }>;\n  activeSpectrum: any;\n  mode: string;\n  zoomFactor: Partial<{ scale: number }>;\n  integralZoomFactor: Partial<{ scale: number }>;\n  molecules: Array<any>;\n  verticalAlign: Partial<{\n    flag: boolean;\n    stacked: boolean;\n    value: number;\n  }>;\n  history: Partial<{\n    past: Array<any>;\n    present: any;\n    future: Array<any>;\n    hasUndo: boolean;\n    hasRedo: boolean;\n  }>;\n  pivot: number;\n  isLoading: boolean;\n  preferences: any;\n  baseLineZones: any;\n  keysPreferences: any;\n  displayerMode: any;\n  tabActiveSpectrum: any;\n  spectraAnalysis: any;\n  displayerKey: any;\n  correlations: Types.CorrelationData;\n  ZoomHistory: any;\n  overDisplayer: boolean;\n  exclusionZones: {\n    [key: string]: Array<{ id: string; from: number; to: number }>;\n  };\n}\n\nexport function dispatchMiddleware(dispatch) {\n  return (action) => {\n    switch (action.type) {\n      case types.INITIATE: {\n        if (action.payload) {\n          const { spectra, ...res } = action.payload;\n          void SpectraManager.fromJSON(spectra).then((data) => {\n            action.payload = { spectra: data, ...res };\n            dispatch(action);\n          });\n        } else {\n          dispatch(action);\n        }\n        break;\n      }\n      case types.LOAD_JSON_FILE: {\n        const data = JSON.parse(action.files[0].binary.toString());\n        void SpectraManager.fromJSON(data.spectra).then((spectra) => {\n          action.payload = Object.assign(data, { spectra });\n          dispatch(action);\n        });\n        break;\n      }\n      case types.LOAD_ZIP_FILE: {\n        for (let zipFile of action.files) {\n          void SpectraManager.addBruker(\n            { display: { name: zipFile.name } },\n            zipFile.binary,\n          ).then((data) => {\n            action.payload = data;\n            dispatch(action);\n          });\n        }\n        break;\n      }\n      case types.LOAD_NMREDATA_FILE: {\n        void nmredataToNmrium(action.file).then((data) => {\n          action.payload = data;\n          dispatch(action);\n        });\n        break;\n      }\n      case types.PREDICT_SPECTRA: {\n        const molecule = OCL.Molecule.fromMolfile(action.payload.mol.molfile);\n        void predictionProton(molecule, {}).then((result) => {\n          action.payload.fromMolfile = result;\n          dispatch(action);\n        });\n\n        break;\n      }\n\n      default:\n        dispatch(action);\n\n        break;\n    }\n  };\n}\n\nfunction innerSpectrumReducer(draft, action) {\n  draft.actionType = action.type;\n  switch (action.type) {\n    case types.INITIATE:\n      return LoadActions.initiate(draft, action);\n    case types.SET_LOADING_FLAG:\n      return LoadActions.setIsLoading(draft, action.isLoading);\n    case types.LOAD_JSON_FILE:\n      return LoadActions.handleLoadJsonFile(draft, action);\n    case types.LOAD_JCAMP_FILE:\n      return LoadActions.loadJcampFile(draft, action.files);\n    case types.LOAD_JDF_FILE:\n      return LoadActions.loadJDFFile(draft, action.files);\n    case types.LOAD_MOL_FILE:\n      return LoadActions.handleLoadMOLFile(draft, action.files);\n    case types.LOAD_ZIP_FILE:\n      return LoadActions.handleLoadZIPFile(draft, action);\n    case types.LOAD_NMREDATA_FILE:\n      return LoadActions.handleLoadNmredata(draft, action);\n    case types.ADD_PEAK:\n      return PeaksActions.addPeak(draft, action.mouseCoordinates);\n    case types.ADD_PEAKS:\n      return PeaksActions.addPeaks(draft, action);\n\n    case types.DELETE_PEAK_NOTATION:\n      return PeaksActions.deletePeak(draft, action.data);\n\n    case types.ADD_INTEGRAL:\n      return IntegralsActions.addIntegral(draft, action);\n    case types.DELETE_INTEGRAL:\n      return IntegralsActions.deleteIntegral(draft, action);\n    case types.CHANGE_INTEGRAL_DATA:\n      return IntegralsActions.changeIntegral(draft, action);\n    case types.RESIZE_INTEGRAL:\n      return IntegralsActions.changeIntegral(draft, action);\n    case types.CHANGE_INTEGRAL_ZOOM:\n      return IntegralsActions.handleChangeIntegralZoom(draft, action);\n    case types.CHANGE_INTEGRAL_SUM:\n      return IntegralsActions.handleChangeIntegralSum(draft, action.value);\n    case types.CHANGE_INTEGRAL_RELATIVE:\n      return IntegralsActions.handleChangeIntegralsRaltiveValue(draft, action);\n\n    case types.SET_ORIGINAL_DOMAIN:\n      return DomainActions.setOriginalDomain(draft, action.domain);\n\n    case types.SET_X_DOMAIN:\n      return DomainActions.setXDomain(draft, action.xDomain);\n\n    case types.SET_Y_DOMAIN:\n      return DomainActions.setYDomain(draft, action.yDomain);\n\n    case types.SET_WIDTH:\n      return setWidth(draft, action.width);\n\n    case types.SET_DIMENSIONS:\n      return handleSetDimensions(draft, action.width, action.height);\n\n    case types.SET_SELECTED_TOOL:\n      return ToolsActions.setSelectedTool(draft, action.selectedTool);\n    case types.RESET_SELECTED_TOOL:\n      return ToolsActions.resetSelectedTool(draft);\n    case types.SET_SELECTED_OPTIONS_PANEL:\n      return ToolsActions.setSelectedOptionPanel(\n        draft,\n        action.selectedOptionPanel,\n      );\n    case types.FULL_ZOOM_OUT:\n      return ToolsActions.zoomOut(draft, action);\n    case types.SHIFT_SPECTRUM:\n      return FiltersActions.shiftSpectrumAlongXAxis(draft, action.shiftValue);\n    case types.APPLY_ZERO_FILLING_FILTER:\n      return FiltersActions.applyZeroFillingFilter(draft, action.value);\n    case types.APPLY_FFT_FILTER:\n      return FiltersActions.applyFFTFilter(draft);\n    case types.APPLY_MANUAL_PHASE_CORRECTION_FILTER:\n      return FiltersActions.applyManualPhaseCorrectionFilter(\n        draft,\n        action.value,\n      );\n    case types.APPLY_AUTO_PHASE_CORRECTION_FILTER:\n      return FiltersActions.applyAutoPhaseCorrectionFilter(draft);\n    case types.APPLY_ABSOLUTE_FILTER:\n      return FiltersActions.applyAbsoluteFilter(draft);\n    case types.CALCULATE_MANUAL_PHASE_CORRECTION_FILTER:\n      return FiltersActions.calculateManualPhaseCorrection(draft, action.value);\n    case types.ENABLE_FILTER:\n      return FiltersActions.enableFilter(draft, action.id, action.checked);\n    case types.DELETE_FILTER:\n      return FiltersActions.deleteFilter(draft, action);\n    case types.DELETE_SPECTRA_FILTER:\n      return FiltersActions.deleteSpectraFilter(draft, action);\n    case types.SET_FILTER_SNAPSHOT:\n      return FiltersActions.filterSnapshotHandler(draft, action);\n    case types.APPLY_MULTIPLE_SPECTRA_FILTER:\n      return FiltersActions.handleMultipleSpectraFilter(draft, action);\n\n    case types.CHANGE_VISIBILITY:\n      return SpectrumsActions.handleSpectrumVisibility(draft, action);\n\n    case types.CHANGE_PEAKS_MARKERS_VISIBILITY:\n      return SpectrumsActions.handleChangePeaksMarkersVisibility(\n        draft,\n        action.data,\n      );\n    case types.CHANGE_ACTIVE_SPECTRUM:\n      return SpectrumsActions.handleChangeActiveSpectrum(draft, action.data);\n    case types.CHANGE_SPECTRUM_COLOR:\n      return SpectrumsActions.handleChangeSpectrumColor(draft, action.data);\n    case types.CHANGE_SPECTRUM_SETTING:\n      return SpectrumsActions.changeSpectrumSetting(draft, action);\n    case types.ALIGN_SPECTRA:\n      return SpectrumsActions.alignSpectraHandler(draft, action);\n    case types.TOGGLE_REAL_IMAGINARY_VISIBILITY:\n      return ToolsActions.handleToggleRealImaginaryVisibility(draft);\n    case types.SET_ZOOM_FACTOR:\n      return ToolsActions.handleZoom(draft, action);\n    case types.SET_SPECTRA_SAME_TOP:\n      return ToolsActions.setSpectraSameTopHandler(draft);\n    case types.RESET_SPECTRA_SCALE:\n      return ToolsActions.resetSpectraScale(draft);\n\n    case types.CHANGE_SPECTRUM_DISPLAY_VIEW_MODE:\n      return ToolsActions.handleChangeSpectrumDisplayMode(draft);\n\n    case types.ADD_MOLECULE:\n      return MoleculeActions.addMoleculeHandler(draft, action.molfile);\n\n    case types.SET_MOLECULE:\n      return MoleculeActions.setMoleculeHandler(\n        draft,\n        action.molfile,\n        action.key,\n      );\n\n    case types.DELETE_MOLECULE:\n      return MoleculeActions.deleteMoleculeHandler(draft, action);\n\n    case types.PREDICT_SPECTRA:\n      return MoleculeActions.predictSpectraFromMolculeHandler(draft, action);\n\n    case types.SET_CORRELATIONS_MF:\n      return CorrelationsActions.handleSetMF(draft, action.payload);\n\n    case types.SET_CORRELATIONS_TOLERANCE:\n      return CorrelationsActions.handleSetTolerance(draft, action.payload);\n\n    case types.SET_CORRELATION:\n      return CorrelationsActions.handleSetCorrelation(draft, action.payload);\n\n    case types.SET_CORRELATIONS:\n      return CorrelationsActions.handleSetCorrelations(draft, action.payload);\n\n    case types.DELETE_SPECTRA:\n      return SpectrumsActions.handleDeleteSpectra(draft, action);\n\n    case types.SET_INTEGRAL_Y_DOMAIN:\n      return DomainActions.handleChangeIntegralYDomain(draft, action.yDomain);\n\n    case types.BRUSH_END:\n      return ToolsActions.handleBrushEnd(draft, action);\n\n    case types.SET_VERTICAL_INDICATOR_X_POSITION:\n      return ToolsActions.setVerticalIndicatorXPosition(draft, action.position);\n    case types.SET_SPECTRUMS_VERTICAL_ALIGN:\n      return ToolsActions.setSpectrumsVerticalAlign(draft);\n\n    case types.AUTO_PEAK_PICKING:\n      return PeaksActions.handleAutoPeakPicking(draft, action.options);\n\n    case types.AUTO_ZONES_DETECTION:\n      return ZonesActions.handleAutoZonesDetection(draft, action.options);\n    case types.AUTO_RANGES_DETECTION:\n      return RangesActions.handleAutoRangesDetection(draft, action.options);\n    case types.ADD_RANGE:\n      return RangesActions.handleAddRange(draft, action);\n    case types.DELETE_RANGE:\n      return RangesActions.handleDeleteRange(draft, action);\n    case types.RESIZE_RANGE:\n      return RangesActions.handleResizeRange(draft, action);\n    case types.CHANGE_RANGE_SUM:\n      return RangesActions.handleChangeRangeSum(draft, action.value);\n    case types.CHANGE_RANGE_RELATIVE:\n      return RangesActions.handleChangeRangeRaltiveValue(draft, action);\n    case types.CHANGE_RANGE_SIGNAL_VALUE:\n      return RangesActions.handleChangeRangeSignalValue(draft, action);\n    case types.CHANGE_RANGE_SIGNAL_KIND:\n      return RangesActions.handleChangeRangeSignalKind(draft, action);\n    case types.SAVE_EDITED_RANGE:\n      return RangesActions.handleSaveEditedRange(draft, action);\n    case types.UNLINK_RANGE:\n      return RangesActions.handleUnlinkRange(draft, action);\n    case types.SET_DIAID_RANGE:\n      return RangesActions.handleSetDiaIDRange(draft, action);\n\n    case types.SET_PREFERENCES:\n      return handelSetPreferences(draft, action.data);\n    case types.SET_ACTIVE_TAB:\n      return ToolsActions.handelSetActiveTab(draft, action.tab);\n    case types.ADD_BASE_LINE_ZONE:\n      return ToolsActions.handleAddBaseLineZone(draft, action.zone);\n    case types.DELETE_BASE_LINE_ZONE:\n      return ToolsActions.handleDeleteBaseLineZone(draft, action.id);\n    case types.ADD_EXCLUSION_ZONE:\n      return ToolsActions.handleAddExclusionZone(draft, action);\n    case types.DELETE_EXCLUSION_ZONE:\n      return ToolsActions.handleDeleteExclusionZone(draft, action);\n\n    case types.APPLY_BASE_LINE_CORRECTION_FILTER:\n      return FiltersActions.handleBaseLineCorrectionFilter(draft, action);\n    case types.SET_KEY_PREFERENCES:\n      return setKeyPreferencesHandler(draft, action.keyCode);\n    case types.APPLY_KEY_PREFERENCES:\n      return applyKeyPreferencesHandler(draft, action.keyCode);\n    case types.SET_2D_LEVEL:\n      return ToolsActions.levelChangeHandler(draft, action);\n    case types.ADD_2D_ZONE:\n      return ZonesActions.add2dZoneHandler(draft, action);\n    case types.DELETE_2D_ZONE:\n      return ZonesActions.handleDeleteZone(draft, action);\n    case types.ADD_MISSING_PROJECTION:\n      return SpectrumsActions.addMissingProjectionHander(draft, action);\n    case types.RESET_DOMAIN:\n      return DomainActions.handelResetDomain(draft);\n    case types.CHANGE_ZONE_SIGNAL_VALUE:\n      return ZonesActions.changeZoneSignalDelta(draft, action);\n    case types.CHANGE_ZONE_SIGNAL_KIND:\n      return ZonesActions.handleChangeZoneSignalKind(draft, action);\n    case types.UNLINK_ZONE:\n      return ZonesActions.handleUnlinkZone(draft, action);\n    case types.SET_DIAID_ZONE:\n      return ZonesActions.handleSetDiaIDZone(draft, action);\n\n    case types.ANALYZE_SPECTRA:\n      return SpectraAanalysisActions.analyzeSpectra(draft, action);\n    case types.DELETE_ANALYZE_SPECTRA_RANGE:\n      return SpectraAanalysisActions.handleDeleteSpectraRanges(draft, action);\n    case types.RESIZE_ANALYZE_SPECTRA_RANGE:\n      return SpectraAanalysisActions.handleResizeSpectraRange(draft, action);\n    case types.SET_ANALYZE_SPECTRA_COLUMNS:\n      return SpectraAanalysisActions.handleSetcolumns(draft, action);\n    case types.FILTER_SPECTRA_COLUMN:\n      return SpectraAanalysisActions.handleFiltercolumn(draft, action);\n\n    case UNDO:\n      return handleHistoryUndo(draft);\n\n    case REDO:\n      return handleHistoryRedo(draft);\n\n    case RESET:\n      return handleHistoryReset(draft, action);\n\n    case types.SET_MOUSE_OVER_DISPLAYER:\n      return GlobalActions.setIsOverDisplayer(draft, action);\n\n    default:\n      return;\n  }\n}\n\nexport const spectrumReducer = produce(innerSpectrumReducer);\n","import { Draft } from 'immer';\n\nimport { State } from '../Reducer';\n\nfunction setWidth(draft: Draft<State>, width) {\n  draft.width = width;\n}\n\nfunction handleSetDimensions(draft: Draft<State>, width, height) {\n  draft.width = width;\n  draft.height = height;\n}\n\nexport { setWidth, handleSetDimensions };\n","import { setDomain, getDomain } from './DomainActions';\n\nfunction handleHistoryUndo(draft) {\n  const { past, present, future } = draft.history;\n  const previous = past[past.length - 1];\n  const newPast = past.slice(0, past.length - 1);\n  const newfuture = [present, ...future];\n\n  const hasRedo = newfuture.length !== 0;\n  const hasUndo = past.length !== 0;\n\n  // AnalysisObj.undoFilter(past);\n  // let resultData = AnalysisObj.getSpectraData();\n\n  const domain = getDomain(draft.data);\n  // const domain = getDomain(resultData);\n  const history = {\n    past: newPast,\n    present: previous,\n    future: newfuture,\n    hasRedo,\n    hasUndo,\n  };\n\n  // draft.data = resultData;\n  draft.xDomain = domain.xDomain;\n  draft.yDomain = domain.yDomain;\n  draft.originDomain = domain;\n  draft.history = history;\n}\n\nfunction handleHistoryRedo(draft) {\n  const { history } = draft;\n  // eslint-disable-next-line no-unused-vars\n  const next = history.future[0];\n  const newPresent = history.future.shift();\n  history.past.push(history.present);\n  history.present = newPresent;\n  history.hasUndo = true;\n  history.hasRedo = history.future.length > 0;\n\n  // AnalysisObj.redoFilter(next);\n  // draft.data = AnalysisObj.getSpectraData();\n  setDomain(draft.data);\n}\n\nfunction handleHistoryReset(draft, action) {\n  draft.history = {\n    past: [],\n    present: action,\n    future: [],\n    hasRedo: false,\n    hasUndo: false,\n  };\n}\n\nexport { handleHistoryUndo, handleHistoryRedo, handleHistoryReset };\n","import { Draft } from 'immer';\n\nimport { State } from '../Reducer';\n\nfunction setIsOverDisplayer(draft: Draft<State>, actions) {\n  draft.overDisplayer = actions.payload;\n}\nexport { setIsOverDisplayer };\n","import { useMemo, memo, forwardRef } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\n\nfunction ToolBarWrapper(WrappedComponent) {\n  const Wrapper = (props) => {\n    const {\n      data,\n      activeSpectrum,\n      verticalAlign,\n      displayerMode,\n    } = useChartData();\n\n    const { info = {} } = useMemo(() => {\n      if (data && activeSpectrum && activeSpectrum.id) {\n        const result = data.find((datum) => datum.id === activeSpectrum.id);\n        return result !== null && result !== undefined\n          ? { info: result.info, spectrumsCount: result.length }\n          : {};\n      }\n      return {};\n    }, [activeSpectrum, data]);\n\n    const { forwardedRef, ...rest } = props;\n    return (\n      <WrappedComponent\n        {...rest}\n        info={info}\n        activeSpectrum={activeSpectrum}\n        verticalAlign={verticalAlign}\n        displayerMode={displayerMode}\n        ref={forwardedRef}\n      />\n    );\n  };\n\n  return memo(\n    forwardRef((props, ref) => {\n      return <Wrapper {...props} forwardedRef={ref} />;\n    }),\n  );\n}\nexport default ToolBarWrapper;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useRef, useCallback } from 'react';\n\nimport CloseButton from '../elements/CloseButton';\nimport { loadFile, extractFileMetaFromPath } from '../utility/FileUtility';\n\nconst styles = css`\n  display: flex;\n  flex-direction: column;\n  width: 450px;\n  padding: 5px;\n  button:focus {\n    outline: none;\n  }\n  .header {\n    height: 24px;\n    border-bottom: 1px solid #f0f0f0;\n    display: flex;\n    span {\n      color: #464646;\n      font-size: 15px;\n      flex: 1;\n    }\n\n    button {\n      background-color: transparent;\n      border: none;\n      svg {\n        height: 16px;\n      }\n    }\n  }\n  .container {\n    display: flex;\n    margin: 30px 5px;\n    input,\n    button {\n      padding: 5px;\n      border: 1px solid gray;\n      border-radius: 5px;\n      height: 36px;\n      margin: 2px;\n    }\n    input {\n      flex: 10;\n    }\n    button {\n      flex: 2;\n      color: white;\n      background-color: gray;\n    }\n  }\n`;\nconst allowedExtensions = ['dx', 'jdx'];\n\nfunction LoadJCAMPModal({ onLoadClick, onClose, startLoading }) {\n  const pathReft = useRef();\n\n  const loadJCAMPHandler = useCallback(() => {\n    // ./data/xtc/XTC-814d_zg30.jdx\n    const path = pathReft.current.value;\n    const { name, extension } = extractFileMetaFromPath(path);\n    if (allowedExtensions.includes(extension)) {\n      startLoading();\n      loadFile(path, { asBuffer: true }).then((data) => {\n        const file = {\n          binary: data,\n          name,\n          extension,\n          jcampURL: path,\n        };\n        onLoadClick(file);\n      });\n    } else {\n      onLoadClick(null);\n    }\n  }, [onLoadClick, startLoading]);\n  return (\n    <div css={styles}>\n      <div className=\"header handle\">\n        <span>Load JCAMP Dialog</span>\n\n        <CloseButton onClick={onClose} />\n      </div>\n      <div className=\"container\">\n        <input\n          ref={pathReft}\n          type=\"text\"\n          placeholder=\"Enter URL to JCAMP-DX file\"\n        />\n        <button type=\"button\" onClick={loadJCAMPHandler}>\n          Load\n        </button>\n      </div>\n    </div>\n  );\n}\n\nLoadJCAMPModal.defaultProps = {\n  onLoadButtonClick: () => {\n    return null;\n  },\n  onClose: () => {\n    return null;\n  },\n  startLoading: () => {\n    return null;\n  },\n};\nexport default LoadJCAMPModal;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport {\n  SvgNmrRealImag,\n  SvgNmrOverlay3,\n  SvgNmrOverlay3Aligned,\n  SvgNmrAlignBottom,\n  SvgNmrAlignCenter,\n} from 'cheminfo-font';\nimport lodashGet from 'lodash/get';\nimport { Fragment, useCallback, memo } from 'react';\nimport {\n  FaDownload,\n  FaFileDownload,\n  FaFileImage,\n  FaCopy,\n  FaFileExport,\n  FaFile,\n  FaFileImport,\n} from 'react-icons/fa';\n\nimport { useDispatch } from '../context/DispatchContext';\nimport { useLoader } from '../context/LoaderContext';\nimport { usePreferences } from '../context/PreferencesContext';\nimport MenuButton from '../elements/MenuButton';\nimport ToolTip from '../elements/ToolTip/ToolTip';\nimport { useAlert } from '../elements/popup/Alert';\nimport { useModal } from '../elements/popup/Modal';\nimport ToolBarWrapper from '../hoc/ToolBarWrapper';\nimport useExport from '../hooks/useExport';\nimport useToolsFunctions from '../hooks/useToolsFunctions';\nimport LoadJCAMPModal from '../modal/LoadJCAMPModal';\nimport { DISPLAYER_MODE } from '../reducer/core/Constants';\nimport { LOAD_JCAMP_FILE, SET_LOADING_FLAG } from '../reducer/types/Types';\n\nconst styles = css`\n  background-color: transparent;\n  border: none;\n  width: 35px;\n  height: 35px;\n  min-height: 35px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  outline: outline;\n  :focus {\n    outline: none !important;\n  }\n\n  &.fa {\n    svg {\n      font-size: 14px;\n    }\n  }\n  &.cheminfo {\n    svg {\n      font-size: 24px;\n    }\n  }\n`;\n\nconst IMPORT_MENU = [\n  {\n    id: 'importFile',\n    icon: <FaFile />,\n    label: 'Import from file system (Press Ctrl + O)',\n  },\n  {\n    id: 'importJDX',\n    icon: <FaFile />,\n    label: 'Add JCAMP-DX from URL',\n  },\n];\nconst EXPORT_MENU = [\n  {\n    id: 'svg',\n    icon: <FaDownload />,\n    label: 'Export as SVG',\n  },\n  {\n    id: 'png',\n    icon: <FaFileImage />,\n    label: 'Export as PNG',\n  },\n  {\n    id: 'json',\n    icon: <FaFileDownload />,\n    label: 'Save data ( Press Ctrl + S )',\n  },\n  {\n    id: 'advance_save',\n    icon: <FaFileDownload />,\n    label: 'Save data as  ( Press Ctrl + Shift + S )',\n  },\n  {\n    id: 'nmre',\n    icon: <FaFileDownload />,\n    label: 'Save NMRE data',\n  },\n  {\n    id: 'copy',\n    icon: <FaCopy />,\n    label: 'Copy image to Clipboard ( Press Ctrl + C )',\n  },\n];\n\nfunction BasicToolBar({ info, verticalAlign, displayerMode }) {\n  const dispatch = useDispatch();\n  const preferences = usePreferences();\n  const alert = useAlert();\n  const modal = useModal();\n  const loader = useLoader();\n\n  const {\n    isRealSpectrumShown,\n\n    changeSpectrumViewHandler,\n    changeDisplayViewModeHandler,\n    alignSpectrumsVerticallyHandler,\n  } = useToolsFunctions();\n\n  const {\n    saveAsSVGHandler,\n    saveAsPNGHandler,\n    saveAsJSONHandler,\n    saveAsNMREHandler,\n    saveToClipboardHandler,\n    saveAsHandler,\n  } = useExport();\n\n  const selectedSpectrumInfo = { isComplex: false, isFid: false, ...info };\n\n  const LoadJacmpHandler = useCallback(\n    (file) => {\n      if (file) {\n        dispatch({ type: LOAD_JCAMP_FILE, files: [file] });\n        modal.close();\n      } else {\n        alert.error('you file must be one of those extensions [ .jdx, dx ] ');\n      }\n    },\n    [alert, dispatch, modal],\n  );\n\n  const startLoadingHandler = useCallback(() => {\n    modal.close();\n    dispatch({ type: SET_LOADING_FLAG, isLoading: true });\n  }, [dispatch, modal]);\n\n  const importJCAMPFile = useCallback(() => {\n    modal.show(\n      <LoadJCAMPModal\n        onLoadClick={LoadJacmpHandler}\n        onClose={() => modal.close()}\n        startLoading={startLoadingHandler}\n      />,\n      {},\n    );\n  }, [LoadJacmpHandler, modal, startLoadingHandler]);\n\n  const isButtonVisible = useCallback(\n    (key) => {\n      return !lodashGet(preferences, `display.toolBarButtons.${key}`);\n    },\n    [preferences],\n  );\n  const importFromFileSystemHandler = useCallback(() => {\n    loader.open();\n  }, [loader]);\n\n  const ImportHandler = useCallback(\n    ({ id }) => {\n      switch (id) {\n        case 'importFile':\n          importFromFileSystemHandler();\n          break;\n        case 'importJDX':\n          importJCAMPFile();\n          break;\n        default:\n          return;\n      }\n    },\n    [importFromFileSystemHandler, importJCAMPFile],\n  );\n\n  const exportHandler = useCallback(\n    ({ id }) => {\n      switch (id) {\n        case 'svg':\n          saveAsSVGHandler();\n          break;\n        case 'png':\n          saveAsPNGHandler();\n          break;\n        case 'json':\n          saveAsJSONHandler();\n          break;\n        case 'advance_save':\n          saveAsHandler();\n          break;\n        case 'nmre':\n          saveAsNMREHandler();\n          break;\n        case 'copy':\n          saveToClipboardHandler();\n          break;\n\n        default:\n          break;\n      }\n    },\n    [\n      saveAsSVGHandler,\n      saveAsPNGHandler,\n      saveAsJSONHandler,\n      saveAsHandler,\n      saveAsNMREHandler,\n      saveToClipboardHandler,\n    ],\n  );\n\n  return (\n    <Fragment>\n      {isButtonVisible('hideImport') && (\n        <MenuButton\n          style={styles}\n          className=\"fa\"\n          component={<FaFileImport />}\n          toolTip=\"Import\"\n          onClick={ImportHandler}\n          items={IMPORT_MENU}\n        />\n      )}\n      {isButtonVisible('hideExportAs') && (\n        <MenuButton\n          style={styles}\n          className=\"fa\"\n          component={<FaFileExport />}\n          toolTip=\"Export As\"\n          onClick={exportHandler}\n          items={EXPORT_MENU}\n        />\n      )}\n\n      {displayerMode === DISPLAYER_MODE.DM_1D &&\n        isButtonVisible('hideSpectraStackAlignments') && (\n          <button\n            type=\"button\"\n            css={styles}\n            className=\"cheminfo\"\n            onClick={changeDisplayViewModeHandler}\n          >\n            <ToolTip\n              title=\"Spectra alignment ( Press s )\"\n              popupPlacement=\"right\"\n            >\n              {verticalAlign.stacked ? (\n                <SvgNmrOverlay3Aligned />\n              ) : (\n                <SvgNmrOverlay3 />\n              )}\n            </ToolTip>\n          </button>\n        )}\n      {displayerMode === DISPLAYER_MODE.DM_1D &&\n        isButtonVisible('hideRealImaginary') &&\n        selectedSpectrumInfo &&\n        selectedSpectrumInfo.isComplex && (\n          <button\n            css={styles}\n            className=\"cheminfo\"\n            type=\"button\"\n            onClick={changeSpectrumViewHandler}\n          >\n            <ToolTip\n              title={\n                isRealSpectrumShown ? 'Display Real ' : 'Display Imaginary '\n              }\n              popupPlacement=\"right\"\n            >\n              <SvgNmrRealImag />\n            </ToolTip>\n          </button>\n        )}\n      {displayerMode === DISPLAYER_MODE.DM_1D &&\n        isButtonVisible('hideSpectraCenterAlignments') && (\n          <button\n            css={styles}\n            className=\"cheminfo\"\n            type=\"button\"\n            onClick={alignSpectrumsVerticallyHandler}\n          >\n            <ToolTip\n              title={\n                !verticalAlign.flag\n                  ? 'Baseline  Center ( Press c )'\n                  : 'Baseline  Bottom ( Press c )'\n              }\n              popupPlacement=\"right\"\n            >\n              {!verticalAlign.flag ? (\n                <SvgNmrAlignCenter />\n              ) : (\n                <SvgNmrAlignBottom />\n              )}\n            </ToolTip>\n          </button>\n        )}\n    </Fragment>\n  );\n}\n\nexport default ToolBarWrapper(memo(BasicToolBar));\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback, useState, useEffect, cloneElement } from 'react';\n\nconst styles = css`\n  width: 35px;\n  height: 35px;\n  background-color: white;\n  padding: 5px;\n  margin: 0px;\n  border: none;\n  outline: none;\n\n  :focus {\n    outline: none !important;\n  }\n`;\nconst activeStyles = css`\n  color: black;\n  background-color: #f3f3f3 !important;\n`;\n\nfunction ToggleButton({\n  children,\n  value,\n  disabled,\n  isActive,\n  onChange,\n  className,\n  style,\n  isVisible,\n  onMouseEnter,\n  onMouseLeave,\n  helpID,\n}) {\n  const [active, setActive] = useState(isActive);\n  const toggleButton = useCallback(() => {\n    const _isActive = !active;\n    setActive(_isActive);\n    if (_isActive) {\n      onChange(value);\n    } else {\n      onChange(null);\n    }\n  }, [active, onChange, value]);\n\n  useEffect(() => {\n    setActive(isActive);\n  }, [isActive]);\n\n  if (!isVisible) {\n    return null;\n  }\n  return (\n    <button\n      type=\"button\"\n      onClick={toggleButton}\n      css={[styles, active && activeStyles]}\n      style={style}\n      className={active ? ` ${className}  active` : ` ${className} `}\n      disabled={disabled}\n      onMouseEnter={onMouseEnter}\n      onMouseLeave={onMouseLeave}\n      data-helpid={helpID}\n    >\n      {cloneElement(children, { style: { fontSize: '10px' } })}\n    </button>\n  );\n}\nToggleButton.displayName = 'ToggleButton';\n\nToggleButton.defaultProps = {\n  isActive: false,\n  disabled: false,\n  isVisible: true,\n  value: null,\n  className: '',\n  onChange: function () {\n    return null;\n  },\n  onValueReady: function () {\n    return null;\n  },\n};\n\nexport default ToggleButton;\n","import {\n  useCallback,\n  useState,\n  useMemo,\n  useEffect,\n  Children,\n  cloneElement,\n} from 'react';\n\nconst style = { display: 'flex', flexDirection: 'column' };\n\nfunction ToggleButtonGroup({ children, value, onChange }) {\n  const [toggleButtons, setToggleButtons] = useState([]);\n  const handleOnChange = useCallback(\n    (val) => {\n      const _toggles = [...toggleButtons];\n      const toggles = _toggles.map((toggle) => {\n        return {\n          value: toggle.value,\n          isActive: toggle.value === val ? true : false,\n        };\n      });\n      setToggleButtons(toggles);\n      onChange(val);\n    },\n    [onChange, toggleButtons],\n  );\n\n  const mappedChildren = useMemo(() => {\n    let index = 0;\n    return Children.map(children, (child) => {\n      if (child) {\n        if (child.type.displayName === 'ToggleButton') {\n          const _child = cloneElement(child, {\n            onChange: handleOnChange,\n            isActive:\n              toggleButtons[index] &&\n              toggleButtons[index].isActive &&\n              toggleButtons[index].isActive,\n            index,\n          });\n          index++;\n          return _child;\n        } else {\n          return cloneElement(child);\n        }\n      }\n    });\n  }, [children, handleOnChange, toggleButtons]);\n\n  useEffect(() => {\n    const val = Children.map(children, (child) => {\n      if (child && child.type.displayName === 'ToggleButton') {\n        return {\n          value: child.props.value,\n          isActive: child.props.value === value ? true : false,\n        };\n      }\n    });\n    setToggleButtons(val);\n  }, [children, value]);\n\n  return <div style={style}> {mappedChildren} </div>;\n}\n\nToggleButtonGroup.defaultProps = {\n  onChange: function () {\n    return null;\n  },\n};\nexport default ToggleButtonGroup;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport {\n  SvgNmrBaselineCorrection,\n  SvgNmrFourierTransform,\n  SvgNmrIntegrate,\n  SvgNmrMultipleAnalysis,\n  SvgNmrPeakPicking,\n  SvgNmrPhaseCorrection,\n  SvgNmrRangePicking,\n  SvgNmrZeroFilling,\n} from 'cheminfo-font';\nimport lodashGet from 'lodash/get';\nimport { useState, useEffect, useCallback, memo } from 'react';\nimport { FaSearchPlus, FaExpand, FaDiceFour } from 'react-icons/fa';\n\nimport { Filters } from '../../data/Filters';\nimport { useDispatch } from '../context/DispatchContext';\nimport { usePreferences } from '../context/PreferencesContext';\nimport ToolTip from '../elements/ToolTip/ToolTip';\nimport { useHelp } from '../elements/popup/Help/Context';\nimport { ToggleButton, ToggleButtonGroup } from '../elements/toggle';\nimport ToolBarWrapper from '../hoc/ToolBarWrapper';\nimport useToolsFunctions from '../hooks/useToolsFunctions';\nimport { DISPLAYER_MODE } from '../reducer/core/Constants';\nimport { APPLY_FFT_FILTER, SET_SELECTED_FILTER } from '../reducer/types/Types';\n\nimport { options } from './ToolTypes';\n\nconst styles = css`\n  button {\n    background-color: transparent;\n    border: none;\n    width: 35px;\n    height: 35px;\n    min-height: 35px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    outline: outline;\n    :focus {\n      outline: none !important;\n    }\n\n    &.fa {\n      svg {\n        font-size: 14px;\n      }\n    }\n    &.cheminfo {\n      svg {\n        font-size: 18px;\n      }\n    }\n  }\n`;\n\n// let debounceClickEvents = [];\n\nfunction FunctionToolBar({\n  defaultValue,\n  activeSpectrum,\n  info,\n  displayerMode,\n}) {\n  const [option, setOption] = useState();\n  const help = useHelp();\n  const preferences = usePreferences();\n\n  const dispatch = useDispatch();\n\n  const selectedSpectrumInfo = {\n    info: { isComplex: false, isFid: false, ...info },\n  };\n  const { handleChangeOption, handleFullZoomOut } = useToolsFunctions();\n\n  const handleChange = useCallback(\n    (selectedOption) => {\n      setOption(selectedOption);\n      handleChangeOption(selectedOption);\n    },\n    [handleChangeOption],\n  );\n\n  useEffect(() => {\n    setOption(defaultValue);\n  }, [defaultValue]);\n\n  const handleOnFFTFilter = useCallback(() => {\n    dispatch({\n      type: APPLY_FFT_FILTER,\n      value: '',\n    });\n    dispatch({ type: SET_SELECTED_FILTER, selectedFilter: null });\n  }, [dispatch]);\n\n  const isButtonVisible = useCallback(\n    (key) => {\n      return !lodashGet(preferences, `display.toolBarButtons.${key}`);\n    },\n    [preferences],\n  );\n\n  return (\n    <div css={styles}>\n      <ToggleButtonGroup value={option} onChange={handleChange}>\n        {isButtonVisible('hideZoomTool') && (\n          <ToggleButton\n            key={options.zoom.id}\n            value={options.zoom.id}\n            {...help.onHover}\n            helpID=\"zoomIn\"\n            className=\"fa\"\n          >\n            <ToolTip\n              title={`${options.zoom.label} ( Press z )`}\n              popupPlacement=\"right\"\n              offset={{ x: 10, y: 0 }}\n              style={{ display: 'flex' }}\n            >\n              <FaSearchPlus />\n            </ToolTip>\n          </ToggleButton>\n        )}\n\n        {isButtonVisible('hideZoomOutTool') && (\n          <button className=\"fa\" type=\"button\" onClick={handleFullZoomOut}>\n            <ToolTip\n              title=\"Horizontal zoom out ( Press f ), Horizontal and Vertical zoom out, double click ( Press ff )\"\n              popupPlacement=\"right\"\n            >\n              <FaExpand />\n            </ToolTip>\n          </button>\n        )}\n\n        {displayerMode === DISPLAYER_MODE.DM_1D &&\n          isButtonVisible('hidePeakTool') && (\n            <ToggleButton\n              key={options.peakPicking.id}\n              value={options.peakPicking.id}\n              className=\"cheminfo\"\n              isVisible={\n                activeSpectrum &&\n                selectedSpectrumInfo &&\n                !selectedSpectrumInfo.info.isFid\n              }\n              {...help.onHover}\n              helpID=\"peakPicking\"\n            >\n              <ToolTip\n                title={`${options.peakPicking.label} ( Press p )`}\n                popupPlacement=\"right\"\n                offset={{ x: 10, y: 0 }}\n              >\n                <SvgNmrPeakPicking />\n              </ToolTip>\n            </ToggleButton>\n          )}\n        {displayerMode === DISPLAYER_MODE.DM_1D &&\n          isButtonVisible('hideIntegralTool') && (\n            <ToggleButton\n              key={options.integral.id}\n              value={options.integral.id}\n              className=\"cheminfo\"\n              isVisible={\n                activeSpectrum &&\n                selectedSpectrumInfo &&\n                !selectedSpectrumInfo.info.isFid\n              }\n              {...help.onHover}\n              helpID=\"integralPicking\"\n            >\n              <ToolTip\n                title={`${options.integral.label} ( Press i )`}\n                popupPlacement=\"right\"\n                offset={{ x: 10, y: 0 }}\n              >\n                <SvgNmrIntegrate />\n              </ToolTip>\n            </ToggleButton>\n          )}\n        {displayerMode === DISPLAYER_MODE.DM_2D &&\n          isButtonVisible('hideIntegralTool') && (\n            <ToggleButton\n              key={options.zone2D.id}\n              value={options.zone2D.id}\n              className=\"fa\"\n              isVisible={activeSpectrum}\n            >\n              <ToolTip\n                title={`${options.zone2D.label} ( Press i  )`}\n                popupPlacement=\"right\"\n                offset={{ x: 10, y: 0 }}\n              >\n                <FaDiceFour />\n              </ToolTip>\n            </ToggleButton>\n          )}\n        {displayerMode === DISPLAYER_MODE.DM_2D && (\n          <ToggleButton\n            key={options.slicingTool.id}\n            value={options.slicingTool.id}\n            style={styles.icon}\n            isVisible={activeSpectrum}\n          >\n            <ToolTip\n              title={`${options.slicingTool.label}`}\n              popupPlacement=\"right\"\n              offset={{ x: 10, y: 0 }}\n            >\n              Slic\n            </ToolTip>\n          </ToggleButton>\n        )}\n        {displayerMode === DISPLAYER_MODE.DM_1D &&\n          isButtonVisible('hideAutoRangesTool') && (\n            <ToggleButton\n              key={options.rangesPicking.id}\n              value={options.rangesPicking.id}\n              className=\"cheminfo\"\n              isVisible={\n                activeSpectrum &&\n                selectedSpectrumInfo &&\n                !selectedSpectrumInfo.info.isFid\n              }\n            >\n              <ToolTip\n                title={options.rangesPicking.label}\n                popupPlacement=\"right\"\n                offset={{ x: 10, y: 0 }}\n              >\n                <SvgNmrRangePicking />\n              </ToolTip>\n            </ToggleButton>\n          )}\n        {displayerMode === DISPLAYER_MODE.DM_1D &&\n          isButtonVisible('hideMultipleSpectraAnalysisTool') && (\n            <ToggleButton\n              key={options.multipleSpectraAnalysis.id}\n              value={options.multipleSpectraAnalysis.id}\n              className=\"cheminfo\"\n            >\n              <ToolTip\n                title={options.multipleSpectraAnalysis.label}\n                popupPlacement=\"right\"\n                offset={{ x: 10, y: 0 }}\n              >\n                <SvgNmrMultipleAnalysis />\n              </ToolTip>\n            </ToggleButton>\n          )}\n        {displayerMode === DISPLAYER_MODE.DM_1D &&\n          isButtonVisible('hideZeroFillingTool') && (\n            <ToggleButton\n              key={options.zeroFilling.id}\n              value={options.zeroFilling.id}\n              className=\"cheminfo\"\n              isVisible={\n                selectedSpectrumInfo &&\n                Filters.zeroFilling.isApplicable(selectedSpectrumInfo)\n              }\n            >\n              <ToolTip\n                title={options.zeroFilling.label}\n                popupPlacement=\"right\"\n                offset={{ x: 10, y: 0 }}\n              >\n                <SvgNmrZeroFilling />\n              </ToolTip>\n            </ToggleButton>\n          )}\n        {displayerMode === DISPLAYER_MODE.DM_1D &&\n          isButtonVisible('hidePhaseCorrectionTool') && (\n            <ToggleButton\n              key={options.phaseCorrection.id}\n              value={options.phaseCorrection.id}\n              className=\"cheminfo\"\n              style={styles.icon}\n              isVisible={\n                activeSpectrum &&\n                selectedSpectrumInfo &&\n                Filters.phaseCorrection.isApplicable(selectedSpectrumInfo)\n              }\n            >\n              <ToolTip\n                title={options.phaseCorrection.label}\n                popupPlacement=\"right\"\n                offset={{ x: 10, y: 0 }}\n              >\n                <SvgNmrPhaseCorrection />\n              </ToolTip>\n            </ToggleButton>\n          )}\n\n        {displayerMode === DISPLAYER_MODE.DM_1D &&\n          isButtonVisible('hideBaseLineCorrectionTool') && (\n            <ToggleButton\n              key={options.baseLineCorrection.id}\n              value={options.baseLineCorrection.id}\n              className=\"cheminfo\"\n              isVisible={\n                activeSpectrum &&\n                selectedSpectrumInfo &&\n                Filters.baselineCorrection.isApplicable(selectedSpectrumInfo)\n              }\n            >\n              <ToolTip\n                title={options.baseLineCorrection.label}\n                popupPlacement=\"right\"\n                offset={{ x: 10, y: 0 }}\n              >\n                <SvgNmrBaselineCorrection />\n              </ToolTip>\n            </ToggleButton>\n          )}\n\n        {displayerMode === DISPLAYER_MODE.DM_1D &&\n          isButtonVisible('hideExclusionZonesTool') && (\n            <ToggleButton\n              key={options.exclusionZones.id}\n              value={options.exclusionZones.id}\n              className=\"cheminfo\"\n            >\n              <ToolTip\n                title={options.exclusionZones.label}\n                popupPlacement=\"right\"\n                offset={{ x: 10, y: 0 }}\n              >\n                <SvgNmrMultipleAnalysis />\n              </ToolTip>\n            </ToggleButton>\n          )}\n      </ToggleButtonGroup>\n\n      {displayerMode === DISPLAYER_MODE.DM_1D &&\n        isButtonVisible('hideFFTTool') &&\n        selectedSpectrumInfo &&\n        Filters.fft.isApplicable(selectedSpectrumInfo) && (\n          <button\n            className=\"cheminfo\"\n            type=\"button\"\n            onClick={handleOnFFTFilter}\n          >\n            <ToolTip\n              title={`FFT Filter`}\n              popupPlacement=\"right\"\n              offset={{ x: 10, y: 0 }}\n            >\n              <SvgNmrFourierTransform />\n            </ToolTip>\n          </button>\n        )}\n    </div>\n  );\n}\n\nexport default ToolBarWrapper(memo(FunctionToolBar));\n\nFunctionToolBar.defaultProps = {\n  defaultValue: options.zoom.id,\n};\n","import { memo } from 'react';\n\nimport BasicToolBar from './BasicToolBar';\nimport FunctionToolBar from './FunctionToolBar';\n\nconst styles = {\n  display: 'flex',\n  flexDirection: 'column',\n  alignItems: 'start',\n  borderRight: '0.55px solid #f7f7f7',\n  paddingRight: '1px',\n  overflowY: 'auto',\n  height: '100%',\n};\nfunction ToolBar({ selectedTool }) {\n  return (\n    <div style={{ ...styles }}>\n      <FunctionToolBar defaultValue={selectedTool} />\n      {/* <HistoryToolBar /> */}\n      <BasicToolBar />\n    </div>\n  );\n}\n\nexport default memo(ToolBar);\n","/** @jsxImportSource @emotion/react */\n\nimport { css } from '@emotion/react';\nimport lodashGet from 'lodash/get';\nimport PropTypes from 'prop-types';\nimport {\n  useEffect,\n  useCallback,\n  useReducer,\n  useState,\n  useMemo,\n  useRef,\n  memo,\n  Reducer,\n  CSSProperties,\n  ReactElement,\n  ReactNode,\n} from 'react';\nimport SplitPane from 'react-split-pane';\nimport { useToggle, useFullscreen } from 'react-use';\n\nimport { Datum1D } from '../data/data1d/Datum1D';\nimport { Datum2D } from '../data/data2d/Datum2D';\nimport checkModifierKeyActivated from '../data/utilities/checkModifierKeyActivated';\n\nimport Viewer1D from './1d/Viewer1D';\nimport Viewer2D from './2d/Viewer2D';\nimport ErrorBoundary from './ErrorBoundary';\nimport KeysListenerTracker from './EventsTrackers/KeysListenerTracker';\nimport { AssignmentProvider } from './assignment';\nimport helpList, { setBaseUrl } from './constants/help';\nimport { ChartDataProvider } from './context/ChartContext';\nimport { DispatchProvider } from './context/DispatchContext';\nimport { GlobalProvider } from './context/GlobalContext';\nimport { PreferencesProvider } from './context/PreferencesContext';\nimport { AlertProvider } from './elements/popup/Alert';\nimport { HelpProvider } from './elements/popup/Help';\nimport { ModalProvider } from './elements/popup/Modal';\nimport Header from './header/Header';\nimport { HighlightProvider } from './highlight';\nimport DropZone from './loader/DropZone';\nimport { defaultGetSpinner, SpinnerProvider } from './loader/SpinnerContext';\nimport Panels from './panels/Panels';\nimport checkActionType from './reducer/IgnoreActions';\nimport {\n  spectrumReducer,\n  initialState,\n  dispatchMiddleware,\n} from './reducer/Reducer';\nimport { DISPLAYER_MODE } from './reducer/core/Constants';\nimport {\n  preferencesInitialState,\n  preferencesReducer,\n  INIT_PREFERENCES,\n} from './reducer/preferencesReducer';\nimport {\n  INITIATE,\n  SET_WIDTH,\n  SET_LOADING_FLAG,\n  SET_MOUSE_OVER_DISPLAYER,\n} from './reducer/types/Types';\nimport ToolBar from './toolbar/ToolBar';\n\nconst splitPaneStyles: Record<\n  'container' | 'resizer' | 'pane',\n  CSSProperties\n> = {\n  container: {\n    position: 'relative',\n    height: 'none',\n  },\n  resizer: {\n    width: 10,\n    backgroundColor: '#f7f7f7',\n    cursor: 'ew-resize',\n  },\n  pane: { overflow: 'hidden' },\n};\n\nconst containerStyles = css`\n  background-color: white;\n  width: 100%;\n  display: block;\n  height: 100%;\n  font-size: 14px;\n\n  div:focus {\n    outline: none !important;\n  }\n\n  button {\n    cursor: pointer;\n    color: black;\n    &:disabled {\n      cursor: default;\n    }\n  }\n\n  button:active,\n  button:hover,\n  button:focus,\n  [type='button']:focus,\n  button {\n    outline: none !important;\n  }\n  * {\n    -webkit-user-drag: none;\n    -moz-user-drag: none;\n    -o-user-drag: none;\n    user-drag: none;\n    -moz-user-select: none;\n    -webkit-user-select: none;\n    -ms-user-select: none;\n    user-select: none;\n  }\n\n  .SplitPane {\n    height: 100%;\n  }\n\n  .Resizer.vertical:after {\n    content: '\\\\22EE';\n    top: 50%;\n    color: black;\n    position: absolute;\n    font-size: 14px;\n  }\n\n  .Resizer.vertical {\n    padding: 2px;\n  }\n\n  .Resizer.vertical:hover {\n    background-color: #dfdfdf !important;\n    border-left: 0.55px #bbbbbb solid;\n    border-right: 0.55px #bbbbbb solid;\n  }\n`;\n\nexport interface NMRiumProps {\n  data?: NMRiumData;\n  docsBaseUrl?: string;\n  onDataChange?: (data: any) => void;\n  preferences?: NMRiumPreferences;\n  emptyText?: ReactNode;\n  /**\n   * Returns a custom spinner that will be rendered while loading data.\n   */\n  getSpinner?: () => ReactElement;\n}\n\nexport type NMRiumPreferences = Partial<{\n  general: Partial<{\n    disableMultipletAnalysis: boolean;\n    hideSetSumFromMolecule: boolean;\n  }>;\n  panels: Partial<{\n    hideSpectraPanel: boolean;\n    hideInformationPanel: boolean;\n    hidePeaksPanel: boolean;\n    hideIntegralsPanel: boolean;\n    hideRangesPanel: boolean;\n    hideStructuresPanel: boolean;\n    hideFiltersPanel: boolean;\n    hideZonesPanel: boolean;\n    hideSummaryPanel: boolean;\n    hideMultipleSpectraAnalysisPanel: boolean;\n  }>;\n  toolBarButtons: Partial<{\n    hideZoomTool: boolean;\n    hideZoomOutTool: boolean;\n    hideImport: boolean;\n    hideExportAs: boolean;\n    hideSpectraStackAlignments: boolean;\n    hideSpectraCenterAlignments: boolean;\n    hideRealImaginary: boolean;\n    hidePeakTool: boolean;\n    hideIntegralTool: boolean;\n    hideAutoRangesTool: boolean;\n    hideZeroFillingTool: boolean;\n    hidePhaseCorrectionTool: boolean;\n    hideBaseLineCorrectionTool: boolean;\n    hideFFTTool: boolean;\n    hideMultipleSpectraAnalysisTool: boolean;\n  }>;\n}>;\n\nexport type Molecules = Array<{ molfile: string }>;\nexport type Spectra = Array<Partial<Datum1D> | Partial<Datum2D>>;\n\nexport interface NMRiumData {\n  molecules?: Molecules;\n  spectra: Spectra;\n}\n\nfunction NMRium({\n  data: dataProp,\n  onDataChange,\n  docsBaseUrl,\n  preferences,\n  getSpinner = defaultGetSpinner,\n  emptyText = undefined,\n}: NMRiumProps) {\n  const rootRef = useRef<HTMLDivElement>(null);\n  const elementsWraperRef = useRef<HTMLDivElement>(null);\n  const [show, toggle] = useToggle(false);\n  const isFullscreen = useFullscreen(rootRef, show, {\n    onClose: () => {\n      toggle(false);\n    },\n  });\n  const [isRightPanelHide, hideRightPanel] = useState(false);\n  const [isResizeEventStart, setResizeEventStart] = useState(false);\n  const [helpData, setHelpData] = useState(helpList);\n\n  const [state, dispatch] = useReducer<Reducer<any, any>>(\n    spectrumReducer,\n    initialState,\n  );\n  const [preferencesState, dispatchPreferences] = useReducer<Reducer<any, any>>(\n    preferencesReducer,\n    preferencesInitialState,\n  );\n\n  const { selectedTool, displayerMode, data: spectraData } = state;\n\n  useEffect(() => {\n    if (checkActionType(state.actionType)) {\n      onDataChange?.(state);\n    }\n  }, [onDataChange, state]);\n\n  const dispatchMiddleWare = useMemo(() => {\n    return dispatchMiddleware(dispatch);\n  }, []);\n\n  useEffect(() => {\n    rootRef.current?.focus();\n  }, [isFullscreen]);\n\n  useEffect(() => {\n    dispatchPreferences({\n      type: INIT_PREFERENCES,\n      payload: { display: preferences, dispatch: dispatchPreferences },\n    });\n  }, [preferences]);\n\n  useEffect(() => {\n    dispatchMiddleWare({ type: SET_LOADING_FLAG, isLoading: true });\n    dispatchMiddleWare({ type: INITIATE, payload: dataProp });\n  }, [dataProp, dispatchMiddleWare]);\n\n  useEffect(() => {\n    setBaseUrl(docsBaseUrl);\n    setHelpData(helpList());\n  }, [docsBaseUrl]);\n\n  const handleSplitPanelDragFinished = useCallback(\n    (size) => {\n      if (size && !isRightPanelHide) {\n        setResizeEventStart(false);\n        dispatch({ type: SET_WIDTH, width: size });\n      }\n    },\n    [isRightPanelHide],\n  );\n\n  const preventAutoHelp = useMemo(() => {\n    return lodashGet(\n      preferencesState,\n      'controllers.help.preventAutoHelp',\n      false,\n    );\n  }, [preferencesState]);\n\n  const rightPanelHandler = useCallback((e) => {\n    e.stopPropagation();\n    hideRightPanel((prevFlag) => !prevFlag);\n  }, []);\n\n  const preventContextMenuHandler = useCallback((e) => {\n    if (!checkModifierKeyActivated(e)) {\n      e.preventDefault();\n    }\n  }, []);\n  const mouseEnterHandler = useCallback(() => {\n    dispatchMiddleWare({ type: SET_MOUSE_OVER_DISPLAYER, payload: true });\n  }, [dispatchMiddleWare]);\n  const mouseLeaveHandler = useCallback(() => {\n    dispatchMiddleWare({ type: SET_MOUSE_OVER_DISPLAYER, payload: false });\n  }, [dispatchMiddleWare]);\n\n  return (\n    <ErrorBoundary>\n      <GlobalProvider\n        value={{\n          rootRef: rootRef.current,\n          elementsWraperRef: elementsWraperRef.current,\n        }}\n      >\n        <PreferencesProvider value={preferencesState}>\n          <div\n            onMouseEnter={mouseEnterHandler}\n            onMouseLeave={mouseLeaveHandler}\n            style={{ height: '100%', position: 'relative' }}\n          >\n            {/* @ts-expect-error: TODO remove when HelpProvider is migrated */}\n            <HelpProvider\n              data={helpData}\n              wrapperRef={elementsWraperRef.current}\n              preventAutoHelp={preventAutoHelp}\n            >\n              {/* @ts-expect-error: TODO remove when AlertProvider is migrated */}\n              <AlertProvider wrapperRef={elementsWraperRef.current}>\n                <DispatchProvider value={dispatchMiddleWare}>\n                  <ChartDataProvider value={{ ...state, isResizeEventStart }}>\n                    <ModalProvider wrapperRef={elementsWraperRef.current}>\n                      <HighlightProvider>\n                        <AssignmentProvider spectraData={spectraData}>\n                          <SpinnerProvider value={getSpinner}>\n                            <div\n                              ref={rootRef}\n                              css={containerStyles}\n                              onContextMenu={preventContextMenuHandler}\n                            >\n                              <Header\n                                isFullscreen={isFullscreen}\n                                onMaximize={toggle}\n                              />\n\n                              <div\n                                style={{\n                                  height: 'calc(100% - 36px)',\n                                  width: '100%',\n                                  backgroundColor: 'white',\n                                }}\n                              >\n                                <DropZone>\n                                  <KeysListenerTracker />\n\n                                  <ToolBar selectedTool={selectedTool} />\n                                  <SplitPane\n                                    style={splitPaneStyles.container}\n                                    resizerStyle={splitPaneStyles.resizer}\n                                    paneStyle={splitPaneStyles.pane}\n                                    pane1Style={\n                                      isRightPanelHide\n                                        ? {\n                                            maxWidth: '100%',\n                                            width: 'calc(100% - 10px)',\n                                          }\n                                        : { maxWidth: '80%' }\n                                    }\n                                    split=\"vertical\"\n                                    defaultSize={\n                                      isRightPanelHide\n                                        ? '99%'\n                                        : 'calc(100% - 600px)'\n                                    }\n                                    minSize=\"80%\"\n                                    onDragFinished={\n                                      handleSplitPanelDragFinished\n                                    }\n                                    onResizerDoubleClick={rightPanelHandler}\n                                    onDragStarted={() => {\n                                      setResizeEventStart(true);\n                                    }}\n                                  >\n                                    {displayerMode === DISPLAYER_MODE.DM_1D ? (\n                                      <Viewer1D emptyText={emptyText} />\n                                    ) : (\n                                      <Viewer2D emptyText={emptyText} />\n                                    )}\n                                    {!isRightPanelHide ? (\n                                      <Panels\n                                        selectedTool={selectedTool}\n                                        displayerMode={displayerMode}\n                                      />\n                                    ) : null}\n                                  </SplitPane>\n                                </DropZone>\n                              </div>\n                              <div\n                                ref={elementsWraperRef}\n                                key={String(isFullscreen)}\n                                id=\"main-wrapper\"\n                                style={{\n                                  position: 'absolute',\n                                  pointerEvents: 'none',\n                                  zIndex: 0,\n                                  left: 0,\n                                  right: 0,\n                                  top: 0,\n                                  bottom: 0,\n                                }}\n                              />\n                            </div>\n                          </SpinnerProvider>\n                        </AssignmentProvider>\n                      </HighlightProvider>\n                    </ModalProvider>\n                  </ChartDataProvider>\n                </DispatchProvider>\n              </AlertProvider>\n            </HelpProvider>\n          </div>\n        </PreferencesProvider>\n      </GlobalProvider>\n    </ErrorBoundary>\n  );\n}\n\nNMRium.propTypes = {\n  docsBaseUrl: PropTypes.string,\n  onDataChange: PropTypes.func,\n  preferences: PropTypes.shape({\n    general: PropTypes.shape({\n      disableMultipletAnalysis: PropTypes.bool,\n      hideSetSumFromMolecule: PropTypes.bool,\n    }),\n    panels: PropTypes.shape({\n      hideSpectraPanel: PropTypes.bool,\n      hideInformationPanel: PropTypes.bool,\n      hidePeaksPanel: PropTypes.bool,\n      hideIntegralsPanel: PropTypes.bool,\n      hideRangesPanel: PropTypes.bool,\n      hideStructuresPanel: PropTypes.bool,\n      hideFiltersPanel: PropTypes.bool,\n    }),\n    toolBarButtons: PropTypes.shape({\n      hideZoomTool: PropTypes.bool,\n      hideZoomOutTool: PropTypes.bool,\n      hideImport: PropTypes.bool,\n      hideExportAs: PropTypes.bool,\n      hideSpectraStackAlignments: PropTypes.bool,\n      hideSpectraCenterAlignments: PropTypes.bool,\n      hideRealImaginary: PropTypes.bool,\n      hidePeakTool: PropTypes.bool,\n      hideIntegralTool: PropTypes.bool,\n      hideAutoRangesTool: PropTypes.bool,\n      hideZeroFillingTool: PropTypes.bool,\n      hidePhaseCorrectionTool: PropTypes.bool,\n      hideBaseLineCorrectionTool: PropTypes.bool,\n      hideFFTTool: PropTypes.bool,\n      hideExclusionZonesTool: PropTypes.bool,\n    }),\n  }),\n};\n\nNMRium.defaultProps = {\n  docsBaseUrl: 'https://docs.nmrium.org',\n  onDataChange: () => null,\n  preferences: {\n    general: {\n      disableMultipletAnalysis: false,\n      hideSetSumFromMolecule: false,\n    },\n\n    panels: {\n      hideSpectraPanel: false,\n      hideInformationPanel: false,\n      hidePeaksPanel: false,\n      hideIntegralsPanel: false,\n      hideRangesPanel: false,\n      hideStructuresPanel: false,\n      hideFiltersPanel: false,\n      hideZonesPanel: false,\n      hideSummaryPanel: false,\n      hideMultipleSpectraAnalysisPanel: false,\n    },\n\n    toolBarButtons: {\n      hideZoomTool: false,\n      hideZoomOutTool: false,\n      hideImport: false,\n      hideExportAs: false,\n      hideSpectraStackAlignments: false,\n      hideSpectraCenterAlignments: false,\n      hideRealImaginary: false,\n      hidePeakTool: false,\n      hideIntegralTool: false,\n      hideAutoRangesTool: false,\n      hideZeroFillingTool: false,\n      hidePhaseCorrectionTool: false,\n      hideBaseLineCorrectionTool: false,\n      hideFFTTool: false,\n      hideMultipleSpectraAnalysisTool: false,\n      hideExclusionZonesTool: false,\n    },\n  },\n};\n\nexport default memo(NMRium);\n"],"sourceRoot":""}