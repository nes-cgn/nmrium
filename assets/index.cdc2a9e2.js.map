{"version":3,"file":"index.cdc2a9e2.js","sources":["../../vite/modulepreload-polyfill","../../src/demo/utility/menu.ts","../../src/demo/Sidebar.tsx","../../vite/preload-helper","../../src/demo/views/index.ts","../../src/demo/layouts/Admin.tsx","../../src/demo/layouts/SingleDisplayerLayout.tsx","../../src/demo/layouts/Main.tsx","../../src/data/utilities/checkModifierKeyActivated.ts","../../src/data/data1d/Spectrum1D/ranges/detectSignal.ts","../../src/component/EventsTrackers/BrushTracker.tsx","../../src/component/EventsTrackers/MouseTracker.tsx","../../src/data/constants/SignalsKinds.ts","../../src/data/data1d/filter1d/absolute.ts","../../src/data/data1d/filter1d/autoPhaseCorrection.ts","../../src/data/data1d/filter1d/baselineCorrection.ts","../../src/data/data1d/filter1d/centerMean.ts","../../src/data/data1d/filter1d/digitalFilter.ts","../../src/data/data1d/filter1d/equallySpaced.ts","../../src/data/data1d/filter1d/exclusionZones.ts","../../src/data/data1d/filter1d/fft.ts","../../src/data/data1d/filter1d/fromTo.ts","../../src/data/data1d/filter1d/lineBroadening.ts","../../src/data/data1d/filter1d/pareto.ts","../../src/data/data1d/filter1d/phaseCorrection.ts","../../src/data/data1d/filter1d/shiftX.ts","../../src/data/data1d/filter1d/standardDeviation.ts","../../src/data/data1d/filter1d/zeroFilling.ts","../../src/data/data2d/filter2d/shiftX.ts","../../src/data/data2d/filter2d/shiftY.ts","../../src/data/utilities/generateID.ts","../../src/data/FiltersManager.ts","../../src/data/utilities/getColor.ts","../../src/data/data1d/Spectrum1D/integrals/initiateIntegrals.ts","../../src/data/data1d/Spectrum1D/getSpectrumErrorValue.ts","../../src/data/data1d/Spectrum1D/shift/getShiftX.ts","../../src/data/data1d/Spectrum1D/peaks/mapPeaks.ts","../../src/data/data1d/Spectrum1D/peaks/initiatePeaks.ts","../../src/data/data1d/Spectrum1D/ranges/mapRanges.ts","../../src/data/data1d/Spectrum1D/ranges/initiateRanges.ts","../../src/data/data1d/Spectrum1D/initiateDatum1D.ts","../../src/data/data1d/Spectrum1D/ranges/generateSpectrumFromRanges.ts","../../src/data/data1d/Spectrum1D/generateSpectrumFromPublicationString.ts","../../src/data/data1d/Spectrum1D/get1DDataXY.ts","../../src/data/constants/References.ts","../../src/data/data1d/Spectrum1D/getReferenceShift.ts","../../src/data/data1d/Spectrum1D/integrals/changeIntegralsRelative.ts","../../src/data/data1d/Spectrum1D/integrals/checkIntegralKind.ts","../../src/data/utilities/getSum.ts","../../src/data/data1d/Spectrum1D/integrals/updateRelatives.ts","../../src/data/data1d/Spectrum1D/integrals/updateIntegralsRelativeValues.ts","../../src/data/data1d/Spectrum1D/isSpectrum1D.ts","../../src/data/data1d/Spectrum1D/peaks/autoPeakPicking.ts","../../src/data/data1d/Spectrum1D/peaks/lookupPeak.ts","../../src/data/utilities/getAtom.ts","../../src/data/data1d/Spectrum1D/SumManager.ts","../../src/data/utilities/RangeUtilities.ts","../../src/data/data1d/Spectrum1D/ranges/checkRangeKind.ts","../../src/data/data1d/Spectrum1D/ranges/updateRangesRelativeValues.ts","../../src/data/data1d/Spectrum1D/ranges/addRange.ts","../../src/data/data1d/Spectrum1D/ranges/changeRange.ts","../../src/data/data1d/Spectrum1D/ranges/changeRangeRelativeValue.ts","../../src/data/data1d/Spectrum1D/ranges/changeRangeSignal.ts","../../src/data/data1d/Spectrum1D/ranges/detectRange.ts","../../src/data/data1d/Spectrum1D/ranges/autoRangesDetection.ts","../../src/data/data1d/Spectrum1D/ranges/detectRanges.ts","../../src/data/data1d/Spectrum1D/shift/internal/updateIntegralXShift.ts","../../src/data/data1d/Spectrum1D/shift/internal/updatePeaksXShift.ts","../../src/data/data1d/Spectrum1D/shift/internal/updateRangesXShift.ts","../../src/data/data1d/Spectrum1D/shift/updateXShift.ts","../../src/component/reducer/core/Constants.ts","../../src/data/data1d/Data1DManager.ts","../../src/data/data2d/Spectrum2D/getMissingProjection.ts","../../src/data/data2d/Spectrum2D/getSlice.ts","../../src/data/data2d/Processing2D.ts","../../src/data/data2d/Spectrum2D/initiateDatum2D.ts","../../src/data/data2d/Spectrum2D/isSpectrum2D.ts","../../src/data/data2d/Spectrum2D/shift/getShift.ts","../../src/data/data2d/Spectrum2D/shift/updateShift.ts","../../src/data/data2d/Spectrum2D/toJSON.ts","../../src/data/data2d/Spectrum2D/zones/changeZoneSignal.ts","../../src/data/data2d/Spectrum2D/zones/getDetectionZones.ts","../../src/data/data2d/Spectrum2D/zones/detectZones.ts","../../src/data/data2d/Spectrum2D/zones/detectZonesManual.ts","../../src/data/data2d/Data2DManager.ts","../../src/data/migration/changeKeys.ts","../../src/data/migration/migrateToVersion1.ts","../../src/data/migration/migrateToVersion2.ts","../../src/data/migration/MigrationManager.ts","../../src/data/utilities/getAtomsFromMF.ts","../../src/data/molecules/Molecule.ts","../../src/data/SpectraManager.ts","../../src/data/data1d/Spectrum1D/toJSON.ts","../../src/data/PredictionManager.ts","../../src/component/panels/SummaryPanel/CorrelationTable/Constants.ts","../../src/component/toolbar/ToolTypes.ts","../../src/component/utility/util/nmredata/addRanges.ts","../../src/component/utility/util/nmredata/addZones.ts","../../src/component/utility/nmredataToNmrium.ts","../../src/component/reducer/actions/AssignmentsActions.ts","../../src/data/utilities/FindUtilities.ts","../../src/component/1d/utilities/scale.ts","../../src/component/reducer/helper/getRange.ts","../../src/component/utility/nucleusToString.ts","../../src/component/reducer/actions/DomainActions.ts","../../src/component/reducer/actions/RangesActions.ts","../../src/data/utilities/ZoneUtilities.ts","../../src/component/2d/utilities/DimensionLayout.ts","../../src/component/2d/utilities/scale.ts","../../src/component/reducer/helper/get2DRange.ts","../../src/component/reducer/actions/ZonesActions.ts","../../src/component/reducer/actions/CorrelationsActions.ts","../../src/component/reducer/helper/Zoom1DManager.ts","../../src/component/reducer/actions/DatabaseActions.ts","../../src/component/reducer/actions/DimensionsActions.ts","../../src/component/utility/getSpectraByNucleus.ts","../../src/component/reducer/helper/ZoomHistoryManager.ts","../../src/component/utility/GroupByInfoKey.ts","../../src/component/reducer/actions/PreferencesActions.ts","../../src/component/reducer/actions/ToolsActions.ts","../../src/component/reducer/actions/FiltersActions.ts","../../src/component/reducer/actions/GlobalActions.ts","../../src/component/reducer/actions/HistoryActions.ts","../../src/component/reducer/actions/IntegralsActions.ts","../../src/data/molecules/MoleculeManager.ts","../../src/component/reducer/types/Types.ts","../../src/component/reducer/actions/LoadActions.ts","../../src/component/reducer/actions/MoleculeActions.ts","../../src/component/reducer/actions/PeaksActions.ts","../../src/data/utilities/generateChar.ts","../../src/data/data1d/MultipleAnalysis.ts","../../src/component/reducer/actions/SpectraAnalysisAction.ts","../../src/component/reducer/actions/SpectrumsActions.ts","../../src/component/reducer/types/HistoryTypes.ts","../../src/component/reducer/Reducer.ts","../../src/component/context/ChartContext.tsx","../../src/component/context/DispatchContext.tsx","../../src/component/hooks/useSpectrum.ts","../../src/component/context/LoaderContext.tsx","../../src/component/loader/NoData.tsx","../../src/component/loader/DefaultSpinnerComponent.tsx","../../src/component/loader/SpinnerContext.tsx","../../src/component/loader/Spinner.tsx","../../src/component/tool/BrushXY.tsx","../../src/component/tool/CrossLinePointer.tsx","../../src/component/utility/LocalStorage.ts","../../src/component/workspaces/basic.ts","../../src/component/workspaces/exercise.ts","../../src/component/workspaces/prediction.ts","../../src/component/workspaces/process1D.ts","../../src/component/workspaces/index.ts","../../src/component/reducer/preferencesReducer.ts","../../src/component/context/PreferencesContext.tsx","../../src/component/utility/PathBuilder.ts","../../src/component/2d/Contours.tsx","../../src/component/hooks/useXYReduce.ts","../../src/component/2d/Left1DChart.tsx","../../src/component/2d/Top1DChart.tsx","../../src/component/2d/XAxis.tsx","../../src/component/2d/YAxis.tsx","../../src/component/2d/zones/IndicationLines.tsx","../../src/component/utility/Events.ts","../../src/component/assignment/AssignmentsContext.ts","../../src/component/highlight/index.tsx","../../src/data/utilities/Concatenation.ts","../../src/component/2d/SignalDeltaLine.tsx","../../src/component/2d/zones/SignalCrosshair.tsx","../../src/component/2d/zones/Signal.tsx","../../src/component/2d/zones/Zone.tsx","../../src/component/2d/zones/Zones.tsx","../../src/component/2d/Chart2D.tsx","../../src/component/utility/FormatNumber.ts","../../src/component/2d/FooterBanner.tsx","../../src/component/2d/tools/XYLabelPointer.tsx","../../src/component/2d/tools/slicing/SliceScale.ts","../../src/component/2d/tools/slicing/HorizontalSliceChart.tsx","../../src/component/2d/tools/slicing/VerticalSliceChart.tsx","../../src/component/2d/tools/slicing/SlicingView.tsx","../../src/component/2d/Viewer2D.tsx","../../src/component/reducer/scaleReducer.ts","../../src/component/context/ScaleContext.tsx","../../src/component/elements/popup/options.ts","../../src/component/elements/popup/Alert/Context.ts","../../src/component/elements/popup/Transition.tsx","../../src/component/elements/popup/Wrapper.tsx","../../src/component/elements/popup/helpers.ts","../../src/component/elements/popup/Alert/ProgressIndicator.tsx","../../src/component/elements/popup/Alert/Provider.tsx","../../src/component/elements/popup/Modal/Context.ts","../../src/component/elements/popup/Modal/ConfirmDialog.tsx","../../src/component/elements/popup/Modal/ModalContent.tsx","../../src/component/elements/popup/Modal/Provider.tsx","../../src/component/context/GlobalContext.tsx","../../src/component/elements/ToolTip/ToolTip.tsx","../../src/component/elements/CloseButton.tsx","../../src/component/modal/MultipletAnalysisModal.tsx","../../src/component/hooks/useSpectraPerNucleus.ts","../../src/component/hooks/useActiveSpectrumStyleOptions.ts","../../src/component/1d/ExclusionZoneAnnotation.tsx","../../src/component/1d/utilities/getVerticalShift.ts","../../src/component/1d/ExclusionZonesAnnotations.tsx","../../src/component/hooks/useXScale.ts","../../src/component/hooks/useIntegralPath.ts","../../src/component/panels/extra/preferences/defaultValues.ts","../../src/component/elements/resizer/useDraggable.ts","../../src/component/elements/resizer/DivResizer.tsx","../../src/component/elements/resizer/SVGResizer.tsx","../../src/component/elements/resizer/Resizer.tsx","../../src/component/1d/IntegralResizable.tsx","../../src/component/1d/Integral.tsx","../../src/component/1d/IntegralsSeries.tsx","../../src/component/1d/Line.tsx","../../src/component/1d/LinesSeries.tsx","../../src/component/1d/PeakAnnotation.tsx","../../src/component/1d/PeakAnnotations.tsx","../../src/component/1d/ResurrectedDatabaseRanges.tsx","../../src/component/1d/XAxis.tsx","../../src/data/data1d/Spectrum1D/generateJGraphData.ts","../../src/component/1d/jCouplingGraph/JGraphContext.tsx","../../src/component/elements/linearAxis/LinearVerticalAxis.tsx","../../src/component/1d/jCouplingGraph/JGraphVerticalAxis.tsx","../../src/component/1d/jCouplingGraph/JsCouplingLinks.tsx","../../src/component/1d/jCouplingGraph/JsCoupling.tsx","../../src/component/1d/jCouplingGraph/JsCouplings.tsx","../../src/component/1d/jCouplingGraph/JGraph.tsx","../../src/component/elements/DeleteButton.tsx","../../src/component/1d/multiAnalysis/AnalysisRange.tsx","../../src/component/1d/multiAnalysis/MultiAnalysisRanges.tsx","../../src/component/assignment/utilities/filterForIDsWithAssignment.ts","../../src/data/constants/Multiplets.ts","../../src/component/panels/extra/utilities/MultiplicityUtilities.ts","../../src/component/1d/multiplicityTree/TreeColors.ts","../../src/component/1d/multiplicityTree/LevelNode.tsx","../../src/component/1d/multiplicityTree/StringNode.tsx","../../src/component/1d/multiplicityTree/TreeNodes.tsx","../../src/component/1d/multiplicityTree/buildTreeNode.ts","../../src/component/1d/multiplicityTree/MultiplicityTree.tsx","../../src/component/1d/multiplicityTree/TempMultiplicityTree.tsx","../../src/component/1d/ranges/Range.tsx","../../src/component/1d/ranges/RangeIntegral.tsx","../../src/component/1d/ranges/Ranges.tsx","../../src/component/1d/tool/BaseLineZones.tsx","../../src/component/1d/Chart1D.tsx","../../src/component/1d/FooterBanner.tsx","../../src/component/1d/SpectraTracker.tsx","../../src/component/1d/tool/PeakPointer.tsx","../../src/component/1d/tool/VerticalIndicator.tsx","../../src/component/1d/tool/XLabelPointer.tsx","../../src/component/1d/Viewer1D.tsx","../../src/component/ErrorOverlay.tsx","../../src/component/elements/Button.tsx","../../src/component/elements/ActionButtons.tsx","../../src/component/elements/CheckBox.tsx","../../src/component/elements/formik/FormikCheckBox.tsx","../../src/component/elements/formik/FormikForm.tsx","../../src/component/hooks/useCombinedRefs.ts","../../src/component/elements/Input.tsx","../../src/component/elements/formik/FormikInput.tsx","../../src/component/modal/ModalStyle.ts","../../src/component/modal/SaveAsModal.tsx","../../src/component/utility/Export.ts","../../src/component/utility/util/nmredata/addSource.ts","../../src/component/utility/util/nmredata/getToFix.ts","../../src/component/utility/util/nmredata/get1DSignals.ts","../../src/component/utility/util/nmredata/getCouplingObserved.ts","../../src/component/utility/util/nmredata/get2DSignals.ts","../../src/component/utility/util/nmredata/flat2DSignals.ts","../../src/component/utility/util/nmredata/getLabels.ts","../../src/component/utility/nmriumToNmredata.ts","../../src/component/hooks/useExport.tsx","../../src/component/hooks/useCheckExperimentalFeature.ts","../../src/component/elements/ButtonToolTip.tsx","../../src/component/panels/extra/BasicPanelStyle.ts","../../src/component/elements/ToggleButton.tsx","../../src/component/panels/header/DefaultPanelHeader.tsx","../../src/component/elements/ContextMenu.tsx","../../src/component/elements/ReactTable/Elements/ReactTableHeader.tsx","../../src/component/elements/ReactTable/Style.ts","../../src/component/elements/ReactTable/Elements/ReactTableRow.tsx","../../src/component/elements/ReactTable/utility/ReactTableContext.ts","../../src/component/elements/ReactTable/utility/useRowSpan.ts","../../src/component/elements/ReactTable/ReactTable.tsx","../../src/component/panels/extra/placeholder/NoTableData.tsx","../../src/component/panels/AutomaticAssignment/AutomaticAssignmentTable.tsx","../../src/component/panels/AutomaticAssignment/useGetAssignments.ts","../../src/component/panels/AutomaticAssignment/AutomaticAssignment.tsx","../../src/component/elements/ReactTable/ReactTableFlexLayout.tsx","../../src/component/panels/InformationPanel.tsx","../../src/component/elements/Tab/DeleteButton.tsx","../../src/component/elements/Tab/Tab.tsx","../../src/component/elements/Tab/Tabs.tsx","../../src/component/elements/NextPrev.tsx","../../src/component/elements/MoleculeSelection.tsx","../../src/component/modal/changeSum/SelectMolecule.tsx","../../src/component/modal/changeSum/ChangeSumModal.tsx","../../src/component/elements/SaveButton.tsx","../../src/component/panels/header/PreferencesHeader.tsx","../../src/component/elements/EditableColumn.tsx","../../src/component/elements/ReactTable/utility/addCustomColumn.ts","../../src/component/elements/Select.tsx","../../src/component/panels/IntegralsPanel/IntegralTable.tsx","../../src/component/elements/ColorInput.tsx","../../src/component/elements/formik/FormikColorInput.tsx","../../src/component/elements/formik/FormikColumnFormatField.tsx","../../src/component/elements/NumberInput.tsx","../../src/component/elements/formik/FormikNumberInput.tsx","../../src/component/hooks/useNucleus.ts","../../src/component/panels/IntegralsPanel/IntegralsPreferences.tsx","../../src/component/panels/IntegralsPanel/IntegralPanel.tsx","../../src/component/elements/Label.tsx","../../src/component/modal/ExportAsMatrixModal.tsx","../../src/component/modal/MultipleSpectraFiltersModal/EquallySpacedFilter.tsx","../../src/component/modal/MultipleSpectraFiltersModal/FromToFilter.tsx","../../src/component/modal/MultipleSpectraFiltersModal/index.tsx","../../src/component/panels/MatrixGenerationPanel/MatrixGenerationPanel.tsx","../../src/component/modal/MoleculeStructureEditorModal.tsx","../../src/component/elements/MenuButton.tsx","../../src/data/utilities/generateNumbersPowerOfX.ts","../../src/component/elements/IsotopesViewer.tsx","../../src/component/elements/formik/FormikErrorsSummary.tsx","../../src/component/elements/formik/FormikSelect.tsx","../../src/component/modal/PredictSpectraModal.tsx","../../src/component/panels/MoleculesPanel/MoleculePanelHeader.tsx","../../src/component/panels/MoleculesPanel/Utilities.ts","../../src/component/panels/MoleculesPanel/useAtomAssignment.tsx","../../src/component/panels/MoleculesPanel/MoleculePanel.tsx","../../src/component/modal/AlignSpectraModal.tsx","../../src/component/utility/Evaluate.ts","../../src/component/panels/MultipleSpectraAnalysisPanel/MultipleAnalysisCodeEditor.tsx","../../src/component/panels/MultipleSpectraAnalysisPanel/MultipleSpectraAnalysisPreferences.tsx","../../src/component/elements/dropDownButton/DropDownList.tsx","../../src/component/elements/dropDownButton/DropDownButton.tsx","../../src/component/panels/MultipleSpectraAnalysisPanel/ColumnHeader.tsx","../../src/component/panels/MultipleSpectraAnalysisPanel/MultipleSpectraAnalysisTable.tsx","../../src/component/panels/MultipleSpectraAnalysisPanel/MultipleSpectraAnalysisPanel.tsx","../../src/component/panels/PeaksPanel/PeaksPreferences.tsx","../../src/component/panels/PeaksPanel/PeaksTable.tsx","../../src/component/panels/PeaksPanel/PeaksPanel.tsx","../../src/component/modal/CopyClipboardModal.tsx","../../src/component/panels/RangesPanel/RangesHeader.tsx","../../src/component/panels/RangesPanel/RangesPreferences.tsx","../../src/component/hooks/useTableSortBy.tsx","../../src/component/panels/extra/preferences/ColumnsHelper.ts","../../src/component/panels/RangesPanel/TableColumns/AbsoluteColumn.tsx","../../src/component/elements/formik/FormikOnChange.tsx","../../src/component/modal/editRange/forms/components/AddSignalFormTab.tsx","../../src/component/modal/editRange/forms/components/DeltaInput.tsx","../../src/component/modal/editRange/forms/components/CouplingsTable.tsx","../../src/component/modal/editRange/forms/components/SignalFormTab.tsx","../../src/component/modal/editRange/forms/components/SignalsForm.tsx","../../src/component/modal/editRange/forms/validation/EditRangeValidation.ts","../../src/component/modal/editRange/EditRangeModal.tsx","../../src/component/panels/RangesPanel/hooks/useEditRangeModal.tsx","../../src/component/panels/RangesPanel/TableColumns/ActionsColumn.tsx","../../src/component/panels/RangesPanel/TableColumns/CouplingColumn.tsx","../../src/component/panels/RangesPanel/TableColumns/RangeAssignmentsColumn.tsx","../../src/component/panels/RangesPanel/TableColumns/RangeColumn.tsx","../../src/component/panels/RangesPanel/TableColumns/RelativeColumn.tsx","../../src/component/panels/RangesPanel/TableColumns/SignalAssignmentsColumn.tsx","../../src/component/panels/RangesPanel/TableColumns/format.ts","../../src/component/panels/RangesPanel/TableColumns/SignalDeltaColumn.tsx","../../src/component/panels/RangesPanel/RangesTableRow.tsx","../../src/component/panels/RangesPanel/hooks/useMapRanges.ts","../../src/component/panels/RangesPanel/RangesTable.tsx","../../src/component/panels/RangesPanel/RangesPanel.tsx","../../src/component/hooks/useCheckToolsVisibility.ts","../../src/component/panels/SpectrumsPanel/SpectraPanelHeader.tsx","../../src/component/panels/SpectrumsPanel/base/ColorIndicator.tsx","../../src/component/panels/SpectrumsPanel/base/ShowHideMarkersButton.tsx","../../src/component/panels/SpectrumsPanel/base/ShowHideSpectrumButton.tsx","../../src/component/panels/SpectrumsPanel/SpectrumListItem.tsx","../../src/component/elements/formik/FormikColorPicker.tsx","../../src/component/panels/SpectrumsPanel/base/setting/Spectrum1DHistogram.tsx","../../src/component/panels/SpectrumsPanel/base/setting/Spectrum1DSetting.tsx","../../src/component/elements/formik/FormikSlider.tsx","../../src/component/panels/SpectrumsPanel/base/setting/Spectrum2DHistogram.tsx","../../src/component/panels/SpectrumsPanel/base/setting/Spectrum2DSetting.tsx","../../src/component/panels/SpectrumsPanel/base/setting/SpectrumSetting.tsx","../../src/component/panels/SpectrumsPanel/SpectrumsTabs.tsx","../../src/component/panels/SpectrumsPanel/SpectrumListPanel.tsx","../../src/data/constants/DefaultPathLengths.ts","../../src/component/modal/editZone/validation/isDefaultPathLength.ts","../../src/component/panels/SummaryPanel/utilities/Utilities.ts","../../src/component/panels/SummaryPanel/utilities/IsInView.ts","../../src/component/panels/SummaryPanel/CorrelationTable/editLink/Confirmation.tsx","../../src/component/panels/SummaryPanel/CorrelationTable/editLink/EditPathLength.tsx","../../src/component/panels/SummaryPanel/CorrelationTable/editLink/MoveLink.tsx","../../src/component/panels/SummaryPanel/CorrelationTable/editLink/EditLinkModal.tsx","../../src/component/panels/SummaryPanel/CorrelationTable/AdditionalColumnHeader.tsx","../../src/component/panels/SummaryPanel/CorrelationTable/AdditionalColumnField.tsx","../../src/component/panels/SummaryPanel/CorrelationTable/CorrelationTableRow.tsx","../../src/component/panels/SummaryPanel/CorrelationTable/CorrelationTable.tsx","../../src/component/panels/SummaryPanel/Overview.tsx","../../src/component/elements/MolecularFormulaInput.tsx","../../src/component/panels/SummaryPanel/SetMolecularFormulaModal.tsx","../../src/component/panels/SummaryPanel/SetShiftTolerancesModal.tsx","../../src/component/panels/SummaryPanel/SummaryPanel.tsx","../../src/component/panels/ZonesPanel/ZonesPreferences.tsx","../../src/component/modal/editZone/EditPathLengthFormik.tsx","../../src/component/modal/editZone/SignalFormTab.tsx","../../src/component/modal/editZone/SignalsForm.tsx","../../src/component/modal/editZone/validation/EditZoneValidation.ts","../../src/component/modal/editZone/EditZoneModal.tsx","../../src/component/panels/ZonesPanel/TableColumns/ActionsColumn.tsx","../../src/component/panels/ZonesPanel/TableColumns/SignalAssignmentsColumn.tsx","../../src/component/panels/ZonesPanel/TableColumns/SignalAssignmentsColumns.tsx","../../src/component/panels/ZonesPanel/TableColumns/SignalDeltaColumn.tsx","../../src/component/panels/ZonesPanel/TableColumns/ZoneAssignmentsColumn.tsx","../../src/component/panels/ZonesPanel/TableColumns/ZoneAssignmentsColumns.tsx","../../src/component/panels/ZonesPanel/ZonesTableRow.tsx","../../src/component/panels/ZonesPanel/ZonesTable.tsx","../../src/component/panels/ZonesPanel/ZonesPanel.tsx","../../src/data/data1d/database.ts","../../src/component/panels/databasePanel/DatabasePreferences.tsx","../../src/component/panels/databasePanel/DatabaseTable.tsx","../../src/component/panels/databasePanel/DatabasePanel.tsx","../../src/component/elements/Table/Table.tsx","../../src/component/elements/Table/TableBody.tsx","../../src/component/elements/Table/TableCell.tsx","../../src/component/elements/Table/TableHead.tsx","../../src/component/elements/Table/TableRow.tsx","../../src/component/panels/filtersPanel/FiltersTable.tsx","../../src/component/panels/filtersPanel/FilterPanel.tsx","../../src/component/panels/predictionPanel/PredictionOptions.tsx","../../src/component/panels/predictionPanel/PredictionPanel.tsx","../../src/component/panels/Panels.tsx","../../src/component/hooks/useToolsFunctions.ts","../../src/component/EventsTrackers/KeysListenerTracker.tsx","../../src/component/assignment/actions/initAssignment.ts","../../src/component/assignment/actions/removeAssignment.ts","../../src/component/assignment/actions/setActiveAssignment.ts","../../src/component/assignment/actions/toggleAssignment.ts","../../src/component/assignment/AssignmentsReducer.ts","../../src/component/assignment/index.tsx","../../src/constants.ts","../../src/versionInfo.ts","../../src/component/elements/Logo.tsx","../../src/component/modal/AboutUsModal.tsx","../../src/component/modal/setting/ControllersTabContent.tsx","../../src/component/modal/setting/DisplayTabContent.tsx","../../src/component/modal/setting/FormattingTabContent.tsx","../../src/component/modal/setting/WorkspaceItem.tsx","../../src/component/modal/setting/settingsValidation.ts","../../src/component/modal/setting/GeneralSettings.tsx","../../src/component/header/AutoPeakPickingOptionPanel.tsx","../../src/component/header/BaseLineCorrectionPanel.tsx","../../src/component/elements/InputRange.tsx","../../src/component/header/ManualPhaseCorrectionPanel.tsx","../../src/component/header/RangesPickingOptionPanel.tsx","../../src/component/header/ZeroFillingOptionsPanel.tsx","../../src/component/header/Zones2DOptionPanel.tsx","../../src/component/header/Header.tsx","../../src/component/utility/FileUtility.ts","../../src/component/loader/DropZone.tsx","../../src/component/reducer/IgnoreActions.ts","../../src/component/elements/ToolbarMenu.tsx","../../src/component/hooks/useDatumWithSpectraStatistics.ts","../../src/component/elements/formik/FormikTextarea.tsx","../../src/component/modal/ImportPublicationStringModal.tsx","../../src/component/modal/LoadJCAMPModal.tsx","../../src/component/toolbar/BasicToolBar.tsx","../../src/component/elements/toggle/ToggleButton.tsx","../../src/component/elements/toggle/ToggleButtonGroup.tsx","../../src/component/toolbar/FunctionToolBar.tsx","../../src/component/toolbar/ToolBar.tsx","../../src/component/NMRium.tsx","../../src/demo/views/Test.tsx","../../src/demo/test/TestRoutes.tsx","../../src/index.tsx"],"sourcesContent":["const p = function polyfill() {\n    const relList = document.createElement('link').relList;\n    if (relList && relList.supports && relList.supports('modulepreload')) {\n        return;\n    }\n    for (const link of document.querySelectorAll('link[rel=\"modulepreload\"]')) {\n        processPreload(link);\n    }\n    new MutationObserver((mutations) => {\n        for (const mutation of mutations) {\n            if (mutation.type !== 'childList') {\n                continue;\n            }\n            for (const node of mutation.addedNodes) {\n                if (node.tagName === 'LINK' && node.rel === 'modulepreload')\n                    processPreload(node);\n            }\n        }\n    }).observe(document, { childList: true, subtree: true });\n    function getFetchOpts(script) {\n        const fetchOpts = {};\n        if (script.integrity)\n            fetchOpts.integrity = script.integrity;\n        if (script.referrerpolicy)\n            fetchOpts.referrerPolicy = script.referrerpolicy;\n        if (script.crossorigin === 'use-credentials')\n            fetchOpts.credentials = 'include';\n        else if (script.crossorigin === 'anonymous')\n            fetchOpts.credentials = 'omit';\n        else\n            fetchOpts.credentials = 'same-origin';\n        return fetchOpts;\n    }\n    function processPreload(link) {\n        if (link.ep)\n            // ep marker = processed\n            return;\n        link.ep = true;\n        // prepopulate the load record\n        const fetchOpts = getFetchOpts(link);\n        fetch(link.href, fetchOpts);\n    }\n};__VITE_IS_MODERN__&&p();","import { SubMenu, MenuItem } from 'rc-menu';\nimport { createElement, cloneElement } from 'react';\n\nfunction buildMenu(array: Array<any> = []) {\n  let menu: Array<any> = [];\n  for (const item of array) {\n    if (item.children && Array.isArray(item.children)) {\n      menu.push(getMenu(item.groupName, [item], []));\n    } else {\n      menu.push(\n        createElement(MenuItem, { key: item.title, ...item }, item.title),\n      );\n    }\n  }\n  return menu;\n}\n\nfunction getMenu(\n  key,\n  array: Array<any> = [],\n  nodes: Array<any> = [],\n  parentIndex = 0,\n) {\n  let _nodes = nodes;\n  let children: Array<any> = [];\n\n  if (parentIndex !== -1 && _nodes[parentIndex]) {\n    _nodes[parentIndex] = cloneElement(_nodes[parentIndex], {}, children);\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-for-in-array\n  for (const index in array) {\n    if (array[index].children && Array.isArray(array[index].children)) {\n      const node = createElement(SubMenu, {\n        key: index + key,\n        title: array[index].groupName,\n      });\n      _nodes.push(node);\n      return getMenu(index + key, array[index].children, _nodes, 0);\n    } else {\n      children.push(\n        createElement(\n          MenuItem,\n          { key: index + key, ...array[index] },\n          array[index].title,\n        ),\n      );\n    }\n  }\n  return _nodes;\n}\n\nfunction mapTreeToFlatArray(array: Array<any> = []) {\n  let routes: Array<any> = [];\n  for (const item of array) {\n    if (item.children && Array.isArray(item.children)) {\n      routes = routes.concat(getFlatArray([item], []));\n    } else {\n      routes.push(item);\n    }\n  }\n  return routes;\n}\n\nfunction getFlatArray(inputArray: Array<any> = [], children: Array<any> = []) {\n  let _children = children;\n\n  for (const item of inputArray) {\n    if (item.children && Array.isArray(item.children)) {\n      return getFlatArray(item.children, _children);\n    } else {\n      children.push(item);\n    }\n  }\n  return _children;\n}\n\nfunction getKey(filePath = '') {\n  const match = new RegExp(/^(?<path>.*)\\/(?<file>[^/]*)$/g).exec(filePath);\n  let parentFolderName = '';\n  if (match) {\n    const parentPath = match[1].split('/');\n    parentFolderName =\n      parentPath.length > 2\n        ? parentPath[parentPath.length - 2] + parentPath[parentPath.length - 1]\n        : parentPath[parentPath.length - 1];\n  }\n  return parentFolderName + filePath.replace(/\\.|\\s|\\//g, '');\n}\n\nexport { buildMenu, getKey, mapTreeToFlatArray };\n","/** @jsxImportSource @emotion/react */\n\nimport { css } from '@emotion/react';\nimport Menu from 'rc-menu';\nimport { memo, useMemo } from 'react';\nimport 'rc-menu/assets/index.css';\nimport { FaBars } from 'react-icons/fa';\nimport { withRouter } from 'react-router-dom';\n\nimport { buildMenu, getKey } from './utility/menu';\n\nconst sidebarCss = css`\n  background: #2ca8ff;\n  position: fixed;\n  top: 0;\n  height: 100%;\n  bottom: 0;\n  left: 0;\n  z-index: 1031;\n`;\n\nconst sidebarOpenCss = css`\n  width: 260px;\n`;\n\nconst sidebarClosedCss = css`\n  width: 3%;\n`;\n\nconst menuBtCss = css`\n  margin-left: 4px;\n  margin-top: 2px;\n  margin-bottom: 2px;\n  margin-right: 4px;\n  z-index: 7;\n  font-size: 18px;\n  background-color: transparent;\n  border: none !important;\n  height: 30px;\n  width: 30px;\n  padding: 1px 6px;\n\n  & svg {\n    fill: white;\n  }\n\n  &:focus {\n    outline: none;\n  }\n\n  &:active {\n    background-color: rgba(0, 0, 0, 0.5);\n    border-radius: 50%;\n  }\n  &:hover {\n    background-color: rgba(0, 0, 0, 0.2);\n    border-radius: 50%;\n  }\n`;\n\nconst logoCss = css`\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  z-index: 4;\n  border-bottom: 1px solid #eee;\n`;\n\nconst simpleTextCss = css`\n  text-transform: uppercase;\n  padding: 0.5rem 0;\n  display: block;\n  white-space: nowrap;\n  font-size: 1em;\n  color: #fff;\n  text-decoration: none;\n  font-weight: 400;\n  line-height: 30px;\n  overflow: hidden;\n`;\n\nconst logoNormalCss = css`\n  display: block;\n  opacity: 1;\n  transform: translateZ(0);\n`;\n\nconst sidebarWrapperCss = css`\n  position: relative;\n  height: calc(100vh - 75px);\n  overflow-y: auto;\n  overflow-x: hidden;\n  width: 260px;\n  z-index: 4;\n  padding-bottom: 100px;\n`;\n\nfunction Sidebar(props) {\n  const routes = useMemo(() => {\n    return buildMenu(props.routes);\n  }, [props.routes]);\n\n  const subDisplay = props.menuIsClosed ? 'none' : 'block';\n\n  return (\n    <div\n      css={css(\n        sidebarCss,\n        props.menuIsClosed ? sidebarClosedCss : sidebarOpenCss,\n      )}\n    >\n      <div css={logoCss}>\n        <div style={{ display: subDisplay, padding: '0.5rem 0.7rem' }}>\n          <a css={css(simpleTextCss, logoNormalCss)}>NMRium</a>\n        </div>\n        <button type=\"button\" css={menuBtCss} onClick={props.onMenuToggle}>\n          <FaBars />\n        </button>\n      </div>\n      <div css={sidebarWrapperCss} style={{ display: subDisplay }}>\n        <Menu\n          onClick={(e) => {\n            // console.log((e.item.props.view || '') + getKey(e.item.props.file));\n            props.history.push(\n              `/SamplesDashboard/${Math.random()\n                .toString(36)\n                .replace('0.', '')}/${\n                // @ts-expect-error This will be fixed by updating use of rc-menu\n                (e.item.props.view || 'View') + getKey(e.item.props.file)\n              }`,\n            );\n          }}\n          mode=\"inline\"\n        >\n          {routes}\n        </Menu>\n      </div>\n    </div>\n  );\n}\n\nexport default withRouter(memo(Sidebar));\n","const scriptRel = 'modulepreload';const seen = {};const base = './';export const __vitePreload = function preload(baseModule, deps) {\n    // @ts-ignore\n    if (!__VITE_IS_MODERN__ || !deps || deps.length === 0) {\n        return baseModule();\n    }\n    return Promise.all(deps.map((dep) => {\n        // @ts-ignore\n        dep = `${base}${dep}`;\n        // @ts-ignore\n        if (dep in seen)\n            return;\n        // @ts-ignore\n        seen[dep] = true;\n        const isCss = dep.endsWith('.css');\n        const cssSelector = isCss ? '[rel=\"stylesheet\"]' : '';\n        // @ts-ignore check if the file is already preloaded by SSR markup\n        if (document.querySelector(`link[href=\"${dep}\"]${cssSelector}`)) {\n            return;\n        }\n        // @ts-ignore\n        const link = document.createElement('link');\n        // @ts-ignore\n        link.rel = isCss ? 'stylesheet' : scriptRel;\n        if (!isCss) {\n            link.as = 'script';\n            link.crossOrigin = '';\n        }\n        link.href = dep;\n        // @ts-ignore\n        document.head.appendChild(link);\n        if (isCss) {\n            return new Promise((res, rej) => {\n                link.addEventListener('load', res);\n                link.addEventListener('error', () => rej(new Error(`Unable to preload CSS for ${dep}`)));\n            });\n        }\n    })).then(() => baseModule());\n}","import { lazy, memo } from 'react';\n\nexport const possibleViews = {\n  Exam: memo(lazy(() => import('./Exam'))),\n  Exercise: memo(lazy(() => import('./Exercise'))),\n  SingleView: memo(lazy(() => import('./SingleView'))),\n  Test: memo(lazy(() => import('./Test'))),\n  View: memo(lazy(() => import('./View'))),\n  TwoInstances: memo(lazy(() => import('./TwoInstances'))),\n  Teaching: memo(lazy(() => import('./Teaching'))),\n  Prediction: memo(lazy(() => import('./Prediction'))),\n};\n","/** @jsxImportSource @emotion/react */\n\nimport { css } from '@emotion/react';\nimport { Suspense, StrictMode, useMemo, useState, useCallback } from 'react';\nimport { Route, Switch } from 'react-router-dom';\n\nimport Sidebar from '../Sidebar';\nimport { mapTreeToFlatArray, getKey } from '../utility/menu';\nimport { possibleViews } from '../views';\n\nconst mainPanelCss = css`\n  position: relative;\n  float: right;\n  height: 100%;\n  background-color: #ebecf1;\n`;\n\nconst mainPanelOpenCss = css`\n  width: calc(100% - 260px);\n`;\n\nconst mainPanelClosedCss = css`\n  width: 98%;\n  margin-left: 20px !important;\n`;\n\ninterface DashboardProps {\n  routes: any[];\n  baseURL: string;\n}\n\nexport function Dashboard(props: DashboardProps) {\n  const { routes = [], baseURL } = props;\n  const routesList = useMemo(() => mapTreeToFlatArray(routes), [routes]);\n  const [menuIsClosed, setMenuIsClosed] = useState(false);\n  const toggleMenu = useCallback(\n    () => setMenuIsClosed(!menuIsClosed),\n    [menuIsClosed],\n  );\n\n  return (\n    <div\n      style={{\n        position: 'relative',\n        top: 0,\n        height: '100vh',\n      }}\n    >\n      <Sidebar\n        {...props}\n        routes={routes}\n        menuIsClosed={menuIsClosed}\n        onMenuToggle={toggleMenu}\n      />\n      <div\n        css={css(\n          mainPanelCss,\n          menuIsClosed ? mainPanelClosedCss : mainPanelOpenCss,\n        )}\n      >\n        <StrictMode>\n          <Suspense fallback={<div>Loading...</div>}>\n            <Switch>\n              {routesList.map((prop) => {\n                return (\n                  <Route\n                    path={`/SamplesDashboard/:id/${\n                      (prop.view || 'View') + getKey(prop.file)\n                    }`}\n                    render={(props) => (\n                      <RenderView {...props} prop={prop} baseURL={baseURL} />\n                    )}\n                    key={getKey(prop.file)}\n                  />\n                );\n              })}\n\n              {routesList.length > 0 && (\n                <Route\n                  path=\"/\"\n                  render={() => {\n                    const routeProp = routesList[0];\n                    const viewName = routeProp.view ? routeProp.view : 'View';\n                    const RenderedView = possibleViews[viewName];\n                    return <RenderedView {...routeProp[0]} />;\n                  }}\n                  key={getKey(routesList[0].file)}\n                />\n              )}\n            </Switch>\n          </Suspense>\n        </StrictMode>\n      </div>\n    </div>\n  );\n}\n\nfunction RenderView(props) {\n  const {\n    match: {\n      params: { id },\n    },\n    prop,\n    baseURL,\n  } = props;\n  const viewName = prop.view ? prop.view : 'View';\n  const RenderedView = possibleViews[viewName];\n  return (\n    <RenderedView key={id} {...prop} id={getKey(prop.file)} baseURL={baseURL} />\n  );\n}\n\nexport default Dashboard;\n","import { Suspense } from 'react';\nimport { Route, Switch } from 'react-router-dom';\n\nimport { getKey } from '../utility/menu';\nimport { possibleViews } from '../views';\n\ninterface SingleDisplayerLayoutProps {\n  view: any;\n  patrh: any;\n  path: any;\n}\n\nexport default function SingleDisplayerLayout(\n  props: SingleDisplayerLayoutProps,\n) {\n  return (\n    <div\n      style={{\n        position: 'relative',\n        top: 0,\n        height: '100vh',\n      }}\n    >\n      <div\n        style={{\n          position: 'absolute',\n          display: 'block',\n          width: '99%',\n          marginLeft: 'auto',\n          marginRight: 'auto',\n          height: '100%',\n          backgroundColor: 'ebecf1',\n        }}\n      >\n        <Suspense fallback={<div>Loading...</div>}>\n          <Switch>\n            <Route\n              path=\"/\"\n              render={(routeProps: any) => {\n                const {\n                  match: {\n                    params: { id },\n                  },\n                } = routeProps;\n                const viewName = props.view ? props.view : 'SingleView';\n\n                const RenderedView = possibleViews[viewName];\n\n                return (\n                  <RenderedView key={id} {...props} id={getKey(props.patrh)} />\n                );\n              }}\n              key={getKey(props.path)}\n            />\n          </Switch>\n        </Suspense>\n      </div>\n    </div>\n  );\n}\n","import { useEffect, useState, useCallback, CSSProperties } from 'react';\n\nimport routes from '../samples.json';\n\nimport AdminLayout from './Admin';\nimport SingleDisplayerLayout from './SingleDisplayerLayout';\n\nconst styles: Record<\n  | 'bodyContainer'\n  | 'container'\n  | 'normal'\n  | 'error'\n  | 'errorHeader'\n  | 'normalHeader'\n  | 'loadButton',\n  CSSProperties\n> = {\n  bodyContainer: {\n    display: 'flex',\n    justifyContent: 'center',\n    alignItems: 'center',\n    height: '100vh',\n    width: '100vw',\n    backgroundColor: '#e3e3e3',\n  },\n  container: {\n    width: '30%',\n    height: '40%',\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'center',\n    borderRadius: '10px',\n    fontSize: '20px',\n    textAlign: 'center',\n  },\n  normal: {\n    backgroundColor: 'white',\n    color: 'black',\n  },\n  error: {\n    backgroundColor: 'red',\n    color: 'white',\n  },\n  errorHeader: {\n    fontSize: '100px',\n  },\n  normalHeader: {\n    fontSize: '24px',\n  },\n  loadButton: {\n    fontSize: '12px',\n    padding: '12px 40px',\n    borderRadius: '10px',\n    border: '1px solid #c70000',\n    fontWeight: 'bold',\n    cursor: 'pointer',\n  },\n};\n\nasync function loadData(url) {\n  const response = await fetch(url);\n  try {\n    checkStatus(response);\n    const data = await response.json();\n    return data;\n  } catch (e) {\n    // eslint-disable-next-line no-console\n    console.error(e);\n    return null;\n  }\n}\n\nfunction checkStatus(response) {\n  if (!response.ok) {\n    throw new Error(`HTTP ${response.status} - ${response.statusText}`);\n  }\n  return response;\n}\n\nconst Main = (props) => {\n  const [data, setRoutes] = useState<{\n    isLoaded: boolean;\n    status: number;\n    routes?: Array<any>;\n    baseURL?: string;\n    path?: string;\n  }>({\n    isLoaded: false,\n    status: 200,\n    routes: [],\n  });\n\n  const [dashBoardType, setDashBoardType] = useState('');\n\n  const loadHandler = useCallback(() => {\n    setRoutes({ isLoaded: true, status: 200, routes: routes });\n  }, []);\n\n  const getFileExtension = (url = '') => {\n    return url.substring(url.lastIndexOf('.') + 1);\n  };\n\n  const href = window.location.href;\n  useEffect(() => {\n    const qs = new URL(href).searchParams;\n    if (qs.has('sampleURL')) {\n      const sampleURL = qs.get('sampleURL');\n      if (!sampleURL) return;\n\n      const extention = getFileExtension(sampleURL).toLowerCase();\n      switch (extention) {\n        case 'json': {\n          setDashBoardType('multi');\n          void loadData(sampleURL).then((remoteRoutes) => {\n            if (remoteRoutes) {\n              const baseURL = sampleURL.replace(\n                /^(?<url>.*[\\\\/])?(?<filename>.*?\\.[^.]*?|)$/g,\n                '$1',\n              );\n\n              const _remoteRoutes = JSON.parse(\n                JSON.stringify(remoteRoutes).replace(/\\.\\/+?/g, baseURL),\n              );\n              setRoutes({\n                isLoaded: true,\n                status: 200,\n                routes: _remoteRoutes,\n                baseURL,\n              });\n            } else {\n              setRoutes({ isLoaded: false, status: 404, routes: [] });\n            }\n          });\n          break;\n        }\n        case 'dx':\n        case 'jdx': {\n          setDashBoardType('single');\n          setRoutes({\n            isLoaded: true,\n            status: 200,\n            path: sampleURL,\n          });\n\n          break;\n        }\n\n        default:\n          break;\n      }\n    } else {\n      setDashBoardType('multi');\n      setRoutes({ isLoaded: true, status: 200, routes: routes, baseURL: './' });\n    }\n  }, [href]);\n\n  return !data.isLoaded ? (\n    <div style={styles.bodyContainer}>\n      <div\n        style={{\n          ...styles.container,\n          ...(data.status === 200 ? styles.normal : styles.error),\n        }}\n      >\n        {data.status === 200 ? (\n          <div>\n            <p style={styles.normalHeader}>Please wait</p>\n            <p>We will redirect you in a minute</p>\n          </div>\n        ) : (\n          <div>\n            <p style={styles.errorHeader}>404</p>\n            <p>Resource not found.</p>\n            <button\n              style={styles.loadButton}\n              type=\"button\"\n              onClick={loadHandler}\n            >\n              Load local samples\n            </button>\n          </div>\n        )}\n      </div>\n    </div>\n  ) : dashBoardType && dashBoardType === 'single' ? (\n    <SingleDisplayerLayout {...props} path={data.path} />\n  ) : (\n    <AdminLayout {...props} routes={data.routes} baseURL={data.baseURL} />\n  );\n};\n\nexport default Main;\n","import { KeyboardEvent, MouseEvent } from 'react';\n\nexport default function checkModifierKeyActivated(\n  event: KeyboardEvent | MouseEvent,\n): boolean {\n  const modifiersKeys = [\n    'Alt',\n    'AltGraph',\n    'CapsLock',\n    'Control',\n    'Meta',\n    'NumLocK',\n    'ScrollLock',\n    'Shift',\n    'OS',\n  ];\n  for (const key of modifiersKeys) {\n    if (event.getModifierState(key)) {\n      return true;\n    }\n  }\n  return false;\n}\n","import { xGetFromToIndex } from 'ml-spectra-processing';\nimport { analyseMultiplet } from 'multiplet-analysis';\n\nexport const MAX_LENGTH = 2048;\n\nexport default function detectSignal(\n  x: Float64Array,\n  re: Float64Array,\n  from,\n  to,\n  frequency,\n) {\n  const { fromIndex, toIndex } = xGetFromToIndex(x, {\n    from: from,\n    to: to,\n  });\n\n  if (toIndex - fromIndex <= MAX_LENGTH) {\n    const data = {\n      x: x.subarray(fromIndex, toIndex),\n      y: re.subarray(fromIndex, toIndex),\n    };\n\n    const result = analyseMultiplet(data, {\n      frequency: frequency,\n      takeBestPartMultiplet: true,\n      symmetrizeEachStep: true,\n    });\n    if (result && result.chemShift === undefined) return;\n    return {\n      multiplicity: result.js.map((j) => j.multiplicity).join(''),\n      kind: 'signal',\n      delta: result.chemShift,\n      js: result.js,\n    };\n  } else {\n    throw new Error(`length of signal should not exceed ${MAX_LENGTH} points`);\n  }\n}\n","import lodashDebounce from 'lodash/debounce';\nimport lodashMap from 'lodash/map';\nimport {\n  createContext,\n  CSSProperties,\n  ReactNode,\n  useCallback,\n  useEffect,\n  useReducer,\n  useRef,\n  useState,\n} from 'react';\n\nconst initialState = {\n  step: 'initial',\n  brush: {\n    start: null,\n    end: null,\n  },\n  startX: 0,\n  endX: 0,\n  startY: 0,\n  endY: 0,\n};\n\nexport const BrushContext = createContext(initialState);\n\ninterface BrushTrackerProps {\n  children: ReactNode;\n  className?: string;\n  style?: CSSProperties;\n  onBrush?: (element: any) => void;\n  onZoom?: (element: any) => void;\n  onDoubleClick?: (element: any) => void;\n  onClick?: (element: any) => void;\n  noPropagation?: boolean;\n}\n\nexport function BrushTracker({\n  children,\n  className,\n  style,\n  onBrush = () => null,\n  onZoom = () => null,\n  onDoubleClick = () => null,\n  onClick = () => null,\n  noPropagation,\n}: BrushTrackerProps) {\n  const [state, dispatch] = useReducer(reducer, initialState);\n  const [mouseDownTime, setMouseDownTime] = useState<number>(0);\n  const debounceClickEventsRef = useRef<Array<any>>([]);\n\n  const mouseDownHandler = useCallback(\n    (event) => {\n      if (event.button === 0) {\n        if (noPropagation) {\n          event.stopPropagation();\n        }\n        dispatch({\n          type: 'DOWN',\n          shiftKey: event.shiftKey,\n          altKey: event.altKey,\n          screenX: event.screenX,\n          screenY: event.screenY,\n          clientX: event.clientX,\n          clientY: event.clientY,\n          boundingRect: event.currentTarget.getBoundingClientRect(),\n        });\n\n        setMouseDownTime(event.timeStamp);\n      }\n      return false;\n    },\n    [noPropagation],\n  );\n\n  const clickHandler = useCallback(\n    (e) => {\n      e.persist();\n      const timeStamp = e.timeStamp;\n      const boundingRect = e.currentTarget.getBoundingClientRect();\n      const x = e.clientX - boundingRect.x;\n      const y = e.clientY - boundingRect.y;\n\n      const callback = lodashDebounce(() => {\n        if (\n          timeStamp - mouseDownTime <= 150 &&\n          debounceClickEventsRef.current.length === 1\n        ) {\n          onClick({ ...e, x, y });\n        }\n        debounceClickEventsRef.current = [];\n      }, 200);\n\n      debounceClickEventsRef.current.push(callback);\n\n      callback();\n\n      if (debounceClickEventsRef.current.length > 1) {\n        lodashMap(debounceClickEventsRef.current, (debounce) =>\n          debounce.cancel(),\n        );\n        debounceClickEventsRef.current = [];\n        onDoubleClick({ ...e, x, y });\n      }\n    },\n    [mouseDownTime, onClick, onDoubleClick],\n  );\n\n  const handleMouseWheel = useCallback(\n    (event) => {\n      const boundingRect = event.currentTarget.getBoundingClientRect();\n      const x = event.clientX - boundingRect.x;\n      const y = event.clientY - boundingRect.y;\n\n      const { deltaY, deltaX, shiftKey, deltaMode } = event;\n      onZoom({ deltaY: deltaY || deltaX, shiftKey, deltaMode, x, y });\n    },\n    [onZoom],\n  );\n\n  useEffect(() => {\n    const { step, startX, endX, startY, endY } = state;\n\n    if (step === 'end' && Math.hypot(endX - startX, endY - startY) > 5) {\n      onBrush(state);\n      dispatch({\n        type: 'DONE',\n      });\n    }\n  }, [onBrush, state]);\n\n  const moveCallback = useCallback((event) => {\n    dispatch({\n      type: 'MOVE',\n      screenX: event.screenX,\n      screenY: event.screenY,\n      clientX: event.clientX,\n      clientY: event.clientY,\n    });\n  }, []);\n\n  const upCallback = useCallback((event) => {\n    dispatch({\n      type: 'UP',\n      clientX: event.clientX,\n      clientY: event.clientY,\n    });\n    return false;\n  }, []);\n\n  return (\n    <BrushContext.Provider value={state}>\n      <div\n        className={className}\n        style={style}\n        onMouseDown={mouseDownHandler}\n        onMouseUp={upCallback}\n        onMouseMove={moveCallback}\n        onClick={clickHandler}\n        onWheel={handleMouseWheel}\n      >\n        {children}\n      </div>\n    </BrushContext.Provider>\n  );\n}\n\nfunction reducer(state, action) {\n  switch (action.type) {\n    case 'UP':\n      if (state.step === 'brushing' || state.step === 'start') {\n        const { clientX, clientY } = action;\n\n        return {\n          ...state,\n          endX: clientX - state.boundingRect.x,\n          endY: clientY - state.boundingRect.y,\n\n          step: state.step === 'start' ? 'initial' : 'end',\n        };\n      }\n      return state;\n    case 'DOWN':\n      if (state.step === 'initial' || state.step === 'end') {\n        const {\n          screenX,\n          screenY,\n          clientX,\n          clientY,\n          boundingRect,\n          shiftKey,\n          altKey,\n        } = action;\n        const x = clientX - boundingRect.x;\n        const y = clientY - boundingRect.y;\n\n        return {\n          ...state,\n          shiftKey,\n          altKey,\n          startX: x,\n          startY: y,\n          startScreenX: screenX,\n          startScreenY: screenY,\n          startClientX: clientX,\n          startClientY: clientY,\n          boundingRect,\n          step: 'start',\n        };\n      }\n      return state;\n    case 'MOVE':\n      if (state.step === 'start' || state.step === 'brushing') {\n        const { clientX, clientY } = action;\n\n        return {\n          ...state,\n          step: 'brushing',\n          endX: clientX - state.boundingRect.x,\n          endY: clientY - state.boundingRect.y,\n        };\n      }\n      return state;\n    case 'DONE':\n      if (state.step === 'end') {\n        return {\n          ...state,\n          step: 'initial',\n        };\n      }\n      break;\n    default:\n      return state;\n  }\n}\n","import {\n  CSSProperties,\n  createContext,\n  useCallback,\n  useState,\n  useContext,\n  ReactNode,\n} from 'react';\n\nexport const MouseContext = createContext<any>({});\nconst MouseaProvider = MouseContext.Provider;\n\nexport function useMouseTracker() {\n  return useContext(MouseContext);\n}\n\ninterface MouseTrackerProps {\n  children: ReactNode;\n  className?: string;\n  style?: CSSProperties;\n  noPropagation?: boolean;\n}\n\nexport function MouseTracker({\n  children,\n  className,\n  style,\n  noPropagation,\n}: MouseTrackerProps) {\n  const [mouseTrackerState, setMouseTrackerState] = useState<{\n    x: number;\n    y: number;\n  } | null>(null);\n  const mouseMoveHandler = useCallback(\n    (e) => {\n      const boundingRect = e.currentTarget.getBoundingClientRect();\n      const x = e.clientX - boundingRect.x;\n      const y = e.clientY - boundingRect.y;\n      setMouseTrackerState({ x, y });\n      if (noPropagation) {\n        e.stopPropagation();\n      }\n    },\n    [noPropagation],\n  );\n\n  const mouseLeaveHandler = useCallback(\n    (e) => {\n      setMouseTrackerState(null);\n      if (noPropagation) {\n        e.stopPropagation();\n      }\n    },\n    [noPropagation],\n  );\n\n  return (\n    <MouseaProvider value={mouseTrackerState}>\n      <div\n        className={className}\n        style={style}\n        onMouseMove={mouseMoveHandler}\n        onMouseLeave={mouseLeaveHandler}\n      >\n        {children}\n      </div>\n    </MouseaProvider>\n  );\n}\n","export const SignalKinds: { key: string; label: string; value: string }[] = [\n  {\n    key: 'signal',\n    label: 'Signal',\n    value: 'signal',\n  },\n  {\n    key: 'reference',\n    label: 'Reference',\n    value: 'reference',\n  },\n  {\n    key: 'solvent',\n    label: 'Solvent',\n    value: 'solvent',\n  },\n  {\n    key: 'impurity',\n    label: 'Impurity',\n    value: 'impurity',\n  },\n  {\n    key: 'standard',\n    label: 'Standard',\n    value: 'standard',\n  },\n  {\n    key: 'p1',\n    label: 'P1',\n    value: 'p1',\n  },\n  {\n    key: 'p2',\n    label: 'P2',\n    value: 'p2',\n  },\n  {\n    key: 'p3',\n    label: 'P3',\n    value: 'p3',\n  },\n];\n\nexport const SignalKindsToInclude = ['signal'];\nexport const DatumKind = { signal: 'signal', mixed: 'mixed' };\n","import { reimAbsolute } from 'ml-spectra-processing';\n\nexport const id = 'absolute';\nexport const name = 'Absolute';\n\n/**\n *\n * @param {Datum1d} datum1d\n */\n\nexport function apply(datum1D) {\n  if (!isApplicable(datum1D)) {\n    throw new Error('absolute not applicable on this data');\n  }\n\n  datum1D.data.re = reimAbsolute(datum1D.data);\n  datum1D.data.im = new Float64Array(0);\n  datum1D.info = { ...datum1D.info, isComplex: false };\n}\n\nexport function isApplicable(datum1D) {\n  if (datum1D.info.isComplex && !datum1D.info.isFid) return true;\n  return false;\n}\n\nexport function reduce() {\n  return {\n    once: false,\n    reduce: null,\n  };\n}\n","import { reimAutoPhaseCorrection } from 'ml-spectra-processing';\n\nexport const id = 'autoPhaseCorrection';\nexport const name = 'Automatic phase correction';\n\n/**\n *\n * @param {Datum1d} datum1d\n * @param {Object} [options={}]\n * @param {number} [options.ph0=0]\n * @param {number} [options.ph1=0]\n */\n\nconst defaultOptions = {\n  minRegSize: 5,\n  maxDistanceToJoin: 128,\n  magnitudeMode: true,\n  factorNoise: 5,\n};\n\nexport function apply(datum1D, options = {}) {\n  if (!isApplicable(datum1D)) {\n    throw new Error('phaseCorrection not applicable on this data');\n  }\n  return reimAutoPhaseCorrection(datum1D.data, {\n    ...defaultOptions,\n    ...options,\n  });\n}\n\nexport function isApplicable(datum1D) {\n  if (datum1D.info.isComplex && !datum1D.info.isFid) return true;\n  return false;\n}\n\nexport function reduce(previousValue, newValue) {\n  let reduced = Object.assign({}, previousValue);\n  for (const k in reduced) {\n    reduced[k] += newValue[k];\n  }\n  return {\n    once: true,\n    reduce: reduced,\n  };\n}\n","import airPLS from 'ml-airpls';\nimport equallySpaced from 'ml-array-xy-equally-spaced';\nimport baselineRegression from 'ml-baseline-correction-regression';\n\nexport const id = 'baselineCorrection';\nexport const name = 'Baseline correction';\n\n/**\n *\n * @param {Datum1d} datum1d\n */\n\nexport const baselineAlgorithms = {\n  airpls: 'airPLS',\n  polynomial: 'Polynomial',\n};\n\nexport function apply(datum1D, options: any = {}) {\n  if (!isApplicable(datum1D)) {\n    throw new Error('baselineCorrection not applicable on this data');\n  }\n  const { algorithm, zones = [] } = options;\n  let { x, re } = datum1D.data;\n\n  let corrected;\n  switch (algorithm) {\n    case 'airpls':\n      corrected = airPLS(x, re, options).corrected;\n      break;\n    case 'polynomial':\n      {\n        const baselineOptions = {\n          regressionOptions: options.degree,\n        };\n        let reduced = equallySpaced(\n          { x, y: re },\n          { numberOfPoints: 4096, zones },\n        );\n        let result = baselineRegression(reduced.x, reduced.y, baselineOptions);\n        let { regression } = result;\n        corrected = new Float64Array(x.length);\n        for (let i = 0; i < re.length; i++) {\n          corrected[i] = re[i] - regression.predict(x[i]);\n        }\n      }\n\n      break;\n    default:\n      throw new Error(`baselineCorrection: algorithm unknown: ${algorithm}`);\n  }\n\n  Object.assign(datum1D.data, { re: corrected });\n}\n\nexport function isApplicable(datum1D) {\n  if (!datum1D.info.isFid) return true;\n  return false;\n}\n\nexport function reduce() {\n  return {\n    once: false,\n    reduce: null,\n  };\n}\n","import { mean } from 'ml-stat/array';\n\nexport const id = 'centerMean';\nexport const name = 'Center Mean';\n\n/**\n * Computes the arithmetic mean of the given values\n * @param {Datum1d} datum1d\n */\n\nexport function apply(datum1D) {\n  if (!isApplicable(datum1D)) {\n    throw new Error('Center Mean is not applicable on this data');\n  }\n\n  const re = datum1D.data.re.slice(0);\n  const im = datum1D.data.im?.slice(0);\n\n  const reMean = mean(re);\n  const imMean = mean(im || []);\n\n  for (let i = 0; i < re.length; i++) {\n    re[i] -= reMean;\n    if (im) {\n      im[i] -= imMean;\n    }\n  }\n\n  datum1D.data.re = re;\n\n  if (im) {\n    datum1D.data.im = im;\n  }\n}\n\nexport function isApplicable(datum1D) {\n  if (datum1D.info.isComplex && !datum1D.info.isFid) return true;\n  return false;\n}\n\nexport function reduce() {\n  return {\n    once: false,\n    reduce: null,\n  };\n}\n","export const id = 'digitalFilter';\nexport const name = 'Digital Filter';\n\n/**\n * Move points from the beginning to the end of FID and performs a first order phase correction\n * @param {Datum1d} datum1d\n */\n\nexport function apply(datum1D, options: any = {}) {\n  if (!isApplicable(datum1D)) {\n    throw new Error('Digital Filter is not applicable on this data');\n  }\n\n  let { digitalFilterValue = 0 } = options;\n  let re = new Float64Array(datum1D.data.re);\n  let im = new Float64Array(datum1D.data.im);\n\n  let pointsToShift = Math.floor(digitalFilterValue);\n\n  const skip = 0;\n  pointsToShift += 0;\n\n  const newRe = new Float64Array(re.length);\n  const newIm = new Float64Array(im.length);\n  newRe.set(re.slice(pointsToShift));\n  newRe.set(re.slice(skip, pointsToShift), re.length - pointsToShift);\n  newIm.set(im.slice(pointsToShift));\n  newIm.set(im.slice(skip, pointsToShift), im.length - pointsToShift);\n\n  datum1D.data.re = newRe;\n  datum1D.data.im = newIm;\n}\n\nexport function isApplicable(datum1D) {\n  if (datum1D.info.isComplex && datum1D.info.isFid) return true;\n  return false;\n}\n\nexport function reduce() {\n  return {\n    once: true,\n    reduce: undefined,\n  };\n}\n","import equallySpaced from 'ml-array-xy-equally-spaced';\n\nexport const id = 'equallySpaced';\nexport const name = 'Equally Spaced';\n\n/**\n * Equally Spaced\n * **\n * Function that returns a Number array of equally spaced numberOfPoints\n * containing a representation of intensities of the spectra arguments x\n * and y.\n *\n * The options parameter contains an object in the following form:\n * from: starting point\n * to: last point\n * numberOfPoints: number of points between from and to\n * variant: \"slot\" or \"smooth\" - smooth is the default option\n *\n * The slot variant consist that each point in the new array is calculated\n * averaging the existing points between the slot that belongs to the current\n * value. The smooth variant is the same but takes the integral of the range\n * of the slot and divide by the step size between two points in the new array.\n *\n * @param {Datum1d} datum1d\n * @param {Object} options.from\n * @param {number} options.to\n * @param {number} options.numberOfPoints\n * @param {Array<{from:number;to:number}>} options.exclusions\n */\n\nexport function apply(datum1D, options: any = {}) {\n  if (!isApplicable(datum1D)) {\n    throw new Error('Equally Spaced is not applicable on this data');\n  }\n  const { from, to, numberOfPoints, exclusions } = options;\n  const { x, re, im } = datum1D.data;\n  const XREdata = equallySpaced(\n    { x, y: re },\n    { from, to, numberOfPoints, exclusions },\n  );\n\n  datum1D.data.x = XREdata.x;\n  datum1D.data.re = XREdata.y;\n  if (im) {\n    const XIMdata = equallySpaced(\n      { x, y: re },\n      { from, to, numberOfPoints, exclusions },\n    );\n    datum1D.data.im = XIMdata.y;\n  }\n}\n\nexport function isApplicable(datum1D) {\n  if (datum1D.info.isComplex && !datum1D.info.isFid) return true;\n  return false;\n}\n\nexport function reduce() {\n  return {\n    once: false,\n    reduce: null,\n  };\n}\n","import { xySetYValue, zonesNormalize } from 'ml-spectra-processing';\n\nimport { Datum1D } from '../../types/data1d/Datum1D';\n\nexport const id = 'exclusionZones';\nexport const name = 'Exclusion Zones';\n\n/**\n *\n * @param {Datum1d} datum1d\n */\n\nexport function apply(datum1D: Datum1D, zones = []) {\n  if (!isApplicable(datum1D)) {\n    throw new Error('Exclusion Zones filter not applicable on this data');\n  }\n  const { x, re, im } = datum1D.data;\n  datum1D.data.re = xySetYValue({ x, y: re }, { zones }).y as number[];\n  datum1D.data.im = (im\n    ? xySetYValue({ x, y: re }, { zones })\n    : im) as unknown as number[];\n}\n\nexport function isApplicable(datum1D: Datum1D) {\n  if (datum1D.info.isComplex && datum1D.info.isFt) return true;\n  return false;\n}\n\nexport function reduce(previousValue, newValue) {\n  return {\n    once: true,\n    reduce: zonesNormalize(previousValue.concat(newValue)),\n  };\n}\n","import { reimFFT, reimPhaseCorrection } from 'ml-spectra-processing';\n\nexport const id = 'fft';\nexport const name = 'FFT';\n\n/**\n *\n * @param {Datum1d} datum1d\n */\n\nexport function apply(datum1D) {\n  if (!isApplicable(datum1D)) {\n    throw new Error('fft not applicable on this data');\n  }\n\n  let digitalFilterApplied = datum1D.filters.some(\n    (e) => e.name === 'digitalFilter' && e.flag,\n  );\n\n  Object.assign(datum1D.data, reimFFT(datum1D.data, { applyZeroShift: true }));\n\n  if (digitalFilterApplied) {\n    let { digitalFilter } = datum1D.info;\n    let ph1 = (digitalFilter - Math.floor(digitalFilter)) * Math.PI * 2;\n    Object.assign(datum1D.data, reimPhaseCorrection(datum1D.data, 0, ph1));\n  }\n\n  datum1D.data.x = generateXAxis(datum1D);\n  datum1D.info = { ...datum1D.info, isFid: false, isFt: true };\n}\n\nexport function isApplicable(datum1D) {\n  if (datum1D.info.isComplex && datum1D.info.isFid) return true;\n  return false;\n}\n\nexport function reduce() {\n  return {\n    once: true,\n    reduce: undefined,\n  };\n}\n\nfunction generateXAxis(datum1D) {\n  const info = datum1D.info;\n  const baseFrequency = parseFloat(info.baseFrequency);\n  const frequencyOffset = parseFloat(info.frequencyOffset);\n  const spectralWidth = parseFloat(info.spectralWidth);\n  const offset = frequencyOffset / baseFrequency;\n  let spectralHalfWidth = 0.5 * spectralWidth;\n  let nbPoints = datum1D.data.x.length;\n  let firstPoint = offset - spectralHalfWidth;\n  let dx = spectralWidth / (nbPoints - 1);\n  const xAxis = new Array(nbPoints);\n  for (let i = 0; i < nbPoints; i++) {\n    xAxis[i] = firstPoint;\n    firstPoint += dx;\n  }\n  return xAxis;\n}\n","import { xGetFromToIndex } from 'ml-spectra-processing';\n\nexport const id = 'fromTo';\nexport const name = 'From/To';\n\n/**\n *\n * @param {Datum1d} datum1d\n */\n\nexport function apply(datum1D, options: any = {}) {\n  if (!isApplicable(datum1D)) {\n    throw new Error('From/To filter not applicable on this data');\n  }\n  const { x, re, im } = datum1D.data;\n  const { from, to } = options;\n  const { fromIndex, toIndex } = xGetFromToIndex(x, { from, to });\n\n  datum1D.data.x = x.slice(fromIndex, toIndex);\n  datum1D.data.re = re.slice(fromIndex, toIndex);\n  if (im) {\n    datum1D.data.im = im.slice(fromIndex, toIndex);\n  }\n}\n\nexport function isApplicable(datum1D) {\n  if (datum1D.info.isComplex && !datum1D.info.isFid) return true;\n  return false;\n}\n\nexport function reduce(previousValue, newValue) {\n  return {\n    once: true,\n    reduce: newValue,\n  };\n}\n","export const id = 'lineBroadening';\nexport const name = 'Line broadening';\n\n/**\n *\n * @param {Datum1d} datum1d\n * @param {Object} [value]\n */\n\nexport function apply(datum1D, value) {\n  if (!isApplicable(datum1D)) {\n    throw new Error('lineBroadening not applicable on this data');\n  }\n\n  let grpdly = datum1D.info.digitalFilter;\n  let pointsToShift;\n  if (grpdly > 0) {\n    pointsToShift = Math.floor(grpdly);\n  } else {\n    pointsToShift = 0;\n  }\n\n  const re = datum1D.data.re;\n  const im = datum1D.data.im;\n  const t = datum1D.data.x;\n\n  const length = re.length;\n\n  const newRE = new Float64Array(length); // I don't think we need a new array... here\n  const newIM = new Float64Array(length);\n  //if (value !== 0) {// is it OK to skip this line if \"value\" is zero?\n  //please check this test of zero is correct !== or != ...\n  const dw = (t[length - 1] - t[0]) / (length - 1); //REPLACE CONSTANT with calculated value... : for this we need AQ or DW to set it right...\n  // convert line broadening in Hz into exponential coefficient:\n  const em = -value * Math.exp(1);\n\n  const coefExp = Math.exp(em * dw);\n  let curFactor = Math.exp(em * t[0]); // in case does not start at zero\n  for (let i = 0; i < length - pointsToShift; i++) {\n    newRE[i] = re[i] * curFactor;\n    newIM[i] = im[i] * curFactor;\n    curFactor = curFactor * coefExp;\n  }\n  curFactor = Math.exp(em * t[0]);\n  for (let i = length; i > length - pointsToShift; i--) {\n    newRE[i] = re[i] * curFactor;\n    newIM[i] = im[i] * curFactor;\n    curFactor = curFactor * coefExp;\n  }\n  datum1D.data = { ...datum1D.data, ...{ re: newRE, im: newIM } };\n  //}\n}\nexport function isApplicable(datum1D) {\n  if (datum1D.info.isComplex && datum1D.info.isFid) return true;\n  return false;\n}\n\nexport function reduce(previousValue, newValue) {\n  return {\n    once: true,\n    reduce: previousValue + newValue,\n  };\n}\n","import { xParetoNormalization } from 'ml-spectra-processing';\n\nexport const id = 'pareto';\nexport const name = 'Pareto';\n\n/**\n * Computes the arithmetic mean of the given values\n * @param {Datum1d} datum1d\n */\n\nexport function apply(datum1D) {\n  if (!isApplicable(datum1D)) {\n    throw new Error('Pareto is not applicable on this data');\n  }\n\n  const re = datum1D.data.re.slice(0);\n  const im = datum1D.data.im?.slice(0);\n\n  datum1D.data.re = xParetoNormalization(re);\n  if (im) {\n    datum1D.data.im = xParetoNormalization(im);\n  }\n}\n\nexport function isApplicable(datum1D) {\n  if (datum1D.info.isComplex && !datum1D.info.isFid) return true;\n  return false;\n}\n\nexport function reduce() {\n  return {\n    once: false,\n    reduce: null,\n  };\n}\n","import { reimPhaseCorrection } from 'ml-spectra-processing';\n\nexport const id = 'phaseCorrection';\nexport const name = 'Phase correction';\n\n/**\n *\n * @param {Datum1d} datum1d\n * @param {Object} [options={}]\n * @param {number} [options.ph0=0]\n * @param {number} [options.ph1=0]\n */\n\nexport function apply(datum1D, options: any = {}) {\n  if (!isApplicable(datum1D)) {\n    throw new Error('phaseCorrection not applicable on this data');\n  }\n  let { ph0, ph1 } = options;\n  ph0 *= Math.PI / 180.0;\n  ph1 *= Math.PI / 180.0;\n  Object.assign(datum1D.data, reimPhaseCorrection(datum1D.data, ph0, ph1));\n}\n\nexport function isApplicable(datum1D) {\n  if (datum1D.info.isComplex && !datum1D.info.isFid) return true;\n  return false;\n}\n\nexport function reduce(previousValue, newValue) {\n  return {\n    once: true,\n    reduce: newValue,\n  };\n}\n","/**\n *\n * @param {Object} datum1d\n * @param {number} [shiftValue=0]\n */\n\nexport const id = 'shiftX';\nexport const name = 'Shift X';\n\nexport function apply(datum1D, shiftValue = 0) {\n  datum1D.data.x = datum1D.data.x.map((val) => val + shiftValue);\n}\n\nexport function isApplicable() {\n  return true;\n}\n\nexport function reduce(previousValue, newValue) {\n  return {\n    once: true,\n    reduce: previousValue + newValue,\n  };\n}\n","import { standardDeviation } from 'ml-stat/array';\n\nexport const id = 'standardDeviation';\nexport const name = 'Standard Deviation';\n\n/**\n * Computes the standard deviation of the given values\n * @param {Datum1d} datum1d\n */\n\nexport function apply(datum1D) {\n  if (!isApplicable(datum1D)) {\n    throw new Error('Standard Deviation is not applicable on this data');\n  }\n\n  const re = datum1D.data.re.slice(0);\n  const im = datum1D.data.im?.slice(0);\n\n  const reStd = standardDeviation(re);\n  const imStd = standardDeviation(im || []);\n\n  for (let i = 0; i < re.length; i++) {\n    re[i] /= reStd;\n    if (im) {\n      im[i] /= imStd;\n    }\n  }\n\n  datum1D.data.re = re;\n\n  if (im) {\n    datum1D.data.im = im;\n  }\n}\n\nexport function isApplicable(datum1D) {\n  if (datum1D.info.isComplex && !datum1D.info.isFid) return true;\n  return false;\n}\n\nexport function reduce() {\n  return {\n    once: false,\n    reduce: null,\n  };\n}\n","export const id = 'zeroFilling';\nexport const name = 'Zero Filling';\n/**\n *\n * @param {Datum1d} datum1d\n * @param {Object} [size]\n */\nexport function apply(datum1D, size) {\n  if (!isApplicable(datum1D)) {\n    throw new Error('zeroFilling not applicable on this data');\n  }\n\n  let digitalFilterApplied = datum1D.filters.some(\n    (e) => e.name === 'digitalFilter' && e.flag,\n  );\n\n  let grpdly = datum1D.info.digitalFilter;\n  let pointsToShift;\n  if (grpdly > 0 && digitalFilterApplied) {\n    pointsToShift = Math.floor(grpdly);\n  } else {\n    pointsToShift = 0;\n  }\n\n  const { re, im, x } = datum1D.data;\n\n  let newRE = new Float64Array(size);\n  let newIM = new Float64Array(size);\n  let newX = new Float64Array(size);\n\n  const length = Math.min(size, re.length);\n\n  newRE.set(re.slice(0, length - pointsToShift));\n  newIM.set(im.slice(0, length - pointsToShift));\n  newX.set(x.slice(0, length - pointsToShift));\n\n  let diff = x[1] - x[0];\n  let currentX = x[length - pointsToShift - 1];\n  for (let i = length - pointsToShift; i < size; i++) {\n    currentX += diff;\n    newX[i] = currentX;\n  }\n\n  if (pointsToShift > 0 && pointsToShift < size) {\n    newRE.set(re.slice(re.length - pointsToShift), size - pointsToShift);\n    newIM.set(im.slice(re.length - pointsToShift), size - pointsToShift);\n  }\n\n  datum1D.data = { ...datum1D.data, ...{ re: newRE, im: newIM, x: newX } };\n}\n\nexport function isApplicable(datum1D) {\n  if (datum1D.info.isComplex && datum1D.info.isFid) return true;\n  return false;\n}\n\nexport function reduce(_previousValue, newValue) {\n  return {\n    once: true,\n    reduce: newValue,\n  };\n}\n","/**\n *\n * @param {Object} datum2d\n * @param {number} [shiftValue=0]\n */\n\nexport const id = 'shift2DX';\nexport const name = 'Shift 2D X';\n\nexport function apply(datum2D, shiftValue = 0) {\n  datum2D.data.minX += shiftValue;\n  datum2D.data.maxX += shiftValue;\n}\n\nexport function isApplicable() {\n  return true;\n}\n\nexport function reduce(previousValue, newValue) {\n  return {\n    once: true,\n    reduce: previousValue + newValue,\n  };\n}\n","/**\n *\n * @param {Object} datum2d\n * @param {number} [shiftValue=0]\n */\n\nexport const id = 'shift2DY';\nexport const name = 'Shift 2D Y';\n\nexport function apply(datum2D, shiftValue = 0) {\n  datum2D.data.minY += shiftValue;\n  datum2D.data.maxY += shiftValue;\n}\n\nexport function isApplicable() {\n  return true;\n}\n\nexport function reduce(previousValue, newValue) {\n  return {\n    once: true,\n    reduce: previousValue + newValue,\n  };\n}\n","const BASE62 = '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ';\n\nconst LENGTH = 8;\n\nexport default function generateID(): string {\n  let id = '';\n  for (let i = 0; i < LENGTH; i++) {\n    id += BASE62.charAt(Math.floor(Math.random() * 62));\n  }\n  return id;\n}\n","/* eslint-disable import/namespace */\nimport * as Filters from './Filters';\nimport generateID from './utilities/generateID';\n\nexport interface Filter {\n  id: string;\n  name: string;\n  label: string;\n  isDeleteAllow: boolean;\n  flag: boolean;\n  value: any;\n}\n\n/***\n * @param {object} Filters [{name:'',options:{}},{...}]\n */\nfunction applyFilter(datum, filters: any[] = []) {\n  let isReduced = false;\n  for (let filter of filters) {\n    const filterOption = {\n      name: filter.name,\n      label: Filters[filter.name].name,\n      value: filter.options,\n    };\n    const previousFilter = lookupForFilter(datum, filter.name);\n    if (previousFilter) {\n      const reduceResult = Filters[filter.name].reduce(\n        previousFilter.value,\n        filterOption.value,\n      );\n      if (reduceResult.once) {\n        if (!isReduced) {\n          isReduced = true;\n        }\n        if (reduceResult.reduce != null && reduceResult.reduce !== undefined) {\n          replaceFilter(datum, previousFilter.id, reduceResult.reduce);\n        }\n      } else {\n        addFilter(\n          datum,\n          filterOption,\n          Object.prototype.hasOwnProperty.call(filter, 'isDeleteAllow')\n            ? filter.isDeleteAllow\n            : true,\n        );\n      }\n    } else {\n      addFilter(\n        datum,\n        filterOption,\n        Object.prototype.hasOwnProperty.call(filter, 'isDeleteAllow')\n          ? filter.isDeleteAllow\n          : true,\n      );\n    }\n  }\n  if (isReduced) {\n    if (filters.length === 1 && isLastFilter(datum, filters[0].name)) {\n      Filters[filters[0].name].apply(datum, filters[0].options);\n    } else {\n      reapplyFilters(datum);\n    }\n  } else {\n    for (let filter of filters) {\n      Filters[filter.name].apply(datum, filter.options);\n    }\n  }\n}\n\nfunction isLastFilter(datum, id) {\n  const index = datum.filters.findIndex((f) => f.name === id);\n  if (datum.filters.length === index + 1) {\n    return true;\n  }\n  return false;\n}\n\nfunction lookupForFilter(datum, filterName) {\n  return datum.filters.find((f) => f.name === filterName);\n}\n\nfunction reapplyFilters(datum, filters: any = null) {\n  const _filters = filters ? filters : datum.filters;\n  enableFilter(datum, null, null, _filters);\n}\n\n// id filter id\nfunction enableFilter(datum, id, checked, filters = null) {\n  datum.filters = datum.filters.slice(0);\n  if (id) {\n    datum.filters = datum.filters.map((filter) => {\n      return { ...filter, flag: filter.id === id ? checked : filter.flag };\n    }, []);\n  }\n  datum.data = { ...datum.data, ...datum.originalData };\n  datum.info = { ...datum.info, ...datum.originalInfo };\n  const _filters = filters ? filters : datum.filters;\n  for (let filterIndex in _filters) {\n    const filter = datum.filters[filterIndex];\n    datum.filters[filterIndex] = {\n      ...datum.filters[filterIndex],\n      error: null,\n    };\n\n    if (filter.flag) {\n      try {\n        Filters[filter.name].apply(datum, filter.value);\n      } catch (error: any) {\n        datum.filters[filterIndex] = {\n          ...datum.filters[filterIndex],\n          error: error.message,\n        };\n      }\n    }\n  }\n}\nfunction deleteFilter(datum, id) {\n  datum.filters = datum.filters.slice(0);\n  datum.filters = datum.filters.filter((filter) => filter.id !== id);\n  datum.data = { ...datum.data, ...datum.originalData };\n  datum.info = { ...datum.info, ...datum.originalInfo };\n\n  for (let filterIndex in datum.filters) {\n    const filter = datum.filters[filterIndex];\n    datum.filters[filterIndex] = {\n      ...datum.filters[filterIndex],\n      error: null,\n    };\n\n    if (filter.flag) {\n      try {\n        Filters[filter.name].apply(datum, filter.value);\n      } catch (error: any) {\n        datum.filters[filterIndex] = {\n          ...datum.filters[filterIndex],\n          error: error.message,\n        };\n      }\n    }\n  }\n}\n\nfunction addFilter(datum, filter, isDeleteAllow = true) {\n  const id = generateID();\n  datum.filters = datum.filters.slice(0);\n  delete filter.isSnapshot;\n  datum.filters.push({\n    ...filter,\n    id: id,\n    flag: true,\n    isDeleteAllow,\n  });\n}\n\nfunction replaceFilter(datum, filterID, value) {\n  datum.filters = datum.filters.slice(0);\n  const index = datum.filters.findIndex((f) => f.id === filterID);\n  delete datum.filters[index].isSnapshot;\n  datum.filters[index] = {\n    ...datum.filters[index],\n    value,\n  };\n}\n\nexport { applyFilter, reapplyFilters, enableFilter, addFilter, deleteFilter };\n","export const COLORS: string[] = [\n  '#C10020',\n  '#007D34',\n  '#803E75',\n  '#FF6800',\n  '#B32851',\n  '#7F180D',\n  '#232C16',\n  '#A6BDD7',\n  '#CEA262',\n  '#817066',\n  '#FF8E00',\n  '#F6768E',\n  '#00538A',\n  '#FF7A5C',\n  '#53377A',\n  '#FFB300',\n  '#F4C800',\n  '#93AA00',\n  '#593315',\n  '#F13A13',\n];\n\ninterface TwoDColors {\n  positiveColor: string;\n  negativeColor: string;\n}\n\nconst color2D: Record<string, TwoDColors> = {\n  cosy: { positiveColor: 'darkblue', negativeColor: 'blue' },\n  roesy: { positiveColor: '#e75480', negativeColor: 'yellow' },\n  noesy: { positiveColor: '#e75480', negativeColor: 'yellow' },\n  tocsy: { positiveColor: 'green', negativeColor: 'yellow' },\n  hsqc: { positiveColor: 'black', negativeColor: 'yellow' },\n  hmbc: { positiveColor: 'darkviolet', negativeColor: 'yellow' },\n};\n\nexport function get2DColor(experiment: string, colors = []): TwoDColors {\n  if (!color2D[experiment]) {\n    const positiveColor = getColor(false, colors);\n    const negativeColor = adjustAlpha(positiveColor, 50);\n    return { positiveColor, negativeColor };\n  }\n  return color2D[experiment];\n}\n\nfunction percentToHex(p: number): string {\n  const percent = Math.max(0, Math.min(100, p));\n  const intValue = Math.round((percent / 100) * 255);\n  const hexValue = intValue.toString(16);\n  return percent === 100 ? '' : hexValue.padStart(2, '0');\n}\n\nexport function adjustAlpha(color: string, factor: number): string {\n  return color + percentToHex(factor);\n}\n\nexport default function getColor(\n  isRandom = false,\n  usedColors: string[] = [],\n  opacity = 100,\n) {\n  const resetColors = COLORS.filter((c) => !usedColors.includes(c));\n  if (resetColors.length > 0 && !isRandom) {\n    return resetColors[0] + percentToHex(opacity);\n  } else {\n    const lum = -0.25;\n    let hex = String(\n      `#${Math.random().toString(16).slice(2, 8).toUpperCase()}`,\n    ).replace(/[^0-9a-f]/gi, '');\n    if (hex.length < 6) {\n      hex = hex[0] + hex[0] + hex[1] + hex[1] + hex[2] + hex[2];\n    }\n    let rgb = '#';\n    let c: number | string;\n    for (let i = 0; i < 3; i++) {\n      c = parseInt(hex.substr(i * 2, 2), 16);\n      c = Math.round(Math.min(Math.max(0, c + c * lum), 255)).toString(16);\n      rgb += `00${c}`.substr(c.length);\n    }\n\n    return rgb + percentToHex(opacity);\n  }\n}\n","import merge from 'lodash/merge';\n\nimport { Integrals } from '../../../types/data1d';\n\nexport function initiateIntegrals(options: Partial<{ integrals: Integrals }>) {\n  return merge(\n    {\n      values: [],\n      options: {\n        sum: undefined,\n        isSumConstant: true,\n        sumAuto: true,\n      },\n    },\n    options.integrals,\n  );\n}\n","import { Datum1D } from '../../types/data1d/Datum1D';\n\nexport function getSpectrumErrorValue(datum: Datum1D) {\n  const { x } = datum.data;\n  return (x[x.length - 1] - x[0]) / 10000;\n}\n","import * as FiltersTypes from '../../../Filters';\nimport { Datum1D } from '../../../types/data1d/Datum1D';\n\nexport function getShiftX(datum: Datum1D): number {\n  const filter =\n    datum?.filters &&\n    datum?.filters.find((filter) => filter.name === FiltersTypes.shiftX.id);\n\n  return filter?.flag ? filter.value : 0;\n}\n","import { Peak, Datum1D } from '../../../types/data1d';\nimport generateID from '../../../utilities/generateID';\nimport { getSpectrumErrorValue } from '../getSpectrumErrorValue';\nimport { getShiftX } from '../shift/getShiftX';\n\nfunction checkPeak(peak: Peak, datum: Datum1D, error) {\n  // check if the Peak is already exists\n  for (const { x } of datum.peaks?.values || []) {\n    if (Math.abs(peak.x - x) < error) {\n      return true;\n    }\n  }\n  return false;\n}\n\nexport function mapPeaks(peaks: Peak[], datum: Datum1D) {\n  const shiftX = getShiftX(datum);\n\n  const error = getSpectrumErrorValue(datum);\n\n  return peaks.reduce<Peak[]>((acc, newPeak) => {\n    // check if the peak is already exists\n    if (checkPeak(newPeak, datum, error)) return acc;\n\n    acc.push({\n      id: newPeak?.id || generateID(),\n      originalX: newPeak.x - shiftX,\n      x: newPeak.x,\n      y: newPeak.y,\n      width: newPeak.width,\n    });\n\n    return acc;\n  }, []);\n}\n","import merge from 'lodash/merge';\n\nimport { Datum1D, Peaks } from '../../../types/data1d';\n\nimport { mapPeaks } from './mapPeaks';\n\nexport function initiatePeaks(\n  options: Partial<{ peaks: Peaks }>,\n  datum: Datum1D,\n) {\n  return merge({ values: [], options: {} }, options.peaks, {\n    values: mapPeaks(options?.peaks?.values || [], datum),\n  });\n}\n","import { xyIntegration } from 'ml-spectra-processing';\n\nimport { DatumKind } from '../../../constants/SignalsKinds';\nimport { Datum1D, Range } from '../../../types/data1d';\nimport generateID from '../../../utilities/generateID';\nimport { getSpectrumErrorValue } from '../getSpectrumErrorValue';\nimport { getShiftX } from '../shift/getShiftX';\n\nfunction checkRange(range: Range, datum: Datum1D, error) {\n  // check if the range is already exists\n  for (const { from, to } of datum.ranges?.values || []) {\n    if (\n      Math.abs(range.from - from) < error &&\n      Math.abs(range.to - to) < error\n    ) {\n      return true;\n    }\n  }\n}\n\nexport function mapRanges(ranges: Range[], datum: Datum1D) {\n  const { x, re } = datum.data;\n  const shiftX = getShiftX(datum);\n  const error = getSpectrumErrorValue(datum);\n  return ranges.reduce<Array<Range>>((acc, newRange) => {\n    if (checkRange(newRange, datum, error)) return acc;\n\n    const absolute = xyIntegration(\n      { x, y: re },\n      { from: newRange.from, to: newRange.to, reverse: true },\n    );\n    const signals = newRange.signals.map((signal) => {\n      const { kind = null, id, ...resSignal } = signal;\n      return {\n        kind: kind || 'signal',\n        id: id || generateID(),\n        originDelta: signal.delta - shiftX,\n        ...resSignal,\n      };\n    });\n\n    acc.push({\n      ...newRange,\n      kind: signals?.[0].kind || DatumKind.signal,\n      originFrom: newRange.from - shiftX,\n      originTo: newRange.to - shiftX,\n      id: newRange.id || generateID(),\n      absolute,\n      signals,\n    });\n\n    return acc;\n  }, []);\n}\n","import merge from 'lodash/merge';\n\nimport { Datum1D, Ranges } from '../../../types/data1d';\n\nimport { mapRanges } from './mapRanges';\n\nexport function initiateRanges(\n  options: Partial<{ ranges: Ranges }>,\n  datum: Datum1D,\n) {\n  return merge(\n    {\n      values: [],\n      options: {\n        sum: undefined,\n        isSumConstant: true,\n        sumAuto: true,\n      },\n    },\n    options.ranges,\n    {\n      values: mapRanges(options?.ranges?.values || [], datum),\n    },\n  );\n}\n","import * as FiltersTypes from '../../Filters';\nimport * as FiltersManager from '../../FiltersManager';\nimport { Datum1D } from '../../types/data1d/Datum1D';\nimport generateID from '../../utilities/generateID';\nimport get1dColor from '../../utilities/getColor';\n\nimport { initiateIntegrals } from './integrals/initiateIntegrals';\nimport { initiatePeaks } from './peaks/initiatePeaks';\nimport { initiateRanges } from './ranges/initiateRanges';\n\nexport function initiateDatum1D(options: any, usedColors = {}): Datum1D {\n  const datum: Partial<Datum1D> = {};\n  datum.id = options.id || generateID();\n  datum.source = Object.assign(\n    {\n      jcampURL: null,\n      file: {\n        binary: null,\n        name: '',\n        extension: '',\n      },\n    },\n    options.source,\n  );\n\n  datum.display = Object.assign(\n    {\n      name: options.display?.name ? options.display.name : generateID(),\n      ...getColor(options, usedColors),\n      isVisible: true,\n      isPeaksMarkersVisible: true,\n      isRealSpectrumVisible: true,\n    },\n    options.display,\n  );\n\n  datum.info = Object.assign(\n    {\n      nucleus: '1H', // 1H, 13C, 19F, ...\n      isFid: false,\n      isComplex: false, // if isComplex is true that mean it contains real/ imaginary  x set, if not hid re/im button .\n      dimension: 1,\n    },\n    options.info,\n  );\n\n  datum.originalInfo = datum.info;\n\n  datum.meta = Object.assign({}, options.meta);\n  datum.data = Object.assign(\n    {\n      x: [],\n      re: [],\n      im: [],\n    },\n    options.data,\n  );\n  datum.originalData = datum.data;\n\n  datum.filters = Object.assign([], options.filters); //array of object {name: \"FilterName\", options: FilterOptions = {value | object} }\n\n  datum.peaks = initiatePeaks(options, datum as Datum1D);\n\n  // array of object {index: xIndex, xShift}\n  // in case the peak does not exactly correspond to the point value\n  // we can think about a second attributed `xShift`\n  datum.integrals = initiateIntegrals(options); // array of object (from: xIndex, to: xIndex)\n  datum.ranges = initiateRanges(options, datum as Datum1D);\n\n  //reapply filters after load the original data\n  FiltersManager.reapplyFilters(datum);\n\n  preprocessing(datum);\n  return datum as Datum1D;\n}\n\nfunction getColor(options, usedColors) {\n  let color = 'black';\n  if (options?.display?.color === undefined) {\n    color = get1dColor(false, usedColors['1d'] || []);\n  } else {\n    color = options.display.color;\n  }\n\n  if (usedColors['1d']) {\n    usedColors['1d'].push(color);\n  }\n\n  return { color };\n}\n\nfunction preprocessing(datum) {\n  if (\n    datum.info.isFid &&\n    datum.filters.findIndex((f) => f.name === FiltersTypes.digitalFilter.id) ===\n      -1 &&\n    datum.info.digitalFilter\n  ) {\n    FiltersManager.applyFilter(datum, [\n      {\n        name: FiltersTypes.digitalFilter.id,\n        options: {\n          digitalFilterValue: datum.info.digitalFilter,\n        },\n        isDeleteAllow: false,\n      },\n    ]);\n  }\n}\n","import { rangesToXY } from 'nmr-processing';\n\nimport { UsedColors } from '../../../../types/UsedColors';\nimport { Datum1D, Range } from '../../../types/data1d';\nimport { initiateDatum1D } from '../initiateDatum1D';\n\nimport { mapRanges } from './mapRanges';\n\nexport function generateSpectrumFromRanges(\n  ranges: Range[],\n  info: {\n    nucleus: string;\n    solvent: string;\n    name?: string;\n    frequency?: number;\n    color?: string;\n  },\n  usedColors: UsedColors,\n): Datum1D {\n  const { nucleus, solvent, name = null, frequency = 400 } = info;\n  const { x, y } = rangesToXY(ranges, {\n    frequency,\n    nbPoints: 524288,\n  });\n\n  const datum = initiateDatum1D(\n    {\n      data: { x, im: null, re: y },\n      display: { name },\n      info: {\n        nucleus,\n        originFrequency: frequency,\n        baseFrequency: frequency,\n        pulseSequence: '',\n        solvent,\n        isFt: true,\n      },\n    },\n    usedColors,\n  );\n  datum.ranges.values = mapRanges(ranges, datum);\n\n  return datum;\n}\n","import { resurrect } from 'nmr-processing';\n\nimport { UsedColors } from '../../../types/UsedColors';\nimport { Datum1D } from '../../types/data1d';\n\nimport { generateSpectrumFromRanges } from './ranges/generateSpectrumFromRanges';\n\nexport function generateSpectrumFromPublicationString(\n  publicationString: string,\n  usedColors: UsedColors,\n): Datum1D {\n  const {\n    ranges,\n    experiment: { nucleus, solvent },\n    parts,\n  } = resurrect(publicationString);\n  return generateSpectrumFromRanges(\n    ranges,\n    { nucleus, solvent, name: parts[0] },\n    usedColors,\n  );\n}\n","import { Datum1D } from '../../types/data1d';\n\n/**\n * @typedef {Object} datum\n * @property {number[]} x - The X points series\n * @property {number[]} y - The Y points series\n */\n\n/**\n *\n * @param spectrum 1d spectrum\n * @returns {datum} datum object includes x and y series\n */\n\nexport function get1DDataXY(spectrum: Datum1D): {\n  x: number[];\n  y: number[];\n} {\n  const {\n    display: { isRealSpectrumVisible },\n    data: { x, re, im },\n  } = spectrum;\n\n  return { x, y: isRealSpectrumVisible ? re : im };\n}\n","interface ReferenceInfo {\n  from: number;\n  to: number;\n  nbPeaks: number;\n  delta: number;\n}\n\nexport const REFERENCES: Record<string, Record<string, ReferenceInfo>> = {\n  '1H': {\n    tms: {\n      from: -0.1,\n      to: 0.1,\n      nbPeaks: 1,\n      delta: 0,\n    },\n    tsp: {\n      from: -0.1,\n      to: 0.1,\n      nbPeaks: 1,\n      delta: 0,\n    },\n    glucose: {\n      from: 5.18,\n      to: 5.28,\n      nbPeaks: 2,\n      delta: 5.23,\n    },\n  },\n  '13C': {},\n};\n\nexport function getRange(\n  options: { nucleus?: string; reference?: string } = {},\n): ReferenceInfo {\n  const { nucleus = '1H', reference = 'tms' } = options;\n\n  if (!REFERENCES[nucleus]) {\n    throw new Error(`Nucleus not found: ${nucleus}`);\n  }\n\n  const info = REFERENCES[nucleus][reference.toLowerCase()];\n\n  if (!info) {\n    throw new Error(`Reference not found: ${reference}`);\n  }\n\n  return {\n    from: info.delta - 0.05,\n    to: info.delta + 0.05,\n    delta: info.delta,\n    nbPeaks: info.nbPeaks,\n  };\n}\n","import type { DataXY } from 'cheminfo-types';\nimport mean from 'ml-array-mean';\nimport { gsd } from 'ml-gsd';\nimport { xFindClosestIndex } from 'ml-spectra-processing';\n\nimport { getRange } from '../../constants/References';\n\n/**\n *\n * @param {*} datum1D\n * @param {object} [options={}]\n * @param {number} [options.from]\n * @param {number} [options.to] Define the from zone where the reference is expected to be found\n * @param {number} [options.from]\n * @param {number} [options.nbPeaks]\n * @param {number} [options.targetX]\n * @param {string} [options.reference]\n */\nexport function getReferenceShift(datum1D, options) {\n  let { from, to, nbPeaks, targetX, reference } = options;\n  if (reference) {\n    let data = getRange({ reference: reference, nucleus: datum1D.nucleus });\n    from = data.from;\n    to = data.to;\n    nbPeaks = data.nbPeaks;\n    targetX = data.delta;\n  }\n\n  const { re, x } = datum1D.data;\n  return xyCalibrate({ x, y: re }, { from, to }, { nbPeaks, targetX });\n}\n\n// This is a copy of the function defined in https://github.com/cheminfo/spectra-processor/blob/b87f6f6c4d45a64dc16f3f9692d5f5dc7e398e5e/src/spectrum/xyCalibrate.js\nfunction xyCalibrate(\n  data: DataXY,\n  range: { to?: number; from?: number } = {},\n  options: {\n    targetX?: number;\n    nbPeaks?: number;\n    gsd?: {\n      minMaxRatio: number;\n      realTopDetection: boolean;\n      smoothY: boolean;\n      sgOptions: {\n        windowSize: number;\n        polynomial: number;\n      };\n    };\n  } = {},\n): number {\n  const {\n    targetX = 0,\n    nbPeaks = 1,\n    gsd: gsdOptions = {\n      minMaxRatio: 0.1,\n      realTopDetection: true,\n      smoothY: true,\n      sgOptions: {\n        windowSize: 7,\n        polynomial: 3,\n      },\n    },\n  } = options;\n  let { from, to } = range;\n  if (from === undefined || to === undefined) return 0;\n\n  const fromIndex = xFindClosestIndex(data.x, from);\n  const toIndex = xFindClosestIndex(data.x, to);\n  const sliceddata = {\n    x: data.x.slice(fromIndex, toIndex) as number[],\n    y: data.y.slice(fromIndex, toIndex) as number[],\n  };\n\n  let peaks = gsd(sliceddata, gsdOptions)\n    .sort((a, b) => b.y - a.y)\n    .slice(0, nbPeaks);\n\n  if (peaks.length === 0) return 0;\n\n  const middle = mean(peaks.map((peak) => peak.x));\n\n  return targetX - middle;\n}\n","import { Datum1D, Integral } from '../../../types/data1d';\n\nexport function changeIntegralsRelative(\n  datum: Datum1D,\n  newIntegral: { id: string; value: number },\n) {\n  const index = datum.integrals.values.findIndex(\n    (integral) => integral.id === newIntegral.id,\n  );\n  if (index !== -1) {\n    const ratio = datum.integrals.values[index].absolute / newIntegral.value;\n    const { values, sum } = datum.integrals.values.reduce<{\n      sum: number;\n      values: Integral[];\n    }>(\n      (acc, integral, index) => {\n        const newIntegralValue = integral.absolute / ratio;\n        acc.sum += newIntegralValue;\n        acc.values[index] = {\n          ...integral,\n          integral: newIntegralValue,\n        };\n\n        return acc;\n      },\n      { values: [], sum: 0 },\n    );\n\n    datum.integrals.values = values;\n    datum.integrals.options = {\n      ...datum.integrals.options,\n      mf: undefined,\n      moleculeKey: undefined,\n      sumAuto: false,\n      sum,\n    };\n  }\n}\n","import { SignalKindsToInclude } from '../../../constants/SignalsKinds';\nimport { Integral } from '../../../types/data1d';\n\n/**\n * check whether integral based on its kind can be included in another operation or not\n * @param integral  integral\n * @returns {boolean}\n */\nexport function checkIntegralKind(integral: Integral): boolean {\n  return SignalKindsToInclude.includes(integral.kind);\n}\n","/**\n * Sum values for specific key in the object\n * @param values array of object\n * @param key key\n * @param check custom check function to to indicate if certain object included or not in the summation\n * @returns number\n */\n\nexport function getSum<Type>(\n  values: Type[],\n  key: keyof Extract<Type, string>,\n  check: ((value: Type) => boolean) | null = null,\n) {\n  return values.reduce((sum, current) => {\n    return check && check(current) === true\n      ? (sum += Math.abs(current[key as string]))\n      : sum;\n  }, 0);\n}\n","import { Integral, Range, Integrals, Ranges } from '../../../types/data1d';\nimport { getSum } from '../../../utilities/getSum';\n\nexport function updateRelatives<Type extends Integral | Range>(\n  data: Type extends Integral ? Integrals : Ranges,\n  key: keyof Type,\n  check: (value: Type) => boolean,\n  forceCalculateIntegral = false,\n): void {\n  const { values, options } = data;\n\n  const currentSum = getSum<Type>(values as Type[], 'absolute', check);\n\n  let factor = 0;\n  if (options.sum) {\n    if (data.options.isSumConstant || forceCalculateIntegral) {\n      factor = currentSum > 0 ? options.sum / currentSum : 0.0;\n    } else {\n      if (data.values?.[0]) {\n        const item = data.values[0];\n        factor =\n          (item[key as string] ? item[key as string] : options.sum) /\n          item.absolute;\n      }\n    }\n  }\n  data.values = data.values.map((value) => {\n    return {\n      ...value,\n      ...(check(value) && {\n        [key as string]: value.absolute * factor,\n      }),\n    };\n  });\n\n  if (!data.options.isSumConstant && !forceCalculateIntegral) {\n    data.options.sum = getSum<Type>(data.values as Type[], key, check);\n  }\n}\n","import { Datum1D, Integral } from '../../../types/data1d';\n\nimport { checkIntegralKind } from './checkIntegralKind';\nimport { updateRelatives } from './updateRelatives';\n\nexport function updateIntegralsRelativeValues(\n  datum: Datum1D,\n  forceCalculateIntegral = false,\n) {\n  updateRelatives<Integral>(\n    datum.integrals,\n    'integral',\n    checkIntegralKind,\n    forceCalculateIntegral,\n  );\n}\n","import { Datum1D } from '../../types/data1d';\nimport { Datum2D } from '../../types/data2d';\n\nexport function isSpectrum1D(spectrum: Datum1D | Datum2D): spectrum is Datum1D {\n  return spectrum.info.dimension === 1;\n}\n","import median from 'ml-array-median';\nimport { xyAutoPeaksPicking } from 'nmr-processing';\n\nimport { Datum1D, Peak } from '../../../types/data1d';\n\nimport { mapPeaks } from './mapPeaks';\n\nexport function autoPeakPicking(datum1D: Datum1D, options) {\n  const {\n    minMaxRatio,\n    maxNumberOfPeaks,\n    noiseFactor,\n    lookNegative,\n    windowFromIndex,\n    windowToIndex,\n  } = options;\n  // we calculate the noise but this could be improved\n  const noise = median(datum1D.data.re.map((y) => Math.abs(y)));\n\n  let { re, x } = datum1D.data;\n\n  if (windowFromIndex !== undefined && windowToIndex !== undefined) {\n    x = x.slice(windowFromIndex, windowToIndex);\n    re = re.slice(windowFromIndex, windowToIndex);\n  }\n\n  let peaks = xyAutoPeaksPicking(\n    { x, y: re },\n    {\n      lookNegative,\n      noiseLevel: noise * noiseFactor,\n      minMaxRatio: minMaxRatio, // Threshold to determine if a given peak should be considered as a noise\n      realTopDetection: true,\n      smoothY: false,\n      sgOptions: { windowSize: 15, polynomial: 3 },\n    },\n  );\n  peaks.sort((a, b) => b.y - a.y);\n  if (maxNumberOfPeaks < peaks.length) peaks = peaks.slice(0, maxNumberOfPeaks);\n\n  return mapPeaks(peaks as Peak[], datum1D);\n}\n","import max from 'ml-array-max';\n\nimport { Data1D } from '../../../types/data1d/Data1D';\n\n// Lookup for apeak while the mouse move\n/**\n *\n * @param {object<{x:Array<number>,re:Array<number>}>} data\n * @param  {object<{from:number,to:number}>} options\n */\n\ninterface LookupPeakOptions {\n  from: number;\n  to: number;\n}\ninterface LookupPeakResult {\n  x: number;\n  y: number;\n  xIndex: number;\n}\n\nexport function lookupPeak(\n  data: Data1D,\n  options: LookupPeakOptions,\n): LookupPeakResult | null {\n  const { from, to } = options;\n  let minIndex = data.x.findIndex((number) => number >= from);\n  let maxIndex = data.x.findIndex((number) => number >= to) - 1;\n\n  if (minIndex > maxIndex) {\n    minIndex = maxIndex;\n    maxIndex = minIndex;\n  }\n  const dataRange = data.re.slice(minIndex, maxIndex);\n  if (dataRange && dataRange.length > 0) {\n    const yValue = max(dataRange);\n    const xIndex = dataRange.findIndex((value) => value === yValue);\n    const xValue = data.x[minIndex + xIndex];\n\n    return { x: xValue, y: yValue, xIndex: minIndex + xIndex };\n  }\n  return null;\n}\n","export default function getAtom(nucleus: string): string {\n  return nucleus?.replace(/[0-9]/g, '') || '';\n}\n","import { Draft } from 'immer';\n\nimport { State } from '../../../component/reducer/Reducer';\nimport { Molecule } from '../../molecules/Molecule';\nimport { Datum1D, Integrals, Ranges } from '../../types/data1d';\nimport { SumOptions } from '../../types/data1d/SumOptions';\nimport getAtom from '../../utilities/getAtom';\n\nimport {\n  isSpectrum1D,\n  updateRangesRelativeValues,\n  updateIntegralsRelativeValues,\n} from '.';\n\nexport interface SumParams {\n  nucleus: string;\n  molecules: Molecule[];\n}\n\nexport type SetSumOptions = Omit<SumOptions, 'isSumConstant'>;\n\nexport function initSumOptions(options: SumOptions, params: SumParams) {\n  let newOptions = { ...options };\n  const { molecules, nucleus } = params;\n\n  if (options.sumAuto && Array.isArray(molecules) && molecules.length > 0) {\n    const { mf, key } = molecules[0];\n    newOptions = { ...newOptions, sumAuto: true, mf, moleculeKey: key };\n  } else {\n    const { mf, moleculeKey, ...resOptions } = newOptions;\n    newOptions = { ...resOptions, sumAuto: false };\n  }\n  if (!newOptions.sum) {\n    newOptions.sum = getSum(newOptions.mf || null, nucleus);\n  }\n\n  return newOptions;\n}\n\nexport function getSum(mf: string | null | undefined, nucleus: string) {\n  const defaultSum = 100;\n\n  if (!mf || !nucleus) return defaultSum;\n\n  const atom = getAtom(nucleus);\n  const atoms = getAtoms(mf);\n\n  return atoms[atom] ? atoms[atom] : defaultSum;\n}\n\nexport function setSumOptions(\n  data: Ranges | Integrals,\n  params: { options: SetSumOptions; nucleus: string },\n) {\n  const { nucleus, options } = params;\n  if (options.sumAuto) {\n    const { mf, moleculeKey } = options;\n    const sum = getSum(mf, nucleus);\n    data.options = { ...data.options, sumAuto: true, moleculeKey, mf, sum };\n  } else {\n    const { mf, moleculeKey, ...resOptions } = data.options;\n    data.options = { ...resOptions, sumAuto: false, sum: options.sum };\n  }\n}\n\nexport function getAtoms(mf: string): Record<string, number> {\n  const result = {};\n  // eslint-disable-next-line prefer-named-capture-group\n  const data = mf.split(/(\\d+)/);\n  for (let i = 0; i < data.length - 1; i = i + 2) {\n    result[data[i]] = Number(data[i + 1]);\n  }\n  return result;\n}\n\n/**\n * change the sum for ranges and integrals in all spectra based on molecule\n * it handle three cases\n * 1 - edit and existing molecule\n * 2- delete molecule / edit molecule and as a result of that it generate more than one molecule\n * 3- add a molecule for the first time\n * @param draft     State draft\n * @param molKey    Molecule key\n * @param molecule  Molecules list\n */\nexport function changeSpectraRelativeSum(\n  draft: Draft<State>,\n  molKey: string,\n  molecule: Molecule,\n) {\n  const keys: (keyof Datum1D)[] = ['ranges', 'integrals'];\n\n  for (const spectrum of draft.data) {\n    if (isSpectrum1D(spectrum)) {\n      for (const key of keys) {\n        const { moleculeKey, mf, sumAuto } = spectrum[key].options;\n\n        if ((molKey === moleculeKey || (!moleculeKey && !mf)) && sumAuto) {\n          const options: Partial<SetSumOptions> = molecule\n            ? {\n                mf: molecule.mf,\n                moleculeKey: molecule.key,\n              }\n            : {\n                mf: undefined,\n                moleculeKey: undefined,\n              };\n\n          setSumOptions(spectrum[key], {\n            nucleus: spectrum.info.nucleus,\n            options: { ...options, sumAuto: true, sum: undefined },\n          });\n          updateRangesRelativeValues(spectrum, true);\n          updateIntegralsRelativeValues(spectrum, true);\n        }\n      }\n    }\n  }\n}\n","import { DatumKind } from '../constants/SignalsKinds';\nimport { Range } from '../types/data1d';\n\nexport function getDiaIDs(range: Range): string[] {\n  return ([] as string[]).concat(\n    range.diaIDs || [],\n    range.signals\n      ? range.signals.map((_signal) => _signal.diaIDs || []).flat()\n      : [],\n  );\n}\n\nexport function getNbAtoms(range: Range, signalIndex?: number): number {\n  if (signalIndex === undefined) {\n    return range.signals\n      ? range.signals.reduce(\n          (sum, signal) => (signal.nbAtoms ? signal.nbAtoms + sum : sum),\n          0,\n        )\n      : 0;\n  }\n\n  return range.signals[signalIndex].nbAtoms || 0;\n}\n\nexport function setNbAtoms(range: Range, signalIndex?: number): void {\n  range.nbAtoms = getNbAtoms(range, signalIndex);\n  if (range.nbAtoms === 0) {\n    delete range.nbAtoms;\n  }\n}\n\nexport function resetDiaIDs(range: Range): void {\n  delete range.diaIDs;\n  delete range.nbAtoms;\n  range.signals.forEach((_signal) => {\n    delete _signal.diaIDs;\n    delete _signal.nbAtoms;\n  });\n  delete range.nbAtoms;\n}\n\n/**\n *\n * @param {object} range\n * @param {String('both' | 'range' | 'signal')} unlinkType\n * @param {object} options\n * @param {number} [options.signalIndex]\n * @returns {object}\n */\nexport function unlink(\n  range: Range,\n  unlinkType = 'both',\n  options: any = {},\n): Range {\n  switch (unlinkType) {\n    case 'both':\n      resetDiaIDs(range);\n      break;\n    case 'range':\n      delete range.diaIDs;\n      delete range.nbAtoms;\n      break;\n    case 'signal':\n      delete range.signals[options.signalIndex].diaIDs;\n      delete range.signals[options.signalIndex].nbAtoms;\n      break;\n    default:\n      break;\n  }\n\n  setNbAtoms(range);\n\n  return range;\n}\n\nexport function addDefaultSignal(range) {\n  range.signals.push({\n    multiplicity: 'm',\n    kind: 'signal',\n    delta: (range.to + range.from) / 2,\n  });\n}\n\nexport function checkRangeKind(range) {\n  return range.kind === DatumKind.signal;\n}\n\nexport function checkSignalKinds(range, kinds) {\n  return !range.signals.some(\n    (_signal) => _signal.kind === undefined || !kinds.includes(_signal.kind),\n  );\n}\n\nexport function unlinkInAssignmentData(\n  assignmentData,\n  ranges: Partial<Range>[],\n) {\n  const ids = ranges.reduce((acc: string[], range) => {\n    if (range.id) {\n      acc.push(range.id);\n    }\n    if (range.signals) {\n      acc = acc.concat(range.signals.map((signal) => signal.id, []));\n    }\n    return acc;\n  }, []);\n  assignmentData.dispatch({\n    type: 'REMOVE_ALL',\n    payload: { id: ids, axis: 'x' },\n  });\n}\n","import { SignalKindsToInclude } from '../../../constants/SignalsKinds';\nimport { Range } from '../../../types/data1d';\nimport { checkSignalKinds } from '../../../utilities/RangeUtilities';\n\nexport function checkRangeKind(range: Range): boolean {\n  return range.signals && checkSignalKinds(range, SignalKindsToInclude);\n}\n","import { Datum1D } from '../../../types/data1d/Datum1D';\nimport { updateRelatives } from '../integrals/updateRelatives';\n\nimport { checkRangeKind } from './checkRangeKind';\n\nexport function updateRangesRelativeValues(\n  datum: Datum1D,\n  forceCalculateIntegral = false,\n) {\n  updateRelatives(\n    datum.ranges,\n    'integration',\n    checkRangeKind,\n    forceCalculateIntegral,\n  );\n}\n","import { xyIntegration } from 'ml-spectra-processing';\n\nimport { DatumKind } from '../../../constants/SignalsKinds';\nimport { Datum1D } from '../../../types/data1d/Datum1D';\nimport generateID from '../../../utilities/generateID';\nimport { initSumOptions, SumParams } from '../SumManager';\n\nimport detectSignal from './detectSignal';\nimport { mapRanges } from './mapRanges';\nimport { updateRangesRelativeValues } from './updateRangesRelativeValues';\n\ninterface AddRangeOptions {\n  from: number;\n  to: number;\n}\n\nexport function addRange(datum: Datum1D, options: AddRangeOptions & SumParams) {\n  const { from, to, molecules, nucleus } = options;\n  const { x, re } = datum.data;\n  const absolute = xyIntegration({ x, y: re }, { from, to, reverse: true });\n\n  // detectSignal use the advance multiplet-analysis that can crash if too many points\n  const signal = detectSignal(\n    x as unknown as Float64Array,\n    re as unknown as Float64Array,\n    from,\n    to,\n    datum.info.originFrequency,\n  );\n  if (!signal) return;\n  try {\n    const range = {\n      id: generateID(),\n      from,\n      to,\n      absolute, // the real value,\n      signals: [{ id: generateID(), ...signal }],\n      kind: DatumKind.signal,\n      integration: 0,\n    };\n\n    datum.ranges.options = initSumOptions(datum.ranges.options, {\n      molecules,\n      nucleus,\n    });\n\n    datum.ranges.values = datum.ranges.values.concat(mapRanges([range], datum));\n    updateRangesRelativeValues(datum);\n  } catch (e) {\n    throw new Error('Could not calculate the multiplicity');\n  }\n}\n","import { xyIntegration } from 'ml-spectra-processing';\n\nimport { Datum1D, Range } from '../../../types/data1d';\n\nimport { updateRangesRelativeValues } from './updateRangesRelativeValues';\n\nexport function changeRange(datum: Datum1D, range: Range) {\n  const { from, to } = range;\n  const { x, re } = datum.data;\n\n  const index = datum.ranges.values.findIndex((i) => i.id === range.id);\n  const absolute = xyIntegration({ x, y: re }, { from, to, reverse: true });\n\n  if (index !== -1) {\n    datum.ranges.values[index] = {\n      ...datum.ranges.values[index],\n      originFrom: from,\n      originTo: to,\n      ...range,\n      absolute,\n    };\n    updateRangesRelativeValues(datum);\n  }\n}\n","import { Datum1D } from '../../../types/data1d';\n\ninterface RangeProps {\n  id: string; // id of the selected range\n  value: number; // New relative value\n}\n\n/**\n * Change Range relative value and re-calculate the relative values for the other ranges\n * @param {Datum1D} datum  spectrum 1d\n * @param {RangeProps} newRange\n */\nexport function changeRangeRelativeValue(datum: Datum1D, newRange: RangeProps) {\n  const index = datum.ranges.values.findIndex(\n    (range) => range.id === newRange.id,\n  );\n  if (index !== -1 && datum.ranges.options.sum) {\n    const { absolute, integration } = datum.ranges.values[index];\n    const ratio = absolute / newRange.value;\n    const sum = (newRange.value / integration) * datum.ranges.options.sum;\n    datum.ranges.options = {\n      ...datum.ranges.options,\n      mf: undefined,\n      moleculeKey: undefined,\n      sumAuto: false,\n      sum,\n    };\n\n    datum.ranges.values = datum.ranges.values.map((range) => {\n      return {\n        ...range,\n        integration: range.absolute / ratio,\n      };\n    });\n  }\n}\n","import { Datum1D } from '../../../types/data1d/Datum1D';\n\ninterface RangeSignalOption {\n  rangeID: string;\n  signalID: string;\n  newSignalValue: number;\n}\n\nexport function changeRangeSignal(datum: Datum1D, options: RangeSignalOption) {\n  const { rangeID, signalID, newSignalValue } = options;\n\n  let shiftValue = 0;\n  const rangeIndex = datum.ranges.values.findIndex(\n    (range) => range.id === rangeID,\n  );\n  if (rangeIndex !== -1) {\n    const signalIndex = datum.ranges.values[rangeIndex].signals.findIndex(\n      (signal) => signal.id === signalID,\n    );\n    shiftValue =\n      newSignalValue -\n      datum.ranges.values[rangeIndex].signals[signalIndex].delta;\n    datum.ranges.values[rangeIndex].signals[signalIndex].delta = newSignalValue;\n  }\n  return shiftValue;\n}\n","import { xyIntegration, xyMaxYPoint, xyMinYPoint } from 'ml-spectra-processing';\n\nimport { RangeDetectionResult, Datum1D } from '../../../types/data1d';\nimport generateID from '../../../utilities/generateID';\nimport { getShiftX } from '../shift/getShiftX';\n\ninterface DetectRangeOptions {\n  from: number;\n  to: number;\n}\n\nexport function detectRange(\n  datum: Datum1D,\n  options: DetectRangeOptions,\n): RangeDetectionResult {\n  const { from, to } = options;\n  const { x, re: y } = datum.data;\n\n  const absolute = xyIntegration({ x, y }, { from, to, reverse: true });\n  const min = xyMinYPoint({ x, y }, { from, to }).y;\n  const max = xyMaxYPoint({ x, y }, { from, to }).y;\n\n  const shiftX = getShiftX(datum);\n\n  return {\n    id: generateID(),\n    originFrom: from - shiftX,\n    originTo: to - shiftX,\n    from,\n    to,\n    absolute, // the real value,\n    min,\n    max,\n  };\n}\n","import { xyAutoRangesPicking } from 'nmr-processing';\n\nimport { Datum1D, Range } from '../../../types/data1d';\n\nconst defaultPeakPickingOptions = {\n  minMaxRatio: 1,\n  realTopDetection: true,\n  maxCriteria: true,\n  smoothY: false,\n  integrationSum: 100,\n  factorStd: 5,\n  clean: true,\n  sgOptions: { windowSize: 7, polynomial: 3 },\n};\n\nexport default function autoRangesDetection(\n  datum1D: Datum1D,\n  options: any = {},\n): Range[] {\n  // we calculate the noise but this could be improved\n\n  let { re, x } = datum1D.data;\n\n  const { originFrequency, nucleus } = datum1D.info;\n\n  const { windowFromIndex, windowToIndex, peakPicking } = options;\n\n  const peakPickingOptions = {\n    ...defaultPeakPickingOptions,\n    ...peakPicking,\n  };\n\n  const rangesOptions = {\n    frequency: originFrequency,\n    nucleus,\n    compile: true,\n    frequencyCluster: 13,\n    keepPeaks: true,\n  };\n\n  if (windowFromIndex !== undefined && windowToIndex !== undefined) {\n    x = x.slice(windowFromIndex, windowToIndex);\n    re = re.slice(windowFromIndex, windowToIndex);\n  }\n\n  if (originFrequency) {\n    // we calculate the number of points per Hz\n    let pointsPerHz = 1 / originFrequency / (x[1] - x[0]);\n    // we can consider a peak with of 0.5 Hz for the windowSize\n    let ws = Math.max(Math.round(pointsPerHz / 2), 5);\n    peakPickingOptions.sgOptions = {\n      windowSize: ws - (ws % 2) + 1,\n      polynomial: 3,\n    };\n  }\n  peakPickingOptions.smoothY = undefined;\n  peakPickingOptions.sgOptions = undefined;\n\n  const ranges = xyAutoRangesPicking(\n    { x, y: re },\n    {\n      peakPicking: peakPickingOptions,\n      ranges: rangesOptions,\n    },\n  );\n  return ranges as Range[];\n}\n","import { Datum1D } from '../../../types/data1d/Datum1D';\nimport { initSumOptions, SumParams } from '../SumManager';\n\nimport autoRangesDetection from './autoRangesDetection';\nimport { mapRanges } from './mapRanges';\nimport { updateRangesRelativeValues } from './updateRangesRelativeValues';\n\ninterface DetectRangesOptions {\n  windowFromIndex?: number;\n  windowToIndex?: number;\n  peakPicking: {\n    factorStd: number; // default 8\n    minMaxRatio: number; // default 0.1\n    integrationSum: number; // default 100\n    compile: boolean; //default true\n    frequencyCluster: number; // default 16\n    clean: boolean; // default true\n    keepPeaks: boolean; //default true\n  };\n  impurities?: {\n    solvent: string;\n  };\n}\n\nexport function detectRanges(\n  datum: Datum1D,\n  options: DetectRangesOptions & SumParams,\n) {\n  const { molecules, nucleus, ...detectOptions } = options;\n  detectOptions.impurities = { solvent: datum.info.solvent || '' };\n  const ranges = autoRangesDetection(datum, detectOptions);\n  datum.ranges.options = initSumOptions(datum.ranges.options, {\n    molecules,\n    nucleus,\n  });\n  datum.ranges.values = datum.ranges.values.concat(mapRanges(ranges, datum));\n  updateRangesRelativeValues(datum);\n}\n","import { Datum1D } from '../../../../types/data1d';\n\nexport function updateIntegralXShift(datum: Datum1D, shiftValue: number) {\n  datum.integrals.values = datum.integrals.values.map((integral) => ({\n    ...integral,\n    from: integral.originFrom + shiftValue,\n    to: integral.originTo + shiftValue,\n  }));\n}\n","import { xFindClosestIndex } from 'ml-spectra-processing';\n\nimport { Datum1D, Peak } from '../../../../types/data1d';\n\nexport function updatePeaksXShift(datum: Datum1D, shiftValue: number) {\n  datum.peaks.values = datum.peaks.values.map<Peak>((peak) => {\n    const delta = peak.originalX + shiftValue;\n    const xIndex = xFindClosestIndex(datum.data.x, delta);\n    return {\n      ...peak,\n      y: datum.data.re[xIndex],\n      x: peak.originalX + shiftValue,\n    };\n  });\n}\n","import { Datum1D } from '../../../../types/data1d';\n\nexport function updateRangesXShift(datum: Datum1D, shiftValue: number) {\n  datum.ranges.values = datum.ranges.values.map((range) => ({\n    ...range,\n    from: (range.originFrom || 0) + shiftValue,\n    to: (range.originTo || 0) + shiftValue,\n    signals:\n      range?.signals &&\n      range.signals.map((s) => ({\n        ...s,\n        delta: (s.originDelta || 0) + shiftValue,\n      })),\n  }));\n}\n","import { Datum1D } from '../../../types/data1d';\n\nimport { getShiftX } from './getShiftX';\nimport { updateIntegralXShift } from './internal/updateIntegralXShift';\nimport { updatePeaksXShift } from './internal/updatePeaksXShift';\nimport { updateRangesXShift } from './internal/updateRangesXShift';\n\nexport function updateXShift(datum: Datum1D) {\n  const shiftX = getShiftX(datum);\n  updatePeaksXShift(datum, shiftX);\n  updateRangesXShift(datum, shiftX);\n  updateIntegralXShift(datum, shiftX);\n}\n","export const DEFAULT_YAXIS_SHIFT_VALUE = 20;\n\nexport enum DISPLAYER_MODE {\n  DM_1D = '1D',\n  DM_2D = '2D',\n}\n\nexport const MARGIN = {\n  '2D': { top: 100, right: 50, bottom: 70, left: 100 },\n  '1D': {\n    top: 10,\n    right: 10,\n    bottom: 70,\n    left: 10,\n  },\n};\n","import { initiateDatum1D } from './Spectrum1D';\n\nexport function fromBruker(result, options = {}, usedColors = {}) {\n  const { dependentVariables, info, meta, source } = result;\n  let data = getData(dependentVariables[0].components);\n  if (data.im) info.isComplex = true;\n\n  if (Array.isArray(info.nucleus)) info.nucleus = info.nucleus[0];\n\n  const datum1D = initiateDatum1D(\n    {\n      ...options,\n      source,\n      info,\n      meta,\n      data,\n    },\n    usedColors,\n  );\n\n  return datum1D;\n}\n\nexport function fromCSD(result, options = {}, usedColors = {}) {\n  let dimension = result.dimensions[0];\n  let dependentVariables = result.dependentVariables;\n\n  let quantityName = dimension.quantityName;\n  let n = dimension.count;\n  let incr = dimension.increment.magnitude;\n  let origin = dimension.originOffset.magnitude;\n  let offset = dimension.coordinatesOffset.magnitude;\n\n  let buffer = dependentVariables[0].components[0];\n  let re: number[] = [];\n  let im: number[] = [];\n  for (let i = buffer.length - 1; i > 0; i -= 2) {\n    re.push(buffer[i - 1]);\n    im.push(buffer[i]);\n  }\n\n  let data: any = {};\n  let i, x0;\n  switch (quantityName) {\n    case 'frequency':\n      x0 = 0 + (offset / origin) * 1000000;\n      i = (incr / origin) * 1000000;\n      data.re = re;\n      data.im = im;\n      break;\n    case 'time':\n      x0 = origin;\n      i = incr;\n      data.re = re.reverse();\n      data.im = im.reverse().map((z) => -z);\n      break;\n    default:\n      break;\n  }\n\n  let scale: number[] = [];\n  for (let x = 0; x < n; x++) {\n    scale.push(x0 + x * i);\n  }\n\n  data.x = scale;\n\n  const datum1D = initiateDatum1D(\n    {\n      ...options,\n      data,\n    },\n    usedColors,\n  );\n  return datum1D;\n}\n\nexport function fromParsedJcamp(\n  parsedJcamp,\n  options,\n  usedColors,\n  jcampSpectrumIndex: number,\n) {\n  const { dependentVariables, info, meta } = parsedJcamp;\n  let data = getData(dependentVariables[0].components);\n  if (Array.isArray(info.nucleus)) info.nucleus = info.nucleus[0];\n  const datum1D = initiateDatum1D(\n    {\n      ...options,\n      source: { ...options.source, jcampSpectrumIndex },\n      info,\n      meta,\n      data,\n    },\n    usedColors,\n  );\n\n  return datum1D;\n}\n\nfunction getData(spectra) {\n  let x = spectra[0]?.data?.x ? spectra[0].data.x : [];\n  let re = spectra[0]?.data?.y ? spectra[0].data.y : [];\n  let im = spectra[1]?.data?.y ? spectra[1].data.y : null;\n\n  if (x[0] > x[1]) {\n    x.reverse();\n    re.reverse();\n    if (im) im.reverse();\n  }\n  return { x, re, im };\n}\n","import { zoneToX } from 'ml-spectra-processing';\n\nimport { UsedColors } from '../../../types/UsedColors';\nimport { initiateDatum1D } from '../../data1d/Spectrum1D';\nimport { Datum2D } from '../../types/data2d/Datum2D';\n\n/**\n * calculate the missing projection\n */\n\nexport function getMissingProjection(\n  datum: Datum2D,\n  nucleus: string,\n  usedColors: UsedColors,\n) {\n  let index = datum.info.nucleus.indexOf(nucleus);\n  // temporary because nucleus was undefined;\n  if (index === -1) index = 0;\n\n  let info = {\n    nucleus: datum.info.nucleus[index], // 1H, 13C, 19F, ...\n    isFid: false,\n    isComplex: false, // if isComplex is true that mean it contains real/ imaginary  x set, if not hid re/im button .\n    dimension: 1,\n  };\n\n  let from = index === 0 ? datum.data.minX : datum.data.minY;\n  let to = index === 0 ? datum.data.maxX : datum.data.maxY;\n  let nbPoints = index === 0 ? datum.data.z[0].length : datum.data.z.length;\n  let projection = new Float64Array(nbPoints);\n  if (index === 1) {\n    for (let i = 0; i < datum.data.z.length; i++) {\n      for (let j = 0; j < datum.data.z[0].length; j++) {\n        projection[i] += datum.data.z[i][j];\n      }\n    }\n  } else {\n    for (let i = 0; i < datum.data.z[0].length; i++) {\n      for (const z of datum.data.z) {\n        projection[i] += z[i];\n      }\n    }\n  }\n\n  let data = {\n    x: zoneToX({ from, to }, nbPoints),\n    re: projection,\n  };\n  return initiateDatum1D({ info, data }, usedColors);\n}\n","import { zoneToX } from 'ml-spectra-processing';\n\nimport { initiateDatum1D } from '../../data1d/Spectrum1D';\nimport { Datum2D } from '../../types/data2d';\n\n/** get 2d projection\n * @param {number} x in ppm\n * @param {number} y in ppm\n */\n\ninterface SlicePosition {\n  x: number;\n  y: number;\n}\n\nexport function getSlice(spectrum: Datum2D, position: SlicePosition) {\n  const data = spectrum.data;\n  const xStep = (data.maxX - data.minX) / (data.z[0].length - 1);\n  const yStep = (data.maxY - data.minY) / (data.z.length - 1);\n  const xIndex = Math.floor((position.x - data.minX) / xStep);\n  const yIndex = Math.floor((position.y - data.minY) / yStep);\n\n  if (xIndex < 0 || xIndex >= data.z[0].length) return;\n  if (yIndex < 0 || yIndex >= data.z.length) return;\n\n  let infoX = {\n    nucleus: spectrum.info.nucleus[0], // 1H, 13C, 19F, ...\n    isFid: false,\n    isComplex: false, // if isComplex is true that mean it contains real/ imaginary  x set, if not hid re/im button .\n    dimension: 1,\n  };\n\n  let dataX = {\n    x: zoneToX(\n      { from: spectrum.data.minX, to: spectrum.data.maxX },\n      spectrum.data.z[0].length,\n    ),\n    re: new Float64Array(spectrum.data.z[0].length),\n  };\n\n  for (let i = 0; i < spectrum.data.z[0].length; i++) {\n    dataX.re[i] += spectrum.data.z[yIndex][i];\n  }\n\n  let infoY = {\n    nucleus: spectrum.info.nucleus[1], // 1H, 13C, 19F, ...\n    isFid: false,\n    isComplex: false, // if isComplex is true that mean it contains real/ imaginary  x set, if not hid re/im button .\n    dimension: 1,\n  };\n\n  let dataY = {\n    x: zoneToX(\n      { from: spectrum.data.minY, to: spectrum.data.maxY },\n      spectrum.data.z.length,\n    ),\n    re: new Float64Array(spectrum.data.z.length),\n  };\n\n  let index = spectrum.data.z.length - 1;\n  for (let i = 0; i < spectrum.data.z.length; i++) {\n    dataY.re[i] += spectrum.data.z[index--][xIndex];\n  }\n\n  const horizontal = initiateDatum1D({ info: infoX, data: dataX }, {});\n  const vertical = initiateDatum1D({ info: infoY, data: dataY }, {});\n  return { horizontal, vertical };\n}\n","import { Conrec } from 'ml-conrec';\n\nexport const defaultContourOptions = {\n  positive: {\n    contourLevels: [0, 21],\n    numberOfLayers: 10,\n  },\n  negative: {\n    contourLevels: [0, 21],\n    numberOfLayers: 10,\n  },\n};\n\nexport default class Processing2D {\n  private options: any;\n  private currentLevelPositive: number;\n  private currentLevelNegative: number;\n  private conrec: Conrec;\n  private median: number;\n  private minMax: any;\n\n  public constructor(\n    minMax: any,\n    options: any = defaultContourOptions,\n    defaultLevel: any = {\n      positive: 10,\n      negative: 10,\n    },\n  ) {\n    this.options = options;\n    const { positive, negative } = defaultLevel;\n\n    this.currentLevelPositive = positive;\n    this.currentLevelNegative = negative;\n\n    const xs = getRange(minMax.minX, minMax.maxX, minMax.z[0].length);\n\n    const ys = getRange(minMax.minY, minMax.maxY, minMax.z.length);\n\n    this.conrec = new Conrec(minMax.z, { xs, ys, swapAxes: false });\n\n    this.median = minMax.noise;\n\n    this.minMax = minMax;\n  }\n\n  public getLevel() {\n    return {\n      levelPositive: this.currentLevelPositive,\n      levelNegative: this.currentLevelNegative,\n    };\n  }\n\n  public setLevel(levelPositive, levelNegative) {\n    this.currentLevelPositive = levelPositive;\n    this.currentLevelNegative = levelNegative;\n  }\n\n  public setOptions(options) {\n    const positiveBoundary = options.positive.contourLevels;\n    const negativeBoundary = options.negative.contourLevels;\n\n    if (this.currentLevelPositive >= positiveBoundary[1]) {\n      this.currentLevelPositive = positiveBoundary[1];\n    } else if (this.currentLevelPositive <= positiveBoundary[0]) {\n      this.currentLevelPositive = positiveBoundary[0];\n    }\n\n    if (this.currentLevelNegative >= negativeBoundary[1]) {\n      this.currentLevelNegative = negativeBoundary[1];\n    } else if (this.currentLevelNegative <= negativeBoundary[0]) {\n      this.currentLevelNegative = negativeBoundary[0];\n    }\n\n    this.options = options;\n  }\n\n  public wheel(value) {\n    const sign = Math.sign(value);\n    const positiveBoundary = this.options.positive.contourLevels;\n    const negativeBoundary = this.options.negative.contourLevels;\n\n    if (\n      (this.currentLevelPositive > positiveBoundary[0] && sign === -1) ||\n      (this.currentLevelPositive < positiveBoundary[1] && sign === 1)\n    ) {\n      this.currentLevelPositive += sign;\n    }\n\n    if (\n      (this.currentLevelNegative > negativeBoundary[0] && sign === -1) ||\n      (this.currentLevelNegative < negativeBoundary[1] && sign === 1)\n    ) {\n      this.currentLevelNegative += sign;\n    }\n  }\n\n  public shiftWheel(value) {\n    const sign = Math.sign(value);\n    const [min, max] = this.options.positive.contourLevels;\n    if (\n      (this.currentLevelPositive === min && sign === -1) ||\n      (this.currentLevelPositive >= max && sign === 1)\n    ) {\n      return;\n    }\n\n    this.currentLevelPositive += sign;\n    return [];\n  }\n\n  public drawContours() {\n    const zoomPositive = this.currentLevelPositive / 2 + 1;\n    const zoomNegative = this.currentLevelNegative / 2 + 1;\n    const {\n      positive: { numberOfLayers: numberOfPositiveLayer },\n      negative: { numberOfLayers: numberOfNegativeLayer },\n    } = this.options;\n    return {\n      positive: this.getContours(zoomPositive, {\n        nbLevels: numberOfPositiveLayer,\n      }),\n      negative: this.getContours(zoomNegative, {\n        negative: true,\n        nbLevels: numberOfNegativeLayer,\n      }),\n    };\n  }\n\n  public getContours(zoomLevel, options: any = {}) {\n    const { negative = false, timeout = 2000, nbLevels = 10 } = options;\n\n    const max = Math.max(\n      Math.abs(this.minMax.maxZ),\n      Math.abs(this.minMax.minZ),\n    );\n\n    let _range = getRange(\n      this.median * 1 * Math.pow(2, zoomLevel),\n      max,\n      nbLevels,\n      2,\n    );\n\n    if (negative) {\n      _range = _range.map((value) => -value);\n    }\n    let contours = [];\n    try {\n      contours = this.conrec.drawContour({\n        contourDrawer: 'basic', // shape or basic\n        levels: _range,\n        timeout: timeout,\n      });\n    } catch (e) {\n      // eslint-disable-next-line no-console\n      console.log(e);\n      throw e;\n    }\n\n    return contours;\n  }\n}\n\nfunction getRange(min: number, max: number, length: number, exp?: number) {\n  if (exp !== undefined) {\n    const factors: number[] = [];\n\n    factors[0] = 0;\n\n    for (let i = 1; i <= length; i++) {\n      factors[i] = factors[i - 1] + (exp - 1) / Math.pow(exp, i);\n    }\n\n    const lastFactor = factors[length];\n\n    const result = new Array(length);\n\n    for (let i = 0; i < length; i++) {\n      result[i] = (max - min) * (1 - factors[i + 1] / lastFactor) + min;\n    }\n\n    return result;\n  } else {\n    const step = (max - min) / (length - 1);\n\n    return range(min, max + step / 2, step);\n  }\n}\n\nfunction range(from: number, to: number, step: number) {\n  const result: number[] = [];\n\n  for (let i = from; i < to; i += step) {\n    result.push(i);\n  }\n\n  return result;\n}\n","import * as FiltersManager from '../../FiltersManager';\nimport { Datum2D } from '../../types/data2d';\nimport generateID from '../../utilities/generateID';\nimport { get2DColor } from '../../utilities/getColor';\nimport Processing2D, { defaultContourOptions } from '../Processing2D';\n\nexport function initiateDatum2D(options: any, usedColors = {}): Datum2D {\n  const datum: any = {};\n\n  datum.id = options.id || generateID();\n  datum.source = Object.assign(\n    {\n      jcampURL: null,\n    },\n    options.source,\n  );\n  datum.display = Object.assign(\n    {\n      name: options.display?.name ? options.display.name : generateID(),\n      ...getColor(options, usedColors),\n      isPositiveVisible: true,\n      isNegativeVisible: true,\n      isVisible: true,\n      contourOptions: defaultContourOptions,\n      dimension: 2,\n    },\n    options.display,\n  );\n\n  datum.info = Object.assign(\n    {\n      nucleus: ['1H', '1H'],\n      isFt: true,\n      isFid: false,\n      isComplex: false, // if isComplex is true that mean it contains real/ imaginary  x set, if not hid re/im button .\n      dimension: 2,\n    },\n    options.info,\n  );\n\n  datum.originalInfo = datum.info;\n  datum.meta = Object.assign({}, options.meta);\n  datum.data = Object.assign(\n    {\n      z: [],\n      minX: 0,\n      minY: 0,\n      maxX: 0,\n      maxY: 0,\n    },\n    options.data,\n  );\n  datum.originalData = datum.data;\n  datum.filters = Object.assign([], options.filters);\n\n  datum.zones = Object.assign({ values: [], options: {} }, options.zones);\n\n  datum.processingController = new Processing2D(\n    datum.data,\n    datum.display.contourOptions,\n  );\n\n  //reapply filters after load the original data\n  FiltersManager.reapplyFilters(datum);\n\n  return datum;\n}\n\nfunction getColor(options, usedColors) {\n  let color = { positiveColor: 'red', negativeColor: 'blue' };\n  if (\n    options?.display?.negativeColor === undefined ||\n    options?.display?.positiveColor === undefined\n  ) {\n    color = get2DColor(options.info.experiment, usedColors['2d'] || []);\n  }\n\n  if (usedColors['2d']) {\n    usedColors['2d'].push(color.positiveColor);\n  }\n  return color;\n}\n","import { Datum1D } from '../../types/data1d';\nimport { Datum2D } from '../../types/data2d';\n\nexport function isSpectrum2D(spectrum: Datum1D | Datum2D): spectrum is Datum2D {\n  return spectrum.info.dimension === 2;\n}\n","import * as Filters from '../../../Filters';\nimport { Datum2D } from '../../../types/data2d';\n\nexport function getShift(datum: Datum2D): { xShift: number; yShift: number } {\n  let shift: any = { xShift: 0, yShift: 0 };\n  if (datum?.filters) {\n    shift = datum.filters.reduce(\n      (acc, filter) => {\n        if (filter.name === Filters.shift2DX.id) {\n          acc.xShift = filter?.flag ? filter.value : 0;\n        }\n        if (filter.name === Filters.shift2DY.id) {\n          acc.yShift = filter?.flag ? filter.value : 0;\n        }\n        return acc;\n      },\n      { xShift: 0, yShift: 0 },\n    );\n  }\n\n  return shift;\n}\n","import { Datum2D } from '../../../types/data2d';\n\nimport { getShift } from './getShift';\n\nexport function updateShift(datum: Datum2D) {\n  const { xShift, yShift } = getShift(datum);\n  updateZonesShift(datum, {\n    xShift,\n    yShift,\n  });\n}\n\nfunction updateZonesShift(datum: Datum2D, { xShift, yShift }) {\n  datum.zones.values = datum.zones.values.map((zone) => ({\n    ...zone,\n    signals: zone.signals?.map((signal) => ({\n      ...signal,\n      x: { ...signal.x, delta: signal.x.originDelta + xShift },\n      y: { ...signal.y, delta: signal.y.originDelta + yShift },\n    })),\n  }));\n}\n","import { DataExportOptions, DataExportOptionsType } from '../../SpectraManager';\nimport { Datum2D } from '../../types/data2d';\n\nexport function toJSON(\n  datum: Datum2D,\n  dataExportOption: DataExportOptionsType,\n) {\n  return {\n    id: datum.id,\n\n    ...(dataExportOption === DataExportOptions.ROW_DATA ||\n    (dataExportOption === DataExportOptions.DATA_SOURCE &&\n      !datum.source.jcampURL)\n      ? {\n          data: datum.originalData,\n          info: datum.originalInfo,\n          meta: datum.meta,\n          source: {\n            jcampURL: null,\n          },\n        }\n      : {\n          source: {\n            jcampURL: datum.source.jcampURL,\n            jcampSpectrumIndex: datum.source.jcampSpectrumIndex,\n          },\n        }),\n    zones: datum.zones,\n    filters: datum.filters,\n    display: datum.display,\n  };\n}\n","import { Datum2D } from '../../../types/data2d';\n\n/**\n *\n * @param {number} zoneID\n * @param {object} signal\n * @param {number} signal.x\n * @param {number} signal.y\n * @param {string} signal.id\n */\nexport function changeZoneSignal(\n  datum: Datum2D,\n  zoneID,\n  newSignal,\n): { xShift: number; yShift: number } {\n  const zoneIndex = datum.zones.values.findIndex((zone) => zone.id === zoneID);\n  if (zoneIndex !== -1) {\n    const signalIndex = datum.zones.values[zoneIndex].signals.findIndex(\n      (s) => s.id === newSignal.id,\n    );\n\n    const zone = datum.zones.values[zoneIndex];\n    if (signalIndex !== -1) {\n      const originalSignal: any = zone.signals[signalIndex];\n      const xShift =\n        newSignal?.x || newSignal?.x === 0\n          ? newSignal.x - originalSignal.x.delta\n          : 0;\n      const yShift =\n        newSignal?.y || newSignal?.y === 0\n          ? newSignal.y - originalSignal.y?.delta\n          : 0;\n\n      return { xShift, yShift };\n    }\n  }\n  return { xShift: 0, yShift: 0 };\n}\n","import { xyzAutoZonesPicking } from 'nmr-processing';\n\nimport { Datum2D } from '../../../types/data2d';\n\nexport interface DetectionZonesOptions {\n  selectedZone: {\n    fromX: number;\n    fromY: number;\n    toX: number;\n    toY: number;\n  };\n  thresholdFactor: number;\n  convolutionByFFT?: boolean;\n  enhanceSymmetry?: boolean;\n}\n\n/**\n *\n * @param {object} options\n * @param {object} options.selectedZone\n * @param {number} options.selectedZone.fromX\n * @param {number} options.selectedZone.fromY\n * @param {number} options.selectedZone.toX\n * @param {number} options.selectedZone.toY\n * @param {number} options.thresholdFactor\n * @param {boolean} options.convolutionByFFT\n */\nexport function getDetectionZones(\n  datum: Datum2D,\n  options: DetectionZonesOptions,\n) {\n  let dataMatrix = {};\n  if (options.selectedZone) {\n    options.enhanceSymmetry = false;\n    dataMatrix = getSubMatrix(datum, options.selectedZone);\n  } else {\n    dataMatrix = datum.data;\n  }\n  return autoZonesDetection(dataMatrix, { ...options, info: datum.info });\n}\n\nfunction autoZonesDetection(data, options) {\n  const { thresholdFactor, clean, maxPercentCutOff, convolutionByFFT } =\n    options;\n\n  const { nucleus: nuclei, originFrequency } = options.info;\n  const { enhanceSymmetry = nuclei[0] === nuclei[1] } = options;\n\n  let zones = xyzAutoZonesPicking(data, {\n    nuclei,\n    observedFrequencies: originFrequency,\n    thresholdFactor,\n    clean,\n    maxPercentCutOff,\n    enhanceSymmetry,\n    convolutionByFFT,\n  });\n\n  return zones;\n}\n\nfunction getSubMatrix(datum, selectedZone) {\n  const { fromX, toX, fromY, toY } = selectedZone;\n  const data = datum.data;\n  const xStep = (data.maxX - data.minX) / (data.z[0].length - 1);\n  const yStep = (data.maxY - data.minY) / (data.z.length - 1);\n  let xIndexFrom = Math.max(Math.floor((fromX - data.minX) / xStep), 0);\n  let yIndexFrom = Math.max(Math.floor((fromY - data.minY) / yStep), 0);\n  let xIndexTo = Math.min(\n    Math.floor((toX - data.minX) / xStep),\n    data.z[0].length - 1,\n  );\n  let yIndexTo = Math.min(\n    Math.floor((toY - data.minY) / yStep),\n    data.z.length - 1,\n  );\n\n  if (xIndexFrom > xIndexTo) [xIndexFrom, xIndexTo] = [xIndexTo, xIndexFrom];\n  if (yIndexFrom > yIndexTo) [yIndexFrom, yIndexTo] = [yIndexTo, yIndexFrom];\n\n  let dataMatrix: any = {\n    z: [],\n    maxX: data.minX + xIndexTo * xStep,\n    minX: data.minX + xIndexFrom * xStep,\n    maxY: data.minY + yIndexTo * yStep,\n    minY: data.minY + yIndexFrom * yStep,\n  };\n  let maxZ = Number.MIN_SAFE_INTEGER;\n  let minZ = Number.MAX_SAFE_INTEGER;\n\n  let nbXPoints = xIndexTo - xIndexFrom + 1;\n\n  for (let j = yIndexFrom; j < yIndexTo; j++) {\n    let row = new Float32Array(nbXPoints);\n    let xIndex = xIndexFrom;\n    for (let i = 0; i < nbXPoints; i++) {\n      row[i] = data.z[j][xIndex++];\n    }\n    for (let rowValue of row) {\n      if (maxZ < rowValue) maxZ = rowValue;\n      if (minZ > rowValue) minZ = rowValue;\n    }\n    dataMatrix.z.push(Array.from(row));\n  }\n  dataMatrix.minZ = minZ;\n  dataMatrix.maxZ = maxZ;\n  return dataMatrix;\n}\n","import { NMRZone } from 'nmr-processing';\n\nimport { DatumKind } from '../../../constants/SignalsKinds';\nimport { Zone } from '../../../types/data2d';\nimport generateID from '../../../utilities/generateID';\nimport { getShift } from '../shift/getShift';\n\nimport { DetectionZonesOptions, getDetectionZones } from './getDetectionZones';\n\nexport function detectZones(datum, options: DetectionZonesOptions): Zone[] {\n  const zones = getDetectionZones(datum, options);\n  const { xShift, yShift } = getShift(datum);\n\n  const { minX, maxX, minY, maxY } = datum.data;\n  const xError = Math.abs(maxX - minX) / 10000;\n  const yError = Math.abs(maxY - minY) / 10000;\n\n  const formattedZones = zones.reduce((acc: Zone[], zone: NMRZone) => {\n    const newXRange = zone.x || { from: 0, to: 0 };\n    const newYRange = zone.y || { from: 0, to: 0 };\n\n    // check if the zone is already exists\n    for (const { x, y } of datum.zones.values) {\n      if (\n        Math.abs(newXRange.from - x.from) < xError &&\n        Math.abs(newXRange.to - x.to) < xError &&\n        Math.abs(newYRange.from - y.from) < yError &&\n        Math.abs(newYRange.to - y.to) < yError\n      ) {\n        return acc;\n      }\n    }\n\n    const signals = zone.signals.map((signal) => {\n      return {\n        id: generateID(),\n        peaks: signal.peaks,\n        x: {\n          originDelta: signal.x.delta - xShift,\n          ...signal.x,\n        },\n        y: {\n          originDelta: signal.y.delta - yShift,\n          ...signal.y,\n        },\n        kind: 'signal',\n      };\n    });\n\n    acc.push({\n      id: generateID(),\n      x: { from: newXRange.from, to: newXRange.to },\n      y: { from: newYRange.from, to: newYRange.to },\n      signals,\n      kind: DatumKind.signal,\n    });\n\n    return acc;\n  }, []);\n  return formattedZones;\n}\n","import { DatumKind } from '../../../constants/SignalsKinds';\nimport { Zone } from '../../../types/data2d';\nimport generateID from '../../../utilities/generateID';\nimport { getShift } from '../shift/getShift';\n\nimport { DetectionZonesOptions, getDetectionZones } from './getDetectionZones';\n\n/**\n *\n * @param {object} options\n * @param {object} options.selectedZone\n * @param {number} options.selectedZone.fromX\n * @param {number} options.selectedZone.fromY\n * @param {number} options.selectedZone.toX\n * @param {number} options.selectedZone.toY\n * @param {number} options.thresholdFactor\n * @param {boolean} options.convolutionByFFT\n */\nexport function detectZonesManual(datum, options: DetectionZonesOptions) {\n  const zones = getDetectionZones(datum, options);\n  const { xShift, yShift } = getShift(datum);\n  const formattedZones: Zone[] = zones.map((zone) => {\n    const signals = zone.signals.map((signal) => {\n      return {\n        id: generateID(),\n        peaks: signal.peaks,\n        x: {\n          originDelta: signal.x.delta - xShift,\n          ...signal.x,\n        },\n        y: {\n          originDelta: signal.y.delta - yShift,\n          ...signal.y,\n        },\n        kind: signal.kind || 'signal',\n      };\n    });\n    return {\n      id: generateID(),\n      x: zone.x,\n      y: zone.y,\n      signals,\n      kind: DatumKind.signal,\n    };\n  }, []);\n\n  return formattedZones;\n}\n","import { initiateDatum2D } from './Spectrum2D';\n\nexport function fromParsedJcamp(\n  parsedJcamp,\n  options,\n  usedColors,\n  jcampSpectrumIndex: number,\n) {\n  const { dependentVariables, info, meta } = parsedJcamp;\n  let data = dependentVariables[0].components;\n  const ob = initiateDatum2D(\n    {\n      ...options,\n      source: { ...options?.source, jcampSpectrumIndex },\n      info,\n      meta,\n      data,\n    },\n    usedColors,\n  );\n  return ob;\n}\n\nexport function fromBruker(result, options = {}, usedColors = {}) {\n  const { dependentVariables, meta, source } = result;\n  let data = dependentVariables[0].components;\n  const datum2D = initiateDatum2D(\n    {\n      ...options,\n      source,\n      meta,\n      data,\n    },\n    usedColors,\n  );\n\n  return datum2D;\n}\n\n// TODO: implement this.\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nexport function fromCSD(result, options = {}, usedColors = {}) {\n  const datum2D = initiateDatum2D({}, usedColors);\n  return datum2D;\n}\n","export function changeKeys(data, changedKeys) {\n  return JSON.parse(JSON.stringify(data), function reviver(key, value) {\n    if (key in changedKeys) {\n      this[changedKeys[key]] = value;\n      return;\n    }\n    return value;\n  });\n}\n","import { changeKeys } from './changeKeys';\n\n/**\n * changes from version 0 to version 1:\n * all change done on objects keys naming\n *  j         =>   js\n *  signal    =>   signals\n *  integral  =>   integration\n *  peak      =>   peaks\n *  diaID     =>   diaIDs\n *\n */\n\nexport default function migrateToVersion1(data: any): any {\n  if (data?.version === 1) return data;\n\n  const newData = { ...data, version: 1 };\n  const changedKeys = {\n    j: 'js',\n    signal: 'signals',\n    integral: 'integration',\n    peak: 'peaks',\n    diaID: 'diaIDs',\n  };\n\n  for (const spectrum of newData.spectra) {\n    if (spectrum.ranges) {\n      spectrum.ranges = changeKeys(spectrum.ranges, changedKeys);\n    } else if (spectrum.zones) {\n      spectrum.zones = changeKeys(spectrum.zones, changedKeys);\n    }\n  }\n\n  return newData;\n}\n","import { changeKeys } from './changeKeys';\n\n/*\n    * changes from version 1 to version 2:\n           1- peaks :\n                delta => x , originDelta => originalX, intensity => y,\n               paths:\n               - peak\n\n           2- range/signals :\n                atomIDs => atoms , intensity => y,\n\n              paths:\n               - range > signals\n               - range > signals > js\n               - range > signals > peaks\n\n           3- zone/signals :\n              we have two cases the\n              a)\n                get out the inner object fromTo:{from,to} => {from,to}\n              paths:\n               - zone > signals > x\n               - zone > signals > y\n              b)\n                { fromTo,deltaX,resolutionX,nucleusX,deltaY,resolutionY,nucleusY,shiftX,shiftY} =>\n                {\n                  x: {\n                    from: fromTo[0].from,\n                    to: fromTo[0].to,\n                    delta: deltaX,\n                    resolution: resolutionX,\n                    nucleus: nucleusX,\n                  },\n                  y: {\n                    from: fromTo[1].from,\n                    to: fromTo[1].to,\n                    delta: deltaY,\n                    resolution: resolutionY,\n                    nucleus: nucleusY,\n                  },\n                  }\n\n                paths:\n                -zone>signals\n    */\n\nexport default function migrateToVersion2(data: any): any {\n  if (data?.version === 2) return data;\n\n  const newData = { ...data, version: 2 };\n\n  const changedKeys = {\n    peaks: {\n      delta: 'x',\n      originDelta: 'originalX',\n      intensity: 'y',\n    },\n    ranges: {\n      atomIDs: 'atoms', // signal\n      intensity: 'y', // signal > peaks\n    },\n  };\n\n  for (const spectrum of newData.spectra) {\n    if (spectrum.peaks) {\n      spectrum.peaks = changeKeys(spectrum.peaks, changedKeys.peaks);\n    } else if (spectrum.ranges) {\n      spectrum.ranges = changeKeys(spectrum.ranges, changedKeys.ranges);\n    } else if (spectrum.zones) {\n      spectrum.zones.values = mapZones(spectrum.zones.values);\n    }\n  }\n\n  return newData;\n}\n\nfunction mapZones(zones) {\n  return zones.map((zone) => {\n    if (zone.signals) {\n      zone.signals = zone.signals.map((signal) => {\n        if (signal.x && signal.y) {\n          const {\n            x: { fromTo: fromToX, ...resX },\n            y: { fromTo: fromToY, ...resY },\n          } = signal;\n          signal = {\n            ...signal,\n            x: { ...resX, ...fromToX },\n            y: { ...resY, ...fromToY },\n          };\n        } else {\n          const {\n            fromTo,\n            deltaX,\n            resolutionX,\n            nucleusX,\n            deltaY,\n            resolutionY,\n            nucleusY,\n\n            shiftX,\n            shiftY,\n            ...resSignal\n          } = signal;\n          signal = {\n            ...resSignal,\n            x: {\n              from: fromTo[0].from,\n              to: fromTo[0].to,\n              delta: deltaX,\n              resolution: resolutionX,\n              nucleus: nucleusX,\n            },\n            y: {\n              from: fromTo[1].from,\n              to: fromTo[1].to,\n              delta: deltaY,\n              resolution: resolutionY,\n              nucleus: nucleusY,\n            },\n          };\n        }\n        return signal;\n      }, []);\n    }\n    return zone;\n  }, []);\n}\n","import migrateToVersion1 from './migrateToVersion1';\nimport migrateToVersion2 from './migrateToVersion2';\n\nexport const CURRENT_EXPORT_VERSION = 2;\n\nfunction migrationPipe(functions: ((data: any) => any)[]) {\n  return (input: any) => functions.reduce((input, func) => func(input), input);\n}\n\nexport function migrate(data: any): any {\n  let migrationsFuncs: ((data: any) => any)[] = [\n    migrateToVersion1,\n    migrateToVersion2,\n  ];\n  let index = data?.version || 0;\n\n  if (index > CURRENT_EXPORT_VERSION) {\n    throw new Error(\n      'This file can not be imported using the current NMRium version, Please move to the new one !!! ',\n    );\n  }\n\n  return migrationPipe(migrationsFuncs.slice(index))(data);\n}\n","const mfCheck = /^(?:[A-Z][a-z]?\\d* *)+$/;\n\nexport default function getAtomsFromMF(mf: string): Record<string, number> {\n  if (!mfCheck.test(mf)) {\n    throw Error(`MF can not be parsed: ${mf}`);\n  }\n  const atoms = {};\n  const parts = mf.matchAll(/(?<atom>[A-Z][a-z]?)(?<number>[0-9]*)/g);\n  for (const part of parts) {\n    const { atom, number } = part.groups as { atom: string; number: string };\n    if (!atoms[atom]) {\n      atoms[atom] = 0;\n    }\n    atoms[atom] += number === '' ? 1 : Number(number);\n  }\n\n  return atoms;\n}\n","import { Molecule as OCLMolecule } from 'openchemlib/full';\n\nimport generateID from '../utilities/generateID';\nimport getAtomsFromMF from '../utilities/getAtomsFromMF';\n\ninterface MoleculeInnerProps {\n  key: string;\n  molfile: string;\n}\nexport interface Molecule extends MoleculeInnerProps {\n  mf: string;\n  em: number;\n  mw: number;\n  svg: string;\n  atoms: Record<string, number>;\n}\n\nexport function initMolecule(\n  options: Partial<MoleculeInnerProps> = {},\n): Molecule {\n  const key = options.key || generateID();\n  const molfile = options.molfile || '';\n\n  const mol = OCLMolecule.fromMolfile(molfile);\n  const mfInfo = mol.getMolecularFormula();\n\n  return {\n    key,\n    molfile,\n    mf: mfInfo.formula,\n    em: mfInfo.absoluteWeight,\n    mw: mfInfo.relativeWeight,\n    svg: mol.toSVG(50, 50),\n    atoms: getAtomsFromMF(mfInfo.formula),\n  };\n}\n\nexport function toJSON(molecule: Molecule): { molfile: string } {\n  return {\n    molfile: molecule.molfile,\n  };\n}\n","import { fromJEOL, fromJCAMP, fromBruker } from 'nmr-parser';\n\nimport { DISPLAYER_MODE } from '../component/reducer/core/Constants';\n\nimport * as Data1DManager from './data1d/Data1DManager';\nimport * as Datum1D from './data1d/Spectrum1D';\nimport * as Data2DManager from './data2d/Data2DManager';\nimport * as Datum2D from './data2d/Spectrum2D';\nimport { CURRENT_EXPORT_VERSION } from './migration/MigrationManager';\nimport * as Molecule from './molecules/Molecule';\n\nexport enum DataExportOptions {\n  ROW_DATA = 'ROW_DATA',\n  DATA_SOURCE = 'DATA_SOURCE',\n}\n\nexport type DataExportOptionsType = keyof typeof DataExportOptions;\n\nexport function addJcampFromURL(spectra, jcampURL, options, usedColors) {\n  return fetch(jcampURL)\n    .then((response) => response.arrayBuffer())\n    .then((jcamp) => {\n      addJcamp(spectra, jcamp, options, usedColors);\n    });\n}\n\nexport function addJcamp(spectra, jcamp, options, usedColors) {\n  options = options || {};\n  const entries = fromJCAMP(jcamp, {\n    noContour: true,\n    xy: true,\n    keepRecordsRegExp: /.*/,\n    profiling: true,\n  });\n  if (entries.length === 0) return;\n  // Should be improved when we have a more complex case\n  for (let index = 0; index < entries.length; index++) {\n    let entry = entries[index];\n\n    const components = entry.dependentVariables?.[0]?.components;\n    if (components && (components.length > 0 || components.z)) {\n      addJcampSS(spectra, { index, entry }, options, usedColors);\n    }\n  }\n}\n\nfunction addJcampSS(spectra, jcampDatum, options, usedColors) {\n  const source = options?.source || {};\n\n  if (\n    !('jcampSpectrumIndex' in source) ||\n    source.jcampSpectrumIndex === jcampDatum.index\n  ) {\n    const dimension = jcampDatum.entry.info.dimension;\n\n    if (dimension === 1) {\n      spectra.push(\n        Data1DManager.fromParsedJcamp(\n          jcampDatum.entry,\n          options,\n          usedColors,\n          jcampDatum.index,\n        ),\n      );\n    }\n    if (dimension === 2) {\n      // console.log(options, jcampDatum.entry);\n\n      spectra.push(\n        Data2DManager.fromParsedJcamp(\n          jcampDatum.entry,\n          options,\n          usedColors,\n          jcampDatum.index,\n        ),\n      );\n    }\n  }\n}\n\nfunction addData(spectra, datum, usedColors) {\n  const dimension = datum.info.dimension;\n  if (dimension === 1) {\n    spectra.push(Datum1D.initiateDatum1D(datum, usedColors));\n  }\n  if (dimension === 2) {\n    spectra.push(Datum2D.initiateDatum2D(datum, usedColors));\n  }\n}\n\nexport function addJDF(spectra, jdf, options: any = {}, usedColors: any = {}) {\n  // need to parse the jcamp\n  let converted = fromJEOL(jdf, {});\n  converted = converted[0];\n  let info = converted.description;\n  let metadata = info.metadata;\n  delete info.metadata;\n  info.acquisitionMode = 0;\n  info.experiment = info.dimension === 1 ? '1d' : '2d';\n  info.type = 'NMR SPECTRUM';\n  info.nucleus = info.nucleus[0];\n  info.numberOfPoints = info.numberOfPoints[0];\n  info.acquisitionTime = info.acquisitionTime[0];\n\n  info.baseFrequency = info.baseFrequency[0];\n  info.frequencyOffset = info.frequencyOffset[0];\n\n  info.spectralWidthClipped = converted.application.spectralWidthClipped;\n\n  if (info.dimension === 1) {\n    if (converted.dependentVariables) {\n      spectra.push(\n        Data1DManager.fromCSD(\n          converted,\n          {\n            ...options,\n            display: { ...options.display },\n            info: info,\n            meta: metadata,\n          },\n          usedColors,\n        ),\n      );\n    }\n  }\n  if (info.dimension === 2 && info.isFt) {\n    spectra.push(\n      Data2DManager.fromCSD(\n        converted,\n        {\n          ...options,\n          display: { ...options.display },\n          info,\n        },\n        usedColors,\n      ),\n    );\n  }\n}\n\nexport async function fromJSON(data: any[] = [], usedColors: any = {}) {\n  const spectra: any[] = [];\n  let promises: any[] = [];\n\n  for (let datum of data) {\n    if (datum?.source?.jcampURL != null) {\n      promises.push(\n        addJcampFromURL(spectra, datum.source.jcampURL, datum, usedColors),\n      );\n    } else {\n      addData(spectra, datum, usedColors);\n    }\n  }\n  await Promise.all(promises);\n  return spectra;\n}\n\nexport async function addBruker(options, data, usedColors) {\n  const spectra: any[] = [];\n  let result = await fromBruker(data, {\n    xy: true,\n    noContours: true,\n    keepOriginal: true,\n  });\n  let entries = result;\n  for (let entry of entries) {\n    let { info, dependentVariables } = entry;\n    if (info.dimension === 1) {\n      if (dependentVariables[0].components) {\n        spectra.push(\n          Data1DManager.fromBruker(\n            entry,\n            {\n              ...options,\n              display: { ...options.display },\n            },\n            usedColors,\n          ),\n        );\n      }\n    } else if (info.dimension === 2) {\n      if (info.isFt) {\n        spectra.push(\n          Data2DManager.fromBruker(\n            entry,\n            {\n              ...options,\n              info,\n              display: { ...options.display },\n            },\n            usedColors,\n          ),\n        );\n      } else {\n        // in case of 2D FID spectrum\n      }\n    }\n  }\n  return spectra;\n}\n\n// handle zip files\nexport async function fromZip(zipFiles) {\n  const spectra = [];\n  for (let zipFile of zipFiles) {\n    await addBruker(\n      spectra,\n      { display: { name: zipFile.name } },\n      zipFile.binary,\n    );\n  }\n  return spectra;\n}\n\nexport function addJDFs(files, usedColors) {\n  const spectra = [];\n  for (const file of files) {\n    addJDF(\n      spectra,\n      file.binary,\n      {\n        display: {\n          name: file.name,\n        },\n        source: {\n          jcampURL: file.jcampURL ? file.jcampURL : null,\n          file,\n        },\n      },\n      usedColors,\n    );\n  }\n  return spectra;\n}\n\nexport function addJcamps(files, usedColors) {\n  const spectra = [];\n  for (const file of files) {\n    addJcamp(\n      spectra,\n      file.binary,\n      {\n        display: {\n          name: file.name,\n        },\n        source: {\n          jcampURL: file.jcampURL ? file.jcampURL : null,\n          file,\n        },\n      },\n      usedColors,\n    );\n  }\n  return spectra;\n}\n\nfunction getPreferences(state) {\n  const {\n    activeTab,\n    verticalAlign: { align },\n  } = state;\n  return {\n    activeTab,\n    ...(state.displayerMode === DISPLAYER_MODE.DM_1D\n      ? { verticalAlign: align }\n      : {}),\n  };\n}\n\n/**\n *\n * @param {object} state\n */\nexport function toJSON(\n  state,\n  dataExportOption: DataExportOptionsType = DataExportOptions.DATA_SOURCE,\n) {\n  const {\n    data,\n    molecules: mols,\n    correlations,\n    multipleAnalysis,\n    toolOptions: {\n      data: { exclusionZones },\n    },\n  } = state || {\n    data: [],\n    molecules: [],\n    correlations: {},\n    multipleAnalysis: {},\n    exclusionZones: {},\n  };\n  const spectra = data.map((ob) => {\n    return ob.info.dimension === 1\n      ? Datum1D.toJSON(ob, dataExportOption)\n      : Datum2D.toJSON(ob, dataExportOption);\n  });\n\n  const preferences = getPreferences(state);\n  const molecules = mols.map((mol) => Molecule.toJSON(mol));\n\n  return {\n    spectra,\n    molecules,\n    correlations,\n    multipleAnalysis,\n    exclusionZones,\n    version: CURRENT_EXPORT_VERSION,\n    preferences,\n  };\n}\n","import { DataExportOptions, DataExportOptionsType } from '../../SpectraManager';\nimport { Datum1D } from '../../types/data1d/Datum1D';\n\nexport function toJSON(\n  datum1D: Datum1D,\n  dataExportOption: DataExportOptionsType,\n) {\n  return {\n    id: datum1D.id,\n    display: datum1D.display,\n    ...(dataExportOption === DataExportOptions.ROW_DATA ||\n    (dataExportOption === DataExportOptions.DATA_SOURCE &&\n      !datum1D.source.jcampURL)\n      ? {\n          data: datum1D.originalData,\n          info: datum1D.originalInfo,\n          meta: datum1D.meta,\n          source: {\n            jcampURL: null,\n          },\n        }\n      : {\n          source: {\n            jcampURL: datum1D.source.jcampURL,\n            jcampSpectrumIndex: datum1D.source.jcampSpectrumIndex,\n          },\n        }),\n    peaks: datum1D.peaks,\n    integrals: datum1D.integrals,\n    ranges: datum1D.ranges,\n    filters: datum1D.filters,\n  };\n}\n","import {\n  predictAll,\n  signalsToXY,\n  signals2DToZ,\n  getFrequency,\n} from 'nmr-processing';\nimport OCL from 'openchemlib/full';\n\nimport { DatumKind } from './constants/SignalsKinds';\nimport {\n  initiateDatum1D,\n  mapRanges,\n  updateIntegralsRelativeValues,\n} from './data1d/Spectrum1D';\nimport { initiateDatum2D } from './data2d/Spectrum2D';\nimport { Datum1D } from './types/data1d';\nimport { Datum2D, Signal2D, Zone } from './types/data2d';\nimport generateID from './utilities/generateID';\nimport { adjustAlpha } from './utilities/getColor';\n\nexport interface PredictionOptions {\n  name: string;\n  frequency: number;\n  '1d': {\n    '1H': { from: number; to: number };\n    '13C': { from: number; to: number };\n    nbPoints: number;\n    lineWidth: number;\n  };\n  '2d': {\n    nbPoints: { x: number; y: number };\n  };\n  spectra: {\n    proton: boolean;\n    carbon: boolean;\n    cosy: boolean;\n    hsqc: boolean;\n    hmbc: boolean;\n  };\n}\n\nexport const defaultPredictionOptions: PredictionOptions = {\n  name: '',\n  frequency: 400,\n  '1d': {\n    '1H': { from: -1, to: 12 },\n    '13C': { from: -5, to: 220 },\n    nbPoints: 2 ** 17,\n    lineWidth: 1,\n  },\n  '2d': {\n    nbPoints: { x: 1024, y: 1024 },\n  },\n  spectra: {\n    proton: true,\n    carbon: true,\n    cosy: true,\n    hsqc: true,\n    hmbc: true,\n  },\n};\n\nexport const FREQUENCIES: Array<{ key: number; value: number; label: string }> =\n  [\n    { key: 1, value: 60, label: '60 MHz' },\n    { key: 2, value: 100, label: '100 MHz' },\n    { key: 3, value: 200, label: '200 MHz' },\n    { key: 4, value: 300, label: '300 MHz' },\n    { key: 5, value: 400, label: '400 MHz' },\n    { key: 6, value: 500, label: '500 MHz' },\n    { key: 7, value: 600, label: '600 MHz' },\n    { key: 8, value: 800, label: '800 MHz' },\n    { key: 9, value: 1000, label: '1000 MHz' },\n    { key: 10, value: 1200, label: '1200 MHz' },\n  ];\n\nconst baseURL = 'https://nmr-prediction.service.zakodium.com';\n\nexport async function predictSpectra(molfile: string): Promise<any> {\n  const molecule = OCL.Molecule.fromMolfile(molfile);\n\n  return predictAll(molecule, {\n    predictOptions: {\n      C: {\n        webserviceURL: `${baseURL}/v1/predict/carbon`,\n      },\n    },\n  });\n}\n\nexport function generateSpectra(\n  data: Record<string, any>,\n  inputOptions: PredictionOptions,\n  color: string,\n): Array<Datum1D | Datum2D> {\n  const spectra: Array<Datum1D | Datum2D> = [];\n  for (const experiment in data) {\n    if (inputOptions.spectra[experiment]) {\n      const spectrum = data[experiment];\n      switch (experiment) {\n        case 'proton':\n        case 'carbon': {\n          const datum = generated1DSpectrum({\n            spectrum,\n            inputOptions,\n            experiment,\n            color,\n          });\n          spectra.push(datum);\n\n          break;\n        }\n        case 'cosy':\n        case 'hsqc':\n        case 'hmbc': {\n          const datum = generated2DSpectrum({\n            spectrum,\n            inputOptions,\n            experiment,\n            color,\n          });\n          spectra.push(datum);\n\n          break;\n        }\n        default:\n          break;\n      }\n    }\n  }\n  return spectra;\n}\n\nfunction generated1DSpectrum(params: {\n  inputOptions: PredictionOptions;\n  spectrum: any;\n  experiment: string;\n  color: string;\n}) {\n  const { spectrum, inputOptions, experiment, color } = params;\n\n  const { signals, ranges, nucleus } = spectrum;\n\n  const {\n    name,\n    '1d': { nbPoints },\n    frequency: freq,\n  } = inputOptions;\n  const frequency = calculateFrequency(nucleus, freq);\n  const { x, y } = signalsToXY(signals, {\n    ...inputOptions['1d'][nucleus],\n    frequency,\n    nbPoints,\n  });\n  const datum = initiateDatum1D(\n    {\n      data: { x, im: null, re: y },\n      display: {\n        name,\n        color,\n      },\n      info: {\n        nucleus,\n        originFrequency: frequency,\n        baseFrequency: frequency,\n        pulseSequence: 'prediction',\n        solvent: '',\n        experiment,\n        isFt: true,\n      },\n    },\n    [],\n  );\n  datum.ranges.values = mapRanges(ranges, datum);\n  updateIntegralsRelativeValues(datum);\n  return datum;\n}\n\nfunction mapZones(zones: Array<Partial<Zone>>) {\n  return zones.reduce<Array<Zone>>((zonesAcc, zone: any) => {\n    const { signals, ...resZone } = zone;\n    const newSignals = signals.reduce(\n      (signalsAcc: Signal2D[], signal: Signal2D) => {\n        const { x, y, id, ...resSignal } = signal;\n        signalsAcc.push({\n          id: id || generateID(),\n          kind: 'signal',\n          x: { ...x, originDelta: x.delta || 0 },\n          y: { ...y, originDelta: y.delta || 0 },\n          ...resSignal,\n        });\n        return signalsAcc;\n      },\n      [],\n    );\n\n    zonesAcc.push({\n      id: generateID(),\n      ...resZone,\n      signals: newSignals,\n      kind: DatumKind.signal,\n    });\n    return zonesAcc;\n  }, []);\n}\n\nfunction generated2DSpectrum(params: {\n  inputOptions: PredictionOptions;\n  spectrum: any;\n  experiment: string;\n  color: string;\n}) {\n  const { spectrum, inputOptions, experiment, color } = params;\n  const { signals, zones, nuclei } = spectrum;\n\n  const xOption = inputOptions['1d'][nuclei[0]];\n  const yOption = inputOptions['1d'][nuclei[1]];\n\n  const width = get2DWidth(nuclei);\n  const frequency = calculateFrequency(nuclei, inputOptions.frequency);\n\n  const spectrumData = signals2DToZ(signals, {\n    from: { x: xOption.from, y: yOption.from },\n    to: { x: xOption.to, y: yOption.to },\n    nbPoints: {\n      x: inputOptions['2d'].nbPoints.x,\n      y: inputOptions['2d'].nbPoints.y,\n    },\n    width,\n    factor: 3,\n  });\n\n  const datum = initiateDatum2D(\n    {\n      data: { ...spectrumData, noise: 0.01 },\n      display: {\n        name: inputOptions.name,\n        positiveColor: color,\n        negativeColor: adjustAlpha(color, 40),\n      },\n      info: {\n        nucleus: nuclei,\n        originFrequency: frequency,\n        baseFrequency: frequency,\n        pulseSequence: experiment,\n        experiment: '2d',\n      },\n    },\n    [],\n  );\n  datum.zones.values = mapZones(zones);\n  return datum;\n}\n\nfunction get2DWidth(nucleus: string[]) {\n  return nucleus[0] === nucleus[1] ? 0.02 : { x: 0.02, y: 0.2133 };\n}\n\nfunction calculateFrequency(\n  nucleus: string | string[],\n  frequency: number,\n): number | string {\n  if (typeof nucleus === 'string') {\n    return getFrequency(nucleus, { nucleus: '1H', frequency });\n  } else {\n    if (nucleus[0] === nucleus[1]) {\n      return `${frequency},${frequency}`;\n    } else {\n      return `${frequency},${getFrequency(nucleus[1], {\n        nucleus: nucleus[0],\n        frequency,\n      })}`;\n    }\n  }\n}\n","// error colors in priority order\nconst ErrorColors: Array<{ key: string; color: string }> = [\n  { key: 'outOfLimit', color: 'red' },\n  { key: 'ambiguousAttachment', color: 'orange' },\n  { key: 'notAttached', color: 'blue' },\n  { key: 'incomplete', color: 'red' },\n];\n\nconst Errors = ErrorColors.map((errorColor) => errorColor.key);\n\nconst Hybridizations: Array<{ key: string; label: string; value: string }> = [\n  {\n    key: '-',\n    label: '',\n    value: '',\n  },\n  {\n    key: 'sp',\n    label: 'sp',\n    value: 'SP',\n  },\n  {\n    key: 'sp2',\n    label: 'sp2',\n    value: 'SP2',\n  },\n  {\n    key: 'sp3',\n    label: 'sp3',\n    value: 'SP3',\n  },\n];\n\nconst DefaultTolerance = {\n  C: 0.25,\n  H: 0.02,\n  N: 0.25,\n  F: 0.25,\n  Si: 0.25,\n  P: 0.25,\n};\n\nexport { DefaultTolerance, Errors, ErrorColors, Hybridizations };\n","import * as Filters from '../../data/Filters';\n\ninterface OptionItem {\n  id: string;\n  label: string;\n  hasOptionPanel: boolean;\n  isFilter: boolean;\n}\n\ntype RecordOptions = Record<\n  | 'zoom'\n  | 'peakPicking'\n  | 'integral'\n  | 'zone2D'\n  | 'slicingTool'\n  | 'HMove'\n  | 'equalizerTool'\n  | 'rangesPicking'\n  | 'zeroFilling'\n  | 'phaseCorrection'\n  | 'baseLineCorrection'\n  | 'generalSelector'\n  | 'editRange'\n  | 'multipleSpectraAnalysis'\n  | 'exclusionZones'\n  | 'databaseRangesSelection',\n  OptionItem\n>;\n\nexport const options: RecordOptions = {\n  zoom: {\n    id: 'zoom',\n    label: 'Zoom',\n    hasOptionPanel: false,\n    isFilter: false,\n  },\n  peakPicking: {\n    id: 'peakPicking',\n    label: 'Peaks Picking',\n    hasOptionPanel: true,\n    isFilter: false,\n  },\n  integral: {\n    id: 'integral',\n    label: 'integral Tool',\n    hasOptionPanel: false,\n    isFilter: false,\n  },\n  zone2D: {\n    id: 'zone2D',\n    label: 'Zone Tool',\n    hasOptionPanel: true,\n    isFilter: false,\n  },\n  slicingTool: {\n    id: 'slicingTool',\n    label: 'Slicing Tool',\n    hasOptionPanel: false,\n    isFilter: false,\n  },\n  HMove: {\n    id: 'HMove',\n    label: 'Move spectrum horizontally',\n    hasOptionPanel: false,\n    isFilter: false,\n  },\n  equalizerTool: {\n    id: 'equalizerTool',\n    label: 'Equalizer Tool',\n    hasOptionPanel: false,\n    isFilter: false,\n  },\n  rangesPicking: {\n    id: 'rangesPicking',\n    label: 'Ranges Picking',\n    hasOptionPanel: true,\n    isFilter: false,\n  },\n  zeroFilling: {\n    id: Filters.zeroFilling.id,\n    label: Filters.zeroFilling.name,\n    hasOptionPanel: true,\n    isFilter: true,\n  },\n  phaseCorrection: {\n    id: Filters.phaseCorrection.id,\n    label: Filters.phaseCorrection.name,\n    hasOptionPanel: true,\n    isFilter: true,\n  },\n  baseLineCorrection: {\n    id: 'baseLineCorrection',\n    label: 'baseline correction',\n    hasOptionPanel: true,\n    isFilter: true,\n  },\n  generalSelector: {\n    id: 'generalSelector',\n    label: 'range general selector',\n    hasOptionPanel: false,\n    isFilter: false,\n  },\n\n  editRange: {\n    id: 'editRange',\n    label: 'edit range',\n    hasOptionPanel: false,\n    isFilter: false,\n  },\n\n  multipleSpectraAnalysis: {\n    id: 'multipleSpectraAnalysis',\n    label: 'Multiple Spectra Analysis',\n    hasOptionPanel: false,\n    isFilter: false,\n  },\n  exclusionZones: {\n    id: 'exclusionZones',\n    label: 'Exclusion Zones',\n    hasOptionPanel: false,\n    isFilter: false,\n  },\n  databaseRangesSelection: {\n    id: 'databaseRangesSelection',\n    label: 'Filter Database',\n    hasOptionPanel: false,\n    isFilter: false,\n  },\n};\n","import { mapRanges } from '../../../../data/data1d/Spectrum1D';\n\nexport function addRanges(signals, datum) {\n  let ranges: Array<any> = [];\n  const { baseFrequency: frequency = 500 } = datum;\n  for (const signal of signals) {\n    const {\n      jCoupling: js,\n      delta,\n      diaIDs = [],\n      multiplicity,\n      integration,\n    } = signal;\n    const fromTo = computeFromTo({ delta, js, frequency });\n    if (js && multiplicity) {\n      if (js.length === multiplicity.length) {\n        js.sort((a, b) => b - a);\n        for (let i = 0; i < js.length; i++) {\n          js[i].multiplicity = multiplicity[i];\n        }\n      }\n    }\n\n    ranges.push({\n      ...fromTo,\n      integration,\n      signals: [\n        {\n          js,\n          delta,\n          diaIDs,\n          multiplicity,\n        },\n      ],\n    });\n  }\n  datum.ranges.values = mapRanges(joinRanges(ranges), datum);\n}\n\ninterface ComputeFromToOptions {\n  delta?: any;\n  js?: any;\n  couplings?: Array<any>;\n  frequency?: any;\n}\n\nfunction computeFromTo(options: ComputeFromToOptions = {}) {\n  const { delta, js: couplings = [], frequency } = options;\n  let width = 0.5;\n  for (let j of couplings) {\n    width += j.coupling;\n  }\n  width /= frequency;\n  return { from: delta - width, to: delta + width };\n}\n\nfunction joinRanges(ranges) {\n  ranges.sort((a, b) => a.from - b.from);\n  for (let i = 0; i < ranges.length - 1; i++) {\n    if (ranges[i].to > ranges[i + 1].from) {\n      ranges[i].to = Math.max(ranges[i + 1].to, ranges[i].to);\n      ranges[i].signals = ranges[i].signals.concat(ranges[i + 1].signals);\n      ranges[i].integration += ranges[i + 1].integration;\n      ranges.splice(i + 1, 1);\n      i--;\n    }\n  }\n  return ranges;\n}\n","import { getShift } from '../../../../data/data2d/Spectrum2D';\nimport generateID from '../../../../data/utilities/generateID';\n\nconst axisLabels = ['y', 'x'];\n\nexport function addZones(signals, datum) {\n  let zones: Array<any> = [];\n  const shift = getShift(datum);\n  const { baseFrequency } = datum.info;\n  const frequency = { x: baseFrequency[0], y: baseFrequency[1] };\n\n  for (const signal of signals) {\n    let zone = { x: {}, y: {}, id: generateID(), kind: 'signal' };\n    let signalFormated = { id: generateID(), kind: 'signal', peaks: [] };\n    let width = { x: 10, y: 10 };\n    for (let axis of axisLabels) {\n      let { coupling = [], delta, diaIDs = [] } = signal[axis];\n      for (let j of coupling) {\n        width[axis] += j.coupling;\n      }\n      if (signal.activeCoupling) {\n        const { activeCoupling = [] } = signal;\n        for (let j of activeCoupling) {\n          width[axis] += j.coupling;\n        }\n      }\n      width[axis] /= frequency[axis];\n\n      zone[axis] = {\n        from: delta - width[axis],\n        to: delta + width[axis],\n      };\n\n      signalFormated[axis] = {\n        delta,\n        diaIDs,\n        originDelta: delta - shift[`${axis}Shift`],\n      };\n    }\n    zones.push({\n      ...zone,\n      signals: [signalFormated],\n    });\n  }\n  datum.zones.values = zones;\n}\n","import Jszip from 'jszip';\nimport { NmrRecord, parseSDF } from 'nmredata';\n\nimport { addBruker, addJcamps } from '../../data/SpectraManager';\n\nimport { addRanges } from './util/nmredata/addRanges';\nimport { addZones } from './util/nmredata/addZones';\n\nexport async function nmredataToNmrium(file, usedColors) {\n  const jszip = new Jszip();\n  const zip = await jszip.loadAsync(file.binary);\n  const sdfFiles = await getSDF(zip.files);\n  const jsonData = await NmrRecord.toJSON({\n    sdf: sdfFiles[0],\n    zipFiles: zip.files,\n  });\n\n  let { spectra, molecules = [] } = jsonData;\n\n  let nmrium: { spectra: any[]; molecules: any[] } = {\n    spectra: [],\n    molecules,\n  };\n\n  for (const data of spectra) {\n    const { file, jcampURL } = data.source;\n\n    let spectrum = (await getSpectra(file, { jcampURL }, usedColors)) || [];\n\n    for (const spectrumData of spectrum) {\n      const { info } = spectrumData;\n\n      if (info.isFid) continue;\n\n      if (info.dimension > 1) {\n        addZones(data.signals, spectrumData);\n      } else {\n        addRanges(data.signals, spectrumData);\n      }\n    }\n\n    nmrium.spectra.push(...spectrum);\n  }\n\n  return nmrium;\n}\n\ninterface GetSpectraOptions {\n  xy?: boolean;\n  noContours?: boolean;\n  keepOriginal?: boolean;\n  jcampURL?: string;\n}\n\nasync function getSpectra(\n  file,\n  options: GetSpectraOptions = {},\n  usedColors = {},\n) {\n  const {\n    xy = true,\n    noContours = true,\n    keepOriginal = true,\n    jcampURL,\n  } = options;\n  switch (file.extension) {\n    case 'jdx':\n    case 'dx':\n      return addJcamps([file], usedColors);\n    case 'zip':\n      return addBruker(\n        { xy, noContours, keepOriginal },\n        file.binary,\n        usedColors,\n      );\n    default:\n      if (!jcampURL) {\n        new Error('file extension is not supported');\n        return;\n      }\n  }\n}\n\nasync function getSDF(zipFiles) {\n  let result: any[] = [];\n  for (const file in zipFiles) {\n    const pathFile = file.split('/');\n    if (/^[^.].+sdf$/.exec(pathFile[pathFile.length - 1])) {\n      const filename = pathFile[pathFile.length - 1].replace(/\\.sdf/, '');\n      const root = pathFile.slice(0, pathFile.length - 1).join('/');\n      const sdf = await zipFiles[file].async('string');\n      let parserResult = parseSDF(`${sdf}`, { mixedEOL: true });\n      parserResult.filename = filename;\n      parserResult.root = root !== '' ? `${root}/` : '';\n      result.push(parserResult);\n    }\n  }\n  return result;\n}\n","import { Draft } from 'immer';\nimport { SpectraData1D, SpectraData2D } from 'nmr-processing';\n\nimport { Datum1D, Range } from '../../../data/types/data1d';\nimport { Datum2D, Zone } from '../../../data/types/data2d';\nimport { State } from '../Reducer';\n\nfunction setAutomaticAssignmentsHandler(\n  draft: Draft<State>,\n  action: { payload: { assignments: (SpectraData1D | SpectraData2D)[] } },\n) {\n  const assignments = action.payload.assignments;\n\n  for (let datum of assignments) {\n    const index = draft.data.findIndex((spectrum) => spectrum.id === datum.id);\n    if (index !== -1) {\n      const dimension = draft.data[index].info.dimension;\n      if (dimension === 1) {\n        (draft.data[index] as Datum1D).ranges.values = (datum as SpectraData1D)\n          .ranges as Range[];\n      } else if (dimension === 2) {\n        (draft.data[index] as Datum2D).zones.values = (datum as SpectraData2D)\n          .zones as Zone[];\n      }\n    }\n  }\n}\n\nexport { setAutomaticAssignmentsHandler };\n","import { Spectra } from '../../component/NMRium';\nimport { Datum1D, Range, Signal1D } from '../types/data1d';\nimport { Datum2D, Signal2D, Zone } from '../types/data2d';\n\nfunction findSpectrum(\n  spectraData: Spectra,\n  spectrumID: string,\n  checkIsVisible: boolean,\n): Datum1D | Datum2D | undefined {\n  const spectrum = spectraData.find((_spectrum) => _spectrum.id === spectrumID);\n  if (\n    spectrum &&\n    checkIsVisible === true &&\n    spectrum.display.isVisible === false\n  ) {\n    return undefined;\n  }\n\n  return spectrum;\n}\n\nfunction findSignal1D(\n  spectrum: Datum1D,\n  signalID: string,\n): Signal1D | undefined {\n  for (let range of spectrum.ranges.values) {\n    const signalIndex = range.signals.findIndex(\n      (_signal) => _signal.id === signalID,\n    );\n    if (signalIndex >= 0) {\n      return range.signals[signalIndex];\n    }\n  }\n}\n\nfunction findSignal2D(\n  spectrum: Datum2D,\n  signalID: string,\n): Signal2D | undefined {\n  for (let zone of spectrum.zones.values) {\n    const signalIndex = zone.signals.findIndex(\n      (_signal) => _signal.id === signalID,\n    );\n    if (signalIndex >= 0) {\n      return zone.signals[signalIndex];\n    }\n  }\n}\n\nfunction findRange(spectrum: Datum1D, signalID: string): Range | undefined {\n  for (let range of spectrum.ranges.values) {\n    const signalIndex = range.signals.findIndex(\n      (_signal) => _signal.id === signalID,\n    );\n    if (signalIndex >= 0) {\n      return range;\n    }\n  }\n}\n\nfunction findZone(spectrum: Datum2D, signalID: string): Zone | undefined {\n  for (let zone of spectrum.zones.values) {\n    const signalIndex = zone.signals.findIndex(\n      (_signal) => _signal.id === signalID,\n    );\n    if (signalIndex >= 0) {\n      return zone;\n    }\n  }\n}\n\nfunction findRangeOrZoneID(\n  spectraData: Spectra,\n  experimentID: string,\n  signalID: string,\n  checkIsVisible: boolean,\n) {\n  const spectrum = findSpectrum(spectraData, experimentID, checkIsVisible);\n  if (spectrum) {\n    if (spectrum.info.dimension === 1) {\n      const range = findRange(spectrum as Datum1D, signalID);\n      if (range) return range.id;\n    } else if (spectrum.info.dimension === 2) {\n      const zone = findZone(spectrum as Datum2D, signalID);\n      if (zone) return zone.id;\n    }\n  }\n}\n\nexport {\n  findRange,\n  findRangeOrZoneID,\n  findSignal1D,\n  findSignal2D,\n  findSpectrum,\n  findZone,\n};\n","import { scaleLinear, zoomIdentity } from 'd3';\n\nfunction getXScale(state, spectrumId: number | null | string = null) {\n  const { width, margin, xDomains, xDomain, mode } = state;\n  const range =\n    mode === 'RTL'\n      ? [width - margin.right, margin.left]\n      : [margin.left, width - margin.right];\n  return scaleLinear(spectrumId ? xDomains[spectrumId] : xDomain, range);\n}\n\nfunction getYScale(state, spectrumId: number | null | string = null) {\n  const { height, margin, verticalAlign, yDomain, yDomains } = state;\n  const _height =\n    verticalAlign.align === 'center'\n      ? (height - 30) / 2\n      : height - margin.bottom - 30;\n  let domainY: [number, number] | [] = [];\n  if (spectrumId === null || yDomains[spectrumId] === undefined) {\n    domainY = [0, yDomain[1]];\n  } else {\n    domainY = [0, yDomains[spectrumId][1]];\n  }\n  return scaleLinear(domainY, [_height, margin.top]);\n}\n\nfunction getIntegralYScale(state) {\n  const { height, margin, verticalAlign, integralsYDomains, activeSpectrum } =\n    state;\n  const _height = verticalAlign.align === 'center' ? height / 2 : height;\n  return scaleLinear(\n    activeSpectrum?.id &&\n      integralsYDomains &&\n      integralsYDomains[activeSpectrum?.id]\n      ? integralsYDomains[activeSpectrum?.id]\n      : [0, 0],\n    [_height * 0.3, margin.top + _height * 0.1],\n  );\n}\n\nfunction reScaleY(scale: number, { domain, height, margin }) {\n  const _scale = scaleLinear(domain, [height - margin.bottom, margin.top]);\n\n  const t = zoomIdentity\n    .translate(0, _scale(0))\n    .scale(scale)\n    .translate(0, -_scale(0));\n\n  return t.rescaleY(_scale).domain();\n}\n\nexport { getXScale, getYScale, getIntegralYScale, reScaleY };\n","import { getXScale } from '../../1d/utilities/scale';\n\ninterface RangeOptions {\n  startX: number;\n  endX: number;\n}\n\nexport default function getRange(\n  draft,\n  options: RangeOptions,\n): [number, number] {\n  const { startX, endX } = options;\n  const scaleX = getXScale(draft);\n\n  const start = scaleX.invert(startX);\n  const end = scaleX.invert(endX);\n  const range: [number, number] = [0, 0];\n  if (start > end) {\n    range[0] = end;\n    range[1] = start;\n  } else {\n    range[0] = start;\n    range[1] = end;\n  }\n  return range;\n}\n","export default function nucleusToString(nucleus) {\n  return typeof nucleus === 'string' ? nucleus : nucleus.join(',');\n}\n","import { extent } from 'd3';\nimport { Draft } from 'immer';\n\nimport { get1DDataXY } from '../../../data/data1d/Spectrum1D/get1DDataXY';\nimport { isSpectrum2D } from '../../../data/data2d/Spectrum2D';\nimport { Datum1D } from '../../../data/types/data1d';\nimport { Datum2D } from '../../../data/types/data2d';\nimport nucleusToString from '../../utility/nucleusToString';\nimport { State } from '../Reducer';\nimport { DISPLAYER_MODE } from '../core/Constants';\n\nfunction getActiveData(draft: Draft<State>): Array<Datum1D> {\n  let data = draft.data.filter(\n    (datum) =>\n      nucleusToString(datum.info.nucleus) === draft.activeTab &&\n      datum.info.dimension === 1,\n  );\n\n  if (draft.activeSpectrum) {\n    const activeSpectrumIndex = data.findIndex(\n      (datum) => datum.id === draft.activeSpectrum?.id,\n    );\n    if (activeSpectrumIndex !== -1) {\n      const isFid = data[activeSpectrumIndex].info.isFid || false;\n      data = data.filter((datum) => datum.info.isFid === isFid);\n    }\n  } else {\n    data = data.filter((datum) => datum.info.isFid === false);\n  }\n\n  return data as Array<Datum1D>;\n}\n\nfunction getDomain(drfat: Draft<State>) {\n  let xArray: Array<number> = [];\n  let yArray: Array<number> = [];\n  let yDomains = {};\n  let xDomains = {};\n\n  const data = getActiveData(drfat);\n  try {\n    xArray = data.reduce<Array<number>>((acc, d: Datum1D) => {\n      const { display, data } = d;\n      const domain = [data.x[0], data.x[data.x.length - 1]];\n      xDomains[d.id] = domain;\n      if (display.isVisible) {\n        acc = acc.concat(domain);\n      }\n      return acc;\n    }, []);\n\n    yArray = data.reduce<Array<number>>((acc, d: Datum1D) => {\n      const { display } = d;\n      const data = get1DDataXY(d);\n\n      const _extent = extent(data.y) as Array<number>;\n      yDomains[d.id] = _extent;\n\n      if (display.isVisible) {\n        acc = acc.concat(_extent);\n      }\n      return acc;\n    }, []);\n  } catch (e) {\n    // eslint-disable-next-line no-console\n    console.log(e);\n  }\n\n  return {\n    xDomain: extent(xArray),\n    yDomain: extent(yArray),\n    yDomains,\n    xDomains,\n  };\n}\nfunction get2DDomain(state) {\n  let xArray = [];\n  let yArray = [];\n  let yDomains = {};\n  let xDomains = {};\n\n  const { activeTab, tabActiveSpectrum, data } = state;\n\n  const nucleus = activeTab.split(',');\n\n  try {\n    xArray = data.reduce((acc, datum: Datum1D | Datum2D) => {\n      if (\n        isSpectrum2D(datum) &&\n        datum.info.nucleus?.join(',') === activeTab &&\n        datum.info.isFt\n      ) {\n        acc = acc.concat([datum.data.minX, datum.data.maxX]);\n      }\n      return acc;\n    }, []);\n\n    yArray = data.reduce((acc, datum: Datum1D | Datum2D) => {\n      if (\n        isSpectrum2D(datum) &&\n        datum.info.nucleus?.join(',') === activeTab &&\n        datum.info.isFt\n      ) {\n        acc = acc.concat([datum.data.minY, datum.data.maxY]);\n      }\n      return acc;\n    }, []);\n  } catch (e) {\n    // eslint-disable-next-line no-console\n    console.log(e);\n  }\n\n  const spectrumsIDs = nucleus.map((n) => tabActiveSpectrum[n]?.id);\n\n  const filteredData = data.reduce((acc, datum: Datum1D | Datum2D) => {\n    return spectrumsIDs.includes(datum.id) && datum.info.dimension === 1\n      ? acc.concat(datum)\n      : acc.concat([]);\n  }, []);\n  try {\n    xDomains = filteredData.reduce((acc, d: Datum1D) => {\n      const { x } = d.data;\n      const domain = [x[0], x[x.length - 1]];\n      acc[d.id] = domain;\n      return acc;\n    }, {});\n\n    yDomains = filteredData.reduce((acc, d: Datum1D) => {\n      const _extent = extent(d.data.re);\n      acc[d.id] = _extent;\n      return acc;\n    }, {});\n  } catch (e) {\n    // eslint-disable-next-line no-console\n    console.log(e);\n  }\n\n  return {\n    xDomain: extent(xArray),\n    yDomain: extent(yArray),\n    yDomains,\n    xDomains,\n  };\n}\n\nexport interface SetDomainOptions {\n  yDomain?: {\n    isChanged?: boolean;\n    isShared?: boolean;\n  };\n}\n\nfunction setDomain(draft: Draft<State>, options?: SetDomainOptions) {\n  const { yDomain = { isChanged: true, isShared: true } } = options || {};\n  let domain;\n\n  if (draft.activeTab) {\n    if (draft.displayerMode === DISPLAYER_MODE.DM_1D) {\n      domain = getDomain(draft);\n    } else {\n      domain = get2DDomain(draft);\n    }\n    draft.xDomain = domain.xDomain;\n    draft.xDomains = domain.xDomains;\n    draft.originDomain = domain;\n\n    if (yDomain.isChanged) {\n      draft.yDomain = domain.yDomain;\n      if (draft.displayerMode === DISPLAYER_MODE.DM_1D && yDomain.isShared) {\n        draft.yDomains = Object.keys(domain.yDomains).reduce((acc, key) => {\n          acc[key] = domain.yDomain;\n          return acc;\n        }, {});\n      } else {\n        draft.yDomains = domain.yDomains;\n      }\n    } else {\n      draft.originDomain = {\n        ...draft.originDomain,\n        xDomain: domain.xDomain,\n        xDomains: domain.xDomains,\n      };\n    }\n  }\n}\n\nfunction getSpectrumIntegralsDomain(datum: Datum1D) {\n  const { integrals, ranges } = datum;\n  let max = Number.NEGATIVE_INFINITY;\n  for (const integral of integrals.values) {\n    max = Math.max(max, integral.absolute);\n  }\n  for (const range of ranges.values) {\n    max = Math.max(max, range.absolute);\n  }\n  return [0, max];\n}\nfunction setIntegralsYDomain(draft: Draft<State>, data: Datum1D[] | Datum1D) {\n  for (const spectrum of Array.isArray(data) ? data : [data]) {\n    if (spectrum?.info?.dimension === 1) {\n      draft.integralsYDomains[spectrum.id] =\n        getSpectrumIntegralsDomain(spectrum);\n    }\n  }\n}\n\nfunction setOriginalDomain(draft: Draft<State>, originDomain) {\n  draft.originDomain = originDomain;\n}\n\nfunction setXDomain(draft: Draft<State>, xDomain) {\n  draft.xDomain = xDomain;\n}\n\nfunction setYDomain(draft: Draft<State>, yDomain) {\n  draft.yDomain = yDomain;\n}\n\nfunction handelResetDomain(draft: Draft<State>) {\n  const { xDomain, yDomain, xDomains, yDomains } = draft.originDomain;\n  draft.xDomain = xDomain;\n  draft.yDomain = yDomain;\n  draft.xDomains = xDomains;\n  draft.yDomains = yDomains;\n}\n\nfunction setMode(draft: Draft<State>) {\n  const data = draft.data.filter(\n    (datum) =>\n      draft.xDomains[datum.id] &&\n      nucleusToString(datum.info.nucleus) === draft.activeTab,\n  );\n  draft.mode = (data[0] as Datum1D)?.info.isFid ? 'LTR' : 'RTL';\n}\n\nexport {\n  getDomain,\n  setOriginalDomain,\n  setXDomain,\n  setYDomain,\n  handelResetDomain,\n  setDomain,\n  setMode,\n  setIntegralsYDomain,\n};\n","import { Draft, original } from 'immer';\nimport cloneDeep from 'lodash/cloneDeep';\nimport { xFindClosestIndex } from 'ml-spectra-processing';\n\nimport * as Filters from '../../../data/Filters';\nimport * as FiltersManager from '../../../data/FiltersManager';\nimport {\n  DatumKind,\n  SignalKindsToInclude,\n} from '../../../data/constants/SignalsKinds';\nimport {\n  addRange,\n  changeRangeSignal,\n  detectRanges,\n  updateRangesRelativeValues,\n  changeRange,\n  changeRangeRelativeValue,\n  updateXShift,\n} from '../../../data/data1d/Spectrum1D';\nimport { setSumOptions } from '../../../data/data1d/Spectrum1D/SumManager';\nimport { Datum1D } from '../../../data/types/data1d';\nimport {\n  unlink,\n  unlinkInAssignmentData,\n} from '../../../data/utilities/RangeUtilities';\nimport { State } from '../Reducer';\nimport getRange from '../helper/getRange';\n\nimport { handleUpdateCorrelations } from './CorrelationsActions';\nimport { setDomain, setIntegralsYDomain } from './DomainActions';\n\nfunction handleAutoRangesDetection(draft: Draft<State>, options) {\n  const {\n    activeSpectrum,\n    data,\n    xDomain,\n    molecules,\n    activeTab: nucleus,\n  } = draft;\n  if (activeSpectrum?.id) {\n    const { index } = activeSpectrum;\n    const datum = data[index] as Datum1D;\n\n    const [from, to] = xDomain;\n    const windowFromIndex = xFindClosestIndex(datum.data.x, from);\n    const windowToIndex = xFindClosestIndex(datum.data.x, to);\n\n    const detectionOptions = {\n      factorStd: 8,\n      integrationSum: 100,\n      compile: true,\n      frequencyCluster: 16,\n      clean: true,\n      keepPeaks: true,\n      ...options, // minMaxRatio default 0.05, lookNegative default false,\n    };\n\n    detectRanges(datum, {\n      ...detectionOptions,\n      windowFromIndex,\n      windowToIndex,\n      molecules,\n      nucleus,\n    });\n    handleOnChangeRangesData(draft);\n    setIntegralsYDomain(draft, datum);\n  }\n}\n\nfunction handleAutoSpectraRangesDetection(draft: Draft<State>) {\n  const peakPicking = {\n    factorStd: 8,\n    minMaxRatio: 0.05,\n    integrationSum: 100,\n    compile: true,\n    frequencyCluster: 16,\n    clean: true,\n    keepPeaks: true,\n  };\n  const { data, activeTab: nucleus, molecules } = draft;\n  for (const datum of data) {\n    if (datum.info.dimension === 1) {\n      detectRanges(datum as Datum1D, { peakPicking, molecules, nucleus });\n      handleOnChangeRangesData(draft);\n    }\n  }\n}\n\nfunction getRangeIndex(draft: Draft<State>, spectrumIndex, rangeID) {\n  return (draft.data[spectrumIndex] as Datum1D).ranges.values.findIndex(\n    (range) => range.id === rangeID,\n  );\n}\n\nfunction handleDeleteRange(draft: Draft<State>, action) {\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n    const { id = null, assignmentData } = action.payload.data;\n    const datum = draft.data[index] as Datum1D;\n    if (id) {\n      const rangeIndex = getRangeIndex(draft, index, id);\n      unlinkInAssignmentData(assignmentData, [datum.ranges.values[rangeIndex]]);\n      datum.ranges.values.splice(rangeIndex, 1);\n    } else {\n      unlinkInAssignmentData(assignmentData, datum.ranges.values);\n      datum.ranges.values = [];\n    }\n    updateRangesRelativeValues(datum);\n    handleOnChangeRangesData(draft);\n  }\n}\n\nfunction handleChangeRangeSignalKind(draft: Draft<State>, action) {\n  const state = original(draft) as State;\n  if (state.activeSpectrum?.id) {\n    const { index } = state.activeSpectrum;\n    const { rowData, value } = action.payload.data;\n    const rangeIndex = getRangeIndex(state, index, rowData.id);\n    const _range = (draft.data[index] as Datum1D).ranges.values[rangeIndex];\n    if (_range?.signals) {\n      _range.signals[rowData.tableMetaInfo.signalIndex].kind = value;\n      _range.kind = SignalKindsToInclude.includes(value)\n        ? DatumKind.signal\n        : DatumKind.mixed;\n      updateRangesRelativeValues(draft.data[index] as Datum1D);\n      handleOnChangeRangesData(draft);\n    }\n  }\n}\n\nfunction handleSaveEditedRange(draft: Draft<State>, action) {\n  const state = original(draft) as State;\n  if (state.activeSpectrum?.id) {\n    const { index } = state.activeSpectrum;\n    const { editedRowData, assignmentData } = action.payload;\n\n    // reset temp range\n    draft.toolOptions.data.tempRange = null;\n\n    // remove assignments in global state\n\n    const _editedRowData: any = unlink(editedRowData);\n\n    delete _editedRowData.tableMetaInfo;\n    delete _editedRowData.rowKey;\n    // remove assignments in assignment hook data\n    // for now: clear all assignments for this range because signals or levels to store might have changed\n    unlinkInAssignmentData(assignmentData, [_editedRowData]);\n    const rangeIndex = getRangeIndex(state, index, _editedRowData.id);\n    (draft.data[index] as Datum1D).ranges.values[rangeIndex] = _editedRowData;\n    updateRangesRelativeValues(draft.data[index] as Datum1D);\n    handleOnChangeRangesData(draft);\n  }\n}\n\nfunction handleDeleteSignal(draft: Draft<State>, action) {\n  const {\n    spectrum,\n    range,\n    signal,\n    assignmentData,\n    unlinkSignalInAssignmentData = true,\n  } = action.payload;\n\n  if (spectrum && range) {\n    const datum1D = draft.data.find(\n      (datum) => datum.id === spectrum.id,\n    ) as Datum1D;\n    const rangeIndex = datum1D.ranges.values.findIndex(\n      (_range) => _range.id === range.id,\n    );\n    const signalIndex = range.signals.findIndex(\n      (_signal) => _signal.id === signal.id,\n    );\n    // remove assignments for the signal range object in global state\n    const _range = unlink(cloneDeep(range), 'signal', { signalIndex });\n    if (unlinkSignalInAssignmentData === true) {\n      unlinkInAssignmentData(assignmentData, [{ signals: [signal] }]);\n    }\n    _range.signals.splice(signalIndex, 1);\n    datum1D.ranges.values[rangeIndex] = _range;\n    // if no signals are existing in a range anymore then delete this range\n    if (_range.signals.length === 0) {\n      unlinkInAssignmentData(assignmentData, [_range]);\n      datum1D.ranges.values.splice(rangeIndex, 1);\n    }\n\n    handleOnChangeRangesData(draft);\n  }\n}\n\nfunction handleUnlinkRange(draft: Draft<State>, action) {\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n    const {\n      assignmentData,\n      rangeData = null,\n      signalIndex = -1,\n    } = action.payload;\n\n    // remove assignments in global state\n    if (rangeData) {\n      const rangeIndex = getRangeIndex(draft, index, rangeData.id);\n      const range = cloneDeep(\n        (draft.data[index] as Datum1D).ranges.values[rangeIndex],\n      );\n\n      let newRange: any = {};\n      let id = rangeData.id;\n      if (rangeData && signalIndex === -1) {\n        newRange = unlink(range, 'range');\n      } else {\n        newRange = unlink(range, 'signal', { signalIndex });\n        id = rangeData.signals[signalIndex].id;\n      }\n      // remove assignments in assignment hook data\n      unlinkInAssignmentData(assignmentData, [\n        {\n          id,\n        },\n      ]);\n      (draft.data[index] as Datum1D).ranges.values[rangeIndex] = newRange;\n    } else {\n      const ranges = (draft.data[index] as Datum1D).ranges.values.map(\n        (range) => {\n          return unlink(range);\n        },\n      );\n      (draft.data[index] as Datum1D).ranges.values = ranges;\n\n      unlinkInAssignmentData(assignmentData, ranges);\n    }\n  }\n}\n\nfunction handleSetDiaIDRange(draft: Draft<State>, action) {\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n    const { rangeData, diaIDs, signalIndex, nbAtoms } = action.payload;\n    const getNbAtoms = (input, current = 0) => input + current;\n    const rangeIndex = getRangeIndex(draft, index, rangeData.id);\n    const _range = (draft.data[index] as Datum1D).ranges.values[rangeIndex];\n    if (signalIndex === undefined) {\n      _range.diaIDs = diaIDs;\n      _range.nbAtoms = getNbAtoms(nbAtoms, _range.nbAtoms);\n    } else {\n      _range.signals[signalIndex].diaIDs = diaIDs;\n      _range.signals[signalIndex].nbAtoms = getNbAtoms(\n        nbAtoms,\n        _range.signals[signalIndex].nbAtoms,\n      );\n    }\n    // _range.nbAtoms = getNbAtoms(_range);\n  }\n}\n\nfunction handleResizeRange(draft: Draft<State>, action) {\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n    changeRange(draft.data[index] as Datum1D, action.data);\n  }\n}\n\nfunction handleChangeRangeSum(draft: Draft<State>, options) {\n  const { data, activeSpectrum, activeTab: nucleus } = draft;\n  if (activeSpectrum?.id) {\n    const { index } = activeSpectrum;\n    const datum = data[index] as Datum1D;\n    setSumOptions(datum.ranges, { options, nucleus });\n    updateRangesRelativeValues(datum, true);\n  }\n}\n\nfunction handleAddRange(draft: Draft<State>, action) {\n  const { startX, endX } = action.payload;\n  const { activeSpectrum, activeTab: nucleus, molecules } = draft;\n  const range = getRange(draft, { startX, endX });\n\n  if (activeSpectrum?.id) {\n    const { index } = activeSpectrum;\n    const [from, to] = range;\n    addRange(draft.data[index] as Datum1D, { from, to, nucleus, molecules });\n    handleOnChangeRangesData(draft);\n    setIntegralsYDomain(draft, draft.data[index] as Datum1D);\n  }\n}\n\nfunction handleChangeRangeRelativeValue(draft, action) {\n  const data = action.payload.data;\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n    changeRangeRelativeValue(draft.data[index], data);\n  }\n}\n\nfunction handleChangeRangeSignalValue(draft, action) {\n  const { rangeID, signalID, value } = action.payload;\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n\n    const shift = changeRangeSignal(draft.data[index], {\n      rangeID,\n      signalID,\n      newSignalValue: value,\n    });\n    FiltersManager.applyFilter(draft.data[index], [\n      { name: Filters.shiftX.id, options: shift },\n    ]);\n\n    updateXShift(draft.data[index] as Datum1D);\n\n    handleOnChangeRangesData(draft);\n    setDomain(draft);\n  }\n}\n\nfunction handleOnChangeRangesData(draft) {\n  handleUpdateCorrelations(draft);\n}\n\nfunction handleChangeRangesSumFlag(draft, action) {\n  const flag = action.payload;\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n    draft.data[index].ranges.options.isSumConstant = !flag;\n  }\n}\n\nfunction handleChangeTempRange(draft: Draft<State>, action) {\n  draft.toolOptions.data.tempRange = action.payload.tempRange;\n}\n\nfunction handleShowMultiplicityTrees(draft: Draft<State>) {\n  draft.toolOptions.data.showMultiplicityTrees =\n    !draft.toolOptions.data.showMultiplicityTrees;\n}\n\nfunction handleShowRangesIntegrals(draft: Draft<State>) {\n  draft.toolOptions.data.showRangesIntegrals =\n    !draft.toolOptions.data.showRangesIntegrals;\n}\n\nfunction handleShowJGraph(draft: Draft<State>) {\n  draft.toolOptions.data.showJGraph = !draft.toolOptions.data.showJGraph;\n}\n\nexport {\n  handleAutoRangesDetection,\n  handleDeleteRange,\n  handleDeleteSignal,\n  handleChangeRangeSum,\n  handleAddRange,\n  handleResizeRange,\n  handleChangeRangeRelativeValue,\n  handleChangeRangeSignalValue,\n  handleChangeRangeSignalKind,\n  handleSaveEditedRange,\n  handleUnlinkRange,\n  handleSetDiaIDRange,\n  handleChangeRangesSumFlag,\n  handleChangeTempRange,\n  handleShowMultiplicityTrees,\n  handleShowRangesIntegrals,\n  handleAutoSpectraRangesDetection,\n  handleShowJGraph,\n};\n","import { DatumKind } from '../constants/SignalsKinds';\nimport { Zone } from '../types/data2d';\n\nexport function getDiaIDs(zone: Zone, axis: string): string[] {\n  return ([] as string[]).concat(\n    zone[axis].diaIDs || [],\n    zone.signals\n      ? zone.signals.map((signal) => signal[axis].diaIDs || []).flat()\n      : [],\n  );\n}\n\nexport function getNbAtoms(zone: Zone, axis: string) {\n  return zone.signals\n    ? zone.signals.reduce(\n        (sum, signal) =>\n          signal[axis].nbAtoms ? sum + signal[axis].nbAtoms : sum,\n        0,\n      )\n    : 0;\n}\n\nexport function setNbAtoms(zone: Zone, axis: string): void {\n  zone[axis].nbAtoms = getNbAtoms(zone, axis);\n  if (zone[axis].nbAtoms === 0) {\n    delete zone[axis].nbAtoms;\n  }\n}\n\nexport function resetDiaIDs(zone: Zone, axis: string) {\n  delete zone[axis].diaIDs;\n  delete zone[axis].nbAtoms;\n  zone.signals.forEach((signal) => {\n    delete signal[axis].diaIDs;\n    delete signal[axis].nbAtoms;\n  });\n  return zone;\n}\n\nexport function checkZoneKind(zone: Zone): boolean {\n  return zone.kind === DatumKind.signal;\n}\n\nexport function checkSignalKinds(zone: Zone, kinds: string[]): boolean {\n  return !zone.signals.some(\n    (_signal) => _signal.kind === undefined || !kinds.includes(_signal.kind),\n  );\n}\n\nexport function unlink(\n  zone: Zone,\n  isOnZoneLevel?: boolean,\n  signalIndex?: number,\n  axis?: string,\n): Zone {\n  if (isOnZoneLevel !== undefined && axis !== undefined) {\n    if (isOnZoneLevel === true) {\n      delete zone[axis].diaIDs;\n      delete zone[axis].nbAtoms;\n    } else if (\n      typeof signalIndex === 'number' &&\n      signalIndex !== -1 &&\n      zone.signals[signalIndex]\n    ) {\n      delete zone.signals[signalIndex][axis].diaIDs;\n      delete zone.signals[signalIndex][axis].nbAtoms;\n    }\n    setNbAtoms(zone, axis);\n  } else if (axis !== undefined) {\n    resetDiaIDs(zone, axis);\n    setNbAtoms(zone, axis);\n  } else {\n    ['x', 'y'].forEach((key) => {\n      resetDiaIDs(zone, key);\n      setNbAtoms(zone, key);\n    });\n  }\n  return zone;\n}\n\nexport function unlinkInAssignmentData(\n  assignmentData,\n  zones: Partial<Zone>[],\n  axis?: string,\n): void {\n  const ids = zones.reduce((acc: string[], zone) => {\n    if (zone.id) {\n      acc.push(zone.id);\n    }\n    if (zone.signals) {\n      acc = acc.concat(zone.signals.map((signal) => signal.id, []));\n    }\n    return acc;\n  }, []);\n\n  if (axis) {\n    assignmentData.dispatch({\n      type: 'REMOVE_ALL',\n      payload: { id: ids, axis },\n    });\n  } else {\n    assignmentData.dispatch({\n      type: 'REMOVE_ALL',\n      payload: { id: ids, axis: 'x' },\n    });\n    assignmentData.dispatch({\n      type: 'REMOVE_ALL',\n      payload: { id: ids, axis: 'y' },\n    });\n  }\n}\n","const LAYOUT = {\n  TOP_1D: 'TOP_1D',\n  LEFT_1D: 'LEFT_1D',\n  CENTER_2D: 'CENTER_2D',\n};\n\ninterface MarginProps {\n  top: number;\n  left: number;\n  right: number;\n  bottom: number;\n}\n\nfunction get2DDimensionLayout({\n  width,\n  height,\n  margin,\n}: {\n  width: number;\n  height: number;\n  margin: MarginProps;\n}) {\n  return {\n    CENTER_2D: {\n      startX: margin.left,\n      startY: margin.top,\n      endX: width - margin.right,\n      endY: height - margin.bottom,\n    },\n    TOP_1D: {\n      startX: margin.left,\n      startY: 0,\n      endX: width - margin.right,\n      endY: margin.top,\n    },\n    LEFT_1D: {\n      startX: 0,\n      startY: margin.top,\n      endX: margin.left,\n      endY: height - margin.bottom,\n    },\n  };\n}\n\ninterface StartEndProps {\n  startX: number;\n  endX?: number;\n  startY: number;\n  endY?: number;\n}\n\ninterface DimensionType {\n  CENTER_2D: {\n    startX: number;\n    startY: number;\n    endX: number;\n    endY: number;\n  };\n  TOP_1D: {\n    startX: number;\n    startY: number;\n    endX: number;\n    endY: number;\n  };\n  LEFT_1D: {\n    startX: number;\n    startY: number;\n    endX: number;\n    endY: number;\n  };\n}\n\nfunction getLayoutID(dimension: DimensionType, brushData: StartEndProps) {\n  for (const key of Object.keys(dimension)) {\n    if (\n      brushData.startX >= dimension[key].startX &&\n      brushData.startX <= dimension[key].endX &&\n      brushData.startY >= dimension[key].startY &&\n      brushData.startY <= dimension[key].endY\n    ) {\n      return key;\n    }\n  }\n  return null;\n}\n\nexport { LAYOUT, get2DDimensionLayout, getLayoutID };\n","import { scaleLinear } from 'd3';\n\nimport { LAYOUT } from './DimensionLayout';\n\nfunction get2DXScale(props: {\n  width: number;\n  margin: { right: number; left: number };\n  xDomain: Array<number>;\n}) {\n  const { width, margin, xDomain } = props;\n  return scaleLinear(xDomain, [width - margin.right, margin.left]);\n}\n\nfunction get2DYScale(\n  props: {\n    height: number;\n    margin: { bottom: number; top: number };\n    yDomain: Array<number>;\n  },\n  reverse = false,\n) {\n  const { height, margin, yDomain } = props;\n  return scaleLinear(\n    yDomain,\n    reverse\n      ? [height - margin.bottom, margin.top]\n      : [margin.top, height - margin.bottom],\n  );\n}\n\ninterface TopLayout {\n  width: number;\n  margin: { right: number; left: number };\n  xDomain: Array<number>;\n}\n\ninterface LeftLayout {\n  height: number;\n  margin: { bottom: number; top: number };\n  yDomain: Array<number>;\n}\n\nfunction get1DXScale(props: TopLayout | LeftLayout, layout: string) {\n  if (![LAYOUT.TOP_1D, LAYOUT.LEFT_1D].includes(layout)) {\n    throw new Error(\n      `layout is required and must be ${LAYOUT.TOP_1D} or ${LAYOUT.LEFT_1D}  `,\n    );\n  }\n\n  switch (layout) {\n    case LAYOUT.TOP_1D: {\n      const { width, margin, xDomain } = props as TopLayout;\n      return scaleLinear(xDomain, [width - margin.right, margin.left]);\n    }\n    case LAYOUT.LEFT_1D: {\n      const { height, margin, yDomain } = props as LeftLayout;\n      return scaleLinear(yDomain, [height - margin.bottom, margin.top]);\n    }\n    default:\n      break;\n  }\n}\n\nfunction get1DYScale(yDomain: Array<number>, height: number, margin = 10) {\n  return scaleLinear(yDomain, [height - margin, margin]);\n}\n\nexport { get2DXScale, get2DYScale, get1DXScale, get1DYScale };\n","import { get2DXScale, get2DYScale } from '../../2d/utilities/scale';\n\nexport default function get2DRange(draft, options) {\n  const { startX, startY, endX, endY } = options;\n  const scaleX = get2DXScale(draft);\n  const scaleY = get2DYScale(draft);\n  const x1 = startX * 1000000 > endX * 1000000 ? endX : startX;\n  const x2 = startX * 1000000 > endX * 1000000 ? startX : endX;\n  const y1 = startY * 1000000 > endY * 1000000 ? endY : startY;\n  const y2 = startY * 1000000 > endY * 1000000 ? startY : endY;\n\n  const fromY = scaleY.invert(y1);\n  const fromX = scaleX.invert(x1);\n  const toY = scaleY.invert(y2);\n  const toX = scaleX.invert(x2);\n  return { fromX, fromY, toX, toY };\n}\n","import { FromTo } from 'cheminfo-types';\nimport { Draft, original } from 'immer';\nimport lodashCloneDeep from 'lodash/cloneDeep';\nimport { setPathLength } from 'nmr-correlation';\n\nimport * as Filters from '../../../data/Filters';\nimport * as FiltersManager from '../../../data/FiltersManager';\nimport {\n  DatumKind,\n  SignalKindsToInclude,\n} from '../../../data/constants/SignalsKinds';\nimport {\n  changeZoneSignal,\n  detectZones,\n  detectZonesManual,\n  updateShift,\n} from '../../../data/data2d/Spectrum2D';\nimport { Datum2D, Signal2D } from '../../../data/types/data2d';\nimport {\n  unlink,\n  unlinkInAssignmentData,\n} from '../../../data/utilities/ZoneUtilities';\nimport { State } from '../Reducer';\nimport get2DRange from '../helper/get2DRange';\n\nimport { handleUpdateCorrelations } from './CorrelationsActions';\nimport { setDomain } from './DomainActions';\n\nfunction changeZonesFactorHandler(draft: Draft<State>, action) {\n  draft.toolOptions.data.zonesNoiseFactor = action.payload;\n}\n\nfunction add2dZoneHandler(draft: Draft<State>, action) {\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n    const drawnZone = get2DRange(draft, action);\n    const datum = draft.data[index] as Datum2D;\n\n    const zones = detectZonesManual(original(datum), {\n      selectedZone: drawnZone,\n      thresholdFactor: draft.toolOptions.data.zonesNoiseFactor,\n      convolutionByFFT: false,\n    });\n\n    datum.zones.values = datum.zones.values.concat(zones);\n\n    handleOnChangeZonesData(draft);\n  }\n}\nfunction handleAutoZonesDetection(draft: Draft<State>, detectionOptions) {\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n\n    const [fromX, toX] = draft.xDomain;\n    const [fromY, toY] = draft.yDomain;\n    detectionOptions.selectedZone = { fromX, toX, fromY, toY };\n    const datum = draft.data[index] as Datum2D;\n    const zones = detectZones(original(datum), detectionOptions);\n    datum.zones.values = datum.zones.values.concat(zones);\n    handleOnChangeZonesData(draft);\n  }\n}\nfunction handleAutoSpectraZonesDetection(draft: Draft<State>) {\n  for (const datum of draft.data) {\n    if (datum.info.dimension === 2) {\n      const { minX, maxX, minY, maxY } = (datum as Datum2D).data;\n      const detectionOptions = {\n        selectedZone: { fromX: minX, toX: maxX, fromY: minY, toY: maxY },\n        thresholdFactor: 1,\n      };\n\n      const zones = detectZones(original(datum), detectionOptions);\n      (datum as Datum2D).zones.values = (datum as Datum2D).zones.values.concat(\n        zones,\n      );\n\n      handleOnChangeZonesData(draft);\n    }\n  }\n}\n\nfunction changeZoneSignalDelta(draft: Draft<State>, action) {\n  const { zoneID, signal } = action.payload;\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n    const { xShift, yShift } = changeZoneSignal(\n      draft.data[index] as Datum2D,\n      zoneID,\n      signal,\n    );\n    let filters: any = [];\n    if (xShift !== 0) {\n      filters.push({ name: Filters.shift2DX.id, options: xShift });\n    }\n    if (yShift !== 0) {\n      filters.push({ name: Filters.shift2DY.id, options: yShift });\n    }\n\n    FiltersManager.applyFilter(draft.data[index], filters);\n\n    updateShift(draft.data[index] as Datum2D);\n\n    setDomain(draft);\n    handleOnChangeZonesData(draft);\n  }\n}\n\nfunction getZoneIndex(state, spectrumIndex, zoneID) {\n  return state.data[spectrumIndex].zones.values.findIndex(\n    (zone) => zone.id === zoneID,\n  );\n}\n\nfunction handleChangeZoneSignalKind(draft: Draft<State>, action) {\n  const state = original(draft) as State;\n  if (state.activeSpectrum?.id) {\n    const { index } = state.activeSpectrum;\n    const { rowData, value } = action.payload;\n    const zoneIndex = getZoneIndex(state, index, rowData.id);\n    const _zone = (draft.data[index] as Datum2D).zones.values[zoneIndex];\n    _zone.signals[rowData.tableMetaInfo.signalIndex].kind = value;\n    _zone.kind = SignalKindsToInclude.includes(value)\n      ? DatumKind.signal\n      : DatumKind.mixed;\n    handleOnChangeZonesData(draft);\n  }\n}\n\nfunction handleDeleteZone(draft: Draft<State>, action) {\n  const state = original(draft) as State;\n  if (state.activeSpectrum?.id) {\n    const { index } = state.activeSpectrum;\n    const { id, assignmentData } = action.payload;\n    if (id) {\n      const zone = (draft.data[index] as Datum2D).zones.values.find(\n        (zone) => zone.id === id,\n      );\n      unlinkInAssignmentData(assignmentData, [zone || {}]);\n      const zoneIndex = getZoneIndex(state, index, id);\n      (draft.data[index] as Datum2D).zones.values.splice(zoneIndex, 1);\n    } else {\n      unlinkInAssignmentData(\n        assignmentData,\n        (draft.data[index] as Datum2D).zones.values,\n      );\n      (draft.data[index] as Datum2D).zones.values = [];\n    }\n    handleOnChangeZonesData(draft);\n  }\n}\n\nfunction handleDeleteSignal(draft: Draft<State>, action) {\n  const {\n    spectrum,\n    zone,\n    signal,\n    assignmentData,\n    unlinkSignalInAssignmentData = true,\n  } = action.payload;\n\n  if (spectrum && zone) {\n    const datum2D = draft.data.find(\n      (datum) => datum.id === spectrum.id,\n    ) as Datum2D;\n    const zoneIndex = datum2D.zones.values.findIndex(\n      (_zone) => _zone.id === zone.id,\n    );\n    const signalIndex = zone.signals.findIndex(\n      (_signal) => _signal.id === signal.id,\n    );\n    // remove assignments for the signal in zone object and global state\n    const _zone = unlink(lodashCloneDeep(zone), false, signalIndex, undefined);\n    if (unlinkSignalInAssignmentData === true) {\n      unlinkInAssignmentData(\n        assignmentData,\n        [{ signals: [signal] }],\n        undefined,\n      );\n    }\n    _zone.signals.splice(signalIndex, 1);\n    datum2D.zones.values[zoneIndex] = _zone;\n    // if no signals are existing in a zone anymore then delete this zone\n    if (_zone.signals.length === 0) {\n      unlinkInAssignmentData(assignmentData, [_zone]);\n      datum2D.zones.values.splice(zoneIndex, 1);\n    }\n\n    handleOnChangeZonesData(draft);\n  }\n}\n\nfunction handleSetSignalPathLength(draft: Draft<State>, action) {\n  const { spectrum, zone, signal, pathLength } = action.payload;\n  if (spectrum && zone) {\n    const datum2D = draft.data.find(\n      (datum) => datum.id === spectrum.id,\n    ) as Datum2D;\n    const zoneIndex = datum2D.zones.values.findIndex(\n      (_zone) => _zone.id === zone.id,\n    );\n    const signalIndex = zone.signals.findIndex(\n      (_signal) => _signal.id === signal.id,\n    );\n    const _zone = unlink(lodashCloneDeep(zone), false, signalIndex, undefined);\n    _zone.signals[signalIndex].j = {\n      ..._zone.signals[signalIndex].j,\n      pathLength,\n    };\n    datum2D.zones.values[zoneIndex] = _zone;\n\n    handleOnChangeZonesData(draft);\n  }\n}\n\nfunction handleUnlinkZone(draft: Draft<State>, action) {\n  const state = original(draft) as State;\n  if (state.activeSpectrum?.id) {\n    const { index } = state.activeSpectrum;\n    const {\n      zoneData = null,\n      assignmentData,\n      isOnZoneLevel = undefined,\n      signalIndex = -1,\n      axis = undefined,\n    } = action.payload;\n\n    if (zoneData) {\n      // remove assignments in global state\n\n      const zoneIndex = getZoneIndex(state, index, zoneData.id);\n\n      const zone = lodashCloneDeep(\n        (draft.data[index] as Datum2D).zones.values[zoneIndex],\n      );\n      const _zoneData = unlink(zone, isOnZoneLevel, signalIndex, axis);\n\n      unlinkInAssignmentData(\n        assignmentData,\n        [{ id: zoneData.signals[signalIndex].id }],\n        axis,\n      );\n      (draft.data[index] as Datum2D).zones.values[zoneIndex] = _zoneData;\n    } else {\n      const zones = (draft.data[index] as Datum2D).zones.values.map((zone) => {\n        return unlink(zone);\n      });\n      (draft.data[index] as Datum2D).zones.values = zones;\n\n      unlinkInAssignmentData(assignmentData, zones);\n    }\n  }\n}\n\nfunction handleSetDiaIDZone(draft: Draft<State>, action) {\n  const state = original(draft) as State;\n  if (state.activeSpectrum?.id) {\n    const { index } = state.activeSpectrum;\n    const { zoneData, diaIDs, axis, signalIndex, nbAtoms } = action.payload;\n    const getNbAtoms = (input, current = 0) => input + current;\n    const zoneIndex = getZoneIndex(state, index, zoneData.id);\n    const _zone = (draft.data[index] as Datum2D).zones.values[zoneIndex];\n    if (signalIndex === undefined) {\n      _zone[axis].diaIDs = diaIDs;\n      _zone[axis].nbAtoms = getNbAtoms(nbAtoms, _zone[axis].nbAtoms);\n    } else {\n      _zone.signals[signalIndex][axis].diaIDs = diaIDs;\n      _zone.signals[signalIndex][axis].nbAtoms = getNbAtoms(\n        nbAtoms,\n        _zone.signals[signalIndex][axis].nbAtoms,\n      );\n    }\n  }\n}\n\nfunction handleSaveEditedZone(draft: Draft<State>, action) {\n  const state = original(draft) as State;\n  if (state.activeSpectrum?.id) {\n    const { index } = state.activeSpectrum;\n    const { editedRowData } = action.payload;\n\n    delete editedRowData.tableMetaInfo;\n\n    const zoneIndex = getZoneIndex(state, index, editedRowData.id);\n    (draft.data[index] as Datum2D).zones.values[zoneIndex] = editedRowData;\n\n    if (editedRowData.signals) {\n      editedRowData.signals.forEach((signal: Signal2D) => {\n        setPathLength(\n          draft.correlations.values,\n          signal.id,\n          signal.j?.pathLength as FromTo,\n        );\n      });\n    }\n\n    handleOnChangeZonesData(draft);\n  }\n}\n\nfunction handleOnChangeZonesData(draft) {\n  handleUpdateCorrelations(draft);\n}\n\nexport {\n  add2dZoneHandler,\n  handleAutoZonesDetection,\n  handleDeleteSignal,\n  handleDeleteZone,\n  changeZoneSignalDelta,\n  handleChangeZoneSignalKind,\n  handleUnlinkZone,\n  handleSaveEditedZone,\n  handleSetDiaIDZone,\n  handleSetSignalPathLength,\n  changeZonesFactorHandler,\n  handleAutoSpectraZonesDetection,\n};\n","import { original, Draft } from 'immer';\nimport lodashCloneDeep from 'lodash/cloneDeep';\nimport {\n  buildCorrelationData,\n  setCorrelation,\n  Tolerance,\n  Options as CorrelationOptions,\n  Correlation,\n  Spectra,\n  Values as CorrelationValues,\n} from 'nmr-correlation';\n\nimport { Datum1D } from '../../../data/types/data1d';\nimport { Datum2D } from '../../../data/types/data2d';\nimport {\n  findRange,\n  findSignal1D,\n  findSignal2D,\n  findSpectrum,\n  findZone,\n} from '../../../data/utilities/FindUtilities';\nimport { State } from '../Reducer';\n\nimport { handleDeleteSignal as handleDeleteSignal1D } from './RangesActions';\nimport { handleDeleteSignal as handleDeleteSignal2D } from './ZonesActions';\n\nfunction handleUpdateCorrelations(draft: Draft<State>) {\n  const { data: spectra, correlations } = draft;\n  draft.correlations = buildCorrelationData(spectra as Spectra, {\n    ...correlations.options,\n    values: lodashCloneDeep(correlations.values),\n  });\n}\n\nfunction handleSetMF(draft: Draft<State>, payload: { mf: string }) {\n  const state = original(draft) as State;\n  const { data: spectra, correlations } = state;\n  const { mf } = payload;\n  // update of correlation data is needed only if the following is true\n  if (correlations.options.mf === '' || correlations.options.mf !== mf) {\n    draft.correlations = buildCorrelationData(spectra as Spectra, {\n      ...correlations.options,\n      mf,\n      values: lodashCloneDeep(correlations.values),\n    });\n  }\n}\n\nfunction handleSetTolerance(\n  draft: Draft<State>,\n  payload: { tolerance: Tolerance },\n) {\n  const state = original(draft) as State;\n  const { data: spectra, correlations } = state;\n  const { tolerance } = payload;\n  draft.correlations = buildCorrelationData(spectra as Spectra, {\n    ...correlations.options,\n    tolerance,\n    values: lodashCloneDeep(correlations.values),\n  });\n}\n\nfunction handleSetCorrelation(\n  draft: Draft<State>,\n  payload: {\n    id: string;\n    correlation: Correlation;\n    options: CorrelationOptions;\n  },\n) {\n  const state = original(draft) as State;\n  const { correlations } = state;\n  const { id, correlation, options } = payload;\n  draft.correlations = setCorrelation(correlations, id, correlation);\n  if (options) {\n    draft.correlations = {\n      ...draft.correlations,\n      options: { ...draft.correlations.options, ...options },\n    };\n  }\n  handleUpdateCorrelations(draft);\n}\n\nfunction handleSetCorrelations(\n  draft: Draft<State>,\n  payload: {\n    correlations: CorrelationValues;\n    options: CorrelationOptions;\n  },\n) {\n  const { correlations, options } = payload;\n  const state = original(draft) as State;\n  let correlationsData = lodashCloneDeep(state.correlations);\n  correlations.forEach((correlation) => {\n    correlationsData = setCorrelation(\n      correlationsData,\n      correlation.id,\n      correlation,\n    );\n  });\n  draft.correlations = correlationsData;\n  if (options) {\n    draft.correlations = {\n      ...draft.correlations,\n      options: { ...draft.correlations.options, ...options },\n    };\n  }\n  handleUpdateCorrelations(draft);\n}\n\nfunction handleDeleteCorrelation(\n  draft: Draft<State>,\n  payload: { correlation: Correlation; assignmentData },\n) {\n  const { correlation, assignmentData } = payload;\n  // delete all signals linked to the correlation\n  correlation.link.forEach((link) => {\n    const spectrum = findSpectrum(draft.data, link.experimentID, false);\n    if (spectrum) {\n      if (spectrum.info.dimension === 1) {\n        const range = findRange(spectrum as Datum1D, link.signal.id);\n        const signal = findSignal1D(spectrum as Datum1D, link.signal.id);\n        handleDeleteSignal1D(draft, {\n          payload: {\n            spectrum,\n            range,\n            signal,\n            assignmentData,\n          },\n        });\n      } else if (spectrum.info.dimension === 2) {\n        const zone = findZone(spectrum as Datum2D, link.signal.id);\n        const signal = findSignal2D(spectrum as Datum2D, link.signal.id);\n        handleDeleteSignal2D(draft, {\n          payload: {\n            spectrum,\n            zone,\n            signal,\n            assignmentData,\n          },\n        });\n      }\n    }\n  });\n}\n\nexport {\n  handleDeleteCorrelation,\n  handleSetCorrelation,\n  handleSetCorrelations,\n  handleSetMF,\n  handleSetTolerance,\n  handleUpdateCorrelations,\n};\n","import { zoomIdentity, scaleLinear } from 'd3';\nimport { Draft } from 'immer';\n\nimport { State } from '../Reducer';\n\nexport const ZoomType = {\n  HORIZONTAL: 'HORIZONTAL',\n  VERTICAL: 'VERTICAL',\n  STEP_HORIZONTAL: 'STEP_HORIZONTAL',\n  FULL: 'FULL',\n};\ninterface ZoomOptions {\n  factor?: number;\n  invert?: boolean;\n}\nfunction wheelZoom(\n  event: WheelEvent,\n  domain: number[],\n  zoomOptions: ZoomOptions = {},\n): number[] {\n  const { factor = 1, invert = false } = zoomOptions;\n  const deltaY =\n    Math.abs(event.deltaY) < 100 ? event.deltaY * 100 : event.deltaY;\n  const delta = deltaY * (invert ? -0.001 : 0.001) * factor;\n  const ratio = delta < 0 ? -1 / (delta - 1) : 1 + delta;\n\n  const [min, max] = domain;\n\n  return [min * ratio, max * ratio];\n}\n\nfunction setZoom(\n  draft: Draft<State>,\n  options: {\n    scale?: number;\n    spectrumID?: string;\n  } = {},\n) {\n  const { height, margin, activeSpectrum } = draft;\n  const { scale = 1, spectrumID = null } = options;\n\n  if (activeSpectrum === null && spectrumID === null) {\n    const { shareYDomain, yDomain, yDomains } = draft.originDomain;\n    draft.yDomains = Object.keys(draft.yDomains).reduce((acc, id) => {\n      const _scale = scaleLinear(shareYDomain ? yDomain : yDomains[id], [\n        height - margin.bottom,\n        margin.top,\n      ]);\n      const [min, max] = shareYDomain ? yDomain : yDomains[id];\n      const maxPoint = Math.max(Math.abs(max), Math.abs(min));\n      const scalePoint = maxPoint === max ? 0 : min;\n      const t = zoomIdentity\n        .translate(\n          0,\n          Math.sign(scalePoint) >= 0 ? _scale(scalePoint) : _scale(scalePoint),\n        )\n        .scale(scale)\n        .translate(0, -_scale(0));\n      const newYDomain = t.rescaleY(_scale).domain();\n      acc[id] = newYDomain;\n      return acc;\n    }, {});\n  } else {\n    const spectrumId = spectrumID || activeSpectrum?.id;\n    if (spectrumId) {\n      const _scale = scaleLinear(draft.originDomain.yDomains[spectrumId], [\n        height - margin.bottom,\n        margin.top,\n      ]);\n      const t = zoomIdentity\n        .translate(0, _scale(0))\n        .scale(scale)\n        .translate(0, -_scale(0));\n      const yDomain = t.rescaleY(_scale).domain();\n\n      draft.yDomains = {\n        ...draft.yDomains,\n        [spectrumId]: yDomain,\n      };\n    }\n  }\n}\n\nexport { setZoom, wheelZoom };\n","import { Draft } from 'immer';\n\nimport { generateSpectrumFromRanges } from '../../../data/data1d/Spectrum1D/ranges/generateSpectrumFromRanges';\nimport { State } from '../Reducer';\nimport { setZoom } from '../helper/Zoom1DManager';\n\nimport { setDomain } from './DomainActions';\n\nfunction handleRangeResurrecting(draft: Draft<State>, action) {\n  const { ranges, info } = action.payload;\n\n  const datum = generateSpectrumFromRanges(ranges, info, draft.usedColors);\n  draft.data.push(datum);\n  setDomain(draft, { yDomain: { isShared: false } });\n  setZoom(draft, { scale: 0.8, spectrumID: datum.id });\n}\n\nexport { handleRangeResurrecting };\n","import { Draft } from 'immer';\n\nimport { State } from '../Reducer';\n\nfunction setWidth(draft: Draft<State>, width) {\n  draft.width = width;\n}\n\nfunction handleSetDimensions(draft: Draft<State>, width, height) {\n  draft.width = width;\n  draft.height = height;\n}\n\nexport { setWidth, handleSetDimensions };\n","import { Datum1D } from '../../data/types/data1d/Datum1D';\nimport { Datum2D } from '../../data/types/data2d';\n\nimport nucleusToString from './nucleusToString';\n\nexport function getSpectraByNucleus(\n  nucleus: string,\n  data: (Datum1D | Datum2D)[],\n) {\n  return data.filter(\n    (spectrum) => nucleusToString(spectrum.info.nucleus) === nucleus,\n  );\n}\n","interface HistoryItem {\n  xDomain: Array<number>;\n  yDomain: Array<number>;\n}\n\nexport interface ZoomHistory {\n  [key: string]: Array<HistoryItem>;\n}\ninterface ZoomHistoryManager {\n  historyStack: Array<HistoryItem>;\n  push: (value: HistoryItem) => void;\n  pop: () => HistoryItem;\n  getLast: () => HistoryItem;\n  clear: () => void;\n}\n\nexport default function zoomHistoryManager(\n  zoomHistory: ZoomHistory,\n  nucleus: string,\n): ZoomHistoryManager {\n  if (!zoomHistory[nucleus] && !Array.isArray(zoomHistory[nucleus])) {\n    zoomHistory[nucleus] = [];\n  }\n\n  const push = preparePush(zoomHistory[nucleus]);\n  const pop = preparePop(zoomHistory[nucleus]);\n  const getLast = prepareGetLast(zoomHistory[nucleus]);\n  const clear = () => (zoomHistory[nucleus] = []);\n  return { historyStack: zoomHistory[nucleus], push, pop, getLast, clear };\n}\n\nfunction preparePush(historyStack) {\n  return (val: HistoryItem) => {\n    historyStack.push(val);\n  };\n}\n\nfunction preparePop(historyStack) {\n  return () => {\n    const val = historyStack.pop();\n    return val ? historyStack[historyStack.length - 1] : null;\n  };\n}\n\nfunction prepareGetLast(historyStack) {\n  return () => {\n    if (historyStack.length === 0) return null;\n    return historyStack[historyStack.length - 1];\n  };\n}\n","function getNucleusSum(input) {\n  const nucleus = input.split(',');\n  return nucleus.reduce((acc, i) => {\n    const additions = nucleus.length === 2 ? 100 : 0;\n    acc += Number(i.replace(/\\D/g, '')) + additions;\n    return acc;\n  }, 0);\n}\n\nexport default function GroupByInfoKey(key) {\n  return (array, orderByNucleus = false) => {\n    const unorderedGroup = array.reduce((objectsByKeyValue, obj) => {\n      const value = obj.info[key];\n      objectsByKeyValue[value] = (objectsByKeyValue[value] || []).concat(obj);\n      return objectsByKeyValue;\n    }, {});\n\n    if (!orderByNucleus) {\n      return unorderedGroup;\n    } else {\n      return Object.keys(unorderedGroup)\n        .sort((a, b) => getNucleusSum(a) - getNucleusSum(b))\n        .reduce((acc, key) => {\n          acc[key] = unorderedGroup[key];\n          return acc;\n        }, {});\n    }\n  };\n}\n","import { Draft } from 'immer';\nimport cloneDeep from 'lodash/cloneDeep';\n\nimport { Datum1D } from '../../../data/types/data1d';\nimport { Datum2D } from '../../../data/types/data2d';\nimport GroupByInfoKey from '../../utility/GroupByInfoKey';\nimport nucleusToString from '../../utility/nucleusToString';\nimport { State, VerticalAlignment } from '../Reducer';\nimport { DEFAULT_YAXIS_SHIFT_VALUE, DISPLAYER_MODE } from '../core/Constants';\n\nimport { setDomain } from './DomainActions';\n\ninterface AlignmentOptions {\n  align?: VerticalAlignment | 'auto-check';\n  checkData?: boolean;\n  activeTab?: string;\n}\n\nfunction changeSpectrumVerticalAlignment(\n  draft: Draft<State>,\n  options: AlignmentOptions,\n) {\n  if (draft.data && draft.data.length > 0) {\n    let dataPerNucleus: Datum1D[] = [];\n    if (['auto-check', 'stack'].includes(options.align || '')) {\n      dataPerNucleus = (draft.data as Datum1D[]).filter((datum) =>\n        datum.info.nucleus === options?.activeTab\n          ? options.activeTab\n          : draft.activeTab && datum.info.dimension === 1,\n      );\n    }\n\n    switch (options.align) {\n      case 'auto-check':\n      case 'bottom':\n      case 'center': {\n        if (\n          options.align === 'center' ||\n          (options.align === 'auto-check' &&\n            dataPerNucleus[0]?.info.isFid &&\n            !dataPerNucleus.some((d) => d.info.isFid === false))\n        ) {\n          const YAxisShift = draft.height / 2;\n          draft.verticalAlign.align = 'center';\n          draft.verticalAlign.verticalShift = YAxisShift;\n        } else {\n          draft.verticalAlign.align = 'bottom';\n          draft.verticalAlign.verticalShift = DEFAULT_YAXIS_SHIFT_VALUE;\n        }\n        break;\n      }\n\n      case 'stack': {\n        draft.verticalAlign.align = 'stack';\n        const visibleSpectra = dataPerNucleus.filter(\n          (datum) => datum.display.isVisible === true,\n        );\n        draft.verticalAlign.verticalShift = Math.floor(\n          (draft.height - draft.margin.bottom) / (visibleSpectra.length + 2),\n        );\n        break;\n      }\n\n      default:\n        return;\n    }\n  }\n}\n\nfunction setKeyPreferencesHandler(draft: Draft<State>, keyCode) {\n  const {\n    activeTab,\n    data,\n    activeSpectrum,\n    zoom,\n    xDomain,\n    xDomains,\n    yDomain,\n    yDomains,\n    originDomain,\n    margin,\n    displayerMode,\n    tabActiveSpectrum,\n  } = draft;\n\n  if (activeTab) {\n    const groupByNucleus = GroupByInfoKey('nucleus');\n\n    const spectrumsGroupsList = groupByNucleus(data);\n\n    const level =\n      displayerMode === DISPLAYER_MODE.DM_2D\n        ? spectrumsGroupsList[activeTab].reduce((acc, datum) => {\n            acc[datum.id] = datum.processingController.getLevel();\n            return acc;\n          }, {})\n        : null;\n\n    draft.keysPreferences[keyCode] = {\n      activeTab,\n      activeSpectrum,\n      displayerMode,\n      tabActiveSpectrum,\n      zoom,\n      xDomain,\n      xDomains,\n      yDomain,\n      yDomains,\n      originDomain,\n      level,\n      margin,\n      data: spectrumsGroupsList[activeTab].reduce((acc, datum) => {\n        acc[datum.id] = {\n          display: {\n            color: datum.display.color,\n            isVisible: datum.display.isVisible,\n            isPeaksMarkersVisible: datum.display.isPeaksMarkersVisible,\n          },\n        };\n        return acc;\n      }, {}),\n    };\n  }\n}\n\nfunction applyKeyPreferencesHandler(draft: Draft<State>, keyCode) {\n  const preferences = draft.keysPreferences[keyCode];\n  if (preferences) {\n    draft.activeTab = preferences.activeTab;\n    (draft.data as Datum1D[] | Datum2D[]).forEach((datum, index) => {\n      if (nucleusToString(datum.info.nucleus) === preferences.activeTab) {\n        draft.data[index].display = Object.assign(\n          cloneDeep(datum.display),\n          preferences.data[datum.id].display,\n        );\n      }\n    });\n    draft.displayerMode = preferences.displayerMode;\n    draft.tabActiveSpectrum = preferences.tabActiveSpectrum;\n    draft.activeSpectrum = preferences.activeSpectrum;\n\n    draft.margin = preferences.margin;\n\n    setDomain(draft);\n\n    draft.xDomain = preferences.xDomain;\n    draft.xDomains = preferences.xDomains;\n    draft.yDomain = preferences.yDomain;\n    draft.originDomain = preferences.originDomain;\n    draft.yDomains = preferences.yDomains;\n\n    if (draft.displayerMode === DISPLAYER_MODE.DM_2D) {\n      for (const datumID of Object.keys(preferences.level)) {\n        const { levelPositive, levelNegative } = preferences.level[datumID];\n        const index = draft.data.findIndex((datum) => datum.id === datumID);\n        const processController = (draft.data[index] as Datum2D)\n          .processingController;\n        processController.setLevel(levelPositive, levelNegative);\n\n        draft.contours[datumID] = processController.drawContours();\n      }\n    } else {\n      draft.zoom = preferences.zoom;\n    }\n  }\n}\n\nexport {\n  changeSpectrumVerticalAlignment,\n  setKeyPreferencesHandler,\n  applyKeyPreferencesHandler,\n};\n","import { max } from 'd3';\nimport { original, Draft, current } from 'immer';\nimport { xFindClosestIndex } from 'ml-spectra-processing';\n\nimport * as Filters from '../../../data/Filters';\nimport { Data1D, Datum1D } from '../../../data/types/data1d';\nimport { Datum2D } from '../../../data/types/data2d';\nimport generateID from '../../../data/utilities/generateID';\nimport { getYScale, getXScale } from '../../1d/utilities/scale';\nimport { LAYOUT } from '../../2d/utilities/DimensionLayout';\nimport { get2DYScale } from '../../2d/utilities/scale';\nimport { options } from '../../toolbar/ToolTypes';\nimport GroupByInfoKey from '../../utility/GroupByInfoKey';\nimport { getSpectraByNucleus } from '../../utility/getSpectraByNucleus';\nimport { State } from '../Reducer';\nimport { DISPLAYER_MODE, MARGIN } from '../core/Constants';\nimport { setZoom, wheelZoom, ZoomType } from '../helper/Zoom1DManager';\nimport zoomHistoryManager from '../helper/ZoomHistoryManager';\n\nimport {\n  setDomain,\n  SetDomainOptions,\n  setIntegralsYDomain,\n  setMode,\n} from './DomainActions';\nimport { resetSpectrumByFilter } from './FiltersActions';\nimport { changeSpectrumVerticalAlignment } from './PreferencesActions';\n\nfunction getStrongestPeak(draft: Draft<State>) {\n  const { activeSpectrum, data } = draft;\n  if (activeSpectrum) {\n    const activeData = data[activeSpectrum?.index].data as Data1D;\n    const strongestPeakValue = max(activeData.re);\n    const index = activeData.re.findIndex((val) => val === strongestPeakValue);\n    return {\n      xValue: activeData.x[index],\n      yValue: strongestPeakValue,\n      index: index,\n    };\n  }\n}\n\nfunction setFilterChanges(draft: Draft<State>, selectedFilter) {\n  const activeSpectrumId = draft.activeSpectrum?.id;\n\n  //save reduced snapshot\n  //select the equalizer tool when you enable manual phase correction filter\n  if (selectedFilter === Filters.phaseCorrection.id) {\n    const datumAfterPhaseCorrection = resetSpectrumByFilter(\n      draft,\n      Filters.phaseCorrection.id,\n      {\n        rollback: true,\n        searchBy: 'name',\n        returnCurrentDatum: true,\n      },\n    );\n    draft.tempData = current(draft).data;\n    if (datumAfterPhaseCorrection) {\n      draft.tempData[datumAfterPhaseCorrection?.index] =\n        datumAfterPhaseCorrection?.datum;\n    }\n    const { xValue, index } = getStrongestPeak(draft) || {\n      xValue: 0,\n      index: 0,\n    };\n\n    draft.toolOptions.data.pivot = { value: xValue, index };\n  } else {\n    if (draft.toolOptions.selectedTool === options.phaseCorrection.id) {\n      draft.toolOptions.data.activeFilterID = null;\n      const spectrumIndex = draft.data.findIndex(\n        (spectrum) => spectrum.id === activeSpectrumId,\n      );\n\n      draft.data[spectrumIndex].data = draft.tempData[spectrumIndex].data;\n    }\n  }\n}\n\nfunction resetTool(draft: Draft<State>, setDefaultTool = true) {\n  // reset temp range\n  draft.toolOptions.data.tempRange = null;\n\n  setSelectedOptionPanel(draft, null);\n  if (setDefaultTool) {\n    draft.toolOptions.selectedTool = options.zoom.id;\n  }\n  draft.toolOptions.data.baseLineZones = [];\n\n  if (draft.toolOptions.data.activeFilterID) {\n    resetSpectrumByFilter(draft);\n  }\n\n  if (draft.tempData) {\n    draft.tempData = null;\n    setDomain(draft);\n  }\n}\n\nfunction resetSelectedTool(draft: Draft<State>, filterOnly = false) {\n  if (\n    (draft.toolOptions.selectedTool &&\n      options[draft.toolOptions.selectedTool].isFilter) ||\n    !filterOnly\n  ) {\n    resetTool(draft);\n  }\n}\n\nfunction setSelectedTool(draft: Draft<State>, action) {\n  const { selectedTool } = action.payload;\n\n  if (draft?.data.length > 0) {\n    if (selectedTool) {\n      // start Range edit mode\n      if (selectedTool === options.editRange.id) {\n        draft.toolOptions.data.tempRange = action.payload.tempRange;\n      } else {\n        draft.toolOptions.data.tempRange = null;\n      }\n\n      if (selectedTool !== draft.toolOptions.selectedTool) {\n        resetTool(draft, false);\n      }\n\n      draft.toolOptions.selectedTool = selectedTool;\n\n      if (options[selectedTool].hasOptionPanel) {\n        setSelectedOptionPanel(draft, selectedTool);\n      }\n\n      if (options[selectedTool].isFilter) {\n        setFilterChanges(draft, selectedTool);\n      }\n    } else {\n      resetTool(draft, false);\n    }\n    setMargin(draft);\n  }\n}\n\nfunction setSelectedOptionPanel(draft: Draft<State>, selectedOptionPanel) {\n  draft.toolOptions.selectedOptionPanel = selectedOptionPanel;\n}\n\nfunction setSpectrumsVerticalAlign(draft: Draft<State>) {\n  const align = ['stack', 'center'].includes(draft.verticalAlign.align)\n    ? 'bottom'\n    : 'center';\n  changeSpectrumVerticalAlignment(draft, { align });\n}\n\nfunction handleChangeSpectrumDisplayMode(draft: Draft<State>) {\n  const align = draft.verticalAlign.align === 'stack' ? 'bottom' : 'stack';\n  changeSpectrumVerticalAlignment(draft, { align });\n}\n\nfunction handleAddBaseLineZone(draft: Draft<State>, { from, to }) {\n  const scaleX = getXScale(draft);\n\n  let start = scaleX.invert(from);\n  const end = scaleX.invert(to);\n\n  let zone: any = [];\n  if (start > end) {\n    zone = [end, start];\n  } else {\n    zone = [start, end];\n  }\n\n  const zones = draft.toolOptions.data.baseLineZones.slice();\n  zones.push({\n    id: generateID(),\n    from: zone[0],\n    to: zone[1],\n  });\n  draft.toolOptions.data.baseLineZones = zones;\n}\n\nfunction handleDeleteBaseLineZone(draft: Draft<State>, id) {\n  const state = original(draft) as State;\n  draft.toolOptions.data.baseLineZones =\n    state.toolOptions.data.baseLineZones.baseLineZones.filter(\n      (zone) => zone.id !== id,\n    );\n}\n\nfunction handleToggleRealImaginaryVisibility(draft) {\n  if (draft.activeSpectrum != null) {\n    const { index } = draft.activeSpectrum;\n\n    draft.data[index].display.isRealSpectrumVisible =\n      !draft.data[index].display.isRealSpectrumVisible;\n\n    setDomain(draft);\n  }\n}\n\nfunction handleBrushEnd(draft: Draft<State>, action) {\n  const is2D = draft.displayerMode === DISPLAYER_MODE.DM_2D;\n  const xScale = getXScale(draft);\n\n  const yScale = is2D ? get2DYScale(draft) : getYScale(draft);\n\n  const startX = xScale.invert(action.startX);\n  const endX = xScale.invert(action.endX);\n  const startY = yScale.invert(action.startY);\n  const endY = yScale.invert(action.endY);\n  const domainX = startX > endX ? [endX, startX] : [startX, endX];\n  const domainY = startY > endY ? [endY, startY] : [startY, endY];\n  const brushHistory = zoomHistoryManager(draft.zoom.history, draft.activeTab);\n  if (draft.displayerMode === DISPLAYER_MODE.DM_2D) {\n    switch (action.trackID) {\n      case LAYOUT.CENTER_2D:\n        draft.xDomain = domainX;\n        draft.yDomain = domainY;\n        break;\n      case LAYOUT.TOP_1D:\n        draft.xDomain = domainX;\n        break;\n      case LAYOUT.LEFT_1D:\n        draft.yDomain = domainY;\n        break;\n      default:\n        break;\n    }\n    if (brushHistory) {\n      brushHistory.push({ xDomain: draft.xDomain, yDomain: draft.yDomain });\n    }\n  } else {\n    draft.xDomain = domainX;\n    if (brushHistory) {\n      brushHistory.push({ xDomain: domainX, yDomain: domainY });\n    }\n  }\n}\nfunction setVerticalIndicatorXPosition(draft: Draft<State>, position) {\n  if (draft.activeSpectrum?.id) {\n    const scaleX = getXScale(draft);\n    const value = scaleX.invert(position);\n    const datum = draft.data[draft.activeSpectrum.index] as Datum1D;\n    const index = xFindClosestIndex(datum.data.x, value);\n    draft.toolOptions.data.pivot = { value, index };\n  }\n}\n\nfunction getSpectrumID(draft: Draft<State>, index): string | null {\n  const spectrum = draft.tabActiveSpectrum[draft.activeTab.split(',')[index]];\n  return spectrum?.id ? spectrum.id : null;\n}\n\nfunction handleZoom(draft: Draft<State>, action) {\n  const { event, trackID, selectedTool } = action;\n  const {\n    activeSpectrum,\n    toolOptions: {\n      data: { showRangesIntegrals },\n    },\n    displayerMode,\n  } = draft;\n  if (displayerMode === DISPLAYER_MODE.DM_2D) {\n    const index =\n      trackID === LAYOUT.TOP_1D ? 0 : trackID === LAYOUT.LEFT_1D ? 1 : null;\n    if (index !== null) {\n      const id = getSpectrumID(draft, index);\n      if (id) {\n        const domain = draft.yDomains[id];\n        draft.yDomains[id] = wheelZoom(event, domain);\n      }\n    }\n  } else {\n    if (activeSpectrum?.id) {\n      if (\n        (showRangesIntegrals || selectedTool === options.integral.id) &&\n        event.shiftKey\n      ) {\n        const domain = draft.integralsYDomains[activeSpectrum?.id];\n        draft.integralsYDomains[activeSpectrum?.id] = wheelZoom(event, domain);\n      } else {\n        const domain = draft.yDomains[activeSpectrum?.id];\n        draft.yDomains[activeSpectrum?.id] = wheelZoom(event, domain);\n      }\n    } else {\n      const spectra = getSpectraByNucleus(\n        draft.activeTab,\n        draft.data,\n      ) as Datum1D[];\n      for (const spectrum of spectra) {\n        const domain = draft.yDomains[spectrum.id];\n        draft.yDomains[spectrum.id] = wheelZoom(event, domain);\n      }\n    }\n  }\n}\n\nfunction zoomOut(draft: Draft<State>, action) {\n  if (draft?.data.length > 0) {\n    const { zoomType, trackID } = action;\n    const zoomHistory = zoomHistoryManager(draft.zoom.history, draft.activeTab);\n\n    if (draft.displayerMode === DISPLAYER_MODE.DM_1D) {\n      switch (zoomType) {\n        case ZoomType.HORIZONTAL: {\n          draft.xDomain = draft.originDomain.xDomain;\n          zoomHistory.clear();\n          break;\n        }\n        case ZoomType.VERTICAL:\n          setZoom(draft, { scale: 0.8 });\n          break;\n        case ZoomType.STEP_HORIZONTAL: {\n          const zoomValue = zoomHistory.pop();\n          draft.xDomain = zoomValue\n            ? zoomValue.xDomain\n            : draft.originDomain.xDomain;\n          setZoom(draft, { scale: 0.8 });\n          break;\n        }\n        default: {\n          draft.xDomain = draft.originDomain.xDomain;\n          setZoom(draft, { scale: 0.8 });\n          break;\n        }\n      }\n    } else {\n      const { xDomain, yDomain, yDomains } = draft.originDomain;\n\n      if ([LAYOUT.TOP_1D, LAYOUT.LEFT_1D, LAYOUT.CENTER_2D].includes(trackID)) {\n        const zoomValue = zoomHistory.pop();\n        draft.xDomain = zoomValue ? zoomValue.xDomain : xDomain;\n        draft.yDomain = zoomValue ? zoomValue.yDomain : yDomain;\n      } else {\n        zoomHistory.clear();\n        draft.xDomain = xDomain;\n        draft.yDomain = yDomain;\n        draft.yDomains = yDomains;\n      }\n    }\n  }\n}\n\nfunction hasAcceptedSpectrum(draft: Draft<State>, index) {\n  const nucleuses = draft.activeTab.split(',');\n  const activeSpectrum = draft.tabActiveSpectrum[nucleuses[index]];\n  return (\n    activeSpectrum?.id &&\n    !(draft.data[activeSpectrum.index] as Datum1D).info.isFid\n  );\n}\n\nfunction setMargin(draft: Draft<State>) {\n  if (\n    draft.displayerMode === DISPLAYER_MODE.DM_2D &&\n    draft.toolOptions.selectedTool !== options.slicingTool.id\n  ) {\n    const top = hasAcceptedSpectrum(draft, 0)\n      ? MARGIN['2D'].top\n      : MARGIN['1D'].top;\n    const left = hasAcceptedSpectrum(draft, 1)\n      ? MARGIN['2D'].left\n      : MARGIN['1D'].left;\n    draft.margin = { ...MARGIN['2D'], top, left };\n  } else if (draft.toolOptions.selectedTool === options.slicingTool.id) {\n    draft.margin = MARGIN['2D'];\n  } else if (draft.displayerMode === DISPLAYER_MODE.DM_1D) {\n    draft.margin = MARGIN['1D'];\n  }\n}\n\nfunction Processing2DData(draft: Draft<State>, data) {\n  if (draft.displayerMode === DISPLAYER_MODE.DM_2D) {\n    let _data = {};\n    for (const datum of data[draft.activeTab]) {\n      _data[datum.id] = datum.processingController.drawContours();\n    }\n    draft.contours = _data;\n  }\n}\n\nfunction setDisplayerMode(draft: Draft<State>, data) {\n  draft.displayerMode =\n    data && (data as Datum1D[] | Datum2D[]).some((d) => d.info.dimension === 2)\n      ? DISPLAYER_MODE.DM_2D\n      : DISPLAYER_MODE.DM_1D;\n}\n\nfunction setTabActiveSpectrum(draft: Draft<State>, dataGroupByTab) {\n  let tabs2D: any[] = [];\n  const tabActiveSpectrum = {};\n\n  const tabkeys = Object.keys(dataGroupByTab).sort((a, b) =>\n    a.split(',').length > b.split(',').length ? -1 : 1,\n  );\n  for (let tabKey of tabkeys) {\n    const data = dataGroupByTab[tabKey];\n    const nucleusLength = tabKey.split(',').length;\n    if (nucleusLength === 2) {\n      tabs2D.push(tabKey);\n    }\n\n    if (data.length === 1) {\n      const index = draft.data.findIndex((datum) => datum.id === data[0].id);\n      tabActiveSpectrum[tabKey] = { id: data[0].id, index };\n    } else {\n      const tabSpectra = dataGroupByTab[tabKey];\n      const tabSpectraLength = tabSpectra.length;\n      if (tabSpectraLength >= 2) {\n        const FTSpectrums = tabSpectra.filter((d) => !d.info.isFid);\n        if (\n          FTSpectrums.length > 0 &&\n          (nucleusLength === 2 ||\n            (nucleusLength === 1 && tabSpectraLength !== FTSpectrums.length))\n        ) {\n          const index = draft.data.findIndex(\n            (datum) => datum.id === FTSpectrums[0].id,\n          );\n          tabActiveSpectrum[tabKey] = { id: FTSpectrums[0].id, index };\n        } else {\n          tabActiveSpectrum[tabKey] = null;\n        }\n      } else {\n        tabActiveSpectrum[tabKey] = null;\n      }\n    }\n  }\n  draft.tabActiveSpectrum = tabActiveSpectrum;\n  return tabs2D;\n}\n\nfunction setTab(draft: Draft<State>, dataGroupByTab, tab, refresh = false) {\n  const groupByTab = Object.keys(dataGroupByTab).sort((a, b) =>\n    a.split(',').length > b.split(',').length ? -1 : 1,\n  );\n\n  if (\n    JSON.stringify(groupByTab) !==\n      JSON.stringify(Object.keys(draft.tabActiveSpectrum)) ||\n    refresh\n  ) {\n    const tabs2D = setTabActiveSpectrum(draft, dataGroupByTab);\n\n    if (tabs2D.length > 0 && tab == null) {\n      draft.activeSpectrum = draft.tabActiveSpectrum[tabs2D[0]];\n      draft.activeTab = tabs2D[0];\n    } else {\n      draft.activeSpectrum = tab ? draft.tabActiveSpectrum[tab] : tab;\n      draft.activeTab = tab;\n    }\n  } else {\n    draft.activeTab = tab;\n    draft.activeSpectrum = draft.tabActiveSpectrum[tab];\n  }\n\n  setDisplayerMode(draft, dataGroupByTab[draft.activeTab]);\n  setMargin(draft);\n}\n\ninterface SetActiveTabOptions {\n  tab?: string | null;\n  refreshActiveTab?: boolean;\n  domainOptions?: SetDomainOptions;\n}\n\nfunction setActiveTab(draft: Draft<State>, options?: SetActiveTabOptions) {\n  const {\n    tab = null,\n    refreshActiveTab = false,\n    domainOptions = {},\n  } = options || {};\n\n  const groupByNucleus = GroupByInfoKey('nucleus');\n  const dataGroupByNucleus = groupByNucleus(draft.data);\n  const tabs = Object.keys(dataGroupByNucleus);\n  const currentTab = !tab || !tabs.includes(tab || '') ? tabs[0] : tab;\n  setTab(draft, dataGroupByNucleus, currentTab, refreshActiveTab);\n  resetTool(draft);\n\n  Processing2DData(draft, dataGroupByNucleus);\n\n  setDomain(draft, domainOptions);\n  setIntegralsYDomain(draft, dataGroupByNucleus[currentTab]);\n\n  const zoomHistory = zoomHistoryManager(draft.zoom.history, draft.activeTab);\n  const zoomValue = zoomHistory.getLast();\n  if (zoomValue) {\n    draft.xDomain = zoomValue.xDomain;\n    draft.yDomain = zoomValue.yDomain;\n  }\n  setMode(draft);\n}\n\nfunction handelSetActiveTab(draft: Draft<State>, tab) {\n  if (tab) {\n    setActiveTab(draft, { tab });\n  }\n}\n\nfunction levelChangeHandler(draft: Draft<State>, { deltaY, shiftKey }) {\n  try {\n    if (draft.activeSpectrum?.id) {\n      const { index, id } = draft.activeSpectrum;\n      const processingController = (draft.data[index] as Datum2D)\n        .processingController;\n      if (shiftKey) {\n        processingController.shiftWheel(deltaY);\n      } else {\n        processingController.wheel(deltaY);\n      }\n      const contours = Object.freeze(processingController.drawContours());\n      draft.contours[id] = contours;\n    }\n  } catch (e) {\n    // eslint-disable-next-line no-console\n    console.log(e);\n  }\n}\n\nfunction setSpectraSameTopHandler(draft: Draft<State>) {\n  if (draft.displayerMode === DISPLAYER_MODE.DM_1D) {\n    draft.originDomain.shareYDomain = false;\n    setZoom(draft, { scale: 0.8 });\n  }\n}\nfunction resetSpectraScale(draft: Draft<State>) {\n  draft.originDomain.shareYDomain = true;\n  draft.yDomains = draft.originDomain.yDomains;\n  draft.yDomain = draft.originDomain.yDomain;\n  setZoom(draft, { scale: 0.8 });\n}\n\nexport {\n  resetSelectedTool,\n  setSelectedTool,\n  setSelectedOptionPanel,\n  setSpectrumsVerticalAlign,\n  handleChangeSpectrumDisplayMode,\n  handleAddBaseLineZone,\n  handleDeleteBaseLineZone,\n  handleToggleRealImaginaryVisibility,\n  handleBrushEnd,\n  setVerticalIndicatorXPosition,\n  handleZoom,\n  zoomOut,\n  handelSetActiveTab,\n  levelChangeHandler,\n  setActiveTab,\n  setTab,\n  setSpectraSameTopHandler,\n  resetSpectraScale,\n};\n","import { current, Draft } from 'immer';\n\nimport * as Filters from '../../../data/Filters';\nimport * as FiltersManager from '../../../data/FiltersManager';\nimport { updateXShift } from '../../../data/data1d/Spectrum1D';\nimport { apply as autoPhaseCorrection } from '../../../data/data1d/filter1d/autoPhaseCorrection';\nimport { apply as phaseCorrection } from '../../../data/data1d/filter1d/phaseCorrection';\nimport { updateShift as update2dShift } from '../../../data/data2d/Spectrum2D';\nimport { Datum1D } from '../../../data/types/data1d';\nimport { Datum2D } from '../../../data/types/data2d';\nimport generateID from '../../../data/utilities/generateID';\nimport { getSpectraByNucleus } from '../../utility/getSpectraByNucleus';\nimport nucleusToString from '../../utility/nucleusToString';\nimport { ActiveSpectrum, State } from '../Reducer';\nimport zoomHistoryManager from '../helper/ZoomHistoryManager';\nimport getRange from '../helper/getRange';\n\nimport { setDomain, setMode } from './DomainActions';\nimport { changeSpectrumVerticalAlignment } from './PreferencesActions';\nimport { resetSelectedTool } from './ToolsActions';\n\nfunction shiftSpectrumAlongXAxis(draft: Draft<State>, shiftValue) {\n  //apply filter into the spectrum\n  if (draft.activeSpectrum?.id) {\n    const index = draft.activeSpectrum?.index;\n\n    FiltersManager.applyFilter(draft.data[index], [\n      { name: Filters.shiftX.id, options: shiftValue },\n    ]);\n    updateXShift(draft.data[index] as Datum1D);\n    resetSelectedTool(draft);\n    setDomain(draft);\n  }\n}\n\nfunction applyZeroFillingFilter(draft: Draft<State>, filterOptions) {\n  if (draft.activeSpectrum?.id) {\n    const index = draft.activeSpectrum.index;\n    const filters = [\n      { name: Filters.zeroFilling.id, options: filterOptions.zeroFillingSize },\n      {\n        name: Filters.lineBroadening.id,\n        options: filterOptions.lineBroadeningValue,\n      },\n    ];\n    FiltersManager.applyFilter(draft.data[index], filters);\n    resetSelectedTool(draft);\n    setDomain(draft);\n    setMode(draft);\n  }\n}\nfunction applyFFTFilter(draft: Draft<State>) {\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n\n    //apply filter into the spectrum\n    FiltersManager.applyFilter(draft.data[index], [\n      { name: Filters.fft.id, options: {} },\n    ]);\n    resetSelectedTool(draft);\n    changeSpectrumVerticalAlignment(draft, { align: 'bottom' });\n\n    setDomain(draft, { yDomain: { isChanged: true } });\n    setMode(draft);\n  }\n}\nfunction applyManualPhaseCorrectionFilter(draft: Draft<State>, filterOptions) {\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n    const { ph0, ph1 } = filterOptions;\n\n    FiltersManager.applyFilter(draft.data[index], [\n      { name: Filters.phaseCorrection.id, options: { ph0, ph1 } },\n    ]);\n\n    resetSelectedTool(draft);\n    draft.tempData = null;\n    setDomain(draft);\n  }\n}\nfunction applyAbsoluteFilter(draft: Draft<State>) {\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n    FiltersManager.applyFilter(draft.data[index], [\n      { name: Filters.absolute.id, options: {} },\n    ]);\n\n    resetSelectedTool(draft);\n    draft.tempData = null;\n    setDomain(draft);\n  }\n}\n\nfunction applyAutoPhaseCorrectionFilter(draft: Draft<State>) {\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n\n    const { ph0, ph1 } = autoPhaseCorrection(draft.data[index]);\n\n    FiltersManager.applyFilter(draft.data[index], [\n      { name: Filters.phaseCorrection.id, options: { ph0, ph1 } },\n    ]);\n\n    resetSelectedTool(draft);\n    draft.tempData = null;\n    setDomain(draft);\n  }\n}\n\nfunction calculateManualPhaseCorrection(draft: Draft<State>, filterOptions) {\n  if (draft.activeSpectrum) {\n    const { index } = draft.activeSpectrum;\n    const {\n      data: { x, re, im },\n      info,\n    } = draft.data[index] as Datum1D;\n\n    const { ph0, ph1 } = filterOptions;\n    let _data = { data: { x: x, re: re, im }, info };\n    phaseCorrection(_data, { ph0, ph1 });\n    const { im: newIm, re: newRe } = _data.data;\n    draft.tempData[index].data.im = newIm;\n    draft.tempData[index].data.re = newRe;\n  }\n}\n\nfunction enableFilter(draft: Draft<State>, filterID, checked) {\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n\n    //apply filter into the spectrum\n    FiltersManager.enableFilter(draft.data[index], filterID, checked);\n\n    if (draft.data[index].info?.dimension === 1) {\n      updateXShift(draft.data[index] as Datum1D);\n    } else if (draft.data[index].info?.dimension === 2) {\n      update2dShift(draft.data[index] as Datum2D);\n    }\n\n    resetSelectedTool(draft);\n    setDomain(draft);\n    setMode(draft);\n\n    const zoomHistory = zoomHistoryManager(draft.zoom.history, draft.activeTab);\n    const zoomValue = zoomHistory.getLast();\n    if (zoomValue) {\n      draft.xDomain = zoomValue.xDomain;\n      draft.yDomain = zoomValue.yDomain;\n    }\n  }\n}\n\nfunction deleteFilter(draft: Draft<State>, actions) {\n  const filterID = actions.payload.id;\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n    //apply filter into the spectrum\n    FiltersManager.deleteFilter(draft.data[index], filterID);\n\n    if (draft.data[index].info?.dimension === 1) {\n      updateXShift(draft.data[index] as Datum1D);\n    } else if (draft.data[index].info?.dimension === 2) {\n      update2dShift(draft.data[index] as Datum2D);\n    }\n\n    resetSelectedTool(draft);\n    setDomain(draft);\n    setMode(draft);\n  }\n}\nfunction deleteSpectraFilter(draft: Draft<State>, actions) {\n  const filterType = actions.payload.filterType;\n\n  if (draft.activeTab) {\n    for (const datum of draft.data) {\n      if (nucleusToString(datum?.info?.nucleus) === draft.activeTab) {\n        const filtersResult =\n          datum.filters?.filter((filter) => filter.name === filterType) || [];\n\n        filtersResult.forEach((filter) => {\n          FiltersManager.deleteFilter(datum, filter.id);\n\n          if (datum.info?.dimension === 1) {\n            updateXShift(datum as Datum1D);\n          } else if (datum.info?.dimension === 2) {\n            update2dShift(datum as Datum2D);\n          }\n        });\n      }\n    }\n\n    resetSelectedTool(draft);\n    setDomain(draft);\n    setMode(draft);\n  }\n}\n\nfunction handleBaseLineCorrectionFilter(draft: Draft<State>, action) {\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n\n    FiltersManager.applyFilter(draft.data[index], [\n      {\n        name: Filters.baselineCorrection.id,\n        options: {\n          zones: draft.toolOptions.data.baseLineZones,\n          ...action.options,\n        },\n      },\n    ]);\n\n    draft.toolOptions.data.baseLineZones = [];\n    const xDomainSnapshot = draft.xDomain.slice();\n\n    resetSelectedTool(draft);\n    setDomain(draft);\n    draft.xDomain = xDomainSnapshot;\n  }\n}\n\n/**\n * reset spectrum data for specific point of time (Filter)\n * @param {object} draft\n * @param {string} id Filter id\n * @param {object} options\n * @param {boolean=} options.resetTool\n * @param {boolean=} options.updateDomain\n * @param {boolean=} options.rollback\n */\nfunction resetSpectrumByFilter(\n  draft,\n  id: string | null = null,\n  options: {\n    rollback?: boolean;\n    resetTool?: boolean;\n    updateDomain?: boolean;\n    returnCurrentDatum?: boolean;\n    searchBy?: 'id' | 'name';\n  } = {},\n  activeSpectrum: ActiveSpectrum | null = null,\n) {\n  const {\n    updateDomain = true,\n    rollback = false,\n    searchBy = 'id',\n    returnCurrentDatum = false,\n  } = options;\n\n  let currentDatum: any = null;\n\n  const currentActiveSpectrum = activeSpectrum\n    ? activeSpectrum\n    : draft.activeSpectrum;\n\n  if (currentActiveSpectrum?.id) {\n    const index = currentActiveSpectrum.index;\n    const datum = draft.data[index] as Datum1D | Datum2D;\n\n    if (id && draft.toolOptions.data.activeFilterID !== id) {\n      const filterIndex = datum.filters.findIndex((f) => f[searchBy] === id);\n      let filters: any[] = [];\n      if (filterIndex !== -1) {\n        filters = datum.filters.slice(\n          0,\n          rollback ? filterIndex : filterIndex + 1,\n        );\n\n        if (filters.length > 1) {\n          draft.toolOptions.data.activeFilterID =\n            datum.filters[rollback ? filterIndex - 1 : filterIndex]?.id;\n        } else {\n          draft.toolOptions.data.activeFilterID = null;\n        }\n\n        FiltersManager.reapplyFilters(datum, filters);\n\n        if (returnCurrentDatum) {\n          const { name, value: options } = datum.filters[filterIndex];\n          const newDatum = current(draft).data[index];\n          if (newDatum.info?.dimension === 1) {\n            FiltersManager.applyFilter(newDatum, [{ name, options }]);\n          }\n\n          currentDatum = { datum: newDatum, index };\n        }\n      }\n    } else {\n      //close filter snapshot mode and replay all enabled filters\n      draft.toolOptions.data.activeFilterID = null;\n      FiltersManager.reapplyFilters(datum);\n    }\n\n    if (datum.info?.dimension === 1) {\n      updateXShift(datum as Datum1D);\n    } else if (datum.info?.dimension === 2) {\n      update2dShift(datum as Datum2D);\n    }\n\n    if (updateDomain) {\n      setDomain(draft);\n      setMode(draft);\n    }\n  }\n  if (returnCurrentDatum) {\n    return currentDatum;\n  }\n}\n\nfunction filterSnapshotHandler(draft: Draft<State>, action) {\n  resetSpectrumByFilter(draft, action.id);\n}\n\nfunction handleMultipleSpectraFilter(draft: Draft<State>, action) {\n  const spectra = getSpectraByNucleus(draft.activeTab, draft.data);\n\n  if (spectra && spectra.length > 0 && Array.isArray(action.payload)) {\n    const exclusions =\n      spectra[0].filters.find((f) => f.name === Filters.exclusionZones.id)\n        ?.value || [];\n\n    for (const spectrum of spectra) {\n      const filters = action.payload.map((filter) => {\n        if (filter.name === Filters.equallySpaced.id) {\n          return {\n            ...filter,\n            options: { ...filter.options, exclusions },\n          };\n        }\n        return filter;\n      });\n\n      FiltersManager.applyFilter(spectrum, filters);\n    }\n  }\n  setDomain(draft);\n}\n\nfunction handleAddExclusionZone(draft: Draft<State>, action) {\n  const { from: startX, to: endX } = action.payload;\n  const range = getRange(draft, { startX, endX });\n\n  let spectra: Datum1D[];\n\n  if (draft.activeSpectrum?.id) {\n    const index = draft.activeSpectrum?.index;\n    spectra = [draft.data[index] as Datum1D];\n  } else {\n    spectra = getSpectraByNucleus(draft.activeTab, draft.data) as Datum1D[];\n  }\n\n  for (const spectrum of spectra) {\n    FiltersManager.applyFilter(spectrum, [\n      {\n        name: Filters.exclusionZones.id,\n        options: [\n          {\n            id: generateID(),\n            from: range[0],\n            to: range[1],\n          },\n        ],\n      },\n    ]);\n  }\n\n  setDomain(draft);\n}\n\nfunction handleDeleteExclusionZone(draft: Draft<State>, action) {\n  const { id, spectrumID } = action.payload;\n  const spectrumIndex = draft.data.findIndex(\n    (spectrum) => spectrum.id === spectrumID,\n  );\n  const exclusionZonesFilter = draft.data[spectrumIndex].filters.find(\n    (filter) => filter.name === Filters.exclusionZones.id,\n  );\n  if (exclusionZonesFilter) {\n    if (exclusionZonesFilter.value.length === 1) {\n      FiltersManager.deleteFilter(\n        draft.data[spectrumIndex],\n        exclusionZonesFilter.id,\n      );\n    } else {\n      exclusionZonesFilter.value = exclusionZonesFilter.value.filter(\n        (zone) => zone.id !== id,\n      );\n      FiltersManager.reapplyFilters(draft.data[spectrumIndex]);\n    }\n  }\n}\n\nexport {\n  shiftSpectrumAlongXAxis,\n  applyZeroFillingFilter,\n  applyFFTFilter,\n  applyManualPhaseCorrectionFilter,\n  applyAutoPhaseCorrectionFilter,\n  applyAbsoluteFilter,\n  calculateManualPhaseCorrection,\n  handleMultipleSpectraFilter,\n  enableFilter,\n  deleteFilter,\n  deleteSpectraFilter,\n  handleBaseLineCorrectionFilter,\n  filterSnapshotHandler,\n  resetSpectrumByFilter,\n  handleAddExclusionZone,\n  handleDeleteExclusionZone,\n};\n","import { Draft } from 'immer';\n\nimport { State } from '../Reducer';\n\nfunction setIsOverDisplayer(draft: Draft<State>, actions) {\n  draft.overDisplayer = actions.payload;\n}\nexport { setIsOverDisplayer };\n","import { setDomain, getDomain } from './DomainActions';\n\nfunction handleHistoryUndo(draft) {\n  const { past, present, future } = draft.history;\n  const previous = past[past.length - 1];\n  const newPast = past.slice(0, past.length - 1);\n  const newfuture = [present, ...future];\n\n  const hasRedo = newfuture.length !== 0;\n  const hasUndo = past.length !== 0;\n\n  const domain = getDomain(draft.data);\n  const history = {\n    past: newPast,\n    present: previous,\n    future: newfuture,\n    hasRedo,\n    hasUndo,\n  };\n\n  draft.xDomain = domain.xDomain;\n  draft.yDomain = domain.yDomain;\n  draft.originDomain = domain;\n  draft.history = history;\n}\n\nfunction handleHistoryRedo(draft) {\n  const { history } = draft;\n  const newPresent = history.future.shift();\n  history.past.push(history.present);\n  history.present = newPresent;\n  history.hasUndo = true;\n  history.hasRedo = history.future.length > 0;\n\n  setDomain(draft.data);\n}\n\nfunction handleHistoryReset(draft, action) {\n  draft.history = {\n    past: [],\n    present: action,\n    future: [],\n    hasRedo: false,\n    hasUndo: false,\n  };\n}\n\nexport { handleHistoryUndo, handleHistoryRedo, handleHistoryReset };\n","import { Draft, original } from 'immer';\nimport { xyIntegration } from 'ml-spectra-processing';\n\nimport {\n  updateIntegralsRelativeValues,\n  changeIntegralsRelative,\n  getShiftX,\n} from '../../../data/data1d/Spectrum1D';\nimport {\n  initSumOptions,\n  setSumOptions,\n} from '../../../data/data1d/Spectrum1D/SumManager';\nimport { Datum1D } from '../../../data/types/data1d';\nimport generateID from '../../../data/utilities/generateID';\nimport { State } from '../Reducer';\nimport getRange from '../helper/getRange';\n\nimport { setIntegralsYDomain } from './DomainActions';\n\nfunction handleChangeIntegralSum(draft: Draft<State>, options) {\n  const { data, activeSpectrum, activeTab: nucleus } = draft;\n  if (activeSpectrum?.id) {\n    const { index } = activeSpectrum;\n    const datum = data[index] as Datum1D;\n    setSumOptions(datum.integrals, { options, nucleus });\n    updateIntegralsRelativeValues(datum, true);\n  }\n}\n\nfunction addIntegral(draft: Draft<State>, action) {\n  const { startX, endX } = action;\n  const { data, molecules, activeTab: nucleus, activeSpectrum } = draft;\n  const [from, to] = getRange(draft, { startX, endX });\n\n  if (activeSpectrum?.id) {\n    const datum = data[activeSpectrum.index] as Datum1D;\n\n    const { x, re } = datum.data;\n\n    const shiftX = getShiftX(datum);\n\n    const integral = {\n      id: generateID(),\n      originFrom: from - shiftX,\n      originTo: to - shiftX,\n      from,\n      to,\n      absolute: xyIntegration({ x, y: re }, { from, to, reverse: true }), // the real value\n      kind: 'signal',\n    };\n    datum.integrals.values.push(integral);\n    datum.integrals.options = initSumOptions(datum.integrals.options, {\n      molecules,\n      nucleus,\n    });\n    updateIntegralsRelativeValues(datum);\n    setIntegralsYDomain(draft, datum);\n  }\n}\n\nfunction deleteIntegral(draft: Draft<State>, action) {\n  if (draft.activeSpectrum) {\n    const state = original(draft) as State;\n    const { index } = draft.activeSpectrum;\n    const { integralID } = action;\n\n    const datum = draft.data[index] as Datum1D;\n\n    if (integralID == null) {\n      datum.integrals.values = [];\n    } else {\n      const peakIndex = (\n        state.data[index] as Datum1D\n      ).integrals.values.findIndex((p) => p.id === integralID);\n      datum.integrals.values.splice(peakIndex, 1);\n      updateIntegralsRelativeValues(datum);\n    }\n  }\n}\n\nfunction changeIntegral(draft: Draft<State>, action) {\n  const state = original(draft) as State;\n  const integral = action.payload.data;\n\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n\n    const originalDatum = state.data[index] as Datum1D;\n    const datum = draft.data[index] as Datum1D;\n\n    const { x, re } = originalDatum.data;\n    const integralIndex = originalDatum.integrals.values.findIndex(\n      (i) => i.id === integral.id,\n    );\n\n    if (integralIndex !== -1) {\n      datum.integrals.values[integralIndex] = {\n        originFrom: integral.from,\n        originTo: integral.to,\n        ...integral,\n        absolute: xyIntegration(\n          { x, y: re },\n          { from: integral.from, to: integral.to, reverse: true },\n        ),\n      };\n      updateIntegralsRelativeValues(datum);\n    }\n  }\n}\n\nfunction handleChangeIntegralsRelativeValue(draft: Draft<State>, action) {\n  const data = action.payload.data;\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n    changeIntegralsRelative(draft.data[index] as Datum1D, data);\n  }\n}\n\nfunction handleChangeIntegralsSumFlag(draft, action) {\n  const flag = action.payload;\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n    draft.data[index].integrals.options.isSumConstant = !flag;\n  }\n}\n\nexport {\n  handleChangeIntegralSum,\n  addIntegral,\n  deleteIntegral,\n  changeIntegral,\n  handleChangeIntegralsRelativeValue,\n  handleChangeIntegralsSumFlag,\n};\n","import { Molecule as OCLMolecule } from 'openchemlib/full';\n\nimport { initMolecule, Molecule } from './Molecule';\n\nexport function fromJSON(mols: any[] = []) {\n  const molecules: Molecule[] = [];\n  for (const mol of mols) {\n    const molecule = OCLMolecule.fromMolfile(mol.molfile);\n    const fragments = molecule.getFragments();\n    for (let fragment of fragments) {\n      molecules.push(\n        initMolecule({\n          molfile: fragment.toMolfileV3(),\n        }),\n      );\n    }\n  }\n\n  return molecules;\n}\n\nexport function addMolfile(molecules, molfile) {\n  // try to parse molfile\n  // this will throw if the molecule can not be parsed !\n  const molecule = OCLMolecule.fromMolfile(molfile);\n  let fragments = molecule.getFragments();\n  for (let fragment of fragments) {\n    molecules.push(\n      initMolecule({\n        molfile: fragment.toMolfileV3(),\n      }),\n    );\n  }\n  // we will split if we have many fragments\n}\n\nexport function setMolfile(molecules, molfile, key) {\n  // try to parse molfile\n  // this will throw if the molecule can not be parsed !\n  let molecule = OCLMolecule.fromMolfile(molfile);\n  let fragments = molecule.getFragments();\n\n  if (fragments.length > 1) {\n    molecules = molecules.filter((m) => m.key !== key);\n\n    for (let fragment of fragments) {\n      molecules.push(\n        initMolecule({\n          molfile: fragment.toMolfileV3(),\n        }),\n      );\n    }\n  } else if (fragments.length === 1) {\n    const fragment = fragments[0];\n    const _mol = initMolecule({\n      molfile: fragment.toMolfileV3(),\n      key: key,\n    });\n    let molIndex = molecules.findIndex((m) => m.key === key);\n    molecules.splice(molIndex, 1, _mol);\n  }\n\n  // we will split if we have many fragments\n}\n","export type ActionType<Action, Payload = void> = Payload extends void\n  ? { type: Action }\n  : { type: Action; payload: Payload };\n\nexport const INITIATE = 'INITIATE';\nexport const SAVE_DATA_AS_JSON = 'SAVE_DATA_AS_JSON';\nexport const LOAD_JSON_FILE = 'LOAD_JSON_FILE';\nexport const LOAD_JCAMP_FILE = 'LOAD_JCAMP_FILE';\nexport const LOAD_NMREDATA_FILE = 'LOAD_NMREDATA_FILE';\nexport const LOAD_MOL_FILE = 'LOAD_MOL_FILE';\nexport const LOAD_ZIP_FILE = 'LOAD_ZIP_FILE';\nexport const LOAD_JDF_FILE = 'LOAD_JDF_FILE';\nexport const ADD_PEAK = 'ADD_PEAK';\nexport const ADD_PEAKS = 'ADD_PEAKS';\nexport const DELETE_PEAK_NOTATION = 'DELETE_PEAK_NOTATION';\nexport const SHIFT_SPECTRUM = 'SHIFT_SPECTRUM';\nexport const SET_X_DOMAIN = 'SET_X_DOMAIN';\nexport const SET_Y_DOMAIN = 'SET_Y_DOMAIN';\nexport const SET_ORIGINAL_DOMAIN = 'SET_ORIGINAL_DOMAIN';\nexport const SET_WIDTH = 'SET_WIDTH';\nexport const SET_DIMENSIONS = 'SET_DIMENSIONS';\nexport const SET_SELECTED_TOOL = 'SET_SELECTED_TOOL';\nexport const SET_SELECTED_FILTER = 'SET_SELECTED_FILTER';\nexport const CHANGE_SPECTRUM_SETTING = 'CHANGE_SPECTRUM_SETTING';\nexport const CHANGE_SPECTRUM_TYPE = 'CHANGE_SPECTRUM_TYPE';\nexport const FULL_ZOOM_OUT = 'FULL_ZOOM_OUT';\nexport const CHANGE_VISIBILITY = 'CHANGE_VISIBILITY';\nexport const CHANGE_PEAKS_MARKERS_VISIBILITY =\n  'CHANGE_PEAKS_MARKERS_VISIBILITY';\nexport const CHANGE_ACTIVE_SPECTRUM = 'CHANGE_ACTIVE_SPECTRUM';\nexport const CHANGE_SPECTRUM_COLOR = 'CHANGE_SPECTRUM_COLOR';\nexport const ADD_INTEGRAL = 'ADD_INTEGRAL';\nexport const DELETE_INTEGRAL = 'DELETE_INTEGRAL';\nexport const TOGGLE_REAL_IMAGINARY_VISIBILITY =\n  'TOGGLE_REAL_IMAGINARY_VISIBILITY';\nexport const SET_ZOOM = 'SET_ZOOM';\nexport const ADD_MOLECULE = 'ADD_MOLECULE';\nexport const SET_MOLECULE = 'SET_MOLECULE';\nexport const DELETE_MOLECULE = 'DELETE_MOLECULE';\nexport const SET_CORRELATION = 'SET_CORRELATION';\nexport const SET_CORRELATIONS = 'SET_CORRELATIONS';\nexport const DELETE_CORRELATION = 'DELETE_CORRELATION';\nexport const SET_CORRELATIONS_MF = 'SET_CORRELATIONS_MF';\nexport const SET_CORRELATIONS_TOLERANCE = 'SET_CORRELATIONS_TOLERANCE';\nexport const DELETE_SPECTRA = 'DELETE_SPECTRA';\nexport const CHANGE_SPECTRUM_DISPLAY_VIEW_MODE =\n  'CHANGE_SPECTRUM_DISPLAY_VIEW_MODE';\nexport const RESIZE_INTEGRAL = 'RESIZE_INTEGRAL';\nexport const BRUSH_END = 'BRUSH_END';\nexport const RESET_DOMAIN = 'RESET_X_DOMAIN';\nexport const ENABLE_FILTER = 'ENABLE_FILTER';\nexport const DELETE_FILTER = 'DELETE_FILTER';\nexport const DELETE_SPECTRA_FILTER = 'DELETE_SPECTRA_FILTER';\nexport const APPLY_ZERO_FILLING_FILTER = 'APPLY_ZERO_FILLING_FILTER';\nexport const APPLY_FFT_FILTER = 'APPLY_FFT_FILTER';\nexport const CALCULATE_MANUAL_PHASE_CORRECTION_FILTER =\n  'CALCULATE_MANUAL_PHASE_CORRECTION_FILTER';\nexport const APPLY_MANUAL_PHASE_CORRECTION_FILTER =\n  'APPLY_MANUAL_PHASE_CORRECTION_FILTER';\nexport const APPLY_AUTO_PHASE_CORRECTION_FILTER =\n  'APPLY_AUTO_PHASE_CORRECTION_FILTER';\nexport const APPLY_ABSOLUTE_FILTER = 'APPLY_ABSOLUTE_FILTER';\nexport const SET_VERTICAL_INDICATOR_X_POSITION =\n  'SET_VERTICAL_INDICATOR_X_POSITION';\nexport const AUTO_PEAK_PICKING = 'AUTO_PEAK_PICKING';\nexport const AUTO_RANGES_DETECTION = 'AUTO_RANGES_DETECTION';\nexport const AUTO_ZONES_DETECTION = 'AUTO_ZONES_DETECTION';\nexport const DELETE_RANGE = 'DELETE_RANGE';\nexport const DELETE_1D_SIGNAL = 'DELETE_1D_SIGNAL';\nexport const SET_SELECTED_OPTIONS_PANEL = 'SET_SELECTED_OPTIONS_PANEL';\nexport const SET_LOADING_FLAG = 'SET_LOADING_FLAG';\nexport const RESET_SELECTED_TOOL = 'RESET_SELECTED_TOOL';\nexport const SET_SPECTRUMS_VERTICAL_ALIGN = 'SET_SPECTRUMS_VERTICAL_AlIGN';\nexport const SAVE_AS_SVG = 'SAVE_AS_SVG';\nexport const CHANGE_INTEGRAL_DATA = 'CHANGE_INTEGRAL_DATA';\nexport const SET_ACTIVE_TAB = 'SET_ACTIVE_TAB';\nexport const CHANGE_INTEGRAL_SUM = 'CHANGE_INTEGRAL_SUM';\nexport const ADD_BASE_LINE_ZONE = 'ADD_BASE_LINE_ZONE';\nexport const DELETE_BASE_LINE_ZONE = 'DELETE_BASE_LINE_ZONE';\nexport const APPLY_BASE_LINE_CORRECTION_FILTER =\n  'APPLY_BASE_LINE_CORRECTION_FILTER';\nexport const SET_KEY_PREFERENCES = 'SET_KEY_PREFERENCES';\nexport const APPLY_KEY_PREFERENCES = 'APPLY_KEY_PREFERENCES';\nexport const RESIZE_RANGE = 'RESIZE_RANGE';\nexport const CHANGE_RANGE_SUM = 'CHANGE_RANGE_SUM';\nexport const ADD_RANGE = 'ADD_RANGE';\nexport const SET_2D_LEVEL = 'SET_2D_LEVEL';\nexport const ADD_2D_ZONE = 'ADD_2D_ZONE';\nexport const DELETE_2D_ZONE = 'DELETE_2D_ZONE';\nexport const DELETE_2D_SIGNAL = 'DELETE_2D_SIGNAL';\nexport const SET_2D_SIGNAL_PATH_LENGTH = 'SET_2D_SIGNAL_PATH_LENGTH';\nexport const ADD_MISSING_PROJECTION = 'ADD_MISSING_PROJECTION';\nexport const SET_FILTER_SNAPSHOT = 'SET_FILTER_SNAPSHOT';\nexport const CHANGE_RANGE_RELATIVE = 'CHANGE_RANGE_RELATIVE';\nexport const CHANGE_RANGE_SIGNAL_VALUE = 'CHANGE_RANGE_SIGNAL_VALUE';\nexport const CHANGE_RANGE_SIGNAL_KIND = 'CHANGE_RANGE_SIGNAL_KIND';\nexport const SAVE_EDITED_RANGE = 'SAVE_EDITED_RANGE';\nexport const UNLINK_RANGE = 'UNLINK_RANGE';\nexport const SET_DIAID_RANGE = 'SET_DIAID_RANGE';\nexport const CHANGE_INTEGRAL_RELATIVE = 'CHANGE_INTEGRAL_RELATIVE';\nexport const ANALYZE_SPECTRA = 'ANALYZE_SPECTRA';\nexport const DELETE_ANALYZE_SPECTRA_RANGE = 'DELETE_ANALYZE_SPECTRA_RANGE';\nexport const RESIZE_ANALYZE_SPECTRA_RANGE = 'RESIZE_ANALYZE_SPECTRA_RANGE';\nexport const SET_ANALYZE_SPECTRA_COLUMNS = 'SET_ANALYZE_SPECTRA_COLUMNS';\nexport const FILTER_SPECTRA_COLUMN = 'FILTER_SPECTRA_COLUMN';\nexport const ALIGN_SPECTRA = 'ALIGN_SPECTRA';\nexport const CHANGE_ZONE_SIGNAL_VALUE = 'CHANGE_ZONE_SIGNAL_VALUE';\nexport const CHANGE_ZONE_SIGNAL_KIND = 'CHANGE_ZONE_SIGNAL_KIND';\nexport const SAVE_EDITED_ZONE = 'SAVE_EDITED_ZONE';\nexport const UNLINK_ZONE = 'UNLINK_ZONE';\nexport const SET_DIAID_ZONE = 'SET_DIAID_ZONE';\nexport const PREDICT_SPECTRA = 'PREDICT_SPECTRA';\nexport const SET_SPECTRA_SAME_TOP = 'SET_SPECTRA_SAME_TOP';\nexport const RESET_SPECTRA_SCALE = 'RESET_SPECTRA_SCALE';\nexport const SET_MOUSE_OVER_DISPLAYER = 'SET_MOUSE_OVER_DISPLAYER';\nexport const APPLY_MULTIPLE_SPECTRA_FILTER = 'APPLY_MULTIPLE_SPECTRA_FILTER';\nexport const ADD_EXCLUSION_ZONE = 'ADD_EXCLUSION_ZONE';\nexport const DELETE_EXCLUSION_ZONE = 'DELETE_EXCLUSION_ZONE';\nexport const CHANGE_RANGES_SUM_FLAG = 'CHANGE_RANGES_SUM_FLAG';\nexport const CHANGE_INTEGRALS_SUM_FLAG = 'CHANGE_INTEGRALS_SUM_FLAG';\nexport const CHANGE_ZONES_NOISE_FACTOR = 'CHANGE_ZONES_NOISE_FACTOR';\nexport const CHANGE_TEMP_RANGE = 'CHANGE_TEMP_RANGE';\nexport const SHOW_MULTIPLICTY_TREES = 'SHOW_MULTIPLICTY_TREES';\nexport const SHOW_RANGES_INTEGRALS = 'SHOW_RANGES_INTEGRALS';\nexport const AUTO_RANGES_SPECTRA_PICKING = 'AUTO_RANGES_SPECTRA_PICKING';\nexport const AUTO_ZONES_SPECTRA_PICKING = 'AUTO_ZONES_SPECTRA_PICKING';\nexport const GENERATE_SPECTRUM_FROM_PUBLICATION_STRING =\n  'GENERATE_SPECTRUM_FROM_PUBLICATION_STRING';\nexport const RESURRECTING_SPECTRUM_FROM_RANGES =\n  'RESURRECTING_SPECTRUM_FROM_RANGES';\nexport const SHOW_J_GRAPH = 'SHOW_J_GRAPH';\nexport const SET_AUTOMATIC_ASSIGNMENTS = 'SET_AUTOMATIC_ASSIGNMENTS';\n","import { Draft } from 'immer';\nimport { buildCorrelationData, CorrelationData } from 'nmr-correlation';\n\nimport { addJcamps, addJDFs } from '../../../data/SpectraManager';\nimport * as MoleculeManager from '../../../data/molecules/MoleculeManager';\nimport { UsedColors } from '../../../types/UsedColors';\nimport { Molecules, NMRiumPreferences, Spectra } from '../../NMRium';\nimport { DefaultTolerance } from '../../panels/SummaryPanel/CorrelationTable/Constants';\nimport { getInitialState, State } from '../Reducer';\nimport { LOAD_JSON_FILE, LOAD_NMREDATA_FILE } from '../types/Types';\n\nimport { changeSpectrumVerticalAlignment } from './PreferencesActions';\nimport { setActiveTab } from './ToolsActions';\n\nfunction setIsLoading(draft: Draft<State>, isLoading: boolean) {\n  draft.isLoading = isLoading;\n}\n\nfunction setColors(draft: Draft<State>, colors: UsedColors) {\n  draft.usedColors['1d'] = draft.usedColors['1d'].concat(colors['1d']);\n  draft.usedColors['2d'] = draft.usedColors['2d'].concat(colors['2d']);\n}\n\nfunction setData(\n  draft: Draft<State>,\n  data: {\n    spectra: Spectra;\n    molecules: Molecules;\n    preferences: NMRiumPreferences;\n    correlations: CorrelationData;\n    usedColors: UsedColors;\n  },\n) {\n  const { spectra, molecules, correlations, usedColors } = data || {\n    spectra: [],\n    molecules: [],\n    correlations: {},\n    multipleAnalysis: {},\n    exclusionZones: [],\n  };\n  setColors(draft, usedColors);\n  draft.data = spectra;\n  draft.molecules = MoleculeManager.fromJSON(molecules);\n\n  if (!correlations || Object.keys(correlations).length === 0) {\n    draft.correlations = buildCorrelationData([], {\n      tolerance: DefaultTolerance,\n    });\n  } else {\n    // in case of older NMRium data are imported, convert hybridization string to number array\n    // @TODO remove following command to overwrite correlations at some point in future\n    draft.correlations =\n      convertHybridizationStringValuesInCorrelations(correlations);\n\n    // draft.correlations = correlations // original command without overwriting\n  }\n}\n\nfunction convertHybridizationStringValuesInCorrelations(\n  correlations: CorrelationData,\n): CorrelationData {\n  return {\n    ...correlations,\n    values: correlations.values.map((correlation) => {\n      if (typeof correlation.hybridization === 'string') {\n        let values: number[] = [];\n        if (correlation.hybridization.length > 0) {\n          const hybridizationString: string =\n            correlation.hybridization.replaceAll('SP', '');\n          const value = Number(hybridizationString);\n          values.push(value);\n        }\n        correlation.hybridization = values;\n      }\n      return correlation;\n    }),\n  };\n}\n\nfunction setPreferences(draft: Draft<State>, data) {\n  const emptyPreferences = {\n    verticalAlign: null,\n  };\n\n  const { verticalAlign = null } = data || emptyPreferences;\n\n  if (verticalAlign) {\n    changeSpectrumVerticalAlignment(draft, {\n      align: verticalAlign,\n    });\n  } else {\n    changeSpectrumVerticalAlignment(draft, { align: 'auto-check' });\n  }\n}\n\nfunction initiate(draft: Draft<State>, action) {\n  setData(draft, action.payload);\n  const preferences = action.payload?.preferences || {};\n  setActiveTab(draft, { tab: preferences?.activeTab || '' });\n  setPreferences(draft, action.payload);\n  draft.isLoading = false;\n}\n\nfunction loadJDFFile(draft: Draft<State>, actions) {\n  const { files } = actions;\n  const spectra = addJDFs(files, draft.usedColors);\n  for (const spectrum of spectra) {\n    draft.data.push(spectrum);\n  }\n\n  setActiveTab(draft);\n\n  draft.isLoading = false;\n}\n\nfunction loadJcampFile(draft: Draft<State>, actions) {\n  const { files } = actions;\n  const spectra = addJcamps(files, draft.usedColors);\n  for (const spectrum of spectra) {\n    draft.data.push(spectrum);\n  }\n  setActiveTab(draft);\n  changeSpectrumVerticalAlignment(draft, { align: 'auto-check' });\n\n  draft.isLoading = false;\n}\n\nfunction handleLoadJsonFile(draft: Draft<State>, action) {\n  const state = getInitialState();\n\n  setData(state, action.payload);\n  const preferences = action.payload?.preferences || {};\n  setActiveTab(state, { tab: preferences?.activeTab || '' });\n  setPreferences(state, preferences);\n\n  state.width = draft.width;\n  state.height = draft.height;\n  state.isLoading = false;\n  state.actionType = LOAD_JSON_FILE;\n  return state;\n}\n\nfunction handleLoadMOLFile(draft: Draft<State>, actions) {\n  const { files } = actions;\n  for (let file of files) {\n    MoleculeManager.addMolfile(draft.molecules, file.binary.toString());\n  }\n  draft.isLoading = false;\n}\n\nfunction handleLoadZIPFile(draft: Draft<State>, action) {\n  const { data, usedColors } = action.payload;\n  draft.data = draft.data.concat(data);\n  setColors(draft, usedColors);\n\n  setActiveTab(draft);\n  changeSpectrumVerticalAlignment(draft, { align: 'auto-check' });\n\n  draft.isLoading = false;\n}\n\nfunction handleLoadNmredata(draft: Draft<State>, action) {\n  const state = getInitialState();\n\n  setData(state, action.payload);\n  setActiveTab(state);\n  changeSpectrumVerticalAlignment(state, { align: 'auto-check' });\n  state.isLoading = false;\n  state.width = draft.width;\n  state.height = draft.height;\n  state.actionType = LOAD_NMREDATA_FILE;\n\n  return state;\n}\n\nexport {\n  setIsLoading,\n  initiate,\n  loadJcampFile,\n  loadJDFFile,\n  handleLoadJsonFile,\n  handleLoadNmredata,\n  handleLoadMOLFile,\n  handleLoadZIPFile,\n};\n","import { Draft } from 'immer';\n\nimport { generateSpectra } from '../../../data/PredictionManager';\nimport { changeSpectraRelativeSum } from '../../../data/data1d/Spectrum1D/SumManager';\nimport * as MoleculeManager from '../../../data/molecules/MoleculeManager';\nimport getColor from '../../../data/utilities/getColor';\nimport nucleusToString from '../../utility/nucleusToString';\nimport { State } from '../Reducer';\nimport { DISPLAYER_MODE } from '../core/Constants';\n\nimport { handleUnlinkRange } from './RangesActions';\nimport { setActiveTab } from './ToolsActions';\nimport { handleUnlinkZone } from './ZonesActions';\n\nfunction addMoleculeHandler(draft: Draft<State>, molfile) {\n  const isEmpty = draft.molecules.length === 0;\n  MoleculeManager.addMolfile(draft.molecules, molfile);\n\n  /**\n   *  if it's the first creation of a molecule after the molecules list was empty,\n   * set the relative sum for ranges and integrals base on the first molecule\n   */\n  const molecule = draft.molecules[0] || null;\n\n  if (isEmpty && molecule) {\n    changeSpectraRelativeSum(draft, molecule.key, molecule);\n  }\n}\n\nfunction setMoleculeHandler(draft: Draft<State>, molfile, key) {\n  MoleculeManager.setMolfile(draft.molecules, molfile, key);\n\n  /**\n   * update all spectra that its sum was based on this molecule with the new molecule\n   */\n  const index = draft.molecules.findIndex((molecule) => molecule.key === key);\n\n  changeSpectraRelativeSum(\n    draft,\n    key,\n    index !== -1 ? draft.molecules[index] : draft.molecules[0] || null,\n  );\n}\n\nfunction removeAssignments(draft: Draft<State>, assignmentData: any) {\n  if (draft.displayerMode === DISPLAYER_MODE.DM_1D) {\n    handleUnlinkRange(draft, { payload: { assignmentData, rangeData: null } });\n  }\n  if (draft.displayerMode === DISPLAYER_MODE.DM_2D) {\n    handleUnlinkZone(draft, { payload: { assignmentData, zoneData: null } });\n  }\n}\n\nfunction deleteMoleculeHandler(draft: Draft<State>, action) {\n  const { key, assignmentData } = action.payload;\n  // remove Assignments links of the active spectrum\n  removeAssignments(draft, assignmentData);\n\n  const moleculeIndex = draft.molecules.findIndex(\n    (molecule) => molecule.key === key,\n  );\n  draft.molecules.splice(moleculeIndex, 1);\n  /**\n   * update all spectra that its sum was based on this molecule with the first molecule\n   * from molecules list and if no remains molecules it sum will be 100\n   */\n  changeSpectraRelativeSum(draft, key, draft.molecules[0] || null);\n}\n\nfunction predictSpectraFromMoleculeHandler(draft: Draft<State>, action) {\n  const { data, options } = action.payload;\n  if (!data) {\n    draft.isLoading = false;\n  } else {\n    const color = getColor(false, draft.usedColors['1d']);\n    for (const spectrum of generateSpectra(data, options, color)) {\n      draft.data.push(spectrum);\n      draft.tabActiveSpectrum[nucleusToString(spectrum.info.nucleus)] = {\n        id: spectrum.id,\n        index: draft.data.length - 1,\n      };\n    }\n    draft.usedColors['1d'].push(color);\n  }\n  draft.toolOptions.data.predictionIndex++;\n  setActiveTab(draft);\n  draft.isLoading = false;\n}\n\nexport {\n  addMoleculeHandler,\n  setMoleculeHandler,\n  deleteMoleculeHandler,\n  predictSpectraFromMoleculeHandler,\n};\n","import { Draft, original } from 'immer';\nimport { xFindClosestIndex } from 'ml-spectra-processing';\n\nimport {\n  getShiftX,\n  lookupPeak,\n  autoPeakPicking,\n} from '../../../data/data1d/Spectrum1D';\nimport { Datum1D } from '../../../data/types/data1d';\nimport { Data1D } from '../../../data/types/data1d/Data1D';\nimport { Peak } from '../../../data/types/data1d/Peak';\nimport generateID from '../../../data/utilities/generateID';\nimport { options } from '../../toolbar/ToolTypes';\nimport { State } from '../Reducer';\nimport getRange from '../helper/getRange';\n\nfunction addPeak(draft: Draft<State>, mouseCoordinates) {\n  const state = original(draft) as State;\n  if (draft.activeSpectrum?.id && state) {\n    const { index } = draft.activeSpectrum;\n    const xShift = 10;\n    const startX = mouseCoordinates.x - xShift;\n    const endX = mouseCoordinates.x + xShift;\n    const [from, to] = getRange(draft, { startX, endX });\n    const candidatePeak = lookupPeak(state.data[index].data as Data1D, {\n      from,\n      to,\n    });\n\n    const shiftX = getShiftX(draft.data[index] as Datum1D);\n\n    if (candidatePeak) {\n      const peak: Peak = {\n        id: generateID(),\n        originalX: candidatePeak.x - shiftX,\n        x: candidatePeak.x,\n        y: candidatePeak.y,\n        width: 0,\n      };\n      (draft.data[index] as Datum1D).peaks.values.push(peak);\n    }\n  }\n}\n\nfunction addPeaks(draft: Draft<State>, action) {\n  const state = original(draft) as State;\n\n  if (draft.activeSpectrum) {\n    const { index } = draft.activeSpectrum;\n    const datumOriginal = state.data[index] as Datum1D;\n\n    const { startX, endX } = action;\n    const [from, to] = getRange(draft, { startX, endX });\n\n    if (from !== to) {\n      const peak = lookupPeak(datumOriginal.data, { from, to });\n\n      const shiftX = getShiftX(draft.data[index] as Datum1D);\n\n      if (peak && !datumOriginal.peaks.values.some((p) => p.x === peak.x)) {\n        const newPeak: Peak = {\n          id: generateID(),\n          originalX: peak.x - shiftX,\n          x: peak.x,\n          y: peak.y,\n          width: 0,\n        };\n        (draft.data[index] as Datum1D).peaks.values.push(newPeak);\n      }\n    }\n  }\n}\n\nfunction deletePeak(draft: Draft<State>, peakData) {\n  if (draft.activeSpectrum) {\n    const { index } = draft.activeSpectrum;\n    const state = original(draft) as State;\n\n    if (peakData == null) {\n      (draft.data[index] as Datum1D).peaks.values = [];\n    } else {\n      const peakIndex = (state.data[index] as Datum1D).peaks.values.findIndex(\n        (p) => p.id === peakData.id,\n      );\n      (draft.data[index] as Datum1D).peaks.values.splice(peakIndex, 1);\n    }\n  }\n}\n\nfunction handleAutoPeakPicking(draft: Draft<State>, autOptions) {\n  if (draft.activeSpectrum?.id) {\n    draft.toolOptions.selectedTool = options.zoom.id;\n    draft.toolOptions.selectedOptionPanel = null;\n    const { index } = draft.activeSpectrum;\n    const datum = draft.data[index] as Datum1D;\n\n    const [from, to] = draft.xDomain;\n    const windowFromIndex = xFindClosestIndex(datum.data.x, from);\n    const windowToIndex = xFindClosestIndex(datum.data.x, to);\n\n    const peaks = autoPeakPicking(draft.data[index] as Datum1D, {\n      ...autOptions,\n      windowFromIndex,\n      windowToIndex,\n    });\n\n    datum.peaks.values = datum.peaks.values.concat(peaks);\n  }\n}\n\nexport { addPeak, addPeaks, deletePeak, handleAutoPeakPicking };\n","export default function generateChar(index: number): string {\n  const aPotions = 'a'.charCodeAt(0);\n  const zPostion = 'z'.charCodeAt(0);\n  const len = zPostion - aPotions + 1;\n\n  let chartResult = '';\n  while (index >= 0) {\n    chartResult = String.fromCharCode((index % len) + aPotions) + chartResult;\n    index = Math.floor(index / len) - 1;\n  }\n  return chartResult;\n}\n","import lodashGet from 'lodash/get';\n\nimport { Spectra } from '../../component/NMRium';\nimport { RangeDetectionResult } from '../types/data1d';\nimport generateChar from '../utilities/generateChar';\n\nimport { detectRange, isSpectrum1D } from './Spectrum1D';\n\nexport enum COLUMNS_TYPES {\n  NORMAL = 'NORMAL',\n  FORMULA = 'FORMULA',\n}\nexport enum COLUMNS_VALUES_KEYS {\n  RELATIVE = 'relative',\n  ABSOLUTE = 'absolute',\n  MIN = 'min',\n  MAX = 'max',\n}\n\nexport type ColumnType = keyof typeof COLUMNS_TYPES;\n\ninterface Column {\n  type: ColumnType;\n  valueKey: COLUMNS_VALUES_KEYS;\n  from: number;\n  to: number;\n  formula?: string;\n  index: number;\n}\n\ntype Columns = Record<string, Column>;\n\ninterface AnalysisOptions {\n  sum: number;\n  code: string | null;\n  columns: Columns;\n  columnIndex: number;\n}\n\ninterface AnalysisRow extends RangeDetectionResult {\n  SID: string;\n  colKey?: string;\n  value?: number;\n}\n\ninterface SpectraAnalysisData {\n  options: AnalysisOptions;\n  values: Record<string, AnalysisRow>;\n}\n\nexport type SpectraAnalysis = Record<string, SpectraAnalysisData>;\n\nfunction addColumnKey(\n  spectraAnalysis: SpectraAnalysis,\n  nucleus: string,\n  columnProps: Column,\n  columnKey: string,\n) {\n  const key = columnKey\n    ? columnKey\n    : generateChar(spectraAnalysis[nucleus].options.columnIndex).toUpperCase();\n  spectraAnalysis[nucleus].options.columns[key] = columnProps;\n  spectraAnalysis[nucleus].options.columnIndex++;\n  return key;\n}\n\nexport function getColumns(spectraAnalysis: SpectraAnalysis, nucleus: string) {\n  return spectraAnalysis[nucleus].options.columns;\n}\n\nexport function getValue(colKey: string, columns: Columns, data) {\n  return data[columns[colKey].valueKey];\n}\n\nexport function getSpectraAnalysis(\n  spectra: Spectra,\n  options,\n): { values: Array<AnalysisRow>; sum: number } {\n  const { from, to, nucleus } = options;\n  return spectra.reduce<{ values: Array<AnalysisRow>; sum: number }>(\n    (acc, datum) => {\n      if (\n        isSpectrum1D(datum) &&\n        datum.info.nucleus === nucleus &&\n        !datum.info.isFid\n      ) {\n        const range = detectRange(datum, { from, to });\n        acc.sum += range.absolute;\n        acc.values.push({ SID: datum.id, ...range });\n      }\n      return acc;\n    },\n    { values: [], sum: 0 },\n  );\n}\n\nfunction init(spectraAnalysis: SpectraAnalysis, nucleus: string) {\n  if (spectraAnalysis[nucleus] === undefined) {\n    spectraAnalysis[nucleus] = {\n      options: {\n        sum: 100,\n        code: null,\n        columns: {},\n        columnIndex: 0,\n      },\n      values: {},\n    };\n  }\n}\n\nexport function changeColumnValueKey(\n  spectraAnalysis: SpectraAnalysis,\n  nucleus: string,\n  columnKey: string,\n  newKey: COLUMNS_VALUES_KEYS,\n) {\n  spectraAnalysis[nucleus].options.columns[columnKey].valueKey = newKey;\n\n  spectraAnalysis[nucleus].values = refreshCalculation(\n    spectraAnalysis,\n    nucleus,\n  );\n}\n\nexport function setColumn(\n  spectraAnalysis: SpectraAnalysis,\n  nucleus: string,\n  { columns: inputColumns, code },\n) {\n  init(spectraAnalysis, nucleus);\n  spectraAnalysis[nucleus].options.code = code;\n  spectraAnalysis[nucleus].options.columns = Object.values(\n    inputColumns,\n  ).reduce<any>((acc, value: any) => {\n    const data = { ...value };\n    delete data.tempKey;\n    acc[value.tempKey] = data;\n    return acc;\n  }, {});\n\n  const { columns: newColumns } = spectraAnalysis[nucleus].options;\n\n  let data = Object.entries(spectraAnalysis[nucleus].values).reduce<any>(\n    (outerAcc, [spectraKey, spectra]) => {\n      outerAcc[spectraKey] = Object.keys(inputColumns).reduce((acc, key) => {\n        const newKey = inputColumns[key].tempKey;\n        if (spectra[key]) {\n          acc[newKey] = spectra[key];\n        }\n        return acc;\n      }, {});\n      return outerAcc;\n    },\n    {},\n  );\n\n  data = Object.entries(data).reduce((acc, spectra: any) => {\n    acc[spectra[0]] = Object.keys(newColumns).reduce((acc, key) => {\n      const isFormula = newColumns[key].type === COLUMNS_TYPES.FORMULA;\n      acc[key] = isFormula\n        ? {\n            colKey: key,\n            value: calculate(\n              newColumns,\n              data[spectra[0]],\n              newColumns[key].formula,\n            ),\n          }\n        : { ...spectra[1][key], colKey: key };\n\n      return acc;\n    }, {});\n\n    return acc;\n  }, {});\n  spectraAnalysis[nucleus].values = data;\n}\n\nfunction refreshByRow(row, columns) {\n  return Object.keys(columns).reduce((acc, key) => {\n    if (columns[key].type === COLUMNS_TYPES.FORMULA) {\n      acc[key] = {\n        colKey: key,\n        ...row,\n        value: calculate(columns, row, columns[key].formula),\n      };\n    }\n\n    return acc;\n  }, {});\n}\n\nfunction refreshCalculation(spectraAnalysis: SpectraAnalysis, nucleus: string) {\n  const { columns } = spectraAnalysis[nucleus].options;\n\n  const data = Object.entries(spectraAnalysis[nucleus].values).reduce(\n    (acc, spectra) => {\n      const [id, row] = spectra;\n      acc[id] = {\n        ...row,\n        ...refreshByRow(row, columns),\n      };\n      return acc;\n    },\n    {},\n  );\n\n  return data;\n}\n\nexport function analyzeSpectra(\n  spectra,\n  spectraAnalysis: SpectraAnalysis,\n  options,\n) {\n  const { from, to, nucleus, columnKey = null } = options;\n  init(spectraAnalysis, nucleus);\n  const colKey = addColumnKey(\n    spectraAnalysis,\n    nucleus,\n    {\n      type: COLUMNS_TYPES.NORMAL,\n      valueKey: COLUMNS_VALUES_KEYS.RELATIVE,\n      from,\n      to,\n      index: 1,\n    },\n    columnKey,\n  );\n\n  const { sum } = spectraAnalysis[nucleus].options;\n\n  const { values: result, sum: spectraSum } = getSpectraAnalysis(spectra, {\n    from,\n    to,\n    nucleus,\n  });\n\n  const prevNucleusData = lodashGet(spectraAnalysis, `${nucleus}.values`, {});\n\n  let data = result.reduce((acc, row) => {\n    const factor = spectraSum > 0 ? sum / spectraSum : 0.0;\n\n    acc[row.SID] = {\n      ...prevNucleusData[row.SID],\n      [colKey]: {\n        colKey,\n        ...row,\n        relative: Math.abs(row.absolute) * factor,\n      },\n    };\n    return acc;\n  }, {});\n\n  spectraAnalysis[nucleus].values = data;\n  spectraAnalysis[nucleus].values = refreshCalculation(\n    spectraAnalysis,\n    nucleus,\n  );\n}\n\nexport function deleteSpectraAnalysis(\n  spectraAnalysis: SpectraAnalysis,\n  colKey: string,\n  nucleus: string,\n) {\n  const result = Object.entries(spectraAnalysis[nucleus].values).reduce(\n    (acc, item: any) => {\n      // eslint-disable-next-line @typescript-eslint/no-dynamic-delete\n      delete item[1][colKey];\n      if (item[1] && Object.keys(item[1]).length > 0) {\n        acc[item[0]] = item[1];\n        return acc;\n      }\n      return acc;\n    },\n    {},\n  );\n\n  const { [colKey]: deletedColumnKey, ...resColumns } =\n    spectraAnalysis[nucleus].options.columns;\n\n  const currentColumns = Object.keys(spectraAnalysis[nucleus].options.columns);\n\n  if (currentColumns.length === 1) {\n    spectraAnalysis[nucleus].options.columnIndex = 0;\n  }\n\n  spectraAnalysis[nucleus].options.columns = resColumns;\n  spectraAnalysis[nucleus].values = result;\n  spectraAnalysis[nucleus].values = refreshCalculation(\n    spectraAnalysis,\n    nucleus,\n  );\n}\n\nfunction calculate(columns: Columns, data: AnalysisRow, formula = '') {\n  const array = formula.split(/\\+|-|\\*|\\/|%|\\(|\\)/);\n\n  const variables: string[] = [];\n\n  for (const col of array) {\n    const column = col.trim();\n    if (columns[column]) {\n      variables.push(column);\n    }\n  }\n\n  const params = variables.map((key) =>\n    data[key] ? data[key][columns[key].valueKey] : null,\n  );\n\n  let result;\n  try {\n    result = new Function(...variables, `return ${formula}`)(...params);\n  } catch (e) {\n    // eslint-disable-next-line no-console\n    console.error(e);\n    result = new Error(`Invalid Formula ( ${formula} ) `);\n  }\n  return result;\n}\n\nexport function getDataAsString(\n  spectraAnalysis: SpectraAnalysis,\n  nucleus: string,\n) {\n  if (spectraAnalysis?.[nucleus]) {\n    const {\n      values,\n      options: { columns },\n    } = spectraAnalysis[nucleus];\n\n    let result = '';\n\n    for (const letter in columns) {\n      result += `${letter}\\t`;\n    }\n    result += '\\n';\n\n    for (const spectrum of Object.values(values)) {\n      for (const letter in columns) {\n        result += `${spectrum[letter][columns[letter].valueKey]}\\t`;\n      }\n      result += '\\n';\n    }\n    return result;\n  }\n  return null;\n}\n","import { Draft } from 'immer';\n\nimport * as MultipleAnalysis from '../../../data/data1d/MultipleAnalysis';\nimport { State } from '../Reducer';\nimport getRange from '../helper/getRange';\n\nfunction analyzeSpectra(draft: Draft<State>, action) {\n  const [from, to] = getRange(draft, action);\n  MultipleAnalysis.analyzeSpectra(draft.data, draft.spectraAnalysis, {\n    from,\n    to,\n    nucleus: draft.activeTab,\n  });\n}\n\nfunction handleDeleteSpectraRanges(draft: Draft<State>, action) {\n  const { colKey } = action;\n\n  MultipleAnalysis.deleteSpectraAnalysis(\n    draft.spectraAnalysis,\n    colKey,\n    draft.activeTab,\n  );\n}\nfunction handleResizeSpectraRange(draft: Draft<State>, action) {\n  const { columnKey, from, to } = action.payload;\n  MultipleAnalysis.analyzeSpectra(draft.data, draft.spectraAnalysis, {\n    from,\n    to,\n    nucleus: draft.activeTab,\n    columnKey,\n  });\n}\nfunction handleSetColumns(draft: Draft<State>, action) {\n  const data = action.payload;\n\n  MultipleAnalysis.setColumn(draft.spectraAnalysis, draft.activeTab, data);\n}\nfunction handleFilterColumn(draft: Draft<State>, action) {\n  const { columnKey, valueKey } = action.payload;\n\n  MultipleAnalysis.changeColumnValueKey(\n    draft.spectraAnalysis,\n    draft.activeTab,\n    columnKey,\n    valueKey,\n  );\n}\n\nexport {\n  analyzeSpectra,\n  handleDeleteSpectraRanges,\n  handleResizeSpectraRange,\n  handleSetColumns,\n  handleFilterColumn,\n};\n","import { Draft, original } from 'immer';\n\nimport * as Filters from '../../../data/Filters';\nimport { applyFilter } from '../../../data/FiltersManager';\nimport {\n  generateSpectrumFromPublicationString,\n  getReferenceShift,\n} from '../../../data/data1d/Spectrum1D';\nimport { getMissingProjection } from '../../../data/data2d/Spectrum2D';\nimport { Datum1D } from '../../../data/types/data1d';\nimport { Datum2D } from '../../../data/types/data2d';\nimport { options } from '../../toolbar/ToolTypes';\nimport GroupByInfoKey from '../../utility/GroupByInfoKey';\nimport { State } from '../Reducer';\nimport { setZoom } from '../helper/Zoom1DManager';\n\nimport { setDomain, setMode } from './DomainActions';\nimport { resetSpectrumByFilter } from './FiltersActions';\nimport { setTab, setActiveTab } from './ToolsActions';\n\nfunction checkIsVisible2D(datum: Datum2D): boolean {\n  if (\n    datum.display.isPositiveVisible === false &&\n    datum.display.isNegativeVisible === false\n  ) {\n    return false;\n  }\n  return true;\n}\n\nfunction setVisible(datum, flag) {\n  if (datum.info.dimension === 2) {\n    (datum as Datum2D).display.isPositiveVisible = flag;\n    (datum as Datum2D).display.isNegativeVisible = flag;\n    (datum as Datum2D).display.isVisible = checkIsVisible2D(datum as Datum2D);\n  } else {\n    (datum as Datum1D).display.isVisible = flag;\n  }\n}\n\nfunction handleSpectrumVisibility(draft: Draft<State>, action) {\n  if (Array.isArray(action.id)) {\n    const IDs = action.id;\n    if (IDs.length === 0) {\n      for (const datum of draft.data) {\n        setVisible(datum, false);\n      }\n    } else {\n      for (const datum of draft.data) {\n        if (IDs.includes(datum.id)) {\n          setVisible(datum, true);\n        } else {\n          setVisible(datum, false);\n        }\n      }\n    }\n  } else {\n    const index = draft.data.findIndex((d) => d.id === action.id);\n    (draft.data[index] as Datum1D | Datum2D).display[action.key] = action.value;\n\n    if ((draft.data[index] as Datum1D | Datum2D).info.dimension === 2) {\n      (draft.data[index] as Datum2D).display.isVisible = checkIsVisible2D(\n        draft.data[index] as Datum2D,\n      );\n    }\n  }\n}\n\nfunction handleChangePeaksMarkersVisibility(draft: Draft<State>, data) {\n  for (let datum of draft.data) {\n    if (\n      datum.info?.dimension === 1 &&\n      data.some((activeData) => activeData.id === datum.id)\n    ) {\n      (datum as Datum1D).display.isPeaksMarkersVisible = true;\n    } else {\n      (datum as Datum1D).display.isPeaksMarkersVisible = false;\n    }\n  }\n}\n\nfunction handleChangeActiveSpectrum(draft: Draft<State>, activeSpectrum) {\n  let refreshDomain = false;\n\n  const currentActiveSpectrum = draft.activeSpectrum;\n  if (activeSpectrum) {\n    const newIndex = draft.data.findIndex((d) => d.id === activeSpectrum.id);\n    const oldIndex = draft.data.findIndex(\n      (d) => d.id === draft.activeSpectrum?.id,\n    );\n    if (newIndex !== -1) {\n      const newActiveSpectrum = draft.data[newIndex] as Datum1D | Datum2D;\n\n      newActiveSpectrum.display.isVisible = true;\n\n      if (oldIndex !== -1) {\n        refreshDomain =\n          (draft.data[oldIndex] as Datum1D | Datum2D).info.isFid ===\n          newActiveSpectrum.info.isFid\n            ? false\n            : true;\n      } else {\n        refreshDomain = newActiveSpectrum.info.isFid || false;\n      }\n    }\n    activeSpectrum = { ...activeSpectrum, index: newIndex };\n    draft.activeSpectrum = activeSpectrum;\n    draft.tabActiveSpectrum[draft.activeTab] = activeSpectrum;\n  } else {\n    if (currentActiveSpectrum) {\n      const index = draft.data.findIndex(\n        (d) => d.id === currentActiveSpectrum.id,\n      );\n      refreshDomain = draft.data[index].info.isFid;\n    } else {\n      refreshDomain = false;\n    }\n    draft.activeSpectrum = null;\n    draft.tabActiveSpectrum[draft.activeTab] = null;\n  }\n\n  if (options[draft.toolOptions.selectedTool].isFilter) {\n    draft.toolOptions.selectedTool = options.zoom.id;\n    draft.toolOptions.data.baseLineZones = [];\n    draft.toolOptions.selectedOptionPanel = null;\n    draft.tempData = null;\n  }\n\n  /**\n   * if the active spectrum not is FID then dont refresh the domain and the mode when the first time you activate soectrum\n   * if the new active spectrum different than the previous active spectrum fid then refresh the domain andf the mode.\n   */\n  if (draft.toolOptions.data.activeFilterID) {\n    resetSpectrumByFilter(draft, null, {}, currentActiveSpectrum);\n  } else if (refreshDomain) {\n    setDomain(draft);\n    setMode(draft);\n  }\n}\n\nfunction changeSpectrumSetting(draft: Draft<State>, { id, display }) {\n  const state = original(draft) as State;\n  const index = state.data.findIndex((d) => d.id === id);\n  if (index !== -1) {\n    draft.data[index].display = display;\n  }\n}\nfunction handleChangeSpectrumColor(draft: Draft<State>, { id, color, key }) {\n  const state = original(draft) as State;\n  const index = state.data.findIndex((d) => d.id === id);\n  if (index !== -1) {\n    (draft.data[index] as Datum1D | Datum2D).display[key] = color;\n  }\n}\n\nfunction handleDeleteSpectra(draft: Draft<State>, action) {\n  const state = original(draft) as State;\n  if (action.id) {\n    const index = state.data.findIndex((d) => d.id === action.id);\n    draft.data.splice(index, 1);\n  } else {\n    draft.data = [];\n  }\n  setActiveTab(draft, { tab: draft.activeTab, refreshActiveTab: true });\n}\nfunction addMissingProjectionHandler(draft, action) {\n  const state = original(draft);\n  const { nucleus } = action;\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n    for (let n of nucleus) {\n      const datum1D = getMissingProjection(\n        state.data[index],\n        n,\n        draft.usedColors,\n      );\n      draft.data.push(datum1D);\n    }\n    const groupByNucleus = GroupByInfoKey('nucleus');\n    const dataGroupByNucleus = groupByNucleus(draft.data);\n    setTab(draft, dataGroupByNucleus, draft.activeTab, true);\n    setDomain(draft);\n    setMode(draft);\n  }\n}\nfunction alignSpectraHandler(draft: Draft<State>, action) {\n  if (draft.data && draft.data.length > 0) {\n    for (let datum of draft.data) {\n      if (\n        datum.info?.dimension === 1 &&\n        datum.info.nucleus === draft.activeTab &&\n        !datum.info?.isFid\n      ) {\n        const shift = getReferenceShift(datum, { ...action.payload });\n        applyFilter(datum, [\n          {\n            name: Filters.shiftX.id,\n            options: shift,\n          },\n        ]);\n      }\n    }\n  }\n\n  setDomain(draft);\n  setMode(draft);\n}\n\nfunction generateSpectrumFromPublicationStringHandler(\n  draft: Draft<State>,\n  action,\n) {\n  const publicationString = action.payload.publicationText;\n\n  const spectrum = generateSpectrumFromPublicationString(\n    publicationString,\n    draft.usedColors,\n  );\n  draft.data.push(spectrum);\n  setActiveTab(draft);\n  setZoom(draft, { scale: 0.8, spectrumID: spectrum.id });\n}\n\nexport {\n  handleSpectrumVisibility,\n  handleChangePeaksMarkersVisibility,\n  handleChangeActiveSpectrum,\n  handleChangeSpectrumColor,\n  changeSpectrumSetting,\n  handleDeleteSpectra,\n  addMissingProjectionHandler,\n  alignSpectraHandler,\n  generateSpectrumFromPublicationStringHandler,\n};\n","export const UNDO = 'undo';\nexport const REDO = 'redo';\nexport const SET = 'set';\nexport const RESET = 'reset';\n","import { Draft, produce } from 'immer';\nimport { buildCorrelationData, CorrelationData } from 'nmr-correlation';\n\nimport { predictSpectra } from '../../data/PredictionManager';\nimport * as SpectraManager from '../../data/SpectraManager';\nimport { SpectraAnalysis } from '../../data/data1d/MultipleAnalysis';\nimport { migrate } from '../../data/migration/MigrationManager';\nimport { Molecule } from '../../data/molecules/Molecule';\nimport { Range } from '../../data/types/data1d';\nimport { Contours } from '../../data/types/data2d/Contours';\nimport generateID from '../../data/utilities/generateID';\nimport { UsedColors } from '../../types/UsedColors';\nimport { Spectra } from '../NMRium';\nimport { DefaultTolerance } from '../panels/SummaryPanel/CorrelationTable/Constants';\nimport { options } from '../toolbar/ToolTypes';\nimport { nmredataToNmrium } from '../utility/nmredataToNmrium';\n\nimport * as AssignmentsActions from './actions/AssignmentsActions';\nimport * as CorrelationsActions from './actions/CorrelationsActions';\nimport * as DatabaseActions from './actions/DatabaseActions';\nimport { setWidth, handleSetDimensions } from './actions/DimensionsActions';\nimport * as DomainActions from './actions/DomainActions';\nimport * as FiltersActions from './actions/FiltersActions';\nimport * as GlobalActions from './actions/GlobalActions';\nimport {\n  handleHistoryUndo,\n  handleHistoryRedo,\n  handleHistoryReset,\n} from './actions/HistoryActions';\nimport * as IntegralsActions from './actions/IntegralsActions';\nimport * as LoadActions from './actions/LoadActions';\nimport * as MoleculeActions from './actions/MoleculeActions';\nimport * as PeaksActions from './actions/PeaksActions';\nimport {\n  setKeyPreferencesHandler,\n  applyKeyPreferencesHandler,\n} from './actions/PreferencesActions';\nimport * as RangesActions from './actions/RangesActions';\nimport * as SpectraAnalysisActions from './actions/SpectraAnalysisAction';\nimport * as SpectrumsActions from './actions/SpectrumsActions';\nimport * as ToolsActions from './actions/ToolsActions';\nimport * as ZonesActions from './actions/ZonesActions';\nimport { DEFAULT_YAXIS_SHIFT_VALUE, DISPLAYER_MODE } from './core/Constants';\nimport { ZoomHistory } from './helper/ZoomHistoryManager';\nimport { UNDO, REDO, RESET } from './types/HistoryTypes';\nimport * as types from './types/Types';\n\nexport interface ActiveSpectrum {\n  id: string;\n  index: number;\n}\n\nexport interface Margin {\n  top: number;\n  right: number;\n  bottom: number;\n  left: number;\n}\nexport const getInitialState = (): State => ({\n  actionType: '',\n  data: [],\n  contours: {} as Contours,\n  tempData: null,\n  xDomain: [],\n  yDomain: [],\n  yDomains: {},\n  xDomains: {},\n  originDomain: {\n    xDomain: [],\n    yDomain: [],\n    xDomains: {},\n    yDomains: {},\n    shareYDomain: false,\n  },\n  integralsYDomains: {},\n  activeTab: '',\n  width: 0,\n  height: 0,\n  margin: {\n    top: 10,\n    right: 20,\n    bottom: 70,\n    left: 0,\n  },\n  activeSpectrum: null,\n  mode: 'RTL',\n  molecules: [],\n  verticalAlign: {\n    align: 'bottom',\n    verticalShift: DEFAULT_YAXIS_SHIFT_VALUE,\n  },\n  history: {\n    past: [],\n    present: null,\n    future: [],\n    hasUndo: false,\n    hasRedo: false,\n  },\n  isLoading: false,\n  keysPreferences: {},\n  displayerMode: DISPLAYER_MODE.DM_1D,\n  tabActiveSpectrum: {},\n  spectraAnalysis: {},\n  correlations: {},\n  displayerKey: '',\n  zoom: {\n    history: {} as ZoomHistory,\n  },\n  overDisplayer: false,\n  toolOptions: {\n    selectedTool: options.zoom.id,\n    selectedOptionPanel: null,\n    data: {\n      baseLineZones: [],\n      pivot: { value: 0, index: 0 },\n      zonesNoiseFactor: 1,\n      activeFilterID: null,\n      tempRange: null,\n      showMultiplicityTrees: false,\n      showRangesIntegrals: true,\n      showJGraph: false,\n      predictionIndex: 0,\n    },\n  },\n  usedColors: { '1d': [], '2d': [] },\n});\n\nexport const initialState = getInitialState();\n\nexport type VerticalAlignment = 'bottom' | 'center' | 'stack';\nexport interface VerticalAlign {\n  align: VerticalAlignment;\n  verticalShift: number;\n}\nexport interface State {\n  /**\n   * Last action type\n   *  base on the action type we can decide to trigger or not the callback function (onDataChange)\n   */\n  actionType: string;\n  /**\n   * spectra list (1d and 2d)\n   */\n  data: Spectra;\n  /**\n   * calculated contours for 2d spectra\n   */\n  contours: Contours;\n  /**\n   * snapshot of the spectra data once phase correction activated\n   *\n   */\n  tempData: any;\n  /**\n   * X axis domain\n   * value change when zooming in/out\n   * @default []\n   */\n  xDomain: Array<number>;\n  /**\n   * Y axis domain\n   * value change when vertical scale change for all spectra\n   * @default []\n   */\n  yDomain: Array<number>;\n\n  /**\n   * Y axis domain per spectrum\n   * value change when vertical scale change for the selected spectrum\n   * @default {}\n   */\n  yDomains: Record<string, Array<number>>;\n  /**\n   * X axis domain per spectrum\n   * value change when zooming in/out for the selected spectrum\n   * @default {}\n   */\n  xDomains: Record<string, Array<number>>;\n  /**\n   * Domain for X and Y axis once it calculated and it change in one case  when we load new spectra\n   * @default {}\n   */\n  originDomain: {\n    xDomain: Array<number>;\n    yDomain: Array<number>;\n    xDomains: Record<string, Array<number>>;\n    yDomains: Record<string, Array<number>>;\n    shareYDomain: boolean;\n  };\n  /**\n   * y axis domain per spectrum for integrals\n   * value change when vertical scale change for the integrals\n   * @default {}\n   */\n  integralsYDomains: Record<string, Array<number>>;\n\n  /**\n   * current select tab (nucleus)\n   * @default null\n   */\n  activeTab: string;\n  /**\n   * plot chart area width\n   * @default 0\n   */\n  width: number;\n  /**\n   * plot chart area height\n   * @default 0\n   */\n  height: number;\n  /**\n   * The margin Around the plot chart area\n   * @default {top: 10,right: 20,bottom: 70,left: 0}\n   */\n  margin: Margin;\n  /**\n   * current active spectrum\n   * @default null\n   */\n  activeSpectrum: ActiveSpectrum | null;\n  /**\n   * Scale direction\n   * @default 'RTL'\n   */\n  mode: 'RTL' | 'LTR';\n  /**\n   * molecules\n   * @default []\n   */\n  molecules: Array<Molecule>;\n  /**\n   * options to control spectra vertical alignment\n   * @default {align: 'bottom',value: DEFAULT_YAXIS_SHIFT_VALUE}\n   */\n  verticalAlign: VerticalAlign;\n  /**\n   * @todo for undo /redo features\n   */\n  history: Partial<{\n    past: Array<any>;\n    present: any;\n    future: Array<any>;\n    hasUndo: boolean;\n    hasRedo: boolean;\n  }>;\n\n  /**\n   * hide/show main loading indicator\n   * @default false\n   */\n  isLoading: boolean;\n\n  /**\n   * temporary snapshot of state once the user press on number from 1-9\n   */\n  keysPreferences: any;\n\n  /**\n   * displayer mode '1D' or '2D'\n   * @default '1D'\n   */\n  displayerMode: DISPLAYER_MODE;\n\n  /**\n   * active spectrum per nucleus\n   * @default {}\n   */\n  tabActiveSpectrum: Record<string, ActiveSpectrum | null>;\n\n  /**\n   * Multiple spectra analysis data\n   */\n\n  spectraAnalysis: SpectraAnalysis;\n  /**\n   * unique key identifier per Displayer instance\n   */\n  displayerKey: string;\n\n  /**\n   * Correlation data\n   */\n  correlations: CorrelationData;\n\n  /**\n   * Zoom Manager for vertical scale for spectra, integral, And undo zoom in per tab (nucleus)\n   * @default  {history: {},spectra: {},integral: {}}\n   */\n  zoom: {\n    history: ZoomHistory;\n  };\n\n  /**\n   * boolean indicator to check if the mouse over the displayer or not\n   * value change to true once the mouse come over the displayer and vice versa true once the mouse out of the displayer\n   * @default false\n   */\n  overDisplayer: boolean;\n\n  /**\n   * Basic options for the tools\n   */\n  toolOptions: {\n    /**\n     * The current selected tool\n     * @default `options.zoom.id`\n     */\n    selectedTool: string;\n    /**\n     * The current active options panel\n     * Part of tools has an options panel for more control over the tool, once the user select the tool then the options panel will be shown in the header\n     * @default null\n     */\n    selectedOptionPanel: string | null;\n\n    /**\n     * extra data for tools\n     */\n    data: {\n      /**\n       * list of zones for Baseline correction filter\n       */\n      baseLineZones: any;\n      /**\n       * pivot point for manual phase correction\n       * @default {value:0,index:0}\n       */\n      pivot: { value: number; index: number };\n      /**\n       * Noise factor for auto zones detection\n       * @default 1\n       */\n      zonesNoiseFactor: number;\n\n      /**\n       * The current active Filter\n       * @default null\n       */\n      activeFilterID: string | null;\n\n      /**\n       * copy of the range that the user start editing for multiplicity tree live updating\n       */\n      tempRange: Range | null;\n      /**\n       * boolean indicator to hide/show multiplicity tree\n       * @default false\n       */\n      showMultiplicityTrees: boolean;\n      /**\n       * boolean indicator to hide/show integrals for the spectrum ranges\n       * @default false\n       */\n      showRangesIntegrals: boolean;\n\n      /**\n       * boolean indicator to hide/show J graph for spectrum signals\n       * @default false\n       */\n\n      showJGraph: boolean;\n\n      /**\n       * prediction Index\n       * @default 0\n       */\n      predictionIndex: number;\n    };\n  };\n\n  usedColors: UsedColors;\n}\n\nexport function initState(state: State): State {\n  const displayerKey = generateID();\n  const correlations = buildCorrelationData([], {\n    tolerance: DefaultTolerance,\n  });\n\n  return {\n    ...state,\n    correlations,\n    displayerKey,\n    history: {},\n  };\n}\n\nexport function dispatchMiddleware(dispatch) {\n  const usedColors: UsedColors = { '1d': [], '2d': [] };\n\n  return (action) => {\n    switch (action.type) {\n      case types.INITIATE: {\n        if (action.payload) {\n          const { spectra, ...res } = migrate(action.payload);\n          void SpectraManager.fromJSON(spectra, usedColors).then((data) => {\n            action.payload = { spectra: data, ...res, usedColors };\n            dispatch(action);\n          });\n        }\n\n        break;\n      }\n      case types.LOAD_JSON_FILE: {\n        const parsedData = JSON.parse(action.files[0].binary.toString());\n        const data = migrate(parsedData);\n        void SpectraManager.fromJSON(data.spectra, usedColors).then(\n          (spectra) => {\n            action.payload = Object.assign(data, { spectra, usedColors });\n            dispatch(action);\n          },\n        );\n        break;\n      }\n      case types.LOAD_ZIP_FILE: {\n        for (let zipFile of action.files) {\n          void SpectraManager.addBruker(\n            { display: { name: zipFile.name } },\n            zipFile.binary,\n            usedColors,\n          ).then((data) => {\n            action.payload = { data, usedColors };\n            dispatch(action);\n          });\n        }\n        break;\n      }\n      case types.LOAD_NMREDATA_FILE: {\n        void nmredataToNmrium(action.file, usedColors).then((data) => {\n          action.payload = Object.assign(data, { usedColors });\n          dispatch(action);\n        });\n        break;\n      }\n      case types.PREDICT_SPECTRA: {\n        const {\n          mol: { molfile },\n          options,\n        } = action.payload;\n        void predictSpectra(molfile).then(\n          (data) => {\n            action.payload = { data, options };\n            dispatch(action);\n          },\n          () => {\n            dispatch(action);\n          },\n        );\n\n        break;\n      }\n\n      default:\n        action.usedColors = usedColors;\n        dispatch(action);\n\n        break;\n    }\n  };\n}\n\nfunction innerSpectrumReducer(draft: Draft<State>, action) {\n  if (![types.LOAD_JSON_FILE, types.LOAD_NMREDATA_FILE].includes(action.type)) {\n    draft.actionType = action.type;\n  }\n\n  switch (action.type) {\n    case types.INITIATE:\n      return LoadActions.initiate(draft, action);\n    case types.SET_LOADING_FLAG:\n      return LoadActions.setIsLoading(draft, action.isLoading);\n    case types.LOAD_JSON_FILE:\n      return LoadActions.handleLoadJsonFile(draft, action);\n    case types.LOAD_JCAMP_FILE:\n      return LoadActions.loadJcampFile(draft, action);\n    case types.LOAD_JDF_FILE:\n      return LoadActions.loadJDFFile(draft, action);\n    case types.LOAD_MOL_FILE:\n      return LoadActions.handleLoadMOLFile(draft, action);\n    case types.LOAD_ZIP_FILE:\n      return LoadActions.handleLoadZIPFile(draft, action);\n    case types.LOAD_NMREDATA_FILE:\n      return LoadActions.handleLoadNmredata(draft, action);\n    case types.ADD_PEAK:\n      return PeaksActions.addPeak(draft, action.mouseCoordinates);\n    case types.ADD_PEAKS:\n      return PeaksActions.addPeaks(draft, action);\n\n    case types.DELETE_PEAK_NOTATION:\n      return PeaksActions.deletePeak(draft, action.data);\n\n    case types.ADD_INTEGRAL:\n      return IntegralsActions.addIntegral(draft, action);\n    case types.DELETE_INTEGRAL:\n      return IntegralsActions.deleteIntegral(draft, action);\n    case types.CHANGE_INTEGRAL_DATA:\n      return IntegralsActions.changeIntegral(draft, action);\n    case types.RESIZE_INTEGRAL:\n      return IntegralsActions.changeIntegral(draft, action);\n    case types.CHANGE_INTEGRAL_SUM:\n      return IntegralsActions.handleChangeIntegralSum(draft, action.value);\n    case types.CHANGE_INTEGRALS_SUM_FLAG:\n      return IntegralsActions.handleChangeIntegralsSumFlag(draft, action);\n    case types.CHANGE_INTEGRAL_RELATIVE:\n      return IntegralsActions.handleChangeIntegralsRelativeValue(draft, action);\n\n    case types.SET_ORIGINAL_DOMAIN:\n      return DomainActions.setOriginalDomain(draft, action.domain);\n\n    case types.SET_X_DOMAIN:\n      return DomainActions.setXDomain(draft, action.xDomain);\n\n    case types.SET_Y_DOMAIN:\n      return DomainActions.setYDomain(draft, action.yDomain);\n\n    case types.SET_WIDTH:\n      return setWidth(draft, action.width);\n\n    case types.SET_DIMENSIONS:\n      return handleSetDimensions(draft, action.width, action.height);\n\n    case types.SET_SELECTED_TOOL:\n      return ToolsActions.setSelectedTool(draft, action);\n    case types.RESET_SELECTED_TOOL:\n      return ToolsActions.resetSelectedTool(draft);\n    case types.SET_SELECTED_OPTIONS_PANEL:\n      return ToolsActions.setSelectedOptionPanel(\n        draft,\n        action.selectedOptionPanel,\n      );\n    case types.FULL_ZOOM_OUT:\n      return ToolsActions.zoomOut(draft, action);\n    case types.SHIFT_SPECTRUM:\n      return FiltersActions.shiftSpectrumAlongXAxis(draft, action.shiftValue);\n    case types.APPLY_ZERO_FILLING_FILTER:\n      return FiltersActions.applyZeroFillingFilter(draft, action.value);\n    case types.APPLY_FFT_FILTER:\n      return FiltersActions.applyFFTFilter(draft);\n    case types.APPLY_MANUAL_PHASE_CORRECTION_FILTER:\n      return FiltersActions.applyManualPhaseCorrectionFilter(\n        draft,\n        action.value,\n      );\n    case types.APPLY_AUTO_PHASE_CORRECTION_FILTER:\n      return FiltersActions.applyAutoPhaseCorrectionFilter(draft);\n    case types.APPLY_ABSOLUTE_FILTER:\n      return FiltersActions.applyAbsoluteFilter(draft);\n    case types.CALCULATE_MANUAL_PHASE_CORRECTION_FILTER:\n      return FiltersActions.calculateManualPhaseCorrection(draft, action.value);\n    case types.ENABLE_FILTER:\n      return FiltersActions.enableFilter(draft, action.id, action.checked);\n    case types.DELETE_FILTER:\n      return FiltersActions.deleteFilter(draft, action);\n    case types.DELETE_SPECTRA_FILTER:\n      return FiltersActions.deleteSpectraFilter(draft, action);\n    case types.SET_FILTER_SNAPSHOT:\n      return FiltersActions.filterSnapshotHandler(draft, action);\n    case types.APPLY_MULTIPLE_SPECTRA_FILTER:\n      return FiltersActions.handleMultipleSpectraFilter(draft, action);\n    case types.ADD_EXCLUSION_ZONE:\n      return FiltersActions.handleAddExclusionZone(draft, action);\n    case types.DELETE_EXCLUSION_ZONE:\n      return FiltersActions.handleDeleteExclusionZone(draft, action);\n\n    case types.CHANGE_VISIBILITY:\n      return SpectrumsActions.handleSpectrumVisibility(draft, action);\n\n    case types.CHANGE_PEAKS_MARKERS_VISIBILITY:\n      return SpectrumsActions.handleChangePeaksMarkersVisibility(\n        draft,\n        action.data,\n      );\n    case types.CHANGE_ACTIVE_SPECTRUM:\n      return SpectrumsActions.handleChangeActiveSpectrum(draft, action.data);\n    case types.CHANGE_SPECTRUM_COLOR:\n      return SpectrumsActions.handleChangeSpectrumColor(draft, action.data);\n    case types.CHANGE_SPECTRUM_SETTING:\n      return SpectrumsActions.changeSpectrumSetting(draft, action);\n    case types.ALIGN_SPECTRA:\n      return SpectrumsActions.alignSpectraHandler(draft, action);\n    case types.DELETE_SPECTRA:\n      return SpectrumsActions.handleDeleteSpectra(draft, action);\n    case types.ADD_MISSING_PROJECTION:\n      return SpectrumsActions.addMissingProjectionHandler(draft, action);\n    case types.GENERATE_SPECTRUM_FROM_PUBLICATION_STRING:\n      return SpectrumsActions.generateSpectrumFromPublicationStringHandler(\n        draft,\n        action,\n      );\n\n    case types.TOGGLE_REAL_IMAGINARY_VISIBILITY:\n      return ToolsActions.handleToggleRealImaginaryVisibility(draft);\n    case types.SET_ZOOM:\n      return ToolsActions.handleZoom(draft, action);\n    case types.SET_SPECTRA_SAME_TOP:\n      return ToolsActions.setSpectraSameTopHandler(draft);\n    case types.RESET_SPECTRA_SCALE:\n      return ToolsActions.resetSpectraScale(draft);\n\n    case types.CHANGE_SPECTRUM_DISPLAY_VIEW_MODE:\n      return ToolsActions.handleChangeSpectrumDisplayMode(draft);\n\n    case types.ADD_MOLECULE:\n      return MoleculeActions.addMoleculeHandler(draft, action.molfile);\n\n    case types.SET_MOLECULE:\n      return MoleculeActions.setMoleculeHandler(\n        draft,\n        action.molfile,\n        action.key,\n      );\n\n    case types.DELETE_MOLECULE:\n      return MoleculeActions.deleteMoleculeHandler(draft, action);\n\n    case types.PREDICT_SPECTRA:\n      return MoleculeActions.predictSpectraFromMoleculeHandler(draft, action);\n\n    case types.SET_CORRELATIONS_MF:\n      return CorrelationsActions.handleSetMF(draft, action.payload);\n\n    case types.SET_CORRELATIONS_TOLERANCE:\n      return CorrelationsActions.handleSetTolerance(draft, action.payload);\n\n    case types.SET_CORRELATION:\n      return CorrelationsActions.handleSetCorrelation(draft, action.payload);\n\n    case types.SET_CORRELATIONS:\n      return CorrelationsActions.handleSetCorrelations(draft, action.payload);\n\n    case types.DELETE_CORRELATION:\n      return CorrelationsActions.handleDeleteCorrelation(draft, action.payload);\n\n    case types.BRUSH_END:\n      return ToolsActions.handleBrushEnd(draft, action);\n\n    case types.SET_VERTICAL_INDICATOR_X_POSITION:\n      return ToolsActions.setVerticalIndicatorXPosition(draft, action.position);\n    case types.SET_SPECTRUMS_VERTICAL_ALIGN:\n      return ToolsActions.setSpectrumsVerticalAlign(draft);\n\n    case types.AUTO_PEAK_PICKING:\n      return PeaksActions.handleAutoPeakPicking(draft, action.options);\n\n    case types.AUTO_ZONES_DETECTION:\n      return ZonesActions.handleAutoZonesDetection(draft, action.options);\n    case types.CHANGE_ZONES_NOISE_FACTOR:\n      return ZonesActions.changeZonesFactorHandler(draft, action);\n    case types.AUTO_RANGES_DETECTION:\n      return RangesActions.handleAutoRangesDetection(draft, action.options);\n    case types.ADD_RANGE:\n      return RangesActions.handleAddRange(draft, action);\n    case types.DELETE_RANGE:\n      return RangesActions.handleDeleteRange(draft, action);\n    case types.DELETE_1D_SIGNAL:\n      return RangesActions.handleDeleteSignal(draft, action);\n    case types.RESIZE_RANGE:\n      return RangesActions.handleResizeRange(draft, action);\n    case types.CHANGE_RANGE_SUM:\n      return RangesActions.handleChangeRangeSum(draft, action.value);\n    case types.CHANGE_RANGES_SUM_FLAG:\n      return RangesActions.handleChangeRangesSumFlag(draft, action);\n    case types.CHANGE_RANGE_RELATIVE:\n      return RangesActions.handleChangeRangeRelativeValue(draft, action);\n    case types.CHANGE_RANGE_SIGNAL_VALUE:\n      return RangesActions.handleChangeRangeSignalValue(draft, action);\n    case types.CHANGE_RANGE_SIGNAL_KIND:\n      return RangesActions.handleChangeRangeSignalKind(draft, action);\n    case types.SAVE_EDITED_RANGE:\n      return RangesActions.handleSaveEditedRange(draft, action);\n    case types.UNLINK_RANGE:\n      return RangesActions.handleUnlinkRange(draft, action);\n    case types.SET_DIAID_RANGE:\n      return RangesActions.handleSetDiaIDRange(draft, action);\n    case types.CHANGE_TEMP_RANGE:\n      return RangesActions.handleChangeTempRange(draft, action);\n    case types.SHOW_MULTIPLICTY_TREES:\n      return RangesActions.handleShowMultiplicityTrees(draft);\n    case types.SHOW_RANGES_INTEGRALS:\n      return RangesActions.handleShowRangesIntegrals(draft);\n    case types.AUTO_RANGES_SPECTRA_PICKING:\n      return RangesActions.handleAutoSpectraRangesDetection(draft);\n    case types.SHOW_J_GRAPH:\n      return RangesActions.handleShowJGraph(draft);\n\n    case types.SET_ACTIVE_TAB:\n      return ToolsActions.handelSetActiveTab(draft, action.tab);\n    case types.ADD_BASE_LINE_ZONE:\n      return ToolsActions.handleAddBaseLineZone(draft, action.zone);\n    case types.DELETE_BASE_LINE_ZONE:\n      return ToolsActions.handleDeleteBaseLineZone(draft, action.id);\n\n    case types.APPLY_BASE_LINE_CORRECTION_FILTER:\n      return FiltersActions.handleBaseLineCorrectionFilter(draft, action);\n    case types.SET_KEY_PREFERENCES:\n      return setKeyPreferencesHandler(draft, action.keyCode);\n    case types.APPLY_KEY_PREFERENCES:\n      return applyKeyPreferencesHandler(draft, action.keyCode);\n    case types.SET_2D_LEVEL:\n      return ToolsActions.levelChangeHandler(draft, action);\n    case types.ADD_2D_ZONE:\n      return ZonesActions.add2dZoneHandler(draft, action);\n    case types.DELETE_2D_ZONE:\n      return ZonesActions.handleDeleteZone(draft, action);\n    case types.DELETE_2D_SIGNAL:\n      return ZonesActions.handleDeleteSignal(draft, action);\n    case types.SET_2D_SIGNAL_PATH_LENGTH:\n      return ZonesActions.handleSetSignalPathLength(draft, action);\n    case types.RESET_DOMAIN:\n      return DomainActions.handelResetDomain(draft);\n    case types.CHANGE_ZONE_SIGNAL_VALUE:\n      return ZonesActions.changeZoneSignalDelta(draft, action);\n    case types.CHANGE_ZONE_SIGNAL_KIND:\n      return ZonesActions.handleChangeZoneSignalKind(draft, action);\n    case types.UNLINK_ZONE:\n      return ZonesActions.handleUnlinkZone(draft, action);\n    case types.SET_DIAID_ZONE:\n      return ZonesActions.handleSetDiaIDZone(draft, action);\n    case types.AUTO_ZONES_SPECTRA_PICKING:\n      return ZonesActions.handleAutoSpectraZonesDetection(draft);\n    case types.SAVE_EDITED_ZONE:\n      return ZonesActions.handleSaveEditedZone(draft, action);\n\n    case types.ANALYZE_SPECTRA:\n      return SpectraAnalysisActions.analyzeSpectra(draft, action);\n    case types.DELETE_ANALYZE_SPECTRA_RANGE:\n      return SpectraAnalysisActions.handleDeleteSpectraRanges(draft, action);\n    case types.RESIZE_ANALYZE_SPECTRA_RANGE:\n      return SpectraAnalysisActions.handleResizeSpectraRange(draft, action);\n    case types.SET_ANALYZE_SPECTRA_COLUMNS:\n      return SpectraAnalysisActions.handleSetColumns(draft, action);\n    case types.FILTER_SPECTRA_COLUMN:\n      return SpectraAnalysisActions.handleFilterColumn(draft, action);\n\n    case types.RESURRECTING_SPECTRUM_FROM_RANGES:\n      return DatabaseActions.handleRangeResurrecting(draft, action);\n\n    case types.SET_AUTOMATIC_ASSIGNMENTS:\n      return AssignmentsActions.setAutomaticAssignmentsHandler(draft, action);\n\n    case UNDO:\n      return handleHistoryUndo(draft);\n\n    case REDO:\n      return handleHistoryRedo(draft);\n\n    case RESET:\n      return handleHistoryReset(draft, action);\n\n    case types.SET_MOUSE_OVER_DISPLAYER:\n      return GlobalActions.setIsOverDisplayer(draft, action);\n\n    default:\n      return;\n  }\n}\n\nexport const spectrumReducer = produce(innerSpectrumReducer);\n","import { createContext, useContext } from 'react';\n\nimport { initialState, State } from '../reducer/Reducer';\n\nexport const ChartContext = createContext<State>(initialState);\nexport const ChartDataProvider = ChartContext.Provider;\n\nexport function useChartData() {\n  return useContext(ChartContext);\n}\n","import { createContext, useContext } from 'react';\n\nexport const dispatchContext = createContext<any>({});\n\nexport const DispatchProvider = dispatchContext.Provider;\n\nexport function useDispatch() {\n  return useContext(dispatchContext);\n}\n","import { useMemo } from 'react';\n\nimport { Datum1D } from '../../data/types/data1d';\nimport { Datum2D } from '../../data/types/data2d';\nimport { useChartData } from '../context/ChartContext';\n\nexport default function useSpectrum(defaultValue: any) {\n  const { data, activeSpectrum } = useChartData();\n\n  return useMemo<Datum1D | Datum2D>(() => {\n    if (data && activeSpectrum && activeSpectrum.id) {\n      const datum =\n        data.find((datum) => datum.id === activeSpectrum.id) || defaultValue;\n      return datum;\n    }\n    return defaultValue;\n  }, [activeSpectrum, data, defaultValue]);\n}\n","import { createContext, useContext } from 'react';\n\nfunction defaultLoader() {\n  // Empty\n}\n\nconst LoaderContext = createContext<() => void>(defaultLoader);\n\nexport const LoaderProvider = LoaderContext.Provider;\n\nexport function useLoader() {\n  return useContext(LoaderContext);\n}\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { ReactNode } from 'react';\n\nimport { useLoader } from '../context/LoaderContext';\n\nconst styles = css`\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background-color: rgba(255, 255, 255, 0.25);\n  flex-direction: column;\n  user-select: none;\n  width: 100%;\n  height: 100%;\n  outline: 10px dashed rgba(0, 0, 0, 0.3);\n  outline-offset: -10px;\n  padding-left: 20px;\n  padding-right: 20px;\n\n  p {\n    padding: 15px 30px;\n    background-color:rgba(0, 0, 0, 0.5);\n    border-radius: 39px;\n    color: white;\n    font-size: x-large;\n    font-weight: bold;\n\n  }\n}\n`;\n\ninterface NoDataProps {\n  isEmpty?: boolean;\n  canOpenLoader?: boolean;\n  emptyText?: ReactNode;\n}\n\nfunction NoData({\n  isEmpty = true,\n  emptyText = 'Drag and drop here a JCAMP-DX, zipped Bruker folder, Jeol jdf or NMRium file',\n  canOpenLoader = true,\n}: NoDataProps) {\n  const openLoader = useLoader();\n\n  if (!isEmpty) {\n    return null;\n  }\n\n  return (\n    <div css={styles} {...(canOpenLoader && { onClick: openLoader })}>\n      <p>{emptyText}</p>\n    </div>\n  );\n}\n\nexport default NoData;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\n\nconst styles = css`\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background-color: rgba(255, 255, 255, 0.25);\n  height: 100%;\n  flex-direction: column;\n  user-select: none;\n  position: absolute;\n  width: 100%;\n\n  svg {\n    animation-duration: 0.5s;\n    animation-name: spinAnimation;\n    animation-iteration-count: infinite;\n    animation-fill-mode: forwards;\n    animation-direction: inherit;\n    animation-timing-function: linear;\n    animation-duration: 1s;\n    width: 100px;\n    height: 100px;\n  }\n\n  @keyframes spinAnimation {\n    from {\n      transform: rotate(0deg);\n    }\n\n    to {\n      transform: rotate(360deg);\n    }\n  }\n`;\n\nexport default function DefaultSpinnerComponent() {\n  return (\n    <div css={styles}>\n      <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 841.9 595.3\">\n        <g fill=\"#61DAFB\">\n          <path d=\"M666.3 296.5c0-32.5-40.7-63.3-103.1-82.4 14.4-63.6 8-114.2-20.2-130.4-6.5-3.8-14.1-5.6-22.4-5.6v22.3c4.6 0 8.3.9 11.4 2.6 13.6 7.8 19.5 37.5 14.9 75.7-1.1 9.4-2.9 19.3-5.1 29.4-19.6-4.8-41-8.5-63.5-10.9-13.5-18.5-27.5-35.3-41.6-50 32.6-30.3 63.2-46.9 84-46.9V78c-27.5 0-63.5 19.6-99.9 53.6-36.4-33.8-72.4-53.2-99.9-53.2v22.3c20.7 0 51.4 16.5 84 46.6-14 14.7-28 31.4-41.3 49.9-22.6 2.4-44 6.1-63.6 11-2.3-10-4-19.7-5.2-29-4.7-38.2 1.1-67.9 14.6-75.8 3-1.8 6.9-2.6 11.5-2.6V78.5c-8.4 0-16 1.8-22.6 5.6-28.1 16.2-34.4 66.7-19.9 130.1-62.2 19.2-102.7 49.9-102.7 82.3 0 32.5 40.7 63.3 103.1 82.4-14.4 63.6-8 114.2 20.2 130.4 6.5 3.8 14.1 5.6 22.5 5.6 27.5 0 63.5-19.6 99.9-53.6 36.4 33.8 72.4 53.2 99.9 53.2 8.4 0 16-1.8 22.6-5.6 28.1-16.2 34.4-66.7 19.9-130.1 62-19.1 102.5-49.9 102.5-82.3zm-130.2-66.7c-3.7 12.9-8.3 26.2-13.5 39.5-4.1-8-8.4-16-13.1-24-4.6-8-9.5-15.8-14.4-23.4 14.2 2.1 27.9 4.7 41 7.9zm-45.8 106.5c-7.8 13.5-15.8 26.3-24.1 38.2-14.9 1.3-30 2-45.2 2-15.1 0-30.2-.7-45-1.9-8.3-11.9-16.4-24.6-24.2-38-7.6-13.1-14.5-26.4-20.8-39.8 6.2-13.4 13.2-26.8 20.7-39.9 7.8-13.5 15.8-26.3 24.1-38.2 14.9-1.3 30-2 45.2-2 15.1 0 30.2.7 45 1.9 8.3 11.9 16.4 24.6 24.2 38 7.6 13.1 14.5 26.4 20.8 39.8-6.3 13.4-13.2 26.8-20.7 39.9zm32.3-13c5.4 13.4 10 26.8 13.8 39.8-13.1 3.2-26.9 5.9-41.2 8 4.9-7.7 9.8-15.6 14.4-23.7 4.6-8 8.9-16.1 13-24.1zM421.2 430c-9.3-9.6-18.6-20.3-27.8-32 9 .4 18.2.7 27.5.7 9.4 0 18.7-.2 27.8-.7-9 11.7-18.3 22.4-27.5 32zm-74.4-58.9c-14.2-2.1-27.9-4.7-41-7.9 3.7-12.9 8.3-26.2 13.5-39.5 4.1 8 8.4 16 13.1 24 4.7 8 9.5 15.8 14.4 23.4zM420.7 163c9.3 9.6 18.6 20.3 27.8 32-9-.4-18.2-.7-27.5-.7-9.4 0-18.7.2-27.8.7 9-11.7 18.3-22.4 27.5-32zm-74 58.9c-4.9 7.7-9.8 15.6-14.4 23.7-4.6 8-8.9 16-13 24-5.4-13.4-10-26.8-13.8-39.8 13.1-3.1 26.9-5.8 41.2-7.9zm-90.5 125.2c-35.4-15.1-58.3-34.9-58.3-50.6 0-15.7 22.9-35.6 58.3-50.6 8.6-3.7 18-7 27.7-10.1 5.7 19.6 13.2 40 22.5 60.9-9.2 20.8-16.6 41.1-22.2 60.6-9.9-3.1-19.3-6.5-28-10.2zM310 490c-13.6-7.8-19.5-37.5-14.9-75.7 1.1-9.4 2.9-19.3 5.1-29.4 19.6 4.8 41 8.5 63.5 10.9 13.5 18.5 27.5 35.3 41.6 50-32.6 30.3-63.2 46.9-84 46.9-4.5-.1-8.3-1-11.3-2.7zm237.2-76.2c4.7 38.2-1.1 67.9-14.6 75.8-3 1.8-6.9 2.6-11.5 2.6-20.7 0-51.4-16.5-84-46.6 14-14.7 28-31.4 41.3-49.9 22.6-2.4 44-6.1 63.6-11 2.3 10.1 4.1 19.8 5.2 29.1zm38.5-66.7c-8.6 3.7-18 7-27.7 10.1-5.7-19.6-13.2-40-22.5-60.9 9.2-20.8 16.6-41.1 22.2-60.6 9.9 3.1 19.3 6.5 28.1 10.2 35.4 15.1 58.3 34.9 58.3 50.6-.1 15.7-23 35.6-58.4 50.6zM320.8 78.4z\" />\n          <path d=\"M520.5 78.1z\" />\n        </g>\n      </svg>\n      <p>Loading ...</p>\n    </div>\n  );\n}\n","import { createContext, ReactElement } from 'react';\n\nimport DefaultSpinnerComponent from './DefaultSpinnerComponent';\n\nexport function defaultGetSpinner() {\n  return <DefaultSpinnerComponent />;\n}\n\nexport const spinnerContext =\n  createContext<() => ReactElement>(defaultGetSpinner);\n\nexport const SpinnerProvider = spinnerContext.Provider;\n","import { useState, Fragment, useEffect, useContext, ReactNode } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\n\nimport NoData from './NoData';\nimport { spinnerContext } from './SpinnerContext';\n\ninterface SpinnerProps {\n  isLoading?: boolean;\n  emptyText?: ReactNode;\n}\n\nfunction Spinner({ isLoading = true, emptyText = undefined }: SpinnerProps) {\n  const { data } = useChartData();\n  const [checkEmpty, startCheckEmpty] = useState(false);\n\n  useEffect(() => {\n    let timeout: any = null;\n    if (!isLoading) {\n      timeout = setTimeout(() => {\n        startCheckEmpty(true);\n      }, 500);\n    }\n    return () => {\n      clearTimeout(timeout);\n    };\n  }, [isLoading]);\n\n  const getSpinner = useContext(spinnerContext);\n\n  return (\n    <Fragment>\n      {isLoading && getSpinner()}\n      {checkEmpty && !isLoading && (\n        <NoData isEmpty={data && data.length === 0} emptyText={emptyText} />\n      )}\n    </Fragment>\n  );\n}\n\nexport default Spinner;\n","import { CSSProperties, useContext } from 'react';\n\nimport { BrushContext } from '../EventsTrackers/BrushTracker';\nimport { useChartData } from '../context/ChartContext';\nimport { options } from '../toolbar/ToolTypes';\n\nconst styles: Record<'container', CSSProperties> = {\n  container: {\n    transformOrigin: 'top left',\n    position: 'absolute',\n    top: '0px',\n    left: '0px',\n    zoom: '100%',\n  },\n};\n\nconst allowTools: Array<string | number> = [\n  options.zoom.id,\n  options.zeroFilling.id,\n  options.peakPicking.id,\n  options.integral.id,\n  options.phaseCorrection.id,\n  options.baseLineCorrection.id,\n  options.rangesPicking.id,\n  options.zone2D.id,\n  options.slicingTool.id,\n  options.editRange.id,\n  options.multipleSpectraAnalysis.id,\n  options.exclusionZones.id,\n  options.databaseRangesSelection.id,\n];\n\nexport const BRUSH_TYPE = {\n  X: 1,\n  Y: 2,\n  XY: 3,\n};\n\nconst defaultDimensionBorder: {\n  startX: number;\n  startY: number;\n  endX?: number;\n  endY?: number;\n} = {\n  startX: 0,\n  startY: 0,\n};\n\ninterface BrushXYProps {\n  brushType: number;\n  dimensionBorder?: {\n    startX: number;\n    startY: number;\n    endX?: number;\n    endY?: number;\n  };\n  width?: number;\n  height?: number;\n}\n\nexport default function BrushXY({\n  brushType = BRUSH_TYPE.XY,\n  dimensionBorder = defaultDimensionBorder,\n  width: widthProps,\n  height: heightProps,\n}: BrushXYProps) {\n  let {\n    width,\n    height,\n    toolOptions: { selectedTool },\n  } = useChartData();\n  let { startX, endX, startY, endY, step } = useContext(BrushContext);\n\n  if (\n    !allowTools.includes(selectedTool) ||\n    step !== 'brushing' ||\n    !dimensionBorder ||\n    (dimensionBorder.startX && startX < dimensionBorder.startX) ||\n    (dimensionBorder.startY && startY < dimensionBorder.startY) ||\n    ((dimensionBorder.endX && Math.sign(endX - startX) === 1\n      ? endX > dimensionBorder.endX\n      : endX < dimensionBorder.startX) &&\n      (dimensionBorder.endX &&\n      dimensionBorder.endY &&\n      Math.sign(endY - startY) === 1\n        ? endY > dimensionBorder.endY\n        : endY < dimensionBorder.startY))\n  ) {\n    return null;\n  }\n\n  width = widthProps ? widthProps : width;\n\n  height = heightProps ? heightProps : height;\n\n  endX =\n    dimensionBorder.endX && endX > dimensionBorder.endX\n      ? dimensionBorder.endX\n      : dimensionBorder.startX && endX < dimensionBorder.startX\n      ? dimensionBorder.startX\n      : endX;\n  endY =\n    dimensionBorder.endY && endY > dimensionBorder.endY\n      ? dimensionBorder.endY\n      : dimensionBorder.startY && endY < dimensionBorder.startY\n      ? dimensionBorder.startY\n      : endY;\n\n  const scaleX =\n    brushType === BRUSH_TYPE.X || brushType === BRUSH_TYPE.XY\n      ? (endX - startX) / width\n      : 1;\n  startX =\n    brushType === BRUSH_TYPE.X || brushType === BRUSH_TYPE.XY ? startX : 0;\n\n  const scaleY =\n    brushType === BRUSH_TYPE.Y || brushType === BRUSH_TYPE.XY\n      ? (endY - startY) / height\n      : 1;\n  startY =\n    brushType === BRUSH_TYPE.Y || brushType === BRUSH_TYPE.XY ? startY : 0;\n  return (\n    <div\n      style={{\n        ...styles.container,\n        transform: `translate(${startX}px, ${startY}px) scale(${scaleX},${scaleY})`,\n        willChange: 'transform',\n      }}\n    >\n      <svg width={width} height={height}>\n        <rect\n          x=\"0\"\n          y=\"0\"\n          width={width}\n          height={height}\n          fill=\"gray\"\n          opacity=\"0.2\"\n        />\n      </svg>\n    </div>\n  );\n}\n","import { CSSProperties, useContext } from 'react';\n\nimport { BrushContext } from '../EventsTrackers/BrushTracker';\nimport { MouseContext } from '../EventsTrackers/MouseTracker';\nimport { useChartData } from '../context/ChartContext';\nimport { options } from '../toolbar/ToolTypes';\n\nconst styles: Record<'line', CSSProperties> = {\n  line: {\n    stroke: 'black',\n    strokeOpacity: 1,\n    shapeRendering: 'crispEdges',\n    strokeWidth: '1',\n    willChange: 'transform',\n  },\n};\n\nconst allowTools: Array<string | number> = [\n  options.zoom.id,\n  options.equalizerTool.id,\n  options.baseLineCorrection.id,\n  options.zone2D.id,\n  options.slicingTool.id,\n  options.integral.id,\n  options.rangesPicking.id,\n  options.editRange.id,\n  options.multipleSpectraAnalysis.id,\n  options.exclusionZones.id,\n  options.databaseRangesSelection.id,\n];\n\nfunction CrossLinePointer() {\n  const {\n    height,\n    width,\n    margin,\n    toolOptions: { selectedTool },\n  } = useChartData();\n  let position = useContext(MouseContext);\n  const brushState = useContext(BrushContext);\n\n  if (\n    !allowTools.includes(selectedTool) ||\n    brushState.step === 'brushing' ||\n    !position ||\n    position.x > width - margin.right ||\n    position.y > height - margin.bottom ||\n    !width ||\n    !height\n  ) {\n    return null;\n  }\n  return (\n    <div\n      key=\"crossLine\"\n      style={{\n        willChange: 'transform',\n        cursor: 'crosshair',\n        transform: `translate(${-width + position.x}px, ${\n          -height + position.y\n        }px)`,\n        position: 'absolute',\n        top: 0,\n        left: 0,\n        pointerEvents: 'none',\n        overflow: 'visible',\n        width: 2 * width,\n        height: 2 * height,\n      }}\n    >\n      <svg width={2 * width} height={2 * height}>\n        <line\n          style={styles.line}\n          x1={width}\n          y1=\"0\"\n          x2={width}\n          y2={height * 2}\n          key=\"vertical_line\"\n        />\n        <line\n          style={styles.line}\n          x1=\"0\"\n          y1={height}\n          x2={width * 2}\n          y2={height}\n          key=\"horizontal_line\"\n        />\n      </svg>\n    </div>\n  );\n}\n\nexport default CrossLinePointer;\n","import lodashGet from 'lodash/get';\nimport lodashSet from 'lodash/set';\nimport { useCallback, useEffect, useMemo, useState } from 'react';\n\nexport function useStateWithLocalStorage(localStorageKey, key?: string) {\n  const [value, setValue] = useState(\n    localStorage.getItem(localStorageKey) || '{}',\n  );\n  useEffect(() => {\n    localStorage.setItem(localStorageKey, value);\n  }, [localStorageKey, value]);\n\n  const setData = useCallback(\n    (data, key = null) => {\n      let castData = JSON.parse(value);\n      if (key) {\n        lodashSet(castData, key, data);\n      } else {\n        castData = { ...castData, ...data };\n      }\n      setValue(JSON.stringify(castData));\n    },\n    [value],\n  );\n\n  return useMemo(() => {\n    return [\n      key ? lodashGet(JSON.parse(value), key, {}) : JSON.parse(value),\n      setData,\n    ];\n  }, [key, setData, value]);\n}\n\nexport function getLocalStorage(localStorageKey, isJson = true) {\n  const settings = localStorage.getItem(localStorageKey);\n  return settings && isJson ? JSON.parse(settings) : settings;\n}\n\nexport function storeData(localStorageKey, value) {\n  localStorage.setItem(localStorageKey, value);\n}\n\nexport function removeData(localStorageKey) {\n  localStorage.removeItem(localStorageKey);\n}\n\nexport function getValue(object, keyPath, defaultValue: any = null) {\n  return lodashGet(object, keyPath, defaultValue);\n}\n","import { Workspace } from './Workspace';\n\nexport const basic: Workspace = {\n  version: 1,\n  label: 'Default workspace',\n  display: {\n    general: {\n      disableMultipletAnalysis: false,\n      hideSetSumFromMolecule: false,\n      hideGeneralSettings: false,\n      experimentalFeatures: { display: true },\n    },\n\n    panels: {\n      spectraPanel: { display: true, open: true },\n      informationPanel: { display: true, open: false },\n      peaksPanel: { display: true, open: false },\n      integralsPanel: { display: true, open: false },\n      rangesPanel: { display: true, open: false },\n      structuresPanel: { display: true, open: false },\n      filtersPanel: { display: true, open: false },\n      zonesPanel: { display: true, open: false },\n      summaryPanel: { display: false, open: false },\n      multipleSpectraAnalysisPanel: { display: false, open: false },\n      databasePanel: { display: false, open: false },\n      predictionPanel: { display: false, open: false },\n    },\n  },\n\n  controllers: {\n    dimmedSpectraTransparency: 0.1,\n  },\n  formatting: {\n    nuclei: {\n      '1h': { name: '1H', ppm: '0.00', hz: '0.00' },\n      '13c': { name: '13C', ppm: '0.00', hz: '0.00' },\n      '15n': { name: '15N', ppm: '0.00', hz: '0.00' },\n      '19f': { name: '19F', ppm: '0.00', hz: '0.00' },\n      '29si': { name: '29Si', ppm: '0.00', hz: '0.00' },\n      '31p': { name: '31P', ppm: '0.00', hz: '0.00' },\n    },\n    panels: {},\n  },\n};\n","import { Workspace } from './Workspace';\nimport { basic } from './basic';\n\nexport const exercise: Workspace = {\n  version: 1,\n  label: 'Exercise workspace',\n  display: {\n    general: {\n      disableMultipletAnalysis: true,\n      hideSetSumFromMolecule: true,\n      hideGeneralSettings: true,\n      experimentalFeatures: { hidden: true },\n    },\n\n    panels: {\n      spectraPanel: { display: true, open: true },\n      informationPanel: { hidden: true },\n      peaksPanel: { hidden: true },\n      integralsPanel: { display: true },\n      rangesPanel: { hidden: true },\n      structuresPanel: { hidden: true },\n      filtersPanel: { hidden: true },\n      zonesPanel: { hidden: true },\n      summaryPanel: { hidden: true },\n      multipleSpectraAnalysisPanel: { hidden: true },\n      databasePanel: { hidden: true },\n      predictionPanel: { hidden: true },\n    },\n\n    toolBarButtons: {\n      zoomTool: true,\n      zoomOutTool: true,\n      import: false,\n      exportAs: false,\n      spectraStackAlignments: true,\n      spectraCenterAlignments: true,\n      realImaginary: false,\n      peakTool: true,\n      integralTool: true,\n      zonePickingTool: false,\n      slicingTool: false,\n      autoRangesTool: false,\n      zeroFillingTool: false,\n      phaseCorrectionTool: false,\n      baseLineCorrectionTool: false,\n      FFTTool: false,\n      multipleSpectraAnalysisTool: false,\n      exclusionZonesTool: false,\n    },\n  },\n  controllers: basic.controllers,\n  formatting: basic.formatting,\n};\n","import { Workspace } from './Workspace';\nimport { basic } from './basic';\n\nexport const prediction: Workspace = {\n  version: 1,\n  label: 'Prediction workspace',\n  display: {\n    general: {\n      experimentalFeatures: { display: false },\n    },\n    panels: {\n      spectraPanel: { display: true },\n      rangesPanel: { display: true },\n      zonesPanel: { display: true },\n      predictionPanel: { display: true, open: true },\n      informationPanel: { display: false },\n      peaksPanel: { display: false },\n      integralsPanel: { display: false },\n      structuresPanel: { display: false },\n      filtersPanel: { display: false },\n      summaryPanel: { display: false },\n      multipleSpectraAnalysisPanel: { display: false },\n      databasePanel: { display: false },\n    },\n  },\n  controllers: basic.controllers,\n  formatting: basic.formatting,\n};\n","import { Workspace } from './Workspace';\nimport { basic } from './basic';\n\nexport const process1D: Workspace = {\n  version: 1,\n  label: 'Process 1D workspace',\n  display: {\n    general: {\n      disableMultipletAnalysis: true,\n    },\n\n    panels: {\n      zonesPanel: { display: true },\n      summaryPanel: { display: true },\n      multipleSpectraAnalysisPanel: { display: true, open: true },\n      spectraPanel: { display: true, open: true },\n      informationPanel: { hidden: true },\n      peaksPanel: { hidden: true },\n      integralsPanel: { hidden: true },\n      rangesPanel: { hidden: true },\n      structuresPanel: { hidden: true },\n      filtersPanel: { hidden: true },\n      databasePanel: { hidden: true },\n      predictionPanel: { hidden: true },\n    },\n\n    toolBarButtons: {\n      import: false,\n      exportAs: false,\n      autoRangesTool: false,\n      multipleSpectraAnalysisTool: false,\n      exclusionZonesTool: false,\n    },\n  },\n  controllers: basic.controllers,\n  formatting: basic.formatting,\n};\n","import { basic } from './basic';\nimport { exercise } from './exercise';\nimport { prediction } from './prediction';\nimport { process1D } from './process1D';\n\nexport default { exercise, default: basic, process1D, prediction };\n","import { Draft, produce, original } from 'immer';\nimport lodashMerge from 'lodash/merge';\n\nimport generateID from '../../data/utilities/generateID';\nimport { NMRiumWorkspace, NMRiumPreferences } from '../NMRium';\nimport {\n  getLocalStorage,\n  removeData,\n  storeData,\n} from '../utility/LocalStorage';\nimport Workspaces from '../workspaces';\nimport { Formatting, Workspace } from '../workspaces/Workspace';\n\nimport { ActionType } from './types/Types';\n\ntype InitPreferencesAction = ActionType<\n  'INIT_PREFERENCES',\n  { display: NMRiumPreferences; workspace: NMRiumWorkspace; dispatch: any }\n>;\ntype SetPreferencesAction = ActionType<\n  'SET_PREFERENCES',\n  Omit<Workspace, 'version' | 'label'>\n>;\ntype SetPanelsPreferencesAction = ActionType<\n  'SET_PANELS_PREFERENCES',\n  { key: string; value: string }\n>;\n\ntype WorkspaceAction = ActionType<\n  'SET_WORKSPACE' | 'REMOVE_WORKSPACE',\n  { workspace: string }\n>;\ntype AddWorkspaceAction = ActionType<\n  'ADD_WORKSPACE',\n  { workspace: string; data: Omit<Workspace, 'version' | 'label'> }\n>;\n\ntype PreferencesActions =\n  | InitPreferencesAction\n  | SetPreferencesAction\n  | ActionType<'RESET_PREFERENCES'>\n  | SetPanelsPreferencesAction\n  | WorkspaceAction\n  | AddWorkspaceAction;\n\nconst LOCAL_STORAGE_VERSION = 6;\n\nexport const WORKSPACES: Array<{\n  key: NMRiumWorkspace;\n  label: string;\n}> = [\n  {\n    key: 'default',\n    label: Workspaces.default.label,\n  },\n  {\n    key: 'process1D',\n    label: Workspaces.process1D.label,\n  },\n  {\n    key: 'exercise',\n    label: Workspaces.exercise.label,\n  },\n  {\n    key: 'prediction',\n    label: Workspaces.prediction.label,\n  },\n];\n\nfunction getPreferencesByWorkspace(workspace: NMRiumWorkspace) {\n  switch (workspace) {\n    case 'exercise':\n      return Workspaces.exercise;\n    case 'process1D':\n      return Workspaces.process1D;\n    case 'prediction':\n      return Workspaces.prediction;\n    case 'default':\n      return Workspaces.default;\n    default:\n      return {} as Workspace;\n  }\n}\n\nexport interface PreferencesState {\n  version: number;\n  workspaces: Record<string, Workspace>;\n  dispatch: (action?: PreferencesActions) => void;\n  workspace: {\n    current: NMRiumWorkspace;\n    base: NMRiumWorkspace | null;\n  };\n}\n\nfunction getActiveWorkspace(draft: Draft<PreferencesState>) {\n  return draft.workspaces[draft.workspace.current || 'default'];\n}\n\nexport const preferencesInitialState: PreferencesState = {\n  version: LOCAL_STORAGE_VERSION,\n  workspaces: {},\n  dispatch: () => null,\n  workspace: {\n    current: 'default',\n    base: null,\n  },\n};\n\nfunction filterObject(data: any) {\n  return JSON.parse(JSON.stringify(data), (key, value) => {\n    if (value?.hidden !== true) {\n      return value;\n    }\n  });\n}\nfunction FlatObject(data: any) {\n  let result = {};\n  JSON.parse(JSON.stringify(data), (key, value) => {\n    if (value?.hidden !== true && key) {\n      result[key] = result[key]++ || 1;\n    }\n  });\n  return result;\n}\n\nfunction checkKeysExists(sourceObject, targetObject) {\n  const source = FlatObject(sourceObject);\n  const target = FlatObject(targetObject);\n\n  if (Object.keys(target).length === 0) {\n    return false;\n  }\n\n  for (const [key, value] of Object.entries(source)) {\n    if (!target[key] || target[key] !== value) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nfunction mapNucleiFormatting(formatting: Formatting) {\n  const { nuclei, ...res } = formatting;\n  const _nuclei = Object.keys(nuclei).reduce((nucleusFormatting, key) => {\n    nucleusFormatting[nuclei[key].name.trim().toLowerCase()] = nuclei[key];\n    return nucleusFormatting;\n  }, {});\n  return { nuclei: _nuclei, ...res };\n}\n\nexport function initPreferencesState(\n  state: PreferencesState,\n): PreferencesState {\n  const nmrLocalStorageVersion = getLocalStorage(\n    'nmr-local-storage-version',\n    false,\n  );\n\n  let localData = getLocalStorage('nmr-general-settings');\n\n  // remove old nmr-local-storage-version key\n  if (nmrLocalStorageVersion && localData?.version) {\n    removeData('nmr-local-storage-version');\n  }\n\n  //  if the local setting version != current settings version number\n  if (!localData?.version || localData?.version !== LOCAL_STORAGE_VERSION) {\n    removeData('nmr-general-settings');\n  }\n  return {\n    ...state,\n    workspaces: localData?.workspaces || { default: Workspaces.default },\n  };\n}\n\nfunction handleInit(draft: Draft<PreferencesState>, action) {\n  if (action.payload) {\n    const localData = getLocalStorage('nmr-general-settings');\n\n    const { dispatch, workspace, ...resProps } = action.payload;\n    /**\n     * set the current workspace what the user-defined in the setting if the workspace is not defined at the level of component, otherwise\n     * use the default workspace\n     *\n     */\n    draft.workspace =\n      !workspace && localData?.currentWorkspace\n        ? { current: localData.currentWorkspace, base: null }\n        : { current: workspace || 'default', base: workspace };\n\n    const workspacePreferences = lodashMerge(\n      {},\n      getPreferencesByWorkspace(draft.workspace.current),\n      resProps,\n    );\n    const currentWorkspacePreferences = getActiveWorkspace(draft);\n\n    /**\n     * Update the local storage general preferences\n     * 1- if local storage is empty.\n     * 2- if predefine workspaces.\n     * 3- b) if workspace not exists in the local storage\n     *    c) if the local setting workspace version != current workspace version number\n     *    d) if hard code workspace parameters !=  current workspace parameters\n     */\n    if (\n      (Workspaces[draft.workspace.current] &&\n        (!currentWorkspacePreferences ||\n          workspacePreferences?.version !==\n            currentWorkspacePreferences?.version ||\n          !checkKeysExists(\n            workspacePreferences.display,\n            currentWorkspacePreferences?.display,\n          ))) ||\n      !localData\n    ) {\n      const {\n        workspaces,\n        version,\n        workspace: { current },\n      } = draft || {};\n      const display = filterObject(workspacePreferences.display);\n\n      const data = {\n        version,\n        ...(localData?.currentWorkspace && {\n          currentWorkspace: localData?.currentWorkspace,\n        }),\n        workspaces: {\n          ...workspaces,\n          [current]: {\n            ...workspacePreferences,\n            display,\n          },\n        },\n      };\n\n      draft.workspaces[current] = lodashMerge(\n        {},\n        currentWorkspacePreferences,\n        workspacePreferences,\n      );\n      storeData('nmr-general-settings', JSON.stringify(data));\n    } else {\n      currentWorkspacePreferences.display = lodashMerge(\n        {},\n        workspacePreferences.display,\n        currentWorkspacePreferences.display,\n      );\n    }\n\n    draft.dispatch = dispatch;\n  }\n}\n\nfunction handleSetPreferences(draft: Draft<PreferencesState>, action) {\n  if (action.payload) {\n    const currentWorkspacePreferences = getActiveWorkspace(draft);\n\n    let { controllers, formatting, display } = action.payload;\n    formatting = mapNucleiFormatting(formatting);\n    let localData = getLocalStorage('nmr-general-settings');\n    localData.currentWorkspace = draft.workspace.current;\n    localData.workspaces = {\n      ...localData.workspaces,\n      [draft.workspace.current]: {\n        ...localData.workspaces[draft.workspace.current],\n        controllers,\n        formatting,\n        display,\n      },\n    };\n\n    storeData('nmr-general-settings', JSON.stringify(localData));\n\n    currentWorkspacePreferences.controllers = controllers;\n    currentWorkspacePreferences.formatting = formatting;\n    currentWorkspacePreferences.display = {\n      ...currentWorkspacePreferences.display,\n      panels: display.panels,\n      general: {\n        ...(currentWorkspacePreferences.display.general || {}),\n        experimentalFeatures: display.general.experimentalFeatures,\n      },\n    };\n  }\n}\nfunction handleSetPanelsPreferences(draft: Draft<PreferencesState>, action) {\n  if (action.payload) {\n    const currentWorkspacePreferences = getActiveWorkspace(draft);\n\n    const { key, value } = action.payload;\n    let localData = getLocalStorage('nmr-general-settings');\n    localData.workspaces[draft.workspace.current].formatting.panels[key] =\n      value;\n    storeData('nmr-general-settings', JSON.stringify(localData));\n    currentWorkspacePreferences.formatting.panels[key] = value;\n  }\n}\nfunction handleResetPreferences(draft: Draft<PreferencesState>) {\n  const currentWorkspacePreferences = getActiveWorkspace(draft);\n  let localData = getLocalStorage('nmr-general-settings');\n  const workSpaceDisplayPreferences = getPreferencesByWorkspace(\n    draft.workspace.current,\n  ).display;\n\n  if (localData.workspaces[draft.workspace.current]) {\n    localData.workspaces[draft.workspace.current].display =\n      workSpaceDisplayPreferences;\n    storeData('nmr-general-settings', JSON.stringify(localData));\n  }\n  currentWorkspacePreferences.display = workSpaceDisplayPreferences;\n}\nfunction handleSetWorkspace(\n  draft: Draft<PreferencesState>,\n  action: WorkspaceAction,\n) {\n  const workspaceKey = action.payload.workspace;\n  if (!draft.workspaces[workspaceKey]) {\n    draft.workspaces[workspaceKey] = getPreferencesByWorkspace(\n      workspaceKey as NMRiumWorkspace,\n    );\n  }\n  draft.workspace.current = workspaceKey as NMRiumWorkspace;\n}\nfunction handleAddWorkspace(\n  draft: Draft<PreferencesState>,\n  action: AddWorkspaceAction,\n) {\n  const {\n    workspace: workspaceName,\n    data: { display, controllers, formatting },\n  } = action.payload;\n  const newWorkSpace = {\n    version: 1,\n    label: workspaceName,\n    display,\n    controllers,\n    formatting,\n  };\n  const newWorkspaceKey = generateID();\n  const localData = getLocalStorage('nmr-general-settings');\n\n  localData.workspaces[newWorkspaceKey] = newWorkSpace;\n  storeData('nmr-general-settings', JSON.stringify(localData));\n  draft.workspaces[newWorkspaceKey] = newWorkSpace;\n  draft.workspace.current = newWorkspaceKey as any;\n}\nfunction handleRemoveWorkspace(\n  draft: Draft<PreferencesState>,\n  action: WorkspaceAction,\n) {\n  const { workspace } = action.payload;\n\n  if (workspace === draft.workspace.current) {\n    draft.workspace.current = 'default';\n  }\n\n  let localData = getLocalStorage('nmr-general-settings');\n  const storedWorkspaces = original(draft)?.workspaces || {};\n  const workspaces = Object.keys(storedWorkspaces).reduce((acc, key) => {\n    if (key !== workspace) {\n      acc[key] = storedWorkspaces[key];\n    }\n    return acc;\n  }, {});\n  draft.workspaces = workspaces;\n  localData.workspaces = filterObject(workspaces);\n  storeData('nmr-general-settings', JSON.stringify(localData));\n}\n\nfunction innerPreferencesReducer(\n  draft: Draft<PreferencesState>,\n  action: PreferencesActions,\n) {\n  switch (action.type) {\n    case 'INIT_PREFERENCES':\n      return handleInit(draft, action);\n    case 'SET_PREFERENCES':\n      return handleSetPreferences(draft, action);\n    case 'SET_PANELS_PREFERENCES':\n      return handleSetPanelsPreferences(draft, action);\n    case 'RESET_PREFERENCES':\n      return handleResetPreferences(draft);\n    case 'SET_WORKSPACE':\n      return handleSetWorkspace(draft, action);\n    case 'ADD_WORKSPACE':\n      return handleAddWorkspace(draft, action);\n    case 'REMOVE_WORKSPACE':\n      return handleRemoveWorkspace(draft, action);\n    default:\n      return draft;\n  }\n}\nconst preferencesReducer = produce(innerPreferencesReducer);\n\nexport default preferencesReducer;\n","import { createContext, useContext, useMemo } from 'react';\n\nimport {\n  preferencesInitialState,\n  PreferencesState,\n  WORKSPACES,\n} from '../reducer/preferencesReducer';\nimport Workspaces from '../workspaces';\n\nexport const PreferencesContext = createContext<PreferencesState>(\n  preferencesInitialState,\n);\nexport const PreferencesProvider = PreferencesContext.Provider;\n\nexport function usePreferences() {\n  const context = useContext(PreferencesContext);\n  if (!context) {\n    throw new Error('Preferences context was not found');\n  }\n\n  const { workspace, workspaces, dispatch } = context;\n\n  return useMemo(() => {\n    return {\n      current: workspaces[workspace.current] || {},\n      workspace,\n      workspaces,\n      dispatch,\n    };\n  }, [dispatch, workspace, workspaces]);\n}\n\nexport function useWorkspacesList() {\n  const { workspaces } = usePreferences();\n  return useMemo(() => {\n    const currentWorkspaces = Object.keys(workspaces).reduce<\n      { key: string; label: string }[]\n    >((acc, key) => {\n      if (!Workspaces[key]) {\n        acc.push({ key, label: workspaces[key].label });\n      }\n      return acc;\n    }, []);\n\n    return [...WORKSPACES, ...currentWorkspaces];\n  }, [workspaces]);\n}\n","export class PathBuilder {\n  private array: Array<string> = [];\n\n  public moveTo(x: number, y: number) {\n    this.array.push(`M ${x} ${y}`);\n  }\n\n  public lineTo(x: number, y: number) {\n    this.array.push(`L ${x} ${y}`);\n  }\n\n  public closePath() {\n    this.array.push('Z');\n  }\n\n  public toString() {\n    return this.array.join(' ');\n  }\n}\n","import get from 'lodash/get';\nimport { memo, useMemo } from 'react';\n\nimport { getShift } from '../../data/data2d/Spectrum2D';\nimport { Datum2D } from '../../data/types/data2d';\nimport { useChartData } from '../context/ChartContext';\nimport { usePreferences } from '../context/PreferencesContext';\nimport { PathBuilder } from '../utility/PathBuilder';\n\nimport { get2DXScale, get2DYScale } from './utilities/scale';\n\ninterface ContoursPathsProps {\n  id: string;\n  color: string;\n  sign: string;\n  datum: Datum2D;\n}\n\nfunction ContoursPaths({\n  id: spectrumID,\n  sign,\n  color,\n  datum,\n}: ContoursPathsProps) {\n  const { margin, width, height, xDomain, yDomain, contours, activeSpectrum } =\n    useChartData();\n\n  const preferences = usePreferences();\n  const { xShift, yShift } = getShift(datum);\n\n  const isActive = useMemo(() => {\n    return activeSpectrum === null\n      ? true\n      : spectrumID === activeSpectrum.id\n      ? true\n      : false;\n  }, [activeSpectrum, spectrumID]);\n\n  function buildContourPath(data) {\n    const _scaleX = get2DXScale({ margin, width, xDomain });\n    const _scaleY = get2DYScale({ margin, height, yDomain });\n    const path = new PathBuilder();\n\n    for (const element of data) {\n      if (element.lines) {\n        const lines = element.lines;\n        if (lines.length < 1e6) {\n          for (let i = 0; i < lines.length; i += 4) {\n            path.moveTo(\n              _scaleX(lines[i] + xShift),\n              _scaleY(lines[i + 1] + yShift),\n            );\n            path.lineTo(\n              _scaleX(lines[i + 2] + xShift),\n              _scaleY(lines[i + 3] + yShift),\n            );\n          }\n        }\n      } else {\n        path.moveTo(\n          _scaleX(element[0].x + xShift),\n          _scaleY(element[0].y + yShift),\n        );\n\n        for (let j = 1; j < element.length; j++) {\n          path.lineTo(\n            _scaleX(element[j].x + xShift),\n            _scaleY(element[j].y + yShift),\n          );\n        }\n      }\n    }\n\n    path.closePath();\n    return path.toString();\n  }\n\n  const data = useMemo(() => {\n    return get(contours, `${spectrumID}.${sign}`, []);\n  }, [contours, sign, spectrumID]);\n\n  return (\n    <path\n      fill=\"none\"\n      data-test-id=\"spectrum-line\"\n      stroke={color}\n      strokeWidth=\"1\"\n      style={{\n        opacity: isActive\n          ? 1\n          : get(\n              preferences.current,\n              'controllers.dimmedSpectraTransparency',\n              0.1,\n            ),\n      }}\n      d={buildContourPath(data)}\n    />\n  );\n}\n\ninterface ContoursInnerProps {\n  data: Array<Datum2D>;\n  displayerKey: string;\n}\n\nfunction ContoursInner({ data, displayerKey }: ContoursInnerProps) {\n  return (\n    <g clipPath={`url(#${displayerKey}clip-chart-2d)`} className=\"contours\">\n      {data?.map((datum, index) => (\n        <g key={`${datum.id + index}`}>\n          {datum.display.isPositiveVisible && (\n            <ContoursPaths\n              id={datum.id}\n              sign=\"positive\"\n              datum={datum}\n              color={datum.display.positiveColor}\n            />\n          )}\n          {datum.display.isNegativeVisible && (\n            <ContoursPaths\n              id={datum.id}\n              sign=\"negative\"\n              datum={datum}\n              color={datum.display.negativeColor}\n            />\n          )}\n        </g>\n      ))}\n    </g>\n  );\n}\n\nconst MemoizedContours = memo(ContoursInner);\n\nexport default function Contours() {\n  const { data: spectra, displayerKey } = useChartData();\n  const data = useMemo<Array<Datum2D>>(() => {\n    return spectra.filter(\n      (datum) => datum.info.dimension === 2 && datum.info.isFt,\n    ) as Array<Datum2D>;\n  }, [spectra]);\n\n  return <MemoizedContours {...{ data, displayerKey }} />;\n}\n","import { DataXY, DoubleArray } from 'cheminfo-types';\nimport { xyReduce } from 'ml-spectra-processing';\nimport { useCallback } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\n\nexport enum XYReducerDomainAxis {\n  XAxis = 'XAxis',\n  YAxis = 'YAxis',\n}\n\ntype XYReducerDomainAxisType = keyof typeof XYReducerDomainAxis;\n\nexport default function useXYReduce(\n  domainAxis: XYReducerDomainAxisType,\n): (data: { x: number[]; y: number[] }) => DataXY<DoubleArray> {\n  const { width, xDomain, yDomain } = useChartData();\n\n  return useCallback(\n    (data: { x: number[]; y: number[] }) => {\n      const { x, y } = data;\n      const [from, to] =\n        domainAxis === XYReducerDomainAxis.XAxis ? xDomain : yDomain;\n      return xyReduce(\n        { x, y },\n        { from, to, nbPoints: width * 4, optimize: true },\n      );\n    },\n    [domainAxis, width, xDomain, yDomain],\n  );\n}\n","import { useMemo, memo } from 'react';\n\nimport { Datum1D } from '../../data/types/data1d';\nimport { useChartData } from '../context/ChartContext';\nimport useXYReduce, { XYReducerDomainAxis } from '../hooks/useXYReduce';\nimport { PathBuilder } from '../utility/PathBuilder';\n\nimport { get1DYScale, get2DYScale } from './utilities/scale';\n\ninterface Left1DChartProps {\n  margin?: number;\n  data: Datum1D;\n}\n\nfunction Left1DChart({\n  margin: marignValue = 10,\n  data: spectrum,\n}: Left1DChartProps) {\n  const {\n    height: originHeight,\n    margin,\n    yDomain,\n    yDomains,\n    displayerKey,\n  } = useChartData();\n  const xyReduce = useXYReduce(XYReducerDomainAxis.YAxis);\n\n  const height = margin.left;\n\n  const paths = useMemo(() => {\n    if (spectrum) {\n      const scaleX = get2DYScale({\n        height: originHeight,\n        yDomain: [yDomain[0], yDomain[1]],\n        margin,\n      });\n      const scaleY = get1DYScale(yDomains[spectrum.id], height, marignValue);\n\n      const { x, re: y } = spectrum.data;\n      const pathPoints = xyReduce({ x, y });\n\n      const pathBuilder = new PathBuilder();\n\n      pathBuilder.moveTo(\n        scaleY(pathPoints.y[pathPoints.y.length - 1]),\n        scaleX(pathPoints.x.length - 1),\n      );\n\n      for (let i = pathPoints.x.length - 2; i >= 0; i--) {\n        pathBuilder.lineTo(scaleY(pathPoints.y[i]), scaleX(pathPoints.x[i]));\n      }\n\n      return pathBuilder.toString();\n    } else {\n      return undefined;\n    }\n  }, [\n    height,\n    margin,\n    marignValue,\n    originHeight,\n    spectrum,\n    xyReduce,\n    yDomain,\n    yDomains,\n  ]);\n\n  const mainHeight = originHeight - margin.bottom - margin.top;\n\n  if (!mainHeight || !height) return null;\n\n  return (\n    <svg\n      viewBox={`0 0 ${height} ${mainHeight + margin.top}`}\n      width={height}\n      height={mainHeight + margin.top}\n    >\n      <defs>\n        <clipPath id={`${displayerKey}clip-left`}>\n          <rect width={height} height={mainHeight} x=\"0\" y={margin.top} />\n        </clipPath>\n      </defs>\n      <g clipPath={`url(#${displayerKey}clip-left)`}>\n        <path className=\"line\" stroke=\"black\" fill=\"none\" d={paths} />\n      </g>\n    </svg>\n  );\n}\n\nexport default memo(Left1DChart);\n","import { useMemo, memo } from 'react';\n\nimport { Datum1D } from '../../data/types/data1d';\nimport { useChartData } from '../context/ChartContext';\nimport useXYReduce, { XYReducerDomainAxis } from '../hooks/useXYReduce';\nimport { PathBuilder } from '../utility/PathBuilder';\n\nimport { get1DYScale, get2DXScale } from './utilities/scale';\n\ninterface Top1DChartProps {\n  margin?: number;\n  data: Datum1D;\n}\n\nfunction Top1DChart({\n  margin: marginProps = 10,\n  data: spectrum,\n}: Top1DChartProps) {\n  const {\n    width,\n    margin: originMargin,\n    xDomain,\n    yDomains,\n    displayerKey,\n  } = useChartData();\n  const xyReduce = useXYReduce(XYReducerDomainAxis.XAxis);\n  const height = originMargin.top;\n\n  const paths = useMemo(() => {\n    if (spectrum) {\n      const scaleX = get2DXScale({ width, xDomain, margin: originMargin });\n      const scaleY = get1DYScale(yDomains[spectrum.id], height, marginProps);\n      const { x, re: y } = spectrum.data;\n      const pathPoints = xyReduce({ x, y });\n\n      const pathBuilder = new PathBuilder();\n      pathBuilder.moveTo(scaleX(pathPoints.x[0]), scaleY(pathPoints.y[0]));\n      for (let i = 1; i < pathPoints.x.length; i++) {\n        pathBuilder.lineTo(scaleX(pathPoints.x[i]), scaleY(pathPoints.y[i]));\n      }\n\n      return pathBuilder.toString();\n    } else {\n      return undefined;\n    }\n  }, [\n    height,\n    marginProps,\n    originMargin,\n    spectrum,\n    width,\n    xDomain,\n    xyReduce,\n    yDomains,\n  ]);\n\n  if (!width || !height) {\n    return null;\n  }\n\n  return (\n    <svg viewBox={`0 0 ${width} ${height}`} width={width} height={height}>\n      <defs>\n        <clipPath id={`${displayerKey}clip-top`}>\n          <rect\n            width={width - originMargin.left - originMargin.right}\n            height={height}\n            x={originMargin.left}\n            y={`${0}`}\n          />\n        </clipPath>\n      </defs>\n      <g clipPath={`url(#${displayerKey}clip-top)`}>\n        <path\n          className=\"line\"\n          stroke=\"red\"\n          fill=\"none\"\n          strokeWidth=\"1px\"\n          d={paths}\n        />\n      </g>\n    </svg>\n  );\n}\n\nexport default memo(Top1DChart);\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport * as d3 from 'd3';\nimport { useEffect, useRef, memo } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\n\nimport { get2DXScale } from './utilities/scale';\n\nconst axisStyles = css`\n  user-select: none;\n\n  path,\n  line {\n    fill: none;\n    stroke: black;\n    stroke-width: 1;\n    shape-rendering: crispEdges;\n    user-select: none;\n  }\n`;\n\nconst defaultMargin = { right: 100, top: 0, left: 0, bottom: 0 };\n\ninterface XAxisProps {\n  show?: boolean;\n  label?: string;\n  margin?: {\n    top: number;\n    right: number;\n    bottom: number;\n    left: number;\n  };\n}\n\nfunction XAxis(props: XAxisProps) {\n  const {\n    show = true,\n    label = 'δ [ppm]',\n    margin: marginProps = defaultMargin,\n  } = props;\n\n  const state = useChartData();\n  const { xDomain, height, width, margin, tabActiveSpectrum, activeTab } =\n    state;\n\n  const refAxis = useRef<SVGGElement>(null);\n\n  useEffect(() => {\n    if (!show) return;\n    const scaleX = get2DXScale({ width, margin, xDomain });\n    const xAxis = d3.axisBottom(scaleX).ticks(8).tickFormat(d3.format('0'));\n\n    // @ts-expect-error actually well typed\n    d3.select(refAxis.current).call(xAxis);\n  }, [\n    activeTab,\n    height,\n    margin,\n    margin.bottom,\n    margin.left,\n    margin.right,\n    margin.top,\n    show,\n    tabActiveSpectrum,\n    width,\n    xDomain,\n  ]);\n\n  if (!width || !height) {\n    return null;\n  }\n\n  return (\n    <>\n      {show && (\n        <g\n          className=\"x\"\n          css={axisStyles}\n          transform={`translate(0,${\n            height - (margin.bottom + marginProps.bottom)\n          })`}\n          ref={refAxis}\n        >\n          <text fill=\"#000\" x={width - 60} y=\"20\" dy=\"0.71em\" textAnchor=\"end\">\n            {label}\n          </text>\n        </g>\n      )}\n    </>\n  );\n}\n\nexport default memo(XAxis);\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport * as d3 from 'd3';\nimport { useEffect, useRef, memo } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\n\nimport { get2DYScale } from './utilities/scale';\n\nconst axisStyles = css`\n  user-select: 'none';\n  -webkit-user-select: none; /* Chrome all / Safari all */\n  -moz-user-select: none; /* Firefox all */\n\n  path,\n  line {\n    fill: none;\n    stroke: black;\n    stroke-width: 1;\n    shape-rendering: crispEdges;\n    user-select: 'none';\n    -webkit-user-select: none; /* Chrome all / Safari all */\n    -moz-user-select: none; /* Firefox all */\n  }\n`;\n\nconst defaultMargin = { right: 50, top: 0, bottom: 0, left: 0 };\n\ninterface YAxisProps {\n  show?: boolean;\n  label?: string;\n  margin?: {\n    right: number;\n    top: number;\n    bottom: number;\n    left: number;\n  };\n}\n\nfunction YAxis(props: YAxisProps) {\n  const {\n    show = true,\n    label = '',\n    margin: marginProps = defaultMargin,\n  } = props;\n\n  const refAxis = useRef<SVGGElement>(null);\n\n  const state = useChartData();\n  const { yDomain, width, height, activeTab, tabActiveSpectrum, margin } =\n    state;\n\n  useEffect(() => {\n    if (!show || !yDomain) return;\n    const scaleY = get2DYScale({ height, yDomain, margin });\n\n    const axis = d3.axisRight(scaleY).ticks(8).tickFormat(d3.format('0'));\n\n    // @ts-expect-error well typed\n    d3.select(refAxis.current).call(axis);\n  }, [show, yDomain, activeTab, tabActiveSpectrum, height, margin]);\n\n  if (!width || !height) {\n    return null;\n  }\n\n  return (\n    <>\n      <g\n        className=\"y\"\n        css={axisStyles}\n        transform={`translate(${width - marginProps.right})`}\n        ref={refAxis}\n      >\n        <text\n          fill=\"#000\"\n          x={-marginProps.top}\n          y={-(marginProps.right - 5)}\n          dy=\"0.71em\"\n          transform=\"rotate(-90)\"\n          textAnchor=\"end\"\n        >\n          {label}\n        </text>\n      </g>\n    </>\n  );\n}\n\nexport default memo(YAxis);\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useState, useEffect, useMemo } from 'react';\n\nimport { SignalKindsToInclude } from '../../../data/constants/SignalsKinds';\nimport { isSpectrum1D } from '../../../data/data1d/Spectrum1D';\nimport { useChartData } from '../../context/ChartContext';\nimport { get2DXScale, get2DYScale } from '../utilities/scale';\n\nconst lineStyle = css`\n  stroke: lightgrey;\n  opacity: 0.7;\n`;\n\ninterface IndicationLinesProps {\n  show: boolean;\n  axis: 'X' | 'Y';\n}\n\nfunction IndicationLines({ axis, show }: IndicationLinesProps) {\n  const {\n    data,\n    activeTab,\n    margin,\n    width,\n    height,\n    xDomain,\n    yDomain,\n    displayerMode,\n  } = useChartData();\n  const [deltas1D, setDeltas1D] = useState<Array<number>>([]);\n\n  const scaleX = get2DXScale({ margin, width, xDomain });\n  const scaleY = get2DYScale({ margin, height, yDomain });\n\n  useEffect(() => {\n    const split = activeTab.split(',');\n\n    const nucleus = axis === 'X' ? split[0] : axis === 'Y' ? split[1] : null;\n    if (nucleus !== null) {\n      const ranges = data\n        .filter(\n          (_datum) =>\n            _datum.display.isVisible === true &&\n            _datum.info.nucleus === nucleus,\n        )\n        .filter(isSpectrum1D)\n        .map((_datum) => _datum.ranges.values)\n        .flat();\n\n      const deltas = ranges\n        .map((_range) =>\n          _range.signals\n            .filter((_signal) =>\n              SignalKindsToInclude.some((_kind) => _signal.kind === _kind),\n            )\n            .map((_signal) => _signal.delta),\n        )\n        .flat();\n      setDeltas1D(deltas);\n    } else {\n      setDeltas1D([]);\n    }\n  }, [activeTab, axis, data, displayerMode]);\n\n  const indicationLines = useMemo(() => {\n    if (show === true && deltas1D.length > 0) {\n      const lines = deltas1D.map((_delta, i) => {\n        return axis === 'X' ? (\n          <line\n            css={lineStyle}\n            // eslint-disable-next-line react/no-array-index-key\n            key={`indicationLine${axis}${i}`}\n            x1={scaleX(_delta)}\n            x2={scaleX(_delta)}\n            y1={scaleY(yDomain[0])}\n            y2={scaleY(yDomain[1])}\n          />\n        ) : axis === 'Y' ? (\n          <line\n            css={lineStyle}\n            // eslint-disable-next-line react/no-array-index-key\n            key={`indicationLine${axis}${i}`}\n            x1={scaleX(xDomain[0])}\n            x2={scaleX(xDomain[1])}\n            y1={scaleY(_delta)}\n            y2={scaleY(_delta)}\n          />\n        ) : null;\n      });\n      return lines;\n    }\n  }, [axis, deltas1D, scaleX, scaleY, show, xDomain, yDomain]);\n\n  return <g>{indicationLines}</g>;\n}\n\nexport default IndicationLines;\n","import EventEmitter from 'eventemitter3';\n\nconst eventEmitter = new EventEmitter();\n\nconst Emitter = {\n  on: (event, fn) => eventEmitter.on(event, fn),\n  once: (event, fn) => eventEmitter.once(event, fn),\n  off: (event, fn) => eventEmitter.off(event, fn),\n  emit: (event, payload) => eventEmitter.emit(event, payload),\n};\n\nObject.freeze(Emitter);\n\nexport default Emitter;\n","import { createContext, useCallback, useContext, useMemo } from 'react';\n\nimport { AssignmentsActions } from './AssignmentsReducer';\n\nexport type Axis = 'x' | 'y';\nexport type Assignment = Record<Axis, string[]>;\nexport type Assignments = Record<string, Assignment>;\n\nexport type AssignmentDimension = '1D' | '2D';\nexport interface AssignmentAction {\n  id: string;\n  axis: Axis | null;\n}\nexport interface AssignmentState {\n  assignments: Assignments;\n  activated: AssignmentAction | null;\n  highlighted: AssignmentAction | null;\n}\nexport interface AssignmentContext {\n  data: AssignmentState;\n  dispatch: (action: AssignmentsActions) => void;\n}\n\nexport interface AssignmentsData\n  extends Pick<AssignmentState, 'activated' | 'highlighted'> {\n  id: string;\n  isActive: boolean;\n  isOver: boolean;\n  assigned: Record<Axis, string[]>;\n  removeAll: (axis: Axis) => void;\n  toggle: (atomIDs: string[], dimension: AssignmentDimension) => void;\n  setActive: (axis: Axis) => void;\n  show: (axis?: Axis) => void;\n  hide: () => void;\n}\n\nexport const assignmentState: AssignmentState = {\n  assignments: {},\n  activated: null,\n  highlighted: null,\n};\n\nexport const assignmentContext = createContext<AssignmentContext>({\n  data: assignmentState,\n  dispatch: () => null,\n});\n\nexport const AssignmentProvider = assignmentContext.Provider;\n\nexport function useAssignmentData() {\n  const context = useContext(assignmentContext);\n\n  if (!context) {\n    throw new Error('Assignment context was not found');\n  }\n\n  return context;\n}\n\n// key can be signal id,range id or zone id\nexport function useAssignment(key): AssignmentsData {\n  const {\n    data: { activated, highlighted, assignments },\n    dispatch,\n  } = useAssignmentData();\n\n  if ((typeof key !== 'string' && typeof key !== 'number') || key === '') {\n    throw new Error(`assignment key must be a non-empty string or number`);\n  }\n  const id = String(key);\n\n  const isActive = useMemo(() => {\n    return activated?.id === id;\n  }, [activated?.id, id]);\n  const isOver = useMemo(() => {\n    return highlighted?.id === id;\n  }, [highlighted?.id, id]);\n\n  const assigned = useMemo(() => {\n    return assignments[id] || null;\n  }, [assignments, id]);\n\n  const removeAll = useCallback(\n    (axis: Axis) => {\n      dispatch({\n        type: 'REMOVE',\n        payload: { ids: [id], axis },\n      });\n    },\n    [dispatch, id],\n  );\n\n  const toggle = useCallback(\n    (atomIDs: string[], dimension: AssignmentDimension) => {\n      dispatch({\n        type: 'TOGGLE',\n        payload: { atomIDs, id, dimension },\n      });\n    },\n    [dispatch, id],\n  );\n\n  const setActive = useCallback(\n    (axis: Axis) => {\n      dispatch({\n        type: 'SET_ACTIVE',\n        payload: {\n          id,\n          axis,\n        },\n      });\n    },\n    [dispatch, id],\n  );\n\n  const show = useCallback(\n    (axis?: Axis) => {\n      dispatch({\n        type: 'SHOW',\n        payload: {\n          id,\n          axis,\n        },\n      });\n    },\n    [dispatch, id],\n  );\n  const hide = useCallback(() => {\n    dispatch({\n      type: 'HIDE',\n    });\n  }, [dispatch]);\n\n  return {\n    id,\n    activated,\n    isActive,\n    isOver,\n    highlighted,\n    assigned,\n    removeAll,\n    toggle,\n    setActive,\n    show,\n    hide,\n  };\n}\n","import {\n  createContext,\n  useReducer,\n  useMemo,\n  useContext,\n  useCallback,\n  useEffect,\n} from 'react';\n\nexport enum HighlightedSource {\n  PEAK = 'PEAK',\n  INTEGRAL = 'INTEGRAL',\n  SIGNAL = 'SIGNAL',\n  RANGE = 'RANGE',\n  ZONE = 'ZONE',\n  EXCLUSION_ZONE = 'EXCLUSION_ZONE',\n  DATABASE = 'DATABASE',\n  UNKNOWN = 'UNKNOWN',\n}\n\ntype HighlightedSourceType = keyof typeof HighlightedSource;\n\ninterface SourceData {\n  type: HighlightedSourceType;\n  extra?: any;\n}\n\ntype HighlightActions = 'HIDE' | 'SHOW' | 'SET_PERMANENT' | 'UNSET_PERMANENT';\n\ninterface HighlightState {\n  highlights: Record<string, number>;\n  highlighted: string[];\n  highlightedPermanently: string[];\n  sourceData: SourceData | null;\n}\n\ninterface HighlightContextProps {\n  highlight: HighlightState;\n  dispatch: (props: { type: HighlightActions; payload?: any }) => void;\n  remove: () => void;\n}\n\nconst emptyState = {\n  highlight: {\n    highlights: {},\n    highlighted: [],\n    highlightedPermanently: [],\n    sourceData: null,\n  },\n  dispatch: () => null,\n  remove: () => null,\n};\n\nconst highlightContext = createContext<HighlightContextProps>(emptyState);\n\nfunction highlightReducer(state, action) {\n  switch (action.type) {\n    case 'SHOW': {\n      const { convertedHighlights, sourceData } = action.payload;\n      const { type = HighlightedSource.UNKNOWN, extra = null } =\n        sourceData || {};\n\n      const newState = {\n        ...state,\n        highlights: { ...state.highlights },\n        sourceData: { type, extra },\n      };\n      for (const value of convertedHighlights) {\n        if (!(value in newState.highlights)) {\n          newState.highlights[value] = 1;\n        }\n      }\n      newState.highlighted = Object.keys(newState.highlights);\n\n      return newState;\n    }\n    case 'HIDE': {\n      const { convertedHighlights } = action.payload;\n\n      const newState = {\n        ...state,\n        highlights: { ...state.highlights },\n        sourceData: null,\n      };\n      for (const value of convertedHighlights) {\n        if (value in newState.highlights) {\n          // eslint-disable-next-line @typescript-eslint/no-dynamic-delete\n          delete newState.highlights[value];\n        }\n      }\n      newState.highlighted = Object.keys(newState.highlights);\n      return newState;\n    }\n    case 'SET_PERMANENT': {\n      const newState = {\n        ...state,\n        // allow just one permanent highlights group at same time\n        highlightedPermanently: action.payload,\n      };\n\n      return newState;\n    }\n    case 'UNSET_PERMANENT': {\n      const newState = {\n        ...state,\n        highlightedPermanently: [],\n      };\n\n      return newState;\n    }\n    default: {\n      throw new Error(`unknown action type: ${action.type}`);\n    }\n  }\n}\n\nexport function HighlightProvider(props) {\n  const [highlight, dispatch] = useReducer(\n    highlightReducer,\n    emptyState.highlight,\n  );\n\n  const contextValue = useMemo(() => {\n    function remove() {\n      dispatch({\n        type: 'HIDE',\n        payload: { convertedHighlights: highlight.highlighted },\n      });\n    }\n    return { highlight, dispatch, remove };\n  }, [highlight]);\n\n  return (\n    <highlightContext.Provider value={contextValue}>\n      {props.children}\n    </highlightContext.Provider>\n  );\n}\n\nexport function useHighlightData() {\n  return useContext(highlightContext);\n}\n\n/**\n * @param {Array<string | number>}  highlights\n * @param {SourceData = null} sourceData\n */\nexport function useHighlight(\n  highlights: (string | number)[],\n  sourceData: SourceData | null = null,\n) {\n  if (!Array.isArray(highlights)) {\n    throw new Error('highlights must be an array');\n  }\n  const { dispatch, highlight } = useHighlightData();\n\n  const convertedHighlights = useMemo(() => {\n    const newHighlights: Array<any> = [];\n    for (const highlight of highlights) {\n      if (typeof highlight !== 'string' && typeof highlight !== 'number') {\n        throw new Error(`highlight key must be a string or number`);\n      }\n      if (highlight !== '') {\n        newHighlights.push(String(highlight));\n      }\n    }\n    return newHighlights;\n  }, [highlights]);\n\n  useEffect(() => {\n    // if deletion of component then also delete its highlight information -> componentWillUnmount\n    return () => {\n      dispatch({\n        type: 'HIDE',\n        payload: { convertedHighlights: [] },\n      });\n      dispatch({\n        type: 'UNSET_PERMANENT',\n      });\n    };\n  }, [dispatch]);\n\n  const isActive = useMemo(() => {\n    return highlight.highlighted.some((key) =>\n      convertedHighlights.includes(key),\n    );\n  }, [convertedHighlights, highlight.highlighted]);\n\n  const isActivePermanently = useMemo(() => {\n    return highlight.highlightedPermanently.some((key) =>\n      convertedHighlights.includes(key),\n    );\n  }, [convertedHighlights, highlight.highlightedPermanently]);\n\n  const show = useCallback(() => {\n    dispatch({\n      type: 'SHOW',\n      payload: {\n        convertedHighlights,\n        sourceData,\n      },\n    });\n  }, [dispatch, convertedHighlights, sourceData]);\n\n  const hide = useCallback(() => {\n    dispatch({\n      type: 'HIDE',\n      payload: {\n        convertedHighlights,\n      },\n    });\n  }, [convertedHighlights, dispatch]);\n\n  const add = useCallback(\n    (id) => {\n      dispatch({\n        type: 'SHOW',\n        payload: { convertedHighlights: [], id },\n      });\n    },\n    [dispatch],\n  );\n\n  const remove = useCallback(\n    (id) => {\n      dispatch({\n        type: 'HIDE',\n        payload: { convertedHighlights: [], id },\n      });\n    },\n    [dispatch],\n  );\n\n  const click = useCallback(\n    (e) => {\n      if (e) {\n        e.preventDefault();\n        e.stopPropagation();\n      }\n\n      if (!isActivePermanently) {\n        dispatch({\n          type: 'SET_PERMANENT',\n          payload: convertedHighlights,\n        });\n      } else {\n        dispatch({\n          type: 'UNSET_PERMANENT',\n        });\n      }\n    },\n    [convertedHighlights, dispatch, isActivePermanently],\n  );\n\n  return useMemo(() => {\n    return {\n      isActive,\n      onHover: {\n        onMouseEnter: show,\n        onMouseLeave: hide,\n      },\n      onClick: click,\n      show,\n      hide,\n      isActivePermanently,\n      click,\n      add,\n      remove,\n    };\n  }, [add, click, hide, isActive, isActivePermanently, remove, show]);\n}\n","export const ConcatenationString = '___';\n\nexport function buildID(prefix: string, suffix: string): string {\n  return `${prefix}${ConcatenationString}${suffix}`;\n}\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useMemo } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\n\nimport { get2DXScale, get2DYScale } from './utilities/scale';\n\nconst lineStyle = css`\n  stroke: green;\n  stroke-width: 2;\n  opacity: 0.5;\n`;\n\ninterface SignalDeltaLineProps {\n  delta: number;\n  axis: 'X' | 'Y';\n  show: boolean;\n}\n\nfunction SignalDeltaLine({ delta, axis, show }: SignalDeltaLineProps) {\n  const { margin, width, height, xDomain, yDomain } = useChartData();\n  const scaleX = get2DXScale({ margin, width, xDomain });\n  const scaleY = get2DYScale({ margin, height, yDomain });\n\n  const line = useMemo(() => {\n    return show === true ? (\n      axis === 'X' ? (\n        <line\n          css={lineStyle}\n          key={`signalLine_${delta}_X`}\n          x1={scaleX(delta)}\n          x2={scaleX(delta)}\n          y1={scaleY(yDomain[0])}\n          y2={scaleY(yDomain[1])}\n        />\n      ) : axis === 'Y' ? (\n        <line\n          css={lineStyle}\n          key={`signalLine_${delta}_Y`}\n          x1={scaleX(xDomain[0])}\n          x2={scaleX(xDomain[1])}\n          y1={scaleY(delta)}\n          y2={scaleY(delta)}\n        />\n      ) : null\n    ) : null;\n  }, [axis, delta, scaleX, scaleY, show, xDomain, yDomain]);\n\n  return <g>{line}</g>;\n}\n\nexport default SignalDeltaLine;\n","/** @jsxImportSource @emotion/react */\n\nimport { useMemo } from 'react';\n\nimport { Signal2D } from '../../../data/types/data2d';\nimport { buildID } from '../../../data/utilities/Concatenation';\nimport { useHighlight } from '../../highlight';\nimport SignalDeltaLine from '../SignalDeltaLine';\n\ninterface SignalCrosshairProps {\n  signal: Signal2D;\n}\n\nfunction SignalCrosshair({ signal }: SignalCrosshairProps) {\n  const highlightIDsX = useMemo(() => {\n    return [buildID(signal.id, 'Crosshair'), buildID(signal.id, 'Crosshair_X')];\n  }, [signal.id]);\n\n  const highlightIDsY = useMemo(() => {\n    return [buildID(signal.id, 'Crosshair'), buildID(signal.id, 'Crosshair_Y')];\n  }, [signal.id]);\n\n  const highlightX = useHighlight(highlightIDsX);\n  const highlightY = useHighlight(highlightIDsY);\n  const highlight = useHighlight([signal.id]);\n\n  if (!signal?.x?.delta || !signal?.y?.delta) return null;\n\n  return (\n    <g>\n      <SignalDeltaLine\n        delta={signal.x.delta}\n        axis=\"X\"\n        show={highlightX.isActive || highlight.isActive}\n      />\n      <SignalDeltaLine\n        delta={signal.y.delta}\n        axis=\"Y\"\n        show={highlightY.isActive || highlight.isActive}\n      />\n    </g>\n  );\n}\n\nexport default SignalCrosshair;\n","/** @jsxImportSource @emotion/react */\n\nimport { memo, useState, useEffect, useCallback } from 'react';\n\nimport { Signal2D } from '../../../data/types/data2d';\nimport { buildID } from '../../../data/utilities/Concatenation';\nimport { useAssignment } from '../../assignment/AssignmentsContext';\nimport { useChartData } from '../../context/ChartContext';\nimport { useHighlightData, useHighlight } from '../../highlight';\nimport { get2DXScale, get2DYScale } from '../utilities/scale';\n\nimport SignalCrosshair from './SignalCrosshair';\n\ninterface SignalProps {\n  signal: Signal2D;\n  isVisible: {\n    signals?: boolean;\n    peaks?: boolean;\n    zones?: boolean;\n  };\n}\n\nconst Signal = memo(({ signal, isVisible }: SignalProps) => {\n  const { margin, width, height, xDomain, yDomain } = useChartData();\n  const scaleX = get2DXScale({ margin, width, xDomain });\n  const scaleY = get2DYScale({ margin, height, yDomain });\n\n  const buildIDs = useCallback((id) => {\n    return [id].concat(buildID(id, 'X'), buildID(id, 'Y'));\n  }, []);\n\n  const assignment = useAssignment(signal.id);\n  const highlight = useHighlight(buildIDs(assignment.id));\n  const highlightData = useHighlightData();\n\n  const [isHighlighted, setIsHighlighted] = useState(false);\n\n  useEffect(() => {\n    if (\n      highlightData.highlight.highlighted.some((_highlighted) =>\n        buildIDs(signal.id).includes(_highlighted),\n      ) ||\n      assignment.isActive\n    ) {\n      setIsHighlighted(true);\n    } else {\n      setIsHighlighted(false);\n    }\n  }, [\n    assignment.isActive,\n    buildIDs,\n    highlightData.highlight.highlighted,\n    signal.id,\n  ]);\n\n  if (!signal) return null;\n\n  return (\n    <g className=\"zone-signal\">\n      {isVisible.signals && (\n        <g>\n          <SignalCrosshair signal={signal} />\n          <circle\n            onMouseEnter={() => {\n              assignment.show();\n              highlight.show();\n            }}\n            onMouseLeave={() => {\n              assignment.hide();\n              highlight.hide();\n            }}\n            key={signal.id}\n            cx={scaleX(signal.x.delta || 0)}\n            cy={scaleY(signal.y.delta || 0)}\n            r={isHighlighted ? 6 : 4}\n            fill={isHighlighted ? 'green' : 'darkgreen'}\n          />\n        </g>\n      )}\n      <g className=\"zone-signal-peak\" style={{ pointerEvents: 'none' }}>\n        {isVisible.peaks &&\n          signal.peaks &&\n          signal.peaks.map((peak, i) => (\n            <circle\n              key={`${signal.id + i}`}\n              cx={scaleX(peak.x)}\n              cy={scaleY(peak.y)}\n              r={2}\n              fill=\"black\"\n            />\n          ))}\n      </g>\n    </g>\n  );\n});\n\nexport default Signal;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useState, useEffect } from 'react';\n\nimport { Zone as ZoneDataProps } from '../../../data/types/data2d';\nimport { checkZoneKind } from '../../../data/utilities/ZoneUtilities';\nimport { useAssignment } from '../../assignment/AssignmentsContext';\nimport { useChartData } from '../../context/ChartContext';\nimport { HighlightedSource, useHighlight } from '../../highlight';\nimport { get2DXScale, get2DYScale } from '../utilities/scale';\n\nimport Signal from './Signal';\n\nconst stylesOnHover = css`\n  pointer-events: bounding-box;\n  @-moz-document url-prefix() {\n    pointer-events: fill;\n  }\n  user-select: 'none';\n  -webkit-user-select: none; /* Chrome all / Safari all */\n  -moz-user-select: none; /* Firefox all */\n\n  .delete-button {\n    visibility: hidden;\n  }\n`;\n\nconst stylesHighlighted = css`\n  pointer-events: bounding-box;\n\n  @-moz-document url-prefix() {\n    pointer-events: fill;\n  }\n  .Integral-area {\n    fill: #ff6f0057;\n  }\n  .delete-button {\n    visibility: visible;\n    cursor: pointer;\n  }\n`;\n\ninterface ZoneProps {\n  zoneData: ZoneDataProps;\n  isVisible: {\n    zones: boolean;\n  };\n}\n\nconst Zone = ({ zoneData, isVisible }: ZoneProps) => {\n  const { x, y, id, signals } = zoneData;\n  const assignmentZone = useAssignment(id);\n  const highlightZone = useHighlight([assignmentZone.id], {\n    type: HighlightedSource.ZONE,\n    extra: { id: assignmentZone.id },\n  });\n  const { margin, width, height, xDomain, yDomain } = useChartData();\n  const scaleX = get2DXScale({ margin, width, xDomain });\n  const scaleY = get2DYScale({ margin, height, yDomain });\n\n  const { from: x1 = 0, to: x2 = 0 } = x;\n  const { from: y1 = 0, to: y2 = 0 } = y;\n\n  const [reduceOpacity, setReduceOpacity] = useState(false);\n\n  useEffect(() => {\n    setReduceOpacity(!checkZoneKind(zoneData));\n  }, [zoneData]);\n\n  return (\n    <g\n      css={\n        highlightZone.isActive || assignmentZone.isActive\n          ? stylesHighlighted\n          : stylesOnHover\n      }\n      key={id}\n      onMouseEnter={() => {\n        assignmentZone.show();\n        highlightZone.show();\n      }}\n      onMouseLeave={() => {\n        assignmentZone.hide();\n        highlightZone.hide();\n      }}\n    >\n      {isVisible.zones && (\n        <g transform={`translate(${scaleX(x2)},${scaleY(y1)})`}>\n          <rect\n            x=\"0\"\n            width={scaleX(x1) - scaleX(x2)}\n            height={scaleY(y2) - scaleY(y1)}\n            className=\"Integral-area\"\n            fill=\"#0000000f\"\n            stroke={reduceOpacity ? '#343a40' : 'darkgreen'}\n            strokeWidth={reduceOpacity ? '0' : '1'}\n          />\n        </g>\n      )}\n      {signals.map((_signal, i) => (\n        <Signal key={`${id + i}`} signal={_signal} isVisible={isVisible} />\n      ))}\n    </g>\n  );\n};\n\nexport default Zone;\n","import { useEffect, useState, memo } from 'react';\n\nimport {\n  Datum2D,\n  Display2D,\n  Zones as ZonesProps,\n} from '../../../data/types/data2d';\nimport { useChartData } from '../../context/ChartContext';\nimport useSpectrum from '../../hooks/useSpectrum';\nimport Events from '../../utility/Events';\n\nimport Zone from './Zone';\n\ninterface ZonesInnerProps {\n  zones: ZonesProps;\n  display: Display2D;\n  displayerKey: string;\n}\n\nfunction ZonesInner({ zones, display, displayerKey }: ZonesInnerProps) {\n  const [isVisible, setVisibility] = useState({\n    zones: true,\n    signals: true,\n    peaks: true,\n  });\n\n  useEffect(() => {\n    Events.on('onZonesVisibilityChange', ({ key }) => {\n      setVisibility((prevVisiblity) => ({\n        ...prevVisiblity,\n        [key]: !prevVisiblity[key],\n      }));\n    });\n  }, []);\n\n  return (\n    <g clipPath={`url(#${displayerKey}clip-chart-2d)`} className=\"2D-Zones\">\n      {display.isVisible &&\n        zones.values.map((zone) => (\n          <g className=\"zone\" key={zone.id}>\n            <Zone zoneData={zone} isVisible={isVisible} />\n          </g>\n        ))}\n    </g>\n  );\n}\n\nconst MemoizedZones = memo(ZonesInner);\n\nconst emptyData = { zones: {}, display: {} };\n\nexport default function Zones() {\n  const { displayerKey } = useChartData();\n\n  const { zones, display } = useSpectrum(emptyData) as Datum2D;\n\n  return <MemoizedZones {...{ zones, display, displayerKey }} />;\n}\n","import { memo } from 'react';\n\nimport { Datum1D } from '../../data/types/data1d';\nimport { useChartData } from '../context/ChartContext';\nimport { Margin } from '../reducer/Reducer';\n\nimport Contours from './Contours';\nimport Left1DChart from './Left1DChart';\nimport Top1DChart from './Top1DChart';\nimport XAxis from './XAxis';\nimport YAxis from './YAxis';\nimport IndicationLines from './zones/IndicationLines';\nimport Zones from './zones/Zones';\n\ninterface Chart2DProps {\n  spectra?: Datum1D[];\n}\n\ninterface Chart2DInnerProps extends Chart2DProps {\n  width: number;\n  height: number;\n  margin: Margin;\n  displayerKey: string;\n}\n\nfunction chart2DInner({\n  spectra,\n  width,\n  height,\n  margin,\n  displayerKey,\n}: Chart2DInnerProps) {\n  return (\n    <svg\n      viewBox={`0 0 ${width} ${height}`}\n      width={width}\n      height={height}\n      id=\"nmrSVG\"\n    >\n      <defs>\n        <clipPath id={`${displayerKey}clip-chart-2d`}>\n          <rect\n            width={width - margin.left - margin.right}\n            height={height - margin.top - margin.bottom}\n            x={margin.left}\n            y={margin.top}\n          />\n        </clipPath>\n      </defs>\n      <rect\n        width={width - margin.left - margin.right}\n        height={height - margin.top - margin.bottom}\n        x={margin.left}\n        y={margin.top}\n        stroke=\"black\"\n        strokeWidth=\"1\"\n        fill=\"transparent\"\n      />\n      {spectra?.[0] && <Top1DChart data={spectra[0]} />}\n      {spectra?.[1] && <Left1DChart data={spectra[1]} />}\n      <Contours />\n      <Zones />\n      <IndicationLines axis=\"X\" show />\n      <IndicationLines axis=\"Y\" show />\n\n      <g className=\"container\" style={{ pointerEvents: 'none' }}>\n        <XAxis />\n        <YAxis />\n      </g>\n    </svg>\n  );\n}\n\nconst MemoizedChart2D = memo(chart2DInner);\n\nexport default function Chart2D({ spectra }: Chart2DProps) {\n  const { width, height, margin, displayerKey } = useChartData();\n\n  return (\n    <MemoizedChart2D {...{ spectra, width, height, margin, displayerKey }} />\n  );\n}\n","import lodashGet from 'lodash/get';\nimport Numeral from 'numeral';\nimport { useMemo } from 'react';\n\nimport { usePreferences } from '../context/PreferencesContext';\n\nfunction FormatNumber(value, format, prefix = '', suffix = '') {\n  return prefix + Numeral(value).format(format) + suffix;\n}\n\ntype ReturnFunction = (\n  value?: number | string,\n  formatKey?: string,\n  prefix?: string,\n  suffix?: string,\n) => string;\n\nexport function useFormatNumberByNucleus(\n  nucleus?: Array<string>,\n): Array<ReturnFunction>;\nexport function useFormatNumberByNucleus(nucleus?: string): ReturnFunction;\nexport function useFormatNumberByNucleus(nucleus?: string | Array<string>) {\n  const preferences = usePreferences();\n  const nucleusByKey = lodashGet(preferences.current, `formatting.nuclei`, {\n    ppm: '0.0',\n    hz: '0.0',\n  });\n\n  return useMemo(() => {\n    function formatFun(n: string) {\n      return (value: any, formatKey = 'ppm', prefix = '', suffix = '') => {\n        return (\n          prefix +\n          Numeral(Number(value)).format(\n            lodashGet(nucleusByKey, `${n.toLowerCase()}.${formatKey}`, '0.0'),\n          ) +\n          suffix\n        );\n      };\n    }\n\n    if (!nucleus) {\n      return () => undefined;\n    }\n\n    if (typeof nucleus === 'string') {\n      return formatFun(nucleus);\n    } else if (Array.isArray(nucleus)) {\n      return nucleus.map((n) => formatFun(n));\n    } else {\n      throw Error('nuclus must be string or array of string');\n    }\n  }, [nucleus, nucleusByKey]);\n}\n\nexport function getNumberOfDecimals(value: number | string) {\n  value = String(value).trim();\n  const lastIndex = value.lastIndexOf('.');\n  return lastIndex > 0 ? value.substr(lastIndex).split('').length - 1 : 0;\n}\n\nexport default FormatNumber;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { xFindClosestIndex } from 'ml-spectra-processing';\nimport { useContext, useMemo, Fragment } from 'react';\nimport { MF } from 'react-mf';\n\nimport { get1DDataXY } from '../../data/data1d/Spectrum1D/get1DDataXY';\nimport { BrushContext } from '../EventsTrackers/BrushTracker';\nimport { MouseContext } from '../EventsTrackers/MouseTracker';\nimport { useChartData } from '../context/ChartContext';\nimport { options } from '../toolbar/ToolTypes';\nimport { useFormatNumberByNucleus } from '../utility/FormatNumber';\n\nimport { getLayoutID, LAYOUT } from './utilities/DimensionLayout';\nimport { get2DXScale, get1DYScale, get2DYScale } from './utilities/scale';\n\nconst styles = css`\n  display: flex;\n  flex-firection: row;\n  align-items: center;\n  pointer-events: bounding-box;\n  user-select: 'none';\n  -webkit-user-select: none; /* Chrome all / Safari all */\n  -moz-user-select: none; /* Firefox all */\n  background-color: #f7f7f7;\n  height: 30px;\n  padding: 6px;\n  color: #8d0018;\n  position: absolute;\n  width: 100%;\n  bottom: 0;\n  div {\n    margin: 0px 10px;\n    display: inline-block;\n\n    .label {\n      font-size: 12px;\n      color: #4d4d4d;\n      font-weight: bold;\n    }\n    .value {\n      font-weight: bold;\n      font-size: 14px;\n    }\n    .unit {\n      font-weight: bold;\n      font-size: 10px;\n    }\n  }\n`;\n\nfunction FooterBanner({ layout, data1D }) {\n  const position = useContext(MouseContext);\n  const { startX, endX, startY, endY, step } = useContext(BrushContext);\n  const {\n    margin,\n    width,\n    height,\n    activeSpectrum,\n    xDomain,\n    yDomain,\n    yDomains,\n    activeTab,\n    data,\n    toolOptions: { selectedTool },\n  } = useChartData();\n\n  const trackID =\n    position &&\n    getLayoutID(layout, {\n      startX: position.x,\n      startY: position.y,\n    });\n\n  const nucleuses = activeTab.split(',');\n  const [formatX, formatY] = useFormatNumberByNucleus(nucleuses);\n\n  const scaleX = useMemo(() => {\n    if (!data1D || data1D.length === 0) {\n      return get2DXScale({ width, margin, xDomain });\n    }\n    if (selectedTool !== options.slicingTool.id) {\n      switch (trackID) {\n        case LAYOUT.TOP_1D:\n        case LAYOUT.CENTER_2D: {\n          return get2DXScale({ width, margin, xDomain });\n        }\n        case LAYOUT.LEFT_1D: {\n          return get2DYScale({ height, margin, yDomain });\n        }\n        default:\n          return null;\n      }\n    }\n    return null;\n  }, [data1D, height, margin, selectedTool, trackID, width, xDomain, yDomain]);\n\n  const scaleY = useMemo(() => {\n    if (!data1D || data1D.length === 0) {\n      return get2DYScale({ height, margin, yDomain });\n    }\n    if (selectedTool !== options.slicingTool.id) {\n      switch (trackID) {\n        case LAYOUT.CENTER_2D: {\n          return get2DYScale({ height, margin, yDomain });\n        }\n        case LAYOUT.TOP_1D: {\n          return data1D[0]\n            ? get1DYScale(yDomains[data1D[0].id], margin.top)\n            : null;\n        }\n        case LAYOUT.LEFT_1D: {\n          return data1D[1]\n            ? get1DYScale(yDomains[data1D[1].id], margin.left)\n            : null;\n        }\n        default:\n          return null;\n      }\n    }\n    return null;\n  }, [data1D, height, margin, selectedTool, trackID, yDomain, yDomains]);\n\n  if (\n    !activeSpectrum ||\n    !position ||\n    position.y < 10 ||\n    position.x < 10 ||\n    position.x > width - margin.right ||\n    position.y > height - margin.bottom\n  ) {\n    return <div css={styles} />;\n  }\n  const getRealYValue = (cordinate) => {\n    let index: number | null = null;\n    if (trackID === LAYOUT.TOP_1D) {\n      index = 0;\n    } else if (trackID === LAYOUT.LEFT_1D) {\n      index = 1;\n    }\n    if (index != null && scaleX != null) {\n      const datum = get1DDataXY(data1D[index]);\n      const xIndex = xFindClosestIndex(datum.x, scaleX.invert(cordinate));\n      return datum.y[xIndex];\n    }\n    return 1;\n  };\n\n  const getXValue = (x: number | null = null) => {\n    if (scaleX != null) {\n      switch (trackID) {\n        case LAYOUT.CENTER_2D:\n        case LAYOUT.TOP_1D: {\n          return scaleX.invert(x ? x : position.x);\n        }\n        case LAYOUT.LEFT_1D: {\n          return scaleX.invert(x ? x : position.y);\n        }\n        default:\n          return 0;\n      }\n    }\n    return 0;\n  };\n\n  const getYValue = () => {\n    if (scaleY != null) {\n      switch (trackID) {\n        case LAYOUT.CENTER_2D:\n        case LAYOUT.TOP_1D: {\n          return scaleY.invert(position.y);\n        }\n        case LAYOUT.LEFT_1D: {\n          return scaleY.invert(position.x);\n        }\n        default:\n          return 0;\n      }\n    }\n    return 0;\n  };\n\n  const getRation = () => {\n    switch (trackID) {\n      case LAYOUT.TOP_1D: {\n        return (\n          (getRealYValue(startX) / (getRealYValue(endX) || Number.MIN_VALUE)) *\n          100\n        ).toFixed(2);\n      }\n      case LAYOUT.LEFT_1D: {\n        return (\n          (getRealYValue(startY) / (getRealYValue(endY) || Number.MIN_VALUE)) *\n          100\n        ).toFixed(2);\n      }\n      default:\n        return 0;\n    }\n  };\n\n  const getDeltaX = () => {\n    switch (trackID) {\n      case LAYOUT.TOP_1D: {\n        return (getXValue(startX) - getXValue(endX)).toPrecision(6);\n      }\n      case LAYOUT.LEFT_1D: {\n        return (getXValue(startY) - getXValue(endY)).toPrecision(6);\n      }\n      default:\n        return 0;\n    }\n  };\n\n  const getLabel = (label2d, labelld, nucleus) => {\n    return trackID === LAYOUT.CENTER_2D ? (\n      <Fragment>\n        {label2d} ( <MF mf={nucleus} /> )\n      </Fragment>\n    ) : (\n      labelld\n    );\n  };\n\n  const getZValue = () => {\n    if (trackID === LAYOUT.CENTER_2D) {\n      const { maxX, maxY, minX, minY, z } = data[activeSpectrum.index]\n        .data as any;\n\n      const xStep = (maxX - minX) / (z[0].length - 1);\n      const yStep = (maxY - minY) / (z.length - 1);\n      const xIndex = Math.floor((getXValue() - minX) / xStep);\n      const yIndex = Math.floor((getYValue() - minY) / yStep);\n\n      if (xIndex < 0 || xIndex >= z[0].length) return 0;\n      if (yIndex < 0 || yIndex >= z.length) return 0;\n\n      return z[yIndex][xIndex];\n    }\n    return 0;\n  };\n\n  return (\n    <div css={styles}>\n      <div>\n        <span className=\"label\">{getLabel('F2', 'X', nucleuses[0])} :</span>\n        <span className=\"value\">{formatX(getXValue())}</span>\n        <span className=\"unit\">ppm</span>\n      </div>\n\n      <div>\n        <span className=\"label\">{getLabel('F1', 'Y', nucleuses[1])} :</span>\n        <span className=\"value\">{formatY(getYValue())}</span>\n        <span className=\"unit\">ppm</span>\n      </div>\n      <div>\n        <span className=\"label\">Intensity :</span>\n        <span className=\"value\">{getZValue()}</span>\n      </div>\n      {step === 'brushing' && (\n        <div>\n          <span className=\"label\"> Δppm :</span>\n          <span className=\"value\">{getDeltaX()}</span>\n        </div>\n      )}\n\n      {step === 'brushing' && (\n        <div>\n          <span className=\"label\"> ratio :</span>\n          <span className=\"value\">{getRation()}%</span>\n        </div>\n      )}\n    </div>\n  );\n}\n\nexport default FooterBanner;\n","import { useContext, useMemo, CSSProperties } from 'react';\n\nimport { BrushContext } from '../../EventsTrackers/BrushTracker';\nimport { MouseContext } from '../../EventsTrackers/MouseTracker';\nimport { useChartData } from '../../context/ChartContext';\nimport { useFormatNumberByNucleus } from '../../utility/FormatNumber';\nimport { getLayoutID, LAYOUT } from '../utilities/DimensionLayout';\nimport { get2DXScale, get2DYScale, get1DYScale } from '../utilities/scale';\n\nconst style: CSSProperties = {\n  cursor: 'crosshair',\n  transformOrigin: 'bottom right',\n  position: 'absolute',\n  top: '-18px',\n  left: '-88px',\n  fontWeight: 'bold',\n  pointerEvents: 'none',\n  overflow: 'visible',\n  userSelect: 'none',\n  width: '85px',\n  textAlign: 'right',\n};\n\nfunction XYLabelPointer({ layout, data1D }) {\n  const position = useContext(MouseContext);\n  const { step } = useContext(BrushContext);\n  const {\n    margin,\n    width,\n    height,\n    xDomain,\n    yDomain,\n    yDomains,\n    activeTab,\n    activeSpectrum,\n  } = useChartData();\n\n  const trackID =\n    position &&\n    getLayoutID(layout, {\n      startX: position.x,\n      startY: position.y,\n    });\n\n  const nucleuses = activeTab.split(',');\n  const [formatX, formatY] = useFormatNumberByNucleus(nucleuses);\n\n  const scaleX = useMemo(() => {\n    if (!activeSpectrum || !data1D || data1D.length === 0) {\n      return get2DXScale({ width, margin, xDomain });\n    }\n\n    switch (trackID) {\n      case LAYOUT.TOP_1D:\n      case LAYOUT.CENTER_2D: {\n        return get2DXScale({ width, margin, xDomain });\n      }\n      case LAYOUT.LEFT_1D: {\n        return get2DYScale({ height, margin, yDomain });\n      }\n      default:\n        return null;\n    }\n  }, [\n    activeSpectrum,\n    data1D,\n    height,\n    margin,\n    trackID,\n    width,\n    xDomain,\n    yDomain,\n  ]);\n\n  const scaleY = useMemo(() => {\n    if (!activeSpectrum || !data1D || data1D.length === 0) {\n      return get2DYScale({ height, margin, yDomain });\n    }\n\n    switch (trackID) {\n      case LAYOUT.CENTER_2D: {\n        return get2DYScale({ height, margin, yDomain });\n      }\n      case LAYOUT.TOP_1D: {\n        return data1D[0]\n          ? get1DYScale(yDomains[data1D[0].id], margin.top)\n          : null;\n      }\n      case LAYOUT.LEFT_1D: {\n        return data1D[1]\n          ? get1DYScale(yDomains[data1D[1].id], margin.left)\n          : null;\n      }\n      default:\n        return null;\n    }\n  }, [activeSpectrum, data1D, height, margin, trackID, yDomain, yDomains]);\n\n  if (\n    step === 'brushing' ||\n    !position ||\n    position.y < margin.top ||\n    position.x < margin.left ||\n    position.x > width - margin.right ||\n    position.y > height - margin.bottom\n  ) {\n    return null;\n  }\n\n  const getXValue = (x = null) => {\n    switch (trackID) {\n      case LAYOUT.CENTER_2D:\n      case LAYOUT.TOP_1D: {\n        return scaleX?.invert(x ? x : position.x);\n      }\n      case LAYOUT.LEFT_1D: {\n        return scaleX?.invert(x ? x : position.y);\n      }\n      default:\n        return 0;\n    }\n  };\n\n  const getYValue = () => {\n    switch (trackID) {\n      case LAYOUT.CENTER_2D:\n      case LAYOUT.TOP_1D: {\n        return scaleY?.invert(position.y);\n      }\n      case LAYOUT.LEFT_1D: {\n        return scaleY?.invert(position.x);\n      }\n      default:\n        return 0;\n    }\n  };\n\n  return (\n    <div\n      key=\"xLabelPointer\"\n      style={{\n        ...style,\n        transform: `translate(${position.x}px, ${position.y}px)`,\n      }}\n    >\n      <span>{formatY(getYValue())}</span>\n      <span style={{ color: 'gray' }}>{','}</span>\n      <span style={{ color: 'red' }}>{formatX(getXValue())}</span>\n    </div>\n  );\n}\n\nexport default XYLabelPointer;\n","import { extent, scaleLinear } from 'd3';\n\nfunction getTopXScale(\n  width: number,\n  margin: { right: number; left: number },\n  x: Array<number>,\n) {\n  const xDomain = extent<number>(x);\n  const scaleX = scaleLinear(extent(x) as number[], [\n    width - margin.right,\n    margin.left,\n  ]);\n\n  return {\n    xDomain,\n    scaleX,\n  };\n}\n\nfunction getLeftXScale(\n  width: number,\n  margin: { bottom: number; top: number },\n  x: Array<number>,\n) {\n  const xDomain = extent(x);\n\n  const scaleX = scaleLinear(extent(x) as number[], [\n    width - margin.bottom,\n    margin.top,\n  ]);\n\n  return {\n    xDomain,\n    scaleX,\n  };\n}\n\nfunction getYScale(height: number, y: Array<number>, margin = 10) {\n  return scaleLinear(extent(y) as number[], [height - margin, margin]);\n}\n\nexport { getTopXScale, getLeftXScale, getYScale };\n","import { useMemo, memo } from 'react';\n\nimport { useChartData } from '../../../context/ChartContext';\nimport useXYReduce, { XYReducerDomainAxis } from '../../../hooks/useXYReduce';\nimport { PathBuilder } from '../../../utility/PathBuilder';\nimport { get2DXScale } from '../../utilities/scale';\n\nimport { getYScale } from './SliceScale';\n\ninterface HorizontalSliceChartProps {\n  margin?: number;\n  data: {\n    x: Array<number>;\n    re: Array<number>;\n  };\n}\n\nfunction HorizontalSliceChart({\n  margin: marginProps = 10,\n  data,\n}: HorizontalSliceChartProps) {\n  const { width, margin: originMargin, xDomain, displayerKey } = useChartData();\n  const xyReduce = useXYReduce(XYReducerDomainAxis.XAxis);\n\n  const height = originMargin.top;\n\n  const paths = useMemo(() => {\n    if (data) {\n      const { x, re: y } = data;\n      const scaleX = get2DXScale({ margin: originMargin, width, xDomain });\n\n      const scaleY = getYScale(height, y, marginProps);\n      const pathPoints = xyReduce({ x, y });\n\n      const pathBuilder = new PathBuilder();\n      pathBuilder.moveTo(scaleX(pathPoints.x[0]), scaleY(pathPoints.y[0]));\n      for (let i = 1; i < pathPoints.x.length; i++) {\n        pathBuilder.lineTo(scaleX(pathPoints.x[i]), scaleY(pathPoints.y[i]));\n      }\n\n      return pathBuilder.toString();\n    } else {\n      return undefined;\n    }\n  }, [data, height, marginProps, originMargin, width, xDomain, xyReduce]);\n\n  if (!width || !height) {\n    return null;\n  }\n\n  return (\n    <svg viewBox={`0 0 ${width} ${height}`} width={width} height={height}>\n      <defs>\n        <clipPath id={`${displayerKey}clip-top`}>\n          <rect\n            width={width - originMargin.left - originMargin.right}\n            height={height}\n            x={originMargin.left}\n            y={`${0}`}\n          />\n        </clipPath>\n      </defs>\n      <g clipPath={`url(#${displayerKey}clip-top)`}>\n        <rect\n          width={width - originMargin.left - originMargin.right}\n          height={height}\n          x={originMargin.left}\n          y={`${0}`}\n          fillOpacity=\"0\"\n        />\n        <path className=\"line\" stroke=\"red\" fill=\"none\" d={paths} />\n      </g>\n    </svg>\n  );\n}\n\nexport default memo(HorizontalSliceChart);\n","import { useMemo, memo } from 'react';\n\nimport { useChartData } from '../../../context/ChartContext';\nimport useXYReduce, { XYReducerDomainAxis } from '../../../hooks/useXYReduce';\nimport { PathBuilder } from '../../../utility/PathBuilder';\nimport { get2DYScale } from '../../utilities/scale';\n\nimport { getYScale } from './SliceScale';\n\ninterface VerticalSliceChartProps {\n  margin?: number;\n  data: {\n    x: Array<number>;\n    re: Array<number>;\n  };\n}\n\nfunction VerticalSliceChart({\n  margin: marignValue = 10,\n  data,\n}: VerticalSliceChartProps) {\n  const {\n    height: originHeight,\n    margin,\n    yDomain,\n    displayerKey,\n  } = useChartData();\n  const xyReduce = useXYReduce(XYReducerDomainAxis.YAxis);\n\n  const height = margin.left;\n\n  const paths = useMemo(() => {\n    if (data) {\n      const { x, re: y } = data;\n      const scaleX = get2DYScale({ height: originHeight, margin, yDomain });\n\n      const scaleY = getYScale(height, y, marignValue);\n\n      const pathPoints = xyReduce({ x, y });\n\n      const pathBuilder = new PathBuilder();\n\n      pathBuilder.moveTo(\n        scaleY(pathPoints.y[pathPoints.y.length - 1]),\n        scaleX(pathPoints.x.length - 1),\n      );\n\n      for (let i = pathPoints.x.length - 2; i >= 0; i--) {\n        pathBuilder.lineTo(scaleY(pathPoints.y[i]), scaleX(pathPoints.x[i]));\n      }\n\n      return pathBuilder.toString();\n    } else {\n      return undefined;\n    }\n  }, [data, height, margin, marignValue, originHeight, xyReduce, yDomain]);\n\n  const mainHeight = originHeight - margin.bottom - margin.top;\n\n  if (!mainHeight || !height) return null;\n\n  return (\n    <svg\n      viewBox={`0 0 ${height} ${mainHeight + margin.top}`}\n      width={height}\n      height={mainHeight + margin.top}\n    >\n      <defs>\n        <clipPath id={`${displayerKey}clip-left`}>\n          <rect width={height} height={mainHeight} x=\"0\" y={margin.top} />\n        </clipPath>\n      </defs>\n      <g clipPath={`url(#${displayerKey}clip-left)`}>\n        <path className=\"line\" stroke=\"red\" fill=\"none\" d={paths} />\n      </g>\n    </svg>\n  );\n}\n\nexport default memo(VerticalSliceChart);\n","import { useMemo } from 'react';\n\nimport { getSlice } from '../../../../data/data2d/Spectrum2D';\nimport { Datum2D } from '../../../../data/types/data2d/Datum2D';\nimport { useMouseTracker } from '../../../EventsTrackers/MouseTracker';\nimport { useChartData } from '../../../context/ChartContext';\nimport { get2DXScale, get2DYScale } from '../../utilities/scale';\n\nimport HorizontalSliceChart from './HorizontalSliceChart';\nimport VerticalSliceChart from './VerticalSliceChart';\n\nfunction SlicingView() {\n  const {\n    width,\n    height,\n    margin,\n    activeSpectrum,\n    data: spectra,\n    xDomain,\n    yDomain,\n  } = useChartData();\n  const position = useMouseTracker();\n\n  const chart2d = useMemo(() => {\n    if (position && activeSpectrum && activeSpectrum.id) {\n      const { x, y } = position;\n      const scale2dX = get2DXScale({ margin, width, xDomain });\n      const scale2dY = get2DYScale({ margin, height, yDomain });\n      const data = getSlice(spectra[activeSpectrum.index] as Datum2D, {\n        x: scale2dX.invert(x),\n        y: scale2dY.invert(y),\n      });\n      return (\n        <svg\n          viewBox={`0 0 ${width} ${height}`}\n          width={width}\n          height={height}\n          style={{\n            position: 'absolute',\n            backgroundColor: 'rgba(255,255,255,0.8)',\n          }}\n        >\n          {data?.horizontal && (\n            <HorizontalSliceChart data={data.horizontal.data} />\n          )}\n          {data?.vertical && <VerticalSliceChart data={data.vertical.data} />}\n        </svg>\n      );\n    }\n    return null;\n  }, [\n    position,\n    activeSpectrum,\n    margin,\n    width,\n    xDomain,\n    height,\n    yDomain,\n    spectra,\n  ]);\n\n  if (!position) {\n    return null;\n  }\n\n  return chart2d;\n}\n\nexport default SlicingView;\n","import { useCallback, useEffect, useMemo, ReactNode } from 'react';\nimport { ResponsiveChart } from 'react-d3-utils';\n\nimport { BrushTracker } from '../EventsTrackers/BrushTracker';\nimport { MouseTracker } from '../EventsTrackers/MouseTracker';\nimport { useChartData } from '../context/ChartContext';\nimport { useDispatch } from '../context/DispatchContext';\nimport useSpectrum from '../hooks/useSpectrum';\nimport NoData from '../loader/NoData';\nimport Spinner from '../loader/Spinner';\nimport {\n  BRUSH_END,\n  FULL_ZOOM_OUT,\n  SET_DIMENSIONS,\n  SET_2D_LEVEL,\n  SET_ZOOM,\n  ADD_2D_ZONE,\n} from '../reducer/types/Types';\nimport BrushXY, { BRUSH_TYPE } from '../tool/BrushXY';\nimport CrossLinePointer from '../tool/CrossLinePointer';\nimport { options } from '../toolbar/ToolTypes';\n\nimport Chart2D from './Chart2D';\nimport FooterBanner from './FooterBanner';\nimport XYLabelPointer from './tools/XYLabelPointer';\nimport SlicingView from './tools/slicing/SlicingView';\nimport { get2DDimensionLayout, getLayoutID } from './utilities/DimensionLayout';\n\ninterface Viewer2DProps {\n  emptyText: ReactNode;\n}\n\nfunction Viewer2D({ emptyText = undefined }: Viewer2DProps) {\n  const state = useChartData();\n  const {\n    toolOptions: { selectedTool },\n    isLoading,\n    data,\n    margin,\n    tabActiveSpectrum,\n    activeTab,\n  } = state;\n\n  const dispatch = useDispatch();\n  const { info } = useSpectrum({ info: {} });\n  const isVisible = info.isFt || !('isFt' in info);\n\n  const spectrumData = useMemo(() => {\n    const nucleuses = activeTab.split(',');\n    return nucleuses.reduce<any>((acc, n) => {\n      if (tabActiveSpectrum[n]?.id) {\n        const id = tabActiveSpectrum[n]?.id;\n        const spectrum = data.find(\n          (datum) => datum.id === id && !datum.info.isFid,\n        );\n        if (spectrum) {\n          acc.push(spectrum);\n        }\n      } else {\n        acc.push(null);\n      }\n      return acc;\n    }, []);\n  }, [activeTab, data, tabActiveSpectrum]);\n\n  const DIMENSION = get2DDimensionLayout(state);\n\n  const handelBrushEnd = useCallback(\n    (brushData) => {\n      const trackID = getLayoutID(DIMENSION, brushData);\n      if (trackID) {\n        if (brushData.altKey) {\n          switch (selectedTool) {\n            default:\n              break;\n          }\n        } else if (brushData.shiftKey) {\n          switch (selectedTool) {\n            case options.zone2D.id:\n              dispatch({ type: ADD_2D_ZONE, ...brushData });\n              break;\n            default:\n              break;\n          }\n        } else {\n          switch (selectedTool) {\n            default:\n              if (selectedTool != null) {\n                return dispatch({\n                  type: BRUSH_END,\n                  ...brushData,\n                  trackID: getLayoutID(DIMENSION, brushData),\n                });\n              }\n          }\n        }\n      }\n    },\n    [selectedTool, dispatch, DIMENSION],\n  );\n\n  const handelOnDoubleClick = useCallback(\n    (e) => {\n      const { x: startX, y: startY } = e;\n      const trackID = getLayoutID(DIMENSION, { startX, startY });\n      if (trackID) {\n        dispatch({ type: FULL_ZOOM_OUT, trackID });\n      }\n    },\n    [DIMENSION, dispatch],\n  );\n\n  const handleZoom = (event) => {\n    const { x: startX, y: startY } = event;\n    const trackID = getLayoutID(DIMENSION, { startX, startY });\n\n    if (trackID) {\n      if (trackID === 'CENTER_2D') {\n        dispatch({ type: SET_2D_LEVEL, ...event });\n      } else {\n        dispatch({ type: SET_ZOOM, event, trackID });\n      }\n    }\n  };\n\n  const mouseClick = useCallback(\n    (position) => {\n      // eslint-disable-next-line @typescript-eslint/no-unused-vars\n      const { x, y } = position;\n      switch (selectedTool) {\n        default:\n          break;\n      }\n    },\n    [selectedTool],\n  );\n\n  if (!isVisible) {\n    return (\n      <NoData\n        emptyText=\"Currently FID can not be displayed for 2D spectra\"\n        canOpenLoader={false}\n      />\n    );\n  }\n\n  return (\n    <ResponsiveChart>\n      {({ width, height }) => (\n        <ViewerResponsiveWrapper width={width} height={height}>\n          <Spinner isLoading={isLoading} emptyText={emptyText} />\n          {data && data.length > 0 && (\n            <BrushTracker\n              onBrush={handelBrushEnd}\n              onDoubleClick={handelOnDoubleClick}\n              onClick={mouseClick}\n              onZoom={handleZoom}\n              style={{\n                width: '100%',\n                height: '100%',\n                margin: 'auto',\n                position: 'relative',\n                overflow: 'hidden',\n              }}\n            >\n              <MouseTracker\n                style={{ width: '100%', height: `100%`, position: 'absolute' }}\n              >\n                {selectedTool && selectedTool === options.slicingTool.id && (\n                  <SlicingView />\n                )}\n\n                <CrossLinePointer />\n                {spectrumData && (\n                  <XYLabelPointer data1D={spectrumData} layout={DIMENSION} />\n                )}\n\n                <BrushXY\n                  brushType={BRUSH_TYPE.XY}\n                  dimensionBorder={DIMENSION.CENTER_2D}\n                />\n                <>\n                  {spectrumData?.[0] && (\n                    <BrushXY\n                      brushType={BRUSH_TYPE.X}\n                      dimensionBorder={DIMENSION.TOP_1D}\n                      height={margin.top}\n                    />\n                  )}\n                  {spectrumData?.[1] && (\n                    <BrushXY\n                      brushType={BRUSH_TYPE.Y}\n                      dimensionBorder={DIMENSION.LEFT_1D}\n                      width={margin.left}\n                    />\n                  )}\n                </>\n                {spectrumData && (\n                  <FooterBanner data1D={spectrumData} layout={DIMENSION} />\n                )}\n\n                <Chart2D spectra={spectrumData} />\n              </MouseTracker>\n            </BrushTracker>\n          )}\n        </ViewerResponsiveWrapper>\n      )}\n    </ResponsiveChart>\n  );\n}\n\ninterface ViewerResponsiveWrapperProps {\n  width: number;\n  height: number;\n  children: any;\n}\n\nexport function ViewerResponsiveWrapper(props: ViewerResponsiveWrapperProps) {\n  const dispatch = useDispatch();\n  const { width, height, children } = props;\n\n  useEffect(() => {\n    dispatch({ type: SET_DIMENSIONS, ...{ width, height } });\n  }, [width, height, dispatch]);\n\n  return children;\n}\n\nexport default Viewer2D;\n","import { ScaleLinear } from 'd3';\nimport { produce } from 'immer';\n\nimport { getXScale, getYScale } from '../1d/utilities/scale';\n\nexport const SET_X_SCALE = 'SET_X_SCALE';\nexport const SET_Y_SCALE = 'SET_Y_SCALE';\nexport const SET_SCALE = 'SET_SCALE';\n\ntype ScaleLinearNumberFunction = (\n  spectrumId?: number | null | string,\n) => ScaleLinear<number, number, number>;\n\nexport interface ScaleState {\n  scaleX: ScaleLinearNumberFunction | null;\n  scaleY: ScaleLinearNumberFunction | null;\n}\n\nexport const scaleInitialState: ScaleState = {\n  scaleX: null,\n  scaleY: null,\n};\n\nfunction innerScaleReducer(draft: ScaleState, action) {\n  switch (action.type) {\n    case SET_X_SCALE:\n      draft.scaleX = (spectrumId = null) => getXScale(action, spectrumId);\n      break;\n\n    case SET_Y_SCALE:\n      draft.scaleY = (spectrumId = null) => getYScale(action, spectrumId);\n      break;\n\n    case SET_SCALE: {\n      draft.scaleX = (spectrumId = null) =>\n        getXScale(action.payload, spectrumId);\n      draft.scaleY = (spectrumId = null) =>\n        getYScale(action.payload, spectrumId);\n      break;\n    }\n    default:\n      return draft;\n  }\n}\n\nconst scaleReducer = produce(innerScaleReducer);\nexport default scaleReducer;\n","import { createContext, useContext } from 'react';\n\nimport { scaleInitialState, ScaleState } from '../reducer/scaleReducer';\n\nexport const scaleContext = createContext<ScaleState>(scaleInitialState);\nexport const ScaleProvider = scaleContext.Provider;\n\nexport function useScale() {\n  return useContext(scaleContext);\n}\n\ntype CheckedScaleState = {\n  [key in keyof ScaleState]: Exclude<ScaleState[key], null>;\n};\n\nexport function useScaleChecked(): CheckedScaleState {\n  const scale = useScale();\n\n  if (!scale.scaleX || !scale.scaleY) {\n    throw new Error('scale cannot be null');\n  }\n\n  return scale as CheckedScaleState;\n}\n","export const positions = {\n  TOP_LEFT: 'top left',\n  TOP_CENTER: 'top center',\n  TOP_RIGHT: 'top right',\n  MIDDLE_LEFT: 'middle left',\n  MIDDLE: 'middle',\n  MIDDLE_RIGHT: 'middle right',\n  BOTTOM_LEFT: 'bottom left',\n  BOTTOM_CENTER: 'bottom center',\n  BOTTOM_RIGHT: 'bottom right',\n};\n\nexport const types = {\n  INFO: 'info',\n  SUCCESS: 'success',\n  ERROR: 'error',\n  PROGRESS_INDICATOR: 'progress_indicator',\n};\n\nexport const transitions = {\n  FADE: 'fade',\n  SCALE: 'scale',\n  SLIDE_RIGHT: 'slide_right',\n  SLIDE_LEFT: 'slide_left',\n  SLIDE_TOP: 'slide_top',\n  SLIDE_BOTTOM: 'slide_bottom',\n};\n","import { createContext, useContext } from 'react';\n\nconst AlertContext = createContext<any>({});\n\nexport const AlertProvider = AlertContext.Provider;\n\nexport function useAlert() {\n  return useContext(AlertContext);\n}\n","import { CSSProperties, ReactNode, useRef } from 'react';\nimport { Transition as ContainerTransition } from 'react-transition-group';\n\nimport { transitions } from './options';\n\nconst duration = 250;\n\nconst defaultStyle: Record<string, CSSProperties> = {\n  [transitions.FADE]: {\n    transition: `opacity ${duration}ms ease`,\n    opacity: 0,\n  },\n  [transitions.SCALE]: {\n    transform: 'scale(1)',\n    transition: `all ${duration}ms ease-in-out`,\n  },\n};\n\ntype TransitionStyles = Record<\n  string,\n  Partial<{\n    entering: CSSProperties;\n    entered: CSSProperties;\n    exiting: CSSProperties;\n    exited: CSSProperties;\n  }>\n>;\n\nconst defaultTransitionStyles: TransitionStyles = {\n  [transitions.FADE]: {\n    entering: { opacity: 0 },\n    entered: { opacity: 1 },\n  },\n  [transitions.SCALE]: {\n    entering: { transform: 'scale(0)' },\n    entered: { transform: 'scale(1)' },\n    exiting: { transform: 'scale(0)' },\n    exited: { transform: 'scale(1)' },\n  },\n};\n\ninterface TransitionProps {\n  children: ReactNode;\n  type: string;\n  transitionStyles?: TransitionStyles;\n}\n\nexport default function Transtion({\n  children,\n  type,\n  transitionStyles = defaultTransitionStyles,\n  ...props\n}: TransitionProps) {\n  const ref = useRef(null);\n  return (\n    <ContainerTransition nodeRef={ref} {...props} timeout={duration}>\n      {(state) => (\n        <div\n          ref={ref}\n          style={{\n            ...defaultStyle[type],\n            ...transitionStyles[type][state],\n            ...transitionStyles.default,\n          }}\n        >\n          {children}\n        </div>\n      )}\n    </ContainerTransition>\n  );\n}\n","import { useMemo } from 'react';\n\nimport { positions } from './options';\n\nfunction getStyles(position, containerStyle): any {\n  const initialStyles = {\n    position: 'fixed',\n    display: 'flex',\n    justifyContent: 'center',\n    alignItems: 'center',\n    flexDirection: 'column',\n    pointerEvents: 'none',\n    overflow: 'visible',\n    ...(containerStyle\n      ? {\n          top: `${containerStyle.top}px`,\n          left: `${containerStyle.left}px`,\n          height: `${containerStyle.height}px`,\n          width: `${containerStyle.width}px`,\n        }\n      : { width: '100%', height: '100%' }),\n  };\n\n  switch (position) {\n    case positions.TOP_LEFT:\n      return {\n        ...initialStyles,\n        justifyContent: 'flex-start',\n        alignItems: 'flex-start',\n      };\n    case positions.TOP_CENTER:\n      return {\n        ...initialStyles,\n        justifyContent: 'flex-start',\n      };\n    case positions.TOP_RIGHT:\n      return {\n        ...initialStyles,\n        justifyContent: 'flex-start',\n        alignItems: 'flex-end',\n      };\n    case positions.MIDDLE_LEFT:\n      return {\n        ...initialStyles,\n        justifyContent: 'center',\n        alignItems: 'flex-start',\n      };\n    case positions.MIDDLE: {\n      return {\n        ...initialStyles,\n        justifyContent: 'center',\n      };\n    }\n    case positions.MIDDLE_RIGHT:\n      return {\n        ...initialStyles,\n        justifyContent: 'center',\n\n        alignItems: 'flex-end',\n      };\n\n    case positions.BOTTOM_LEFT:\n      return {\n        ...initialStyles,\n        justifyContent: 'flex-end',\n\n        alignItems: 'flex-start',\n      };\n    case positions.BOTTOM_CENTER:\n      return {\n        ...initialStyles,\n        justifyContent: 'flex-end',\n      };\n    case positions.BOTTOM_RIGHT:\n      return {\n        ...initialStyles,\n        justifyContent: 'flex-end',\n\n        alignItems: 'flex-end',\n      };\n\n    default: {\n      return initialStyles;\n    }\n  }\n}\n\nexport default function Wrapper({\n  children,\n  options: { position },\n  containerStyle,\n  ...props\n}) {\n  const styles = useMemo(\n    () => getStyles(position, containerStyle),\n    [position, containerStyle],\n  );\n\n  return (\n    children.length > 0 && (\n      <div style={styles} {...props}>\n        {children}\n      </div>\n    )\n  );\n}\n","export function groupBy(\n  array: Array<any>,\n  fn: (item: any) => string,\n): Array<any> {\n  return array.reduce((result, item) => {\n    const key = fn(item);\n    if (!result[key]) result[key] = [];\n    result[key].push(item);\n    return result;\n  }, {});\n}\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\n\nconst styles = css`\n  width: 40px;\n  height: 40px;\n  margin: 0 auto;\n  :after {\n    content: ' ';\n    display: block;\n    width: 30px;\n    height: 30px;\n    margin-top: 10px;\n    border-radius: 50%;\n    border: 4px solid;\n    border-color: #fff transparent #fff transparent;\n    animation: ring-animation 1s linear infinite;\n  }\n  @keyframes ring-animation {\n    0% {\n      transform: rotate(0deg);\n    }\n    100% {\n      transform: rotate(360deg);\n    }\n  }\n`;\n\nexport default function ProgressIndicator() {\n  return <div css={styles} />;\n}\n","import {\n  Fragment,\n  useState,\n  useRef,\n  useEffect,\n  useCallback,\n  useMemo,\n  memo,\n  CSSProperties,\n  ReactNode,\n} from 'react';\nimport { createPortal } from 'react-dom';\nimport { FaTimes } from 'react-icons/fa';\nimport { TransitionGroup } from 'react-transition-group';\n\nimport Transition from '../Transition';\nimport Wrapper from '../Wrapper';\nimport { groupBy } from '../helpers';\nimport { positions, transitions, types } from '../options';\n\nimport { AlertProvider } from './Context';\nimport ProgressIndicator from './ProgressIndicator';\n\ninterface ProviderProps {\n  children: ReactNode;\n  offset?: string;\n  position?: any;\n  timeout?: number;\n  type?: any;\n  transition?: any;\n  containerStyle?: CSSProperties;\n  wrapperRef?: any;\n  context?: {\n    Provider?: any;\n    Consumer?: any;\n  };\n}\n\nfunction Provider({\n  children,\n  wrapperRef = null,\n  offset = '5px',\n  position = positions.BOTTOM_CENTER,\n  timeout = 3000,\n  type,\n  transition = transitions.FADE,\n  ...props\n}: ProviderProps) {\n  const root = useRef<any>(null);\n  const timersId = useRef<any>([]);\n  const [alerts, setAlerts] = useState<any[]>([]);\n\n  useEffect(() => {\n    root.current = document.createElement('div');\n    const ref = root.current;\n    const timersIdRef = timersId.current;\n\n    if (wrapperRef) {\n      wrapperRef.appendChild(ref);\n    }\n    return () => {\n      if (ref) {\n        if (wrapperRef) {\n          timersIdRef.forEach(clearTimeout);\n\n          wrapperRef.removeChild(ref);\n        }\n      }\n    };\n  }, [wrapperRef]);\n\n  const remove = useCallback((alert) => {\n    setAlerts((currentAlerts) => {\n      const lengthBeforeRemove = currentAlerts.length;\n      const filteredAlerts = currentAlerts.filter((a) => a.id !== alert.id);\n\n      if (lengthBeforeRemove > filteredAlerts.length && alert.options.onClose) {\n        alert.options.onClose();\n      }\n\n      return filteredAlerts;\n    });\n  }, []);\n\n  const show = useCallback(\n    (message = '', options = {}) => {\n      const id = Math.random().toString(36).substr(2, 9);\n\n      const alertOptions = {\n        position: options.position || position,\n        timeout,\n        type,\n        backgroundColor: 'black',\n        color: 'white',\n        ...options,\n      };\n\n      const alert: any = {\n        id,\n        message,\n        options: alertOptions,\n      };\n\n      alert.close = () => remove(alert);\n\n      if (alert.options.timeout) {\n        const timerId = setTimeout(() => {\n          remove(alert);\n\n          timersId.current.splice(timersId.current.indexOf(timerId), 1);\n        }, alert.options.timeout);\n\n        timersId.current.push(timerId);\n      }\n\n      setAlerts((state) => state.concat(alert));\n      if (alert.options.onOpen) alert.options.onOpen();\n\n      return alert;\n    },\n    [position, remove, timeout, type],\n  );\n\n  const success = useCallback(\n    (message = '', options = {}) => {\n      options.type = types.SUCCESS;\n      options = { backgroundColor: '#28ba62', color: 'white', ...options };\n\n      return show(message, options);\n    },\n    [show],\n  );\n\n  const error = useCallback(\n    (message = '', options = {}) => {\n      options.type = types.ERROR;\n      options = { backgroundColor: '#cf3c4f', color: 'white', ...options };\n      return show(message, options);\n    },\n    [show],\n  );\n\n  const info = useCallback(\n    (message = '', options = {}) => {\n      options.type = types.INFO;\n      options.color = '#28ba62';\n      return show(message, options);\n    },\n    [show],\n  );\n\n  const showLoading = useCallback(\n    (message = 'Process in progress', options = {}) => {\n      options.type = types.PROGRESS_INDICATOR;\n      options.timeout = 0;\n      options.backgroundColor = '#232323';\n\n      return new Promise((resolve) => {\n        const alert = show(message, options);\n        setTimeout(() => {\n          resolve(() => remove(alert));\n        }, 500);\n      });\n    },\n    [remove, show],\n  );\n\n  const closeHandler = useCallback(\n    (alert) => {\n      remove(alert);\n    },\n    [remove],\n  );\n\n  const alertsByPosition = groupBy(alerts, (alert) => alert.options.position);\n\n  const parentStyle = useMemo(() => {\n    return wrapperRef\n      ? wrapperRef.getBoundingClientRect()\n      : {\n          top: 0,\n          left: 0,\n          width: window.innerWidth,\n          height: window.innerHeight,\n        };\n  }, [wrapperRef]);\n\n  const alertContextValue = useMemo(\n    () => ({ show, success, error, info, showLoading }),\n    [show, success, error, info, showLoading],\n  );\n\n  return (\n    <AlertProvider value={alertContextValue}>\n      {children}\n      {root.current &&\n        createPortal(\n          <Fragment>\n            {Object.keys(positions).map((key) => {\n              const position = positions[key];\n\n              return (\n                <TransitionGroup\n                  appear\n                  key={position}\n                  options={{ position, zIndex: 999999 }}\n                  component={Wrapper}\n                  containerStyle={parentStyle}\n                  {...props}\n                >\n                  {alertsByPosition[position]\n                    ? alertsByPosition[position].map((alert) => (\n                        <Transition type={transition} key={alert.id}>\n                          <div\n                            style={{\n                              margin: offset,\n                              padding: '25px',\n                              borderRadius: '10px',\n                              pointerEvents: 'all',\n                              backgroundColor: alert.options.backgroundColor,\n                              color: alert.options.color,\n                              minHeight: '60px',\n                              position: 'relative',\n                            }}\n                            key={alert.id}\n                          >\n                            <button\n                              style={{\n                                position: 'absolute',\n                                right: '5px',\n                                top: '5px',\n                                border: 'none',\n                                backgroundColor: 'transparent',\n                                color: 'white',\n                              }}\n                              type=\"button\"\n                              onClick={() => closeHandler(alert)}\n                            >\n                              <FaTimes />\n                            </button>\n\n                            <span>{alert.message}</span>\n                            {alert.options.type ===\n                              types.PROGRESS_INDICATOR && <ProgressIndicator />}\n                          </div>\n                        </Transition>\n                      ))\n                    : null}\n                </TransitionGroup>\n              );\n            })}\n          </Fragment>,\n          root.current,\n        )}\n    </AlertProvider>\n  );\n}\n\nexport default memo(Provider);\n","import { createContext, useContext } from 'react';\n\nconst ModalContext = createContext<any>({});\nexport const ModalProvider = ModalContext.Provider;\n\nexport function useModal() {\n  return useContext(ModalContext);\n}\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { CSSProperties, useCallback } from 'react';\n\nconst styles = css`\n  display: block;\n  border-radius: 5px;\n  overflow: hidden;\n  width: 300px;\n  border-top: 10px solid #ed0000;\n\n  .message {\n    font-weight: bold;\n    font-size: 14px;\n    text-align: center;\n    color: #af0000;\n    text-align: center;\n    padding: 25px;\n    display: block;\n  }\n  .buttons-container {\n    display: flex;\n    flex-direction: row-reverse;\n    align-items: flex-end;\n    padding: 5px;\n    border-top: 1px solid #efefef;\n\n    button:last-of-type {\n      border-radius: 5px 0 0 5px;\n    }\n    button:first-of-type {\n      border-radius: 0px 5px 5px 0px;\n      border-width: 1px;\n    }\n    button {\n      border-color: #dcdcdc;\n      border-width: 1px 0px 1px 1px;\n      background-color: white;\n      display: inline-block;\n      cursor: pointer;\n      color: #363636;\n      font-weight: bold;\n      padding: 6px 24px;\n      text-decoration: none;\n    }\n    button:hover {\n      background: -webkit-gradient(\n        linear,\n        left top,\n        left bottom,\n        color-stop(0.05, #f6f6f6),\n        color-stop(1, #ffffff)\n      );\n      background: -moz-linear-gradient(top, #f6f6f6 5%, #ffffff 100%);\n      background: -webkit-linear-gradient(top, #f6f6f6 5%, #ffffff 100%);\n      background: -o-linear-gradient(top, #f6f6f6 5%, #ffffff 100%);\n      background: -ms-linear-gradient(top, #f6f6f6 5%, #ffffff 100%);\n      background: linear-gradient(to bottom, #f6f6f6 5%, #ffffff 100%);\n      filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#f6f6f6', endColorstr='#ffffff',GradientType=0);\n      background-color: #f6f6f6;\n    }\n  }\n`;\n\ninterface ConfirmationDialogProps {\n  style?: CSSProperties;\n  buttons: Array<{ handler: () => void; text: string; style?: CSSProperties }>;\n  onClose: () => void;\n  message: string;\n}\n\nfunction ConfirmationDialog({\n  style = {},\n  buttons = [],\n  onClose,\n  message,\n}: ConfirmationDialogProps) {\n  const optionsHandler = useCallback(\n    (e, { handler = () => null }) => {\n      handler(e);\n      onClose();\n    },\n    [onClose],\n  );\n\n  return (\n    <div style={style} css={styles}>\n      <p className=\"message\">{message}</p>\n      <div className=\"buttons-container\">\n        {buttons.map((option) => (\n          <button\n            key={option.text}\n            type=\"button\"\n            onClick={(e) => optionsHandler(e, option)}\n            style={option.style && option.style}\n          >\n            {option.text}\n          </button>\n        ))}\n      </div>\n    </div>\n  );\n}\n\nexport default ConfirmationDialog;\n","import { useRef, useEffect, cloneElement } from 'react';\nimport { useSize } from 'react-use';\n\nconst ModalContent = ({ modal, onClose, onLayout }) => {\n  const contentSize = useRef<any>();\n\n  const [Content, { width, height }] = useSize(() => {\n    return (\n      <div\n        style={{\n          height: '100%',\n          display: 'block',\n          overflow: 'auto',\n        }}\n      >\n        {cloneElement(modal.component, {\n          ...modal.options,\n          onClose: onClose,\n          style: { cursor: 'default' },\n        })}\n      </div>\n    );\n  });\n\n  useEffect(() => {\n    if (isFinite(height) && isFinite(width) && !contentSize.current) {\n      contentSize.current = { width, height };\n      onLayout({ modal, layout: { width, height } });\n    }\n  }, [width, height, contentSize, onLayout, modal]);\n\n  return Content;\n};\n\nexport default ModalContent;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport {\n  useRef,\n  useState,\n  useEffect,\n  useCallback,\n  Fragment,\n  useMemo,\n  CSSProperties,\n  ReactNode,\n} from 'react';\nimport { createPortal } from 'react-dom';\nimport { Rnd } from 'react-rnd';\nimport { TransitionGroup } from 'react-transition-group';\n\nimport Transition from '../Transition';\nimport Wrapper from '../Wrapper';\nimport { positions, transitions } from '../options';\n\nimport ConfirmDialog from './ConfirmDialog';\nimport { ModalProvider } from './Context';\nimport ModalContent from './ModalContent';\n\nconst transitionStyles: any = {\n  [transitions.FADE]: {\n    entering: { opacity: 0 },\n    entered: { opacity: 1 },\n  },\n  [transitions.SCALE]: {\n    entering: { transform: 'scale(0)' },\n    entered: { transform: 'scale(1)' },\n    exiting: { transform: 'scale(0)' },\n    exited: { transform: 'scale(0)' },\n  },\n};\n\ninterface ProviderProps {\n  children: ReactNode;\n  style?: CSSProperties;\n  offset?: string;\n  position?: any;\n  transition?: any;\n  wrapperRef?: any;\n}\n\nfunction Provider({\n  children,\n  style = undefined,\n  offset = '0px',\n  position = positions.MIDDLE,\n  transition = transitions.SCALE,\n  wrapperRef = null,\n}: ProviderProps) {\n  const root = useRef<any>();\n  const modalRef = useRef<any>();\n  const [modal, setModal] = useState<any>();\n\n  useEffect(() => {\n    root.current = document.createElement('div');\n    const ref = root.current;\n    if (wrapperRef) {\n      wrapperRef.appendChild(ref);\n    }\n    return () => {\n      if (ref) {\n        if (wrapperRef) {\n          wrapperRef.removeChild(ref);\n        }\n      }\n    };\n  }, [wrapperRef]);\n\n  const close = useCallback(\n    function close() {\n      setModal(null);\n    },\n    [setModal],\n  );\n\n  const parentStyle = useMemo(() => {\n    return wrapperRef\n      ? wrapperRef.getBoundingClientRect()\n      : {\n          top: 0,\n          left: 0,\n          width: window.innerWidth,\n          height: window.innerHeight,\n        };\n  }, [wrapperRef]);\n\n  /**\n   *\n   * @param {*} component  <component />\n   * @param {object} options    {onYest:()=>{}, prop1, .... etc}\n   * @param {transitions} options.transition\n   * @param {positions} options.position\n   * @param {boolean} options.isBackgroundBlur\n   * @param {boolean} options.enableResizing\n   */\n  const show = useCallback(\n    (component, options = {}) => {\n      const _modal: any = {\n        component,\n        options: { isBackgroundBlur: true, enableResizing: false, ...options },\n      };\n\n      _modal.close = close;\n\n      setModal(_modal);\n      if (_modal.options.onOpen) _modal.options.onOpen();\n      return _modal;\n    },\n    [close],\n  );\n\n  /**\n   * @param {object} dialogOptions\n   * @param {object} dialogOptions.message\n   * @param {Array<{ handler: Function,text: string,style: object}>} dialogOptions.buttons\n   * @param {object} dialogOptions.tyle\n   */\n  const showConfirmDialog = useCallback(\n    (dialogOptions, options = { enableResizing: false }) => {\n      const _modal: any = {\n        component: <ConfirmDialog {...dialogOptions} />,\n        options: { isBackgroundBlur: true, ...options },\n      };\n\n      _modal.close = close;\n\n      setModal(_modal);\n      if (_modal.options.onOpen) _modal.options.onOpen();\n\n      return _modal;\n    },\n    [close],\n  );\n\n  useEffect(() => {\n    function keyHandler(e) {\n      if (['Escape', 'Esc'].includes(e.key)) {\n        close();\n      }\n    }\n    document.addEventListener('keydown', keyHandler, false);\n    return () => document.removeEventListener('keydown', keyHandler, false);\n  }, [close]);\n\n  const styles = css`\n    position: absolute;\n    left: 0;\n    top: 0;\n    bottom: 0;\n    right: 0;\n    z-index: 0;\n    pointer-events: all;\n    .handle {\n      cursor: move;\n    }\n\n    .rnd-container {\n      box-sizing: initial;\n      background-color: #fff;\n      box-shadow: 0 0 0 0, 0 8px 16px rgba(0, 0, 0, 0.3);\n      border-radius: 5px;\n    }\n  `;\n\n  const outerStyle: CSSProperties = modal?.options.isBackgroundBlur\n    ? { backgroundColor: 'rgba(255,255,255,0.8)' }\n    : { pointerEvents: 'none' };\n\n  const modalContextValue = useMemo(\n    () => ({ show, close, showConfirmDialog }),\n    [show, close, showConfirmDialog],\n  );\n\n  const contentLayoutHandler = useCallback(\n    ({ modal, layout }) => {\n      const width = modal.options.width\n        ? modal.options.width\n        : layout.width > parentStyle.width\n        ? parentStyle.width\n        : layout.width;\n      const height = modal.options.height\n        ? modal.options.height\n        : layout.height > parentStyle.height\n        ? parentStyle.height\n        : layout.height;\n\n      modalRef.current.updateSize({ width, height });\n    },\n    [parentStyle.height, parentStyle.width],\n  );\n\n  return (\n    <ModalProvider value={modalContextValue}>\n      {children}\n      {root.current &&\n        createPortal(\n          <Fragment>\n            {modal ? (\n              <div\n                css={styles}\n                style={{\n                  ...outerStyle,\n                }}\n              >\n                <TransitionGroup\n                  appear\n                  key={\n                    positions[\n                      modal.options.transition\n                        ? modal.options.transition\n                        : transition\n                    ]\n                  }\n                  options={{\n                    position: modal.options.position\n                      ? modal.options.position\n                      : position,\n                  }}\n                  containerStyle={parentStyle}\n                  component={Wrapper}\n                >\n                  <Transition\n                    type={\n                      modal.options.transition\n                        ? modal.options.transition\n                        : transition\n                    }\n                    transitionStyles={{\n                      ...transitionStyles,\n                      default: {\n                        width: modal.options.width\n                          ? `${modal.options.width}px`\n                          : 'auto',\n                      },\n                      height: modal.options.height\n                        ? `${modal.options.height}px`\n                        : 'auto',\n                    }}\n                    key={modal.id}\n                  >\n                    <Rnd\n                      maxWidth={parentStyle.width}\n                      maxHeight={parentStyle.height}\n                      ref={modalRef}\n                      default={{\n                        width: modal.options.width\n                          ? modal.options.width\n                          : 'auto',\n                        height: modal.options.height\n                          ? modal.options.height\n                          : 'auto',\n                        x: 0,\n                        y: 0,\n                      }}\n                      className=\"rnd-container\"\n                      style={{\n                        ...style,\n                        margin: offset,\n                        position: 'static',\n                        pointerEvents: 'all',\n                        userSelect: 'none',\n                      }}\n                      enableResizing={modal.options.enableResizing}\n                      dragHandleClassName=\"handle\"\n                      enableUserSelectHack={false}\n                    >\n                      <ModalContent\n                        modal={modal}\n                        onClose={close}\n                        onLayout={contentLayoutHandler}\n                      />\n                    </Rnd>\n                  </Transition>\n                </TransitionGroup>\n              </div>\n            ) : null}\n          </Fragment>,\n          root.current,\n        )}\n    </ModalProvider>\n  );\n}\n\nexport default Provider;\n","import { createContext, useContext } from 'react';\n\nexport const GlobalConetxt = createContext<{\n  rootRef: HTMLDivElement | null;\n  elementsWrapperRef: HTMLDivElement | null;\n}>({ rootRef: null, elementsWrapperRef: null });\n\nexport const GlobalProvider = GlobalConetxt.Provider;\n\nexport function useGlobal() {\n  return useContext(GlobalConetxt);\n}\n","import {\n  useRef,\n  useLayoutEffect,\n  useCallback,\n  useState,\n  memo,\n  Fragment,\n  CSSProperties,\n  ReactNode,\n} from 'react';\nimport { createPortal } from 'react-dom';\n\nimport { useGlobal } from '../../context/GlobalContext';\n\nconst styles: Record<'popup', CSSProperties> = {\n  popup: {\n    position: 'fixed',\n    top: 0,\n    left: 0,\n    pointerEvents: 'none',\n    backgroundColor: 'gray',\n    padding: '3px',\n    borderRadius: '2px',\n    color: 'white',\n    whiteSpace: 'nowrap',\n    fontSize: '10px',\n    fontFamily: 'tahoma',\n    textShadow: 'none',\n  },\n};\n\ninterface ToolTipProps {\n  style?: any;\n  className?: string;\n  popupPlacement: string;\n  children: ReactNode;\n  title: string;\n  offset?: { x: number; y: number };\n}\n\nfunction ToolTip({\n  style = { popup: {}, mainContainer: {} },\n  className = '',\n  popupPlacement = 'right',\n  children,\n  title,\n  offset = { x: 0, y: 0 },\n}: ToolTipProps) {\n  const refChild = useRef<HTMLDivElement>(null);\n  const refContent = useRef<HTMLDivElement>(null);\n\n  const [placement, setPlacement] = useState({ x: 0, y: 0 });\n  const [show, showToolTip] = useState(false);\n  const { elementsWrapperRef } = useGlobal();\n\n  useLayoutEffect(() => {\n    const getPopupPlacement = () => {\n      let x: number;\n      let y: number;\n\n      if (refChild.current === null || refContent.current === null) {\n        return null;\n      }\n\n      const childBounding = refChild.current.getBoundingClientRect();\n      const contentBounding = refContent.current.getBoundingClientRect();\n\n      switch (popupPlacement) {\n        case 'left':\n          x = -contentBounding.width;\n          y =\n            childBounding.height / 2 -\n            ((childBounding.height / 2) * contentBounding.height) /\n              childBounding.height;\n          break;\n        case 'right':\n          x = childBounding.width;\n          y =\n            childBounding.height / 2 -\n            ((childBounding.height / 2) * contentBounding.height) /\n              childBounding.height;\n          break;\n        case 'top':\n          x =\n            childBounding.width / 2 -\n            ((childBounding.width / 2) * contentBounding.width) /\n              childBounding.width;\n          y = -childBounding.height;\n          break;\n        case 'bottom':\n          x =\n            childBounding.width / 2 -\n            ((childBounding.width / 2) * contentBounding.width) /\n              childBounding.width;\n          y = childBounding.height;\n          break;\n        default:\n          x = 0;\n          y = 0;\n          break;\n      }\n      return { x: x + childBounding.x, y: y + childBounding.y };\n    };\n\n    if (show) {\n      const pl = getPopupPlacement();\n\n      if (pl) {\n        setPlacement(pl);\n      }\n    }\n  }, [popupPlacement, show]);\n\n  const mouseOverHandler = useCallback(() => {\n    showToolTip(true);\n  }, []);\n\n  const mouseLeaveHandler = useCallback(() => {\n    showToolTip(false);\n  }, []);\n\n  return (\n    <Fragment>\n      <div\n        style={{\n          position: 'relative',\n          height: '100%',\n          display: 'flex',\n          justifyContent: 'center',\n          alignItems: 'center',\n          ...style.mainContainer,\n        }}\n        ref={refChild}\n        onMouseOver={mouseOverHandler}\n        onMouseOut={mouseLeaveHandler}\n      >\n        {children}\n      </div>\n      {show &&\n        elementsWrapperRef &&\n        createPortal(\n          <div\n            ref={refContent}\n            style={{\n              ...styles.popup,\n              transform: `translate(${placement.x + offset.x}px,${\n                placement.y + offset.y\n              }px)`,\n              zIndex: 999999999,\n              ...style.popup,\n            }}\n            className={className}\n          >\n            <span style={{ pointerEvents: 'none' }}>{title}</span>\n          </div>,\n          elementsWrapperRef,\n        )}\n    </Fragment>\n  );\n}\n\nexport default memo(ToolTip);\n","import { CSSProperties, memo } from 'react';\nimport { FaTimes } from 'react-icons/fa';\n\nimport ToolTip from './ToolTip/ToolTip';\n\nconst styles: Record<'button' | 'svg', CSSProperties> = {\n  button: {\n    backgroundColor: 'transparent',\n    border: 'none',\n    height: '100%',\n    display: 'flex',\n    justifyContent: 'center',\n    alignItems: 'center',\n  },\n  svg: {\n    fill: '#ca0000',\n    fontSize: '16px',\n  },\n};\n\ninterface CloseButtonProps {\n  onClick?: () => void;\n  popupTitle?: string;\n  popupPlacement?: string;\n  className?: string;\n}\n\nfunction CloseButton(props: CloseButtonProps) {\n  const {\n    onClick = () => null,\n    popupTitle = 'Close',\n    popupPlacement = 'left',\n    className = '',\n  } = props;\n  return (\n    <div className={className}>\n      <ToolTip title={popupTitle} popupPlacement={popupPlacement}>\n        <button style={styles.button} type=\"button\" onClick={onClick}>\n          <FaTimes style={styles.svg} />\n        </button>\n      </ToolTip>\n    </div>\n  );\n}\n\nexport default memo(CloseButton);\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { xGetFromToIndex, xyToXYObject } from 'ml-spectra-processing';\nimport { analyseMultiplet } from 'multiplet-analysis';\nimport { useState, useEffect } from 'react';\nimport { Plot, LineSeries, Axis } from 'react-plot';\n\nimport { isSpectrum2D } from '../../data/data2d/Spectrum2D';\nimport { Spectra } from '../NMRium';\nimport CloseButton from '../elements/CloseButton';\nimport { ActiveSpectrum } from '../reducer/Reducer';\n\nconst styles = css`\n  display: flex;\n  flex-direction: column;\n  width: 900px;\n  height: 400px;\n  padding: 5px;\n  button:focus {\n    outline: none;\n  }\n  .header {\n    height: 24px;\n    border-bottom: 1px solid #f0f0f0;\n    display: flex;\n    span {\n      color: #464646;\n      font-size: 15px;\n      flex: 1;\n    }\n\n    button {\n      background-color: transparent;\n      border: none;\n      svg {\n        height: 16px;\n      }\n    }\n  }\n  .container {\n    overflow-y: auto;\n    background-color: white;\n    padding-top: 10px;\n\n    .row {\n      outline: none;\n      display: flex !important;\n      flex-direction: row;\n      margin: 0;\n      div {\n        flex: 4;\n      }\n      .multiplicity {\n        flex: 2;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n      }\n    }\n\n    .row:nth-child(odd) {\n      background: #fafafa;\n    }\n  }\n`;\n\nconst loaderStyles = css`\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  flex-direction: column;\n  user-select: none;\n  width: 900px;\n  height: 400px;\n\n  svg {\n    animation-duration: 0.5s;\n    animation-name: spinAnimation;\n    animation-iteration-count: infinite;\n    animation-fill-mode: forwards;\n    animation-direction: inherit;\n    animation-timing-function: linear;\n    animation-duration: 1s;\n    width: 100px;\n    height: 100px;\n  }\n\n  @keyframes spinAnimation {\n    from {\n      transform: rotate(0deg);\n    }\n\n    to {\n      transform: rotate(360deg);\n    }\n  }\n`;\n\ninterface MultipletAnalysisModalProps {\n  data: Spectra;\n  activeSpectrum: ActiveSpectrum;\n  scaleX: any;\n  startX: any;\n  endX: any;\n  onClose: (element?: string) => void;\n}\n\nexport default function MultipletAnalysisModal({\n  data,\n  activeSpectrum,\n  scaleX,\n  startX,\n  endX,\n  onClose,\n}: MultipletAnalysisModalProps) {\n  const [analysisData, setAnalysisData] = useState<any>();\n  const [calcStart, setCalcStartStatus] = useState(false);\n  const [isCalcFinished, setCalcFinished] = useState(false);\n\n  useEffect(() => {\n    setTimeout(() => {\n      setCalcStartStatus(true);\n    }, 400);\n  }, []);\n\n  useEffect(() => {\n    if (activeSpectrum && startX && endX && calcStart) {\n      const spectrum = data[activeSpectrum.index];\n      if (isSpectrum2D(spectrum)) {\n        throw new Error('unreachable');\n      }\n\n      const {\n        data: { x, re },\n        info,\n      } = spectrum;\n\n      const from = scaleX().invert(startX);\n      const to = scaleX().invert(endX);\n\n      const { fromIndex, toIndex } = xGetFromToIndex(x, {\n        from,\n        to,\n      });\n      const analysesProps = {\n        x: x.slice(fromIndex, toIndex),\n        y: re.slice(fromIndex, toIndex),\n      };\n      try {\n        const result = analyseMultiplet(analysesProps, {\n          frequency: info.originFrequency,\n          takeBestPartMultiplet: true,\n          symmetrizeEachStep: true,\n          debug: true,\n        });\n        setCalcFinished(true);\n        setAnalysisData(result);\n      } catch (err) {\n        // eslint-disable-next-line no-console\n        console.log(err);\n      }\n    }\n  }, [startX, endX, data, scaleX, activeSpectrum, calcStart]);\n\n  if (!isCalcFinished) {\n    return (\n      <div css={loaderStyles}>\n        <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 841.9 595.3\">\n          <g fill=\"#61DAFB\">\n            <path d=\"M666.3 296.5c0-32.5-40.7-63.3-103.1-82.4 14.4-63.6 8-114.2-20.2-130.4-6.5-3.8-14.1-5.6-22.4-5.6v22.3c4.6 0 8.3.9 11.4 2.6 13.6 7.8 19.5 37.5 14.9 75.7-1.1 9.4-2.9 19.3-5.1 29.4-19.6-4.8-41-8.5-63.5-10.9-13.5-18.5-27.5-35.3-41.6-50 32.6-30.3 63.2-46.9 84-46.9V78c-27.5 0-63.5 19.6-99.9 53.6-36.4-33.8-72.4-53.2-99.9-53.2v22.3c20.7 0 51.4 16.5 84 46.6-14 14.7-28 31.4-41.3 49.9-22.6 2.4-44 6.1-63.6 11-2.3-10-4-19.7-5.2-29-4.7-38.2 1.1-67.9 14.6-75.8 3-1.8 6.9-2.6 11.5-2.6V78.5c-8.4 0-16 1.8-22.6 5.6-28.1 16.2-34.4 66.7-19.9 130.1-62.2 19.2-102.7 49.9-102.7 82.3 0 32.5 40.7 63.3 103.1 82.4-14.4 63.6-8 114.2 20.2 130.4 6.5 3.8 14.1 5.6 22.5 5.6 27.5 0 63.5-19.6 99.9-53.6 36.4 33.8 72.4 53.2 99.9 53.2 8.4 0 16-1.8 22.6-5.6 28.1-16.2 34.4-66.7 19.9-130.1 62-19.1 102.5-49.9 102.5-82.3zm-130.2-66.7c-3.7 12.9-8.3 26.2-13.5 39.5-4.1-8-8.4-16-13.1-24-4.6-8-9.5-15.8-14.4-23.4 14.2 2.1 27.9 4.7 41 7.9zm-45.8 106.5c-7.8 13.5-15.8 26.3-24.1 38.2-14.9 1.3-30 2-45.2 2-15.1 0-30.2-.7-45-1.9-8.3-11.9-16.4-24.6-24.2-38-7.6-13.1-14.5-26.4-20.8-39.8 6.2-13.4 13.2-26.8 20.7-39.9 7.8-13.5 15.8-26.3 24.1-38.2 14.9-1.3 30-2 45.2-2 15.1 0 30.2.7 45 1.9 8.3 11.9 16.4 24.6 24.2 38 7.6 13.1 14.5 26.4 20.8 39.8-6.3 13.4-13.2 26.8-20.7 39.9zm32.3-13c5.4 13.4 10 26.8 13.8 39.8-13.1 3.2-26.9 5.9-41.2 8 4.9-7.7 9.8-15.6 14.4-23.7 4.6-8 8.9-16.1 13-24.1zM421.2 430c-9.3-9.6-18.6-20.3-27.8-32 9 .4 18.2.7 27.5.7 9.4 0 18.7-.2 27.8-.7-9 11.7-18.3 22.4-27.5 32zm-74.4-58.9c-14.2-2.1-27.9-4.7-41-7.9 3.7-12.9 8.3-26.2 13.5-39.5 4.1 8 8.4 16 13.1 24 4.7 8 9.5 15.8 14.4 23.4zM420.7 163c9.3 9.6 18.6 20.3 27.8 32-9-.4-18.2-.7-27.5-.7-9.4 0-18.7.2-27.8.7 9-11.7 18.3-22.4 27.5-32zm-74 58.9c-4.9 7.7-9.8 15.6-14.4 23.7-4.6 8-8.9 16-13 24-5.4-13.4-10-26.8-13.8-39.8 13.1-3.1 26.9-5.8 41.2-7.9zm-90.5 125.2c-35.4-15.1-58.3-34.9-58.3-50.6 0-15.7 22.9-35.6 58.3-50.6 8.6-3.7 18-7 27.7-10.1 5.7 19.6 13.2 40 22.5 60.9-9.2 20.8-16.6 41.1-22.2 60.6-9.9-3.1-19.3-6.5-28-10.2zM310 490c-13.6-7.8-19.5-37.5-14.9-75.7 1.1-9.4 2.9-19.3 5.1-29.4 19.6 4.8 41 8.5 63.5 10.9 13.5 18.5 27.5 35.3 41.6 50-32.6 30.3-63.2 46.9-84 46.9-4.5-.1-8.3-1-11.3-2.7zm237.2-76.2c4.7 38.2-1.1 67.9-14.6 75.8-3 1.8-6.9 2.6-11.5 2.6-20.7 0-51.4-16.5-84-46.6 14-14.7 28-31.4 41.3-49.9 22.6-2.4 44-6.1 63.6-11 2.3 10.1 4.1 19.8 5.2 29.1zm38.5-66.7c-8.6 3.7-18 7-27.7 10.1-5.7-19.6-13.2-40-22.5-60.9 9.2-20.8 16.6-41.1 22.2-60.6 9.9 3.1 19.3 6.5 28.1 10.2 35.4 15.1 58.3 34.9 58.3 50.6-.1 15.7-23 35.6-58.4 50.6zM320.8 78.4z\" />\n            <path d=\"M520.5 78.1z\" />\n          </g>\n        </svg>\n        <p>Analyse Multiplet in progress. Please wait ...</p>\n      </div>\n    );\n  }\n\n  return (\n    <div css={styles}>\n      <div className=\"header handle\">\n        <span>Analyse Multiplet</span>\n\n        <CloseButton onClick={onClose} />\n      </div>\n      <div className=\"container\">\n        {analysisData?.debug?.steps.map((d, index) => {\n          return (\n            // eslint-disable-next-line react/no-array-index-key\n            <div key={index} className=\"row\">\n              <Plot\n                width={400}\n                height={200}\n                svgStyle={{ overflow: 'visible' }}\n                seriesViewportStyle={{ stroke: 'black' }}\n              >\n                <LineSeries data={xyToXYObject(d.multiplet)} />\n                <Axis\n                  id=\"y\"\n                  position=\"left\"\n                  tickPosition=\"inner\"\n                  displayPrimaryGridLines\n                  hiddenTicks\n                  paddingStart={0.1}\n                  paddingEnd={0.1}\n                />\n                <Axis\n                  id=\"x\"\n                  position=\"bottom\"\n                  tickPosition=\"inner\"\n                  displayPrimaryGridLines\n                />\n              </Plot>\n              <div className=\"multiplicity\">\n                <p>\n                  {analysisData.js[index]\n                    ? `${\n                        analysisData.js[index]?.multiplicity\n                      }: ${analysisData.js[index]?.coupling.toFixed(3)} Hz`\n                    : ''}\n                </p>\n              </div>\n              <Plot\n                width={400}\n                height={200}\n                seriesViewportStyle={{ stroke: 'black' }}\n              >\n                <LineSeries\n                  data={xyToXYObject(d.errorFunction)}\n                  lineStyle={{ strokeWidth: 1 }}\n                />\n                <Axis\n                  id=\"y\"\n                  position=\"left\"\n                  tickPosition=\"inner\"\n                  displayPrimaryGridLines\n                  hiddenTicks\n                  paddingStart={0.1}\n                  paddingEnd={0.1}\n                />\n                <Axis\n                  id=\"x\"\n                  position=\"bottom\"\n                  tickPosition=\"inner\"\n                  displayPrimaryGridLines\n                />\n              </Plot>\n            </div>\n          );\n        })}\n      </div>\n    </div>\n  );\n}\n","import { useMemo } from 'react';\n\nimport { Datum1D } from '../../data/types/data1d';\nimport { Datum2D } from '../../data/types/data2d';\nimport { useChartData } from '../context/ChartContext';\nimport nucleusToString from '../utility/nucleusToString';\n\nexport default function useSpectraByActiveNucleus() {\n  const { data, activeTab } = useChartData();\n\n  return useMemo<Array<Datum1D | Datum2D>>(() => {\n    if (data) {\n      return (\n        data.filter(\n          (spectrum) => activeTab === nucleusToString(spectrum.info.nucleus),\n        ) || []\n      );\n    }\n    return [];\n  }, [activeTab, data]);\n}\n","import get from 'lodash/get';\nimport { useMemo } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\nimport { usePreferences } from '../context/PreferencesContext';\n\ninterface ActiveSpectrumOptionsResult {\n  isActive: boolean;\n  opacity: number;\n}\n\nexport default function useActiveSpectrumStyleOptions(\n  id: string,\n): ActiveSpectrumOptionsResult {\n  const { activeSpectrum } = useChartData();\n  const preferences = usePreferences();\n\n  return useMemo(() => {\n    const isActive =\n      activeSpectrum === null ? true : id === activeSpectrum.id ? true : false;\n    const opacity = isActive\n      ? 1\n      : get(preferences.current, 'controllers.dimmedSpectraTransparency', 0.1);\n    return { isActive, opacity };\n  }, [activeSpectrum, id, preferences]);\n}\n","import { memo } from 'react';\n\nimport { ExclusionZone } from '../../data/types/data1d/ExclusionZone';\nimport { useScaleChecked } from '../context/ScaleContext';\nimport { HighlightedSource, useHighlight } from '../highlight';\nimport useActiveSpectrumStyleOptions from '../hooks/useActiveSpectrumStyleOptions';\n\ninterface ExclusionZoneProps {\n  zone: ExclusionZone;\n  color: string;\n  vAlign: number;\n  spectrumID: string;\n}\n\nfunction ExclusionZoneAnnotation({\n  zone,\n  color,\n  vAlign,\n  spectrumID,\n}: ExclusionZoneProps) {\n  const { scaleX, scaleY } = useScaleChecked();\n  const highlight = useHighlight([zone.id], {\n    type: HighlightedSource.EXCLUSION_ZONE,\n    extra: { id: zone.id, spectrumID },\n  });\n\n  const { opacity } = useActiveSpectrumStyleOptions(spectrumID);\n\n  return (\n    <g key={zone.id} transform={`translate(${scaleX()(zone.to)},0)`}>\n      <rect\n        x=\"0\"\n        transform={`translate(0,${scaleY()(0) - (vAlign + 5)})`}\n        width={`${scaleX()(zone.from) - scaleX()(zone.to)}`}\n        height=\"10px\"\n        style={{\n          fill: highlight.isActive ? '#ff6f0057' : color,\n          opacity,\n        }}\n        {...highlight.onHover}\n      />\n    </g>\n  );\n}\n\nexport default memo(ExclusionZoneAnnotation);\n","import { VerticalAlign, VerticalAlignment } from '../../reducer/Reducer';\n\nexport default function getVerticalShift(\n  verticalAlign: VerticalAlign,\n  option: { index?: number; align?: VerticalAlignment },\n) {\n  const { index = 1, align = 'stack' } = option || {\n    index: 1,\n    align: 'stack',\n  };\n\n  return verticalAlign.align === align\n    ? index * verticalAlign.verticalShift\n    : 0;\n}\n","import { memo } from 'react';\n\nimport * as Filters from '../../data/Filters';\nimport { Datum1D } from '../../data/types/data1d';\nimport { ExclusionZone } from '../../data/types/data1d/ExclusionZone';\nimport { useChartData } from '../context/ChartContext';\nimport useSpectraByActiveNucleus from '../hooks/useSpectraPerNucleus';\nimport { VerticalAlign } from '../reducer/Reducer';\nimport { DISPLAYER_MODE } from '../reducer/core/Constants';\n\nimport ExclusionZoneAnnotation from './ExclusionZoneAnnotation';\nimport getVerticalShift from './utilities/getVerticalShift';\n\ninterface ExclusionZonesAnnotationsInnerProps {\n  displayerKey: string;\n  spectra: Datum1D[];\n  xDomains: any;\n  verticalAlign: VerticalAlign;\n}\n\nfunction ExclusionZonesAnnotationsInner({\n  displayerKey,\n  xDomains,\n  spectra,\n  verticalAlign,\n}: ExclusionZonesAnnotationsInnerProps) {\n  return (\n    <g\n      className=\"spectrum-exclusion-zones-group\"\n      clipPath={`url(#${displayerKey}clip-chart-1d)`}\n    >\n      {spectra\n        .filter((d) => d.display.isVisible === true && xDomains[d.id])\n        .map((d, index) =>\n          getExclusionZones(d).map((zone) => {\n            return (\n              <ExclusionZoneAnnotation\n                key={zone.id}\n                spectrumID={d.id}\n                vAlign={getVerticalShift(verticalAlign, { index })}\n                zone={zone}\n                color={d.display.color}\n              />\n            );\n          }),\n        )}\n    </g>\n  );\n}\n\nconst MemoizedPeakAnnotations = memo(ExclusionZonesAnnotationsInner);\n\nfunction ExclusionZonesAnnotations() {\n  const { displayerKey, xDomains, displayerMode, verticalAlign } =\n    useChartData();\n\n  const spectra = useSpectraByActiveNucleus() as Datum1D[];\n\n  if (displayerMode !== DISPLAYER_MODE.DM_1D) return null;\n\n  return (\n    <MemoizedPeakAnnotations\n      spectra={spectra}\n      displayerKey={displayerKey}\n      xDomains={xDomains}\n      verticalAlign={verticalAlign}\n    />\n  );\n}\n\nexport default ExclusionZonesAnnotations;\n\nfunction getExclusionZones(data: Datum1D): ExclusionZone[] {\n  return (\n    data.filters.find(\n      (filter) => filter.name === Filters.exclusionZones.id && filter.flag,\n    )?.value || []\n  );\n}\n","import { ScaleLinear } from 'd3';\nimport { useMemo } from 'react';\n\nimport { getXScale } from '../1d/utilities/scale';\nimport { useChartData } from '../context/ChartContext';\n\nexport function useXScale(): ScaleLinear<any, any, never> {\n  const { width, margin, xDomains, xDomain, mode } = useChartData();\n\n  return useMemo(\n    () => getXScale({ width, margin, xDomains, xDomain, mode }),\n    [margin, mode, width, xDomain, xDomains],\n  );\n}\n","import { ScaleLinear } from 'd3';\nimport { xyIntegral, xyReduce } from 'ml-spectra-processing';\nimport { useMemo } from 'react';\n\nimport { Data1D } from '../../data/types/data1d';\nimport { getIntegralYScale } from '../1d/utilities/scale';\nimport { useChartData } from '../context/ChartContext';\nimport { PathBuilder } from '../utility/PathBuilder';\n\nimport { useXScale } from './useXScale';\n\nfunction useIntegralYDomain(): ScaleLinear<number, number, number> {\n  const { height, margin, verticalAlign, activeSpectrum, integralsYDomains } =\n    useChartData();\n\n  return useMemo(\n    () =>\n      getIntegralYScale({\n        height,\n        margin,\n        verticalAlign,\n        activeSpectrum,\n        integralsYDomains,\n      }),\n    [activeSpectrum, height, integralsYDomains, margin, verticalAlign],\n  );\n}\n\nexport default function useIntegralPath(integralOptions: {\n  from: number;\n  to: number;\n}) {\n  const { data, activeSpectrum } = useChartData();\n\n  const scaleX = useXScale();\n  const scaleY = useIntegralYDomain();\n  const integral = useMemo(() => {\n    if (activeSpectrum) {\n      const { x, re } = data[activeSpectrum?.index].data as Data1D;\n      const { from, to } = integralOptions;\n      return xyIntegral(\n        { x, y: re },\n        {\n          from,\n          to,\n          reverse: true,\n        },\n      );\n    }\n    return { x: [], y: [] };\n  }, [activeSpectrum, data, integralOptions]);\n\n  const paths = useMemo(() => {\n    if (integral) {\n      const xySeries = xyReduce(integral, {\n        // from: xDomain[0],\n        // to: xDomain[1],\n        nbPoints: 200,\n        optimize: true,\n      });\n\n      const pathBuilder = new PathBuilder();\n      pathBuilder.moveTo(scaleX(xySeries.x[0]), scaleY(xySeries.y[0]));\n      for (let i = 1; i < xySeries.x.length; i++) {\n        pathBuilder.lineTo(scaleX(xySeries.x[i]), scaleY(xySeries.y[i]));\n      }\n\n      return pathBuilder.toString();\n    } else {\n      return '';\n    }\n  }, [integral, scaleX, scaleY]);\n\n  return paths;\n}\n","const integralDefaultValues = {\n  showAbsolute: false,\n  absoluteFormat: '0.00',\n  showRelative: true,\n  relativeFormat: '0.00',\n  color: '#000000',\n  strokeWidth: 1,\n};\n\nconst zoneDefaultValues = {\n  showFrom: false,\n  fromFormat: '0.00',\n  showTo: false,\n  toFormat: '0.00',\n  showAbsolute: false,\n  absoluteFormat: '0.00',\n  showRelative: true,\n  relativeFormat: '0.00',\n};\n\nconst getRangeDefaultValues = (nucleus?: string) => ({\n  showFrom: false,\n  fromFormat: '0.00',\n  showTo: false,\n  toFormat: '0.00',\n  showAbsolute: false,\n  absoluteFormat: '0.00',\n  showRelative: true,\n  relativeFormat: '0.00',\n  jGraphTolerance: nucleus === '1H' ? 0.2 : nucleus === '13C' ? 2 : 0, //J Graph tolerance for: 1H: 0.2Hz 13C: 2Hz\n});\n\nconst peaksDefaultValues = {\n  showPeakNumber: true,\n  peakNumberFormat: '0',\n  showPeakIndex: false,\n  peakIndexFormat: '0.00',\n  showDeltaPPM: true,\n  deltaPPMFormat: '0.00',\n  showDeltaHz: false,\n  deltaHzFormat: '0.00',\n  showPeakWidth: false,\n  peakWidthFormat: '00.0000',\n  showIntensity: true,\n  intensityFormat: '0.00',\n};\n\nconst databaseDefaultValues = {\n  showSmiles: true,\n  showSolvent: false,\n  showNames: true,\n  showRange: false,\n  showDelta: true,\n  showAssignment: false,\n  showCoupling: true,\n  showMultiplicity: true,\n};\n\nexport {\n  peaksDefaultValues,\n  integralDefaultValues,\n  getRangeDefaultValues,\n  zoneDefaultValues,\n  databaseDefaultValues,\n};\n","import { useCallback, useEffect, useRef, useState } from 'react';\n\ninterface UseDraggable {\n  x: number;\n  anchor: Anchor;\n}\nexport interface Draggable {\n  onMouseDown: (\n    event: React.MouseEvent<HTMLDivElement | SVGElement, MouseEvent>,\n  ) => void;\n  position: { x: number; action: Action };\n  previousPosition: number;\n  isActive: boolean;\n  anchor: Anchor;\n}\ntype Action = 'start' | 'move' | 'end' | null;\n\nexport type Anchor = 'RIGHT' | 'LEFT';\n\nexport default function useDraggable(props: UseDraggable): Draggable {\n  const { x, anchor } = props;\n  const isActive = useRef<boolean>(false);\n  const positionRef = useRef<{ relativeX: number; x: number }>({\n    relativeX: x,\n    x,\n  });\n  const [position, setPosition] = useState<{ x: number; action: Action }>({\n    x,\n    action: null,\n  });\n\n  useEffect(() => {\n    positionRef.current = { relativeX: x, x };\n    setPosition({ x, action: null });\n  }, [x]);\n\n  const onMouseDown = useCallback(\n    (e: React.MouseEvent<HTMLDivElement | SVGElement, MouseEvent>) => {\n      setPosition({ x: positionRef.current.x, action: 'start' });\n\n      positionRef.current.relativeX = e.clientX - positionRef.current.relativeX;\n      isActive.current = true;\n      e.stopPropagation();\n      function onMouseUp(e: MouseEvent) {\n        e.stopPropagation();\n\n        if (isActive.current) {\n          const x = e.clientX - positionRef.current.relativeX;\n          positionRef.current = { relativeX: x, x };\n          setPosition({ x, action: 'end' });\n          isActive.current = false;\n        }\n\n        window.removeEventListener('mousemove', onMouseMove);\n        window.removeEventListener('mouseup', onMouseUp);\n      }\n      function onMouseMove(e: MouseEvent) {\n        e.stopPropagation();\n\n        if (isActive.current) {\n          setPosition({\n            x: e.clientX - positionRef.current.relativeX,\n            action: 'move',\n          });\n        }\n      }\n\n      window.addEventListener('mousemove', onMouseMove);\n      window.addEventListener('mouseup', onMouseUp);\n    },\n    [],\n  );\n\n  return {\n    onMouseDown,\n    position,\n    previousPosition: positionRef.current.x,\n    isActive: isActive.current,\n    anchor,\n  };\n}\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { CSSProperties, useEffect } from 'react';\n\nimport { Position, ResizerProps } from './Resizer';\nimport useDraggable, { Anchor, Draggable } from './useDraggable';\n\nconst anchorStyle: CSSProperties = {\n  marginLeft: '5px',\n  width: '2px',\n  height: '100%',\n  pointerEvents: 'none',\n  position: 'relative',\n};\nconst styles = {\n  container: (position: number) => css`\n    position: absolute;\n    height: 100%;\n    width: 10px;\n    left: -5px;\n    cursor: e-resize;\n    transform: translateX(${position}px);\n    user-select: none;\n    z-index: 99999999;\n\n    &:hover {\n      div {\n        background-color: red;\n      }\n    }\n  `,\n\n  content: (anchorSide: Anchor | '', left: Draggable, right: Draggable) => {\n    const width = right.previousPosition - left.previousPosition;\n\n    const baseCss = css`\n      position: absolute;\n      width: ${width}px;\n      overflow: hidden;\n    `;\n    if (right.position.action === 'move' || left.position.action === 'move') {\n      const scale = (right.position.x - left.position.x) / width;\n      if (anchorSide === 'RIGHT') {\n        return [\n          baseCss,\n          css`\n            transform: translateX(${left.position.x}px) scaleX(${scale});\n            transform-origin: left center;\n          `,\n        ];\n      } else if (anchorSide === 'LEFT') {\n        return css([\n          baseCss,\n          css`\n            transform: translateX(${left.position.x}px) scaleX(${scale});\n            transform-origin: left center;\n          `,\n        ]);\n      }\n    } else {\n      return css([\n        baseCss,\n        css`\n          transform: translateX(${left.position.x}px);\n        `,\n      ]);\n    }\n  },\n};\n\nexport default function DivResizer(props: ResizerProps) {\n  const {\n    children,\n    initialPosition = { x1: 10, x2: 40 },\n    onStart,\n    onMove,\n    onEnd,\n  } = props;\n\n  const right = useDraggable({\n    x: initialPosition.x2,\n    anchor: 'RIGHT',\n  });\n  const left = useDraggable({\n    x: initialPosition.x1,\n    anchor: 'LEFT',\n  });\n\n  const anchor = left.isActive\n    ? left.anchor\n    : right.isActive\n    ? right.anchor\n    : '';\n\n  useEffect(() => {\n    const position: Position = { x1: left.position.x, x2: right.position.x };\n    const status = left.isActive\n      ? left.position.action\n      : right.isActive\n      ? right.position.action\n      : '';\n    switch (status) {\n      case 'start':\n        onStart?.(position);\n        break;\n      case 'move':\n        onMove?.(position);\n        break;\n      case 'end':\n        onEnd?.(position);\n        break;\n      default:\n        break;\n    }\n  }, [left, onEnd, onMove, onStart, right]);\n\n  return (\n    <>\n      <div\n        data-no-export=\"true\"\n        onMouseDown={right.onMouseDown}\n        css={styles.container(right.position.x)}\n      >\n        <div style={anchorStyle} />\n      </div>\n      <div css={styles.content(anchor, left, right)}>\n        {typeof children === 'function'\n          ? children?.(left.position.x, right.position.x)\n          : children}\n      </div>\n      <div\n        data-no-export=\"true\"\n        onMouseDown={left.onMouseDown}\n        css={styles.container(left.position.x)}\n      >\n        <div style={anchorStyle} />\n      </div>\n    </>\n  );\n}\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { CSSProperties, useEffect, MouseEventHandler } from 'react';\n\nimport { Position, ResizerProps } from './Resizer';\nimport useDraggable from './useDraggable';\n\nconst anchorStyle: CSSProperties = {\n  width: '2px',\n  height: '100%',\n  pointerEvents: 'none',\n  fill: 'transparent',\n};\nconst styles = {\n  container: (position: number) => css`\n    transform: translateX(${position}px);\n\n    &:hover {\n      rect:last-child {\n        fill: red !important;\n      }\n    }\n  `,\n  innerContainer: css`\n    position: absolute;\n    height: 100%;\n    fill: transparent;\n    width: 10px;\n    cursor: e-resize;\n    user-select: none;\n    z-index: 99999999;\n  `,\n};\n\nexport default function SVGResizer(props: ResizerProps) {\n  const {\n    children,\n    initialPosition = { x1: 10, x2: 40 },\n    onStart,\n    onMove,\n    onEnd,\n  } = props;\n\n  const right = useDraggable({\n    x: initialPosition.x2,\n    anchor: 'RIGHT',\n  });\n  const left = useDraggable({\n    x: initialPosition.x1,\n    anchor: 'LEFT',\n  });\n\n  useEffect(() => {\n    const position: Position = { x1: left.position.x, x2: right.position.x };\n    const status = left.isActive\n      ? left.position.action\n      : right.isActive\n      ? right.position.action\n      : '';\n    switch (status) {\n      case 'start':\n        onStart?.(position);\n        break;\n      case 'move':\n        onMove?.(position);\n        break;\n      case 'end':\n        onEnd?.(position);\n        break;\n      default:\n        break;\n    }\n  }, [left, onEnd, onMove, onStart, right]);\n\n  return (\n    <g\n      style={{\n        transform: `translateX(${left.position.x}px)`,\n      }}\n    >\n      {typeof children === 'function'\n        ? children(left.position.x, right.position.x)\n        : children}\n      <SVGResizerHandle onMouseDown={left.onMouseDown} position={0} />\n      <SVGResizerHandle\n        onMouseDown={right.onMouseDown}\n        position={right.position.x - left.position.x}\n      />\n    </g>\n  );\n}\n\nfunction SVGResizerHandle(props: {\n  onMouseDown: MouseEventHandler<SVGGElement>;\n  position: number;\n}) {\n  return (\n    <g\n      onMouseDown={props.onMouseDown}\n      css={styles.container(props.position)}\n      data-no-export=\"true\"\n    >\n      <rect x=\"-5px\" css={styles.innerContainer} />\n      <rect x=\"-2.5px\" style={anchorStyle} />\n    </g>\n  );\n}\n","import { ReactFragment } from 'react';\n\nimport DivResizer from './DivResizer';\nimport SVGResizer from './SVGResizer';\n\nexport interface Position {\n  x1: number;\n  x2: number;\n}\n\ntype ChildType =\n  | Array<React.ReactElement>\n  | React.ReactElement\n  | ReactFragment\n  | boolean\n  | null;\n\nexport interface ResizerProps {\n  children?: ChildType | ((x1: number, x2: number) => ChildType);\n  initialPosition?: Position;\n  position?: Position;\n  onStart?: PositionChangeHandler;\n  onMove?: PositionChangeHandler;\n  onEnd?: PositionChangeHandler;\n  tag?: 'div' | 'svg';\n}\n\ntype PositionChangeHandler = (data: Position) => void;\n\nexport default function Resizer(props: ResizerProps) {\n  const { tag = 'div', ...resProps } = props;\n  if (tag === 'div') {\n    return <DivResizer {...resProps} />;\n  } else {\n    return <SVGResizer {...resProps} />;\n  }\n}\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\nimport { useDispatch } from '../context/DispatchContext';\nimport { useScaleChecked } from '../context/ScaleContext';\nimport Resizer from '../elements/resizer/Resizer';\nimport { HighlightedSource, useHighlight } from '../highlight/index';\nimport { RESIZE_INTEGRAL } from '../reducer/types/Types';\n\nconst stylesOnHover = css`\n  pointer-events: bounding-box;\n  @-moz-document url-prefix() {\n    pointer-events: fill;\n  }\n  .highlight {\n    fill: transparent;\n  }\n  .target {\n    visibility: hidden;\n  }\n`;\n\nconst stylesHighlighted = css`\n  pointer-events: bounding-box;\n\n  @-moz-document url-prefix() {\n    pointer-events: fill;\n  }\n  fill: #ff6f0057;\n\n  .target {\n    visibility: visible;\n  }\n`;\n\ninterface IntegralResizableProps {\n  integralData: {\n    id: string;\n    from: number;\n    to: number;\n    integral?: number;\n  };\n}\n\nfunction IntegralResizable({ integralData }: IntegralResizableProps) {\n  const { height, margin } = useChartData();\n  const { scaleX } = useScaleChecked();\n  const dispatch = useDispatch();\n  const { id, from, to, integral } = integralData;\n  const highlight = useHighlight([id], {\n    type: HighlightedSource.INTEGRAL,\n    extra: { id },\n  });\n\n  const handleOnStopResizing = useCallback(\n    (position) => {\n      dispatch({\n        type: RESIZE_INTEGRAL,\n        payload: {\n          data: {\n            ...integralData,\n            from: scaleX().invert(position.x2),\n            to: scaleX().invert(position.x1),\n          },\n        },\n      });\n    },\n    [dispatch, integralData, scaleX],\n  );\n\n  const handleOnEnterNotation = useCallback(() => {\n    highlight.show();\n  }, [highlight]);\n\n  const handleOnMouseLeaveNotation = useCallback(() => {\n    highlight.hide();\n  }, [highlight]);\n\n  const x0 = from ? scaleX()(from) : 0;\n  const x1 = to ? scaleX()(to) : 0;\n\n  return (\n    <g\n      css={highlight.isActive ? stylesHighlighted : stylesOnHover}\n      onMouseEnter={handleOnEnterNotation}\n      onMouseLeave={handleOnMouseLeaveNotation}\n    >\n      <Resizer\n        tag=\"svg\"\n        initialPosition={{ x1: x1, x2: x0 }}\n        onEnd={handleOnStopResizing}\n      >\n        {(x1, x2) => (\n          <g>\n            <rect\n              x=\"0\"\n              y=\"0\"\n              width={x2 - x1}\n              height={height - margin.bottom}\n              className=\"highlight\"\n              data-no-export=\"true\"\n            />\n            <text\n              x={0}\n              y={height - margin.bottom + 30}\n              fill=\"black\"\n              style={{ fontSize: '12px', fontWeight: 'bold' }}\n            >\n              {integral !== undefined ? integral.toFixed(2) : ''}\n            </text>\n          </g>\n        )}\n      </Resizer>\n    </g>\n  );\n}\n\nexport default IntegralResizable;\n","import { useMemo } from 'react';\n\nimport { usePreferences } from '../context/PreferencesContext';\nimport useIntegralPath from '../hooks/useIntegralPath';\nimport { integralDefaultValues } from '../panels/extra/preferences/defaultValues';\nimport { getValue } from '../utility/LocalStorage';\n\nimport IntegralResizable from './IntegralResizable';\n\ninterface IntegralProps {\n  integral: { id: string; from: number; to: number; integral?: number };\n  isActive: boolean;\n}\n\nfunction Integral({ integral, isActive }: IntegralProps) {\n  const preferences = usePreferences();\n  const path = useIntegralPath(integral);\n\n  const integralSettings = useMemo(() => {\n    let {\n      color = integralDefaultValues.color,\n      strokeWidth = integralDefaultValues.strokeWidth,\n    } = getValue(preferences.current, 'formatting.panels.integrals') || {};\n    return { color, strokeWidth };\n  }, [preferences]);\n\n  return (\n    <g>\n      <path\n        className=\"line\"\n        stroke={integralSettings.color}\n        strokeWidth={integralSettings.strokeWidth}\n        fill=\"none\"\n        style={{\n          opacity: isActive ? 1 : 0.2,\n        }}\n        d={path}\n      />\n\n      <IntegralResizable integralData={integral} />\n    </g>\n  );\n}\n\nexport default Integral;\n","import { useMemo } from 'react';\n\nimport { isSpectrum1D } from '../../data/data1d/Spectrum1D';\nimport { useChartData } from '../context/ChartContext';\n\nimport Integral from './Integral';\n\nfunction IntegralsSeries() {\n  const { xDomains, activeSpectrum, data, displayerKey } = useChartData();\n\n  const Integrals = useMemo(() => {\n    const isActive = (id) => {\n      return activeSpectrum === null\n        ? true\n        : id === activeSpectrum.id\n        ? true\n        : false;\n    };\n\n    return (\n      <g className=\"integrals\">\n        {data?.[0] &&\n          data\n            .filter((d) => d.display.isVisible === true && xDomains[d.id])\n            .filter(isSpectrum1D)\n            .map((spectrum) =>\n              spectrum.integrals.values.map((integral) => (\n                <Integral\n                  key={integral.id}\n                  integral={integral}\n                  isActive={isActive(spectrum.id)}\n                />\n              )),\n            )}\n      </g>\n    );\n  }, [activeSpectrum, data, xDomains]);\n\n  return <g clipPath={`url(#${displayerKey}clip-chart-1d)`}>{Integrals}</g>;\n}\n\nexport default IntegralsSeries;\n","import { CSSProperties, useMemo } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\nimport { useScaleChecked } from '../context/ScaleContext';\nimport useActiveSpectrumStyleOptions from '../hooks/useActiveSpectrumStyleOptions';\nimport useXYReduce, { XYReducerDomainAxis } from '../hooks/useXYReduce';\nimport { PathBuilder } from '../utility/PathBuilder';\n\nimport getVerticalShift from './utilities/getVerticalShift';\n\ninterface LineProps {\n  data?: {\n    x: Array<number>;\n    y: Array<number>;\n  };\n  id: string;\n  display: {\n    color: CSSProperties['stroke'];\n  };\n  index: number;\n}\n\nfunction Line({ data, id, display, index }: LineProps) {\n  const { verticalAlign } = useChartData();\n  const { scaleX, scaleY } = useScaleChecked();\n  const xyReduce = useXYReduce(XYReducerDomainAxis.XAxis);\n  const { opacity } = useActiveSpectrumStyleOptions(id);\n\n  const vAlign = useMemo(() => {\n    return getVerticalShift(verticalAlign, { index });\n  }, [index, verticalAlign]);\n\n  const paths = useMemo(() => {\n    const _scaleX = scaleX();\n    const _scaleY = scaleY(id);\n\n    const pathBuilder = new PathBuilder();\n    if (data?.x && data?.y && _scaleX(0)) {\n      const pathPoints = xyReduce(data);\n\n      pathBuilder.moveTo(_scaleX(pathPoints.x[0]), _scaleY(pathPoints.y[0]));\n      for (let i = 1; i < pathPoints.x.length; i++) {\n        pathBuilder.lineTo(_scaleX(pathPoints.x[i]), _scaleY(pathPoints.y[i]));\n      }\n\n      return pathBuilder.toString();\n    } else {\n      return '';\n    }\n  }, [scaleX, scaleY, id, data, xyReduce]);\n\n  return (\n    <path\n      className=\"line\"\n      data-test-id=\"spectrum-line\"\n      key={id}\n      stroke={display.color}\n      fill=\"none\"\n      style={{\n        opacity,\n      }}\n      d={paths}\n      transform={`translate(0,-${vAlign})`}\n    />\n  );\n}\n\nexport default Line;\n","import { get1DDataXY } from '../../data/data1d/Spectrum1D/get1DDataXY';\nimport { useChartData } from '../context/ChartContext';\n\nimport Line from './Line';\n\nfunction LinesSeries() {\n  const { data, tempData, displayerKey, xDomains } = useChartData();\n  const _data = tempData ? tempData : data;\n\n  return (\n    <g clipPath={`url(#${displayerKey}clip-chart-1d)`} className=\"spectrums\">\n      {_data\n        ?.filter((d) => d.display.isVisible === true && xDomains[d.id])\n        .map((d, i) => (\n          <Line key={d.id} {...d} data={get1DDataXY(d)} index={i} />\n        ))}\n    </g>\n  );\n}\n\nexport default LinesSeries;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport {\n  useRef,\n  useState,\n  useCallback,\n  useLayoutEffect,\n  useEffect,\n  useMemo,\n} from 'react';\n\nimport { useDispatch } from '../context/DispatchContext';\nimport { HighlightedSource, useHighlight } from '../highlight';\nimport { SHIFT_SPECTRUM } from '../reducer/types/Types';\nimport { useFormatNumberByNucleus } from '../utility/FormatNumber';\n\nconst styles = css`\n  input {\n    -webkit-user-select: text; /* Safari 3.1+ */\n    -moz-user-select: text; /* Firefox 2+ */\n    -ms-user-select: text; /* IE 10+ */\n    user-select: text; /* Standard syntax */\n  }\n\n  input[type='number']::-webkit-outer-spin-button,\n  input[type='number']::-webkit-inner-spin-button {\n    -webkit-appearance: none;\n    margin: 0;\n  }\n\n  input[type='number'] {\n    -moz-appearance: textfield;\n  }\n\n  .notification-input-normal {\n    opacity: 1;\n    left: 4px;\n    position: fixed;\n    font-size: 10px;\n    outline: none;\n    background-color: transparent;\n  }\n\n  .notification-input-normal input:focus {\n    outline: none;\n    background-color: white;\n  }\n\n  .input-over {\n    background-color: white;\n    outline: none;\n  }\n`;\n\ninterface PeakAnnotationProps {\n  id: string;\n  x: number;\n  y: number;\n  sign: number;\n  color: string;\n  isActive: boolean;\n  value: number;\n  nucleus: string;\n}\n\nfunction PeakAnnotation({\n  id,\n  x,\n  y,\n  sign, // 1 positive -1 negative\n  value,\n  color,\n  isActive,\n  nucleus,\n}: PeakAnnotationProps) {\n  const refText = useRef<SVGTextElement>(null);\n  const [isSelected, setIsSelected] = useState(false);\n  const [_value, setValue] = useState(value);\n  const [containerSize, setContainerSize] = useState({ width: 0, height: 0 });\n  const format = useFormatNumberByNucleus(nucleus);\n  const highlight = useHighlight([id], {\n    type: HighlightedSource.PEAK,\n    extra: { id },\n  });\n\n  const dispatch = useDispatch();\n\n  const handleOnPeakChange = useCallback(\n    (e) => dispatch({ type: SHIFT_SPECTRUM, shiftValue: e.shiftValue }),\n    [dispatch],\n  );\n\n  useLayoutEffect(() => {\n    const textBox = refText.current?.getBBox();\n    setContainerSize({\n      width: textBox?.width || 0,\n      height: textBox?.height || 0,\n    });\n  }, [isSelected]);\n\n  useEffect(() => {\n    setValue(value);\n  }, [value]);\n\n  const handleKeyDown = useCallback(\n    (event: React.KeyboardEvent<HTMLInputElement>) => {\n      if (event.key === 'Enter') {\n        const newValue = event.currentTarget.valueAsNumber;\n        if (!isNaN(newValue)) {\n          const shiftValue = newValue - value;\n\n          handleOnPeakChange({\n            id,\n            value: newValue,\n            oldValue: value,\n            shiftValue: shiftValue,\n          });\n\n          event.currentTarget.blur();\n          setIsSelected(false);\n        }\n      } else if (event.key === 'Escape') {\n        setValue(value);\n        event.currentTarget.blur();\n        setIsSelected(false);\n      }\n    },\n    [value, handleOnPeakChange, id],\n  );\n\n  const handleChange = useCallback((event) => {\n    setValue(event.target.value);\n  }, []);\n\n  const handleSelectPeakAnnotation = useCallback((e) => {\n    e.stopPropagation();\n    setIsSelected(true);\n    return false;\n  }, []);\n\n  const handleOnEnterNotation = useCallback(() => {\n    highlight.show();\n  }, [highlight]);\n\n  const handleOnMouseLeaveNotation = useCallback(() => {\n    highlight.hide();\n  }, [highlight]);\n\n  const newValue = useMemo(\n    () => (isSelected ? value : format(value)),\n    [format, isSelected, value],\n  );\n  const oldValue = useMemo(\n    () => (isSelected ? _value : format(_value)),\n    [_value, format, isSelected],\n  );\n\n  return (\n    <g\n      css={styles}\n      id={id}\n      style={{ outline: 'none' }}\n      transform={`translate(${x}, ${y})`}\n      onMouseEnter={handleOnEnterNotation}\n      onMouseLeave={handleOnMouseLeaveNotation}\n    >\n      <line\n        x1=\"0\"\n        x2=\"0\"\n        y1={sign === -1 ? 10 : 0}\n        y2={sign === -1 ? 28 : -18}\n        stroke={color}\n        strokeWidth={highlight.isActive ? '7px' : '1px'}\n      />\n      <text\n        ref={refText}\n        className=\"peaks-text\"\n        x=\"0\"\n        y={sign === -1 ? 28 : -12}\n        dy=\"0\"\n        dx=\"0.35em\"\n        fill=\"transparent\"\n        fontSize=\"10px\"\n        fontWeight=\"100\"\n        style={{\n          position: 'absolute',\n        }}\n      >\n        {newValue}\n      </text>\n      <foreignObject\n        x=\"0\"\n        y={sign === -1 ? 16 : -22}\n        dy=\"0.1em\"\n        dx=\"0.35em\"\n        width={containerSize.width + 20}\n        height=\"40px\"\n        data-no-export=\"true\"\n      >\n        <div\n          style={{\n            width: containerSize.width + 20,\n            height: '100%',\n            paddingRight: 5,\n          }}\n        >\n          <input\n            onClick={handleSelectPeakAnnotation}\n            className={isSelected ? 'input-over' : 'notification-input-normal'}\n            style={{\n              width: 'inherit',\n              border: isSelected ? `1px solid ${color}` : `0`,\n              opacity: isActive ? 1 : 0.2,\n              userSelect: 'none',\n              color: color,\n            }}\n            value={oldValue}\n            onKeyDown={handleKeyDown}\n            onChange={handleChange}\n            type=\"number\"\n            disabled={!isActive}\n          />\n        </div>\n      </foreignObject>\n    </g>\n  );\n}\n\nexport default PeakAnnotation;\n","import { useMemo } from 'react';\n\nimport { isSpectrum1D } from '../../data/data1d/Spectrum1D';\nimport { useChartData } from '../context/ChartContext';\nimport { useScaleChecked } from '../context/ScaleContext';\n\nimport PeakAnnotation from './PeakAnnotation';\nimport getVerticalShift from './utilities/getVerticalShift';\n\nfunction PeakAnnotations() {\n  const { data, activeSpectrum, verticalAlign, displayerKey, xDomains } =\n    useChartData();\n  const { scaleX, scaleY } = useScaleChecked();\n\n  const Peaks = useMemo(() => {\n    const getVerticalAlign = (id) => {\n      const index = data.findIndex((d) => d.id === id);\n      return getVerticalShift(verticalAlign, { index });\n    };\n\n    const reSortData = () => {\n      const _data = [...data];\n      return activeSpectrum\n        ? _data.sort((x, y) => {\n            return x.id === activeSpectrum.id\n              ? 1\n              : y.id === activeSpectrum.id\n              ? -1\n              : 0;\n          })\n        : _data;\n    };\n\n    return (\n      data &&\n      reSortData()\n        .filter((d) => d.display.isVisible === true && xDomains[d.id])\n        .filter(isSpectrum1D)\n        .map((d) => {\n          return (\n            d.peaks?.values &&\n            d.display.isPeaksMarkersVisible && (\n              <g\n                key={d.id}\n                transform={`translate(0,-${getVerticalAlign(d.id)})`}\n              >\n                {d.peaks.values.map(({ x, y, id }) => (\n                  <PeakAnnotation\n                    key={id}\n                    x={scaleX()(x)}\n                    y={scaleY(d.id)(y) - 5}\n                    sign={Math.sign(y)}\n                    id={id}\n                    value={x}\n                    color=\"#730000\"\n                    nucleus={d.info.nucleus}\n                    isActive={\n                      activeSpectrum == null\n                        ? false\n                        : activeSpectrum.id === d.id\n                        ? true\n                        : false\n                    }\n                  />\n                ))}\n              </g>\n            )\n          );\n        })\n    );\n  }, [data, verticalAlign, activeSpectrum, xDomains, scaleX, scaleY]);\n\n  return (\n    <g className=\"peaks\" clipPath={`url(#${displayerKey}clip-chart-1d)`}>\n      {Peaks}\n    </g>\n  );\n}\n\nexport default PeakAnnotations;\n","import { extent } from 'd3';\nimport { rangesToXY } from 'nmr-processing';\n\nimport { Datum1D } from '../../data/types/data1d';\nimport { useChartData } from '../context/ChartContext';\nimport { useScaleChecked } from '../context/ScaleContext';\nimport { HighlightedSource, useHighlightData } from '../highlight';\nimport useSpectrum from '../hooks/useSpectrum';\n\nimport { getYScale } from './utilities/scale';\n\nconst emptyData = { info: { originFrequency: 400 } };\n\nfunction ResurrectedDatabaseRanges() {\n  const { displayerKey, verticalAlign, height, margin } = useChartData();\n  const { info } = useSpectrum(emptyData) as Datum1D;\n  const { highlight } = useHighlightData();\n  const { scaleX } = useScaleChecked();\n\n  if (highlight.sourceData?.type !== HighlightedSource.DATABASE) {\n    return null;\n  }\n\n  const fullHeight = height - margin.bottom;\n  const blockHight = fullHeight / 4;\n\n  const { ranges } = highlight.sourceData.extra || [];\n\n  let yDomain: any[] = [0, 0];\n\n  const spectra = ranges.map((range) => {\n    const { from, to } = range;\n    const diff = Math.abs(from - to) / 2;\n    const newForm = from - diff;\n    const newTo = to + diff;\n    const data = rangesToXY([range], {\n      frequency: info.originFrequency,\n      from: newForm,\n      to: newTo,\n      nbPoints: 256,\n    });\n    //calculate y domain\n    const domain = extent(data.y) as number[];\n    yDomain[0] = domain[0] < yDomain[0] ? domain[0] : yDomain[0];\n    yDomain[1] = domain[1] > yDomain[1] ? domain[1] : yDomain[1];\n\n    return { data, from: newForm, to: newTo };\n  }, []);\n\n  const scaleY = getYScale({\n    height: blockHight,\n    margin: { top: 0, bottom: 0 },\n    verticalAlign,\n    yDomain,\n  });\n\n  const paths = spectra.map(({ data: { x, y }, from, to }) => {\n    let path = `M ${scaleX()(x[0])} ${scaleY(y[0])} `;\n    path += x.slice(1).reduce((accumulator, point, i) => {\n      accumulator += ` L ${scaleX()(point)} ${scaleY(y[i + 1])}`;\n      return accumulator;\n    }, '');\n    return { path, from, to };\n  }, []);\n\n  return (\n    <g\n      clipPath={`url(#${displayerKey}clip-chart-1d)`}\n      className=\"resurrected-database-ranges\"\n      width=\"100%\"\n      height=\"100%\"\n    >\n      {paths.map(({ path, from, to }, index) => (\n        // eslint-disable-next-line react/no-array-index-key\n        <g key={`${index}`}>\n          <g transform={`translate(${scaleX()(to)},0)`}>\n            <rect\n              x=\"0\"\n              width={Math.abs(scaleX()(to) - scaleX()(from))}\n              height=\"100%\"\n              fill=\"#ff6f0057\"\n            />\n          </g>\n          <path\n            transform={`translate(0,${fullHeight - blockHight * 2})`}\n            stroke=\"black\"\n            fill=\"none\"\n            d={path}\n          />\n        </g>\n      ))}\n    </g>\n  );\n}\n\nexport default ResurrectedDatabaseRanges;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport * as d3 from 'd3';\nimport { useEffect, useRef } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\nimport { useScale } from '../context/ScaleContext';\n\nconst axisStyles = css`\n  user-select: none;\n\n  path,\n  line {\n    fill: none;\n    stroke: black;\n    stroke-width: 1;\n    shape-rendering: crispEdges;\n    user-select: none;\n  }\n`;\n\nconst gridStyles = css`\n  user-select: none;\n\n  line {\n    stroke: rgb(104, 104, 104);\n    stroke-opacity: 0.2;\n    shape-rendering: crispEdges;\n    stroke-dasharray: 3;\n    stroke-width: 1;\n    user-select: none;\n  }\n\n  path {\n    stroke-width: 0;\n  }\n`;\n\ninterface XAxisProps {\n  show?: boolean;\n  showGrid?: boolean;\n  mode?: string;\n  label?: string;\n}\n\nfunction XAxis(props: XAxisProps) {\n  const { show = true, showGrid = false, mode, label: labelProp } = props;\n  const { xDomain, height, width, margin } = useChartData();\n  const { scaleX } = useScale();\n\n  const refAxis = useRef<SVGGElement>(null);\n  const refGrid = useRef<SVGGElement>(null);\n\n  const label = labelProp ? labelProp : mode === 'RTL' ? 'δ [ppm]' : 'time [s]';\n\n  useEffect(() => {\n    if (!show || !scaleX) return;\n\n    const xAxis = d3\n      .axisBottom(scaleX().domain(xDomain))\n      .ticks(8)\n      .tickFormat(d3.format('0'));\n\n    const grid = d3\n      .axisBottom(scaleX().domain(xDomain))\n      .ticks(50)\n      .tickSize(-(height - margin.top - margin.bottom))\n      .tickFormat(() => '');\n\n    // @ts-expect-error This line of code is actually well typed ...\n    d3.select(refAxis.current).call(xAxis);\n\n    // @ts-expect-error ditto\n    d3.select(refGrid.current).call(grid);\n  }, [height, margin.bottom, margin.top, scaleX, show, xDomain]);\n\n  if (!width || !height || !scaleX) {\n    return null;\n  }\n\n  return (\n    <>\n      {show && (\n        <g\n          className=\"x\"\n          css={axisStyles}\n          transform={`translate(0,${height - margin.bottom})`}\n          ref={refAxis}\n        >\n          <text fill=\"#000\" x={width - 10} y=\"30\" dy=\"0.70em\" textAnchor=\"end\">\n            {label}\n          </text>\n        </g>\n      )}\n      {showGrid && (\n        <g\n          css={gridStyles}\n          className=\"grid\"\n          ref={refGrid}\n          transform={`translate(0,${height - margin.bottom})`}\n        />\n      )}\n    </>\n  );\n}\n\nexport default XAxis;\n","import { Jcoupling } from 'nmr-processing';\n\nimport { Range, Signal1D } from '../../types/data1d';\nimport generateID from '../../utilities/generateID';\n/**\n * Links object that use coupling as key and value is an array of objects {id:signal id ,x:signal delta,y:coupling}\n */\n\ninterface Coupling {\n  coupling: number;\n  delta: number;\n}\n\nexport interface CouplingLink {\n  id: string;\n  couplings: Coupling[];\n  from: number;\n  to: number;\n}\n\ninterface GenerateJGraphDataResult {\n  signals: Signal1D[];\n  jCouplingMax: number;\n  links: CouplingLink[];\n}\n\nexport default function generateJGraphData(\n  ranges: Range[],\n  jGraphTolerance: number,\n): GenerateJGraphDataResult | null {\n  if (!ranges && !Array.isArray(ranges)) return null;\n\n  let signals: Signal1D[] = [];\n  let jCouplingMax = 0;\n  let links: CouplingLink[] = createLinks(ranges, jGraphTolerance);\n  for (const range of ranges) {\n    for (const signal of range.signals) {\n      const { id: signalId, ...restSignal } = signal;\n\n      if (restSignal.js) {\n        signals.push({ id: `${range.id}${signalId}`, ...restSignal });\n        const tempMax = getJsCouplingMax(restSignal.js);\n        jCouplingMax = tempMax > jCouplingMax ? tempMax : jCouplingMax;\n      }\n    }\n  }\n\n  return { signals, jCouplingMax, links };\n}\n\nfunction getJsCouplingMax(js: Jcoupling[]): number {\n  let max = -Infinity;\n  for (const { coupling } of js) {\n    max = coupling > max ? coupling : max;\n  }\n  return max;\n}\n\nfunction getCouplings(ranges: Range[]): Coupling[] {\n  const couplings: Coupling[] = [];\n  for (let range of ranges) {\n    for (const { delta, js } of range.signals) {\n      for (const { coupling } of js || []) {\n        couplings.push({ coupling, delta });\n      }\n    }\n  }\n  return couplings;\n}\n\nfunction initLink(coupling: Coupling): CouplingLink {\n  const { delta } = coupling;\n  return {\n    id: generateID(),\n    from: delta,\n    to: delta,\n    couplings: [coupling],\n  };\n}\n\nfunction createLinks(ranges: Range[], jGraphTolerance = 0) {\n  const couplings = getCouplings(ranges).sort(\n    (a, b) => a.coupling - b.coupling,\n  );\n\n  if (!couplings || couplings.length === 0) return [];\n\n  const links: CouplingLink[] = [initLink(couplings[0])];\n\n  let index = 0;\n  let start = index;\n  let end = 1;\n\n  while (end < couplings.length) {\n    const nextCoupling = couplings[end];\n    if (\n      Math.abs(couplings[start].coupling - nextCoupling.coupling) <\n      jGraphTolerance\n    ) {\n      links[index].couplings.push(nextCoupling);\n\n      if (nextCoupling.delta > links[index].to) {\n        links[index].to = nextCoupling.delta;\n      } else if (nextCoupling.delta < links[index].from) {\n        links[index].from = nextCoupling.delta;\n      }\n\n      end++;\n    } else {\n      if (\n        Math.abs(couplings[end - 1].coupling - nextCoupling.coupling) <\n        jGraphTolerance\n      ) {\n        start = end - 1;\n      } else {\n        index++;\n        links[index] = initLink(couplings[end]);\n        start = end;\n        end = end + 1;\n      }\n    }\n  }\n\n  return links;\n}\n","import { ScaleLinear } from 'd3';\nimport { useContext, createContext } from 'react';\n\ninterface JGraphState {\n  scaleY: ScaleLinear<number, number, never> | null;\n  height: number;\n  maxValue: number;\n}\n\nconst JGraphContext = createContext<JGraphState>({\n  scaleY: null,\n  height: 0,\n  maxValue: 0,\n});\n\nexport const JGraphContextProvider = JGraphContext.Provider;\n\nexport function useJGraph() {\n  const jGraphState = useContext(JGraphContext);\n  if (!jGraphState.scaleY) {\n    throw new Error('scale cannot be null');\n  }\n\n  return jGraphState;\n}\n","import { ScaleLinear } from 'd3';\nimport { forwardRef, useRef, MutableRefObject } from 'react';\nimport { useLinearPrimaryTicks } from 'react-d3-utils';\n\ninterface BaseAxis {\n  x: number;\n  y: number;\n}\ninterface ScaleAxis {\n  scale: ScaleLinear<number, number>;\n}\n\ninterface Vertical {\n  height: number;\n  showGrid?: false;\n}\n\ninterface VerticalGrid {\n  height: number;\n  showGrid: true;\n  width: number;\n}\n\ninterface Ticks {\n  label: string;\n  position: number;\n}\n\ninterface TickAxis {\n  ticks: Ticks[];\n  // eslint-disable-next-line react/no-unused-prop-types\n  ref: MutableRefObject<SVGGElement | null>;\n}\n\ntype VerticalAxisProps = BaseAxis & (Vertical | VerticalGrid) & ScaleAxis;\ntype VerticalRenderProps = BaseAxis & (Vertical | VerticalGrid) & TickAxis;\n\nconst VerticalAxis = forwardRef<SVGGElement | null, VerticalRenderProps>(\n  (props, ref) => {\n    const { x, y, height, showGrid, ticks } = props;\n    return (\n      <g ref={ref} transform={`translate(${x}, ${y})`}>\n        <line y2={height} x1={15} x2={15} stroke=\"black\" />\n        {ticks.map(({ label, position }, index) => (\n          // eslint-disable-next-line react/no-array-index-key\n          <g key={index + label + position}>\n            {showGrid && props.width && (\n              <line\n                y1={position}\n                y2={position}\n                x1={15}\n                x2={props.width - x}\n                stroke=\"lightgray\"\n              />\n            )}\n            <line y1={position} y2={position} x1={15} x2={10} stroke=\"black\" />\n            <text y={position} dominantBaseline=\"middle\" textAnchor=\"end\">\n              {label}\n            </text>\n          </g>\n        ))}\n      </g>\n    );\n  },\n);\n\nexport function LinearVerticalAxis(props: VerticalAxisProps) {\n  const { scale, ...other } = props;\n  const ref = useRef<SVGGElement>(null);\n  const ticks = useLinearPrimaryTicks(scale, 'vertical', ref);\n  return <VerticalAxis {...other} ticks={ticks} ref={ref} />;\n}\n","import { useChartData } from '../../context/ChartContext';\nimport { LinearVerticalAxis } from '../../elements/linearAxis/LinearVerticalAxis';\n\nimport { useJGraph } from './JGraphContext';\n\nexport function JGraphVerticalAxis() {\n  const { width, margin } = useChartData();\n  const { height, scaleY } = useJGraph();\n\n  if (!scaleY) return null;\n\n  return (\n    <svg style={{ overflow: 'visible' }} height={height + 20} width={60}>\n      <LinearVerticalAxis\n        x={20}\n        y={0}\n        scale={scaleY}\n        height={height}\n        showGrid\n        width={width - margin.right}\n      />\n    </svg>\n  );\n}\n","import { useCallback } from 'react';\n\nimport { CouplingLink } from '../../../data/data1d/Spectrum1D/generateJGraphData';\nimport { useScaleChecked } from '../../context/ScaleContext';\n\nimport { useJGraph } from './JGraphContext';\n\ninterface JsCouplingLinksProps {\n  links: CouplingLink[];\n}\n\nexport default function JsCouplingLinks(props: JsCouplingLinksProps) {\n  const { links } = props;\n  const { scaleX } = useScaleChecked();\n  const { scaleY, maxValue } = useJGraph();\n  const generatePath = useCallback(\n    (link: CouplingLink): string => {\n      if (!scaleY) return '';\n\n      const { from, to, couplings } = link;\n      let paths: string[] = [];\n      for (const coupling of couplings) {\n        paths.push(\n          `M${scaleX()(from)},${scaleY(coupling.coupling)} L${scaleX()(\n            to,\n          )},${scaleY(coupling.coupling)}`,\n        );\n      }\n      return paths.join(' ');\n    },\n    [scaleX, scaleY],\n  );\n\n  return (\n    <g className=\"js-coupling-links\">\n      {links\n        .filter((link) => link.couplings.length > 1)\n        .map((link) => {\n          return (\n            <path\n              key={link.id}\n              d={generatePath(link)}\n              style={{\n                stroke: `hsl(${\n                  (link.couplings[0].coupling * 360) / maxValue\n                },100%,50%)`,\n              }}\n              strokeWidth=\"1\"\n            />\n          );\n        })}\n    </g>\n  );\n}\n","import { useState } from 'react';\n\nimport { useJGraph } from './JGraphContext';\n\ninterface JsCouplingProps {\n  value: number;\n}\n\nexport default function JsCoupling({ value }: JsCouplingProps) {\n  const { scaleY, maxValue } = useJGraph();\n  const [isOver, setOver] = useState<boolean>(false);\n\n  if (!scaleY) return null;\n\n  return (\n    <g\n      className=\"coupling\"\n      style={{ transform: `translate(0px,${scaleY(value)}px)` }}\n    >\n      <circle\n        onMouseEnter={() => setOver(true)}\n        onMouseLeave={() => setOver(false)}\n        cx={0}\n        cy={0}\n        r={4}\n        fill={`hsl(${(value * 360) / maxValue},100%,${isOver ? 45 : 50}%)`}\n        pointerEvents=\"all\"\n      />\n      {isOver && (\n        <g style={{ transform: `translate(0px,15px)` }}>\n          <text\n            pointerEvents=\"none\"\n            stroke=\"white\"\n            strokeWidth=\"0.6em\"\n            fontSize=\"11px\"\n            dominantBaseline=\"middle\"\n            textAnchor=\"end\"\n          >{`${value.toFixed(1)} Hz`}</text>\n          <text\n            pointerEvents=\"none\"\n            stroke=\"black\"\n            fontSize=\"11px\"\n            dominantBaseline=\"middle\"\n            textAnchor=\"end\"\n          >{`${value.toFixed(1)} Hz`}</text>\n        </g>\n      )}\n    </g>\n  );\n}\n","import { Signal1D } from '../../../data/types/data1d';\nimport { useScaleChecked } from '../../context/ScaleContext';\n\nimport { useJGraph } from './JGraphContext';\nimport JsCoupling from './JsCoupling';\n\ninterface JsCouplingsProps {\n  signals: Signal1D[];\n}\n\nexport default function JsCouplings(props: JsCouplingsProps) {\n  const { scaleX } = useScaleChecked();\n  const { height } = useJGraph();\n\n  return (\n    <g className=\"js-coupling\">\n      {props.signals.map((signal) => {\n        return (\n          <g\n            key={signal.id}\n            transform={`translate(${scaleX()(signal.delta)},0)`}\n          >\n            <line\n              x1=\"0\"\n              y1={height}\n              x2=\"0\"\n              y2=\"0\"\n              stroke=\"black\"\n              strokeWidth=\"1\"\n            />\n            {signal.js?.map((j) => {\n              return <JsCoupling key={`${j.coupling}`} value={j.coupling} />;\n            })}\n          </g>\n        );\n      })}\n    </g>\n  );\n}\n","import { scaleLinear } from 'd3';\nimport lodashGet from 'lodash/get';\nimport { memo, useMemo } from 'react';\n\nimport generateJGraphData, {\n  CouplingLink,\n} from '../../../data/data1d/Spectrum1D/generateJGraphData';\nimport { Signal1D } from '../../../data/types/data1d';\nimport { Datum1D } from '../../../data/types/data1d/Datum1D';\nimport { useChartData } from '../../context/ChartContext';\nimport { usePreferences } from '../../context/PreferencesContext';\nimport useSpectrum from '../../hooks/useSpectrum';\nimport { getRangeDefaultValues } from '../../panels/extra/preferences/defaultValues';\n\nimport { JGraphContextProvider } from './JGraphContext';\nimport { JGraphVerticalAxis } from './JGraphVerticalAxis';\nimport JCouplingLinks from './JsCouplingLinks';\nimport JsCouplings from './JsCouplings';\n\nconst marginTop = 50;\n\ninterface innerJGraphProps {\n  signals: Signal1D[];\n  links: CouplingLink[];\n}\n\nfunction InnerJGraph(props: innerJGraphProps) {\n  const { signals, links } = props;\n  return (\n    <g className=\"j-graph\" transform={`translate(0,${marginTop})`}>\n      <JGraphVerticalAxis />\n      <JCouplingLinks links={links} />\n      <JsCouplings signals={signals} />\n    </g>\n  );\n}\n\nconst emptyData = { ranges: {} };\nconst MemoizedJGraph = memo(InnerJGraph);\n\nexport default function JGraph() {\n  const preferences = usePreferences();\n\n  const {\n    height,\n    toolOptions: {\n      data: { showJGraph },\n    },\n    activeTab,\n  } = useChartData();\n\n  const graphHeight = height / 4;\n\n  const { ranges } = useSpectrum(emptyData) as Datum1D;\n\n  const jGraphTolerance = useMemo(() => {\n    const _preferences =\n      lodashGet(\n        preferences.current,\n        `formatting.panels.ranges.[${activeTab}]`,\n      ) || getRangeDefaultValues(activeTab);\n\n    return _preferences.jGraphTolerance;\n  }, [activeTab, preferences]);\n\n  const {\n    signals,\n    jCouplingMax: maxValue,\n    links,\n  } = useMemo(\n    () =>\n      generateJGraphData(ranges.values, jGraphTolerance) || {\n        signals: [],\n        jCouplingMax: 0,\n        links: [],\n      },\n    [jGraphTolerance, ranges.values],\n  );\n\n  const scaleY = useMemo(() => {\n    const maxRange = maxValue + maxValue * 0.1;\n    return scaleLinear().range([graphHeight, 0]).domain([0, maxRange]);\n  }, [graphHeight, maxValue]);\n\n  const JGraphState = useMemo(() => {\n    return { scaleY, height: graphHeight, maxValue };\n  }, [graphHeight, scaleY, maxValue]);\n\n  if (!showJGraph) return null;\n\n  return (\n    <JGraphContextProvider value={JGraphState}>\n      <MemoizedJGraph signals={signals} links={links} />\n    </JGraphContextProvider>\n  );\n}\n","interface DeleteButtonProps {\n  onDelete?: () => void;\n  fill?: string;\n  x: string | number;\n  y: string | number;\n}\n\nfunction DeleteButton(props: DeleteButtonProps) {\n  const {\n    x = 'initial',\n    y = 'initial',\n    onDelete = () => null,\n    fill = '#c81121',\n  } = props;\n\n  return (\n    <svg\n      className=\"delete-button\"\n      x={x}\n      y={y}\n      onClick={onDelete}\n      data-no-export=\"true\"\n    >\n      <rect rx=\"5\" width=\"16\" height=\"16\" fill={fill} />\n      <line x1=\"5\" x2=\"10\" y1=\"8\" y2=\"8\" stroke=\"white\" strokeWidth=\"2\" />\n    </svg>\n  );\n}\n\nexport default DeleteButton;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback } from 'react';\n\nimport { useDispatch } from '../../context/DispatchContext';\nimport { useScaleChecked } from '../../context/ScaleContext';\nimport DeleteButton from '../../elements/DeleteButton';\nimport Resizer from '../../elements/resizer/Resizer';\nimport { useHighlight } from '../../highlight';\nimport {\n  DELETE_ANALYZE_SPECTRA_RANGE,\n  RESIZE_ANALYZE_SPECTRA_RANGE,\n} from '../../reducer/types/Types';\n\nconst styles = {\n  common: css`\n    pointer-events: bounding-box;\n\n    @-moz-document url-prefix() {\n      pointer-events: fill;\n    }\n  `,\n  hover: css`\n    .delete-button {\n      visibility: hidden;\n    }\n  `,\n  Highlighted: css`\n    .range-area {\n      height: 100%;\n      fill: #ff6f0057;\n    }\n    .delete-button {\n      visibility: visible;\n      cursor: pointer;\n    }\n  `,\n};\n\ninterface AnalysisRangeProps {\n  columnKey: string;\n  rangeData: {\n    from: number;\n    to: number;\n  };\n}\n\nfunction AnalysisRange({ rangeData, columnKey }: AnalysisRangeProps) {\n  const { from, to } = rangeData;\n  const highlight = useHighlight([columnKey]);\n  const { scaleX } = useScaleChecked();\n  const dispatch = useDispatch();\n\n  const deleteHandler = useCallback(() => {\n    dispatch({ type: DELETE_ANALYZE_SPECTRA_RANGE, colKey: columnKey });\n  }, [columnKey, dispatch]);\n\n  const resizeEndHandler = useCallback(\n    (resized) => {\n      dispatch({\n        type: RESIZE_ANALYZE_SPECTRA_RANGE,\n        payload: { ...rangeData, ...resized, columnKey },\n      });\n    },\n    [columnKey, dispatch, rangeData],\n  );\n\n  return (\n    <g\n      {...highlight.onHover}\n      css={[\n        styles.common,\n        highlight.isActive ? styles.Highlighted : styles.hover,\n      ]}\n    >\n      <Resizer\n        tag=\"svg\"\n        onEnd={resizeEndHandler}\n        initialPosition={{ x2: scaleX()(from), x1: scaleX()(to) }}\n      >\n        {(x1, x2) => (\n          <>\n            <g transform={`translate(0,25)`}>\n              <rect\n                x=\"0\"\n                width={x2 - x1}\n                height=\"6\"\n                className=\"range-area\"\n                fill=\"green\"\n              />\n              <text\n                textAnchor=\"middle\"\n                x={(x2 - x1) / 2}\n                y=\"-5\"\n                fontSize=\"12\"\n                fill=\"red\"\n                fontWeight=\"bolder\"\n                fillOpacity={highlight.isActive ? 1 : 0.6}\n              >\n                {columnKey}\n              </text>\n            </g>\n            <DeleteButton x={-20} y={10} onDelete={deleteHandler} />\n          </>\n        )}\n      </Resizer>\n    </g>\n  );\n}\n\nexport default AnalysisRange;\n","import { memo, useMemo } from 'react';\n\nimport { SpectraAnalysis } from '../../../data/data1d/MultipleAnalysis';\nimport { useChartData } from '../../context/ChartContext';\n\nimport AnalysisRange from './AnalysisRange';\n\ninterface MultiAnalysisRangesInnerProps {\n  activeTab: string;\n  displayerKey: string;\n  spectraAnalysis: SpectraAnalysis;\n}\n\nfunction MultiAnalysisRangesInner({\n  activeTab,\n  spectraAnalysis,\n  displayerKey,\n}: MultiAnalysisRangesInnerProps) {\n  const columns = useMemo(() => {\n    const {\n      options: { columns },\n    } = spectraAnalysis[activeTab] || {\n      options: { columns: {} },\n    };\n    return columns;\n  }, [activeTab, spectraAnalysis]);\n\n  const ranges = useMemo(() => {\n    return Object.keys(columns).map((key) => key, []);\n  }, [columns]);\n\n  if (!ranges || ranges.length === 0) {\n    return null;\n  }\n\n  return (\n    <g clipPath={`url(#${displayerKey}clip-chart-1d)`}>\n      {ranges.map((columnKey) => (\n        <AnalysisRange\n          key={columnKey}\n          columnKey={columnKey}\n          rangeData={columns[columnKey]}\n        />\n      ))}\n    </g>\n  );\n}\n\nconst MemoizedMultiAnalysisRanges = memo(MultiAnalysisRangesInner);\n\nexport default function MultiAnalysisRanges() {\n  const { activeTab, spectraAnalysis, displayerKey } = useChartData();\n\n  return (\n    <MemoizedMultiAnalysisRanges\n      {...{ activeTab, spectraAnalysis, displayerKey }}\n    />\n  );\n}\n","import { AssignmentContext } from '../AssignmentsContext';\n\nexport function filterForIDsWithAssignment(\n  assignmentData: AssignmentContext,\n  ids: string[],\n) {\n  return ids.filter((id) =>\n    Object.keys(assignmentData.data).filter((_id) => _id === id),\n  );\n}\n","export interface MultipletDefinition {\n  label: string;\n  value: string;\n  multiplicity: number | null;\n}\n\nexport const Multiplets: MultipletDefinition[] = [\n  { label: 'massive (m)', value: 'm', multiplicity: null },\n  { label: 'singlet (s)', value: 's', multiplicity: 1 },\n  { label: 'doublet (d)', value: 'd', multiplicity: 2 },\n  { label: 'triplet (t)', value: 't', multiplicity: 3 },\n  { label: 'quartet (q)', value: 'q', multiplicity: 4 },\n  { label: 'quintet (i)', value: 'i', multiplicity: 5 },\n  { label: 'sextet (x)', value: 'x', multiplicity: 6 },\n  { label: 'septet (p)', value: 'p', multiplicity: 7 },\n  { label: 'octet (o)', value: 'o', multiplicity: 8 },\n  { label: 'nonet (n)', value: 'n', multiplicity: 9 },\n];\n","import { Multiplets } from '../../../../data/constants/Multiplets';\n\nfunction getMultiplicityNumber(string) {\n  const multiplet = Multiplets.find(\n    (_multiplet) => string === _multiplet.label || string === _multiplet.value,\n  );\n\n  return multiplet ? multiplet.multiplicity : null;\n}\n\nfunction checkMultiplet(multiplet, rejected: Array<any> = []) {\n  // options to determine whether a massive (m), for example, should be considered as rejected multiplet\n  if (multiplet === undefined || multiplet.length === 0) {\n    return false;\n  }\n  const _multiplet = Multiplets.find(\n    (m) => m.value === multiplet || m.label === multiplet,\n  );\n  return (\n    _multiplet &&\n    !rejected.includes(_multiplet.value) &&\n    !rejected.includes(_multiplet.label)\n  );\n}\n\nfunction checkMultiplicity(multiplicity, rejected: Array<string> = []) {\n  // options to determine whether a massive (m), for example, should be considered as rejected multiplicity\n  if (multiplicity === undefined || multiplicity.length === 0) {\n    return false;\n  }\n  return !multiplicity\n    .split('')\n    .find((_multiplet) => !checkMultiplet(_multiplet, rejected));\n}\n\nfunction translateMultiplet(multiplet) {\n  return multiplet.length === 1\n    ? Multiplets.find((_multiplet) => _multiplet.value === multiplet)?.label\n    : Multiplets.find((_multiplet) => _multiplet.label === multiplet)?.value;\n}\n\nfunction hasCouplingConstant(multiplet) {\n  if (multiplet.length > 1) {\n    multiplet = translateMultiplet(multiplet);\n  }\n  // with the pre-set rejected ones, we check the given multiplicity for the need of having a coupling constant (massive and singlet do not)\n  return checkMultiplicity(multiplet, ['m', 's']);\n}\n\nfunction getPascal(n, spin) {\n  if (n === undefined || n === 0 || spin === undefined) return [1];\n  let mult = 2 * spin + 1;\n  let previousLine: Array<any> = [];\n  for (let j = 0; j < mult - 1; j++) previousLine.push(1);\n  // complete with \"1 1\" or \"1 1 1\" for spin 1/2 and 1 respectively\n  for (let i = 0; i < n - 1; i++) {\n    // copy the line\n    let _line = previousLine.slice();\n    for (let j = 1; j < mult; j++) {\n      for (let k = 0; k < previousLine.length - 1; k++) {\n        _line[k + j] += previousLine[k];\n      } // add the previous line\n      _line.push(1); // complete the line\n    }\n    previousLine = _line.slice();\n  }\n  return previousLine;\n}\n\nexport {\n  checkMultiplet,\n  checkMultiplicity,\n  getMultiplicityNumber,\n  getPascal,\n  hasCouplingConstant,\n  translateMultiplet,\n};\n","export const TREE_LEVEL_COLORS: Array<string> = [\n  'red',\n  'green',\n  'blue',\n  'magenta',\n];\n","import { Signal1D } from '../../../data/types/data1d';\nimport { useScaleChecked } from '../../context/ScaleContext';\n\nimport { TREE_LEVEL_COLORS } from './TreeColors';\n\ninterface LevelNodeProps {\n  signal: Signal1D;\n  startY: number;\n  levelHeight: number;\n}\n\nfunction LevelNode({ signal, startY, levelHeight }: LevelNodeProps) {\n  const { scaleX } = useScaleChecked();\n\n  return (\n    <line\n      key={`startLevelNode_${signal.id}`}\n      x1={scaleX()(signal.delta)}\n      y1={startY}\n      x2={scaleX()(signal.delta)}\n      y2={startY + levelHeight}\n      stroke={TREE_LEVEL_COLORS[0]}\n    />\n  );\n}\n\nexport default LevelNode;\n","/* eslint-disable import/order */\nimport { CSSProperties } from 'react';\n\nimport { useScaleChecked } from '../../context/ScaleContext';\nimport { Signal1D } from '../../../data/types/data1d/Signal1D';\n\ninterface StringNodeProps {\n  signal: Signal1D;\n  startY: number;\n  levelHeight: number;\n  fontSize: CSSProperties['fontSize'];\n  showLabels: boolean;\n}\n\nfunction StringNode({\n  signal,\n  startY,\n  levelHeight,\n  fontSize,\n  showLabels,\n}: StringNodeProps) {\n  const { scaleX } = useScaleChecked();\n  return (\n    <text\n      key={`multiplicityString_${signal.id}`}\n      textAnchor=\"middle\"\n      x={scaleX()(signal.delta)}\n      y={startY + levelHeight / 2}\n      fontSize={fontSize}\n      lengthAdjust=\"spacing\"\n      fill=\"black\"\n      visibility={showLabels ? 'visible' : 'hidden'}\n    >\n      {signal.multiplicity}\n    </text>\n  );\n}\n\nexport default StringNode;\n","/* eslint-disable react/no-unused-prop-types */\nimport { CSSProperties, useCallback } from 'react';\n\nimport { useScaleChecked } from '../../context/ScaleContext';\n\ninterface NodeData {\n  startX: number;\n  _startX: number;\n  ratio: number;\n  multiplicityIndex: number;\n  color: string;\n}\n\ninterface TreeNodesProps {\n  showLabels: boolean;\n  startY: number;\n  signalID: string;\n  levelHeight: number;\n  nodesData: Array<NodeData>;\n  labelOptions: {\n    distance: number;\n    fontSize: CSSProperties['fontSize'];\n  };\n}\n\nfunction TreeNodes({\n  nodesData,\n  levelHeight,\n  startY,\n  signalID,\n  labelOptions,\n  showLabels,\n}: TreeNodesProps) {\n  const { scaleX } = useScaleChecked();\n  const buildTreeNodeAndEdge = useCallback(\n    ({ startX, _startX, ratio, multiplicityIndex, color }: NodeData) => {\n      const edgeLevel = 2 * multiplicityIndex + 2;\n      const _startYEdge = startY + edgeLevel * levelHeight;\n      const _startYNode = startY + (edgeLevel + 1) * levelHeight;\n\n      return (\n        <g\n          key={`${multiplicityIndex}_${signalID}_${startX}_${_startX}_${ratio}`}\n        >\n          {/* ratio text */}\n          <text\n            textAnchor=\"middle\"\n            x={scaleX()(_startX) + labelOptions.distance}\n            y={_startYNode + 2 * (levelHeight / 3)}\n            fontSize={labelOptions.fontSize}\n            fill={color}\n            visibility={showLabels ? 'visible' : 'hidden'}\n          >\n            {ratio}\n          </text>\n\n          <line\n            x1={scaleX()(startX)}\n            y1={_startYEdge}\n            x2={scaleX()(_startX)}\n            y2={_startYNode}\n            stroke={color}\n          />\n\n          <line\n            x1={scaleX()(_startX)}\n            y1={_startYNode}\n            x2={scaleX()(_startX)}\n            y2={_startYNode + levelHeight}\n            stroke={color}\n          />\n        </g>\n      );\n    },\n    [\n      signalID,\n      labelOptions.distance,\n      labelOptions.fontSize,\n      scaleX,\n      showLabels,\n      startY,\n      levelHeight,\n    ],\n  );\n\n  return <>{nodesData?.map((node) => buildTreeNodeAndEdge(node))}</>;\n}\n\nexport default TreeNodes;\n","import lodashGet from 'lodash/get';\n\nimport { Signal1D } from '../../../data/types/data1d';\nimport {\n  getMultiplicityNumber,\n  getPascal,\n} from '../../panels/extra/utilities/MultiplicityUtilities';\n\nimport { TREE_LEVEL_COLORS } from './TreeColors';\n\nfunction createTreeNodes(signal: Signal1D, spectrumData) {\n  function buildTreeNodesData(\n    multiplicityIndex,\n    jIndices,\n    treeNodesData,\n    startX,\n  ) {\n    if (!signal.multiplicity) {\n      return null;\n    }\n\n    if (multiplicityIndex >= signal.multiplicity.length) {\n      return treeNodesData;\n    }\n    // re-use colors if needed\n    const color =\n      TREE_LEVEL_COLORS[multiplicityIndex % TREE_LEVEL_COLORS.length];\n\n    const jIndex = jIndices.findIndex(\n      (_jIndex) => _jIndex === multiplicityIndex,\n    );\n    const frequency = lodashGet(spectrumData, 'info.originFrequency', 0);\n\n    const coupling =\n      jIndex >= 0 && frequency > 0 && signal?.js?.[jIndex]\n        ? signal.js[jIndex].coupling / frequency // convert to ppm\n        : null;\n\n    // in case of \"s\": no coupling constant and build one tree node only\n    if (!coupling) {\n      treeNodesData.push({\n        startX,\n        _startX: startX,\n        ratio: 1,\n        multiplicityIndex,\n        color,\n      });\n      // go to next multiplet in multiplicity string\n      buildTreeNodesData(\n        multiplicityIndex + 1,\n        jIndices,\n        treeNodesData,\n        startX,\n      );\n    } else {\n      // in case of other multiplets\n      const multiplicity = signal.multiplicity || '';\n      const pascal = getPascal(\n        getMultiplicityNumber(multiplicity.charAt(multiplicityIndex)),\n        0.5,\n      ); // @TODO for now we use the default spin of 1 / 2 only\n\n      let _startX =\n        pascal.length % 2 === 0\n          ? startX - (pascal.length / 2) * coupling + coupling / 2 // in case of even number of nodes\n          : startX - (pascal.length / 2 - 0.5) * coupling; // in case of odd number of nodes\n\n      pascal.forEach((ratio, k) => {\n        if (k > 0) {\n          _startX += coupling;\n        }\n        treeNodesData.push({\n          startX,\n          _startX,\n          ratio,\n          multiplicityIndex,\n          color,\n        });\n        // go to next multiplet in multiplicity string\n        buildTreeNodesData(\n          multiplicityIndex + 1,\n          jIndices,\n          treeNodesData,\n          _startX,\n        );\n      });\n    }\n\n    return treeNodesData;\n  }\n  return buildTreeNodesData;\n}\n\nexport default createTreeNodes;\n","/** @jsxImportSource @emotion/react */\nimport lodashGet from 'lodash/get';\nimport { useMemo, useState, useEffect, CSSProperties } from 'react';\n\nimport { Signal1D } from '../../../data/types/data1d';\nimport { useAssignment } from '../../assignment/AssignmentsContext';\nimport { useChartData } from '../../context/ChartContext';\nimport { useScaleChecked } from '../../context/ScaleContext';\nimport { HighlightedSource, useHighlight } from '../../highlight';\nimport {\n  hasCouplingConstant,\n  checkMultiplicity,\n} from '../../panels/extra/utilities/MultiplicityUtilities';\nimport { options } from '../../toolbar/ToolTypes';\n\nimport LevelNode from './LevelNode';\nimport StringNode from './StringNode';\nimport TreeNodes from './TreeNodes';\nimport createTreeNodes from './buildTreeNode';\n\nconst styles = {\n  cursor: 'default',\n  opacity: 0.6,\n  strokeWidth: 1,\n};\n\n// export interface SignalNodeProps {\n//   id: string;\n//   delta: number;\n//   multiplicity: string;\n// }\n\ninterface MultiplicityTreeProps {\n  rangeFrom: number;\n  rangeTo: number;\n  signal: Signal1D;\n  labelOptions?: {\n    distance: number;\n    fontSize: CSSProperties['fontSize'];\n  };\n}\n\nfunction extractID(assignment) {\n  return [assignment.id].concat(assignment.assigned?.x || []);\n}\n\nfunction MultiplicityTree({\n  rangeFrom,\n  rangeTo,\n  signal,\n  labelOptions = {\n    distance: 10,\n    fontSize: 11,\n  },\n}: MultiplicityTreeProps) {\n  const { scaleX, scaleY } = useScaleChecked();\n  const {\n    data: spectraData,\n    activeSpectrum,\n    toolOptions: { selectedTool },\n    width,\n  } = useChartData();\n  const assignment = useAssignment(signal.id);\n  const highlight = useHighlight(extractID(assignment), {\n    type: HighlightedSource.SIGNAL,\n    extra: extractID(assignment),\n  });\n\n  const spectrumData = useMemo(\n    () =>\n      // eslint-disable-next-line @typescript-eslint/restrict-template-expressions\n      lodashGet(spectraData, `${activeSpectrum?.index}`, null),\n    [activeSpectrum, spectraData],\n  );\n\n  const [xRange, setXRange] = useState({ x1: signal.delta, x2: signal.delta });\n  const [treeProps, setTreeProps] = useState({\n    width: 0,\n    height: 0,\n    levelHeight: 0,\n  });\n  const [drawInFullRange, setDrawInFullRange] = useState(false);\n  const [showLabels, setShowLabels] = useState(false);\n\n  useEffect(() => {\n    const _drawInFullRange = !checkMultiplicity(signal.multiplicity, ['m']);\n    const _treeWidth = _drawInFullRange\n      ? Math.abs(scaleX()(xRange.x1) - scaleX()(xRange.x2))\n      : Math.abs(scaleX()(xRange.x1) - scaleX()(xRange.x2)) +\n        labelOptions.distance;\n    const _treeHeight = _drawInFullRange ? _treeWidth / 3 : _treeWidth / 2;\n    // +2 because of multiplicity text and start level node before the actual tree starts\n    // 2* for levels between nodes (edges)\n    const length = signal?.multiplicity?.length || 0;\n    const _treeLevelHeight = _drawInFullRange\n      ? _treeHeight / (length + 2)\n      : _treeHeight / (2 * length + 2);\n\n    setTreeProps({\n      width: _treeWidth,\n      height: _treeHeight,\n      levelHeight: _treeLevelHeight,\n    });\n    setDrawInFullRange(_drawInFullRange);\n  }, [\n    labelOptions.distance,\n    scaleX,\n    signal.multiplicity,\n    xRange.x1,\n    xRange.x2,\n  ]);\n\n  useEffect(() => {\n    if (treeProps.width / width >= 0.1) {\n      setShowLabels(true);\n    } else {\n      setShowLabels(false);\n    }\n  }, [treeProps.width, width]);\n\n  const startY = useMemo(() => {\n    let yMax;\n    spectrumData.data.x.forEach((_x, i) => {\n      if (\n        _x >= rangeFrom &&\n        _x <= rangeTo &&\n        (!yMax || spectrumData.data.re[i] > yMax)\n      ) {\n        yMax = spectrumData.data.re[i];\n      }\n    });\n\n    return scaleY(spectrumData.id)(yMax) - treeProps.height - 30;\n  }, [\n    spectrumData.data.x,\n    spectrumData.data.re,\n    spectrumData.id,\n    scaleY,\n    treeProps.height,\n    rangeFrom,\n    rangeTo,\n  ]);\n\n  const treeNodesData = useMemo(() => {\n    if (signal.multiplicity) {\n      const buildTreeNodesData = createTreeNodes(signal, spectrumData);\n      const jIndices = signal.multiplicity\n        .split('')\n        .map((_mult, i) => (hasCouplingConstant(_mult) ? i : undefined))\n        .filter((_i) => _i !== undefined);\n\n      return buildTreeNodesData(0, jIndices, [], signal.delta);\n    }\n    return [];\n  }, [signal, spectrumData]);\n\n  useEffect(() => {\n    if (drawInFullRange) {\n      setXRange({ x1: rangeFrom, x2: rangeTo });\n    } else {\n      const _xRange = { x1: signal.delta, x2: signal.delta };\n      treeNodesData.forEach((_treeNodeData) => {\n        if (_treeNodeData.startX < _xRange.x1) {\n          _xRange.x1 = _treeNodeData.startX;\n        }\n        if (_treeNodeData.startX > _xRange.x2) {\n          _xRange.x2 = _treeNodeData.startX;\n        }\n        if (_treeNodeData._startX < _xRange.x1) {\n          _xRange.x1 = _treeNodeData._startX;\n        }\n        if (_treeNodeData._startX > _xRange.x2) {\n          _xRange.x2 = _treeNodeData._startX;\n        }\n      });\n      setXRange(_xRange);\n    }\n  }, [\n    drawInFullRange,\n    rangeFrom,\n    rangeTo,\n    signal.delta,\n    signal.multiplicity,\n    treeNodesData,\n  ]);\n\n  const multiplicityTree = useMemo(() => {\n    const { levelHeight } = treeProps;\n    // first tree level\n    const firstLevelStartY = startY;\n    let _startY = firstLevelStartY;\n    // second tree level\n    const secondLevelStartY = startY + levelHeight;\n    _startY = secondLevelStartY;\n\n    // third tree level\n    _startY += levelHeight;\n\n    if (drawInFullRange) {\n      const _rangeFrom = scaleX()(rangeFrom);\n      const _rangeTo = scaleX()(rangeTo);\n\n      const pathData = `M ${_rangeFrom} ${\n        _startY + levelHeight\n      } ${_rangeFrom} ${_startY} ${scaleX()(\n        signal.delta,\n      )} ${_startY} ${_rangeTo} ${_startY} ${_rangeTo} ${\n        _startY + levelHeight\n      }`;\n\n      return (\n        <g>\n          <StringNode\n            signal={signal}\n            startY={firstLevelStartY}\n            levelHeight={levelHeight}\n            fontSize={labelOptions.fontSize}\n            showLabels={showLabels}\n          />\n          <LevelNode\n            signal={signal}\n            startY={secondLevelStartY}\n            levelHeight={levelHeight}\n          />\n          <path d={pathData} stroke=\"blue\" fill=\"none\" />\n        </g>\n      );\n    }\n\n    return (\n      <g>\n        <StringNode\n          signal={signal}\n          startY={firstLevelStartY}\n          levelHeight={levelHeight}\n          fontSize={labelOptions.fontSize}\n          showLabels={showLabels}\n        />\n        <LevelNode\n          signal={signal}\n          startY={secondLevelStartY}\n          levelHeight={levelHeight}\n        />\n        <TreeNodes\n          nodesData={treeNodesData}\n          signalID={treeNodesData}\n          showLabels={showLabels}\n          startY={startY}\n          labelOptions={labelOptions}\n          levelHeight={levelHeight}\n        />\n      </g>\n    );\n  }, [\n    treeProps,\n    startY,\n    drawInFullRange,\n    signal,\n    labelOptions,\n    showLabels,\n    treeNodesData,\n    scaleX,\n    rangeFrom,\n    rangeTo,\n  ]);\n\n  return (\n    <g\n      css={\n        highlight.isActive || assignment.isActive\n          ? { ...styles, opacity: 1, strokeWidth: 1.5 }\n          : styles\n      }\n      {...{\n        onMouseEnter: () => {\n          assignment.show('x');\n          highlight.show();\n        },\n        onMouseLeave: () => {\n          assignment.hide();\n          highlight.hide();\n        },\n      }}\n      {...{\n        onClick:\n          selectedTool && selectedTool === options.editRange.id\n            ? () => {\n                return null;\n              }\n            : (e) => {\n                if (e.shiftKey) {\n                  e.stopPropagation();\n                  assignment.setActive('x');\n                }\n              },\n      }}\n    >\n      {multiplicityTree}\n    </g>\n  );\n}\n\nexport default MultiplicityTree;\n","import { memo } from 'react';\n\nimport { useChartData } from '../../context/ChartContext';\n\nimport MultiplicityTree from './MultiplicityTree';\n\ninterface TempMultiplicityTreeInnerProps {\n  range: any;\n}\n\nfunction TempMultiplicityTreeInner({ range }: TempMultiplicityTreeInnerProps) {\n  return (\n    range?.signals &&\n    range.signals.length > 0 &&\n    range.signals.map((signal) => (\n      <MultiplicityTree\n        rangeFrom={range.from}\n        rangeTo={range.to}\n        signal={signal}\n        key={signal.id}\n      />\n    ))\n  );\n}\n\nconst MemoizedTempMultiplicityTree = memo(TempMultiplicityTreeInner);\n\nexport default function TempMultiplicityTree() {\n  const {\n    toolOptions: {\n      data: { tempRange },\n    },\n  } = useChartData();\n\n  return <MemoizedTempMultiplicityTree range={tempRange} />;\n}\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback, useState, useEffect } from 'react';\n\nimport { Signal1D } from '../../../data/types/data1d';\nimport { checkRangeKind } from '../../../data/utilities/RangeUtilities';\nimport {\n  useAssignment,\n  useAssignmentData,\n} from '../../assignment/AssignmentsContext';\nimport { filterForIDsWithAssignment } from '../../assignment/utilities/filterForIDsWithAssignment';\nimport { useDispatch } from '../../context/DispatchContext';\nimport { useScaleChecked } from '../../context/ScaleContext';\nimport Resizer from '../../elements/resizer/Resizer';\nimport { HighlightedSource, useHighlight } from '../../highlight';\nimport { RESIZE_RANGE } from '../../reducer/types/Types';\nimport { options } from '../../toolbar/ToolTypes';\nimport MultiplicityTree from '../multiplicityTree/MultiplicityTree';\nimport TempMultiplicityTree from '../multiplicityTree/TempMultiplicityTree';\n\nconst stylesOnHover = css`\n  pointer-events: bounding-box;\n  @-moz-document url-prefix() {\n    pointer-events: fill;\n  }\n  user-select: 'none';\n  -webkit-user-select: none; /* Chrome all / Safari all */\n  -moz-user-select: none; /* Firefox all */\n\n  .delete-button {\n    visibility: hidden;\n  }\n`;\n\nconst stylesHighlighted = css`\n  pointer-events: bounding-box;\n\n  @-moz-document url-prefix() {\n    pointer-events: fill;\n  }\n  .range-area {\n    height: 100%;\n    fill: #ff6f0057;\n  }\n  .delete-button {\n    visibility: visible;\n    cursor: pointer;\n  }\n`;\n\nexport interface RangeData {\n  id: string;\n  from: number;\n  to: number;\n  integration: number;\n  signals: Signal1D[];\n}\n\ninterface RangeProps {\n  showMultiplicityTrees: boolean;\n  selectedTool: string;\n  rangeData: RangeData;\n  startEditMode: boolean;\n}\n\nfunction Range({\n  rangeData,\n  showMultiplicityTrees,\n  selectedTool,\n  startEditMode,\n}: RangeProps) {\n  const { id, from, to, integration, signals } = rangeData;\n  const assignmentData = useAssignmentData();\n  const assignmentRange = useAssignment(id);\n  const highlightRange = useHighlight(\n    [assignmentRange.id].concat(assignmentRange.assigned?.x || []).concat(\n      filterForIDsWithAssignment(\n        assignmentData,\n        signals.map((_signal) => _signal.id),\n      ),\n    ),\n    { type: HighlightedSource.RANGE, extra: { id } },\n  );\n\n  const { scaleX } = useScaleChecked();\n  const dispatch = useDispatch();\n\n  const [reduceOpacity, setReduceOpacity] = useState(false);\n  const [isBlockedByEditing, setIsBlockedByEditing] = useState(false);\n\n  useEffect(() => {\n    if (selectedTool && selectedTool === options.editRange.id) {\n      setIsBlockedByEditing(true);\n    } else {\n      setIsBlockedByEditing(false);\n    }\n  }, [selectedTool]);\n\n  useEffect(() => {\n    setReduceOpacity(!checkRangeKind(rangeData));\n  }, [rangeData]);\n\n  const handleOnStopResizing = useCallback(\n    (position) => {\n      dispatch({\n        type: RESIZE_RANGE,\n        data: {\n          ...rangeData,\n          from: scaleX().invert(position.x2),\n          to: scaleX().invert(position.x1),\n        },\n      });\n    },\n    [dispatch, rangeData, scaleX],\n  );\n\n  const mouseEnterHandler = useCallback(() => {\n    assignmentRange.show('x');\n    highlightRange.show();\n  }, [assignmentRange, highlightRange]);\n\n  const mouseLeaveHandler = useCallback(() => {\n    assignmentRange.hide();\n    highlightRange.hide();\n  }, [assignmentRange, highlightRange]);\n\n  const assignHandler = useCallback(\n    (e) => {\n      if (\n        selectedTool === options.rangesPicking.id &&\n        e.shiftKey &&\n        !isBlockedByEditing\n      ) {\n        assignmentRange.setActive('x');\n      }\n    },\n    [assignmentRange, isBlockedByEditing, selectedTool],\n  );\n\n  return (\n    <g\n      data-test-id=\"range\"\n      style={{ outline: 'none' }}\n      css={\n        isBlockedByEditing ||\n        highlightRange.isActive ||\n        assignmentRange.isActive\n          ? stylesHighlighted\n          : stylesOnHover\n      }\n      key={id}\n      onMouseEnter={mouseEnterHandler}\n      onMouseLeave={mouseLeaveHandler}\n      onClick={assignHandler}\n    >\n      <Resizer\n        tag=\"svg\"\n        initialPosition={{ x1: scaleX()(to), x2: scaleX()(from) }}\n        onEnd={handleOnStopResizing}\n      >\n        {(x1, x2) => (\n          <g transform={`translate(0,10)`}>\n            <rect\n              data-no-export=\"true\"\n              x=\"0\"\n              width={x2 - x1}\n              height=\"6\"\n              className=\"range-area\"\n              fill=\"green\"\n              fillOpacity={\n                !reduceOpacity ||\n                highlightRange.isActive ||\n                assignmentRange.isActive\n                  ? 1\n                  : 0.4\n              }\n            />\n            <text\n              textAnchor=\"middle\"\n              x={(x2 - x1) / 2}\n              y=\"20\"\n              fontSize=\"10\"\n              fill=\"red\"\n              fillOpacity={\n                !reduceOpacity ||\n                highlightRange.isActive ||\n                assignmentRange.isActive\n                  ? 1\n                  : 0.6\n              }\n            >\n              {integration !== undefined ? integration.toFixed(2) : ''}\n            </text>\n          </g>\n        )}\n      </Resizer>\n\n      {startEditMode ? (\n        <TempMultiplicityTree />\n      ) : (\n        showMultiplicityTrees &&\n        signals &&\n        signals.length > 0 &&\n        signals.map((_signal) => (\n          <MultiplicityTree\n            rangeFrom={from}\n            rangeTo={to}\n            signal={_signal}\n            key={_signal.id}\n          />\n        ))\n      )}\n    </g>\n  );\n}\n\nexport default Range;\n","import useIntegralPath from '../../hooks/useIntegralPath';\n\ninterface IntegralProps {\n  range: { id: string; from: number; to: number; integral?: number };\n}\n\nfunction RangeIntegral({ range }: IntegralProps) {\n  const path = useIntegralPath(range);\n\n  return (\n    <path\n      className=\"line\"\n      stroke=\"black\"\n      strokeWidth=\"1\"\n      fill=\"none\"\n      d={path}\n    />\n  );\n}\n\nexport default RangeIntegral;\n","import { Fragment, memo } from 'react';\n\nimport { Datum1D, Ranges as RangesProps } from '../../../data/types/data1d';\nimport { useChartData } from '../../context/ChartContext';\nimport useSpectrum from '../../hooks/useSpectrum';\n\nimport Range from './Range';\nimport RangeIntegral from './RangeIntegral';\n\ninterface RangesInnerProps {\n  displayerKey: string;\n  selectedTool: string;\n  ranges: RangesProps;\n  editRangeID: string;\n  showMultiplicityTrees: boolean;\n  showRangesIntegrals: boolean;\n}\n\nfunction RangesInner({\n  ranges,\n  displayerKey,\n  selectedTool,\n  editRangeID,\n  showMultiplicityTrees,\n  showRangesIntegrals,\n}: RangesInnerProps) {\n  return (\n    <g clipPath={`url(#${displayerKey}clip-chart-1d)`}>\n      {ranges?.values?.map((range) => (\n        <Fragment key={range.id}>\n          <Range\n            rangeData={range}\n            selectedTool={selectedTool}\n            showMultiplicityTrees={showMultiplicityTrees}\n            startEditMode={\n              editRangeID && editRangeID === range.id ? true : false\n            }\n          />\n          {showRangesIntegrals && <RangeIntegral range={range} />}\n        </Fragment>\n      ))}\n    </g>\n  );\n}\n\nconst MemoizedRanges = memo(RangesInner);\n\nconst empyData = { ranges: {} };\n\nexport default function Ranges() {\n  const {\n    displayerKey,\n    toolOptions: {\n      selectedTool,\n      data: { tempRange, showMultiplicityTrees, showRangesIntegrals },\n    },\n  } = useChartData();\n\n  const { ranges } = useSpectrum(empyData) as Datum1D;\n\n  return (\n    <MemoizedRanges\n      {...{\n        ranges,\n        showMultiplicityTrees,\n        showRangesIntegrals,\n        selectedTool,\n        displayerKey,\n        editRangeID: tempRange?.id || '',\n      }}\n    />\n  );\n}\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback, useMemo } from 'react';\n\nimport { useChartData } from '../../context/ChartContext';\nimport { useDispatch } from '../../context/DispatchContext';\nimport { useScaleChecked } from '../../context/ScaleContext';\nimport DeleteButton from '../../elements/DeleteButton';\nimport { DELETE_BASE_LINE_ZONE } from '../../reducer/types/Types';\n\nconst styles = css`\n  pointer-events: bounding-box;\n  user-select: 'none';\n  -webkit-user-select: none; /* Chrome all / Safari all */\n  -moz-user-select: none; /* Firefox all */\n\n  .zone-area {\n    height: 100%;\n    fill: #b8b8b857;\n    cursor: pointer;\n  }\n  .delete-button {\n    display: none;\n    cursor: pointer;\n  }\n  :hover .delete-button {\n    display: block;\n  }\n`;\n\nfunction BaseLineZones() {\n  const { toolOptions } = useChartData();\n\n  const { scaleX } = useScaleChecked();\n  const dispatch = useDispatch();\n\n  const deleteRangeHandler = useCallback(\n    (id) => {\n      dispatch({ type: DELETE_BASE_LINE_ZONE, id });\n    },\n    [dispatch],\n  );\n\n  const baseLineZones = useMemo(() => {\n    return toolOptions.data.baseLineZones;\n  }, [toolOptions]);\n\n  return (\n    <>\n      {baseLineZones.length > 0 && (\n        <g>\n          {baseLineZones.map((zone) => (\n            <g\n              key={zone.id}\n              transform={`translate(${scaleX()(zone.to)},0)`}\n              css={styles}\n            >\n              <DeleteButton\n                x={-20}\n                y={10}\n                onDelete={() => deleteRangeHandler(zone.id)}\n              />\n              <rect\n                x=\"0\"\n                width={`${scaleX()(zone.from) - scaleX()(zone.to)}`}\n                className=\"zone-area\"\n              />\n            </g>\n          ))}\n        </g>\n      )}\n    </>\n  );\n}\n\nexport default BaseLineZones;\n","import ExclusionZonesAnnotations from './ExclusionZonesAnnotations';\nimport IntegralsSeries from './IntegralsSeries';\nimport LinesSeries from './LinesSeries';\nimport PeakAnnotations from './PeakAnnotations';\nimport ResurrectedDatabaseRanges from './ResurrectedDatabaseRanges';\nimport XAxis from './XAxis';\nimport JGraph from './jCouplingGraph/JGraph';\nimport MultiAnalysisRanges from './multiAnalysis/MultiAnalysisRanges';\nimport Ranges from './ranges/Ranges';\nimport BaseLineZones from './tool/BaseLineZones';\n\nfunction Chart1D({ mode, width, height, margin, displayerKey }) {\n  return (\n    <svg\n      viewBox={`0 0 ${width} ${height}`}\n      width={width}\n      height={height}\n      id=\"nmrSVG\"\n    >\n      <defs>\n        <clipPath id={`${displayerKey}clip-chart-1d`}>\n          <rect\n            width={`${width - margin.left - margin.right}`}\n            height={`${height}`}\n            x={`${margin.left}`}\n            y={`${0}`}\n          />\n        </clipPath>\n      </defs>\n\n      <LinesSeries />\n      <IntegralsSeries />\n      <PeakAnnotations />\n      <Ranges />\n      <JGraph />\n      <MultiAnalysisRanges />\n      <BaseLineZones />\n      <ExclusionZonesAnnotations />\n      <ResurrectedDatabaseRanges />\n\n      <g className=\"container\" style={{ pointerEvents: 'none' }}>\n        <XAxis showGrid mode={mode} />\n      </g>\n    </svg>\n  );\n}\n\nexport default Chart1D;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { xFindClosestIndex } from 'ml-spectra-processing';\nimport { useContext, useCallback, Fragment, memo } from 'react';\nimport { BsCursor } from 'react-icons/bs';\nimport { IoPulseSharp } from 'react-icons/io5';\n\nimport { get1DDataXY } from '../../data/data1d/Spectrum1D/get1DDataXY';\nimport { Datum1D } from '../../data/types/data1d';\nimport { BrushContext } from '../EventsTrackers/BrushTracker';\nimport { MouseContext } from '../EventsTrackers/MouseTracker';\nimport { useChartData } from '../context/ChartContext';\nimport { useScaleChecked } from '../context/ScaleContext';\nimport useSpectrum from '../hooks/useSpectrum';\nimport { ActiveSpectrum } from '../reducer/Reducer';\nimport { useFormatNumberByNucleus } from '../utility/FormatNumber';\n\nconst styles = css`\n  display: flex;\n  flex-firection: row;\n  align-items: center;\n  pointer-events: bounding-box;\n  user-select: 'none';\n  -webkit-user-select: none; /* Chrome all / Safari all */\n  -moz-user-select: none; /* Firefox all */\n  background-color: #f7f7f7;\n  height: 30px;\n  padding: 6px;\n  color: #8d0018;\n  position: absolute;\n  width: 100%;\n  bottom: 0;\n\n  div {\n    margin: 0px 10px;\n    display: inline-block;\n\n    .label {\n      font-size: 12px;\n      color: #4d4d4d;\n      font-weight: bold;\n    }\n    .value {\n      font-weight: bold;\n      font-size: 14px;\n      display: inline-block;\n    }\n    .unit {\n      font-weight: bold;\n      font-size: 10px;\n    }\n    .xvalue {\n      min-width: 50px;\n    }\n    .yvalue {\n      min-width: 80px;\n    }\n  }\n\n  .separator {\n    border-left: 2px solid gray;\n    margin: 0 20px;\n    width: 1px;\n    height: 100%;\n  }\n`;\n\ninterface FooterBannerInnerProps {\n  margin: {\n    top: number;\n    left: number;\n    right: number;\n    bottom: number;\n  };\n  width: number;\n  height: number;\n  activeSpectrum: ActiveSpectrum | null;\n  spectrum: Datum1D;\n  activeTab: string;\n}\n\nfunction FooterBannerInner({\n  margin,\n  width,\n  height,\n  activeSpectrum,\n  spectrum,\n  activeTab,\n}: FooterBannerInnerProps) {\n  let position = useContext(MouseContext);\n  const { startX, endX, step } = useContext(BrushContext);\n  const { scaleX } = useScaleChecked();\n\n  const format = useFormatNumberByNucleus(activeTab);\n\n  const getYValue = useCallback(\n    (xPosition) => {\n      if (spectrum) {\n        const data = get1DDataXY(spectrum);\n        const xIndex = xFindClosestIndex(data.x, scaleX().invert(xPosition));\n        return data.y[xIndex];\n      }\n      return 1;\n    },\n    [spectrum, scaleX],\n  );\n\n  if (\n    !position ||\n    position.y < margin.top ||\n    position.x < margin.left ||\n    position.x > width - margin.right ||\n    position.y > height - margin.bottom\n  ) {\n    return <div css={styles} />;\n  }\n\n  return (\n    <div css={styles}>\n      <BsCursor />\n      <div>\n        <span className=\"label\"> 𝛅: </span>\n        <span className=\"value\">{format(scaleX().invert(position.x))}</span>\n        <span className=\"unit\">ppm</span>\n        {activeSpectrum && spectrum?.info?.originFrequency && (\n          <>\n            <span className=\"value\">\n              &nbsp;(\n              {format(\n                scaleX().invert(position.x) * spectrum?.info?.originFrequency,\n                'hz',\n              )}\n            </span>\n            <span className=\"unit\">Hz</span>\n            <span className=\"value\">) </span>\n          </>\n        )}\n      </div>\n\n      {step === 'brushing' && (\n        <div>\n          <span className=\"label\"> Δppm: </span>\n          <span className=\"value\">\n            {(scaleX().invert(startX) - scaleX().invert(endX)).toPrecision(6)}\n          </span>\n        </div>\n      )}\n\n      {activeSpectrum && (\n        <Fragment>\n          {spectrum?.info?.originFrequency && step === 'brushing' && (\n            <div>\n              <span className=\"label\"> ΔHz: </span>\n              <span className=\"value\">\n                {(\n                  (scaleX().invert(startX) - scaleX().invert(endX)) *\n                  spectrum?.info?.originFrequency\n                ).toPrecision(5)}\n              </span>\n            </div>\n          )}\n          {step === 'brushing' && (\n            <div>\n              <span className=\"label\"> ratio :</span>\n              <span className=\"value\">\n                {(\n                  (getYValue(startX) / (getYValue(endX) || Number.MIN_VALUE)) *\n                  100\n                ).toFixed(2)}\n                %\n              </span>\n            </div>\n          )}\n        </Fragment>\n      )}\n\n      {activeSpectrum && (\n        <Fragment>\n          <div className=\"separator\" />\n          <IoPulseSharp />\n          <div>\n            <span className=\"label\">Intensity: </span>\n            <span className=\"value yvalue\">\n              {format(getYValue(position.x))}\n            </span>\n          </div>\n        </Fragment>\n      )}\n    </div>\n  );\n}\n\nconst MemoizedFooterBanner = memo(FooterBannerInner);\n\nexport default function FooterBanner() {\n  const { margin, width, height, activeSpectrum, activeTab } = useChartData();\n  const spectrum = useSpectrum(null) as Datum1D;\n  return (\n    <MemoizedFooterBanner\n      {...{ margin, width, height, activeSpectrum, spectrum, activeTab }}\n    />\n  );\n}\n","import { xFindClosestIndex } from 'ml-spectra-processing';\nimport { CSSProperties, useContext, useEffect, useMemo, useState } from 'react';\n\nimport { get1DDataXY } from '../../data/data1d/Spectrum1D/get1DDataXY';\nimport { Datum1D } from '../../data/types/data1d';\nimport { MouseContext } from '../EventsTrackers/MouseTracker';\nimport { useChartData } from '../context/ChartContext';\nimport { useScale } from '../context/ScaleContext';\nimport Events from '../utility/Events';\n\nconst styles: Record<\n  'container' | 'value' | 'colorIndicator' | 'name',\n  CSSProperties\n> = {\n  container: {\n    position: 'absolute',\n    left: '10px',\n    top: '10px',\n  },\n  value: {\n    width: '67px',\n    display: 'inline-block',\n    margin: '0 5px',\n    fontSize: '12px',\n  },\n  colorIndicator: {\n    width: '10px',\n    height: '1px',\n    borderBottom: `2px solid`,\n    display: 'inline-block',\n    marginBottom: '3px',\n  },\n  name: {\n    fontSize: '12px',\n  },\n};\n\ninterface YTrackerProps {\n  datum: {\n    x: Array<number>;\n    y: Array<number>;\n  };\n}\n\nfunction YTracker({ datum }: YTrackerProps) {\n  const { scaleX } = useScale();\n  const position = useContext(MouseContext);\n\n  if (!scaleX || !position) {\n    return null;\n  }\n\n  const xIndex = xFindClosestIndex(datum.x, scaleX().invert(position.x));\n\n  return <span style={styles.value}>{datum.y[xIndex]}</span>;\n}\n\nfunction SpectraTracker() {\n  const { data, activeTab, xDomains } = useChartData();\n  const [isVisible, ToggleVisibility] = useState(false);\n\n  useEffect(() => {\n    function handler(flag) {\n      ToggleVisibility(flag);\n    }\n\n    Events.on('showYSpectraTrackers', handler);\n\n    return () => {\n      Events.off('showYSpectraTrackers', handler);\n    };\n  }, []);\n\n  const trackers = useMemo(() => {\n    return (\n      isVisible &&\n      data.map(\n        (spectrum) =>\n          spectrum.display.isVisible &&\n          xDomains[spectrum.id] &&\n          spectrum.info.nucleus === activeTab && (\n            <div style={{ display: 'block' }} key={spectrum.id}>\n              <span\n                style={{\n                  ...styles.colorIndicator,\n                  borderColor: (spectrum as Datum1D).display.color,\n                }}\n              />\n              <YTracker datum={get1DDataXY(spectrum as Datum1D)} />\n              <span style={styles.value}>{spectrum.display.name}</span>\n            </div>\n          ),\n        [],\n      )\n    );\n  }, [activeTab, data, isVisible, xDomains]);\n\n  if (!isVisible) return null;\n\n  return <div style={styles.container}>{trackers}</div>;\n}\n\nexport default SpectraTracker;\n","import max from 'ml-array-max';\nimport { useContext, useEffect, useState } from 'react';\n\nimport { get1DDataXY } from '../../../data/data1d/Spectrum1D/get1DDataXY';\nimport { Datum1D } from '../../../data/types/data1d';\nimport { BrushContext } from '../../EventsTrackers/BrushTracker';\nimport { MouseContext } from '../../EventsTrackers/MouseTracker';\nimport { useChartData } from '../../context/ChartContext';\nimport { useScaleChecked } from '../../context/ScaleContext';\nimport { options } from '../../toolbar/ToolTypes';\nimport getVerticalShift from '../utilities/getVerticalShift';\n\nconst styles = {\n  radius: 10,\n  borderColor: '#1f1f1f',\n  strokeWidth: 1,\n  fillOpacity: 0,\n  SVGPadding: 1,\n};\n\ninterface PeakPosition {\n  x: number;\n  y: number;\n  xIndex: number;\n}\n\nfunction PeakPointer() {\n  const {\n    height,\n    width,\n    margin,\n    activeSpectrum,\n    data,\n    mode,\n    toolOptions: { selectedTool },\n    verticalAlign,\n  } = useChartData();\n  const { scaleX, scaleY } = useScaleChecked();\n\n  let position = useContext(MouseContext);\n  const brushState = useContext(BrushContext);\n  const [closePeakPosition, setPosition] = useState<PeakPosition | null>();\n\n  useEffect(() => {\n    const vShift = activeSpectrum\n      ? getVerticalShift(verticalAlign, {\n          index: activeSpectrum?.index || 1,\n          align: 'center',\n        })\n      : 0;\n\n    const getClosePeak = (xShift, mouseCoordinates) => {\n      if (\n        activeSpectrum &&\n        position &&\n        selectedTool === options.peakPicking.id\n      ) {\n        const range = [\n          scaleX().invert(mouseCoordinates.x - xShift),\n          scaleX().invert(mouseCoordinates.x + xShift),\n        ].sort((a, b) => {\n          return a - b;\n        });\n\n        //get the active sepectrum data by looking for it by id\n        const spectrum = data.find(\n          (d) => d.id === activeSpectrum.id,\n        ) as Datum1D;\n\n        if (!spectrum) throw new Error('Unreachable');\n        const datum = get1DDataXY(spectrum);\n        const maxIndex = datum.x.findIndex((number) => number >= range[1]) - 1;\n        const minIndex = datum.x.findIndex((number) => number >= range[0]);\n\n        const yDataRange = datum.y.slice(minIndex, maxIndex);\n        if (yDataRange && yDataRange.length > 0) {\n          const yValue = max(yDataRange);\n          const xIndex = yDataRange.findIndex((value) => value === yValue);\n          const xValue = datum.x[minIndex + xIndex];\n          return {\n            x: scaleX()(xValue),\n            y: scaleY(activeSpectrum.id)(yValue) - vShift,\n            xIndex: minIndex + xIndex,\n          };\n        }\n      }\n      return null;\n    };\n\n    const candidatePeakPosition = getClosePeak(10, position);\n    setPosition(candidatePeakPosition);\n  }, [\n    activeSpectrum,\n    data,\n    mode,\n    position,\n    scaleX,\n    scaleY,\n    selectedTool,\n    verticalAlign,\n  ]);\n\n  if (\n    selectedTool !== options.peakPicking.id ||\n    !closePeakPosition ||\n    !activeSpectrum ||\n    brushState.step === 'brushing' ||\n    !position ||\n    position.y < margin.top ||\n    position.left < margin.left ||\n    position.x > width - margin.right ||\n    position.y > height - margin.bottom\n  ) {\n    return null;\n  }\n\n  return (\n    <div\n      key=\"peakPointer\"\n      style={{\n        cursor: 'crosshair',\n        transform: `translate(${closePeakPosition.x}px, ${closePeakPosition.y}px)`,\n        transformOrigin: 'top left',\n        position: 'absolute',\n        top: -(styles.radius + styles.SVGPadding),\n        left: -(styles.radius + styles.SVGPadding),\n        pointerEvents: 'none',\n        overflow: 'visible',\n      }}\n    >\n      <svg\n        width={styles.radius * 2 + styles.SVGPadding * 2}\n        height={styles.radius * 2 + styles.SVGPadding * 2}\n      >\n        <circle\n          cx={styles.radius + styles.SVGPadding}\n          cy={styles.radius + styles.SVGPadding}\n          r={styles.radius}\n          stroke={styles.borderColor}\n          strokeWidth={styles.strokeWidth}\n          fillOpacity={styles.fillOpacity}\n        />\n        <line\n          x1={styles.radius + styles.SVGPadding}\n          y1={styles.SVGPadding}\n          x2={styles.radius + styles.SVGPadding}\n          y2={styles.radius * 2 + styles.SVGPadding}\n          stroke={styles.borderColor}\n          strokeWidth={styles.strokeWidth}\n        />\n        <line\n          x1={styles.SVGPadding}\n          y1={styles.radius + styles.SVGPadding}\n          x2={styles.radius * 2 + styles.SVGPadding}\n          y2={styles.radius + styles.SVGPadding}\n          stroke={styles.borderColor}\n          strokeWidth={styles.strokeWidth}\n        />\n      </svg>\n    </div>\n  );\n}\n\nexport default PeakPointer;\n","import { CSSProperties } from 'react';\n\nimport { useChartData } from '../../context/ChartContext';\nimport { useScaleChecked } from '../../context/ScaleContext';\nimport { options } from '../../toolbar/ToolTypes';\n\nconst styles: CSSProperties = {\n  transformOrigin: 'top left',\n  position: 'absolute',\n  top: '0px',\n  left: '0px',\n  width: 1,\n  backgroundColor: 'red',\n};\n\nfunction VerticalIndicator() {\n  const {\n    height,\n    toolOptions: {\n      selectedTool,\n      data: { pivot },\n    },\n  } = useChartData();\n  const { scaleX } = useScaleChecked();\n\n  if (options.phaseCorrection.id !== selectedTool) return null;\n  return (\n    <div\n      style={{\n        ...styles,\n        transform: `translate(${scaleX()(pivot.value)}px, 0px)`,\n        height: height,\n      }}\n    />\n  );\n}\n\nexport default VerticalIndicator;\n","import { useContext, useCallback, useMemo, CSSProperties } from 'react';\n\nimport { Datum1D } from '../../../data/types/data1d';\nimport { BrushContext } from '../../EventsTrackers/BrushTracker';\nimport { MouseContext } from '../../EventsTrackers/MouseTracker';\nimport { useChartData } from '../../context/ChartContext';\nimport { useScaleChecked } from '../../context/ScaleContext';\nimport { useFormatNumberByNucleus } from '../../utility/FormatNumber';\n\nconst style: CSSProperties = {\n  cursor: 'crosshair',\n  transformOrigin: 'bottom right',\n  position: 'absolute',\n  top: '-18px',\n  left: '-30px',\n  pointerEvents: 'none',\n  overflow: 'visible',\n  userSelect: 'none',\n};\n\nfunction XLabelPointer() {\n  const { height, width, margin, data, activeSpectrum } = useChartData();\n  const { scaleX } = useScaleChecked();\n\n  const position = useContext(MouseContext);\n  const brushState = useContext(BrushContext);\n  const activeSpectrumData = useMemo(() => {\n    const spectrumData = activeSpectrum\n      ? data.find((d) => d.id === activeSpectrum.id)\n      : null;\n    return spectrumData;\n  }, [activeSpectrum, data]);\n\n  const format = useFormatNumberByNucleus(\n    (activeSpectrumData as Datum1D)?.info.nucleus,\n  );\n\n  const getXValue = useCallback(\n    (xVal) => {\n      if (activeSpectrumData) {\n        const xInvert = scaleX().invert(xVal);\n        return format(xInvert);\n      }\n    },\n    [activeSpectrumData, format, scaleX],\n  );\n\n  if (\n    !activeSpectrum ||\n    brushState.step === 'brushing' ||\n    !position ||\n    position.y < margin.top ||\n    position.x < margin.left ||\n    position.x > width - margin.right ||\n    position.y > height - margin.bottom\n  ) {\n    return null;\n  }\n  return (\n    <div\n      key=\"xLabelPointer\"\n      style={{\n        ...style,\n        transform: `translate(${position.x}px, ${position.y}px)`,\n      }}\n    >\n      <span>{getXValue(position.x)}</span>\n    </div>\n  );\n}\n\nexport default XLabelPointer;\n","import { xGetFromToIndex } from 'ml-spectra-processing';\nimport { useCallback, useEffect, useReducer, ReactNode } from 'react';\nimport { ResponsiveChart } from 'react-d3-utils';\n\nimport { MAX_LENGTH } from '../../data/data1d/Spectrum1D/ranges/detectSignal';\nimport { Datum1D } from '../../data/types/data1d';\nimport { ViewerResponsiveWrapper } from '../2d/Viewer2D';\nimport { BrushTracker } from '../EventsTrackers/BrushTracker';\nimport { MouseTracker } from '../EventsTrackers/MouseTracker';\nimport { useChartData } from '../context/ChartContext';\nimport { useDispatch } from '../context/DispatchContext';\nimport { usePreferences } from '../context/PreferencesContext';\nimport { ScaleProvider } from '../context/ScaleContext';\nimport { useAlert } from '../elements/popup/Alert';\nimport { useModal } from '../elements/popup/Modal';\nimport Spinner from '../loader/Spinner';\nimport MultipletAnalysisModal from '../modal/MultipletAnalysisModal';\nimport { ZoomType } from '../reducer/helper/Zoom1DManager';\nimport getRange from '../reducer/helper/getRange';\nimport scaleReducer, {\n  scaleInitialState,\n  SET_SCALE,\n} from '../reducer/scaleReducer';\nimport {\n  ADD_INTEGRAL,\n  ADD_PEAKS,\n  ADD_BASE_LINE_ZONE,\n  BRUSH_END,\n  FULL_ZOOM_OUT,\n  SET_ZOOM,\n  ADD_PEAK,\n  SET_VERTICAL_INDICATOR_X_POSITION,\n  ADD_RANGE,\n  ANALYZE_SPECTRA,\n  ADD_EXCLUSION_ZONE,\n} from '../reducer/types/Types';\nimport BrushXY, { BRUSH_TYPE } from '../tool/BrushXY';\nimport CrossLinePointer from '../tool/CrossLinePointer';\nimport { options } from '../toolbar/ToolTypes';\nimport Events from '../utility/Events';\n\nimport Chart1D from './Chart1D';\nimport FooterBanner from './FooterBanner';\nimport SpectraTracker from './SpectraTracker';\nimport PeakPointer from './tool/PeakPointer';\nimport VerticalIndicator from './tool/VerticalIndicator';\nimport XLabelPointer from './tool/XLabelPointer';\n\ninterface Viewer1DProps {\n  emptyText?: ReactNode;\n}\n\nfunction Viewer1D({ emptyText = undefined }: Viewer1DProps) {\n  const {\n    current: {\n      display: { general },\n    },\n  } = usePreferences();\n  const state = useChartData();\n\n  const {\n    toolOptions: { selectedTool },\n    isLoading,\n    data,\n    mode,\n    width: widthProp,\n    height: heightProp,\n    margin,\n    activeSpectrum,\n    xDomain,\n    xDomains,\n    yDomain,\n    yDomains,\n    verticalAlign,\n    displayerKey,\n  } = state;\n\n  const dispatch = useDispatch();\n  const modal = useModal();\n  const alert = useAlert();\n\n  const [scaleState, dispatchScale] = useReducer(\n    scaleReducer,\n    scaleInitialState,\n  );\n\n  useEffect(() => {\n    if (xDomain.length > 0 && yDomain.length > 0 && widthProp && heightProp) {\n      dispatchScale({\n        type: SET_SCALE,\n        payload: {\n          yDomain,\n          yDomains,\n          xDomain,\n          xDomains,\n          margin,\n          height: heightProp,\n          width: widthProp,\n          verticalAlign,\n          mode,\n        },\n      });\n    }\n  }, [\n    heightProp,\n    margin,\n    mode,\n    verticalAlign,\n    widthProp,\n    xDomain,\n    xDomains,\n    yDomain,\n    yDomains,\n  ]);\n\n  const handelBrushEnd = useCallback(\n    (brushData) => {\n      const propagateEvent = () => {\n        if (!scaleState.scaleX || !scaleState.scaleY) return;\n\n        const { startX, endX } = brushData;\n        const startXPPM = scaleState.scaleX().invert(startX);\n        const endXPPM = scaleState.scaleX().invert(endX);\n        Events.emit('brushEnd', {\n          ...brushData,\n          range: [startXPPM, endXPPM].sort((a, b) => a - b),\n        });\n      };\n\n      if (brushData.altKey) {\n        switch (selectedTool) {\n          case options.rangesPicking.id: {\n            if (!general?.disableMultipletAnalysis) {\n              modal.show(\n                <MultipletAnalysisModal\n                  data={data}\n                  activeSpectrum={activeSpectrum}\n                  scaleX={scaleState.scaleX}\n                  {...brushData}\n                />,\n                {\n                  onClose: () => {\n                    modal.close();\n                  },\n                },\n              );\n            }\n            break;\n          }\n          default:\n            break;\n        }\n      } else if (brushData.shiftKey) {\n        switch (selectedTool) {\n          case options.integral.id:\n            dispatch({\n              type: ADD_INTEGRAL,\n              ...brushData,\n            });\n            break;\n          case options.rangesPicking.id: {\n            const [from, to] = getRange(state, {\n              startX: brushData.startX,\n              endX: brushData.endX,\n            });\n\n            if (!activeSpectrum) break;\n\n            const {\n              data: { x },\n            } = state.data[activeSpectrum.index] as Datum1D;\n\n            const { fromIndex, toIndex } = xGetFromToIndex(x, { from, to });\n\n            if (toIndex - fromIndex <= MAX_LENGTH) {\n              dispatch({\n                type: ADD_RANGE,\n                payload: {\n                  ...brushData,\n                },\n              });\n            } else {\n              alert.error(\n                `Advanced peak picking only available for area up to ${MAX_LENGTH} points`,\n              );\n            }\n\n            break;\n          }\n          case options.multipleSpectraAnalysis.id:\n            dispatch({\n              type: ANALYZE_SPECTRA,\n              ...brushData,\n            });\n            break;\n\n          case options.peakPicking.id:\n            dispatch({\n              type: ADD_PEAKS,\n              ...brushData,\n            });\n            break;\n\n          case options.baseLineCorrection.id:\n            dispatch({\n              type: ADD_BASE_LINE_ZONE,\n              zone: { from: brushData.startX, to: brushData.endX },\n            });\n            break;\n\n          case options.exclusionZones.id:\n            dispatch({\n              type: ADD_EXCLUSION_ZONE,\n              payload: { from: brushData.startX, to: brushData.endX },\n            });\n            break;\n\n          default:\n            propagateEvent();\n            break;\n        }\n      } else {\n        switch (selectedTool) {\n          default:\n            if (selectedTool != null) {\n              dispatch({ type: BRUSH_END, ...brushData });\n            }\n            break;\n        }\n      }\n    },\n    [\n      scaleState,\n      selectedTool,\n      general?.disableMultipletAnalysis,\n      modal,\n      data,\n      activeSpectrum,\n      dispatch,\n      state,\n      alert,\n    ],\n  );\n\n  const handelOnDoubleClick = useCallback(() => {\n    dispatch({ type: FULL_ZOOM_OUT, zoomType: ZoomType.STEP_HORIZONTAL });\n  }, [dispatch]);\n\n  const handleZoom = useCallback(\n    (event) => {\n      dispatch({ type: SET_ZOOM, event, selectedTool });\n    },\n    [dispatch, selectedTool],\n  );\n\n  const mouseClick = useCallback(\n    (position) => {\n      const propagateEvent = () => {\n        if (!scaleState.scaleX) return;\n\n        const xPPM = scaleState.scaleX().invert(position.x);\n        Events.emit('mouseClick', {\n          ...position,\n          xPPM,\n        });\n      };\n\n      if (position.shiftKey) {\n        switch (selectedTool) {\n          case options.peakPicking.id:\n            dispatch({\n              type: ADD_PEAK,\n              mouseCoordinates: position,\n            });\n            break;\n          case options.editRange.id:\n            propagateEvent();\n            break;\n          default:\n            break;\n        }\n      } else {\n        switch (selectedTool) {\n          case options.phaseCorrection.id:\n            dispatch({\n              type: SET_VERTICAL_INDICATOR_X_POSITION,\n              position: position.x,\n            });\n            break;\n\n          default:\n        }\n      }\n    },\n    [dispatch, scaleState, selectedTool],\n  );\n\n  return (\n    <ScaleProvider value={scaleState}>\n      <ResponsiveChart>\n        {({ height, width }) => (\n          <ViewerResponsiveWrapper height={height} width={width}>\n            <div style={{ height: '100%', position: 'relative' }}>\n              <Spinner isLoading={isLoading} emptyText={emptyText} />\n\n              {scaleState.scaleX &&\n                scaleState.scaleY &&\n                data &&\n                data.length > 0 && (\n                  <BrushTracker\n                    onBrush={handelBrushEnd}\n                    onDoubleClick={handelOnDoubleClick}\n                    onClick={mouseClick}\n                    onZoom={handleZoom}\n                    style={{\n                      width: '100%',\n                      height: '100%',\n                      margin: 'auto',\n                      position: 'relative',\n                      overflow: 'hidden',\n                    }}\n                  >\n                    <MouseTracker\n                      style={{\n                        width: '100%',\n                        height: `100%`,\n                        position: 'absolute',\n                      }}\n                    >\n                      <SpectraTracker />\n                      <CrossLinePointer />\n                      <BrushXY brushType={BRUSH_TYPE.X} />\n                      <XLabelPointer />\n                      <PeakPointer />\n                      <VerticalIndicator />\n                      <FooterBanner />\n                      <Chart1D\n                        width={widthProp}\n                        height={heightProp}\n                        margin={margin}\n                        mode={mode}\n                        displayerKey={displayerKey}\n                      />\n                    </MouseTracker>\n                  </BrushTracker>\n                )}\n            </div>\n          </ViewerResponsiveWrapper>\n        )}\n      </ResponsiveChart>\n    </ScaleProvider>\n  );\n}\n\nexport default Viewer1D;\n","import { CSSProperties } from 'react';\nimport { FallbackProps } from 'react-error-boundary';\n\ntype RecordKey = 'container' | 'header' | 'title' | 'body';\n\nconst styles: Record<RecordKey, CSSProperties> = {\n  container: {\n    margin: '25px',\n  },\n\n  header: {\n    backgroundColor: '#ffffff',\n    padding: '20px',\n    borderRadius: '10px',\n    fontSize: '30px',\n    textAlign: 'center',\n  },\n\n  title: {\n    textDecoration: 'underline',\n  },\n\n  body: {\n    marginTop: '10px',\n    whiteSpace: 'pre-wrap',\n    backgroundColor: 'white',\n    padding: '20px',\n    borderRadius: '10px',\n    color: 'red',\n  },\n};\n\nexport default function ErrorOverlay(props: FallbackProps) {\n  return (\n    <div style={styles.container}>\n      <p style={styles.header}>Something went wrong.</p>\n      <details style={styles.body}>\n        <p style={styles.title}>{props.error.message}</p>\n        {props.error.stack}\n      </details>\n    </div>\n  );\n}\n","/** @jsxImportSource @emotion/react */\nimport { css, CSSObject, SerializedStyles } from '@emotion/react';\nimport {\n  ReactNode,\n  ButtonHTMLAttributes,\n  CSSProperties,\n  MouseEvent,\n} from 'react';\n\ntype Size = 'xSmall' | 'small' | 'medium' | 'large';\n\ntype Color = CSSProperties['color'];\n\ninterface BaseColor {\n  base: Color;\n  hover: Color;\n  active?: Color;\n}\n\ntype Fill = 'clear' | 'outline' | 'solid';\n\ntype ColorTheme = 'success' | 'danger' | 'warning' | 'medium' | 'light';\n\ntype ColorPalettes = Record<\n  ColorTheme,\n  {\n    base: Color;\n    shade: Color;\n    tint: Color;\n  }\n>;\n\nconst colorPalettes: ColorPalettes = {\n  success: {\n    base: '#2dd36f',\n    shade: '#28ba62',\n    tint: '#42d77d',\n  },\n  danger: {\n    base: '#eb445a',\n    shade: '#cf3c4f',\n    tint: '#ed576b',\n  },\n  warning: {\n    base: '#ffc409',\n    shade: '#e0ac08',\n    tint: '#ffca22',\n  },\n  medium: {\n    base: '#92949c',\n    shade: '#808289',\n    tint: '#9d9fa6',\n  },\n  light: {\n    base: '#f4f5f8',\n    shade: '#d7d8da',\n    tint: '#f5f6f9',\n  },\n};\n\nconst sizeConfig: Record<\n  Size,\n  Pick<CSSProperties, 'fontSize' | 'padding' | 'borderRadius'>\n> = {\n  xSmall: {\n    fontSize: '0.75rem',\n    padding: '0.15rem 0.3rem',\n    borderRadius: '0.15rem',\n  },\n  small: {\n    fontSize: '0.8rem',\n    padding: '0.25rem 0.5rem',\n    borderRadius: '0.2rem',\n  },\n  medium: {\n    fontSize: '1rem',\n    padding: '0.375rem 0.75rem',\n    borderRadius: '0.25rem',\n  },\n  large: {\n    fontSize: '1.25rem',\n    padding: '0.5rem 1rem',\n    borderRadius: '0.3rem',\n  },\n};\n\ninterface ButtonStyle {\n  color: BaseColor;\n  size: Size;\n  borderColor: Color;\n  backgroundColor: BaseColor;\n  borderRadius?: CSSProperties['borderRadius'];\n  fill?: Fill;\n  style?: CSSObject;\n}\n\ninterface Style {\n  button: (props: ButtonStyle) => SerializedStyles;\n}\n\nfunction getFillStyle(props: ButtonStyle) {\n  const { borderColor, fill, backgroundColor, color } = props;\n\n  switch (fill) {\n    case 'solid': {\n      return css`\n        border-color: transparent;\n        background-color: ${backgroundColor.base};\n        color: ${color.hover};\n      `;\n    }\n    case 'outline': {\n      return css`\n        border-style: solid;\n        border-color: ${backgroundColor.base};\n        background-color: transparent;\n        color: ${color.base};\n      `;\n    }\n\n    case 'clear': {\n      return css`\n        border-color: transparent;\n        background-color: transparent;\n        color: ${color.base};\n      `;\n    }\n    default:\n      return css`\n        background-color: ${backgroundColor.base};\n        color: ${color.base};\n        border-color: ${borderColor};\n      `;\n  }\n}\n\nconst styles: Style = {\n  button: (props) => {\n    const { size, backgroundColor, color, borderRadius } = props;\n\n    const basic = css`\n      display: flex;\n      flex-direction: row;\n      border-width: 1px;\n      align-items: center;\n    `;\n\n    const fillStyle = getFillStyle(props);\n\n    const colorStyle = css`\n      &:not([disabled]):hover {\n        background-color: ${backgroundColor.hover};\n        color: ${color.hover};\n      }\n      &:not([disabled]):active {\n        background-color: ${backgroundColor?.active || backgroundColor.hover};\n        color: ${color?.active || color.hover};\n      }\n\n      &:disabled {\n        opacity: 0.25;\n      }\n    `;\n    return css([\n      basic,\n      sizeConfig[size],\n      fillStyle,\n      colorStyle,\n      { borderRadius },\n    ]);\n  },\n};\n\ninterface ButtonProps\n  extends Partial<ButtonStyle>,\n    Omit<ButtonHTMLAttributes<HTMLButtonElement>, 'color' | 'style'> {\n  onClick?: (event?: MouseEvent<HTMLButtonElement>) => void;\n  children: ReactNode;\n}\n\nconst Button = (props: ButtonProps) => {\n  const {\n    onClick,\n    size = 'small',\n    color = { base: 'black', hover: 'white' },\n    backgroundColor = { base: 'white', hover: 'black', active: 'black' },\n    borderColor = 'transparent',\n    fill,\n    borderRadius,\n    style = {},\n    ...restProps\n  } = props;\n\n  return (\n    <button\n      type=\"button\"\n      onClick={onClick}\n      css={[\n        styles.button({\n          size,\n          backgroundColor,\n          color,\n          borderColor,\n          fill,\n          borderRadius,\n        }),\n        style,\n      ]}\n      {...restProps}\n    >\n      <span style={{ flex: 1 }}> {props.children}</span>\n    </button>\n  );\n};\n\nfunction ThemeButton(props: { colorTheme: ColorTheme } & ButtonProps) {\n  const { base, shade, tint } = colorPalettes[props.colorTheme];\n\n  const {\n    color = { base: shade, hover: 'white' },\n    backgroundColor = {\n      base: base,\n      hover: shade,\n      active: tint,\n    },\n    fill = 'solid',\n    ...restProps\n  } = props;\n  return <Button {...{ fill, ...restProps, backgroundColor, color }} />;\n}\n\nButton.Done = (props: ButtonProps) => {\n  return <ThemeButton {...props} colorTheme=\"success\" />;\n};\nButton.Danger = (props: ButtonProps) => {\n  return <ThemeButton {...props} colorTheme=\"danger\" />;\n};\nButton.Action = (props: ButtonProps) => {\n  return <ThemeButton {...props} colorTheme=\"medium\" />;\n};\n\nexport default Button;\n","import { CSSProperties, MouseEvent } from 'react';\n\nimport Button from './Button';\n\ninterface ActionButtonsProps {\n  onDone: (event?: MouseEvent) => void;\n  onCancel: (event?: MouseEvent) => void;\n  doneLabel?: string;\n  cancelLabel?: string;\n  style?: CSSProperties;\n}\n\nexport default function ActionButtons(props: ActionButtonsProps) {\n  const {\n    onDone,\n    onCancel,\n    doneLabel = 'Apply',\n    cancelLabel = 'Cancel',\n    style = {},\n  } = props;\n  return (\n    <div style={{ margin: '0 10px', display: 'flex', ...style }}>\n      <Button.Done\n        onClick={onDone}\n        style={\n          style?.flexDirection === 'row-reverse'\n            ? {\n                marginLeft: '10px',\n              }\n            : {}\n        }\n      >\n        {doneLabel}\n      </Button.Done>\n      <Button.Danger\n        fill=\"outline\"\n        onClick={onCancel}\n        style={\n          !style.flexDirection || style.flexDirection === 'row'\n            ? {\n                marginLeft: '10px',\n              }\n            : {}\n        }\n      >\n        {cancelLabel}\n      </Button.Danger>\n    </div>\n  );\n}\n","import {\n  useState,\n  useCallback,\n  ChangeEvent,\n  forwardRef,\n  ForwardedRef,\n  CSSProperties,\n} from 'react';\n\nexport interface CheckBoxProps {\n  onChange?: (value: ChangeEvent<HTMLInputElement>) => void;\n  name?: string;\n  disabled?: boolean;\n  checked?: boolean;\n  style?: CSSProperties;\n}\n\nconst CheckBox = forwardRef(\n  (props: CheckBoxProps, ref: ForwardedRef<HTMLInputElement>) => {\n    const {\n      checked: checkProps = false,\n      disabled = false,\n      name = '',\n      onChange = () => null,\n      style = {},\n    } = props;\n\n    const [checked, setCheck] = useState<boolean>(checkProps);\n\n    const handleCheck = useCallback(\n      (e) => {\n        setCheck(!checked);\n        onChange(e);\n      },\n      [checked, onChange],\n    );\n\n    return (\n      <input\n        ref={ref}\n        type=\"checkbox\"\n        name={name}\n        id={name}\n        onChange={handleCheck}\n        defaultChecked={checkProps}\n        disabled={disabled}\n        style={style}\n      />\n    );\n  },\n);\n\nexport default CheckBox;\n","import { useFormikContext } from 'formik';\nimport lodashGet from 'lodash/get';\nimport { CSSProperties, useCallback } from 'react';\n\nimport CheckBox, { CheckBoxProps } from '../CheckBox';\n\ninterface FormikCheckBoxProps extends Omit<CheckBoxProps, 'style'> {\n  name: string;\n  label?: string;\n  className?: string;\n  reverse?: boolean;\n  style?: {\n    container?: CSSProperties;\n    label?: CSSProperties;\n    checkbox?: CSSProperties;\n  };\n}\n\nfunction FormikCheckBox(props: FormikCheckBoxProps) {\n  const {\n    label,\n    name,\n    onChange = () => null,\n    className = 'checkbox',\n    reverse = false,\n    style = { container: {}, label: {}, checkbox: {} },\n    ...resProps\n  } = props;\n\n  const { values, setFieldValue } = useFormikContext();\n  const value = reverse ? !lodashGet(values, name) : lodashGet(values, name);\n\n  const changeHandler = useCallback(\n    (e: React.ChangeEvent<HTMLInputElement>) => {\n      e.persist();\n      onChange(e);\n      setFieldValue(name, reverse ? value : !value);\n    },\n    [name, onChange, reverse, setFieldValue, value],\n  );\n\n  return (\n    <div\n      className={`${className} check-${value}`}\n      style={style.container ? style.container : {}}\n    >\n      {label && (\n        <label\n          htmlFor={name}\n          className=\"checkbox-label\"\n          style={style.label ? style.label : {}}\n        >\n          {label}\n        </label>\n      )}\n      <CheckBox\n        {...resProps}\n        name={name}\n        checked={value}\n        onChange={changeHandler}\n        style={style.checkbox ? style.checkbox : {}}\n      />\n    </div>\n  );\n}\n\nexport default FormikCheckBox;\n","import { Formik, FormikHelpers, FormikProps } from 'formik';\nimport { ForwardedRef, forwardRef, ReactNode } from 'react';\n\ninterface FormikFormProps {\n  initialValues?: any;\n  onSubmit?: (values: any, helpers: FormikHelpers<any>) => void;\n  validationSchema?: any;\n  children?: Array<ReactNode> | ReactNode;\n}\n\nconst FormikForm = forwardRef(\n  (props: FormikFormProps, ref: ForwardedRef<FormikProps<any>>) => {\n    const {\n      onSubmit = () => null,\n      initialValues = {},\n      validationSchema = null,\n    } = props;\n\n    return (\n      <Formik\n        innerRef={ref}\n        initialValues={initialValues}\n        onSubmit={onSubmit}\n        validationSchema={validationSchema}\n      >\n        <>{props.children}</>\n      </Formik>\n    );\n  },\n);\n\nexport default FormikForm;\n","import { LegacyRef, MutableRefObject, useEffect, useRef } from 'react';\n\nexport default function useCombinedRefs(\n  refs: Array<MutableRefObject<any> | LegacyRef<any>>,\n) {\n  const targetRef = useRef<any>();\n\n  useEffect(() => {\n    refs.forEach((ref) => {\n      if (!ref) return;\n      if (typeof ref === 'function') {\n        ref(targetRef.current);\n      } else {\n        (ref as MutableRefObject<any>).current = targetRef.current;\n      }\n    });\n  }, [refs]);\n\n  return targetRef;\n}\n","import debounce from 'lodash/debounce';\nimport {\n  useState,\n  useEffect,\n  useCallback,\n  useRef,\n  CSSProperties,\n  forwardRef,\n  ForwardedRef,\n  ReactElement,\n} from 'react';\n\nimport useCombinedRefs from '../hooks/useCombinedRefs';\n\nconst styles: Record<\n  'label' | 'input' | 'inputWrapper' | 'clearButton',\n  CSSProperties\n> = {\n  label: {\n    lineHeight: 2,\n    userSelect: 'none',\n  },\n\n  inputWrapper: {\n    height: '100%',\n    width: '100px',\n    borderRadius: '5px',\n    borderWidth: '0.55px',\n    borderColor: '#c7c7c7',\n    borderStyle: 'solid',\n    display: 'flex',\n    flexDirection: 'row',\n    alignItems: 'center',\n    overflow: 'hidden',\n  },\n  input: {\n    outline: 'none',\n    flex: 1,\n    height: '100%',\n    textAlign: 'center',\n    width: '100%',\n  },\n  clearButton: {\n    height: 'calc(100% - 4px)',\n    borderRadius: '50%',\n    backgroundColor: 'gray',\n    color: 'white',\n    aspectRatio: '1',\n    fontSize: '60%',\n    padding: 0,\n  },\n};\n\nexport interface InputProps\n  extends Omit<React.InputHTMLAttributes<HTMLInputElement>, 'style'> {\n  style?: {\n    input?: CSSProperties;\n    inputWrapper?: CSSProperties;\n  };\n  enableAutoSelect?: boolean;\n  debounceTime?: number;\n  checkValue?: (element: number | string) => boolean;\n  format?: () => (element: string) => number | string;\n  renderIcon?: (() => ReactElement) | null;\n  canClear?: boolean;\n  onClear?: () => void;\n}\n\nconst Input = forwardRef(\n  (\n    {\n      value = '',\n      name,\n      style = {\n        input: {},\n        inputWrapper: {},\n      },\n      onChange = () => null,\n      debounceTime = 0,\n      onKeyDown = () => null,\n      checkValue = () => true,\n      type = 'text',\n      enableAutoSelect = false,\n      className,\n      format = () => (value) => value,\n      onBlur = () => null,\n      onFocus = () => null,\n      renderIcon = null,\n      canClear = false,\n      onClear,\n      ...props\n    }: InputProps,\n    ref: ForwardedRef<HTMLInputElement>,\n  ) => {\n    const [val, setVal] = useState(value);\n    const localRef = useRef<any>();\n    const combinedRef = useCombinedRefs([ref, localRef]);\n\n    const debounceOnChange = useRef(\n      debounce((value) => {\n        onChange(value);\n      }, debounceTime),\n    ).current;\n\n    useEffect(() => {\n      setVal(value);\n    }, [value]);\n\n    useEffect(() => {\n      if (enableAutoSelect) {\n        combinedRef?.current?.select();\n      }\n    }, [enableAutoSelect, combinedRef]);\n\n    const getValue = useCallback(\n      (value) => {\n        const formatValue = format();\n        return formatValue(\n          type === 'number'\n            ? String(value).trim() === '-'\n              ? Number(0)\n              : Number(value)\n            : value,\n        );\n      },\n      [format, type],\n    );\n\n    const onChangeHandler = useCallback(\n      (e) => {\n        e.persist();\n        e.stopPropagation();\n        e.preventDefault();\n        function check(value) {\n          if (type === 'number') {\n            const pattern = /^(?:-?[0-9]*|[0-9]\\d*)(?:\\.\\d{0,20})?$/;\n            if (value.trim() === '' || pattern.test(value)) {\n              return true;\n            }\n            return false;\n          }\n          return true;\n        }\n\n        const _value: string = e.target.value;\n        if (check(_value) && checkValue(_value)) {\n          const formatValue = format();\n\n          setVal(formatValue(_value));\n\n          const val = {\n            ...e,\n            target: { name: e.target.name, value: getValue(_value) },\n          };\n\n          if (debounceTime) {\n            debounceOnChange(val);\n          } else {\n            onChange(val);\n          }\n        }\n      },\n      [\n        checkValue,\n        debounceOnChange,\n        debounceTime,\n        format,\n        getValue,\n        onChange,\n        type,\n      ],\n    );\n\n    const handleKeyDown = useCallback(\n      (event) => {\n        event.persist();\n        onKeyDown({\n          ...event,\n          target: { name: event.target.name, value: getValue(val) },\n        });\n      },\n      [getValue, onKeyDown, val],\n    );\n    const preventPropagate = useCallback((event) => {\n      event.stopPropagation();\n    }, []);\n\n    const clearHandler = useCallback(() => {\n      setVal('');\n      onClear?.();\n    }, [onClear]);\n\n    return (\n      <div\n        style={{\n          ...styles.inputWrapper,\n          ...(style?.inputWrapper ? style.inputWrapper : {}),\n        }}\n        className={`input ${className || ''}`}\n      >\n        {renderIcon?.()}\n        <input\n          {...props}\n          ref={combinedRef}\n          name={name}\n          style={{\n            ...styles.input,\n            ...(style?.input ? style.input : {}),\n          }}\n          data-test-id={name ? `input-${name}` : ''}\n          type=\"text\"\n          value={val}\n          onChange={onChangeHandler}\n          onKeyDown={handleKeyDown}\n          onKeyPress={preventPropagate}\n          onDoubleClick={(e) => e.stopPropagation()}\n          onFocus={onFocus}\n          onBlur={onBlur}\n        />\n        {canClear && val && (\n          <button\n            type=\"button\"\n            style={styles.clearButton}\n            onClick={clearHandler}\n          >\n            <span style={{ display: 'block', margin: '0 auto' }}>&#10005;</span>\n          </button>\n        )}\n      </div>\n    );\n  },\n);\n\nexport default Input;\n","import { useFormikContext } from 'formik';\nimport lodashGet from 'lodash/get';\nimport { useCallback, useEffect, useMemo } from 'react';\n\nimport Input, { InputProps } from '../Input';\n\ninterface FormikInputProps extends InputProps {\n  name: string;\n  checkErrorAfterInputTouched?: boolean;\n}\n\nfunction FormikInput(props: FormikInputProps) {\n  const {\n    name,\n    style = { label: {}, input: {} },\n    onChange = () => null,\n    checkValue = () => true,\n    type = 'text',\n    className = '',\n    value = null,\n    format = () => (value) => value,\n    checkErrorAfterInputTouched = true,\n    ...resProps\n  } = props;\n\n  const { values, handleChange, setFieldValue, errors, touched } =\n    useFormikContext();\n\n  const changeHandler = useCallback(\n    (e) => {\n      onChange(e);\n      handleChange(e);\n    },\n    [handleChange, onChange],\n  );\n\n  useEffect(() => {\n    if (value) {\n      setFieldValue(name, value);\n    }\n  }, [name, setFieldValue, value]);\n\n  const isInvalid = useMemo(() => {\n    if (checkErrorAfterInputTouched) {\n      return lodashGet(errors, name) && lodashGet(touched, name);\n    }\n    return lodashGet(errors, name);\n  }, [checkErrorAfterInputTouched, errors, name, touched]);\n\n  return (\n    <Input\n      name={name}\n      value={value ? value : lodashGet(values, name)}\n      onChange={changeHandler}\n      type={type}\n      style={{\n        ...style,\n        inputWrapper: {\n          ...style.input,\n          ...(isInvalid && { borderColor: 'red', outline: 'none' }),\n        },\n      }}\n      checkValue={checkValue}\n      className={className}\n      format={format}\n      {...resProps}\n    />\n  );\n}\n\nexport default FormikInput;\n","import { css } from '@emotion/react';\n\nexport const ModalStyles = css`\n  overflow: auto;\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n\n  .header {\n    text-align: center;\n    padding: 10px 0 10px 0px;\n    margin: 0px;\n    color: #005d9e;\n    place-items: normal;\n    text-transform: none;\n    background-color: #fcfcfc;\n  }\n\n  .tab-content {\n    width: 100%;\n  }\n  .row {\n    display: flex;\n  }\n\n  .inner-content {\n    padding: 15px 30px;\n    width: 100%;\n    overflow: auto;\n  }\n\n  .footer-container {\n    display: flex;\n    flex-direction: row;\n    align-items: end;\n    justify-content: end;\n\n    background: rgb(242, 242, 242);\n    background: -moz-linear-gradient(\n      0deg,\n      rgba(242, 242, 242, 1) 0%,\n      rgba(245, 245, 245, 1) 37%,\n      rgba(255, 255, 255, 1) 90%\n    );\n    background: -webkit-linear-gradient(\n      0deg,\n      rgba(242, 242, 242, 1) 0%,\n      rgba(245, 245, 245, 1) 37%,\n      rgba(255, 255, 255, 1) 90%\n    );\n    background: linear-gradient(\n      0deg,\n      rgba(242, 242, 242, 1) 0%,\n      rgba(245, 245, 245, 1) 37%,\n      rgba(255, 255, 255, 1) 90%\n    );\n    filter: progid:DXImageTransform.Microsoft.gradient(startColorstr=\"#f2f2f2\",endColorstr=\"#ffffff\",GradientType=1);\n    padding: 6px 15px;\n    height: 55px;\n  }\n\n  .section-header {\n    font-size: 13px;\n    color: #2ca8ff;\n    margin-bottom: 10px;\n    border-bottom: 0.55px solid #f9f9f9;\n    padding: 6px 2px;\n  }\n\n  .custom-label {\n    font-size: 12px;\n    font-weight: bold;\n    margin-right: 10px;\n    width: 120px;\n  }\n  .margin-10 {\n    margin: 10px 0;\n  }\n  .padding-h-10 {\n    margin: 10px;\n  }\n\n  .input {\n    font-size: 14px;\n    border-radius: 5px;\n    border: 1px solid #cccccc;\n    padding: 5px;\n    width: 100px;\n    margin-right: 10px;\n    height: initial !important;\n  }\n\n  .close-bt {\n    border: none;\n    color: red;\n    background-color: transparent;\n    outline: none;\n    position: absolute;\n    right: 10px;\n    top: 2px;\n    width: 30px;\n    height: 30px;\n  }\n`;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { Field } from 'formik';\nimport { useCallback, useRef } from 'react';\n\nimport { DataExportOptions } from '../../data/SpectraManager';\nimport ActionButtons from '../elements/ActionButtons';\nimport CloseButton from '../elements/CloseButton';\nimport FormikCheckBox from '../elements/formik/FormikCheckBox';\nimport FormikForm from '../elements/formik/FormikForm';\nimport FormikInput from '../elements/formik/FormikInput';\n\nimport { ModalStyles } from './ModalStyle';\n\nconst styles = css`\n  .row {\n    align-items: center;\n  }\n\n  .inner-content {\n    flex: 1;\n  }\n\n  .custom-label {\n    width: 80px;\n  }\n\n  .name {\n    width: 100% !important;\n    text-align: left !important;\n  }\n\n  .data-export-group {\n    label:first-child {\n      margin-right: 10px;\n    }\n    label {\n      display: inline-block;\n    }\n    input[type='radio'] {\n      margin-right: 5px;\n    }\n  }\n`;\n\nconst INITIAL_VALUE = {\n  name: '',\n  compressed: false,\n  pretty: false,\n  dataExportOption: DataExportOptions.ROW_DATA,\n};\n\ninterface SaveAsModalProps {\n  onClose?: (event?: MouseEvent) => void;\n  onSave: (element: any) => void;\n  name: string;\n}\n\nfunction SaveAsModal({ onClose, onSave, name }: SaveAsModalProps) {\n  const refForm = useRef<any>();\n\n  const handleSave = useCallback(() => {\n    refForm.current.submitForm();\n  }, []);\n\n  const submitHandler = useCallback(\n    (values) => {\n      onSave(values);\n      onClose?.();\n    },\n    [onClose, onSave],\n  );\n\n  return (\n    <div css={[ModalStyles, styles]}>\n      <div className=\"header handle\">\n        <span>Save as ... </span>\n        <CloseButton onClick={onClose} className=\"close-bt\" />\n      </div>\n      <div className=\"inner-content\">\n        <FormikForm\n          ref={refForm}\n          initialValues={{ ...INITIAL_VALUE, name }}\n          onSubmit={submitHandler}\n        >\n          <div className=\"row margin-10\">\n            <span className=\"custom-label\">Name</span>\n            <FormikInput\n              name=\"name\"\n              className=\"name\"\n              style={{\n                inputWrapper: { width: '100%' },\n              }}\n            />\n          </div>\n\n          <div className=\"row margin-10\">\n            <span className=\"custom-label\">Compressed</span>\n            <FormikCheckBox name=\"compressed\" />\n          </div>\n          <div className=\"row margin-10\">\n            <span className=\"custom-label\">Pretty Format</span>\n            <FormikCheckBox name=\"pretty\" />\n          </div>\n          <div className=\"row margin-10\">\n            <span className=\"custom-label\"> Include </span>\n            <div className=\"data-export-group\">\n              <label>\n                <Field\n                  type=\"radio\"\n                  name=\"dataExportOption\"\n                  value={DataExportOptions.ROW_DATA}\n                />\n                Raw Data\n              </label>\n              <label>\n                <Field\n                  type=\"radio\"\n                  name=\"dataExportOption\"\n                  value={DataExportOptions.DATA_SOURCE}\n                />\n                Data Source\n              </label>\n            </div>\n          </div>\n        </FormikForm>\n      </div>\n      <div className=\"footer-container\">\n        <ActionButtons\n          style={{ flexDirection: 'row-reverse', margin: 0 }}\n          onDone={handleSave}\n          doneLabel=\"Save\"\n          onCancel={() => onClose?.()}\n        />\n      </div>\n    </div>\n  );\n}\n\nexport default SaveAsModal;\n","import { saveAs } from 'file-saver';\nimport JSZip from 'jszip';\n\nfunction copyFormattedHtml(html) {\n  // Create an iframe (isolated container) for the HTML\n  let container = document.createElement('div');\n  container.innerHTML = html;\n\n  // Hide element\n  container.style.position = 'fixed';\n  container.style.pointerEvents = 'none';\n  container.style.opacity = '0';\n\n  // Detect all style sheets of the page\n  let activeSheets = Array.prototype.slice\n    .call(document.styleSheets)\n    .filter((sheet) => {\n      return !sheet.disabled;\n    });\n\n  // Mount the iframe to the DOM to make `contentWindow` available\n  document.body.appendChild(container);\n\n  // Copy to clipboard\n  window.getSelection()?.removeAllRanges();\n\n  let range = document.createRange();\n  range.selectNode(container);\n  window.getSelection()?.addRange(range);\n\n  document.execCommand('copy');\n  for (const active of activeSheets) {\n    active.disabled = true;\n  }\n\n  document.execCommand('copy');\n  for (const active of activeSheets) {\n    active.disabled = false;\n  }\n\n  // Remove the iframe\n  document.body.removeChild(container);\n}\n\nasync function copyHTMLToClipboard(data) {\n  try {\n    copyFormattedHtml(data);\n    return true;\n  } catch (err) {\n    return false;\n  }\n}\nasync function copyTextToClipboard(data) {\n  try {\n    await navigator.clipboard.writeText(data);\n    return true;\n  } catch (err) {\n    return false;\n  }\n}\n/**\n * export the experiments result in JSON format\n * @param {*} data\n */\nasync function exportAsJSON(\n  data,\n  fileName = 'experiment',\n  spaceIndent = 0,\n  isCompressed = false,\n) {\n  const fileData = JSON.stringify(\n    data,\n    (key, value) =>\n      ArrayBuffer.isView(value) ? Array.from(value as any) : value,\n    spaceIndent,\n  );\n  if (!isCompressed) {\n    const blob = new Blob([fileData], { type: 'text/plain' });\n    saveAs(blob, `${fileName}.nmrium`);\n  } else {\n    try {\n      const zip = new JSZip();\n      zip.file(`${fileName}.nmrium`, fileData);\n      const blob = await zip.generateAsync({\n        type: 'blob',\n        compression: 'DEFLATE',\n        compressionOptions: {\n          level: 9,\n        },\n      });\n      saveAs(blob, `${fileName}.nmrium`);\n    } catch (e) {\n      // eslint-disable-next-line no-console\n      console.log(e);\n    }\n  }\n}\n\nfunction exportAsMatrix(data, options, fileName = 'experiment') {\n  //columns labels\n  const columnsLables = ['name', 'experiment'];\n  for (const value of data[0].data.x) {\n    columnsLables.push(value);\n  }\n  let matrix = `${columnsLables.join('\\t')}\\n`;\n\n  for (const spectrum of data) {\n    const {\n      data: { re },\n      info: { experiment },\n      display: { name },\n    } = spectrum;\n    const cellsValues = [name, experiment];\n    for (const value of re) {\n      cellsValues.push(value);\n    }\n    matrix += `${cellsValues.join('\\t')}\\n`;\n  }\n\n  const blob = new Blob([matrix], { type: 'text/tab-separated-values' });\n  saveAs(blob, `${fileName}.tsv`);\n}\n\nfunction exportAsNMRE(data, fileName = 'experiment') {\n  data.generateAsync({ type: 'blob' }).then((content) => {\n    saveAs(content, `${fileName}.nmredata`);\n  });\n}\n\nfunction exportAsMol(data, fileName = 'mol') {\n  const blob = new Blob([data], { type: 'text/plain' });\n  saveAs(blob, `${fileName}.mol`);\n}\n/**\n * export the vitalization result as SVG, if you need to remove some content during exportation process enclose the the content with <!-- export-remove --> ${content} <!-- export-remove -->\n */\nfunction exportAsSVG(\n  rootRef: HTMLDivElement,\n  elementID: string,\n  fileName = 'experiment',\n) {\n  const { blob } = getBlob(rootRef, elementID);\n  saveAs(blob, `${fileName}.svg`);\n}\n\nfunction exportAsPng(\n  rootRef: HTMLDivElement,\n  elementID: string,\n  fileName = 'experiment',\n) {\n  const { blob, width, height } = getBlob(rootRef, elementID);\n  try {\n    let canvas = document.createElement('canvas');\n    canvas.width = width;\n    canvas.height = height;\n    let context = canvas.getContext('2d');\n\n    if (context) {\n      context.fillStyle = 'white';\n      context.fillRect(0, 0, canvas.width, canvas.height);\n    }\n\n    let img = new Image();\n    let url = URL.createObjectURL(blob);\n    img.onload = async () => {\n      context?.drawImage(img, 0, 0);\n      let png = canvas.toDataURL('image/png', 1);\n      saveAs(png, `${fileName}.png`);\n      URL.revokeObjectURL(png);\n    };\n    img.src = url;\n  } catch (e) {\n    // eslint-disable-next-line no-console\n    console.log(e);\n  }\n}\n\nfunction copyDataURLCliboard(image) {\n  const img = document.createElement('img');\n  img.src = image;\n\n  img.style.position = 'fixed';\n  img.style.pointerEvents = 'none';\n  img.style.opacity = '0';\n\n  document.body.appendChild(img);\n  const range = document.createRange();\n  range.selectNode(img);\n  window.getSelection()?.addRange(range);\n  document.execCommand('Copy');\n  document.body.removeChild(img);\n}\n\nfunction copyBlobToCliboard(canvas) {\n  canvas.toBlob((b) => {\n    const clip = new ClipboardItem({\n      [b.type]: b,\n    });\n\n    navigator.clipboard.write([clip]).then(\n      () => {\n        // eslint-disable-next-line no-console\n        console.log('experiment copied.');\n      },\n      (err) => {\n        // eslint-disable-next-line no-console\n        console.log(err);\n      },\n    );\n  });\n}\n\nfunction copyPNGToClipboard(rootRef: HTMLDivElement, elementID: string) {\n  const { blob, width, height } = getBlob(rootRef, elementID);\n  try {\n    let canvas = document.createElement('canvas');\n    canvas.width = width;\n    canvas.height = height;\n    let context = canvas.getContext('2d');\n\n    if (context) {\n      context.fillStyle = 'white';\n      context.fillRect(0, 0, canvas.width, canvas.height);\n    }\n\n    let img = new Image();\n    const url = URL.createObjectURL(blob);\n    img.onload = async () => {\n      context?.drawImage(img, 0, 0);\n      const png = canvas.toDataURL('image/png', 1);\n\n      // @ts-expect-error write exists in some browsers\n      if (navigator.clipboard.write) {\n        copyBlobToCliboard(canvas);\n      } else {\n        copyDataURLCliboard(png);\n      }\n\n      URL.revokeObjectURL(png);\n    };\n    img.src = url;\n  } catch (e) {\n    if (e instanceof ReferenceError) {\n      // eslint-disable-next-line no-alert\n      alert(\n        'Your browser does not support this feature, please use Google Chrome',\n      );\n    }\n    // eslint-disable-next-line no-console\n    console.log(e);\n  }\n}\n\nfunction getBlob(rootRef: HTMLDivElement, elementID: string) {\n  let _svg: any = (rootRef.getRootNode() as Document)\n    .getElementById(elementID)\n    ?.cloneNode(true);\n  const width = _svg?.getAttribute('width').replace('px', '');\n  const height = _svg?.getAttribute('height').replace('px', '');\n  _svg\n    .querySelectorAll('[data-no-export=\"true\"]')\n    .forEach((element) => element.remove());\n  const head = `<svg class=\"nmr-svg\"  viewBox='0 0 ${width} ${height}' width=\"${width}\"  height=\"${height}\"  version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\">`;\n  const style = `<style>.grid line,.grid path{stroke:none;} .peaks-text{fill:#730000} .x path{stroke-width:1px} .x text{\n    font-size: 12px;\n    font-weight: bold;\n  } \n \n  .nmr-svg,.contours{\n    background-color:white;\n    fill:white;\n  }\n  \n\n  \n  </style>`;\n  const svg = `${head + style + _svg.innerHTML}</svg>`;\n  const blob = new Blob([svg], { type: 'image/svg+xml' });\n  return { blob, width, height };\n}\n\nexport {\n  exportAsSVG,\n  exportAsJSON,\n  exportAsNMRE,\n  exportAsPng,\n  copyPNGToClipboard,\n  copyTextToClipboard,\n  copyHTMLToClipboard,\n  exportAsMol,\n  exportAsMatrix,\n};\n","import Jszip from 'jszip';\n\nconst jszip = new Jszip();\n\ninterface addSourceOptions {\n  spectrum?: any;\n  source?: any;\n}\n\nexport async function addSource(nmrRecord, options: addSourceOptions = {}) {\n  const { spectrum, source } = options;\n  const { file = {}, jcampURL } = source;\n  let tag = '';\n  const dimension = `${spectrum.info.dimension}d`;\n  switch (file.extension) {\n    case 'jdx':\n    case 'dx':\n      tag += `\\nJcamp_Location=file:jcamp/${dimension}/${spectrum.display.name}\\\\`;\n      nmrRecord.file(\n        `jcamp/${dimension}/${spectrum.display.name}`,\n        file.binary,\n      );\n      break;\n    case 'zip':\n      if (!file.binary) return;\n      void jszip.loadAsync(file.binary).then(async (zip) => {\n        for (const file in zip.files) {\n          if (file.endsWith('/')) continue;\n          nmrRecord.file(\n            `Bruker/${file}`,\n            await zip.file(file)?.async('arraybuffer'),\n          );\n        }\n        tag += `\\nSpectrum_Location=file:Bruker/${getPathFromZip(zip)}\\\\`;\n      });\n      break;\n    default:\n      if (!jcampURL) break;\n      void (await fetch(jcampURL).then(async (jcamp) => {\n        if (!jcamp) return;\n        let name = jcampURL.split('/').slice(-1);\n        const path = `jcamp/${dimension}/${name}`;\n        tag += `\\nJcamp_Location=file:${path}\\\\`;\n        nmrRecord.file(path, await jcamp.arrayBuffer());\n      }));\n  }\n\n  return tag;\n}\n\nfunction getPathFromZip(zip) {\n  let files = zip.filter((relativePath) => {\n    if (relativePath.match('__MACOSX')) return false;\n    if (\n      relativePath.endsWith('fid') ||\n      relativePath.endsWith('1r') ||\n      relativePath.endsWith('ser') ||\n      relativePath.endsWith('2rr')\n    ) {\n      return true;\n    }\n    return false;\n  });\n  const index = files.findIndex(\n    (file) => file.name.endsWith('1r') || file.name.endsWith('2rr'),\n  );\n  return index > -1 ? files[index].name : files[0].name;\n}\n","export function getToFix(nucleusArray: string | Array<string>) {\n  if (!Array.isArray(nucleusArray)) nucleusArray = [nucleusArray];\n  let toFix: Array<number> = [];\n  for (let nucleus of nucleusArray) {\n    toFix.push(chooseDecimal(nucleus));\n  }\n  return toFix;\n}\n\nfunction chooseDecimal(nucleus: string) {\n  switch (nucleus.toUpperCase()) {\n    case '1H':\n      return 2;\n    case '13C':\n      return 1;\n    default:\n      return 1;\n  }\n}\n","import { addSource } from './addSource';\nimport { getToFix } from './getToFix';\n\ninterface Get1DSignalsOptions {\n  prefix?: string;\n  labels: {\n    byDiaID: Array<{ label: string }>;\n  };\n}\n\nexport async function get1DSignals(\n  data,\n  nmrRecord,\n  options: Get1DSignalsOptions = { labels: { byDiaID: [] } },\n) {\n  let { prefix = '', labels } = options;\n  let str = '';\n  let nucleusArray: Array<Array<any>> = [];\n  for (let spectrum of data) {\n    const { info } = spectrum;\n    if (info.isFid || info.dimension > 1) continue;\n    let partTag = '';\n    let ranges = spectrum.ranges.values || [];\n\n    let nucleus = spectrum.info.nucleus;\n    let counter = 1;\n    let subfix = '';\n    nucleusArray.forEach((e) => {\n      if (e === nucleus) counter++;\n    });\n    nucleusArray.push(nucleus);\n\n    if (counter > 1) subfix = `#${counter}`;\n\n    partTag += `${prefix}1D_${nucleus.toUpperCase()}${subfix}>`;\n\n    if (spectrum.info.baseFrequency) {\n      partTag += `\\nLarmor=${Number(spectrum.info.baseFrequency).toFixed(2)}\\\\`;\n    }\n\n    const { source = {} } = spectrum;\n\n    partTag += await addSource(nmrRecord, {\n      spectrum,\n      source,\n    });\n\n    let toFix = getToFix(nucleus)[0];\n\n    for (let range of ranges) {\n      let signals = range.signals;\n\n      for (let signal of signals) {\n        let { multiplicity } = signal;\n        if ((!multiplicity || multiplicity === 'm') && nucleus === '1H') {\n          partTag += `\\n${Number(range.from).toFixed(toFix)}-${Number(\n            range.to,\n          ).toFixed(toFix)}`;\n        } else if (signal.delta) {\n          partTag += `\\n${Number(signal.delta).toFixed(toFix)}`;\n        } else {\n          continue;\n        }\n\n        let signalLabel = '';\n\n        if (signal.diaIDs && signal.diaIDs.length > 0) {\n          signal.diaIDs.forEach((diaID, i, arr) => {\n            let separator = ', ';\n            if (i === arr.length - 1) separator = '';\n            let label = labels.byDiaID[diaID].label || diaID;\n            signalLabel += `${label}${separator}`;\n          });\n          partTag += `, L=${signalLabel}`;\n        }\n\n        if (nucleus === '1H') {\n          if (signal.multiplicity) partTag += `, S=${signal.multiplicity}`;\n\n          let jCoupling = signal.js;\n          if (Array.isArray(jCoupling) && jCoupling.length) {\n            let separator = ', J=';\n\n            for (const jCouplingElement of jCoupling) {\n              partTag += `${separator}${Number(\n                jCouplingElement.coupling,\n              ).toFixed(3)}`;\n              if (jCouplingElement.diaIDs) {\n                let { diaIDs } = jCouplingElement;\n                if (!Array.isArray(diaIDs)) diaIDs = [diaIDs];\n                if (!diaIDs.length) continue;\n                let jCouple =\n                  labels.byDiaID[diaIDs[0]].label || String(diaIDs[0]);\n                partTag += `(${jCouple})`;\n              }\n              separator = ', ';\n            }\n          }\n          if (range.integration) {\n            partTag += `, E=${Number(range.integration).toFixed(toFix)}`;\n          } else if (range.nbAtoms) {\n            partTag += `, E=${range.nbAtoms.toFixed(toFix)}`;\n          } else if (range.signals[0].nbAtoms !== undefined) {\n            partTag += `, E=${range.signals[0].nbAtoms}`;\n          }\n        }\n      }\n      if (signals.length) partTag += '\\\\';\n    }\n    partTag += '\\n';\n\n    if (/\\n/.exec(partTag)) str += partTag;\n  }\n  return str;\n}\n","export function getCouplingObserved(experiment: string) {\n  switch (experiment.toLowerCase()) {\n    case 'hsqc':\n    case 'cosy':\n      return '1J';\n    case 'hmbc':\n      return 'NJ';\n    default:\n      return 'NJ';\n  }\n}\n","import { addSource } from './addSource';\nimport { getCouplingObserved } from './getCouplingObserved';\nimport { getToFix } from './getToFix';\n\nconst isArray = Array.isArray;\n\ninterface Get2DSignalsOptions {\n  labels: { byDiaID?: string };\n  prefix?: string;\n}\n\nexport async function get2DSignals(\n  data,\n  nmrRecord,\n  options: Get2DSignalsOptions = { labels: {} },\n) {\n  const { byDiaID } = options.labels;\n  let str = '';\n  let nucleusRecorded: Array<Array<any>> = [];\n  const prefix = `\\n> <NMREDATA_2D_`;\n  for (let spectrum of data) {\n    if (spectrum.info.dimension < 2) continue;\n    let partTag = '';\n    const { info, source } = spectrum;\n    let { nucleus, experiment, pulseSequence } = info;\n\n    nucleusRecorded.push(nucleus);\n\n    let couplingObserved = getCouplingObserved(experiment);\n    if (nucleus) {\n      partTag += `${prefix}${nucleus[1]}_${couplingObserved}_${nucleus[0]}>`;\n    }\n    let toFix = getToFix(nucleus);\n\n    partTag += await addSource(nmrRecord, {\n      spectrum,\n      source,\n    });\n\n    if (experiment) partTag += `\\nCorType=${experiment} \\\\`;\n    if (pulseSequence) partTag += `\\nPulseProgram=${pulseSequence} \\\\`;\n\n    if (spectrum.info.baseFrequency) {\n      partTag += `\\nLarmor=${Number(spectrum.info.baseFrequency[0]).toFixed(\n        2,\n      )}\\\\`;\n    }\n\n    let zones = spectrum.zones.values || [];\n    for (let zone of zones) {\n      let signals = zone.signals;\n      for (let signal of signals) {\n        let { x, y, peaks } = signal;\n        let xLabel = getAssignment(x, byDiaID, toFix[0]);\n        let yLabel = getAssignment(y, byDiaID, toFix[1]);\n        let intensity = Math.max(...peaks.map((e) => e.z));\n        partTag += `\\n${xLabel}/${yLabel}, I=${intensity.toFixed(2)}\\\\`;\n      }\n    }\n    str += partTag;\n  }\n  return str.length > 0 ? `${str}\\n` : '';\n}\n\nfunction getAssignment(axis, labels, toFix) {\n  let { diaIDs, delta } = axis;\n  if (diaIDs) {\n    if (!isArray(diaIDs)) diaIDs = [diaIDs];\n    if (diaIDs.length < 1) return Number(delta).toFixed(toFix);\n    let label = diaIDs.map((diaID) => labels[diaID].label).join(',');\n    return diaIDs.length > 1 ? `(${label})` : label;\n  }\n  return Number(delta).toFixed(toFix);\n}\n","export function flat2DSignals(signals) {\n  let flattedSignal: Array<any> = [];\n  for (const { x, y } of signals) {\n    flattedSignal.push(x, y);\n  }\n  return flattedSignal;\n}\n","import { getShortestPaths } from 'openchemlib-utils';\n\nimport { flat2DSignals } from './flat2DSignals';\nimport { getToFix } from './getToFix';\n\ninterface GetLabelsOptions {\n  molecule?: any;\n  groupedDiaIDs: Array<any>;\n}\n\nexport function getLabels(\n  data,\n  options: GetLabelsOptions = { groupedDiaIDs: [] },\n) {\n  const { groupedDiaIDs, molecule } = options;\n\n  let connections = getShortestPaths(molecule, { toLabel: 'H', maxLength: 1 });\n\n  let byDiaID = {};\n  let byAssignNumber = {};\n  for (let spectrum of data) {\n    let { dimension, nucleus } = spectrum.info;\n    let toFix = getToFix(nucleus);\n\n    let [roiKey, flatSignals] =\n      dimension > 1 ? ['zones', flat2DSignals] : ['ranges', (s) => s || []];\n\n    let rois = spectrum[roiKey].values || [];\n    for (let roi of rois) {\n      let signals = flatSignals(roi.signals);\n      for (let i = 0; i < signals.length; i++) {\n        let diaIDs = signals[i].diaIDs || [];\n        for (let diaID of diaIDs) {\n          let delta = Number(signals[i].delta).toFixed(toFix[i % dimension]);\n          // get atomLabel\n          let groupedOclID = groupedDiaIDs.find((dia) => {\n            if (dia.oclID === diaID) return true;\n            return false;\n          });\n          // the addition of one in atom number it is because the atoms enumeration starts from zero\n\n          let labelOptions = {\n            atom: groupedOclID.atoms[0],\n            molecule,\n            connections,\n            atomLabel: groupedOclID.atomLabel,\n          };\n\n          byDiaID[diaID] = {\n            atoms: groupedOclID.atoms.map((e) => e + 1),\n            shift: delta,\n            label: createLabel(labelOptions),\n          };\n\n          for (let atom of groupedOclID.atoms) {\n            labelOptions.atom = atom;\n            byAssignNumber[atom] = {\n              shift: delta,\n              diaID,\n              label: createLabel(labelOptions),\n            };\n          }\n        }\n      }\n    }\n  }\n  return { byAssignNumber, byDiaID };\n}\n\nfunction createLabel(options) {\n  const { atom, molecule, atomLabel, connections } = options;\n  let label = '';\n  if (atomLabel !== 'C') {\n    let connectedTo = connections[atom];\n    let path = connectedTo.find((e) => e && e.length > 1);\n    let pLabel = `${atomLabel}${path[0] + 1}`;\n    let hLabel = `${molecule.getAtomLabel(path[1])}${path[1] + 1}`;\n    label = `${pLabel}${hLabel}`;\n  } else {\n    label = `${atomLabel}${atom + 1}`;\n  }\n  return label;\n}\n","import jszip from 'jszip';\nimport { getGroupedDiastereotopicAtomIDs } from 'openchemlib-utils';\nimport { Molecule as OCLMolecule } from 'openchemlib/full';\n\nimport { get1DSignals } from './util/nmredata/get1DSignals';\nimport { get2DSignals } from './util/nmredata/get2DSignals';\nimport { getLabels } from './util/nmredata/getLabels';\n\nconst tags = {\n  solvent: 'SOLVENT',\n  temperature: 'TEMPERATURE',\n  assignment: 'ASSIGNMENT',\n  j: 'J',\n  signals: 'SIGNALS',\n  id: 'ID',\n};\n\nexport async function nmriumToNmredata(state, options = {}) {\n  const {\n    data, // it would be changed depending of the final location\n    molecules,\n  } = state || {\n    data: [], // it would be changed depending of the final location\n    molecules: [],\n  };\n\n  let nmrRecord = new jszip();\n\n  for (const molecule of molecules) {\n    await addNMReDATA(data, nmrRecord, {\n      ...options,\n      molecule,\n    });\n  }\n\n  if (!molecules.length) await addNMReDATA(data, nmrRecord, options);\n  return nmrRecord;\n}\n\ninterface AddNMReDATAOptions {\n  id?: string;\n  prefix?: string;\n  filename?: string;\n  molecule?: any;\n}\n\nasync function addNMReDATA(data, nmrRecord, options: AddNMReDATAOptions = {}) {\n  let {\n    id,\n    prefix = '\\n> <NMREDATA_',\n    filename = 'nmredata',\n    molecule,\n  } = options;\n\n  let sdfResult = '';\n\n  let groupedDiaIDs;\n  if (molecule) {\n    molecule = OCLMolecule.fromMolfile(molecule.molfile);\n    sdfResult += molecule.toMolfile();\n    molecule.addImplicitHydrogens();\n    groupedDiaIDs = getGroupedDiastereotopicAtomIDs(molecule);\n  }\n\n  let labels: { byDiaID: any; byAssignNumber: any } = molecule\n    ? getLabels(data, { groupedDiaIDs, molecule })\n    : { byDiaID: undefined, byAssignNumber: undefined };\n\n  sdfResult += `${prefix}VERSION>\\n1.1\\\\\\n`;\n  sdfResult += putTag(data, 'temperature', { prefix });\n  sdfResult += putTag(data, 'solvent', { prefix });\n\n  if (id) sdfResult += `${prefix + tags.id}>\\nid\\\\\\n`;\n  sdfResult += formatAssignments(labels.byDiaID, { prefix });\n  sdfResult += await get1DSignals(data, nmrRecord, { prefix, labels });\n  sdfResult += await get2DSignals(data, nmrRecord, { prefix, labels });\n  sdfResult += '\\n$$$$\\n';\n  nmrRecord.file(`${filename}.sdf`, sdfResult);\n}\n\nfunction formatAssignments(labels, options) {\n  if (!labels) return '';\n  const { prefix } = options;\n  let str = `${prefix + tags.assignment}>\\n`;\n  for (let l in labels) {\n    let atoms = labels[l].atoms;\n    str += `${labels[l].label}, ${labels[l].shift}`; // change to add label\n    for (let atom of atoms) str += `, ${atom}`;\n    str += '\\\\\\n';\n  }\n  return str;\n}\n\nfunction putTag(spectra, tag, options: { prefix?: string } = { prefix: '' }) {\n  const { prefix } = options;\n  let str = '';\n  for (let spectrum of spectra) {\n    if (spectrum.info[tag]) {\n      str += `${prefix + tags[tag]}>\\n${String(spectrum.info[tag])}\\\\\\n`;\n      break;\n    }\n  }\n  return str;\n}\n","import { useCallback } from 'react';\n\nimport { toJSON } from '../../data/SpectraManager';\nimport { useChartData } from '../context/ChartContext';\nimport { useGlobal } from '../context/GlobalContext';\nimport { useAlert } from '../elements/popup/Alert';\nimport { positions, useModal } from '../elements/popup/Modal';\nimport SaveAsModal from '../modal/SaveAsModal';\nimport {\n  copyPNGToClipboard,\n  exportAsJSON,\n  exportAsNMRE,\n  exportAsPng,\n  exportAsSVG,\n} from '../utility/Export';\nimport { nmriumToNmredata } from '../utility/nmriumToNmredata';\n\nexport default function useExport() {\n  const { rootRef } = useGlobal();\n  const modal = useModal();\n  const alert = useAlert();\n  const state = useChartData();\n\n  const saveToClipboardHandler = useCallback(async () => {\n    if (state.data.length > 0 && rootRef) {\n      const hideLoading = await alert.showLoading(\n        'Exporting as NMRium process in progress',\n      );\n      setTimeout(() => {\n        copyPNGToClipboard(rootRef, 'nmrSVG');\n        hideLoading();\n        alert.success('Image copied to clipboard');\n      }, 0);\n    }\n  }, [rootRef, alert, state]);\n\n  const saveAsJSONHandler = useCallback(\n    async (spaceIndent = 0, isCompressed = true) => {\n      if (state.data.length > 0) {\n        const hideLoading = await alert.showLoading(\n          'Exporting as NMRium process in progress',\n        );\n\n        setTimeout(() => {\n          async function handle() {\n            //exported file name by default will be the first spectrum name\n            const fileName = state.data[0]?.display?.name;\n            const exportedData = toJSON(state);\n            await exportAsJSON(\n              exportedData,\n              fileName,\n              spaceIndent,\n              isCompressed,\n            );\n            hideLoading();\n          }\n\n          void handle();\n        }, 0);\n      }\n    },\n    [alert, state],\n  );\n\n  const saveAsNMREHandler = useCallback(async () => {\n    if (state.data.length > 0) {\n      const hideLoading = await alert.showLoading(\n        'Exporting as NMRE process in progress',\n      );\n      setTimeout(() => {\n        async function handle() {\n          const fileName = state.data[0]?.display?.name;\n          const exportedData = await nmriumToNmredata(state);\n          exportAsNMRE(exportedData, fileName);\n          hideLoading();\n        }\n\n        void handle();\n      }, 0);\n    }\n  }, [alert, state]);\n\n  const saveAsSVGHandler = useCallback(async () => {\n    if (state.data.length > 0 && rootRef) {\n      const hideLoading = await alert.showLoading(\n        'Exporting as SVG process in progress',\n      );\n      setTimeout(() => {\n        const fileName = state.data[0]?.display?.name;\n        exportAsSVG(rootRef, 'nmrSVG', fileName);\n        hideLoading();\n      }, 0);\n    }\n  }, [rootRef, alert, state.data]);\n\n  const saveAsPNGHandler = useCallback(async () => {\n    if (state.data.length > 0 && rootRef) {\n      const hideLoading = await alert.showLoading(\n        'Exporting as PNG process in progress',\n      );\n      setTimeout(() => {\n        const fileName = state.data[0]?.display?.name;\n        exportAsPng(rootRef, 'nmrSVG', fileName);\n        hideLoading();\n      }, 0);\n    }\n  }, [rootRef, alert, state.data]);\n\n  const saveHandler = useCallback(\n    (options) => {\n      async function handler() {\n        const { name, pretty, compressed, dataExportOption } = options;\n        const hideLoading = await alert.showLoading(\n          `Exporting as ${name}.nmrium process in progress`,\n        );\n        setTimeout(() => {\n          void (async () => {\n            const exportedData = toJSON(state, dataExportOption);\n            const spaceIndent = pretty ? 2 : 0;\n            await exportAsJSON(exportedData, name, spaceIndent, compressed);\n            hideLoading();\n          })();\n        }, 0);\n      }\n\n      void handler();\n    },\n    [alert, state],\n  );\n  const saveAsHandler = useCallback(async () => {\n    if (state.data.length > 0) {\n      const fileName = state.data[0]?.display?.name;\n      modal.show(<SaveAsModal name={fileName} onSave={saveHandler} />, {\n        isBackgroundBlur: false,\n        position: positions.TOP_CENTER,\n        width: 400,\n      });\n    }\n  }, [modal, saveHandler, state.data]);\n\n  return {\n    saveToClipboardHandler,\n    saveAsJSONHandler,\n    saveAsNMREHandler,\n    saveAsSVGHandler,\n    saveAsPNGHandler,\n    saveAsHandler,\n  };\n}\n","import lodashGet from 'lodash/get';\n\nimport { usePreferences } from '../context/PreferencesContext';\n\nexport default function useCheckExperimentalFeature(): boolean {\n  const preferences = usePreferences();\n  const value = lodashGet(\n    preferences.current,\n    'display.general.experimentalFeatures',\n    false,\n  );\n\n  if (value?.hidden === true || value?.display === false) {\n    return false;\n  }\n\n  return true;\n}\n","import { CSSProperties, InputHTMLAttributes, ReactNode } from 'react';\n\nimport ToolTip from './ToolTip/ToolTip';\n\ninterface ButtonToolTipProps\n  extends Omit<InputHTMLAttributes<HTMLButtonElement>, 'type'> {\n  popupTitle?: string;\n  popupPlacement?: string;\n  style?: CSSProperties;\n  children?: ReactNode;\n}\n\nfunction ButtonToolTip({\n  children,\n  style = {},\n  onClick = () => null,\n  popupTitle = '',\n  popupPlacement = 'right',\n  ...props\n}: ButtonToolTipProps) {\n  return (\n    <ToolTip title={popupTitle} popupPlacement={popupPlacement}>\n      <button style={style} type=\"button\" onClick={onClick} {...props}>\n        {children}\n      </button>\n    </ToolTip>\n  );\n}\n\nexport default ButtonToolTip;\n","import { css } from '@emotion/react';\n\nexport const tablePanelStyle = css`\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  width: 100%;\n\n  .inner-container {\n    height: 100%;\n    overflow: hidden;\n    isolation: isolate;\n  }\n\n  .table-container {\n    overflow: auto;\n    height: 100%;\n    display: block;\n    background-color: white;\n  }\n`;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { CSSProperties, memo, ReactNode, useCallback, useState } from 'react';\n\nimport ToolTip from './ToolTip/ToolTip';\n\nconst styles = css`\n  background-color: #f5f5f5;\n  border: none;\n  border-radius: 5px;\n\n  &:hover {\n    background-color: lightgray !important;\n    color: black !important;\n  }\n\n  &.toggle-active {\n    background-color: gray;\n    color: white;\n  }\n`;\n\ninterface ToggleButtonProps {\n  popupTitle: string;\n  popupPlacement: string;\n  style?: CSSProperties;\n  defaultValue?: boolean;\n  onClick: (element: boolean) => void;\n  disabled?: boolean;\n  children: ReactNode;\n  className?: string;\n}\n\nfunction ToggleButton({\n  children,\n  style = {},\n  onClick = () => null,\n  popupTitle = '',\n  popupPlacement = 'right',\n  defaultValue = false,\n  disabled = false,\n  className = '',\n}: ToggleButtonProps) {\n  const [flag, Toggle] = useState<boolean>(defaultValue);\n\n  const toggleHandler = useCallback(() => {\n    onClick(!flag);\n\n    Toggle(!flag);\n  }, [onClick, flag]);\n  return (\n    <ToolTip title={popupTitle} popupPlacement={popupPlacement}>\n      <button\n        disabled={disabled}\n        css={styles}\n        style={style}\n        className={(flag ? 'toggle toggle-active ' : 'toggle ') + className}\n        type=\"button\"\n        onClick={toggleHandler}\n      >\n        {children}\n      </button>\n    </ToolTip>\n  );\n}\n\nexport default memo(ToggleButton);\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { CSSProperties, memo, ReactNode } from 'react';\nimport { FaRegTrashAlt, FaCog, FaFilter } from 'react-icons/fa';\n\nimport ToggleButton from '../../elements/ToggleButton';\nimport ToolTip from '../../elements/ToolTip/ToolTip';\n\nconst styles = css`\n  display: flex;\n  flex-direction: row;\n  border-bottom: 0.55px solid rgb(240, 240, 240);\n  padding: 0px 5px;\n\n  .left-container {\n    display: flex;\n    flex-direction: row;\n    flex: 1;\n  }\n  button {\n    background-color: transparent;\n    border: none;\n    padding: 5px;\n  }\n\n  button:disabled {\n    opacity: 0.6;\n  }\n\n  .counter-label {\n    margin: 0;\n    text-align: right;\n    line-height: 22px;\n    padding: 0px 10px;\n    white-space: nowrap;\n  }\n`;\n\ninterface DefaultPanelHeaderProps {\n  counter?: number;\n  counterFiltered?: number;\n  deleteToolTip?: string;\n  filterToolTip?: string;\n  onDelete?: () => void;\n  onFilter?: () => void;\n  onSettingClick?: () => void;\n  filterIsActive?: boolean;\n  canDelete?: boolean;\n  showSettingButton?: boolean;\n  showCounter?: boolean;\n  children?: ReactNode;\n  style?: CSSProperties;\n  className?: string;\n}\n\nfunction DefaultPanelHeader({\n  counter,\n  onDelete = () => null,\n  deleteToolTip = 'Delete',\n  onFilter = () => null,\n  filterToolTip = '',\n  filterIsActive = false,\n  counterFiltered = 0,\n  children,\n  onSettingClick = () => null,\n  showSettingButton = false,\n  canDelete = true,\n  style = {},\n  className = '',\n}: DefaultPanelHeaderProps) {\n  return (\n    <div css={styles} {...{ style, className }}>\n      <div className=\"left-container\">\n        {canDelete && (\n          <ToolTip title={deleteToolTip} popupPlacement=\"right\">\n            <button type=\"button\" onClick={onDelete} disabled={counter === 0}>\n              <FaRegTrashAlt />\n            </button>\n          </ToolTip>\n        )}\n\n        {/* Optional if there is no filter needed, e.g. in spectra panel */}\n        {filterToolTip ? (\n          <ToggleButton\n            popupTitle={filterToolTip}\n            popupPlacement=\"right\"\n            onClick={onFilter}\n            defaultValue={filterIsActive}\n          >\n            <FaFilter style={{ pointerEvents: 'none', fontSize: '12px' }} />\n          </ToggleButton>\n        ) : null}\n\n        {children}\n      </div>\n      {counter !== undefined && (\n        <p className=\"counter-label\">\n          [{' '}\n          {filterIsActive &&\n          filterIsActive === true &&\n          counterFiltered !== undefined\n            ? `${counterFiltered}/${counter}`\n            : counter}{' '}\n          ]\n        </p>\n      )}\n      {showSettingButton && (\n        <ToolTip title=\"preferences\" popupPlacement=\"left\">\n          <button type=\"button\" onClick={onSettingClick}>\n            <FaCog />\n          </button>\n        </ToolTip>\n      )}\n    </div>\n  );\n}\n\nexport default memo(DefaultPanelHeader);\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport {\n  useState,\n  useImperativeHandle,\n  useCallback,\n  useRef,\n  useEffect,\n  forwardRef,\n} from 'react';\nimport { createPortal } from 'react-dom';\n\nimport { useGlobal } from '../context/GlobalContext';\n\nconst styles = css`\n  box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.25);\n  padding: 0px;\n  margin: 0px;\n  border-radius: 2px;\n  display: flex;\n  flex-direction: column;\n  position: fixed;\n  z-index: 99999;\n  padding: 2px;\n  background-color: white;\n  width: 150px;\n  pointer-events: all;\n\n  button {\n    background-color: transparent;\n    border: none;\n    border-bottom: 0.55px solid #f0f0f0;\n    font-size: 11px;\n    padding: 5px;\n    text-align: left;\n    outline: none;\n  }\n  button:hover {\n    background-color: #fafafa;\n    outline: none;\n  }\n\n  button:active {\n    background-color: #eaeaea;\n    outline: none;\n  }\n\n  button:last-of-type {\n    border: none;\n  }\n`;\n\n// TODO: remove this hacky ref usage.\nfunction ContextMenu({ context }, ref: any) {\n  const [position, setPosition] = useState<{ left: any; top: any }>({\n    left: 0,\n    top: 0,\n  });\n  const { rootRef, elementsWrapperRef } = useGlobal();\n  const [data, setData] = useState();\n  const [isVisible, show] = useState<boolean>();\n  const [sourceElement, setSourceElement] = useState(null);\n  const root = useRef<any>();\n\n  useEffect(() => {\n    root.current = document.createElement('div');\n    if (elementsWrapperRef) {\n      elementsWrapperRef.appendChild(root.current);\n    }\n    return () => {\n      if (root.current && elementsWrapperRef) {\n        elementsWrapperRef.removeChild(root.current);\n      }\n    };\n  }, [elementsWrapperRef]);\n\n  const contextMenuHandler = (event) => {\n    event.preventDefault();\n    setSourceElement(event.target.parentElement);\n    show(true);\n    const clickX = event.clientX;\n    const clickY = event.clientY;\n\n    const screenW = window.innerWidth;\n    const screenH = window.innerHeight;\n    const rootW = 150;\n    const rootH = 0;\n\n    const right = screenW - clickX > rootW;\n    let left: any = !right;\n    let top: any = screenH - clickY > rootH;\n    const bottom = !top;\n    if (right) {\n      left = `${clickX + 5}px`;\n    }\n\n    if (left) {\n      left = `${clickX - rootW - 5}px`;\n    }\n\n    if (top) {\n      top = `${clickY + 5}px`;\n    }\n\n    if (bottom) {\n      top = `${clickY - rootH - 5}px`;\n    }\n\n    setPosition({ left, top });\n  };\n\n  useImperativeHandle(ref, () => ({\n    handleContextMenu: (e, _data) => {\n      setData(_data);\n      contextMenuHandler(e);\n    },\n  }));\n\n  const clickHandler = useCallback(\n    (event, click) => {\n      event.preventDefault();\n      click(data);\n      show(false);\n    },\n    [data],\n  );\n\n  useEffect(() => {\n    const _handleGlobalClick = (event) => {\n      const wasOutside =\n        sourceElement &&\n        event.target.parentElement &&\n        !event.target.parentElement.isSameNode(sourceElement);\n      if (wasOutside && isVisible) show(false);\n    };\n    if (rootRef) {\n      rootRef.addEventListener('click', _handleGlobalClick);\n    }\n    return () => {\n      if (rootRef) {\n        rootRef.removeEventListener('click', _handleGlobalClick);\n      }\n    };\n  }, [isVisible, ref, rootRef, sourceElement]);\n\n  if (!isVisible) {\n    return null;\n  }\n\n  return (\n    root.current &&\n    createPortal(\n      context && (\n        <div ref={ref} css={[styles, position]}>\n          {context.map((c, index) => (\n            <button\n              // eslint-disable-next-line react/no-array-index-key\n              key={index}\n              type=\"button\"\n              onClick={(e) => clickHandler(e, c.onClick)}\n            >\n              {c.label}\n            </button>\n          ))}\n        </div>\n      ),\n      root.current,\n    )\n  );\n}\n\nexport default forwardRef(ContextMenu);\n","import { memo } from 'react';\n\ninterface ReactTableHeaderProps {\n  headerGroups: any;\n}\n\nfunction ReactTableHeader({ headerGroups }: ReactTableHeaderProps) {\n  return (\n    <thead>\n      {headerGroups.map((headerGroup) => (\n        <tr\n          key={headerGroup.getHeaderGroupProps().key}\n          {...headerGroup.getHeaderGroupProps()}\n        >\n          {headerGroup.headers.map((column) => (\n            <th\n              key={column.getHeaderProps().key}\n              {...column.getHeaderProps(column.getSortByToggleProps())}\n              style={column.style}\n            >\n              {column.render('Header')}\n              <span>\n                {column.isSorted ? (column.isSortedDesc ? ' ▼' : ' ▲') : ''}\n              </span>\n            </th>\n          ))}\n        </tr>\n      ))}\n    </thead>\n  );\n}\n\nexport default memo(ReactTableHeader);\n","import { css } from '@emotion/react';\n\nconst HighlightedRowStyle = css`\n  background-color: #ff6f0057;\n`;\n\nconst ConstantlyHighlightedRowStyle = css`\n  background-color: #f5f5dc;\n`;\n\nconst ReactTableStyle = css`\n  border-spacing: 0;\n  border: 1px solid #dedede;\n  width: 100%;\n  max-height: 100%;\n  font-size: 12px;\n\n  .react-contextmenu-wrapper {\n    display: contents;\n  }\n\n  tr {\n    :last-child {\n      td {\n        border-bottom: 0;\n      }\n    }\n  }\n\n  th {\n    position: sticky;\n    background-color: white;\n    z-index: 0;\n    top: 0;\n  }\n  th,\n  td {\n    margin: 0;\n    padding: 0.15rem 0.4rem;\n    border-bottom: 1px solid #dedede;\n    border-right: 1px solid #dedede;\n\n    // :last-child {\n    //   border-right: 0;\n    // }\n    button {\n      background-color: transparent;\n      border: none;\n    }\n  }\n`;\n\nexport { ReactTableStyle, HighlightedRowStyle, ConstantlyHighlightedRowStyle };\n","/** @jsxImportSource @emotion/react */\n\nimport { useMemo, forwardRef, useEffect } from 'react';\n\nimport { HighlightedSource, useHighlight } from '../../../highlight/index';\nimport { HighlightedRowStyle, ConstantlyHighlightedRowStyle } from '../Style';\n\ninterface ReactTableRowProps {\n  row: any;\n  highlightedSource?: HighlightedSource;\n  onContextMenu: () => void;\n  isVisible: boolean;\n}\n\nfunction getIDs(row: any): string[] {\n  const id = row.original.id;\n  if (id) {\n    if (id instanceof Array) {\n      return id;\n    } else {\n      return [String(id)];\n    }\n  }\n  return [''];\n}\nfunction ReactTableRow(props: ReactTableRowProps, ref) {\n  const {\n    row,\n    highlightedSource = HighlightedSource.UNKNOWN,\n    onContextMenu,\n  } = props;\n  const data = useMemo(\n    () => ({\n      type: highlightedSource,\n      extra: row.original,\n    }),\n    [highlightedSource, row],\n  );\n  const highlight = useHighlight(getIDs(row), data);\n\n  useEffect(() => {\n    return () => {\n      highlight.hide();\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  return useMemo(() => {\n    return (\n      <tr\n        ref={ref}\n        onContextMenu={onContextMenu}\n        key={row.getRowProps().key}\n        css={\n          highlight.isActive\n            ? HighlightedRowStyle\n            : Object.prototype.hasOwnProperty.call(\n                row.original,\n                'isConstantlyHighlighted',\n              ) && row.original.isConstantlyHighlighted === true\n            ? ConstantlyHighlightedRowStyle\n            : null\n        }\n        {...row.getRowProps()}\n        {...highlight.onHover}\n      >\n        {row.cells.map((cell) => {\n          const { style, padding } = cell.column;\n\n          if (cell.isRowSpanned) {\n            return null;\n          } else {\n            return (\n              <td\n                rowSpan={cell.rowSpan}\n                key={cell.key}\n                {...cell.getCellProps()}\n                onContextMenu={(e) => {\n                  e.preventDefault();\n\n                  return false;\n                }}\n                style={{ padding, ...style }}\n              >\n                {cell.render('Cell')}\n              </td>\n            );\n          }\n        })}\n      </tr>\n    );\n  }, [highlight.isActive, highlight.onHover, onContextMenu, ref, row]);\n}\n\nexport default forwardRef(ReactTableRow);\n","import { createContext, useContext } from 'react';\n\nimport { TableVirtualConfig } from '../ReactTable';\n\nconst reactContext = createContext<TableVirtualConfig | null>(null);\nexport const ReactTableProvider = reactContext.Provider;\n\nexport function useReactTableContext() {\n  const context = useContext(reactContext);\n  if (!context) {\n    throw new Error('react table context was not found ');\n  }\n  return context;\n}\n","export default function useRowSpan(hooks) {\n  hooks.useInstance.push(reducer);\n}\n\nfunction reducer(instance) {\n  const { allColumns } = instance;\n\n  let rowSpanHeaders: any[] = [];\n\n  allColumns.forEach((column) => {\n    const { id, enableRowSpan } = column;\n\n    if (enableRowSpan !== undefined && enableRowSpan !== false) {\n      rowSpanHeaders.push({ id, cellValue: null, cellIndex: 0 });\n    }\n  });\n\n  Object.assign(instance, {\n    rowSpanHeaders,\n  });\n}\n\nexport function prepareRowSpan(rows, index, rowSpanHeaders, groupKey?: string) {\n  const row = rows[index];\n  for (let j = 0; j < row.allCells.length; j++) {\n    const cell = row.allCells[j];\n    const rowSpanHeader = rowSpanHeaders.find((x) => x.id === cell.column.id);\n    if (rowSpanHeader !== undefined) {\n      const cellValue = groupKey\n        ? `${cell.value}-${row.original[groupKey]}`\n        : cell.value;\n\n      if (\n        rowSpanHeader.cellValue === null ||\n        rowSpanHeader.cellValue !== cellValue\n      ) {\n        cell.isRowSpanned = false;\n        rowSpanHeader.cellValue = cellValue;\n        rowSpanHeader.cellIndex = index;\n        cell.rowSpan = 1;\n      } else {\n        rows[rowSpanHeader.cellIndex].allCells[j].rowSpan++;\n        cell.isRowSpanned = true;\n      }\n    }\n  }\n}\n","/** @jsxImportSource @emotion/react */\nimport {\n  useRef,\n  useCallback,\n  memo,\n  forwardRef,\n  useState,\n  Ref,\n  useEffect,\n  UIEvent,\n} from 'react';\nimport { useTable, useSortBy } from 'react-table';\nimport { useMeasure } from 'react-use';\n\nimport checkModifierKeyActivated from '../../../data/utilities/checkModifierKeyActivated';\nimport { HighlightedSource } from '../../highlight';\nimport useCombinedRefs from '../../hooks/useCombinedRefs';\nimport ContextMenu from '../ContextMenu';\n\nimport ReactTableHeader from './Elements/ReactTableHeader';\nimport ReactTableRow from './Elements/ReactTableRow';\nimport { ReactTableStyle } from './Style';\nimport {\n  ReactTableProvider,\n  useReactTableContext,\n} from './utility/ReactTableContext';\nimport useRowSpan, { prepareRowSpan } from './utility/useRowSpan';\n\ninterface ReactTableProps {\n  data: any;\n  columns: any;\n  highlightedSource?: HighlightedSource;\n  context?: Array<{ label: string; onClick: () => void }> | null;\n  approxItemHeight?: number;\n  groupKey?: string;\n  enableVirtualScroll?: boolean;\n}\n\ninterface ReactTableInnerProps extends ReactTableProps {\n  onScroll: (event: UIEvent<HTMLDivElement>) => void;\n}\n\nconst styles = {\n  table: (enableVirtualScroll: boolean) => {\n    if (enableVirtualScroll) {\n      return { position: 'sticky', top: 0 };\n    }\n  },\n};\n\nconst ReactTableInner = forwardRef(function ReactTableInner(\n  props: ReactTableInnerProps,\n  ref: Ref<HTMLDivElement>,\n) {\n  const {\n    data,\n    columns,\n    highlightedSource,\n    context = null,\n    onScroll,\n    approxItemHeight = 40,\n    enableVirtualScroll = false,\n    groupKey,\n  } = props;\n\n  const contextRef = useRef<any>(null);\n  const { index: indexBoundary } = useReactTableContext();\n\n  const {\n    getTableProps,\n    getTableBodyProps,\n    headerGroups,\n    rows,\n    prepareRow,\n    rowSpanHeaders,\n  } = useTable(\n    {\n      columns,\n      data,\n    },\n    useSortBy,\n    useRowSpan,\n  );\n  const contextMenuHandler = useCallback(\n    (e, row) => {\n      if (!checkModifierKeyActivated(e)) {\n        e.preventDefault();\n        contextRef.current.handleContextMenu(e, row.original);\n      }\n    },\n    [contextRef],\n  );\n\n  const rowsData = enableVirtualScroll\n    ? rows.slice(indexBoundary.start, indexBoundary.end)\n    : rows;\n\n  return (\n    <div\n      ref={ref}\n      className=\"table-container\"\n      style={{\n        overflowY: 'auto',\n        position: 'relative',\n        height: '100%',\n      }}\n      {...(enableVirtualScroll && { onScroll })}\n    >\n      {enableVirtualScroll && (\n        <div\n          style={{\n            height: approxItemHeight * data.length,\n            position: 'absolute',\n            width: '100%',\n            pointerEvents: 'none',\n          }}\n        />\n      )}\n      <table\n        {...getTableProps()}\n        css={ReactTableStyle}\n        style={styles.table(enableVirtualScroll)}\n      >\n        <ReactTableHeader headerGroups={headerGroups} />\n        <tbody {...getTableBodyProps()}>\n          {rowsData.map((row, index) => {\n            prepareRow(row);\n            prepareRowSpan(\n              rows,\n              enableVirtualScroll ? index + indexBoundary.start : index,\n              rowSpanHeaders,\n              groupKey,\n            );\n\n            return (\n              <ReactTableRow\n                key={row.key}\n                row={row}\n                {...row.getRowProps()}\n                onContextMenu={(e) => contextMenuHandler(e, row)}\n                highlightedSource={highlightedSource}\n              />\n            );\n          })}\n        </tbody>\n      </table>\n      <ContextMenu ref={contextRef} context={context} />\n    </div>\n  );\n});\n\nexport interface TableVirtualConfig {\n  offsetHeight: number;\n  scrollHeight: number;\n  numberOfVisibleRows: number;\n  index: { start: number; end: number };\n}\n\nfunction ReactTable(props: ReactTableProps) {\n  const { data, approxItemHeight = 40, groupKey } = props;\n  const ref = useRef<HTMLDivElement | null>(null);\n  const [mRef, { height }] = useMeasure();\n  const combineRef = useCombinedRefs([mRef, ref]);\n\n  const [tableVirtualConfig, setTableVirtualConfig] =\n    useState<TableVirtualConfig>({\n      offsetHeight: 0,\n      scrollHeight: 0,\n      numberOfVisibleRows: 0,\n      index: { start: 0, end: 0 },\n    });\n\n  useEffect(() => {\n    if (combineRef.current) {\n      const { scrollHeight } = combineRef.current;\n      const numberOfVisibleRows = Math.ceil(height / approxItemHeight);\n      setTableVirtualConfig((prev) => ({\n        ...prev,\n        offsetHeight: height,\n        scrollHeight,\n        numberOfVisibleRows,\n        index: { start: 0, end: numberOfVisibleRows + 1 },\n      }));\n    }\n  }, [approxItemHeight, combineRef, height]);\n\n  const lookForGroupIndex = useCallback(\n    (currentIndex: number, side: 1 | -1) => {\n      const currentItem = data[currentIndex];\n      if (currentItem.index && groupKey) {\n        switch (side) {\n          case -1: {\n            let index = currentIndex - 1;\n            while (index > 0) {\n              if (data[index][groupKey] !== currentItem[groupKey]) {\n                return index + 1;\n              }\n              index--;\n            }\n            return currentIndex;\n          }\n          case 1: {\n            let index = currentIndex + 1;\n            while (index < data.length) {\n              if (data[index][groupKey] !== currentItem[groupKey]) {\n                return index - 1;\n              }\n              index++;\n            }\n            return currentIndex;\n          }\n          default:\n            return currentIndex;\n        }\n      }\n\n      return currentIndex;\n    },\n    [data, groupKey],\n  );\n\n  const findStartIndex = useCallback(\n    (index: number, numberOfVisibleRows: number) => {\n      const newIndex = index - numberOfVisibleRows;\n      const currentIndx = newIndex >= data.length ? newIndex : index;\n      // return currentIndx;\n      // Look for the first index of the group\n      return lookForGroupIndex(currentIndx, -1);\n    },\n    [data.length, lookForGroupIndex],\n  );\n  const findEndIndex = useCallback(\n    (index: number, numberOfVisibleRows: number) => {\n      const newIndex = index + numberOfVisibleRows;\n      const currentIndx = newIndex >= data.length ? data.length - 1 : newIndex;\n      // return currentIndx;\n      // Look for the last index of the group\n      return lookForGroupIndex(currentIndx, 1);\n    },\n    [data.length, lookForGroupIndex],\n  );\n\n  const scrollHandler = useCallback(() => {\n    if (ref.current && tableVirtualConfig) {\n      const { scrollTop } = ref.current;\n      const { numberOfVisibleRows, index } = tableVirtualConfig;\n      const currentIndx = Math.ceil(scrollTop / approxItemHeight);\n      const start = findStartIndex(currentIndx, numberOfVisibleRows);\n\n      if (currentIndx !== index.start) {\n        const end = findEndIndex(currentIndx, numberOfVisibleRows);\n        setTableVirtualConfig({\n          ...tableVirtualConfig,\n          index: { start, end: end + 1 },\n        });\n      }\n    }\n  }, [approxItemHeight, findEndIndex, findStartIndex, tableVirtualConfig]);\n\n  return (\n    <ReactTableProvider value={tableVirtualConfig}>\n      <ReactTableInner\n        onScroll={scrollHandler}\n        ref={combineRef}\n        {...{ ...props }}\n      />\n    </ReactTableProvider>\n  );\n}\n\nexport default memo(ReactTable);\n","import { CSSProperties } from 'react';\n\nconst styles: Record<'label' | 'container', CSSProperties> = {\n  container: {\n    height: '100%',\n    backgroundColor: 'white',\n  },\n  label: {\n    textAlign: 'center',\n    width: '100%',\n    fontSize: '11px',\n    padding: '5px',\n    color: 'gray',\n  },\n};\n\n// placeholder for empty tables if no data is available to show (e.g. peaks, integrals, ranges)\nfunction NoTableData() {\n  return (\n    <div style={styles.container}>\n      <p style={styles.label}>No Data</p>\n    </div>\n  );\n}\n\nexport default NoTableData;\n","import { SvgNmrAssignment } from 'cheminfo-font';\nimport { useCallback, useMemo, memo } from 'react';\n\nimport { useDispatch } from '../../context/DispatchContext';\nimport ReactTable from '../../elements/ReactTable/ReactTable';\nimport { CustomColumn } from '../../elements/ReactTable/utility/addCustomColumn';\nimport { SET_AUTOMATIC_ASSIGNMENTS } from '../../reducer/types/Types';\nimport NoTableData from '../extra/placeholder/NoTableData';\n\nimport { AutoAssignmentsData } from './useGetAssignments';\n\ninterface AutomaticAssignmentTableProps {\n  data: AutoAssignmentsData[];\n}\n\nfunction PeaksTable({ data }: AutomaticAssignmentTableProps) {\n  const dispatch = useDispatch();\n\n  const assignHandler = useCallback(\n    (e, row) => {\n      e.preventDefault();\n      e.stopPropagation();\n      const assignments = row.original.assignment;\n      dispatch({\n        type: SET_AUTOMATIC_ASSIGNMENTS,\n        payload: { assignments },\n      });\n    },\n    [dispatch],\n  );\n\n  const COLUMNS: CustomColumn[] = useMemo(\n    () => [\n      {\n        index: 1,\n        Header: '#',\n        Cell: ({ row }) => row.index + 1,\n        style: { width: '1%', maxWidth: '40px', minWidth: '40px' },\n      },\n      {\n        index: 2,\n        Header: 'Score',\n        accessor: 'score',\n      },\n      {\n        index: 3,\n        Header: '',\n        style: {\n          width: '1%',\n          maxWidth: '24px',\n          minWidth: '24px',\n        },\n        id: 'assign-button',\n        Cell: ({ row }) => (\n          <button\n            type=\"button\"\n            className=\"assign-button\"\n            onClick={(e) => assignHandler(e, row)}\n          >\n            <SvgNmrAssignment />\n          </button>\n        ),\n      },\n    ],\n    [assignHandler],\n  );\n\n  return data && data.length > 0 ? (\n    <ReactTable data={data} columns={COLUMNS} />\n  ) : (\n    <NoTableData />\n  );\n}\n\nexport default memo(PeaksTable);\n","import {\n  getAssignments as getAssignmentsData,\n  SpectraData,\n  SpectraData1D,\n  SpectraData2D,\n} from 'nmr-processing';\nimport OCL from 'openchemlib/full';\nimport { useCallback, useMemo, useState } from 'react';\n\nimport { Datum1D } from '../../../data/types/data1d';\nimport { Datum2D } from '../../../data/types/data2d/Datum2D';\nimport { useChartData } from '../../context/ChartContext';\nimport { useAlert } from '../../elements/popup/Alert';\n\nexport interface AutoAssignmentsData {\n  score: number;\n  assignment: (SpectraData1D | SpectraData2D)[];\n}\n\nfunction mapSpectra(data: (Datum1D | Datum2D)[]) {\n  return data.reduce<SpectraData[]>((acc, spectrum) => {\n    const { id, info } = spectrum;\n    const dimension = spectrum.info.dimension;\n    if (dimension === 1) {\n      const ranges = (spectrum as Datum1D).ranges.values;\n      acc.push({ id, info, ranges });\n    } else if (dimension === 2) {\n      const zones = (spectrum as Datum2D).zones.values;\n      acc.push({ id, info, zones });\n    }\n    return acc;\n  }, []);\n}\n\nexport function useGetAssignments() {\n  const { data, molecules } = useChartData();\n  const alert = useAlert();\n  const [assignments, setAssignments] = useState<AutoAssignmentsData[]>([]);\n\n  const getAssignments = useCallback(() => {\n    void (async () => {\n      const hideLoading = await alert.showLoading('Auto Assignments');\n      const molecule = OCL.Molecule.fromMolfile(molecules[0]?.molfile || '');\n      const spectra = mapSpectra(data);\n      const result = await getAssignmentsData(\n        {\n          spectra,\n          molecule,\n        },\n        { minScore: 0 },\n      );\n      hideLoading();\n      setAssignments(result);\n    })();\n  }, [alert, data, molecules]);\n\n  return useMemo(\n    () => ({\n      getAssignments,\n      assignments,\n    }),\n\n    [assignments, getAssignments],\n  );\n}\n","/** @jsxImportSource @emotion/react */\nimport { SvgNmrAssignment2 } from 'cheminfo-font';\n\nimport Button from '../../elements/ButtonToolTip';\nimport { tablePanelStyle } from '../extra/BasicPanelStyle';\nimport DefaultPanelHeader from '../header/DefaultPanelHeader';\n\nimport AutomaticAssignmentTable from './AutomaticAssignmentTable';\nimport { useGetAssignments } from './useGetAssignments';\n\nfunction AutomaticAssignment() {\n  const { getAssignments, assignments } = useGetAssignments();\n  return (\n    <div css={tablePanelStyle}>\n      {\n        <DefaultPanelHeader showSettingButton={false} canDelete={false}>\n          <Button popupTitle=\"automatic assignment\" onClick={getAssignments}>\n            <SvgNmrAssignment2 style={{ fontSize: '18px' }} />\n          </Button>\n        </DefaultPanelHeader>\n      }\n\n      <div className=\"inner-container\">\n        <AutomaticAssignmentTable data={assignments} />\n      </div>\n    </div>\n  );\n}\n\nexport default AutomaticAssignment;\n","/** @jsxImportSource @emotion/react */\n\nimport { memo } from 'react';\nimport { useTable, useSortBy, useFlexLayout } from 'react-table';\n\nimport { ReactTableStyle } from './Style';\n\ninterface ReactTableFlexLayoutProps {\n  data: any;\n  columns: any;\n  onMouseDown?: () => void;\n}\n\nfunction ReactTableFlexLayout({\n  data,\n  columns,\n  onMouseDown = () => null,\n}: ReactTableFlexLayoutProps) {\n  const { getTableProps, getTableBodyProps, headerGroups, rows, prepareRow } =\n    useTable(\n      {\n        columns,\n        data,\n      },\n      useSortBy,\n      useFlexLayout,\n    );\n  return (\n    <table\n      {...getTableProps()}\n      css={ReactTableStyle}\n      style={{ height: '100%' }}\n    >\n      <thead>\n        {headerGroups.map((headerGroup) => (\n          <tr\n            key={headerGroup.getHeaderGroupProps().key}\n            {...headerGroup.getHeaderGroupProps()}\n          >\n            {headerGroup.headers.map((column) => (\n              <th\n                key={column.getHeaderProps().key}\n                {...column.getHeaderProps(column.getSortByToggleProps())}\n              >\n                {column.render('Header')}\n                <span>\n                  {column.isSorted ? (column.isSortedDesc ? ' ▼' : ' ▲') : ''}\n                </span>\n              </th>\n            ))}\n          </tr>\n        ))}\n      </thead>\n      <tbody\n        {...getTableBodyProps()}\n        style={{ display: 'block', height: '100%', overflowY: 'auto' }}\n      >\n        {rows.map((row) => {\n          prepareRow(row);\n          return (\n            <tr\n              key={row.getRowProps().key}\n              {...row.getRowProps()}\n              onMouseDown={onMouseDown}\n            >\n              {row.cells.map((cell) => {\n                return (\n                  <td\n                    key={cell.getCellProps().key}\n                    {...cell.getCellProps()}\n                    style={{ ...cell.getCellProps().style, padding: '0px' }}\n                  >\n                    {cell.render('Cell')}\n                  </td>\n                );\n              })}\n            </tr>\n          );\n        })}\n      </tbody>\n    </table>\n  );\n}\n\nexport default memo(ReactTableFlexLayout);\n","import {\n  useState,\n  useCallback,\n  useEffect,\n  memo,\n  useMemo,\n  useRef,\n  CSSProperties,\n} from 'react';\n\nimport ReactTableFlexLayout from '../elements/ReactTable/ReactTableFlexLayout';\nimport useSpectrum from '../hooks/useSpectrum';\n\nconst styles: Record<\n  'container' | 'tableContainer' | 'searchInput',\n  CSSProperties\n> = {\n  container: {\n    height: '100%',\n    flexDirection: 'column',\n    display: 'flex',\n    width: '100%',\n  },\n  tableContainer: {\n    height: 'calc(100% - 30px)',\n    overflow: 'auto',\n    display: 'block',\n  },\n\n  searchInput: {\n    width: '100%',\n    borderRadius: '5px',\n    border: '0.55px solid gray',\n    padding: '5px',\n    marginBottom: '2px',\n  },\n};\n\ninterface InformationPanelInnerProps {\n  info: any;\n  meta: any;\n}\n\nfunction InformationPanelInner({ info, meta }: InformationPanelInnerProps) {\n  const [information, setInformation] = useState({});\n  const [matches, setMatchesData] = useState<string[]>([]);\n  const searchRef = useRef<HTMLInputElement>(null);\n\n  const handleSearch = useCallback(\n    (e) => {\n      const values = Object.keys(information).filter((key) =>\n        key\n          .toLowerCase()\n          .includes(e.target ? e.target.value.toLowerCase() : e.toLowerCase()),\n      );\n      setMatchesData(values);\n    },\n    [information],\n  );\n\n  useEffect(() => {\n    if (searchRef.current) {\n      handleSearch(searchRef.current.value);\n    }\n  }, [handleSearch, searchRef]);\n\n  useEffect(() => {\n    if (info && meta) {\n      const keys = Object.keys(info).concat(Object.keys(meta));\n      setMatchesData(keys);\n      setInformation({\n        ...info,\n        ...meta,\n      });\n    }\n  }, [info, meta]);\n\n  const columns = useMemo(\n    () => [\n      {\n        Header: 'Parameter',\n        sortType: 'basic',\n        minWidth: 100,\n        width: 20,\n        maxWidth: 20,\n        Cell: ({ row }) => (\n          <p style={{ padding: '5px', backgroundColor: 'white' }}>\n            {row.original}\n          </p>\n        ),\n      },\n      {\n        Header: 'Value',\n        sortType: 'basic',\n        resizable: true,\n        Cell: ({ row }) => (\n          <p\n            style={{\n              backgroundColor: '#efefef',\n              height: '100%',\n              padding: '5px',\n              fontFamily: 'monospace',\n              whiteSpace: 'pre',\n              overflow: 'hidden',\n            }}\n          >\n            {`${information[row.original]}`}\n          </p>\n        ),\n      },\n    ],\n    [information],\n  );\n\n  return (\n    <div style={styles.container}>\n      <div>\n        <input\n          type=\"text\"\n          style={styles.searchInput}\n          placeholder=\"Search for parameter...\"\n          onChange={handleSearch}\n          ref={searchRef}\n        />\n      </div>\n      <div style={styles.tableContainer}>\n        <ReactTableFlexLayout data={matches} columns={columns} />\n      </div>\n    </div>\n  );\n}\n\nconst MemoizedInformationPanel = memo(InformationPanelInner);\n\nconst emptyData = { info: {}, meta: {} };\n\nexport default function InformationPanel() {\n  const { info, meta } = useSpectrum(emptyData);\n\n  return <MemoizedInformationPanel {...{ info, meta }} />;\n}\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { FaTimes } from 'react-icons/fa';\n\nconst styles = css`\n  border-radius: 50%;\n  width: 16px;\n  height: 16px;\n  background-color: transparent;\n  border: none;\n  padding: 0;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n\n  :hover {\n    background-color: red;\n    border-radius: 50%;\n\n    .icon {\n      color: white;\n    }\n  }\n\n  .icon {\n    color: #252525;\n    width: 8px;\n  }\n`;\n\ninterface DeleteButtonProps {\n  onDelete: (element: React.MouseEvent<HTMLButtonElement, MouseEvent>) => void;\n  className?: string;\n}\n\nfunction DeleteButton({ onDelete, className = 'delete' }: DeleteButtonProps) {\n  return (\n    <button css={styles} className={className} type=\"button\" onClick={onDelete}>\n      <FaTimes className=\"icon\" />\n    </button>\n  );\n}\n\nexport default DeleteButton;\n","/** @jsxImportSource @emotion/react */\nimport { css, SerializedStyles } from '@emotion/react';\nimport { CSSProperties, ReactNode, useCallback } from 'react';\n\nimport DeleteButton from './DeleteButton';\n\nconst styles = (styles) => css`\n  position: relative;\n\n  .delete {\n    position: absolute;\n    top: 2px;\n    left: 2px;\n  }\n\n  ${styles}\n`;\n\nexport interface InternalTabProps {\n  tabid: string;\n  tablabel?: string;\n  isActive: boolean;\n  tabstyles?: CSSProperties | SerializedStyles;\n  canDelete?: boolean;\n  onDelete?: (element: any) => void;\n  onClick?: (element: any) => void;\n  render?: ({\n    isActive,\n    title,\n    id,\n  }: {\n    isActive: boolean;\n    title: string;\n    id: string | number;\n  }) => any;\n}\n\n/* eslint-disable react/no-unused-prop-types */\nexport interface TabProps {\n  tabid: string;\n  tablabel?: string;\n  canDelete?: boolean;\n  onDelete?: (element: any) => void;\n  tabstyles?: CSSProperties | SerializedStyles;\n  children: ReactNode;\n  render?: () => ReactNode;\n  className?: string;\n}\n/* eslint-enable react/no-unused-prop-types */\n\nexport function InternalTab({\n  tabid,\n  tablabel,\n  isActive,\n  onClick = () => null,\n  canDelete,\n  onDelete = () => null,\n  tabstyles,\n  render,\n}: InternalTabProps) {\n  let className = 'tab-list-item';\n\n  // use tab identifier if given (higher priority)\n  if (isActive) {\n    className += ' tab-list-active';\n  }\n\n  const clickHandler = useCallback(\n    (e) => {\n      onClick({ ...e, tablabel, tabid });\n    },\n    [onClick, tablabel, tabid],\n  );\n\n  const deleteHandler = useCallback(\n    (e) => {\n      // stop propagation here to not have set it\n      // as active tab too (via tab click event triggering)\n      e.stopPropagation();\n      onDelete({ ...e, tablabel, tabid });\n    },\n    [onDelete, tablabel, tabid],\n  );\n\n  return (\n    <li\n      className={className}\n      onClick={clickHandler}\n      css={styles(tabstyles)}\n      data-test-id={`tab-${tabid}`}\n    >\n      {canDelete && <DeleteButton onDelete={deleteHandler} />}\n      {render\n        ? render({ isActive, title: tablabel || '', id: tabid })\n        : tablabel}\n    </li>\n  );\n}\n\nexport default function Tab(props: TabProps) {\n  return <>{props.children}</>;\n}\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport {\n  isValidElement,\n  useCallback,\n  useMemo,\n  Children,\n  memo,\n  ReactElement,\n} from 'react';\n\nimport { InternalTab, TabProps } from './Tab';\n\nconst topStyles = css`\n  height: 100%;\n  width: 100%;\n  display: flex;\n  flex-direction: column;\n\n  .tab-list {\n    border-bottom: 1px solid #ccc;\n    padding-left: 0;\n    margin: 0;\n  }\n\n  .tab-list li:first-of-type {\n    margin-left: 5px;\n  }\n\n  .tab-list li:hover {\n    background-color: #f7f7f7;\n  }\n\n  .tab-list-item {\n    display: inline-block;\n    list-style: none;\n    padding: 0.5rem 2rem;\n  }\n\n  .tab-list-active {\n    background-color: white;\n    border: solid #ccc;\n    border-width: 1px 1px 0 1px;\n  }\n\n  .tab-content {\n    height: 100%;\n    overflow: auto;\n  }\n`;\n\nconst leftStyles = css`\n  display: flex;\n  height: 100%;\n  width: 100%;\n  .tab-list {\n    border-right: 1px solid #ccc;\n    padding-left: 0;\n    margin: 0;\n  }\n\n  .tab-list li:hover {\n    background-color: #f7f7f7;\n  }\n\n  .tab-list li:first-of-type {\n    margin-top: 10px;\n  }\n\n  .tab-list-item {\n    display: block;\n    list-style: none;\n    margin-right: -1px;\n    padding: 0.5rem 0.75rem;\n  }\n\n  .tab-list-active {\n    background-color: white;\n    border: solid #ccc;\n    border-width: 1px 0px 1px 1px;\n  }\n\n  .tab-content {\n    height: 100%;\n    overflow: auto;\n  }\n`;\n\nexport enum PositionsEnum {\n  TOP = 'TOP',\n  LEFT = 'LEFT',\n}\n\ninterface TabsProps {\n  children: Array<ReactElement<TabProps> | boolean>;\n  onClick: (element: any) => void;\n  activeTab: string;\n  position?: PositionsEnum;\n  onDelete?: (element: any) => void;\n}\n\nfunction Tabs({\n  children,\n  onClick,\n  position,\n  onDelete = () => null,\n  activeTab,\n}: TabsProps) {\n  const onClickTabHandler = useCallback(\n    (tab) => {\n      const { tablabel, tabid } = tab;\n      onClick({ tablabel, tabid });\n    },\n    [onClick],\n  );\n\n  let contentChild;\n  const tabs = Children.map(children, (child) => {\n    if (!isValidElement(child)) return null;\n\n    const { tabid } = child.props;\n\n    if (tabid === activeTab) {\n      contentChild = child.props.children;\n    }\n\n    return (\n      <InternalTab\n        {...child.props}\n        isActive={tabid === activeTab}\n        onClick={onClickTabHandler}\n        onDelete={onDelete}\n      />\n    );\n  });\n\n  const styles = useMemo(() => {\n    switch (position) {\n      case PositionsEnum.TOP:\n        return topStyles;\n      case PositionsEnum.LEFT:\n        return leftStyles;\n      default:\n        return topStyles;\n    }\n  }, [position]);\n\n  return (\n    <div className=\"tabs\" css={styles}>\n      <ol className=\"tab-list\">{tabs}</ol>\n      <div className=\"tab-content\">{contentChild}</div>\n    </div>\n  );\n}\n\nexport default memo(Tabs);\n","/** @jsxImportSource @emotion/react */\n\nimport { css } from '@emotion/react';\nimport {\n  ReactNode,\n  useState,\n  Children,\n  useMemo,\n  useEffect,\n  useCallback,\n  memo,\n} from 'react';\nimport { FaAngleLeft } from 'react-icons/fa';\nimport { useMeasure } from 'react-use';\n\ninterface ArrowProps {\n  direction: 'right' | 'left';\n  onClick: () => void;\n}\n\nfunction Arrow({ direction, onClick }: ArrowProps) {\n  return (\n    <div\n      onClick={onClick}\n      css={css`\n        display: flex;\n        position: absolute;\n        top: calc(50% - 20px);\n        ${direction === 'right' ? `right: 25px` : `left: 25px`};\n        height: 40px;\n        width: 40px;\n        justify-content: center;\n        background: white;\n        border-radius: 50%;\n        cursor: pointer;\n        align-items: center;\n        border: none;\n        transition: transform ease-in 0.1s;\n        background-color: #f7f7f7;\n\n        &:hover {\n          transform: scale(1.1);\n          background-color: #607d8b !important;\n          color: white;\n        }\n        img {\n          transform: translateX(${direction === 'left' ? '-2' : '2'}px);\n          &:focus {\n            outline: 0;\n          }\n        }\n      `}\n    >\n      <FaAngleLeft\n        style={{ transform: `scaleX(${direction === 'right' ? '-1' : '1'})` }}\n      />\n    </div>\n  );\n}\n\nconst transition = 0.45;\n\ninterface NextPrevProps {\n  children: ReactNode;\n  loop?: boolean;\n  defaultIndex?: number;\n  onChange?: (element: number) => void;\n}\n\nfunction NextPrev({\n  children,\n  loop = false,\n  defaultIndex = 0,\n  onChange = () => null,\n}: NextPrevProps) {\n  const [ref, { width }] = useMeasure<HTMLDivElement>();\n  const [activeIndex, setActiveIndex] = useState(0);\n  useEffect(() => {\n    setActiveIndex(defaultIndex);\n  }, [defaultIndex]);\n\n  const Sliders = useMemo(\n    () =>\n      Children.map(children, (child: any) => {\n        return (\n          <div\n            key={child.key}\n            css={css`\n              width: ${width}px;\n              height: 100%;\n            `}\n          >\n            {child}\n          </div>\n        );\n      }),\n    [children, width],\n  );\n\n  const nextHandler = useCallback(() => {\n    setActiveIndex((preActiveIndex) => {\n      if (Sliders && preActiveIndex === Sliders.length - 1) {\n        onChange(preActiveIndex);\n\n        if (loop) {\n          return 0;\n        } else {\n          return preActiveIndex;\n        }\n      }\n\n      const nextIndex = preActiveIndex + 1;\n      onChange(nextIndex);\n\n      return nextIndex;\n    });\n  }, [Sliders, loop, onChange]);\n\n  const prevHandler = useCallback(() => {\n    setActiveIndex((preActiveIndex) => {\n      if (preActiveIndex === 0) {\n        onChange(preActiveIndex);\n        if (loop) {\n          return 0;\n        } else {\n          return preActiveIndex;\n        }\n      }\n      const prevIndex = preActiveIndex - 1;\n\n      onChange(prevIndex);\n\n      return prevIndex;\n    });\n  }, [loop, onChange]);\n\n  if (!width && !Sliders) return null;\n  return (\n    <div\n      css={css`\n        position: relative;\n        height: 100%;\n        width: 100%;\n        margin: 0 auto;\n        overflow: hidden;\n        display: block;\n      `}\n      ref={ref}\n    >\n      <div\n        css={css`\n          transform: translateX(-${width * activeIndex}px);\n          transition: transform ease-out ${transition}s;\n          height: 100%;\n          width: ${width * (Sliders ? Sliders.length : 1)}px;\n          display: flex;\n        `}\n      >\n        {Sliders}\n      </div>\n\n      {activeIndex !== 0 && <Arrow direction=\"left\" onClick={prevHandler} />}\n      {Sliders && activeIndex !== Sliders.length - 1 && (\n        <Arrow direction=\"right\" onClick={nextHandler} />\n      )}\n    </div>\n  );\n}\n\nexport default memo(NextPrev);\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback, useEffect, useState } from 'react';\nimport MF from 'react-mf/lib/components/MF';\nimport { MolfileSvgRenderer } from 'react-ocl/full';\n\nimport { Molecule } from '../../data/molecules/Molecule';\n\nimport NextPrev from './NextPrev';\n\nconst toolbarStyle = css`\n  display: flex;\n  flex-direction: row;\n  border-top: 0.55px solid rgb(240, 240, 240);\n  border-bottom: 0.55px solid rgb(240, 240, 240);\n  padding: 0px 5px;\n\n  p {\n    margin: 0;\n    text-align: right;\n    width: 100%;\n    line-height: 22px;\n    padding: 0px 10px;\n  }\n`;\n\nconst moleculeContainerStyle = css`\n  width: 100%;\n  position: relative;\n  .slider {\n    height: 180px;\n    width: 100%;\n    padding: 0px;\n    padding: 0px;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    flex-direction: column;\n  }\n  .slider p {\n    width: 100%;\n    margin: 0 auto;\n    display: block;\n    position: relative;\n    text-align: center;\n  }\n  .slider svg polygon {\n    fill: gray !important;\n  }\n  button {\n    flex: 2;\n    padding: 5px;\n    border: 1px solid gray;\n    border-radius: 5px;\n    height: 36px;\n    margin: 0 auto;\n    margin-top: 15px;\n    display: block;\n    width: 20%;\n\n    color: white;\n    background-color: gray;\n  }\n`;\n\ninterface MoleculeSelectionProps {\n  molecules: Array<Molecule>;\n  onChange: (element: number) => void;\n  index?: number;\n}\n\nexport default function MoleculeSelection(props: MoleculeSelectionProps) {\n  const { molecules, onChange = () => null, index } = props;\n  const [currentIndex, setCurrentIndex] = useState<number>(0);\n\n  useEffect(() => {\n    const _index = index && index < molecules.length ? index : 0;\n    if (molecules && molecules.length > 0) {\n      setCurrentIndex(_index);\n    }\n  }, [index, molecules]);\n\n  const onChangeHandler = useCallback(\n    (slideIndex) => {\n      setCurrentIndex(slideIndex);\n      onChange(slideIndex);\n    },\n    [onChange],\n  );\n\n  return (\n    <div>\n      <div css={toolbarStyle}>\n        <p>\n          {molecules &&\n            molecules.length > 0 &&\n            `${+(currentIndex + 1)} / ${molecules.length}`}{' '}\n        </p>\n      </div>\n      <div css={moleculeContainerStyle}>\n        <NextPrev defaultIndex={currentIndex} onChange={onChangeHandler}>\n          {molecules?.map((mol, index) => (\n            <div key={mol.key} className=\"slider\">\n              <div>\n                {mol.molfile && (\n                  <MolfileSvgRenderer\n                    id={`molSVG${index}`}\n                    width={120}\n                    molfile={mol.molfile}\n                  />\n                )}\n              </div>\n              <p>\n                <MF mf={mol.mf} /> - {mol.mw?.toFixed(2)}\n              </p>\n            </div>\n          ))}\n        </NextPrev>\n      </div>\n    </div>\n  );\n}\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useFormikContext } from 'formik';\nimport { useCallback, useState, useEffect, useMemo } from 'react';\n\nimport getAtom from '../../../data/utilities/getAtom';\nimport { useChartData } from '../../context/ChartContext';\nimport MoleculeSelection from '../../elements/MoleculeSelection';\n\nconst styles = css`\n  .molecule-container {\n    display: flex;\n    flex-direction: column;\n    flex-grow: 1;\n    .title {\n      padding: 0px 10px;\n      width: 100%;\n      text-align: center;\n    }\n\n    .molecule-selection-container {\n      width: 450px;\n      display: block;\n      margin: 0 auto;\n    }\n\n    .newSumText {\n      margin-top: 15px;\n      padding: 0px 10px;\n      width: 100%;\n\n      text-align: center;\n    }\n  }\n\n  .empty {\n    width: 100%;\n    padding: 20%;\n    text-align: center;\n  }\n`;\n\ninterface SelectMoleculeProps {\n  name: string;\n}\n\nexport default function SelectMolecule(props: SelectMoleculeProps) {\n  const [currentIndex, setCurrentIndex] = useState<number>();\n  const { setFieldValue, errors, values } = useFormikContext<{\n    molecule: { mf: string; key: string } | null;\n    sum: number;\n  }>();\n  const { molecules, activeTab } = useChartData();\n  const element = getAtom(activeTab);\n  const newSum = useMemo(() => {\n    return element &&\n      molecules &&\n      molecules.length > 0 &&\n      currentIndex !== undefined &&\n      molecules[currentIndex].atoms[element]\n      ? molecules[currentIndex].atoms[element]\n      : 0;\n  }, [currentIndex, element, molecules]);\n\n  const setValue = useCallback(\n    (index: number) => {\n      setCurrentIndex(index);\n      setFieldValue(props.name, molecules[index]);\n    },\n    [molecules, props.name, setFieldValue],\n  );\n\n  useEffect(() => {\n    if (molecules && molecules.length > 0) {\n      const index = values[props.name]\n        ? molecules.findIndex(\n            (molecule) => molecule.key === values[props.name].key,\n          )\n        : -1;\n      setValue(index !== -1 ? index : 0);\n    }\n  }, [molecules, props.name, setValue, values]);\n\n  const onChangeMoleculeSelectionHandler = useCallback(\n    (index) => {\n      setValue(index);\n    },\n    [setValue],\n  );\n\n  return (\n    <div css={styles}>\n      {element && molecules && molecules.length > 0 ? (\n        <div className=\"molecule-container\">\n          <p className=\"title\">Select a molecule as reference!</p>\n\n          <div className=\"molecule-selection-container\">\n            <MoleculeSelection\n              index={currentIndex}\n              molecules={molecules}\n              onChange={onChangeMoleculeSelectionHandler}\n            />\n            <p className=\"newSumText\">\n              New sum for {element} will be {newSum}!\n            </p>\n          </div>\n        </div>\n      ) : (\n        <p\n          className=\"empty\"\n          style={{ color: errors[props.name] ? 'red' : 'black' }}\n        >\n          You have to Select a spectrum and Add a molecule from the Structure\n          panel to select as a reference!\n        </p>\n      )}\n    </div>\n  );\n}\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback, useEffect, useMemo, useRef, useState } from 'react';\nimport * as Yup from 'yup';\n\nimport { SumOptions } from '../../../data/types/data1d/SumOptions';\nimport { usePreferences } from '../../context/PreferencesContext';\nimport CloseButton from '../../elements/CloseButton';\nimport Tab from '../../elements/Tab/Tab';\nimport Tabs from '../../elements/Tab/Tabs';\nimport FormikForm from '../../elements/formik/FormikForm';\nimport FormikInput from '../../elements/formik/FormikInput';\nimport { ModalStyles } from '../ModalStyle';\n\nimport SelectMolecule from './SelectMolecule';\n\nconst styles = css`\n  width: 450px;\n  height: 400px;\n  .header {\n    display: flex;\n    padding: 10px;\n    span {\n      font-size: 14px;\n      flex: 1;\n    }\n  }\n\n  .tab-content {\n    flex: 1;\n  }\n\n  .manual-container {\n    padding: 30px 5px;\n\n    .input {\n      width: 80% !important;\n      height: 36px;\n      margin: 0 auto;\n    }\n    .input Input {\n      padding: 5px;\n      text-align: center;\n    }\n  }\n\n  .footer-container {\n    button {\n      width: 20%;\n      color: white;\n      background-color: gray !important;\n    }\n    button:hover {\n      border: 1px solid gray;\n      color: gray;\n      background-color: white !important;\n    }\n  }\n`;\n\nenum SumSetOptions {\n  Auto = 'auto',\n  Manual = 'manual',\n}\n\ntype SaveInput =\n  | {\n      sum: number;\n      sumAuto: false;\n    }\n  | {\n      moleculeKey: string;\n      mf: string;\n      sumAuto: true;\n    };\n\ninterface ChangeSumModalProps {\n  onSave: (saveInput: SaveInput) => void;\n  onClose: () => void;\n  header: string;\n  sumOptions: SumOptions;\n}\n\nexport default function ChangeSumModal({\n  onSave,\n  onClose,\n  header,\n  sumOptions,\n}: ChangeSumModalProps) {\n  const {\n    current: {\n      display: { general, panels },\n    },\n  } = usePreferences();\n\n  const [setOption, setActiveOption] = useState(SumSetOptions.Auto);\n  const formRef = useRef<any>(null);\n\n  const handleKeyDown = useCallback((event) => {\n    if (event.key === 'Enter') {\n      formRef.current.submitForm();\n    }\n  }, []);\n\n  const onTabChangeHandler = useCallback((tab) => {\n    setActiveOption(tab.tabid);\n  }, []);\n\n  useEffect(() => {\n    if (\n      sumOptions?.sumAuto &&\n      !general?.hideSetSumFromMolecule &&\n      !panels?.structuresPanel?.hidden\n    ) {\n      setActiveOption(SumSetOptions.Auto);\n      const { mf, moleculeKey: key } = sumOptions;\n      formRef.current.setValues({\n        sum: null,\n        molecule: key && mf ? { mf, key } : null,\n      });\n    } else {\n      setActiveOption(SumSetOptions.Manual);\n      formRef.current.setValues({ sum: sumOptions?.sum || '', molecule: null });\n    }\n  }, [general?.hideSetSumFromMolecule, panels?.structuresPanel, sumOptions]);\n\n  const saveHandler = useCallback(\n    (values) => {\n      switch (setOption) {\n        case SumSetOptions.Auto: {\n          const {\n            molecule: { mf, key: moleculeKey },\n          } = values;\n\n          onSave({ sumAuto: true, mf, moleculeKey });\n          break;\n        }\n        case SumSetOptions.Manual: {\n          const { sum } = values;\n          onSave({ sum, sumAuto: false });\n          break;\n        }\n        default:\n          return;\n      }\n      onClose();\n    },\n    [onClose, onSave, setOption],\n  );\n\n  const validationSchema = useMemo(() => {\n    switch (setOption) {\n      case SumSetOptions.Auto: {\n        return Yup.object({\n          molecule: Yup.object().required(),\n        });\n      }\n      case SumSetOptions.Manual: {\n        return Yup.object({\n          sum: Yup.number().required(),\n        });\n      }\n      default:\n        return null;\n    }\n  }, [setOption]);\n\n  return (\n    // <div css={modalContainer}>\n    <div css={[ModalStyles, styles]}>\n      <div className=\"header handle\">\n        <span>{header}</span>\n\n        <CloseButton onClick={onClose} />\n      </div>\n      <div className=\"tab-content\">\n        <FormikForm\n          ref={formRef}\n          onSubmit={saveHandler}\n          initialValues={{ sum: null, molecule: null }}\n          validationSchema={validationSchema}\n        >\n          <Tabs activeTab={setOption} onClick={onTabChangeHandler}>\n            {!general?.hideSetSumFromMolecule &&\n              !panels?.structuresPanel?.hidden && (\n                <Tab tablabel=\"Auto\" tabid={SumSetOptions.Auto}>\n                  <SelectMolecule name=\"molecule\" />\n                </Tab>\n              )}\n\n            <Tab tablabel=\"Manual\" tabid={SumSetOptions.Manual}>\n              <div className=\"manual-container\">\n                <FormikInput\n                  name=\"sum\"\n                  type=\"number\"\n                  placeholder=\"Enter the new value\"\n                  onKeyDown={handleKeyDown}\n                />\n              </div>\n            </Tab>\n          </Tabs>\n        </FormikForm>\n      </div>\n      <div className=\"footer-container\">\n        <button\n          type=\"button\"\n          onClick={() => formRef.current.submitForm()}\n          className=\"btn\"\n        >\n          Set\n        </button>\n      </div>\n    </div>\n  );\n}\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { memo } from 'react';\nimport { FaCheck } from 'react-icons/fa';\n\nimport ToolTip from './ToolTip/ToolTip';\n\nconst styles = css`\n  background-color: transparent;\n  border: none;\n  height: 100%;\n  svg {\n    fill: green;\n    font-size: 16px;\n  }\n`;\n\ninterface SaveButtonProps {\n  popupTitle?: string;\n  popupPlacement?: string;\n  disabled?: boolean;\n  className?: string;\n  onClick?: () => void;\n}\n\nfunction SaveButton(props: SaveButtonProps) {\n  const {\n    className = '',\n    disabled = false,\n    popupPlacement = 'left',\n    popupTitle = 'Save',\n    onClick,\n  } = props;\n\n  return (\n    <div className={className}>\n      <ToolTip title={popupTitle} popupPlacement={popupPlacement}>\n        <button\n          css={styles}\n          type=\"button\"\n          onClick={onClick}\n          disabled={disabled}\n          className={className}\n        >\n          <FaCheck />\n        </button>\n      </ToolTip>\n    </div>\n  );\n}\n\nexport default memo(SaveButton);\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { memo } from 'react';\n\nimport CloseButton from '../../elements/CloseButton';\nimport SaveButton from '../../elements/SaveButton';\n\nconst styles = css`\n  display: flex;\n  flex-direction: row-reverse;\n  border-bottom: 0.55px solid rgb(240, 240, 240);\n\n  button {\n    background-color: transparent;\n    border: none;\n    padding: 5px;\n  }\n  button:disabled {\n    opacity: 0.6;\n  }\n`;\n\ninterface PreferencesHeaderProps {\n  onClose: () => void;\n  onSave: () => void;\n}\n\nfunction PreferencesHeader({ onClose, onSave }: PreferencesHeaderProps) {\n  return (\n    <div css={styles}>\n      <CloseButton onClick={onClose} popupTitle=\"close Preferences\" />\n      <SaveButton onClick={onSave} popupTitle=\"save Preferences\" />\n    </div>\n  );\n}\n\nexport default memo(PreferencesHeader);\n","import {\n  CSSProperties,\n  forwardRef,\n  useCallback,\n  useEffect,\n  useImperativeHandle,\n  useState,\n} from 'react';\n\nimport Input from './Input';\n\ninterface EditableColumnProps {\n  onSave?: (element: any) => void;\n  onEditStart?: (element: any) => void;\n  type?: 'number' | 'text';\n  editStatus?: boolean;\n  value: string | number;\n  style?: CSSProperties;\n}\n\n// TODO: remove this hacky ref usage.\nfunction EditableColumn(props: EditableColumnProps, ref: any) {\n  const {\n    onSave = () => null,\n    value,\n    type = 'text',\n    style,\n    onEditStart = () => null,\n    editStatus = false,\n  } = props;\n\n  const [enabled, enableEdit] = useState<boolean | undefined>();\n\n  useEffect(() => {\n    enableEdit(editStatus);\n  }, [editStatus]);\n\n  useImperativeHandle(ref, () => ({\n    startEdit: () => {\n      enableEdit(true);\n    },\n    closeEdit: () => {\n      enableEdit(false);\n    },\n  }));\n\n  const mouseClickCallback = useCallback((e: MouseEvent) => {\n    if (!(e.target as HTMLInputElement).classList.contains('editable-column')) {\n      enableEdit(false);\n      window.removeEventListener('mousedown', mouseClickCallback);\n    }\n  }, []);\n\n  const editModeHandler = useCallback(\n    (flag, event = null) => {\n      if (!flag) {\n        // when press Enter or Tab\n        if (['Enter', 'Tab'].includes(event.key)) {\n          onSave(event);\n        }\n        // close edit mode if press Enter, Tab or Escape\n        if (['Enter', 'Tab', 'Escape'].includes(event.key)) {\n          enableEdit(flag);\n          window.removeEventListener('mousedown', mouseClickCallback);\n        }\n      } else {\n        // start edit mode and add mouse listener to handle mouse click outside the input to finish the mode\n        window.addEventListener('mousedown', mouseClickCallback);\n        onEditStart(event);\n        enableEdit(flag);\n      }\n    },\n    [mouseClickCallback, onEditStart, onSave],\n  );\n\n  return (\n    <div\n      style={{ display: 'table', width: '100%', height: '100%', ...style }}\n      onDoubleClick={(event) => editModeHandler(true, event)}\n    >\n      {!enabled && (\n        <span style={{ display: 'table-cell', verticalAlign: 'middle' }}>\n          {value}\n        </span>\n      )}\n      {enabled && (\n        <div style={{ display: 'table-cell', verticalAlign: 'middle' }}>\n          <Input\n            enableAutoSelect\n            className=\"editable-column\"\n            value={value}\n            type={type}\n            onKeyDown={(e) => editModeHandler(false, e)}\n          />\n        </div>\n      )}\n    </div>\n  );\n}\n\nexport default forwardRef(EditableColumn);\n","import { CSSProperties } from 'react';\n\nexport interface CustomColumn {\n  index: number;\n  id?: string;\n  Header?: (() => JSX.Element) | string;\n  sortType?: string;\n  Cell?: (rowData: { row: { original: any; index: number } }) => any;\n  accessor?: ((row?: any, index?: number) => any) | string;\n  enableRowSpan?: boolean;\n  style?: CSSProperties;\n  extraParams?: any;\n}\n\nexport default function addCustomColumn(array, options: CustomColumn) {\n  const {\n    index,\n    Header = () => null,\n    extraParams,\n    accessor = null,\n    Cell = null,\n    sortType = 'basic',\n    enableRowSpan = false,\n    style = {},\n    id,\n  } = options || {};\n\n  array.push({\n    index,\n    ...{ ...(id && { id }) },\n    ...{ ...(accessor ? { accessor } : {}) },\n    ...{ ...(Cell ? { Cell } : {}) },\n    Header,\n    sortType,\n    enableRowSpan,\n    style,\n    ...extraParams,\n  });\n}\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { CSSProperties, ForwardedRef, forwardRef, useCallback } from 'react';\n\nconst arrowDownIcon = `url('data:image/svg+xml;utf8,<svg  xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\" width=\"960px\" height=\"560px\" viewBox=\"0 0 960 560\" enable-background=\"new 0 0 960 560\" xml:space=\"preserve\"><g id=\"Rounded_Rectangle_33_copy_4_1_\"><path d=\"M480,344.181L268.869,131.889c-15.756-15.859-41.3-15.859-57.054,0c-15.754,15.857-15.754,41.57,0,57.431l237.632,238.937c8.395,8.451,19.562,12.254,30.553,11.698c10.993,0.556,22.159-3.247,30.555-11.698l237.631-238.937c15.756-15.86,15.756-41.571,0-57.431s-41.299-15.859-57.051,0L480,344.181z\"/></g></svg>')`;\n\nexport interface SelectEntry {\n  key: string | number;\n  value: string | number;\n  label: string | number;\n}\n\nexport interface SelectProps {\n  onChange?: (element: string) => void;\n  data: Array<SelectEntry>;\n  style?: CSSProperties;\n  defaultValue?: string | number;\n  name?: string;\n  className?: string;\n}\n\nconst Select = forwardRef(function Select(\n  props: SelectProps,\n  ref: ForwardedRef<HTMLSelectElement>,\n) {\n  const {\n    data,\n    style = { width: 100 },\n    onChange = () => null,\n    defaultValue,\n    name = '',\n    className = '',\n  } = props;\n\n  const handleOnChanged = useCallback(\n    (e) => {\n      let value = e.target.value;\n      if (!isNaN(value)) {\n        value = Number(value);\n      }\n      onChange(value);\n    },\n    [onChange],\n  );\n\n  const styles = css`\n    padding: 0px 5px;\n    border: 0.55px solid #cacaca;\n    font-size: 14px;\n    width: ${style.width ? Number(style.width) - 5 : 115}px;\n    margin: 0;\n    height: 100%;\n    background: ${arrowDownIcon} no-repeat right white;\n    -webkit-appearance: none;\n    background-position-x: calc(100% - 5px);\n    background-size: 15px 15px;\n    border-radius: 5px;\n    margin: 0px 5px;\n    align-self: center;\n    :focus,\n    input:focus {\n      outline: none;\n    }\n  `;\n\n  return (\n    <select\n      ref={ref}\n      css={styles}\n      name={name}\n      onChange={handleOnChanged}\n      defaultValue={defaultValue}\n      className={className}\n      style={style}\n    >\n      {data.map((d) => (\n        <option key={`${d.key}`} value={d.value}>\n          {d.label}\n        </option>\n      ))}\n    </select>\n  );\n});\n\nexport default Select;\n","import lodashGet from 'lodash/get';\nimport { useCallback, useMemo, memo } from 'react';\nimport { FaRegTrashAlt } from 'react-icons/fa';\n\nimport { SignalKinds } from '../../../data/constants/SignalsKinds';\nimport { checkIntegralKind } from '../../../data/data1d/Spectrum1D';\nimport { Integral } from '../../../data/types/data1d';\nimport { useDispatch } from '../../context/DispatchContext';\nimport EditableColumn from '../../elements/EditableColumn';\nimport ReactTable from '../../elements/ReactTable/ReactTable';\nimport addCustomColumn, {\n  CustomColumn,\n} from '../../elements/ReactTable/utility/addCustomColumn';\nimport Select from '../../elements/Select';\nimport {\n  DELETE_INTEGRAL,\n  CHANGE_INTEGRAL_DATA,\n  CHANGE_INTEGRAL_RELATIVE,\n} from '../../reducer/types/Types';\nimport formatNumber from '../../utility/FormatNumber';\nimport { getValue } from '../../utility/LocalStorage';\nimport NoTableData from '../extra/placeholder/NoTableData';\nimport { integralDefaultValues } from '../extra/preferences/defaultValues';\n\nimport { IntegralPanelInnerProps } from './IntegralPanel';\n\nconst selectStyle = { marginLeft: 10, marginRight: 10, border: 'none' };\n\ninterface IntegralTableProps\n  extends Pick<IntegralPanelInnerProps, 'activeTab' | 'preferences'> {\n  data: Array<Integral>;\n}\n\nfunction IntegralTable({ activeTab, data, preferences }: IntegralTableProps) {\n  const dispatch = useDispatch();\n  const deleteIntegralHandler = useCallback(\n    (e, row) => {\n      e.preventDefault();\n      e.stopPropagation();\n      const params = row.original;\n      dispatch({\n        type: DELETE_INTEGRAL,\n        integralID: params.id,\n      });\n    },\n    [dispatch],\n  );\n  const changeIntegralDataHandler = useCallback(\n    (value, row) => {\n      const data = { ...row.original, kind: value };\n      dispatch({\n        type: CHANGE_INTEGRAL_DATA,\n        payload: { data },\n      });\n    },\n    [dispatch],\n  );\n  const initialColumns: CustomColumn[] = useMemo(\n    () => [\n      {\n        index: 1,\n        Header: '#',\n        Cell: ({ row }) => row.index + 1,\n        width: 10,\n      },\n\n      {\n        index: 2,\n        Header: 'From',\n        sortType: 'basic',\n        resizable: true,\n        accessor: (row) => row.from.toFixed(2),\n      },\n      {\n        index: 3,\n        Header: 'To',\n        sortType: 'basic',\n        resizable: true,\n        accessor: (row) => row.to.toFixed(2),\n      },\n      {\n        index: 6,\n        Header: 'Kind',\n        sortType: 'basic',\n        resizable: true,\n        accessor: (row) => row.kind,\n        Cell: ({ row }) => (\n          <Select\n            onChange={(value) => changeIntegralDataHandler(value, row)}\n            data={SignalKinds}\n            style={selectStyle}\n            defaultValue={row.original.kind}\n          />\n        ),\n      },\n      {\n        index: 7,\n        style: { width: '1%', maxWidth: '24px', minWidth: '24px' },\n        id: 'delete-button',\n        Cell: ({ row }) => (\n          <button\n            type=\"button\"\n            className=\"delete-button\"\n            onClick={(e) => deleteIntegralHandler(e, row)}\n          >\n            <FaRegTrashAlt />\n          </button>\n        ),\n      },\n    ],\n    [changeIntegralDataHandler, deleteIntegralHandler],\n  );\n\n  const saveRelativeHandler = useCallback(\n    (event, row) => {\n      const data = { value: event.target.value, id: row.id };\n      dispatch({\n        type: CHANGE_INTEGRAL_RELATIVE,\n        payload: { data },\n      });\n    },\n    [dispatch],\n  );\n\n  const integralsPreferences = useMemo(\n    () =>\n      getValue(\n        preferences.current,\n        `formatting.panels.integrals.[${activeTab}]`,\n        integralDefaultValues,\n      ),\n    [activeTab, preferences],\n  );\n\n  const COLUMNS: (CustomColumn & { showWhen: string })[] = useMemo(\n    () => [\n      {\n        showWhen: 'showAbsolute',\n        index: 4,\n        Header: 'Absolute',\n        accessor: (row) =>\n          formatNumber(\n            row.absolute,\n            lodashGet(\n              integralsPreferences,\n              'absoluteFormat',\n              integralDefaultValues.absoluteFormat,\n            ),\n          ),\n      },\n      {\n        showWhen: 'showRelative',\n        index: 5,\n        id: 'relative',\n        Header: () => {\n          const n = activeTab?.replace(/[0-9]/g, '');\n          return <span>{`Relative ${n}`}</span>;\n        },\n        accessor: (row) => {\n          return formatNumber(\n            row.integral,\n            lodashGet(\n              integralsPreferences,\n              'relativeFormat',\n              integralDefaultValues.relativeFormat,\n            ),\n          );\n        },\n        Cell: ({ row }) => {\n          const value = formatNumber(\n            row.original.integral,\n            lodashGet(\n              integralsPreferences,\n              'relativeFormat',\n              integralDefaultValues.relativeFormat,\n            ),\n          );\n          const flag = checkIntegralKind(row.original);\n          const integral = flag ? value : `[ ${value} ]`;\n\n          return (\n            <EditableColumn\n              value={integral}\n              onSave={(event) => saveRelativeHandler(event, row.original)}\n              type=\"number\"\n            />\n          );\n        },\n      },\n    ],\n    [activeTab, integralsPreferences, saveRelativeHandler],\n  );\n\n  const tableColumns = useMemo(() => {\n    let columns = [...initialColumns];\n    for (const col of COLUMNS) {\n      const { showWhen, ...colParams } = col;\n      if (integralsPreferences[showWhen]) {\n        addCustomColumn(columns, colParams);\n      }\n    }\n\n    return columns.sort((object1, object2) => object1.index - object2.index);\n  }, [COLUMNS, initialColumns, integralsPreferences]);\n\n  return data && data.length > 0 ? (\n    <ReactTable data={data} columns={tableColumns} />\n  ) : (\n    <NoTableData />\n  );\n}\n\nexport default memo(IntegralTable);\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback, memo, useState, useEffect } from 'react';\nimport { ChromePicker } from 'react-color';\n\nconst style = css`\n  display: flex;\n  margin: 5px 0px;\n\n.inputLabel{\n  flex: 2;\n  font-size: 11px;\n  font-weight: bold;\n  color: #232323;\n}\n\n.input {\n  width: '60%',\n  text-align: 'center',\n}\n\n.color{\n  width: 36px;\n  height: 14px;\n  border-radius: 2px;\n}\n\n.swatch{\n  padding: 5px;\n  background: #fff;\n  border-radius: 1px;\n  box-shadow: 0 0 0 1px rgba(0,0,0,.1);\n  display: inline-block;\n  cursor: pointer;\n}\n.color-popover {\n  position: absolute;\n  z-index: 2;\n}\n\n.cover {\n  position: fixed;\n  top: 0px;\n  right: 0px;\n  bottom: 0px;\n  left: 0px;\n}\n  .chrome-picker {\n    border-radius: none !important;\n    width: 200px !important;\n    height: 60px !important;\n    display: flex;\n\n\n  }\n  .chrome-picker > div:first-of-type {\n    padding: 0px !important;\n\n  }\n  .chrome-picker > div:last-child >  div:first-of-type {\n    width: 120px;\n\n  }\n  .chrome-picker > div:last-child >  div:last-child {\n    display:none !important;\n  }\n`;\n\nexport interface ColorInputProps {\n  value?: string;\n  label?: string;\n  name: string;\n  onColorChange?: (element: any) => void;\n}\n\nfunction ColorInput(props: ColorInputProps) {\n  const {\n    label = 'Color: ',\n    onColorChange = () => null,\n    name,\n    value = '#000000',\n  } = props;\n\n  const [displayColorPicker, showColorPicker] = useState(false);\n  const [selectedColor, setColor] = useState(value);\n\n  useEffect(() => {\n    setColor(value);\n  }, [value]);\n\n  const handleClick = useCallback(() => {\n    showColorPicker(!displayColorPicker);\n  }, [displayColorPicker]);\n\n  const handleClose = useCallback(() => {\n    showColorPicker(false);\n  }, []);\n\n  const handleOnColorChanged = useCallback(\n    (colorEvent) => {\n      const hex = `${colorEvent.hex}${Math.round(\n        colorEvent.rgb.a * 255,\n      ).toString(16)}`;\n      setColor(hex);\n      onColorChange({ ...colorEvent, hex, name });\n    },\n    [name, onColorChange],\n  );\n  return (\n    <div css={style}>\n      <span className=\"inputLabel\">{label}</span>\n      <div style={{ flex: 4 }}>\n        <div className=\"swatch\" onClick={handleClick}>\n          <div className=\"color\" style={{ backgroundColor: selectedColor }} />\n          <input type=\"hidden\" value={selectedColor} name={name} />\n        </div>\n        {displayColorPicker ? (\n          <div className=\"color-popover\">\n            <div className=\"cover\" onClick={handleClose} />\n            <ChromePicker\n              color={{ hex: selectedColor }}\n              onChangeComplete={handleOnColorChanged}\n            />\n          </div>\n        ) : null}\n      </div>\n    </div>\n  );\n}\n\nexport default memo(ColorInput);\n","import { useFormikContext } from 'formik';\nimport lodashGet from 'lodash/get';\nimport { useCallback, memo } from 'react';\n\nimport ColorInput, { ColorInputProps } from '../ColorInput';\n\ninterface FormikColorPickerProps extends ColorInputProps {\n  name: string;\n}\n\nfunction FormikColorPicker(props: FormikColorPickerProps) {\n  const { onColorChange = () => null, name, ...colorPickerProps } = props;\n\n  const { values, setFieldValue } = useFormikContext();\n\n  const colorChangeHandler = useCallback(\n    (color) => {\n      onColorChange(color);\n      setFieldValue(name, color.hex);\n    },\n    [name, onColorChange, setFieldValue],\n  );\n\n  return (\n    <ColorInput\n      {...colorPickerProps}\n      name={name}\n      onColorChange={colorChangeHandler}\n      value={lodashGet(values, name)}\n    />\n  );\n}\n\nexport default memo(FormikColorPicker);\n","import { useFormikContext } from 'formik';\nimport lodashGet from 'lodash/get';\nimport { CSSProperties, memo, useCallback } from 'react';\n\nimport Input from '../Input';\n\nconst styles: Record<'row' | 'inputLabel' | 'input', CSSProperties> = {\n  row: {\n    display: 'flex',\n    margin: '5px 0px',\n    alignItems: 'center',\n  },\n  inputLabel: {\n    flex: 2,\n    fontSize: '11px',\n    fontWeight: 'bold',\n    color: '#232323',\n  },\n  input: {\n    width: '60%',\n    textAlign: 'center',\n  },\n};\n\ninterface FormikColumnFormatFieldProps {\n  label: string;\n  checkControllerName: string;\n  formatControllerName?: string;\n  disableFormat?: boolean;\n  hideFormat?: boolean;\n}\n\nfunction FormikColumnFormatField(props: FormikColumnFormatFieldProps) {\n  const {\n    label,\n    checkControllerName,\n    formatControllerName,\n    disableFormat = false,\n    hideFormat = false,\n  } = props;\n\n  const { values, handleChange, setFieldValue } = useFormikContext();\n\n  const changeHandler = useCallback(\n    (e) => {\n      handleChange(e);\n    },\n    [handleChange],\n  );\n\n  const checkChangeHandler = useCallback(\n    (e) => {\n      setFieldValue(e.target.name, e.target.checked);\n    },\n    [setFieldValue],\n  );\n\n  return (\n    <div style={styles.row}>\n      <span style={styles.inputLabel}>{label}</span>\n      <div\n        style={{\n          flex: 4,\n          display: 'flex',\n          flexDirection: 'row',\n          alignItems: 'center',\n        }}\n      >\n        <input\n          type=\"checkbox\"\n          style={{ margin: '0px 5px' }}\n          name={checkControllerName}\n          onChange={checkChangeHandler}\n          checked={lodashGet(values, checkControllerName, false)}\n        />\n        {!hideFormat && formatControllerName && (\n          <Input\n            style={{ inputWrapper: styles.input }}\n            name={formatControllerName}\n            value={lodashGet(values, formatControllerName, '')}\n            onChange={changeHandler}\n            type=\"text\"\n            disabled={disableFormat}\n          />\n        )}\n      </div>\n    </div>\n  );\n}\n\nexport default memo(FormikColumnFormatField);\n","import {\n  CSSProperties,\n  ForwardedRef,\n  forwardRef,\n  useCallback,\n  useRef,\n} from 'react';\n\nconst styles: Record<\n  'container' | 'label' | 'inputContainer' | 'input',\n  CSSProperties\n> = {\n  container: {\n    display: 'flex',\n  },\n  label: {\n    lineHeight: 2,\n    userSelect: 'none',\n    flex: '2',\n  },\n  inputContainer: {\n    flex: '4',\n    display: 'flex',\n    justifyContent: 'flex-start',\n  },\n  input: {\n    height: '100%',\n    width: '100px',\n    borderRadius: '5px',\n    border: '0.55px solid #c7c7c7',\n    margin: '0px 5px 0px 5px',\n    textAlign: 'center',\n  },\n};\n\nexport interface NumberInputProps {\n  pattern?: string;\n  label?: string;\n  name?: string;\n  step?: any;\n  min?: any;\n  max?: any;\n  defaultValue?: number;\n  style?: {\n    container?: any;\n    label?: any;\n    inputContainer?: any;\n    input?: any;\n  };\n  onChange?: (element: any) => void;\n  onInput?: () => void;\n}\n\nconst NumberInput = forwardRef(\n  (\n    {\n      label,\n      name,\n      defaultValue = 0,\n      style = { label: {}, input: {}, container: {}, inputContainer: {} },\n      onChange = () => null,\n      onInput = () => null,\n      pattern = '^d*(.d{0,2})?$',\n      step = 'any',\n      min = 'any',\n      max = 'any',\n    }: NumberInputProps,\n    ref: ForwardedRef<HTMLInputElement>,\n  ) => {\n    const localRef = useRef<HTMLInputElement>(null);\n    const changeHander = useCallback(\n      (e) => {\n        if (e.target.checkValidity()) {\n          const value = Number(\n            e.target.value === '' ? defaultValue : e.target.value,\n          );\n          onChange({\n            ...e,\n            target: { ...e.target, name: e.target.name, value },\n          });\n        } else {\n          const _ref: any = ref ? ref : localRef;\n          _ref.current.value = Number(defaultValue);\n        }\n      },\n      [defaultValue, onChange, ref],\n    );\n    return (\n      <div style={{ ...styles.container, ...style.container }}>\n        <span style={{ ...styles.label, ...style.label }}>{label}</span>\n        <div style={{ ...styles.inputContainer, ...style.inputContainer }}>\n          <input\n            ref={ref ? ref : localRef}\n            name={name}\n            style={{ ...styles.input, ...style.input }}\n            type=\"number\"\n            pattern={pattern}\n            defaultValue={defaultValue}\n            step={step}\n            onChange={changeHander}\n            onInput={onInput}\n            min={min}\n            max={max}\n            key={defaultValue}\n          />\n        </div>\n      </div>\n    );\n  },\n);\n\nexport default NumberInput;\n","import { useFormikContext } from 'formik';\nimport lodashGet from 'lodash/get';\nimport { useCallback } from 'react';\n\nimport NumberInput, { NumberInputProps } from '../NumberInput';\n\ninterface FormikNumberInputProps extends NumberInputProps {\n  label: string;\n  name: string;\n}\n\nfunction FormikNumberInput(props: FormikNumberInputProps) {\n  const { label, name, ...resProps } = props;\n  const { values, handleChange } = useFormikContext();\n\n  const changeHandler = useCallback(\n    (e) => {\n      handleChange(e);\n    },\n    [handleChange],\n  );\n\n  return (\n    <NumberInput\n      label={label}\n      name={name}\n      defaultValue={lodashGet(values, name)}\n      onChange={changeHandler}\n      {...resProps}\n    />\n  );\n}\n\nexport default FormikNumberInput;\n","import { useMemo } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\n\nexport default function useNucleus() {\n  const { tabActiveSpectrum } = useChartData();\n  return useMemo<Array<string>>(() => {\n    if (tabActiveSpectrum && Object.keys(tabActiveSpectrum).length > 0) {\n      return Object.keys(tabActiveSpectrum);\n    }\n    return [];\n  }, [tabActiveSpectrum]);\n}\n","import {\n  useEffect,\n  useCallback,\n  useImperativeHandle,\n  useRef,\n  CSSProperties,\n  memo,\n  forwardRef,\n} from 'react';\nimport { MF } from 'react-mf';\n\nimport { usePreferences } from '../../context/PreferencesContext';\nimport FormikColorInput from '../../elements/formik/FormikColorInput';\nimport FormikColumnFormatField from '../../elements/formik/FormikColumnFormatField';\nimport FormikForm from '../../elements/formik/FormikForm';\nimport FormikNumberInput from '../../elements/formik/FormikNumberInput';\nimport { useAlert } from '../../elements/popup/Alert';\nimport useNucleus from '../../hooks/useNucleus';\nimport { getValue as getValueByKeyPath } from '../../utility/LocalStorage';\nimport { integralDefaultValues } from '../extra/preferences/defaultValues';\n\nconst styles: Record<\n  | 'container'\n  | 'groupContainer'\n  | 'row'\n  | 'header'\n  | 'inputLabel'\n  | 'input'\n  | 'inputLabel',\n  CSSProperties\n> = {\n  container: {\n    padding: 10,\n    backgroundColor: '#f1f1f1',\n    height: '100%',\n    overflowY: 'auto',\n  },\n  groupContainer: {\n    padding: '5px',\n    borderRadius: '5px',\n    margin: '10px 0px',\n    backgroundColor: 'white',\n  },\n  row: {\n    display: 'flex',\n    margin: '5px 0px',\n  },\n  header: {\n    borderBottom: '1px solid #e8e8e8',\n    paddingBottom: '5px',\n    fontWeight: 'bold',\n    color: '#4a4a4a',\n  },\n  inputLabel: {\n    flex: 2,\n    fontSize: '11px',\n    fontWeight: 'bold',\n    color: '#232323',\n  },\n  input: {\n    width: '30%',\n    textAlign: 'center',\n  },\n};\n\nconst formatFields = [\n  {\n    id: 1,\n    label: 'Absolute :',\n    checkController: 'showAbsolute',\n    formatController: 'absoluteFormat',\n  },\n  {\n    id: 2,\n    label: 'Relative :',\n    checkController: 'showRelative',\n    formatController: 'relativeFormat',\n  },\n];\n\ninterface IntegralsPreferencesInnerProps {\n  nucleus: Array<string>;\n  preferences: any;\n  innerRef: any;\n}\n\nfunction IntegralsPreferencesInner({\n  nucleus,\n  preferences,\n  innerRef,\n}: IntegralsPreferencesInnerProps) {\n  const alert = useAlert();\n\n  const formRef = useRef<any>();\n\n  const updateValues = useCallback(() => {\n    if (nucleus) {\n      const { color, strokeWidth, ...restProps } = integralDefaultValues;\n\n      const integralPreferences = getValueByKeyPath(\n        preferences.current,\n        `formatting.panels.integrals`,\n      );\n\n      let defaultValues = nucleus.reduce((acc, nucleusLabel) => {\n        acc[nucleusLabel] = restProps;\n        return acc;\n      }, {});\n      defaultValues = Object.assign(defaultValues, { color, strokeWidth });\n\n      formRef.current.setValues(\n        integralPreferences ? integralPreferences : defaultValues,\n      );\n    }\n  }, [nucleus, preferences]);\n\n  useEffect(() => {\n    updateValues();\n  }, [updateValues]);\n\n  const saveHandler = useCallback(\n    (values) => {\n      preferences.dispatch({\n        type: 'SET_PANELS_PREFERENCES',\n        payload: { key: 'integrals', value: values },\n      });\n      alert.success('Integrals preferences saved successfully');\n    },\n    [alert, preferences],\n  );\n\n  useImperativeHandle(innerRef, () => ({\n    saveSetting: () => {\n      formRef.current.submitForm();\n    },\n  }));\n\n  return (\n    <div style={styles.container}>\n      <FormikForm onSubmit={saveHandler} ref={formRef}>\n        <div style={styles.groupContainer}>\n          <p style={styles.header}>General</p>\n          <FormikColorInput name=\"color\" />\n          <FormikNumberInput\n            name=\"strokeWidth\"\n            label=\"stroke width :\"\n            style={{\n              label: { fontSize: '11px', fontWeight: 'bold', color: '#232323' },\n              input: {\n                width: '60%',\n                textAlign: 'center',\n                borderRadius: '5px',\n              },\n            }}\n            min={1}\n            max={9}\n            pattern=\"[1-9]+\"\n          />\n        </div>\n\n        {nucleus?.map((nucleusLabel) => (\n          <div key={nucleusLabel} style={styles.groupContainer}>\n            <p style={styles.header}>\n              <MF mf={nucleusLabel} />\n            </p>\n            {formatFields.map((field) => (\n              <FormikColumnFormatField\n                key={field.id}\n                label={field.label}\n                checkControllerName={`${nucleusLabel}.${field.checkController}`}\n                formatControllerName={`${nucleusLabel}.${field.formatController}`}\n              />\n            ))}\n          </div>\n        ))}\n      </FormikForm>\n    </div>\n  );\n}\n\nconst MemoizedIntegralsPreferences = memo(IntegralsPreferencesInner);\n\n// TODO: remove this hacky use of ref.\nfunction IntegralsPreferences(props, ref) {\n  const preferences = usePreferences();\n  const nucleus = useNucleus();\n\n  return (\n    <MemoizedIntegralsPreferences\n      innerRef={ref}\n      {...{\n        nucleus,\n        preferences,\n      }}\n    />\n  );\n}\n\nexport default forwardRef(IntegralsPreferences);\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { SvgNmrSum } from 'cheminfo-font';\nimport lodashGet from 'lodash/get';\nimport { useCallback, useMemo, useState, useRef, memo, Fragment } from 'react';\nimport { ImLink } from 'react-icons/im';\n\nimport { Datum1D, Info1D, Integrals } from '../../../data/types/data1d';\nimport { useChartData } from '../../context/ChartContext';\nimport { useDispatch } from '../../context/DispatchContext';\nimport { usePreferences } from '../../context/PreferencesContext';\nimport ToggleButton from '../../elements/ToggleButton';\nimport ToolTip from '../../elements/ToolTip/ToolTip';\nimport { useModal } from '../../elements/popup/Modal';\nimport useSpectrum from '../../hooks/useSpectrum';\nimport ChangeSumModal from '../../modal/changeSum/ChangeSumModal';\nimport {\n  DELETE_INTEGRAL,\n  CHANGE_INTEGRAL_SUM,\n  CHANGE_INTEGRALS_SUM_FLAG,\n} from '../../reducer/types/Types';\nimport { tablePanelStyle } from '../extra/BasicPanelStyle';\nimport DefaultPanelHeader from '../header/DefaultPanelHeader';\nimport PreferencesHeader from '../header/PreferencesHeader';\n\nimport IntegralTable from './IntegralTable';\nimport IntegralsPreferences from './IntegralsPreferences';\n\nconst style = css`\n  .sum-button {\n    width: 22px;\n    height: 22px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n  }\n\n  .fix-integral-toggle-btn {\n    svg {\n      font-size: 12px !important;\n    }\n  }\n`;\n\nexport interface IntegralPanelInnerProps {\n  integrals: Integrals;\n  info: Info1D;\n  activeTab: string;\n  xDomain: Array<number>;\n  preferences: any;\n}\n\nfunction IntegralPanelInner({\n  integrals,\n  info,\n  activeTab,\n  xDomain,\n  preferences,\n}: IntegralPanelInnerProps) {\n  const [filterIsActive, setFilterIsActive] = useState(false);\n\n  const dispatch = useDispatch();\n  const modal = useModal();\n  const [isFlipped, setFlipStatus] = useState(false);\n  const settingRef = useRef<any>();\n\n  const yesHandler = useCallback(() => {\n    dispatch({ type: DELETE_INTEGRAL, integralID: null });\n  }, [dispatch]);\n\n  const handleDeleteAll = useCallback(() => {\n    modal.showConfirmDialog({\n      message: 'All records will be deleted, Are You sure?',\n      buttons: [{ text: 'Yes', handler: yesHandler }, { text: 'No' }],\n    });\n  }, [modal, yesHandler]);\n\n  const changeIntegralSumHandler = useCallback(\n    (value) => {\n      dispatch({ type: CHANGE_INTEGRAL_SUM, value });\n      modal.close();\n    },\n    [dispatch, modal],\n  );\n\n  const currentSum = useMemo(() => {\n    return lodashGet(integrals, 'options.sum', null);\n  }, [integrals]);\n\n  const showChangeIntegralSumModal = useCallback(() => {\n    modal.show(\n      <ChangeSumModal\n        onClose={() => modal.close()}\n        onSave={changeIntegralSumHandler}\n        header={\n          currentSum\n            ? `Set new Integrals Sum (Current: ${Number(currentSum).toFixed(\n                2,\n              )})`\n            : 'Set new Integrals Sum'\n        }\n        sumOptions={integrals?.options}\n      />,\n    );\n  }, [changeIntegralSumHandler, currentSum, integrals?.options, modal]);\n\n  const settingsPanelHandler = useCallback(() => {\n    setFlipStatus(!isFlipped);\n  }, [isFlipped]);\n\n  const saveSettingHandler = useCallback(() => {\n    settingRef.current.saveSetting();\n    setFlipStatus(false);\n  }, []);\n\n  const handleOnFilter = useCallback(() => {\n    setFilterIsActive(!filterIsActive);\n  }, [filterIsActive]);\n\n  const toggleConstantSumHandler = useCallback(\n    (flag) => {\n      dispatch({ type: CHANGE_INTEGRALS_SUM_FLAG, payload: flag });\n    },\n    [dispatch],\n  );\n\n  const filteredData = useMemo(() => {\n    function isInRange(from, to) {\n      const factor = 10000;\n      to = to * factor;\n      from = from * factor;\n      return (\n        (to >= xDomain[0] * factor && from <= xDomain[1] * factor) ||\n        (from <= xDomain[0] * factor && to >= xDomain[1] * factor)\n      );\n    }\n    if (info.dimension === 1 && integrals?.values) {\n      const _integrals = filterIsActive\n        ? integrals.values.filter((integral) =>\n            isInRange(integral.from, integral.to),\n          )\n        : integrals.values;\n\n      return _integrals.map((integral) => {\n        return {\n          ...integral,\n          isConstantlyHighlighted: isInRange(integral.from, integral.to),\n        };\n      });\n    }\n    return [];\n  }, [filterIsActive, info.dimension, integrals, xDomain]);\n\n  return (\n    <Fragment>\n      <div\n        css={[\n          tablePanelStyle,\n          style,\n          isFlipped &&\n            css`\n              th {\n                position: relative;\n              }\n            `,\n        ]}\n      >\n        {!isFlipped && (\n          <DefaultPanelHeader\n            counter={integrals?.values?.length}\n            onDelete={handleDeleteAll}\n            deleteToolTip=\"Delete All Integrals\"\n            onFilter={handleOnFilter}\n            filterToolTip={\n              filterIsActive\n                ? 'Show all integrals'\n                : 'Hide integrals out of view'\n            }\n            filterIsActive={filterIsActive}\n            counterFiltered={filteredData.length}\n            showSettingButton\n            onSettingClick={settingsPanelHandler}\n          >\n            <ToolTip\n              title={\n                currentSum\n                  ? `Change Integrals Sum (${Number(currentSum).toFixed(2)})`\n                  : 'Change Integrals Sum'\n              }\n              popupPlacement=\"right\"\n            >\n              <button\n                className=\"sum-button\"\n                type=\"button\"\n                onClick={showChangeIntegralSumModal}\n              >\n                <SvgNmrSum />\n              </button>\n            </ToolTip>\n            <ToggleButton\n              className=\"fix-integral-toggle-btn\"\n              popupTitle=\"fix integral values\"\n              popupPlacement=\"right\"\n              onClick={toggleConstantSumHandler}\n            >\n              <ImLink />\n            </ToggleButton>\n          </DefaultPanelHeader>\n        )}\n        {isFlipped && (\n          <PreferencesHeader\n            onSave={saveSettingHandler}\n            onClose={settingsPanelHandler}\n          />\n        )}\n        <div className=\"inner-container\">\n          {!isFlipped ? (\n            <IntegralTable\n              data={filteredData}\n              activeTab={activeTab}\n              preferences={preferences}\n            />\n          ) : (\n            <IntegralsPreferences ref={settingRef} />\n          )}\n        </div>\n      </div>\n    </Fragment>\n  );\n}\n\nconst MemoizedIntegralPanel = memo(IntegralPanelInner);\n\nconst emptyData = { integrals: {}, info: {} };\n\nexport default function IntegralPanel() {\n  const { xDomain, activeTab } = useChartData();\n\n  const preferences = usePreferences();\n\n  const { integrals, info } = useSpectrum(emptyData) as Datum1D;\n\n  return (\n    <MemoizedIntegralPanel\n      {...{\n        integrals,\n        info,\n        preferences: preferences.current,\n        xDomain,\n        activeTab,\n      }}\n    />\n  );\n}\n","import React, { CSSProperties, ReactNode } from 'react';\n\ninterface LabelProps {\n  title: string;\n  children: ReactNode;\n  className?: string;\n  style?: {\n    label?: CSSProperties;\n    wrapper?: CSSProperties;\n  };\n}\n\nexport default function Label(props: LabelProps) {\n  const { title, className = '', children, style } = props;\n  return (\n    <div style={{ display: 'flex', alignItems: 'center' }}>\n      <span\n        className={className}\n        style={{\n          fontSize: '11px',\n          fontWeight: 'bold',\n          color: '#232323',\n          paddingRight: '10px',\n          width: 'max-content',\n          ...style?.label,\n        }}\n      >\n        {title}\n      </span>\n      <div style={style?.wrapper}>{children}</div>\n    </div>\n  );\n}\n","/** @jsxImportSource @emotion/react */\nimport { useCallback, useEffect, useRef } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\nimport Button from '../elements/Button';\nimport CloseButton from '../elements/CloseButton';\nimport Label from '../elements/Label';\nimport FormikForm from '../elements/formik/FormikForm';\nimport FormikInput from '../elements/formik/FormikInput';\nimport Events from '../utility/Events';\nimport { exportAsMatrix } from '../utility/Export';\n\nimport { ModalStyles } from './ModalStyle';\n\nconst INITIAL_VALUE = { from: -1, to: 1, nbPoints: 1024 };\n\ninterface ExportAsMatrixModalProps {\n  onClose?: (element?: string) => void;\n}\n\nfunction ExportAsMatrixModal({\n  onClose = () => null,\n}: ExportAsMatrixModalProps) {\n  const refForm = useRef<any>();\n  const { data } = useChartData();\n\n  const handleSave = useCallback(() => {\n    refForm.current.submitForm();\n  }, []);\n\n  const submitHandler = useCallback(\n    (options) => {\n      exportAsMatrix(data, options, 'fileName');\n      onClose();\n    },\n    [data, onClose],\n  );\n\n  useEffect(() => {\n    function handler(event: any) {\n      const [from, to] = event.range;\n      refForm.current.setValues({ ...refForm.current.values, from, to });\n    }\n\n    Events.on('brushEnd', handler);\n\n    return () => {\n      Events.off('brushEnd', handler);\n    };\n  }, []);\n\n  return (\n    <div css={ModalStyles}>\n      <div className=\"header handle\">\n        <span>Export spectra as a Matrix</span>\n        <CloseButton onClick={onClose} className=\"close-bt\" />\n      </div>\n      <div className=\"inner-content\">\n        <FormikForm\n          ref={refForm}\n          initialValues={INITIAL_VALUE}\n          onSubmit={submitHandler}\n        >\n          <div className=\"row margin-10\">\n            <span className=\"custom-label\">Range :</span>\n            <Label title=\"From : \">\n              <FormikInput name=\"from\" type=\"number\" />\n            </Label>\n            <Label title=\"To : \">\n              <FormikInput name=\"to\" type=\"number\" />\n            </Label>\n          </div>\n          <div className=\"row margin-10\">\n            <Label title=\"Number of Points :\" className=\"custom-label\">\n              <FormikInput name=\"nbPoints\" type=\"number\" />\n            </Label>\n          </div>\n        </FormikForm>\n      </div>\n      <div className=\"footer-container\">\n        <Button.Done onClick={handleSave}>Export Now</Button.Done>\n      </div>\n    </div>\n  );\n}\n\nexport default ExportAsMatrixModal;\n","import { FormikHelpers, FormikProps } from 'formik';\nimport { ForwardedRef, forwardRef } from 'react';\n\nimport { useChartData } from '../../context/ChartContext';\nimport Label from '../../elements/Label';\nimport FormikForm from '../../elements/formik/FormikForm';\nimport FormikInput from '../../elements/formik/FormikInput';\n\ninterface EquallySpacedFilterProps {\n  onSubmit: (values: any, helper: FormikHelpers<any>) => void;\n}\n\nfunction EquallySpacedFilter(\n  { onSubmit }: EquallySpacedFilterProps,\n  ref: ForwardedRef<FormikProps<any>>,\n) {\n  const { xDomain } = useChartData();\n  return (\n    <FormikForm\n      ref={ref}\n      initialValues={{\n        from: xDomain[0],\n        to: xDomain[1],\n        numberOfPoints: 1024,\n      }}\n      onSubmit={onSubmit}\n    >\n      <div className=\"row margin-10\">\n        <span className=\"custom-label\">Range :</span>\n        <Label title=\"From : \">\n          <FormikInput name=\"from\" type=\"number\" />\n        </Label>\n        <Label title=\"To : \">\n          <FormikInput name=\"to\" type=\"number\" />\n        </Label>\n      </div>\n      <div className=\"row margin-10\">\n        <Label className=\"custom-label\" title=\"Number of points : \">\n          <FormikInput name=\"numberOfPoints\" type=\"number\" />\n        </Label>\n      </div>\n    </FormikForm>\n  );\n}\n\nexport default forwardRef(EquallySpacedFilter);\n","import { FormikHelpers, FormikProps } from 'formik';\nimport { ForwardedRef, forwardRef } from 'react';\n\nimport { useChartData } from '../../context/ChartContext';\nimport Label from '../../elements/Label';\nimport FormikForm from '../../elements/formik/FormikForm';\nimport FormikInput from '../../elements/formik/FormikInput';\n\ninterface FromToFilterProps {\n  onSubmit: (values: any, helper: FormikHelpers<any>) => void;\n}\n\nfunction FromToFilter(\n  { onSubmit }: FromToFilterProps,\n  ref: ForwardedRef<FormikProps<any>>,\n) {\n  const { xDomain } = useChartData();\n  return (\n    <FormikForm\n      ref={ref}\n      initialValues={{ from: xDomain[0], to: xDomain[1] }}\n      onSubmit={onSubmit}\n    >\n      <div className=\"row margin-10\">\n        <span className=\"custom-label\">Range :</span>\n        <Label title=\"From :\">\n          <FormikInput name=\"from\" type=\"number\" />\n        </Label>\n        <Label title=\"To :\">\n          <FormikInput name=\"to\" type=\"number\" />\n        </Label>\n      </div>\n    </FormikForm>\n  );\n}\n\nexport default forwardRef(FromToFilter);\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback, useEffect, useMemo, useRef, useState } from 'react';\n\nimport * as Filters from '../../../data/Filters';\nimport { REFERENCES } from '../../../data/constants/References';\nimport { useDispatch } from '../../context/DispatchContext';\nimport ActionButtons from '../../elements/ActionButtons';\nimport CloseButton from '../../elements/CloseButton';\nimport Select from '../../elements/Select';\nimport FormikForm from '../../elements/formik/FormikForm';\nimport { APPLY_MULTIPLE_SPECTRA_FILTER } from '../../reducer/types/Types';\nimport Events from '../../utility/Events';\nimport { ModalStyles } from '../ModalStyle';\n\nimport EquallySpacedFilter from './EquallySpacedFilter';\nimport FromToFilter from './FromToFilter';\n\nconst baseList: Array<{\n  key: string | number;\n  value: number | string;\n  label: string;\n}> = [\n  { key: 0, value: 0, label: 'Select Filter' },\n  {\n    key: Filters.fromTo.id,\n    value: Filters.fromTo.id,\n    label: Filters.fromTo.name,\n  },\n  {\n    key: Filters.equallySpaced.id,\n    value: Filters.equallySpaced.id,\n    label: Filters.equallySpaced.name,\n  },\n  {\n    key: Filters.standardDeviation.id,\n    value: Filters.standardDeviation.id,\n    label: Filters.standardDeviation.name,\n  },\n  {\n    key: Filters.centerMean.id,\n    value: Filters.centerMean.id,\n    label: Filters.centerMean.name,\n  },\n  {\n    key: Filters.pareto.id,\n    value: Filters.pareto.id,\n    label: Filters.pareto.name,\n  },\n];\n\nconst styles = css`\n  .row {\n    align-items: center;\n  }\n\n  .container {\n    flex: 1;\n  }\n\n  .infoText {\n    padding: 10px;\n    font-size: 12px;\n    text-align: left;\n    color: white;\n    background-color: #5f5f5f;\n    border-radius: 5px;\n  }\n`;\n\ninterface MultipleSpectraFiltersModalProps {\n  onClose?: () => void;\n  nucleus?: string;\n}\n\nfunction MultipleSpectraFiltersModal({\n  onClose = () => null,\n  nucleus = '',\n}: MultipleSpectraFiltersModalProps) {\n  const refForm = useRef<any>();\n\n  const dispatch = useDispatch();\n  const [filter, setFilter] = useState('');\n\n  const List = useMemo(() => {\n    const list = REFERENCES[nucleus]\n      ? Object.entries(REFERENCES[nucleus]).map(\n          (item) => ({\n            key: item[0],\n            value: item[0],\n            label: item[0],\n          }),\n          [],\n        )\n      : [];\n\n    return baseList.concat(list as any);\n  }, [nucleus]);\n\n  const handleSave = useCallback((e) => {\n    e.preventDefault();\n    if (refForm.current) {\n      refForm.current.submitForm();\n    }\n  }, []);\n\n  const submitHandler = useCallback(\n    (options) => {\n      if (options) {\n        dispatch({\n          type: APPLY_MULTIPLE_SPECTRA_FILTER,\n          payload: [{ name: filter, options }],\n        });\n\n        onClose();\n      }\n    },\n    [dispatch, filter, onClose],\n  );\n\n  useEffect(() => {\n    function handle(event: any) {\n      const [from, to] = event.range;\n      if (refForm.current) {\n        refForm.current.setValues({ ...refForm.current.values, from, to });\n      }\n    }\n\n    Events.on('brushEnd', handle);\n\n    return () => {\n      Events.off('brushEnd', handle);\n    };\n  }, []);\n\n  const filterChangeHandler = useCallback((id) => {\n    setFilter(id);\n  }, []);\n\n  const filterOptions = useMemo(() => {\n    switch (filter) {\n      case Filters.fromTo.id:\n        return <FromToFilter onSubmit={submitHandler} ref={refForm} />;\n      case Filters.equallySpaced.id:\n        return <EquallySpacedFilter onSubmit={submitHandler} ref={refForm} />;\n      default:\n        <FormikForm\n          ref={refForm}\n          initialValues={null}\n          onSubmit={submitHandler}\n        />;\n        break;\n    }\n  }, [filter, submitHandler]);\n\n  return (\n    <div css={[ModalStyles, styles]}>\n      <div className=\"header handle\">\n        <span>Apply filters</span>\n        <CloseButton onClick={onClose} className=\"close-bt\" />\n      </div>\n      <div className=\"inner-content container\">\n        <p className=\"infoText\">\n          This filter will use the exclusions zones defined in the first\n          spectrum.\n        </p>\n        <div className=\"row margin-10\">\n          <span className=\"custom-label\">Filter :</span>\n\n          <Select\n            data={List}\n            style={{ width: 275, height: 30, margin: 0 }}\n            onChange={filterChangeHandler}\n          />\n        </div>\n        {filterOptions}\n      </div>\n      <div className=\"footer-container\">\n        <ActionButtons\n          style={{ flexDirection: 'row-reverse', margin: 0 }}\n          onDone={handleSave}\n          doneLabel=\"Save\"\n          onCancel={onClose}\n          cancelLabel=\"Close\"\n        />\n      </div>\n    </div>\n  );\n}\n\nexport default MultipleSpectraFiltersModal;\n","/** @jsxImportSource @emotion/react */\nimport { SvgNmrAddFilter, SvgNmrExportAsMatrix } from 'cheminfo-font';\nimport { useCallback } from 'react';\n\nimport { useDispatch } from '../../context/DispatchContext';\nimport Button from '../../elements/ButtonToolTip';\nimport { positions, useModal } from '../../elements/popup/Modal';\nimport ExportAsMatrixModal from '../../modal/ExportAsMatrixModal';\nimport MultipleSpectraFiltersModal from '../../modal/MultipleSpectraFiltersModal';\nimport { RESET_SELECTED_TOOL } from '../../reducer/types/Types';\nimport { tablePanelStyle } from '../extra/BasicPanelStyle';\nimport DefaultPanelHeader from '../header/DefaultPanelHeader';\n\nfunction MatrixGenerationPanel() {\n  const modal = useModal();\n  const dispatch = useDispatch();\n\n  const openFiltersModal = useCallback(() => {\n    dispatch({ type: RESET_SELECTED_TOOL });\n    modal.show(<MultipleSpectraFiltersModal />, {\n      isBackgroundBlur: false,\n      position: positions.TOP_CENTER,\n      width: 550,\n      height: 250,\n    });\n  }, [modal, dispatch]);\n\n  const openExportAsMatrixModal = useCallback(() => {\n    dispatch({ type: RESET_SELECTED_TOOL });\n    modal.show(<ExportAsMatrixModal />, {\n      isBackgroundBlur: false,\n      position: positions.TOP_CENTER,\n      width: 500,\n    });\n  }, [modal, dispatch]);\n\n  return (\n    <div css={tablePanelStyle}>\n      {\n        <DefaultPanelHeader\n          deleteToolTip=\"Delete All Peaks\"\n          showSettingButton\n          canDelete={false}\n        >\n          <Button popupTitle=\"Add Filter\" onClick={openFiltersModal}>\n            <SvgNmrAddFilter style={{ fontSize: '18px' }} />\n          </Button>\n          <Button\n            popupTitle=\"Export spectra as a Matrix\"\n            onClick={openExportAsMatrixModal}\n          >\n            <SvgNmrExportAsMatrix />\n          </Button>\n        </DefaultPanelHeader>\n      }\n\n      <div className=\"inner-container\" />\n    </div>\n  );\n}\n\nexport default MatrixGenerationPanel;\n","/** @jsxImportSource @emotion/react */\nimport { useState, useEffect, useCallback } from 'react';\nimport { StructureEditor } from 'react-ocl/full';\n\nimport { useDispatch } from '../context/DispatchContext';\nimport ActionButtons from '../elements/ActionButtons';\nimport { SET_MOLECULE, ADD_MOLECULE } from '../reducer/types/Types';\n\nimport { ModalStyles } from './ModalStyle';\n\ninterface MoleculeStructureEditorModalProps {\n  onClose?: (element?: string) => void;\n  selectedMolecule: {\n    key: any;\n    molfile: string;\n  };\n}\n\nfunction MoleculeStructureEditorModal(\n  props: MoleculeStructureEditorModalProps,\n) {\n  const { onClose = () => null, selectedMolecule } = props;\n\n  const [molfile, setMolfile] = useState<string | null>(null);\n  const dispatch = useDispatch();\n  useEffect(() => {\n    if (selectedMolecule) {\n      setMolfile(selectedMolecule.molfile);\n    } else {\n      setMolfile(null);\n    }\n  }, [selectedMolecule]);\n\n  const cb = useCallback(\n    (newMolfile) => {\n      const molText =\n        /(?<s>M {2}V30 BEGIN BOND)(?<mol>.*?)(?<e>M {2}V30 END BOND)/gs.exec(\n          newMolfile,\n        )?.groups?.mol;\n\n      setMolfile(molText?.trim() ? newMolfile : null);\n    },\n    [setMolfile],\n  );\n\n  const handleClose = useCallback(() => {\n    onClose();\n  }, [onClose]);\n\n  const handleSave = useCallback(() => {\n    if (selectedMolecule) {\n      dispatch({ type: SET_MOLECULE, molfile, key: selectedMolecule.key });\n      onClose('replace');\n    } else {\n      dispatch({ type: ADD_MOLECULE, molfile });\n      onClose('new');\n    }\n  }, [dispatch, selectedMolecule, molfile, onClose]);\n\n  return (\n    <div css={ModalStyles}>\n      <StructureEditor\n        initialMolfile={selectedMolecule?.molfile}\n        svgMenu\n        fragment={false}\n        onChange={cb}\n      />\n      <div className=\"footer-container\">\n        <ActionButtons\n          style={{ flexDirection: 'row-reverse', margin: 0 }}\n          onDone={handleSave}\n          doneLabel=\"Save\"\n          onCancel={handleClose}\n        />\n      </div>\n    </div>\n  );\n}\n\nexport default MoleculeStructureEditorModal;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { ReactNode, useState, useCallback, useRef } from 'react';\n\nimport ToolTip from './ToolTip/ToolTip';\n\nconst menuStyles = css`\n  .menu {\n    box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.5);\n    padding: 0px;\n    margin: 0px;\n    border-radius: 5px;\n    display: flex;\n    flex-direction: column;\n    position: absolute;\n    z-index: 99999;\n    padding: 2px;\n    background-color: white;\n\n    button:hover {\n      background-color: #fafafa;\n    }\n  }\n\n  .menu-cover {\n    position: fixed;\n    width: 100%;\n    height: 100%;\n    top: 0;\n    left: 0;\n    z-index: 1;\n  }\n\n  .menu-item {\n    background-color: transparent;\n    border: none;\n    border-bottom: 0.55px solid whitesmoke;\n    height: 35px;\n    outline: outline;\n    display: table-cell;\n    vertical-align: middle;\n    text-align: left;\n    padding: 0 10px;\n\n    svg {\n      display: inline-block;\n    }\n\n    :focus {\n      outline: none !important;\n    }\n    span {\n      font-size: 10px;\n      padding: 0px 10px;\n    }\n  }\n`;\n\ninterface MenuItemProps {\n  icon: ReactNode;\n  label: string;\n  onClick: () => void;\n}\n\nfunction MenuItem({ icon, label, onClick }: MenuItemProps) {\n  return (\n    <button type=\"button\" className=\"menu-item\" onClick={onClick}>\n      {icon}\n      <span>{label}</span>\n    </button>\n  );\n}\n\ninterface MenuListProps {\n  items: Array<MenuItemProps & { id: string }>;\n  onClick: (element: MenuItemProps & { id: string }) => void;\n  boxBounding: any;\n}\n\nfunction MenuList({ items, boxBounding, onClick }: MenuListProps) {\n  return (\n    <div\n      className=\"menu\"\n      style={{\n        transform: `translate(${boxBounding.width}px, -${boxBounding.height}px) `,\n      }}\n    >\n      {items?.map((item) => {\n        return (\n          <MenuItem key={item.id} {...item} onClick={() => onClick(item)} />\n        );\n      })}\n    </div>\n  );\n}\n\ninterface MenuButtonProps {\n  style?: any;\n  component: any;\n  toolTip: string;\n  className?: string;\n  items: Array<any>;\n  onClick: (element: any) => void;\n}\n\nexport default function MenuButton({\n  style,\n  component,\n  toolTip = '',\n  className,\n  items = [],\n  onClick = () => null,\n}: MenuButtonProps) {\n  const menuButtonRef = useRef<HTMLButtonElement>(null);\n  const [isShown, showMenu] = useState(false);\n\n  const closeMenuButton = useCallback(() => {\n    showMenu(false);\n  }, []);\n\n  const handleClick = useCallback(() => {\n    showMenu((flag) => !flag);\n  }, []);\n  const clickHandler = useCallback(\n    (e) => {\n      showMenu(false);\n      onClick(e);\n    },\n    [onClick],\n  );\n\n  return (\n    <div style={{ height: 'auto' }} css={menuStyles}>\n      <button\n        ref={menuButtonRef}\n        type=\"button\"\n        css={style}\n        onClick={handleClick}\n        className={className}\n        style={{ boxSizing: 'border-box' }}\n      >\n        <ToolTip title={toolTip} popupPlacement=\"right\">\n          {component}\n        </ToolTip>\n      </button>\n      {isShown && (\n        <MenuList\n          items={items}\n          boxBounding={menuButtonRef.current?.getBoundingClientRect()}\n          onClick={clickHandler}\n        />\n      )}\n\n      {isShown && <div className=\"menu-cover\" onClick={closeMenuButton} />}\n    </div>\n  );\n}\n","export default function generateNumbersPowerOfX(\n  start: number,\n  end: number,\n  options?: { power?: number; format?: (input: number) => string | number },\n) {\n  const { power = 2, format = formatNumber } = options || {};\n  let values: Array<{ key: number; label: string | number; value: number }> =\n    [];\n  for (let i = start; i <= end; i++) {\n    const result = power ** i;\n    values.push({\n      key: result,\n      label: format(result),\n      value: result,\n    });\n  }\n  return values;\n}\n\nfunction formatNumber(number: number): string | number {\n  if (number >= 1024 * 1024) {\n    return `${number / (1024 * 1024)}M`;\n  } else if (number >= 1024) {\n    return `${number / 1024}K`;\n  } else {\n    return number;\n  }\n}\n","import { HTMLAttributes } from 'react';\n\ninterface IsotopesViewerProps extends HTMLAttributes<HTMLDivElement> {\n  value?: string;\n}\n\nfunction IsotopesViewer({ value = '', ...othersProps }: IsotopesViewerProps) {\n  return (\n    <div\n      {...othersProps}\n      // eslint-disable-next-line react/no-danger\n      dangerouslySetInnerHTML={{\n        __html: value.replace(/(?<isotope>[0-9]+)/g, '<sup>$<isotope></sup>'),\n      }}\n    />\n  );\n}\n\nexport default IsotopesViewer;\n","import { useFormikContext } from 'formik';\nimport { CSSProperties, useMemo } from 'react';\n\nconst styles: Record<'container' | 'text', CSSProperties> = {\n  container: {\n    backgroundColor: '#fd000c',\n    borderRadius: '5px',\n    padding: '0.4rem',\n  },\n  text: {\n    color: 'white',\n    margin: '0.5px',\n    fontSize: '0.9em',\n    listStyle: 'inside',\n  },\n};\n\nexport interface FormikErrorsSummaryProps {\n  style?: Record<'container' | 'text', CSSProperties>;\n}\n\nconst getErrors = (errorObj: Record<string, any>): string[] => {\n  const result: string[] = [];\n  function errorsIterators(obj) {\n    Object.keys(obj).forEach((key) => {\n      if (typeof obj[key] === 'object') {\n        errorsIterators(obj[key]);\n      } else {\n        result.push(obj[key]);\n      }\n    });\n  }\n\n  errorsIterators(errorObj);\n  return result;\n};\n\nfunction FormikErrorsSummary({ style }: FormikErrorsSummaryProps) {\n  const { errors, isValid } = useFormikContext();\n\n  const errorList = useMemo(() => {\n    return getErrors(errors);\n  }, [errors]);\n\n  if (isValid) return <div />;\n\n  return (\n    <ul style={{ ...styles.container, ...style?.container }}>\n      {errorList.map((errorText, index) => {\n        return (\n          // eslint-disable-next-line react/no-array-index-key\n          <li key={index} style={{ ...styles.text, ...style?.text }}>\n            {errorText}\n          </li>\n        );\n      })}\n    </ul>\n  );\n}\n\nexport default FormikErrorsSummary;\n","import { useFormikContext } from 'formik';\nimport lodashGet from 'lodash/get';\nimport { useCallback, useEffect } from 'react';\n\nimport Select, { SelectProps } from '../Select';\n\nconst FormikSelect = function FormikSelect(\n  props: SelectProps & { value?: string },\n) {\n  const { name = '', value, onChange = () => null, ...resProps } = props;\n\n  const { values, setFieldValue } = useFormikContext();\n  const changeHandler = useCallback(\n    (value) => {\n      onChange(value);\n      setFieldValue(name, value);\n    },\n    [name, onChange, setFieldValue],\n  );\n\n  useEffect(() => {\n    if (value) {\n      setFieldValue(name, value);\n    }\n  }, [name, setFieldValue, value]);\n\n  return (\n    <Select\n      name={name}\n      defaultValue={value ? value : lodashGet(values, name)}\n      onChange={changeHandler}\n      {...resProps}\n    />\n  );\n};\n\nexport default FormikSelect;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback, useRef, useState, useMemo } from 'react';\nimport * as Yup from 'yup';\n\nimport {\n  defaultPredictionOptions,\n  FREQUENCIES,\n} from '../../data/PredictionManager';\nimport generateNumbersPowerOfX from '../../data/utilities/generateNumbersPowerOfX';\nimport { useChartData } from '../context/ChartContext';\nimport { useDispatch } from '../context/DispatchContext';\nimport Button from '../elements/Button';\nimport CheckBox from '../elements/CheckBox';\nimport CloseButton from '../elements/CloseButton';\nimport IsotopesViewer from '../elements/IsotopesViewer';\nimport Label from '../elements/Label';\nimport FormikCheckBox from '../elements/formik/FormikCheckBox';\nimport FormikErrorsSummary from '../elements/formik/FormikErrorsSummary';\nimport FormikForm from '../elements/formik/FormikForm';\nimport FormikInput from '../elements/formik/FormikInput';\nimport FormikSelect from '../elements/formik/FormikSelect';\nimport { useAlert } from '../elements/popup/Alert';\nimport { PREDICT_SPECTRA, SET_LOADING_FLAG } from '../reducer/types/Types';\nimport { useStateWithLocalStorage } from '../utility/LocalStorage';\n\nimport { ModalStyles } from './ModalStyle';\n\nconst styles = css`\n  .row {\n    align-items: center;\n  }\n\n  .inner-content {\n    flex: 1;\n  }\n\n  .custom-label {\n    width: 160px;\n    font-weight: 500;\n  }\n\n  .nucleus-label {\n    padding: 0 10px;\n    color: black;\n    font-weight: 700;\n\n    &.disabled {\n      opacity: 0.5;\n      color: black;\n    }\n  }\n  .warning {\n    color: #c40000;\n    font-weight: bold;\n    font-size: 13px;\n    text-align: justify;\n    margin-top: 30px;\n  }\n\n  .warning-container {\n    margin-top: 5px;\n    display: flex;\n    input {\n      margin: 5px 5px 5px 0;\n    }\n  }\n\n  .middle-x {\n    padding: 0 10px;\n  }\n\n  .group-label {\n    width: 100%;\n    display: block;\n    border-bottom: 1px solid #efefef;\n    padding-bottom: 5px;\n    font-weight: 600;\n    color: #005d9e;\n  }\n`;\n\nconst NUMBER_OF_POINTS_1D = generateNumbersPowerOfX(12, 19);\nconst NUMBER_OF_POINTS_2D = generateNumbersPowerOfX(10, 10, {\n  format: (value) => value,\n});\n\nconst predictionFormValidation = Yup.object().shape({\n  name: Yup.string().required().label('Name'),\n  frequency: Yup.number().integer().required().label('Frequency'),\n  '1d': Yup.object({\n    '1H': Yup.object({\n      from: Yup.number().integer().required().label(\"1H ' From ' \"),\n      to: Yup.number().integer().required().label(\"1H ' To ' \"),\n    }),\n    '13C': Yup.object().shape({\n      from: Yup.number().integer().required().label(\"13C ' From ' \"),\n      to: Yup.number().integer().required().label(\"13C ' To ' \"),\n    }),\n    lineWidth: Yup.number().integer().min(1).required().label('Line Width'),\n    nbPoints: Yup.number().integer().required().label('1D Number Of Points'),\n  }),\n  '2d': Yup.object({\n    nbPoints: Yup.object({\n      x: Yup.number().integer().required().label('2D Number Of Points'),\n      y: Yup.number().integer().required().label('2D Number Of Points'),\n    }),\n  }),\n  spectra: Yup.object({\n    proton: Yup.boolean(),\n    carbon: Yup.boolean(),\n    cosy: Yup.boolean(),\n    hsqc: Yup.boolean(),\n    hmbc: Yup.boolean(),\n  }).test(\n    'check-options',\n    'You must check one of the options to start prediction',\n    (obj) => {\n      if (Object.values(obj).includes(true)) {\n        return true;\n      }\n      return false;\n    },\n  ),\n});\n\ninterface PredictSpectraModalProps {\n  onClose?: (element?: string) => void;\n  molfile: any;\n}\n\nfunction PredictSpectraModal({\n  onClose = () => null,\n  molfile,\n}: PredictSpectraModalProps) {\n  const refForm = useRef<any>();\n  const dispatch = useDispatch();\n  const alert = useAlert();\n  const [isApproved, setApproved] = useState(false);\n  const [predictionPreferences, setPredictionPreferences] =\n    useStateWithLocalStorage('nmrium-prediction-preferences');\n\n  const {\n    toolOptions: {\n      data: { predictionIndex },\n    },\n  } = useChartData();\n\n  const handleSave = useCallback(() => {\n    refForm.current.submitForm();\n  }, []);\n\n  const initValues = useMemo(() => {\n    const { isApproved: isAgree, ...options } = predictionPreferences;\n    setApproved(isAgree);\n    return Object.assign(defaultPredictionOptions, options, {\n      name: `Prediction ${predictionIndex + 1}`,\n    });\n  }, [predictionPreferences, predictionIndex]);\n\n  const submitHandler = useCallback(\n    (values) => {\n      void (async () => {\n        setPredictionPreferences({ ...values, isApproved });\n        dispatch({\n          type: SET_LOADING_FLAG,\n          isLoading: true,\n        });\n\n        const predictedSpectra = Object.entries(values.spectra)\n          .reduce<Array<string>>((acc, [key, value]) => {\n            if (value) {\n              acc.push(key);\n            }\n            return acc;\n          }, [])\n          .join(' , ');\n\n        const hideLoading = await alert.showLoading(\n          `Predict ${predictedSpectra} in progress`,\n        );\n\n        dispatch({\n          type: PREDICT_SPECTRA,\n          payload: { mol: molfile, options: values },\n        });\n\n        hideLoading();\n        onClose();\n      })();\n    },\n    [alert, dispatch, isApproved, molfile, onClose, setPredictionPreferences],\n  );\n\n  const approveCheckHandler = useCallback((e) => {\n    setApproved(e.target.checked);\n  }, []);\n\n  return (\n    <div css={[ModalStyles, styles]}>\n      <div className=\"header handle\">\n        <span>Prediction of NMR spectrum</span>\n        <CloseButton onClick={onClose} className=\"close-bt\" />\n      </div>\n      <div className=\"inner-content\">\n        <FormikForm\n          ref={refForm}\n          initialValues={initValues}\n          validationSchema={predictionFormValidation}\n          onSubmit={submitHandler}\n        >\n          <FormikErrorsSummary />\n          <div className=\"row margin-10\">\n            <span className=\"custom-label\">Name :</span>\n            <FormikInput\n              name=\"name\"\n              style={{ input: { width: '200px', textAlign: 'left' } }}\n            />\n          </div>\n          <div className=\"row margin-10\">\n            <span className=\"custom-label\">Spectrometer Frequency :</span>\n\n            <FormikSelect\n              data={FREQUENCIES}\n              style={{ width: 290, height: 30, margin: 0 }}\n              name=\"frequency\"\n            />\n          </div>\n\n          <span className=\"group-label\">1D Options </span>\n\n          <div className=\"row margin-10 padding-h-10\">\n            <IsotopesViewer value=\"1H\" className=\"custom-label\" />\n            <Label title=\"From\">\n              <FormikInput name=\"1d.1H.from\" type=\"number\" />\n            </Label>\n            <Label title=\"To\" style={{ label: { padding: '0 10px' } }}>\n              <FormikInput name=\"1d.1H.to\" type=\"number\" />\n            </Label>\n          </div>\n          <div className=\"row margin-10 padding-h-10\">\n            <IsotopesViewer value=\"13C\" className=\"custom-label\" />\n            <Label title=\"From\">\n              <FormikInput name=\"1d.13C.from\" type=\"number\" />\n            </Label>\n            <Label title=\"To\" style={{ label: { padding: '0 10px' } }}>\n              <FormikInput name=\"1d.13C.to\" type=\"number\" />\n            </Label>\n          </div>\n          <div className=\"row margin-10 padding-h-10\">\n            <span className=\"custom-label\">Line Width : </span>\n            <FormikInput\n              name=\"1d.lineWidth\"\n              type=\"number\"\n              style={{ input: { margin: 0 } }}\n            />\n            <span style={{ paddingLeft: '0.4rem' }}> Hz </span>\n          </div>\n          <div className=\"row margin-10 padding-h-10\">\n            <span className=\"custom-label\">Number of Points : </span>\n            <FormikSelect\n              data={NUMBER_OF_POINTS_1D}\n              name=\"1d.nbPoints\"\n              style={{ width: 290, height: 30, margin: 0 }}\n            />\n          </div>\n          <span className=\"group-label\">2D Options </span>\n\n          <div className=\"row margin-10 padding-h-10\">\n            <span className=\"custom-label\">Number of Points : </span>\n            <FormikSelect\n              data={NUMBER_OF_POINTS_2D}\n              name=\"2d.nbPoints.x\"\n              style={{ margin: 0, height: 30 }}\n            />\n            <span className=\"middle-x\"> X </span>\n            <FormikSelect\n              data={NUMBER_OF_POINTS_2D}\n              name=\"2d.nbPoints.y\"\n              style={{ margin: 0, height: 30 }}\n            />\n          </div>\n          <div className=\"row margin-10\">\n            <span className=\"group-label\">Spectra </span>\n          </div>\n          <div\n            className=\"row margin-10 padding-h-10\"\n            style={{ justifyContent: 'space-between' }}\n          >\n            <div className=\"row\">\n              <FormikCheckBox name=\"spectra.proton\" />\n              <IsotopesViewer value=\"1H\" className=\"nucleus-label\" />\n            </div>\n            <div className=\"row\">\n              <FormikCheckBox name=\"spectra.carbon\" />\n              <IsotopesViewer value=\"13C\" className=\"nucleus-label\" />\n            </div>\n            <div className=\"row\">\n              <FormikCheckBox name=\"spectra.cosy\" />\n              <IsotopesViewer value=\"COSY\" className=\"nucleus-label\" />\n            </div>\n            <div className=\"row\">\n              <FormikCheckBox name=\"spectra.hsqc\" />\n              <IsotopesViewer value=\"HSQC\" className=\"nucleus-label\" />\n            </div>\n            <div className=\"row\">\n              <FormikCheckBox name=\"spectra.hmbc\" />\n              <IsotopesViewer value=\"HMBC\" className=\"nucleus-label\" />\n            </div>\n          </div>\n        </FormikForm>\n        <p className=\"warning\">\n          In order to predict spectra we are calling an external service and the\n          chemical structure will leave your browser! You should never predict\n          spectra for confidential molecules.\n        </p>\n        <div className=\"warning-container\">\n          <CheckBox\n            onChange={approveCheckHandler}\n            checked={isApproved}\n            key={String(isApproved)}\n          />\n          <p>I confirm that the chemical structure is not confidential.</p>\n        </div>\n      </div>\n      <div className=\"footer-container\">\n        <Button.Done onClick={handleSave} disabled={!isApproved}>\n          Predict spectrum\n        </Button.Done>\n      </div>\n    </div>\n  );\n}\n\nexport default PredictSpectraModal;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { SvgNmrFt } from 'cheminfo-font';\nimport { useCallback } from 'react';\nimport {\n  FaCopy,\n  FaDownload,\n  FaFileExport,\n  FaFileImage,\n  FaPaste,\n  FaPlus,\n  FaRegTrashAlt,\n} from 'react-icons/fa';\n\nimport { useAssignmentData } from '../../assignment/AssignmentsContext';\nimport { useDispatch } from '../../context/DispatchContext';\nimport { useGlobal } from '../../context/GlobalContext';\nimport ButtonToolTip from '../../elements/ButtonToolTip';\nimport MenuButton from '../../elements/MenuButton';\nimport ToolTip from '../../elements/ToolTip/ToolTip';\nimport { useAlert } from '../../elements/popup/Alert';\nimport { positions, useModal } from '../../elements/popup/Modal';\nimport PredictSpectraModal from '../../modal/PredictSpectraModal';\nimport { ADD_MOLECULE, DELETE_MOLECULE } from '../../reducer/types/Types';\nimport {\n  copyPNGToClipboard,\n  copyTextToClipboard,\n  exportAsSVG,\n} from '../../utility/Export';\n\nconst toolbarStyle = css`\n  display: flex;\n  flex-direction: row;\n  border-bottom: 0.55px solid rgb(240, 240, 240);\n  padding: 0px 5px;\n\n  button svg {\n    fill: #4e4e4e;\n  }\n\n  button {\n    background-color: transparent;\n    border: none;\n    padding: 5px;\n  }\n\n  p {\n    margin: 0;\n    text-align: right;\n    width: 100%;\n    line-height: 22px;\n    padding: 0px 10px;\n  }\n`;\n\nconst MOL_EXPORT_MENU = [\n  {\n    id: 'molfile',\n    icon: <FaCopy />,\n    label: 'Copy as molfile',\n  },\n  {\n    id: 'png',\n    icon: <FaFileImage />,\n    label: 'Copy as PNG',\n  },\n  {\n    id: 'svg',\n    icon: <FaDownload />,\n    label: 'Export as SVG',\n  },\n];\n\nexport interface MoleculeHeaderActionsOptions {\n  hidePast?: boolean;\n  hideAdd?: boolean;\n  hideExport?: boolean;\n  hideDelete?: boolean;\n  hidePredict?: boolean;\n}\ninterface MoleculePanelHeaderProps {\n  currentIndex: number;\n  molecules: Array<any>;\n  onMoleculeIndexChange: (index: number) => void;\n  onOpenMoleculeEditor: () => void;\n  actionsOptions?: MoleculeHeaderActionsOptions;\n}\n\nexport default function MoleculePanelHeader({\n  currentIndex,\n  molecules,\n  onMoleculeIndexChange = () => null,\n  onOpenMoleculeEditor = () => null,\n  actionsOptions = {},\n}: MoleculePanelHeaderProps) {\n  const { rootRef } = useGlobal();\n  const alert = useAlert();\n  const dispatch = useDispatch();\n  const modal = useModal();\n  const assignmentData = useAssignmentData();\n\n  const saveAsSVGHandler = useCallback(() => {\n    if (!rootRef) return;\n    exportAsSVG(rootRef, `molSVG${currentIndex}`, 'molFile');\n  }, [rootRef, currentIndex]);\n\n  const saveAsPNGHandler = useCallback(() => {\n    if (!rootRef) return;\n    copyPNGToClipboard(rootRef, `molSVG${currentIndex}`);\n    alert.success('MOL copied as PNG to clipboard');\n  }, [rootRef, alert, currentIndex]);\n\n  const saveAsMolHandler = useCallback(() => {\n    if (molecules[currentIndex]) {\n      void copyTextToClipboard(molecules[currentIndex].molfile).then((flag) => {\n        if (flag) {\n          alert.success('MOLFile copied to clipboard');\n        } else {\n          alert.error('copied not completed');\n        }\n      });\n    }\n  }, [alert, currentIndex, molecules]);\n\n  const exportHandler = useCallback(\n    ({ id }) => {\n      switch (id) {\n        case 'molfile':\n          saveAsMolHandler();\n          break;\n        case 'png':\n          saveAsPNGHandler();\n          break;\n        case 'svg':\n          saveAsSVGHandler();\n          break;\n        default:\n          break;\n      }\n    },\n    [saveAsMolHandler, saveAsPNGHandler, saveAsSVGHandler],\n  );\n\n  const handlePaste = useCallback(() => {\n    void navigator.clipboard.readText().then((molfile) => {\n      dispatch({ type: ADD_MOLECULE, molfile });\n    });\n  }, [dispatch]);\n\n  const handleDelete = useCallback(() => {\n    if (molecules[currentIndex]?.key) {\n      onMoleculeIndexChange(0);\n      dispatch({\n        type: DELETE_MOLECULE,\n        payload: { key: molecules[currentIndex].key, assignmentData },\n      });\n    }\n  }, [\n    molecules,\n    currentIndex,\n    onMoleculeIndexChange,\n    dispatch,\n    assignmentData,\n  ]);\n\n  const openPredictSpectraModal = useCallback(() => {\n    modal.show(<PredictSpectraModal molfile={molecules[currentIndex]} />, {\n      position: positions.TOP_CENTER,\n      enableResizing: true,\n      width: 600,\n    });\n  }, [modal, molecules, currentIndex]);\n\n  return (\n    <div css={toolbarStyle}>\n      {!actionsOptions.hideExport && (\n        <MenuButton\n          component={<FaFileExport />}\n          toolTip=\"Export As\"\n          items={MOL_EXPORT_MENU}\n          onClick={exportHandler}\n        />\n      )}\n\n      {!actionsOptions.hidePast && (\n        <ToolTip title=\"Paste molfile\" popupPlacement=\"left\">\n          <button className=\"bar-button\" type=\"button\" onClick={handlePaste}>\n            <FaPaste />\n          </button>\n        </ToolTip>\n      )}\n      {!actionsOptions.hideAdd && (\n        <ToolTip title=\"Add Molecule\" popupPlacement=\"left\">\n          <button\n            className=\"bar-button\"\n            type=\"button\"\n            onClick={onOpenMoleculeEditor}\n            data-test-id=\"panel-structures-button-add\"\n          >\n            <FaPlus />\n          </button>\n        </ToolTip>\n      )}\n      {!actionsOptions.hideDelete && (\n        <ToolTip title=\"Delete Molecule\" popupPlacement=\"left\">\n          <button className=\"bar-button\" type=\"button\" onClick={handleDelete}>\n            <FaRegTrashAlt />\n          </button>\n        </ToolTip>\n      )}\n      {!actionsOptions.hidePredict && molecules && molecules.length > 0 && (\n        <ButtonToolTip\n          popupTitle=\"Predict Spectra\"\n          popupPlacement=\"left\"\n          onClick={openPredictSpectraModal}\n        >\n          <SvgNmrFt />\n        </ButtonToolTip>\n      )}\n      <p>\n        {molecules &&\n          molecules.length > 0 &&\n          `${+(currentIndex + 1)} / ${molecules.length}`}{' '}\n      </p>\n    </div>\n  );\n}\n","import { Range } from '../../../data/types/data1d';\nimport { Zone } from '../../../data/types/data2d';\nimport { AssignmentContext, Axis } from '../../assignment/AssignmentsContext';\n\ninterface Atom {\n  oclID: string;\n  atomLabel: string;\n  nbAtoms: number;\n  nbHydrogens: number;\n  hydrogenOCLIDs: string[];\n}\nexport interface AtomData {\n  oclIDs: string[];\n  nbAtoms: number;\n}\n\nfunction getElements(activeTab: string) {\n  const nuclei = activeTab.split(',');\n  return nuclei.map((nucleus) => nucleus.replace(/[0-9]/g, ''));\n}\n\nexport function extractFromAtom(\n  atom: Atom,\n  activeTab: string,\n  axis?: Axis | null,\n): AtomData {\n  const elements = getElements(activeTab);\n\n  if (elements.length > 0 && Object.keys(atom).length > 0) {\n    const dim = axis === 'x' ? 0 : axis === 'y' ? 1 : null;\n\n    switch (dim !== null && elements[dim]) {\n      case atom.atomLabel: {\n        // take always oclID if atom type is same as element of activeTab)\n        return { oclIDs: [atom.oclID], nbAtoms: atom.nbAtoms };\n      }\n      case 'H': {\n        // if we are in proton spectrum and use then the IDs of attached hydrogens of an atom\n        return {\n          oclIDs: atom.hydrogenOCLIDs,\n          nbAtoms: atom.nbAtoms * atom.nbHydrogens,\n        };\n      }\n      default:\n        return {\n          oclIDs: [atom.oclID].concat(atom.hydrogenOCLIDs),\n          nbAtoms: atom.nbAtoms + atom.nbAtoms * atom.nbHydrogens,\n        };\n    }\n  }\n\n  return { oclIDs: [], nbAtoms: 0 };\n}\n\nexport function findDatumAndSignalIndex(data: (Range | Zone)[], id: string) {\n  // if datum could be found then the id is on range/zone level\n  let datum = data.find((_datum) => _datum.id === id);\n  let signalIndex;\n  if (!datum) {\n    // figure out the datum via id\n    for (const record of data) {\n      signalIndex = record.signals.findIndex((signal) => signal.id === id);\n      if (signalIndex >= 0) {\n        datum = record;\n        break;\n      }\n    }\n  }\n\n  return { datum, signalIndex };\n}\n\nexport function getHighlightsOnHover(\n  assignments: AssignmentContext,\n  oclIDs,\n  data,\n) {\n  // set all IDs to highlight when hovering over an atom from assignment data\n  let highlights: string[] = [];\n  const assignmentsByKey = assignments.data.assignments;\n  for (const key in assignmentsByKey) {\n    const assignments = assignmentsByKey[key];\n    let isFound = false;\n\n    for (const axis in assignments) {\n      if (assignments[axis]?.some((oclKey) => oclIDs.includes(oclKey))) {\n        highlights = highlights.concat(assignments[axis]);\n        const { datum, signalIndex } = findDatumAndSignalIndex(data, key);\n\n        if (datum) {\n          highlights.push(datum.id);\n          if (signalIndex !== undefined) {\n            highlights.push(datum.signals[signalIndex].id);\n          }\n          isFound = true;\n          break;\n        }\n      }\n    }\n    if (isFound) {\n      break;\n    }\n  }\n\n  return highlights;\n}\n\nexport function getCurrentDiaIDsToHighlight(assignmentData: AssignmentContext) {\n  const { highlighted, assignments } = assignmentData.data;\n  const assignment = highlighted ? assignments[highlighted.id] : null;\n  const axisHover = highlighted ? highlighted.axis : null;\n\n  if (axisHover && assignment && assignment[axisHover]) {\n    return assignment[axisHover];\n  } else {\n    return (assignment?.x || []).concat(assignment?.y || []);\n  }\n}\n\nexport function toggleDiaIDs(diaIDs: string[], atomInformation: AtomData) {\n  let _diaIDs = diaIDs ? diaIDs.slice() : [];\n  const { nbAtoms, oclIDs } = atomInformation;\n  let tempNbAtoms = nbAtoms;\n  oclIDs.forEach((_oclID) => {\n    if (_diaIDs.includes(_oclID)) {\n      tempNbAtoms *= -1;\n      _diaIDs = _diaIDs.filter((_id) => _id !== _oclID);\n    } else {\n      _diaIDs.push(_oclID);\n    }\n  });\n  return [_diaIDs, tempNbAtoms];\n}\n","import { useCallback, useEffect, useMemo, useState } from 'react';\n\nimport { Range } from '../../../data/types/data1d';\nimport { Zone } from '../../../data/types/data2d';\nimport { ConcatenationString } from '../../../data/utilities/Concatenation';\nimport checkModifierKeyActivated from '../../../data/utilities/checkModifierKeyActivated';\nimport {\n  useAssignment,\n  useAssignmentData,\n} from '../../assignment/AssignmentsContext';\nimport { filterForIDsWithAssignment } from '../../assignment/utilities/filterForIDsWithAssignment';\nimport { useDispatch } from '../../context/DispatchContext';\nimport { useAlert } from '../../elements/popup/Alert';\nimport { HighlightedSource, useHighlightData } from '../../highlight';\nimport { DISPLAYER_MODE } from '../../reducer/core/Constants';\nimport { SET_DIAID_RANGE, SET_DIAID_ZONE } from '../../reducer/types/Types';\n\nimport {\n  AtomData,\n  extractFromAtom,\n  findDatumAndSignalIndex,\n  getCurrentDiaIDsToHighlight,\n  getHighlightsOnHover,\n  toggleDiaIDs,\n} from './Utilities';\n\nexport default function useAtomAssignment({\n  displayerMode,\n  activeTab: nucleus,\n  zones,\n  ranges,\n}) {\n  const alert = useAlert();\n  const dispatch = useDispatch();\n  const highlightData = useHighlightData();\n  const assignments = useAssignmentData();\n\n  const activeAssignment = useAssignment(\n    assignments.data.activated\n      ? assignments.data.activated.id\n      : ConcatenationString, // dummy value\n  );\n\n  const [onAtomHoverHighlights, setOnAtomHoverHighlights] = useState<any>([]);\n  const [onAtomHoverAction, setOnAtomHoverAction] = useState<\n    'show' | 'hide' | null\n  >(null);\n\n  useEffect(() => {\n    if (onAtomHoverAction) {\n      if (onAtomHoverAction === 'show') {\n        highlightData.dispatch({\n          type: 'SHOW',\n          payload: { convertedHighlights: onAtomHoverHighlights },\n        });\n      } else if (onAtomHoverAction === 'hide') {\n        highlightData.dispatch({\n          type: 'HIDE',\n          payload: { convertedHighlights: onAtomHoverHighlights },\n        });\n        setOnAtomHoverHighlights([]);\n      }\n      setOnAtomHoverAction(null);\n    }\n  }, [onAtomHoverAction, onAtomHoverHighlights, highlightData]);\n\n  const data = useMemo(() => {\n    if (zones || ranges) {\n      if (displayerMode === DISPLAYER_MODE.DM_1D && ranges && ranges.values) {\n        return ranges.values;\n      } else if (\n        displayerMode === DISPLAYER_MODE.DM_2D &&\n        zones &&\n        zones.values\n      ) {\n        return zones.values;\n      }\n    }\n    return [];\n  }, [displayerMode, ranges, zones]);\n\n  const assignedDiaIDs = useMemo(() => {\n    const assignedDiaID: { x: Array<any>; y: Array<any> } = { x: [], y: [] };\n    const assignment = assignments.data.assignments;\n    for (let id in assignment) {\n      if (assignment[id].x) {\n        assignedDiaID.x.push(...assignment[id].x);\n      }\n      if (assignment[id].y) {\n        assignedDiaID.y.push(...assignment[id].y);\n      }\n    }\n    // with its structure it's prepared for showing assigned IDs per axis\n    return assignedDiaID;\n  }, [assignments.data]);\n\n  // used for atom highlighting for now, until we would like to highlight atoms per axis separately\n  const assignedDiaIDsMerged = useMemo(\n    () => assignedDiaIDs.x.concat(assignedDiaIDs.y),\n    [assignedDiaIDs.x, assignedDiaIDs.y],\n  );\n\n  const currentDiaIDsToHighlight = useMemo(() => {\n    let highlights: string[] = [];\n    highlightData.highlight.highlighted.forEach((highlightID) => {\n      const temp = assignments.data.assignments[highlightID];\n      if (temp) {\n        const { datum } = findDatumAndSignalIndex(data, highlightID);\n        const type = highlightData.highlight.sourceData?.type;\n        if (\n          datum &&\n          (type === HighlightedSource.ZONE || type === HighlightedSource.RANGE)\n        ) {\n          // we are on range/zone level only, so add the belonging signal IDs to highlight too\n          highlights = highlights.concat(\n            datum.signals\n              .map((signal) =>\n                filterForIDsWithAssignment(assignments, [signal.id]).length > 0\n                  ? signal.diaIDs\n                  : [],\n              )\n              .flat(),\n          );\n        }\n      }\n    });\n    return getCurrentDiaIDsToHighlight(assignments).concat(highlights);\n  }, [\n    assignments,\n    data,\n    highlightData.highlight.highlighted,\n    highlightData.highlight.sourceData?.type,\n  ]);\n\n  const toggleAssignment = useCallback((diaID, atomInformation: AtomData) => {\n    // a previous version of the code prevented to assign many time the same atom\n    // see revision cc13abc18f77b6787b923e3c4edaef51750d9e90\n    return toggleDiaIDs(diaID, atomInformation);\n  }, []);\n\n  const handleOnClickAtom = useCallback(\n    (atom, event) => {\n      if (!checkModifierKeyActivated(event) && activeAssignment.activated) {\n        const { axis, id } = activeAssignment.activated;\n        if (id && axis) {\n          const atomInformation = extractFromAtom(atom, nucleus, axis);\n          if (atomInformation.nbAtoms > 0) {\n            // save assignment in assignment hook\n            const dimension =\n              displayerMode === DISPLAYER_MODE.DM_1D ? '1D' : '2D';\n            activeAssignment.toggle(atomInformation.oclIDs, dimension);\n            // console.log(activeAssignment);\n            // save assignment (diaIDs) in range/zone data\n            const { datum, signalIndex } = findDatumAndSignalIndex(\n              data,\n              activeAssignment.id,\n            );\n            if (datum) {\n              // determine the level of setting the diaIDs array (range vs. signal level) and save there\n              // let nbAtoms = 0;\n              // on range/zone level\n\n              if (displayerMode === DISPLAYER_MODE.DM_1D) {\n                const range = datum as Range;\n                let _diaIDs: string[] = [];\n                if (signalIndex === undefined) {\n                  _diaIDs = range?.diaIDs || [];\n                } else {\n                  _diaIDs = range?.signals[signalIndex]?.diaIDs || [];\n                }\n                const [_diaID, nbAtoms] = toggleAssignment(\n                  _diaIDs,\n                  atomInformation,\n                );\n                dispatch({\n                  type: SET_DIAID_RANGE,\n                  payload: {\n                    nbAtoms,\n                    rangeData: datum,\n                    diaIDs: _diaID,\n                    signalIndex,\n                  },\n                });\n              } else {\n                const zone = datum as Zone;\n                let _diaIDs: string[] = [];\n                if (signalIndex === undefined) {\n                  _diaIDs = zone[axis]?.diaIDs || [];\n                } else {\n                  _diaIDs = zone?.signals[signalIndex][axis]?.diaIDs || [];\n                }\n                const [_diaID, nbAtoms] = toggleAssignment(\n                  _diaIDs,\n                  atomInformation,\n                );\n                dispatch({\n                  type: SET_DIAID_ZONE,\n                  payload: {\n                    nbAtoms,\n                    zoneData: datum,\n                    diaIDs: _diaID,\n                    axis: axis,\n                    signalIndex,\n                  },\n                });\n              }\n            }\n            activeAssignment.setActive(axis);\n          } else {\n            alert.info(\n              'Not assigned! Different atom type or no attached hydrogens found!',\n            );\n          }\n        }\n      }\n    },\n    [\n      activeAssignment,\n      alert,\n      data,\n      dispatch,\n      displayerMode,\n      nucleus,\n      toggleAssignment,\n    ],\n  );\n\n  const handleOnAtomHover = useCallback(\n    (atom) => {\n      const { oclIDs } = extractFromAtom(atom, nucleus);\n\n      // on enter the atom\n      if (oclIDs.length > 0) {\n        // set all IDs to highlight when hovering over an atom from assignment data\n        const highlights = getHighlightsOnHover(assignments, oclIDs, data);\n        setOnAtomHoverHighlights(highlights);\n        setOnAtomHoverAction('show');\n      } else {\n        // on leave the atom\n        setOnAtomHoverAction('hide');\n      }\n      // }\n    },\n    [assignments, data, nucleus],\n  );\n\n  return {\n    handleOnAtomHover,\n    handleOnClickAtom,\n    currentDiaIDsToHighlight,\n    assignedDiaIDsMerged,\n  };\n}\n","/** @jsxImportSource @emotion/react */\nimport { css, SerializedStyles } from '@emotion/react';\nimport OCL from 'openchemlib/full';\nimport { useState, useCallback, useEffect, memo, ReactElement } from 'react';\nimport { ResponsiveChart } from 'react-d3-utils';\nimport { MF } from 'react-mf';\nimport OCLnmr from 'react-ocl-nmr';\n\nimport { Molecule } from '../../../data/molecules/Molecule';\nimport { Datum1D, Ranges } from '../../../data/types/data1d';\nimport { Datum2D, Zones } from '../../../data/types/data2d';\nimport { useChartData } from '../../context/ChartContext';\nimport { useDispatch } from '../../context/DispatchContext';\nimport NextPrev from '../../elements/NextPrev';\nimport { positions, useModal } from '../../elements/popup/Modal';\nimport useSpectrum from '../../hooks/useSpectrum';\nimport MoleculeStructureEditorModal from '../../modal/MoleculeStructureEditorModal';\nimport { DISPLAYER_MODE } from '../../reducer/core/Constants';\nimport { SET_MOLECULE } from '../../reducer/types/Types';\n\nimport MoleculePanelHeader, {\n  MoleculeHeaderActionsOptions,\n} from './MoleculePanelHeader';\nimport useAtomAssignment from './useAtomAssignment';\n\nconst styles: Record<\n  'panel' | 'innerPanel' | 'molecule' | 'toolbar' | 'slider' | 'items',\n  SerializedStyles\n> = {\n  panel: css({\n    display: 'flex',\n    overflow: 'auto',\n    flexGrow: 1,\n    width: '100%',\n    height: '100%',\n    flexDirection: 'column',\n  }),\n  innerPanel: css({\n    display: 'flex',\n    flex: '1',\n    flexDirection: 'column',\n    overflow: 'auto',\n  }),\n  molecule: css({\n    display: 'flex',\n    flex: '1',\n  }),\n  toolbar: css({\n    display: 'flex',\n    borderBottom: '0.55px solid rgb(240, 240, 240)',\n    padding: '0px 10px',\n    justifyContent: 'end',\n    height: 22,\n  }),\n  slider: css({\n    display: 'flex',\n    flexDirection: 'column',\n    justifyContent: 'center',\n    alignItems: 'center',\n    flexGrow: 1,\n    minHeight: 0,\n  }),\n  items: css({\n    display: 'flex',\n    flexDirection: 'column',\n    flex: '1 1 0%',\n    height: '100%',\n    minHeight: 0,\n  }),\n};\n\ninterface MoleculePanelInnerProps extends MoleculePanelProps {\n  zones: Zones;\n  ranges: Ranges;\n  molecules: Array<Molecule>;\n  activeTab: string;\n  displayerMode: DISPLAYER_MODE;\n}\n\nfunction MoleculePanelInner({\n  zones,\n  ranges,\n  molecules: moleculesProp,\n  activeTab,\n  displayerMode,\n  onMoleculeChange,\n  actionsOptions,\n  children,\n}: MoleculePanelInnerProps) {\n  const [currentIndex, setCurrentIndex] = useState(0);\n  const [molecules, setMolecules] = useState<any>([]);\n\n  const dispatch = useDispatch();\n  const modal = useModal();\n\n  const {\n    currentDiaIDsToHighlight,\n    handleOnAtomHover,\n    handleOnClickAtom,\n    assignedDiaIDsMerged,\n  } = useAtomAssignment({ zones, ranges, activeTab, displayerMode });\n\n  useEffect(() => {\n    if (moleculesProp) {\n      setMolecules((prevMolecules) => {\n        if (moleculesProp.length > prevMolecules.length) {\n          setCurrentIndex(molecules.length);\n        }\n        return moleculesProp;\n      });\n    }\n  }, [molecules.length, moleculesProp]);\n\n  useEffect(() => {\n    onMoleculeChange?.(molecules[currentIndex] || null);\n  }, [currentIndex, molecules, onMoleculeChange]);\n\n  const handleReplaceMolecule = useCallback(\n    (key, molfile) => {\n      dispatch({ type: SET_MOLECULE, molfile, key });\n    },\n    [dispatch],\n  );\n\n  const openMoleculeEditorHandler = useCallback(\n    (moleclue = null) => {\n      modal.show(<MoleculeStructureEditorModal selectedMolecule={moleclue} />, {\n        position: positions.TOP_CENTER,\n        width: 700,\n        height: 500,\n      });\n    },\n    [modal],\n  );\n\n  const moleculeIndexHandler = useCallback((index) => {\n    setCurrentIndex(index);\n  }, []);\n\n  return (\n    <div css={styles.panel}>\n      <MoleculePanelHeader\n        currentIndex={currentIndex}\n        molecules={molecules}\n        onOpenMoleculeEditor={() => openMoleculeEditorHandler()}\n        onMoleculeIndexChange={moleculeIndexHandler}\n        actionsOptions={actionsOptions}\n      />\n      <div css={styles.innerPanel}>\n        <div css={styles.molecule}>\n          <NextPrev\n            onChange={(slideIndex) => setCurrentIndex(slideIndex)}\n            defaultIndex={currentIndex}\n          >\n            {molecules && molecules.length > 0 ? (\n              molecules.map((mol: Molecule, index) => (\n                <div key={mol.key} css={styles.items}>\n                  <span css={styles.toolbar}>\n                    <MF mf={mol.mf} /> - {mol.mw?.toFixed(2)}\n                  </span>\n                  <div\n                    css={styles.slider}\n                    className=\"mol-svg-container\"\n                    onDoubleClick={() => openMoleculeEditorHandler(mol)}\n                    style={{\n                      backgroundColor:\n                        (index + 1) % 2 !== 0 ? '#fafafa' : 'white',\n                    }}\n                  >\n                    <ResponsiveChart>\n                      {({ height, width }) => {\n                        return (\n                          <OCLnmr\n                            OCL={OCL}\n                            id={`molSVG${index}`}\n                            width={width}\n                            height={height}\n                            molfile={mol.molfile || ''}\n                            setMolfile={(molfile) =>\n                              handleReplaceMolecule(mol.key, molfile)\n                            }\n                            setSelectedAtom={handleOnClickAtom}\n                            atomHighlightColor={\n                              currentDiaIDsToHighlight &&\n                              currentDiaIDsToHighlight.length > 0\n                                ? 'red'\n                                : '#FFD700'\n                            }\n                            atomHighlightOpacity={0.35}\n                            highlights={\n                              currentDiaIDsToHighlight &&\n                              currentDiaIDsToHighlight.length > 0\n                                ? currentDiaIDsToHighlight\n                                : assignedDiaIDsMerged\n                            }\n                            setHoverAtom={handleOnAtomHover}\n                          />\n                        );\n                      }}\n                    </ResponsiveChart>\n                  </div>\n                </div>\n              ))\n            ) : (\n              <div\n                css={styles.slider}\n                style={{ height: '100%' }}\n                onClick={() => openMoleculeEditorHandler()}\n              >\n                <span>Click to draw molecule</span>\n              </div>\n            )}\n          </NextPrev>\n        </div>\n        {children}\n      </div>\n    </div>\n  );\n}\n\nconst MemoizedMoleculePanel = memo(MoleculePanelInner);\nconst emptyData = { ranges: {}, zones: {} };\n\ninterface MoleculePanelProps {\n  onMoleculeChange?: (molecule: Molecule) => void;\n  children?: ReactElement;\n  actionsOptions?: MoleculeHeaderActionsOptions;\n}\n\nexport default function MoleculePanel({\n  onMoleculeChange,\n  children,\n  actionsOptions,\n}: MoleculePanelProps) {\n  const { molecules, displayerMode, activeTab } = useChartData();\n\n  const data = useSpectrum(emptyData);\n  const ranges: Ranges = (data as Datum1D)?.ranges || {};\n  const zones: Zones = (data as Datum2D)?.zones || {};\n\n  return (\n    <MemoizedMoleculePanel\n      {...{\n        molecules,\n        displayerMode,\n        activeTab,\n        ranges,\n        zones,\n        onMoleculeChange,\n        actionsOptions,\n      }}\n    >\n      {children}\n    </MemoizedMoleculePanel>\n  );\n}\n","/** @jsxImportSource @emotion/react */\nimport { useCallback, useEffect, useMemo, useRef } from 'react';\n\nimport { REFERENCES } from '../../data/constants/References';\nimport { useDispatch } from '../context/DispatchContext';\nimport Button from '../elements/Button';\nimport CloseButton from '../elements/CloseButton';\nimport Label from '../elements/Label';\nimport Select from '../elements/Select';\nimport FormikForm from '../elements/formik/FormikForm';\nimport FormikInput from '../elements/formik/FormikInput';\nimport { ALIGN_SPECTRA } from '../reducer/types/Types';\nimport Events from '../utility/Events';\n\nimport { ModalStyles } from './ModalStyle';\n\nconst baseList = [{ key: 1, value: 'manual', label: 'Manual' }];\n\ninterface AlignSpectraModalProps {\n  onClose?: (element?: string) => void;\n  nucleus: any;\n}\n\nfunction AlignSpectraModal({\n  onClose = () => null,\n  nucleus,\n}: AlignSpectraModalProps) {\n  const refForm = useRef<any>();\n  const dispatch = useDispatch();\n  const List = useMemo(() => {\n    const list = REFERENCES[nucleus]\n      ? Object.entries(REFERENCES[nucleus]).map(\n          (item) => ({\n            key: item[0],\n            value: item[0],\n            label: item[0],\n          }),\n          [],\n        )\n      : [];\n\n    return baseList.concat(list as any);\n  }, [nucleus]);\n  const handleSave = useCallback(() => {\n    refForm.current.submitForm();\n  }, []);\n\n  const submitHandler = useCallback(\n    (values) => {\n      dispatch({ type: ALIGN_SPECTRA, payload: values });\n      onClose();\n    },\n    [dispatch, onClose],\n  );\n\n  useEffect(() => {\n    function handler(event: any) {\n      const [from, to] = event.range;\n      refForm.current.setValues({ ...refForm.current.values, from, to });\n    }\n\n    Events.on('brushEnd', handler);\n\n    return () => {\n      Events.off('brushEnd', handler);\n    };\n  }, []);\n\n  const optionChangeHandler = useCallback(\n    (id) => {\n      const value = REFERENCES[nucleus][id];\n      const { delta = 0, ...resValues } = value || { delta: 0 };\n      refForm.current.setValues({\n        ...refForm.current.values,\n        targetX: delta,\n        ...resValues,\n      });\n    },\n    [nucleus],\n  );\n\n  return (\n    <div css={ModalStyles}>\n      <div className=\"header handle\">\n        <span>Spectra calibration</span>\n        <CloseButton onClick={onClose} className=\"close-bt\" />\n      </div>\n      <div className=\"inner-content\" style={{ flex: 1 }}>\n        <FormikForm\n          ref={refForm}\n          initialValues={{ from: -1, to: 1, nbPeaks: 1, targetX: 0 }}\n          onSubmit={submitHandler}\n        >\n          <div className=\"row margin-10\">\n            <span className=\"custom-label\">Options :</span>\n\n            <Select\n              data={List}\n              style={{ width: 270, height: 30, marginBottom: '20px' }}\n              onChange={optionChangeHandler}\n            />\n          </div>\n          <div className=\"row margin-10\">\n            <span className=\"custom-label\">Range :</span>\n            <Label title=\"From : \">\n              <FormikInput name=\"from\" type=\"number\" />\n            </Label>\n            <Label title=\"To : \">\n              <FormikInput name=\"to\" type=\"number\" />\n            </Label>\n          </div>\n          <div className=\" margin-10\">\n            <Label className=\"custom-label\" title=\"Number of Peaks : \">\n              <FormikInput name=\"nbPeaks\" type=\"number\" />\n            </Label>\n          </div>\n          <div className=\" margin-10\">\n            <Label className=\"custom-label\" title=\"Target PPM :\">\n              <FormikInput name=\"targetX\" type=\"number\" />\n            </Label>\n          </div>\n        </FormikForm>\n      </div>\n      <div className=\"footer-container\">\n        <Button.Done onClick={handleSave}>Done</Button.Done>\n      </div>\n    </div>\n  );\n}\n\nexport default AlignSpectraModal;\n","export default function calculate(code: string, args = null) {\n  try {\n    return new Function('args', `return ${code}`)(args);\n  } catch (e) {\n    return e;\n  }\n}\n","/** @jsxImportSource @emotion/react */\nimport { useFormikContext } from 'formik';\nimport { memo, useEffect, useState } from 'react';\n\nimport Eval from '../../utility/Evaluate';\n\nconst initCode = `function run(data) {\n\n  return JSON.stringify(data,undefined, 2);\n  \n}(args);\n`;\n\ninterface MultipleAnalysisCodeEditorProps {\n  data: any;\n}\n\nfunction MultipleAnalysisCodeEditor({ data }: MultipleAnalysisCodeEditorProps) {\n  const { values, setFieldValue } = useFormikContext<any>();\n  const [code, setCode] = useState(values.code ? values.code : initCode);\n  const [result, setResult] = useState('');\n\n  useEffect(() => {\n    const evalResult = Eval(code, data);\n    if (evalResult instanceof Error) {\n      setResult(evalResult.message);\n    } else {\n      setFieldValue('code', code);\n      setResult(evalResult);\n    }\n  }, [code, data, setFieldValue]);\n\n  return (\n    <div style={{ marginTop: '20px' }}>\n      <textarea\n        value={code}\n        onChange={(event) => setCode(event.target.value)}\n        style={{\n          fontFamily: '\"Fira code\", \"Fira Mono\", monospace',\n          fontSize: 12,\n          padding: '1em',\n          width: '90%',\n          backgroundColor: '#fcfcfc',\n          marginBottom: '10px',\n          minHeight: '100px',\n          overflow: 'auto',\n          maxHeight: '200px',\n        }}\n      />\n      <p style={{ marginBottom: '5px' }}>Result:</p>\n\n      <textarea\n        value={result}\n        readOnly\n        style={{\n          border: '0.55px solid #f3f3f3',\n          fontFamily: '\"Fira code\", \"Fira Mono\", monospace',\n          fontSize: 12,\n          padding: '1em',\n          width: '90%',\n          marginBottom: '10px',\n          minHeight: '100px',\n          overflow: 'auto',\n          maxHeight: '200px',\n        }}\n      />\n    </div>\n  );\n}\n\nexport default memo(MultipleAnalysisCodeEditor);\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport {\n  forwardRef,\n  useCallback,\n  useEffect,\n  useImperativeHandle,\n  useMemo,\n  useRef,\n  useState,\n} from 'react';\nimport { FaPlus } from 'react-icons/fa';\nimport * as Yup from 'yup';\n\nimport { COLUMNS_TYPES } from '../../../data/data1d/MultipleAnalysis';\nimport { useDispatch } from '../../context/DispatchContext';\nimport FormikForm from '../../elements/formik/FormikForm';\nimport FormikInput from '../../elements/formik/FormikInput';\nimport { SET_ANALYZE_SPECTRA_COLUMNS } from '../../reducer/types/Types';\n\nimport MultipleAnalysisCodeEditor from './MultipleAnalysisCodeEditor';\n\nconst styles = css`\n  width: 100%;\n  thead {\n    border-bottom: 1px solid lightgray;\n    background-color: #fafafa;\n    font-size: 12px;\n  }\n\n  td,\n  th {\n    padding: 3px 5px;\n    text-align: center;\n  }\n\n  .operation-col {\n    width: 30px;\n  }\n\n  .input {\n    height: 25px !important;\n    width: 100% !important;\n    margin: 0 !important;\n  }\n\n  .input.disbale {\n    background-color: #e8e8e8;\n    border-radius: 5px;\n  }\n\n  .label,\n  .index {\n    width: 100px;\n  }\n\n  .counter {\n    width: 50px;\n  }\n\n  .add {\n    background-color: transparent;\n    border: 0;\n    outline: none;\n    svg {\n      font-szie: 14px;\n      fill: green;\n    }\n  }\n`;\n\n// TODO: remove this hacky use of ref.\nfunction MultipleSpectraAnalysisPreferences({ data, onAfterSave }, ref: any) {\n  const dispatch = useDispatch();\n  const refForm = useRef<any>();\n  const [columns, setColumns] = useState({});\n\n  useImperativeHandle(ref, () => ({\n    saveSetting() {\n      refForm.current.submitForm();\n    },\n  }));\n\n  useEffect(() => {\n    const result = Object.keys(data.columns).reduce((acc, key) => {\n      acc[key] = { ...data.columns[key], tempKey: key };\n      return acc;\n    }, {});\n    setColumns(result);\n    refForm.current.setValues({ columns: result, code: data.code });\n  }, [data]);\n\n  const columnsKeys = useMemo(() => {\n    return Object.keys(columns);\n  }, [columns]);\n\n  const preferncesSchema = useMemo(() => {\n    function columnSchema() {\n      return columnsKeys.reduce((acc, key) => {\n        acc[key] = Yup.object().shape({\n          tempKey: Yup.string()\n            .required()\n            .test('unique', 'must be unique column name', (colmnName) => {\n              const formData = refForm.current.values.columns;\n              return (\n                Object.keys(formData).reduce((acc, colKey) => {\n                  if (formData[colKey].tempKey === colmnName) {\n                    (acc as any[]).push(colmnName);\n                  }\n                  return acc;\n                }, []).length === 1\n              );\n            }),\n          ...(columns[key].type === COLUMNS_TYPES.FORMULA\n            ? { formula: Yup.string().required() }\n            : {}),\n          index: Yup.string().required(),\n        });\n        return acc;\n      }, {});\n    }\n\n    return Yup.object().shape({\n      columns: Yup.object().shape(columnSchema()),\n    });\n  }, [columns, columnsKeys, refForm]);\n\n  const submitHandler = useCallback(\n    (values) => {\n      onAfterSave?.(true);\n      const result = Object.entries(values.columns).reduce(\n        (acc, [key, value]) => {\n          acc[key] = { ...columns[key], ...(value as any) };\n          return acc;\n        },\n        {},\n      );\n      dispatch({\n        type: SET_ANALYZE_SPECTRA_COLUMNS,\n        payload: { code: values.code, columns: result },\n      });\n    },\n    [columns, dispatch, onAfterSave],\n  );\n\n  const addNewColumn = useCallback((index) => {\n    setColumns((prevData) => {\n      return {\n        ...prevData,\n        [`temp${index}`]: {\n          tempKey: '',\n          type: 'FORMULA',\n          valueKey: 'value',\n          formula: '',\n          index: index,\n        },\n      };\n    });\n  }, []);\n\n  return (\n    <FormikForm\n      ref={refForm}\n      initialValues={{ columns, code: null }}\n      validationSchema={preferncesSchema}\n      onSubmit={submitHandler}\n    >\n      {columnsKeys && (\n        <table css={styles}>\n          <thead>\n            <tr>\n              <th className=\"counter\">#</th>\n              <th className=\"label\">Label</th>\n              <th>value</th>\n              <th className=\"index\">index</th>\n            </tr>\n          </thead>\n          <tbody>\n            {columnsKeys.map((key, index) => {\n              return (\n                <tr key={key}>\n                  <td className=\"counter\">{index + 1}</td>\n                  <td className=\"label\">\n                    <FormikInput\n                      key={key}\n                      name={`columns.${key}.tempKey`}\n                      value={columns[key].tempKey}\n                    />\n                  </td>\n                  <td>\n                    {columns[key].type === COLUMNS_TYPES.FORMULA ? (\n                      <FormikInput\n                        name={`columns.${key}.formula`}\n                        value={columns[key].formula}\n                      />\n                    ) : (\n                      <div className=\"input disbale\" />\n                    )}\n                  </td>\n                  <td className=\"index\">\n                    <FormikInput\n                      name={`columns.${key}.index`}\n                      value={columns[key].index}\n                    />\n                  </td>\n                  <td className=\"operation-col\">\n                    {columnsKeys.length === index + 1 && (\n                      <button\n                        className=\"add\"\n                        type=\"button\"\n                        onClick={() => addNewColumn(index + 1)}\n                      >\n                        <FaPlus />\n                      </button>\n                    )}\n                  </td>\n                </tr>\n              );\n            })}\n          </tbody>\n        </table>\n      )}\n      <MultipleAnalysisCodeEditor data={data} />\n    </FormikForm>\n  );\n}\n\nexport default forwardRef(MultipleSpectraAnalysisPreferences);\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useLayoutEffect, useRef } from 'react';\n\nimport { DropDownListProps } from './DropDownButton';\n\nconst styles = {\n  container: css`\n    background-color: white;\n    position: absolute;\n    height: auto;\n    z-index: 99999999999999;\n    box-shadow: 0 19px 38px rgba(0, 0, 0, 0.3), 0 15px 12px rgba(0, 0, 0, 0.22);\n    border-radius: 10px;\n    margin-bottom: 20px;\n    overflow: hidden;\n  `,\n  ul: css`\n    list-style-type: none;\n    padding: 0;\n    margin: 0;\n  `,\n  li: css`\n    text-align: center;\n    color: black;\n    border-bottom: 0.55px solid #f9f9f9;\n    min-width: 150px;\n    width: fit-content;\n    &:last-of-type {\n      border-bottom: none;\n    }\n\n    &:hover {\n      background-color: gray;\n      color: white;\n    }\n  `,\n  label: css`\n    padding: 5px 20px;\n    display: block;\n  `,\n};\n\nfunction DropDownList({\n  data = [],\n  onSelect,\n  renderItem = null,\n}: DropDownListProps) {\n  const ref = useRef<HTMLDivElement>(null);\n  useLayoutEffect(() => {\n    if (ref.current) {\n      const containerRect = ref.current?.getBoundingClientRect();\n      if (containerRect.right > window.innerWidth) {\n        ref.current.style.right = `${\n          containerRect.right - window.innerWidth\n        }px`;\n      }\n    }\n  }, []);\n  return (\n    <div css={styles.container} ref={ref}>\n      <ul css={styles.ul}>\n        {data.map((item, index) => (\n          <li css={styles.li} key={item.key} onClick={() => onSelect(index)}>\n            {renderItem?.(item) || <span css={styles.label}>{item.label}</span>}\n          </li>\n        ))}\n      </ul>\n    </div>\n  );\n}\n\nexport default DropDownList;\n","/** @jsxImportSource @emotion/react */\nimport { css, CSSObject } from '@emotion/react';\nimport { ReactNode, useCallback, useEffect, useRef, useState } from 'react';\nimport { FaEllipsisH } from 'react-icons/fa';\n\nimport DropDownList from './DropDownList';\n\nconst styles = {\n  container: css`\n    position: relative;\n    padding: 2px;\n    border-radius: 10px;\n    width: max-content;\n    display: inline-block;\n    border: 0.55px solid lightgray;\n    font-size: 10px;\n  `,\n  button: css`\n    width: 100%;\n  `,\n};\n\nexport interface DropDownListItem {\n  key: string;\n  label: string;\n  index?: number;\n}\n\nexport interface DropDownListProps {\n  data: Array<DropDownListItem>;\n  onSelect: (index: number) => void;\n  renderItem?: ((item: DropDownListItem) => ReactNode) | null;\n}\n\ninterface DropDownButtonProps extends Omit<DropDownListProps, 'onSelect'> {\n  selectedKey?: string;\n  onSelect?: (item: DropDownListItem) => void;\n  formatSelectedValue?: (Item: DropDownListItem) => string;\n  style?: CSSObject;\n}\n\nfunction DropDownButton(props: DropDownButtonProps) {\n  const {\n    data,\n    selectedKey,\n    onSelect,\n    formatSelectedValue = (item) => item.label,\n    renderItem = null,\n    style,\n  } = props;\n  const [open, setOpen] = useState(false);\n  const [item, setItem] = useState<DropDownListItem | null>();\n\n  const drop = useRef<HTMLDivElement>(null);\n\n  useEffect(() => {\n    if (selectedKey) {\n      const item = data.find((i) => i.key === selectedKey) || null;\n      setItem(item);\n    }\n  }, [selectedKey, data]);\n\n  useEffect(() => {\n    function handleClick() {\n      setOpen(false);\n    }\n    window.addEventListener('click', handleClick);\n    return () => window.removeEventListener('click', handleClick);\n  }, []);\n\n  const selectHandler = useCallback(\n    (index) => {\n      setItem(data[index]);\n      onSelect?.(data[index]);\n    },\n    [data, onSelect],\n  );\n\n  return (\n    <div className=\"dropdown\" ref={drop} css={[styles.container, style]}>\n      <button\n        css={styles.button}\n        type=\"button\"\n        onClick={(event) => {\n          setOpen((open) => !open);\n          event.stopPropagation();\n        }}\n      >\n        {!item ? <FaEllipsisH /> : formatSelectedValue(item)}\n      </button>\n      {open && (\n        <DropDownList\n          data={data}\n          onSelect={selectHandler}\n          renderItem={renderItem}\n        />\n      )}\n    </div>\n  );\n}\n\nexport default DropDownButton;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback } from 'react';\n\nimport {\n  COLUMNS_TYPES,\n  COLUMNS_VALUES_KEYS,\n} from '../../../data/data1d/MultipleAnalysis';\nimport { useDispatch } from '../../context/DispatchContext';\nimport DeleteButton from '../../elements/Tab/DeleteButton';\nimport DropDownButton from '../../elements/dropDownButton/DropDownButton';\nimport { DELETE_ANALYZE_SPECTRA_RANGE } from '../../reducer/types/Types';\n\nconst styles = (styles) => css`\n  position: relative;\n\n  .delete {\n    position: absolute;\n    right: 0px;\n    top: 0px;\n  }\n\n  .container {\n    display: flex;\n    flex-direction: column;\n    padding: 0;\n    margin: 0;\n  }\n\n  .dropDown-container {\n    justify-content: flex-start;\n    align-items: flex-start;\n  }\n\n  .label-container {\n    flex: 1;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    flex-direction: column;\n    min-height: 45px;\n  }\n\n  .label {\n    text-align: center;\n  }\n\n  ${styles}\n`;\n\nconst columnsFilters: Array<{ key: string; label: string }> = [\n  { key: COLUMNS_VALUES_KEYS.RELATIVE, label: 'Relative' },\n  { key: COLUMNS_VALUES_KEYS.ABSOLUTE, label: 'Absolute' },\n  { key: COLUMNS_VALUES_KEYS.MIN, label: 'Min Intensity' },\n  { key: COLUMNS_VALUES_KEYS.MAX, label: 'Max Intensity' },\n];\n\ninterface ColumnHeaderProps {\n  charLabel: string;\n  rangeLabel: string;\n  onColumnFilter: (element: any) => void;\n  data: {\n    type: string;\n    valueKey: string;\n  };\n}\n\nfunction ColumnHeader({\n  charLabel,\n  rangeLabel,\n  data,\n  onColumnFilter,\n}: ColumnHeaderProps) {\n  const dispatch = useDispatch();\n\n  const deleteHandler = useCallback(() => {\n    dispatch({ type: DELETE_ANALYZE_SPECTRA_RANGE, colKey: charLabel });\n  }, [charLabel, dispatch]);\n\n  return (\n    <div css={styles}>\n      <div className=\"container\">\n        {data.type === COLUMNS_TYPES.NORMAL && (\n          <div className=\"dropDown-container\">\n            <DropDownButton\n              data={columnsFilters}\n              formatSelectedValue={(item) => item.label.substring(0, 3)}\n              selectedKey={data.valueKey}\n              onSelect={onColumnFilter}\n            />\n          </div>\n        )}\n        <div className=\"label-container\">\n          <span className=\"label\"> {charLabel}</span>\n          <span className=\"label\">{rangeLabel}</span>\n        </div>\n      </div>\n      <DeleteButton onDelete={deleteHandler} />\n    </div>\n  );\n}\n\nexport default ColumnHeader;\n","import lodashGet from 'lodash/get';\nimport { useMemo, memo, useCallback, Fragment } from 'react';\n\nimport { useDispatch } from '../../context/DispatchContext';\nimport ReactTable from '../../elements/ReactTable/ReactTable';\nimport addCustomColumn, {\n  CustomColumn,\n} from '../../elements/ReactTable/utility/addCustomColumn';\nimport { FILTER_SPECTRA_COLUMN } from '../../reducer/types/Types';\nimport Eval from '../../utility/Evaluate';\nimport { useFormatNumberByNucleus } from '../../utility/FormatNumber';\nimport NoTableData from '../extra/placeholder/NoTableData';\n\nimport ColumnHeader from './ColumnHeader';\n\ninterface MultipleSpectraAnalysisTableProps {\n  data: any;\n  activeTab: string;\n}\n\nfunction MultipleSpectraAnalysisTable({\n  data,\n  activeTab,\n}: MultipleSpectraAnalysisTableProps) {\n  const format = useFormatNumberByNucleus(activeTab);\n\n  const codeEvaluation = useMemo(() => {\n    const code = lodashGet(data, 'code', '');\n    return Eval(code, data);\n  }, [data]);\n\n  const dispatch = useDispatch();\n\n  const columnFilterHandler = useCallback(\n    (columnKey, valueKey) => {\n      dispatch({\n        type: FILTER_SPECTRA_COLUMN,\n        payload: {\n          columnKey,\n          valueKey,\n        },\n      });\n    },\n    [dispatch],\n  );\n\n  const tableColumns = useMemo(() => {\n    const columns: CustomColumn[] = [\n      {\n        Header: '#',\n        index: 0,\n        Cell: ({ row }) => row.index + 1,\n      },\n    ];\n\n    function cellHandler(row, columnKey, valueKey) {\n      const value = row.original[columnKey][valueKey];\n      const result =\n        value instanceof Error ? (\n          <span style={{ color: 'red' }}>{value.message}</span>\n        ) : (\n          format(value)\n        );\n      return result;\n    }\n\n    function headerHandler(columnData, columnKey) {\n      return (\n        <ColumnHeader\n          charLabel={columnKey}\n          data={columnData}\n          onColumnFilter={(item) => columnFilterHandler(columnKey, item.key)}\n          rangeLabel={\n            columnData.from && columnData.to\n              ? `${format(columnData.from)} - ${format(columnData.to)}`\n              : ''\n          }\n        />\n      );\n    }\n\n    if (data.columns) {\n      Object.keys(data.columns).forEach((columnKey) => {\n        const { valueKey, index: columnIndex } = data.columns[columnKey];\n        addCustomColumn(columns, {\n          index: columnIndex + 1,\n          Cell: ({ row }) => cellHandler(row, columnKey, valueKey),\n          Header: () => headerHandler(data.columns[columnKey], columnKey),\n          id: columnKey,\n        });\n      });\n    }\n    return columns.sort((object1, object2) => object1.index - object2.index);\n  }, [columnFilterHandler, data.columns, format]);\n\n  return data.values && data.values.length > 0 ? (\n    <Fragment>\n      <ReactTable data={data.values} columns={tableColumns} />\n      <div\n        style={{\n          width: '100%',\n          padding: '10px',\n        }}\n        // eslint-disable-next-line react/no-danger\n        dangerouslySetInnerHTML={{ __html: codeEvaluation }}\n      />\n    </Fragment>\n  ) : (\n    <NoTableData />\n  );\n}\n\nexport default memo(MultipleSpectraAnalysisTable);\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { SvgNmrOverlay } from 'cheminfo-font';\nimport { useCallback, useState, useRef, memo, useMemo } from 'react';\nimport { FaFileExport } from 'react-icons/fa';\nimport { IoPulseOutline } from 'react-icons/io5';\n\nimport {\n  getDataAsString,\n  SpectraAnalysis,\n} from '../../../data/data1d/MultipleAnalysis';\nimport { useChartData } from '../../context/ChartContext';\nimport { useDispatch } from '../../context/DispatchContext';\nimport Button from '../../elements/ButtonToolTip';\nimport ToggleButton from '../../elements/ToggleButton';\nimport { positions, useAlert } from '../../elements/popup/Alert';\nimport { useModal } from '../../elements/popup/Modal';\nimport AlignSpectraModal from '../../modal/AlignSpectraModal';\nimport { RESET_SELECTED_TOOL } from '../../reducer/types/Types';\nimport Events from '../../utility/Events';\nimport { copyTextToClipboard } from '../../utility/Export';\nimport { tablePanelStyle } from '../extra/BasicPanelStyle';\nimport DefaultPanelHeader from '../header/DefaultPanelHeader';\nimport PreferencesHeader from '../header/PreferencesHeader';\n\nimport MultipleSpectraAnalysisPreferences from './MultipleSpectraAnalysisPreferences';\nimport MultipleSpectraAnalysisTable from './MultipleSpectraAnalysisTable';\n\ninterface MultipleSpectraAnalysisPanelInnerProps {\n  activeTab: string;\n  spectraAnalysis: SpectraAnalysis;\n}\n\nfunction MultipleSpectraAnalysisPanelInner({\n  activeTab,\n  spectraAnalysis,\n}: MultipleSpectraAnalysisPanelInnerProps) {\n  const [isFlipped, setFlipStatus] = useState(false);\n  const settingRef = useRef<any>();\n  const alert = useAlert();\n  const modal = useModal();\n  const dispatch = useDispatch();\n\n  const data = useMemo<any>(() => {\n    const {\n      values,\n      options: { columns, code },\n    } = spectraAnalysis[activeTab] || {\n      values: {},\n      options: { columns: {}, code: null },\n    };\n    return { values: Object.values(values), columns, code };\n  }, [activeTab, spectraAnalysis]);\n\n  const settingsPanelHandler = useCallback(() => {\n    setFlipStatus(!isFlipped);\n  }, [isFlipped]);\n\n  const saveSettingHandler = useCallback(() => {\n    settingRef.current.saveSetting();\n  }, []);\n\n  const afterSaveHandler = useCallback(() => {\n    setFlipStatus(false);\n  }, []);\n\n  const showTrackerHandler = useCallback((flag) => {\n    Events.emit('showYSpectraTrackers', flag);\n  }, []);\n  const openAlignSpectra = useCallback(() => {\n    dispatch({ type: RESET_SELECTED_TOOL });\n    modal.show(<AlignSpectraModal nucleus={activeTab} />, {\n      isBackgroundBlur: false,\n      position: positions.TOP_CENTER,\n      width: 500,\n    });\n  }, [activeTab, modal, dispatch]);\n\n  const copyToClipboardHandler = useCallback(() => {\n    void (async () => {\n      const data = getDataAsString(spectraAnalysis, activeTab);\n      const success = await copyTextToClipboard(data);\n      if (success) {\n        alert.success('Data copied to clipboard');\n      } else {\n        alert.error('copy to clipboard failed');\n      }\n    })();\n  }, [activeTab, alert, spectraAnalysis]);\n\n  return (\n    <div\n      css={[\n        tablePanelStyle,\n        isFlipped &&\n          css`\n            .table-container th {\n              position: relative;\n            }\n          `,\n      ]}\n    >\n      {!isFlipped && (\n        <DefaultPanelHeader\n          deleteToolTip=\"Delete All Peaks\"\n          showSettingButton\n          canDelete={false}\n          onSettingClick={settingsPanelHandler}\n        >\n          <Button\n            popupTitle=\"Copy To Clipboard\"\n            // style={styles.button}\n            onClick={copyToClipboardHandler}\n          >\n            <FaFileExport />\n          </Button>\n          <Button\n            popupTitle=\"Spectra calibration\"\n            // style={styles.button}\n            onClick={openAlignSpectra}\n          >\n            <SvgNmrOverlay style={{ fontSize: '18px' }} />\n          </Button>\n          <ToggleButton\n            popupTitle=\"Y Spectra Tracker\"\n            popupPlacement=\"right\"\n            onClick={showTrackerHandler}\n          >\n            <IoPulseOutline />\n          </ToggleButton>\n        </DefaultPanelHeader>\n      )}\n      {isFlipped && (\n        <PreferencesHeader\n          onSave={saveSettingHandler}\n          onClose={settingsPanelHandler}\n        />\n      )}\n      <div className=\"inner-container\">\n        {!isFlipped ? (\n          <MultipleSpectraAnalysisTable data={data} activeTab={activeTab} />\n        ) : (\n          <MultipleSpectraAnalysisPreferences\n            data={data}\n            onAfterSave={afterSaveHandler}\n            ref={settingRef}\n          />\n        )}\n      </div>\n    </div>\n  );\n}\n\nconst MemoizedMultipleSpectraAnalysisPanel = memo(\n  MultipleSpectraAnalysisPanelInner,\n);\n\nexport default function MultipleSpectraAnalysisPanel() {\n  const { activeTab, spectraAnalysis, displayerKey } = useChartData();\n\n  if (!activeTab) {\n    return <div />;\n  }\n\n  return (\n    <MemoizedMultipleSpectraAnalysisPanel\n      {...{ activeTab, spectraAnalysis, displayerKey }}\n    />\n  );\n}\n","import {\n  useEffect,\n  useCallback,\n  useImperativeHandle,\n  useRef,\n  CSSProperties,\n  memo,\n  forwardRef,\n} from 'react';\n\nimport { usePreferences } from '../../context/PreferencesContext';\nimport IsotopesViewer from '../../elements/IsotopesViewer';\nimport FormikColumnFormatField from '../../elements/formik/FormikColumnFormatField';\nimport FormikForm from '../../elements/formik/FormikForm';\nimport { useAlert } from '../../elements/popup/Alert';\nimport useNucleus from '../../hooks/useNucleus';\nimport { getValue as getValueByKeyPath } from '../../utility/LocalStorage';\nimport { peaksDefaultValues } from '../extra/preferences/defaultValues';\n\nconst styles: Record<\n  'container' | 'groupContainer' | 'row' | 'header' | 'inputLabel' | 'input',\n  CSSProperties\n> = {\n  container: {\n    padding: 10,\n    backgroundColor: '#f1f1f1',\n    height: '100%',\n    overflowY: 'auto',\n  },\n  groupContainer: {\n    padding: '5px',\n    borderRadius: '5px',\n    margin: '10px 0px',\n    backgroundColor: 'white',\n  },\n  row: {\n    display: 'flex',\n    margin: '5px 0px',\n  },\n  header: {\n    borderBottom: '1px solid #e8e8e8',\n    paddingBottom: '5px',\n    fontWeight: 'bold',\n    color: '#4a4a4a',\n  },\n  inputLabel: {\n    flex: 2,\n    fontSize: '11px',\n    fontWeight: 'bold',\n    color: '#232323',\n  },\n  input: {\n    width: '30%',\n    textAlign: 'center',\n  },\n};\n\nconst formatFields: Array<{\n  id: number;\n  label: string;\n  checkController: string;\n  formatController: string;\n}> = [\n  {\n    id: 1,\n    label: 'Peak Number :',\n    checkController: 'showPeakNumber',\n    formatController: 'peakNumberFormat',\n  },\n  {\n    id: 2,\n    label: 'Peak Index : ',\n    checkController: 'showPeakIndex',\n    formatController: 'peakIndexFormat',\n  },\n  {\n    id: 3,\n    label: 'δ (ppm) :',\n    checkController: 'showDeltaPPM',\n    formatController: 'deltaPPMFormat',\n  },\n  {\n    id: 4,\n    label: 'δ (Hz) :',\n    checkController: 'showDeltaHz',\n    formatController: 'deltaHzFormat',\n  },\n  {\n    id: 5,\n    label: 'Peak Width',\n    checkController: 'showPeakWidth',\n    formatController: 'peakWidthFormat',\n  },\n  {\n    id: 6,\n    label: 'Intensity :',\n    checkController: 'showIntensity',\n    formatController: 'intensityFormat',\n  },\n];\ninterface PeaksPreferencesInnerProps {\n  nucleus: Array<string>;\n  preferences: any;\n  innerRef: any;\n}\n\nfunction PeaksPreferencesInner({\n  nucleus,\n  preferences,\n  innerRef,\n}: PeaksPreferencesInnerProps) {\n  const alert = useAlert();\n  const formRef = useRef<any>(null);\n\n  const updateValues = useCallback(() => {\n    if (nucleus) {\n      const defaultValues = nucleus.reduce((acc, nucleusLabel) => {\n        acc[nucleusLabel] = peaksDefaultValues;\n        return acc;\n      }, {});\n      const peaksPreferences = getValueByKeyPath(\n        preferences.current,\n        `formatting.panels.peaks`,\n      );\n      formRef.current.setValues(\n        peaksPreferences ? peaksPreferences : defaultValues,\n      );\n    }\n  }, [nucleus, preferences]);\n\n  useEffect(() => {\n    updateValues();\n  }, [updateValues]);\n\n  const saveHandler = useCallback(\n    (values) => {\n      preferences.dispatch({\n        type: 'SET_PANELS_PREFERENCES',\n        payload: { key: 'peaks', value: values },\n      });\n      alert.success('Peaks preferences saved successfully');\n    },\n    [alert, preferences],\n  );\n\n  useImperativeHandle(\n    innerRef,\n    () => ({\n      saveSetting: () => {\n        formRef.current.submitForm();\n      },\n    }),\n    [],\n  );\n\n  return (\n    <div style={styles.container}>\n      <FormikForm onSubmit={saveHandler} ref={formRef}>\n        {nucleus?.map((nucleusLabel) => (\n          <div key={nucleusLabel} style={styles.groupContainer}>\n            <IsotopesViewer style={styles.header} value={nucleusLabel} />\n            {formatFields.map((field) => (\n              <FormikColumnFormatField\n                key={field.id}\n                label={field.label}\n                checkControllerName={`${nucleusLabel}.${field.checkController}`}\n                formatControllerName={`${nucleusLabel}.${field.formatController}`}\n                hideFormat={field.formatController === 'deltaPPMFormat'}\n              />\n            ))}\n          </div>\n        ))}\n      </FormikForm>\n    </div>\n  );\n}\n\nconst MemoizedPeaksPreferences = memo(PeaksPreferencesInner);\n\n// TODO: remove this hacky use of ref.\nfunction PeaksPreferences(props, ref: any) {\n  const nucleus = useNucleus();\n  const preferences = usePreferences();\n  return (\n    <MemoizedPeaksPreferences innerRef={ref} {...{ nucleus, preferences }} />\n  );\n}\n\nexport default forwardRef(PeaksPreferences);\n","import { useCallback, useMemo, memo } from 'react';\nimport { FaRegTrashAlt } from 'react-icons/fa';\n\nimport { useDispatch } from '../../context/DispatchContext';\nimport EditableColumn from '../../elements/EditableColumn';\nimport ReactTable from '../../elements/ReactTable/ReactTable';\nimport addCustomColumn, {\n  CustomColumn,\n} from '../../elements/ReactTable/utility/addCustomColumn';\nimport {\n  DELETE_PEAK_NOTATION,\n  SHIFT_SPECTRUM,\n} from '../../reducer/types/Types';\nimport formatNumber, {\n  useFormatNumberByNucleus,\n} from '../../utility/FormatNumber';\nimport { getValue } from '../../utility/LocalStorage';\nimport NoTableData from '../extra/placeholder/NoTableData';\nimport { peaksDefaultValues } from '../extra/preferences/defaultValues';\n\ninterface PeaksTableProps {\n  activeTab: string;\n  preferences: any;\n  data: any;\n  info: {\n    nucleus: string;\n  };\n}\n\nfunction PeaksTable({ activeTab, preferences, data, info }: PeaksTableProps) {\n  const dispatch = useDispatch();\n  const format = useFormatNumberByNucleus(info.nucleus);\n\n  const deletePeakHandler = useCallback(\n    (e, row) => {\n      e.preventDefault();\n      e.stopPropagation();\n      const params = row.original;\n      dispatch({\n        type: DELETE_PEAK_NOTATION,\n        data: { id: params.id, xIndex: params.xIndex },\n      });\n    },\n    [dispatch],\n  );\n\n  const peaksPreferences = useMemo(\n    () =>\n      getValue(\n        preferences.current,\n        `formatting.panels.peaks.[${activeTab}]`,\n        peaksDefaultValues,\n      ),\n    [activeTab, preferences],\n  );\n\n  const saveDeltaPPMRefsHandler = useCallback(\n    (event, row) => {\n      const shiftValue = parseFloat(event.target.value) - parseFloat(row.value);\n      dispatch({ type: SHIFT_SPECTRUM, shiftValue });\n    },\n    [dispatch],\n  );\n  const COLUMNS: (CustomColumn & { showWhen: string })[] = useMemo(\n    () => [\n      {\n        showWhen: 'showPeakNumber',\n        index: 1,\n        Header: '#',\n        Cell: ({ row }) => row.index + 1,\n        style: { width: '1%', maxWidth: '40px', minWidth: '40px' },\n      },\n      {\n        showWhen: 'showPeakIndex',\n        index: 2,\n        Header: 'index',\n        accessor: (row) =>\n          formatNumber(row.xIndex, peaksPreferences.peakIndexFormat),\n      },\n      {\n        showWhen: 'showDeltaPPM',\n        index: 3,\n        Header: 'δ (ppm)',\n        accessor: (row) => format(row.value),\n        Cell: ({ row }) => (\n          <EditableColumn\n            value={format(row.original.value)}\n            onSave={(event) => saveDeltaPPMRefsHandler(event, row.original)}\n            type=\"number\"\n          />\n        ),\n      },\n      {\n        showWhen: 'showDeltaHz',\n        index: 4,\n        Header: 'δ (Hz)',\n        accessor: (row) =>\n          formatNumber(row.valueHz, peaksPreferences.deltaHzFormat),\n      },\n      {\n        showWhen: 'showIntensity',\n        index: 5,\n        Header: 'Intensity',\n        style: { maxWidth: '80px' },\n        accessor: (row) =>\n          formatNumber(row.intensity, peaksPreferences.intensityFormat),\n      },\n      {\n        showWhen: 'showPeakWidth',\n        index: 6,\n        Header: 'Peak Width',\n        accessor: (row) =>\n          formatNumber(row.peakWidth, peaksPreferences.peakWidthFormat),\n      },\n    ],\n    [format, peaksPreferences, saveDeltaPPMRefsHandler],\n  );\n\n  const initialColumns: CustomColumn[] = useMemo(\n    () => [\n      {\n        index: 20,\n        Header: '',\n        style: {\n          width: '1%',\n          maxWidth: '24px',\n          minWidth: '24px',\n        },\n        id: 'delete-button',\n        Cell: ({ row }) => (\n          <button\n            type=\"button\"\n            className=\"delete-button\"\n            onClick={(e) => deletePeakHandler(e, row)}\n          >\n            <FaRegTrashAlt />\n          </button>\n        ),\n      },\n    ],\n    [deletePeakHandler],\n  );\n\n  const tableColumns = useMemo(() => {\n    let columns = [...initialColumns];\n    for (const col of COLUMNS) {\n      const { showWhen, ...colParams } = col;\n      if (peaksPreferences[showWhen]) {\n        addCustomColumn(columns, colParams);\n      }\n    }\n\n    return columns.sort((object1, object2) => object1.index - object2.index);\n  }, [COLUMNS, initialColumns, peaksPreferences]);\n\n  return data && data.length > 0 ? (\n    <ReactTable\n      data={data}\n      columns={tableColumns}\n      approxItemHeight={20}\n      enableVirtualScroll\n    />\n  ) : (\n    <NoTableData />\n  );\n}\n\nexport default memo(PeaksTable);\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback, useMemo, useState, useRef, memo } from 'react';\n\nimport { Datum1D, Info1D, Peaks } from '../../../data/types/data1d';\nimport { useChartData } from '../../context/ChartContext';\nimport { useDispatch } from '../../context/DispatchContext';\nimport { usePreferences } from '../../context/PreferencesContext';\nimport { useModal } from '../../elements/popup/Modal';\nimport useSpectrum from '../../hooks/useSpectrum';\nimport { DELETE_PEAK_NOTATION } from '../../reducer/types/Types';\nimport { useFormatNumberByNucleus } from '../../utility/FormatNumber';\nimport { tablePanelStyle } from '../extra/BasicPanelStyle';\nimport DefaultPanelHeader from '../header/DefaultPanelHeader';\nimport PreferencesHeader from '../header/PreferencesHeader';\n\nimport PeaksPreferences from './PeaksPreferences';\nimport PeaksTable from './PeaksTable';\n\ninterface PeaksPanelInnerProps {\n  peaks: Peaks;\n  xDomain: number[];\n  activeTab: string;\n  preferences: any;\n  info: Info1D;\n}\n\nfunction PeaksPanelInner({\n  peaks,\n  info,\n  xDomain,\n  activeTab,\n  preferences,\n}: PeaksPanelInnerProps) {\n  const [filterIsActive, setFilterIsActive] = useState(false);\n  const [isFlipped, setFlipStatus] = useState(false);\n  const format = useFormatNumberByNucleus(info.nucleus);\n\n  const dispatch = useDispatch();\n  const modal = useModal();\n\n  const settingRef = useRef<any>();\n\n  const yesHandler = useCallback(() => {\n    dispatch({ type: DELETE_PEAK_NOTATION, data: null });\n  }, [dispatch]);\n\n  const handleDeleteAll = useCallback(() => {\n    modal.showConfirmDialog({\n      message: 'All records will be deleted, Are You sure?',\n      buttons: [{ text: 'Yes', handler: yesHandler }, { text: 'No' }],\n    });\n  }, [modal, yesHandler]);\n\n  const settingsPanelHandler = useCallback(() => {\n    setFlipStatus(!isFlipped);\n  }, [isFlipped]);\n\n  const saveSettingHandler = useCallback(() => {\n    settingRef.current.saveSetting();\n    setFlipStatus(false);\n  }, []);\n\n  const handleOnFilter = useCallback(() => {\n    setFilterIsActive(!filterIsActive);\n  }, [filterIsActive]);\n\n  const filteredPeaks = useMemo(() => {\n    function isInRange(value) {\n      const factor = 100000;\n      return (\n        value * factor >= xDomain[0] * factor &&\n        value * factor <= xDomain[1] * factor\n      );\n    }\n    if (peaks?.values) {\n      const _peaks = filterIsActive\n        ? peaks.values.filter((peak) => isInRange(peak.x))\n        : peaks.values;\n\n      return _peaks\n        .map((peak) => {\n          const value = Number(format(peak.x));\n          return {\n            value: value,\n            valueHz: info?.originFrequency\n              ? Number(value) * info.originFrequency\n              : '',\n            id: peak.id,\n            intensity: peak.y,\n            peakWidth: peak.width ? peak.width : '',\n            isConstantlyHighlighted: isInRange(value),\n          };\n        })\n        .sort((prev, next) => prev.value - next.value);\n    }\n\n    return [];\n  }, [filterIsActive, format, info, peaks, xDomain]);\n\n  return (\n    <div\n      css={[\n        tablePanelStyle,\n        isFlipped &&\n          css`\n            .table-container {\n              table,\n              th {\n                position: relative !important;\n              }\n            }\n          `,\n      ]}\n    >\n      {!isFlipped && (\n        <DefaultPanelHeader\n          counter={peaks?.values?.length}\n          onDelete={handleDeleteAll}\n          deleteToolTip=\"Delete All Peaks\"\n          onFilter={handleOnFilter}\n          filterToolTip={\n            filterIsActive ? 'Show all peaks' : 'Hide peaks out of view'\n          }\n          filterIsActive={filterIsActive}\n          counterFiltered={filteredPeaks.length}\n          showSettingButton\n          onSettingClick={settingsPanelHandler}\n        />\n      )}\n      {isFlipped && (\n        <PreferencesHeader\n          onSave={saveSettingHandler}\n          onClose={settingsPanelHandler}\n        />\n      )}\n      <div className=\"inner-container\">\n        {!isFlipped ? (\n          <PeaksTable\n            data={filteredPeaks}\n            activeTab={activeTab}\n            preferences={preferences}\n            info={info}\n          />\n        ) : (\n          <PeaksPreferences ref={settingRef} />\n        )}\n      </div>\n    </div>\n  );\n}\n\nconst MemoizedPeaksPanel = memo(PeaksPanelInner);\n\nconst emptyData = { peaks: null, info: {} };\n\nexport default function PeaksPanel() {\n  const { xDomain, activeTab } = useChartData();\n  const { peaks, info } = useSpectrum(emptyData) as Datum1D;\n  const preferences = usePreferences();\n\n  return (\n    <MemoizedPeaksPanel {...{ peaks, info, xDomain, activeTab, preferences }} />\n  );\n}\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { FaCopy } from 'react-icons/fa';\n\nimport CloseButton from '../elements/CloseButton';\n\nconst styles = css`\n  overflow: auto;\n  width: 400px;\n  .innerContainer {\n    padding: 5px;\n    width: 100%;\n    height: 180px;\n    border: none;\n  }\n\n  .mainButtonsContainer {\n    padding: 5px 0px;\n    border-bottom: 0.55px solid #ebebeb;\n    display: flex;\n    justify-content: space-between;\n  }\n\n  button {\n    background-color: transparent;\n    border: none;\n    padding: 0 5px;\n  }\n\n  button:disabled {\n    opacity: 0.6;\n  }\n`;\n\ninterface CopyClipboardModalProps {\n  text: string;\n  onClose: () => void;\n  onCopyClick: (text: string) => void;\n}\n\nfunction CopyClipboardModal({\n  text,\n  onClose,\n  onCopyClick,\n}: CopyClipboardModalProps) {\n  return (\n    <div css={styles}>\n      <div className=\"mainButtonsContainer handle\">\n        <button type=\"button\" onClick={() => onCopyClick(text)}>\n          <FaCopy />\n        </button>\n\n        <CloseButton onClick={onClose} />\n      </div>\n      <div\n        className=\"innerContainer\"\n        // eslint-disable-next-line react/no-danger\n        dangerouslySetInnerHTML={{ __html: text }}\n      />\n    </div>\n  );\n}\n\nexport default CopyClipboardModal;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { SvgNmrIntegrate, SvgNmrSum } from 'cheminfo-font';\nimport lodashGet from 'lodash/get';\nimport { rangesToACS } from 'nmr-processing';\nimport { useCallback } from 'react';\nimport { FaFileExport, FaUnlink, FaSitemap, FaChartBar } from 'react-icons/fa';\nimport { ImLink } from 'react-icons/im';\n\nimport { useAssignmentData } from '../../assignment/AssignmentsContext';\nimport { useDispatch } from '../../context/DispatchContext';\nimport { usePreferences } from '../../context/PreferencesContext';\nimport Button from '../../elements/ButtonToolTip';\nimport ToggleButton from '../../elements/ToggleButton';\nimport { useAlert } from '../../elements/popup/Alert';\nimport { useModal } from '../../elements/popup/Modal';\nimport CopyClipboardModal from '../../modal/CopyClipboardModal';\nimport ChangeSumModal from '../../modal/changeSum/ChangeSumModal';\nimport {\n  CHANGE_RANGES_SUM_FLAG,\n  CHANGE_RANGE_SUM,\n  DELETE_RANGE,\n  SHOW_J_GRAPH,\n  SHOW_MULTIPLICTY_TREES,\n  SHOW_RANGES_INTEGRALS,\n} from '../../reducer/types/Types';\nimport { copyHTMLToClipboard } from '../../utility/Export';\nimport { getNumberOfDecimals } from '../../utility/FormatNumber';\nimport DefaultPanelHeader from '../header/DefaultPanelHeader';\n\nconst style = css`\n  .btn {\n    background-color: transparent;\n    border: none;\n  }\n\n  .icon svg {\n    font-size: 12px;\n  }\n\n  .preview-publication-icon svg {\n    font-size: 13px;\n  }\n\n  button {\n    margin-right: 2px;\n  }\n`;\n\nfunction RangesHeader({\n  ranges,\n  info,\n  onUnlink,\n  onFilterActivated,\n  onSettingClick,\n  isFilterActive,\n  filterCounter,\n  showMultiplicityTrees,\n  showJGraph,\n  showRangesIntegrals,\n}) {\n  const dispatch = useDispatch();\n  const modal = useModal();\n  const alert = useAlert();\n  const preferences = usePreferences();\n  const assignmentData = useAssignmentData();\n\n  const currentSum = lodashGet(ranges, 'options.sum', null);\n\n  const changeRangesSumHandler = useCallback(\n    (value) => {\n      dispatch({ type: CHANGE_RANGE_SUM, value });\n      modal.close();\n    },\n    [dispatch, modal],\n  );\n\n  const showChangeRangesSumModal = useCallback(() => {\n    modal.show(\n      <ChangeSumModal\n        onClose={() => modal.close()}\n        onSave={changeRangesSumHandler}\n        header={\n          currentSum\n            ? `Set new Ranges Sum (Current: ${Number(currentSum).toFixed(2)})`\n            : 'Set new Ranges Sum'\n        }\n        sumOptions={ranges?.options}\n      />,\n    );\n  }, [changeRangesSumHandler, currentSum, modal, ranges?.options]);\n\n  const removeAssignments = useCallback(() => {\n    onUnlink();\n  }, [onUnlink]);\n\n  const handleOnRemoveAssignments = useCallback(() => {\n    modal.showConfirmDialog({\n      message: 'All assignments will be removed. Are you sure?',\n      buttons: [{ text: 'Yes', handler: removeAssignments }, { text: 'No' }],\n    });\n  }, [removeAssignments, modal]);\n\n  const handleDeleteAll = useCallback(() => {\n    modal.showConfirmDialog({\n      message: 'All ranges will be deleted. Are You sure?',\n      buttons: [\n        {\n          text: 'Yes',\n          handler: () => {\n            dispatch({\n              type: DELETE_RANGE,\n              payload: { data: { assignmentData } },\n            });\n          },\n        },\n        { text: 'No' },\n      ],\n    });\n  }, [assignmentData, dispatch, modal]);\n\n  const handleSetShowMultiplicityTrees = useCallback(() => {\n    dispatch({ type: SHOW_MULTIPLICTY_TREES });\n  }, [dispatch]);\n\n  const handleShowIntegrals = useCallback(() => {\n    dispatch({ type: SHOW_RANGES_INTEGRALS });\n  }, [dispatch]);\n\n  const handleShowJGraph = useCallback(() => {\n    dispatch({ type: SHOW_J_GRAPH });\n  }, [dispatch]);\n\n  const saveToClipboardHandler = useCallback(\n    (value) => {\n      void (async () => {\n        const success = await copyHTMLToClipboard(value);\n        if (success) {\n          alert.success('Data copied to clipboard');\n        } else {\n          alert.error('copy to clipboard failed');\n        }\n      })();\n    },\n    [alert],\n  );\n\n  const saveAsHTMLHandler = useCallback(() => {\n    const { originFrequency: observedFrequency, nucleus } = info;\n    const format = lodashGet(\n      preferences.current,\n      `formatting.nuclei[${nucleus.toLowerCase()}]`,\n      '0.0',\n    );\n    const nbDecimalDelta = getNumberOfDecimals(format.ppm);\n    const nbDecimalJ = getNumberOfDecimals(format.hz);\n\n    const result = rangesToACS(ranges.values, {\n      nucleus, // '19f'\n      nbDecimalDelta, // 2\n      nbDecimalJ, // 1\n      observedFrequency, //400\n    });\n    modal.show(\n      <CopyClipboardModal\n        text={result}\n        onCopyClick={saveToClipboardHandler}\n        onClose={() => modal.close()}\n      />,\n      {},\n    );\n  }, [info, modal, preferences, ranges.values, saveToClipboardHandler]);\n\n  const changeSumConstantFlagHandler = useCallback(\n    (flag) => {\n      dispatch({\n        type: CHANGE_RANGES_SUM_FLAG,\n        payload: flag,\n      });\n    },\n    [dispatch],\n  );\n\n  return (\n    <div css={style}>\n      <DefaultPanelHeader\n        counter={ranges?.values?.length}\n        onDelete={handleDeleteAll}\n        deleteToolTip=\"Delete All Ranges\"\n        onFilter={onFilterActivated}\n        filterToolTip={\n          isFilterActive ? 'Show all ranges' : 'Hide ranges out of view'\n        }\n        filterIsActive={isFilterActive}\n        counterFiltered={filterCounter}\n        showSettingButton\n        onSettingClick={onSettingClick}\n      >\n        <Button\n          popupTitle=\"Preview publication string\"\n          popupPlacement=\"right\"\n          onClick={saveAsHTMLHandler}\n          className=\"btn preview-publication-icon\"\n        >\n          <FaFileExport />\n        </Button>\n        <Button\n          popupTitle={\n            currentSum\n              ? `Change Ranges Sum (${Number(currentSum).toFixed(2)})`\n              : 'Change Ranges Sum'\n          }\n          popupPlacement=\"right\"\n          onClick={showChangeRangesSumModal}\n          className=\"btn icon\"\n        >\n          <SvgNmrSum />\n        </Button>\n        <Button\n          popupTitle=\"Remove all Assignments\"\n          popupPlacement=\"right\"\n          onClick={handleOnRemoveAssignments}\n          disabled={!ranges || !ranges.values || ranges.values.length === 0}\n          className=\"btn icon\"\n        >\n          <FaUnlink />\n        </Button>\n        <ToggleButton\n          popupTitle={\n            showMultiplicityTrees\n              ? 'Hide Multiplicity Trees in Spectrum'\n              : 'Show Multiplicity Trees in Spectrum'\n          }\n          popupPlacement=\"right\"\n          onClick={handleSetShowMultiplicityTrees}\n          disabled={!ranges || !ranges.values || ranges.values.length === 0}\n        >\n          <FaSitemap style={{ pointerEvents: 'none', fontSize: '12px' }} />\n        </ToggleButton>\n        <ToggleButton\n          popupTitle={showJGraph ? 'Hide J Graph' : 'Show J Graph'}\n          popupPlacement=\"right\"\n          onClick={handleShowJGraph}\n          disabled={!ranges || !ranges.values || ranges.values.length === 0}\n        >\n          <FaChartBar style={{ pointerEvents: 'none', fontSize: '12px' }} />\n        </ToggleButton>\n        <ToggleButton\n          popupTitle={showRangesIntegrals ? 'Hide integrals' : 'Show integrals'}\n          popupPlacement=\"right\"\n          onClick={handleShowIntegrals}\n          defaultValue={showRangesIntegrals}\n          disabled={!ranges || !ranges.values || ranges.values.length === 0}\n        >\n          <SvgNmrIntegrate\n            style={{ pointerEvents: 'none', fontSize: '12px' }}\n          />\n        </ToggleButton>\n\n        <ToggleButton\n          className=\"icon\"\n          popupTitle=\"fix integral values\"\n          popupPlacement=\"right\"\n          onClick={changeSumConstantFlagHandler}\n        >\n          <ImLink />\n        </ToggleButton>\n      </DefaultPanelHeader>\n    </div>\n  );\n}\n\nexport default RangesHeader;\n","import {\n  useEffect,\n  useCallback,\n  useImperativeHandle,\n  useRef,\n  memo,\n  CSSProperties,\n  forwardRef,\n} from 'react';\n\nimport { usePreferences } from '../../context/PreferencesContext';\nimport IsotopesViewer from '../../elements/IsotopesViewer';\nimport Label from '../../elements/Label';\nimport FormikColumnFormatField from '../../elements/formik/FormikColumnFormatField';\nimport FormikForm from '../../elements/formik/FormikForm';\nimport FormikInput from '../../elements/formik/FormikInput';\nimport { useAlert } from '../../elements/popup/Alert';\nimport useNucleus from '../../hooks/useNucleus';\nimport { getValue as getValueByKeyPath } from '../../utility/LocalStorage';\nimport { getRangeDefaultValues } from '../extra/preferences/defaultValues';\n\nconst styles: Record<\n  | 'container'\n  | 'groupContainer'\n  | 'row'\n  | 'header'\n  | 'inputLabel'\n  | 'inputWrapper',\n  CSSProperties\n> = {\n  container: {\n    padding: 10,\n    backgroundColor: '#f1f1f1',\n    height: '100%',\n    overflowY: 'auto',\n  },\n  groupContainer: {\n    padding: '5px',\n    borderRadius: '5px',\n    margin: '10px 0px',\n    backgroundColor: 'white',\n  },\n  row: {\n    display: 'flex',\n    margin: '5px 0px',\n  },\n  header: {\n    borderBottom: '1px solid #e8e8e8',\n    paddingBottom: '5px',\n    fontWeight: 'bold',\n    color: '#4a4a4a',\n  },\n  inputLabel: {\n    flex: 2,\n  },\n\n  inputWrapper: {\n    width: '100px',\n    flex: '4',\n    borderRadius: '5px',\n  },\n};\n\nconst formatFields = [\n  {\n    id: 1,\n    label: 'From :',\n    checkController: 'showFrom',\n    formatController: 'fromFormat',\n  },\n  {\n    id: 2,\n    label: 'To :',\n    checkController: 'showTo',\n    formatController: 'toFormat',\n  },\n  {\n    id: 3,\n    label: 'Absolute :',\n    checkController: 'showAbsolute',\n    formatController: 'absoluteFormat',\n  },\n  {\n    id: 4,\n    label: 'Relative :',\n    checkController: 'showRelative',\n    formatController: 'relativeFormat',\n  },\n];\n\ninterface RangesPreferencesInnerProps {\n  nucleus: Array<string>;\n  preferences: any;\n  innerRef: any;\n}\n\nfunction RangesPreferencesInner({\n  nucleus,\n  preferences,\n  innerRef,\n}: RangesPreferencesInnerProps) {\n  const alert = useAlert();\n  const formRef = useRef<any>();\n\n  const updateValues = useCallback(() => {\n    if (nucleus) {\n      const defaultValues = nucleus.reduce((acc, nucleusLabel) => {\n        acc[nucleusLabel] = getRangeDefaultValues(nucleusLabel);\n        return acc;\n      }, {});\n      const rangesPreferences = getValueByKeyPath(\n        preferences.current,\n        `formatting.panels.ranges`,\n      );\n      formRef.current.setValues(\n        rangesPreferences ? rangesPreferences : defaultValues,\n      );\n    }\n  }, [nucleus, preferences]);\n\n  useEffect(() => {\n    updateValues();\n  }, [updateValues]);\n\n  const saveHandler = useCallback(\n    (values) => {\n      preferences.dispatch({\n        type: 'SET_PANELS_PREFERENCES',\n        payload: { key: 'ranges', value: values },\n      });\n      alert.success('ranges preferences saved successfully');\n    },\n    [alert, preferences],\n  );\n\n  useImperativeHandle(\n    innerRef,\n    () => ({\n      saveSetting: () => {\n        formRef.current.submitForm();\n      },\n    }),\n    [],\n  );\n\n  return (\n    <div style={styles.container}>\n      <FormikForm onSubmit={saveHandler} ref={formRef}>\n        {nucleus?.map((nucleusLabel) => (\n          <div key={nucleusLabel} style={styles.groupContainer}>\n            <IsotopesViewer style={styles.header} value={nucleusLabel} />\n            {formatFields.map((field) => (\n              <FormikColumnFormatField\n                key={field.id}\n                label={field.label}\n                checkControllerName={`${nucleusLabel}.${field.checkController}`}\n                formatControllerName={`${nucleusLabel}.${field.formatController}`}\n              />\n            ))}\n            <Label\n              title=\"J Graph tolerance (Hz) :\"\n              style={{ label: styles.inputLabel, wrapper: styles.inputWrapper }}\n            >\n              <FormikInput\n                name={`${nucleusLabel}.jGraphTolerance`}\n                type=\"number\"\n              />\n            </Label>\n          </div>\n        ))}\n      </FormikForm>\n    </div>\n  );\n}\n\nconst MemoizedRangesPreferences = memo(RangesPreferencesInner);\n\n// TODO: remove this hacky use of ref.\nfunction RangesPreferences(prop, ref: any) {\n  const nucleus = useNucleus();\n\n  const preferences = usePreferences();\n  return (\n    <MemoizedRangesPreferences\n      innerRef={ref}\n      {...{\n        preferences,\n        nucleus,\n      }}\n    />\n  );\n}\n\nexport default forwardRef(RangesPreferences);\n","import lodashGet from 'lodash/get';\nimport { useCallback, useMemo, useState } from 'react';\n\nexport enum SortType {\n  ASCENDING = 'asc',\n  DESCENDING = 'desc',\n  ORIGINAL = 'original',\n}\n\ninterface SortConfig {\n  key: string;\n  direction: SortType;\n}\n\nexport default function useTableSortBy(items, config = null) {\n  const [sortConfig, setSortConfig] = useState<SortConfig | null>(config);\n  const sortedItems = useMemo(() => {\n    const sortableItems = items.slice();\n    if (sortConfig !== null) {\n      sortableItems.sort((a, b) => {\n        if (sortConfig.direction === SortType.ASCENDING) {\n          return (\n            lodashGet(a, sortConfig.key, 0) - lodashGet(b, sortConfig.key, 0)\n          );\n        } else if (sortConfig.direction === SortType.DESCENDING) {\n          return (\n            lodashGet(b, sortConfig.key, 0) - lodashGet(a, sortConfig.key, 0)\n          );\n        }\n        return 0;\n      });\n    }\n    return sortableItems;\n  }, [items, sortConfig]);\n\n  const sortHandler = useCallback(\n    (event) => {\n      const key = event.currentTarget?.id;\n      let direction = SortType.ASCENDING;\n      if (key && sortConfig && sortConfig.key === key) {\n        switch (sortConfig.direction) {\n          case SortType.ASCENDING:\n            direction = SortType.DESCENDING;\n\n            break;\n          case SortType.DESCENDING:\n            direction = SortType.ORIGINAL;\n\n            break;\n          default:\n            direction = SortType.ASCENDING;\n\n            break;\n        }\n      }\n      setSortConfig({ key, direction });\n    },\n    [sortConfig],\n  );\n\n  const isSortedDesc = useCallback(\n    (columnName): { flag: boolean | null; content: string } => {\n      const defaultContent = { flag: null, content: ' ' };\n\n      if (!sortConfig || sortConfig.key !== columnName) {\n        return defaultContent;\n      }\n      switch (sortConfig.direction) {\n        case SortType.DESCENDING:\n          return { flag: true, content: ' ▼' };\n\n        case SortType.ASCENDING:\n          return { flag: false, content: ' ▲' };\n\n        default:\n          return defaultContent;\n      }\n    },\n    [sortConfig],\n  );\n\n  return { items: sortedItems, isSortedDesc, onSort: { onClick: sortHandler } };\n}\n","import lodashGet from 'lodash/get';\n\nimport FormatNumber from '../../../utility/FormatNumber';\n\nexport default class ColumnsHelper {\n  private preferences: any;\n  private defaultPreference: any;\n\n  public constructor(preferences, defaultPreference) {\n    this.preferences = preferences;\n    this.defaultPreference = defaultPreference;\n  }\n\n  public checkPreferences(preferencesToCheck, key) {\n    const val =\n      preferencesToCheck === undefined ||\n      Object.keys(preferencesToCheck).length === 0 ||\n      (preferencesToCheck && preferencesToCheck[key] === true)\n        ? true\n        : false;\n\n    return val;\n  }\n\n  public setCustomColumn(array, index, columnLabel, cellHandler) {\n    array.push({\n      orderIndex: index,\n      Header: columnLabel,\n      sortType: 'basic',\n      Cell: ({ row }) => cellHandler(row),\n    });\n  }\n\n  public addColumn(\n    columns: string,\n    flagKey: string,\n    formatKey: string,\n    columnKey: string,\n    columnLabel: string,\n    columnIndex: string,\n    options: {\n      formatPrefix?: string;\n      formatSuffix?: string;\n      showPrefixSuffixCallback?: (element: any) => boolean;\n    } = {},\n  ) {\n    const preferences = this.preferences || this.defaultPreference;\n\n    if (this.checkPreferences(preferences, flagKey)) {\n      this.setCustomColumn(columns, columnIndex, columnLabel, (row) => {\n        const format =\n          preferences &&\n          Object.prototype.hasOwnProperty.call(preferences, formatKey)\n            ? preferences[formatKey]\n            : this.defaultPreference[formatKey];\n\n        const {\n          formatPrefix = '',\n          formatSuffix = '',\n          showPrefixSuffixCallback = () => true,\n        } = options;\n\n        if (showPrefixSuffixCallback(row)) {\n          return FormatNumber(\n            row.original[columnKey],\n            format,\n            formatPrefix,\n            formatSuffix,\n          );\n        } else {\n          return FormatNumber(row.original[columnKey], format, '', '');\n        }\n      });\n    }\n  }\n}\n\nexport function isColumnVisible(preferences, key) {\n  return lodashGet(preferences, key, false);\n}\n","import { CSSProperties } from 'react';\n\nimport FormatNumber from '../../../utility/FormatNumber';\n\ninterface AbsoluteColumnProps {\n  value: any;\n  onHoverRange: {\n    onMouseEnter: () => void;\n    onMouseLeave: () => void;\n  };\n  rowSpanTags: {\n    rowSpan: any;\n    style: CSSProperties;\n  };\n  format: string;\n}\n\nfunction AbsoluteColumn({\n  rowSpanTags,\n  value,\n  onHoverRange,\n  format,\n}: AbsoluteColumnProps) {\n  return (\n    <td {...rowSpanTags} {...onHoverRange}>\n      {FormatNumber(value, format)}\n    </td>\n  );\n}\n\nexport default AbsoluteColumn;\n","import { useFormikContext } from 'formik';\nimport { useEffect } from 'react';\n\ninterface FormikOnChangeProps {\n  onChange?: (any) => void;\n  enableValidation?: boolean;\n}\n\nconst FormikOnChange = (props: FormikOnChangeProps) => {\n  const { onChange = () => null, enableValidation = true } = props;\n  const { values, errors } = useFormikContext();\n\n  useEffect(() => {\n    if (enableValidation) {\n      if (Object.keys(errors).length === 0) {\n        onChange(values);\n      }\n    } else {\n      onChange(values);\n    }\n  }, [values, enableValidation, errors, onChange]);\n\n  return null;\n};\n\nexport default FormikOnChange;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useFormikContext } from 'formik';\nimport { forwardRef, useCallback, useMemo } from 'react';\nimport { FaPlus } from 'react-icons/fa';\nimport * as Yup from 'yup';\n\nimport { useChartData } from '../../../../context/ChartContext';\nimport Button from '../../../../elements/Button';\nimport FormikForm from '../../../../elements/formik/FormikForm';\nimport FormikInput from '../../../../elements/formik/FormikInput';\nimport { translateMultiplet } from '../../../../panels/extra/utilities/MultiplicityUtilities';\nimport { useFormatNumberByNucleus } from '../../../../utility/FormatNumber';\n\nconst styles = {\n  container: css`\n    text-align: center;\n    width: 100%;\n    height: 100%;\n    padding: 0.4rem;\n  `,\n  inputInfo: css`\n    font-size: 10px;\n    color: black;\n    font-weight: bold;\n  `,\n  infoText: css`\n    padding: 10px;\n    font-size: 13px;\n  `,\n\n  signalContainer: css`\n    border: 0.55px solid #dedede;\n  `,\n  inputContainer: css`\n    display: flex;\n    justify-content: center;\n  `,\n  addSignalBtn: css`\n    margin-top: 15px;\n    margin-top: 20px;\n    width: 100%;\n    background-color: #fcfcfc;\n    border-top: 0.55px solid #dedede;\n    align-items: center;\n    justify-content: center;\n    display: flex;\n    padding: 0.4rem;\n    font-size: 12px;\n\n    & :disabled {\n      opacity: 0.6;\n    }\n  `,\n};\n\ninterface AddSignalFormTabProps {\n  onFocus: (element: any) => void;\n  onBlur?: () => void;\n  range: any;\n}\n\n// TODO: this seems to be a hacky use of ref.\nfunction AddSignalFormTab(\n  { onFocus, onBlur, range }: AddSignalFormTabProps,\n  ref: any,\n) {\n  const { values, setFieldValue } = useFormikContext<any>();\n  const { activeTab } = useChartData();\n  const format = useFormatNumberByNucleus(activeTab);\n\n  const saveHandler = useCallback(\n    (val) => {\n      const newSignal = {\n        multiplicity: 'm',\n        kind: 'signal',\n        delta: Number(val.newSignalDelta),\n        js: [{ multiplicity: translateMultiplet('m'), coupling: '' }],\n      };\n      const _signals = values.signals.slice().concat(newSignal);\n\n      setFieldValue('signals', _signals);\n      setFieldValue('activeTab', String(_signals.length - 1));\n    },\n    [setFieldValue, values.signals],\n  );\n\n  const validation = useMemo(() => {\n    return Yup.object().shape({\n      newSignalDelta: Yup.number()\n        .test(`test-range`, '', function testNewSignalDelta(value) {\n          const { path, createError } = this;\n          if (value && value > range.from && value < range.to) {\n            return true;\n          }\n\n          const errorMessage = ` ${\n            value ? value.toFixed(5) : 0\n          } ppm out of the range`;\n          return createError({ path, message: errorMessage });\n        })\n        .required(),\n    });\n  }, [range]);\n\n  const triggerSubmitHandler = useCallback(() => {\n    ref.current.submitForm();\n  }, [ref]);\n\n  return (\n    <div css={styles.container}>\n      <div>\n        <p css={styles.infoText}>\n          Edit or select a delta value of new signal (ppm):\n        </p>\n        <FormikForm\n          ref={ref}\n          validationSchema={validation}\n          initialValues={{\n            newSignalDelta: (range.from + range.to) / 2,\n          }}\n          onSubmit={saveHandler}\n        >\n          <div css={styles.inputContainer}>\n            <FormikInput\n              name=\"newSignalDelta\"\n              type=\"number\"\n              placeholder={`𝛅 (ppm)`}\n              onFocus={onFocus}\n              onBlur={onBlur}\n              style={{\n                input: {\n                  width: '250px',\n                  height: '30px',\n                },\n              }}\n              checkErrorAfterInputTouched={false}\n            />\n          </div>\n          <p css={styles.inputInfo}>\n            [ {`${format(range.from)} ppm - ${format(range.to)} ppm`} ]\n          </p>\n\n          <Button css={styles.addSignalBtn} onClick={triggerSubmitHandler}>\n            <FaPlus title=\"Add new signal\" />\n          </Button>\n        </FormikForm>\n      </div>\n    </div>\n  );\n}\n\nexport default forwardRef(AddSignalFormTab);\n","import { CSSProperties } from 'react';\n\nimport FormikInput from '../../../../elements/formik/FormikInput';\nimport { translateMultiplet } from '../../../../panels/extra/utilities/MultiplicityUtilities';\n\nconst style: Record<'input', CSSProperties> = {\n  input: {\n    width: '50px',\n    height: '26px',\n    borderWidth: 0,\n    margin: '0 5px',\n  },\n};\n\ninterface DeltaInputProps {\n  signal: any;\n  index: number;\n  onFocus: (element: any) => void;\n}\n\nfunction DeltaInput({ signal, index, onFocus }: DeltaInputProps) {\n  return (\n    <div style={{ display: 'flex', alignItems: 'center' }}>\n      <span>𝛅: </span>\n      <FormikInput\n        name={`signals.${index}.delta`}\n        type=\"number\"\n        placeholder={'J (Hz)'}\n        onFocus={onFocus}\n        style={style}\n        checkErrorAfterInputTouched={false}\n      />\n      <span>\n        {signal.js\n          .map((_coupling) => translateMultiplet(_coupling.multiplicity))\n          .join('')}\n      </span>\n    </div>\n  );\n}\n\nexport default DeltaInput;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useFormikContext } from 'formik';\nimport lodashGet from 'lodash/get';\nimport { memo, useMemo, useCallback } from 'react';\nimport { FaPlus, FaRegTrashAlt } from 'react-icons/fa';\n\nimport { Multiplets } from '../../../../../data/constants/Multiplets';\nimport Button from '../../../../elements/Button';\nimport FormikInput from '../../../../elements/formik/FormikInput';\nimport FormikSelect from '../../../../elements/formik/FormikSelect';\nimport {\n  hasCouplingConstant,\n  translateMultiplet,\n} from '../../../../panels/extra/utilities/MultiplicityUtilities';\n\nconst CouplingsTableStyle = css`\n  border-spacing: 0;\n  border: 1px solid #dedede;\n  width: 100%;\n  height: 100%;\n  font-size: 12px;\n\n  th,\n  td {\n    text-align: center;\n    margin: 0;\n    padding: 0.3rem;\n    border-bottom: 1px solid #f5f5f5;\n\n    button {\n      background-color: transparent;\n      border: none;\n    }\n\n    .add-button {\n      color: blue;\n      width: 100%;\n      height: 100%;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n    }\n\n    .delete-button {\n      border-radius: 25%;\n      padding: 0;\n      padding-left: 0.3rem;\n      padding-right: 0.3rem;\n    }\n    .delete-button:hover {\n      .icon {\n        color: red;\n      }\n    }\n\n    input {\n      background-color: transparent;\n      border: 0.5px solid #dedede;\n      height: 100%;\n      width: 100%;\n      text-align: center;\n    }\n    .selectBox {\n      background-color: transparent;\n      border: 0.5px solid #dedede;\n      height: 100%;\n      width: 100% !important;\n      text-align: center;\n      margin: 0;\n    }\n  }\n\n  tr {\n    :last-child {\n      background-color: #fcfcfc;\n    }\n  }\n`;\n\ninterface CouplingsTableProps {\n  push: (element: { multiplicity?: string; coupling: string }) => void;\n  remove: (element: number) => void;\n  onFocus: (element: any) => void;\n  onBlur?: () => void;\n}\n\nfunction CouplingsTable({\n  push,\n  remove,\n  onFocus,\n  onBlur,\n}: CouplingsTableProps) {\n  const { values, setFieldValue } = useFormikContext<any>();\n\n  const multiplicityChangeHandler = useCallback(\n    (value, name) => {\n      if (!hasCouplingConstant(value)) {\n        setFieldValue(name, '');\n      }\n    },\n    [setFieldValue],\n  );\n\n  const multipletsList = useMemo(() => {\n    return Multiplets.map((multiplet) => ({\n      key: multiplet.value,\n      ...multiplet,\n      value: multiplet.label,\n    }));\n  }, []);\n\n  return (\n    <table css={CouplingsTableStyle}>\n      <tbody>\n        <tr>\n          <th>#</th>\n          <th>Multiplicity</th>\n          <th>J (Hz)</th>\n          <th>{''}</th>\n        </tr>\n        {lodashGet(values, `signals[${values.activeTab}].js`, []).map(\n          (_coupling, i) => (\n            <tr\n              // eslint-disable-next-line react/no-array-index-key\n              key={`editCouplings${values.activeTab}${i}`}\n            >\n              <td>{i + 1}</td>\n              <td>\n                <FormikSelect\n                  className=\"selectBox\"\n                  name={`signals.${values.activeTab}.js.${i}.multiplicity`}\n                  data={multipletsList}\n                  onChange={(value) =>\n                    multiplicityChangeHandler(\n                      value,\n                      `signals.${values.activeTab}.js.${i}.coupling`,\n                    )\n                  }\n                />\n              </td>\n              <td>\n                <FormikInput\n                  name={`signals.${values.activeTab}.js.${i}.coupling`}\n                  type=\"number\"\n                  placeholder={'J (Hz)'}\n                  disabled={!hasCouplingConstant(_coupling.multiplicity)}\n                  onFocus={onFocus}\n                  onBlur={onBlur}\n                  style={{\n                    input: {\n                      width: '100%',\n                      height: '26px',\n                    },\n                  }}\n                  checkErrorAfterInputTouched={false}\n                />\n              </td>\n              <td>\n                <Button\n                  className=\"delete-button\"\n                  onClick={() => {\n                    remove(i);\n                  }}\n                >\n                  <FaRegTrashAlt className=\"icon\" title=\"Delete coupling\" />\n                </Button>\n              </td>\n            </tr>\n          ),\n        )}\n        <tr />\n        <tr>\n          <td colSpan={4}>\n            <Button\n              className=\"add-button\"\n              onClick={() =>\n                push({\n                  multiplicity: translateMultiplet('m'),\n                  coupling: '',\n                })\n              }\n            >\n              <FaPlus title=\"Add new coupling\" />\n            </Button>\n          </td>\n        </tr>\n      </tbody>\n    </table>\n  );\n}\n\nexport default memo(CouplingsTable);\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useFormikContext, FieldArray } from 'formik';\nimport { memo } from 'react';\n\nimport CouplingsTable from './CouplingsTable';\n\nconst SignalFormTabStyle = css`\n  border-spacing: 0;\n  width: 100%;\n  font-size: 12px;\n  height: 100%;\n\n  margin: 0;\n  padding: 0.4rem;\n  text-align: center;\n`;\n\ninterface SignalFormTabProps {\n  onFocus: (element: any) => void;\n  onBlur?: () => void;\n}\n\nfunction SignalFormTab({ onFocus, onBlur }: SignalFormTabProps) {\n  const { values } = useFormikContext<{ activeTab: string }>();\n\n  return (\n    <div css={SignalFormTabStyle}>\n      <FieldArray\n        name={`signals.${values.activeTab}.js`}\n        render={({ push, remove }) => (\n          <div>\n            <CouplingsTable\n              push={push}\n              remove={remove}\n              onFocus={onFocus}\n              onBlur={onBlur}\n            />\n          </div>\n        )}\n      />\n    </div>\n  );\n}\n\nexport default memo(SignalFormTab);\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useFormikContext } from 'formik';\nimport { useCallback, useMemo, memo, useEffect, useState, useRef } from 'react';\n\nimport { useChartData } from '../../../../context/ChartContext';\nimport Tab from '../../../../elements/Tab/Tab';\nimport Tabs from '../../../../elements/Tab/Tabs';\nimport useSpectrum from '../../../../hooks/useSpectrum';\nimport Events from '../../../../utility/Events';\nimport { useFormatNumberByNucleus } from '../../../../utility/FormatNumber';\n\nimport AddSignalFormTab from './AddSignalFormTab';\nimport DeltaInput from './DeltaInput';\nimport SignalFormTab from './SignalFormTab';\n\nconst textStyles = css`\n  text-align: center;\n  width: 100%;\n\n  .errorText {\n    color: red;\n  }\n\n  .infoText {\n    padding: 10px;\n    margin: 10px 0;\n    font-size: 14px;\n    text-align: left;\n    color: white;\n    background-color: #5f5f5f;\n    border-radius: 5px;\n  }\n`;\n\nconst tabStylesAddition = css`\n  color: red;\n`;\nconst tabStyles = css`\n  display: inline-grid;\n  list-style: none;\n  padding: 0.5rem 1.5rem;\n`;\n\ninterface SignalsFormProps {\n  range: number;\n}\n\nfunction SignalsForm({ range }: SignalsFormProps) {\n  const newSignalFormRef = useRef<any>();\n  const [activeField, setActiveField] = useState<string | null>(null);\n\n  const {\n    values,\n    setFieldValue,\n    errors,\n  }: {\n    values: any;\n    setFieldValue: (\n      field: string,\n      value: any,\n      shouldValidate?: boolean | undefined,\n    ) => void;\n    errors: any;\n  } = useFormikContext<any>();\n\n  const { activeTab } = useChartData();\n  const { info }: { info: any } = useSpectrum({ info: {} });\n  const format = useFormatNumberByNucleus(activeTab);\n\n  useEffect(() => {\n    function handle(event) {\n      if (info?.originFrequency && activeField) {\n        if (values.activeTab === 'addSignalTab') {\n          newSignalFormRef.current.setValues({\n            [activeField]:\n              (event.range[1] - event.range[0]) / 2 + event.range[0],\n          });\n        } else if (activeField.includes('delta')) {\n          setFieldValue(\n            activeField,\n            (event.range[1] - event.range[0]) / 2 + event.range[0],\n          );\n        } else {\n          const value = Number(\n            format(\n              Math.abs(event.range[0] - event.range[1]) * info.originFrequency,\n            ),\n          );\n          setFieldValue(activeField, value);\n        }\n      }\n\n      setActiveField(null);\n    }\n\n    Events.on('brushEnd', handle);\n\n    return () => {\n      Events.off('brushEnd', handle);\n    };\n  }, [activeField, setFieldValue, values.activeTab, format, info]);\n\n  useEffect(() => {\n    function handle(event) {\n      if (activeField) {\n        if (values.activeTab === 'addSignalTab') {\n          newSignalFormRef.current.setValues({ [activeField]: event.xPPM });\n        } else if (activeField.includes('delta')) {\n          setFieldValue(activeField, event.xPPM);\n        }\n      }\n      setActiveField(null);\n    }\n\n    Events.on('mouseClick', handle);\n\n    return () => {\n      Events.off('mouseClick', handle);\n    };\n  }, [values.activeTab, activeField, setFieldValue]);\n\n  const handleOnFocus = useCallback(\n    (event) => {\n      setActiveField(event.target.name);\n    },\n    [setActiveField],\n  );\n\n  const tapClickHandler = useCallback(\n    ({ tabid }) => {\n      setFieldValue('activeTab', tabid);\n    },\n    [setFieldValue],\n  );\n\n  const handleDeleteSignal = useCallback(\n    ({ tabid }) => {\n      const _signals = values.signals.filter(\n        (_signal, i) => i !== Number(tabid),\n      );\n      setFieldValue('signals', _signals);\n    },\n    [setFieldValue, values.signals],\n  );\n\n  useEffect(() => {\n    setFieldValue(\n      'activeTab',\n      values.signals.length > 0\n        ? (values.signals.length - 1).toString()\n        : 'addSignalTab',\n    );\n  }, [setFieldValue, values.signals.length]);\n\n  const tabContainsErrors = useCallback(\n    (i) => {\n      return errors?.signals && errors?.signals[i] ? true : false;\n    },\n    [errors],\n  );\n\n  const signalFormTabs = useMemo(() => {\n    const signalTabs =\n      values.signals.length > 0\n        ? values.signals.map((signal, i) => (\n            <Tab\n              // eslint-disable-next-line react/no-array-index-key\n              key={`signalForm${i}`}\n              tabid={`${i}`}\n              tabstyles={tabContainsErrors(i) ? tabStylesAddition : tabStyles}\n              canDelete\n              render={() => (\n                <DeltaInput signal={signal} index={i} onFocus={handleOnFocus} />\n              )}\n            >\n              <SignalFormTab onFocus={handleOnFocus} />\n            </Tab>\n          ))\n        : [];\n\n    const addSignalTab = (\n      <Tab\n        tablabel=\"+\"\n        tabid=\"addSignalTab\"\n        canDelete={false}\n        key=\"addSignalTab\"\n        className=\"add-signal-tab\"\n      >\n        <AddSignalFormTab\n          onFocus={handleOnFocus}\n          range={range}\n          ref={newSignalFormRef}\n        />\n      </Tab>\n    );\n\n    return signalTabs.concat(addSignalTab);\n  }, [handleOnFocus, range, tabContainsErrors, values.signals]);\n\n  const editSignalInfoText = (\n    <p className=\"infoText\">\n      Focus on an input field and press Shift + Drag &#38; Drop to draw a\n      coupling constant in spectrum view.\n    </p>\n  );\n\n  const addSignalInfoText = (\n    <p className=\"infoText\">\n      Focus on the input field and press Shift + Left mouse click to select new\n      signal delta value in spectrum view.\n    </p>\n  );\n\n  return (\n    <div>\n      <div css={textStyles}>\n        {errors.signals &&\n        (errors.signals.noSignals || errors.signals.noCouplings) ? (\n          <div>\n            <p className=\"errorText\">\n              {errors.signals.noSignals ||\n                errors.signals.noCouplings[0].message}\n            </p>\n            {errors.signals.noSignals ? addSignalInfoText : null}\n          </div>\n        ) : values.activeTab === 'addSignalTab' ? (\n          addSignalInfoText\n        ) : (\n          editSignalInfoText\n        )}\n      </div>\n      <Tabs\n        activeTab={values.activeTab}\n        onClick={tapClickHandler}\n        onDelete={handleDeleteSignal}\n      >\n        {signalFormTabs}\n      </Tabs>\n    </div>\n  );\n}\n\nexport default memo(SignalsForm);\n","import { useMemo } from 'react';\nimport * as Yup from 'yup';\n\nimport { hasCouplingConstant } from '../../../../panels/extra/utilities/MultiplicityUtilities';\n\nconst useValidation = () =>\n  useMemo(() => {\n    return Yup.object().shape({\n      signals: Yup.array()\n        .of(\n          Yup.object().shape({\n            j: Yup.array()\n              .of(\n                Yup.object().shape({\n                  multiplicity: Yup.string().required(),\n                  coupling: Yup.mixed().test(\n                    'checkValue',\n                    '',\n                    function testCoupling(value) {\n                      const { path, createError } = this;\n                      const hasCoupling = hasCouplingConstant(\n                        this.parent.multiplicity,\n                      );\n                      if (\n                        (!hasCoupling && isNaN(value)) ||\n                        (hasCoupling && !isNaN(value))\n                      ) {\n                        return true;\n                      }\n\n                      return createError({\n                        path,\n                        message: `${path} is required`,\n                      });\n                    },\n                  ),\n                }),\n              )\n              .min(1, 'There must be at least one coupling in a signal'),\n          }),\n        )\n        .min(1, 'There must be at least one signal in a range!'),\n    });\n  }, []);\n\nexport default useValidation;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useMemo, useCallback, useEffect, useRef } from 'react';\nimport { FaSearchPlus } from 'react-icons/fa';\n\nimport generateID from '../../../data/utilities/generateID';\nimport { useChartData } from '../../context/ChartContext';\nimport { useDispatch } from '../../context/DispatchContext';\nimport Button from '../../elements/Button';\nimport CloseButton from '../../elements/CloseButton';\nimport SaveButton from '../../elements/SaveButton';\nimport FormikForm from '../../elements/formik/FormikForm';\nimport FormikOnChange from '../../elements/formik/FormikOnChange';\nimport {\n  hasCouplingConstant,\n  translateMultiplet,\n} from '../../panels/extra/utilities/MultiplicityUtilities';\nimport { CHANGE_TEMP_RANGE } from '../../reducer/types/Types';\nimport { useFormatNumberByNucleus } from '../../utility/FormatNumber';\n\nimport SignalsForm from './forms/components/SignalsForm';\nimport useRangeFormValidation from './forms/validation/EditRangeValidation';\n\nconst styles = css`\n  width: 600px;\n  height: 500px;\n  padding: 5px;\n  button:focus {\n    outline: none;\n  }\n  .header {\n    height: 24px;\n    border-bottom: 1px solid #f0f0f0;\n    display: flex;\n    align-items: center;\n    span {\n      color: #464646;\n      font-size: 15px;\n      flex: 1;\n      border-left: 1px solid #ececec;\n      padding-left: 6px;\n    }\n\n    button {\n      background-color: transparent;\n      border: none;\n      padding: 5px;\n\n      svg {\n        height: 16px;\n      }\n    }\n  }\n  .container {\n    display: flex;\n    margin: 30px 5px;\n    input,\n    button {\n      padding: 5px;\n      border: 1px solid gray;\n      border-radius: 5px;\n      height: 36px;\n      margin: 2px;\n    }\n    input {\n      flex: 10;\n    }\n    button {\n      flex: 2;\n      color: white;\n      background-color: gray;\n    }\n  }\n`;\n\ninterface EditRangeModalProps {\n  onSaveEditRangeModal: (value: any) => Promise<void> | null | void;\n  onCloseEditRangeModal: () => void;\n  onZoomEditRangeModal: (value: any) => void;\n  range: any;\n  automaticZoom?: boolean;\n}\n\ninterface Coupling {\n  multiplicity: any;\n  coupling: string | number;\n}\n\nfunction EditRangeModal({\n  onSaveEditRangeModal = () => null,\n  onCloseEditRangeModal = () => null,\n  onZoomEditRangeModal = () => null,\n  range,\n  automaticZoom = true,\n}: EditRangeModalProps) {\n  const formRef = useRef<any>(null);\n  const { activeTab } = useChartData();\n  const dispatch = useDispatch();\n  const format = useFormatNumberByNucleus(activeTab);\n  const validation = useRangeFormValidation();\n\n  const handleOnZoom = useCallback(() => {\n    onZoomEditRangeModal(range);\n  }, [onZoomEditRangeModal, range]);\n\n  useEffect(() => {\n    if (automaticZoom) {\n      handleOnZoom();\n    }\n  }, [automaticZoom, handleOnZoom]);\n\n  const handleOnClose = useCallback(() => {\n    onCloseEditRangeModal();\n  }, [onCloseEditRangeModal]);\n\n  const getCouplings = useCallback(\n    (couplings) =>\n      couplings\n        .filter((coupling) => coupling.coupling !== '')\n        .map((coupling) => {\n          return {\n            ...coupling,\n            multiplicity: translateMultiplet(coupling.multiplicity),\n          };\n        }),\n    [],\n  );\n\n  const getSignals = useCallback(\n    (signals) => {\n      return signals.map((signal) => {\n        return {\n          id: generateID(),\n          ...signal,\n          multiplicity: signal.js\n            .map((_coupling) => translateMultiplet(_coupling.multiplicity))\n            .join(''),\n          js: getCouplings(signal.js),\n        };\n      });\n    },\n    [getCouplings],\n  );\n\n  const handleOnSave = useCallback(\n    (formValues) => {\n      void (async () => {\n        const _range = { ...range };\n        _range.signals = getSignals(formValues.signals);\n        await onSaveEditRangeModal(_range);\n        handleOnClose();\n      })();\n    },\n    [getSignals, handleOnClose, onSaveEditRangeModal, range],\n  );\n\n  const data = useMemo(() => {\n    const signals = range.signals.map((signal) => {\n      // counter within j array to access to right j values\n\n      let counterJ = 0;\n      const couplings: Array<Coupling> = [];\n      signal.multiplicity.split('').forEach((_multiplicity) => {\n        let coupling: Coupling = {\n          multiplicity: _multiplicity,\n          coupling: '',\n        };\n\n        if (hasCouplingConstant(_multiplicity)) {\n          coupling = { ...signal.js[counterJ] };\n          coupling.coupling = Number(format(coupling.coupling));\n          counterJ++;\n        }\n        coupling.multiplicity = translateMultiplet(coupling.multiplicity);\n        couplings.push(coupling);\n      });\n\n      return { ...signal, js: couplings };\n    });\n    return { activeTab: '0', signals };\n  }, [format, range]);\n\n  const changeHandler = useCallback(\n    (values) => {\n      const signals = getSignals(values.signals);\n      dispatch({\n        type: CHANGE_TEMP_RANGE,\n        payload: { tempRange: Object.assign({}, range, { signals }) },\n      });\n    },\n    [dispatch, getSignals, range],\n  );\n\n  return (\n    <div css={styles}>\n      <FormikForm\n        ref={formRef}\n        initialValues={data}\n        validationSchema={validation}\n        onSubmit={handleOnSave}\n      >\n        <div className=\"header handle\">\n          <Button onClick={handleOnZoom} className=\"zoom-button\">\n            <FaSearchPlus title=\"Set to default view on range in spectrum\" />\n          </Button>\n          <span>\n            {` Range and Signal edition: ${format(range.from)} ppm to ${format(\n              range.to,\n            )} ppm`}\n          </span>\n          <SaveButton\n            onClick={() => formRef.current.submitForm()}\n            popupTitle=\"Save and exit\"\n          />\n\n          <CloseButton onClick={handleOnClose} />\n        </div>\n        <SignalsForm range={range} />\n        <FormikOnChange onChange={changeHandler} />\n      </FormikForm>\n    </div>\n  );\n}\n\nexport default EditRangeModal;\n","import { useCallback, useMemo } from 'react';\n\nimport { useAssignmentData } from '../../../assignment/AssignmentsContext';\nimport { useDispatch } from '../../../context/DispatchContext';\nimport { useModal } from '../../../elements/popup/Modal';\nimport { positions, transitions } from '../../../elements/popup/options';\nimport EditRangeModal from '../../../modal/editRange/EditRangeModal';\nimport {\n  CHANGE_RANGE_SIGNAL_KIND,\n  DELETE_RANGE,\n  RESET_SELECTED_TOOL,\n  SAVE_EDITED_RANGE,\n  SET_SELECTED_TOOL,\n  SET_X_DOMAIN,\n} from '../../../reducer/types/Types';\nimport { options } from '../../../toolbar/ToolTypes';\n\nimport { RangeData } from './useMapRanges';\n\nexport default function useEditRangeModal(range: RangeData) {\n  const dispatch = useDispatch();\n  const modal = useModal();\n  const assignmentData = useAssignmentData();\n\n  const zoomRange = useCallback(() => {\n    const margin = Math.abs(range.from - range.to);\n    dispatch({\n      type: SET_X_DOMAIN,\n      xDomain: [range.from - margin, range.to + margin],\n    });\n  }, [dispatch, range.from, range.to]);\n\n  const deleteRange = useCallback(() => {\n    dispatch({\n      type: DELETE_RANGE,\n      payload: {\n        data: { id: range.id, assignmentData },\n      },\n    });\n  }, [assignmentData, dispatch, range.id]);\n\n  const changeRangeSignalKind = useCallback(\n    (value) => {\n      dispatch({\n        type: CHANGE_RANGE_SIGNAL_KIND,\n        payload: {\n          data: { rowData: range, value },\n        },\n      });\n    },\n    [dispatch, range],\n  );\n\n  const saveEditRangeHandler = useCallback(\n    (editedRowData) => {\n      dispatch({\n        type: SAVE_EDITED_RANGE,\n        payload: {\n          editedRowData,\n          assignmentData,\n        },\n      });\n    },\n    [assignmentData, dispatch],\n  );\n\n  const closeEditRangeHandler = useCallback(() => {\n    dispatch({ type: RESET_SELECTED_TOOL });\n    modal.close();\n  }, [dispatch, modal]);\n\n  const editRange = useCallback(() => {\n    dispatch({\n      type: SET_SELECTED_TOOL,\n      payload: { selectedTool: options.editRange.id, tempRange: range },\n    });\n    modal.show(\n      <EditRangeModal\n        onCloseEditRangeModal={closeEditRangeHandler}\n        onSaveEditRangeModal={saveEditRangeHandler}\n        onZoomEditRangeModal={zoomRange}\n        range={range}\n      />,\n      {\n        position: positions.MIDDLE_RIGHT,\n        transition: transitions.SCALE,\n        isBackgroundBlur: false,\n      },\n    );\n  }, [\n    closeEditRangeHandler,\n    dispatch,\n    modal,\n    range,\n    saveEditRangeHandler,\n    zoomRange,\n  ]);\n\n  return useMemo(\n    () => ({\n      editRange,\n      deleteRange,\n      zoomRange,\n      changeRangeSignalKind,\n    }),\n    [changeRangeSignalKind, deleteRange, editRange, zoomRange],\n  );\n}\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { Fragment, CSSProperties } from 'react';\nimport { FaRegTrashAlt, FaSearchPlus, FaEdit } from 'react-icons/fa';\n\nimport { SignalKinds } from '../../../../data/constants/SignalsKinds';\nimport Select from '../../../elements/Select';\nimport useEditRangeModal from '../hooks/useEditRangeModal';\nimport { RangeData } from '../hooks/useMapRanges';\n\nconst styles = css`\n  width: 66px;\n  padding: 0 !important;\n  button {import useEditRangeModal from './../../../hooks/useEditRangeModal';\n\n    background-color: transparent;\n    border: none;\n    padding: 5px;\n  }\n\n  button:disabled {\n    opacity: 0.6;\n  }\n`;\n\nconst selectBoxStyle: CSSProperties = {\n  marginLeft: 2,\n  marginRight: 2,\n  border: 'none',\n  height: '20px',\n};\n\ninterface ActionsColumnProps {\n  rowData: RangeData;\n  rowSpanTags: {\n    rowSpan: any;\n    style: CSSProperties;\n  };\n  onHoverSignal?: {\n    onMouseEnter: () => void;\n    onMouseLeave: () => void;\n  };\n  onHoverRange?: {\n    onMouseEnter: () => void;\n    onMouseLeave: () => void;\n  };\n}\n\nfunction ActionsColumn({\n  rowData,\n  onHoverSignal,\n  rowSpanTags,\n}: ActionsColumnProps) {\n  const { editRange, deleteRange, changeRangeSignalKind, zoomRange } =\n    useEditRangeModal(rowData);\n\n  return (\n    <Fragment>\n      <td {...onHoverSignal}>\n        <Select\n          onChange={changeRangeSignalKind}\n          data={SignalKinds}\n          defaultValue={rowData.tableMetaInfo.signal.kind}\n          style={selectBoxStyle}\n        />\n      </td>\n      <td {...rowSpanTags} css={styles}>\n        <button type=\"button\" className=\"delete-button\" onClick={deleteRange}>\n          <FaRegTrashAlt />\n        </button>\n        <button type=\"button\" className=\"zoom-button\" onClick={zoomRange}>\n          <FaSearchPlus title=\"Zoom to range in spectrum\" />\n        </button>\n        <button type=\"button\" className=\"edit-button\" onClick={editRange}>\n          <FaEdit color=\"blue\" />\n        </button>\n      </td>\n    </Fragment>\n  );\n}\n\nexport default ActionsColumn;\n","import lodashGet from 'lodash/get';\n\ninterface CouplingColumnProps {\n  rowData: {\n    id: number;\n    from: number;\n    to: number;\n    tableMetaInfo: any;\n  };\n  onHoverSignal?: {\n    onMouseEnter: () => void;\n    onMouseLeave: () => void;\n  };\n}\n\nfunction CouplingColumn({ rowData, onHoverSignal }: CouplingColumnProps) {\n  const result = lodashGet(rowData, 'tableMetaInfo.signal.js');\n  return (\n    <td {...onHoverSignal}>\n      {result\n        ?.map((coupling) =>\n          !isNaN(coupling.coupling) ? coupling.coupling.toFixed(1) : '',\n        )\n        .join(',')}\n    </td>\n  );\n}\n\nexport default CouplingColumn;\n","import lodashGet from 'lodash/get';\nimport { CSSProperties, useMemo, useCallback, memo } from 'react';\nimport { FaMinusCircle } from 'react-icons/fa';\n\nimport { AssignmentsData } from '../../../assignment/AssignmentsContext';\nimport { HighlightedSource } from '../../../highlight';\n\nconst spanStyle: CSSProperties = {\n  color: 'red',\n  fontWeight: 'bold',\n};\n\ninterface RangAssignmentColumnProps {\n  rowData: any;\n  onHover: {\n    onMouseEnter: () => void;\n    onMouseLeave: () => void;\n  };\n  assignment: AssignmentsData;\n  highlight: {\n    isActive: boolean;\n  };\n  onUnlinkVisibilityChange?: (element: any) => void;\n  unlinkVisibility: boolean;\n  onLink?: (a: any, b: any) => void;\n  onUnlink?: (element: any, b: boolean) => void;\n  rowSpanTags: any;\n  highlightData: any;\n}\n\nfunction RangeAssignmentsColumn({\n  rowData,\n  assignment,\n  highlight,\n  onUnlinkVisibilityChange,\n  unlinkVisibility,\n  onLink,\n  onUnlink,\n  rowSpanTags,\n  onHover,\n  highlightData,\n}: RangAssignmentColumnProps) {\n  const diaIDs = useMemo(() => {\n    return lodashGet(rowData, 'diaIDs', 0);\n  }, [rowData]);\n\n  const visibilityChangeHandler = useCallback(\n    (flag) => {\n      onUnlinkVisibilityChange?.(flag);\n    },\n    [onUnlinkVisibilityChange],\n  );\n\n  const spanCss: CSSProperties = useMemo(() => {\n    const flag =\n      assignment.isActive ||\n      assignment.isOver ||\n      (highlight.isActive &&\n        highlightData.highlight.sourceData?.type !== HighlightedSource.SIGNAL);\n    return flag\n      ? {\n          color: 'red',\n          fontWeight: 'bold',\n        }\n      : { color: 'black', fontWeight: 'normal' };\n  }, [\n    assignment.isActive,\n    assignment.isOver,\n    highlight.isActive,\n    highlightData.highlight.sourceData?.type,\n  ]);\n\n  return (\n    <td\n      {...rowSpanTags}\n      {...onHover}\n      {...{ onClick: (e) => onLink?.(e, assignment) }}\n    >\n      {rowData.nbAtoms !== undefined && rowData.nbAtoms > 0 ? (\n        rowData.diaIDs && rowData.diaIDs.length > 0 ? (\n          <div\n            onMouseEnter={() => visibilityChangeHandler(true)}\n            onMouseLeave={() => visibilityChangeHandler(false)}\n          >\n            {rowData.nbAtoms} {' ( '}\n            <span style={spanCss}>{diaIDs.length}</span>\n            {' ) '}\n            <sup>\n              <button\n                type=\"button\"\n                style={{\n                  visibility: unlinkVisibility ? 'visible' : 'hidden',\n                  padding: 0,\n                  margin: 0,\n                }}\n                onClick={(e) => onUnlink?.(e, true)}\n              >\n                <FaMinusCircle color=\"red\" />\n              </button>\n            </sup>\n          </div>\n        ) : assignment.isActive ? (\n          <div>\n            {`${rowData.nbAtoms} (`}\n            <span style={spanStyle}>0</span>\n            {')'}\n          </div>\n        ) : (\n          rowData.nbAtoms\n        )\n      ) : assignment.isActive ? (\n        <div>\n          {'0 ('}\n          <span style={spanStyle}>0</span>\n          {')'}\n        </div>\n      ) : (\n        ''\n      )}\n    </td>\n  );\n}\n\nexport default memo(RangeAssignmentsColumn);\n","import { CSSProperties, memo } from 'react';\n\nimport FormatNumber from '../../../utility/FormatNumber';\n\ninterface RangeColumnProps {\n  value: any;\n  rowSpanTags: {\n    rowSpan: any;\n    style: CSSProperties;\n  };\n  onHoverRange?: {\n    onMouseEnter: () => void;\n    onMouseLeave: () => void;\n  };\n  format: string;\n}\n\nfunction RangeColumn({\n  value,\n  rowSpanTags,\n  onHoverRange,\n  format,\n}: RangeColumnProps) {\n  return (\n    <td {...rowSpanTags} {...onHoverRange}>\n      {FormatNumber(value, format)}\n    </td>\n  );\n}\n\nexport default memo(RangeColumn);\n","import { useCallback, useMemo } from 'react';\n\nimport { checkRangeKind } from '../../../../data/utilities/RangeUtilities';\nimport { useDispatch } from '../../../context/DispatchContext';\nimport EditableColumn from '../../../elements/EditableColumn';\nimport { CHANGE_RANGE_RELATIVE } from '../../../reducer/types/Types';\nimport FormatNumber from '../../../utility/FormatNumber';\n\nfunction RelativeColumn({ rowData, rowSpanTags, onHoverRange, format }) {\n  const dispatch = useDispatch();\n\n  const integralVal = useMemo(() => {\n    const flag = checkRangeKind(rowData);\n    const formattedValue = FormatNumber(rowData.integration, format);\n    return flag ? formattedValue : `[ ${formattedValue} ]`;\n  }, [format, rowData]);\n\n  const saveHandler = useCallback(\n    (event) => {\n      dispatch({\n        type: CHANGE_RANGE_RELATIVE,\n        payload: {\n          data: { value: event.target.value, id: rowData.id },\n        },\n      });\n    },\n    [dispatch, rowData.id],\n  );\n\n  return (\n    <td {...rowSpanTags} {...onHoverRange}>\n      <EditableColumn\n        value={integralVal}\n        onSave={saveHandler}\n        type=\"number\"\n        style={{ padding: '0.1rem 0.4rem' }}\n      />\n    </td>\n  );\n}\n\nexport default RelativeColumn;\n","import lodashGet from 'lodash/get';\nimport { CSSProperties, useMemo, useCallback, memo } from 'react';\nimport { FaMinusCircle } from 'react-icons/fa';\n\nimport { AssignmentsData } from '../../../assignment/AssignmentsContext';\n\ninterface SignalAssignmentsColumnProps {\n  rowData: any;\n  onHover: {\n    onMouseEnter: () => void;\n    onMouseLeave: () => void;\n  };\n  assignment: AssignmentsData;\n  highlight: {\n    isActive: boolean;\n  };\n  onUnlinkVisibilityChange?: (element: any) => void;\n  unlinkVisibility: boolean;\n  onLink?: (a: any, b: any) => void;\n  onUnlink?: (element: any, b: boolean) => void;\n}\n\nfunction SignalAssignmentsColumn({\n  rowData,\n  onHover,\n  assignment,\n  highlight,\n  onUnlinkVisibilityChange,\n  unlinkVisibility,\n  onLink,\n  onUnlink,\n}: SignalAssignmentsColumnProps) {\n  const diaIDs = useMemo(() => {\n    return lodashGet(rowData, 'tableMetaInfo.signal.diaIDs', []);\n  }, [rowData]);\n\n  const tdCss: CSSProperties | undefined = useMemo(() => {\n    return assignment.isActive || highlight.isActive\n      ? {\n          color: 'red',\n          fontWeight: 'bold',\n        }\n      : undefined;\n  }, [assignment.isActive, highlight.isActive]);\n\n  const visibilityChangeHandler = useCallback(\n    (flag) => {\n      onUnlinkVisibilityChange?.(flag);\n    },\n    [onUnlinkVisibilityChange],\n  );\n  const assignHandler = useCallback(\n    (e) => {\n      onLink?.(e, assignment);\n    },\n    [assignment, onLink],\n  );\n\n  return (\n    <td {...onHover} onClick={assignHandler} style={tdCss}>\n      {diaIDs && diaIDs.length > 0 ? (\n        <div\n          onMouseEnter={() => visibilityChangeHandler(true)}\n          onMouseLeave={() => visibilityChangeHandler(false)}\n        >\n          {diaIDs.length}{' '}\n          <sup>\n            <button\n              type=\"button\"\n              style={{\n                visibility: unlinkVisibility ? 'visible' : 'hidden',\n                padding: 0,\n                margin: 0,\n              }}\n              onClick={(e) => onUnlink?.(e, false)}\n            >\n              <FaMinusCircle color=\"red\" />\n            </button>\n          </sup>\n        </div>\n      ) : assignment.isActive ? (\n        '0'\n      ) : (\n        ''\n      )}\n    </td>\n  );\n}\n\nexport default memo(SignalAssignmentsColumn);\n","import lodashGet from 'lodash/get';\n\nimport FormatNumber from '../../../utility/FormatNumber';\n\nexport default function useFormat(preferences) {\n  return (value, keysPath, prefix = '', suffix = '') => {\n    const format = lodashGet(preferences, keysPath, '0.000');\n    return FormatNumber(value, format, prefix, suffix);\n  };\n}\n","import { useCallback } from 'react';\n\nimport { useDispatch } from '../../../context/DispatchContext';\nimport EditableColumn from '../../../elements/EditableColumn';\nimport { CHANGE_RANGE_SIGNAL_VALUE } from '../../../reducer/types/Types';\nimport { checkMultiplicity } from '../../extra/utilities/MultiplicityUtilities';\n\nimport useFormat from './format';\n\ninterface SignalDeltaColumnProps {\n  rowData: any;\n  onHoverSignal: {\n    onMouseEnter: () => void;\n    onMouseLeave: () => void;\n  };\n  preferences: string;\n}\n\nfunction SignalDeltaColumn({\n  rowData,\n  onHoverSignal,\n  preferences,\n}: SignalDeltaColumnProps) {\n  const dispatch = useDispatch();\n  const signal = rowData.tableMetaInfo.signal;\n  const format = useFormat(preferences);\n\n  const saveHandler = useCallback(\n    (event) => {\n      dispatch({\n        type: CHANGE_RANGE_SIGNAL_VALUE,\n        payload: {\n          value: event.target.value,\n          rangeID: rowData.id,\n          signalID: signal.id,\n        },\n      });\n    },\n    [dispatch, rowData.id, signal.id],\n  );\n\n  if (!signal) return <td>{''}</td>;\n\n  return (\n    <td {...onHoverSignal}>\n      {!checkMultiplicity(signal.multiplicity, ['m']) ? (\n        `${format(rowData.from, 'fromFormat')} - ${format(\n          rowData.to,\n          'toFormat',\n        )}`\n      ) : (\n        <EditableColumn\n          value={signal.delta.toFixed(3)}\n          onSave={saveHandler}\n          type=\"number\"\n          style={{ padding: '0.1rem 0.4rem' }}\n        />\n      )}\n    </td>\n  );\n}\n\nexport default SignalDeltaColumn;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport lodashGet from 'lodash/get';\nimport { useMemo, useCallback, useState } from 'react';\n\nimport {\n  AssignmentsData,\n  useAssignment,\n  useAssignmentData,\n} from '../../assignment/AssignmentsContext';\nimport { filterForIDsWithAssignment } from '../../assignment/utilities/filterForIDsWithAssignment';\nimport {\n  HighlightedSource,\n  useHighlight,\n  useHighlightData,\n} from '../../highlight';\nimport { isColumnVisible } from '../extra/preferences/ColumnsHelper';\n\nimport AbsoluteColumn from './TableColumns/AbsoluteColumn';\nimport ActionsColumn from './TableColumns/ActionsColumn';\nimport CouplingColumn from './TableColumns/CouplingColumn';\nimport RangeAssignmentsColumn from './TableColumns/RangeAssignmentsColumn';\nimport RangeColumn from './TableColumns/RangeColumn';\nimport RelativeColumn from './TableColumns/RelativeColumn';\nimport SignalAssignmentsColumn from './TableColumns/SignalAssignmentsColumn';\nimport SignalDeltaColumn from './TableColumns/SignalDeltaColumn';\nimport useFormat from './TableColumns/format';\n\nconst HighlightedRowStyle = css`\n  background-color: #ff6f0057;\n`;\n\nconst ConstantlyHighlightedRowStyle = css`\n  background-color: #f5f5dc;\n`;\n\ninterface RangesTableRowProps {\n  rowData: any;\n  onUnlink: (a: any, b?: any) => void;\n  onContextMenu: (element: any, data: any) => void;\n  preferences: string;\n}\n\nfunction RangesTableRow({\n  rowData,\n  onUnlink,\n  onContextMenu,\n  preferences,\n}: RangesTableRowProps) {\n  const assignmentData = useAssignmentData();\n  const assignmentRange = useAssignment(rowData.id);\n  const highlightRange = useHighlight(\n    [assignmentRange.id].concat(assignmentRange.assigned?.x || []).concat(\n      filterForIDsWithAssignment(\n        assignmentData,\n        rowData.signals.map((_signal) => _signal.id),\n      ),\n    ),\n    { type: HighlightedSource.RANGE },\n  );\n  const highlightRangeAssignmentsColumn = useHighlight(\n    assignmentRange.assigned?.x || [],\n    { type: HighlightedSource.RANGE },\n  );\n  const assignmentSignal = useAssignment(rowData.tableMetaInfo.id);\n  const highlightSignal = useHighlight(\n    [assignmentSignal.id].concat(assignmentSignal.assigned?.x || []),\n    { type: HighlightedSource.SIGNAL },\n  );\n  const highlightData = useHighlightData();\n  const [unlinkRangeButtonVisibility, showUnlinkRangeButton] = useState(false);\n  const [unlinkSignalButtonVisibility, showUnlinkSignalButton] =\n    useState(false);\n\n  const getFormat = useFormat(preferences);\n\n  const rowSpanTags: any = useMemo(() => {\n    return {\n      rowSpan: rowData.tableMetaInfo.rowSpan,\n      style: lodashGet(rowData.tableMetaInfo, 'hide', false)\n        ? { display: 'none' }\n        : undefined,\n    };\n  }, [rowData.tableMetaInfo]);\n\n  const unlinkHandler = useCallback(\n    (e, isOnRangeLevel) => {\n      // stop propagation here to prevent enabling/disabling the assignment mode at the same time\n      if (e) {\n        e.stopPropagation();\n      }\n\n      if (isOnRangeLevel !== undefined) {\n        if (isOnRangeLevel) {\n          onUnlink(rowData);\n          showUnlinkRangeButton(false);\n          assignmentRange.removeAll('x');\n        } else {\n          onUnlink(\n            rowData,\n            lodashGet(rowData, 'tableMetaInfo.signalIndex', undefined),\n          );\n          showUnlinkSignalButton(false);\n          assignmentSignal.removeAll('x');\n        }\n      } else {\n        showUnlinkRangeButton(false);\n        showUnlinkSignalButton(false);\n      }\n    },\n    [assignmentRange, assignmentSignal, onUnlink, rowData],\n  );\n\n  const linkHandler = useCallback((e, assignment: AssignmentsData) => {\n    e.stopPropagation();\n    assignment.setActive('x');\n  }, []);\n\n  const onHoverRange = useMemo(() => {\n    return {\n      onMouseEnter: () => {\n        assignmentRange.show('x');\n        highlightRange.show();\n      },\n      onMouseLeave: () => {\n        assignmentRange.hide();\n        highlightRange.hide();\n      },\n    };\n  }, [assignmentRange, highlightRange]);\n\n  const onHoverRangeAssignmentsColumn = useMemo(() => {\n    return {\n      onMouseEnter: () => {\n        assignmentRange.show('x');\n        highlightRangeAssignmentsColumn.show();\n      },\n      onMouseLeave: () => {\n        assignmentRange.hide();\n        highlightRangeAssignmentsColumn.hide();\n      },\n    };\n  }, [assignmentRange, highlightRangeAssignmentsColumn]);\n\n  const onHoverSignal = useMemo(() => {\n    return {\n      onMouseEnter: () => {\n        assignmentSignal.show('x');\n        highlightSignal.show();\n      },\n      onMouseLeave: () => {\n        assignmentSignal.hide();\n        highlightSignal.hide();\n      },\n    };\n  }, [assignmentSignal, highlightSignal]);\n\n  const trCss = useMemo(() => {\n    return highlightRange.isActive || assignmentRange.isActive\n      ? HighlightedRowStyle\n      : lodashGet(rowData, 'tableMetaInfo.isConstantlyHighlighted', false)\n      ? ConstantlyHighlightedRowStyle\n      : null;\n  }, [assignmentRange.isActive, highlightRange.isActive, rowData]);\n\n  return (\n    <tr onContextMenu={(e) => onContextMenu(e, rowData)} css={trCss}>\n      <td {...rowSpanTags} {...onHoverRange}>\n        {rowData.tableMetaInfo.rowIndex + 1}\n      </td>\n\n      {isColumnVisible(preferences, 'showFrom') && (\n        <RangeColumn\n          value={rowData.from}\n          rowSpanTags={rowSpanTags}\n          onHoverRange={onHoverRange}\n          format={getFormat('showFrom', undefined)}\n        />\n      )}\n      {isColumnVisible(preferences, 'showTo') && (\n        <RangeColumn\n          value={rowData.to}\n          rowSpanTags={rowSpanTags}\n          onHoverRange={onHoverRange}\n          format={getFormat('toFormat', undefined)}\n        />\n      )}\n\n      <SignalDeltaColumn\n        rowData={rowData}\n        onHoverSignal={onHoverSignal}\n        preferences={preferences}\n      />\n\n      {isColumnVisible(preferences, 'showRelative') && (\n        <RelativeColumn\n          rowData={rowData}\n          rowSpanTags={rowSpanTags}\n          onHoverRange={onHoverRange}\n          format={getFormat('relativeFormat', undefined)}\n        />\n      )}\n\n      {isColumnVisible(preferences, 'showAbsolute') && (\n        <AbsoluteColumn\n          value={rowData.absolute}\n          rowSpanTags={rowSpanTags}\n          onHoverRange={onHoverRange}\n          format={getFormat('absoluteFormat', undefined)}\n        />\n      )}\n\n      <td {...onHoverSignal}>\n        {lodashGet(rowData, 'tableMetaInfo.signal.multiplicity', '')}\n      </td>\n\n      <CouplingColumn rowData={rowData} onHoverSignal={onHoverSignal} />\n\n      <SignalAssignmentsColumn\n        rowData={rowData}\n        assignment={assignmentSignal}\n        highlight={highlightSignal}\n        onHover={onHoverSignal}\n        unlinkVisibility={unlinkSignalButtonVisibility}\n        onUnlinkVisibilityChange={(flag) => showUnlinkSignalButton(flag)}\n        onLink={linkHandler}\n        onUnlink={unlinkHandler}\n      />\n\n      <RangeAssignmentsColumn\n        rowData={rowData}\n        assignment={assignmentRange}\n        highlight={highlightRangeAssignmentsColumn}\n        onHover={onHoverRangeAssignmentsColumn}\n        unlinkVisibility={unlinkRangeButtonVisibility}\n        onUnlinkVisibilityChange={(flag) => showUnlinkRangeButton(flag)}\n        onLink={linkHandler}\n        onUnlink={unlinkHandler}\n        rowSpanTags={rowSpanTags}\n        highlightData={highlightData}\n      />\n\n      <ActionsColumn\n        rowData={rowData}\n        onHoverSignal={onHoverSignal}\n        onHoverRange={onHoverRange}\n        rowSpanTags={rowSpanTags}\n      />\n    </tr>\n  );\n}\n\nexport default RangesTableRow;\n","import { useMemo } from 'react';\n\nimport { Range } from '../../../../data/types/data1d';\nimport generateID from '../../../../data/utilities/generateID';\n\nexport interface RangeData extends Range {\n  rowKey: string;\n  tableMetaInfo: any;\n}\n\nfunction useMapRanges(data) {\n  return useMemo(() => {\n    const _rangesData: Array<RangeData> = [];\n    data.forEach((range, i) => {\n      if (range.signals.length === 1) {\n        _rangesData.push({\n          rowKey: generateID(),\n          ...range,\n          tableMetaInfo: {\n            ...range.tableMetaInfo,\n            signal: range.signals[0],\n            rowIndex: i,\n            signalIndex: 0,\n            id: range.signals[0].id,\n          },\n        });\n      } else if (range.signals.length > 1) {\n        range.signals.forEach((signal, j) => {\n          let hide = false;\n          let rowSpan = null;\n          if (j < range.signals.length - 1) {\n            if (j === 0) {\n              rowSpan = range.signals.length;\n            } else {\n              hide = true;\n            }\n          } else {\n            hide = true;\n          }\n\n          _rangesData.push({\n            rowKey: generateID(),\n            ...range,\n            tableMetaInfo: {\n              ...range.tableMetaInfo,\n              signal,\n              rowSpan,\n              hide,\n              rowIndex: i,\n              signalIndex: j,\n              id: signal.id,\n            },\n          });\n        });\n      }\n    });\n\n    return _rangesData;\n  }, [data]);\n}\n\nexport default useMapRanges;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport lodashGet from 'lodash/get';\nimport { Fragment, useCallback, useRef } from 'react';\nimport { FaLink } from 'react-icons/fa';\n\nimport checkModifierKeyActivated from '../../../data/utilities/checkModifierKeyActivated';\nimport ContextMenu from '../../elements/ContextMenu';\nimport useTableSortBy from '../../hooks/useTableSortBy';\n\nimport RangesTableRow from './RangesTableRow';\nimport useMapRanges from './hooks/useMapRanges';\n\nconst tableStyle = css`\n  border-spacing: 0;\n  border: 1px solid #dedede;\n  width: 100%;\n  font-size: 12px;\n  .react-contextmenu-wrapper {\n    display: contents;\n  }\n  tr {\n    :last-child {\n      td {\n        border-bottom: 0;\n      }\n    }\n  }\n  th {\n    position: sticky;\n    top: 0;\n    background-color: white;\n    z-index: 1;\n  }\n  th,\n  td {\n    white-space: nowrap;\n    text-align: center;\n    margin: 0;\n    padding: 0.1rem 0.4rem;\n    border-bottom: 1px solid #dedede;\n    border-right: 1px solid #dedede;\n\n    :last-child {\n      border-right: 0;\n    }\n    button {\n      background-color: transparent;\n      border: none;\n    }\n  }\n`;\n\nfunction RangesTable({ tableData, onUnlink, context, activeTab, preferences }) {\n  const element = activeTab?.replace(/[0-9]/g, '');\n  const contextRef = useRef<any>();\n  const { items: sortedData, isSortedDesc, onSort } = useTableSortBy(tableData);\n  const data = useMapRanges(sortedData);\n\n  const isVisible = (key) => {\n    return lodashGet(preferences, key, false);\n  };\n\n  const contextMenuHandler = useCallback(\n    (e, rowData) => {\n      if (!checkModifierKeyActivated(e)) {\n        e.preventDefault();\n        contextRef.current.handleContextMenu(e, rowData);\n      }\n    },\n    [contextRef],\n  );\n\n  return (\n    <Fragment>\n      <table css={tableStyle}>\n        <thead>\n          <tr>\n            <th>#</th>\n            {isVisible('showFrom') ? (\n              <th id=\"from\" {...onSort}>\n                From\n                {isSortedDesc('from').content}\n              </th>\n            ) : null}\n            {isVisible('showTo') ? (\n              <th id=\"to\" {...onSort}>\n                To {isSortedDesc('to').content}\n              </th>\n            ) : null}\n            <th>δ (ppm) </th>\n\n            {isVisible('showRelative') ? (\n              <th id=\"integration\" {...onSort}>\n                Rel. {element} {isSortedDesc('integration').content}\n              </th>\n            ) : null}\n            {isVisible('showAbsolute') ? <th>Absolute</th> : null}\n            <th>Mult.</th>\n            <th>J (Hz)</th>\n            <th>\n              <FaLink style={{ fontSize: 10 }} />\n            </th>\n            <th>Σ</th>\n            <th>Kind</th>\n            <th>{''}</th>\n          </tr>\n        </thead>\n        <tbody>\n          {data?.map((range) => {\n            return (\n              <RangesTableRow\n                key={range.rowKey}\n                rowData={range}\n                onUnlink={onUnlink}\n                onContextMenu={(e, rowData) => contextMenuHandler(e, rowData)}\n                preferences={preferences}\n              />\n            );\n          })}\n        </tbody>\n      </table>\n      <ContextMenu ref={contextRef} context={context} />\n    </Fragment>\n  );\n}\n\nexport default RangesTable;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport lodashGet from 'lodash/get';\nimport { xGetFromToIndex } from 'ml-spectra-processing';\nimport { useCallback, useMemo, memo, useState, useRef } from 'react';\n\nimport { Molecule } from '../../../data/molecules/Molecule';\nimport { Data1D, Datum1D, Info1D, Ranges } from '../../../data/types/data1d';\nimport { useAssignmentData } from '../../assignment/AssignmentsContext';\nimport { useChartData } from '../../context/ChartContext';\nimport { useDispatch } from '../../context/DispatchContext';\nimport { usePreferences } from '../../context/PreferencesContext';\nimport { useAlert } from '../../elements/popup/Alert';\nimport useSpectrum from '../../hooks/useSpectrum';\nimport { UNLINK_RANGE } from '../../reducer/types/Types';\nimport { copyTextToClipboard } from '../../utility/Export';\nimport { tablePanelStyle } from '../extra/BasicPanelStyle';\nimport NoTableData from '../extra/placeholder/NoTableData';\nimport { getRangeDefaultValues } from '../extra/preferences/defaultValues';\nimport PreferencesHeader from '../header/PreferencesHeader';\n\nimport RangesHeader from './RangesHeader';\nimport RangesPreferences from './RangesPreferences';\nimport RangesTable from './RangesTable';\n\ninterface RangesTablePanelInnerProps {\n  ranges: Ranges;\n  data: Data1D;\n  info: Info1D;\n  xDomain: Array<number>;\n  activeTab: string;\n  molecules: Array<Molecule>;\n  showMultiplicityTrees: boolean;\n  showJGraph: boolean;\n  showRangesIntegrals: boolean;\n  preferences: any;\n}\n\nfunction RangesTablePanelInner({\n  ranges,\n  data,\n  info,\n  xDomain,\n  preferences,\n  activeTab,\n  molecules,\n  showMultiplicityTrees,\n  showJGraph,\n  showRangesIntegrals,\n}: RangesTablePanelInnerProps) {\n  const [isFilterActive, setFilterIsActive] = useState(false);\n  const assignmentData = useAssignmentData();\n\n  const dispatch = useDispatch();\n  const alert = useAlert();\n  const [isFlipped, setFlipStatus] = useState(false);\n\n  const settingRef = useRef<any>();\n\n  const rangesData = useMemo(() => {\n    const isInView = (from, to) => {\n      const factor = 10000;\n      to = to * factor;\n      from = from * factor;\n      return (\n        (to >= xDomain[0] * factor && from <= xDomain[1] * factor) ||\n        (from <= xDomain[0] * factor && to >= xDomain[1] * factor)\n      );\n    };\n\n    const getFilteredRanges = (ranges) => {\n      return ranges.filter((range) => isInView(range.from, range.to));\n    };\n\n    if (ranges.values) {\n      const _ranges = isFilterActive\n        ? getFilteredRanges(ranges.values)\n        : ranges.values;\n\n      return _ranges.map((range) => {\n        return {\n          ...range,\n          tableMetaInfo: {\n            isConstantlyHighlighted: isInView(range.from, range.to),\n          },\n        };\n      });\n    }\n    return [];\n  }, [isFilterActive, ranges.values, xDomain]);\n\n  const unlinkRangeHandler = useCallback(\n    (rangeData, signalIndex = -1) => {\n      dispatch({\n        type: UNLINK_RANGE,\n        payload: {\n          rangeData,\n          assignmentData,\n          signalIndex,\n        },\n      });\n    },\n    [assignmentData, dispatch],\n  );\n\n  const saveJSONToClipboardHandler = useCallback(\n    async (value) => {\n      if (data.x && data.re) {\n        const { x, re } = data;\n        const { from, to } = value;\n\n        const { fromIndex, toIndex } = xGetFromToIndex(x, {\n          from,\n          to,\n        });\n        const dataToClipboard = {\n          x: Array.from(x.slice(fromIndex, toIndex)),\n          y: Array.from(re.slice(fromIndex, toIndex)),\n          ...value,\n        };\n\n        const success = await copyTextToClipboard(\n          JSON.stringify(dataToClipboard, undefined, 2),\n        );\n\n        if (success) {\n          alert.show('Data copied to clipboard');\n        } else {\n          alert.error('copy to clipboard failed');\n        }\n      }\n    },\n    [data, alert],\n  );\n\n  const rangesPreferences = useMemo(() => {\n    const _preferences =\n      lodashGet(\n        preferences.current,\n        `formatting.panels.ranges.[${activeTab}]`,\n      ) || getRangeDefaultValues(activeTab);\n\n    return _preferences;\n  }, [activeTab, preferences]);\n\n  const contextMenu = useMemo(\n    () => [\n      {\n        label: 'Copy to clipboard',\n        onClick: saveJSONToClipboardHandler,\n      },\n    ],\n    [saveJSONToClipboardHandler],\n  );\n\n  const filterHandler = useCallback(() => {\n    setFilterIsActive(!isFilterActive);\n  }, [isFilterActive]);\n\n  const settingsPanelHandler = useCallback(() => {\n    setFlipStatus(!isFlipped);\n  }, [isFlipped]);\n\n  const saveSettingHandler = useCallback(() => {\n    settingRef.current.saveSetting();\n    setFlipStatus(false);\n  }, []);\n\n  return (\n    <>\n      <div\n        css={[\n          tablePanelStyle,\n          isFlipped &&\n            css`\n              th {\n                position: relative;\n              }\n            `,\n        ]}\n      >\n        {!isFlipped && (\n          <RangesHeader\n            {...{\n              ranges,\n              info,\n              activeTab,\n              molecules,\n              showRangesIntegrals,\n              showMultiplicityTrees,\n              showJGraph,\n              isFilterActive,\n            }}\n            onUnlink={unlinkRangeHandler}\n            onFilterActivated={filterHandler}\n            onSettingClick={settingsPanelHandler}\n            filterCounter={rangesData.length}\n          />\n        )}\n        {isFlipped && (\n          <PreferencesHeader\n            onSave={saveSettingHandler}\n            onClose={settingsPanelHandler}\n          />\n        )}\n        <div className=\"inner-container\">\n          {!isFlipped ? (\n            <div className=\"table-container\">\n              {rangesData && rangesData.length > 0 ? (\n                <RangesTable\n                  activeTab={activeTab}\n                  tableData={rangesData}\n                  onUnlink={unlinkRangeHandler}\n                  context={contextMenu}\n                  preferences={rangesPreferences}\n                />\n              ) : (\n                <NoTableData />\n              )}\n            </div>\n          ) : (\n            <RangesPreferences ref={settingRef} />\n          )}\n        </div>\n      </div>\n    </>\n  );\n}\n\nconst MemoizedRangesTablePanel = memo(RangesTablePanelInner);\n\nconst emptyData = { ranges: {}, data: {}, info: {} };\n\nexport default function RangesTablePanel() {\n  const {\n    displayerKey,\n    xDomain,\n    activeTab,\n    molecules,\n    toolOptions: {\n      selectedTool,\n      data: { showMultiplicityTrees, showRangesIntegrals, showJGraph },\n    },\n  } = useChartData();\n\n  const { ranges, data, info } = useSpectrum(emptyData) as Datum1D;\n  const preferences = usePreferences();\n\n  return (\n    <MemoizedRangesTablePanel\n      {...{\n        ranges,\n        data,\n        info,\n        showMultiplicityTrees,\n        showJGraph,\n        showRangesIntegrals,\n        selectedTool,\n        displayerKey,\n        preferences,\n        xDomain,\n        activeTab,\n        molecules,\n      }}\n    />\n  );\n}\n","import lodashGet from 'lodash/get';\n\nimport { usePreferences } from '../context/PreferencesContext';\n\nexport function useCheckToolsVisibility(): (toolKey: string) => boolean {\n  const preferences = usePreferences();\n\n  return (toolKey) =>\n    lodashGet(preferences.current, `display.toolBarButtons.${toolKey}`, true);\n}\n","import {\n  SvgNmrSameTop,\n  SvgNmrResetScale,\n  SvgNmrRangePicking,\n} from 'cheminfo-font';\nimport { memo, useCallback } from 'react';\nimport {\n  FaCreativeCommonsSamplingPlus,\n  FaEye,\n  FaEyeSlash,\n} from 'react-icons/fa';\n\nimport { Datum1D } from '../../../data/types/data1d';\nimport { Datum2D } from '../../../data/types/data2d';\nimport { useChartData } from '../../context/ChartContext';\nimport { useDispatch } from '../../context/DispatchContext';\nimport Button from '../../elements/ButtonToolTip';\nimport { useAlert } from '../../elements/popup/Alert';\nimport { useModal } from '../../elements/popup/Modal';\nimport { useCheckToolsVisibility } from '../../hooks/useCheckToolsVisibility';\nimport { ActiveSpectrum } from '../../reducer/Reducer';\nimport { DISPLAYER_MODE } from '../../reducer/core/Constants';\nimport {\n  ADD_MISSING_PROJECTION,\n  CHANGE_VISIBILITY,\n  DELETE_SPECTRA,\n  RESET_SPECTRA_SCALE,\n  SET_SPECTRA_SAME_TOP,\n  AUTO_RANGES_SPECTRA_PICKING,\n  AUTO_ZONES_SPECTRA_PICKING,\n} from '../../reducer/types/Types';\nimport DefaultPanelHeader from '../header/DefaultPanelHeader';\n\ninterface SpectraPanelHeaderProps {\n  spectrums: Array<Datum1D | Datum2D>;\n}\n\ninterface SpectraPanelHeaderInnerProps extends SpectraPanelHeaderProps {\n  data: Array<Datum1D | Datum2D>;\n  activeTab: string;\n  activeSpectrum: ActiveSpectrum | null;\n  displayerMode: string;\n  isAutomaticPickingVisible: boolean;\n}\n\nfunction SpectraPanelHeaderInner({\n  data,\n  activeSpectrum,\n  activeTab,\n  displayerMode,\n  spectrums,\n  isAutomaticPickingVisible,\n}: SpectraPanelHeaderInnerProps) {\n  const modal = useModal();\n  const alert = useAlert();\n  const dispatch = useDispatch();\n\n  const handleDelete = useCallback(() => {\n    modal.showConfirmDialog({\n      message: 'All records will be deleted, Are You sure?',\n      buttons: [\n        {\n          text: 'Yes',\n          handler: () => {\n            dispatch({ type: DELETE_SPECTRA });\n          },\n        },\n        { text: 'No' },\n      ],\n    });\n  }, [dispatch, modal]);\n\n  const showAllSpectrumsHandler = useCallback(() => {\n    const spectrumsPerTab = spectrums.map((datum) => {\n      return datum.id;\n    });\n    dispatch({ type: CHANGE_VISIBILITY, id: spectrumsPerTab });\n  }, [dispatch, spectrums]);\n\n  const hideAllSpectrumsHandler = useCallback(() => {\n    dispatch({ type: CHANGE_VISIBILITY, id: [] });\n  }, [dispatch]);\n\n  const addMissingProjectionHandler = useCallback(() => {\n    function getMissingProjection(SpectrumsData) {\n      let nucleus = activeTab.split(',');\n      nucleus = nucleus[0] === nucleus[1] ? [nucleus[0]] : nucleus;\n      const missingNucleus: Array<string> = [];\n      for (const n of nucleus) {\n        const hasSpectrums = SpectrumsData.some((d) => d.info.nucleus === n);\n        if (!hasSpectrums) {\n          missingNucleus.push(n);\n        }\n      }\n      return missingNucleus;\n    }\n    const missingNucleus = getMissingProjection(data);\n    if (missingNucleus.length > 0) {\n      dispatch({ type: ADD_MISSING_PROJECTION, nucleus: missingNucleus });\n    } else {\n      alert.error('Nothing to calculate');\n    }\n  }, [activeTab, alert, data, dispatch]);\n\n  const setSameTopHandler = useCallback(() => {\n    dispatch({ type: SET_SPECTRA_SAME_TOP });\n  }, [dispatch]);\n  const resetScaleHandler = useCallback(() => {\n    dispatch({ type: RESET_SPECTRA_SCALE });\n  }, [dispatch]);\n\n  const automaticPickingHandler = useCallback(() => {\n    void (async () => {\n      const hideLoading = await alert.showLoading(\n        'Automatic Ranges/Zones detection for all spectra in progress',\n      );\n      setTimeout(() => {\n        dispatch({ type: AUTO_RANGES_SPECTRA_PICKING });\n        dispatch({ type: AUTO_ZONES_SPECTRA_PICKING });\n        hideLoading();\n      }, 0);\n    })();\n  }, [dispatch, alert]);\n\n  return (\n    <DefaultPanelHeader\n      onDelete={handleDelete}\n      counter={spectrums?.length}\n      deleteToolTip=\"Delete all spectra\"\n    >\n      <Button popupTitle=\"Hide all spectra\" onClick={hideAllSpectrumsHandler}>\n        <FaEyeSlash />\n      </Button>\n      <Button popupTitle=\"Show all spectra\" onClick={showAllSpectrumsHandler}>\n        <FaEye />\n      </Button>\n      {activeSpectrum && activeTab && activeTab.split(',').length > 1 && (\n        <Button\n          popupTitle=\"Add missing projection\"\n          onClick={addMissingProjectionHandler}\n        >\n          <FaCreativeCommonsSamplingPlus />\n        </Button>\n      )}\n      {displayerMode === DISPLAYER_MODE.DM_1D && spectrums.length > 1 && (\n        <>\n          <Button popupTitle=\"Reset Scale\" onClick={resetScaleHandler}>\n            <SvgNmrResetScale />\n          </Button>\n          <Button popupTitle=\"Same Top\" onClick={setSameTopHandler}>\n            <SvgNmrSameTop />\n          </Button>\n        </>\n      )}\n      {data && data.length > 0 && isAutomaticPickingVisible && (\n        <Button\n          popupTitle=\"Automatic Ranges/Zones picking for all spectra\"\n          onClick={automaticPickingHandler}\n        >\n          <SvgNmrRangePicking />\n        </Button>\n      )}\n    </DefaultPanelHeader>\n  );\n}\n\nconst MemoizedSpectraPanelHeader = memo(SpectraPanelHeaderInner);\n\nexport default function SpectrumsTabs({ spectrums }: SpectraPanelHeaderProps) {\n  const { data, activeSpectrum, activeTab, displayerMode } = useChartData();\n  const isToolVisible = useCheckToolsVisibility();\n  const isAutomaticPickingVisible = isToolVisible('autoRangesTool');\n  return (\n    <MemoizedSpectraPanelHeader\n      {...{\n        data,\n        activeSpectrum,\n        activeTab,\n        displayerMode,\n        spectrums,\n        isAutomaticPickingVisible,\n      }}\n    />\n  );\n}\n","import { CSSProperties, memo } from 'react';\n\ninterface ColorIndicatorNDProps {\n  activated: boolean;\n}\n\ninterface ColorIndicator1DProps extends ColorIndicatorNDProps {\n  color: string;\n}\n\ninterface ColorIndicator2DProps extends ColorIndicatorNDProps {\n  positiveColor: string;\n  negativeColor: string;\n}\n\nfunction ColorIndicator1D({ color, activated }: ColorIndicator1DProps) {\n  return (\n    <div\n      style={{\n        backgroundColor: color,\n        height: '12px',\n        width: '12px',\n        opacity: activated ? 1 : 0.1,\n        display: 'inline-block',\n      }}\n    />\n  );\n}\n\nfunction ColorIndicator2D({\n  positiveColor,\n  negativeColor,\n  activated,\n}: ColorIndicator2DProps) {\n  return (\n    <svg\n      width=\"12\"\n      height=\"12\"\n      viewBox=\"0 0 12 12\"\n      opacity={activated ? 1 : 0.1}\n    >\n      <g>\n        <path d=\"M0,0H12L0,12Z\" fill={positiveColor} strokeWidth=\"0\" />\n        <path d=\"M12,12H0L12,0Z\" fill={negativeColor} strokeWidth=\"0\" />\n      </g>\n    </svg>\n  );\n}\n\ntype ColorIndicatorProps = BaseColorIndicatorProps &\n  (\n    | {\n        dimension: 1;\n        color: Omit<ColorIndicator1DProps, 'activated'>;\n      }\n    | { dimension: 2; color: Omit<ColorIndicator2DProps, 'activated'> }\n  );\n\ninterface BaseColorIndicatorProps {\n  activated: boolean;\n  onClick: (e: any) => void;\n  style: CSSProperties;\n}\n\nfunction ColorIndicator(props: ColorIndicatorProps) {\n  const { style, onClick = () => null, activated } = props;\n\n  return (\n    <button style={style} type=\"button\" onClick={onClick}>\n      {props.dimension === 2 ? (\n        <ColorIndicator2D {...props.color} activated={activated} />\n      ) : (\n        <ColorIndicator1D activated={activated} {...props.color} />\n      )}\n    </button>\n  );\n}\n\nexport default memo(ColorIndicator);\n","import { SvgNmrPeaks } from 'cheminfo-font';\nimport { CSSProperties } from 'react';\n\ninterface DataProps {\n  id: string;\n  peaks: {\n    values: Array<any>;\n  };\n}\n\ninterface MarkersProps {\n  id: string;\n}\n\ninterface ShowHideMarkersButtonProps {\n  style: CSSProperties;\n  data: DataProps;\n  onChangeMarkersVisibility: (data: DataProps) => void;\n  markersVisible: Array<MarkersProps>;\n}\n\nexport default function ShowHideMarkersButton({\n  data,\n  onChangeMarkersVisibility,\n  markersVisible,\n  style,\n}: ShowHideMarkersButtonProps) {\n  const isMarkerVisible = (id) => {\n    return markersVisible.findIndex((v) => v.id === id) !== -1 ? true : false;\n  };\n\n  return (\n    <button\n      style={{\n        ...style,\n        opacity:\n          isMarkerVisible(data.id) && data.peaks && data.peaks.values.length > 0\n            ? 1\n            : 0.1,\n      }}\n      type=\"button\"\n      onClick={() => onChangeMarkersVisibility(data)}\n      disabled={data.peaks && data.peaks.values.length === 0}\n    >\n      <SvgNmrPeaks />\n    </button>\n  );\n}\n","import { CSSProperties } from 'react';\nimport { FaEye } from 'react-icons/fa';\n\ninterface DataProps {\n  id: string;\n  display: { color: string; positiveColor: string; negativeColor: string };\n  info: {\n    dimension: 1 | 2;\n  };\n}\n\ninterface ShowHideSpectrumButtonProps {\n  data: DataProps;\n  onChangeVisibility: (\n    data: DataProps,\n    is: 'isVisible' | 'isPositiveVisible' | 'isNegativeVisible',\n  ) => void;\n  style: CSSProperties;\n}\n\nexport default function ShowHideSpectrumButton({\n  data,\n  onChangeVisibility,\n  style,\n}: ShowHideSpectrumButtonProps) {\n  const isVisible = (id, key) => {\n    return data ? data.display[key] : true;\n  };\n  return (\n    <>\n      {data.info.dimension === 1 && (\n        <button\n          data-test-id=\"hide-show-spectrum-button\"\n          style={style}\n          type=\"button\"\n          onClick={() => onChangeVisibility(data, 'isVisible')}\n        >\n          <FaEye\n            style={{\n              ...(isVisible(data.id, 'isVisible')\n                ? {\n                    opacity: 1,\n                    strokeWidth: '1px',\n                    fill: data.display.color,\n                  }\n                : {\n                    opacity: 0.1,\n                    fill: data.display.color,\n                  }),\n            }}\n          />\n        </button>\n      )}\n      {data.info.dimension === 2 && (\n        <div style={{ minWidth: '40px' }}>\n          <button\n            style={{ ...style, width: '20px', minWidth: '20px' }}\n            type=\"button\"\n            onClick={() => onChangeVisibility(data, 'isPositiveVisible')}\n          >\n            <FaEye\n              style={{\n                ...(isVisible(data.id, 'isPositiveVisible')\n                  ? {\n                      opacity: 1,\n                      strokeWidth: '1px',\n                      fill: data.display.positiveColor,\n                    }\n                  : {\n                      opacity: 0.1,\n                      fill: data.display.positiveColor,\n                    }),\n              }}\n            />\n          </button>\n          <button\n            style={{ ...style, width: '20px', minWidth: '20px' }}\n            type=\"button\"\n            onClick={() => onChangeVisibility(data, 'isNegativeVisible')}\n          >\n            <FaEye\n              style={{\n                ...(isVisible(data.id, 'isNegativeVisible')\n                  ? {\n                      opacity: 1,\n                      strokeWidth: '1px',\n                      fill: data.display.negativeColor,\n                    }\n                  : {\n                      opacity: 0.1,\n                      fill: data.display.negativeColor,\n                    }),\n              }}\n            />\n          </button>\n        </div>\n      )}\n    </>\n  );\n}\n","import { SvgNmrFid, SvgNmrFt, SvgNmr2D } from 'cheminfo-font';\nimport { CSSProperties, memo } from 'react';\n\nimport ColorIndicator from './base/ColorIndicator';\nimport ShowHideMarkersButton from './base/ShowHideMarkersButton';\nimport ShowHideSpectrumButton from './base/ShowHideSpectrumButton';\n\nconst styles: Record<\n  'button' | 'row' | 'name' | 'info' | 'icon',\n  CSSProperties\n> = {\n  button: {\n    backgroundColor: 'transparent',\n    border: 'none',\n    width: '26px',\n    minWidth: '26px',\n  },\n  row: {\n    display: 'flex',\n    alignContent: 'center',\n    height: '25px',\n    borderBottom: '0.55px solid #f1f1f1',\n  },\n  name: {\n    flex: 1,\n    height: '100%',\n    display: 'flex',\n  },\n  info: {\n    flex: '1 1 1px',\n    height: '100%',\n    display: 'block',\n    alignItems: 'center',\n    overflow: 'hidden',\n    textOverflow: 'ellipsis',\n    whiteSpace: 'nowrap',\n    lineHeight: '24px',\n  },\n  icon: {\n    display: 'flex',\n    margin: 'auto',\n    justifyContent: 'center',\n  },\n};\n\nfunction SpectrumListItem({\n  activeSpectrum,\n  markersVisible,\n  data,\n  onChangeVisibility,\n  onChangeMarkersVisibility,\n  onChangeActiveSpectrum,\n  onOpenSettingModal,\n  onContextMenu,\n}) {\n  const formatValueAsHTML = (value) => {\n    if (value) {\n      value = value.replace(/(?<value>[0-9]+)/g, '<sub>$<value></sub>');\n    }\n    return value;\n  };\n  const activated = activeSpectrum && activeSpectrum.id === data.id;\n  const { color, name, positiveColor, negativeColor } = data.display;\n  return (\n    <div\n      style={{\n        ...styles.row,\n        ...(activated\n          ? { backgroundColor: '#fafafa' }\n          : { opacity: activeSpectrum ? 0.2 : 1 }),\n      }}\n      onContextMenu={onContextMenu}\n    >\n      <ShowHideSpectrumButton\n        data={data}\n        onChangeVisibility={onChangeVisibility}\n        style={styles.button}\n      />\n\n      <div\n        data-test-id=\"activate-deactivate-spectrum-button\"\n        style={styles.name}\n        onClick={() => onChangeActiveSpectrum(data)}\n      >\n        <div style={{ ...styles.icon, width: '16px' }}>\n          {data.info.isFid ? (\n            <SvgNmrFid />\n          ) : data.info.dimension === 2 ? (\n            <SvgNmr2D />\n          ) : (\n            <SvgNmrFt />\n          )}\n        </div>\n        <span style={styles.info}>{name}</span>\n        <div\n          style={styles.info}\n          // eslint-disable-next-line react/no-danger\n          dangerouslySetInnerHTML={{\n            __html: data.info && formatValueAsHTML(data.info.solvent),\n          }}\n        />\n        <span style={styles.info}>\n          <span\n            style={{\n              borderLeft: '0.55px solid #e5e5e5',\n              paddingRight: '5px',\n            }}\n          />\n          {data.info?.experiment}\n        </span>\n\n        {/* {data.info && data.info.solvent} */}\n        {/* </div> */}\n        <span style={styles.info}>{data.info?.pulse}</span>\n      </div>\n\n      <ShowHideMarkersButton\n        data={data}\n        style={{\n          ...styles.icon,\n          ...styles.button,\n        }}\n        onChangeMarkersVisibility={onChangeMarkersVisibility}\n        markersVisible={markersVisible}\n      />\n      <ColorIndicator\n        style={styles.button}\n        dimension={data.info.dimension}\n        color={{ positiveColor, color, negativeColor }}\n        activated={activated}\n        onClick={(event) => onOpenSettingModal(data, event)}\n      />\n    </div>\n  );\n}\n\nexport default memo(SpectrumListItem);\n","import { useFormikContext } from 'formik';\nimport lodashGet from 'lodash/get';\nimport { useCallback, memo } from 'react';\nimport { SketchPicker } from 'react-color';\n\nimport { COLORS } from '../../../data/utilities/getColor';\n\ninterface FormikColorPickerProps {\n  name: string;\n  onColorChange?: (element: any) => void;\n}\n\nfunction FormikColorPicker(props: FormikColorPickerProps) {\n  const { onColorChange = () => null, name } = props;\n\n  const { values, setFieldValue } = useFormikContext();\n\n  const colorchangeHandler = useCallback(\n    (color) => {\n      onColorChange(color);\n      setFieldValue(\n        name,\n        `${color.hex}${Math.round(color.rgb.a * 255).toString(16)}`,\n      );\n    },\n    [name, onColorChange, setFieldValue],\n  );\n\n  return (\n    <SketchPicker\n      color={{ hex: lodashGet(values, name, '#000') }}\n      presetColors={COLORS}\n      onChangeComplete={(e) => colorchangeHandler(e)}\n    />\n  );\n}\n\nexport default memo(FormikColorPicker);\n","import { xNoiseSanPlot } from 'ml-spectra-processing';\nimport { memo, useMemo } from 'react';\nimport { Axis, LineSeries, Legend, Heading, Plot } from 'react-plot';\n\nfunction prepareData(input) {\n  const length = input.length;\n  const jump = Math.floor(length / 307200) || 1;\n  const array = new Float64Array((length / jump) >> 0);\n  let index = 0;\n  for (let i = 0; i < array.length; i += jump) {\n    array[index++] = input[i];\n  }\n  return array;\n}\n\nfunction getLine(value, data, options) {\n  const { log10, abs } = Math;\n  const { yLogBase } = options;\n  const first = data.length > 0 ? data[0].x : 0;\n  const last = data.length > 0 ? data[data.length - 1].x : 0;\n  const inLogScale = log10(abs(value)) / log10(yLogBase);\n  return [\n    { x: first, y: inLogScale },\n    { x: last, y: inLogScale },\n  ];\n}\n\ninterface Spectrum1DHistogramProps {\n  color?: string;\n  data: any;\n  options?: any;\n}\n\nfunction Spectrum1DHistogram({\n  color = 'red',\n  data,\n  options = {},\n}: Spectrum1DHistogramProps) {\n  //factorStd = 5,\n  const { yLogBase = 2 } = options;\n  const processedData = useMemo(() => {\n    const input = prepareData(data.re);\n\n    const sanResult = xNoiseSanPlot(input, options);\n    const sanPlot: any = {};\n    const lines: any = {};\n    for (let plotKey in sanResult.sanplot) {\n      const { x, y } = sanResult.sanplot[plotKey];\n      let result = new Array(x.length);\n      for (let i = 0; i < x.length; i++) {\n        result[i] = { x: x[i], y: y[i] };\n      }\n      sanPlot[plotKey] = result;\n      lines[plotKey] = getLine(sanResult[plotKey], result, { yLogBase });\n    }\n    return { sanPlot, lines };\n  }, [data.re, options, yLogBase]);\n\n  return (\n    <div\n      style={{\n        display: 'flex',\n        flexDirection: 'column',\n        alignItems: 'center',\n        justifyContent: 'center',\n      }}\n    >\n      <div style={{ display: 'block' }}>\n        <Plot width={180} height={220}>\n          <Heading title=\"Sanplot\" />\n          <LineSeries\n            data={processedData.sanPlot.positive}\n            xAxis=\"x\"\n            yAxis=\"y\"\n            label=\"positive\"\n            lineStyle={{\n              stroke: color,\n              strokeWidth: 1.2,\n            }}\n            markerStyle={{\n              fill: color,\n              stroke: color,\n            }}\n          />\n          <LineSeries\n            data={processedData.lines.positive}\n            xAxis=\"x\"\n            yAxis=\"y\"\n            label=\"noise level\"\n            lineStyle={{\n              stroke: 'blue',\n              strokeWidth: 0.8,\n              strokeDasharray: '3, 3',\n            }}\n            markerStyle={{\n              fill: color,\n              stroke: color,\n            }}\n          />\n          <Axis\n            id=\"x\"\n            label=\"Pt\"\n            position=\"bottom\"\n            tickLabelStyle={{ fontSize: '0.6rem' }}\n            labelStyle={{ fontSize: '0.6rem' }}\n          />\n          <Axis\n            id=\"y\"\n            label={`Intensity [Log${yLogBase}]`}\n            position=\"left\"\n            tickLabelStyle={{ fontSize: '0.6rem' }}\n            labelStyle={{ fontSize: '0.7rem' }}\n          />\n          <Legend position=\"embedded\" bottom={5} right={60} />\n        </Plot>\n      </div>\n      <div style={{ display: 'block', width: 180, height: 180 }}>\n        <Plot width={180} height={180}>\n          <LineSeries\n            data={processedData.sanPlot.negative}\n            xAxis=\"x\"\n            yAxis=\"y\"\n            label=\"negative\"\n            lineStyle={{\n              stroke: color,\n              strokeWidth: 1.2,\n            }}\n            markerStyle={{\n              fill: color,\n              stroke: color,\n            }}\n          />\n\n          <LineSeries\n            data={processedData.lines.negative}\n            xAxis=\"x\"\n            yAxis=\"y\"\n            label=\"noise level\"\n            lineStyle={{\n              stroke: 'blue',\n              strokeWidth: 0.8,\n              strokeDasharray: '3, 3',\n            }}\n            markerStyle={{\n              fill: color,\n              stroke: color,\n            }}\n          />\n\n          <Axis\n            id=\"x\"\n            label=\"Pt\"\n            position=\"bottom\"\n            tickLabelStyle={{ fontSize: '0.6rem' }}\n            labelStyle={{ fontSize: '0.5rem' }}\n          />\n          <Axis\n            id=\"y\"\n            label={`Intensity [Log${yLogBase}]`}\n            position=\"left\"\n            tickLabelStyle={{ fontSize: '0.6rem' }}\n            labelStyle={{ fontSize: '0.7rem' }}\n          />\n          <Legend position=\"embedded\" bottom={5} right={60} />\n        </Plot>\n      </div>\n    </div>\n  );\n}\n\nexport default memo(Spectrum1DHistogram);\n","import { useCallback, useRef } from 'react';\n\nimport FormikColorPicker from '../../../../elements/formik/FormikColorPicker';\nimport FormikForm from '../../../../elements/formik/FormikForm';\n\nimport Spectrum1DHistogram from './Spectrum1DHistogram';\n\ninterface Spectrum1DSettingProps {\n  data: any;\n  onSubmit: (values: any, helpers: any) => void;\n}\n\nfunction Spectrum1DSetting({\n  data: SpectrumData,\n  onSubmit,\n}: Spectrum1DSettingProps) {\n  const refForm = useRef<any>(null);\n\n  const triggerSubmitHandler = useCallback(() => {\n    if (refForm.current) {\n      refForm.current.submitForm();\n    }\n  }, []);\n\n  return (\n    <FormikForm\n      ref={refForm}\n      initialValues={SpectrumData.display}\n      onSubmit={onSubmit}\n    >\n      <div style={{ display: 'flex', flexDirection: 'column', gap: '1.25rem' }}>\n        <div style={{ display: 'block', position: 'relative' }}>\n          <FormikColorPicker\n            name=\"color\"\n            onColorChange={triggerSubmitHandler}\n          />\n        </div>\n        <Spectrum1DHistogram color=\"red\" data={SpectrumData.data} />\n      </div>\n    </FormikForm>\n  );\n}\n\nexport default Spectrum1DSetting;\n","import { useFormikContext } from 'formik';\nimport lodashGet from 'lodash/get';\nimport { useCallback, memo } from 'react';\nimport ReactSlider from 'react-slider';\n\ninterface FormikSliderProps {\n  name: string;\n  onAfterChange?: (element: any) => void;\n}\n\nfunction FormikSlider(props: FormikSliderProps) {\n  const { onAfterChange = () => null, name, ...sliderProps } = props;\n\n  const { values, setFieldValue } = useFormikContext();\n\n  const changeHandler = useCallback(\n    (value) => {\n      onAfterChange(value);\n      setFieldValue(name, value);\n    },\n    [name, onAfterChange, setFieldValue],\n  );\n\n  return (\n    <ReactSlider\n      className=\"horizontal-slider\"\n      thumbClassName=\"thumb\"\n      trackClassName=\"track\"\n      defaultValue={lodashGet(values, name, [0, 100])}\n      onAfterChange={changeHandler}\n      renderThumb={(props, state) => (\n        <div {...props}>\n          <span>{state.valueNow}</span>\n        </div>\n      )}\n      pearling\n      minDistance={10}\n      {...sliderProps}\n    />\n  );\n}\n\nexport default memo(FormikSlider);\n","import { xNoiseSanPlot } from 'ml-spectra-processing';\nimport { memo, useMemo } from 'react';\nimport { Axis, LineSeries, Legend, Plot } from 'react-plot';\n\nfunction prepareData(matrix) {\n  let cols = matrix[0].length;\n  let rows = matrix.length;\n  let jump = Math.floor((cols * rows) / 204800) || 1;\n  const array = new Float64Array(((cols * rows) / jump) >> 0);\n  let index = 0;\n  for (let i = 0; i < array.length; i += jump) {\n    array[index++] = matrix[(i / rows) >> 0][i % rows];\n  }\n  return array;\n}\n\nfunction getLine(value, data, options) {\n  const { log10, abs } = Math;\n  const { yLogBase } = options;\n  const first = data.length > 0 ? data[0].x : 0;\n  const last = data.length > 0 ? data[data.length - 1].x : 0;\n  const inLogScale = log10(abs(value)) / log10(yLogBase);\n  return [\n    { x: first, y: inLogScale },\n    { x: last, y: inLogScale },\n  ];\n}\n\ninterface Spectrum2DHistogramProps {\n  color?: string;\n  data: any;\n  options?: any;\n}\n\nfunction Spectrum2DHistogram({\n  color = 'red',\n  data,\n  options = {},\n}: Spectrum2DHistogramProps) {\n  const { yLogBase = 2 } = options;\n\n  const processedData = useMemo(() => {\n    const input = prepareData(data.z);\n    const sanResult = xNoiseSanPlot(input, options);\n    const sanPlot: any = {};\n    const lines: any = {};\n    for (let plotKey in sanResult.sanplot) {\n      const { x, y } = sanResult.sanplot[plotKey];\n      let result = new Array(x.length);\n      for (let i = 0; i < x.length; i++) {\n        result[i] = { x: x[i], y: y[i] };\n      }\n      sanPlot[plotKey] = result;\n      lines[plotKey] = getLine(sanResult[plotKey], result, { yLogBase });\n    }\n    return { sanPlot, lines };\n  }, [data.z, options, yLogBase]);\n\n  return (\n    <div>\n      <div style={{ textAlign: 'center', paddingBottom: 5, paddingTop: 5 }}>\n        San Plot\n      </div>\n\n      <div\n        style={{\n          borderTop: '1px solid #ededed',\n          marginTop: '10px',\n          paddingTop: '10px',\n          display: 'flex',\n          flexDirection: 'row',\n        }}\n      >\n        <Plot width={220} height={180}>\n          <LineSeries\n            data={processedData.sanPlot.positive}\n            xAxis=\"x\"\n            yAxis=\"y\"\n            label=\"positive\"\n            lineStyle={{\n              stroke: color,\n              strokeWidth: 1.2,\n            }}\n            markerStyle={{\n              fill: color,\n              stroke: color,\n            }}\n          />\n          <LineSeries\n            data={processedData.lines.positive}\n            xAxis=\"x\"\n            yAxis=\"y\"\n            label=\"noise level\"\n            lineStyle={{\n              stroke: 'blue',\n              strokeWidth: 0.8,\n              strokeDasharray: '3, 3',\n            }}\n            markerStyle={{\n              fill: color,\n              stroke: color,\n            }}\n          />\n          <Axis\n            id=\"x\"\n            label=\"Pt\"\n            position=\"bottom\"\n            tickLabelStyle={{ fontSize: '0.6rem' }}\n            labelStyle={{ fontSize: '0.6rem' }}\n          />\n          <Axis\n            id=\"y\"\n            label={`Intensity [Log ${yLogBase}]`}\n            position=\"left\"\n            tickLabelStyle={{ fontSize: '0.6rem' }}\n            labelStyle={{ fontSize: '0.7rem' }}\n          />\n          <Legend position=\"embedded\" bottom={90} right={5} />\n        </Plot>\n\n        <Plot width={220} height={180}>\n          <LineSeries\n            data={processedData.sanPlot.negative}\n            xAxis=\"x\"\n            yAxis=\"y\"\n            label=\"negative\"\n            lineStyle={{\n              stroke: color,\n              strokeWidth: 1.2,\n            }}\n            markerStyle={{\n              fill: color,\n              stroke: color,\n            }}\n          />\n\n          <LineSeries\n            data={processedData.lines.negative}\n            xAxis=\"x\"\n            yAxis=\"y\"\n            label=\"noise level\"\n            lineStyle={{\n              stroke: 'blue',\n              strokeWidth: 0.8,\n              strokeDasharray: '3, 3',\n            }}\n            markerStyle={{\n              fill: color,\n              stroke: color,\n            }}\n          />\n\n          <Axis\n            id=\"x\"\n            label=\"Pt\"\n            position=\"bottom\"\n            tickLabelStyle={{ fontSize: '0.6rem' }}\n            labelStyle={{ fontSize: '0.5rem' }}\n          />\n          <Axis\n            id=\"y\"\n            position=\"left\"\n            tickLabelStyle={{ fontSize: '0.6rem' }}\n            labelStyle={{ fontSize: '0.7rem' }}\n          />\n          <Legend position=\"embedded\" bottom={90} right={5} />\n        </Plot>\n      </div>\n    </div>\n  );\n}\n\nexport default memo(Spectrum2DHistogram);\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback, useRef } from 'react';\n\nimport FormikColorPicker from '../../../../elements/formik/FormikColorPicker';\nimport FormikForm from '../../../../elements/formik/FormikForm';\nimport FormikInput from '../../../../elements/formik/FormikInput';\nimport FormikSlider from '../../../../elements/formik/FormikSlider';\n\nimport Spectrum2DHistogram from './Spectrum2DHistogram';\n\ninterface Spectrum2DSettingProps {\n  data: any;\n  onSubmit: (values: any, helpers: any) => void;\n}\n\nfunction Spectrum2DSetting({\n  data: SpectrumData,\n  onSubmit,\n}: Spectrum2DSettingProps) {\n  const refForm = useRef<any>(null);\n\n  const style = css`\n    .positive {\n      display: inline-block;\n      .track-1 {\n        background-color: ${SpectrumData.display.positiveColor} !important;\n      }\n    }\n    .negative {\n      display: inline-block;\n\n      .track-1 {\n        background-color: ${SpectrumData.display.negativeColor} !important;\n      }\n    }\n  `;\n\n  const triggerSubmitHandler = useCallback(() => {\n    refForm.current.submitForm();\n  }, []);\n\n  return (\n    <FormikForm\n      ref={refForm}\n      initialValues={SpectrumData.display}\n      onSubmit={onSubmit}\n    >\n      <div css={style}>\n        <div className=\"positive\">\n          <span style={{ padding: '0 10px' }}>Positive</span>\n          <FormikColorPicker\n            name=\"positiveColor\"\n            onColorChange={triggerSubmitHandler}\n          />\n          <div style={{ padding: '5px' }}>\n            <span className=\"label\">contour Levels [ min - max ]</span>\n            <FormikSlider\n              name=\"contourOptions.positive.contourLevels\"\n              onAfterChange={triggerSubmitHandler}\n            />\n            <span className=\"label\">number of Layers </span>\n            <FormikInput\n              name=\"contourOptions.positive.numberOfLayers\"\n              onChange={triggerSubmitHandler}\n              type=\"number\"\n            />\n          </div>\n        </div>\n        <div className=\"negative\">\n          <span style={{ padding: '0 10px' }}>Negative</span>\n          <FormikColorPicker\n            name=\"negativeColor\"\n            onColorChange={triggerSubmitHandler}\n          />\n          <div style={{ padding: '5px' }}>\n            <span className=\"label\">contour Levels [ min - max ]</span>\n            <FormikSlider\n              name=\"contourOptions.negative.contourLevels\"\n              onAfterChange={triggerSubmitHandler}\n            />\n            <span className=\"label\">number of Layers </span>\n            <FormikInput\n              name=\"contourOptions.negative.numberOfLayers\"\n              onChange={triggerSubmitHandler}\n              type=\"number\"\n            />\n          </div>\n        </div>\n        <Spectrum2DHistogram data={SpectrumData.data} />\n      </div>\n    </FormikForm>\n  );\n}\n\nexport default Spectrum2DSetting;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { memo, useCallback } from 'react';\n\nimport { useDispatch } from '../../../../context/DispatchContext';\nimport { CHANGE_SPECTRUM_SETTING } from '../../../../reducer/types/Types';\n\nimport Spectrum1DSetting from './Spectrum1DSetting';\nimport Spectrum2DSetting from './Spectrum2DSetting';\n\nconst style = css`\n  position: fixed;\n  z-index: 999999999;\n  width:100%;\n  height:100%;\n  left:0;\n  top:0;\n  .inner-conatiner{\n    position:absolute;\n    display: flex;\n    flex-direction: row-reverse;\n    border-radius: 4px;\n    background-color: white;\n    box-shadow: rgba(0, 0, 0, 0.15) 0px 0px 0px 1px,\n      rgba(0, 0, 0, 0.15) 0px 8px 16px;\n      overflow: auto;\n      height: 350px;\n  }\n\n\n  .sketch-picker {\n    border-radius: none !important;\n    box-shadow: none !important;\n  }\n\n\n  .horizontal-slider {\n    width: 80%;\n    height: 15px;\n  }\n\n  .thumb {\n    height: 15px;\n    line-height: 15px;\n    width: 20px;\n    text-align: center;\n    color: black;\n    border-radius: 5px;\n    cursor: grab;\n    font-size: 10px;\n    background-image: -webkit-linear-gradient(top, #f4f1ee, #fff);\n    background-image: linear-gradient(top, #f4f1ee, #fff);\n  }\n\n  .track {\n    top: 0;\n    bottom: 0;\n    background: #eaeaea;\n    border-radius: 999px;\n    border-radius: 5px;\n  }\n\n  .track-1 {\n    background: red;\n  }\n   \n  .label{\n    font-size: 12px;\n    margin: 8px 0;\n    display: block;\n  }\n \n  }\n`;\n\ninterface SpectrumSettingProps {\n  position: { x: number; y: number } | null;\n  data: any;\n  onClose: () => void;\n}\n\nfunction SpectrumSetting({ position, data, onClose }: SpectrumSettingProps) {\n  const dispatch = useDispatch();\n  const { id, info } = data;\n\n  const submitHandler = useCallback(\n    (values) => {\n      dispatch({ type: CHANGE_SPECTRUM_SETTING, id, display: values });\n    },\n    [dispatch, id],\n  );\n\n  const clickHandler = useCallback(\n    (e) => {\n      if (e.target === e.currentTarget) {\n        onClose();\n      }\n    },\n    [onClose],\n  );\n\n  if (!position) return null;\n  const { x, y } = position;\n\n  return (\n    <div css={style} onClick={clickHandler}>\n      <div\n        className=\"inner-conatiner\"\n        style={{\n          left: info.dimension === 2 ? x - 450 : x - 240,\n          width: info.dimension === 2 ? 450 : 240,\n          padding: info.dimension === 2 ? '10px 0' : '',\n          top: y,\n        }}\n      >\n        {info.dimension === 2 ? (\n          <Spectrum2DSetting onSubmit={submitHandler} data={data} />\n        ) : (\n          <Spectrum1DSetting onSubmit={submitHandler} data={data} />\n        )}\n      </div>\n    </div>\n  );\n}\n\nfunction arePropsEqual() {\n  return true;\n}\n\nexport default memo(SpectrumSetting, arePropsEqual);\n","import { useCallback, useState, useMemo, useRef, useEffect, memo } from 'react';\n\nimport { Datum1D } from '../../../data/types/data1d';\nimport { Datum2D } from '../../../data/types/data2d';\nimport checkModifierKeyActivated from '../../../data/utilities/checkModifierKeyActivated';\nimport { useChartData } from '../../context/ChartContext';\nimport { useDispatch } from '../../context/DispatchContext';\nimport ContextMenu from '../../elements/ContextMenu';\nimport Tab from '../../elements/Tab/Tab';\nimport Tabs from '../../elements/Tab/Tabs';\nimport { useAlert } from '../../elements/popup/Alert';\nimport { ActiveSpectrum } from '../../reducer/Reducer';\nimport {\n  CHANGE_PEAKS_MARKERS_VISIBILITY,\n  SET_ACTIVE_TAB,\n  CHANGE_VISIBILITY,\n  CHANGE_ACTIVE_SPECTRUM,\n  DELETE_SPECTRA,\n} from '../../reducer/types/Types';\nimport { copyTextToClipboard } from '../../utility/Export';\nimport GroupByInfoKey from '../../utility/GroupByInfoKey';\n\nimport SpectrumListItem from './SpectrumListItem';\nimport SpectrumSetting from './base/setting/SpectrumSetting';\n\ninterface TabChangeProps {\n  tab: string;\n  data: Array<Datum1D | Datum2D>;\n}\n\ninterface SpectrumsTabsProps {\n  onTabChange: (data: TabChangeProps) => void;\n}\ninterface SpectrumsTabsInnerProps extends SpectrumsTabsProps {\n  data: Array<Datum1D | Datum2D>;\n  activeTab: string;\n  activeSpectrum: ActiveSpectrum | null;\n}\n\nfunction SpectrumsTabsInner({\n  data,\n  activeSpectrum,\n  activeTab,\n  onTabChange,\n}: SpectrumsTabsInnerProps) {\n  const contextRef = useRef<any>();\n  const [markersVisible, setMarkersVisible] = useState<Array<{ id: string }>>(\n    [],\n  );\n  const [selectedSpectrumData, setSelectedSpectrum] = useState(null);\n  const [settingModalPosition, setSettingModalPosition] = useState<{\n    x: number;\n    y: number;\n  } | null>(null);\n  const [isSettingModalDisplayed, setIsSettingModalDisplayed] = useState(false);\n\n  const alert = useAlert();\n  const dispatch = useDispatch();\n\n  useEffect(() => {\n    if (data) {\n      const visibleMarkers = data.reduce((acc: any, datum) => {\n        if (\n          datum.info.dimension === 1 &&\n          (datum as Datum1D).display.isPeaksMarkersVisible === true\n        ) {\n          acc.push({ id: datum.id });\n        }\n        return acc;\n      }, []);\n\n      setMarkersVisible(visibleMarkers);\n    }\n  }, [data, dispatch]);\n\n  const spectrumsGroupByNucleus = useMemo(() => {\n    if (!data) return [];\n    const groupByNucleus = GroupByInfoKey('nucleus');\n    return groupByNucleus(data, true);\n  }, [data]);\n\n  useEffect(() => {\n    onTabChange({\n      tab: activeTab,\n      data: spectrumsGroupByNucleus[activeTab],\n    });\n  }, [activeTab, onTabChange, spectrumsGroupByNucleus]);\n\n  const handleChangeMarkersVisibility = useCallback(\n    (d) => {\n      const currentIndex = markersVisible.findIndex((v) => v.id === d.id);\n      const newChecked = [...markersVisible];\n      if (currentIndex === -1) {\n        newChecked.push({ id: d.id });\n      } else {\n        newChecked.splice(currentIndex, 1);\n      }\n      dispatch({ type: CHANGE_PEAKS_MARKERS_VISIBILITY, data: newChecked });\n      setMarkersVisible(newChecked);\n    },\n    [dispatch, markersVisible],\n  );\n\n  const onTabChangeHandler = useCallback(\n    (tab) => {\n      onTabChange({\n        tab: tab.tabid,\n        data: spectrumsGroupByNucleus[tab.tabid],\n      });\n\n      dispatch({ type: SET_ACTIVE_TAB, tab: tab.tabid });\n    },\n    [dispatch, onTabChange, spectrumsGroupByNucleus],\n  );\n\n  const contextMenu = useMemo(\n    () => [\n      {\n        label: 'Copy to Clipboard',\n        onClick: (spectrumData) => {\n          void (async () => {\n            const { x, y, info } = spectrumData;\n            const success = await copyTextToClipboard(\n              JSON.stringify({ x, y, info }, undefined, 2),\n            );\n\n            if (success) {\n              alert.success('Data copied to clipboard');\n            } else {\n              alert.error('Copy to clipboard failed');\n            }\n          })();\n        },\n      },\n      {\n        label: 'Delete',\n        onClick: (spectrumData) => {\n          setTimeout(() => {\n            dispatch({ type: DELETE_SPECTRA, id: spectrumData.id });\n          }, 0);\n        },\n      },\n    ],\n    [alert, dispatch],\n  );\n\n  const contextMenuHandler = useCallback(\n    (e, rowData) => {\n      if (!checkModifierKeyActivated(e)) {\n        e.preventDefault();\n        contextRef.current.handleContextMenu(e, rowData);\n      }\n    },\n    [contextRef],\n  );\n\n  const openSettingHandler = useCallback((selectedSpectrum, event) => {\n    setSettingModalPosition({\n      x: event.nativeEvent.clientX,\n      y: event.nativeEvent.clientY,\n    });\n    setSelectedSpectrum(selectedSpectrum);\n    setIsSettingModalDisplayed(true);\n  }, []);\n\n  const handleChangeVisibility = useCallback(\n    (d, key) => {\n      dispatch({\n        type: CHANGE_VISIBILITY,\n        id: d.id,\n        key,\n        value: !d.display[key],\n      });\n    },\n    [dispatch],\n  );\n\n  const handleChangeActiveSpectrum = useCallback(\n    (d) => {\n      setTimeout(() => {\n        if (activeSpectrum && activeSpectrum.id === d.id) {\n          dispatch({ type: CHANGE_ACTIVE_SPECTRUM, data: null });\n        } else {\n          dispatch({ type: CHANGE_ACTIVE_SPECTRUM, data: { id: d.id } });\n        }\n      }, 0);\n    },\n    [activeSpectrum, dispatch],\n  );\n\n  const mouseLeaveHandler = useCallback(() => {\n    setIsSettingModalDisplayed(false);\n  }, []);\n\n  return (\n    <div style={{ height: 'calc(100% - 25px)' }}>\n      <Tabs activeTab={activeTab} onClick={onTabChangeHandler}>\n        {spectrumsGroupByNucleus &&\n          Object.keys(spectrumsGroupByNucleus).map((group) => (\n            <Tab tablabel={group} tabid={group} key={group}>\n              {spectrumsGroupByNucleus[group]?.map((d) => (\n                <SpectrumListItem\n                  key={d.id}\n                  activeSpectrum={activeSpectrum}\n                  markersVisible={markersVisible}\n                  data={d}\n                  onChangeVisibility={handleChangeVisibility}\n                  onChangeMarkersVisibility={handleChangeMarkersVisibility}\n                  onChangeActiveSpectrum={handleChangeActiveSpectrum}\n                  onOpenSettingModal={openSettingHandler}\n                  onContextMenu={(e) => contextMenuHandler(e, d)}\n                />\n              ))}\n            </Tab>\n          ))}\n      </Tabs>\n      <ContextMenu ref={contextRef} context={contextMenu} />\n\n      {isSettingModalDisplayed ? (\n        <SpectrumSetting\n          onClose={mouseLeaveHandler}\n          data={selectedSpectrumData}\n          position={settingModalPosition}\n        />\n      ) : null}\n    </div>\n  );\n}\n\nconst MemoizedSpectra = memo(SpectrumsTabsInner);\n\nexport default function SpectrumsTabs({ onTabChange }: SpectrumsTabsProps) {\n  const { data, activeSpectrum, activeTab } = useChartData();\n\n  return (\n    <MemoizedSpectra {...{ data, activeSpectrum, activeTab, onTabChange }} />\n  );\n}\n","import { useCallback, memo, useState, CSSProperties } from 'react';\n\nimport SpectraPanelHeader from './SpectraPanelHeader';\nimport SpectrumsTabs from './SpectrumsTabs';\n\nconst styles: CSSProperties = {\n  overflow: 'hidden',\n  height: '100%',\n  display: 'flex',\n  flexDirection: 'column',\n  width: '100%',\n};\n\nfunction SpectrumListPanel() {\n  const [spectrums, setSpectrums] = useState<Array<any>>([]);\n\n  const tabChangeHandler = useCallback((e) => {\n    setSpectrums(e.data ? e.data : []);\n  }, []);\n\n  return (\n    <div style={styles}>\n      <SpectraPanelHeader spectrums={spectrums} />\n      <SpectrumsTabs onTabChange={tabChangeHandler} />\n    </div>\n  );\n}\n\nexport default memo(SpectrumListPanel);\n","import { FromTo } from 'cheminfo-types';\n\nexport interface DefaultPathLengthsInterface {\n  [key: string]: FromTo;\n}\n\nconst DefaultPathLengths: DefaultPathLengthsInterface = {\n  hmbc: { from: 2, to: 3 },\n  cosy: { from: 3, to: 4 },\n  hsqc: { from: 1, to: 1 },\n  hmqc: { from: 1, to: 1 },\n  inadequate: { from: 1, to: 1 },\n};\n\nexport default DefaultPathLengths;\n","import { FromTo } from 'cheminfo-types';\n\nimport DefaultPathLengths from '../../../../data/constants/DefaultPathLengths';\n\nfunction isDefaultPathLength(\n  pathLength: FromTo,\n  experimentType: string,\n): boolean {\n  return (\n    DefaultPathLengths[experimentType] &&\n    pathLength.from === DefaultPathLengths[experimentType].from &&\n    pathLength.to === DefaultPathLengths[experimentType].to\n  );\n}\n\nexport default isDefaultPathLength;\n","import { FromTo } from 'cheminfo-types';\nimport lodashCloneDeep from 'lodash/cloneDeep';\nimport lodashGet from 'lodash/get';\nimport {\n  addLink,\n  buildCorrelation,\n  buildLink,\n  getLinkDelta,\n  getLinkDim,\n  removeLink,\n  Correlation,\n  Link,\n} from 'nmr-correlation';\n\nimport DefaultPathLengths from '../../../../data/constants/DefaultPathLengths';\nimport { Datum2D } from '../../../../data/types/data2d';\nimport {\n  findSignal2D,\n  findSpectrum,\n} from '../../../../data/utilities/FindUtilities';\nimport { Spectra } from '../../../NMRium';\nimport isDefaultPathLength from '../../../modal/editZone/validation/isDefaultPathLength';\nimport { ActiveSpectrum } from '../../../reducer/Reducer';\nimport { DISPLAYER_MODE } from '../../../reducer/core/Constants';\nimport { ErrorColors } from '../CorrelationTable/Constants';\n\nfunction getAtomType(nucleus: string): string {\n  return nucleus.split(/\\d+/)[1];\n}\n\nfunction getLabelColor(correlationData, correlation) {\n  const error = lodashGet(\n    correlationData,\n    `state.${correlation.atomType}.error`,\n    null,\n  );\n\n  if (error) {\n    for (let { key, color } of ErrorColors) {\n      if (\n        key !== 'incomplete' && // do not consider this for a single atom type\n        (key === 'notAttached' || key === 'ambiguousAttachment') &&\n        lodashGet(error, `${key}`, []).some(\n          (index) => correlationData.values[index].id === correlation.id,\n        )\n      ) {\n        return color;\n      }\n    }\n  }\n\n  return null;\n}\n\nfunction findSignalMatch1D(\n  spectrum: Datum2D,\n  link: Link,\n  factor: number,\n  xDomain0: number,\n  xDomain1: number,\n) {\n  if (spectrum && spectrum.info.dimension === 2) {\n    const signal = findSignal2D(spectrum, link.signal.id);\n    if (signal) {\n      const otherAxis = link.axis === 'x' ? 'y' : 'x';\n      const delta = signal[otherAxis]?.delta;\n      if (delta !== undefined) {\n        return delta * factor >= xDomain0 && delta * factor <= xDomain1;\n      }\n    }\n  }\n  return false;\n}\n\nfunction findSignalMatch2D(\n  spectrum: Datum2D,\n  link: Link,\n  factor: number,\n  xDomain0: number,\n  xDomain1: number,\n  yDomain0: number,\n  yDomain1: number,\n): boolean {\n  if (spectrum && spectrum.info.dimension === 2) {\n    const signal = findSignal2D(spectrum, link.signal.id);\n    if (signal?.x.delta && signal?.y.delta) {\n      return (\n        signal.x.delta * factor >= xDomain0 &&\n        signal.x.delta * factor <= xDomain1 &&\n        signal.y.delta * factor >= yDomain0 &&\n        signal.y.delta * factor <= yDomain1\n      );\n    }\n  }\n  return false;\n}\n\nfunction getAbbreviation(link: Link): string {\n  let abbreviation = 'X';\n  if (link.experimentType === 'hsqc' || link.experimentType === 'hmqc') {\n    abbreviation =\n      !link.signal || link.signal.sign === 0\n        ? 'S'\n        : `S${link.signal.sign === 1 ? '+' : '-'}`;\n  } else if (\n    link.experimentType === 'hmbc' ||\n    link.experimentType === 'cosy' ||\n    link.experimentType === 'tocsy'\n  ) {\n    abbreviation = 'M';\n  } else if (\n    link.experimentType === 'noesy' ||\n    link.experimentType === 'roesy'\n  ) {\n    abbreviation = 'NOE';\n  } else if (link.experimentType === 'inadequate') {\n    abbreviation = 'I';\n  } else if (link.experimentType === 'adequate') {\n    abbreviation = 'A';\n  }\n\n  const pathLength: FromTo | undefined = link.signal.j?.pathLength;\n  if (pathLength) {\n    const isDefaultCorrelation =\n      DefaultPathLengths[link.experimentType] &&\n      pathLength.from >= DefaultPathLengths[link.experimentType].from &&\n      pathLength.from <= DefaultPathLengths[link.experimentType].to &&\n      pathLength.to >= DefaultPathLengths[link.experimentType].from &&\n      pathLength.to <= DefaultPathLengths[link.experimentType].to;\n\n    return `${abbreviation}${isDefaultCorrelation ? '' : '*'}`;\n  }\n\n  return abbreviation;\n}\n\nfunction buildNewLink1D(link) {\n  return buildLink({\n    ...link,\n    edited: {\n      ...link.edited,\n      moved: true,\n    },\n  });\n}\n\nfunction buildNewLink2D(link: Link, axis: 'x' | 'y') {\n  const linkIDs = link.id.split('_');\n  return buildLink({\n    ...link,\n    id: linkIDs[axis === 'x' ? 0 : 1],\n    axis,\n    match: [],\n    edited: {\n      ...link.edited,\n      moved: true,\n    },\n  });\n}\n\nfunction cloneCorrelationAndEditLink(\n  correlation: Correlation,\n  link: Link,\n  axis: 'x' | 'y',\n  action: 'add' | 'remove' | 'unmove',\n): Correlation {\n  const linkDim = getLinkDim(link);\n  const _correlation = lodashCloneDeep(correlation);\n  const split = link.id.split('_');\n  if (action === 'add') {\n    addLink(\n      _correlation,\n      linkDim === 1 ? buildNewLink1D(link) : buildNewLink2D(link, axis),\n    );\n  } else if (action === 'remove' || action === 'unmove') {\n    removeLink(_correlation, axis === 'x' ? split[0] : split[1]);\n  }\n\n  return _correlation;\n}\n\nfunction getEditedCorrelations({\n  correlationDim1,\n  correlationDim2,\n  selectedCorrelationIdDim1,\n  selectedCorrelationIdDim2,\n  action,\n  link,\n  correlations,\n}: {\n  correlationDim1: Correlation;\n  correlationDim2: Correlation;\n  action: 'move' | 'remove' | 'unmove' | 'setPathLength';\n  selectedCorrelationIdDim1: string | undefined;\n  selectedCorrelationIdDim2: string | undefined;\n  link: Link;\n  correlations: Correlation[];\n}) {\n  const selectedCorrelationDim1 = correlations.find(\n    (correlation) => correlation.id === selectedCorrelationIdDim1,\n  );\n  const selectedCorrelationDim2 = correlations.find(\n    (correlation) => correlation.id === selectedCorrelationIdDim2,\n  );\n  const hasChangedDim1 = selectedCorrelationDim1?.id !== correlationDim1.id;\n  const hasChangedDim2 =\n    correlationDim2 && selectedCorrelationDim2?.id !== correlationDim2?.id;\n  const linkDim = getLinkDim(link);\n\n  const editedCorrelations: Correlation[] = [];\n  const buildCorrelationDataOptions: {\n    skipDataUpdate?: boolean;\n  } = {};\n\n  if (action === 'move') {\n    if (linkDim === 1) {\n      // modify current cell correlation\n      const _correlationDim1 = cloneCorrelationAndEditLink(\n        correlationDim1,\n        link,\n        'x',\n        'remove',\n      );\n      // modify selected correlation\n      let newCorrelationDim1: Correlation;\n      if (selectedCorrelationDim1) {\n        newCorrelationDim1 = cloneCorrelationAndEditLink(\n          hasChangedDim1 ? selectedCorrelationDim1 : _correlationDim1,\n          link,\n          'x',\n          'add',\n        );\n      } else {\n        newCorrelationDim1 = buildCorrelation({\n          atomType: correlationDim1.atomType,\n          link: [buildNewLink1D(link)],\n        });\n      }\n      editedCorrelations.push(_correlationDim1, newCorrelationDim1);\n      buildCorrelationDataOptions.skipDataUpdate = true;\n    } else if (linkDim === 2) {\n      // modify current cell correlations\n      const _correlationDim1 = cloneCorrelationAndEditLink(\n        correlationDim1,\n        link,\n        'x',\n        'remove',\n      );\n      editedCorrelations.push(_correlationDim1);\n      const _correlationDim2 = cloneCorrelationAndEditLink(\n        correlationDim2,\n        link,\n        'y',\n        'remove',\n      );\n      editedCorrelations.push(_correlationDim2);\n\n      // modify selected correlations\n      if (selectedCorrelationDim1 && selectedCorrelationDim2) {\n        editedCorrelations.push(\n          cloneCorrelationAndEditLink(\n            hasChangedDim1 ? selectedCorrelationDim1 : _correlationDim1,\n            link,\n            'x',\n            'add',\n          ),\n        );\n        editedCorrelations.push(\n          cloneCorrelationAndEditLink(\n            hasChangedDim2 ? selectedCorrelationDim2 : _correlationDim2,\n            link,\n            'y',\n            'add',\n          ),\n        );\n      } else if (\n        selectedCorrelationDim1 &&\n        selectedCorrelationIdDim2 === 'new'\n      ) {\n        editedCorrelations.push(\n          cloneCorrelationAndEditLink(\n            hasChangedDim1 ? selectedCorrelationDim1 : _correlationDim1,\n            link,\n            'x',\n            'add',\n          ),\n        );\n        editedCorrelations.push(\n          buildCorrelation({\n            atomType: correlationDim2.atomType,\n            link: [buildNewLink2D(link, 'y')],\n          }),\n        );\n      } else if (\n        selectedCorrelationIdDim1 === 'new' &&\n        selectedCorrelationDim2\n      ) {\n        editedCorrelations.push(\n          buildCorrelation({\n            atomType: correlationDim1.atomType,\n            link: [buildNewLink2D(link, 'x')],\n          }),\n        );\n        editedCorrelations.push(\n          cloneCorrelationAndEditLink(\n            hasChangedDim2 ? selectedCorrelationDim2 : _correlationDim2,\n            link,\n            'y',\n            'add',\n          ),\n        );\n      } else if (\n        selectedCorrelationIdDim1 === 'new' &&\n        selectedCorrelationIdDim2 === 'new'\n      ) {\n        editedCorrelations.push(\n          buildCorrelation({\n            atomType: correlationDim1.atomType,\n            link: [buildNewLink2D(link, 'x')],\n          }),\n        );\n        editedCorrelations.push(\n          buildCorrelation({\n            atomType: correlationDim2.atomType,\n            link: [buildNewLink2D(link, 'y')],\n          }),\n        );\n      }\n      buildCorrelationDataOptions.skipDataUpdate = true;\n    }\n  } else if (action === 'remove') {\n    const _correlationDim1 = cloneCorrelationAndEditLink(\n      correlationDim1,\n      link,\n      'x',\n      'remove',\n    );\n    editedCorrelations.push(_correlationDim1);\n    if (getLinkDim(link) === 2) {\n      const _correlationDim2 = cloneCorrelationAndEditLink(\n        correlationDim2,\n        link,\n        'y',\n        'remove',\n      );\n      editedCorrelations.push(_correlationDim2);\n    }\n  } else if (action === 'unmove') {\n    if (linkDim === 1) {\n      if (selectedCorrelationDim1) {\n        editedCorrelations.push(\n          cloneCorrelationAndEditLink(\n            selectedCorrelationDim1,\n            link,\n            'x',\n            'unmove',\n          ),\n        );\n      }\n    } else if (linkDim === 2) {\n      if (selectedCorrelationDim1 && selectedCorrelationDim2) {\n        editedCorrelations.push(\n          cloneCorrelationAndEditLink(\n            selectedCorrelationDim1,\n            link,\n            'x',\n            'unmove',\n          ),\n        );\n        editedCorrelations.push(\n          cloneCorrelationAndEditLink(\n            selectedCorrelationDim2,\n            link,\n            'y',\n            'unmove',\n          ),\n        );\n      }\n    }\n  } else if (action === 'setPathLength') {\n    editedCorrelations.push(\n      cloneCorrelationAndSetPathLength(correlationDim1, link, 'x'),\n    );\n    editedCorrelations.push(\n      cloneCorrelationAndSetPathLength(correlationDim2, link, 'y'),\n    );\n  }\n\n  return { editedCorrelations, buildCorrelationDataOptions };\n}\n\nfunction cloneCorrelationAndSetPathLength(\n  correlation: Correlation,\n  editedLink: Link,\n  axis: 'x' | 'y',\n): Correlation {\n  const _correlation = lodashCloneDeep(correlation);\n  const linkDim = getLinkDim(editedLink);\n  if (linkDim === 2) {\n    const editedLinkID = editedLink.id.split('_')[axis === 'x' ? 0 : 1];\n    const _link = _correlation.link.find((link) => link.id === editedLinkID);\n    if (_link) {\n      const newPathLength: FromTo = editedLink.signal.j?.pathLength;\n      // remove (previous) pathLength if it is same as default\n      if (isDefaultPathLength(newPathLength, _link.experimentType)) {\n        delete _link.signal.j?.pathLength;\n        if (_link.signal.j && Object.keys(_link.signal.j).length === 0) {\n          delete _link.signal.j;\n        }\n        delete _link.edited.pathLength;\n      } else {\n        if (!_link.signal.j) {\n          _link.signal.j = { pathLength: newPathLength };\n        } else {\n          _link.signal.j.pathLength = newPathLength;\n        }\n        _link.edited.pathLength = true;\n      }\n    }\n  }\n\n  return _correlation;\n}\n\nfunction convertValuesString(\n  valuesString: string,\n  key: 'protonsCount' | 'hybridization',\n): number[] {\n  valuesString = valuesString\n    .toLowerCase()\n    .replace(/\\s+/g, '')\n    .split(',')\n    .map((token) => (token === 'sp' ? 'sp1' : token))\n    .join(',');\n  valuesString = valuesString.replaceAll('sp', '');\n\n  let values: number[] = [];\n  const regex = /^(?:[0-9],{0,1})+$/g;\n  if (regex.test(valuesString)) {\n    // allow digits followed by optional comma only\n    values = valuesString\n      .split(',')\n      .filter((char) => char.length > 0)\n      .map((char) => Number(char));\n  }\n\n  // allow key specific values only\n  // protonsCount: [0, 1, 2, 3, ...], hybridization: [1, 2, 3]\n  values = values.filter(\n    (value) =>\n      value >= (key === 'protonsCount' ? 0 : 1) &&\n      (key === 'protonsCount' || value <= 3),\n  );\n\n  // unique values\n  return values.filter((index, i, a) => a.indexOf(index) === i);\n}\n\nfunction isInView(\n  spectraData: Spectra,\n  activeTab: string,\n  activeSpectrum: ActiveSpectrum | null,\n  xDomain: number[],\n  yDomain: number[],\n  displayerMode: string,\n  correlation: Correlation,\n): boolean {\n  if (correlation.pseudo === true) {\n    return false;\n  }\n\n  if (\n    activeSpectrum === null ||\n    !correlation.link.some((link) => link.experimentID === activeSpectrum.id)\n  ) {\n    return false;\n  }\n\n  const atomTypesInView = activeTab.split(',').map((tab) => getAtomType(tab));\n\n  const factor = 10000;\n  const xDomain0 = xDomain[0] * factor;\n  const xDomain1 = xDomain[1] * factor;\n  const yDomain0 = yDomain[0] * factor;\n  const yDomain1 = yDomain[1] * factor;\n\n  if (displayerMode === DISPLAYER_MODE.DM_1D) {\n    const firstLink1D = correlation.link.find((link) => getLinkDim(link) === 1);\n    if (!firstLink1D) {\n      return false;\n    }\n    let delta = getLinkDelta(firstLink1D);\n    if (delta === undefined) {\n      return false;\n    }\n    delta *= factor;\n    const spectrum = findSpectrum(spectraData, firstLink1D.experimentID, true);\n    if (\n      spectrum &&\n      atomTypesInView[0] === correlation.atomType &&\n      delta >= xDomain0 &&\n      delta <= xDomain1\n    ) {\n      return true;\n    }\n    // try to find a link which contains the belonging 2D signal in the spectra in view\n    if (\n      correlation.link.some((link) => {\n        const spectrum = findSpectrum(\n          spectraData,\n          link.experimentID,\n          true,\n        ) as Datum2D;\n        return findSignalMatch1D(spectrum, link, factor, xDomain0, xDomain1);\n      })\n    ) {\n      return true;\n    }\n  } else if (displayerMode === DISPLAYER_MODE.DM_2D) {\n    if (!atomTypesInView.includes(correlation.atomType)) {\n      return false;\n    }\n    const firstLink2D = correlation.link.find((link) => getLinkDim(link) === 2);\n    if (!firstLink2D) {\n      return false;\n    }\n    const spectrum = findSpectrum(\n      spectraData,\n      firstLink2D.experimentID,\n      true,\n    ) as Datum2D;\n    // correlation is represented by a 2D signal\n    if (\n      findSignalMatch2D(\n        spectrum,\n        firstLink2D,\n        factor,\n        xDomain0,\n        xDomain1,\n        yDomain0,\n        yDomain1,\n      )\n    ) {\n      return true;\n    } else {\n      // try to find a link which contains the belonging 2D signal in the spectra in view\n      if (\n        correlation.link.some((link) => {\n          const spectrum = findSpectrum(\n            spectraData,\n            link.experimentID,\n            true,\n          ) as Datum2D;\n          return findSignalMatch2D(\n            spectrum,\n            link,\n            factor,\n            xDomain0,\n            xDomain1,\n            yDomain0,\n            yDomain1,\n          );\n        })\n      ) {\n        return true;\n      }\n    }\n  }\n  // do not show correlation\n  return false;\n}\n\nexport {\n  buildNewLink1D,\n  buildNewLink2D,\n  cloneCorrelationAndEditLink,\n  convertValuesString,\n  findSignalMatch1D,\n  findSignalMatch2D,\n  getAbbreviation,\n  getAtomType,\n  getEditedCorrelations,\n  getLabelColor,\n  isInView,\n};\n","import { Correlation } from 'nmr-correlation';\nimport { useMemo } from 'react';\n\nimport { useChartData } from '../../../context/ChartContext';\n\nimport { isInView } from './Utilities';\n\ninterface InputProps {\n  correlation: Correlation;\n}\n\nfunction IsInView({ correlation }: InputProps) {\n  const {\n    data: spectraData,\n    xDomain,\n    yDomain,\n    displayerMode,\n    activeTab,\n    activeSpectrum,\n  } = useChartData();\n\n  return useMemo(\n    () =>\n      isInView(\n        spectraData,\n        activeTab,\n        activeSpectrum,\n        xDomain,\n        yDomain,\n        displayerMode,\n        correlation,\n      ),\n    [\n      activeSpectrum,\n      activeTab,\n      correlation,\n      displayerMode,\n      spectraData,\n      xDomain,\n      yDomain,\n    ],\n  );\n}\n\nexport default IsInView;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback } from 'react';\n\nconst styles = css`\n  margin-top: 10px;\n  padding: 5px;\n  text-align: center;\n\n  p {\n    font-size: 14px;\n  }\n\n  button:focus {\n    outline: none;\n  }\n\n  button {\n    flex: 2;\n    padding: 5px;\n    border: 1px solid gray;\n    border-radius: 5px;\n    height: 30px;\n    margin: 0 auto;\n    margin-top: 15px;\n    display: block;\n    width: 90px;\n\n    color: white;\n    background-color: gray;\n  }\n`;\n\ninterface EditLinkConfirmationProps {\n  description: string;\n  onConfirm: () => void;\n}\n\nfunction EditLinkConfirmation({\n  description,\n  onConfirm,\n}: EditLinkConfirmationProps) {\n  const handleOnConfirm = useCallback(\n    (e) => {\n      e.preventDefault();\n      e.stopPropagation();\n\n      onConfirm();\n    },\n    [onConfirm],\n  );\n\n  return (\n    <div css={styles}>\n      <p>{description}</p>\n      <button type=\"button\" onClick={handleOnConfirm}>\n        Confirm\n      </button>\n    </div>\n  );\n}\n\nexport default EditLinkConfirmation;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { FromTo } from 'cheminfo-types';\nimport { useCallback, useEffect, useState } from 'react';\n\nimport DefaultPathLengths from '../../../../../data/constants/DefaultPathLengths';\nimport { Signal2D } from '../../../../../data/types/data2d';\nimport Button from '../../../../elements/Button';\nimport Input from '../../../../elements/Input';\nimport Label from '../../../../elements/Label';\n\nconst editPathLengthsStyles = css`\n  width: 100%;\n  height: 100%;\n  margin-top: 10px;\n  text-align: center;\n\n  .input-container {\n    width: 100%;\n    margin-top: 5px;\n    text-align: center;\n\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n  }\n\n  button {\n    flex: 2;\n    padding: 5px;\n    border: 1px solid gray;\n    border-radius: 5px;\n    height: 30px;\n    margin: 0 auto;\n    margin-top: 15px;\n    display: block;\n    width: 60px;\n\n    color: white;\n    background-color: gray;\n  }\n\n  .warning {\n    margin-top: 5px;\n    color: red;\n  }\n`;\n\ninterface InputProps {\n  signal: Signal2D;\n  experimentType: string;\n  onEdit: (editedSignal: Signal2D) => void;\n}\n\nfunction EditPathLength({ signal, experimentType, onEdit }: InputProps) {\n  const [from, setFrom] = useState<number>(\n    signal.j?.pathLength !== undefined\n      ? (signal.j.pathLength as FromTo).from\n      : DefaultPathLengths[experimentType]?.from || 0,\n  );\n  const [to, setTo] = useState<number>(\n    signal.j?.pathLength !== undefined\n      ? (signal.j.pathLength as FromTo).to\n      : DefaultPathLengths[experimentType]?.to || 0,\n  );\n  const [isError, setIsError] = useState<boolean>(false);\n\n  const handleOnEdit = useCallback(() => {\n    const pathLength: FromTo = {\n      from,\n      to,\n    };\n    const editedSignal: Signal2D = {\n      ...signal,\n      j: {\n        ...signal.j,\n        pathLength,\n      },\n    };\n\n    onEdit(editedSignal);\n  }, [to, from, onEdit, signal]);\n\n  useEffect(() => {\n    setIsError(from <= 0 || from > to);\n  }, [to, from]);\n\n  return (\n    <div css={editPathLengthsStyles}>\n      <p>Setting of the minimum and maximum path length (J coupling).</p>\n      <div className=\"input-container\">\n        <Label\n          title=\"Min:\"\n          style={{\n            label: {\n              marginRight: '5px',\n              fontSize: '14px',\n              fontWeight: 'normal',\n            },\n          }}\n        >\n          <Input\n            type=\"number\"\n            value={from}\n            onChange={(e) => {\n              setFrom(Number(e.target.value));\n            }}\n            style={{ input: { color: isError ? 'red' : 'black' } }}\n          />\n        </Label>\n        <Label\n          title=\"Max:\"\n          style={{\n            label: {\n              marginRight: '5px',\n              fontSize: '14px',\n              fontWeight: 'normal',\n            },\n          }}\n        >\n          <Input\n            type=\"number\"\n            value={to}\n            onChange={(e) => {\n              setTo(Number(e.target.value));\n            }}\n          />\n        </Label>\n      </div>\n      {isError ? (\n        <p className=\"warning\">\n          Minimum must not be 0 or higher than the maximum value.{' '}\n        </p>\n      ) : (\n        <Button type=\"button\" onClick={handleOnEdit} disabled={isError}>\n          Set\n        </Button>\n      )}\n    </div>\n  );\n}\n\nexport default EditPathLength;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { getCorrelationDelta, Correlation, Link } from 'nmr-correlation';\nimport { useCallback, useState } from 'react';\n\nimport Select from '../../../../elements/Select';\n\nconst moveLinkStyles = css`\n  width: 100%;\n  height: 100%;\n  margin-top: 10px;\n  text-align: center;\n\n  p {\n    font-size: 14px;\n  }\n\n  .selection-container {\n    margin-top: 10px;\n    width: 100%;\n    text-align: center;\n  }\n\n  button {\n    flex: 2;\n    padding: 5px;\n    border: 1px solid gray;\n    border-radius: 5px;\n    height: 30px;\n    margin: 0 auto;\n    margin-top: 15px;\n    display: block;\n    width: 60px;\n\n    color: white;\n    background-color: gray;\n  }\n`;\n\ninterface MoveLinkProps {\n  correlationDim1: Correlation;\n  correlationDim2: Correlation;\n  link: Link;\n  correlations: Correlation[];\n  onEdit: (\n    correlationIdDim1: string,\n    correlationIdDim2: string | undefined,\n  ) => void;\n}\n\nfunction MoveLink({\n  correlationDim1,\n  correlationDim2,\n  link,\n  correlations,\n  onEdit,\n}: MoveLinkProps) {\n  const [selectedCorrelationIdDim1, setSelectedCorrelationIdDim1] =\n    useState<string>(correlationDim1.id);\n  const [selectedCorrelationIdDim2, setSelectedCorrelationIdDim2] =\n    useState<string>(correlationDim2?.id || undefined);\n\n  function getCorrelationLabel(correlation: Correlation) {\n    const delta = getCorrelationDelta(correlation);\n    return `${delta ? delta.toFixed(2) : '?'}`;\n  }\n\n  const getSelection = useCallback(\n    (correlation: Correlation, dim: 0 | 1) => {\n      const selectionData = correlations.reduce((arr, _correlation) => {\n        if (\n          _correlation.pseudo === false &&\n          _correlation.atomType === link.atomType[dim]\n        ) {\n          arr.push({\n            key: _correlation.id,\n            value: _correlation.id,\n            label: `${_correlation.label.origin}: ${getCorrelationLabel(\n              _correlation,\n            )}`,\n          });\n        }\n        return arr;\n      }, []);\n      selectionData.push({\n        key: 'new',\n        value: 'new',\n        label: `new -> ${(\n          (dim === 0\n            ? getCorrelationDelta(correlationDim1)\n            : getCorrelationDelta(correlationDim2)) as number\n        ).toFixed(2)}`,\n      });\n\n      return (\n        <Select\n          onChange={(selection: string) => {\n            if (dim === 0) {\n              setSelectedCorrelationIdDim1(selection);\n            } else {\n              setSelectedCorrelationIdDim2(selection);\n            }\n          }}\n          data={selectionData}\n          defaultValue={correlation.id}\n          style={{\n            width: 110,\n            height: 25,\n            margin: 0,\n            border: '1px solid grey',\n          }}\n        />\n      );\n    },\n    [correlationDim1, correlationDim2, correlations, link.atomType],\n  );\n\n  return (\n    <div css={moveLinkStyles}>\n      <p>Move of signals on either one or both axes.</p>\n      <p>&quot;New&quot; means to separate into a new row or column.</p>\n      <div className=\"selection-container\">\n        {getSelection(correlationDim1, 0)}\n        {correlationDim2 && getSelection(correlationDim2, 1)}\n      </div>\n      <button\n        type=\"button\"\n        onClick={() =>\n          onEdit(selectedCorrelationIdDim1, selectedCorrelationIdDim2)\n        }\n      >\n        Move\n      </button>\n    </div>\n  );\n}\n\nexport default MoveLink;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { getLinkDim, Link } from 'nmr-correlation';\nimport { useCallback, useMemo, useState } from 'react';\n\nimport CloseButton from '../../../../elements/CloseButton';\nimport Tab from '../../../../elements/Tab/Tab';\nimport Tabs, { PositionsEnum } from '../../../../elements/Tab/Tabs';\nimport { getEditedCorrelations } from '../../utilities/Utilities';\n\nimport EditLinkConfirmation from './Confirmation';\nimport EditPathLength from './EditPathLength';\nimport MoveLink from './MoveLink';\n\nconst modalContainer = css`\n  width: 490px;\n  height: 220px;\n  padding: 5px;\n\n  button:focus {\n    outline: none;\n  }\n\n  .header {\n    height: 24px;\n    border-bottom: 1px solid #f0f0f0;\n    display: flex;\n    align-items: center;\n\n    button {\n      height: 36px;\n      margin: 2px;\n      background-color: transparent;\n      border: none;\n      svg {\n        height: 16px;\n      }\n    }\n\n    p {\n      font-weight: bold;\n\n      margin-bottom: 5px;\n      margin-right: 30px;\n      padding: 0px 10px;\n      width: 100%;\n\n      text-align: center;\n    }\n  }\n\n  button {\n    flex: 2;\n    padding: 5px;\n    border: 1px solid gray;\n    border-radius: 5px;\n    height: 30px;\n    margin: 0 auto;\n    margin-top: 15px;\n    display: block;\n    width: 20%;\n\n    color: white;\n    background-color: gray;\n  }\n\n  .tabs-container {\n    width: 100%;\n    flex: 1;\n    overflow: auto;\n    border: none;\n  }\n`;\n\nexport default function EditLinkModal({\n  correlationDim1,\n  correlationDim2,\n  link,\n  correlations,\n  onClose,\n  onEdit,\n}) {\n  const [activeTab, setActiveTab] = useState<string>('move');\n\n  const getLinkLabel = useCallback(() => {\n    const linkDim = getLinkDim(link);\n    if (linkDim === 1) {\n      return ` 1D (${link.signal.delta.toFixed(3)})`;\n    } else if (linkDim === 2) {\n      return `${link.signal.x ? `${link.signal.x.delta.toFixed(2)}` : '?'} (${\n        correlationDim1.label.origin\n      }), ${link.signal.y ? link.signal.y.delta.toFixed(2) : '?'} (${\n        correlationDim2.label.origin\n      })`;\n    }\n\n    return '';\n  }, [correlationDim1.label.origin, link, correlationDim2]);\n\n  const handleOnEdit = useCallback(\n    (\n      action: 'move' | 'remove' | 'unmove' | 'setPathLength',\n      selectedCorrelationIdDim1: string | undefined,\n      selectedCorrelationIdDim2: string | undefined,\n      editedLink?: Link,\n    ) => {\n      const { editedCorrelations, buildCorrelationDataOptions } =\n        getEditedCorrelations({\n          correlationDim1,\n          correlationDim2,\n          selectedCorrelationIdDim1,\n          selectedCorrelationIdDim2,\n          action,\n          link: editedLink || link,\n          correlations,\n        });\n      onEdit(\n        editedCorrelations,\n        action,\n        editedLink || link,\n        buildCorrelationDataOptions,\n      );\n\n      onClose?.();\n    },\n    [correlationDim1, correlationDim2, correlations, link, onClose, onEdit],\n  );\n\n  const tabsContainer = useMemo(\n    () => (\n      <div className=\"tabs-container\">\n        <Tabs\n          position={PositionsEnum.TOP}\n          activeTab={activeTab}\n          onClick={(tab) => setActiveTab(tab.tabid)}\n        >\n          <Tab tablabel=\"Move\" tabid={'move'}>\n            <MoveLink\n              correlationDim1={correlationDim1}\n              correlationDim2={correlationDim2}\n              link={link}\n              correlations={correlations}\n              onEdit={(correlationIdDim1, correlationIdDim2) =>\n                handleOnEdit('move', correlationIdDim1, correlationIdDim2)\n              }\n            />\n          </Tab>\n          <Tab tablabel=\"Unmove\" tabid=\"unmove\">\n            <EditLinkConfirmation\n              description=\"Movement of signal to its original place.\"\n              onConfirm={() =>\n                handleOnEdit('unmove', correlationDim1.id, correlationDim2.id)\n              }\n            />\n          </Tab>\n          <Tab tablabel=\"Remove\" tabid={'remove'}>\n            <EditLinkConfirmation\n              description=\"Deletion of signal.\"\n              onConfirm={() => handleOnEdit('remove', undefined, undefined)}\n            />\n          </Tab>\n          <Tab tablabel=\"J Coupling\" tabid={'setPathLength'}>\n            <EditPathLength\n              signal={link.signal}\n              experimentType={link.experimentType}\n              onEdit={(editedSignal) => {\n                const editedLink = { ...link, signal: editedSignal };\n                handleOnEdit(\n                  'setPathLength',\n                  correlationDim1,\n                  correlationDim2,\n                  editedLink,\n                );\n              }}\n            />\n          </Tab>\n        </Tabs>\n      </div>\n    ),\n    [\n      activeTab,\n      correlationDim1,\n      correlationDim2,\n      correlations,\n      handleOnEdit,\n      link,\n    ],\n  );\n\n  return (\n    <div css={modalContainer}>\n      <div className=\"header handle\">\n        <CloseButton onClick={onClose} />\n        <p className=\"header-info\">{`${link.experimentType.toUpperCase()} signal at ${getLinkLabel()}`}</p>\n      </div>\n      {tabsContainer}\n    </div>\n  );\n}\n","/** @jsxImportSource @emotion/react */\nimport { getCorrelationDelta, getLinkDim } from 'nmr-correlation';\nimport { useCallback, useMemo, useRef } from 'react';\n\nimport { buildID } from '../../../../data/utilities/Concatenation';\nimport { findRangeOrZoneID } from '../../../../data/utilities/FindUtilities';\nimport ContextMenu from '../../../elements/ContextMenu';\nimport { positions, useModal } from '../../../elements/popup/Modal';\nimport { useHighlight } from '../../../highlight';\nimport IsInView from '../utilities/IsInView';\nimport { getLabelColor } from '../utilities/Utilities';\n\nimport EditLinkModal from './editLink/EditLinkModal';\n\nfunction AdditionalColumnHeader({\n  spectraData,\n  correlationsData,\n  correlation,\n  onEdit,\n}) {\n  const contextRef = useRef<any>();\n  const modal = useModal();\n\n  const highlightIDsAdditionalColumn = useMemo(() => {\n    if (correlation.pseudo === true) {\n      return [];\n    }\n    const ids: string[] = [];\n    correlation.link.forEach((link) => {\n      if (link.pseudo === false) {\n        ids.push(link.signal.id);\n        ids.push(buildID(link.signal.id, 'Crosshair_X'));\n        const _id = findRangeOrZoneID(\n          spectraData,\n          link.experimentID,\n          link.signal.id,\n          true,\n        );\n        if (_id) {\n          ids.push(_id);\n        }\n      }\n    });\n\n    return ids;\n  }, [correlation, spectraData]);\n  const highlightAdditionalColumn = useHighlight(highlightIDsAdditionalColumn);\n\n  const mouseEnterHandler = useCallback(\n    (event) => {\n      event.currentTarget.focus();\n      highlightAdditionalColumn.show();\n    },\n    [highlightAdditionalColumn],\n  );\n  const mouseLeaveHandler = useCallback(\n    (event) => {\n      event.currentTarget.blur();\n      highlightAdditionalColumn.hide();\n    },\n    [highlightAdditionalColumn],\n  );\n\n  const isInView = IsInView({ correlation });\n\n  const tableHeaderProps = useMemo(() => {\n    return {\n      style: {\n        ...{ color: getLabelColor(correlationsData, correlation) || undefined },\n        backgroundColor: highlightAdditionalColumn.isActive\n          ? '#ff6f0057'\n          : isInView\n          ? '#f5f5dc'\n          : 'inherit',\n      },\n      title:\n        correlation.pseudo === false &&\n        correlation.link\n          .reduce((arr, link) => {\n            if (\n              link.pseudo === false &&\n              !arr.includes(link.experimentType.toUpperCase())\n            ) {\n              arr.push(link.experimentType.toUpperCase());\n            }\n            return arr;\n          }, [])\n          .sort()\n          .join('/'),\n      onMouseEnter: mouseEnterHandler,\n      onMouseLeave: mouseLeaveHandler,\n    };\n  }, [\n    correlation,\n    correlationsData,\n    highlightAdditionalColumn.isActive,\n    isInView,\n    mouseEnterHandler,\n    mouseLeaveHandler,\n  ]);\n\n  const equivalenceTextStyle = useMemo(() => {\n    return correlation.edited.equivalence\n      ? { backgroundColor: '#F7F2E0' }\n      : {\n          color: Number.isInteger(correlation.equivalence)\n            ? correlation.equivalence === 1\n              ? '#bebebe'\n              : 'black'\n            : 'red',\n        };\n  }, [correlation]);\n\n  const contextMenu = useMemo(() => {\n    return correlation.pseudo === false\n      ? correlation.link\n          .filter((link) => getLinkDim(link) === 1 && link.pseudo === false)\n          .map((link) => {\n            return {\n              label: `edit 1D (${link.signal.delta.toFixed(3)}${\n                link.edited?.moved === true ? '[MOVED]' : ''\n              })`,\n              onClick: () => {\n                highlightAdditionalColumn.hide();\n                modal.show(\n                  <EditLinkModal\n                    onClose={() => modal.close()}\n                    onEdit={onEdit}\n                    link={link}\n                    correlationDim1={correlation}\n                    correlationDim2={undefined}\n                    correlations={correlationsData.values}\n                  />,\n                  { position: positions.MIDDLE_RIGHT, isBackgroundBlur: false },\n                );\n              },\n            };\n          })\n          .concat([\n            {\n              label: `delete all (${correlation.label.origin})`,\n              onClick: () => {\n                modal.showConfirmDialog({\n                  message: `All signals of ${correlation.label.origin} (${(\n                    getCorrelationDelta(correlation) as number\n                  ).toFixed(2)}) will be deleted. Are you sure?`,\n                  buttons: [\n                    {\n                      text: 'Yes',\n                      handler: () => {\n                        onEdit([correlation], 'removeAll');\n                      },\n                    },\n                    { text: 'No' },\n                  ],\n                });\n                highlightAdditionalColumn.hide();\n              },\n            },\n          ])\n      : [];\n  }, [\n    correlation,\n    correlationsData.values,\n    highlightAdditionalColumn,\n    modal,\n    onEdit,\n  ]);\n\n  const contextMenuHandler = useCallback(\n    (e) => {\n      e.preventDefault();\n      contextRef.current.handleContextMenu(e);\n    },\n    [contextRef],\n  );\n\n  const { title, ...thProps } = tableHeaderProps;\n\n  return (\n    <th {...thProps} title={title === false ? undefined : title}>\n      <div\n        style={{ display: 'block' }}\n        onContextMenu={(e) => {\n          if (contextMenu.length > 0) {\n            contextMenuHandler(e);\n          }\n        }}\n      >\n        <p>{correlation.label.origin}</p>\n        <p>\n          {getCorrelationDelta(correlation)\n            ? getCorrelationDelta(correlation)?.toFixed(2)\n            : ''}\n        </p>\n        <p style={equivalenceTextStyle}>\n          {Number.isInteger(correlation.equivalence)\n            ? correlation.equivalence\n            : correlation.equivalence.toFixed(2)}\n        </p>\n        <ContextMenu ref={contextRef} context={contextMenu} />\n      </div>\n    </th>\n  );\n}\n\nexport default AdditionalColumnHeader;\n","import { buildLink, Correlation, Link } from 'nmr-correlation';\nimport { useCallback, useMemo, useRef } from 'react';\n\nimport { buildID } from '../../../../data/utilities/Concatenation';\nimport { findRangeOrZoneID } from '../../../../data/utilities/FindUtilities';\nimport generateID from '../../../../data/utilities/generateID';\nimport ContextMenu from '../../../elements/ContextMenu';\nimport { positions, useModal } from '../../../elements/popup/Modal';\nimport { useHighlight } from '../../../highlight';\nimport IsInView from '../utilities/IsInView';\nimport {\n  cloneCorrelationAndEditLink,\n  getAbbreviation,\n} from '../utilities/Utilities';\n\nimport EditLinkModal from './editLink/EditLinkModal';\n\nfunction AdditionalColumnField({\n  rowCorrelation,\n  columnCorrelation,\n  commonLinks,\n  correlations,\n  spectraData,\n  onEdit,\n}) {\n  const contextRef = useRef<any>();\n  const modal = useModal();\n\n  const highlightIDsCommonLinks = useMemo(() => {\n    const ids: Array<any> = [];\n    commonLinks.forEach((link: Link) => {\n      if (link.pseudo === false) {\n        ids.push(link.signal.id);\n        ids.push(buildID(link.signal.id, 'Crosshair'));\n        const _id = findRangeOrZoneID(\n          spectraData,\n          link.experimentID,\n          link.signal.id,\n          true,\n        );\n        if (_id) {\n          ids.push(_id);\n        }\n      }\n    });\n\n    return ids;\n  }, [commonLinks, spectraData]);\n  const highlightCommonLinks = useHighlight(highlightIDsCommonLinks);\n\n  const mouseEnterHandler = useCallback(\n    (event) => {\n      event.currentTarget.focus();\n      highlightCommonLinks.show();\n    },\n    [highlightCommonLinks],\n  );\n  const mouseLeaveHandler = useCallback(\n    (event) => {\n      event.currentTarget.blur();\n      highlightCommonLinks.hide();\n    },\n    [highlightCommonLinks],\n  );\n\n  const contextMenuHandler = useCallback(\n    (e) => {\n      e.preventDefault();\n      contextRef.current.handleContextMenu(e);\n    },\n    [contextRef],\n  );\n\n  const handleEditPseudoHSQC = useCallback(\n    (action: 'add' | 'remove', link?: Link) => {\n      const pseudoLinkCountHSQC = rowCorrelation.link.filter(\n        (_link) =>\n          (_link.experimentType === 'hsqc' ||\n            _link.experimentType === 'hmqc') &&\n          _link.pseudo === true,\n      ).length;\n\n      let _correlationDim1: Correlation;\n      let _correlationDim2: Correlation;\n      if (action === 'add') {\n        const commonPseudoLink = buildLink({\n          experimentType: 'hsqc',\n          experimentID: generateID(),\n          atomType: [columnCorrelation.atomType, rowCorrelation.atomType],\n          id: generateID(),\n          pseudo: true,\n          signal: { id: generateID(), sign: 0 }, // pseudo signal\n        });\n        _correlationDim1 = cloneCorrelationAndEditLink(\n          columnCorrelation,\n          commonPseudoLink,\n          'x',\n          'add',\n        );\n        _correlationDim2 = cloneCorrelationAndEditLink(\n          rowCorrelation,\n          commonPseudoLink,\n          'y',\n          'add',\n        );\n        // increase number of attached protons if no value was specified manually before\n        if (!_correlationDim2.edited.protonsCount) {\n          _correlationDim2.protonsCount = [pseudoLinkCountHSQC + 1];\n        }\n      } else {\n        _correlationDim1 = cloneCorrelationAndEditLink(\n          columnCorrelation,\n          link,\n          'x',\n          'remove',\n        );\n        _correlationDim2 = cloneCorrelationAndEditLink(\n          rowCorrelation,\n          link,\n          'y',\n          'remove',\n        );\n        // decrease number of attached protons if no value was specified manually before\n        if (!_correlationDim2.edited.protonsCount) {\n          _correlationDim2.protonsCount =\n            pseudoLinkCountHSQC - 1 > 0 ? [pseudoLinkCountHSQC - 1] : [];\n        }\n      }\n\n      onEdit([_correlationDim1, _correlationDim2], action, link, {\n        skipDataUpdate: true,\n      });\n    },\n    [columnCorrelation, onEdit, rowCorrelation],\n  );\n\n  const contextMenu = useMemo(() => {\n    // allow the edition of correlations\n    const commonLinksMenu = commonLinks\n      .map((commonLink) => {\n        const commonLinkContextMenuLabel = `${getAbbreviation(commonLink)} (${\n          commonLink.signal.x ? commonLink.signal.x.delta.toFixed(2) : '?'\n        }, ${\n          commonLink.signal.y ? commonLink.signal.y.delta.toFixed(2) : '?'\n        })${commonLink.edited?.moved === true ? '[MOVED]' : ''}`;\n\n        return commonLink.pseudo === false\n          ? [\n              {\n                label: `edit ${commonLinkContextMenuLabel}`,\n                onClick: () => {\n                  highlightCommonLinks.hide();\n                  modal.show(\n                    <EditLinkModal\n                      onClose={() => modal.close()}\n                      onEdit={onEdit}\n                      link={commonLink}\n                      correlationDim1={columnCorrelation}\n                      correlationDim2={rowCorrelation}\n                      correlations={correlations}\n                    />,\n                    {\n                      position: positions.MIDDLE_RIGHT,\n                      isBackgroundBlur: false,\n                    },\n                  );\n                },\n              },\n            ]\n          : [];\n      })\n      .flat();\n    // allow addition or removal of a pseudo HSQC link between pseudo heavy atom and proton\n    const commonPseudoLinkHSQC = commonLinks.find(\n      (commonLink) =>\n        commonLink.pseudo === true && commonLink.experimentType === 'hsqc',\n    );\n    if (rowCorrelation.pseudo === true) {\n      if (commonPseudoLinkHSQC) {\n        commonLinksMenu.push({\n          label: 'remove pseudo HSQC',\n          onClick: () => handleEditPseudoHSQC('remove', commonPseudoLinkHSQC),\n        });\n      } else {\n        commonLinksMenu.push({\n          label: 'add pseudo HSQC',\n          onClick: () => handleEditPseudoHSQC('add'),\n        });\n      }\n    }\n\n    return commonLinksMenu;\n  }, [\n    columnCorrelation,\n    commonLinks,\n    correlations,\n    handleEditPseudoHSQC,\n    highlightCommonLinks,\n    modal,\n    onEdit,\n    rowCorrelation,\n  ]);\n\n  const contentLabel = useMemo(\n    () =>\n      commonLinks.map((commonLink, i) => (\n        <label key={commonLink.id}>\n          <label\n            style={{\n              color:\n                commonLink.pseudo === true || commonLink.edited?.moved === true\n                  ? 'blue'\n                  : 'black',\n            }}\n          >\n            {getAbbreviation(commonLink)}\n          </label>\n          {i < commonLinks.length - 1 && <label>/</label>}\n        </label>\n      )),\n    [commonLinks],\n  );\n\n  const title = useMemo(\n    () =>\n      commonLinks\n        .reduce((arr, link) => {\n          if (!arr.includes(link.experimentType.toUpperCase())) {\n            arr.push(link.experimentType.toUpperCase());\n          }\n          return arr;\n        }, [])\n        .join('/'),\n    [commonLinks],\n  );\n\n  const isInViewRow = IsInView({ correlation: rowCorrelation });\n  const isInViewColumn = IsInView({ correlation: columnCorrelation });\n\n  return (\n    <td\n      onContextMenu={(e) => {\n        if (contextMenu.length > 0) {\n          contextMenuHandler(e);\n        }\n      }}\n      style={{\n        backgroundColor: highlightCommonLinks.isActive\n          ? '#ff6f0057'\n          : isInViewColumn || isInViewRow\n          ? '#f5f5dc'\n          : 'inherit',\n      }}\n      title={title}\n      onMouseEnter={mouseEnterHandler}\n      onMouseLeave={mouseLeaveHandler}\n    >\n      {contentLabel}\n      <ContextMenu ref={contextRef} context={contextMenu} />\n    </td>\n  );\n}\n\nexport default AdditionalColumnField;\n","import {\n  buildLink,\n  getCorrelationDelta,\n  getLabel,\n  getLinkDim,\n  Link,\n} from 'nmr-correlation';\nimport { useCallback, useMemo, useRef } from 'react';\n\nimport { buildID } from '../../../../data/utilities/Concatenation';\nimport { findRangeOrZoneID } from '../../../../data/utilities/FindUtilities';\nimport ContextMenu from '../../../elements/ContextMenu';\nimport EditableColumn from '../../../elements/EditableColumn';\nimport { positions, useModal } from '../../../elements/popup/Modal';\nimport { useHighlight } from '../../../highlight';\nimport IsInView from '../utilities/IsInView';\nimport { convertValuesString } from '../utilities/Utilities';\n\nimport AdditionalColumnField from './AdditionalColumnField';\nimport EditLinkModal from './editLink/EditLinkModal';\n\nfunction CorrelationTableRow({\n  additionalColumnData,\n  correlations,\n  correlation,\n  styleRow,\n  styleLabel,\n  onSaveEditEquivalences,\n  onSaveEditNumericValues,\n  onEditCorrelationTableCellHandler,\n  spectraData,\n}) {\n  const contextRef = useRef<any>();\n  const modal = useModal();\n\n  const highlightIDsRow = useMemo(() => {\n    if (correlation.pseudo === true) {\n      return [];\n    }\n    const ids: string[] = [];\n\n    correlation.link.forEach((link) => {\n      if (link.pseudo === false) {\n        ids.push(link.signal.id);\n        ids.push(buildID(link.signal.id, 'Crosshair_Y'));\n        const _id = findRangeOrZoneID(\n          spectraData,\n          link.experimentID,\n          link.signal.id,\n          true,\n        );\n        if (_id) {\n          ids.push(_id);\n        }\n      }\n    });\n\n    return ids;\n  }, [correlation, spectraData]);\n  const highlightRow = useHighlight(highlightIDsRow);\n\n  const onSaveEquivalencesHandler = useCallback(\n    (e) => {\n      onSaveEditEquivalences(correlation, e.target.value);\n    },\n    [correlation, onSaveEditEquivalences],\n  );\n\n  const onSaveEditNumericValuesHandler = useCallback(\n    (e, key: 'protonsCount' | 'hybridization') => {\n      onSaveEditNumericValues({\n        correlation,\n        values: convertValuesString(e.target.value, key),\n        key,\n      });\n    },\n    [correlation, onSaveEditNumericValues],\n  );\n\n  const additionalColumnFields = useMemo(() => {\n    return additionalColumnData.map((_correlation) => {\n      const commonLinks: Link[] = [];\n      correlation.link.forEach((link) => {\n        _correlation.link.forEach((_link) => {\n          if (\n            link.axis !== _link.axis &&\n            link.experimentID === _link.experimentID &&\n            link.signal.id === _link.signal.id &&\n            !commonLinks.some(\n              (_commonLink) => _commonLink.signal.id === link.signal.id,\n            )\n          ) {\n            let experimentLabel = link.experimentType;\n            if (link.signal && link.signal.sign !== 0) {\n              experimentLabel += link.signal.sign === 1 ? ' (+)' : ' (-)';\n            }\n            commonLinks.push(\n              buildLink({\n                ...link,\n                experimentLabel,\n                axis: undefined,\n                id: `${_link.id}_${link.id}`,\n              }),\n            );\n          }\n        });\n      });\n\n      return (\n        <AdditionalColumnField\n          key={`addColData_${correlation.id}_${_correlation.id}`}\n          rowCorrelation={correlation}\n          columnCorrelation={_correlation}\n          commonLinks={commonLinks}\n          correlations={correlations}\n          spectraData={spectraData}\n          onEdit={onEditCorrelationTableCellHandler}\n        />\n      );\n    });\n  }, [\n    additionalColumnData,\n    correlation,\n    correlations,\n    onEditCorrelationTableCellHandler,\n    spectraData,\n  ]);\n\n  const equivalenceCellStyle = useMemo(() => {\n    return correlation.edited.equivalence\n      ? { color: 'blue' }\n      : {\n          color: correlation.equivalence === 1 ? '#bebebe' : 'black',\n        };\n  }, [correlation]);\n\n  const mouseEnterHandler = useCallback(\n    (event) => {\n      event.currentTarget.focus();\n      highlightRow.show();\n    },\n    [highlightRow],\n  );\n  const mouseLeaveHandler = useCallback(\n    (event) => {\n      event.currentTarget.blur();\n      highlightRow.hide();\n    },\n    [highlightRow],\n  );\n\n  const isInView = IsInView({ correlation });\n\n  const tableDataProps = useMemo(() => {\n    return {\n      style: {\n        ...styleRow,\n        backgroundColor: highlightRow.isActive\n          ? '#ff6f0057'\n          : isInView\n          ? '#f5f5dc'\n          : 'inherit',\n      },\n      title:\n        correlation.pseudo === false &&\n        correlation.link\n          .reduce((arr, link) => {\n            if (\n              link.pseudo === false &&\n              !arr.includes(link.experimentType.toUpperCase())\n            ) {\n              arr.push(link.experimentType.toUpperCase());\n            }\n            return arr;\n          }, [])\n          .sort()\n          .join('/'),\n      onMouseEnter: mouseEnterHandler,\n      onMouseLeave: mouseLeaveHandler,\n    };\n  }, [\n    correlation.link,\n    correlation.pseudo,\n    highlightRow.isActive,\n    isInView,\n    mouseEnterHandler,\n    mouseLeaveHandler,\n    styleRow,\n  ]);\n\n  const contextMenu = useMemo(() => {\n    return correlation.pseudo === false\n      ? correlation.link\n          .filter((link) => getLinkDim(link) === 1 && link.pseudo === false)\n          .map((link) => {\n            return {\n              label: `edit 1D (${link.signal.delta.toFixed(3)})${\n                link.edited?.moved === true ? '[MOVED]' : ''\n              }`,\n              onClick: () => {\n                highlightRow.hide();\n                modal.show(\n                  <EditLinkModal\n                    onClose={() => modal.close()}\n                    onEdit={onEditCorrelationTableCellHandler}\n                    link={link}\n                    correlationDim1={correlation}\n                    correlationDim2={undefined}\n                    correlations={correlations}\n                  />,\n                  {\n                    position: positions.MIDDLE_RIGHT,\n                    isBackgroundBlur: false,\n                  },\n                );\n              },\n            };\n          })\n          .concat([\n            {\n              label: `delete ${correlation.label.origin}`,\n              onClick: () => {\n                modal.showConfirmDialog({\n                  message: `All signals of ${correlation.label.origin} (${(\n                    getCorrelationDelta(correlation) as number\n                  ).toFixed(2)}) will be deleted. Are you sure?`,\n                  buttons: [\n                    {\n                      text: 'Yes',\n                      handler: () => {\n                        onEditCorrelationTableCellHandler(\n                          [correlation],\n                          'removeAll',\n                        );\n                      },\n                    },\n                    { text: 'No' },\n                  ],\n                });\n                highlightRow.hide();\n              },\n            },\n          ])\n      : [];\n  }, [\n    correlation,\n    highlightRow,\n    modal,\n    onEditCorrelationTableCellHandler,\n    correlations,\n  ]);\n\n  const contextMenuHandler = useCallback(\n    (e) => {\n      e.preventDefault();\n      contextRef.current.handleContextMenu(e);\n    },\n    [contextRef],\n  );\n\n  const { title, ...otherTableDataProps } = tableDataProps;\n  const t = !title ? '' : title;\n\n  return (\n    <tr style={styleRow}>\n      <td\n        title={t}\n        {...{\n          ...otherTableDataProps,\n          style: { ...tableDataProps.style, styleLabel },\n        }}\n        onContextMenu={(e) => {\n          if (contextMenu.length > 0) {\n            contextMenuHandler(e);\n          }\n        }}\n      >\n        {getLabel(correlations, correlation)}\n        <ContextMenu ref={contextRef} context={contextMenu} />\n      </td>\n      <td title={t} {...otherTableDataProps}>\n        {getCorrelationDelta(correlation)\n          ? getCorrelationDelta(correlation)?.toFixed(2)\n          : ''}\n      </td>\n      <td title={t} {...otherTableDataProps}>\n        {correlation.pseudo === false ? (\n          correlation.atomType !== 'H' ? (\n            <EditableColumn\n              type=\"number\"\n              value={correlation.equivalence}\n              style={equivalenceCellStyle}\n              onSave={onSaveEquivalencesHandler}\n            />\n          ) : (\n            <text style={equivalenceCellStyle}>{correlation.equivalence}</text>\n          )\n        ) : (\n          ''\n        )}\n      </td>\n      <td title={t} {...otherTableDataProps}>\n        {correlation.atomType !== 'H' ? (\n          <EditableColumn\n            type=\"text\"\n            value={correlation.protonsCount.join(',')}\n            style={correlation.edited.protonsCount ? { color: 'blue' } : {}}\n            onSave={(e) => onSaveEditNumericValuesHandler(e, 'protonsCount')}\n          />\n        ) : (\n          ''\n        )}\n      </td>\n      <td\n        title={t}\n        {...{\n          ...otherTableDataProps,\n          style: { ...tableDataProps.style, borderRight: '1px solid' },\n        }}\n      >\n        {correlation.atomType !== 'H' ? (\n          <EditableColumn\n            type=\"text\"\n            value={correlation.hybridization\n              .map((hybrid) => `sp${hybrid}`)\n              .join(',')}\n            style={correlation.edited.hybridization ? { color: 'blue' } : {}}\n            onSave={(e) => onSaveEditNumericValuesHandler(e, 'hybridization')}\n          />\n        ) : (\n          ''\n        )}\n      </td>\n      {additionalColumnFields}\n    </tr>\n  );\n}\n\nexport default CorrelationTableRow;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { Correlation } from 'nmr-correlation';\nimport { useMemo } from 'react';\n\nimport { getLabelColor } from '../utilities/Utilities';\n\nimport AdditionalColumnHeader from './AdditionalColumnHeader';\nimport CorrelationTableRow from './CorrelationTableRow';\n\nconst tableStyle = css`\n  overflow: auto;\n  height: 100%;\n  display: block;\n  table {\n    border-spacing: 0;\n    border: 1px solid #dedede;\n    width: 100%;\n    font-size: 12px;\n    height: 100%;\n  }\n  tr {\n    :last-child {\n      td {\n        border-bottom: 0;\n      }\n    }\n  }\n  thead tr {\n    background-color: white !important;\n  }\n  th {\n    position: sticky;\n    background-color: white;\n    top: 0;\n  }\n\n  th,\n  td {\n    white-space: nowrap;\n    text-align: center;\n    margin: 0;\n    padding: 0.4rem;\n    border-bottom: 1px solid #dedede;\n    border-right: 1px solid #dedede;\n\n    :last-child {\n      border-right: 0;\n    }\n    button {\n      background-color: transparent;\n      border: none;\n    }\n  }\n`;\n\nfunction CorrelationTable({\n  correlationsData,\n  filteredCorrelationsData,\n  additionalColumnData,\n  editEquivalencesSaveHandler,\n  onSaveEditNumericValues,\n  onEditCorrelationTableCellHandler,\n  showProtonsAsRows,\n  spectraData,\n}) {\n  const rows = useMemo(() => {\n    if (!filteredCorrelationsData) {\n      return [];\n    }\n\n    return filteredCorrelationsData.values\n      .filter((correlation: Correlation) =>\n        showProtonsAsRows\n          ? correlation.atomType === 'H'\n          : correlation.atomType !== 'H',\n      )\n      .map((correlation: Correlation) => (\n        <CorrelationTableRow\n          additionalColumnData={additionalColumnData}\n          correlations={correlationsData.values}\n          correlation={correlation}\n          key={`correlation${correlation.atomType}${correlation.id}`}\n          styleRow={{ backgroundColor: 'mintcream' }}\n          styleLabel={\n            correlation.atomType === 'H'\n              ? {\n                  color: getLabelColor(correlationsData, correlation),\n                }\n              : {}\n          }\n          onSaveEditEquivalences={editEquivalencesSaveHandler}\n          onSaveEditNumericValues={onSaveEditNumericValues}\n          onEditCorrelationTableCellHandler={onEditCorrelationTableCellHandler}\n          spectraData={spectraData}\n        />\n      ));\n  }, [\n    filteredCorrelationsData,\n    showProtonsAsRows,\n    additionalColumnData,\n    correlationsData,\n    editEquivalencesSaveHandler,\n    onSaveEditNumericValues,\n    onEditCorrelationTableCellHandler,\n    spectraData,\n  ]);\n\n  const additionalColumnHeader = useMemo(\n    () =>\n      additionalColumnData.map((correlation: Correlation) => (\n        <AdditionalColumnHeader\n          key={`additionalCorrelationHeader_${correlation.id}`}\n          spectraData={spectraData}\n          correlationsData={correlationsData}\n          correlation={correlation}\n          onEdit={onEditCorrelationTableCellHandler}\n        />\n      )),\n    [\n      additionalColumnData,\n      correlationsData,\n      onEditCorrelationTableCellHandler,\n      spectraData,\n    ],\n  );\n\n  return (\n    <div css={tableStyle}>\n      <table>\n        <thead>\n          <tr>\n            <th>Atom</th>\n            <th>δ (ppm)</th>\n            <th>Equiv</th>\n            <th>#H</th>\n            <th style={{ borderRight: '1px solid' }}>Hybrid</th>\n            {additionalColumnHeader}\n          </tr>\n        </thead>\n        <tbody>{rows}</tbody>\n      </table>\n    </div>\n  );\n}\n\nexport default CorrelationTable;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { getAtomCounts } from 'nmr-correlation';\nimport { memo } from 'react';\n\nimport { ErrorColors, Errors } from './CorrelationTable/Constants';\n\nconst styles = css`\n  display: flex;\n  width: 100%;\n  font-size: 15px;\n  font-weight: 300;\n  white-space: nowrap;\n  span {\n    margin-left: 8px;\n  }\n`;\n\ninterface OverviewProps {\n  correlationsData?: {\n    options: {\n      mf: string;\n    };\n    state: any;\n  };\n}\n\nfunction Overview({ correlationsData }: OverviewProps) {\n  if (!correlationsData) {\n    return null;\n  }\n\n  const atoms = getAtomCounts(correlationsData.options.mf);\n\n  const elements =\n    Object.keys(atoms).length > 0 ? (\n      Object.keys(atoms).map((atomType, i) => {\n        const stateAtomType = correlationsData.state[atomType];\n        const error = stateAtomType ? stateAtomType.error : undefined;\n        const errorColorIndex = error\n          ? Errors.findIndex((_error) => error[_error] !== undefined)\n          : 'black';\n\n        return (\n          <span\n            // eslint-disable-next-line react/no-array-index-key\n            key={`molFormulaView_${i}`}\n            style={{\n              color: stateAtomType\n                ? stateAtomType.complete === true &&\n                  (!error || Object.keys(error).length === 0)\n                  ? 'green'\n                  : errorColorIndex >= 0\n                  ? ErrorColors[errorColorIndex].color\n                  : 'black'\n                : 'black',\n            }}\n          >\n            {`${atomType}: ${stateAtomType ? stateAtomType.current : '-'}/${\n              atoms[atomType]\n            }   `}\n          </span>\n        );\n      })\n    ) : (\n      <p style={{ fontStyle: 'italic', color: 'orange' }}>\n        Molecular formula is not set\n      </p>\n    );\n\n  return <div css={styles}>{elements}</div>;\n}\n\nexport default memo(Overview);\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback, useState } from 'react';\n\nimport getAtomsFromMF from '../../data/utilities/getAtomsFromMF';\n\nconst inputStyle = css`\n  text-align: center;\n\n  input {\n    height: 100%;\n    width: 200px;\n    border-radius: 5px;\n    border: 0.55px solid #c7c7c7;\n    margin: 0px 5px 0px 5px;\n    text-align: center;\n  }\n\n  button {\n    flex: 2;\n    padding: 5px;\n    border: 1px solid gray;\n    border-radius: 5px;\n    height: 36px;\n    margin: 0 auto;\n    margin-top: 15px;\n    display: block;\n    width: 20%;\n\n    color: white;\n    background-color: gray;\n  }\n`;\n\ninterface MolecularFormulaInputProps {\n  onSave?: (element: string) => void;\n  previousMF: string;\n}\n\nfunction MolecularFormulaInput({\n  onSave = () => null,\n  previousMF,\n}: MolecularFormulaInputProps) {\n  const [mf, setMF] = useState('');\n  const [isValidMF, setIsValidMF] = useState(true);\n  const [hasChanged, setHasChanged] = useState(false);\n\n  const checkMF = useCallback((mf: string) => {\n    if (mf.trim().length === 0) {\n      return false;\n    }\n    try {\n      getAtomsFromMF(mf);\n      return true;\n    } catch (error) {\n      return false;\n    }\n  }, []);\n\n  const onChangeHandler = useCallback(\n    (e) => {\n      setHasChanged(true);\n      if (checkMF(e.target.value)) {\n        setIsValidMF(true);\n        setMF(e.target.value);\n      } else {\n        setIsValidMF(false);\n        setMF('');\n      }\n    },\n    [checkMF],\n  );\n\n  const onSaveHandler = useCallback(() => {\n    onSave(hasChanged ? mf.trim() : previousMF);\n  }, [hasChanged, mf, onSave, previousMF]);\n\n  return (\n    <div css={inputStyle}>\n      <input type=\"text\" onChange={onChangeHandler} defaultValue={previousMF} />\n      <button type=\"button\" onClick={onSaveHandler} disabled={!isValidMF}>\n        {isValidMF ? 'Set' : 'Invalid'}\n      </button>\n    </div>\n  );\n}\n\nexport default MolecularFormulaInput;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback, useEffect, useState } from 'react';\n\nimport CloseButton from '../../elements/CloseButton';\nimport MolecularFormulaInput from '../../elements/MolecularFormulaInput';\nimport MoleculeSelection from '../../elements/MoleculeSelection';\n\nconst modalContainer = css`\n  overflow: auto;\n  width: 400px;\n  height: 550px;\n  padding: 5px;\n  button:focus {\n    outline: none;\n  }\n  .header {\n    height: 24px;\n    border-bottom: 1px solid #f0f0f0;\n    display: flex;\n    align-items: center;\n\n    button {\n      height: 36px;\n      margin: 2px;\n      background-color: transparent;\n      border: none;\n      svg {\n        height: 16px;\n      }\n    }\n  }\n\n  button {\n    flex: 2;\n    padding: 5px;\n    border: 1px solid gray;\n    border-radius: 5px;\n    height: 30px;\n    margin: 0 auto;\n    margin-top: 15px;\n    display: block;\n    width: 20%;\n\n    color: white;\n    background-color: gray;\n  }\n\n  .info {\n    margin-top: 0;\n    margin-bottom: 10px;\n    padding: 0px 10px;\n    width: 100%;\n\n    text-align: center;\n  }\n\n  .optional {\n    margin-top: 20px;\n    margin-bottom: 5px;\n    padding: 0px 10px;\n\n    text-align: center;\n    font-size: 18px;\n    font-weight: bold;\n  }\n  .optional2 {\n    margin-top: 5px;\n    margin-bottom: 25px;\n    padding: 0px 10px;\n    width: 100%;\n\n    text-align: center;\n  }\n`;\n\ninterface SetMolecularFormulaModalProps {\n  onClose: () => void;\n  onSave?: (element: any) => void;\n  molecules: any;\n  previousMF: any;\n}\n\nexport default function SetMolecularFormulaModal({\n  onClose,\n  onSave,\n  molecules,\n  previousMF,\n}: SetMolecularFormulaModalProps) {\n  const [currentIndex, setCurrentIndex] = useState<number>(0);\n\n  useEffect(() => {\n    if (molecules && molecules.length > 0) {\n      setCurrentIndex(0);\n    }\n  }, [molecules]);\n\n  const onSaveHandlerMolecularFormulaInput = useCallback(\n    (mf) => {\n      onSave?.(mf);\n      onClose?.();\n    },\n    [onClose, onSave],\n  );\n\n  const onSaveHandlerMoleculeSelection = useCallback(() => {\n    onSave?.(molecules[currentIndex].mf);\n    onClose?.();\n  }, [currentIndex, molecules, onClose, onSave]);\n\n  const onChangeHandlerMoleculeSelection = useCallback((index) => {\n    setCurrentIndex(index);\n  }, []);\n\n  return (\n    <div css={modalContainer}>\n      <div className=\"header handle\">\n        <CloseButton onClick={onClose} />\n      </div>\n      <div>\n        <p className=\"info\">Please type in a molecular formula!</p>\n      </div>\n      <MolecularFormulaInput\n        onSave={onSaveHandlerMolecularFormulaInput}\n        previousMF={previousMF}\n      />\n      <div>\n        <p className=\"optional\">OR</p>\n        <p className=\"optional2\">Select a molecule as reference!</p>\n      </div>\n      <MoleculeSelection\n        molecules={molecules}\n        onChange={onChangeHandlerMoleculeSelection}\n      />\n      <button type=\"button\" onClick={onSaveHandlerMoleculeSelection}>\n        Set\n      </button>\n    </div>\n  );\n}\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback, useEffect, useMemo, useState } from 'react';\n\nimport CloseButton from '../../elements/CloseButton';\n\nconst modalContainer = css`\n  width: 220px;\n  height: 270px;\n  padding: 5px;\n  text-align: center;\n\n  button:focus {\n    outline: none;\n  }\n\n  .header {\n    height: 24px;\n    border-bottom: 1px solid #f0f0f0;\n    display: flex;\n    align-items: center;\n\n    span {\n      color: #464646;\n      font-size: 15px;\n      flex: 1;\n      user-select: none;\n    }\n\n    button {\n      height: 36px;\n      margin: 2px;\n      background-color: transparent;\n      border: none;\n      svg {\n        height: 16px;\n      }\n    }\n  }\n\n  button {\n    flex: 2;\n    padding: 5px;\n    border: 1px solid gray;\n    border-radius: 5px;\n    height: 30px;\n    margin: 0 auto;\n    margin-top: 15px;\n    display: block;\n    width: 20%;\n\n    color: white;\n    background-color: gray;\n  }\n\n  table {\n    margin-top: 10px;\n    width: 100%;\n\n    input::-webkit-outer-spin-button,\n    input::-webkit-inner-spin-button {\n      -webkit-appearance: none;\n    }\n\n    input {\n      width: 100px;\n      text-align: center;\n      border-radius: 5px;\n      border: 0.55px solid #c7c7c7;\n    }\n  }\n`;\n\ninterface SetShiftToleranceModalProps {\n  onClose: () => void;\n  onSave?: (element: any) => void;\n  previousTolerance: any;\n}\n\nexport default function SetShiftToleranceModal({\n  onClose,\n  onSave,\n  previousTolerance,\n}: SetShiftToleranceModalProps) {\n  const [tolerance, setTolerance] = useState<any>();\n  const [isValid, setIsValid] = useState<{ [atomType: string]: boolean }>({});\n\n  useEffect(() => {\n    if (previousTolerance) {\n      setTolerance(previousTolerance);\n      const _isValid = {};\n      Object.keys(previousTolerance).forEach((atomType) => {\n        _isValid[atomType] = true;\n      });\n      setIsValid(_isValid);\n    } else {\n      setTolerance(undefined);\n    }\n  }, [previousTolerance]);\n\n  const onSaveHandler = useCallback(() => {\n    onSave?.(tolerance);\n    onClose?.();\n  }, [onClose, onSave, tolerance]);\n\n  const onChangeHandler = useCallback(\n    (e, atomType: string) => {\n      const value: string = e.target.value;\n      if (value.trim().length > 0) {\n        setTolerance({ ...tolerance, [atomType]: Number(value) });\n        setIsValid({ ...isValid, [atomType]: true });\n      } else {\n        setIsValid({ ...isValid, [atomType]: false });\n      }\n    },\n    [isValid, tolerance],\n  );\n\n  const rows = useMemo(() => {\n    return tolerance\n      ? Object.keys(tolerance).map((atomType) => {\n          return (\n            <tr key={`tolerance_${atomType}`}>\n              <td>{atomType}</td>\n              <td>\n                <input\n                  type=\"number\"\n                  onChange={(e) => onChangeHandler(e, atomType)}\n                  defaultValue={tolerance[atomType]}\n                  style={\n                    !isValid[atomType] ? { backgroundColor: 'orange' } : {}\n                  }\n                />\n              </td>\n            </tr>\n          );\n        })\n      : undefined;\n  }, [isValid, onChangeHandler, tolerance]);\n\n  return (\n    <div css={modalContainer}>\n      <div className=\"header handle\">\n        <span>Set Shift Tolerances</span>\n        <CloseButton onClick={onClose} />\n      </div>\n\n      <table>\n        <thead>\n          <tr>\n            <th>Atom</th>\n            <th>Value</th>\n          </tr>\n        </thead>\n        <tbody>{rows}</tbody>\n      </table>\n      <button\n        type=\"button\"\n        onClick={onSaveHandler}\n        disabled={Object.keys(isValid).some((atomType) => !isValid[atomType])}\n      >\n        Set\n      </button>\n    </div>\n  );\n}\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport {\n  getLinkDelta,\n  getLinkDim,\n  Correlation,\n  Values as CorrelationValues,\n  Options as CorrelationOptions,\n  Link,\n} from 'nmr-correlation';\nimport { memo, useCallback, useEffect, useMemo, useState } from 'react';\nimport { FaFlask, FaSlidersH } from 'react-icons/fa';\n\nimport { Datum1D } from '../../../data/types/data1d';\nimport { Datum2D } from '../../../data/types/data2d';\nimport {\n  findRange,\n  findSignal1D,\n  findSignal2D,\n  findSpectrum,\n  findZone,\n} from '../../../data/utilities/FindUtilities';\nimport { useAssignmentData } from '../../assignment/AssignmentsContext';\nimport { useChartData } from '../../context/ChartContext';\nimport { useDispatch } from '../../context/DispatchContext';\nimport Select from '../../elements/Select';\nimport ToolTip from '../../elements/ToolTip/ToolTip';\nimport { useModal } from '../../elements/popup/Modal';\nimport { DISPLAYER_MODE } from '../../reducer/core/Constants';\nimport {\n  DELETE_1D_SIGNAL,\n  DELETE_2D_SIGNAL,\n  DELETE_CORRELATION,\n  SET_2D_SIGNAL_PATH_LENGTH,\n  SET_CORRELATION,\n  SET_CORRELATIONS,\n  SET_CORRELATIONS_MF,\n  SET_CORRELATIONS_TOLERANCE,\n} from '../../reducer/types/Types';\nimport DefaultPanelHeader from '../header/DefaultPanelHeader';\n\nimport CorrelationTable from './CorrelationTable/CorrelationTable';\nimport Overview from './Overview';\nimport SetMolecularFormulaModal from './SetMolecularFormulaModal';\nimport SetShiftToleranceModal from './SetShiftTolerancesModal';\nimport {\n  findSignalMatch1D,\n  findSignalMatch2D,\n  getAtomType,\n} from './utilities/Utilities';\n\nconst panelStyle = css`\n  display: flex;\n  flex-direction: column;\n  text-align: center;\n  height: 100%;\n  width: 100%;\n\n  .extra-header-content {\n    display: flex;\n    width: 100%;\n\n    .overview-container {\n      width: 100%;\n      display: flex;\n      align-items: center;\n      margin-left: 10px;\n    }\n\n    .table-view-selection {\n      width: 100%;\n      display: flex;\n      align-items: center;\n      justify-content: flex-end;\n      margin-right: 2px;\n\n      white-space: nowrap;\n\n      label {\n        font-size: 13px;\n      }\n    }\n  }\n`;\n\nfunction SummaryPanel() {\n  const {\n    molecules,\n    correlations: correlationsData,\n    data: spectraData,\n    xDomain,\n    yDomain,\n    displayerMode,\n    activeTab,\n  } = useChartData();\n\n  const dispatch = useDispatch();\n  const modal = useModal();\n  const assignmentData = useAssignmentData();\n\n  const [additionalColumnData, setAdditionalColumnData] = useState([]);\n  const [\n    selectedAdditionalColumnsAtomType,\n    setSelectedAdditionalColumnsAtomType,\n  ] = useState<string>('H');\n  const [showProtonsAsRows, setShowProtonsAsRows] = useState(false);\n  const [filterIsActive, setFilterIsActive] = useState(false);\n\n  const filteredCorrelationsData = useMemo(() => {\n    const isInView = (correlation: Correlation): boolean => {\n      if (correlation.pseudo === true) {\n        return false;\n      }\n      const atomTypesInView = activeTab\n        .split(',')\n        .map((tab) => getAtomType(tab));\n\n      const factor = 10000;\n      const xDomain0 = xDomain[0] * factor;\n      const xDomain1 = xDomain[1] * factor;\n      const yDomain0 = yDomain[0] * factor;\n      const yDomain1 = yDomain[1] * factor;\n\n      if (displayerMode === DISPLAYER_MODE.DM_1D) {\n        const firstLink1D = correlation.link.find(\n          (link: Link) => getLinkDim(link) === 1,\n        );\n        if (!firstLink1D) {\n          return false;\n        }\n        let delta = getLinkDelta(firstLink1D);\n        if (delta === undefined) {\n          return false;\n        }\n        delta *= factor;\n        const spectrum = findSpectrum(\n          spectraData,\n          firstLink1D.experimentID,\n          true,\n        );\n        if (\n          spectrum &&\n          atomTypesInView[0] === correlation.atomType &&\n          delta >= xDomain0 &&\n          delta <= xDomain1\n        ) {\n          return true;\n        }\n        // try to find a link which contains the belonging 2D signal in the spectra in view\n        if (\n          correlation.link.some((link: Link) => {\n            const spectrum = findSpectrum(\n              spectraData,\n              link.experimentID,\n              true,\n            ) as Datum2D;\n            return findSignalMatch1D(\n              spectrum,\n              link,\n              factor,\n              xDomain0,\n              xDomain1,\n            );\n          })\n        ) {\n          return true;\n        }\n      } else if (displayerMode === DISPLAYER_MODE.DM_2D) {\n        if (!atomTypesInView.includes(correlation.atomType)) {\n          return false;\n        }\n        const firstLink2D = correlation.link.find(\n          (link: Link) => getLinkDim(link) === 2,\n        );\n        if (!firstLink2D) {\n          return false;\n        }\n        const spectrum = findSpectrum(\n          spectraData,\n          firstLink2D.experimentID,\n          true,\n        ) as Datum2D;\n        // correlation is represented by a 2D signal\n        if (\n          findSignalMatch2D(\n            spectrum,\n            firstLink2D,\n            factor,\n            xDomain0,\n            xDomain1,\n            yDomain0,\n            yDomain1,\n          )\n        ) {\n          return true;\n        } else {\n          // try to find a link which contains the belonging 2D signal in the spectra in view\n          if (\n            correlation.link.some((link) => {\n              const spectrum = findSpectrum(\n                spectraData,\n                link.experimentID,\n                true,\n              ) as Datum2D;\n              return findSignalMatch2D(\n                spectrum,\n                link,\n                factor,\n                xDomain0,\n                xDomain1,\n                yDomain0,\n                yDomain1,\n              );\n            })\n          ) {\n            return true;\n          }\n        }\n      }\n      // do not show correlation\n      return false;\n    };\n\n    if (correlationsData) {\n      const _values = filterIsActive\n        ? correlationsData.values.filter((correlation) => isInView(correlation))\n        : correlationsData.values;\n\n      return { ...correlationsData, values: _values };\n    }\n  }, [\n    activeTab,\n    correlationsData,\n    displayerMode,\n    filterIsActive,\n    spectraData,\n    xDomain,\n    yDomain,\n  ]);\n\n  const handleOnSetMolecularFormula = useCallback(\n    (mf) => {\n      dispatch({\n        type: SET_CORRELATIONS_MF,\n        payload: {\n          mf,\n        },\n      });\n    },\n    [dispatch],\n  );\n\n  const handleOnSetShiftTolerance = useCallback(\n    (tolerance) => {\n      dispatch({\n        type: SET_CORRELATIONS_TOLERANCE,\n        payload: {\n          tolerance,\n        },\n      });\n    },\n    [dispatch],\n  );\n\n  const showSetMolecularFormulaModal = useCallback(() => {\n    modal.show(\n      <SetMolecularFormulaModal\n        onClose={() => modal.close()}\n        onSave={handleOnSetMolecularFormula}\n        molecules={molecules}\n        previousMF={correlationsData.options.mf}\n      />,\n    );\n  }, [correlationsData, handleOnSetMolecularFormula, modal, molecules]);\n\n  const showSetShiftToleranceModal = useCallback(() => {\n    modal.show(\n      <SetShiftToleranceModal\n        onClose={() => modal.close()}\n        onSave={handleOnSetShiftTolerance}\n        previousTolerance={correlationsData.options.tolerance}\n      />,\n    );\n  }, [correlationsData, handleOnSetShiftTolerance, modal]);\n\n  const additionalColumnTypes = useMemo(() => {\n    const columnTypes = ['H', 'H-H'].concat(\n      correlationsData\n        ? correlationsData.values\n            .map((correlation) => correlation.atomType)\n            .filter(\n              (atomType, i, array) =>\n                atomType !== 'H' && array.indexOf(atomType) === i,\n            )\n        : [],\n    );\n\n    return columnTypes.map((columnType) => {\n      return {\n        key: columnType,\n        label: columnType,\n        value: columnType,\n      };\n    });\n  }, [correlationsData]);\n\n  useEffect(() => {\n    const _selectedAdditionalColumnsAtomType =\n      selectedAdditionalColumnsAtomType.split('-')[0];\n\n    setAdditionalColumnData(\n      filteredCorrelationsData\n        ? filteredCorrelationsData.values\n            .filter(\n              (correlation) =>\n                correlation.atomType === _selectedAdditionalColumnsAtomType,\n            )\n            .reverse()\n        : [],\n    );\n  }, [filteredCorrelationsData, selectedAdditionalColumnsAtomType]);\n\n  const editEquivalencesSaveHandler = useCallback(\n    (correlation: Correlation, value: number) => {\n      dispatch({\n        type: SET_CORRELATION,\n        payload: {\n          id: correlation.id,\n          correlation: {\n            ...correlation,\n            equivalence: value,\n            edited: { ...correlation.edited, equivalence: value !== 1 },\n          },\n        },\n      });\n    },\n    [dispatch],\n  );\n\n  const editNumericValuesSaveHandler = useCallback(\n    ({\n      correlation,\n      values,\n      key,\n    }: {\n      correlation: Correlation;\n      values: number[];\n      key: 'hybridization' | 'protonsCount';\n    }) => {\n      dispatch({\n        type: SET_CORRELATION,\n        payload: {\n          id: correlation.id,\n          correlation: {\n            ...correlation,\n            [key]: values,\n            edited: { ...correlation.edited, [key]: true },\n          },\n          options: {\n            skipDataUpdate: true,\n          },\n        },\n      });\n    },\n    [dispatch],\n  );\n\n  const setCorrelationsHandler = useCallback(\n    (correlations: CorrelationValues, options?: CorrelationOptions) => {\n      dispatch({\n        type: SET_CORRELATIONS,\n        payload: {\n          correlations,\n          options,\n        },\n      });\n    },\n    [dispatch],\n  );\n\n  const deleteCorrelationHandler = useCallback(\n    (correlation: Correlation) => {\n      dispatch({\n        type: DELETE_CORRELATION,\n        payload: {\n          correlation,\n          assignmentData,\n        },\n      });\n    },\n    [assignmentData, dispatch],\n  );\n\n  const deleteSignalHandler = useCallback(\n    (link: Link) => {\n      // remove linking signal in spectrum\n      const linkDim = getLinkDim(link);\n      if (linkDim === 1) {\n        const spectrum = findSpectrum(\n          spectraData,\n          link.experimentID,\n          false,\n        ) as Datum1D;\n        const range = findRange(spectrum, link.signal.id);\n        const signal = findSignal1D(spectrum, link.signal.id);\n\n        dispatch({\n          type: DELETE_1D_SIGNAL,\n          payload: {\n            spectrum,\n            range,\n            signal,\n            assignmentData,\n          },\n        });\n      } else if (linkDim === 2) {\n        const spectrum = findSpectrum(\n          spectraData,\n          link.experimentID,\n          false,\n        ) as Datum2D;\n        const zone = findZone(spectrum, link.signal.id);\n        const signal = findSignal2D(spectrum, link.signal.id);\n\n        dispatch({\n          type: DELETE_2D_SIGNAL,\n          payload: {\n            spectrum,\n            zone,\n            signal,\n            assignmentData,\n          },\n        });\n      }\n    },\n    [assignmentData, dispatch, spectraData],\n  );\n\n  const changeSignalPathLengthHandler = useCallback(\n    (link: Link) => {\n      const linkDim = getLinkDim(link);\n      if (linkDim === 2) {\n        const spectrum = findSpectrum(\n          spectraData,\n          link.experimentID,\n          false,\n        ) as Datum2D;\n        const zone = findZone(spectrum, link.signal.id);\n        const signal = findSignal2D(spectrum, link.signal.id);\n\n        dispatch({\n          type: SET_2D_SIGNAL_PATH_LENGTH,\n          payload: {\n            spectrum,\n            zone,\n            signal,\n            pathLength: link.signal.j?.pathLength,\n          },\n        });\n      }\n    },\n    [dispatch, spectraData],\n  );\n\n  const editCorrelationTableCellHandler = useCallback(\n    (\n      editedCorrelations: Correlation[],\n      action: string,\n      link?: Link,\n      options?: CorrelationOptions,\n    ) => {\n      if (\n        action === 'add' ||\n        action === 'move' ||\n        action === 'remove' ||\n        action === 'unmove' ||\n        action === 'setPathLength'\n      ) {\n        if (link && link.pseudo === false) {\n          if (action === 'remove') {\n            deleteSignalHandler(link);\n          } else if (action === 'setPathLength') {\n            changeSignalPathLengthHandler(link);\n          }\n        }\n        setCorrelationsHandler(editedCorrelations, options);\n      } else if (action === 'removeAll') {\n        deleteCorrelationHandler(editedCorrelations[0]);\n      }\n    },\n    [\n      changeSignalPathLengthHandler,\n      deleteCorrelationHandler,\n      deleteSignalHandler,\n      setCorrelationsHandler,\n    ],\n  );\n\n  const handleOnFilter = useCallback(() => {\n    setFilterIsActive(!filterIsActive);\n  }, [filterIsActive]);\n\n  return (\n    <div css={panelStyle}>\n      <DefaultPanelHeader\n        canDelete={false}\n        counter={correlationsData ? correlationsData.values.length : 0}\n        onFilter={handleOnFilter}\n        filterToolTip={\n          filterIsActive\n            ? 'Show all correlations'\n            : 'Hide correlations out of view'\n        }\n        filterIsActive={filterIsActive}\n        counterFiltered={filteredCorrelationsData?.values.length}\n      >\n        <ToolTip\n          title={`Set molecular formula (${correlationsData.options.mf})`}\n          popupPlacement=\"right\"\n        >\n          <button type=\"button\" onClick={showSetMolecularFormulaModal}>\n            <FaFlask />\n          </button>\n        </ToolTip>\n        <ToolTip title={`Set shift tolerance`} popupPlacement=\"right\">\n          <button type=\"button\" onClick={showSetShiftToleranceModal}>\n            <FaSlidersH />\n          </button>\n        </ToolTip>\n        <div className=\"extra-header-content\">\n          <div className=\"overview-container\">\n            <Overview correlationsData={correlationsData} />\n          </div>\n          <div className=\"table-view-selection\">\n            <span>\n              <label>View:</label>\n              <Select\n                onChange={(selection) => {\n                  setSelectedAdditionalColumnsAtomType(selection);\n                  if (selection === 'H-H') {\n                    setShowProtonsAsRows(true);\n                  } else {\n                    setShowProtonsAsRows(false);\n                  }\n                }}\n                data={additionalColumnTypes}\n                defaultValue={selectedAdditionalColumnsAtomType}\n                style={{\n                  fontSize: '12px',\n                  width: '70px',\n                  height: '18px',\n                  border: '1px solid grey',\n                }}\n              />\n            </span>\n          </div>\n        </div>\n      </DefaultPanelHeader>\n      <CorrelationTable\n        correlationsData={correlationsData}\n        filteredCorrelationsData={filteredCorrelationsData}\n        additionalColumnData={additionalColumnData}\n        editEquivalencesSaveHandler={editEquivalencesSaveHandler}\n        onSaveEditNumericValues={editNumericValuesSaveHandler}\n        onEditCorrelationTableCellHandler={editCorrelationTableCellHandler}\n        showProtonsAsRows={showProtonsAsRows}\n        spectraData={spectraData}\n      />\n    </div>\n  );\n}\n\nexport default memo(SummaryPanel);\n","import {\n  useEffect,\n  useCallback,\n  useImperativeHandle,\n  useRef,\n  memo,\n  CSSProperties,\n  forwardRef,\n} from 'react';\n\nimport { usePreferences } from '../../context/PreferencesContext';\nimport IsotopesViewer from '../../elements/IsotopesViewer';\nimport FormikColumnFormatField from '../../elements/formik/FormikColumnFormatField';\nimport FormikForm from '../../elements/formik/FormikForm';\nimport { useAlert } from '../../elements/popup/Alert';\nimport useNucleus from '../../hooks/useNucleus';\nimport { getValue as getValueByKeyPath } from '../../utility/LocalStorage';\nimport { zoneDefaultValues } from '../extra/preferences/defaultValues';\n\nconst styles: Record<\n  'container' | 'groupContainer' | 'row' | 'header' | 'inputLabel' | 'input',\n  CSSProperties\n> = {\n  container: {\n    padding: 10,\n    backgroundColor: '#f1f1f1',\n    height: '100%',\n    overflowY: 'auto',\n  },\n  groupContainer: {\n    padding: '5px',\n    borderRadius: '5px',\n    margin: '10px 0px',\n    backgroundColor: 'white',\n  },\n  row: {\n    display: 'flex',\n    margin: '5px 0px',\n  },\n  header: {\n    borderBottom: '1px solid #e8e8e8',\n    paddingBottom: '5px',\n    fontWeight: 'bold',\n    color: '#4a4a4a',\n  },\n  inputLabel: {\n    flex: 2,\n    fontSize: '11px',\n    fontWeight: 'bold',\n    color: '#232323',\n  },\n  input: {\n    width: '30%',\n    textAlign: 'center',\n  },\n};\n\nconst formatFields: Array<{\n  id: number;\n  label: string;\n  checkController: string;\n  formatController: string;\n}> = [\n  {\n    id: 1,\n    label: 'From :',\n    checkController: 'showFrom',\n    formatController: 'fromFormat',\n  },\n  {\n    id: 2,\n    label: 'To :',\n    checkController: 'showTo',\n    formatController: 'toFormat',\n  },\n  {\n    id: 3,\n    label: 'Absolute :',\n    checkController: 'showAbsolute',\n    formatController: 'absoluteFormat',\n  },\n  {\n    id: 4,\n    label: 'Relative :',\n    checkController: 'showRelative',\n    formatController: 'relativeFormat',\n  },\n];\n\ninterface ZonesPreferencesInnerProps {\n  nucleus: Array<string>;\n  innerRef: any;\n}\n\nfunction ZonesPreferencesInner({\n  nucleus,\n  innerRef,\n}: ZonesPreferencesInnerProps) {\n  const alert = useAlert();\n  const preferences = usePreferences();\n  const formRef = useRef<any>();\n\n  const updateValues = useCallback(() => {\n    if (nucleus) {\n      const defaultValues = nucleus.reduce((acc, nucleusLabel) => {\n        acc[nucleusLabel] = zoneDefaultValues;\n        return acc;\n      }, {});\n      const zonesPreferences = getValueByKeyPath(\n        preferences.current,\n        `formatting.panels.zones`,\n      );\n      formRef.current.setValues(\n        zonesPreferences ? zonesPreferences : defaultValues,\n      );\n    }\n  }, [nucleus, preferences]);\n\n  useEffect(() => {\n    updateValues();\n  }, [updateValues]);\n\n  const saveHandler = useCallback(\n    (values) => {\n      preferences.dispatch({\n        type: 'SET_PANELS_PREFERENCES',\n        payload: { key: 'zones', value: values },\n      });\n      alert.success('zones preferences saved successfully');\n    },\n    [alert, preferences],\n  );\n\n  useImperativeHandle(\n    innerRef,\n    () => ({\n      saveSetting: () => {\n        formRef.current.submitForm();\n      },\n    }),\n    [],\n  );\n\n  return (\n    <div style={styles.container}>\n      <FormikForm onSubmit={saveHandler} ref={formRef}>\n        {nucleus?.map((nucleusLabel) => (\n          <div key={nucleusLabel} style={styles.groupContainer}>\n            <IsotopesViewer style={styles.header} value={nucleusLabel} />\n            {formatFields.map((field) => (\n              <FormikColumnFormatField\n                key={field.id}\n                label={field.label}\n                checkControllerName={`${nucleusLabel}.${field.checkController}`}\n                formatControllerName={`${nucleusLabel}.${field.formatController}`}\n              />\n            ))}\n          </div>\n        ))}\n      </FormikForm>\n    </div>\n  );\n}\n\nconst MemoizedZonesPreferences = memo(ZonesPreferencesInner);\n\n// TODO: remove this hacky use of ref.\nfunction ZonesPreferences(props, ref: any) {\n  const nucleus = useNucleus();\n  return <MemoizedZonesPreferences innerRef={ref} {...{ nucleus }} />;\n}\n\nexport default forwardRef(ZonesPreferences);\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useFormikContext } from 'formik';\n\nimport DefaultPathLengths from '../../../data/constants/DefaultPathLengths';\nimport FormikNumberInput from '../../elements/formik/FormikNumberInput';\n\nconst editPathLengthsStyles = css`\n  width: 100%;\n  height: 100%;\n  margin-top: 10px;\n  text-align: center;\n\n  .input-container {\n    width: 100%;\n    margin-top: 5px;\n    text-align: center;\n\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n\n    input::-webkit-outer-spin-button,\n    input::-webkit-inner-spin-button {\n      -webkit-appearance: none;\n    }\n  }\n\n  button {\n    flex: 2;\n    padding: 5px;\n    border: 1px solid gray;\n    border-radius: 5px;\n    height: 30px;\n    margin: 0 auto;\n    margin-top: 15px;\n    display: block;\n    width: 60px;\n\n    color: white;\n    background-color: gray;\n  }\n\n  .warning {\n    margin-top: 5px;\n    color: red;\n  }\n`;\n\ninterface InputProps {\n  signalIndex: number;\n}\n\nfunction EditPathLengthFormik({ signalIndex }: InputProps) {\n  const {\n    errors,\n    values,\n  }: {\n    values: any;\n    setFieldValue: (\n      field: string,\n      value: any,\n      shouldValidate?: boolean | undefined,\n    ) => void;\n    errors: any;\n  } = useFormikContext();\n\n  return (\n    <div css={editPathLengthsStyles}>\n      <p>Setting of the minimum and maximum path length (J coupling).</p>\n      <div className=\"input-container\">\n        <FormikNumberInput\n          name={`signals[${signalIndex}].j.pathLength.from`}\n          defaultValue={\n            values.signals[signalIndex].j?.pathLength?.from ||\n            DefaultPathLengths[values.experimentType]?.from ||\n            1\n          }\n          label=\"Min: \"\n          style={{\n            input: {\n              color: errors.signals?.[signalIndex].j?.pathLength?.from\n                ? 'red'\n                : 'black',\n            },\n          }}\n          min={1}\n          max={\n            values.signals[signalIndex].j?.pathLength?.to ||\n            DefaultPathLengths[values.experimentType]?.to\n          }\n          pattern=\"[1-9]+\"\n        />\n        <FormikNumberInput\n          name={`signals[${signalIndex}].j.pathLength.to`}\n          defaultValue={\n            values.signals[signalIndex].j?.pathLength?.to ||\n            DefaultPathLengths[values.experimentType]?.to ||\n            1\n          }\n          label=\"Max: \"\n          style={{\n            input: {\n              color: errors.signals?.[signalIndex].j?.pathLength?.to\n                ? 'red'\n                : 'black',\n            },\n          }}\n          min={\n            values.signals[signalIndex].j?.pathLength?.from ||\n            DefaultPathLengths[values.experimentType]?.from ||\n            1\n          }\n          pattern=\"[1-9]+\"\n        />\n      </div>\n    </div>\n  );\n}\n\nexport default EditPathLengthFormik;\n","import EditPathLengthFormik from './EditPathLengthFormik';\n\ninterface SignalFormTabProps {\n  signalIndex: number;\n}\n\nfunction SignalFormTab({ signalIndex }: SignalFormTabProps) {\n  return <EditPathLengthFormik signalIndex={signalIndex} />;\n}\n\nexport default SignalFormTab;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useFormikContext } from 'formik';\nimport { useCallback, useMemo } from 'react';\n\nimport Tab from '../../elements/Tab/Tab';\nimport Tabs from '../../elements/Tab/Tabs';\n\nimport SignalFormTab from './SignalFormTab';\n\nconst textStyles = css`\n  text-align: center;\n  width: 100%;\n\n  .errorText {\n    color: red;\n  }\n\n  .infoText {\n    padding: 10px;\n    margin: 10px 0;\n    font-size: 14px;\n    text-align: left;\n    color: white;\n    background-color: #5f5f5f;\n    border-radius: 5px;\n  }\n`;\n\nconst tabStylesAddition = css`\n  color: red;\n`;\nconst tabStyles = css`\n  display: inline-grid;\n  list-style: none;\n  padding: 0.5rem 1.5rem;\n`;\n\nfunction SignalsForm() {\n  const {\n    values,\n    setFieldValue,\n    errors,\n  }: {\n    values: any;\n    setFieldValue: (\n      field: string,\n      value: any,\n      shouldValidate?: boolean | undefined,\n    ) => void;\n    errors: any;\n  } = useFormikContext<any>();\n\n  const tabContainsErrors = useCallback(\n    (i) => {\n      return errors?.signals && errors?.signals[i] ? true : false;\n    },\n    [errors],\n  );\n\n  const signalFormTabs = useMemo(() => {\n    const signalTabs =\n      values.signals.length > 0\n        ? values.signals.map((signal, i) => (\n            <Tab\n              // eslint-disable-next-line react/no-array-index-key\n              key={`signalForm_zone${i}`}\n              tabid={`${i}`}\n              tabstyles={tabContainsErrors(i) ? tabStylesAddition : tabStyles}\n              render={() => (\n                <div\n                  style={{\n                    display: 'flex',\n                    flexDirection: 'column',\n                    alignItems: 'center',\n                    fontSize: '11px',\n                  }}\n                >\n                  <span>\n                    𝛅<sub>{signal.x.nucleus}</sub>: {signal.x.delta.toFixed(2)}\n                  </span>\n                  <span>\n                    𝛅<sub>{signal.y.nucleus}</sub>: {signal.y.delta.toFixed(2)}\n                  </span>\n                </div>\n              )}\n            >\n              <SignalFormTab signalIndex={i} />\n            </Tab>\n          ))\n        : [];\n\n    return signalTabs;\n  }, [tabContainsErrors, values.signals]);\n\n  const tapClickHandler = useCallback(\n    ({ tabid }) => {\n      setFieldValue('activeTab', tabid);\n    },\n    [setFieldValue],\n  );\n\n  const handleDeleteSignal = useCallback(\n    ({ tabid }) => {\n      const _signals = values.signals.filter(\n        (_signal, i) => i !== Number(tabid),\n      );\n      setFieldValue('signals', _signals);\n    },\n    [setFieldValue, values.signals],\n  );\n\n  return (\n    <div>\n      <div css={textStyles} />\n      <Tabs\n        activeTab={values.activeTab}\n        onClick={tapClickHandler}\n        onDelete={handleDeleteSignal}\n      >\n        {signalFormTabs}\n      </Tabs>\n    </div>\n  );\n}\n\nexport default SignalsForm;\n","import { useMemo } from 'react';\nimport * as Yup from 'yup';\n\nconst useValidation = () =>\n  useMemo(() => {\n    return Yup.object().shape({\n      signals: Yup.array()\n        .of(\n          Yup.object().shape({\n            j: Yup.object().shape({\n              pathLength: Yup.object().shape({\n                from: Yup.number().required().positive().integer(),\n                to: Yup.number().required().positive().integer(),\n              }),\n            }),\n          }),\n        )\n        .min(1, 'There must be at least one signal in a zone!'),\n    });\n  }, []);\n\nexport default useValidation;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { FromTo } from 'cheminfo-types';\nimport { useCallback, useEffect, useMemo, useRef } from 'react';\nimport { FaSearchPlus } from 'react-icons/fa';\n\nimport DefaultPathLengths from '../../../data/constants/DefaultPathLengths';\nimport { Signal2D } from '../../../data/types/data2d';\nimport Button from '../../elements/Button';\nimport CloseButton from '../../elements/CloseButton';\nimport SaveButton from '../../elements/SaveButton';\nimport FormikForm from '../../elements/formik/FormikForm';\n\nimport SignalsForm from './SignalsForm';\nimport useRangeFormValidation from './validation/EditZoneValidation';\nimport isDefaultPathLength from './validation/isDefaultPathLength';\n\nconst styles = css`\n  width: 500px;\n  height: 250px;\n  padding: 5px;\n  button:focus {\n    outline: none;\n  }\n  .header {\n    height: 24px;\n    border-bottom: 1px solid #f0f0f0;\n    display: flex;\n    align-items: center;\n    span {\n      color: #464646;\n      font-size: 15px;\n      flex: 1;\n      border-left: 1px solid #ececec;\n      padding-left: 6px;\n    }\n\n    button {\n      background-color: transparent;\n      border: none;\n      padding: 5px;\n\n      svg {\n        height: 16px;\n      }\n    }\n  }\n  .container {\n    display: flex;\n    margin: 30px 5px;\n  }\n`;\n\ninterface EditZoneModalProps {\n  onSaveEditZoneModal: (value: any) => Promise<void> | null | void;\n  onCloseEditZoneModal: () => void;\n  onZoomEditZoneModal: (value: any) => void;\n  rowData: any;\n}\n\nfunction EditZoneModal({\n  onSaveEditZoneModal = () => null,\n  onCloseEditZoneModal = () => null,\n  onZoomEditZoneModal = () => null,\n  rowData,\n}: EditZoneModalProps) {\n  const formRef = useRef<any>(null);\n  const validation = useRangeFormValidation();\n\n  const handleOnZoom = useCallback(() => {\n    onZoomEditZoneModal(rowData);\n  }, [onZoomEditZoneModal, rowData]);\n\n  useEffect(() => {\n    handleOnZoom();\n  }, [handleOnZoom]);\n\n  const handleOnClose = useCallback(() => {\n    onCloseEditZoneModal();\n  }, [onCloseEditZoneModal]);\n\n  const handleOnSave = useCallback(\n    (formValues) => {\n      void (async () => {\n        const _rowData = {\n          ...rowData,\n          signals: formValues.signals.map((signal: Signal2D) => {\n            if (\n              isDefaultPathLength(\n                signal.j?.pathLength as FromTo,\n                rowData.tableMetaInfo.experiment,\n              )\n            ) {\n              delete signal.j?.pathLength;\n              if (signal.j && Object.keys(signal.j).length === 0) {\n                delete signal.j;\n              }\n            }\n\n            return signal;\n          }),\n        };\n\n        await onSaveEditZoneModal(_rowData);\n        handleOnClose();\n      })();\n    },\n    [handleOnClose, onSaveEditZoneModal, rowData],\n  );\n\n  const data = useMemo(() => {\n    return {\n      activeTab: '0',\n      signals: rowData.signals.map((signal: Signal2D): Signal2D => {\n        return {\n          ...signal,\n          j: {\n            pathLength: {\n              from:\n                DefaultPathLengths[rowData.tableMetaInfo.experiment]?.from || 1,\n              to: DefaultPathLengths[rowData.tableMetaInfo.experiment]?.to || 1,\n            },\n            ...signal.j,\n          },\n        };\n      }),\n    };\n  }, [rowData.signals, rowData.tableMetaInfo.experiment]);\n\n  return (\n    <div css={styles}>\n      <FormikForm\n        ref={formRef}\n        initialValues={data}\n        validationSchema={validation}\n        onSubmit={handleOnSave}\n      >\n        <div className=\"header handle\">\n          <Button onClick={handleOnZoom} className=\"zoom-button\">\n            <FaSearchPlus title=\"Set to default view on range in spectrum\" />\n          </Button>\n          <span>{`Zone and Signal edition`}</span>\n          <SaveButton\n            onClick={() => formRef.current.submitForm()}\n            popupTitle=\"Save and exit\"\n          />\n          <CloseButton onClick={handleOnClose} />\n        </div>\n        <SignalsForm />\n      </FormikForm>\n    </div>\n  );\n}\n\nexport default EditZoneModal;\n","import { CSSProperties, Fragment, useCallback } from 'react';\nimport { FaEdit, FaRegTrashAlt, FaSearchPlus } from 'react-icons/fa';\n\nimport { SignalKinds } from '../../../../data/constants/SignalsKinds';\nimport { useAssignmentData } from '../../../assignment/AssignmentsContext';\nimport { useDispatch } from '../../../context/DispatchContext';\nimport Select from '../../../elements/Select';\nimport {\n  useModal,\n  positions,\n  transitions,\n} from '../../../elements/popup/Modal';\nimport EditZoneModal from '../../../modal/editZone/EditZoneModal';\nimport {\n  CHANGE_ZONE_SIGNAL_KIND,\n  DELETE_2D_ZONE,\n  SAVE_EDITED_ZONE,\n  SET_SELECTED_TOOL,\n  SET_X_DOMAIN,\n  SET_Y_DOMAIN,\n} from '../../../reducer/types/Types';\nimport { options } from '../../../toolbar/ToolTypes';\n\nconst selectBoxStyle: CSSProperties = {\n  marginLeft: 2,\n  marginRight: 2,\n  border: 'none',\n  height: '20px',\n};\n\nexport interface RowDataProps {\n  id: number;\n  tableMetaInfo: {\n    id: number;\n    signalIndex: number;\n    rowSpan: any;\n    signal: {\n      kind: any;\n    };\n    experiment: string;\n  };\n  x: {\n    from: number;\n    to: number;\n  };\n  y: {\n    from: number;\n    to: number;\n  };\n}\n\ninterface ActionsColumnProps {\n  rowData: RowDataProps;\n  rowSpanTags: any;\n}\n\nfunction ActionsColumn({ rowData, rowSpanTags }: ActionsColumnProps) {\n  const dispatch = useDispatch();\n  const assignmentData = useAssignmentData();\n  const modal = useModal();\n\n  const changeSignalKindHandler = useCallback(\n    (value) => {\n      dispatch({\n        type: CHANGE_ZONE_SIGNAL_KIND,\n        payload: {\n          rowData,\n          value,\n        },\n      });\n    },\n    [dispatch, rowData],\n  );\n\n  const deleteZoneHandler = useCallback(() => {\n    dispatch({\n      type: DELETE_2D_ZONE,\n      payload: {\n        id: rowData.id,\n        assignmentData,\n      },\n    });\n  }, [assignmentData, dispatch, rowData]);\n\n  const zoomZoneHandler = useCallback(() => {\n    const xMargin = Math.abs(rowData.x.from - rowData.x.to) * 10;\n    dispatch({\n      type: SET_X_DOMAIN,\n      xDomain:\n        rowData.x.from <= rowData.x.to\n          ? [rowData.x.from - xMargin, rowData.x.to + xMargin]\n          : [rowData.x.to - xMargin, rowData.x.from + xMargin],\n    });\n    const yMargin = Math.abs(rowData.y.from - rowData.y.to) * 10;\n    dispatch({\n      type: SET_Y_DOMAIN,\n      yDomain:\n        rowData.y.from <= rowData.y.to\n          ? [rowData.y.from - yMargin, rowData.y.to + yMargin]\n          : [rowData.y.to - yMargin, rowData.y.from + yMargin],\n    });\n  }, [dispatch, rowData.x.from, rowData.x.to, rowData.y.from, rowData.y.to]);\n\n  const saveEditZoneHandler = useCallback(\n    (editedRowData) => {\n      dispatch({\n        type: SAVE_EDITED_ZONE,\n        payload: {\n          editedRowData,\n        },\n      });\n    },\n    [dispatch],\n  );\n\n  const openEditZoneHandler = useCallback(() => {\n    dispatch({\n      type: SET_SELECTED_TOOL,\n      payload: { selectedTool: options.editRange.id, tempRange: rowData },\n    });\n    modal.show(\n      <EditZoneModal\n        onCloseEditZoneModal={() => modal.close()}\n        onSaveEditZoneModal={saveEditZoneHandler}\n        onZoomEditZoneModal={() => zoomZoneHandler()}\n        rowData={rowData}\n      />,\n      {\n        position: positions.MIDDLE_RIGHT,\n        transition: transitions.SCALE,\n        isBackgroundBlur: false,\n      },\n    );\n  }, [dispatch, modal, rowData, saveEditZoneHandler, zoomZoneHandler]);\n\n  return (\n    <Fragment>\n      <td>\n        <Select\n          onChange={(value) => {\n            changeSignalKindHandler(value);\n          }}\n          data={SignalKinds}\n          defaultValue={rowData.tableMetaInfo.signal.kind}\n          style={selectBoxStyle}\n        />\n      </td>\n      <td {...rowSpanTags}>\n        <button\n          type=\"button\"\n          className=\"delete-button\"\n          onClick={deleteZoneHandler}\n        >\n          <FaRegTrashAlt />\n        </button>\n        <button type=\"button\" className=\"zoom-button\" onClick={zoomZoneHandler}>\n          <FaSearchPlus title=\"Zoom to zone in spectrum\" />\n        </button>\n        <button\n          type=\"button\"\n          className=\"edit-button\"\n          onClick={openEditZoneHandler}\n        >\n          <FaEdit color=\"blue\" />\n        </button>\n      </td>\n    </Fragment>\n  );\n}\n\nexport default ActionsColumn;\n","import lodashGet from 'lodash/get';\nimport { FaMinusCircle } from 'react-icons/fa';\n\nimport { AssignmentsData, Axis } from '../../../assignment/AssignmentsContext';\n\nimport { RowDataProps } from './ActionsColumn';\n\nexport interface SignalAssignmentsColumnProps {\n  rowData: RowDataProps;\n  assignment: AssignmentsData;\n  // assignment: {\n  //   isActive: any;\n  //   activeAxis: any;\n  // };\n  highlight: {\n    isActive: any;\n  };\n  onHover: () => void;\n  onClick: (event: any, assignment: AssignmentsData, axis: Axis) => void;\n  onUnlink: (event: any, flag: boolean, axis: Axis) => void;\n  showUnlinkButton: boolean;\n  axis: Axis;\n  setShowUnlinkButton: (element: boolean) => void;\n}\n\nfunction SignalAssignmentsColumn({\n  rowData,\n  assignment,\n  highlight,\n  onHover,\n  onClick,\n  onUnlink,\n  axis,\n  showUnlinkButton,\n  setShowUnlinkButton,\n}: SignalAssignmentsColumnProps) {\n  return (\n    <td\n      {...onHover}\n      {...{ onClick: (e) => onClick(e, assignment, axis) }}\n      style={\n        highlight.isActive ||\n        (assignment.isActive && assignment.activated?.axis === axis)\n          ? {\n              color: 'red',\n              fontWeight: 'bold',\n            }\n          : undefined\n      }\n    >\n      {lodashGet(rowData, `tableMetaInfo.signal.${axis}.diaIDs`, []).length >\n      0 ? (\n        <div\n          onMouseEnter={() => setShowUnlinkButton(true)}\n          onMouseLeave={() => setShowUnlinkButton(false)}\n        >\n          {rowData.tableMetaInfo.signal[axis].diaIDs.length}{' '}\n          <sup>\n            <button\n              type=\"button\"\n              style={{\n                visibility: showUnlinkButton ? 'visible' : 'hidden',\n                padding: 0,\n                margin: 0,\n              }}\n              onClick={(e) => onUnlink(e, false, axis)}\n            >\n              <FaMinusCircle color=\"red\" />\n            </button>\n          </sup>\n        </div>\n      ) : assignment.isActive && assignment.activated?.axis === axis ? (\n        '0'\n      ) : (\n        ''\n      )}\n    </td>\n  );\n}\n\nexport default SignalAssignmentsColumn;\n","import { Fragment } from 'react';\n\nimport { AssignmentsData, Axis } from '../../../assignment/AssignmentsContext';\n\nimport { RowDataProps } from './ActionsColumn';\nimport SignalAssignmentsColumn from './SignalAssignmentsColumn';\n\ninterface SignalAssignmentsColumnsProps {\n  rowData: RowDataProps;\n  onHoverSignalX: any;\n  onHoverSignalY: any;\n  showUnlinkButtonSignalX: boolean;\n  showUnlinkButtonSignalY: boolean;\n  setShowUnlinkButtonSignalX: (element: boolean) => void;\n  setShowUnlinkButtonSignalY: (element: boolean) => void;\n  onClick: (event: any, assignment: AssignmentsData, axis: Axis) => void;\n  onUnlink: (event: any, flag: boolean, axis: Axis) => void;\n  highlightSignalX: {\n    isActive: any;\n  };\n  highlightSignalY: {\n    isActive: any;\n  };\n  assignmentSignal: AssignmentsData;\n}\n\nfunction SignalAssignmentsColumns({\n  rowData,\n  assignmentSignal,\n  onHoverSignalX,\n  onHoverSignalY,\n  showUnlinkButtonSignalX,\n  showUnlinkButtonSignalY,\n  setShowUnlinkButtonSignalX,\n  setShowUnlinkButtonSignalY,\n  onClick,\n  onUnlink,\n  highlightSignalX,\n  highlightSignalY,\n}: SignalAssignmentsColumnsProps) {\n  return (\n    <Fragment>\n      <SignalAssignmentsColumn\n        rowData={rowData}\n        assignment={assignmentSignal}\n        highlight={highlightSignalX}\n        onHover={onHoverSignalX}\n        onClick={onClick}\n        onUnlink={onUnlink}\n        axis=\"x\"\n        showUnlinkButton={showUnlinkButtonSignalX}\n        setShowUnlinkButton={setShowUnlinkButtonSignalX}\n      />\n      <SignalAssignmentsColumn\n        rowData={rowData}\n        assignment={assignmentSignal}\n        highlight={highlightSignalY}\n        onHover={onHoverSignalY}\n        onClick={onClick}\n        onUnlink={onUnlink}\n        axis=\"y\"\n        showUnlinkButton={showUnlinkButtonSignalY}\n        setShowUnlinkButton={setShowUnlinkButtonSignalY}\n      />\n    </Fragment>\n  );\n}\n\nexport default SignalAssignmentsColumns;\n","import lodashGet from 'lodash/get';\nimport { Fragment, useCallback } from 'react';\n\nimport { useDispatch } from '../../../context/DispatchContext';\nimport EditableColumn from '../../../elements/EditableColumn';\nimport { CHANGE_ZONE_SIGNAL_VALUE } from '../../../reducer/types/Types';\n\nimport { RowDataProps } from './ActionsColumn';\n\ninterface SignalDeltaColumnProps {\n  rowData: RowDataProps;\n  onHoverSignalX: any;\n  onHoverSignalY: any;\n}\n\nfunction SignalDeltaColumn({\n  rowData,\n  onHoverSignalX,\n  onHoverSignalY,\n}: SignalDeltaColumnProps) {\n  const dispatch = useDispatch();\n\n  const signalDeltaX = lodashGet(rowData, 'tableMetaInfo.signal.x.delta', null);\n  const signalDeltaY = lodashGet(rowData, 'tableMetaInfo.signal.y.delta', null);\n  const id = lodashGet(rowData, 'tableMetaInfo.signal.id', undefined);\n\n  const saveXHandler = useCallback(\n    (event) => {\n      const value = event.target.value;\n      dispatch({\n        type: CHANGE_ZONE_SIGNAL_VALUE,\n        payload: {\n          zoneID: rowData.id,\n          signal: { id, x: value },\n        },\n      });\n    },\n    [dispatch, id, rowData.id],\n  );\n  const saveYHandler = useCallback(\n    (event) => {\n      const value = event.target.value;\n      dispatch({\n        type: CHANGE_ZONE_SIGNAL_VALUE,\n        payload: {\n          zoneID: rowData.id,\n          signal: { id, y: value },\n        },\n      });\n    },\n    [dispatch, id, rowData.id],\n  );\n\n  return (\n    <Fragment>\n      <td {...onHoverSignalX}>\n        {signalDeltaX !== null ? (\n          <EditableColumn\n            value={signalDeltaX.toFixed(2)}\n            onSave={saveXHandler}\n            type=\"number\"\n            style={{ padding: '0.1rem 0.4rem' }}\n          />\n        ) : (\n          ''\n        )}\n      </td>\n      <td {...onHoverSignalY}>\n        {signalDeltaY !== null ? (\n          <EditableColumn\n            value={signalDeltaY.toFixed(2)}\n            onSave={saveYHandler}\n            type=\"number\"\n            style={{ padding: '0.1rem 0.4rem' }}\n          />\n        ) : (\n          ''\n        )}\n      </td>\n    </Fragment>\n  );\n}\n\nexport default SignalDeltaColumn;\n","import lodashGet from 'lodash/get';\nimport { MouseEvent } from 'react';\nimport { FaMinusCircle } from 'react-icons/fa';\n\nimport { AssignmentsData, Axis } from '../../../assignment/AssignmentsContext';\n\nimport { RowDataProps } from './ActionsColumn';\n\nexport interface ZoneAssignmentColumnProps {\n  rowData: RowDataProps;\n  axis: any;\n  onHover: () => void;\n  onClick: (event: MouseEvent, assignment: AssignmentsData, axis: Axis) => void;\n  onUnlink: (event: MouseEvent, flag: boolean, axis: Axis) => void;\n  highlight: {\n    isActive: any;\n  };\n\n  assignment: AssignmentsData;\n  showUnlinkButton: boolean;\n  setShowUnlinkButton: (element: boolean) => void;\n  rowSpanTags: any;\n}\n\nfunction ZoneAssignmentColumn({\n  rowData,\n  assignment,\n  highlight,\n  onHover,\n  onClick,\n  onUnlink,\n  axis,\n  showUnlinkButton,\n  setShowUnlinkButton,\n  rowSpanTags,\n}: ZoneAssignmentColumnProps) {\n  return (\n    <td\n      {...rowSpanTags}\n      {...onHover}\n      {...{ onClick: (e) => onClick(e, assignment, axis) }}\n    >\n      {lodashGet(rowData, `${axis}.nbAtoms`, 0) > 0 ? (\n        lodashGet(rowData, `${axis}.diaIDs`, 0).length > 0 ? (\n          <div\n            onMouseEnter={() => setShowUnlinkButton(true)}\n            onMouseLeave={() => setShowUnlinkButton(false)}\n          >\n            {rowData[axis].nbAtoms} {`(`}\n            <span\n              style={\n                (assignment.isActive && assignment.activated?.axis === axis) ||\n                (assignment.isOver && assignment.highlighted?.axis === axis) ||\n                highlight.isActive\n                  ? {\n                      color: 'red',\n                      fontWeight: 'bold',\n                    }\n                  : { color: 'black', fontWeight: 'normal' }\n              }\n            >\n              {lodashGet(rowData, `${axis}.diaIDs`, []).length}\n            </span>\n            {`)`}{' '}\n            <sup>\n              <button\n                type=\"button\"\n                style={{\n                  visibility: showUnlinkButton ? 'visible' : 'hidden',\n                  padding: 0,\n                  margin: 0,\n                }}\n                onClick={(e) => onUnlink(e, true, axis)}\n              >\n                <FaMinusCircle color=\"red\" />\n              </button>\n            </sup>\n          </div>\n        ) : assignment.isActive && assignment.activated?.axis === axis ? (\n          <div>\n            {`${lodashGet(rowData, `${axis}.nbAtoms`, '')} (`}\n            <span\n              style={{\n                color: 'red',\n                fontWeight: 'bold',\n              }}\n            >\n              0\n            </span>\n            {')'}\n          </div>\n        ) : (\n          rowData[axis].nbAtoms\n        )\n      ) : assignment.isActive && assignment.activated?.axis === axis ? (\n        <div>\n          {'0 ('}\n          <span style={{ color: 'red', fontWeight: 'bold' }}>0</span>\n          {')'}\n        </div>\n      ) : (\n        ''\n      )}\n    </td>\n  );\n}\n\nexport default ZoneAssignmentColumn;\n","import { Fragment } from 'react';\n\nimport { AssignmentsData, Axis } from '../../../assignment/AssignmentsContext';\n\nimport { RowDataProps } from './ActionsColumn';\nimport ZoneAssignmentColumn from './ZoneAssignmentsColumn';\n\ninterface ZoneAssignmentsColumnsProps {\n  rowData: RowDataProps;\n  onHoverZoneX: any;\n  onHoverZoneY: any;\n  onClick: (event: any, assignment: AssignmentsData, axis: Axis) => void;\n  onUnlink: (event: any, flag: boolean, axis: Axis) => void;\n  rowSpanTags: any;\n  showUnlinkButtonZoneX: boolean;\n  showUnlinkButtonZoneY: boolean;\n  setShowUnlinkButtonZoneX: (element: boolean) => void;\n  setShowUnlinkButtonZoneY: (element: boolean) => void;\n  assignmentZone: AssignmentsData;\n  highlightZoneX: {\n    isActive: any;\n  };\n  highlightZoneY: {\n    isActive: any;\n  };\n}\n\nfunction ZoneAssignmentsColumns({\n  rowData,\n  assignmentZone,\n  onHoverZoneX,\n  onHoverZoneY,\n  showUnlinkButtonZoneX,\n  showUnlinkButtonZoneY,\n  setShowUnlinkButtonZoneX,\n  setShowUnlinkButtonZoneY,\n  rowSpanTags,\n  onClick,\n  onUnlink,\n  highlightZoneX,\n  highlightZoneY,\n}: ZoneAssignmentsColumnsProps) {\n  return (\n    <Fragment>\n      <ZoneAssignmentColumn\n        rowData={rowData}\n        assignment={assignmentZone}\n        highlight={highlightZoneX}\n        onHover={onHoverZoneX}\n        onClick={onClick}\n        onUnlink={onUnlink}\n        axis={'x'}\n        showUnlinkButton={showUnlinkButtonZoneX}\n        setShowUnlinkButton={setShowUnlinkButtonZoneX}\n        rowSpanTags={rowSpanTags}\n      />\n      <ZoneAssignmentColumn\n        rowData={rowData}\n        assignment={assignmentZone}\n        highlight={highlightZoneY}\n        onHover={onHoverZoneY}\n        onClick={onClick}\n        onUnlink={onUnlink}\n        axis={'y'}\n        showUnlinkButton={showUnlinkButtonZoneY}\n        setShowUnlinkButton={setShowUnlinkButtonZoneY}\n        rowSpanTags={rowSpanTags}\n      />\n    </Fragment>\n  );\n}\n\nexport default ZoneAssignmentsColumns;\n","/** @jsxImportSource @emotion/react */\n\nimport lodashGet from 'lodash/get';\nimport {\n  CSSProperties,\n  useMemo,\n  useCallback,\n  useState,\n  MouseEvent,\n} from 'react';\n\nimport { buildID } from '../../../data/utilities/Concatenation';\nimport {\n  Axis,\n  useAssignment,\n  AssignmentsData,\n} from '../../assignment/AssignmentsContext';\nimport { useHighlight } from '../../highlight';\n\nimport ActionsColumn, { RowDataProps } from './TableColumns/ActionsColumn';\nimport SignalAssignmentsColumns from './TableColumns/SignalAssignmentsColumns';\nimport SignalDeltaColumn from './TableColumns/SignalDeltaColumn';\nimport ZoneAssignmentsColumns from './TableColumns/ZoneAssignmentsColumns';\n\nconst HighlightedRowStyle: CSSProperties = { backgroundColor: '#ff6f0057' };\n\nconst ConstantlyHighlightedRowStyle = { backgroundColor: '#f5f5dc' };\n\ninterface ZonesTableRowProps {\n  rowData: RowDataProps;\n  onUnlink: (\n    rowData: RowDataProps,\n    isOnZoneLevel: boolean,\n    signalIndex: any,\n    axis: Axis,\n  ) => void;\n  onContextMenu: (a: any, rowData: RowDataProps) => void;\n  rowIndex: number;\n}\n\nfunction ZonesTableRow({\n  rowData,\n  onUnlink,\n  onContextMenu,\n  rowIndex,\n}: ZonesTableRowProps) {\n  const assignmentZone = useAssignment(rowData.id);\n  const highlightZone = useHighlight([assignmentZone.id]);\n  const highlightZoneX = useHighlight(\n    [buildID(assignmentZone.id, 'X')].concat(assignmentZone.assigned?.x || []),\n  );\n\n  const highlightZoneY = useHighlight(\n    [buildID(assignmentZone.id, 'Y')].concat(assignmentZone.assigned?.y || []),\n  );\n\n  const assignmentSignal = useAssignment(rowData.tableMetaInfo.id);\n  const highlightSignalX = useHighlight(\n    [buildID(assignmentSignal.id, 'X')].concat(\n      assignmentSignal.assigned?.x || [],\n      buildID(assignmentSignal.id, 'Crosshair'),\n    ),\n  );\n  const highlightSignalY = useHighlight(\n    [buildID(assignmentSignal.id, 'Y')].concat(\n      assignmentSignal.assigned?.y || [],\n      buildID(assignmentSignal.id, 'Crosshair'),\n    ),\n  );\n\n  const [showUnlinkButtonZoneX, setShowUnlinkButtonZoneX] = useState(false);\n  const [showUnlinkButtonZoneY, setShowUnlinkButtonZoneY] = useState(false);\n  const [showUnlinkButtonSignalX, setShowUnlinkButtonSignalX] = useState(false);\n  const [showUnlinkButtonSignalY, setShowUnlinkButtonSignalY] = useState(false);\n\n  const rowSpanTags = useMemo(() => {\n    return {\n      rowSpan: rowData.tableMetaInfo.rowSpan,\n      style:\n        lodashGet(rowData, 'tableMetaInfo.hide', false) === true\n          ? { display: 'none' }\n          : null,\n    };\n  }, [rowData]);\n\n  const unlinkHandler = useCallback(\n    (event: MouseEvent, isOnZoneLevel: boolean, axis: Axis) => {\n      // event handling here in case of unlink button clicked\n      if (event) {\n        event.stopPropagation();\n      }\n      onUnlink(rowData, isOnZoneLevel, rowData.tableMetaInfo.signalIndex, axis);\n      if (axis === 'x') {\n        if (isOnZoneLevel !== undefined) {\n          if (isOnZoneLevel) {\n            setShowUnlinkButtonZoneX(false);\n            assignmentZone.removeAll('x');\n          } else {\n            setShowUnlinkButtonSignalX(false);\n            assignmentSignal.removeAll('x');\n          }\n        } else {\n          setShowUnlinkButtonZoneX(false);\n          setShowUnlinkButtonSignalX(false);\n        }\n      } else if (axis === 'y') {\n        if (isOnZoneLevel !== undefined) {\n          if (isOnZoneLevel) {\n            setShowUnlinkButtonZoneY(false);\n            assignmentZone.removeAll('y');\n          } else {\n            setShowUnlinkButtonSignalY(false);\n            assignmentSignal.removeAll('y');\n          }\n        } else {\n          setShowUnlinkButtonZoneY(false);\n          setShowUnlinkButtonSignalY(false);\n        }\n      } else {\n        setShowUnlinkButtonZoneX(false);\n        assignmentZone.removeAll('x');\n        setShowUnlinkButtonSignalX(false);\n        assignmentSignal.removeAll('x');\n        setShowUnlinkButtonZoneY(false);\n        assignmentZone.removeAll('y');\n        setShowUnlinkButtonSignalY(false);\n        assignmentSignal.removeAll('y');\n      }\n    },\n    [assignmentSignal, assignmentZone, onUnlink, rowData],\n  );\n\n  const clickHandler = useCallback(\n    (event: MouseEvent, assignment: AssignmentsData, axis: Axis) => {\n      event.stopPropagation();\n      assignment.setActive(axis);\n    },\n    [],\n  );\n\n  const onHoverZoneX = useMemo(() => {\n    return {\n      onMouseEnter: () => {\n        assignmentZone.show('x');\n        highlightZoneX.show();\n      },\n      onMouseLeave: () => {\n        assignmentZone.hide();\n        highlightZoneX.hide();\n      },\n    };\n  }, [assignmentZone, highlightZoneX]);\n\n  const onHoverZoneY = useMemo(() => {\n    return {\n      onMouseEnter: () => {\n        assignmentZone.show('y');\n        highlightZoneY.show();\n      },\n      onMouseLeave: () => {\n        assignmentZone.hide();\n        highlightZoneY.hide();\n      },\n    };\n  }, [assignmentZone, highlightZoneY]);\n\n  const onHoverSignalX = useMemo(() => {\n    return {\n      onMouseEnter: () => {\n        assignmentSignal.show('x');\n        highlightSignalX.show();\n      },\n      onMouseLeave: () => {\n        assignmentSignal.hide();\n        highlightSignalX.hide();\n      },\n    };\n  }, [assignmentSignal, highlightSignalX]);\n\n  const onHoverSignalY = useMemo(() => {\n    return {\n      onMouseEnter: () => {\n        assignmentSignal.show('y');\n        highlightSignalY.show();\n      },\n      onMouseLeave: () => {\n        assignmentSignal.hide();\n        highlightSignalY.hide();\n      },\n    };\n  }, [assignmentSignal, highlightSignalY]);\n\n  return (\n    <tr\n      onContextMenu={(e) => onContextMenu(e, rowData)}\n      style={\n        highlightZone.isActive || assignmentZone.isActive\n          ? (HighlightedRowStyle as any)\n          : lodashGet(\n              rowData,\n              'tableMetaInfo.isConstantlyHighlighted',\n              false,\n            ) === true\n          ? ConstantlyHighlightedRowStyle\n          : null\n      }\n      {...highlightZone.onHover}\n    >\n      <td {...(rowSpanTags as any)}>{rowIndex + 1}</td>\n      <SignalDeltaColumn\n        rowData={rowData}\n        onHoverSignalX={onHoverSignalX}\n        onHoverSignalY={onHoverSignalY}\n      />\n      <SignalAssignmentsColumns\n        rowData={rowData}\n        assignmentSignal={assignmentSignal}\n        onHoverSignalX={onHoverSignalX}\n        onHoverSignalY={onHoverSignalY}\n        showUnlinkButtonSignalX={showUnlinkButtonSignalX}\n        showUnlinkButtonSignalY={showUnlinkButtonSignalY}\n        setShowUnlinkButtonSignalX={(show) => setShowUnlinkButtonSignalX(show)}\n        setShowUnlinkButtonSignalY={(show) => setShowUnlinkButtonSignalY(show)}\n        onClick={clickHandler}\n        onUnlink={unlinkHandler}\n        highlightSignalX={highlightSignalX}\n        highlightSignalY={highlightSignalY}\n      />\n      <ZoneAssignmentsColumns\n        rowData={rowData}\n        assignmentZone={assignmentZone}\n        onHoverZoneX={onHoverZoneX}\n        onHoverZoneY={onHoverZoneY}\n        showUnlinkButtonZoneX={showUnlinkButtonZoneX}\n        showUnlinkButtonZoneY={showUnlinkButtonZoneY}\n        setShowUnlinkButtonZoneX={(show) => setShowUnlinkButtonZoneX(show)}\n        setShowUnlinkButtonZoneY={(show) => setShowUnlinkButtonZoneY(show)}\n        rowSpanTags={rowSpanTags}\n        onClick={clickHandler}\n        onUnlink={unlinkHandler}\n        highlightZoneX={highlightZoneX}\n        highlightZoneY={highlightZoneY}\n      />\n      <ActionsColumn rowData={rowData} rowSpanTags={rowSpanTags} />\n    </tr>\n  );\n}\n\nexport default ZonesTableRow;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useMemo, useCallback, useRef, ReactNode } from 'react';\nimport { FaLink } from 'react-icons/fa';\n\nimport checkModifierKeyActivated from '../../../data/utilities/checkModifierKeyActivated';\nimport ContextMenu from '../../elements/ContextMenu';\nimport useTableSortBy from '../../hooks/useTableSortBy';\n\nimport ZonesTableRow from './ZonesTableRow';\n\nconst tableStyle = css`\n  border-spacing: 0;\n  border: 1px solid #dedede;\n  width: 100%;\n  font-size: 12px;\n  .react-contextmenu-wrapper {\n    display: contents;\n  }\n  tr {\n    :last-child {\n      td {\n        border-bottom: 0;\n      }\n    }\n  }\n  thead tr:nth-of-type(1) th {\n    top: 0;\n  }\n  thead tr:nth-of-type(2) th {\n    top: 21px;\n  }\n  th {\n    position: sticky;\n    background-color: white;\n    z-index: 2;\n  }\n  th,\n  td {\n    white-space: nowrap;\n    text-align: center;\n    margin: 0;\n    padding: 0.1rem 0.4rem;\n    border-bottom: 1px solid #dedede;\n    border-right: 1px solid #dedede;\n\n    :last-child {\n      border-right: 0;\n    }\n    button {\n      background-color: transparent;\n      border: none;\n      padding: 0 5px;\n    }\n  }\n`;\n\ninterface ZonesTableProps {\n  tableData: Array<{\n    signals: Array<any>;\n    tableMetaInfo: any;\n    rowIndex: number;\n    signalIndex: number;\n    id: number;\n  }>;\n  onUnlink: (\n    zoneData: any,\n    isOnZoneLevel: any,\n    signalIndex: any,\n    axis: any,\n  ) => void;\n  context?: any;\n  nuclei: string[];\n  experiment: string;\n}\n\nfunction ZonesTable({\n  tableData,\n  onUnlink,\n  context,\n  nuclei,\n  experiment,\n}: ZonesTableProps) {\n  const contextRef = useRef<any>(null);\n\n  const contextMenuHandler = useCallback(\n    (e, rowData) => {\n      if (!checkModifierKeyActivated(e)) {\n        e.preventDefault();\n        contextRef.current.handleContextMenu(e, rowData);\n      }\n    },\n    [contextRef],\n  );\n\n  const data = useMemo(() => {\n    const _data: Array<any> = [];\n    tableData.forEach((zone, i) => {\n      if (zone.signals.length === 1) {\n        _data.push({\n          ...zone,\n          tableMetaInfo: {\n            ...zone.tableMetaInfo,\n            signal: zone.signals[0],\n            rowIndex: i,\n            signalIndex: 0,\n            id: zone.signals[0].id,\n            experiment,\n            nuclei,\n          },\n        });\n      } else if (zone.signals.length > 1) {\n        zone.signals.forEach((signal, j) => {\n          let hide = false;\n          let rowSpan: number | null = null;\n          if (j < zone.signals.length - 1) {\n            if (j === 0) {\n              rowSpan = zone.signals.length;\n            } else {\n              hide = true;\n            }\n          } else {\n            hide = true;\n          }\n          _data.push({\n            ...zone,\n            tableMetaInfo: {\n              ...zone.tableMetaInfo,\n              signal,\n              rowSpan,\n              hide,\n              rowIndex: i,\n              signalIndex: j,\n              id: signal.id,\n              experiment,\n            },\n          });\n        });\n      }\n    });\n\n    return _data;\n  }, [experiment, nuclei, tableData]);\n\n  const { items: sortedData, isSortedDesc, onSort } = useTableSortBy(data);\n\n  const rows = useMemo(\n    () =>\n      sortedData.map((rowData, index) => (\n        <ZonesTableRow\n          rowIndex={index}\n          key={`${rowData.tableMetaInfo.id}`}\n          rowData={rowData}\n          onUnlink={onUnlink}\n          onContextMenu={(e, rowData) => contextMenuHandler(e, rowData)}\n        />\n      )),\n    [contextMenuHandler, sortedData, onUnlink],\n  );\n\n  return (\n    <div>\n      <table css={tableStyle}>\n        <thead>\n          <tr>\n            <th rowSpan={2}>#</th>\n            <th colSpan={2}>δ (ppm)</th>\n            <th colSpan={2}>\n              <FaLink />\n            </th>\n            <th colSpan={2}>Σ</th>\n            <th rowSpan={2}>Kind</th>\n            <th rowSpan={2}>{''}</th>\n          </tr>\n          <tr>\n            <th id=\"tableMetaInfo.signal.x.delta\" {...onSort}>\n              <SurroundedText text=\"F2\">\n                {nuclei[0]}{' '}\n                {isSortedDesc('tableMetaInfo.signal.x.delta').content}\n              </SurroundedText>\n            </th>\n            <th id=\"tableMetaInfo.signal.y.delta\" {...onSort}>\n              <SurroundedText text=\"F1\">\n                {nuclei[1]}{' '}\n                {isSortedDesc('tableMetaInfo.signal.y.delta').content}\n              </SurroundedText>\n            </th>\n            <th>\n              <SurroundedText text=\"F2\">{nuclei[0]}</SurroundedText>\n            </th>\n            <th>\n              <SurroundedText text=\"F1\">{nuclei[1]}</SurroundedText>\n            </th>\n            <th>\n              <SurroundedText text=\"F2\">{nuclei[0]}</SurroundedText>\n            </th>\n            <th>\n              <SurroundedText text=\"F1\">{nuclei[1]}</SurroundedText>\n            </th>\n          </tr>\n        </thead>\n        <tbody>{rows}</tbody>\n      </table>\n      <ContextMenu ref={contextRef} context={context} />\n    </div>\n  );\n}\n\nfunction SurroundedText(props: { text: 'F1' | 'F2'; children: ReactNode }) {\n  return (\n    <>\n      <div\n        style={{\n          position: 'absolute',\n          fontSize: 8,\n          color: '#3539E6',\n        }}\n      >\n        {props.text}\n      </div>\n      <div style={{ marginLeft: 5 }}>{props.children}</div>\n    </>\n  );\n}\n\nexport default ZonesTable;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useState, useMemo, useCallback, useRef, memo } from 'react';\nimport { FaUnlink } from 'react-icons/fa';\n\nimport { Datum2D } from '../../../data/types/data2d';\nimport { useAssignmentData } from '../../assignment/AssignmentsContext';\nimport { useChartData } from '../../context/ChartContext';\nimport { useDispatch } from '../../context/DispatchContext';\nimport ToggleButton from '../../elements/ToggleButton';\nimport ToolTip from '../../elements/ToolTip/ToolTip';\nimport { useModal } from '../../elements/popup/Modal';\nimport useSpectrum from '../../hooks/useSpectrum';\nimport { DELETE_2D_ZONE, UNLINK_ZONE } from '../../reducer/types/Types';\nimport Events from '../../utility/Events';\nimport { tablePanelStyle } from '../extra/BasicPanelStyle';\nimport NoTableData from '../extra/placeholder/NoTableData';\nimport DefaultPanelHeader from '../header/DefaultPanelHeader';\nimport PreferencesHeader from '../header/PreferencesHeader';\n\nimport ZonesPreferences from './ZonesPreferences';\nimport ZonesTable from './ZonesTable';\n\nconst style = css`\n  .remove-assignments-btn {\n    border-radius: 5px;\n    margin-top: 3px;\n    margin-left: 2px;\n    border: none;\n    height: 16px;\n    width: 18px;\n    font-size: 12px;\n    padding: 0;\n    background-color: transparent;\n  }\n  .toggle {\n    width: 22px;\n    height: 22px;\n    margin-left: 2px;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n  }\n`;\n\nfunction ZonesPanelInner({ zones, activeTab, xDomain, yDomain, experiment }) {\n  const [filterIsActive, setFilterIsActive] = useState(false);\n\n  const assignmentData = useAssignmentData();\n\n  const dispatch = useDispatch();\n  const modal = useModal();\n  const [isFlipped, setFlipStatus] = useState(false);\n  const settingRef = useRef<any>();\n\n  const tableData = useMemo(() => {\n    const isInView = (xFrom, xTo, yFrom, yTo) => {\n      const factor = 10000;\n      xFrom = xFrom * factor;\n      xTo = xTo * factor;\n      yFrom = yFrom * factor;\n      yTo = yTo * factor;\n      return (\n        ((xTo >= xDomain[0] * factor && xFrom <= xDomain[1] * factor) ||\n          (xFrom <= xDomain[0] * factor && xTo >= xDomain[1] * factor)) &&\n        ((yTo >= yDomain[0] * factor && yFrom <= yDomain[1] * factor) ||\n          (yFrom <= yDomain[0] * factor && yTo >= yDomain[1] * factor))\n      );\n    };\n\n    const getFilteredZones = (zones) => {\n      return zones.filter((zone) => {\n        return isInView(zone.x.from, zone.x.to, zone.y.from, zone.y.to);\n      });\n    };\n    if (zones.values) {\n      const _zones = filterIsActive\n        ? getFilteredZones(zones.values)\n        : zones.values;\n\n      return _zones.map((zone) => {\n        return {\n          ...zone,\n          tableMetaInfo: {\n            isConstantlyHighlighted: isInView(\n              zone.x.from,\n              zone.x.to,\n              zone.y.from,\n              zone.y.to,\n            ),\n          },\n        };\n      });\n    }\n  }, [zones, filterIsActive, xDomain, yDomain]);\n\n  const handleOnFilter = useCallback(() => {\n    setFilterIsActive(!filterIsActive);\n  }, [filterIsActive]);\n\n  const unlinkZoneHandler = useCallback(\n    (\n      zoneData = null,\n      isOnZoneLevel = undefined,\n      signalIndex = -1,\n      axis = undefined,\n    ) => {\n      dispatch({\n        type: UNLINK_ZONE,\n        payload: {\n          zoneData,\n          assignmentData,\n          isOnZoneLevel,\n          signalIndex,\n          axis,\n        },\n      });\n    },\n    [assignmentData, dispatch],\n  );\n\n  const removeAssignments = useCallback(() => {\n    unlinkZoneHandler();\n  }, [unlinkZoneHandler]);\n\n  const handleOnRemoveAssignments = useCallback(() => {\n    modal.showConfirmDialog({\n      message: 'All assignments will be removed. Are you sure?',\n      buttons: [{ text: 'Yes', handler: removeAssignments }, { text: 'No' }],\n    });\n  }, [removeAssignments, modal]);\n\n  const handleDeleteAll = useCallback(() => {\n    modal.showConfirmDialog({\n      message: 'All zones will be deleted. Are You sure?',\n      buttons: [\n        {\n          text: 'Yes',\n          handler: () => {\n            dispatch({ type: DELETE_2D_ZONE, payload: { assignmentData } });\n          },\n        },\n        { text: 'No' },\n      ],\n    });\n  }, [assignmentData, dispatch, modal]);\n\n  const settingsPanelHandler = useCallback(() => {\n    setFlipStatus(!isFlipped);\n  }, [isFlipped]);\n\n  const saveSettingHandler = useCallback(() => {\n    settingRef.current.saveSetting();\n    setFlipStatus(false);\n  }, []);\n\n  const visibilityHandler = useCallback((key) => {\n    Events.emit('onZonesVisibilityChange', { key });\n  }, []);\n\n  return (\n    <>\n      <div\n        css={[\n          tablePanelStyle,\n          style,\n          isFlipped &&\n            css`\n              th {\n                position: relative;\n              }\n            `,\n        ]}\n      >\n        {!isFlipped && (\n          <DefaultPanelHeader\n            counter={zones.values ? zones.values.length : 0}\n            onDelete={handleDeleteAll}\n            deleteToolTip=\"Delete All Zones\"\n            onFilter={handleOnFilter}\n            filterToolTip={\n              filterIsActive ? 'Show all zones' : 'Hide zones out of view'\n            }\n            filterIsActive={filterIsActive}\n            counterFiltered={tableData?.length}\n            showSettingButton\n            onSettingClick={settingsPanelHandler}\n          >\n            <ToolTip title={`Remove all Assignments`} popupPlacement=\"right\">\n              <button\n                className=\"remove-assignments-btn\"\n                type=\"button\"\n                onClick={handleOnRemoveAssignments}\n                disabled={!zones.values || zones.values.length === 0}\n              >\n                <FaUnlink />\n              </button>\n            </ToolTip>\n            <ToggleButton\n              popupTitle=\"show/hide zones\"\n              popupPlacement=\"right\"\n              defaultValue\n              onClick={() => visibilityHandler('zones')}\n            >\n              <span style={{ fontSize: '12px', pointerEvents: 'none' }}>z</span>\n            </ToggleButton>\n            <ToggleButton\n              popupTitle=\"show/hide signals\"\n              popupPlacement=\"right\"\n              defaultValue\n              onClick={() => visibilityHandler('signals')}\n            >\n              <span style={{ fontSize: '12px', pointerEvents: 'none' }}>s</span>\n            </ToggleButton>\n            <ToggleButton\n              popupTitle=\"show/hide peaks\"\n              popupPlacement=\"right\"\n              defaultValue\n              onClick={() => visibilityHandler('peaks')}\n            >\n              <span style={{ fontSize: '12px', pointerEvents: 'none' }}>p</span>\n            </ToggleButton>\n          </DefaultPanelHeader>\n        )}\n        {isFlipped && (\n          <PreferencesHeader\n            onSave={saveSettingHandler}\n            onClose={settingsPanelHandler}\n          />\n        )}\n        <div className=\"inner-container\">\n          {!isFlipped ? (\n            <div className=\"table-container\">\n              {tableData && tableData.length > 0 ? (\n                <ZonesTable\n                  tableData={tableData}\n                  onUnlink={unlinkZoneHandler}\n                  nuclei={\n                    activeTab && activeTab.split(',').length === 2\n                      ? activeTab.split(',')\n                      : ['?', '?']\n                  }\n                  experiment={experiment}\n                />\n              ) : (\n                <NoTableData />\n              )}\n            </div>\n          ) : (\n            <ZonesPreferences ref={settingRef} />\n          )}\n        </div>\n      </div>\n    </>\n  );\n}\n\nconst MemoizedZonesPanel = memo(ZonesPanelInner);\n\nconst emptyData = { zones: {}, info: {} };\n\nexport default function ZonesPanel() {\n  const { displayerKey, xDomain, yDomain, activeTab } = useChartData();\n  const { zones, info } = useSpectrum(emptyData) as Datum2D;\n\n  return (\n    <MemoizedZonesPanel\n      {...{\n        xDomain,\n        yDomain,\n        activeTab,\n        displayerKey,\n        zones,\n        experiment: info.experiment,\n      }}\n    />\n  );\n}\n","import {\n  protonImpurities,\n  carbonImpurities,\n  Jcoupling,\n  DatabaseNMREntry,\n} from 'nmr-processing';\n\nimport { filter } from 'smart-array-filter';\n\nimport generateID from '../utilities/generateID';\n\nexport interface DataBaseSignal {\n  assignment: string;\n  delta: number;\n}\n\nexport interface DataBaseRange {\n  from: number;\n  to: number;\n  signals: Array<DataBaseSignal>;\n}\n\nexport interface DataBase {\n  data: Record<\n    string,\n    {\n      description: string;\n      value: Array<DatabaseNMREntry>;\n    }\n  >;\n}\n\nexport const database: DataBase = {\n  data: {\n    solvent: {\n      description: 'Solvent database',\n      value: prepareDataBase([...protonImpurities, ...carbonImpurities]),\n    },\n  },\n};\n\nexport interface InitiateDatabaseResult {\n  data: DatabaseNMREntry[];\n  getSolvents: () => string[];\n  search: (keywords?: string[]) => DatabaseNMREntry[];\n}\n\nexport function initiateDatabase(\n  databaseKey: string,\n  nucleus: string,\n): InitiateDatabaseResult {\n  const databaseData = database.data[databaseKey]\n    ? database.data[databaseKey].value\n    : [];\n\n  const data = databaseData.filter((datum) => datum.nucleus === nucleus);\n\n  const getSolvents = () => prepareGetSolvents(data);\n  const search = (keywords: string | string[] = []) =>\n    filter(data, { keywords });\n\n  return { data, getSolvents, search };\n}\n\nfunction prepareGetSolvents(data) {\n  const result: string[] = [];\n  const map = new Map();\n  for (const item of data) {\n    if (!map.has(item.solvent)) {\n      map.set(item.solvent, true);\n      result.push(item.solvent);\n    }\n  }\n  return result;\n}\n\nexport function getDatabasesNames() {\n  return Object.keys(database.data).map((key) => {\n    const { description } = database.data[key];\n    return { id: key, name: description };\n  });\n}\n\nfunction prepareDataBase(array: Array<DatabaseNMREntry>) {\n  return array.map((item) => {\n    item.ranges = item.ranges.map((range) => ({\n      id: generateID(),\n      ...range,\n    }));\n    return item;\n  }, []);\n}\n\nexport type PrepareDataResult = Partial<\n  DataBaseRange | DataBaseSignal | Jcoupling\n>;\n\nexport function prepareData(\n  data: Array<DatabaseNMREntry>,\n): PrepareDataResult[] {\n  const result: PrepareDataResult[] = [];\n  let index = 0;\n  for (const item of data) {\n    let ids: string[] = [];\n    const { ranges, ...restItemKeys } = item;\n\n    for (const range of ranges) {\n      ids.push(range.id || generateID());\n      const { signals = [], ...restRangKeys } = range;\n      for (const signal of signals) {\n        const { js = [], ...restSignalKeys } = signal;\n        const jsResult = mapJs(js);\n\n        const data = {\n          ...restItemKeys,\n          ...restRangKeys,\n          ...restSignalKeys,\n          ...jsResult,\n          index,\n          id: ids,\n          ranges,\n        };\n        result.push(data);\n      }\n    }\n    index++;\n  }\n  return result;\n}\n\nfunction mapJs(js: Jcoupling[]) {\n  if (js && js.length > 0) {\n    const { coupling, multiplicity } = js.reduce<any>(\n      (acc, { coupling, multiplicity }) => {\n        acc.coupling.push(coupling.toFixed(1));\n        acc.multiplicity += multiplicity;\n        return acc;\n      },\n      { coupling: [], multiplicity: '' },\n    );\n    return { multiplicity, coupling: coupling.join(',') };\n  } else {\n    return { multiplicity: 's', coupling: '' };\n  }\n}\n","import {\n  useEffect,\n  useCallback,\n  useImperativeHandle,\n  useRef,\n  CSSProperties,\n  forwardRef,\n} from 'react';\n\nimport { usePreferences } from '../../context/PreferencesContext';\nimport FormikColumnFormatField from '../../elements/formik/FormikColumnFormatField';\nimport FormikForm from '../../elements/formik/FormikForm';\nimport { useAlert } from '../../elements/popup/Alert';\nimport { getValue as getValueByKeyPath } from '../../utility/LocalStorage';\nimport { databaseDefaultValues } from '../extra/preferences/defaultValues';\n\nconst styles: Record<\n  | 'container'\n  | 'groupContainer'\n  | 'header'\n  | 'inputContainer'\n  | 'input'\n  | 'inputLabel',\n  CSSProperties\n> = {\n  container: {\n    padding: 10,\n    backgroundColor: '#f1f1f1',\n    height: '100%',\n    overflowY: 'auto',\n  },\n  groupContainer: {\n    padding: '5px',\n    borderRadius: '5px',\n    margin: '10px 0px',\n    backgroundColor: 'white',\n  },\n\n  header: {\n    borderBottom: '1px solid #e8e8e8',\n    paddingBottom: '5px',\n    fontWeight: 'bold',\n    color: '#4a4a4a',\n  },\n  inputContainer: {\n    flex: 4,\n    borderRadius: '5px',\n  },\n  inputLabel: {\n    flex: 2,\n    fontSize: '11px',\n    fontWeight: 'bold',\n    color: '#232323',\n  },\n  input: {\n    width: '100px',\n  },\n};\n\nfunction DatabasePreferences(props, ref) {\n  const preferences = usePreferences();\n  const alert = useAlert();\n\n  const formRef = useRef<any>();\n\n  const updateValues = useCallback(() => {\n    const databasePreferences = getValueByKeyPath(\n      preferences.current,\n      `formatting.panels.database`,\n    );\n\n    formRef.current.setValues(\n      databasePreferences ? databasePreferences : databaseDefaultValues,\n    );\n  }, [preferences]);\n\n  useEffect(() => {\n    updateValues();\n  }, [updateValues]);\n\n  const saveHandler = useCallback(\n    (values) => {\n      preferences.dispatch({\n        type: 'SET_PANELS_PREFERENCES',\n        payload: { key: 'database', value: values },\n      });\n      alert.success('database preferences saved successfully');\n    },\n    [alert, preferences],\n  );\n\n  useImperativeHandle(ref, () => ({\n    saveSetting: () => {\n      formRef.current.submitForm();\n    },\n  }));\n\n  return (\n    <div style={styles.container}>\n      <FormikForm onSubmit={saveHandler} ref={formRef}>\n        <div style={styles.groupContainer}>\n          <FormikColumnFormatField\n            label=\"Smiles\"\n            checkControllerName=\"showSmiles\"\n            hideFormat\n          />\n          <FormikColumnFormatField\n            label=\"Solvent\"\n            checkControllerName=\"showSolvent\"\n            hideFormat\n          />\n          <FormikColumnFormatField\n            label=\"Names\"\n            checkControllerName=\"showNames\"\n            hideFormat\n          />\n          <FormikColumnFormatField\n            label=\"Range\"\n            checkControllerName=\"showRange\"\n            hideFormat\n          />\n          <FormikColumnFormatField\n            label=\"δ (ppm)\"\n            checkControllerName=\"showDelta\"\n            hideFormat\n          />\n          <FormikColumnFormatField\n            label=\"Assignment\"\n            checkControllerName=\"showAssignment\"\n            hideFormat\n          />\n          <FormikColumnFormatField\n            label=\"J (Hz)\"\n            checkControllerName=\"showCoupling\"\n            hideFormat\n          />\n          <FormikColumnFormatField\n            label=\"Multiplicity\"\n            checkControllerName=\"showMultiplicity\"\n            hideFormat\n          />\n        </div>\n      </FormikForm>\n    </div>\n  );\n}\n\nexport default forwardRef(DatabasePreferences);\n","/** @jsxImportSource @emotion/react */\nimport { useMemo, memo, CSSProperties } from 'react';\nimport { FaPlus } from 'react-icons/fa';\nimport { SmilesSvgRenderer } from 'react-ocl/full';\n\nimport { usePreferences } from '../../context/PreferencesContext';\nimport ReactTable from '../../elements/ReactTable/ReactTable';\nimport addCustomColumn, {\n  CustomColumn,\n} from '../../elements/ReactTable/utility/addCustomColumn';\nimport { HighlightedSource } from '../../highlight';\nimport { getValue } from '../../utility/LocalStorage';\nimport NoTableData from '../extra/placeholder/NoTableData';\nimport { databaseDefaultValues } from '../extra/preferences/defaultValues';\n\ninterface DatabaseTableProps {\n  data: any;\n  onAdd: (row: any) => void;\n}\n\nconst overFlowStyle: CSSProperties = {\n  overflow: 'hidden',\n  whiteSpace: 'nowrap',\n  textOverflow: 'ellipsis',\n};\n\nconst COLUMNS: (CustomColumn & { showWhen: string })[] = [\n  {\n    showWhen: 'showNames',\n    index: 1,\n    Header: 'names',\n    accessor: (row) => (row.names ? row.names.join(',') : ''),\n    enableRowSpan: true,\n    style: {\n      width: '100px',\n      minWidth: '100px',\n      maxWidth: '100px',\n      ...overFlowStyle,\n    },\n  },\n  {\n    showWhen: 'showRange',\n    index: 2,\n    Header: 'From - To',\n    accessor: (row) => `${row.from.toFixed(2)} - ${row.to.toFixed(2)}`,\n    enableRowSpan: true,\n  },\n  {\n    showWhen: 'showDelta',\n    index: 3,\n    Header: 'δ (ppm)',\n    accessor: 'delta',\n  },\n  {\n    showWhen: 'showAssignment',\n    index: 4,\n    Header: 'Assignment',\n    accessor: 'assignment',\n  },\n  {\n    showWhen: 'showMultiplicity',\n    index: 5,\n    Header: 'Multi.',\n    accessor: 'multiplicity',\n  },\n  {\n    showWhen: 'showCoupling',\n    index: 6,\n    Header: 'J (Hz)',\n    accessor: 'coupling',\n    style: {\n      width: '60px',\n      minWidth: '60px',\n      ...overFlowStyle,\n    },\n  },\n  {\n    showWhen: 'showSolvent',\n    index: 7,\n    Header: 'Solvent',\n    accessor: 'solvent',\n    style: {\n      width: '80px',\n      minWidth: '80px',\n      ...overFlowStyle,\n    },\n  },\n  {\n    showWhen: 'showSmiles',\n    index: 8,\n    Header: 'Smiles',\n    accessor: 'index',\n    enableRowSpan: true,\n    Cell: ({ row }) => (\n      <div\n        className=\"smiles-container\"\n        style={{ width: '100px', display: 'block', overflow: 'hidden' }}\n      >\n        {row?.original.smiles && (\n          <SmilesSvgRenderer\n            height={60}\n            width={60}\n            smiles={row.original.smiles}\n          />\n        )}\n      </div>\n    ),\n  },\n];\n\nfunction DatabaseTable({ data, onAdd }: DatabaseTableProps) {\n  const preferences = usePreferences();\n\n  const initialColumns = useMemo(\n    () => [\n      {\n        index: 10,\n        Header: '',\n        width: '1%',\n        maxWidth: '24px',\n        minWidth: '24px',\n        id: 'add-button',\n        accessor: 'index',\n        enableRowSpan: true,\n        Cell: ({ row }) => (\n          <button\n            type=\"button\"\n            className=\"add-button\"\n            onClick={() => onAdd(row)}\n          >\n            <FaPlus />\n          </button>\n        ),\n      },\n    ],\n    [onAdd],\n  );\n\n  const tableColumns = useMemo(() => {\n    const databasePreferences = getValue(\n      preferences.current,\n      'formatting.panels.database',\n      databaseDefaultValues,\n    );\n\n    let columns = [...initialColumns];\n    for (const col of COLUMNS) {\n      const { showWhen, ...colParams } = col;\n      if (databasePreferences[showWhen]) {\n        addCustomColumn(columns, colParams);\n      }\n    }\n\n    return columns.sort((object1, object2) => object1.index - object2.index);\n  }, [initialColumns, preferences]);\n\n  return data && data.length > 0 ? (\n    <ReactTable\n      data={data}\n      columns={tableColumns}\n      highlightedSource={HighlightedSource.DATABASE}\n      groupKey=\"index\"\n      approxItemHeight={30}\n      enableVirtualScroll\n    />\n  ) : (\n    <NoTableData />\n  );\n}\n\nexport default memo(DatabaseTable);\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useAccordionContext } from 'analysis-ui-components';\nimport { DatabaseNMREntry } from 'nmr-processing';\nimport { useCallback, useState, useRef, memo, useEffect, useMemo } from 'react';\nimport { FaICursor } from 'react-icons/fa';\nimport { IoSearchOutline } from 'react-icons/io5';\n\nimport {\n  initiateDatabase,\n  getDatabasesNames,\n  InitiateDatabaseResult,\n  prepareData,\n} from '../../../data/data1d/database';\nimport { useChartData } from '../../context/ChartContext';\nimport { useDispatch } from '../../context/DispatchContext';\nimport Input from '../../elements/Input';\nimport Select, { SelectEntry } from '../../elements/Select';\nimport ToggleButton from '../../elements/ToggleButton';\nimport useToolsFunctions from '../../hooks/useToolsFunctions';\nimport { RESURRECTING_SPECTRUM_FROM_RANGES } from '../../reducer/types/Types';\nimport { options } from '../../toolbar/ToolTypes';\nimport Events from '../../utility/Events';\nimport { useFormatNumberByNucleus } from '../../utility/FormatNumber';\nimport { tablePanelStyle } from '../extra/BasicPanelStyle';\nimport DefaultPanelHeader from '../header/DefaultPanelHeader';\nimport PreferencesHeader from '../header/PreferencesHeader';\n\nimport DatabasePreferences from './DatabasePreferences';\nimport DatabaseTable from './DatabaseTable';\n\nconst style = css`\n  .header {\n    height: 30px;\n    padding: 2px 0px 2px 5px;\n  }\n  .input-container {\n    width: 100%;\n  }\n  .search-input {\n    width: 100% !important;\n    border-radius: 5px;\n    border: 0.55px solid gray;\n    padding: 0 5px;\n    outline: none;\n  }\n  .smiles-container svg {\n    display: block;\n    margin: 0 auto;\n  }\n`;\n\nexport interface DatabaseInnerProps {\n  nucleus: string;\n  selectedTool: string;\n}\n\ninterface ResultEntry {\n  data: DatabaseNMREntry[];\n  databases: SelectEntry[];\n  solvents: SelectEntry[];\n}\n\nconst emptyKeywords = {\n  solvent: '',\n  searchKeywords: '',\n};\n\nfunction DatabasePanelInner({ nucleus, selectedTool }: DatabaseInnerProps) {\n  const dispatch = useDispatch();\n  const { handleChangeOption } = useToolsFunctions();\n  const format = useFormatNumberByNucleus(nucleus);\n\n  const [isFlipped, setFlipStatus] = useState(false);\n  const settingRef = useRef<any>();\n  const [keywords, setKeywords] = useState<{\n    solvent: string;\n    searchKeywords: string;\n  }>(emptyKeywords);\n  const databaseInstance = useRef<InitiateDatabaseResult | null>(null);\n  const [result, setResult] = useState<ResultEntry>({\n    data: [],\n    databases: [],\n    solvents: [],\n  });\n  const { item } = useAccordionContext('Database');\n\n  const settingsPanelHandler = useCallback(() => {\n    setFlipStatus(!isFlipped);\n  }, [isFlipped]);\n\n  const saveSettingHandler = useCallback(() => {\n    settingRef.current.saveSetting();\n    setFlipStatus(false);\n  }, []);\n\n  const handleSearch = useCallback((input) => {\n    if (typeof input === 'string' || input === -1) {\n      const solvent = String(input);\n      setKeywords((prevState) => ({ ...prevState, solvent }));\n    } else {\n      setKeywords((prevState) => ({\n        ...prevState,\n        searchKeywords: input.target.value,\n      }));\n    }\n  }, []);\n\n  useEffect(() => {\n    if (item?.isOpen) {\n      setTimeout(() => {\n        const databases = mapDatabasesToSelect(getDatabasesNames());\n        databaseInstance.current = initiateDatabase(databases[0].key, nucleus);\n        const data = databaseInstance.current.data;\n        const solvents = mapSolventsToSelect(\n          databaseInstance.current.getSolvents(),\n        );\n\n        setResult({ data, databases, solvents });\n      });\n    }\n  }, [item?.isOpen, nucleus]);\n\n  useEffect(() => {\n    const { solvent, searchKeywords } = keywords;\n    setTimeout(() => {\n      if (databaseInstance.current) {\n        if (!solvent && !searchKeywords) {\n          const data = databaseInstance.current.data;\n          const solvents = mapSolventsToSelect(\n            databaseInstance.current.getSolvents(),\n          );\n          setResult((prevResult) => ({ ...prevResult, data, solvents }));\n        } else {\n          const values = [...searchKeywords.split(',')];\n          if (solvent !== '-1') {\n            values.unshift(`solvent:${solvent}`);\n          }\n\n          const data = databaseInstance.current.search(values);\n          setResult((prevResult) => ({ ...prevResult, data }));\n        }\n      }\n    });\n  }, [keywords]);\n\n  useEffect(() => {\n    function handle(event) {\n      if (selectedTool === options.databaseRangesSelection.id) {\n        setKeywords((prevState) => {\n          const oldKeywords = prevState.searchKeywords\n            ? prevState.searchKeywords.split(',')\n            : [];\n          const [from, to] = event.range;\n          const searchKeywords = [\n            ...oldKeywords,\n            `delta:${format(from)}..${format(to)}`,\n          ].join(',');\n          return { ...prevState, searchKeywords };\n        });\n      }\n    }\n\n    Events.on('brushEnd', handle);\n\n    return () => {\n      Events.off('brushEnd', handle);\n    };\n  }, [format, selectedTool]);\n\n  const handleChangeDatabase = useCallback(\n    (databaseKey) => {\n      databaseInstance.current = initiateDatabase(databaseKey, nucleus);\n      setKeywords(emptyKeywords);\n    },\n    [nucleus],\n  );\n\n  const tableData = useMemo(() => {\n    return prepareData(result.data);\n  }, [result.data]);\n\n  const resurrectHandler = useCallback(\n    (row) => {\n      const { index } = row.original;\n      const { ranges, solvent, names = [] } = result.data[index];\n      dispatch({\n        type: RESURRECTING_SPECTRUM_FROM_RANGES,\n        payload: { ranges, info: { solvent, nucleus, name: names[0] } },\n      });\n    },\n    [dispatch, nucleus, result.data],\n  );\n\n  const clearHandler = useCallback(() => {\n    setKeywords((prevState) => ({ ...prevState, searchKeywords: '' }));\n  }, []);\n\n  const enableFilterHandler = useCallback(\n    (flag) => {\n      const tool = !flag ? options.zoom.id : options.databaseRangesSelection.id;\n      handleChangeOption(tool);\n    },\n    [handleChangeOption],\n  );\n\n  return (\n    <div\n      css={[\n        tablePanelStyle,\n        style,\n        isFlipped &&\n          css`\n            .table-container {\n              table,\n              th {\n                position: relative !important;\n              }\n            }\n          `,\n      ]}\n    >\n      {!isFlipped && (\n        <DefaultPanelHeader\n          showSettingButton\n          onSettingClick={settingsPanelHandler}\n          canDelete={false}\n          className=\"header\"\n        >\n          <ToggleButton\n            key={`${selectedTool}`}\n            defaultValue={selectedTool === options.databaseRangesSelection.id}\n            popupTitle=\"Filter by select ranges\"\n            popupPlacement=\"right\"\n            onClick={enableFilterHandler}\n          >\n            <FaICursor\n              style={{\n                pointerEvents: 'none',\n                fontSize: '12px',\n                transform: 'rotate(90deg)',\n              }}\n            />\n          </ToggleButton>\n          <Select\n            style={{ flex: 2 }}\n            data={result.databases}\n            onChange={handleChangeDatabase}\n          />\n          <Select\n            style={{ flex: 1 }}\n            data={result.solvents}\n            onChange={handleSearch}\n          />\n          <Input\n            value={keywords.searchKeywords}\n            renderIcon={() => <IoSearchOutline />}\n            style={{ inputWrapper: { flex: 3 } }}\n            className=\"search-input\"\n            type=\"text\"\n            debounceTime={250}\n            placeholder=\"Search for parameter...\"\n            onChange={handleSearch}\n            onClear={clearHandler}\n            canClear\n          />\n        </DefaultPanelHeader>\n      )}\n      {isFlipped && (\n        <PreferencesHeader\n          onSave={saveSettingHandler}\n          onClose={settingsPanelHandler}\n        />\n      )}\n      <div className=\"inner-container\">\n        {!isFlipped ? (\n          <DatabaseTable data={tableData} onAdd={resurrectHandler} />\n        ) : (\n          <DatabasePreferences ref={settingRef} />\n        )}\n      </div>\n    </div>\n  );\n}\n\nconst MemoizedDatabasePanel = memo(DatabasePanelInner);\n\nexport default function PeaksPanel() {\n  const {\n    activeTab,\n    toolOptions: { selectedTool },\n  } = useChartData();\n  if (!activeTab) return <div />;\n  return (\n    <MemoizedDatabasePanel nucleus={activeTab} selectedTool={selectedTool} />\n  );\n}\n\nfunction mapSolventsToSelect(solvents: string[]) {\n  const result = solvents.map((key) => {\n    return {\n      key,\n      label: key,\n      value: key,\n    };\n  }, []);\n  result.unshift({ key: '-1', label: 'All', value: '-1' });\n  return result;\n}\n\nfunction mapDatabasesToSelect(databases) {\n  return databases.map(({ id, name }) => ({\n    key: id,\n    value: id,\n    label: name,\n  }));\n}\n","import { CSSProperties, memo, ReactNode } from 'react';\n\nconst styles: CSSProperties = {\n  width: '100%',\n  height: '100%',\n  padding: '0px',\n  display: 'flex',\n  flexDirection: 'column',\n};\n\ninterface TableProps {\n  children: ReactNode;\n  className?: string;\n  style?: CSSProperties;\n  testID?: string;\n}\n\nfunction Table({ children, className, style, testID }: TableProps) {\n  return (\n    <div\n      className={className}\n      style={{ ...styles, ...style }}\n      data-test-id={testID}\n    >\n      {children}\n    </div>\n  );\n}\n\nexport default memo(Table);\n","import {\n  useMemo,\n  memo,\n  Children,\n  cloneElement,\n  ReactNode,\n  CSSProperties,\n} from 'react';\n\nconst styles: CSSProperties = {\n  width: '100%',\n  overflowY: 'auto',\n  display: 'flex',\n  flexDirection: 'column',\n  padding: '5px 0px',\n  color: 'gray',\n};\n\ninterface TableBodyProps {\n  children: ReactNode;\n  className?: string;\n  style?: CSSProperties;\n}\n\nfunction TableBody({ children, className, style }: TableBodyProps) {\n  const mappedChildren = useMemo(() => {\n    return Children.map(children, (child: any) =>\n      cloneElement(child, {\n        style: { borderBottom: '0.55px solid #d8d8d8', ...child.props.style },\n      }),\n    );\n  }, [children]);\n\n  return (\n    <div className={className} style={{ ...styles, ...style }}>\n      {mappedChildren}\n    </div>\n  );\n}\n\nexport default memo(TableBody);\n","import { CSSProperties, memo, ReactNode } from 'react';\n\nconst styles = {\n  width: '100%',\n  display: 'flex',\n  alignItems: 'flex-start',\n};\n\nfunction getVAlign(align) {\n  if (align.toLowerCase() === 'top') {\n    return 'flex-start';\n  } else if (align.toLowerCase() === 'bottom') {\n    return 'flex-end';\n  }\n  return 'center';\n}\n\ninterface TableHeaderProps {\n  className?: string;\n  style?: CSSProperties;\n  children: ReactNode;\n  align?: CSSProperties['textAlign'];\n  vAlign?: 'center' | 'top' | 'bottom';\n  size?: number;\n  onClick?: () => void;\n}\n\nfunction TableHeader({\n  children,\n  className,\n  style,\n  align = 'center',\n  vAlign = 'center',\n  size = 1,\n  onClick = () => null,\n}: TableHeaderProps) {\n  return (\n    <div\n      className={className}\n      style={{\n        ...styles,\n        alignItems: getVAlign(vAlign),\n        textAlign: align,\n        flex: size,\n        ...style,\n      }}\n      onClick={onClick}\n    >\n      {children}\n    </div>\n  );\n}\n\nexport default memo(TableHeader);\n","import { CSSProperties, memo, ReactNode } from 'react';\n\nconst styles: CSSProperties = {\n  width: '100%',\n  display: 'flex',\n  padding: '0px 5px',\n  color: '#424242',\n  backgroundColor: '#d8d8d8',\n  borderBottom: '0.55px solid #d8d8d8',\n  fontSize: 11,\n  fontWeight: 'bold',\n};\n\ninterface TableHeadProps {\n  children: ReactNode;\n  className?: string;\n  style?: CSSProperties;\n}\n\nfunction TableHead({ children, className, style }: TableHeadProps) {\n  return (\n    <div className={className} style={{ ...styles, ...style }}>\n      {children}\n    </div>\n  );\n}\n\nexport default memo(TableHead);\n","import { CSSProperties, memo, ReactNode } from 'react';\n\nconst styles = {\n  width: '100%',\n  display: 'flex',\n  padding: '5px 0px',\n};\n\ninterface TableHeaderProps {\n  children: ReactNode;\n  className?: string;\n  style?: CSSProperties;\n  onClick?: () => void;\n}\n\nfunction TableHeader({\n  children,\n  className,\n  style,\n  onClick = () => null,\n}: TableHeaderProps) {\n  return (\n    <div\n      className={className}\n      style={{ ...styles, ...style }}\n      onClick={onClick}\n    >\n      {children}\n    </div>\n  );\n}\n\nexport default memo(TableHeader);\n","import { useMemo, useCallback, memo, useRef } from 'react';\nimport { FaRegTrashAlt } from 'react-icons/fa';\nimport { ObjectInspector } from 'react-inspector';\n\nimport { useChartData } from '../../context/ChartContext';\nimport { useDispatch } from '../../context/DispatchContext';\nimport CheckBox from '../../elements/CheckBox';\nimport TableCell from '../../elements/Table/TableCell';\nimport TableRow from '../../elements/Table/TableRow';\nimport { useAlert } from '../../elements/popup/Alert';\nimport { useModal } from '../../elements/popup/Modal';\nimport useSpectraByActiveNucleus from '../../hooks/useSpectraPerNucleus';\nimport useSpectrum from '../../hooks/useSpectrum';\nimport {\n  ENABLE_FILTER,\n  DELETE_FILTER,\n  SET_FILTER_SNAPSHOT,\n  DELETE_SPECTRA_FILTER,\n} from '../../reducer/types/Types';\n\nimport { FiltersProps } from './FilterPanel';\n\ninterface FiltersTableInnerProps {\n  filters: Array<FiltersProps>;\n  spectraCounter: number;\n  selectedTool: string | null;\n  activeFilterID: string | null;\n}\n\nfunction FiltersTableInner({\n  filters,\n  spectraCounter,\n  selectedTool,\n  activeFilterID,\n}: FiltersTableInnerProps) {\n  const dispatch = useDispatch();\n  const modal = useModal();\n  const alert = useAlert();\n  const selectedFilterRef = useRef<{ index: string | number | null }>({\n    index: null,\n  });\n\n  const handelFilterCheck = useCallback(\n    (id, checked) => {\n      void (async () => {\n        const hideLoading = await alert.showLoading(\n          `${checked ? 'Enable' : 'Disable'} filter in progress`,\n        );\n        setTimeout(() => {\n          dispatch({ type: ENABLE_FILTER, id, checked });\n          hideLoading();\n        }, 0);\n      })();\n    },\n    [alert, dispatch],\n  );\n  const handelDeleteFilter = useCallback(\n    ({ id, name }) => {\n      const buttons = [\n        {\n          text: 'Yes',\n          handler: async () => {\n            const hideLoading = await alert.showLoading(\n              'Delete filter process in progress',\n            );\n            dispatch({ type: DELETE_FILTER, payload: { id } });\n            hideLoading();\n          },\n        },\n        { text: 'No' },\n      ];\n\n      if (spectraCounter > 1) {\n        buttons.unshift({\n          text: 'Yes, for all spectra',\n          handler: async () => {\n            const hideLoading = await alert.showLoading(\n              'Delete all spectra filter process in progress',\n            );\n            dispatch({\n              type: DELETE_SPECTRA_FILTER,\n              payload: { filterType: name },\n            });\n            hideLoading();\n          },\n        });\n      }\n\n      modal.showConfirmDialog({\n        message: 'Are you sure you want to delete the spectrum?',\n        buttons,\n      });\n    },\n    [alert, dispatch, modal, spectraCounter],\n  );\n  const filterSnapShotHandler = useCallback(\n    (newID) => {\n      void (async () => {\n        const hideLoading = await alert.showLoading(\n          'Filter snapshot process in progress',\n        );\n        setTimeout(() => {\n          dispatch({ type: SET_FILTER_SNAPSHOT, id: newID });\n          hideLoading();\n        }, 0);\n      })();\n    },\n    [alert, dispatch],\n  );\n\n  const getStyle = useCallback(\n    (filter, index) => {\n      const { id, name } = filter;\n\n      if (activeFilterID && activeFilterID === id) {\n        selectedFilterRef.current.index = index;\n      } else if (!activeFilterID) {\n        selectedFilterRef.current.index = null;\n      }\n\n      const classes: string[] = ['filter-row'];\n      if (activeFilterID === id) {\n        classes.push('filter-active');\n      } else if (selectedTool === name) {\n        classes.push('filter-current');\n      } else if (\n        selectedFilterRef.current.index != null &&\n        index > selectedFilterRef.current.index\n      ) {\n        classes.push('filter-deactive');\n      }\n\n      return classes.join(' ');\n    },\n    [activeFilterID, selectedTool],\n  );\n\n  const filtersTableRow = useMemo(() => {\n    return filters?.map((d, index) => {\n      return (\n        <TableRow key={d.id} className={getStyle(d, index)}>\n          <TableCell\n            align=\"center\"\n            size={2}\n            onClick={() => filterSnapShotHandler(d.id)}\n          >\n            {d.label}\n          </TableCell>\n          <TableCell align=\"left\" size={3}>\n            <div onClick={(e) => e.stopPropagation()}>\n              <ObjectInspector data={d.error ? d.error : d.value} />\n            </div>\n          </TableCell>\n          <TableCell align=\"center\" vAlign=\"center\" size={1}>\n            <CheckBox\n              checked={d.flag}\n              onChange={(event) =>\n                handelFilterCheck(d.id, event.target.checked)\n              }\n            />\n            {d.isDeleteAllow && (\n              <button\n                className=\"btn\"\n                type=\"button\"\n                onClick={() => handelDeleteFilter(d)}\n              >\n                <FaRegTrashAlt />\n              </button>\n            )}\n          </TableCell>\n        </TableRow>\n      );\n    });\n  }, [\n    filterSnapShotHandler,\n    filters,\n    getStyle,\n    handelDeleteFilter,\n    handelFilterCheck,\n  ]);\n\n  return <>{filtersTableRow}</>;\n}\n\nconst emptyData = { filters: [] };\n\nconst MemoizedFiltersTable = memo(FiltersTableInner);\n\nexport default function FilterTable() {\n  const {\n    toolOptions: {\n      selectedTool,\n      data: { activeFilterID },\n    },\n  } = useChartData();\n  const { filters } = useSpectrum(emptyData);\n  const spectraCounter = useSpectraByActiveNucleus().length;\n\n  return (\n    <MemoizedFiltersTable\n      {...{ selectedTool, filters, spectraCounter, activeFilterID }}\n    />\n  );\n}\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useMemo, memo } from 'react';\n\nimport { Filter } from '../../../data/FiltersManager';\nimport Table from '../../elements/Table/Table';\nimport TableBody from '../../elements/Table/TableBody';\nimport TableCell from '../../elements/Table/TableCell';\nimport TableHead from '../../elements/Table/TableHead';\nimport TableRow from '../../elements/Table/TableRow';\nimport useSpectrum from '../../hooks/useSpectrum';\nimport NoTableData from '../extra/placeholder/NoTableData';\n\nimport FiltersTable from './FiltersTable';\n\nconst styles = css`\n  .btn {\n    background-color: transparent;\n    border: none;\n    height: 25;\n    width: 25;\n    padding: 5px;\n  }\n  .filter-row {\n    padding: 5px !important;\n  }\n  .filter-active {\n    background-color: #f7f7f7;\n    div,\n    span,\n    .btn {\n      color: black !important;\n    }\n\n    li {\n      background-color: transparent !important;\n    }\n  }\n  .filter-current {\n    background-color: #707070;\n    div,\n    span,\n    .btn {\n      color: white !important;\n    }\n\n    li {\n      background-color: transparent !important;\n    }\n  }\n\n  .filter-deactive {\n    opacity: 0.3;\n  }\n`;\n\nexport interface FiltersProps extends Filter {\n  error?: any;\n}\n\ninterface FiltersPanelInnerProps {\n  filters: Array<FiltersProps>;\n}\n\nfunction FilterPanelInner({ filters }: FiltersPanelInnerProps) {\n  const filtersTable = useMemo(() => {\n    return filters ? (\n      <Table testID=\"filters-table\">\n        <TableHead>\n          <TableRow>\n            <TableCell align=\"center\" size={1}>\n              Label\n            </TableCell>\n            <TableCell align=\"center\" size={2}>\n              Properties\n            </TableCell>\n          </TableRow>\n        </TableHead>\n        <TableBody css={styles}>\n          <FiltersTable />\n        </TableBody>\n      </Table>\n    ) : (\n      <NoTableData />\n    );\n  }, [filters]);\n\n  return filtersTable;\n}\n\nconst emptyData = { filters: [] };\n\nconst MemoizedFilterPanel = memo(FilterPanelInner);\n\nexport default function FilterPanel() {\n  const { filters } = useSpectrum(emptyData);\n\n  return <MemoizedFilterPanel filters={filters} />;\n}\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback, useRef } from 'react';\nimport * as Yup from 'yup';\n\nimport {\n  PredictionOptions as PredictionOptionsInterface,\n  defaultPredictionOptions,\n  FREQUENCIES,\n} from '../../../data/PredictionManager';\nimport Button from '../../elements/Button';\nimport IsotopesViewer from '../../elements/IsotopesViewer';\nimport Label from '../../elements/Label';\nimport FormikErrorsSummary from '../../elements/formik/FormikErrorsSummary';\nimport FormikForm from '../../elements/formik/FormikForm';\nimport FormikInput from '../../elements/formik/FormikInput';\nimport FormikSelect from '../../elements/formik/FormikSelect';\n\nconst styles = css`\n  padding: 10px;\n  border-top: solid #f2f2f2 1px;\n\n  .row {\n    flex: row;\n    display: flex;\n    padding-bottom: 10px;\n  }\n\n  .inner-content {\n    flex: 1;\n  }\n\n  .custom-label {\n    width: 160px;\n  }\n\n  .footer-container {\n    display: flex;\n    flex-direction: row-reverse;\n    align-items: flex-end;\n  }\n\n  .input {\n    font-size: 14px;\n    border-radius: 5px;\n    border: 1px solid #cccccc;\n    padding: 5px;\n    width: 100px;\n    margin-right: 10px;\n    height: initial !important;\n  }\n`;\n\nconst predictionFormValidation = Yup.object().shape({\n  frequency: Yup.number().integer().required().label('Frequency'),\n  '1d': Yup.object({\n    '1H': Yup.object({\n      from: Yup.number().integer().required().label(\"1H ' From ' \"),\n      to: Yup.number().integer().required().label(\"1H ' To ' \"),\n    }),\n    '13C': Yup.object().shape({\n      from: Yup.number().integer().required().label(\"13C ' From ' \"),\n      to: Yup.number().integer().required().label(\"13C ' To ' \"),\n    }),\n    lineWidth: Yup.number().integer().min(1).required().label('Line Width'),\n  }),\n});\n\ninterface PredictionOptionsProps {\n  onPredict?: (options?: PredictionOptionsInterface) => void;\n}\n\nfunction PredictionOptions({ onPredict = () => null }: PredictionOptionsProps) {\n  const refForm = useRef<any>();\n\n  const handleSave = useCallback(() => {\n    refForm.current.submitForm();\n  }, []);\n\n  const submitHandler = useCallback(\n    (values) => {\n      void (async () => {\n        onPredict(values);\n      })();\n    },\n    [onPredict],\n  );\n\n  return (\n    <div css={styles}>\n      <div>\n        <FormikForm\n          ref={refForm}\n          initialValues={defaultPredictionOptions}\n          validationSchema={predictionFormValidation}\n          onSubmit={submitHandler}\n        >\n          <FormikErrorsSummary />\n          <div className=\"row margin-10\">\n            <span className=\"custom-label\">Frequency : </span>\n            <FormikSelect\n              data={FREQUENCIES}\n              style={{ width: 290, height: 30, margin: 0 }}\n              name=\"frequency\"\n            />\n          </div>\n\n          <div className=\"row\">\n            <IsotopesViewer value=\"1H\" className=\"custom-label\" />\n            <Label title=\"From\">\n              <FormikInput name=\"1d.1H.from\" type=\"number\" />\n            </Label>\n            <Label title=\"To\" style={{ label: { padding: '0 10px' } }}>\n              <FormikInput name=\"1d.1H.to\" type=\"number\" />\n            </Label>\n          </div>\n          <div className=\"row\">\n            <IsotopesViewer value=\"13C\" className=\"custom-label\" />\n            <Label title=\"From\">\n              <FormikInput name=\"1d.13C.from\" type=\"number\" />\n            </Label>\n            <Label title=\"To\" style={{ label: { padding: '0 10px' } }}>\n              <FormikInput name=\"1d.13C.to\" type=\"number\" />\n            </Label>\n          </div>\n          <div className=\"row margin-10 padding-h-10\">\n            <span className=\"custom-label\">Line Width : </span>\n            <FormikInput\n              name=\"1d.lineWidth\"\n              type=\"number\"\n              style={{ input: { margin: 0 } }}\n            />\n            <span style={{ paddingLeft: '0.4rem' }}> Hz </span>\n          </div>\n        </FormikForm>\n      </div>\n      <div>\n        <Button.Done onClick={handleSave}>Predict spectrum</Button.Done>\n      </div>\n    </div>\n  );\n}\n\nexport default PredictionOptions;\n","import { useState, useCallback } from 'react';\n\nimport { Molecule } from '../../../data/molecules/Molecule';\nimport { useDispatch } from '../../context/DispatchContext';\nimport { useAlert } from '../../elements/popup/Alert';\nimport { PREDICT_SPECTRA, SET_LOADING_FLAG } from '../../reducer/types/Types';\nimport MoleculePanel from '../MoleculesPanel/MoleculePanel';\n\nimport PredictionPreferences from './PredictionOptions';\n\nexport default function PredictionPane() {\n  const [molecule, setMolecule] = useState<Molecule | null>();\n\n  const changeHandler = useCallback((molecule) => {\n    setMolecule(molecule);\n  }, []);\n  const dispatch = useDispatch();\n  const alert = useAlert();\n\n  const predictHandler = useCallback(\n    (values) => {\n      void (async () => {\n        if (molecule) {\n          dispatch({\n            type: SET_LOADING_FLAG,\n            isLoading: true,\n          });\n\n          const hideLoading = await alert.showLoading(\n            `Predict 1H, 13C, COSY, HSQC, and HMBC in progress`,\n          );\n\n          dispatch({\n            type: PREDICT_SPECTRA,\n            payload: { mol: molecule, options: values },\n          });\n\n          hideLoading();\n        } else {\n          alert.error('No Molecule selected');\n        }\n      })();\n    },\n    [alert, dispatch, molecule],\n  );\n\n  return (\n    <MoleculePanel\n      onMoleculeChange={changeHandler}\n      actionsOptions={{ hidePredict: true, hideDelete: true, hideExport: true }}\n    >\n      <PredictionPreferences onPredict={predictHandler} />\n    </MoleculePanel>\n  );\n}\n","import { Accordion } from 'analysis-ui-components';\nimport lodashGet from 'lodash/get';\nimport { useCallback, memo, ReactElement, CSSProperties } from 'react';\n\nimport { PanelPreferencesType } from '../../types/PanelPreferencesType';\nimport { useChartData } from '../context/ChartContext';\nimport { usePreferences } from '../context/PreferencesContext';\nimport useCheckExperimentalFeature from '../hooks/useCheckExperimentalFeature';\nimport { DISPLAYER_MODE } from '../reducer/core/Constants';\n\nimport AutomaticAssignment from './AutomaticAssignment/AutomaticAssignment';\nimport InformationPanel from './InformationPanel';\nimport IntegralPanel from './IntegralsPanel/IntegralPanel';\nimport MatrixGenerationPanel from './MatrixGenerationPanel/MatrixGenerationPanel';\nimport MoleculePanel from './MoleculesPanel/MoleculePanel';\nimport MultipleSpectraAnalysisPanel from './MultipleSpectraAnalysisPanel/MultipleSpectraAnalysisPanel';\nimport PeaksPanel from './PeaksPanel/PeaksPanel';\nimport RangesPanel from './RangesPanel/RangesPanel';\nimport SpectrumListPanel from './SpectrumsPanel/SpectrumListPanel';\nimport SummaryPanel from './SummaryPanel/SummaryPanel';\nimport ZonesPanel from './ZonesPanel/ZonesPanel';\nimport DatabasePanel from './databasePanel/DatabasePanel';\nimport FilterPanel from './filtersPanel/FilterPanel';\nimport PredictionPane from './predictionPanel/PredictionPanel';\n\ninterface AccordionItem {\n  title: string;\n  component: ReactElement;\n  style?: CSSProperties;\n  hidePreferenceKey: string;\n  mode: '1D' | '2D' | null;\n  isExperimental?: boolean;\n}\n\nconst accordionItems: AccordionItem[] = [\n  {\n    title: 'Spectra',\n    component: <SpectrumListPanel />,\n    hidePreferenceKey: 'spectraPanel',\n    mode: null,\n  },\n  {\n    title: 'Information',\n    component: <InformationPanel />,\n    style: { overflow: 'hidden' },\n    hidePreferenceKey: 'informationPanel',\n    mode: null,\n  },\n  {\n    title: 'Peaks',\n    component: <PeaksPanel />,\n    hidePreferenceKey: 'peaksPanel',\n    mode: null,\n  },\n  {\n    title: 'Filters',\n    component: <FilterPanel />,\n    hidePreferenceKey: 'filtersPanel',\n    mode: null,\n  },\n  {\n    title: 'Integrals',\n    component: <IntegralPanel />,\n    hidePreferenceKey: 'integralsPanel',\n    mode: null,\n  },\n  {\n    title: 'Ranges',\n    component: <RangesPanel />,\n    hidePreferenceKey: 'rangesPanel',\n    mode: DISPLAYER_MODE.DM_1D,\n  },\n  {\n    title: 'Multiple Spectra Analysis',\n    component: <MultipleSpectraAnalysisPanel />,\n    hidePreferenceKey: 'multipleSpectraAnalysisPanel',\n    mode: null,\n  },\n  {\n    title: 'Matrix Generation',\n    component: <MatrixGenerationPanel />,\n    hidePreferenceKey: '',\n    mode: null,\n    isExperimental: true,\n  },\n  {\n    title: 'Zones',\n    component: <ZonesPanel />,\n    hidePreferenceKey: 'zonesPanel',\n    mode: DISPLAYER_MODE.DM_2D,\n  },\n  {\n    title: 'Summary',\n    component: <SummaryPanel />,\n    hidePreferenceKey: 'summaryPanel',\n    mode: null,\n  },\n  {\n    title: 'Structures',\n    component: <MoleculePanel />,\n    hidePreferenceKey: 'structuresPanel',\n    mode: null,\n  },\n  {\n    title: 'Database',\n    component: <DatabasePanel />,\n    hidePreferenceKey: 'databasePanel',\n    mode: null,\n  },\n  {\n    title: 'Automatic Assignment',\n    component: <AutomaticAssignment />,\n    hidePreferenceKey: '',\n    mode: null,\n    isExperimental: true,\n  },\n  {\n    title: 'Prediction',\n    component: <PredictionPane />,\n    hidePreferenceKey: 'predictionPanel',\n    mode: null,\n  },\n];\n\nexport const TOOLS_PANELS_ACCORDION: Record<string, string> = {\n  null: 'Spectra',\n  peakPicking: 'Peaks',\n  integral: 'Integrals',\n  rangesPicking: 'Ranges',\n  zone2D: 'Zones',\n  multipleSpectraAnalysis: 'Multiple Spectra Analysis',\n};\n\nfunction usePanelPreferences(): (item: AccordionItem) => PanelPreferencesType {\n  const preferences = usePreferences();\n\n  return useCallback(\n    (item: AccordionItem) => {\n      return lodashGet(\n        preferences.current,\n        `display.panels.${item.hidePreferenceKey}`,\n      );\n    },\n    [preferences],\n  );\n}\n\nfunction PanelsInner({ displayerMode: displayedMode }) {\n  const getPanelPreferences = usePanelPreferences();\n  const isExperimental = useCheckExperimentalFeature();\n  const check = useCallback(\n    (item) => {\n      const panelOptions = getPanelPreferences(item);\n      return (\n        (panelOptions?.hidden !== true &&\n          panelOptions?.display === true &&\n          item.isExperimental === undefined &&\n          (item.mode == null || item.mode === displayedMode)) ||\n        (item.isExperimental && isExperimental)\n      );\n    },\n    [displayedMode, getPanelPreferences, isExperimental],\n  );\n\n  const isOpened = useCallback(\n    (item: AccordionItem) => {\n      const panelOptions = getPanelPreferences(item);\n      return panelOptions?.hidden !== true && panelOptions?.open;\n    },\n    [getPanelPreferences],\n  );\n\n  return (\n    <div style={{ width: '100%', height: '100%', flex: '1 1 0%' }}>\n      <Accordion>\n        {accordionItems.map((item) => {\n          return (\n            check(item) && (\n              <Accordion.Item\n                key={item.title}\n                title={item.title}\n                defaultOpened={isOpened(item)}\n              >\n                {item.component}\n              </Accordion.Item>\n            )\n          );\n        })}\n      </Accordion>\n    </div>\n  );\n}\n\nconst MemoizedPanels = memo(PanelsInner);\n\nexport default function Panels() {\n  const {\n    displayerMode,\n    toolOptions: { selectedTool },\n  } = useChartData();\n\n  return <MemoizedPanels {...{ displayerMode, selectedTool }} />;\n}\n","import { useToggleAccordion } from 'analysis-ui-components';\nimport lodashDebounce from 'lodash/debounce';\nimport lodashMap from 'lodash/map';\nimport { useCallback, useRef, useState } from 'react';\n\nimport { useDispatch } from '../context/DispatchContext';\nimport { useAlert } from '../elements/popup/Alert';\nimport { TOOLS_PANELS_ACCORDION } from '../panels/Panels';\nimport { ZoomType } from '../reducer/helper/Zoom1DManager';\nimport {\n  CHANGE_SPECTRUM_DISPLAY_VIEW_MODE,\n  FULL_ZOOM_OUT,\n  SET_SELECTED_TOOL,\n  SET_SPECTRUMS_VERTICAL_ALIGN,\n  TOGGLE_REAL_IMAGINARY_VISIBILITY,\n} from '../reducer/types/Types';\nimport { options } from '../toolbar/ToolTypes';\n\nexport default function useToolsFunctions() {\n  const dispatch = useDispatch();\n  const alert = useAlert();\n\n  const { open: openPanel } = useToggleAccordion();\n  const [isRealSpectrumShown, setIsRealSpectrumShown] = useState(false);\n\n  const debounceClickEventsRef = useRef<{ clicks: Array<any> }>({ clicks: [] });\n  const handleChangeOption = useCallback(\n    (selectedTool) => {\n      if (\n        [\n          options.peakPicking.id,\n          options.integral.id,\n          options.zone2D.id,\n          options.exclusionZones.id,\n        ].includes(selectedTool)\n      ) {\n        alert.show('Press Shift + Left Mouse button to select zone');\n      }\n\n      if (Object.keys(TOOLS_PANELS_ACCORDION).includes(selectedTool)) {\n        openPanel(TOOLS_PANELS_ACCORDION[selectedTool]);\n      }\n\n      dispatch({\n        type: SET_SELECTED_TOOL,\n        payload: { selectedTool },\n      });\n    },\n    [alert, dispatch, openPanel],\n  );\n\n  const handleFullZoomOut = useCallback(() => {\n    if (debounceClickEventsRef.current.clicks.length === 0) {\n      dispatch({\n        type: FULL_ZOOM_OUT,\n        zoomType: ZoomType.HORIZONTAL,\n      });\n    }\n    const callback = lodashDebounce(() => {\n      debounceClickEventsRef.current.clicks = [];\n    }, 500);\n    debounceClickEventsRef.current.clicks.push(callback);\n\n    callback();\n\n    if (debounceClickEventsRef.current.clicks.length > 1) {\n      lodashMap(debounceClickEventsRef.current.clicks, (debounce) =>\n        debounce.cancel(),\n      );\n      debounceClickEventsRef.current.clicks = [];\n      dispatch({\n        type: FULL_ZOOM_OUT,\n      });\n    }\n  }, [dispatch, debounceClickEventsRef]);\n\n  const changeDisplayViewModeHandler = useCallback(() => {\n    dispatch({\n      type: CHANGE_SPECTRUM_DISPLAY_VIEW_MODE,\n    });\n  }, [dispatch]);\n\n  const changeSpectrumViewHandler = useCallback(() => {\n    dispatch({\n      type: TOGGLE_REAL_IMAGINARY_VISIBILITY,\n      isRealSpectrumVisible: !isRealSpectrumShown,\n    });\n    setIsRealSpectrumShown(!isRealSpectrumShown);\n  }, [dispatch, isRealSpectrumShown]);\n\n  const alignSpectrumsVerticallyHandler = useCallback(() => {\n    dispatch({\n      type: SET_SPECTRUMS_VERTICAL_ALIGN,\n    });\n  }, [dispatch]);\n\n  return {\n    handleChangeOption,\n    handleFullZoomOut,\n    changeDisplayViewModeHandler,\n    changeSpectrumViewHandler,\n    alignSpectrumsVerticallyHandler,\n    isRealSpectrumShown,\n  };\n}\n","import { useCallback, useEffect, useMemo } from 'react';\n\nimport checkModifierKeyActivated from '../../data/utilities/checkModifierKeyActivated';\nimport { useAssignmentData } from '../assignment/AssignmentsContext';\nimport { useChartData } from '../context/ChartContext';\nimport { useDispatch } from '../context/DispatchContext';\nimport { useLoader } from '../context/LoaderContext';\nimport { useAlert } from '../elements/popup/Alert';\nimport { HighlightedSource, useHighlightData } from '../highlight/index';\nimport useExport from '../hooks/useExport';\nimport useToolsFunctions from '../hooks/useToolsFunctions';\nimport { DISPLAYER_MODE } from '../reducer/core/Constants';\nimport {\n  SET_KEY_PREFERENCES,\n  APPLY_KEY_PREFERENCES,\n  DELETE_INTEGRAL,\n  DELETE_PEAK_NOTATION,\n  DELETE_RANGE,\n  DELETE_2D_ZONE,\n  DELETE_EXCLUSION_ZONE,\n} from '../reducer/types/Types';\nimport { options } from '../toolbar/ToolTypes';\n\nfunction KeysListenerTracker() {\n  const {\n    keysPreferences,\n    displayerMode,\n    overDisplayer,\n    data,\n    activeSpectrum,\n  } = useChartData();\n  const dispatch = useDispatch();\n  const alert = useAlert();\n  const openLoader = useLoader();\n\n  const {\n    handleChangeOption,\n    handleFullZoomOut,\n    alignSpectrumsVerticallyHandler,\n    changeDisplayViewModeHandler,\n  } = useToolsFunctions();\n\n  const { saveToClipboardHandler, saveAsJSONHandler, saveAsHandler } =\n    useExport();\n\n  const { highlight, remove } = useHighlightData();\n\n  const assignmentData = useAssignmentData();\n  const allow1DTool = useMemo(() => {\n    return displayerMode === DISPLAYER_MODE.DM_1D && data && data.length > 0;\n  }, [data, displayerMode]);\n\n  const deleteHandler = useCallback(\n    async (sourceData) => {\n      const {\n        type,\n        extra: { id },\n      } = sourceData;\n\n      switch (type) {\n        case HighlightedSource.INTEGRAL: {\n          dispatch({\n            type: DELETE_INTEGRAL,\n            integralID: id,\n          });\n          // remove keys from the highlighted list after delete\n          remove();\n\n          break;\n        }\n        case HighlightedSource.PEAK: {\n          dispatch({\n            type: DELETE_PEAK_NOTATION,\n            data: { id },\n          });\n          // remove keys from the highlighted list after delete\n          remove();\n\n          break;\n        }\n        case HighlightedSource.RANGE: {\n          dispatch({\n            type: DELETE_RANGE,\n            payload: {\n              data: {\n                id,\n                assignmentData,\n              },\n            },\n          });\n          // remove keys from the highlighted list after delete\n          remove();\n\n          break;\n        }\n        case HighlightedSource.ZONE: {\n          dispatch({\n            type: DELETE_2D_ZONE,\n            payload: {\n              id,\n              assignmentData,\n            },\n          });\n          // remove keys from the highlighted list after delete\n          remove();\n\n          break;\n        }\n        case HighlightedSource.EXCLUSION_ZONE: {\n          const hideLoading = await alert.showLoading(\n            `Exclusion filter in progress`,\n          );\n          dispatch({\n            type: DELETE_EXCLUSION_ZONE,\n            payload: {\n              id,\n              spectrumID: sourceData.extra.spectrumID,\n            },\n          });\n          hideLoading();\n          // remove keys from the highlighted list after delete\n          remove();\n\n          break;\n        }\n\n        default:\n          break;\n      }\n    },\n    [assignmentData, dispatch, remove, alert],\n  );\n\n  const keysPreferencesListenerHandler = useCallback(\n    (e, num) => {\n      if (data && data.length > 0 && num >= 1 && num <= 9) {\n        if (e.shiftKey) {\n          dispatch({\n            type: SET_KEY_PREFERENCES,\n            keyCode: num,\n          });\n          alert.show(`Configuration Reset, press '${num}' again to reload it.`);\n        } else {\n          if (!checkModifierKeyActivated(e)) {\n            if (keysPreferences?.[num]) {\n              dispatch({\n                type: APPLY_KEY_PREFERENCES,\n                keyCode: num,\n              });\n            } else {\n              dispatch({\n                type: SET_KEY_PREFERENCES,\n                keyCode: num,\n              });\n              alert.show(\n                `Configuration saved, press '${num}' again to reload it.`,\n              );\n            }\n          }\n        }\n      }\n    },\n    [alert, data, dispatch, keysPreferences],\n  );\n\n  const toolsListenerHandler = useCallback(\n    (e) => {\n      function check1DModeWithActiveSpectrum(\n        label: string,\n        checkSwitch = true,\n      ) {\n        if (displayerMode === DISPLAYER_MODE.DM_1D && !activeSpectrum) {\n          throw new Error(`Select a spectrum to proceed with ${label}`);\n        } else if (checkSwitch && displayerMode === DISPLAYER_MODE.DM_2D) {\n          throw new Error(\n            `Switch to 1D Mode and select a spectrum to proceed with ${label}`,\n          );\n        }\n      }\n      function check2DModeWithActiveSpectrum(\n        label: string,\n        checkSwitch = true,\n      ) {\n        if (displayerMode === DISPLAYER_MODE.DM_2D && !activeSpectrum) {\n          throw new Error(`Select a spectrum to proceed with ${label}`);\n        } else if (checkSwitch && displayerMode === DISPLAYER_MODE.DM_1D) {\n          throw new Error(\n            `Switch to 2D Mode and select a spectrum to proceed with ${label}`,\n          );\n        }\n      }\n\n      try {\n        if (!e.shiftKey && !e.metaKey) {\n          switch (e.key) {\n            case 'f':\n              handleFullZoomOut();\n              break;\n            case 'z':\n            case 'Escape':\n              handleChangeOption(options.zoom.id);\n              break;\n            case 'r': {\n              if (displayerMode === DISPLAYER_MODE.DM_2D) {\n                check2DModeWithActiveSpectrum(options.zone2D.label, false);\n                handleChangeOption(options.zone2D.id);\n              } else {\n                check1DModeWithActiveSpectrum(\n                  options.rangesPicking.label,\n                  false,\n                );\n                handleChangeOption(options.rangesPicking.id);\n              }\n              break;\n            }\n            case 'a': {\n              check1DModeWithActiveSpectrum(options.phaseCorrection.label);\n              handleChangeOption(options.phaseCorrection.id);\n\n              break;\n            }\n            case 'b': {\n              check1DModeWithActiveSpectrum(options.baseLineCorrection.label);\n              handleChangeOption(options.baseLineCorrection.id);\n\n              break;\n            }\n            case 'p': {\n              check1DModeWithActiveSpectrum(options.peakPicking.label);\n              handleChangeOption(options.peakPicking.id);\n\n              break;\n            }\n            case 'i': {\n              check1DModeWithActiveSpectrum(options.integral.label);\n              handleChangeOption(options.integral.id);\n\n              break;\n            }\n            case 'e': {\n              check1DModeWithActiveSpectrum(options.exclusionZones.label);\n              handleChangeOption(options.exclusionZones.id);\n\n              break;\n            }\n            default:\n          }\n        }\n\n        if (!e.shiftKey && !e.metaKey && !e.ctrlKey) {\n          switch (e.key) {\n            case 'c': {\n              if (allow1DTool) {\n                alignSpectrumsVerticallyHandler();\n              }\n              break;\n            }\n            case 's': {\n              if (allow1DTool) {\n                changeDisplayViewModeHandler();\n              }\n              break;\n            }\n            default:\n          }\n        }\n\n        if (!e.shiftKey && (e.metaKey || e.ctrlKey)) {\n          switch (e.key) {\n            case 'c':\n              void saveToClipboardHandler();\n              e.preventDefault();\n              break;\n            case 's':\n              void saveAsJSONHandler();\n              e.preventDefault();\n              break;\n            case 'o':\n              openLoader();\n              e.preventDefault();\n              break;\n            default:\n          }\n        }\n        if (e.shiftKey && (e.metaKey || e.ctrlKey)) {\n          switch (e.key) {\n            case 's':\n            case 'S':\n              void saveAsHandler();\n              e.preventDefault();\n              break;\n            default:\n          }\n        }\n      } catch (e: any) {\n        alert.error(e.message);\n      }\n    },\n    [\n      activeSpectrum,\n      alert,\n      alignSpectrumsVerticallyHandler,\n      allow1DTool,\n      changeDisplayViewModeHandler,\n      displayerMode,\n      handleChangeOption,\n      handleFullZoomOut,\n      openLoader,\n      saveAsHandler,\n      saveAsJSONHandler,\n      saveToClipboardHandler,\n    ],\n  );\n  const handleOnKeyDown = useCallback(\n    (e) => {\n      if (\n        !['input', 'textarea'].includes(e.target.localName) &&\n        overDisplayer\n      ) {\n        const num = Number(e.code.substr(e.code.length - 1)) || 0;\n        if (num > 0) {\n          keysPreferencesListenerHandler(e, num);\n        } else {\n          if (['Delete', 'Backspace'].includes(e.key) && highlight.sourceData) {\n            e.preventDefault();\n            void deleteHandler(highlight.sourceData);\n          } else {\n            toolsListenerHandler(e);\n          }\n        }\n      }\n    },\n    [\n      deleteHandler,\n      highlight,\n      keysPreferencesListenerHandler,\n      overDisplayer,\n      toolsListenerHandler,\n    ],\n  );\n\n  useEffect(() => {\n    document.addEventListener('keydown', handleOnKeyDown, true);\n\n    return () => document.removeEventListener('keydown', handleOnKeyDown, true);\n  }, [handleOnKeyDown]);\n\n  return null;\n}\n\nexport default KeysListenerTracker;\n","import { isSpectrum1D } from '../../../data/data1d/Spectrum1D';\nimport { Datum1D } from '../../../data/types/data1d';\nimport { Ranges } from '../../../data/types/data1d/Ranges';\nimport { Datum2D, Zones } from '../../../data/types/data2d';\nimport { assignmentState, AssignmentState, Axis } from '../AssignmentsContext';\n\nexport default function initAssignment(action) {\n  const newState = {\n    ...assignmentState,\n  };\n\n  const spectra = (action.payload.spectra || []) as (Datum1D | Datum2D)[];\n  for (const spectrum of spectra) {\n    if (isSpectrum1D(spectrum)) {\n      setRangesAssignments(newState, spectrum.ranges);\n    } else {\n      setZonesAssignments(newState, spectrum.zones);\n    }\n  }\n\n  return newState;\n}\n\nfunction setRangesAssignments(state: AssignmentState, ranges: Ranges) {\n  const diaIDRecords = ranges.values.reduce<{ id: string; diaIDs: string[] }[]>(\n    (acc, { id, diaIDs, signals }) => {\n      acc.push({ id, diaIDs: diaIDs || [] });\n      for (const signal of signals) {\n        acc.push({ id: signal.id, diaIDs: signal.diaIDs || [] });\n      }\n      return acc;\n    },\n    [],\n  );\n\n  for (const { id, diaIDs } of diaIDRecords) {\n    for (const diaID of diaIDs) {\n      setAssignment(state, id, 'x', diaID);\n    }\n  }\n}\nfunction setZonesAssignments(state: AssignmentState, zones: Zones) {\n  const diaIDRecords = zones.values.reduce<\n    { id: string; diaIDs: Record<Axis, string[]> }[]\n  >((acc, { id, x, y, signals }) => {\n    acc.push({ id, diaIDs: { x: x.diaIDs || [], y: y.diaIDs || [] } });\n    for (const signal of signals) {\n      acc.push({\n        id: signal.id,\n        diaIDs: { x: signal.x.diaIDs || [], y: signal.y.diaIDs || [] },\n      });\n    }\n    return acc;\n  }, []);\n\n  for (const { id, diaIDs } of diaIDRecords) {\n    (['x', 'y'] as Axis[]).forEach((axis) => {\n      for (const diaID of diaIDs[axis]) {\n        setAssignment(state, id, axis, diaID);\n      }\n    });\n  }\n}\n\nfunction setAssignment(state: AssignmentState, id, axis: Axis, diaID: string) {\n  if (\n    Array.isArray(state.assignments?.[id]?.[axis]) &&\n    state.assignments[id][axis].includes(diaID)\n  ) {\n    state.assignments[id][axis].push();\n  } else {\n    state.assignments = {\n      ...state.assignments,\n      [id]: { ...state.assignments[id], [axis]: [diaID] },\n    };\n  }\n}\n","import { AssignmentState, Axis } from '../AssignmentsContext';\n\ninterface RemoveAction {\n  ids: string[];\n  atomID?: string;\n  axis: Axis;\n}\n\ninterface AssignmentRemoveOptions extends Omit<RemoveAction, 'ids'> {\n  id: string;\n}\n\nexport function removeAssignment(\n  state: AssignmentState,\n  options: AssignmentRemoveOptions,\n) {\n  const { id, atomID = '', axis } = options;\n\n  const atomIDs = state.assignments?.[id]?.[axis] || null;\n\n  if (atomIDs) {\n    if (atomID) {\n      atomIDs.filter((id) => id !== atomID);\n      state.assignments[id][axis] = atomIDs;\n    } else {\n      state.assignments[id][axis] = [];\n    }\n  }\n}\n\nexport default function removeAssignments(\n  state: AssignmentState,\n  action: RemoveAction,\n) {\n  const newState = {\n    ...state,\n  };\n  // signal id\n  const { ids, atomID = '', axis } = action;\n  for (const id of ids) {\n    removeAssignment(newState, { id, atomID, axis });\n  }\n  return newState;\n}\n","import { AssignmentState } from '../AssignmentsContext';\nimport { SetActiveAction } from '../AssignmentsReducer';\n\nexport default function setActiveAssignment(\n  state: AssignmentState,\n  action: SetActiveAction,\n) {\n  let { id, axis } = action.payload;\n  const isActive = state.activated?.id === id;\n\n  return {\n    ...state,\n    activated: !isActive ? { id, axis: axis || null } : null,\n  };\n}\n","import {\n  AssignmentDimension,\n  AssignmentState,\n  Axis,\n} from '../AssignmentsContext';\nimport { ToggleAction } from '../AssignmentsReducer';\n\nimport { removeAssignment } from './removeAssignment';\n\ninterface AddAction {\n  id: string;\n  atomID: string;\n  axis: Axis;\n  dimension: AssignmentDimension;\n}\n\nfunction addAssignment(state: AssignmentState, action: AddAction) {\n  const { id, atomID, axis, dimension } = action;\n\n  const assignment = state.assignments?.[id] || null;\n  const axisAssignments = assignment?.[axis] || null;\n\n  // avoid duplicates\n  if (axisAssignments) {\n    if (!axisAssignments.includes(id)) {\n      axisAssignments.push(atomID);\n    }\n  } else {\n    const otherAxis = axis === 'x' ? 'y' : 'x';\n    state.assignments = {\n      ...state.assignments,\n      [id]: {\n        ...state.assignments[id],\n        [axis]: [atomID],\n        ...(dimension === '2D' && {\n          [otherAxis]: assignment?.[otherAxis] ? assignment[otherAxis] : [],\n        }),\n      },\n    };\n  }\n}\n\nexport default function ToggleAssignments(\n  state: AssignmentState,\n  action: ToggleAction,\n) {\n  const newState = {\n    ...state,\n  };\n  const { id, atomIDs: atomsKeys, dimension } = action.payload;\n  const axis = state.activated?.axis;\n  if (axis) {\n    const atomIDs = state.assignments?.[id]?.[axis] || [];\n\n    for (const atomID of atomsKeys) {\n      if (!atomIDs.includes(id)) {\n        addAssignment(newState, { axis, id, atomID, dimension });\n      } else {\n        removeAssignment(newState, { atomID, axis, id });\n      }\n    }\n  }\n  return newState;\n}\n","import { Data1D } from '../../data/types/data1d';\nimport { Data2D } from '../../data/types/data2d';\nimport { ActionType } from '../reducer/types/Types';\n\nimport {\n  AssignmentDimension,\n  AssignmentState,\n  Axis,\n} from './AssignmentsContext';\nimport initAssignment from './actions/initAssignment';\nimport removeAssignments from './actions/removeAssignment';\nimport setActiveAssignment from './actions/setActiveAssignment';\nimport toggleAssignment from './actions/toggleAssignment';\n\nexport type InitiateAction = ActionType<\n  'INITIATE_ASSIGNMENTS',\n  { spectra: (Data1D | Data2D)[] }\n>;\nexport type ToggleAction = ActionType<\n  'TOGGLE',\n  { atomIDs: string[]; id: string; dimension: AssignmentDimension }\n>;\nexport type AddAction = ActionType<\n  'ADD',\n  { id: string; atomID: string; axis: Axis }\n>;\nexport type RemoveAction = ActionType<\n  'REMOVE',\n  { ids: string[]; atomID?: string; axis: Axis }\n>;\nexport type SetActiveAction = ActionType<\n  'SET_ACTIVE',\n  { id: string; axis: Axis }\n>;\nexport type ShowAction = ActionType<'SHOW', { id: string; axis?: Axis }>;\n\nexport type AssignmentsActions =\n  | InitiateAction\n  | ToggleAction\n  | AddAction\n  | RemoveAction\n  | SetActiveAction\n  | ShowAction\n  | ActionType<'HIDE'>;\n\nexport default function assignmentReducer(\n  state: AssignmentState,\n  action: AssignmentsActions,\n): AssignmentState {\n  switch (action.type) {\n    case 'INITIATE_ASSIGNMENTS': {\n      return initAssignment(action);\n    }\n    case 'REMOVE': {\n      const { axis, ids, atomID } = action.payload;\n      return removeAssignments(state, { axis, ids, atomID });\n    }\n    case 'TOGGLE': {\n      return toggleAssignment(state, action);\n    }\n    case 'SET_ACTIVE': {\n      return setActiveAssignment(state, action);\n    }\n    case 'SHOW': {\n      const { id, axis } = action.payload;\n      return {\n        ...state,\n        highlighted: {\n          id,\n          axis: axis || null,\n        },\n      };\n    }\n    case 'HIDE': {\n      return {\n        ...state,\n        highlighted: null,\n      };\n    }\n\n    default:\n      return state;\n  }\n}\n","import { useReducer, useMemo, useEffect, Reducer } from 'react';\n\nimport {\n  AssignmentContext,\n  assignmentState,\n  AssignmentState,\n  assignmentContext,\n} from './AssignmentsContext';\nimport assignmentReducer, { AssignmentsActions } from './AssignmentsReducer';\n\nexport function AssignmentProvider(props) {\n  const { spectraData: spectra } = props;\n  const [data, dispatch] = useReducer<\n    Reducer<AssignmentState, AssignmentsActions>\n  >(assignmentReducer, assignmentState);\n\n  const state = useMemo<AssignmentContext>(() => ({ data, dispatch }), [data]);\n\n  useEffect(() => {\n    if (spectra) {\n      dispatch({\n        type: 'INITIATE_ASSIGNMENTS',\n        payload: { spectra },\n      });\n    }\n  }, [spectra]);\n\n  return (\n    <assignmentContext.Provider value={state}>\n      {props.children}\n    </assignmentContext.Provider>\n  );\n}\n","export const docsBaseUrl = 'https://docs.nmrium.org';\n\nexport const helpList: Record<string, { text: string; url: string }> = {\n  zoomIn: {\n    text: 'Zoom Tool',\n    url: `${docsBaseUrl}/help/zoom-and-scale`,\n  },\n  peakPicking: {\n    text: 'peak picking tool',\n    url: `${docsBaseUrl}/help/peaks`,\n  },\n  integralPicking: {\n    text: 'integral tool',\n    url: `${docsBaseUrl}/help/integrations`,\n  },\n  fullScreen: {\n    text: 'Full Screen mode',\n    url: `${docsBaseUrl}/help/general`,\n  },\n  loadSpectrum: {\n    text: 'load spectrums',\n    url: `${docsBaseUrl}/help/loading-a-spectrum`,\n  },\n};\n","export default { version: 'git-1024c2e81febaeef916fbedfd0a9fe6ef3aa1921' };\n","interface LogoProps {\n  width?: number;\n  height?: number;\n}\n\nexport default function Logo({ width = 100, height = 100 }: LogoProps) {\n  return (\n    <svg\n      style={{ width: width, height: height }}\n      xmlns=\"http://www.w3.org/2000/svg\"\n      viewBox=\"0 0 752.34 221.73\"\n    >\n      <path\n        fill=\"#ea580c\"\n        fillRule=\"evenodd\"\n        d=\"M.64,31.7A31.67,31.67,0,0,1,54.72,9.29l0,0A31.66,31.66,0,0,1,64,31.7V190a13.39,13.39,0,0,0,26.77,0V54a31.7,31.7,0,0,1,31.7-31.7V40.58A13.38,13.38,0,0,0,109.13,54V190a31.71,31.71,0,0,1-63.41,0V31.7a13.29,13.29,0,0,0-3.88-9.46l0,0A13.41,13.41,0,0,0,19,31.7V164.82H.64Z\"\n      />\n      <path\n        fill=\"#2b143e\"\n        fillRule=\"evenodd\"\n        d=\"M154.21,54v68.17a13.34,13.34,0,0,0,3.89,9.47h0A13.39,13.39,0,0,0,181,122.14V99.32h-.06a31.63,31.63,0,0,1,9.29-22.38l0,0a31.65,31.65,0,0,1,44.8,0l0,0a31.58,31.58,0,0,1,9.3,22.39V118H226V99.32a13.3,13.3,0,0,0-3.89-9.46h0a13.44,13.44,0,0,0-18.93,0l0,0a13.3,13.3,0,0,0-3.83,8.19v24.09a31.7,31.7,0,0,1-54.11,22.42v0a31.66,31.66,0,0,1-9.3-22.4V54Z\"\n      />\n      <path\n        fill=\"#2b143e\"\n        fillRule=\"evenodd\"\n        d=\"M729.19,96.34c-8.65,0-14.26,3.17-17.67,8-3.41-5.12-8.78-8-16-8-8.16,0-13.52,3.17-16.32,7.31v-5.6H661V159h18.28V124.62c0-7.19,3.41-11.46,9.5-11.46,5.85,0,8.78,3.9,8.78,10V159h18.27V124.62c0-7.19,3.42-11.46,9.51-11.46,5.85,0,8.77,3.9,8.77,10V159h18.28V121.57C752.34,106.33,743.2,96.34,729.19,96.34Z\"\n      />\n      <path\n        fill=\"#2b143e\"\n        fillRule=\"evenodd\"\n        d=\"M629.26,98.05v33.26c0,8.66-4.63,12.56-11.33,12.56-5.85,0-10.6-3.54-10.6-11.09V98.05H589.05v37.41c0,16.45,10.48,25.22,22.79,25.22,8,0,14.13-2.92,17.42-7.43V159h18.28V98.05Z\"\n      />\n      <rect fill=\"#2b143e\" x=\"558.22\" y=\"98.05\" width=\"18.28\" height=\"60.93\" />\n      <path\n        fill=\"#2b143e\"\n        fillRule=\"evenodd\"\n        d=\"M567.36,92.68a11,11,0,1,0-11-11A11.08,11.08,0,0,0,567.36,92.68Z\"\n      />\n      <path\n        fill=\"#ea580c\"\n        fillRule=\"evenodd\"\n        d=\"M478.77,159H498V116.57L525.66,159H549.2l-22.3-34.75c5.45-2.13,8.12-4.14,11.48-8.86a31.07,31.07,0,0,0,6.07-18.26V94.62c0-10.61-3.45-15.93-9.28-21.78S520.75,63.09,510,63.09H478.71l.06,95.89Zm33.1-50.27h-6.46v-.06H498V82.19h10.87c4.67,0,9.44,1.38,11.94,3.81a12.84,12.84,0,0,1,3.81,9.2C524.58,102.52,518.92,108.71,511.87,108.71Z\"\n      />\n      <polygon\n        fill=\"#ea580c\"\n        fillRule=\"evenodd\"\n        points=\"372.91 60.8 372.91 158.98 392.16 158.98 392.16 119.23 419.91 157.41 447.61 119.23 447.61 158.98 466.87 158.98 466.87 60.8 419.91 125.22 372.91 60.8\"\n      />\n      <polygon\n        fill=\"#ea580c\"\n        fillRule=\"evenodd\"\n        points=\"283.89 61.04 283.89 159.1 303.14 159.1 303.14 105.85 361.01 160.93 361.01 62.83 341.67 62.83 341.67 116.08 283.89 61.04\"\n      />\n    </svg>\n  );\n}\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\n\nimport versionInfo from '../../versionInfo';\nimport CloseButton from '../elements/CloseButton';\nimport Logo from '../elements/Logo';\n\nconst styles = css`\n  display: flex;\n  flex-direction: column;\n  user-select:\n  button:focus {\n    outline: none;\n  }\n  .header {\n    height: 34px;\n    border-bottom: 1px solid #f0f0f0;\n    display: flex;\n    padding: 5px;\n\n    span {\n      color: #464646;\n      font-size: 15px;\n      flex: 1;\n      user-select: none;\n\n    }\n\n    button {\n      background-color: transparent;\n      border: none;\n      svg {\n        height: 16px;\n      }\n    }\n  }\n  .container {\n    width: 100%;\n    height: 100%;\n    padding: 20px;\n  }\n\n  .center-container {\n    width: 100%;\n    height: 100%;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n  }\n  ul {\n    list-style-type: disc;\n    margin-left:20px;\n    }\n  span,li{\n    user-select: text;\n  }\n  span.title {\n    font-weight: bold;\n    color: #ea580c;\n  }\n  span.content {\n    color: #2b143e;\n    font-size: 14px;\n    text-align: left;\n  }\n\n  img {\n    width: 100px;\n  }\n\n  a {\n    color: #969696;\n  }\n\n  a:hover,\n  a:focus {\n    color: #00bcd4;\n  }\n\n  .separator {\n    border-bottom: 1px solid gray;\n    width: 15px;\n    height: 1px;\n    margin: 10px 0px;\n  }\n`;\n\ninterface AboutUsModalProps {\n  onClose?: () => null;\n}\n\nfunction AboutUsModal({ onClose = () => null }: AboutUsModalProps) {\n  return (\n    <div css={styles}>\n      <div className=\"header handle\">\n        <span>About NMRium</span>\n\n        <CloseButton onClick={onClose} />\n      </div>\n      <div className=\"container\">\n        <div className=\"center-container\">\n          <Logo width={160} height={50} />\n          Version <VersionInfo />\n          <span className=\"separator\" />\n          <a href=\"https://git.nmrium.org\" target=\"_blank\" rel=\"noreferrer\">\n            GitHub ( https://git.nmrium.org )\n          </a>\n        </div>\n        <div className=\"center-container\">\n          <span className=\"separator\" />\n        </div>\n\n        <span className=\"content\">\n          This project is developed by Zakodium Sàrl (Switzerland), the\n          University of Cologne (Germany), Johannes Gutenberg University Mainz\n          (Germany) and Universidad del Valle (Colombia).\n        </span>\n        <div className=\"center-container\">\n          <span className=\"separator\" />\n          <span className=\"title\">Funding is provided by</span>\n          <span className=\"separator\" />\n        </div>\n\n        <div className=\"content\">\n          <ul>\n            <li>\n              IDNMR grant, which part of the Scientific Library Services and\n              Information Systems (LIS) initiative of the DFG.\n            </li>\n            <li>Zakodium Sàrl (Switzerland).</li>\n            <li>Universidad del Valle (Cali, Colombia).</li>\n          </ul>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default AboutUsModal;\n\nfunction VersionInfo() {\n  const { version } = versionInfo;\n  if (version === 'HEAD') {\n    return <>HEAD</>;\n  } else if (version.startsWith('git-')) {\n    return (\n      <a\n        href={`https://github.com/cheminfo/nmrium/tree/${version.slice(4)}`}\n        target=\"_blank\"\n        rel=\"noreferrer\"\n      >\n        git-{version.slice(4, 14)}\n      </a>\n    );\n  } else {\n    return (\n      <a\n        href={`https://github.com/cheminfo/nmrium/tree/${version}`}\n        target=\"_blank\"\n        rel=\"noreferrer\"\n      >\n        {version}\n      </a>\n    );\n  }\n}\n","import Label from '../../elements/Label';\nimport FormikInput from '../../elements/formik/FormikInput';\n\nfunction ControllersTabContent() {\n  return (\n    <>\n      <p className=\"section-header\">Spectra</p>\n      <Label\n        title=\"Transparency of Dimmed Spectra [ 0 - 1 ]\"\n        // style={{ label: styles.inputLabel, wrapper: styles.inputWrapper }}\n      >\n        <FormikInput\n          name=\"controllers.dimmedSpectraTransparency\"\n          checkValue={(value) => value >= 0 && value <= 1}\n          type=\"number\"\n        />\n      </Label>\n    </>\n  );\n}\n\nexport default ControllersTabContent;\n","import lodashGet from 'lodash/get';\nimport { useMemo } from 'react';\n\nimport { NMRiumPreferences } from '../../NMRium';\nimport ReactTable from '../../elements/ReactTable/ReactTable';\nimport { CustomColumn } from '../../elements/ReactTable/utility/addCustomColumn';\nimport FormikCheckBox from '../../elements/formik/FormikCheckBox';\n\ninterface ListItem {\n  label: string;\n  name: string;\n  hideOpenOption?: boolean;\n}\nconst LIST: ListItem[] = [\n  {\n    label: 'Spectra selection panel',\n    name: 'panels.spectraPanel',\n  },\n  {\n    label: 'Spectra information Panel',\n    name: 'panels.informationPanel',\n  },\n  {\n    label: 'Peaks and peak picking',\n    name: 'panels.peaksPanel',\n  },\n  {\n    label: 'Integration and integrals',\n    name: 'panels.integralsPanel',\n  },\n  {\n    label: '1D ranges peak picking',\n    name: 'panels.rangesPanel',\n  },\n  {\n    label: 'Chemical structure panel',\n    name: 'panels.structuresPanel',\n  },\n  {\n    label: 'Filters Panel',\n    name: 'panels.filtersPanel',\n  },\n  {\n    label: '2D zones peak picking',\n    name: 'panels.zonesPanel',\n  },\n  {\n    label: 'Assignment summary Panel',\n    name: 'panels.summaryPanel',\n  },\n  {\n    label: 'Multiple Spectra Analysis Panel',\n    name: 'panels.multipleSpectraAnalysisPanel',\n  },\n  {\n    label: 'Database Panel',\n    name: 'panels.databasePanel',\n  },\n  {\n    label: 'Prediction Panel',\n    name: 'panels.predictionPanel',\n  },\n  {\n    label: 'Experimental Features',\n    name: 'general.experimentalFeatures',\n    hideOpenOption: true,\n  },\n];\n\ninterface DisplayTabContentProps {\n  preferences: NMRiumPreferences;\n}\n\nfunction CheckBoxCell(props) {\n  return (\n    <FormikCheckBox\n      style={{\n        container: { display: 'block', margin: '0 auto', width: 'fit-content' },\n      }}\n      key={props.name}\n      className=\"checkbox-element\"\n      name={props.name}\n    />\n  );\n}\n\nfunction DisplayTabContent({ preferences }: DisplayTabContentProps) {\n  const COLUMNS: CustomColumn[] = useMemo(\n    () => [\n      {\n        index: 1,\n        Header: '#',\n        Cell: ({ row }) => row.index + 1,\n      },\n      {\n        index: 1,\n        Header: 'Feature',\n        accessor: 'label',\n        style: { width: '60%' },\n      },\n      {\n        index: 2,\n        Header: 'Active',\n        Cell: ({ row }) => (\n          <CheckBoxCell name={`display.${row.original.name}.display`} />\n        ),\n      },\n      {\n        index: 3,\n        Header: 'Open on load',\n        Cell: ({ row }) =>\n          !row.original.hideOpenOption ? (\n            <CheckBoxCell name={`display.${row.original.name}.open`} />\n          ) : (\n            <div />\n          ),\n      },\n    ],\n    [],\n  );\n\n  const data = useMemo(() => {\n    return LIST.filter(\n      (item) => lodashGet(preferences, `${item.name}.hidden`) !== true,\n    );\n  }, [preferences]);\n\n  return (\n    <div style={{ width: '100%', overflow: 'hidden' }}>\n      <ReactTable columns={COLUMNS} data={data} />\n    </div>\n  );\n}\n\nexport default DisplayTabContent;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useFormikContext } from 'formik';\nimport lodashGet from 'lodash/get';\nimport { Fragment, useCallback, useMemo } from 'react';\nimport { FaPlus } from 'react-icons/fa';\n\nimport generateID from '../../../data/utilities/generateID';\nimport CloseButton from '../../elements/CloseButton';\nimport FormikInput from '../../elements/formik/FormikInput';\n\nconst styles = css`\n  .counter-col {\n    width: 30px;\n  }\n  .nucleus-label-col {\n    display: flex;\n    justify-content: center;\n    width: 80px;\n  }\n\n  .width-100 {\n    width: 100% !important;\n    margin: 0px !important;\n  }\n\n  .nucleus-format-input-col {\n    text-align: center;\n    width: 100px;\n  }\n\n  th {\n    font-size: 11px;\n    font-weight: 600;\n  }\n  .operation-container {\n    display: flex;\n  }\n  .add {\n    background-color: transparent;\n    border: 0;\n    outline: none;\n    svg {\n      font-szie: 14px;\n      fill: green;\n    }\n  }\n`;\n\nfunction FormattingTabContent() {\n  const { values, setFieldValue } = useFormikContext();\n  const nuclei = useMemo(\n    () => lodashGet(values, 'formatting.nuclei', {}),\n    [values],\n  );\n\n  const deleteHandler = useCallback(\n    (key: string) => {\n      let _nuclei = {};\n      for (const nucleus in nuclei) {\n        if (nucleus !== key) {\n          _nuclei[nucleus] = nuclei[nucleus];\n        }\n      }\n      setFieldValue('formatting.nuclei', _nuclei);\n    },\n    [nuclei, setFieldValue],\n  );\n\n  const addNewNucleusFormatHandler = useCallback(() => {\n    const newFormat = {\n      name: '',\n      ppm: '0.00',\n      hz: '0.00',\n    };\n    const key = generateID();\n    const newNuclei = { ...nuclei, [key]: newFormat };\n    setFieldValue('formatting.nuclei', newNuclei);\n  }, [nuclei, setFieldValue]);\n\n  const nucleiList = Object.keys(nuclei);\n\n  return (\n    <Fragment>\n      <p className=\"section-header\">Nuclei Formatting</p>\n      <div css={styles}>\n        <table>\n          <thead>\n            <tr>\n              <th className=\"counter-col\">#</th>\n              <th className=\"nucleus-label-col\">Nucleus </th>\n              <th className=\"nucleus-format-input-col\">δ (ppm)</th>\n              <th className=\"nucleus-format-input-col\">Coupling (Hz)</th>\n              <th className=\"nucleus-format-input-col\" />\n            </tr>\n          </thead>\n          <tbody>\n            {nucleiList?.map((key, index) => {\n              const num = index + 1;\n              return (\n                <tr key={`${key}`}>\n                  <td className=\"counter-col\">\n                    <span>{num} - </span>{' '}\n                  </td>\n                  <td className=\"nucleus-label-col\">\n                    <FormikInput\n                      name={`formatting.nuclei.${key}.name`}\n                      className=\"width-100\"\n                      checkErrorAfterInputTouched={false}\n                    />\n                  </td>\n                  <td className=\"nucleus-format-input-col\">\n                    <FormikInput\n                      name={`formatting.nuclei.${key}.ppm`}\n                      className=\"width-100\"\n                    />\n                  </td>\n                  <td className=\"nucleus-format-input-col\">\n                    <FormikInput\n                      name={`formatting.nuclei.${key}.hz`}\n                      className=\"width-100\"\n                    />\n                  </td>\n                  <td className=\"operation-container\">\n                    <CloseButton\n                      onClick={() => deleteHandler(key)}\n                      popupTitle={`remove ${nuclei[key].name}`}\n                      popupPlacement=\"right\"\n                    />\n                    {nucleiList.length === index + 1 && (\n                      <button\n                        className=\"add\"\n                        type=\"button\"\n                        onClick={addNewNucleusFormatHandler}\n                      >\n                        <FaPlus />\n                      </button>\n                    )}\n                  </td>\n                </tr>\n              );\n            })}\n          </tbody>\n        </table>\n      </div>\n    </Fragment>\n  );\n}\n\nexport default FormattingTabContent;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback, useState } from 'react';\n\nimport workspaces from '../../workspaces';\n\nconst styles = css`\n  .container {\n    display: flex;\n    span {\n      padding: 5px !important;\n    }\n    span {\n      flex: 1;\n      text-align: left !important;\n    }\n  }\n\n  .new-container {\n    background-color: #f6f6f6;\n    display: flex;\n    padding: 0.3em;\n\n    input {\n      padding: 0.5em;\n      color: black;\n      outline: none;\n      background-color: transparent !important;\n    }\n  }\n\n  .delete-button:hover {\n    color: white;\n  }\n\n  .save-button:hover {\n    color: green;\n  }\n  .delete-button,\n  .save-button {\n    padding: 5px;\n  }\n`;\n\nconst WorkspaceItem = ({ item, onSave, onDelete }) => {\n  const [name, setName] = useState<string>('');\n  const addWorkspaceHandler = useCallback(\n    (e) => {\n      e.stopPropagation();\n      setName('');\n      onSave(name);\n    },\n    [name, onSave],\n  );\n\n  const deleteWorkspaceHandler = useCallback(\n    (e) => {\n      e.stopPropagation();\n      onDelete(item.key);\n    },\n    [item.key, onDelete],\n  );\n\n  const onTextChange = useCallback((e) => {\n    setName(e.target.value);\n  }, []);\n\n  return (\n    <div css={styles}>\n      {item.key === 'new' ? (\n        <div className=\"new-container\">\n          <input\n            value={name}\n            placeholder=\"Custom workspace\"\n            onClick={(e) => e.stopPropagation()}\n            onChange={onTextChange}\n          />\n          <button\n            type=\"button\"\n            className=\"save-button\"\n            onClick={addWorkspaceHandler}\n            disabled={!name}\n          >\n            save\n          </button>\n        </div>\n      ) : (\n        <div className=\"container\">\n          <span>{item.label}</span>\n          {!workspaces[item.key] && (\n            <button\n              type=\"button\"\n              className=\"delete-button\"\n              onClick={deleteWorkspaceHandler}\n            >\n              Delete\n            </button>\n          )}\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default WorkspaceItem;\n","import * as Yup from 'yup';\n\nimport { Workspace } from '../../workspaces/Workspace';\n\nconst formattingValidation = (obj: Workspace) =>\n  Object.keys(obj.formatting.nuclei).reduce((validate, key) => {\n    validate[key] = Yup.object().shape({\n      name: Yup.string().trim().required('Nucleus is a required field'),\n      ppm: Yup.string().trim().required('PPM format is a required field'),\n      hz: Yup.string().trim().required('Hz format  is a required field'),\n    });\n    return validate;\n  }, {});\n\nexport const validation = Yup.lazy((obj: Workspace) =>\n  Yup.object().shape({\n    formatting: Yup.object().shape<any>({\n      nuclei: Yup.object()\n        .shape(formattingValidation(obj))\n        .test(\n          'Unique',\n          'Nuclei need te be unique',\n          function check(nuclei: Record<string, any>) {\n            let nucleusFrequencies: Record<\n              string,\n              { value: number; fields: string[] }\n            > = {};\n            for (const key of Object.keys(nuclei)) {\n              const _key = nuclei[key].name?.toLowerCase() || '';\n              if (_key) {\n                if (nucleusFrequencies[_key]) {\n                  ++nucleusFrequencies[_key].value;\n                  nucleusFrequencies[_key].fields.push(key);\n                } else {\n                  nucleusFrequencies[_key] = { value: 1, fields: [key] };\n                }\n              }\n            }\n\n            const errors = Object.keys(nucleusFrequencies).reduce<\n              Yup.ValidationError[]\n            >((errorList, key) => {\n              const { value, fields } = nucleusFrequencies[key];\n              if (value > 1) {\n                for (let field of fields) {\n                  errorList.push(\n                    new Yup.ValidationError(\n                      `${key} nucleus must te be unique`,\n                      nuclei[key].name,\n                      `${this.path}.${field}.name`,\n                    ),\n                  );\n                }\n              }\n              return errorList;\n            }, []);\n\n            return new Yup.ValidationError(errors);\n          },\n        ),\n    }),\n  }),\n);\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback, useMemo, useRef, useState } from 'react';\n\nimport {\n  usePreferences,\n  useWorkspacesList,\n} from '../../context/PreferencesContext';\nimport ActionButtons from '../../elements/ActionButtons';\nimport CloseButton from '../../elements/CloseButton';\nimport Tab from '../../elements/Tab/Tab';\nimport Tabs, { PositionsEnum } from '../../elements/Tab/Tabs';\nimport DropDownButton, {\n  DropDownListItem,\n} from '../../elements/dropDownButton/DropDownButton';\nimport FormikForm from '../../elements/formik/FormikForm';\nimport { useAlert } from '../../elements/popup/Alert';\nimport { ModalStyles } from '../ModalStyle';\n\nimport ControllersTabContent from './ControllersTabContent';\nimport DisplayTabContent from './DisplayTabContent';\nimport FormattingTabContent from './FormattingTabContent';\nimport WorkspaceItem from './WorkspaceItem';\nimport { validation } from './settingsValidation';\n\nconst styles = css`\n  .main-content {\n    width: 100%;\n    flex: 1;\n    overflow: auto;\n    border: none;\n  }\n\n  .tab-content {\n    width: 100%;\n  }\n\n  .section-header {\n    font-size: 13px;\n    color: #2ca8ff;\n    margin-bottom: 10px;\n    border-bottom: 0.55px solid #f9f9f9;\n    padding: 6px 2px;\n  }\n\n  .label {\n    font-size: 12px;\n    font-weight: bold;\n    margin-right: 10px;\n  }\n\n  .input {\n    font-size: 14px;\n    border-radius: 5px;\n    border: 1px solid #cccccc;\n    padding: 5px;\n    width: 100px;\n    margin-right: 10px;\n    height: initial !important;\n  }\n\n  .close-bt {\n    border: none;\n    color: red;\n    background-color: transparent;\n    outline: none;\n    position: absolute;\n    right: 10px;\n    top: 2px;\n    width: 30px;\n    height: 30px;\n  }\n\n  .checkbox-label {\n    min-width: 300px;\n    display: inline-block;\n  }\n\n  .help-checkbox-element {\n    .checkbox-label {\n      width: 260px;\n    }\n  }\n\n  .workspace-container {\n    display: flex;\n    background-color: #f4f4f4;\n    align-items: center;\n    cursor: default;\n    padding: 0.5em;\n    .dropdown {\n      padding: 0.4em 1em;\n    }\n    & .label {\n      font-size: 0.8em;\n    }\n  }\n`;\n\ninterface GeneralSettingsProps {\n  onClose?: () => void;\n}\n\nfunction GeneralSettings({ onClose }: GeneralSettingsProps) {\n  const [activeTab, setActiveTab] = useState('controllers');\n  const { dispatch, ...preferences } = usePreferences();\n  const alert = useAlert();\n  const refForm = useRef<any>();\n  const workspaces = useWorkspacesList();\n\n  const workspacesList = useMemo(() => {\n    return workspaces.concat([\n      {\n        key: 'new',\n        label: 'Custom workspace',\n      },\n    ]);\n  }, [workspaces]);\n\n  const handleSave = useCallback(() => {\n    refForm.current.submitForm();\n  }, []);\n  const handleReset = useCallback(() => {\n    dispatch({ type: 'RESET_PREFERENCES' });\n    alert.success('Settings saved successfully');\n    onClose?.();\n  }, [alert, dispatch, onClose]);\n\n  const submitHandler = useCallback(\n    (values) => {\n      dispatch({ type: 'SET_PREFERENCES', payload: values });\n      alert.success('Settings saved successfully');\n\n      onClose?.();\n    },\n    [alert, dispatch, onClose],\n  );\n\n  const tabChangeHandler = useCallback((tab) => {\n    setActiveTab(tab.tabid);\n  }, []);\n\n  const addWorkSpaceHandler = useCallback(\n    (name) => {\n      dispatch({\n        type: 'ADD_WORKSPACE',\n        payload: {\n          workspace: name,\n          data: refForm.current.values,\n        },\n      });\n    },\n    [dispatch],\n  );\n  const deleteWorkSpaceHandler = useCallback(\n    (key) => {\n      dispatch({\n        type: 'REMOVE_WORKSPACE',\n        payload: {\n          workspace: key,\n        },\n      });\n    },\n    [dispatch],\n  );\n\n  const ChangeWorkspaceHandler = useCallback(\n    (option: DropDownListItem) => {\n      dispatch({\n        type: 'SET_WORKSPACE',\n        payload: {\n          workspace: option.key,\n        },\n      });\n    },\n    [dispatch],\n  );\n\n  const renderItem = useCallback(\n    (item) => {\n      return (\n        <WorkspaceItem\n          item={item}\n          onSave={addWorkSpaceHandler}\n          onDelete={deleteWorkSpaceHandler}\n        />\n      );\n    },\n    [addWorkSpaceHandler, deleteWorkSpaceHandler],\n  );\n\n  return (\n    <div css={[ModalStyles, styles]}>\n      <div className=\"header handle\">\n        <span>General Settings</span>\n        <CloseButton onClick={onClose} className=\"close-bt\" />\n      </div>\n      <div className=\"workspace-container\">\n        <span className=\"label\">Workspace : </span>\n\n        <DropDownButton\n          data={workspacesList}\n          renderItem={renderItem}\n          selectedKey={preferences?.workspace.current}\n          onSelect={ChangeWorkspaceHandler}\n        />\n      </div>\n      <div className=\"main-content\">\n        <FormikForm\n          key={JSON.stringify(preferences.current)}\n          ref={refForm}\n          initialValues={preferences.current}\n          validationSchema={validation}\n          onSubmit={submitHandler}\n        >\n          <Tabs\n            position={PositionsEnum.LEFT}\n            activeTab={activeTab}\n            onClick={tabChangeHandler}\n          >\n            <Tab tablabel=\"Controllers\" tabid=\"controllers\">\n              <div className=\"inner-content\">\n                <ControllersTabContent />\n              </div>\n            </Tab>\n\n            <Tab tablabel=\"Formatting\" tabid=\"formatting\">\n              <div className=\"inner-content\">\n                <FormattingTabContent />\n              </div>\n            </Tab>\n\n            <Tab tablabel=\"Display\" tabid=\"display\">\n              <div className=\"inner-content\">\n                <DisplayTabContent preferences={preferences.current.display} />\n              </div>\n            </Tab>\n          </Tabs>\n        </FormikForm>\n      </div>\n      <div className=\"footer-container\">\n        <ActionButtons\n          style={{ flexDirection: 'row-reverse', margin: 0 }}\n          onDone={handleSave}\n          doneLabel=\"Save\"\n          onCancel={handleReset}\n          cancelLabel=\"Reset\"\n        />\n      </div>\n    </div>\n  );\n}\n\nexport default GeneralSettings;\n","import { CSSProperties, useCallback, useRef } from 'react';\n\nimport { useDispatch } from '../context/DispatchContext';\nimport Button from '../elements/Button';\nimport CheckBox from '../elements/CheckBox';\nimport NumberInput from '../elements/NumberInput';\nimport { AUTO_PEAK_PICKING } from '../reducer/types/Types';\n\nconst styles: Record<\n  'container' | 'input' | 'inputContainer' | 'label',\n  CSSProperties\n> = {\n  container: {\n    height: '100%',\n    display: 'flex',\n    fontSize: '12px',\n    alignItems: 'center',\n  },\n  input: {\n    width: '50px',\n  },\n  inputContainer: {\n    flex: '2',\n  },\n  label: {\n    flex: '5',\n  },\n};\n\nfunction AutoPeakPickingOptionPanel() {\n  const dispatch = useDispatch();\n  const minMaxRatioRef = useRef<any>();\n  const maxNumberOfPeaksRef = useRef<any>();\n  const noiseFactor = useRef<any>();\n  const lookNegativeRef = useRef<any>();\n\n  const handleApplyFilter = useCallback(() => {\n    dispatch({\n      type: AUTO_PEAK_PICKING,\n      options: {\n        maxNumberOfPeaks: maxNumberOfPeaksRef.current.value,\n        minMaxRatio: minMaxRatioRef.current.value,\n        noiseFactor: noiseFactor.current.value,\n        lookNegative: lookNegativeRef.current.checked,\n      },\n    });\n  }, [dispatch]);\n\n  return (\n    <div style={styles.container}>\n      <NumberInput\n        ref={maxNumberOfPeaksRef}\n        label=\"Max Number Of Peaks:\"\n        name=\"maxNumberOfPeaks\"\n        style={{\n          input: styles.input,\n          inputContainer: styles.inputContainer,\n          label: styles.label,\n        }}\n        defaultValue={50}\n      />\n      <NumberInput\n        ref={noiseFactor}\n        label=\"Noise factor\"\n        name=\"noiseFactor\"\n        style={{\n          input: styles.input,\n          inputContainer: styles.inputContainer,\n          label: styles.label,\n        }}\n        defaultValue={3}\n      />\n      <NumberInput\n        ref={minMaxRatioRef}\n        label=\"Min Max Ratio:\"\n        name=\"minMaxRatio\"\n        style={{\n          input: styles.input,\n          inputContainer: styles.inputContainer,\n          label: styles.label,\n        }}\n        defaultValue={0.1}\n        step=\"0.01\"\n      />\n\n      <div style={{ justifyItems: 'baseline', marginRight: '3px' }}>\n        <label\n          style={{ marginRight: '2px', lineHeight: 2, userSelect: 'none' }}\n          htmlFor=\"lookNegative\"\n        >\n          Detect Negative:\n        </label>\n        <CheckBox name=\"lookNegative\" ref={lookNegativeRef} />\n      </div>\n      <Button.Done onClick={handleApplyFilter} style={{ margin: '0 10px' }}>\n        Apply\n      </Button.Done>\n    </div>\n  );\n}\n\nexport default AutoPeakPickingOptionPanel;\n","import { useCallback, useRef, useState, CSSProperties, useMemo } from 'react';\nimport * as Yup from 'yup';\n\nimport { baselineAlgorithms } from '../../data/data1d/filter1d/baselineCorrection';\nimport { useDispatch } from '../context/DispatchContext';\nimport Label from '../elements/Label';\nimport Select from '../elements/Select';\nimport FormikForm from '../elements/formik/FormikForm';\nimport FormikInput from '../elements/formik/FormikInput';\nimport {\n  RESET_SELECTED_TOOL,\n  APPLY_BASE_LINE_CORRECTION_FILTER,\n} from '../reducer/types/Types';\n\nimport ActionButtons from '../elements/ActionButtons';\n\nconst styles: Record<'container' | 'label', CSSProperties> = {\n  container: {\n    padding: '5px',\n    height: '100%',\n    display: 'flex',\n    alignItems: 'center',\n  },\n  label: {\n    lineHeight: 2,\n    userSelect: 'none',\n  },\n};\n\nfunction BaseLineCorrectionPanel() {\n  const dispatch = useDispatch();\n  const formRef = useRef<any>();\n  const algorithmRef = useRef<any>();\n\n  const [algorithm, setAlgorithm] = useState('polynomial');\n\n  const handleApplyFilter = useCallback(\n    (values) => {\n      let options = {};\n      switch (algorithm) {\n        case 'airpls':\n          options = {\n            algorithm: algorithmRef.current.value,\n            ...values,\n          };\n          break;\n        case 'polynomial':\n          options = {\n            algorithm: algorithmRef.current.value,\n            ...values,\n          };\n          break;\n        default:\n          break;\n      }\n      dispatch({\n        type: APPLY_BASE_LINE_CORRECTION_FILTER,\n        options,\n      });\n    },\n    [algorithm, dispatch],\n  );\n\n  const handleCancelFilter = useCallback(() => {\n    dispatch({\n      type: RESET_SELECTED_TOOL,\n    });\n  }, [dispatch]);\n\n  const getAlgorithmsList = useCallback(() => {\n    return Object.keys(baselineAlgorithms).map((val) => {\n      return { key: val, label: baselineAlgorithms[val], value: val };\n    });\n  }, []);\n\n  const changeAlgorithmHandler = useCallback((val) => {\n    setAlgorithm(val);\n  }, []);\n\n  const formData = useMemo(() => {\n    switch (algorithm) {\n      case 'airpls': {\n        const validation = Yup.object().shape({\n          maxIterations: Yup.number().integer().min(1).required(),\n          tolerance: Yup.number().moreThan(0).required(),\n        });\n        return {\n          validation,\n          initialValue: { maxIterations: 100, tolerance: 0.001 },\n        };\n      }\n      case 'autoPolynomial':\n      case 'polynomial': {\n        const validation = Yup.object().shape({\n          degree: Yup.number().integer().min(1).max(6).required(),\n        });\n\n        return { validation, initialValue: { degree: 3 } };\n      }\n      default:\n        return { validation: {}, initialValue: {} };\n    }\n  }, [algorithm]);\n\n  return (\n    <div style={styles.container}>\n      <span style={styles.label}>Algorithm: </span>\n      <Select\n        ref={algorithmRef}\n        data={getAlgorithmsList()}\n        style={{ marginLeft: 10, marginRight: 10 }}\n        onChange={changeAlgorithmHandler}\n        defaultValue=\"polynomial\"\n      />\n\n      <FormikForm\n        ref={formRef}\n        onSubmit={handleApplyFilter}\n        key={JSON.stringify(formData.initialValue)}\n        initialValues={formData.initialValue}\n        validationSchema={formData.validation}\n      >\n        {algorithm && algorithm === 'airpls' && (\n          <div style={{ display: 'flex' }}>\n            <Label title=\"maxIterations:\">\n              <FormikInput type=\"number\" name=\"maxIterations\" />\n            </Label>\n            <Label title=\"tolerance:\" style={{ label: { padding: '0 5px' } }}>\n              <FormikInput type=\"number\" name=\"tolerance\" />\n            </Label>\n          </div>\n        )}\n\n        {algorithm && ['autoPolynomial', 'polynomial'].includes(algorithm) && (\n          <Label title=\"degree [ 1 - 6 ]:\">\n            <FormikInput\n              type=\"number\"\n              name=\"degree\"\n              min={1}\n              max={6}\n              style={{ inputWrapper: { height: '100%' } }}\n            />\n          </Label>\n        )}\n      </FormikForm>\n\n      <ActionButtons\n        onDone={() => formRef.current.submitForm()}\n        onCancel={handleCancelFilter}\n      />\n    </div>\n  );\n}\n\nexport default BaseLineCorrectionPanel;\n","import {\n  CSSProperties,\n  forwardRef,\n  useCallback,\n  useImperativeHandle,\n  useRef,\n} from 'react';\n\nconst styles: Record<'container' | 'label', CSSProperties> = {\n  container: {\n    width: '100%',\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'center',\n    border: '0.55px solid #c7c7c7',\n    borderRadius: '5px',\n    userSelect: 'none',\n    backgroundColor: '#18ce0f14',\n    fontSize: '10px',\n    color: '#00801d',\n    margin: '0px 5px',\n    cursor: 'ew-resize',\n  },\n  label: {\n    whiteSpace: 'nowrap',\n    textOverflow: 'ellipsis',\n    overflow: 'hidden',\n    maxWidth: '100%',\n    paddingLeft: '5px',\n    paddingRight: '5px',\n  },\n};\n\ninterface InputRangeProps {\n  name: string;\n  value?: number;\n  onChange: (element: any) => void;\n  label?: string;\n  style?: CSSProperties;\n  className?: string;\n}\n\n// TODO: remove this hacky ref usage.\nfunction InputRange(props: InputRangeProps, ref: any) {\n  const { name, value = 0, onChange, label, style, className } = props;\n  const previousPosition = useRef(0);\n  const valueRef = useRef(value);\n\n  useImperativeHandle(ref, () => ({\n    setValue: (value) => {\n      valueRef.current = value;\n    },\n  }));\n\n  const mouseDownCallback = useCallback(\n    (event) => {\n      function mouseMoveCallback(event) {\n        let diff = event.clientX - previousPosition.current;\n        previousPosition.current = event.clientX;\n        if (event.buttons === 1) {\n          const step = diff / (event.shiftKey ? 10 : 1);\n          valueRef.current = valueRef.current + step;\n          onChange({\n            value: valueRef.current,\n            name,\n          });\n        }\n      }\n\n      function mouseUpCallback() {\n        window.removeEventListener('mousemove', mouseMoveCallback);\n        window.removeEventListener('mouseup', mouseUpCallback);\n      }\n\n      previousPosition.current = event.clientX;\n      window.addEventListener('mousemove', mouseMoveCallback);\n      window.addEventListener('mouseup', mouseUpCallback);\n    },\n    [name, onChange],\n  );\n\n  return (\n    <div\n      style={{ ...styles.container, ...style }}\n      className={className}\n      onMouseDown={mouseDownCallback}\n    >\n      <span style={styles.label}>{label}</span>\n    </div>\n  );\n}\n\nexport default forwardRef(InputRange);\n","import {\n  useMemo,\n  CSSProperties,\n  memo,\n  useCallback,\n  useEffect,\n  useRef,\n  useState,\n} from 'react';\n\nimport * as Filters from '../../data/Filters';\nimport { Filter } from '../../data/FiltersManager';\nimport { Data1D, Datum1D } from '../../data/types/data1d';\nimport { useChartData } from '../context/ChartContext';\nimport { useDispatch } from '../context/DispatchContext';\nimport ActionButtons from '../elements/ActionButtons';\nimport Input from '../elements/Input';\nimport InputRange from '../elements/InputRange';\nimport Label from '../elements/Label';\nimport Select from '../elements/Select';\nimport useSpectrum from '../hooks/useSpectrum';\nimport {\n  APPLY_MANUAL_PHASE_CORRECTION_FILTER,\n  APPLY_AUTO_PHASE_CORRECTION_FILTER,\n  CALCULATE_MANUAL_PHASE_CORRECTION_FILTER,\n  RESET_SELECTED_TOOL,\n  APPLY_ABSOLUTE_FILTER,\n} from '../reducer/types/Types';\n\nconst styles: Record<'container' | 'input' | 'select', CSSProperties> = {\n  container: {\n    padding: '5px',\n    height: '100%',\n    display: 'flex',\n  },\n  input: {\n    width: '100px',\n  },\n  select: {\n    marginLeft: '5px',\n    marginRight: '10px',\n    border: 'none',\n    height: '20px',\n  },\n};\n\nconst phaseCorrectionTypes = {\n  manual: 'manual',\n  automatic: 'automatic',\n  absolute: 'absolute',\n};\n\nconst algorithms = [\n  {\n    key: phaseCorrectionTypes.manual,\n    label: 'Manual',\n    value: phaseCorrectionTypes.manual,\n  },\n  {\n    key: phaseCorrectionTypes.automatic,\n    label: 'Automatic',\n    value: phaseCorrectionTypes.automatic,\n  },\n  {\n    key: phaseCorrectionTypes.absolute,\n    label: 'Absolute',\n    value: phaseCorrectionTypes.absolute,\n  },\n];\n\ninterface ManualPhaseCorrectionPanelInnerProps {\n  data: Data1D;\n  pivot: { index: number };\n  filter: Filter | null;\n}\n\nfunction ManualPhaseCorrectionPanelInner({\n  data,\n  pivot,\n  filter,\n}: ManualPhaseCorrectionPanelInnerProps) {\n  const dispatch = useDispatch();\n  const [value, setValue] = useState({ ph0: 0, ph1: 0 });\n  const valueRef = useRef({ ph0: 0, ph1: 0 });\n\n  const ph0Ref = useRef<any>();\n  const ph1Ref = useRef<any>();\n\n  const [phaseCorrectionType, setPhaseCorrectionType] = useState(\n    phaseCorrectionTypes.manual,\n  );\n\n  useEffect(() => {\n    if (filter) {\n      valueRef.current = filter.value;\n      setValue(filter.value);\n      ph0Ref.current.setValue(filter.value.ph0);\n      ph1Ref.current.setValue(filter.value.ph1);\n    } else {\n      ph0Ref.current.setValue(valueRef.current.ph0);\n      ph1Ref.current.setValue(valueRef.current.ph1);\n    }\n  }, [filter]);\n\n  const handleApplyFilter = useCallback(() => {\n    switch (phaseCorrectionType) {\n      case phaseCorrectionTypes.automatic: {\n        dispatch({\n          type: APPLY_AUTO_PHASE_CORRECTION_FILTER,\n        });\n        break;\n      }\n\n      case phaseCorrectionTypes.manual: {\n        dispatch({\n          type: APPLY_MANUAL_PHASE_CORRECTION_FILTER,\n          value,\n        });\n        break;\n      }\n      case phaseCorrectionTypes.absolute: {\n        dispatch({\n          type: APPLY_ABSOLUTE_FILTER,\n        });\n        break;\n      }\n      default:\n        break;\n    }\n  }, [dispatch, phaseCorrectionType, value]);\n\n  const calcPhaseCorrectionHandler = useCallback(\n    (newValues, filedName) => {\n      if (filedName === 'ph1' && data.re) {\n        const diff0 = newValues.ph0 - valueRef.current.ph0;\n        const diff1 = newValues.ph1 - valueRef.current.ph1;\n        newValues.ph0 += diff0 - (diff1 * pivot?.index) / data.re.length;\n      }\n\n      dispatch({\n        type: CALCULATE_MANUAL_PHASE_CORRECTION_FILTER,\n        value: newValues,\n      });\n    },\n    [data.re, dispatch, pivot?.index],\n  );\n\n  const handleInput = useCallback(\n    (e) => {\n      const { name, value } = e.target;\n      if (e.target) {\n        const newValue = { ...valueRef.current, [name]: value };\n        if (String(value).trim() !== '-') {\n          calcPhaseCorrectionHandler(newValue, name);\n        }\n        valueRef.current = newValue;\n        setValue(valueRef.current);\n      }\n    },\n    [calcPhaseCorrectionHandler],\n  );\n\n  const handleRangeChange = useCallback(\n    (e) => {\n      const newValue = { ...valueRef.current, [e.name]: e.value };\n      calcPhaseCorrectionHandler(newValue, e.name);\n      valueRef.current = newValue;\n      setValue(valueRef.current);\n    },\n    [calcPhaseCorrectionHandler],\n  );\n\n  const handleCancelFilter = useCallback(() => {\n    dispatch({\n      type: RESET_SELECTED_TOOL,\n    });\n  }, [dispatch]);\n\n  const onChangeHandler = useCallback((val) => {\n    setPhaseCorrectionType(val);\n  }, []);\n\n  return (\n    <div style={styles.container}>\n      <Select\n        onChange={onChangeHandler}\n        data={algorithms}\n        defaultValue={phaseCorrectionTypes.manual}\n        style={styles.select}\n      />\n\n      {phaseCorrectionType === phaseCorrectionTypes.manual && (\n        <>\n          <Label title=\"PH0 :\" style={{ wrapper: { marginRight: '5px' } }}>\n            <Input\n              name=\"ph0\"\n              style={{ input: styles.input }}\n              onChange={handleInput}\n              value={value.ph0}\n              type=\"number\"\n              debounceTime={250}\n            />\n          </Label>\n          <Label title=\"PH1 :\">\n            <Input\n              name=\"ph1\"\n              style={{ input: styles.input }}\n              onChange={handleInput}\n              value={value.ph1}\n              type=\"number\"\n              debounceTime={250}\n            />\n          </Label>\n          <InputRange\n            ref={ph0Ref}\n            name=\"ph0\"\n            label=\"Change Ph0 By mouse click and drag\"\n            style={{ width: '20%' }}\n            onChange={handleRangeChange}\n          />\n          <InputRange\n            ref={ph1Ref}\n            name=\"ph1\"\n            label=\"Change Ph1 By mouse click and drag\"\n            style={{ width: '20%' }}\n            onChange={handleRangeChange}\n          />\n        </>\n      )}\n\n      <ActionButtons onDone={handleApplyFilter} onCancel={handleCancelFilter} />\n    </div>\n  );\n}\n\nconst MemoizedManualPhaseCorrectionPanel = memo(\n  ManualPhaseCorrectionPanelInner,\n);\n\nconst emptyData = { datum: {}, filter: null };\nexport default function ManualPhaseCorrectionPanel() {\n  const {\n    toolOptions: {\n      data: { pivot },\n    },\n  } = useChartData();\n\n  const { data, filters } = useSpectrum(emptyData) as Datum1D;\n\n  const filter = useMemo(() => {\n    return (\n      filters.find((filter) => filter.name === Filters.phaseCorrection.id) ||\n      null\n    );\n  }, [filters]);\n\n  return <MemoizedManualPhaseCorrectionPanel {...{ data, filter, pivot }} />;\n}\n","import { CSSProperties, useCallback, useRef } from 'react';\n\nimport { useDispatch } from '../context/DispatchContext';\nimport Button from '../elements/Button';\nimport CheckBox from '../elements/CheckBox';\nimport NumberInput from '../elements/NumberInput';\nimport { AUTO_RANGES_DETECTION } from '../reducer/types/Types';\n\nconst styles: Record<\n  'container' | 'input' | 'inputContainer' | 'label' | 'hint',\n  CSSProperties\n> = {\n  container: {\n    padding: '5px',\n    height: '100%',\n    display: 'flex',\n    fontSize: '12px',\n    alignItems: 'baseline',\n  },\n  input: {\n    height: '100%',\n    width: '50px',\n    borderRadius: '5px',\n    border: '0.55px solid #c7c7c7',\n    margin: '0px 5px 0px 5px',\n    textAlign: 'center',\n  },\n  inputContainer: {\n    flex: 2,\n  },\n  label: {\n    flex: 5,\n  },\n\n  hint: {\n    lineHeight: 2,\n    userSelect: 'none',\n    fontSize: '11px',\n  },\n};\n\nfunction RangesPickingOptionPanel() {\n  const dispatch = useDispatch();\n  const lookNegativeRef = useRef<any>();\n  const minMaxRatioRef = useRef<any>();\n\n  const handleApplyFilter = useCallback(() => {\n    dispatch({\n      type: AUTO_RANGES_DETECTION,\n      options: {\n        peakPicking: {\n          minMaxRatio: Number(minMaxRatioRef.current.value) || 0.05,\n          lookNegative: lookNegativeRef.current.checked,\n        },\n      },\n    });\n  }, [dispatch]);\n\n  return (\n    <div style={styles.container}>\n      <div style={{ justifyItems: 'baseline', margin: '0 10px' }}>\n        <label\n          style={{ marginRight: '2px', lineHeight: 2, userSelect: 'none' }}\n          htmlFor=\"lookNegative\"\n        >\n          Detect negative:\n        </label>\n        <CheckBox name=\"lookNegative\" ref={lookNegativeRef} />\n      </div>\n      <NumberInput\n        ref={minMaxRatioRef}\n        label=\"Min Max Ratio:\"\n        name=\"minMaxRatio\"\n        style={{\n          input: styles.input,\n          inputContainer: styles.inputContainer,\n          label: styles.label,\n        }}\n        defaultValue={0.05}\n        step=\"0.01\"\n      />\n\n      <Button.Done onClick={handleApplyFilter} style={{ margin: '0 10px' }}>\n        Auto ranges picking\n      </Button.Done>\n      <span style={styles.hint}>\n        Manual selection using SHIFT + select zone or click on Auto peak picking\n      </span>\n    </div>\n  );\n}\n\nexport default RangesPickingOptionPanel;\n","import { CSSProperties, useCallback, useRef, useState } from 'react';\n\nimport { Data1D } from '../../data/types/data1d';\nimport generateNumbersPowerOfX from '../../data/utilities/generateNumbersPowerOfX';\nimport { useChartData } from '../context/ChartContext';\nimport { useDispatch } from '../context/DispatchContext';\nimport ActionButtons from '../elements/ActionButtons';\nimport Select from '../elements/Select';\nimport {\n  APPLY_ZERO_FILLING_FILTER,\n  RESET_SELECTED_TOOL,\n} from '../reducer/types/Types';\n\nconst styles: Record<'container' | 'input' | 'label', CSSProperties> = {\n  container: {\n    padding: '5px',\n    height: '100%',\n    display: 'flex',\n  },\n\n  input: {\n    height: '100%',\n    width: '80px',\n    borderRadius: '5px',\n    border: '0.55px solid #c7c7c7',\n    margin: '0px 5px 0px 5px',\n    textAlign: 'center',\n  },\n\n  label: {\n    lineHeight: 2,\n    userSelect: 'none',\n  },\n};\n\nconst Sizes = generateNumbersPowerOfX(8, 21);\n\nfunction ZeroFillingOptionsPanel() {\n  const dispatch = useDispatch();\n  const { data, activeSpectrum } = useChartData();\n  const sizeTextInputRef = useRef<any>();\n  const [lineBroadeningValue, setLineBroadeningValue] = useState(1);\n\n  const handleApplyFilter = useCallback(() => {\n    dispatch({\n      type: APPLY_ZERO_FILLING_FILTER,\n      value: {\n        zeroFillingSize: Number(sizeTextInputRef.current.value),\n        lineBroadeningValue: lineBroadeningValue,\n      },\n    });\n  }, [dispatch, lineBroadeningValue]);\n\n  const getDefaultValue = useCallback(() => {\n    if (data && activeSpectrum?.id) {\n      return (\n        2 **\n        Math.round(\n          Math.log2((data[activeSpectrum.index].data as Data1D).x.length),\n        )\n      );\n    }\n    return '';\n  }, [activeSpectrum, data]);\n\n  const handleInput = useCallback(\n    (e) => {\n      if (e.target) {\n        const _value = e.target.validity.valid\n          ? Number(e.target.value)\n          : lineBroadeningValue;\n        setLineBroadeningValue(_value);\n      }\n    },\n    [lineBroadeningValue],\n  );\n\n  const handleCancelFilter = useCallback(() => {\n    dispatch({\n      type: RESET_SELECTED_TOOL,\n    });\n  }, [dispatch]);\n\n  return (\n    <div style={styles.container}>\n      <span style={styles.label}>Size: </span>\n      <Select\n        ref={sizeTextInputRef}\n        data={Sizes}\n        style={{ marginLeft: 10, marginRight: 10 }}\n        defaultValue={getDefaultValue()}\n      />\n      <span style={styles.label}>Line Broadening: </span>\n      <input\n        name=\"line-broadening\"\n        style={styles.input}\n        type=\"number\"\n        defaultValue={lineBroadeningValue}\n        onInput={handleInput}\n        pattern=\"^\\d*(\\.\\d{0,2})?$\"\n        step=\"any\"\n      />\n      <ActionButtons onDone={handleApplyFilter} onCancel={handleCancelFilter} />\n    </div>\n  );\n}\n\nexport default ZeroFillingOptionsPanel;\n","import { CSSProperties, useCallback, useRef } from 'react';\n\nimport { useDispatch } from '../context/DispatchContext';\nimport Button from '../elements/Button';\nimport NumberInput from '../elements/NumberInput';\nimport {\n  AUTO_ZONES_DETECTION,\n  CHANGE_ZONES_NOISE_FACTOR,\n} from '../reducer/types/Types';\n\nconst styles: Record<\n  'container' | 'input' | 'inputContainer' | 'label',\n  CSSProperties\n> = {\n  container: {\n    padding: '5px',\n    height: '100%',\n    display: 'flex',\n    fontSize: '12px',\n  },\n  input: {\n    width: '50px',\n  },\n  inputContainer: {\n    flex: '2',\n  },\n  label: {\n    flex: '5',\n  },\n};\n\nfunction Zones2DOptionPanel() {\n  const dispatch = useDispatch();\n  const thresholdFactor = useRef<any>();\n\n  const handleApplyFilter = useCallback(() => {\n    dispatch({\n      type: AUTO_ZONES_DETECTION,\n      options: {\n        thresholdFactor: thresholdFactor.current.value,\n      },\n    });\n  }, [dispatch]);\n\n  const handleInput = useCallback(\n    (e) => {\n      if (e.target) {\n        dispatch({ type: CHANGE_ZONES_NOISE_FACTOR, payload: e.target.value });\n      }\n    },\n    [dispatch],\n  );\n\n  return (\n    <div style={styles.container}>\n      <NumberInput\n        ref={thresholdFactor}\n        label=\"NoiseFactor\"\n        name=\"noiseFactor\"\n        style={{\n          input: styles.input,\n          inputContainer: styles.inputContainer,\n          label: styles.label,\n        }}\n        defaultValue={1}\n        onChange={handleInput}\n      />\n      <Button.Done onClick={handleApplyFilter} style={{ margin: '0 10px' }}>\n        Auto Zones Picking\n      </Button.Done>\n    </div>\n  );\n}\n\nexport default Zones2DOptionPanel;\n","import { Header, Toolbar } from 'analysis-ui-components';\nimport { SvgLogoNmrium } from 'cheminfo-font';\nimport { useMemo, useCallback, memo } from 'react';\nimport {\n  FaRegWindowMaximize,\n  FaWrench,\n  FaQuestionCircle,\n} from 'react-icons/fa';\n\nimport { docsBaseUrl } from '../../constants';\nimport { useChartData } from '../context/ChartContext';\nimport {\n  usePreferences,\n  useWorkspacesList,\n} from '../context/PreferencesContext';\nimport DropDownButton, {\n  DropDownListItem,\n} from '../elements/dropDownButton/DropDownButton';\nimport { useModal, positions } from '../elements/popup/Modal';\nimport AboutUsModal from '../modal/AboutUsModal';\nimport GeneralSettings from '../modal/setting/GeneralSettings';\nimport { options } from '../toolbar/ToolTypes';\n\nimport AutoPeakPickingOptionPanel from './AutoPeakPickingOptionPanel';\nimport BaseLineCorrectionPanel from './BaseLineCorrectionPanel';\nimport ManualPhaseCorrectionPanel from './ManualPhaseCorrectionPanel';\nimport RangesPickingOptionPanel from './RangesPickingOptionPanel';\nimport ZeroFillingOptionsPanel from './ZeroFillingOptionsPanel';\nimport Zones2DOptionPanel from './Zones2DOptionPanel';\n\ninterface HeaderInnerProps {\n  onMaximize?: () => void;\n  isFullscreen: boolean;\n  selectedOptionPanel: string | null;\n}\n\nfunction HeaderInner(props: HeaderInnerProps) {\n  const { isFullscreen, onMaximize = () => null, selectedOptionPanel } = props;\n\n  const modal = useModal();\n  const {\n    current: {\n      display: { general },\n    },\n    workspace,\n    dispatch,\n  } = usePreferences();\n\n  const workspacesList = useWorkspacesList();\n  const hideGeneralSettings =\n    general?.hideGeneralSettings && workspace.base ? true : false;\n\n  const selectedPanel = useMemo(() => {\n    switch (selectedOptionPanel) {\n      case options.zeroFilling.id:\n        return <ZeroFillingOptionsPanel />;\n      case options.phaseCorrection.id:\n        return <ManualPhaseCorrectionPanel />;\n      case options.peakPicking.id:\n        return <AutoPeakPickingOptionPanel />;\n      case options.rangesPicking.id:\n        return <RangesPickingOptionPanel />;\n      case options.baseLineCorrection.id:\n        return <BaseLineCorrectionPanel />;\n      case options.zone2D.id:\n        return <Zones2DOptionPanel />;\n      default:\n        break;\n    }\n  }, [selectedOptionPanel]);\n\n  const openGeneralSettingsHandler = useCallback(() => {\n    modal.show(<GeneralSettings />, {\n      position: positions.TOP_CENTER,\n      enableResizing: true,\n      width: 600,\n      height: 400,\n    });\n  }, [modal]);\n\n  const openAboutUs = useCallback(() => {\n    modal.show(<AboutUsModal />, {\n      isBackgroundBlur: false,\n      position: positions.MIDDLE,\n      width: 500,\n      height: 480,\n    });\n  }, [modal]);\n\n  const changeWorkspaceHandler = useCallback(\n    (option: DropDownListItem) => {\n      dispatch({\n        type: 'SET_WORKSPACE',\n        payload: {\n          workspace: option.key,\n        },\n      });\n    },\n    [dispatch],\n  );\n\n  return (\n    <Header>\n      <div\n        style={{\n          display: 'flex',\n          flexDirection: 'row',\n          alignItems: 'center',\n        }}\n      >\n        <div>\n          <Toolbar orientation=\"horizontal\">\n            <Toolbar.Item\n              onClick={openAboutUs}\n              titleOrientation=\"horizontal\"\n              id=\"logo\"\n              title=\"About NMRium\"\n            >\n              <div\n                style={{\n                  display: 'flex',\n                  alignItems: 'center',\n                  justifyContent: 'center',\n                }}\n              >\n                <SvgLogoNmrium />\n              </div>\n            </Toolbar.Item>\n          </Toolbar>\n        </div>\n        <div className=\"toolOptionsPanel\">{selectedPanel}</div>\n      </div>\n      <div\n        style={{\n          display: 'flex',\n          flexDirection: 'row',\n          alignItems: 'center',\n        }}\n      >\n        {!hideGeneralSettings && (\n          <DropDownButton\n            data={workspacesList}\n            selectedKey={workspace.current}\n            onSelect={changeWorkspaceHandler}\n          />\n        )}\n        <div>\n          <Toolbar orientation=\"horizontal\">\n            <Toolbar.Item\n              id=\"user-manual\"\n              title=\"User manual\"\n              onClick={() => window.open(docsBaseUrl, '_blank')}\n            >\n              <FaQuestionCircle />\n            </Toolbar.Item>\n            {!hideGeneralSettings && (\n              <Toolbar.Item\n                id=\"general-settings\"\n                onClick={openGeneralSettingsHandler}\n                title=\"General settings\"\n              >\n                <FaWrench />\n              </Toolbar.Item>\n            )}\n\n            {!isFullscreen && (\n              <Toolbar.Item\n                id=\"full-screen\"\n                onClick={onMaximize}\n                title=\"Full Screen\"\n                className=\"windowButton\"\n              >\n                <FaRegWindowMaximize />\n              </Toolbar.Item>\n            )}\n          </Toolbar>\n        </div>\n      </div>\n    </Header>\n  );\n}\n\nconst MemoizedHeader = memo(HeaderInner);\n\nexport default function HeaderWrapper({ isFullscreen, onMaximize }) {\n  const {\n    toolOptions: { selectedOptionPanel },\n  } = useChartData();\n  return (\n    <MemoizedHeader\n      {...{\n        selectedOptionPanel,\n        isFullscreen,\n        onMaximize,\n      }}\n    />\n  );\n}\n","export const FILES_TYPES = {\n  MOL: 'mol',\n  NMRIUM: 'nmrium',\n  JSON: 'json',\n  DX: 'dx',\n  JDX: 'jdx',\n  JDF: 'jdf',\n  ZIP: 'zip',\n  NMREDATA: 'nmredata',\n};\nexport const FILES_SIGNATURES = {\n  ZIP: '504b0304',\n};\n\nfunction getFileSignature(fileArrayBuffer) {\n  return new Uint8Array(fileArrayBuffer)\n    .slice(0, 4)\n    .reduce((acc, byte) => (acc += byte.toString(16).padStart(2, '0')), '');\n}\n\nasync function loadFile(file, options = { asBuffer: false }) {\n  const response = await fetch(file);\n  checkStatus(response);\n  const data = options.asBuffer ? response.arrayBuffer() : response.text();\n  return data;\n}\n\nfunction checkStatus(response) {\n  if (!response.ok) {\n    throw new Error(`HTTP ${response.status} - ${response.statusText}`);\n  }\n  return response;\n}\n\nfunction getFileExtension(name) {\n  return name.replace(/^.*\\./, '').toLowerCase();\n}\n\nfunction getFileName(name) {\n  return name.substr(0, name.lastIndexOf('.'));\n}\n\nfunction extractFileMetaFromPath(path) {\n  const meta = path.replace(/^.*[\\\\/]/, '').split('.');\n\n  return { name: meta[0].toLowerCase(), extension: meta[1].toLowerCase() };\n}\n/**\n *\n * @param {Array<File>} acceptedFiles\n * @param {object} options\n * @param {boolean} options.asBuffer\n * @returns\n */\nfunction loadFiles<T = unknown>(\n  acceptedFiles,\n  options: { asBuffer?: boolean } = {},\n) {\n  return Promise.all(\n    ([] as Array<T>).map.call(acceptedFiles, (file: any) => {\n      return new Promise((resolve, reject) => {\n        const reader = new FileReader();\n        reader.onabort = (e) => reject(e);\n        reader.onerror = (e) => reject(e);\n        reader.onload = () => {\n          if (reader.result) {\n            const binary = reader.result;\n            const name = getFileName(file.name);\n            const extension = getFileExtension(file.name);\n            resolve({ binary, name, extension });\n          }\n        };\n        if (options.asBuffer) {\n          reader.readAsArrayBuffer(file);\n        } else {\n          reader.readAsBinaryString(file);\n        }\n      });\n    }),\n  ) as Promise<Array<T>>;\n}\n\nasync function loadFilesFromZip(files, options: { asBuffer?: boolean } = {}) {\n  const result: Array<{ binary: any; name: string; extension: string }> = [];\n  for (const file of files) {\n    try {\n      const binary = await file.async(options.asBuffer ? 'uint8array' : 'text');\n      const name = getFileName(file.name);\n      const extension = getFileExtension(file.name);\n      result.push({ binary, name, extension });\n    } catch (e) {\n      // eslint-disable-next-line no-console\n      console.error(e);\n    }\n  }\n  return result;\n}\n\nexport {\n  loadFiles,\n  loadFilesFromZip,\n  loadFile,\n  getFileExtension,\n  getFileName,\n  extractFileMetaFromPath,\n  getFileSignature,\n};\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport Zip from 'jszip';\nimport { useCallback } from 'react';\nimport { useDropzone } from 'react-dropzone';\nimport { FaUpload } from 'react-icons/fa';\n\nimport { File } from '../../data/types/common/File';\nimport { useChartData } from '../context/ChartContext';\nimport { useDispatch } from '../context/DispatchContext';\nimport { LoaderProvider } from '../context/LoaderContext';\nimport { useAlert } from '../elements/popup/Alert';\nimport {\n  LOAD_MOL_FILE,\n  LOAD_JSON_FILE,\n  LOAD_JCAMP_FILE,\n  SET_LOADING_FLAG,\n  LOAD_ZIP_FILE,\n  LOAD_JDF_FILE,\n  LOAD_NMREDATA_FILE,\n} from '../reducer/types/Types';\nimport {\n  FILES_TYPES,\n  FILES_SIGNATURES,\n  getFileExtension,\n  getFileSignature,\n  loadFiles,\n  loadFilesFromZip,\n} from '../utility/FileUtility';\n\nconst style = css`\n  height: 100%;\n  background-color: #b5b5b599;\n  position: absolute;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  flex-flow: column;\n  z-index: 99999;\n\n  p {\n    color: white;\n    background-color: rgb(104, 104, 104);\n    padding: 1.5%;\n    border-radius: 30px;\n    margin: 0px;\n  }\n\n  svg {\n    stroke-width: 0;\n    font-size: 3rem !important;\n    fill: white;\n  }\n`;\n\nconst containerStyle = css`\n  border: 0.55px #e6e6e6 solid;\n  display: flex;\n  flex: 1;\n  flex-direction: 'column';\n  height: 100%;\n`;\n\nfunction DropZone(props) {\n  const { width, height } = useChartData();\n  const dispatch = useDispatch();\n  const alert = useAlert();\n\n  const loadSubFilesFromZip = useCallback(\n    async (extractedfiles, uniqueFileExtensions) => {\n      for (let extension of uniqueFileExtensions) {\n        const selectedFilesByExtensions = extractedfiles.filter(\n          (file) => getFileExtension(file.name) === extension,\n        );\n\n        switch (extension) {\n          case FILES_TYPES.MOL: {\n            const files = await loadFilesFromZip(selectedFilesByExtensions);\n            dispatch({ type: LOAD_MOL_FILE, files });\n            break;\n          }\n          case FILES_TYPES.NMRIUM:\n          case FILES_TYPES.JSON: {\n            const files = await loadFilesFromZip(selectedFilesByExtensions, {\n              asBuffer: true,\n            });\n            if (selectedFilesByExtensions.length === 1) {\n              const decoder = new TextDecoder('utf8');\n              files[0].binary = decoder.decode(files[0].binary);\n\n              dispatch({ type: LOAD_JSON_FILE, files });\n            } else {\n              throw new Error('You can add only one json file');\n            }\n\n            break;\n          }\n          case FILES_TYPES.JDX:\n          case FILES_TYPES.DX: {\n            const files = await loadFilesFromZip(selectedFilesByExtensions, {\n              asBuffer: true,\n            });\n            dispatch({ type: LOAD_JCAMP_FILE, files });\n\n            break;\n          }\n          case FILES_TYPES.JDF: {\n            const files = await loadFilesFromZip(selectedFilesByExtensions, {\n              asBuffer: true,\n            });\n            dispatch({ type: LOAD_JDF_FILE, files });\n            break;\n          }\n          default:\n            break;\n        }\n      }\n    },\n    [dispatch],\n  );\n\n  const loadFilesHandler = useCallback(\n    async (files) => {\n      const uniqueFileExtensions = [\n        ...new Set(files.map((file) => getFileExtension(file.name))),\n      ];\n\n      for (let extension of uniqueFileExtensions) {\n        const selectedFilesByExtensions = files.filter(\n          (file) => getFileExtension(file.name) === extension,\n        );\n        try {\n          switch (extension) {\n            case FILES_TYPES.MOL: {\n              const files = await loadFiles(selectedFilesByExtensions);\n              dispatch({ type: LOAD_MOL_FILE, files });\n\n              break;\n            }\n            case FILES_TYPES.NMRIUM:\n            case FILES_TYPES.JSON:\n              if (selectedFilesByExtensions.length === 1) {\n                const files = await loadFiles<{ binary: any }>(\n                  selectedFilesByExtensions,\n                  {\n                    asBuffer: true,\n                  },\n                );\n                // InputFileFormat\n                const fileSignature = getFileSignature(files[0].binary);\n                if (fileSignature === FILES_SIGNATURES.ZIP) {\n                  const unzipResult = await Zip.loadAsync(files[0].binary);\n                  await loadSubFilesFromZip(Object.values(unzipResult.files), [\n                    FILES_TYPES.NMRIUM,\n                  ]);\n                } else {\n                  const decoder = new TextDecoder('utf8');\n                  files[0].binary = decoder.decode(files[0].binary);\n                  dispatch({ type: LOAD_JSON_FILE, files });\n                }\n              } else {\n                throw new Error('You can add only one json file');\n              }\n\n              break;\n            case FILES_TYPES.JDX:\n            case FILES_TYPES.DX: {\n              const files = await loadFiles(selectedFilesByExtensions, {\n                asBuffer: true,\n              });\n              dispatch({ type: LOAD_JCAMP_FILE, files });\n\n              break;\n            }\n            case FILES_TYPES.JDF: {\n              const files = await loadFiles(selectedFilesByExtensions, {\n                asBuffer: true,\n              });\n              dispatch({ type: LOAD_JDF_FILE, files });\n\n              break;\n            }\n            case FILES_TYPES.ZIP: {\n              const files: File[] = await loadFiles(selectedFilesByExtensions, {\n                asBuffer: true,\n              });\n              for (const zipFile of files) {\n                const unzipResult = await Zip.loadAsync(zipFile.binary);\n\n                const uniqueFileExtensions = [\n                  ...new Set(\n                    Object.values(unzipResult.files).map((file) =>\n                      getFileExtension(file.name),\n                    ),\n                  ),\n                ];\n                const isNotZip = uniqueFileExtensions.some(\n                  (ex) =>\n                    FILES_TYPES[ex.toUpperCase()] && ex !== FILES_TYPES.ZIP,\n                );\n                if (isNotZip) {\n                  const hasBruker = Object.keys(unzipResult.files).some(\n                    (path) => {\n                      return ['2rr', 'fid', '1r'].some((brukerFile) =>\n                        path.endsWith(brukerFile),\n                      );\n                    },\n                  );\n                  if (hasBruker) dispatch({ type: LOAD_ZIP_FILE, files });\n                  await loadSubFilesFromZip(\n                    Object.values(unzipResult.files),\n                    uniqueFileExtensions,\n                  );\n                } else {\n                  dispatch({ type: LOAD_ZIP_FILE, files });\n                }\n              }\n\n              break;\n            }\n            case FILES_TYPES.NMREDATA:\n              void loadFiles(selectedFilesByExtensions, {\n                asBuffer: true,\n              }).then(async (files) => {\n                for (const zipFile of files) {\n                  dispatch({\n                    type: LOAD_NMREDATA_FILE,\n                    file: zipFile,\n                  });\n                }\n              });\n              break;\n            default:\n              throw new Error(\n                'The file extension must be zip, dx, jdx, json, mol, nmredata or nmrium.',\n              );\n          }\n        } catch (e: any) {\n          dispatch({ type: SET_LOADING_FLAG, isLoading: false });\n          alert.error(e.message);\n        }\n      }\n    },\n    [alert, dispatch, loadSubFilesFromZip],\n  );\n\n  const onDrop = useCallback(\n    (droppedFiles) => {\n      dispatch({ type: SET_LOADING_FLAG, isLoading: true });\n      void loadFilesHandler(droppedFiles);\n    },\n    [dispatch, loadFilesHandler],\n  );\n\n  const {\n    getRootProps,\n    getInputProps,\n    isDragActive,\n    open: openImportDialog,\n  } = useDropzone({\n    onDrop,\n    noClick: true,\n    noKeyboard: true,\n  });\n\n  const open = useCallback(() => {\n    openImportDialog();\n  }, [openImportDialog]);\n\n  return (\n    <LoaderProvider value={open}>\n      <div {...getRootProps()} role=\"none\" css={containerStyle}>\n        <input data-test-id=\"dropzone-input\" {...getInputProps()} />\n        {isDragActive && (\n          <div\n            css={style}\n            style={{\n              width: `${width}px`,\n              height: `${height}px`,\n              marginTop: '30px',\n              marginLeft: '30px',\n            }}\n          >\n            <FaUpload />\n            <p>Drop your files here</p>\n          </div>\n        )}\n        {props.children}\n      </div>\n    </LoaderProvider>\n  );\n}\n\nexport default DropZone;\n","import * as types from './types/Types';\n\nconst ignoreActions = [\n  types.APPLY_KEY_PREFERENCES,\n  types.BRUSH_END,\n  types.RESET_DOMAIN,\n  types.RESET_SELECTED_TOOL,\n  types.SET_KEY_PREFERENCES,\n  types.SET_LOADING_FLAG,\n  types.SET_ORIGINAL_DOMAIN,\n  types.SET_SELECTED_FILTER,\n  types.SET_SELECTED_OPTIONS_PANEL,\n  types.SET_SELECTED_TOOL,\n  types.SET_SPECTRUMS_VERTICAL_ALIGN,\n  types.SET_VERTICAL_INDICATOR_X_POSITION,\n  types.SET_WIDTH,\n  types.SET_DIMENSIONS,\n  types.SET_X_DOMAIN,\n  types.SET_Y_DOMAIN,\n  types.SET_ZOOM,\n  types.TOGGLE_REAL_IMAGINARY_VISIBILITY,\n  types.CALCULATE_MANUAL_PHASE_CORRECTION_FILTER,\n  types.CHANGE_SPECTRUM_DISPLAY_VIEW_MODE,\n  types.FULL_ZOOM_OUT,\n  types.SAVE_AS_SVG,\n  types.SAVE_DATA_AS_JSON,\n  types.SET_ACTIVE_TAB,\n  types.CHANGE_VISIBILITY,\n  types.CHANGE_PEAKS_MARKERS_VISIBILITY,\n  types.CHANGE_ACTIVE_SPECTRUM,\n  types.CHANGE_SPECTRUM_COLOR,\n  types.SET_MOUSE_OVER_DISPLAYER,\n];\n\nfunction checkActionType(type: string): boolean {\n  if (!ignoreActions.includes(type)) return true;\n  return false;\n}\n\nexport default checkActionType;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { Toolbar } from 'analysis-ui-components';\nimport {\n  ReactNode,\n  useState,\n  useCallback,\n  useRef,\n  useLayoutEffect,\n} from 'react';\n\nconst menuStyles = css`\n  .menu {\n    box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.5);\n    padding: 0px;\n    margin: 0px;\n    border-radius: 5px;\n    display: flex;\n    flex-direction: column;\n    position: absolute;\n    z-index: 99999;\n    padding: 2px;\n    background-color: white;\n\n    button:hover {\n      background-color: #fafafa;\n    }\n  }\n\n  .menu-cover {\n    position: fixed;\n    width: 100%;\n    height: 100%;\n    top: 0;\n    left: 0;\n    z-index: 1;\n  }\n\n  .menu-item {\n    background-color: transparent;\n    border: none;\n    border-bottom: 0.55px solid whitesmoke;\n    height: 35px;\n    outline: outline;\n    display: table-cell;\n    vertical-align: middle;\n    text-align: left;\n    padding: 0 10px;\n\n    svg {\n      display: inline-block;\n    }\n\n    :focus {\n      outline: none !important;\n    }\n    span {\n      font-size: 10px;\n      padding: 0px 10px;\n    }\n  }\n`;\n\ninterface MenuItemProps {\n  icon: ReactNode;\n  label: string;\n  onClick: () => void;\n}\n\nfunction MenuItem({ icon, label, onClick }: MenuItemProps) {\n  return (\n    <button type=\"button\" className=\"menu-item\" onClick={onClick}>\n      {icon}\n      <span>{label}</span>\n    </button>\n  );\n}\n\ninterface MenuListProps {\n  items: Array<MenuItemProps & { id: string }>;\n  onClick: (element: MenuItemProps & { id: string }) => void;\n  boxBounding: any;\n}\n\nfunction MenuList({ items, boxBounding, onClick }: MenuListProps) {\n  const listRef = useRef<any>();\n  const [translate, setTranslate] = useState({\n    x: boxBounding.width,\n    y: boxBounding.height,\n  });\n\n  useLayoutEffect(() => {\n    const boxSize = listRef.current.getBoundingClientRect();\n    setTranslate((oldTransform) => {\n      let y = boxBounding.height;\n      if (boxSize.bottom > window.innerHeight) {\n        y = boxBounding.height * 2 + (boxSize.bottom - window.innerHeight);\n      }\n      return {\n        ...oldTransform,\n        y,\n      };\n    });\n  }, [boxBounding.height]);\n\n  return (\n    <div\n      ref={listRef}\n      className=\"menu\"\n      style={{\n        transform: `translate(${translate.x}px, -${translate.y}px) `,\n      }}\n    >\n      {items?.map((item) => {\n        return (\n          <MenuItem key={item.id} {...item} onClick={() => onClick(item)} />\n        );\n      })}\n    </div>\n  );\n}\n\ninterface MenuButtonProps {\n  component: any;\n  toolTip: string;\n  items: Array<any>;\n  onClick: (element: any) => void;\n}\n\nexport default function ToolbarMenu({\n  component,\n  toolTip = '',\n  items = [],\n  onClick = () => null,\n}: MenuButtonProps) {\n  const menuButtonRef = useRef<HTMLDivElement>(null);\n  const [isShown, showMenu] = useState(false);\n\n  const closeMenuButton = useCallback(() => {\n    showMenu(false);\n  }, []);\n\n  const handleClick = useCallback(() => {\n    showMenu((flag) => !flag);\n  }, []);\n\n  const clickHandler = useCallback(\n    (e) => {\n      showMenu(false);\n      onClick(e);\n    },\n    [onClick],\n  );\n\n  const boxBounding = useCallback(() => {\n    return menuButtonRef.current?.getBoundingClientRect();\n  }, []);\n\n  return (\n    <div style={{ height: 'auto' }} css={menuStyles}>\n      <div ref={menuButtonRef}>\n        <Toolbar.Item\n          id={`menu-${toolTip}`}\n          title={toolTip}\n          active={isShown}\n          onClick={handleClick}\n        >\n          {component}\n        </Toolbar.Item>\n      </div>\n      {isShown && (\n        <MenuList\n          items={items}\n          boxBounding={boxBounding()}\n          onClick={clickHandler}\n        />\n      )}\n\n      {isShown && <div className=\"menu-cover\" onClick={closeMenuButton} />}\n    </div>\n  );\n}\n","import { useMemo } from 'react';\n\nimport { Info1D as Datum1DInfo, Data1D } from '../../data/types/data1d';\nimport { Info2D as Datum2DInfo, Data2D } from '../../data/types/data2d';\nimport { useChartData } from '../context/ChartContext';\nimport nucleusToString from '../utility/nucleusToString';\n\ninterface SpectrumWithStatisticsProps {\n  info: Datum1DInfo | Datum2DInfo;\n  datum: Data1D | Data2D;\n  ftCounter: number;\n  fidCounter: number;\n}\n\nconst emptyData = { info: {}, datum: {}, ftCounter: 0, fidCounter: 0 };\n\nexport default function useDatumWithSpectraStatistics(): SpectrumWithStatisticsProps {\n  const { data, activeSpectrum, activeTab } = useChartData();\n\n  return useMemo(() => {\n    if (data) {\n      let info: any = {};\n      let datum: any = {};\n      let ftCounter = 0;\n      let fidCounter = 0;\n\n      for (const dataInfo of data) {\n        const { isFid, isFt, nucleus } = dataInfo.info;\n\n        if (activeTab === nucleusToString(nucleus)) {\n          if (isFid) {\n            fidCounter++;\n          }\n          if (isFt) {\n            ftCounter++;\n          }\n          if (activeSpectrum && dataInfo.id === activeSpectrum.id) {\n            info = dataInfo.info;\n            datum = dataInfo.data;\n          }\n        }\n      }\n\n      return {\n        info,\n        datum,\n        ftCounter,\n        fidCounter,\n      };\n    }\n    return emptyData;\n  }, [activeSpectrum, data, activeTab]);\n}\n","import { useFormikContext } from 'formik';\nimport lodashGet from 'lodash/get';\nimport { useCallback, useEffect, useMemo, CSSProperties } from 'react';\n\ninterface FormikTextareaProps\n  extends Omit<React.TextareaHTMLAttributes<HTMLTextAreaElement>, 'style'> {\n  name: string;\n  style?: CSSProperties;\n  value?: string;\n  className?: string;\n}\n\nfunction FormikTextarea(props: FormikTextareaProps) {\n  const {\n    name,\n    style = {},\n    onChange = () => null,\n    className = '',\n    value,\n    placeholder = '',\n    ...resProps\n  } = props;\n\n  const { values, handleChange, setFieldValue, errors } = useFormikContext();\n\n  const changeHandler = useCallback(\n    (e) => {\n      onChange(e);\n      handleChange(e);\n    },\n    [handleChange, onChange],\n  );\n\n  useEffect(() => {\n    if (value) {\n      setFieldValue(name, value);\n    }\n  }, [name, setFieldValue, value]);\n\n  const isInvalid = useMemo(() => {\n    return lodashGet(errors, name);\n  }, [errors, name]);\n\n  return (\n    <textarea\n      {...{ name, className, placeholder }}\n      value={value ? value : lodashGet(values, name)}\n      onChange={changeHandler}\n      style={{\n        ...style,\n        ...(isInvalid && {\n          borderColor: 'red',\n          borderWidth: '1px',\n          outline: 'none',\n        }),\n      }}\n      {...resProps}\n    />\n  );\n}\n\nexport default FormikTextarea;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback, useRef } from 'react';\nimport * as yup from 'yup';\n\nimport { useDispatch } from '../context/DispatchContext';\nimport Button from '../elements/Button';\nimport CloseButton from '../elements/CloseButton';\nimport FormikForm from '../elements/formik/FormikForm';\nimport FormikTextarea from '../elements/formik/FormikTextarea';\nimport { useAlert } from '../elements/popup/Alert';\nimport { GENERATE_SPECTRUM_FROM_PUBLICATION_STRING } from '../reducer/types/Types';\n\nimport { ModalStyles } from './ModalStyle';\n\nconst styles = css`\n  width: 600px;\n  height: 300px;\n\n  .inner-content {\n    flex: 1;\n    border: none;\n    overflow: hidden;\n    padding: 0px;\n  }\n\n  .text-area {\n    width: 100%;\n    height: 100%;\n    outline: none;\n    resize: none;\n    padding: 0 0 0 15px;\n  }\n`;\n\nconst validationSchema = yup.object({\n  publicationText: yup.string().required(),\n});\n\ninterface ImportPublicationStringModalProps {\n  onClose: () => void;\n}\n\nfunction ImportPublicationStringModal({\n  onClose,\n}: ImportPublicationStringModalProps) {\n  const formRef = useRef<any>();\n  const dispatch = useDispatch();\n  const alert = useAlert();\n  const publicationStringHandler = useCallback(\n    (values) => {\n      void (async () => {\n        const hideLoading = await alert.showLoading(\n          'Generate spectrum from publication string in progress',\n        );\n        setTimeout(() => {\n          dispatch({\n            type: GENERATE_SPECTRUM_FROM_PUBLICATION_STRING,\n            payload: values,\n          });\n          hideLoading();\n        });\n        onClose();\n      })();\n    },\n    [alert, dispatch, onClose],\n  );\n\n  return (\n    <div css={[ModalStyles, styles]}>\n      <div className=\"header handle\">\n        <span>Import from publication string</span>\n        <CloseButton onClick={onClose} className=\"close-bt\" />\n      </div>\n      <div className=\"inner-content\">\n        <FormikForm\n          ref={formRef}\n          initialValues={{\n            publicationText:\n              '1H NMR (CDCl3, 400MHz) δ 10.58 (b, 1H), 7.40 (d, 1H, J = 8.0 Hz), 6.19 (d, 1H, J = 7.6 Hz), 4.88 (s, 1H), 2.17 (s, 3H), 1.02 (s, 9H), 1.01 (s, 9H), 0.89 (s, 9H)',\n          }}\n          validationSchema={validationSchema}\n          onSubmit={publicationStringHandler}\n        >\n          <FormikTextarea\n            name=\"publicationText\"\n            className=\"text-area\"\n            placeholder=\"Enter publication string\"\n          />\n        </FormikForm>\n      </div>\n      <div className=\"footer-container\">\n        <Button.Done onClick={() => formRef.current.submitForm()}>\n          Import\n        </Button.Done>\n      </div>\n    </div>\n  );\n}\n\nexport default ImportPublicationStringModal;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useRef, useCallback } from 'react';\n\nimport Button from '../elements/Button';\nimport CloseButton from '../elements/CloseButton';\nimport { loadFile, extractFileMetaFromPath } from '../utility/FileUtility';\n\nconst styles = css`\n  display: flex;\n  flex-direction: column;\n  width: 450px;\n  padding: 5px;\n  button:focus {\n    outline: none;\n  }\n  .header {\n    height: 24px;\n    border-bottom: 1px solid #f0f0f0;\n    display: flex;\n    span {\n      color: #464646;\n      font-size: 15px;\n      flex: 1;\n    }\n\n    button {\n      background-color: transparent;\n      border: none;\n      svg {\n        height: 16px;\n      }\n    }\n  }\n  .container {\n    display: flex;\n    margin: 30px 5px;\n    align-items: center;\n    height: 36px;\n\n    input {\n      padding: 5px;\n      border: 1px solid gray;\n      border-radius: 5px;\n      margin: 2px;\n    }\n    input {\n      flex: 10;\n    }\n    button {\n      flex: 2;\n      height: 100%;\n    }\n  }\n`;\nconst allowedExtensions = ['dx', 'jdx'];\n\ninterface LoadJCAMPModalProps {\n  onLoadClick: (element: any) => void;\n  startLoading: () => void;\n  onClose: (element?: string) => void;\n}\n\nexport default function LoadJCAMPModal({\n  onLoadClick,\n  onClose,\n  startLoading,\n}: LoadJCAMPModalProps) {\n  const pathReft = useRef<any>();\n\n  const loadJCAMPHandler = useCallback(() => {\n    const path = pathReft.current.value;\n    const { name, extension } = extractFileMetaFromPath(path);\n    if (allowedExtensions.includes(extension)) {\n      startLoading?.();\n      void loadFile(path, { asBuffer: true }).then((data) => {\n        const file = {\n          binary: data,\n          name,\n          extension,\n          jcampURL: path,\n        };\n        onLoadClick(file);\n      });\n    } else {\n      onLoadClick(null);\n    }\n  }, [onLoadClick, startLoading]);\n  return (\n    <div css={styles}>\n      <div className=\"header handle\">\n        <span>Load JCAMP Dialog</span>\n\n        <CloseButton onClick={onClose} />\n      </div>\n      <div className=\"container\">\n        <input\n          ref={pathReft}\n          type=\"text\"\n          placeholder=\"Enter URL to JCAMP-DX file\"\n        />\n        <Button.Done onClick={loadJCAMPHandler}>Load</Button.Done>\n      </div>\n    </div>\n  );\n}\n","import { Toolbar } from 'analysis-ui-components';\nimport {\n  SvgNmrRealImag,\n  SvgNmrOverlay3,\n  SvgNmrOverlay3Aligned,\n  SvgNmrAlignBottom,\n  SvgNmrAlignCenter,\n} from 'cheminfo-font';\nimport { Fragment, useCallback, memo, useMemo } from 'react';\nimport {\n  FaDownload,\n  FaFileDownload,\n  FaFileImage,\n  FaCopy,\n  FaFileExport,\n  FaFile,\n  FaFileImport,\n} from 'react-icons/fa';\n\nimport { Info1D } from '../../data/types/data1d';\nimport { Info2D } from '../../data/types/data2d';\nimport { useChartData } from '../context/ChartContext';\nimport { useDispatch } from '../context/DispatchContext';\nimport { useLoader } from '../context/LoaderContext';\nimport ToolbarMenu from '../elements/ToolbarMenu';\nimport { useAlert } from '../elements/popup/Alert';\nimport { useModal } from '../elements/popup/Modal';\nimport useCheckExperimentalFeature from '../hooks/useCheckExperimentalFeature';\nimport { useCheckToolsVisibility } from '../hooks/useCheckToolsVisibility';\nimport useDatumWithSpectraStatistics from '../hooks/useDatumWithSpectraStatistics';\nimport useExport from '../hooks/useExport';\nimport useToolsFunctions from '../hooks/useToolsFunctions';\nimport ImportPublicationStringModal from '../modal/ImportPublicationStringModal';\nimport LoadJCAMPModal from '../modal/LoadJCAMPModal';\nimport { ActiveSpectrum, VerticalAlignment } from '../reducer/Reducer';\nimport { DISPLAYER_MODE } from '../reducer/core/Constants';\nimport { LOAD_JCAMP_FILE, SET_LOADING_FLAG } from '../reducer/types/Types';\n\nconst IMPORT_MENU = [\n  {\n    id: 'importFile',\n    icon: <FaFile />,\n    label: 'Import from file system (Press Ctrl + O)',\n  },\n  {\n    id: 'importJDX',\n    icon: <FaFile />,\n    label: 'Add JCAMP-DX from URL',\n  },\n  {\n    id: 'importPublicationString',\n    icon: <FaFile />,\n    label: 'Import from publication string',\n  },\n];\n\nconst EXPORT_MENU = [\n  {\n    id: 'svg',\n    icon: <FaDownload />,\n    label: 'Export as SVG',\n  },\n  {\n    id: 'png',\n    icon: <FaFileImage />,\n    label: 'Export as PNG',\n  },\n  {\n    id: 'json',\n    icon: <FaFileDownload />,\n    label: 'Save data ( Press Ctrl + S )',\n  },\n  {\n    id: 'advance_save',\n    icon: <FaFileDownload />,\n    label: 'Save data as  ( Press Ctrl + Shift + S )',\n  },\n  {\n    id: 'nmre',\n    icon: <FaFileDownload />,\n    label: 'Save NMRE data',\n  },\n  {\n    id: 'copy',\n    icon: <FaCopy />,\n    label: 'Copy image to Clipboard ( Press Ctrl + C )',\n  },\n];\n\ninterface BasicToolBarInnerProps {\n  activeSpectrum: ActiveSpectrum | null;\n  fidCounter: number;\n  ftCounter: number;\n  displayerMode: DISPLAYER_MODE;\n  info: Info1D | Info2D;\n  verticalAlign: {\n    align: VerticalAlignment;\n  };\n}\n\nfunction BasicToolBarInner({\n  info,\n  verticalAlign,\n  displayerMode,\n  ftCounter,\n  fidCounter,\n  activeSpectrum,\n}: BasicToolBarInnerProps) {\n  const dispatch = useDispatch();\n  const alert = useAlert();\n  const modal = useModal();\n  const openLoader = useLoader();\n\n  const isExperimentalFeature = useCheckExperimentalFeature();\n  const isButtonVisible = useCheckToolsVisibility();\n\n  const importMenu = useMemo(() => {\n    return isExperimentalFeature\n      ? IMPORT_MENU\n      : IMPORT_MENU.filter((item) => item.id !== 'importPublicationString');\n  }, [isExperimentalFeature]);\n\n  const {\n    isRealSpectrumShown,\n    changeSpectrumViewHandler,\n    changeDisplayViewModeHandler,\n    alignSpectrumsVerticallyHandler,\n  } = useToolsFunctions();\n\n  const {\n    saveAsSVGHandler,\n    saveAsPNGHandler,\n    saveAsJSONHandler,\n    saveAsNMREHandler,\n    saveToClipboardHandler,\n    saveAsHandler,\n  } = useExport();\n\n  const LoadJacmpHandler = useCallback(\n    (file) => {\n      if (file) {\n        dispatch({ type: LOAD_JCAMP_FILE, files: [file] });\n        modal.close();\n      } else {\n        alert.error('you file must be one of those extensions [ .jdx, dx ] ');\n      }\n    },\n    [alert, dispatch, modal],\n  );\n\n  const startLoadingHandler = useCallback(() => {\n    modal.close();\n    dispatch({ type: SET_LOADING_FLAG, isLoading: true });\n  }, [dispatch, modal]);\n\n  const importJCAMPFile = useCallback(() => {\n    modal.show(\n      <LoadJCAMPModal\n        onLoadClick={LoadJacmpHandler}\n        onClose={() => modal.close()}\n        startLoading={startLoadingHandler}\n      />,\n      {},\n    );\n  }, [LoadJacmpHandler, modal, startLoadingHandler]);\n\n  const openImportPublicationStringModal = useCallback(() => {\n    modal.show(\n      <ImportPublicationStringModal onClose={() => modal.close()} />,\n      {},\n    );\n  }, [modal]);\n\n  const importHandler = useCallback(\n    ({ id }) => {\n      switch (id) {\n        case 'importFile':\n          openLoader();\n          break;\n        case 'importJDX':\n          importJCAMPFile();\n          break;\n        case 'importPublicationString':\n          openImportPublicationStringModal();\n          break;\n        default:\n          return;\n      }\n    },\n    [openLoader, importJCAMPFile, openImportPublicationStringModal],\n  );\n\n  const exportHandler = useCallback(\n    ({ id }) => {\n      switch (id) {\n        case 'svg':\n          void saveAsSVGHandler();\n          break;\n        case 'png':\n          void saveAsPNGHandler();\n          break;\n        case 'json':\n          void saveAsJSONHandler();\n          break;\n        case 'advance_save':\n          void saveAsHandler();\n          break;\n        case 'nmre':\n          void saveAsNMREHandler();\n          break;\n        case 'copy':\n          void saveToClipboardHandler();\n          break;\n\n        default:\n          break;\n      }\n    },\n    [\n      saveAsSVGHandler,\n      saveAsPNGHandler,\n      saveAsJSONHandler,\n      saveAsHandler,\n      saveAsNMREHandler,\n      saveToClipboardHandler,\n    ],\n  );\n\n  return (\n    <Fragment>\n      {isButtonVisible('import') && (\n        <ToolbarMenu\n          component={<FaFileImport />}\n          toolTip=\"Import\"\n          onClick={(element) => {\n            importHandler(element);\n            return null;\n          }}\n          items={importMenu}\n        />\n      )}\n      {isButtonVisible('exportAs') && (\n        <ToolbarMenu\n          component={<FaFileExport />}\n          toolTip=\"Export As\"\n          onClick={(element) => {\n            exportHandler(element);\n            return null;\n          }}\n          items={EXPORT_MENU}\n        />\n      )}\n\n      {displayerMode === DISPLAYER_MODE.DM_1D &&\n        isButtonVisible('spectraStackAlignments') &&\n        ftCounter > 1 &&\n        (info?.isFt || !activeSpectrum) && (\n          <Toolbar.Item\n            id=\"spectra-alignment\"\n            className=\"cheminfo\"\n            title=\"Spectra alignment ( Press s )\"\n            onClick={changeDisplayViewModeHandler}\n          >\n            {verticalAlign.align === 'stack' ? (\n              <SvgNmrOverlay3Aligned />\n            ) : (\n              <SvgNmrOverlay3 />\n            )}\n          </Toolbar.Item>\n        )}\n      {displayerMode === DISPLAYER_MODE.DM_1D &&\n        isButtonVisible('realImaginary') &&\n        info.isComplex && (\n          <Toolbar.Item\n            id=\"display\"\n            title={isRealSpectrumShown ? 'Display Real ' : 'Display Imaginary'}\n            onClick={changeSpectrumViewHandler}\n            className=\"cheminfo\"\n          >\n            <SvgNmrRealImag />\n          </Toolbar.Item>\n        )}\n      {displayerMode === DISPLAYER_MODE.DM_1D &&\n        isButtonVisible('spectraCenterAlignments') &&\n        (ftCounter > 0 || fidCounter > 0) && (\n          <Toolbar.Item\n            id=\"baseline-position\"\n            title={\n              verticalAlign.align === 'bottom'\n                ? 'Baseline  Center ( Press c )'\n                : 'Baseline  Bottom ( Press c )'\n            }\n            onClick={alignSpectrumsVerticallyHandler}\n            className=\"cheminfo\"\n          >\n            <div style={{ fontSize: 24 }}>\n              {verticalAlign.align === 'bottom' ? (\n                <SvgNmrAlignCenter />\n              ) : (\n                <SvgNmrAlignBottom />\n              )}\n            </div>\n          </Toolbar.Item>\n        )}\n    </Fragment>\n  );\n}\n\nconst MemoizedBasicToolBar = memo(BasicToolBarInner);\n\nexport default function BasicToolBar() {\n  const { activeSpectrum, verticalAlign, displayerMode, activeTab } =\n    useChartData();\n\n  const { info, fidCounter, ftCounter } = useDatumWithSpectraStatistics();\n  return (\n    <MemoizedBasicToolBar\n      {...{\n        info,\n        fidCounter,\n        ftCounter,\n        activeSpectrum,\n        verticalAlign,\n        displayerMode,\n        activeTab,\n      }}\n    />\n  );\n}\n","import { Toolbar } from 'analysis-ui-components';\nimport {\n  useCallback,\n  useState,\n  useEffect,\n  ReactElement,\n  JSXElementConstructor,\n} from 'react';\n\ninterface ToggleButtonProps {\n  isActive?: boolean;\n  value?: any;\n  onChange?: (value: any) => null;\n  children: ReactElement<any, string | JSXElementConstructor<any>>;\n  isVisible?: boolean;\n}\n\nexport default function ToggleButton(\n  props: ToggleButtonProps & { title: string; id: string },\n) {\n  const {\n    children,\n    value = null,\n    isActive = false,\n    onChange = () => null,\n    isVisible = true,\n    id,\n    title,\n  } = props;\n\n  const [active, setActive] = useState(props.isActive);\n\n  const toggleButton = useCallback(() => {\n    const _isActive = !active;\n    setActive(_isActive);\n\n    if (_isActive) {\n      onChange(value);\n    } else {\n      onChange(null);\n    }\n  }, [active, onChange, value]);\n\n  useEffect(() => {\n    setActive(isActive);\n  }, [isActive]);\n\n  if (!isVisible) {\n    return null;\n  }\n\n  return (\n    <Toolbar.Item onClick={toggleButton} title={title} id={id} active={active}>\n      {children}\n    </Toolbar.Item>\n  );\n}\n","import {\n  useCallback,\n  useState,\n  useMemo,\n  useEffect,\n  Children,\n  cloneElement,\n  ReactNode,\n} from 'react';\n\nimport ToggleButton from './ToggleButton';\n\ninterface ToggleButtonGroupProps {\n  children: ReactNode;\n  value: string;\n  onChange?: (value: any) => void;\n}\n\nexport default function ToggleButtonGroup({\n  children,\n  value,\n  onChange = () => null,\n}: ToggleButtonGroupProps) {\n  const [toggleButtons, setToggleButtons] = useState<any>([]);\n  const handleOnChange = useCallback(\n    (val) => {\n      const _toggles: Array<any> = [...toggleButtons];\n      const toggles = _toggles.map((toggle) => {\n        return {\n          value: toggle.value,\n          isActive: toggle.value === val ? true : false,\n        };\n      });\n\n      setToggleButtons(toggles);\n      onChange(val);\n    },\n    [onChange, toggleButtons],\n  );\n\n  const mappedChildren = useMemo(() => {\n    let index = 0;\n    return Children.map(children, (child: any) => {\n      if (child) {\n        if (child.type === ToggleButton) {\n          const _child = cloneElement(child, {\n            onChange: handleOnChange,\n            isActive: toggleButtons[index]?.isActive,\n            index,\n          });\n          index++;\n          return _child;\n        } else {\n          return cloneElement(child);\n        }\n      }\n    });\n  }, [children, handleOnChange, toggleButtons]);\n\n  useEffect(() => {\n    const val = Children.map(children, (child: any) => {\n      if (child && child.type === ToggleButton) {\n        return {\n          value: child.props.value,\n          isActive: child.props.value === value ? true : false,\n        };\n      }\n    });\n    setToggleButtons(val);\n  }, [children, value]);\n\n  return <>{mappedChildren}</>;\n}\n","import { Toolbar } from 'analysis-ui-components';\nimport {\n  SvgNmrBaselineCorrection,\n  SvgNmrFourierTransform,\n  SvgNmrIntegrate,\n  SvgNmrMultipleAnalysis,\n  SvgNmrPeakPicking,\n  SvgNmrPhaseCorrection,\n  SvgNmrRangePicking,\n  SvgNmrZeroFilling,\n} from 'cheminfo-font';\nimport { useState, useEffect, useCallback, memo } from 'react';\nimport { FaSearchPlus, FaExpand, FaDiceFour } from 'react-icons/fa';\n\nimport * as Filters from '../../data/Filters';\nimport { Info1D, Data1D } from '../../data/types/data1d';\nimport { Info2D, Data2D } from '../../data/types/data2d';\nimport { useChartData } from '../context/ChartContext';\nimport { useDispatch } from '../context/DispatchContext';\nimport ToggleButton from '../elements/toggle/ToggleButton';\nimport ToggleButtonGroup from '../elements/toggle/ToggleButtonGroup';\nimport { useCheckToolsVisibility } from '../hooks/useCheckToolsVisibility';\nimport useDatumWithSpectraStatistics from '../hooks/useDatumWithSpectraStatistics';\nimport useToolsFunctions from '../hooks/useToolsFunctions';\nimport { ActiveSpectrum } from '../reducer/Reducer';\nimport { DISPLAYER_MODE } from '../reducer/core/Constants';\nimport { APPLY_FFT_FILTER, SET_SELECTED_FILTER } from '../reducer/types/Types';\n\nimport { options } from './ToolTypes';\n\ninterface FunctionToolBarInnerProps {\n  defaultValue: string;\n  activeSpectrum: ActiveSpectrum | null;\n  ftCounter: number;\n  displayerMode: DISPLAYER_MODE;\n  info: Info1D | Info2D;\n  datum: Data1D | Data2D;\n  mode: string;\n}\n\nfunction FunctionToolBarInner({\n  defaultValue,\n  activeSpectrum,\n  info,\n  datum,\n  displayerMode,\n  ftCounter,\n  mode,\n}: FunctionToolBarInnerProps) {\n  const [option, setOption] = useState<string>('');\n  const isButtonVisible = useCheckToolsVisibility();\n\n  const dispatch = useDispatch();\n\n  const { handleChangeOption, handleFullZoomOut } = useToolsFunctions();\n\n  const handleChange = useCallback(\n    (selectedOption) => {\n      setOption(selectedOption);\n      handleChangeOption(selectedOption);\n    },\n    [handleChangeOption],\n  );\n\n  useEffect(() => {\n    setOption(defaultValue);\n  }, [defaultValue]);\n\n  const handleOnFFTFilter = useCallback(() => {\n    dispatch({\n      type: APPLY_FFT_FILTER,\n      value: '',\n    });\n    dispatch({ type: SET_SELECTED_FILTER, selectedFilter: null });\n  }, [dispatch]);\n\n  return (\n    <>\n      <ToggleButtonGroup value={option} onChange={handleChange}>\n        {isButtonVisible('zoomTool') && (\n          <ToggleButton\n            key={options.zoom.id}\n            value={options.zoom.id}\n            id=\"zoomIn\"\n            title={`${options.zoom.label} ( Press z )`}\n          >\n            <div style={{ fontSize: 14 }}>\n              <FaSearchPlus />\n            </div>\n          </ToggleButton>\n        )}\n\n        {isButtonVisible('zoomOutTool') && (\n          <Toolbar.Item\n            id=\"zoom-out\"\n            onClick={handleFullZoomOut}\n            title=\"Horizontal zoom out ( Press f ), Horizontal and Vertical zoom out, double click ( Press ff )\"\n          >\n            <div style={{ fontSize: 14 }}>\n              <FaExpand />\n            </div>\n          </Toolbar.Item>\n        )}\n\n        {displayerMode === DISPLAYER_MODE.DM_1D && isButtonVisible('peakTool') && (\n          <ToggleButton\n            key={options.peakPicking.id}\n            value={options.peakPicking.id}\n            title={`${options.peakPicking.label} ( Press p )`}\n            isVisible={activeSpectrum && !info?.isFid ? true : false}\n            id=\"peakPicking\"\n          >\n            <SvgNmrPeakPicking />\n          </ToggleButton>\n        )}\n        {displayerMode === DISPLAYER_MODE.DM_1D &&\n          isButtonVisible('integralTool') && (\n            <ToggleButton\n              key={options.integral.id}\n              value={options.integral.id}\n              isVisible={activeSpectrum && !info?.isFid ? true : false}\n              id=\"integralPicking\"\n              title={`${options.integral.label} ( Press i )`}\n            >\n              <SvgNmrIntegrate />\n            </ToggleButton>\n          )}\n        {displayerMode === DISPLAYER_MODE.DM_2D &&\n          isButtonVisible('zonePickingTool') && (\n            <ToggleButton\n              key={options.zone2D.id}\n              value={options.zone2D.id}\n              id=\"zone2d\"\n              isVisible={activeSpectrum && !info?.isFid ? true : false}\n              title={`${options.zone2D.label} ( Press r )`}\n            >\n              <FaDiceFour />\n            </ToggleButton>\n          )}\n        {displayerMode === DISPLAYER_MODE.DM_2D &&\n          isButtonVisible('slicingTool') && (\n            <ToggleButton\n              key={options.slicingTool.id}\n              value={options.slicingTool.id}\n              isVisible={activeSpectrum && !info?.isFid ? true : false}\n              id=\"slic\"\n              title={`${options.slicingTool.label}`}\n            >\n              <p>Slic</p>\n            </ToggleButton>\n          )}\n        {displayerMode === DISPLAYER_MODE.DM_1D &&\n          isButtonVisible('autoRangesTool') && (\n            <ToggleButton\n              key={options.rangesPicking.id}\n              value={options.rangesPicking.id}\n              isVisible={activeSpectrum && !info?.isFid ? true : false}\n              title={`${options.rangesPicking.label} ( Press r )`}\n              id=\"ranges-pick\"\n            >\n              <SvgNmrRangePicking />\n            </ToggleButton>\n          )}\n        {displayerMode === DISPLAYER_MODE.DM_1D &&\n          isButtonVisible('multipleSpectraAnalysisTool') &&\n          ftCounter > 1 &&\n          mode === 'RTL' && (\n            <ToggleButton\n              key={options.multipleSpectraAnalysis.id}\n              value={options.multipleSpectraAnalysis.id}\n              id=\"multipleSpectraAnalysis\"\n              title={options.multipleSpectraAnalysis.label}\n            >\n              <SvgNmrMultipleAnalysis />\n            </ToggleButton>\n          )}\n        {displayerMode === DISPLAYER_MODE.DM_1D &&\n          isButtonVisible('zeroFillingTool') && (\n            <ToggleButton\n              key={options.zeroFilling.id}\n              value={options.zeroFilling.id}\n              isVisible={Filters.zeroFilling.isApplicable({ info })}\n              id=\"zeroFilling\"\n              title={options.zeroFilling.label}\n            >\n              <SvgNmrZeroFilling />\n            </ToggleButton>\n          )}\n        {displayerMode === DISPLAYER_MODE.DM_1D &&\n          isButtonVisible('phaseCorrectionTool') && (\n            <ToggleButton\n              key={options.phaseCorrection.id}\n              value={options.phaseCorrection.id}\n              id=\"phaseCorrection\"\n              title={`${options.phaseCorrection.label} ( Press a )`}\n              isVisible={\n                activeSpectrum &&\n                info &&\n                Filters.phaseCorrection.isApplicable({ info }) &&\n                (datum as Data1D).im\n                  ? true\n                  : false\n              }\n            >\n              <SvgNmrPhaseCorrection />\n            </ToggleButton>\n          )}\n\n        {displayerMode === DISPLAYER_MODE.DM_1D &&\n          isButtonVisible('baseLineCorrectionTool') && (\n            <ToggleButton\n              key={options.baseLineCorrection.id}\n              value={options.baseLineCorrection.id}\n              id=\"baseLineCorrection\"\n              title={`${options.baseLineCorrection.label} ( Press b )`}\n              isVisible={\n                activeSpectrum &&\n                info &&\n                Filters.baselineCorrection.isApplicable({ info })\n                  ? true\n                  : false\n              }\n            >\n              <SvgNmrBaselineCorrection />\n            </ToggleButton>\n          )}\n\n        {displayerMode === DISPLAYER_MODE.DM_1D &&\n          isButtonVisible('exclusionZonesTool') &&\n          !info?.isFid &&\n          ftCounter > 0 && (\n            <ToggleButton\n              key={options.exclusionZones.id}\n              value={options.exclusionZones.id}\n              title={`${options.exclusionZones.label} ( Press e )`}\n              id=\"exclusionZones\"\n            >\n              <div style={{ fontSize: 18 }}>\n                <SvgNmrMultipleAnalysis />\n              </div>\n            </ToggleButton>\n          )}\n      </ToggleButtonGroup>\n\n      {displayerMode === DISPLAYER_MODE.DM_1D &&\n        isButtonVisible('FFTTool') &&\n        info &&\n        Filters.fft.isApplicable({ info }) && (\n          <Toolbar.Item\n            id=\"fft-filter\"\n            className=\"cheminfo\"\n            title=\"FFT Filter\"\n            onClick={handleOnFFTFilter}\n          >\n            <SvgNmrFourierTransform />\n          </Toolbar.Item>\n        )}\n    </>\n  );\n}\n\nconst MemoizedFunctionToolBar = memo(FunctionToolBarInner);\n\nexport default function FunctionToolBar({\n  defaultValue = options.zoom.id,\n}: {\n  defaultValue?: string;\n}) {\n  const { activeSpectrum, displayerMode, activeTab, mode } = useChartData();\n\n  const data = useDatumWithSpectraStatistics();\n\n  return (\n    <MemoizedFunctionToolBar\n      {...{\n        ...data,\n        activeSpectrum,\n        displayerMode,\n        activeTab,\n        defaultValue,\n        mode,\n      }}\n    />\n  );\n}\n","import { Toolbar } from 'analysis-ui-components';\nimport { memo } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\n\nimport BasicToolBar from './BasicToolBar';\nimport FunctionToolBar from './FunctionToolBar';\n\ninterface ToolBarInnerProps {\n  selectedTool: string;\n}\n\nfunction ToolBarInner({ selectedTool }: ToolBarInnerProps) {\n  return (\n    <div style={{ fontSize: 18 }}>\n      <Toolbar orientation=\"vertical\">\n        <FunctionToolBar defaultValue={selectedTool} />\n        {/* <HistoryToolBar /> */}\n        <BasicToolBar />\n      </Toolbar>\n    </div>\n  );\n}\n\nconst MemoizedToolBar = memo(ToolBarInner);\n\nexport default function ToolBar() {\n  const {\n    toolOptions: { selectedTool },\n  } = useChartData();\n\n  return <MemoizedToolBar {...{ selectedTool }} />;\n}\n","/** @jsxImportSource @emotion/react */\n\nimport { css } from '@emotion/react';\nimport { RootLayout, SplitPane } from 'analysis-ui-components';\nimport { CorrelationData } from 'nmr-correlation';\nimport {\n  useEffect,\n  useCallback,\n  useReducer,\n  useMemo,\n  useRef,\n  memo,\n  Reducer,\n  ReactElement,\n  ReactNode,\n} from 'react';\nimport { ErrorBoundary } from 'react-error-boundary';\nimport { useToggle, useFullscreen } from 'react-use';\n\nimport { Datum1D } from '../data/types/data1d';\nimport { Datum2D } from '../data/types/data2d';\nimport checkModifierKeyActivated from '../data/utilities/checkModifierKeyActivated';\nimport { PanelPreferencesType } from '../types/PanelPreferencesType';\n\nimport Viewer1D from './1d/Viewer1D';\nimport Viewer2D from './2d/Viewer2D';\nimport ErrorOverlay from './ErrorOverlay';\nimport KeysListenerTracker from './EventsTrackers/KeysListenerTracker';\nimport { AssignmentProvider } from './assignment';\nimport { ChartDataProvider } from './context/ChartContext';\nimport { DispatchProvider } from './context/DispatchContext';\nimport { GlobalProvider } from './context/GlobalContext';\nimport { PreferencesProvider } from './context/PreferencesContext';\nimport { AlertProvider } from './elements/popup/Alert';\nimport { ModalProvider } from './elements/popup/Modal';\nimport Header from './header/Header';\nimport { HighlightProvider } from './highlight';\nimport DropZone from './loader/DropZone';\nimport { defaultGetSpinner, SpinnerProvider } from './loader/SpinnerContext';\nimport Panels from './panels/Panels';\nimport checkActionType from './reducer/IgnoreActions';\nimport {\n  spectrumReducer,\n  initialState,\n  dispatchMiddleware,\n  initState,\n  State,\n} from './reducer/Reducer';\nimport { DISPLAYER_MODE } from './reducer/core/Constants';\nimport preferencesReducer, {\n  preferencesInitialState,\n  PreferencesState,\n  initPreferencesState,\n} from './reducer/preferencesReducer';\nimport {\n  INITIATE,\n  SET_LOADING_FLAG,\n  SET_MOUSE_OVER_DISPLAYER,\n} from './reducer/types/Types';\nimport ToolBar from './toolbar/ToolBar';\n\nconst viewerContainerStyle = css`\n  border: 0.55px #e6e6e6 solid;\n  display: flex;\n  flex: 1;\n  flex-direction: 'column';\n  height: 100%;\n  margin-left: -1px;\n`;\n\nconst containerStyles = css`\n  background-color: white;\n  width: 100%;\n  display: block;\n  height: 100%;\n  font-size: 14px;\n\n  div:focus {\n    outline: none !important;\n  }\n\n  button {\n    cursor: pointer;\n    &:disabled {\n      cursor: default;\n    }\n  }\n\n  button:active,\n  button:hover,\n  button:focus,\n  [type='button']:focus,\n  button {\n    outline: none !important;\n  }\n  * {\n    -webkit-user-drag: none;\n    -moz-user-drag: none;\n    -o-user-drag: none;\n    user-drag: none;\n    -moz-user-select: none;\n    -webkit-user-select: none;\n    -ms-user-select: none;\n    user-select: none;\n  }\n\n  .SplitPane {\n    height: 100%;\n  }\n`;\n\nexport type NMRiumWorkspace =\n  | 'exercise'\n  | 'process1D'\n  | 'default'\n  | 'prediction';\n\nexport interface NMRiumProps {\n  data?: NMRiumData;\n  onDataChange?: (data: State) => void;\n  workspace?: NMRiumWorkspace;\n  preferences?: NMRiumPreferences;\n  emptyText?: ReactNode;\n  /**\n   * Returns a custom spinner that will be rendered while loading data.\n   */\n  getSpinner?: () => ReactElement;\n}\n\nexport type NMRiumPreferences = Partial<{\n  general: Partial<{\n    disableMultipletAnalysis: boolean;\n    hideSetSumFromMolecule: boolean;\n    hideGeneralSettings: boolean;\n    experimentalFeatures: PanelPreferencesType;\n  }>;\n  panels: Partial<{\n    spectraPanel: PanelPreferencesType;\n    informationPanel: PanelPreferencesType;\n    peaksPanel: PanelPreferencesType;\n    integralsPanel: PanelPreferencesType;\n    rangesPanel: PanelPreferencesType;\n    structuresPanel: PanelPreferencesType;\n    filtersPanel: PanelPreferencesType;\n    zonesPanel: PanelPreferencesType;\n    summaryPanel: PanelPreferencesType;\n    multipleSpectraAnalysisPanel: PanelPreferencesType;\n    databasePanel: PanelPreferencesType;\n    predictionPanel: PanelPreferencesType;\n  }>;\n  toolBarButtons: Partial<{\n    zoomTool: boolean;\n    zoomOutTool: boolean;\n    import: boolean;\n    exportAs: boolean;\n    spectraStackAlignments: boolean;\n    spectraCenterAlignments: boolean;\n    realImaginary: boolean;\n    peakTool: boolean;\n    integralTool: boolean;\n    zonePickingTool: boolean;\n    slicingTool: boolean;\n    autoRangesTool: boolean;\n    zeroFillingTool: boolean;\n    phaseCorrectionTool: boolean;\n    baseLineCorrectionTool: boolean;\n    FFTTool: boolean;\n    multipleSpectraAnalysisTool: boolean;\n    exclusionZonesTool: boolean;\n  }>;\n}>;\n\nexport type Molecules = Array<{ molfile: string }>;\nexport type Spectra = Array<Datum1D | Datum2D>;\n\ntype DeepPartial<T> = {\n  [P in keyof T]?: DeepPartial<T[P]>;\n};\n\nexport interface NMRiumData {\n  molecules?: Molecules;\n  spectra: DeepPartial<Spectra>;\n  correlations?: CorrelationData;\n}\n\nconst defaultPreferences = {};\nconst defaultData: NMRiumData = {\n  spectra: [],\n};\n\nfunction NMRium(props: NMRiumProps) {\n  return (\n    <RootLayout style={{ width: '100%' }}>\n      <ErrorBoundary FallbackComponent={ErrorOverlay}>\n        <InnerNMRium {...props} />\n      </ErrorBoundary>\n    </RootLayout>\n  );\n}\n\nfunction InnerNMRium({\n  data: dataProp = defaultData,\n  workspace,\n  preferences = defaultPreferences,\n  getSpinner = defaultGetSpinner,\n  onDataChange,\n  emptyText,\n}: NMRiumProps) {\n  const rootRef = useRef<HTMLDivElement>(null);\n  const elementsWrapperRef = useRef<HTMLDivElement>(null);\n  const [show, toggle] = useToggle(false);\n\n  const isFullscreen = useFullscreen(rootRef, show, {\n    onClose: () => {\n      toggle(false);\n    },\n  });\n\n  const [state, dispatch] = useReducer<Reducer<State, any>, State>(\n    spectrumReducer,\n    initialState,\n    initState,\n  );\n\n  const [preferencesState, dispatchPreferences] = useReducer<\n    Reducer<PreferencesState, any>,\n    PreferencesState\n  >(preferencesReducer, preferencesInitialState, initPreferencesState);\n\n  const { displayerMode, data: spectraData } = state;\n\n  useEffect(() => {\n    if (checkActionType(state.actionType)) {\n      onDataChange?.(state);\n    }\n  }, [onDataChange, state]);\n\n  const dispatchMiddleWare = useMemo(() => {\n    return dispatchMiddleware(dispatch);\n  }, []);\n\n  useEffect(() => {\n    rootRef.current?.focus();\n  }, [isFullscreen]);\n\n  useEffect(() => {\n    dispatchPreferences({\n      type: 'INIT_PREFERENCES',\n      payload: {\n        display: preferences,\n        workspace,\n        dispatch: dispatchPreferences,\n      },\n    });\n  }, [preferences, workspace]);\n\n  useEffect(() => {\n    dispatchMiddleWare({ type: SET_LOADING_FLAG, isLoading: true });\n    if (dataProp) {\n      dispatchMiddleWare({ type: INITIATE, payload: dataProp });\n    }\n  }, [dataProp, dispatchMiddleWare]);\n\n  const preventContextMenuHandler = useCallback((e) => {\n    if (!checkModifierKeyActivated(e)) {\n      e.preventDefault();\n    }\n  }, []);\n\n  const mainDivRef = useRef<HTMLDivElement>(null);\n  useEffect(() => {\n    const div = mainDivRef.current;\n    if (!div) {\n      return;\n    }\n    function mouseEnterHandler() {\n      dispatchMiddleWare({ type: SET_MOUSE_OVER_DISPLAYER, payload: true });\n    }\n    function mouseLeaveHandler() {\n      dispatchMiddleWare({ type: SET_MOUSE_OVER_DISPLAYER, payload: false });\n    }\n    div.addEventListener('mouseenter', mouseEnterHandler);\n    div.addEventListener('mouseleave', mouseLeaveHandler);\n    return () => {\n      div.removeEventListener('mouseenter', mouseEnterHandler);\n      div.removeEventListener('mouseleave', mouseLeaveHandler);\n    };\n  }, [dispatchMiddleWare]);\n\n  return (\n    <GlobalProvider\n      value={{\n        rootRef: rootRef.current,\n        elementsWrapperRef: elementsWrapperRef.current,\n      }}\n    >\n      <PreferencesProvider value={preferencesState}>\n        <div ref={mainDivRef} style={{ height: '100%', position: 'relative' }}>\n          <AlertProvider wrapperRef={elementsWrapperRef.current}>\n            <DispatchProvider value={dispatchMiddleWare}>\n              <ChartDataProvider value={state}>\n                <ModalProvider wrapperRef={elementsWrapperRef.current}>\n                  <HighlightProvider>\n                    <AssignmentProvider spectraData={spectraData}>\n                      <SpinnerProvider value={getSpinner}>\n                        <div\n                          className=\"nmrium-container\"\n                          ref={rootRef}\n                          css={containerStyles}\n                          onContextMenu={preventContextMenuHandler}\n                          style={{ height: '100%', width: '100%' }}\n                        >\n                          <DropZone>\n                            <div\n                              style={{\n                                display: 'flex',\n                                flexDirection: 'column',\n                                backgroundColor: 'white',\n                                width: '100%',\n                              }}\n                            >\n                              <Header\n                                isFullscreen={isFullscreen}\n                                onMaximize={toggle}\n                              />\n\n                              <div\n                                style={{\n                                  display: 'flex',\n                                  flexDirection: 'row',\n                                  height: '100%',\n                                }}\n                              >\n                                <ToolBar />\n                                <SplitPane\n                                  initialSeparation=\"590px\"\n                                  orientation=\"horizontal\"\n                                  sideSeparation=\"end\"\n                                >\n                                  <div css={viewerContainerStyle}>\n                                    <KeysListenerTracker />\n                                    <div\n                                      data-test-id=\"viewer\"\n                                      style={{\n                                        width: '100%',\n                                        height: '100%',\n                                      }}\n                                    >\n                                      {displayerMode ===\n                                      DISPLAYER_MODE.DM_1D ? (\n                                        <Viewer1D emptyText={emptyText} />\n                                      ) : (\n                                        <Viewer2D emptyText={emptyText} />\n                                      )}\n                                    </div>\n                                  </div>\n                                  <Panels />\n                                </SplitPane>\n\n                                <div\n                                  ref={elementsWrapperRef}\n                                  key={String(isFullscreen)}\n                                  id=\"main-wrapper\"\n                                  style={{\n                                    position: 'absolute',\n                                    pointerEvents: 'none',\n                                    zIndex: 0,\n                                    left: 0,\n                                    right: 0,\n                                    top: 0,\n                                    bottom: 0,\n                                  }}\n                                />\n                              </div>\n                            </div>\n                          </DropZone>\n                        </div>\n                      </SpinnerProvider>\n                    </AssignmentProvider>\n                  </HighlightProvider>\n                </ModalProvider>\n              </ChartDataProvider>\n            </DispatchProvider>\n          </AlertProvider>\n        </div>\n      </PreferencesProvider>\n    </GlobalProvider>\n  );\n}\nexport default memo(NMRium);\n","import { DropZone } from 'analysis-ui-components';\nimport debounce from 'lodash/debounce';\nimport { useState, useEffect, useCallback } from 'react';\nimport { ObjectInspector } from 'react-inspector';\n\nimport NMRium from '../../component/NMRium';\nimport { loadFiles } from '../../component/utility/FileUtility';\n\nfunction searchDeep(obj, searchKey) {\n  let result: any = [];\n  function objectHelper(obj) {\n    Object.keys(obj).forEach((key) => {\n      if (searchKey === key) {\n        result.push({ [key]: obj[key] });\n      }\n      if (Array.isArray(obj[key])) {\n        obj[key].forEach((object) => {\n          objectHelper(object);\n        });\n      } else if (typeof obj[key] === 'object' && obj[key] !== null) {\n        objectHelper(obj[key]);\n      }\n    });\n  }\n\n  objectHelper(obj);\n  return result;\n}\n\nfunction Inspector(data: any) {\n  const [filteredData, seData] = useState<any>();\n  const [key, setKey] = useState<string>('');\n  useEffect(() => {\n    const result = searchDeep(data, key);\n    seData(key ? result : data);\n  }, [data, key]);\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  const handleSearch = useCallback(\n    debounce((e) => {\n      const key = e.target.value;\n      setKey(key);\n    }, 500),\n    [data],\n  );\n\n  return (\n    <div\n      style={{ display: 'flex', flexDirection: 'column', paddingTop: '10px' }}\n    >\n      <input\n        style={{ border: '1px solid gray', padding: '5px' }}\n        type=\"text\"\n        placeholder=\"Search for key...\"\n        onChange={handleSearch}\n      />\n      <ObjectInspector data={filteredData} />;\n    </div>\n  );\n}\n\nexport default function Test() {\n  const [data, setData] = useState<any>();\n  const [callBackData, setCallBackData] = useState<any>({});\n\n  const dropFileHandler = useCallback((dropfiles) => {\n    void (async () => {\n      try {\n        const files = await loadFiles<{ binary: any }>(dropfiles, {\n          asBuffer: true,\n        });\n\n        const decoder = new TextDecoder('utf8');\n        const data = JSON.parse(decoder.decode(files[0].binary));\n        setData(data);\n      } catch (e) {\n        // eslint-disable-next-line no-alert\n        alert('Invalid JSON file');\n      }\n    })();\n  }, []);\n  const dataChangeHandler = useCallback((data) => {\n    setCallBackData(data);\n  }, []);\n\n  return (\n    <div style={{ display: 'flex', height: '100vh', padding: '20px' }}>\n      <div style={{ flex: 9 }}>\n        <NMRium data={data} onDataChange={dataChangeHandler} />\n      </div>\n      <div\n        style={{\n          display: 'flex',\n          flexDirection: 'column',\n          padding: '10px',\n          flex: 3,\n        }}\n      >\n        <div style={{ flex: 3 }}>\n          <DropZone onDrop={dropFileHandler} color=\"gray\" />\n        </div>\n        <div style={{ flex: 9 }}>\n          <Inspector data={callBackData} />\n        </div>\n      </div>\n    </div>\n  );\n}\n","import { lazy, Suspense } from 'react';\nimport { Switch, Route } from 'react-router-dom';\n\nimport Test from '../views/Test';\n\nconst TestHighlight = lazy(() => import('./TestHighlight'));\n\nexport default function TestRoutes() {\n  return (\n    <Suspense fallback={null}>\n      <Switch>\n        <Route path=\"/test/highlight\" component={TestHighlight} />\n        <Route path=\"/\" component={Test} />\n        <Route render={() => <div>Page not found</div>} />\n      </Switch>\n    </Suspense>\n  );\n}\n","import ReactDOM from 'react-dom';\nimport { HashRouter, Route, Switch } from 'react-router-dom';\n\nimport Main from './demo/layouts/Main';\nimport TestRoutes from './demo/test/TestRoutes';\n\n// Reset styles so they do not affect development of the React component.\nimport 'modern-normalize/modern-normalize.css';\nimport './demo/preflight.css';\n\nimport './demo/index.css';\n\nReactDOM.render(\n  <HashRouter>\n    <Switch>\n      <Route path=\"/test\" component={TestRoutes} />\n      <Route path=\"/\" render={(props) => <Main {...props} />} />\n    </Switch>\n  </HashRouter>,\n  document.getElementById('root'),\n);\n"],"names":["createElement","MenuItem","cloneElement","sidebarCss","css","sidebarOpenCss","sidebarClosedCss","menuBtCss","logoCss","simpleTextCss","logoNormalCss","sidebarWrapperCss","props","routes","useMemo","buildMenu","subDisplay","menuIsClosed","_jsxs","_jsx","display","padding","onMenuToggle","Menu","e","history","push","Math","random","toString","replace","item","view","getKey","file","withRouter","memo","Sidebar","lazy","mainPanelCss","mainPanelOpenCss","mainPanelClosedCss","baseURL","routesList","mapTreeToFlatArray","setMenuIsClosed","useState","toggleMenu","useCallback","position","top","height","StrictMode","Suspense","map","prop","length","routeProp","viewName","RenderedView","possibleViews","match","params","id","width","marginLeft","marginRight","backgroundColor","routeProps","patrh","path","styles","bodyContainer","justifyContent","alignItems","container","borderRadius","fontSize","textAlign","normal","color","error","errorHeader","normalHeader","loadButton","border","fontWeight","cursor","url","response","fetch","checkStatus","json","console","ok","Error","status","statusText","Main","data","setRoutes","isLoaded","dashBoardType","setDashBoardType","loadHandler","getFileExtension","substring","lastIndexOf","href","window","location","useEffect","qs","URL","searchParams","has","sampleURL","get","extention","toLowerCase","loadData","then","remoteRoutes","_remoteRoutes","JSON","parse","stringify","AdminLayout","initialState","step","brush","start","end","startX","endX","startY","endY","BrushContext","createContext","children","className","style","onBrush","onZoom","onDoubleClick","onClick","noPropagation","state","dispatch","useReducer","reducer","mouseDownTime","setMouseDownTime","debounceClickEventsRef","useRef","mouseDownHandler","event","button","stopPropagation","type","shiftKey","altKey","screenX","screenY","clientX","clientY","boundingRect","currentTarget","getBoundingClientRect","timeStamp","clickHandler","persist","x","y","callback","lodashDebounce","current","lodashMap","debounce","cancel","handleMouseWheel","deltaY","deltaX","deltaMode","hypot","moveCallback","upCallback","action","startScreenX","startScreenY","startClientX","startClientY","MouseContext","MouseaProvider","Provider","useContext","mouseTrackerState","setMouseTrackerState","mouseMoveHandler","mouseLeaveHandler","name","isApplicable","equallySpaced","baselineRegression","mean","standardDeviation","enableFilter","getColor","merge","FiltersTypes.shiftX.id","FiltersManager.reapplyFilters","get1dColor","FiltersTypes.digitalFilter.id","FiltersManager.applyFilter","getRange","getSum","getNbAtoms","resetDiaIDs","setNbAtoms","Filters.shift2DX.id","Filters.shift2DY.id","mapZones","OCLMolecule","Data1DManager.fromParsedJcamp","Data2DManager.fromParsedJcamp","Datum1D.initiateDatum1D","Datum2D.initiateDatum2D","Data1DManager.fromCSD","Data2DManager.fromCSD","fromBruker","Data1DManager.fromBruker","Data2DManager.fromBruker","Datum1D.toJSON","Datum2D.toJSON","Molecule.toJSON","OCL","Filters.zeroFilling.id","Filters.zeroFilling.name","Filters.phaseCorrection.id","Filters.phaseCorrection.name","Jszip","scaleLinear","unlinkInAssignmentData","original","unlink","cloneDeep","Filters.shiftX.id","lodashCloneDeep","handleDeleteSignal1D","handleDeleteSignal2D","zoomIdentity","max","getYScale","Filters.lineBroadening.id","Filters.fft.id","Filters.absolute.id","autoPhaseCorrection","phaseCorrection","FiltersManager.enableFilter","update2dShift","FiltersManager.deleteFilter","Filters.baselineCorrection.id","Filters.exclusionZones.id","Filters.equallySpaced.id","MoleculeManager.fromJSON","MoleculeManager.addMolfile","MoleculeManager.setMolfile","removeAssignments","calculate","lodashGet","MultipleAnalysis.analyzeSpectra","MultipleAnalysis.deleteSpectraAnalysis","MultipleAnalysis.setColumn","MultipleAnalysis.changeColumnValueKey","types.INITIATE","SpectraManager.fromJSON","types.LOAD_JSON_FILE","types.LOAD_ZIP_FILE","SpectraManager.addBruker","types.LOAD_NMREDATA_FILE","types.PREDICT_SPECTRA","LoadActions.initiate","types.SET_LOADING_FLAG","LoadActions.setIsLoading","LoadActions.handleLoadJsonFile","types.LOAD_JCAMP_FILE","LoadActions.loadJcampFile","types.LOAD_JDF_FILE","LoadActions.loadJDFFile","types.LOAD_MOL_FILE","LoadActions.handleLoadMOLFile","LoadActions.handleLoadZIPFile","LoadActions.handleLoadNmredata","types.ADD_PEAK","PeaksActions.addPeak","types.ADD_PEAKS","PeaksActions.addPeaks","types.DELETE_PEAK_NOTATION","PeaksActions.deletePeak","types.ADD_INTEGRAL","IntegralsActions.addIntegral","types.DELETE_INTEGRAL","IntegralsActions.deleteIntegral","types.CHANGE_INTEGRAL_DATA","IntegralsActions.changeIntegral","types.RESIZE_INTEGRAL","types.CHANGE_INTEGRAL_SUM","IntegralsActions.handleChangeIntegralSum","types.CHANGE_INTEGRALS_SUM_FLAG","IntegralsActions.handleChangeIntegralsSumFlag","types.CHANGE_INTEGRAL_RELATIVE","IntegralsActions.handleChangeIntegralsRelativeValue","types.SET_ORIGINAL_DOMAIN","DomainActions.setOriginalDomain","types.SET_X_DOMAIN","DomainActions.setXDomain","types.SET_Y_DOMAIN","DomainActions.setYDomain","types.SET_WIDTH","types.SET_DIMENSIONS","types.SET_SELECTED_TOOL","ToolsActions.setSelectedTool","types.RESET_SELECTED_TOOL","ToolsActions.resetSelectedTool","types.SET_SELECTED_OPTIONS_PANEL","ToolsActions.setSelectedOptionPanel","types.FULL_ZOOM_OUT","ToolsActions.zoomOut","types.SHIFT_SPECTRUM","FiltersActions.shiftSpectrumAlongXAxis","types.APPLY_ZERO_FILLING_FILTER","FiltersActions.applyZeroFillingFilter","types.APPLY_FFT_FILTER","FiltersActions.applyFFTFilter","types.APPLY_MANUAL_PHASE_CORRECTION_FILTER","FiltersActions.applyManualPhaseCorrectionFilter","types.APPLY_AUTO_PHASE_CORRECTION_FILTER","FiltersActions.applyAutoPhaseCorrectionFilter","types.APPLY_ABSOLUTE_FILTER","FiltersActions.applyAbsoluteFilter","types.CALCULATE_MANUAL_PHASE_CORRECTION_FILTER","FiltersActions.calculateManualPhaseCorrection","types.ENABLE_FILTER","FiltersActions.enableFilter","types.DELETE_FILTER","FiltersActions.deleteFilter","types.DELETE_SPECTRA_FILTER","FiltersActions.deleteSpectraFilter","types.SET_FILTER_SNAPSHOT","FiltersActions.filterSnapshotHandler","types.APPLY_MULTIPLE_SPECTRA_FILTER","FiltersActions.handleMultipleSpectraFilter","types.ADD_EXCLUSION_ZONE","FiltersActions.handleAddExclusionZone","types.DELETE_EXCLUSION_ZONE","FiltersActions.handleDeleteExclusionZone","types.CHANGE_VISIBILITY","SpectrumsActions.handleSpectrumVisibility","types.CHANGE_PEAKS_MARKERS_VISIBILITY","SpectrumsActions.handleChangePeaksMarkersVisibility","types.CHANGE_ACTIVE_SPECTRUM","SpectrumsActions.handleChangeActiveSpectrum","types.CHANGE_SPECTRUM_COLOR","SpectrumsActions.handleChangeSpectrumColor","types.CHANGE_SPECTRUM_SETTING","SpectrumsActions.changeSpectrumSetting","types.ALIGN_SPECTRA","SpectrumsActions.alignSpectraHandler","types.DELETE_SPECTRA","SpectrumsActions.handleDeleteSpectra","types.ADD_MISSING_PROJECTION","SpectrumsActions.addMissingProjectionHandler","types.GENERATE_SPECTRUM_FROM_PUBLICATION_STRING","SpectrumsActions.generateSpectrumFromPublicationStringHandler","types.TOGGLE_REAL_IMAGINARY_VISIBILITY","ToolsActions.handleToggleRealImaginaryVisibility","types.SET_ZOOM","ToolsActions.handleZoom","types.SET_SPECTRA_SAME_TOP","ToolsActions.setSpectraSameTopHandler","types.RESET_SPECTRA_SCALE","ToolsActions.resetSpectraScale","types.CHANGE_SPECTRUM_DISPLAY_VIEW_MODE","ToolsActions.handleChangeSpectrumDisplayMode","types.ADD_MOLECULE","MoleculeActions.addMoleculeHandler","types.SET_MOLECULE","MoleculeActions.setMoleculeHandler","types.DELETE_MOLECULE","MoleculeActions.deleteMoleculeHandler","MoleculeActions.predictSpectraFromMoleculeHandler","types.SET_CORRELATIONS_MF","CorrelationsActions.handleSetMF","types.SET_CORRELATIONS_TOLERANCE","CorrelationsActions.handleSetTolerance","types.SET_CORRELATION","CorrelationsActions.handleSetCorrelation","types.SET_CORRELATIONS","CorrelationsActions.handleSetCorrelations","types.DELETE_CORRELATION","CorrelationsActions.handleDeleteCorrelation","types.BRUSH_END","ToolsActions.handleBrushEnd","types.SET_VERTICAL_INDICATOR_X_POSITION","ToolsActions.setVerticalIndicatorXPosition","types.SET_SPECTRUMS_VERTICAL_ALIGN","ToolsActions.setSpectrumsVerticalAlign","types.AUTO_PEAK_PICKING","PeaksActions.handleAutoPeakPicking","types.AUTO_ZONES_DETECTION","ZonesActions.handleAutoZonesDetection","types.CHANGE_ZONES_NOISE_FACTOR","ZonesActions.changeZonesFactorHandler","types.AUTO_RANGES_DETECTION","RangesActions.handleAutoRangesDetection","types.ADD_RANGE","RangesActions.handleAddRange","types.DELETE_RANGE","RangesActions.handleDeleteRange","types.DELETE_1D_SIGNAL","RangesActions.handleDeleteSignal","types.RESIZE_RANGE","RangesActions.handleResizeRange","types.CHANGE_RANGE_SUM","RangesActions.handleChangeRangeSum","types.CHANGE_RANGES_SUM_FLAG","RangesActions.handleChangeRangesSumFlag","types.CHANGE_RANGE_RELATIVE","RangesActions.handleChangeRangeRelativeValue","types.CHANGE_RANGE_SIGNAL_VALUE","RangesActions.handleChangeRangeSignalValue","types.CHANGE_RANGE_SIGNAL_KIND","RangesActions.handleChangeRangeSignalKind","types.SAVE_EDITED_RANGE","RangesActions.handleSaveEditedRange","types.UNLINK_RANGE","RangesActions.handleUnlinkRange","types.SET_DIAID_RANGE","RangesActions.handleSetDiaIDRange","types.CHANGE_TEMP_RANGE","RangesActions.handleChangeTempRange","types.SHOW_MULTIPLICTY_TREES","RangesActions.handleShowMultiplicityTrees","types.SHOW_RANGES_INTEGRALS","RangesActions.handleShowRangesIntegrals","types.AUTO_RANGES_SPECTRA_PICKING","RangesActions.handleAutoSpectraRangesDetection","types.SHOW_J_GRAPH","RangesActions.handleShowJGraph","types.SET_ACTIVE_TAB","ToolsActions.handelSetActiveTab","types.ADD_BASE_LINE_ZONE","ToolsActions.handleAddBaseLineZone","types.DELETE_BASE_LINE_ZONE","ToolsActions.handleDeleteBaseLineZone","types.APPLY_BASE_LINE_CORRECTION_FILTER","FiltersActions.handleBaseLineCorrectionFilter","types.SET_KEY_PREFERENCES","types.APPLY_KEY_PREFERENCES","types.SET_2D_LEVEL","ToolsActions.levelChangeHandler","types.ADD_2D_ZONE","ZonesActions.add2dZoneHandler","types.DELETE_2D_ZONE","ZonesActions.handleDeleteZone","types.DELETE_2D_SIGNAL","ZonesActions.handleDeleteSignal","types.SET_2D_SIGNAL_PATH_LENGTH","ZonesActions.handleSetSignalPathLength","types.RESET_DOMAIN","DomainActions.handelResetDomain","types.CHANGE_ZONE_SIGNAL_VALUE","ZonesActions.changeZoneSignalDelta","types.CHANGE_ZONE_SIGNAL_KIND","ZonesActions.handleChangeZoneSignalKind","types.UNLINK_ZONE","ZonesActions.handleUnlinkZone","types.SET_DIAID_ZONE","ZonesActions.handleSetDiaIDZone","types.AUTO_ZONES_SPECTRA_PICKING","ZonesActions.handleAutoSpectraZonesDetection","types.SAVE_EDITED_ZONE","ZonesActions.handleSaveEditedZone","types.ANALYZE_SPECTRA","SpectraAnalysisActions.analyzeSpectra","types.DELETE_ANALYZE_SPECTRA_RANGE","SpectraAnalysisActions.handleDeleteSpectraRanges","types.RESIZE_ANALYZE_SPECTRA_RANGE","SpectraAnalysisActions.handleResizeSpectraRange","types.SET_ANALYZE_SPECTRA_COLUMNS","SpectraAnalysisActions.handleSetColumns","types.FILTER_SPECTRA_COLUMN","SpectraAnalysisActions.handleFilterColumn","types.RESURRECTING_SPECTRUM_FROM_RANGES","DatabaseActions.handleRangeResurrecting","types.SET_AUTOMATIC_ASSIGNMENTS","AssignmentsActions.setAutomaticAssignmentsHandler","types.SET_MOUSE_OVER_DISPLAYER","GlobalActions.setIsOverDisplayer","produce","ChartContext","ChartDataProvider","dispatchContext","DispatchProvider","LoaderContext","defaultLoader","LoaderProvider","isEmpty","emptyText","canOpenLoader","openLoader","useLoader","spinnerContext","defaultGetSpinner","SpinnerProvider","isLoading","undefined","useChartData","checkEmpty","startCheckEmpty","timeout","setTimeout","clearTimeout","getSpinner","Fragment","transformOrigin","left","zoom","allowTools","options","zeroFilling","peakPicking","integral","baseLineCorrection","rangesPicking","zone2D","slicingTool","editRange","multipleSpectraAnalysis","exclusionZones","databaseRangesSelection","BRUSH_TYPE","X","Y","XY","defaultDimensionBorder","brushType","dimensionBorder","widthProps","heightProps","toolOptions","selectedTool","includes","sign","scaleX","scaleY","transform","willChange","line","stroke","strokeOpacity","shapeRendering","strokeWidth","equalizerTool","margin","brushState","right","bottom","pointerEvents","overflow","lodashSet","Workspaces","lodashMerge","PreferencesContext","preferencesInitialState","PreferencesProvider","context","workspace","workspaces","usePreferences","currentWorkspaces","Object","keys","reduce","acc","key","label","WORKSPACES","spectrumID","datum","xDomain","yDomain","contours","activeSpectrum","preferences","xShift","yShift","getShift","isActive","buildContourPath","_scaleX","get2DXScale","_scaleY","get2DYScale","PathBuilder","element","lines","i","moveTo","lineTo","j","closePath","opacity","displayerKey","index","isPositiveVisible","positiveColor","isNegativeVisible","negativeColor","MemoizedContours","ContoursInner","spectra","filter","info","dimension","isFt","marignValue","spectrum","originHeight","yDomains","xyReduce","useXYReduce","XYReducerDomainAxis","YAxis","paths","get1DYScale","re","pathPoints","pathBuilder","mainHeight","Left1DChart","marginProps","originMargin","XAxis","Top1DChart","axisStyles","defaultMargin","show","tabActiveSpectrum","activeTab","refAxis","xAxis","d3","ticks","tickFormat","call","_Fragment","axis","lineStyle","displayerMode","deltas1D","setDeltas1D","split","nucleus","deltas","ranges","_datum","isVisible","isSpectrum1D","values","flat","_range","signals","_signal","SignalKindsToInclude","some","_kind","kind","delta","indicationLines","_delta","HighlightedSource","emptyState","highlight","highlights","highlighted","highlightedPermanently","sourceData","remove","highlightContext","convertedHighlights","payload","extra","newState","value","highlightReducer","contextValue","Array","isArray","useHighlightData","newHighlights","String","isActivePermanently","hide","add","click","preventDefault","onHover","onMouseEnter","onMouseLeave","signal","highlightIDsX","buildID","highlightIDsY","highlightX","useHighlight","highlightY","Signal","buildIDs","concat","assignment","useAssignment","highlightData","isHighlighted","setIsHighlighted","_highlighted","peaks","peak","stylesOnHover","stylesHighlighted","Zone","zoneData","assignmentZone","highlightZone","ZONE","from","x1","to","x2","y1","y2","reduceOpacity","setReduceOpacity","checkZoneKind","zones","setVisibility","on","prevVisiblity","zone","MemoizedZones","ZonesInner","emptyData","useSpectrum","MemoizedChart2D","chart2DInner","layout","data1D","trackID","getLayoutID","nucleuses","formatX","formatY","useFormatNumberByNucleus","LAYOUT","TOP_1D","CENTER_2D","LEFT_1D","getRealYValue","cordinate","get1DDataXY","xIndex","xFindClosestIndex","invert","getXValue","getYValue","getRation","Number","MIN_VALUE","toFixed","getDeltaX","toPrecision","getLabel","label2d","labelld","getZValue","maxX","maxY","minX","minY","z","xStep","yStep","floor","yIndex","userSelect","HorizontalSliceChart","VerticalSliceChart","useMouseTracker","chart2d","scale2dX","scale2dY","getSlice","horizontal","vertical","useDispatch","spectrumData","n","find","isFid","DIMENSION","get2DDimensionLayout","handelBrushEnd","brushData","ADD_2D_ZONE","BRUSH_END","handelOnDoubleClick","FULL_ZOOM_OUT","handleZoom","SET_2D_LEVEL","SET_ZOOM","mouseClick","FooterBanner","SET_DIMENSIONS","scaleContext","scaleInitialState","ScaleProvider","scale","useScale","AlertProvider","duration","defaultStyle","transitions","FADE","transition","SCALE","defaultTransitionStyles","entering","entered","exiting","exited","transitionStyles","ref","default","containerStyle","initialStyles","flexDirection","positions","TOP_LEFT","TOP_CENTER","TOP_RIGHT","MIDDLE_LEFT","MIDDLE","MIDDLE_RIGHT","BOTTOM_LEFT","BOTTOM_CENTER","BOTTOM_RIGHT","getStyles","wrapperRef","offset","root","timersId","alerts","setAlerts","document","timersIdRef","appendChild","forEach","removeChild","alert","currentAlerts","lengthBeforeRemove","filteredAlerts","a","onClose","message","substr","alertOptions","close","timerId","splice","indexOf","onOpen","success","types","SUCCESS","ERROR","INFO","showLoading","PROGRESS_INDICATOR","Promise","resolve","closeHandler","alertsByPosition","groupBy","parentStyle","innerWidth","innerHeight","alertContextValue","createPortal","zIndex","Wrapper","Transition","minHeight","buttons","optionsHandler","handler","option","text","ModalContent","modal","onLayout","contentSize","Content","useSize","component","isFinite","modalRef","setModal","_modal","isBackgroundBlur","enableResizing","showConfirmDialog","dialogOptions","ConfirmDialog","keyHandler","addEventListener","removeEventListener","outerStyle","modalContextValue","contentLayoutHandler","updateSize","GlobalConetxt","rootRef","elementsWrapperRef","GlobalProvider","popup","whiteSpace","fontFamily","textShadow","mainContainer","popupPlacement","title","refChild","refContent","placement","setPlacement","showToolTip","useGlobal","useLayoutEffect","getPopupPlacement","childBounding","contentBounding","pl","mouseOverHandler","ToolTip","svg","fill","popupTitle","CloseButton","loaderStyles","analysisData","setAnalysisData","calcStart","setCalcStartStatus","isCalcFinished","setCalcFinished","isSpectrum2D","fromIndex","toIndex","xGetFromToIndex","analysesProps","slice","result","analyseMultiplet","frequency","originFrequency","takeBestPartMultiplet","symmetrizeEachStep","debug","err","log","steps","d","xyToXYObject","multiplet","js","multiplicity","coupling","errorFunction","vAlign","useScaleChecked","EXCLUSION_ZONE","useActiveSpectrumStyleOptions","ExclusionZoneAnnotation","xDomains","verticalAlign","getExclusionZones","getVerticalShift","MemoizedPeakAnnotations","ExclusionZonesAnnotationsInner","useSpectraByActiveNucleus","DISPLAYER_MODE","DM_1D","filters","Filters","flag","anchorStyle","content","anchorSide","previousPosition","baseCss","initialPosition","onStart","onMove","onEnd","useDraggable","anchor","onMouseDown","innerContainer","tag","resProps","integralData","INTEGRAL","handleOnStopResizing","RESIZE_INTEGRAL","handleOnEnterNotation","handleOnMouseLeaveNotation","x0","useIntegralPath","integralSettings","integralDefaultValues","getValue","Integrals","integrals","tempData","_data","refText","isSelected","setIsSelected","_value","setValue","containerSize","setContainerSize","format","PEAK","handleOnPeakChange","SHIFT_SPECTRUM","shiftValue","textBox","getBBox","handleKeyDown","newValue","valueAsNumber","isNaN","oldValue","blur","handleChange","target","handleSelectPeakAnnotation","outline","paddingRight","Peaks","getVerticalAlign","findIndex","reSortData","sort","isPeaksMarkersVisible","DATABASE","fullHeight","blockHight","range","diff","abs","newForm","newTo","rangesToXY","nbPoints","domain","extent","accumulator","point","gridStyles","showGrid","mode","labelProp","refGrid","grid","tickSize","JGraphContext","maxValue","JGraphContextProvider","jGraphState","VerticalAxis","forwardRef","other","useLinearPrimaryTicks","useJGraph","links","generatePath","link","couplings","join","isOver","setOver","marginTop","JCouplingLinks","MemoizedJGraph","InnerJGraph","showJGraph","graphHeight","jGraphTolerance","_preferences","getRangeDefaultValues","jCouplingMax","generateJGraphData","maxRange","JGraphState","onDelete","common","hover","Highlighted","rangeData","columnKey","deleteHandler","DELETE_ANALYZE_SPECTRA_RANGE","colKey","resizeEndHandler","resized","RESIZE_ANALYZE_SPECTRA_RANGE","DeleteButton","spectraAnalysis","columns","MemoizedMultiAnalysisRanges","MultiAnalysisRangesInner","levelHeight","TREE_LEVEL_COLORS","showLabels","nodesData","signalID","labelOptions","buildTreeNodeAndEdge","_startX","ratio","multiplicityIndex","edgeLevel","_startYEdge","_startYNode","distance","node","assigned","rangeFrom","rangeTo","spectraData","extractID","SIGNAL","xRange","setXRange","treeProps","setTreeProps","drawInFullRange","setDrawInFullRange","setShowLabels","_drawInFullRange","checkMultiplicity","_treeWidth","_treeHeight","_treeLevelHeight","yMax","_x","treeNodesData","buildTreeNodesData","createTreeNodes","jIndices","_mult","hasCouplingConstant","_i","_xRange","_treeNodeData","multiplicityTree","firstLevelStartY","_startY","secondLevelStartY","_rangeFrom","_rangeTo","pathData","setActive","MemoizedTempMultiplicityTree","TempMultiplicityTreeInner","tempRange","showMultiplicityTrees","startEditMode","integration","assignmentData","useAssignmentData","assignmentRange","highlightRange","filterForIDsWithAssignment","RANGE","isBlockedByEditing","setIsBlockedByEditing","checkRangeKind","RESIZE_RANGE","mouseEnterHandler","assignHandler","editRangeID","showRangesIntegrals","MemoizedRanges","RangesInner","empyData","deleteRangeHandler","DELETE_BASE_LINE_ZONE","baseLineZones","xPosition","MemoizedFooterBanner","FooterBannerInner","colorIndicator","borderBottom","marginBottom","ToggleVisibility","off","trackers","borderColor","radius","fillOpacity","SVGPadding","closePeakPosition","setPosition","vShift","align","candidatePeakPosition","getClosePeak","mouseCoordinates","b","maxIndex","number","minIndex","yDataRange","yValue","xValue","pivot","activeSpectrumData","xVal","xInvert","general","widthProp","heightProp","useModal","useAlert","scaleState","dispatchScale","scaleReducer","SET_SCALE","propagateEvent","startXPPM","endXPPM","Events","emit","disableMultipletAnalysis","ADD_INTEGRAL","MAX_LENGTH","ADD_RANGE","ANALYZE_SPECTRA","ADD_PEAKS","ADD_BASE_LINE_ZONE","ADD_EXCLUSION_ZONE","zoomType","ZoomType","STEP_HORIZONTAL","xPPM","ADD_PEAK","SET_VERTICAL_INDICATOR_X_POSITION","header","textDecoration","body","stack","colorPalettes","base","shade","tint","danger","warning","medium","light","sizeConfig","xSmall","small","large","size","basic","fillStyle","getFillStyle","colorStyle","active","Button","restProps","flex","colorTheme","Done","Danger","Action","onDone","onCancel","doneLabel","cancelLabel","CheckBox","checked","checkProps","disabled","onChange","setCheck","handleCheck","reverse","checkbox","setFieldValue","useFormikContext","changeHandler","FormikForm","onSubmit","initialValues","validationSchema","lineHeight","inputWrapper","borderWidth","borderStyle","input","clearButton","aspectRatio","Input","debounceTime","onKeyDown","checkValue","enableAutoSelect","onBlur","onFocus","renderIcon","canClear","onClear","val","setVal","localRef","combinedRef","useCombinedRefs","debounceOnChange","select","formatValue","trim","onChangeHandler","check","pattern","test","preventPropagate","clearHandler","checkErrorAfterInputTouched","errors","touched","isInvalid","INITIAL_VALUE","compressed","pretty","dataExportOption","DataExportOptions","ROW_DATA","onSave","refForm","handleSave","submitForm","submitHandler","ModalStyles","DATA_SOURCE","JSZip","saveAs","jszip","saveToClipboardHandler","hideLoading","copyPNGToClipboard","saveAsJSONHandler","spaceIndent","isCompressed","fileName","exportedData","toJSON","exportAsJSON","handle","saveAsNMREHandler","nmriumToNmredata","exportAsNMRE","saveAsSVGHandler","saveAsPNGHandler","saveHandler","saveAsHandler","defaultValue","Toggle","toggleHandler","ToggleButton","counter","deleteToolTip","onFilter","filterToolTip","filterIsActive","counterFiltered","onSettingClick","showSettingButton","canDelete","DefaultPanelHeader","setData","sourceElement","setSourceElement","contextMenuHandler","parentElement","clickX","clickY","screenW","screenH","rootW","rootH","useImperativeHandle","handleContextMenu","_handleGlobalClick","wasOutside","isSameNode","c","ContextMenu","headerGroups","headerGroup","getHeaderGroupProps","headers","column","getHeaderProps","getSortByToggleProps","render","isSorted","isSortedDesc","ReactTableHeader","HighlightedRowStyle","ConstantlyHighlightedRowStyle","row","highlightedSource","UNKNOWN","onContextMenu","getIDs","prototype","hasOwnProperty","isConstantlyHighlighted","getRowProps","cells","cell","isRowSpanned","rowSpan","getCellProps","ReactTableRow","table","enableVirtualScroll","ReactTableInner","onScroll","approxItemHeight","groupKey","contextRef","indexBoundary","useReactTableContext","getTableProps","getTableBodyProps","rows","prepareRow","rowSpanHeaders","useTable","useSortBy","useRowSpan","checkModifierKeyActivated","rowsData","overflowY","ReactTableStyle","prepareRowSpan","mRef","useMeasure","combineRef","tableVirtualConfig","setTableVirtualConfig","offsetHeight","scrollHeight","numberOfVisibleRows","ceil","prev","lookForGroupIndex","currentIndex","side","currentItem","findStartIndex","newIndex","currentIndx","findEndIndex","scrollHandler","scrollTop","ReactTable","assignments","SET_AUTOMATIC_ASSIGNMENTS","COLUMNS","Header","Cell","maxWidth","minWidth","accessor","SvgNmrAssignment","PeaksTable","getAssignments","getAssignmentsData","useGetAssignments","tablePanelStyle","SvgNmrAssignment2","useFlexLayout","ReactTableFlexLayout","tableContainer","searchInput","meta","information","setInformation","matches","setMatchesData","searchRef","handleSearch","sortType","resizable","MemoizedInformationPanel","InformationPanelInner","tabid","tablabel","tabstyles","topStyles","leftStyles","PositionsEnum","onClickTabHandler","tab","contentChild","tabs","Children","child","isValidElement","Tabs","direction","loop","defaultIndex","activeIndex","setActiveIndex","Sliders","nextHandler","preActiveIndex","nextIndex","prevHandler","prevIndex","NextPrev","toolbarStyle","moleculeContainerStyle","molecules","setCurrentIndex","_index","slideIndex","mol","molfile","MF","mf","mw","getAtom","newSum","atoms","molecule","onChangeMoleculeSelectionHandler","sumOptions","panels","setOption","setActiveOption","SumSetOptions","formRef","onTabChangeHandler","sumAuto","hideSetSumFromMolecule","structuresPanel","hidden","moleculeKey","setValues","sum","Yup","required","SaveButton","PreferencesHeader","onEditStart","editStatus","enabled","enableEdit","startEdit","closeEdit","mouseClickCallback","classList","contains","editModeHandler","EditableColumn","arrowDownIcon","Select","handleOnChanged","selectStyle","deleteIntegralHandler","DELETE_INTEGRAL","integralID","changeIntegralDataHandler","CHANGE_INTEGRAL_DATA","initialColumns","SignalKinds","saveRelativeHandler","CHANGE_INTEGRAL_RELATIVE","integralsPreferences","showWhen","formatNumber","absolute","absoluteFormat","relativeFormat","checkIntegralKind","tableColumns","col","colParams","addCustomColumn","object1","object2","IntegralTable","onColorChange","displayColorPicker","showColorPicker","selectedColor","setColor","handleClick","handleClose","handleOnColorChanged","colorEvent","hex","round","rgb","ChromePicker","ColorInput","colorPickerProps","colorChangeHandler","FormikColorPicker","inputLabel","checkControllerName","formatControllerName","disableFormat","hideFormat","checkChangeHandler","FormikColumnFormatField","inputContainer","NumberInput","onInput","min","changeHander","checkValidity","_ref","groupContainer","paddingBottom","formatFields","checkController","formatController","innerRef","updateValues","integralPreferences","getValueByKeyPath","defaultValues","nucleusLabel","assign","saveSetting","field","MemoizedIntegralsPreferences","IntegralsPreferencesInner","useNucleus","IntegralsPreferences","setFilterIsActive","isFlipped","setFlipStatus","settingRef","yesHandler","handleDeleteAll","changeIntegralSumHandler","CHANGE_INTEGRAL_SUM","currentSum","showChangeIntegralSumModal","settingsPanelHandler","saveSettingHandler","handleOnFilter","toggleConstantSumHandler","CHANGE_INTEGRALS_SUM_FLAG","filteredData","factor","_integrals","isInRange","SvgNmrSum","MemoizedIntegralPanel","IntegralPanelInner","wrapper","numberOfPoints","EquallySpacedFilter","FromToFilter","baseList","setFilter","List","list","REFERENCES","entries","APPLY_MULTIPLE_SPECTRA_FILTER","filterChangeHandler","filterOptions","openFiltersModal","RESET_SELECTED_TOOL","openExportAsMatrixModal","SvgNmrAddFilter","SvgNmrExportAsMatrix","selectedMolecule","setMolfile","cb","newMolfile","molText","exec","groups","SET_MOLECULE","ADD_MOLECULE","menuStyles","icon","items","boxBounding","toolTip","menuButtonRef","isShown","showMenu","closeMenuButton","boxSizing","MenuList","othersProps","__html","listStyle","getErrors","errorObj","errorsIterators","obj","isValid","errorList","errorText","FormikSelect","NUMBER_OF_POINTS_1D","generateNumbersPowerOfX","NUMBER_OF_POINTS_2D","predictionFormValidation","shape","integer","lineWidth","proton","carbon","cosy","hsqc","hmbc","isApproved","setApproved","predictionPreferences","setPredictionPreferences","useStateWithLocalStorage","predictionIndex","initValues","isAgree","defaultPredictionOptions","SET_LOADING_FLAG","predictedSpectra","PREDICT_SPECTRA","approveCheckHandler","FREQUENCIES","paddingLeft","MOL_EXPORT_MENU","onMoleculeIndexChange","onOpenMoleculeEditor","actionsOptions","saveAsMolHandler","copyTextToClipboard","exportHandler","handlePaste","navigator","clipboard","readText","handleDelete","DELETE_MOLECULE","openPredictSpectraModal","hideExport","hidePast","hideAdd","hideDelete","hidePredict","SvgNmrFt","activeAssignment","activated","ConcatenationString","onAtomHoverHighlights","setOnAtomHoverHighlights","onAtomHoverAction","setOnAtomHoverAction","DM_2D","assignedDiaIDs","assignedDiaID","assignedDiaIDsMerged","currentDiaIDsToHighlight","highlightID","findDatumAndSignalIndex","diaIDs","getCurrentDiaIDsToHighlight","toggleAssignment","diaID","atomInformation","toggleDiaIDs","handleOnClickAtom","atom","extractFromAtom","nbAtoms","toggle","oclIDs","signalIndex","_diaIDs","_diaID","SET_DIAID_RANGE","SET_DIAID_ZONE","handleOnAtomHover","getHighlightsOnHover","panel","flexGrow","innerPanel","toolbar","slider","moleculesProp","onMoleculeChange","setMolecules","useAtomAssignment","prevMolecules","handleReplaceMolecule","openMoleculeEditorHandler","moleclue","moleculeIndexHandler","MemoizedMoleculePanel","MoleculePanelInner","ALIGN_SPECTRA","optionChangeHandler","resValues","targetX","nbPeaks","initCode","code","setCode","setResult","evalResult","Eval","maxHeight","MultipleAnalysisCodeEditor","onAfterSave","setColumns","tempKey","columnsKeys","preferncesSchema","colmnName","formData","COLUMNS_TYPES","FORMULA","formula","object","columnSchema","SET_ANALYZE_SPECTRA_COLUMNS","addNewColumn","prevData","valueKey","MultipleSpectraAnalysisPreferences","ul","li","onSelect","renderItem","containerRect","selectedKey","formatSelectedValue","open","setOpen","setItem","drop","selectHandler","columnsFilters","COLUMNS_VALUES_KEYS","RELATIVE","ABSOLUTE","MIN","MAX","charLabel","rangeLabel","onColumnFilter","NORMAL","codeEvaluation","columnFilterHandler","FILTER_SPECTRA_COLUMN","columnData","columnIndex","cellHandler","headerHandler","MultipleSpectraAnalysisTable","afterSaveHandler","showTrackerHandler","openAlignSpectra","copyToClipboardHandler","getDataAsString","SvgNmrOverlay","MemoizedMultipleSpectraAnalysisPanel","MultipleSpectraAnalysisPanelInner","peaksDefaultValues","peaksPreferences","MemoizedPeaksPreferences","PeaksPreferencesInner","PeaksPreferences","deletePeakHandler","DELETE_PEAK_NOTATION","saveDeltaPPMRefsHandler","parseFloat","peakIndexFormat","valueHz","deltaHzFormat","intensity","intensityFormat","peakWidth","peakWidthFormat","filteredPeaks","_peaks","next","MemoizedPeaksPanel","PeaksPanelInner","onCopyClick","onUnlink","onFilterActivated","isFilterActive","filterCounter","changeRangesSumHandler","CHANGE_RANGE_SUM","showChangeRangesSumModal","handleOnRemoveAssignments","DELETE_RANGE","handleSetShowMultiplicityTrees","SHOW_MULTIPLICTY_TREES","handleShowIntegrals","SHOW_RANGES_INTEGRALS","handleShowJGraph","SHOW_J_GRAPH","copyHTMLToClipboard","saveAsHTMLHandler","observedFrequency","nbDecimalDelta","getNumberOfDecimals","ppm","nbDecimalJ","hz","rangesToACS","changeSumConstantFlagHandler","CHANGE_RANGES_SUM_FLAG","SvgNmrIntegrate","rangesPreferences","MemoizedRangesPreferences","RangesPreferencesInner","RangesPreferences","config","sortConfig","setSortConfig","sortedItems","sortableItems","SortType","sortHandler","columnName","defaultContent","onSort","rowSpanTags","onHoverRange","FormatNumber","FormikOnChange","enableValidation","inputInfo","infoText","signalContainer","addSignalBtn","newSignal","newSignalDelta","translateMultiplet","_signals","validation","createError","errorMessage","triggerSubmitHandler","AddSignalFormTab","_coupling","CouplingsTableStyle","multiplicityChangeHandler","multipletsList","Multiplets","CouplingsTable","SignalFormTabStyle","SignalFormTab","textStyles","tabStylesAddition","tabStyles","newSignalFormRef","activeField","setActiveField","handleOnFocus","tapClickHandler","handleDeleteSignal","tabContainsErrors","signalFormTabs","signalTabs","addSignalTab","editSignalInfoText","addSignalInfoText","noSignals","noCouplings","SignalsForm","useValidation","Yup.object","Yup.array","Yup.string","Yup.mixed","onSaveEditRangeModal","onCloseEditRangeModal","onZoomEditRangeModal","automaticZoom","useRangeFormValidation","handleOnZoom","handleOnClose","getCouplings","getSignals","generateID","handleOnSave","formValues","counterJ","_multiplicity","CHANGE_TEMP_RANGE","zoomRange","SET_X_DOMAIN","deleteRange","changeRangeSignalKind","CHANGE_RANGE_SIGNAL_KIND","rowData","saveEditRangeHandler","editedRowData","SAVE_EDITED_RANGE","closeEditRangeHandler","SET_SELECTED_TOOL","selectBoxStyle","onHoverSignal","useEditRangeModal","tableMetaInfo","spanStyle","onUnlinkVisibilityChange","unlinkVisibility","onLink","visibilityChangeHandler","spanCss","visibility","RangeAssignmentsColumn","RangeColumn","integralVal","formattedValue","CHANGE_RANGE_RELATIVE","tdCss","SignalAssignmentsColumn","useFormat","CHANGE_RANGE_SIGNAL_VALUE","rangeID","highlightRangeAssignmentsColumn","assignmentSignal","highlightSignal","unlinkRangeButtonVisibility","showUnlinkRangeButton","unlinkSignalButtonVisibility","showUnlinkSignalButton","getFormat","unlinkHandler","isOnRangeLevel","removeAll","linkHandler","onHoverRangeAssignmentsColumn","trCss","rowIndex","isColumnVisible","SignalDeltaColumn","ActionsColumn","tableStyle","tableData","sortedData","useTableSortBy","useMapRanges","rowKey","rangesData","isInView","getFilteredRanges","_ranges","unlinkRangeHandler","UNLINK_RANGE","saveJSONToClipboardHandler","dataToClipboard","contextMenu","filterHandler","MemoizedRangesTablePanel","RangesTablePanelInner","spectrums","isAutomaticPickingVisible","DELETE_SPECTRA","showAllSpectrumsHandler","spectrumsPerTab","CHANGE_VISIBILITY","hideAllSpectrumsHandler","addMissingProjectionHandler","getMissingProjection","SpectrumsData","missingNucleus","hasSpectrums","ADD_MISSING_PROJECTION","setSameTopHandler","SET_SPECTRA_SAME_TOP","resetScaleHandler","RESET_SPECTRA_SCALE","automaticPickingHandler","AUTO_RANGES_SPECTRA_PICKING","AUTO_ZONES_SPECTRA_PICKING","SvgNmrResetScale","SvgNmrSameTop","SvgNmrRangePicking","MemoizedSpectraPanelHeader","SpectraPanelHeaderInner","isToolVisible","useCheckToolsVisibility","ColorIndicator","onChangeMarkersVisibility","markersVisible","isMarkerVisible","v","SvgNmrPeaks","onChangeVisibility","alignContent","textOverflow","onChangeActiveSpectrum","onOpenSettingModal","formatValueAsHTML","SvgNmrFid","SvgNmr2D","solvent","borderLeft","experiment","pulse","SpectrumListItem","colorchangeHandler","SketchPicker","COLORS","jump","array","Float64Array","log10","yLogBase","first","last","inLogScale","processedData","prepareData","sanResult","xNoiseSanPlot","sanPlot","plotKey","sanplot","getLine","positive","strokeDasharray","negative","Spectrum1DHistogram","SpectrumData","gap","onAfterChange","sliderProps","ReactSlider","valueNow","FormikSlider","matrix","cols","paddingTop","borderTop","Spectrum2DHistogram","CHANGE_SPECTRUM_SETTING","SpectrumSetting","arePropsEqual","onTabChange","setMarkersVisible","selectedSpectrumData","setSelectedSpectrum","settingModalPosition","setSettingModalPosition","isSettingModalDisplayed","setIsSettingModalDisplayed","visibleMarkers","spectrumsGroupByNucleus","groupByNucleus","GroupByInfoKey","handleChangeMarkersVisibility","newChecked","CHANGE_PEAKS_MARKERS_VISIBILITY","SET_ACTIVE_TAB","openSettingHandler","selectedSpectrum","nativeEvent","handleChangeVisibility","handleChangeActiveSpectrum","CHANGE_ACTIVE_SPECTRUM","group","MemoizedSpectra","SpectrumsTabsInner","setSpectrums","tabChangeHandler","SpectraPanelHeader","SpectrumListPanel","description","onConfirm","handleOnConfirm","editPathLengthsStyles","experimentType","onEdit","setFrom","pathLength","DefaultPathLengths","setTo","isError","setIsError","handleOnEdit","editedSignal","moveLinkStyles","correlationDim1","correlationDim2","correlations","selectedCorrelationIdDim1","setSelectedCorrelationIdDim1","selectedCorrelationIdDim2","setSelectedCorrelationIdDim2","correlation","getCorrelationDelta","getSelection","dim","selectionData","arr","_correlation","pseudo","atomType","origin","getCorrelationLabel","selection","modalContainer","setActiveTab","getLinkLabel","linkDim","getLinkDim","editedLink","editedCorrelations","buildCorrelationDataOptions","getEditedCorrelations","tabsContainer","TOP","correlationIdDim1","correlationIdDim2","toUpperCase","correlationsData","highlightIDsAdditionalColumn","ids","_id","findRangeOrZoneID","experimentID","highlightAdditionalColumn","focus","IsInView","tableHeaderProps","getLabelColor","equivalenceTextStyle","edited","equivalence","isInteger","moved","thProps","rowCorrelation","columnCorrelation","commonLinks","highlightIDsCommonLinks","highlightCommonLinks","handleEditPseudoHSQC","pseudoLinkCountHSQC","_link","_correlationDim1","_correlationDim2","commonPseudoLink","buildLink","cloneCorrelationAndEditLink","protonsCount","skipDataUpdate","commonLinksMenu","commonLink","commonLinkContextMenuLabel","getAbbreviation","commonPseudoLinkHSQC","contentLabel","isInViewRow","isInViewColumn","additionalColumnData","styleRow","styleLabel","onSaveEditEquivalences","onSaveEditNumericValues","onEditCorrelationTableCellHandler","highlightIDsRow","highlightRow","onSaveEquivalencesHandler","onSaveEditNumericValuesHandler","convertValuesString","additionalColumnFields","_commonLink","experimentLabel","equivalenceCellStyle","tableDataProps","otherTableDataProps","t","borderRight","hybridization","hybrid","filteredCorrelationsData","editEquivalencesSaveHandler","showProtonsAsRows","additionalColumnHeader","getAtomCounts","elements","stateAtomType","errorColorIndex","Errors","_error","complete","ErrorColors","fontStyle","Overview","inputStyle","previousMF","setMF","isValidMF","setIsValidMF","hasChanged","setHasChanged","checkMF","getAtomsFromMF","onSaveHandler","onSaveHandlerMolecularFormulaInput","onSaveHandlerMoleculeSelection","onChangeHandlerMoleculeSelection","previousTolerance","tolerance","setTolerance","setIsValid","_isValid","panelStyle","setAdditionalColumnData","selectedAdditionalColumnsAtomType","setSelectedAdditionalColumnsAtomType","setShowProtonsAsRows","atomTypesInView","getAtomType","xDomain0","xDomain1","yDomain0","yDomain1","firstLink1D","getLinkDelta","findSpectrum","findSignalMatch1D","firstLink2D","findSignalMatch2D","_values","handleOnSetMolecularFormula","SET_CORRELATIONS_MF","handleOnSetShiftTolerance","SET_CORRELATIONS_TOLERANCE","showSetMolecularFormulaModal","showSetShiftToleranceModal","additionalColumnTypes","columnTypes","columnType","_selectedAdditionalColumnsAtomType","SET_CORRELATION","editNumericValuesSaveHandler","setCorrelationsHandler","SET_CORRELATIONS","deleteCorrelationHandler","DELETE_CORRELATION","deleteSignalHandler","findRange","findSignal1D","DELETE_1D_SIGNAL","findZone","findSignal2D","DELETE_2D_SIGNAL","changeSignalPathLengthHandler","SET_2D_SIGNAL_PATH_LENGTH","editCorrelationTableCellHandler","SummaryPanel","zoneDefaultValues","zonesPreferences","MemoizedZonesPreferences","ZonesPreferencesInner","ZonesPreferences","Yup.number","onSaveEditZoneModal","onCloseEditZoneModal","onZoomEditZoneModal","_rowData","isDefaultPathLength","changeSignalKindHandler","CHANGE_ZONE_SIGNAL_KIND","deleteZoneHandler","DELETE_2D_ZONE","zoomZoneHandler","xMargin","yMargin","SET_Y_DOMAIN","saveEditZoneHandler","SAVE_EDITED_ZONE","openEditZoneHandler","showUnlinkButton","setShowUnlinkButton","onHoverSignalX","onHoverSignalY","showUnlinkButtonSignalX","showUnlinkButtonSignalY","setShowUnlinkButtonSignalX","setShowUnlinkButtonSignalY","highlightSignalX","highlightSignalY","signalDeltaX","signalDeltaY","saveXHandler","CHANGE_ZONE_SIGNAL_VALUE","zoneID","saveYHandler","onHoverZoneX","onHoverZoneY","showUnlinkButtonZoneX","showUnlinkButtonZoneY","setShowUnlinkButtonZoneX","setShowUnlinkButtonZoneY","highlightZoneX","highlightZoneY","isOnZoneLevel","nuclei","xFrom","xTo","yFrom","yTo","getFilteredZones","_zones","unlinkZoneHandler","UNLINK_ZONE","visibilityHandler","MemoizedZonesPanel","ZonesPanelInner","databasePreferences","databaseDefaultValues","DatabasePreferences","overFlowStyle","names","enableRowSpan","smiles","onAdd","DatabaseTable","emptyKeywords","searchKeywords","handleChangeOption","useToolsFunctions","keywords","setKeywords","databaseInstance","databases","solvents","useAccordionContext","prevState","isOpen","mapDatabasesToSelect","getDatabasesNames","initiateDatabase","mapSolventsToSelect","getSolvents","prevResult","unshift","search","oldKeywords","handleChangeDatabase","databaseKey","resurrectHandler","RESURRECTING_SPECTRUM_FROM_RANGES","enableFilterHandler","tool","MemoizedDatabasePanel","DatabasePanelInner","testID","Table","mappedChildren","TableBody","getVAlign","TableHeader","TableHead","spectraCounter","activeFilterID","selectedFilterRef","handelFilterCheck","ENABLE_FILTER","handelDeleteFilter","DELETE_FILTER","DELETE_SPECTRA_FILTER","filterType","filterSnapShotHandler","newID","SET_FILTER_SNAPSHOT","getStyle","classes","filtersTableRow","ObjectInspector","isDeleteAllow","MemoizedFiltersTable","FiltersTableInner","filtersTable","FiltersTable","MemoizedFilterPanel","FilterPanelInner","onPredict","setMolecule","predictHandler","PredictionPreferences","accordionItems","hidePreferenceKey","PeaksPanel","RangesPanel","isExperimental","DatabasePanel","TOOLS_PANELS_ACCORDION","null","displayedMode","getPanelPreferences","usePanelPreferences","useCheckExperimentalFeature","panelOptions","isOpened","MemoizedPanels","PanelsInner","keysPreferences","overDisplayer","handleFullZoomOut","alignSpectrumsVerticallyHandler","changeDisplayViewModeHandler","useExport","allow1DTool","DELETE_EXCLUSION_ZONE","keysPreferencesListenerHandler","num","SET_KEY_PREFERENCES","keyCode","APPLY_KEY_PREFERENCES","toolsListenerHandler","checkSwitch","metaKey","ctrlKey","handleOnKeyDown","localName","assignmentReducer","assignmentState","version","versionInfo","startsWith","LIST","hideOpenOption","_nuclei","addNewNucleusFormatHandler","newFormat","newNuclei","nucleiList","WorkspaceItem","setName","addWorkspaceHandler","deleteWorkspaceHandler","onTextChange","Yup.lazy","Yup.ValidationError","useWorkspacesList","workspacesList","handleReset","addWorkSpaceHandler","deleteWorkSpaceHandler","ChangeWorkspaceHandler","LEFT","minMaxRatioRef","maxNumberOfPeaksRef","noiseFactor","lookNegativeRef","handleApplyFilter","AUTO_PEAK_PICKING","maxNumberOfPeaks","minMaxRatio","lookNegative","justifyItems","algorithmRef","algorithm","setAlgorithm","APPLY_BASE_LINE_CORRECTION_FILTER","handleCancelFilter","getAlgorithmsList","baselineAlgorithms","changeAlgorithmHandler","maxIterations","moreThan","initialValue","degree","valueRef","mouseDownCallback","mouseMoveCallback","mouseUpCallback","InputRange","phaseCorrectionTypes","manual","automatic","algorithms","ph0","ph1","ph0Ref","ph1Ref","phaseCorrectionType","setPhaseCorrectionType","APPLY_AUTO_PHASE_CORRECTION_FILTER","APPLY_MANUAL_PHASE_CORRECTION_FILTER","APPLY_ABSOLUTE_FILTER","calcPhaseCorrectionHandler","newValues","filedName","diff0","diff1","CALCULATE_MANUAL_PHASE_CORRECTION_FILTER","handleInput","handleRangeChange","MemoizedManualPhaseCorrectionPanel","ManualPhaseCorrectionPanelInner","hint","AUTO_RANGES_DETECTION","Sizes","sizeTextInputRef","lineBroadeningValue","setLineBroadeningValue","APPLY_ZERO_FILLING_FILTER","zeroFillingSize","getDefaultValue","log2","validity","valid","thresholdFactor","AUTO_ZONES_DETECTION","CHANGE_ZONES_NOISE_FACTOR","isFullscreen","onMaximize","selectedOptionPanel","hideGeneralSettings","selectedPanel","openGeneralSettingsHandler","openAboutUs","changeWorkspaceHandler","SvgLogoNmrium","docsBaseUrl","MemoizedHeader","HeaderInner","loadSubFilesFromZip","extractedfiles","uniqueFileExtensions","extension","selectedFilesByExtensions","FILES_TYPES","MOL","files","loadFilesFromZip","LOAD_MOL_FILE","NMRIUM","asBuffer","decoder","TextDecoder","binary","decode","LOAD_JSON_FILE","JDX","DX","LOAD_JCAMP_FILE","JDF","LOAD_JDF_FILE","loadFilesHandler","Set","loadFiles","fileSignature","getFileSignature","FILES_SIGNATURES","ZIP","unzipResult","Zip","loadAsync","zipFile","ex","hasBruker","brukerFile","endsWith","LOAD_ZIP_FILE","NMREDATA","LOAD_NMREDATA_FILE","onDrop","droppedFiles","getRootProps","getInputProps","isDragActive","openImportDialog","useDropzone","noClick","noKeyboard","types.SET_SELECTED_FILTER","types.SAVE_AS_SVG","types.SAVE_DATA_AS_JSON","listRef","translate","setTranslate","boxSize","oldTransform","placeholder","yup","publicationText","publicationStringHandler","GENERATE_SPECTRUM_FROM_PUBLICATION_STRING","allowedExtensions","onLoadClick","startLoading","pathReft","loadJCAMPHandler","extractFileMetaFromPath","loadFile","jcampURL","IMPORT_MENU","EXPORT_MENU","ftCounter","fidCounter","isExperimentalFeature","isButtonVisible","importMenu","isRealSpectrumShown","changeSpectrumViewHandler","LoadJacmpHandler","startLoadingHandler","importJCAMPFile","openImportPublicationStringModal","importHandler","SvgNmrOverlay3Aligned","SvgNmrOverlay3","isComplex","SvgNmrRealImag","SvgNmrAlignCenter","SvgNmrAlignBottom","MemoizedBasicToolBar","BasicToolBarInner","useDatumWithSpectraStatistics","toggleButton","_isActive","toggleButtons","setToggleButtons","handleOnChange","toggles","_toggles","_child","selectedOption","handleOnFFTFilter","APPLY_FFT_FILTER","SET_SELECTED_FILTER","selectedFilter","SvgNmrPeakPicking","SvgNmrMultipleAnalysis","SvgNmrZeroFilling","im","SvgNmrPhaseCorrection","SvgNmrBaselineCorrection","SvgNmrFourierTransform","MemoizedFunctionToolBar","FunctionToolBarInner","MemoizedToolBar","ToolBarInner","viewerContainerStyle","containerStyles","defaultPreferences","defaultData","ErrorOverlay","dataProp","onDataChange","useToggle","useFullscreen","spectrumReducer","initState","preferencesState","dispatchPreferences","preferencesReducer","initPreferencesState","checkActionType","actionType","dispatchMiddleWare","dispatchMiddleware","INITIATE","preventContextMenuHandler","mainDivRef","div","SET_MOUSE_OVER_DISPLAYER","ModalProvider","NMRium","searchKey","objectHelper","seData","setKey","searchDeep","callBackData","setCallBackData","dropFileHandler","dropfiles","dataChangeHandler","DropZone","TestHighlight","Test","ReactDOM","TestRoutes","getElementById"],"mappings":"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"}