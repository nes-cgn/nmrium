{"version":3,"mappings":"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","names":["createElement","MenuItem","cloneElement","sidebarCss","css","sidebarOpenCss","sidebarClosedCss","menuBtCss","logoCss","simpleTextCss","logoNormalCss","sidebarWrapperCss","props","routes","useMemo","buildMenu","subDisplay","menuIsClosed","display","padding","_jsx","onMenuToggle","Menu","e","history","push","Math","random","toString","replace","item","view","getKey","file","withRouter","memo","Sidebar","mainPanelCss","mainPanelOpenCss","mainPanelClosedCss","baseURL","routesList","mapTreeToFlatArray","setMenuIsClosed","useState","toggleMenu","useCallback","position","top","height","Suspense","map","prop","length","routeProp","viewName","RenderedView","possibleViews","match","params","id","width","marginLeft","marginRight","backgroundColor","routeProps","patrh","path","styles","bodyContainer","justifyContent","alignItems","container","borderRadius","fontSize","textAlign","normal","color","error","errorHeader","normalHeader","loadButton","border","fontWeight","cursor","url","response","fetch","checkStatus","data","json","console","ok","Error","status","statusText","Main","setRoutes","isLoaded","dashBoardType","setDashBoardType","loadHandler","getFileExtension","substring","lastIndexOf","href","window","location","useEffect","qs","URL","searchParams","has","sampleURL","get","extention","toLowerCase","loadData","then","remoteRoutes","_remoteRoutes","JSON","parse","stringify","_jsxs","AdminLayout","initialState","step","brush","start","end","startX","endX","startY","endY","BrushContext","createContext","children","className","style","onBrush","onZoom","onDoubleClick","onClick","noPropagation","state","dispatch","useReducer","reducer","mouseDownTime","setMouseDownTime","debounceClickEventsRef","useRef","mouseDownHandler","event","button","stopPropagation","type","shiftKey","altKey","screenX","screenY","clientX","clientY","boundingRect","currentTarget","getBoundingClientRect","timeStamp","clickHandler","persist","x","y","callback","lodashDebounce","current","lodashMap","debounce","cancel","handleMouseWheel","deltaY","deltaX","deltaMode","hypot","moveCallback","upCallback","action","startScreenX","startScreenY","startClientX","startClientY","MouseContext","MouseaProvider","Provider","useContext","mouseTrackerState","setMouseTrackerState","mouseMoveHandler","mouseLeaveHandler","name","isApplicable","equallySpaced","baselineRegression","mean","standardDeviation","enableFilter","getColor","merge","FiltersTypes.shiftX.id","FiltersManager.reapplyFilters","get1dColor","FiltersTypes.digitalFilter.id","FiltersManager.applyFilter","getRange","getSum","getNbAtoms","resetDiaIDs","setNbAtoms","Filters.shift2DX.id","Filters.shift2DY.id","mapZones","OCLMolecule","Data1DManager.fromParsedJcamp","Data2DManager.fromParsedJcamp","Datum1D.initiateDatum1D","Datum2D.initiateDatum2D","Data1DManager.fromCSD","Data2DManager.fromCSD","fromBruker","Data1DManager.fromBruker","Data2DManager.fromBruker","Datum1D.toJSON","Datum2D.toJSON","Molecule.toJSON","OCL","Filters.zeroFilling.id","Filters.zeroFilling.name","Filters.phaseCorrection.id","Filters.phaseCorrection.name","Jszip","scaleLinear","unlinkInAssignmentData","original","unlink","cloneDeep","Filters.shiftX.id","lodashCloneDeep","handleDeleteSignal1D","handleDeleteSignal2D","zoomIdentity","max","getYScale","Filters.lineBroadening.id","Filters.fft.id","Filters.absolute.id","autoPhaseCorrection","phaseCorrection","FiltersManager.enableFilter","update2dShift","FiltersManager.deleteFilter","Filters.baselineCorrection.id","Filters.exclusionZones.id","Filters.equallySpaced.id","MoleculeManager.fromJSON","MoleculeManager.addMolfile","MoleculeManager.setMolfile","removeAssignments","calculate","lodashGet","MultipleAnalysis.analyzeSpectra","MultipleAnalysis.deleteSpectraAnalysis","MultipleAnalysis.setColumn","MultipleAnalysis.changeColumnValueKey","types.INITIATE","SpectraManager.fromJSON","types.LOAD_JSON_FILE","types.LOAD_ZIP_FILE","SpectraManager.addBruker","types.LOAD_NMREDATA_FILE","types.PREDICT_SPECTRA","types.SET_LOADING_FLAG","LoadActions.setIsLoading","types.LOAD_JCAMP_FILE","types.LOAD_JDF_FILE","types.LOAD_MOL_FILE","types.ADD_PEAK","PeaksActions.addPeak","types.ADD_PEAKS","types.DELETE_PEAK_NOTATION","PeaksActions.deletePeak","types.ADD_INTEGRAL","types.DELETE_INTEGRAL","types.CHANGE_INTEGRAL_DATA","types.RESIZE_INTEGRAL","types.CHANGE_INTEGRAL_SUM","IntegralsActions.handleChangeIntegralSum","types.CHANGE_INTEGRALS_SUM_FLAG","types.CHANGE_INTEGRAL_RELATIVE","types.SET_ORIGINAL_DOMAIN","DomainActions.setOriginalDomain","types.SET_X_DOMAIN","DomainActions.setXDomain","types.SET_Y_DOMAIN","DomainActions.setYDomain","types.SET_WIDTH","types.SET_DIMENSIONS","types.SET_SELECTED_TOOL","types.RESET_SELECTED_TOOL","types.SET_SELECTED_OPTIONS_PANEL","ToolsActions.setSelectedOptionPanel","types.FULL_ZOOM_OUT","types.SHIFT_SPECTRUM","FiltersActions.shiftSpectrumAlongXAxis","types.APPLY_ZERO_FILLING_FILTER","FiltersActions.applyZeroFillingFilter","types.APPLY_FFT_FILTER","types.APPLY_MANUAL_PHASE_CORRECTION_FILTER","FiltersActions.applyManualPhaseCorrectionFilter","types.APPLY_AUTO_PHASE_CORRECTION_FILTER","types.APPLY_ABSOLUTE_FILTER","types.CALCULATE_MANUAL_PHASE_CORRECTION_FILTER","FiltersActions.calculateManualPhaseCorrection","types.ENABLE_FILTER","FiltersActions.enableFilter","types.DELETE_FILTER","types.DELETE_SPECTRA_FILTER","types.SET_FILTER_SNAPSHOT","types.APPLY_MULTIPLE_SPECTRA_FILTER","types.ADD_EXCLUSION_ZONE","types.DELETE_EXCLUSION_ZONE","types.CHANGE_VISIBILITY","types.CHANGE_PEAKS_MARKERS_VISIBILITY","SpectrumsActions.handleChangePeaksMarkersVisibility","types.CHANGE_ACTIVE_SPECTRUM","SpectrumsActions.handleChangeActiveSpectrum","types.CHANGE_SPECTRUM_COLOR","SpectrumsActions.handleChangeSpectrumColor","types.CHANGE_SPECTRUM_SETTING","types.ALIGN_SPECTRA","types.DELETE_SPECTRA","types.ADD_MISSING_PROJECTION","types.GENERATE_SPECTRUM_FROM_PUBLICATION_STRING","types.TOGGLE_REAL_IMAGINARY_VISIBILITY","types.SET_ZOOM","types.SET_SPECTRA_SAME_TOP","types.RESET_SPECTRA_SCALE","types.CHANGE_SPECTRUM_DISPLAY_VIEW_MODE","types.ADD_MOLECULE","MoleculeActions.addMoleculeHandler","types.SET_MOLECULE","MoleculeActions.setMoleculeHandler","types.DELETE_MOLECULE","types.FLOAT_MOLECULE_OVER_SPECTRUM","types.SET_CORRELATIONS_MF","CorrelationsActions.handleSetMF","types.SET_CORRELATIONS_TOLERANCE","CorrelationsActions.handleSetTolerance","types.SET_CORRELATION","CorrelationsActions.handleSetCorrelation","types.SET_CORRELATIONS","CorrelationsActions.handleSetCorrelations","types.DELETE_CORRELATION","CorrelationsActions.handleDeleteCorrelation","types.BRUSH_END","types.SET_VERTICAL_INDICATOR_X_POSITION","ToolsActions.setVerticalIndicatorXPosition","types.SET_SPECTRUMS_VERTICAL_ALIGN","types.AUTO_PEAK_PICKING","PeaksActions.handleAutoPeakPicking","types.AUTO_ZONES_DETECTION","ZonesActions.handleAutoZonesDetection","types.CHANGE_ZONES_NOISE_FACTOR","types.AUTO_RANGES_DETECTION","RangesActions.handleAutoRangesDetection","types.ADD_RANGE","types.DELETE_RANGE","types.DELETE_1D_SIGNAL","types.RESIZE_RANGE","types.CHANGE_RANGE_SUM","RangesActions.handleChangeRangeSum","types.CHANGE_RANGES_SUM_FLAG","types.CHANGE_RANGE_RELATIVE","types.CHANGE_RANGE_SIGNAL_VALUE","types.CHANGE_RANGE_SIGNAL_KIND","types.SAVE_EDITED_RANGE","types.UNLINK_RANGE","types.SET_DIAID_RANGE","types.CHANGE_TEMP_RANGE","types.SHOW_MULTIPLICTY_TREES","types.SHOW_RANGES_INTEGRALS","types.AUTO_RANGES_SPECTRA_PICKING","types.SHOW_J_GRAPH","types.SET_ACTIVE_TAB","ToolsActions.handelSetActiveTab","types.ADD_BASE_LINE_ZONE","ToolsActions.handleAddBaseLineZone","types.DELETE_BASE_LINE_ZONE","ToolsActions.handleDeleteBaseLineZone","types.APPLY_BASE_LINE_CORRECTION_FILTER","types.SET_KEY_PREFERENCES","types.APPLY_KEY_PREFERENCES","types.SET_2D_LEVEL","types.ADD_2D_ZONE","types.DELETE_2D_ZONE","types.DELETE_2D_SIGNAL","types.SET_2D_SIGNAL_PATH_LENGTH","types.RESET_DOMAIN","types.CHANGE_ZONE_SIGNAL_VALUE","types.CHANGE_ZONE_SIGNAL_KIND","types.UNLINK_ZONE","types.SET_DIAID_ZONE","types.AUTO_ZONES_SPECTRA_PICKING","types.SAVE_EDITED_ZONE","types.ANALYZE_SPECTRA","types.DELETE_ANALYZE_SPECTRA_RANGE","types.RESIZE_ANALYZE_SPECTRA_RANGE","types.SET_ANALYZE_SPECTRA_COLUMNS","types.FILTER_SPECTRA_COLUMN","types.RESURRECTING_SPECTRUM_FROM_RANGES","types.SET_AUTOMATIC_ASSIGNMENTS","types.SET_MOUSE_OVER_DISPLAYER","produce","ChartContext","ChartDataProvider","dispatchContext","DispatchProvider","LoaderContext","defaultLoader","LoaderProvider","isEmpty","emptyText","canOpenLoader","openLoader","useLoader","spinnerContext","defaultGetSpinner","SpinnerProvider","isLoading","undefined","useChartData","checkEmpty","startCheckEmpty","timeout","setTimeout","clearTimeout","getSpinner","Fragment","transformOrigin","left","zoom","allowTools","options","zeroFilling","peakPicking","integral","baseLineCorrection","rangesPicking","zone2D","slicingTool","editRange","multipleSpectraAnalysis","exclusionZones","databaseRangesSelection","BRUSH_TYPE","X","Y","XY","defaultDimensionBorder","brushType","dimensionBorder","widthProps","heightProps","toolOptions","selectedTool","includes","sign","scaleX","scaleY","transform","willChange","line","stroke","strokeOpacity","shapeRendering","strokeWidth","equalizerTool","margin","brushState","right","bottom","pointerEvents","overflow","GlobalConetxt","rootRef","elementsWrapperRef","viewerRef","GlobalProvider","initialPosition","onStart","onMove","onEnd","parentElement","dragHandleClassName","value","onMouseDown","useDraggable","AlertProvider","duration","defaultStyle","transitions","FADE","transition","opacity","SCALE","defaultTransitionStyles","entering","entered","exiting","exited","transitionStyles","ref","default","containerStyle","initialStyles","flexDirection","positions","TOP_LEFT","TOP_CENTER","TOP_RIGHT","MIDDLE_LEFT","MIDDLE","MIDDLE_RIGHT","BOTTOM_LEFT","BOTTOM_CENTER","BOTTOM_RIGHT","getStyles","wrapperRef","offset","root","timersId","alerts","setAlerts","document","timersIdRef","appendChild","forEach","removeChild","remove","alert","currentAlerts","lengthBeforeRemove","filteredAlerts","filter","a","onClose","show","message","substr","alertOptions","close","timerId","splice","indexOf","concat","onOpen","success","types","SUCCESS","ERROR","info","INFO","showLoading","PROGRESS_INDICATOR","Promise","resolve","closeHandler","alertsByPosition","groupBy","parentStyle","innerWidth","innerHeight","alertContextValue","createPortal","Object","keys","key","zIndex","Wrapper","Transition","minHeight","HighlightedSource","emptyState","highlight","highlights","highlighted","highlightedPermanently","sourceData","highlightContext","convertedHighlights","payload","extra","newState","highlightReducer","contextValue","Array","isArray","useHighlightData","newHighlights","String","isActive","some","isActivePermanently","hide","add","click","preventDefault","onHover","onMouseEnter","onMouseLeave","displayerMode","activeTab","nucleus","zones","ranges","useAlert","useDispatch","highlightData","assignments","useAssignmentData","activeAssignment","useAssignment","activated","ConcatenationString","onAtomHoverHighlights","setOnAtomHoverHighlights","onAtomHoverAction","setOnAtomHoverAction","DISPLAYER_MODE","DM_1D","values","DM_2D","assignedDiaIDs","assignedDiaID","assignment","assignedDiaIDsMerged","currentDiaIDsToHighlight","highlightID","temp","datum","findDatumAndSignalIndex","ZONE","RANGE","signals","signal","filterForIDsWithAssignment","diaIDs","flat","getCurrentDiaIDsToHighlight","toggleAssignment","diaID","atomInformation","toggleDiaIDs","handleOnClickAtom","atom","checkModifierKeyActivated","axis","extractFromAtom","nbAtoms","dimension","toggle","oclIDs","signalIndex","range","_diaIDs","_diaID","SET_DIAID_RANGE","rangeData","zone","SET_DIAID_ZONE","zoneData","setActive","handleOnAtomHover","getHighlightsOnHover","colorPalettes","base","shade","tint","danger","warning","medium","light","sizeConfig","xSmall","small","large","borderColor","fill","hover","size","basic","fillStyle","getFillStyle","colorStyle","active","Button","restProps","flex","colorTheme","buttonProps","Done","Danger","Action","onFloatBtnClick","molecule","index","useGlobal","useAtomAssignment","floatMoleculeHandler","FLOAT_MOLECULE_OVER_SPECTRUM","molfile","molecules","isFloat","MemoizedFloatMoleculeStructures","FloatMoleculeStructuresInner","emptyData","useSpectrum","lodashSet","Workspaces","lodashMerge","PreferencesContext","preferencesInitialState","PreferencesProvider","context","workspace","workspaces","usePreferences","currentWorkspaces","reduce","acc","label","WORKSPACES","spectrumID","xDomain","yDomain","contours","activeSpectrum","preferences","xShift","yShift","getShift","_scaleX","get2DXScale","_scaleY","get2DYScale","PathBuilder","element","lines","i","moveTo","lineTo","j","closePath","buildContourPath","displayerKey","isPositiveVisible","positiveColor","isNegativeVisible","negativeColor","MemoizedContours","ContoursInner","spectra","isFt","marignValue","spectrum","originHeight","yDomains","xyReduce","useXYReduce","XYReducerDomainAxis","YAxis","paths","get1DYScale","re","pathPoints","pathBuilder","mainHeight","Left1DChart","marginProps","originMargin","XAxis","Top1DChart","axisStyles","defaultMargin","tabActiveSpectrum","refAxis","xAxis","d3","ticks","tickFormat","call","_Fragment","lineStyle","deltas1D","setDeltas1D","split","_datum","isVisible","isSpectrum1D","deltas","_range","_signal","SignalKindsToInclude","_kind","kind","delta","indicationLines","_delta","highlightIDsX","buildID","highlightIDsY","highlightX","useHighlight","highlightY","Signal","buildIDs","isHighlighted","setIsHighlighted","_highlighted","peaks","peak","stylesOnHover","stylesHighlighted","Zone","assignmentZone","highlightZone","from","x1","to","x2","y1","y2","reduceOpacity","setReduceOpacity","checkZoneKind","setVisibility","on","prevVisiblity","MemoizedZones","ZonesInner","MemoizedChart2D","chart2DInner","layout","data1D","trackID","getLayoutID","nucleuses","formatX","formatY","useFormatNumberByNucleus","LAYOUT","TOP_1D","CENTER_2D","LEFT_1D","getRealYValue","cordinate","get1DDataXY","xIndex","xFindClosestIndex","invert","getXValue","getYValue","getRation","Number","MIN_VALUE","toFixed","getDeltaX","toPrecision","getLabel","label2d","labelld","getZValue","maxX","maxY","minX","minY","z","xStep","yStep","floor","yIndex","userSelect","HorizontalSliceChart","VerticalSliceChart","useMouseTracker","chart2d","scale2dX","scale2dY","getSlice","horizontal","vertical","spectrumData","n","find","isFid","DIMENSION","get2DDimensionLayout","handelBrushEnd","brushData","ADD_2D_ZONE","BRUSH_END","handelOnDoubleClick","FULL_ZOOM_OUT","handleZoom","SET_2D_LEVEL","SET_ZOOM","mouseClick","FooterBanner","SET_DIMENSIONS","scaleContext","scaleInitialState","ScaleProvider","scale","useScale","buttons","optionsHandler","handler","option","text","ModalContent","modal","onLayout","contentSize","Content","useSize","component","isFinite","modalRef","setModal","_modal","isBackgroundBlur","enableResizing","showConfirmDialog","dialogOptions","ConfirmDialog","addEventListener","keyHandler","removeEventListener","outerStyle","modalContextValue","contentLayoutHandler","updateSize","popup","whiteSpace","fontFamily","textShadow","mainContainer","popupPlacement","title","refChild","refContent","placement","setPlacement","showToolTip","useLayoutEffect","getPopupPlacement","childBounding","contentBounding","pl","mouseOverHandler","ToolTip","svg","popupTitle","CloseButton","loaderStyles","analysisData","setAnalysisData","calcStart","setCalcStartStatus","isCalcFinished","setCalcFinished","isSpectrum2D","fromIndex","toIndex","xGetFromToIndex","analysesProps","slice","result","analyseMultiplet","frequency","originFrequency","takeBestPartMultiplet","symmetrizeEachStep","debug","err","log","steps","d","xyToXYObject","multiplet","js","multiplicity","coupling","errorFunction","vAlign","useScaleChecked","EXCLUSION_ZONE","useActiveSpectrumStyleOptions","ExclusionZoneAnnotation","xDomains","verticalAlign","getExclusionZones","getVerticalShift","MemoizedPeakAnnotations","ExclusionZonesAnnotationsInner","useSpectraByActiveNucleus","filters","Filters","flag","currentPosition","prevPosition","activeRef","triggerEvent","fromEdge","anchorStyle","content","baseCss","useResizer","innerContainer","ceil","tag","resProps","integralData","INTEGRAL","handleOnStopResizing","RESIZE_INTEGRAL","handleOnEnterNotation","handleOnMouseLeaveNotation","useIntegralPath","integralSettings","integralDefaultValues","getValue","Integrals","integrals","tempData","_data","refText","isSelected","setIsSelected","_value","setValue","containerSize","setContainerSize","format","PEAK","handleOnPeakChange","SHIFT_SPECTRUM","shiftValue","textBox","getBBox","handleKeyDown","newValue","valueAsNumber","isNaN","oldValue","blur","handleChange","target","handleSelectPeakAnnotation","outline","paddingRight","Peaks","getVerticalAlign","findIndex","reSortData","sort","isPeaksMarkersVisible","DATABASE","fullHeight","blockHight","diff","abs","newForm","newTo","rangesToXY","nbPoints","domain","extent","accumulator","point","gridStyles","showGrid","mode","labelProp","refGrid","grid","tickSize","JGraphContext","maxValue","JGraphContextProvider","jGraphState","VerticalAxis","forwardRef","other","useLinearPrimaryTicks","useJGraph","links","generatePath","link","couplings","join","isOver","setOver","marginTop","JCouplingLinks","MemoizedJGraph","InnerJGraph","showJGraph","graphHeight","jGraphTolerance","_preferences","getRangeDefaultValues","jCouplingMax","generateJGraphData","maxRange","JGraphState","onDelete","common","Highlighted","columnKey","deleteHandler","DELETE_ANALYZE_SPECTRA_RANGE","colKey","resizeEndHandler","resized","RESIZE_ANALYZE_SPECTRA_RANGE","DeleteButton","spectraAnalysis","columns","MemoizedMultiAnalysisRanges","MultiAnalysisRangesInner","levelHeight","TREE_LEVEL_COLORS","showLabels","nodesData","signalID","labelOptions","buildTreeNodeAndEdge","_startX","ratio","multiplicityIndex","edgeLevel","_startYEdge","_startYNode","distance","node","assigned","rangeFrom","rangeTo","spectraData","extractID","SIGNAL","xRange","setXRange","treeProps","setTreeProps","drawInFullRange","setDrawInFullRange","setShowLabels","_drawInFullRange","checkMultiplicity","_treeWidth","_treeHeight","_treeLevelHeight","yMax","_x","treeNodesData","buildTreeNodesData","createTreeNodes","jIndices","_mult","hasCouplingConstant","_i","_xRange","_treeNodeData","multiplicityTree","firstLevelStartY","_startY","secondLevelStartY","_rangeFrom","_rangeTo","pathData","MemoizedTempMultiplicityTree","TempMultiplicityTreeInner","tempRange","showMultiplicityTrees","startEditMode","integration","assignmentData","assignmentRange","highlightRange","isBlockedByEditing","setIsBlockedByEditing","checkRangeKind","RESIZE_RANGE","mouseEnterHandler","assignHandler","editRangeID","showRangesIntegrals","MemoizedRanges","RangesInner","empyData","deleteRangeHandler","DELETE_BASE_LINE_ZONE","baseLineZones","xPosition","MemoizedFooterBanner","FooterBannerInner","colorIndicator","borderBottom","marginBottom","ToggleVisibility","off","trackers","radius","fillOpacity","SVGPadding","closePeakPosition","setPosition","vShift","align","getClosePeak","mouseCoordinates","b","maxIndex","number","minIndex","yDataRange","yValue","xValue","candidatePeakPosition","pivot","activeSpectrumData","xVal","xInvert","general","widthProp","heightProp","useModal","scaleState","dispatchScale","scaleReducer","SET_SCALE","propagateEvent","startXPPM","endXPPM","Events","emit","disableMultipletAnalysis","ADD_INTEGRAL","MAX_LENGTH","ADD_RANGE","ANALYZE_SPECTRA","ADD_PEAKS","ADD_BASE_LINE_ZONE","ADD_EXCLUSION_ZONE","zoomType","ZoomType","STEP_HORIZONTAL","xPPM","ADD_PEAK","SET_VERTICAL_INDICATOR_X_POSITION","header","textDecoration","body","stack","onDone","onCancel","doneLabel","cancelLabel","CheckBox","checked","checkProps","disabled","onChange","setCheck","handleCheck","reverse","checkbox","setFieldValue","useFormikContext","changeHandler","FormikForm","onSubmit","initialValues","validationSchema","lineHeight","inputWrapper","borderWidth","borderStyle","input","clearButton","aspectRatio","Input","debounceTime","onKeyDown","checkValue","enableAutoSelect","onBlur","onFocus","renderIcon","canClear","onClear","val","setVal","localRef","combinedRef","useCombinedRefs","debounceOnChange","select","formatValue","trim","onChangeHandler","pattern","test","check","preventPropagate","clearHandler","checkErrorAfterInputTouched","errors","touched","isInvalid","INITIAL_VALUE","compressed","pretty","dataExportOption","DataExportOptions","ROW_DATA","onSave","refForm","handleSave","submitForm","submitHandler","ModalStyles","DATA_SOURCE","saveAs","JSZip","jszip","saveToClipboardHandler","hideLoading","copyPNGToClipboard","saveAsJSONHandler","spaceIndent","isCompressed","fileName","exportedData","toJSON","exportAsJSON","handle","saveAsNMREHandler","nmriumToNmredata","exportAsNMRE","saveAsSVGHandler","saveAsPNGHandler","saveHandler","saveAsHandler","defaultValue","Toggle","toggleHandler","ToggleButton","counter","deleteToolTip","onFilter","filterToolTip","filterIsActive","counterFiltered","onSettingClick","showSettingButton","canDelete","DefaultPanelHeader","isToolVisible","useCheckToolsVisibility","automaticPickingHandler","AUTO_RANGES_SPECTRA_PICKING","AUTO_ZONES_SPECTRA_PICKING","SvgNmrRangePicking","setData","sourceElement","setSourceElement","contextMenuHandler","clickX","clickY","screenW","screenH","rootW","rootH","useImperativeHandle","handleContextMenu","_handleGlobalClick","wasOutside","isSameNode","c","ContextMenu","headerGroups","headerGroup","getHeaderGroupProps","headers","column","getHeaderProps","getSortByToggleProps","render","isSorted","isSortedDesc","ReactTableHeader","row","isConstantlyHighlighted","rowCss","highlightedSource","UNKNOWN","onContextMenu","isRowActive","getIDs","highlightStyle","getRowProps","cells","cell","isRowSpanned","rowSpan","getCellProps","ReactTableRow","table","enableVirtualScroll","ReactTableInner","onScroll","approxItemHeight","groupKey","highlightActiveRow","contextRef","indexBoundary","useReactTableContext","rowIndex","setRowIndex","getTableProps","getTableBodyProps","rows","prepareRow","rowSpanHeaders","useTable","useSortBy","useRowSpan","rowsData","overflowY","ReactTableStyle","prepareRowSpan","mRef","useMeasure","combineRef","tableVirtualConfig","setTableVirtualConfig","offsetHeight","scrollHeight","numberOfVisibleRows","prev","lookForGroupIndex","currentIndex","side","currentItem","findStartIndex","newIndex","currentIndx","findEndIndex","scrollHandler","scrollTop","ReactTable","SET_AUTOMATIC_ASSIGNMENTS","COLUMNS","Header","Cell","maxWidth","minWidth","accessor","SvgNmrAssignment","AutomaticAssignmentTable","getAssignmentsData","getAssignments","restAssignments","useAutoAssignments","tablePanelStyle","SvgNmrAssignment2","useFlexLayout","ReactTableFlexLayout","tableContainer","searchInput","meta","information","setInformation","matches","setMatchesData","searchRef","handleSearch","sortType","resizable","MemoizedInformationPanel","InformationPanelInner","tabid","tablabel","tabstyles","topStyles","leftStyles","PositionsEnum","onClickTabHandler","tab","contentChild","tabs","Children","child","isValidElement","Tabs","direction","loop","defaultIndex","activeIndex","setActiveIndex","Sliders","nextHandler","preActiveIndex","nextIndex","prevHandler","prevIndex","NextPrev","toolbarStyle","moleculeContainerStyle","setCurrentIndex","_index","slideIndex","mol","MF","mf","mw","getAtom","newSum","atoms","onChangeMoleculeSelectionHandler","sumOptions","panels","setOption","setActiveOption","SumSetOptions","formRef","onTabChangeHandler","sumAuto","hideSetSumFromMolecule","structuresPanel","hidden","moleculeKey","setValues","sum","Yup","required","SaveButton","PreferencesHeader","onEditStart","editStatus","enabled","enableEdit","startEdit","closeEdit","mouseClickCallback","classList","contains","editModeHandler","EditableColumn","arrowDownIcon","Select","placeholder","handleOnChanged","selectStyle","deleteIntegralHandler","DELETE_INTEGRAL","integralID","changeIntegralDataHandler","CHANGE_INTEGRAL_DATA","initialColumns","SignalKinds","saveRelativeHandler","CHANGE_INTEGRAL_RELATIVE","integralsPreferences","showWhen","formatNumber","absolute","absoluteFormat","relativeFormat","checkIntegralKind","tableColumns","col","colParams","addCustomColumn","object1","object2","IntegralTable","onColorChange","displayColorPicker","showColorPicker","selectedColor","setColor","handleClick","handleClose","handleOnColorChanged","colorEvent","hex","round","rgb","ChromePicker","ColorInput","colorPickerProps","colorChangeHandler","FormikColorPicker","inputLabel","checkControllerName","formatControllerName","disableFormat","hideFormat","checkChangeHandler","FormikColumnFormatField","inputContainer","NumberInput","onInput","min","changeHander","checkValidity","_ref","groupContainer","paddingBottom","formatFields","checkController","formatController","innerRef","updateValues","integralPreferences","getValueByKeyPath","defaultValues","nucleusLabel","assign","saveSetting","field","MemoizedIntegralsPreferences","IntegralsPreferencesInner","useNucleus","IntegralsPreferences","setFilterIsActive","isFlipped","setFlipStatus","settingRef","yesHandler","handleDeleteAll","changeIntegralSumHandler","CHANGE_INTEGRAL_SUM","currentSum","showChangeIntegralSumModal","settingsPanelHandler","saveSettingHandler","handleOnFilter","toggleConstantSumHandler","CHANGE_INTEGRALS_SUM_FLAG","filteredData","factor","_integrals","isInRange","SvgNmrSum","MemoizedIntegralPanel","IntegralPanelInner","wrapper","numberOfPoints","EquallySpacedFilter","FromToFilter","baseList","setFilter","List","list","REFERENCES","entries","APPLY_MULTIPLE_SPECTRA_FILTER","filterChangeHandler","filterOptions","openFiltersModal","RESET_SELECTED_TOOL","openExportAsMatrixModal","SvgNmrAddFilter","SvgNmrExportAsMatrix","selectedMolecule","setMolfile","cb","newMolfile","molText","exec","groups","SET_MOLECULE","ADD_MOLECULE","menuStyles","icon","items","boxBounding","toolTip","menuButtonRef","isShown","showMenu","closeMenuButton","boxSizing","MenuList","othersProps","__html","listStyle","getErrors","errorObj","obj","errorsIterators","isValid","errorList","errorText","FormikSelect","NUMBER_OF_POINTS_1D","generateNumbersPowerOfX","NUMBER_OF_POINTS_2D","predictionFormValidation","shape","integer","lineWidth","proton","carbon","cosy","hsqc","hmbc","isApproved","setApproved","predictionPreferences","setPredictionPreferences","useStateWithLocalStorage","predictionIndex","initValues","isAgree","defaultPredictionOptions","SET_LOADING_FLAG","predictedSpectra","PREDICT_SPECTRA","approveCheckHandler","FREQUENCIES","paddingLeft","MOL_EXPORT_MENU","onMoleculeIndexChange","onOpenMoleculeEditor","actionsOptions","saveAsMolHandler","copyTextToClipboard","exportHandler","handlePaste","navigator","clipboard","readText","handleDelete","DELETE_MOLECULE","openPredictSpectraModal","hideExport","hidePast","hideAdd","hideDelete","hidePredict","SvgNmrFt","panel","flexGrow","innerPanel","toolbar","slider","moleculesProp","onMoleculeChange","setMolecules","prevMolecules","handleReplaceMolecule","openMoleculeEditorHandler","moleculeIndexHandler","MemoizedMoleculePanel","MoleculePanelInner","ALIGN_SPECTRA","optionChangeHandler","resValues","targetX","nbPeaks","initCode","code","setCode","setResult","evalResult","Eval","maxHeight","MultipleAnalysisCodeEditor","onAfterSave","setColumns","tempKey","columnsKeys","preferncesSchema","colmnName","formData","COLUMNS_TYPES","FORMULA","formula","object","columnSchema","SET_ANALYZE_SPECTRA_COLUMNS","addNewColumn","prevData","valueKey","MultipleSpectraAnalysisPreferences","ul","li","onSelect","renderItem","containerRect","selectedKey","formatSelectedValue","open","setOpen","setItem","drop","selectHandler","columnsFilters","COLUMNS_VALUES_KEYS","RELATIVE","ABSOLUTE","MIN","MAX","charLabel","rangeLabel","onColumnFilter","NORMAL","codeEvaluation","columnFilterHandler","FILTER_SPECTRA_COLUMN","columnData","columnIndex","cellHandler","headerHandler","MultipleSpectraAnalysisTable","afterSaveHandler","showTrackerHandler","openAlignSpectra","copyToClipboardHandler","getDataAsString","SvgNmrOverlay","MemoizedMultipleSpectraAnalysisPanel","MultipleSpectraAnalysisPanelInner","peaksDefaultValues","peaksPreferences","MemoizedPeaksPreferences","PeaksPreferencesInner","PeaksPreferences","deletePeakHandler","DELETE_PEAK_NOTATION","saveDeltaPPMRefsHandler","parseFloat","peakIndexFormat","valueHz","deltaHzFormat","intensity","intensityFormat","peakWidth","peakWidthFormat","PeaksTable","filteredPeaks","_peaks","next","MemoizedPeaksPanel","PeaksPanelInner","onCopyClick","onUnlink","onFilterActivated","isFilterActive","filterCounter","changeRangesSumHandler","CHANGE_RANGE_SUM","showChangeRangesSumModal","handleOnRemoveAssignments","DELETE_RANGE","handleSetShowMultiplicityTrees","SHOW_MULTIPLICTY_TREES","handleShowIntegrals","SHOW_RANGES_INTEGRALS","handleShowJGraph","SHOW_J_GRAPH","copyHTMLToClipboard","saveAsHTMLHandler","observedFrequency","nbDecimalDelta","getNumberOfDecimals","ppm","nbDecimalJ","hz","rangesToACS","changeSumConstantFlagHandler","CHANGE_RANGES_SUM_FLAG","SvgNmrIntegrate","rangesPreferences","MemoizedRangesPreferences","RangesPreferencesInner","RangesPreferences","config","sortConfig","setSortConfig","sortedItems","sortableItems","SortType","sortHandler","columnName","defaultContent","onSort","rowSpanTags","onHoverRange","FormatNumber","FormikOnChange","enableValidation","inputInfo","infoText","signalContainer","addSignalBtn","newSignal","newSignalDelta","translateMultiplet","_signals","validation","createError","errorMessage","triggerSubmitHandler","AddSignalFormTab","_coupling","CouplingsTableStyle","multiplicityChangeHandler","multipletsList","Multiplets","CouplingsTable","SignalFormTabStyle","SignalFormTab","textStyles","tabStylesAddition","tabStyles","newSignalFormRef","activeField","setActiveField","handleOnFocus","tapClickHandler","handleDeleteSignal","tabContainsErrors","signalFormTabs","signalTabs","addSignalTab","editSignalInfoText","addSignalInfoText","noSignals","noCouplings","SignalsForm","useValidation","Yup.array","Yup.object","Yup.string","Yup.mixed","onSaveEditRangeModal","onCloseEditRangeModal","onZoomEditRangeModal","automaticZoom","useRangeFormValidation","handleOnZoom","handleOnClose","getCouplings","getSignals","generateID","handleOnSave","formValues","counterJ","_multiplicity","CHANGE_TEMP_RANGE","zoomRange","SET_X_DOMAIN","deleteRange","changeRangeSignalKind","CHANGE_RANGE_SIGNAL_KIND","rowData","saveEditRangeHandler","editedRowData","SAVE_EDITED_RANGE","closeEditRangeHandler","SET_SELECTED_TOOL","selectBoxStyle","onHoverSignal","useEditRangeModal","tableMetaInfo","spanStyle","onUnlinkVisibilityChange","unlinkVisibility","onLink","visibilityChangeHandler","spanCss","visibility","RangeAssignmentsColumn","RangeColumn","integralVal","formattedValue","CHANGE_RANGE_RELATIVE","tdCss","SignalAssignmentsColumn","useFormat","CHANGE_RANGE_SIGNAL_VALUE","rangeID","HighlightedRowStyle","ConstantlyHighlightedRowStyle","highlightRangeAssignmentsColumn","assignmentSignal","highlightSignal","unlinkRangeButtonVisibility","showUnlinkRangeButton","unlinkSignalButtonVisibility","showUnlinkSignalButton","getFormat","unlinkHandler","isOnRangeLevel","removeAll","linkHandler","onHoverRangeAssignmentsColumn","trCss","isColumnVisible","SignalDeltaColumn","ActionsColumn","tableStyle","tableData","sortedData","useTableSortBy","useMapRanges","rowKey","rangesData","isInView","getFilteredRanges","_ranges","unlinkRangeHandler","UNLINK_RANGE","saveJSONToClipboardHandler","dataToClipboard","contextMenu","filterHandler","MemoizedRangesTablePanel","RangesTablePanelInner","spectrums","DELETE_SPECTRA","showAllSpectrumsHandler","spectrumsPerTab","CHANGE_VISIBILITY","hideAllSpectrumsHandler","addMissingProjectionHandler","SpectrumsData","missingNucleus","hasSpectrums","getMissingProjection","ADD_MISSING_PROJECTION","setSameTopHandler","SET_SPECTRA_SAME_TOP","resetScaleHandler","RESET_SPECTRA_SCALE","SvgNmrResetScale","SvgNmrSameTop","MemoizedSpectraPanelHeader","SpectraPanelHeaderInner","ColorIndicator","onChangeMarkersVisibility","markersVisible","isMarkerVisible","v","SvgNmrPeaks","onChangeVisibility","alignContent","textOverflow","onChangeActiveSpectrum","onOpenSettingModal","formatValueAsHTML","SvgNmrFid","SvgNmr2D","solvent","borderLeft","experiment","pulse","SpectrumListItem","colorchangeHandler","SketchPicker","COLORS","yLogBase","hideHeading","sanPlot","strokeDasharray","processedData","processSnapPlot","Spectrum1DHistogram","SpectrumData","gap","onAfterChange","sliderProps","ReactSlider","valueNow","FormikSlider","paddingTop","borderTop","Spectrum2DHistogram","CHANGE_SPECTRUM_SETTING","SpectrumSetting","arePropsEqual","onTabChange","setMarkersVisible","selectedSpectrumData","setSelectedSpectrum","settingModalPosition","setSettingModalPosition","isSettingModalDisplayed","setIsSettingModalDisplayed","visibleMarkers","spectrumsGroupByNucleus","groupByNucleus","GroupByInfoKey","handleChangeMarkersVisibility","newChecked","CHANGE_PEAKS_MARKERS_VISIBILITY","SET_ACTIVE_TAB","openSettingHandler","selectedSpectrum","nativeEvent","handleChangeVisibility","handleChangeActiveSpectrum","CHANGE_ACTIVE_SPECTRUM","group","MemoizedSpectra","SpectrumsTabsInner","setSpectrums","tabChangeHandler","SpectraPanelHeader","SpectrumListPanel","description","onConfirm","handleOnConfirm","editPathLengthsStyles","experimentType","onEdit","setFrom","pathLength","DefaultPathLengths","setTo","isError","setIsError","handleOnEdit","editedSignal","moveLinkStyles","correlationDim1","correlationDim2","correlations","selectedCorrelationIdDim1","setSelectedCorrelationIdDim1","selectedCorrelationIdDim2","setSelectedCorrelationIdDim2","correlation","getCorrelationDelta","getSelection","dim","selectionData","arr","_correlation","pseudo","atomType","origin","getCorrelationLabel","selection","modalContainer","setActiveTab","getLinkLabel","linkDim","getLinkDim","editedLink","editedCorrelations","buildCorrelationDataOptions","getEditedCorrelations","tabsContainer","TOP","correlationIdDim1","correlationIdDim2","toUpperCase","correlationsData","highlightIDsAdditionalColumn","ids","_id","findRangeOrZoneID","experimentID","highlightAdditionalColumn","focus","IsInView","tableHeaderProps","getLabelColor","equivalenceTextStyle","edited","equivalence","isInteger","moved","thProps","rowCorrelation","columnCorrelation","commonLinks","highlightIDsCommonLinks","highlightCommonLinks","handleEditPseudoHSQC","pseudoLinkCountHSQC","_link","_correlationDim1","_correlationDim2","commonPseudoLink","buildLink","cloneCorrelationAndEditLink","protonsCount","skipDataUpdate","commonLinksMenu","commonLink","commonLinkContextMenuLabel","getAbbreviation","commonPseudoLinkHSQC","contentLabel","isInViewRow","isInViewColumn","additionalColumnData","styleRow","styleLabel","onSaveEditEquivalences","onSaveEditNumericValues","onEditCorrelationTableCellHandler","highlightIDsRow","highlightRow","onSaveEquivalencesHandler","onSaveEditNumericValuesHandler","convertValuesString","additionalColumnFields","_commonLink","experimentLabel","equivalenceCellStyle","tableDataProps","otherTableDataProps","t","borderRight","hybridization","hybrid","filteredCorrelationsData","editEquivalencesSaveHandler","showProtonsAsRows","additionalColumnHeader","getAtomCounts","elements","stateAtomType","errorColorIndex","Errors","_error","complete","ErrorColors","fontStyle","Overview","inputStyle","previousMF","setMF","isValidMF","setIsValidMF","hasChanged","setHasChanged","checkMF","getAtomsFromMF","onSaveHandler","onSaveHandlerMolecularFormulaInput","onSaveHandlerMoleculeSelection","onChangeHandlerMoleculeSelection","previousTolerance","tolerance","setTolerance","setIsValid","_isValid","panelStyle","setAdditionalColumnData","selectedAdditionalColumnsAtomType","setSelectedAdditionalColumnsAtomType","setShowProtonsAsRows","atomTypesInView","getAtomType","xDomain0","xDomain1","yDomain0","yDomain1","firstLink1D","getLinkDelta","findSpectrum","findSignalMatch1D","firstLink2D","findSignalMatch2D","_values","handleOnSetMolecularFormula","SET_CORRELATIONS_MF","handleOnSetShiftTolerance","SET_CORRELATIONS_TOLERANCE","showSetMolecularFormulaModal","showSetShiftToleranceModal","additionalColumnTypes","columnTypes","array","columnType","_selectedAdditionalColumnsAtomType","SET_CORRELATION","editNumericValuesSaveHandler","setCorrelationsHandler","SET_CORRELATIONS","deleteCorrelationHandler","DELETE_CORRELATION","deleteSignalHandler","findRange","findSignal1D","DELETE_1D_SIGNAL","findZone","findSignal2D","DELETE_2D_SIGNAL","changeSignalPathLengthHandler","SET_2D_SIGNAL_PATH_LENGTH","editCorrelationTableCellHandler","SummaryPanel","zoneDefaultValues","zonesPreferences","MemoizedZonesPreferences","ZonesPreferencesInner","ZonesPreferences","Yup.number","onSaveEditZoneModal","onCloseEditZoneModal","onZoomEditZoneModal","_rowData","isDefaultPathLength","changeSignalKindHandler","CHANGE_ZONE_SIGNAL_KIND","deleteZoneHandler","DELETE_2D_ZONE","zoomZoneHandler","xMargin","yMargin","SET_Y_DOMAIN","saveEditZoneHandler","SAVE_EDITED_ZONE","openEditZoneHandler","showUnlinkButton","setShowUnlinkButton","onHoverSignalX","onHoverSignalY","showUnlinkButtonSignalX","showUnlinkButtonSignalY","setShowUnlinkButtonSignalX","setShowUnlinkButtonSignalY","highlightSignalX","highlightSignalY","signalDeltaX","signalDeltaY","saveXHandler","CHANGE_ZONE_SIGNAL_VALUE","zoneID","saveYHandler","onHoverZoneX","onHoverZoneY","showUnlinkButtonZoneX","showUnlinkButtonZoneY","setShowUnlinkButtonZoneX","setShowUnlinkButtonZoneY","highlightZoneX","highlightZoneY","isOnZoneLevel","nuclei","xFrom","xTo","yFrom","yTo","getFilteredZones","_zones","unlinkZoneHandler","UNLINK_ZONE","visibilityHandler","MemoizedZonesPanel","ZonesPanelInner","databasePreferences","databaseDefaultValues","DatabasePreferences","overFlowStyle","names","enableRowSpan","idCode","coordinates","ocl","smiles","onAdd","DatabaseTable","emptyKeywords","searchKeywords","handleChangeOption","useToolsFunctions","databases","useDatabases","keywords","setKeywords","databaseInstance","solvents","prevState","mapSolventsToSelect","getSolvents","prevResult","unshift","search","oldKeywords","handleChangeDatabase","databaseIndex","_database","initiateDatabase","prepareData","resurrectHandler","RESURRECTING_SPECTRUM_FROM_RANGES","enableFilterHandler","tool","mapDatabasesToSelect","MemoizedDatabasePanel","DatabasePanelInner","testID","Table","mappedChildren","TableBody","getVAlign","TableHeader","TableHead","spectraCounter","activeFilterID","selectedFilterRef","handelFilterCheck","ENABLE_FILTER","handelDeleteFilter","DELETE_FILTER","DELETE_SPECTRA_FILTER","filterType","filterSnapShotHandler","newID","SET_FILTER_SNAPSHOT","getStyle","classes","filtersTableRow","ObjectInspector","isDeleteAllow","MemoizedFiltersTable","FiltersTableInner","filtersTable","FiltersTable","MemoizedFilterPanel","FilterPanelInner","onPredict","setMolecule","predictHandler","PredictionPreferences","accordionItems","hidePreferenceKey","PeaksPanel","RangesPanel","isExperimental","DatabasePanel","TOOLS_PANELS_ACCORDION","null","displayedMode","getPanelPreferences","usePanelPreferences","useCheckExperimentalFeature","panelOptions","isOpened","MemoizedPanels","PanelsInner","keysPreferences","overDisplayer","handleFullZoomOut","alignSpectrumsVerticallyHandler","changeDisplayViewModeHandler","useExport","allow1DTool","DELETE_EXCLUSION_ZONE","keysPreferencesListenerHandler","num","SET_KEY_PREFERENCES","keyCode","APPLY_KEY_PREFERENCES","toolsListenerHandler","checkSwitch","metaKey","ctrlKey","tags","tagName","composedPath","handleOnKeyDown","checkNotInputField","hidePanelOnLoad","assignmentReducer","assignmentState","version","versionInfo","startsWith","addButton","th","labelCol","serialCol","currentWorkspace","addNewDatabaseHandler","newDatabase","resetDatabaseHandler","database","LIST","hideOpenOption","_nuclei","addNewNucleusFormatHandler","newFormat","newNuclei","nucleiList","WorkspaceItem","setName","addWorkspaceHandler","deleteWorkspaceHandler","onTextChange","Yup.ValidationError","Yup.lazy","useWorkspacesList","workspacesList","handleReset","addWorkSpaceHandler","deleteWorkSpaceHandler","ChangeWorkspaceHandler","LEFT","minMaxRatioRef","maxNumberOfPeaksRef","noiseFactor","lookNegativeRef","handleApplyFilter","AUTO_PEAK_PICKING","maxNumberOfPeaks","minMaxRatio","lookNegative","justifyItems","algorithmRef","algorithm","setAlgorithm","APPLY_BASE_LINE_CORRECTION_FILTER","handleCancelFilter","getAlgorithmsList","baselineAlgorithms","changeAlgorithmHandler","maxIterations","moreThan","initialValue","degree","previousPosition","valueRef","mouseDownCallback","mouseMoveCallback","mouseUpCallback","InputRange","phaseCorrectionTypes","manual","automatic","algorithms","ph0","ph1","ph0Ref","ph1Ref","phaseCorrectionType","setPhaseCorrectionType","APPLY_AUTO_PHASE_CORRECTION_FILTER","APPLY_MANUAL_PHASE_CORRECTION_FILTER","APPLY_ABSOLUTE_FILTER","calcPhaseCorrectionHandler","newValues","filedName","diff0","diff1","CALCULATE_MANUAL_PHASE_CORRECTION_FILTER","handleInput","handleRangeChange","MemoizedManualPhaseCorrectionPanel","ManualPhaseCorrectionPanelInner","hint","AUTO_RANGES_DETECTION","Sizes","sizeTextInputRef","lineBroadeningValue","setLineBroadeningValue","APPLY_ZERO_FILLING_FILTER","zeroFillingSize","getDefaultValue","log2","validity","valid","thresholdFactor","AUTO_ZONES_DETECTION","CHANGE_ZONES_NOISE_FACTOR","isFullscreen","onMaximize","selectedOptionPanel","hideGeneralSettings","selectedPanel","openGeneralSettingsHandler","openAboutUs","changeWorkspaceHandler","SvgLogoNmrium","docsBaseUrl","MemoizedHeader","HeaderInner","loadSubFilesFromZip","extractedfiles","uniqueFileExtensions","extension","selectedFilesByExtensions","FILES_TYPES","MOL","files","loadFilesFromZip","LOAD_MOL_FILE","NMRIUM","asBuffer","decoder","TextDecoder","binary","decode","LOAD_JSON_FILE","JDX","DX","LOAD_JCAMP_FILE","JDF","LOAD_JDF_FILE","loadFilesHandler","Set","loadFiles","fileSignature","getFileSignature","FILES_SIGNATURES","ZIP","unzipResult","Zip","loadAsync","zipFile","isNotZip","ex","hasBruker","brukerFile","endsWith","LOAD_ZIP_FILE","NMREDATA","LOAD_NMREDATA_FILE","onDrop","droppedFiles","getRootProps","getInputProps","isDragActive","openImportDialog","useDropzone","noClick","noKeyboard","types.SET_SELECTED_FILTER","types.SAVE_AS_SVG","types.SAVE_DATA_AS_JSON","listRef","translate","setTranslate","boxSize","oldTransform","yup","publicationText","publicationStringHandler","GENERATE_SPECTRUM_FROM_PUBLICATION_STRING","allowedExtensions","onLoadClick","startLoading","pathReft","loadJCAMPHandler","extractFileMetaFromPath","loadFile","jcampURL","IMPORT_MENU","EXPORT_MENU","ftCounter","fidCounter","isExperimentalFeature","isButtonVisible","importMenu","isRealSpectrumShown","changeSpectrumViewHandler","LoadJacmpHandler","startLoadingHandler","importJCAMPFile","openImportPublicationStringModal","importHandler","SvgNmrOverlay3","isComplex","SvgNmrRealImag","SvgNmrAlignBottom","MemoizedBasicToolBar","BasicToolBarInner","useDatumWithSpectraStatistics","toggleButton","_isActive","toggleButtons","setToggleButtons","handleOnChange","_toggles","toggles","_child","selectedOption","handleOnFFTFilter","APPLY_FFT_FILTER","SET_SELECTED_FILTER","selectedFilter","SvgNmrPeakPicking","SvgNmrMultipleAnalysis","SvgNmrZeroFilling","im","SvgNmrPhaseCorrection","SvgNmrBaselineCorrection","SvgNmrFourierTransform","MemoizedFunctionToolBar","FunctionToolBarInner","MemoizedToolBar","ToolBarInner","viewerContainerStyle","containerStyles","defaultPreferences","defaultData","ErrorOverlay","dataProp","onDataChange","useToggle","useFullscreen","spectrumReducer","initState","preferencesState","dispatchPreferences","preferencesReducer","initPreferencesState","checkActionType","actionType","dispatchMiddleWare","dispatchMiddleware","INITIATE","preventContextMenuHandler","mainDivRef","div","SET_MOUSE_OVER_DISPLAYER","ModalProvider","NMRium","searchKey","objectHelper","seData","setKey","searchDeep","callBackData","setCallBackData","dropFileHandler","dropfiles","dataChangeHandler","DropZone","TestHighlight","lazy","Test","rootElement","getElementById","createRoot","TestRoutes"],"sources":["../../vite/modulepreload-polyfill","../../src/demo/utility/menu.ts","../../src/demo/Sidebar.tsx","../../vite/preload-helper","../../src/demo/views/index.ts","../../src/demo/layouts/Admin.tsx","../../src/demo/layouts/SingleDisplayerLayout.tsx","../../src/demo/layouts/Main.tsx","../../src/data/utilities/checkModifierKeyActivated.ts","../../src/data/data1d/Spectrum1D/ranges/detectSignal.ts","../../src/component/EventsTrackers/BrushTracker.tsx","../../src/component/EventsTrackers/MouseTracker.tsx","../../src/data/constants/SignalsKinds.ts","../../src/data/data1d/filter1d/absolute.ts","../../src/data/data1d/filter1d/autoPhaseCorrection.ts","../../src/data/data1d/filter1d/baselineCorrection.ts","../../src/data/data1d/filter1d/centerMean.ts","../../src/data/data1d/filter1d/digitalFilter.ts","../../src/data/data1d/filter1d/equallySpaced.ts","../../src/data/data1d/filter1d/exclusionZones.ts","../../src/data/data1d/filter1d/fft.ts","../../src/data/data1d/filter1d/fromTo.ts","../../src/data/data1d/filter1d/lineBroadening.ts","../../src/data/data1d/filter1d/pareto.ts","../../src/data/data1d/filter1d/phaseCorrection.ts","../../src/data/data1d/filter1d/shiftX.ts","../../src/data/data1d/filter1d/standardDeviation.ts","../../src/data/data1d/filter1d/zeroFilling.ts","../../src/data/data2d/filter2d/shiftX.ts","../../src/data/data2d/filter2d/shiftY.ts","../../src/data/utilities/generateID.ts","../../src/data/FiltersManager.ts","../../src/data/utilities/getColor.ts","../../src/data/data1d/Spectrum1D/integrals/initiateIntegrals.ts","../../src/data/data1d/Spectrum1D/getSpectrumErrorValue.ts","../../src/data/data1d/Spectrum1D/shift/getShiftX.ts","../../src/data/data1d/Spectrum1D/peaks/mapPeaks.ts","../../src/data/data1d/Spectrum1D/peaks/initiatePeaks.ts","../../src/data/data1d/Spectrum1D/ranges/mapRanges.ts","../../src/data/data1d/Spectrum1D/ranges/initiateRanges.ts","../../src/data/data1d/Spectrum1D/initiateDatum1D.ts","../../src/data/data1d/Spectrum1D/ranges/generateSpectrumFromRanges.ts","../../src/data/data1d/Spectrum1D/generateSpectrumFromPublicationString.ts","../../src/data/data1d/Spectrum1D/get1DDataXY.ts","../../src/data/constants/References.ts","../../src/data/data1d/Spectrum1D/getReferenceShift.ts","../../src/data/data1d/Spectrum1D/integrals/changeIntegralsRelative.ts","../../src/data/data1d/Spectrum1D/integrals/checkIntegralKind.ts","../../src/data/utilities/getSum.ts","../../src/data/data1d/Spectrum1D/integrals/updateRelatives.ts","../../src/data/data1d/Spectrum1D/integrals/updateIntegralsRelativeValues.ts","../../src/data/data1d/Spectrum1D/isSpectrum1D.ts","../../src/data/data1d/Spectrum1D/peaks/autoPeakPicking.ts","../../src/data/data1d/Spectrum1D/peaks/lookupPeak.ts","../../src/data/utilities/getAtom.ts","../../src/data/data1d/Spectrum1D/SumManager.ts","../../src/data/utilities/RangeUtilities.ts","../../src/data/data1d/Spectrum1D/ranges/checkRangeKind.ts","../../src/data/data1d/Spectrum1D/ranges/updateRangesRelativeValues.ts","../../src/data/data1d/Spectrum1D/ranges/addRange.ts","../../src/data/data1d/Spectrum1D/ranges/changeRange.ts","../../src/data/data1d/Spectrum1D/ranges/changeRangeRelativeValue.ts","../../src/data/data1d/Spectrum1D/ranges/changeRangeSignal.ts","../../src/data/data1d/Spectrum1D/ranges/detectRange.ts","../../src/data/data1d/Spectrum1D/ranges/autoRangesDetection.ts","../../src/data/data1d/Spectrum1D/ranges/detectRanges.ts","../../src/data/data1d/Spectrum1D/shift/internal/updateIntegralXShift.ts","../../src/data/data1d/Spectrum1D/shift/internal/updatePeaksXShift.ts","../../src/data/data1d/Spectrum1D/shift/internal/updateRangesXShift.ts","../../src/data/data1d/Spectrum1D/shift/updateXShift.ts","../../src/component/reducer/core/Constants.ts","../../src/data/data1d/Data1DManager.ts","../../src/data/data2d/Spectrum2D/getMissingProjection.ts","../../src/data/data2d/Spectrum2D/getSlice.ts","../../src/data/data2d/Processing2D.ts","../../src/data/data2d/Spectrum2D/initiateDatum2D.ts","../../src/data/data2d/Spectrum2D/isSpectrum2D.ts","../../src/data/data2d/Spectrum2D/shift/getShift.ts","../../src/data/data2d/Spectrum2D/shift/updateShift.ts","../../src/data/data2d/Spectrum2D/toJSON.ts","../../src/data/data2d/Spectrum2D/zones/changeZoneSignal.ts","../../src/data/data2d/Spectrum2D/zones/getDetectionZones.ts","../../src/data/data2d/Spectrum2D/zones/detectZones.ts","../../src/data/data2d/Spectrum2D/zones/detectZonesManual.ts","../../src/data/data2d/Data2DManager.ts","../../src/data/migration/changeKeys.ts","../../src/data/migration/migrateToVersion1.ts","../../src/data/migration/migrateToVersion2.ts","../../src/data/migration/MigrationManager.ts","../../src/data/utilities/getAtomsFromMF.ts","../../src/data/molecules/Molecule.ts","../../src/data/SpectraManager.ts","../../src/data/data1d/Spectrum1D/toJSON.ts","../../src/data/PredictionManager.ts","../../src/component/panels/SummaryPanel/CorrelationTable/Constants.ts","../../src/component/toolbar/ToolTypes.ts","../../src/component/utility/util/nmredata/addRanges.ts","../../src/component/utility/util/nmredata/addZones.ts","../../src/component/utility/nmredataToNmrium.ts","../../src/component/reducer/actions/AssignmentsActions.ts","../../src/data/utilities/FindUtilities.ts","../../src/component/1d/utilities/scale.ts","../../src/component/reducer/helper/getRange.ts","../../src/component/utility/nucleusToString.ts","../../src/component/reducer/actions/DomainActions.ts","../../src/component/reducer/actions/RangesActions.ts","../../src/data/utilities/ZoneUtilities.ts","../../src/component/2d/utilities/DimensionLayout.ts","../../src/component/2d/utilities/scale.ts","../../src/component/reducer/helper/get2DRange.ts","../../src/component/reducer/actions/ZonesActions.ts","../../src/component/reducer/actions/CorrelationsActions.ts","../../src/component/reducer/helper/Zoom1DManager.ts","../../src/component/reducer/actions/DatabaseActions.ts","../../src/component/reducer/actions/DimensionsActions.ts","../../src/component/utility/getSpectraByNucleus.ts","../../src/component/reducer/helper/ZoomHistoryManager.ts","../../src/component/utility/GroupByInfoKey.ts","../../src/component/reducer/actions/PreferencesActions.ts","../../src/component/reducer/actions/ToolsActions.ts","../../src/component/reducer/actions/FiltersActions.ts","../../src/component/reducer/actions/GlobalActions.ts","../../src/component/reducer/actions/HistoryActions.ts","../../src/component/reducer/actions/IntegralsActions.ts","../../src/data/molecules/MoleculeManager.ts","../../src/component/reducer/types/Types.ts","../../src/component/reducer/actions/LoadActions.ts","../../src/component/reducer/actions/MoleculeActions.ts","../../src/component/reducer/actions/PeaksActions.ts","../../src/data/utilities/generateChar.ts","../../src/data/data1d/MultipleAnalysis.ts","../../src/component/reducer/actions/SpectraAnalysisAction.ts","../../src/component/reducer/actions/SpectrumsActions.ts","../../src/component/reducer/types/HistoryTypes.ts","../../src/component/reducer/Reducer.ts","../../src/component/context/ChartContext.tsx","../../src/component/context/DispatchContext.tsx","../../src/component/hooks/useSpectrum.ts","../../src/component/context/LoaderContext.tsx","../../src/component/loader/NoData.tsx","../../src/component/loader/DefaultSpinnerComponent.tsx","../../src/component/loader/SpinnerContext.tsx","../../src/component/loader/Spinner.tsx","../../src/component/tool/BrushXY.tsx","../../src/component/tool/CrossLinePointer.tsx","../../src/component/context/GlobalContext.tsx","../../src/component/elements/draggble/useDraggable.ts","../../src/component/elements/draggble/SVGDraggable.tsx","../../src/data/utilities/Concatenation.ts","../../src/component/assignment/AssignmentsContext.ts","../../src/component/assignment/utilities/filterForIDsWithAssignment.ts","../../src/component/elements/popup/options.ts","../../src/component/elements/popup/Alert/Context.ts","../../src/component/elements/popup/Transition.tsx","../../src/component/elements/popup/Wrapper.tsx","../../src/component/elements/popup/helpers.ts","../../src/component/elements/popup/Alert/ProgressIndicator.tsx","../../src/component/elements/popup/Alert/Provider.tsx","../../src/component/highlight/index.tsx","../../src/component/panels/MoleculesPanel/Utilities.ts","../../src/component/panels/MoleculesPanel/useAtomAssignment.tsx","../../src/component/elements/Button.tsx","../../src/component/tool/FloatMoleculeStructures/ActionsButton.tsx","../../src/component/tool/FloatMoleculeStructures/DraggableStructure.tsx","../../src/component/tool/FloatMoleculeStructures/index.tsx","../../src/component/utility/LocalStorage.ts","../../src/component/workspaces/basic.ts","../../src/component/workspaces/embedded.ts","../../src/component/workspaces/exercise.ts","../../src/component/workspaces/prediction.ts","../../src/component/workspaces/process1D.ts","../../src/component/workspaces/index.ts","../../src/component/reducer/preferencesReducer.ts","../../src/component/context/PreferencesContext.tsx","../../src/component/utility/PathBuilder.ts","../../src/component/2d/Contours.tsx","../../src/component/hooks/useXYReduce.ts","../../src/component/2d/Left1DChart.tsx","../../src/component/2d/Top1DChart.tsx","../../src/component/2d/XAxis.tsx","../../src/component/2d/YAxis.tsx","../../src/component/2d/zones/IndicationLines.tsx","../../src/component/utility/Events.ts","../../src/component/2d/SignalDeltaLine.tsx","../../src/component/2d/zones/SignalCrosshair.tsx","../../src/component/2d/zones/Signal.tsx","../../src/component/2d/zones/Zone.tsx","../../src/component/2d/zones/Zones.tsx","../../src/component/2d/Chart2D.tsx","../../src/component/utility/FormatNumber.ts","../../src/component/2d/FooterBanner.tsx","../../src/component/2d/tools/XYLabelPointer.tsx","../../src/component/2d/tools/slicing/SliceScale.ts","../../src/component/2d/tools/slicing/HorizontalSliceChart.tsx","../../src/component/2d/tools/slicing/VerticalSliceChart.tsx","../../src/component/2d/tools/slicing/SlicingView.tsx","../../src/component/2d/Viewer2D.tsx","../../src/component/reducer/scaleReducer.ts","../../src/component/context/ScaleContext.tsx","../../src/component/elements/popup/Modal/Context.ts","../../src/component/elements/popup/Modal/ConfirmDialog.tsx","../../src/component/elements/popup/Modal/ModalContent.tsx","../../src/component/elements/popup/Modal/Provider.tsx","../../src/component/elements/ToolTip/ToolTip.tsx","../../src/component/elements/CloseButton.tsx","../../src/component/modal/MultipletAnalysisModal.tsx","../../src/component/hooks/useSpectraPerNucleus.ts","../../src/component/hooks/useActiveSpectrumStyleOptions.ts","../../src/component/1d/ExclusionZoneAnnotation.tsx","../../src/component/1d/utilities/getVerticalShift.ts","../../src/component/1d/ExclusionZonesAnnotations.tsx","../../src/component/hooks/useXScale.ts","../../src/component/hooks/useIntegralPath.ts","../../src/component/panels/extra/preferences/defaultValues.ts","../../src/component/elements/resizer/useResizer.tsx","../../src/component/elements/resizer/DivResizer.tsx","../../src/component/elements/resizer/SVGResizer.tsx","../../src/component/elements/resizer/Resizer.tsx","../../src/component/1d/IntegralResizable.tsx","../../src/component/1d/Integral.tsx","../../src/component/1d/IntegralsSeries.tsx","../../src/component/1d/Line.tsx","../../src/component/1d/LinesSeries.tsx","../../src/component/1d/PeakAnnotation.tsx","../../src/component/1d/PeakAnnotations.tsx","../../src/component/1d/ResurrectedDatabaseRanges.tsx","../../src/component/1d/XAxis.tsx","../../src/data/data1d/Spectrum1D/generateJGraphData.ts","../../src/component/1d/jCouplingGraph/JGraphContext.tsx","../../src/component/elements/linearAxis/LinearVerticalAxis.tsx","../../src/component/1d/jCouplingGraph/JGraphVerticalAxis.tsx","../../src/component/1d/jCouplingGraph/JsCouplingLinks.tsx","../../src/component/1d/jCouplingGraph/JsCoupling.tsx","../../src/component/1d/jCouplingGraph/JsCouplings.tsx","../../src/component/1d/jCouplingGraph/JGraph.tsx","../../src/component/elements/DeleteButton.tsx","../../src/component/1d/multiAnalysis/AnalysisRange.tsx","../../src/component/1d/multiAnalysis/MultiAnalysisRanges.tsx","../../src/data/constants/Multiplets.ts","../../src/component/panels/extra/utilities/MultiplicityUtilities.ts","../../src/component/1d/multiplicityTree/TreeColors.ts","../../src/component/1d/multiplicityTree/LevelNode.tsx","../../src/component/1d/multiplicityTree/StringNode.tsx","../../src/component/1d/multiplicityTree/TreeNodes.tsx","../../src/component/1d/multiplicityTree/buildTreeNode.ts","../../src/component/1d/multiplicityTree/MultiplicityTree.tsx","../../src/component/1d/multiplicityTree/TempMultiplicityTree.tsx","../../src/component/1d/ranges/Range.tsx","../../src/component/1d/ranges/RangeIntegral.tsx","../../src/component/1d/ranges/Ranges.tsx","../../src/component/1d/tool/BaseLineZones.tsx","../../src/component/1d/Chart1D.tsx","../../src/component/1d/FooterBanner.tsx","../../src/component/1d/SpectraTracker.tsx","../../src/component/1d/tool/PeakPointer.tsx","../../src/component/1d/tool/VerticalIndicator.tsx","../../src/component/1d/tool/XLabelPointer.tsx","../../src/component/1d/Viewer1D.tsx","../../src/component/ErrorOverlay.tsx","../../src/component/elements/ActionButtons.tsx","../../src/component/elements/CheckBox.tsx","../../src/component/elements/formik/FormikCheckBox.tsx","../../src/component/elements/formik/FormikForm.tsx","../../src/component/hooks/useCombinedRefs.ts","../../src/component/elements/Input.tsx","../../src/component/elements/formik/FormikInput.tsx","../../src/component/modal/ModalStyle.ts","../../src/component/modal/SaveAsModal.tsx","../../src/component/utility/Export.ts","../../src/component/utility/util/nmredata/addSource.ts","../../src/component/utility/util/nmredata/getToFix.ts","../../src/component/utility/util/nmredata/get1DSignals.ts","../../src/component/utility/util/nmredata/getCouplingObserved.ts","../../src/component/utility/util/nmredata/get2DSignals.ts","../../src/component/utility/util/nmredata/flat2DSignals.ts","../../src/component/utility/util/nmredata/getLabels.ts","../../src/component/utility/nmriumToNmredata.ts","../../src/component/hooks/useExport.tsx","../../src/component/hooks/useCheckExperimentalFeature.ts","../../src/component/elements/ButtonToolTip.tsx","../../src/component/panels/extra/BasicPanelStyle.ts","../../src/component/elements/ToggleButton.tsx","../../src/component/panels/header/DefaultPanelHeader.tsx","../../src/component/hooks/useCheckToolsVisibility.ts","../../src/component/panels/header/SpectraAutomaticPickingButton.tsx","../../src/component/elements/ContextMenu.tsx","../../src/component/elements/ReactTable/Elements/ReactTableHeader.tsx","../../src/component/elements/ReactTable/Elements/ReactTableRow.tsx","../../src/component/elements/ReactTable/Style.ts","../../src/component/elements/ReactTable/utility/ReactTableContext.ts","../../src/component/elements/ReactTable/utility/useRowSpan.ts","../../src/component/elements/ReactTable/ReactTable.tsx","../../src/component/panels/extra/placeholder/NoTableData.tsx","../../src/component/panels/AutomaticAssignment/AutomaticAssignmentTable.tsx","../../src/component/panels/AutomaticAssignment/useAutoAssignments.ts","../../src/component/panels/AutomaticAssignment/AutomaticAssignment.tsx","../../src/component/elements/ReactTable/ReactTableFlexLayout.tsx","../../src/component/panels/InformationPanel.tsx","../../src/component/elements/Tab/DeleteButton.tsx","../../src/component/elements/Tab/Tab.tsx","../../src/component/elements/Tab/Tabs.tsx","../../src/component/elements/NextPrev.tsx","../../src/component/elements/MoleculeSelection.tsx","../../src/component/modal/changeSum/SelectMolecule.tsx","../../src/component/modal/changeSum/ChangeSumModal.tsx","../../src/component/elements/SaveButton.tsx","../../src/component/panels/header/PreferencesHeader.tsx","../../src/component/elements/EditableColumn.tsx","../../src/component/elements/ReactTable/utility/addCustomColumn.ts","../../src/component/elements/Select.tsx","../../src/component/panels/IntegralsPanel/IntegralTable.tsx","../../src/component/elements/ColorInput.tsx","../../src/component/elements/formik/FormikColorInput.tsx","../../src/component/elements/formik/FormikColumnFormatField.tsx","../../src/component/elements/NumberInput.tsx","../../src/component/elements/formik/FormikNumberInput.tsx","../../src/component/hooks/useNucleus.ts","../../src/component/panels/IntegralsPanel/IntegralsPreferences.tsx","../../src/component/panels/IntegralsPanel/IntegralPanel.tsx","../../src/component/elements/Label.tsx","../../src/component/modal/ExportAsMatrixModal.tsx","../../src/component/modal/MultipleSpectraFiltersModal/EquallySpacedFilter.tsx","../../src/component/modal/MultipleSpectraFiltersModal/FromToFilter.tsx","../../src/component/modal/MultipleSpectraFiltersModal/index.tsx","../../src/component/panels/MatrixGenerationPanel/MatrixGenerationPanel.tsx","../../src/component/modal/MoleculeStructureEditorModal.tsx","../../src/component/elements/MenuButton.tsx","../../src/data/utilities/generateNumbersPowerOfX.ts","../../src/component/elements/IsotopesViewer.tsx","../../src/component/elements/formik/FormikErrorsSummary.tsx","../../src/component/elements/formik/FormikSelect.tsx","../../src/component/modal/PredictSpectraModal.tsx","../../src/component/panels/MoleculesPanel/MoleculePanelHeader.tsx","../../src/component/panels/MoleculesPanel/MoleculePanel.tsx","../../src/component/modal/AlignSpectraModal.tsx","../../src/component/utility/Evaluate.ts","../../src/component/panels/MultipleSpectraAnalysisPanel/MultipleAnalysisCodeEditor.tsx","../../src/component/panels/MultipleSpectraAnalysisPanel/MultipleSpectraAnalysisPreferences.tsx","../../src/component/elements/dropDownButton/DropDownList.tsx","../../src/component/elements/dropDownButton/DropDownButton.tsx","../../src/component/panels/MultipleSpectraAnalysisPanel/ColumnHeader.tsx","../../src/component/panels/MultipleSpectraAnalysisPanel/MultipleSpectraAnalysisTable.tsx","../../src/component/panels/MultipleSpectraAnalysisPanel/MultipleSpectraAnalysisPanel.tsx","../../src/component/panels/PeaksPanel/PeaksPreferences.tsx","../../src/component/panels/PeaksPanel/PeaksTable.tsx","../../src/component/panels/PeaksPanel/PeaksPanel.tsx","../../src/component/modal/CopyClipboardModal.tsx","../../src/component/panels/RangesPanel/RangesHeader.tsx","../../src/component/panels/RangesPanel/RangesPreferences.tsx","../../src/component/hooks/useTableSortBy.tsx","../../src/component/panels/extra/preferences/ColumnsHelper.ts","../../src/component/panels/RangesPanel/TableColumns/AbsoluteColumn.tsx","../../src/component/elements/formik/FormikOnChange.tsx","../../src/component/modal/editRange/forms/components/AddSignalFormTab.tsx","../../src/component/modal/editRange/forms/components/DeltaInput.tsx","../../src/component/modal/editRange/forms/components/CouplingsTable.tsx","../../src/component/modal/editRange/forms/components/SignalFormTab.tsx","../../src/component/modal/editRange/forms/components/SignalsForm.tsx","../../src/component/modal/editRange/forms/validation/EditRangeValidation.ts","../../src/component/modal/editRange/EditRangeModal.tsx","../../src/component/panels/RangesPanel/hooks/useEditRangeModal.tsx","../../src/component/panels/RangesPanel/TableColumns/ActionsColumn.tsx","../../src/component/panels/RangesPanel/TableColumns/CouplingColumn.tsx","../../src/component/panels/RangesPanel/TableColumns/RangeAssignmentsColumn.tsx","../../src/component/panels/RangesPanel/TableColumns/RangeColumn.tsx","../../src/component/panels/RangesPanel/TableColumns/RelativeColumn.tsx","../../src/component/panels/RangesPanel/TableColumns/SignalAssignmentsColumn.tsx","../../src/component/panels/RangesPanel/TableColumns/format.ts","../../src/component/panels/RangesPanel/TableColumns/SignalDeltaColumn.tsx","../../src/component/panels/RangesPanel/RangesTableRow.tsx","../../src/component/panels/RangesPanel/hooks/useMapRanges.ts","../../src/component/panels/RangesPanel/RangesTable.tsx","../../src/component/panels/RangesPanel/RangesPanel.tsx","../../src/component/panels/SpectrumsPanel/SpectraPanelHeader.tsx","../../src/component/panels/SpectrumsPanel/base/ColorIndicator.tsx","../../src/component/panels/SpectrumsPanel/base/ShowHideMarkersButton.tsx","../../src/component/panels/SpectrumsPanel/base/ShowHideSpectrumButton.tsx","../../src/component/panels/SpectrumsPanel/SpectrumListItem.tsx","../../src/component/elements/formik/FormikColorPicker.tsx","../../src/component/panels/SpectrumsPanel/base/setting/PlotChart.tsx","../../src/component/panels/SpectrumsPanel/base/setting/processSnapPlot.ts","../../src/component/panels/SpectrumsPanel/base/setting/Spectrum1DHistogram.tsx","../../src/component/panels/SpectrumsPanel/base/setting/Spectrum1DSetting.tsx","../../src/component/elements/formik/FormikSlider.tsx","../../src/component/panels/SpectrumsPanel/base/setting/Spectrum2DHistogram.tsx","../../src/component/panels/SpectrumsPanel/base/setting/Spectrum2DSetting.tsx","../../src/component/panels/SpectrumsPanel/base/setting/SpectrumSetting.tsx","../../src/component/panels/SpectrumsPanel/SpectrumsTabs.tsx","../../src/component/panels/SpectrumsPanel/SpectrumListPanel.tsx","../../src/data/constants/DefaultPathLengths.ts","../../src/component/modal/editZone/validation/isDefaultPathLength.ts","../../src/component/panels/SummaryPanel/utilities/Utilities.ts","../../src/component/panels/SummaryPanel/utilities/IsInView.ts","../../src/component/panels/SummaryPanel/CorrelationTable/editLink/Confirmation.tsx","../../src/component/panels/SummaryPanel/CorrelationTable/editLink/EditPathLength.tsx","../../src/component/panels/SummaryPanel/CorrelationTable/editLink/MoveLink.tsx","../../src/component/panels/SummaryPanel/CorrelationTable/editLink/EditLinkModal.tsx","../../src/component/panels/SummaryPanel/CorrelationTable/AdditionalColumnHeader.tsx","../../src/component/panels/SummaryPanel/CorrelationTable/AdditionalColumnField.tsx","../../src/component/panels/SummaryPanel/CorrelationTable/CorrelationTableRow.tsx","../../src/component/panels/SummaryPanel/CorrelationTable/CorrelationTable.tsx","../../src/component/panels/SummaryPanel/Overview.tsx","../../src/component/elements/MolecularFormulaInput.tsx","../../src/component/panels/SummaryPanel/SetMolecularFormulaModal.tsx","../../src/component/panels/SummaryPanel/SetShiftTolerancesModal.tsx","../../src/component/panels/SummaryPanel/SummaryPanel.tsx","../../src/component/panels/ZonesPanel/ZonesPreferences.tsx","../../src/component/modal/editZone/EditPathLengthFormik.tsx","../../src/component/modal/editZone/SignalFormTab.tsx","../../src/component/modal/editZone/SignalsForm.tsx","../../src/component/modal/editZone/validation/EditZoneValidation.ts","../../src/component/modal/editZone/EditZoneModal.tsx","../../src/component/panels/ZonesPanel/TableColumns/ActionsColumn.tsx","../../src/component/panels/ZonesPanel/TableColumns/SignalAssignmentsColumn.tsx","../../src/component/panels/ZonesPanel/TableColumns/SignalAssignmentsColumns.tsx","../../src/component/panels/ZonesPanel/TableColumns/SignalDeltaColumn.tsx","../../src/component/panels/ZonesPanel/TableColumns/ZoneAssignmentsColumn.tsx","../../src/component/panels/ZonesPanel/TableColumns/ZoneAssignmentsColumns.tsx","../../src/component/panels/ZonesPanel/ZonesTableRow.tsx","../../src/component/panels/ZonesPanel/ZonesTable.tsx","../../src/component/panels/ZonesPanel/ZonesPanel.tsx","../../src/data/data1d/database.ts","../../src/component/panels/databasePanel/DatabasePreferences.tsx","../../src/component/panels/databasePanel/DatabaseTable.tsx","../../src/component/panels/databasePanel/useDatabases.ts","../../src/component/panels/databasePanel/DatabasePanel.tsx","../../src/component/elements/Table/Table.tsx","../../src/component/elements/Table/TableBody.tsx","../../src/component/elements/Table/TableCell.tsx","../../src/component/elements/Table/TableHead.tsx","../../src/component/elements/Table/TableRow.tsx","../../src/component/panels/filtersPanel/FiltersTable.tsx","../../src/component/panels/filtersPanel/FilterPanel.tsx","../../src/component/panels/predictionPanel/PredictionOptions.tsx","../../src/component/panels/predictionPanel/PredictionPanel.tsx","../../src/component/panels/Panels.tsx","../../src/component/hooks/useToolsFunctions.ts","../../src/component/EventsTrackers/KeysListenerTracker.tsx","../../src/component/SplitPaneWrapper.tsx","../../src/component/assignment/actions/initAssignment.ts","../../src/component/assignment/actions/removeAssignment.ts","../../src/component/assignment/actions/setActiveAssignment.ts","../../src/component/assignment/actions/toggleAssignment.ts","../../src/component/assignment/AssignmentsReducer.ts","../../src/component/assignment/index.tsx","../../src/constants.ts","../../src/versionInfo.ts","../../src/component/elements/Logo.tsx","../../src/component/modal/AboutUsModal.tsx","../../src/component/modal/setting/ControllersTabContent.tsx","../../src/component/modal/setting/DatabasesTabContent.tsx","../../src/component/modal/setting/DisplayTabContent.tsx","../../src/component/modal/setting/FormattingTabContent.tsx","../../src/component/modal/setting/WorkspaceItem.tsx","../../src/component/modal/setting/settingsValidation.ts","../../src/component/modal/setting/GeneralSettings.tsx","../../src/component/header/AutoPeakPickingOptionPanel.tsx","../../src/component/header/BaseLineCorrectionPanel.tsx","../../src/component/elements/InputRange.tsx","../../src/component/header/ManualPhaseCorrectionPanel.tsx","../../src/component/header/RangesPickingOptionPanel.tsx","../../src/component/header/ZeroFillingOptionsPanel.tsx","../../src/component/header/Zones2DOptionPanel.tsx","../../src/component/header/Header.tsx","../../src/component/utility/FileUtility.ts","../../src/component/loader/DropZone.tsx","../../src/component/reducer/IgnoreActions.ts","../../src/component/elements/ToolbarMenu.tsx","../../src/component/hooks/useDatumWithSpectraStatistics.ts","../../src/component/elements/formik/FormikTextarea.tsx","../../src/component/modal/ImportPublicationStringModal.tsx","../../src/component/modal/LoadJCAMPModal.tsx","../../src/component/toolbar/BasicToolBar.tsx","../../src/component/elements/toggle/ToggleButton.tsx","../../src/component/elements/toggle/ToggleButtonGroup.tsx","../../src/component/toolbar/FunctionToolBar.tsx","../../src/component/toolbar/ToolBar.tsx","../../src/component/NMRium.tsx","../../src/demo/views/Test.tsx","../../src/demo/test/TestRoutes.tsx","../../src/index.tsx"],"sourcesContent":["const p = function polyfill() {\n    const relList = document.createElement('link').relList;\n    if (relList && relList.supports && relList.supports('modulepreload')) {\n        return;\n    }\n    for (const link of document.querySelectorAll('link[rel=\"modulepreload\"]')) {\n        processPreload(link);\n    }\n    new MutationObserver((mutations) => {\n        for (const mutation of mutations) {\n            if (mutation.type !== 'childList') {\n                continue;\n            }\n            for (const node of mutation.addedNodes) {\n                if (node.tagName === 'LINK' && node.rel === 'modulepreload')\n                    processPreload(node);\n            }\n        }\n    }).observe(document, { childList: true, subtree: true });\n    function getFetchOpts(script) {\n        const fetchOpts = {};\n        if (script.integrity)\n            fetchOpts.integrity = script.integrity;\n        if (script.referrerpolicy)\n            fetchOpts.referrerPolicy = script.referrerpolicy;\n        if (script.crossorigin === 'use-credentials')\n            fetchOpts.credentials = 'include';\n        else if (script.crossorigin === 'anonymous')\n            fetchOpts.credentials = 'omit';\n        else\n            fetchOpts.credentials = 'same-origin';\n        return fetchOpts;\n    }\n    function processPreload(link) {\n        if (link.ep)\n            // ep marker = processed\n            return;\n        link.ep = true;\n        // prepopulate the load record\n        const fetchOpts = getFetchOpts(link);\n        fetch(link.href, fetchOpts);\n    }\n};__VITE_IS_MODERN__&&p();","import { SubMenu, MenuItem } from 'rc-menu';\nimport { createElement, cloneElement } from 'react';\n\nfunction buildMenu(array: Array<any> = []) {\n  let menu: Array<any> = [];\n  for (const item of array) {\n    if (item.children && Array.isArray(item.children)) {\n      menu.push(getMenu(item.groupName, [item], []));\n    } else {\n      menu.push(\n        createElement(MenuItem, { key: item.title, ...item }, item.title),\n      );\n    }\n  }\n  return menu;\n}\n\nfunction getMenu(\n  key,\n  array: Array<any> = [],\n  nodes: Array<any> = [],\n  parentIndex = 0,\n) {\n  let _nodes = nodes;\n  let children: Array<any> = [];\n\n  if (parentIndex !== -1 && _nodes[parentIndex]) {\n    _nodes[parentIndex] = cloneElement(_nodes[parentIndex], {}, children);\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-for-in-array\n  for (const index in array) {\n    if (array[index].children && Array.isArray(array[index].children)) {\n      const node = createElement(SubMenu, {\n        key: index + key,\n        title: array[index].groupName,\n      });\n      _nodes.push(node);\n      return getMenu(index + key, array[index].children, _nodes, 0);\n    } else {\n      children.push(\n        createElement(\n          MenuItem,\n          { key: index + key, ...array[index] },\n          array[index].title,\n        ),\n      );\n    }\n  }\n  return _nodes;\n}\n\nfunction mapTreeToFlatArray(array: Array<any> = []) {\n  let routes: Array<any> = [];\n  for (const item of array) {\n    if (item.children && Array.isArray(item.children)) {\n      routes = routes.concat(getFlatArray([item], []));\n    } else {\n      routes.push(item);\n    }\n  }\n  return routes;\n}\n\nfunction getFlatArray(inputArray: Array<any> = [], children: Array<any> = []) {\n  let _children = children;\n\n  for (const item of inputArray) {\n    if (item.children && Array.isArray(item.children)) {\n      return getFlatArray(item.children, _children);\n    } else {\n      children.push(item);\n    }\n  }\n  return _children;\n}\n\nfunction getKey(filePath = '') {\n  const match = new RegExp(/^(?<path>.*)\\/(?<file>[^/]*)$/g).exec(filePath);\n  let parentFolderName = '';\n  if (match) {\n    const parentPath = match[1].split('/');\n    parentFolderName =\n      parentPath.length > 2\n        ? parentPath[parentPath.length - 2] + parentPath[parentPath.length - 1]\n        : parentPath[parentPath.length - 1];\n  }\n  return parentFolderName + filePath.replace(/\\.|\\s|\\//g, '');\n}\n\nexport { buildMenu, getKey, mapTreeToFlatArray };\n","/** @jsxImportSource @emotion/react */\n\nimport { css } from '@emotion/react';\nimport Menu from 'rc-menu';\nimport { memo, useMemo } from 'react';\nimport 'rc-menu/assets/index.css';\nimport { FaBars } from 'react-icons/fa';\nimport { withRouter } from 'react-router-dom';\n\nimport { buildMenu, getKey } from './utility/menu';\n\nconst sidebarCss = css`\n  background: #2ca8ff;\n  position: fixed;\n  top: 0;\n  height: 100%;\n  bottom: 0;\n  left: 0;\n  z-index: 1031;\n`;\n\nconst sidebarOpenCss = css`\n  width: 260px;\n`;\n\nconst sidebarClosedCss = css`\n  width: 3%;\n`;\n\nconst menuBtCss = css`\n  margin-left: 4px;\n  margin-top: 2px;\n  margin-bottom: 2px;\n  margin-right: 4px;\n  z-index: 7;\n  font-size: 18px;\n  background-color: transparent;\n  border: none !important;\n  height: 30px;\n  width: 30px;\n  padding: 1px 6px;\n\n  & svg {\n    fill: white;\n  }\n\n  &:focus {\n    outline: none;\n  }\n\n  &:active {\n    background-color: rgba(0, 0, 0, 0.5);\n    border-radius: 50%;\n  }\n  &:hover {\n    background-color: rgba(0, 0, 0, 0.2);\n    border-radius: 50%;\n  }\n`;\n\nconst logoCss = css`\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  z-index: 4;\n  border-bottom: 1px solid #eee;\n`;\n\nconst simpleTextCss = css`\n  text-transform: uppercase;\n  padding: 0.5rem 0;\n  display: block;\n  white-space: nowrap;\n  font-size: 1em;\n  color: #fff;\n  text-decoration: none;\n  font-weight: 400;\n  line-height: 30px;\n  overflow: hidden;\n`;\n\nconst logoNormalCss = css`\n  display: block;\n  opacity: 1;\n  transform: translateZ(0);\n`;\n\nconst sidebarWrapperCss = css`\n  position: relative;\n  height: calc(100vh - 75px);\n  overflow-y: auto;\n  overflow-x: hidden;\n  width: 260px;\n  z-index: 4;\n  padding-bottom: 100px;\n`;\n\nfunction Sidebar(props) {\n  const routes = useMemo(() => {\n    return buildMenu(props.routes);\n  }, [props.routes]);\n\n  const subDisplay = props.menuIsClosed ? 'none' : 'block';\n\n  return (\n    <div\n      css={css(\n        sidebarCss,\n        props.menuIsClosed ? sidebarClosedCss : sidebarOpenCss,\n      )}\n    >\n      <div css={logoCss}>\n        <div style={{ display: subDisplay, padding: '0.5rem 0.7rem' }}>\n          <a css={css(simpleTextCss, logoNormalCss)}>NMRium</a>\n        </div>\n        <button type=\"button\" css={menuBtCss} onClick={props.onMenuToggle}>\n          <FaBars />\n        </button>\n      </div>\n      <div css={sidebarWrapperCss} style={{ display: subDisplay }}>\n        <Menu\n          onClick={(e) => {\n            // console.log((e.item.props.view || '') + getKey(e.item.props.file));\n            props.history.push(\n              `/SamplesDashboard/${Math.random()\n                .toString(36)\n                .replace('0.', '')}/${\n                // @ts-expect-error This will be fixed by updating use of rc-menu\n                (e.item.props.view || 'View') + getKey(e.item.props.file)\n              }`,\n            );\n          }}\n          mode=\"inline\"\n        >\n          {routes}\n        </Menu>\n      </div>\n    </div>\n  );\n}\n\nexport default withRouter(memo(Sidebar));\n","const scriptRel = 'modulepreload';const seen = {};const base = './';export const __vitePreload = function preload(baseModule, deps) {\n    // @ts-ignore\n    if (!__VITE_IS_MODERN__ || !deps || deps.length === 0) {\n        return baseModule();\n    }\n    return Promise.all(deps.map((dep) => {\n        // @ts-ignore\n        dep = `${base}${dep}`;\n        // @ts-ignore\n        if (dep in seen)\n            return;\n        // @ts-ignore\n        seen[dep] = true;\n        const isCss = dep.endsWith('.css');\n        const cssSelector = isCss ? '[rel=\"stylesheet\"]' : '';\n        // @ts-ignore check if the file is already preloaded by SSR markup\n        if (document.querySelector(`link[href=\"${dep}\"]${cssSelector}`)) {\n            return;\n        }\n        // @ts-ignore\n        const link = document.createElement('link');\n        // @ts-ignore\n        link.rel = isCss ? 'stylesheet' : scriptRel;\n        if (!isCss) {\n            link.as = 'script';\n            link.crossOrigin = '';\n        }\n        link.href = dep;\n        // @ts-ignore\n        document.head.appendChild(link);\n        if (isCss) {\n            return new Promise((res, rej) => {\n                link.addEventListener('load', res);\n                link.addEventListener('error', () => rej(new Error(`Unable to preload CSS for ${dep}`)));\n            });\n        }\n    })).then(() => baseModule());\n}","import { lazy, memo } from 'react';\n\nexport const possibleViews = {\n  Exam: memo(lazy(() => import('./Exam'))),\n  Exercise: memo(lazy(() => import('./Exercise'))),\n  SingleView: memo(lazy(() => import('./SingleView'))),\n  Test: memo(lazy(() => import('./Test'))),\n  View: memo(lazy(() => import('./View'))),\n  TwoInstances: memo(lazy(() => import('./TwoInstances'))),\n  Teaching: memo(lazy(() => import('./Teaching'))),\n  Prediction: memo(lazy(() => import('./Prediction'))),\n};\n","/** @jsxImportSource @emotion/react */\n\nimport { css } from '@emotion/react';\nimport { Suspense, useMemo, useState, useCallback } from 'react';\nimport { Route, Switch } from 'react-router-dom';\n\nimport Sidebar from '../Sidebar';\nimport { mapTreeToFlatArray, getKey } from '../utility/menu';\nimport { possibleViews } from '../views';\n\nconst mainPanelCss = css`\n  position: relative;\n  float: right;\n  height: 100%;\n  background-color: #ebecf1;\n`;\n\nconst mainPanelOpenCss = css`\n  width: calc(100% - 260px);\n`;\n\nconst mainPanelClosedCss = css`\n  width: 98%;\n  margin-left: 20px !important;\n`;\n\ninterface DashboardProps {\n  routes: any[];\n  baseURL: string;\n}\n\nexport function Dashboard(props: DashboardProps) {\n  const { routes = [], baseURL } = props;\n  const routesList = useMemo(() => mapTreeToFlatArray(routes), [routes]);\n  const [menuIsClosed, setMenuIsClosed] = useState(false);\n  const toggleMenu = useCallback(\n    () => setMenuIsClosed(!menuIsClosed),\n    [menuIsClosed],\n  );\n\n  return (\n    <div\n      style={{\n        position: 'relative',\n        top: 0,\n        height: '100vh',\n      }}\n    >\n      <Sidebar\n        {...props}\n        routes={routes}\n        menuIsClosed={menuIsClosed}\n        onMenuToggle={toggleMenu}\n      />\n      <div\n        css={css(\n          mainPanelCss,\n          menuIsClosed ? mainPanelClosedCss : mainPanelOpenCss,\n        )}\n      >\n        {/* <StrictMode> */}\n        <Suspense fallback={<div>Loading...</div>}>\n          <Switch>\n            {routesList.map((prop) => {\n              return (\n                <Route\n                  path={`/SamplesDashboard/:id/${\n                    (prop.view || 'View') + getKey(prop.file)\n                  }`}\n                  render={(props) => (\n                    <RenderView {...props} prop={prop} baseURL={baseURL} />\n                  )}\n                  key={getKey(prop.file)}\n                />\n              );\n            })}\n\n            {routesList.length > 0 && (\n              <Route\n                path=\"/\"\n                render={() => {\n                  const routeProp = routesList[0];\n                  const viewName = routeProp.view ? routeProp.view : 'View';\n                  const RenderedView = possibleViews[viewName];\n                  return <RenderedView {...routeProp[0]} />;\n                }}\n                key={getKey(routesList[0].file)}\n              />\n            )}\n          </Switch>\n        </Suspense>\n        {/* </StrictMode> */}\n      </div>\n    </div>\n  );\n}\n\nfunction RenderView(props) {\n  const {\n    match: {\n      params: { id },\n    },\n    prop,\n    baseURL,\n  } = props;\n  const viewName = prop.view ? prop.view : 'View';\n  const RenderedView = possibleViews[viewName];\n  return (\n    <RenderedView key={id} {...prop} id={getKey(prop.file)} baseURL={baseURL} />\n  );\n}\n\nexport default Dashboard;\n","import { Suspense } from 'react';\nimport { Route, Switch } from 'react-router-dom';\n\nimport { getKey } from '../utility/menu';\nimport { possibleViews } from '../views';\n\ninterface SingleDisplayerLayoutProps {\n  view: any;\n  patrh: any;\n  path: any;\n}\n\nexport default function SingleDisplayerLayout(\n  props: SingleDisplayerLayoutProps,\n) {\n  return (\n    <div\n      style={{\n        position: 'relative',\n        top: 0,\n        height: '100vh',\n      }}\n    >\n      <div\n        style={{\n          position: 'absolute',\n          display: 'block',\n          width: '99%',\n          marginLeft: 'auto',\n          marginRight: 'auto',\n          height: '100%',\n          backgroundColor: 'ebecf1',\n        }}\n      >\n        <Suspense fallback={<div>Loading...</div>}>\n          <Switch>\n            <Route\n              path=\"/\"\n              render={(routeProps: any) => {\n                const {\n                  match: {\n                    params: { id },\n                  },\n                } = routeProps;\n                const viewName = props.view ? props.view : 'SingleView';\n\n                const RenderedView = possibleViews[viewName];\n\n                return (\n                  <RenderedView key={id} {...props} id={getKey(props.patrh)} />\n                );\n              }}\n              key={getKey(props.path)}\n            />\n          </Switch>\n        </Suspense>\n      </div>\n    </div>\n  );\n}\n","import { useEffect, useState, useCallback, CSSProperties } from 'react';\n\nimport routes from '../samples.json';\n\nimport AdminLayout from './Admin';\nimport SingleDisplayerLayout from './SingleDisplayerLayout';\n\nconst styles: Record<\n  | 'bodyContainer'\n  | 'container'\n  | 'normal'\n  | 'error'\n  | 'errorHeader'\n  | 'normalHeader'\n  | 'loadButton',\n  CSSProperties\n> = {\n  bodyContainer: {\n    display: 'flex',\n    justifyContent: 'center',\n    alignItems: 'center',\n    height: '100vh',\n    width: '100vw',\n    backgroundColor: '#e3e3e3',\n  },\n  container: {\n    width: '30%',\n    height: '40%',\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'center',\n    borderRadius: '10px',\n    fontSize: '20px',\n    textAlign: 'center',\n  },\n  normal: {\n    backgroundColor: 'white',\n    color: 'black',\n  },\n  error: {\n    backgroundColor: 'red',\n    color: 'white',\n  },\n  errorHeader: {\n    fontSize: '100px',\n  },\n  normalHeader: {\n    fontSize: '24px',\n  },\n  loadButton: {\n    fontSize: '12px',\n    padding: '12px 40px',\n    borderRadius: '10px',\n    border: '1px solid #c70000',\n    fontWeight: 'bold',\n    cursor: 'pointer',\n  },\n};\n\nasync function loadData(url) {\n  const response = await fetch(url);\n  try {\n    checkStatus(response);\n    const data = await response.json();\n    return data;\n  } catch (e) {\n    // eslint-disable-next-line no-console\n    console.error(e);\n    return null;\n  }\n}\n\nfunction checkStatus(response) {\n  if (!response.ok) {\n    throw new Error(`HTTP ${response.status} - ${response.statusText}`);\n  }\n  return response;\n}\n\nconst Main = (props) => {\n  const [data, setRoutes] = useState<{\n    isLoaded: boolean;\n    status: number;\n    routes?: Array<any>;\n    baseURL?: string;\n    path?: string;\n  }>({\n    isLoaded: false,\n    status: 200,\n    routes: [],\n  });\n\n  const [dashBoardType, setDashBoardType] = useState('');\n\n  const loadHandler = useCallback(() => {\n    setRoutes({ isLoaded: true, status: 200, routes: routes });\n  }, []);\n\n  const getFileExtension = (url = '') => {\n    return url.substring(url.lastIndexOf('.') + 1);\n  };\n\n  const href = window.location.href;\n  useEffect(() => {\n    const qs = new URL(href).searchParams;\n    if (qs.has('sampleURL')) {\n      const sampleURL = qs.get('sampleURL');\n      if (!sampleURL) return;\n\n      const extention = getFileExtension(sampleURL).toLowerCase();\n      switch (extention) {\n        case 'json': {\n          setDashBoardType('multi');\n          void loadData(sampleURL).then((remoteRoutes) => {\n            if (remoteRoutes) {\n              const baseURL = sampleURL.replace(\n                /^(?<url>.*[\\\\/])?(?<filename>.*?\\.[^.]*?|)$/g,\n                '$1',\n              );\n\n              const _remoteRoutes = JSON.parse(\n                JSON.stringify(remoteRoutes).replace(/\\.\\/+?/g, baseURL),\n              );\n              setRoutes({\n                isLoaded: true,\n                status: 200,\n                routes: _remoteRoutes,\n                baseURL,\n              });\n            } else {\n              setRoutes({ isLoaded: false, status: 404, routes: [] });\n            }\n          });\n          break;\n        }\n        case 'dx':\n        case 'jdx': {\n          setDashBoardType('single');\n          setRoutes({\n            isLoaded: true,\n            status: 200,\n            path: sampleURL,\n          });\n\n          break;\n        }\n\n        default:\n          break;\n      }\n    } else {\n      setDashBoardType('multi');\n      setRoutes({ isLoaded: true, status: 200, routes: routes, baseURL: './' });\n    }\n  }, [href]);\n\n  return !data.isLoaded ? (\n    <div style={styles.bodyContainer}>\n      <div\n        style={{\n          ...styles.container,\n          ...(data.status === 200 ? styles.normal : styles.error),\n        }}\n      >\n        {data.status === 200 ? (\n          <div>\n            <p style={styles.normalHeader}>Please wait</p>\n            <p>We will redirect you in a minute</p>\n          </div>\n        ) : (\n          <div>\n            <p style={styles.errorHeader}>404</p>\n            <p>Resource not found.</p>\n            <button\n              style={styles.loadButton}\n              type=\"button\"\n              onClick={loadHandler}\n            >\n              Load local samples\n            </button>\n          </div>\n        )}\n      </div>\n    </div>\n  ) : dashBoardType && dashBoardType === 'single' ? (\n    <SingleDisplayerLayout {...props} path={data.path} />\n  ) : (\n    <AdminLayout {...props} routes={data.routes} baseURL={data.baseURL} />\n  );\n};\n\nexport default Main;\n","import { KeyboardEvent, MouseEvent } from 'react';\n\nexport default function checkModifierKeyActivated(\n  event: KeyboardEvent | MouseEvent,\n): boolean {\n  const modifiersKeys = [\n    'Alt',\n    'AltGraph',\n    'CapsLock',\n    'Control',\n    'Meta',\n    'NumLocK',\n    'ScrollLock',\n    'Shift',\n    'OS',\n  ];\n  for (const key of modifiersKeys) {\n    if (event.getModifierState(key)) {\n      return true;\n    }\n  }\n  return false;\n}\n","import { xGetFromToIndex } from 'ml-spectra-processing';\nimport { analyseMultiplet } from 'multiplet-analysis';\n\nexport const MAX_LENGTH = 2048;\n\nexport default function detectSignal(\n  x: Float64Array,\n  re: Float64Array,\n  from,\n  to,\n  frequency,\n) {\n  const { fromIndex, toIndex } = xGetFromToIndex(x, {\n    from: from,\n    to: to,\n  });\n\n  if (toIndex - fromIndex <= MAX_LENGTH) {\n    const data = {\n      x: x.subarray(fromIndex, toIndex),\n      y: re.subarray(fromIndex, toIndex),\n    };\n\n    const result = analyseMultiplet(data, {\n      frequency: frequency,\n      takeBestPartMultiplet: true,\n      symmetrizeEachStep: true,\n    });\n    if (result && result.chemShift === undefined) return;\n    return {\n      multiplicity: result.js.map((j) => j.multiplicity).join(''),\n      kind: 'signal',\n      delta: result.chemShift,\n      js: result.js,\n    };\n  } else {\n    throw new Error(`length of signal should not exceed ${MAX_LENGTH} points`);\n  }\n}\n","import lodashDebounce from 'lodash/debounce';\nimport lodashMap from 'lodash/map';\nimport {\n  createContext,\n  CSSProperties,\n  ReactNode,\n  useCallback,\n  useEffect,\n  useReducer,\n  useRef,\n  useState,\n} from 'react';\n\nconst initialState = {\n  step: 'initial',\n  brush: {\n    start: null,\n    end: null,\n  },\n  startX: 0,\n  endX: 0,\n  startY: 0,\n  endY: 0,\n};\n\nexport const BrushContext = createContext(initialState);\n\ninterface BrushTrackerProps {\n  children: ReactNode;\n  className?: string;\n  style?: CSSProperties;\n  onBrush?: (element: any) => void;\n  onZoom?: (element: any) => void;\n  onDoubleClick?: (element: any) => void;\n  onClick?: (element: any) => void;\n  noPropagation?: boolean;\n}\n\nexport function BrushTracker({\n  children,\n  className,\n  style,\n  onBrush = () => null,\n  onZoom = () => null,\n  onDoubleClick = () => null,\n  onClick = () => null,\n  noPropagation,\n}: BrushTrackerProps) {\n  const [state, dispatch] = useReducer(reducer, initialState);\n  const [mouseDownTime, setMouseDownTime] = useState<number>(0);\n  const debounceClickEventsRef = useRef<Array<any>>([]);\n\n  const mouseDownHandler = useCallback(\n    (event) => {\n      if (event.button === 0) {\n        if (noPropagation) {\n          event.stopPropagation();\n        }\n        dispatch({\n          type: 'DOWN',\n          shiftKey: event.shiftKey,\n          altKey: event.altKey,\n          screenX: event.screenX,\n          screenY: event.screenY,\n          clientX: event.clientX,\n          clientY: event.clientY,\n          boundingRect: event.currentTarget.getBoundingClientRect(),\n        });\n\n        setMouseDownTime(event.timeStamp);\n      }\n      return false;\n    },\n    [noPropagation],\n  );\n\n  const clickHandler = useCallback(\n    (e) => {\n      e.persist();\n      const timeStamp = e.timeStamp;\n      const boundingRect = e.currentTarget.getBoundingClientRect();\n      const x = e.clientX - boundingRect.x;\n      const y = e.clientY - boundingRect.y;\n\n      const callback = lodashDebounce(() => {\n        if (\n          timeStamp - mouseDownTime <= 150 &&\n          debounceClickEventsRef.current.length === 1\n        ) {\n          onClick({ ...e, x, y });\n        }\n        debounceClickEventsRef.current = [];\n      }, 200);\n\n      debounceClickEventsRef.current.push(callback);\n\n      callback();\n\n      if (debounceClickEventsRef.current.length > 1) {\n        lodashMap(debounceClickEventsRef.current, (debounce) =>\n          debounce.cancel(),\n        );\n        debounceClickEventsRef.current = [];\n        onDoubleClick({ ...e, x, y });\n      }\n    },\n    [mouseDownTime, onClick, onDoubleClick],\n  );\n\n  const handleMouseWheel = useCallback(\n    (event) => {\n      const boundingRect = event.currentTarget.getBoundingClientRect();\n      const x = event.clientX - boundingRect.x;\n      const y = event.clientY - boundingRect.y;\n\n      const { deltaY, deltaX, shiftKey, deltaMode } = event;\n      onZoom({ deltaY: deltaY || deltaX, shiftKey, deltaMode, x, y });\n    },\n    [onZoom],\n  );\n\n  useEffect(() => {\n    const { step, startX, endX, startY, endY } = state;\n\n    if (step === 'end' && Math.hypot(endX - startX, endY - startY) > 5) {\n      onBrush(state);\n      dispatch({\n        type: 'DONE',\n      });\n    }\n  }, [onBrush, state]);\n\n  const moveCallback = useCallback((event) => {\n    dispatch({\n      type: 'MOVE',\n      screenX: event.screenX,\n      screenY: event.screenY,\n      clientX: event.clientX,\n      clientY: event.clientY,\n    });\n  }, []);\n\n  const upCallback = useCallback((event) => {\n    dispatch({\n      type: 'UP',\n      clientX: event.clientX,\n      clientY: event.clientY,\n    });\n    return false;\n  }, []);\n\n  return (\n    <BrushContext.Provider value={state}>\n      <div\n        className={className}\n        style={style}\n        onMouseDown={mouseDownHandler}\n        onMouseUp={upCallback}\n        onMouseMove={moveCallback}\n        onClick={clickHandler}\n        onWheel={handleMouseWheel}\n      >\n        {children}\n      </div>\n    </BrushContext.Provider>\n  );\n}\n\nfunction reducer(state, action) {\n  switch (action.type) {\n    case 'UP':\n      if (state.step === 'brushing' || state.step === 'start') {\n        const { clientX, clientY } = action;\n\n        return {\n          ...state,\n          endX: clientX - state.boundingRect.x,\n          endY: clientY - state.boundingRect.y,\n\n          step: state.step === 'start' ? 'initial' : 'end',\n        };\n      }\n      return state;\n    case 'DOWN':\n      if (state.step === 'initial' || state.step === 'end') {\n        const {\n          screenX,\n          screenY,\n          clientX,\n          clientY,\n          boundingRect,\n          shiftKey,\n          altKey,\n        } = action;\n        const x = clientX - boundingRect.x;\n        const y = clientY - boundingRect.y;\n\n        return {\n          ...state,\n          shiftKey,\n          altKey,\n          startX: x,\n          startY: y,\n          startScreenX: screenX,\n          startScreenY: screenY,\n          startClientX: clientX,\n          startClientY: clientY,\n          boundingRect,\n          step: 'start',\n        };\n      }\n      return state;\n    case 'MOVE':\n      if (state.step === 'start' || state.step === 'brushing') {\n        const { clientX, clientY } = action;\n\n        return {\n          ...state,\n          step: 'brushing',\n          endX: clientX - state.boundingRect.x,\n          endY: clientY - state.boundingRect.y,\n        };\n      }\n      return state;\n    case 'DONE':\n      if (state.step === 'end') {\n        return {\n          ...state,\n          step: 'initial',\n        };\n      }\n      break;\n    default:\n      return state;\n  }\n}\n","import {\n  CSSProperties,\n  createContext,\n  useCallback,\n  useState,\n  useContext,\n  ReactNode,\n} from 'react';\n\nexport const MouseContext = createContext<any>({});\nconst MouseaProvider = MouseContext.Provider;\n\nexport function useMouseTracker() {\n  return useContext(MouseContext);\n}\n\ninterface MouseTrackerProps {\n  children: ReactNode;\n  className?: string;\n  style?: CSSProperties;\n  noPropagation?: boolean;\n}\n\nexport function MouseTracker({\n  children,\n  className,\n  style,\n  noPropagation,\n}: MouseTrackerProps) {\n  const [mouseTrackerState, setMouseTrackerState] = useState<{\n    x: number;\n    y: number;\n  } | null>(null);\n  const mouseMoveHandler = useCallback(\n    (e) => {\n      const boundingRect = e.currentTarget.getBoundingClientRect();\n      const x = e.clientX - boundingRect.x;\n      const y = e.clientY - boundingRect.y;\n      setMouseTrackerState({ x, y });\n      if (noPropagation) {\n        e.stopPropagation();\n      }\n    },\n    [noPropagation],\n  );\n\n  const mouseLeaveHandler = useCallback(\n    (e) => {\n      setMouseTrackerState(null);\n      if (noPropagation) {\n        e.stopPropagation();\n      }\n    },\n    [noPropagation],\n  );\n\n  return (\n    <MouseaProvider value={mouseTrackerState}>\n      <div\n        className={className}\n        style={style}\n        onMouseMove={mouseMoveHandler}\n        onMouseLeave={mouseLeaveHandler}\n      >\n        {children}\n      </div>\n    </MouseaProvider>\n  );\n}\n","export const SignalKinds: { key: string; label: string; value: string }[] = [\n  {\n    key: 'signal',\n    label: 'Signal',\n    value: 'signal',\n  },\n  {\n    key: 'reference',\n    label: 'Reference',\n    value: 'reference',\n  },\n  {\n    key: 'solvent',\n    label: 'Solvent',\n    value: 'solvent',\n  },\n  {\n    key: 'impurity',\n    label: 'Impurity',\n    value: 'impurity',\n  },\n  {\n    key: 'standard',\n    label: 'Standard',\n    value: 'standard',\n  },\n  {\n    key: 'p1',\n    label: 'P1',\n    value: 'p1',\n  },\n  {\n    key: 'p2',\n    label: 'P2',\n    value: 'p2',\n  },\n  {\n    key: 'p3',\n    label: 'P3',\n    value: 'p3',\n  },\n];\n\nexport const SignalKindsToInclude = ['signal'];\nexport const DatumKind = { signal: 'signal', mixed: 'mixed' };\n","import { reimAbsolute } from 'ml-spectra-processing';\n\nexport const id = 'absolute';\nexport const name = 'Absolute';\n\n/**\n *\n * @param {Datum1d} datum1d\n */\n\nexport function apply(datum1D) {\n  if (!isApplicable(datum1D)) {\n    throw new Error('absolute not applicable on this data');\n  }\n\n  datum1D.data.re = reimAbsolute(datum1D.data);\n  datum1D.data.im = new Float64Array(0);\n  datum1D.info = { ...datum1D.info, isComplex: false };\n}\n\nexport function isApplicable(datum1D) {\n  if (datum1D.info.isComplex && !datum1D.info.isFid) return true;\n  return false;\n}\n\nexport function reduce() {\n  return {\n    once: false,\n    reduce: null,\n  };\n}\n","import { reimAutoPhaseCorrection } from 'ml-spectra-processing';\n\nexport const id = 'autoPhaseCorrection';\nexport const name = 'Automatic phase correction';\n\n/**\n *\n * @param {Datum1d} datum1d\n * @param {Object} [options={}]\n * @param {number} [options.ph0=0]\n * @param {number} [options.ph1=0]\n */\n\nconst defaultOptions = {\n  minRegSize: 5,\n  maxDistanceToJoin: 128,\n  magnitudeMode: true,\n  factorNoise: 5,\n};\n\nexport function apply(datum1D, options = {}) {\n  if (!isApplicable(datum1D)) {\n    throw new Error('phaseCorrection not applicable on this data');\n  }\n  return reimAutoPhaseCorrection(datum1D.data, {\n    ...defaultOptions,\n    ...options,\n  });\n}\n\nexport function isApplicable(datum1D) {\n  if (datum1D.info.isComplex && !datum1D.info.isFid) return true;\n  return false;\n}\n\nexport function reduce(previousValue, newValue) {\n  let reduced = Object.assign({}, previousValue);\n  for (const k in reduced) {\n    reduced[k] += newValue[k];\n  }\n  return {\n    once: true,\n    reduce: reduced,\n  };\n}\n","import airPLS from 'ml-airpls';\nimport equallySpaced from 'ml-array-xy-equally-spaced';\nimport baselineRegression from 'ml-baseline-correction-regression';\n\nexport const id = 'baselineCorrection';\nexport const name = 'Baseline correction';\n\n/**\n *\n * @param {Datum1d} datum1d\n */\n\nexport const baselineAlgorithms = {\n  airpls: 'airPLS',\n  polynomial: 'Polynomial',\n};\n\nexport function apply(datum1D, options: any = {}) {\n  if (!isApplicable(datum1D)) {\n    throw new Error('baselineCorrection not applicable on this data');\n  }\n  const { algorithm, zones = [] } = options;\n  let { x, re } = datum1D.data;\n\n  let corrected;\n  switch (algorithm) {\n    case 'airpls':\n      corrected = airPLS(x, re, options).corrected;\n      break;\n    case 'polynomial':\n      {\n        const baselineOptions = {\n          regressionOptions: options.degree,\n        };\n        let reduced = equallySpaced(\n          { x, y: re },\n          { numberOfPoints: 4096, zones },\n        );\n        let result = baselineRegression(reduced.x, reduced.y, baselineOptions);\n        let { regression } = result;\n        corrected = new Float64Array(x.length);\n        for (let i = 0; i < re.length; i++) {\n          corrected[i] = re[i] - regression.predict(x[i]);\n        }\n      }\n\n      break;\n    default:\n      throw new Error(`baselineCorrection: algorithm unknown: ${algorithm}`);\n  }\n\n  Object.assign(datum1D.data, { re: corrected });\n}\n\nexport function isApplicable(datum1D) {\n  if (!datum1D.info.isFid) return true;\n  return false;\n}\n\nexport function reduce() {\n  return {\n    once: false,\n    reduce: null,\n  };\n}\n","import { mean } from 'ml-stat/array';\n\nexport const id = 'centerMean';\nexport const name = 'Center Mean';\n\n/**\n * Computes the arithmetic mean of the given values\n * @param {Datum1d} datum1d\n */\n\nexport function apply(datum1D) {\n  if (!isApplicable(datum1D)) {\n    throw new Error('Center Mean is not applicable on this data');\n  }\n\n  const re = datum1D.data.re.slice(0);\n  const im = datum1D.data.im?.slice(0);\n\n  const reMean = mean(re);\n  const imMean = mean(im || []);\n\n  for (let i = 0; i < re.length; i++) {\n    re[i] -= reMean;\n    if (im) {\n      im[i] -= imMean;\n    }\n  }\n\n  datum1D.data.re = re;\n\n  if (im) {\n    datum1D.data.im = im;\n  }\n}\n\nexport function isApplicable(datum1D) {\n  if (datum1D.info.isComplex && !datum1D.info.isFid) return true;\n  return false;\n}\n\nexport function reduce() {\n  return {\n    once: false,\n    reduce: null,\n  };\n}\n","export const id = 'digitalFilter';\nexport const name = 'Digital Filter';\n\n/**\n * Move points from the beginning to the end of FID and performs a first order phase correction\n * @param {Datum1d} datum1d\n */\n\nexport function apply(datum1D, options: any = {}) {\n  if (!isApplicable(datum1D)) {\n    throw new Error('Digital Filter is not applicable on this data');\n  }\n\n  let { digitalFilterValue = 0 } = options;\n  let re = new Float64Array(datum1D.data.re);\n  let im = new Float64Array(datum1D.data.im);\n\n  let pointsToShift = Math.floor(digitalFilterValue);\n\n  const skip = 0;\n  pointsToShift += 0;\n\n  const newRe = new Float64Array(re.length);\n  const newIm = new Float64Array(im.length);\n  newRe.set(re.slice(pointsToShift));\n  newRe.set(re.slice(skip, pointsToShift), re.length - pointsToShift);\n  newIm.set(im.slice(pointsToShift));\n  newIm.set(im.slice(skip, pointsToShift), im.length - pointsToShift);\n\n  datum1D.data.re = newRe;\n  datum1D.data.im = newIm;\n}\n\nexport function isApplicable(datum1D) {\n  if (datum1D.info.isComplex && datum1D.info.isFid) return true;\n  return false;\n}\n\nexport function reduce() {\n  return {\n    once: true,\n    reduce: undefined,\n  };\n}\n","import equallySpaced from 'ml-array-xy-equally-spaced';\n\nexport const id = 'equallySpaced';\nexport const name = 'Equally Spaced';\n\n/**\n * Equally Spaced\n * **\n * Function that returns a Number array of equally spaced numberOfPoints\n * containing a representation of intensities of the spectra arguments x\n * and y.\n *\n * The options parameter contains an object in the following form:\n * from: starting point\n * to: last point\n * numberOfPoints: number of points between from and to\n * variant: \"slot\" or \"smooth\" - smooth is the default option\n *\n * The slot variant consist that each point in the new array is calculated\n * averaging the existing points between the slot that belongs to the current\n * value. The smooth variant is the same but takes the integral of the range\n * of the slot and divide by the step size between two points in the new array.\n *\n * @param {Datum1d} datum1d\n * @param {Object} options.from\n * @param {number} options.to\n * @param {number} options.numberOfPoints\n * @param {Array<{from:number;to:number}>} options.exclusions\n */\n\nexport function apply(datum1D, options: any = {}) {\n  if (!isApplicable(datum1D)) {\n    throw new Error('Equally Spaced is not applicable on this data');\n  }\n  const { from, to, numberOfPoints, exclusions } = options;\n  const { x, re, im } = datum1D.data;\n  const XREdata = equallySpaced(\n    { x, y: re },\n    { from, to, numberOfPoints, exclusions },\n  );\n\n  datum1D.data.x = XREdata.x;\n  datum1D.data.re = XREdata.y;\n  if (im) {\n    const XIMdata = equallySpaced(\n      { x, y: re },\n      { from, to, numberOfPoints, exclusions },\n    );\n    datum1D.data.im = XIMdata.y;\n  }\n}\n\nexport function isApplicable(datum1D) {\n  if (datum1D.info.isComplex && !datum1D.info.isFid) return true;\n  return false;\n}\n\nexport function reduce() {\n  return {\n    once: false,\n    reduce: null,\n  };\n}\n","import { xySetYValue, zonesNormalize } from 'ml-spectra-processing';\n\nimport { Datum1D } from '../../types/data1d/Datum1D';\n\nexport const id = 'exclusionZones';\nexport const name = 'Exclusion Zones';\n\n/**\n *\n * @param {Datum1d} datum1d\n */\n\nexport function apply(datum1D: Datum1D, zones = []) {\n  if (!isApplicable(datum1D)) {\n    throw new Error('Exclusion Zones filter not applicable on this data');\n  }\n  const { x, re, im } = datum1D.data;\n  datum1D.data.re = xySetYValue({ x, y: re }, { zones }).y as number[];\n  datum1D.data.im = (im\n    ? xySetYValue({ x, y: re }, { zones })\n    : im) as unknown as number[];\n}\n\nexport function isApplicable(datum1D: Datum1D) {\n  if (datum1D.info.isComplex && datum1D.info.isFt) return true;\n  return false;\n}\n\nexport function reduce(previousValue, newValue) {\n  return {\n    once: true,\n    reduce: zonesNormalize(previousValue.concat(newValue)),\n  };\n}\n","import { reimFFT, reimPhaseCorrection } from 'ml-spectra-processing';\n\nexport const id = 'fft';\nexport const name = 'FFT';\n\n/**\n *\n * @param {Datum1d} datum1d\n */\n\nexport function apply(datum1D) {\n  if (!isApplicable(datum1D)) {\n    throw new Error('fft not applicable on this data');\n  }\n\n  let digitalFilterApplied = datum1D.filters.some(\n    (e) => e.name === 'digitalFilter' && e.flag,\n  );\n\n  Object.assign(datum1D.data, reimFFT(datum1D.data, { applyZeroShift: true }));\n\n  if (digitalFilterApplied) {\n    let { digitalFilter } = datum1D.info;\n    let ph1 = (digitalFilter - Math.floor(digitalFilter)) * Math.PI * 2;\n    Object.assign(datum1D.data, reimPhaseCorrection(datum1D.data, 0, ph1));\n  }\n\n  datum1D.data.x = generateXAxis(datum1D);\n  datum1D.info = { ...datum1D.info, isFid: false, isFt: true };\n}\n\nexport function isApplicable(datum1D) {\n  if (datum1D.info.isComplex && datum1D.info.isFid) return true;\n  return false;\n}\n\nexport function reduce() {\n  return {\n    once: true,\n    reduce: undefined,\n  };\n}\n\nfunction generateXAxis(datum1D) {\n  const info = datum1D.info;\n  const baseFrequency = parseFloat(info.baseFrequency);\n  const frequencyOffset = parseFloat(info.frequencyOffset);\n  const spectralWidth = parseFloat(info.spectralWidth);\n  const offset = frequencyOffset / baseFrequency;\n  let spectralHalfWidth = 0.5 * spectralWidth;\n  let nbPoints = datum1D.data.x.length;\n  let firstPoint = offset - spectralHalfWidth;\n  let dx = spectralWidth / (nbPoints - 1);\n  const xAxis = new Float32Array(nbPoints);\n  for (let i = 0; i < nbPoints; i++) {\n    xAxis[i] = firstPoint;\n    firstPoint += dx;\n  }\n  return xAxis;\n}\n","import { xGetFromToIndex } from 'ml-spectra-processing';\n\nexport const id = 'fromTo';\nexport const name = 'From/To';\n\n/**\n *\n * @param {Datum1d} datum1d\n */\n\nexport function apply(datum1D, options: any = {}) {\n  if (!isApplicable(datum1D)) {\n    throw new Error('From/To filter not applicable on this data');\n  }\n  const { x, re, im } = datum1D.data;\n  const { from, to } = options;\n  const { fromIndex, toIndex } = xGetFromToIndex(x, { from, to });\n\n  datum1D.data.x = x.slice(fromIndex, toIndex);\n  datum1D.data.re = re.slice(fromIndex, toIndex);\n  if (im) {\n    datum1D.data.im = im.slice(fromIndex, toIndex);\n  }\n}\n\nexport function isApplicable(datum1D) {\n  if (datum1D.info.isComplex && !datum1D.info.isFid) return true;\n  return false;\n}\n\nexport function reduce(previousValue, newValue) {\n  return {\n    once: true,\n    reduce: newValue,\n  };\n}\n","export const id = 'lineBroadening';\nexport const name = 'Line broadening';\n\n/**\n *\n * @param {Datum1d} datum1d\n * @param {Object} [value]\n */\n\nexport function apply(datum1D, value) {\n  if (!isApplicable(datum1D)) {\n    throw new Error('lineBroadening not applicable on this data');\n  }\n\n  let grpdly = datum1D.info.digitalFilter;\n  let pointsToShift;\n  if (grpdly > 0) {\n    pointsToShift = Math.floor(grpdly);\n  } else {\n    pointsToShift = 0;\n  }\n\n  const re = datum1D.data.re;\n  const im = datum1D.data.im;\n  const t = datum1D.data.x;\n\n  const length = re.length;\n\n  const newRE = new Float64Array(length); // I don't think we need a new array... here\n  const newIM = new Float64Array(length);\n  //if (value !== 0) {// is it OK to skip this line if \"value\" is zero?\n  //please check this test of zero is correct !== or != ...\n  const dw = (t[length - 1] - t[0]) / (length - 1); //REPLACE CONSTANT with calculated value... : for this we need AQ or DW to set it right...\n  // convert line broadening in Hz into exponential coefficient:\n  const em = -value * Math.exp(1);\n\n  const coefExp = Math.exp(em * dw);\n  let curFactor = Math.exp(em * t[0]); // in case does not start at zero\n  for (let i = 0; i < length - pointsToShift; i++) {\n    newRE[i] = re[i] * curFactor;\n    newIM[i] = im[i] * curFactor;\n    curFactor = curFactor * coefExp;\n  }\n  curFactor = Math.exp(em * t[0]);\n  for (let i = length; i > length - pointsToShift; i--) {\n    newRE[i] = re[i] * curFactor;\n    newIM[i] = im[i] * curFactor;\n    curFactor = curFactor * coefExp;\n  }\n  datum1D.data = { ...datum1D.data, ...{ re: newRE, im: newIM } };\n  //}\n}\nexport function isApplicable(datum1D) {\n  if (datum1D.info.isComplex && datum1D.info.isFid) return true;\n  return false;\n}\n\nexport function reduce(previousValue, newValue) {\n  return {\n    once: true,\n    reduce: previousValue + newValue,\n  };\n}\n","import { xParetoNormalization } from 'ml-spectra-processing';\n\nexport const id = 'pareto';\nexport const name = 'Pareto';\n\n/**\n * Computes the arithmetic mean of the given values\n * @param {Datum1d} datum1d\n */\n\nexport function apply(datum1D) {\n  if (!isApplicable(datum1D)) {\n    throw new Error('Pareto is not applicable on this data');\n  }\n\n  const re = datum1D.data.re.slice(0);\n  const im = datum1D.data.im?.slice(0);\n\n  datum1D.data.re = xParetoNormalization(re);\n  if (im) {\n    datum1D.data.im = xParetoNormalization(im);\n  }\n}\n\nexport function isApplicable(datum1D) {\n  if (datum1D.info.isComplex && !datum1D.info.isFid) return true;\n  return false;\n}\n\nexport function reduce() {\n  return {\n    once: false,\n    reduce: null,\n  };\n}\n","import { reimPhaseCorrection } from 'ml-spectra-processing';\n\nexport const id = 'phaseCorrection';\nexport const name = 'Phase correction';\n\n/**\n *\n * @param {Datum1d} datum1d\n * @param {Object} [options={}]\n * @param {number} [options.ph0=0]\n * @param {number} [options.ph1=0]\n */\n\nexport function apply(datum1D, options: any = {}) {\n  if (!isApplicable(datum1D)) {\n    throw new Error('phaseCorrection not applicable on this data');\n  }\n  let { ph0, ph1 } = options;\n  ph0 *= Math.PI / 180.0;\n  ph1 *= Math.PI / 180.0;\n  Object.assign(datum1D.data, reimPhaseCorrection(datum1D.data, ph0, ph1));\n}\n\nexport function isApplicable(datum1D) {\n  if (datum1D.info.isComplex && !datum1D.info.isFid) return true;\n  return false;\n}\n\nexport function reduce(previousValue, newValue) {\n  return {\n    once: true,\n    reduce: newValue,\n  };\n}\n","/**\n *\n * @param {Object} datum1d\n * @param {number} [shiftValue=0]\n */\n\nexport const id = 'shiftX';\nexport const name = 'Shift X';\n\nexport function apply(datum1D, shiftValue = 0) {\n  datum1D.data.x = datum1D.data.x.map((val) => val + shiftValue);\n}\n\nexport function isApplicable() {\n  return true;\n}\n\nexport function reduce(previousValue, newValue) {\n  return {\n    once: true,\n    reduce: previousValue + newValue,\n  };\n}\n","import { standardDeviation } from 'ml-stat/array';\n\nexport const id = 'standardDeviation';\nexport const name = 'Standard Deviation';\n\n/**\n * Computes the standard deviation of the given values\n * @param {Datum1d} datum1d\n */\n\nexport function apply(datum1D) {\n  if (!isApplicable(datum1D)) {\n    throw new Error('Standard Deviation is not applicable on this data');\n  }\n\n  const re = datum1D.data.re.slice(0);\n  const im = datum1D.data.im?.slice(0);\n\n  const reStd = standardDeviation(re);\n  const imStd = standardDeviation(im || []);\n\n  for (let i = 0; i < re.length; i++) {\n    re[i] /= reStd;\n    if (im) {\n      im[i] /= imStd;\n    }\n  }\n\n  datum1D.data.re = re;\n\n  if (im) {\n    datum1D.data.im = im;\n  }\n}\n\nexport function isApplicable(datum1D) {\n  if (datum1D.info.isComplex && !datum1D.info.isFid) return true;\n  return false;\n}\n\nexport function reduce() {\n  return {\n    once: false,\n    reduce: null,\n  };\n}\n","export const id = 'zeroFilling';\nexport const name = 'Zero Filling';\n/**\n *\n * @param {Datum1d} datum1d\n * @param {Object} [size]\n */\nexport function apply(datum1D, size) {\n  if (!isApplicable(datum1D)) {\n    throw new Error('zeroFilling not applicable on this data');\n  }\n\n  let digitalFilterApplied = datum1D.filters.some(\n    (e) => e.name === 'digitalFilter' && e.flag,\n  );\n\n  let grpdly = datum1D.info.digitalFilter;\n  let pointsToShift;\n  if (grpdly > 0 && digitalFilterApplied) {\n    pointsToShift = Math.floor(grpdly);\n  } else {\n    pointsToShift = 0;\n  }\n\n  const { re, im, x } = datum1D.data;\n\n  let newRE = new Float64Array(size);\n  let newIM = new Float64Array(size);\n  let newX = new Float64Array(size);\n\n  const length = Math.min(size, re.length);\n\n  newRE.set(re.slice(0, length - pointsToShift));\n  newIM.set(im.slice(0, length - pointsToShift));\n  newX.set(x.slice(0, length - pointsToShift));\n\n  let diff = x[1] - x[0];\n  let currentX = x[length - pointsToShift - 1];\n  for (let i = length - pointsToShift; i < size; i++) {\n    currentX += diff;\n    newX[i] = currentX;\n  }\n\n  if (pointsToShift > 0 && pointsToShift < size) {\n    newRE.set(re.slice(re.length - pointsToShift), size - pointsToShift);\n    newIM.set(im.slice(re.length - pointsToShift), size - pointsToShift);\n  }\n\n  datum1D.data = { ...datum1D.data, ...{ re: newRE, im: newIM, x: newX } };\n}\n\nexport function isApplicable(datum1D) {\n  if (datum1D.info.isComplex && datum1D.info.isFid) return true;\n  return false;\n}\n\nexport function reduce(_previousValue, newValue) {\n  return {\n    once: true,\n    reduce: newValue,\n  };\n}\n","/**\n *\n * @param {Object} datum2d\n * @param {number} [shiftValue=0]\n */\n\nexport const id = 'shift2DX';\nexport const name = 'Shift 2D X';\n\nexport function apply(datum2D, shiftValue = 0) {\n  datum2D.data.minX += shiftValue;\n  datum2D.data.maxX += shiftValue;\n}\n\nexport function isApplicable() {\n  return true;\n}\n\nexport function reduce(previousValue, newValue) {\n  return {\n    once: true,\n    reduce: previousValue + newValue,\n  };\n}\n","/**\n *\n * @param {Object} datum2d\n * @param {number} [shiftValue=0]\n */\n\nexport const id = 'shift2DY';\nexport const name = 'Shift 2D Y';\n\nexport function apply(datum2D, shiftValue = 0) {\n  datum2D.data.minY += shiftValue;\n  datum2D.data.maxY += shiftValue;\n}\n\nexport function isApplicable() {\n  return true;\n}\n\nexport function reduce(previousValue, newValue) {\n  return {\n    once: true,\n    reduce: previousValue + newValue,\n  };\n}\n","const BASE62 = '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ';\n\nconst LENGTH = 8;\n\nexport default function generateID(): string {\n  let id = '';\n  for (let i = 0; i < LENGTH; i++) {\n    id += BASE62.charAt(Math.floor(Math.random() * 62));\n  }\n  return id;\n}\n","/* eslint-disable import/namespace */\nimport * as Filters from './Filters';\nimport generateID from './utilities/generateID';\n\nexport interface Filter {\n  id: string;\n  name: string;\n  label: string;\n  isDeleteAllow: boolean;\n  flag: boolean;\n  value: any;\n}\n\n/***\n * @param {object} Filters [{name:'',options:{}},{...}]\n */\nfunction applyFilter(datum, filters: any[] = []) {\n  let isReduced = false;\n  for (let filter of filters) {\n    const filterOption = {\n      name: filter.name,\n      label: Filters[filter.name].name,\n      value: filter.options,\n    };\n    const previousFilter = lookupForFilter(datum, filter.name);\n    if (previousFilter) {\n      const reduceResult = Filters[filter.name].reduce(\n        previousFilter.value,\n        filterOption.value,\n      );\n      if (reduceResult.once) {\n        if (!isReduced) {\n          isReduced = true;\n        }\n        if (reduceResult.reduce != null && reduceResult.reduce !== undefined) {\n          replaceFilter(datum, previousFilter.id, reduceResult.reduce);\n        }\n      } else {\n        addFilter(\n          datum,\n          filterOption,\n          Object.prototype.hasOwnProperty.call(filter, 'isDeleteAllow')\n            ? filter.isDeleteAllow\n            : true,\n        );\n      }\n    } else {\n      addFilter(\n        datum,\n        filterOption,\n        Object.prototype.hasOwnProperty.call(filter, 'isDeleteAllow')\n          ? filter.isDeleteAllow\n          : true,\n      );\n    }\n  }\n  if (isReduced) {\n    if (filters.length === 1 && isLastFilter(datum, filters[0].name)) {\n      Filters[filters[0].name].apply(datum, filters[0].options);\n    } else {\n      reapplyFilters(datum);\n    }\n  } else {\n    for (let filter of filters) {\n      Filters[filter.name].apply(datum, filter.options);\n    }\n  }\n}\n\nfunction isLastFilter(datum, id) {\n  const index = datum.filters.findIndex((f) => f.name === id);\n  if (datum.filters.length === index + 1) {\n    return true;\n  }\n  return false;\n}\n\nfunction lookupForFilter(datum, filterName) {\n  return datum.filters.find((f) => f.name === filterName);\n}\n\nfunction reapplyFilters(datum, filters: any = null) {\n  const _filters = filters ? filters : datum.filters;\n  enableFilter(datum, null, null, _filters);\n}\n\n// id filter id\nfunction enableFilter(datum, id, checked, filters = null) {\n  datum.filters = datum.filters.slice(0);\n  if (id) {\n    datum.filters = datum.filters.map((filter) => {\n      return { ...filter, flag: filter.id === id ? checked : filter.flag };\n    }, []);\n  }\n  datum.data = { ...datum.data, ...datum.originalData };\n  datum.info = { ...datum.info, ...datum.originalInfo };\n  const _filters = filters ? filters : datum.filters;\n  for (let filterIndex in _filters) {\n    const filter = datum.filters[filterIndex];\n    datum.filters[filterIndex] = {\n      ...datum.filters[filterIndex],\n      error: null,\n    };\n\n    if (filter.flag) {\n      try {\n        Filters[filter.name].apply(datum, filter.value);\n      } catch (error: any) {\n        datum.filters[filterIndex] = {\n          ...datum.filters[filterIndex],\n          error: error.message,\n        };\n      }\n    }\n  }\n}\nfunction deleteFilter(datum, id) {\n  datum.filters = datum.filters.slice(0);\n  datum.filters = datum.filters.filter((filter) => filter.id !== id);\n  datum.data = { ...datum.data, ...datum.originalData };\n  datum.info = { ...datum.info, ...datum.originalInfo };\n\n  for (let filterIndex in datum.filters) {\n    const filter = datum.filters[filterIndex];\n    datum.filters[filterIndex] = {\n      ...datum.filters[filterIndex],\n      error: null,\n    };\n\n    if (filter.flag) {\n      try {\n        Filters[filter.name].apply(datum, filter.value);\n      } catch (error: any) {\n        datum.filters[filterIndex] = {\n          ...datum.filters[filterIndex],\n          error: error.message,\n        };\n      }\n    }\n  }\n}\n\nfunction addFilter(datum, filter, isDeleteAllow = true) {\n  const id = generateID();\n  datum.filters = datum.filters.slice(0);\n  delete filter.isSnapshot;\n  datum.filters.push({\n    ...filter,\n    id: id,\n    flag: true,\n    isDeleteAllow,\n  });\n}\n\nfunction replaceFilter(datum, filterID, value) {\n  datum.filters = datum.filters.slice(0);\n  const index = datum.filters.findIndex((f) => f.id === filterID);\n  delete datum.filters[index].isSnapshot;\n  datum.filters[index] = {\n    ...datum.filters[index],\n    value,\n  };\n}\n\nexport { applyFilter, reapplyFilters, enableFilter, addFilter, deleteFilter };\n","export const COLORS: string[] = [\n  '#C10020',\n  '#007D34',\n  '#803E75',\n  '#FF6800',\n  '#B32851',\n  '#7F180D',\n  '#232C16',\n  '#A6BDD7',\n  '#CEA262',\n  '#817066',\n  '#FF8E00',\n  '#F6768E',\n  '#00538A',\n  '#FF7A5C',\n  '#53377A',\n  '#FFB300',\n  '#F4C800',\n  '#93AA00',\n  '#593315',\n  '#F13A13',\n];\n\ninterface TwoDColors {\n  positiveColor: string;\n  negativeColor: string;\n}\n\nconst color2D: Record<string, TwoDColors> = {\n  cosy: { positiveColor: 'darkblue', negativeColor: 'blue' },\n  roesy: { positiveColor: '#e75480', negativeColor: 'yellow' },\n  noesy: { positiveColor: '#e75480', negativeColor: 'yellow' },\n  tocsy: { positiveColor: 'green', negativeColor: 'yellow' },\n  hsqc: { positiveColor: 'black', negativeColor: 'yellow' },\n  hmbc: { positiveColor: 'darkviolet', negativeColor: 'yellow' },\n};\n\nexport function get2DColor(experiment: string, colors = []): TwoDColors {\n  if (!color2D[experiment]) {\n    const positiveColor = getColor(false, colors);\n    const negativeColor = adjustAlpha(positiveColor, 50);\n    return { positiveColor, negativeColor };\n  }\n  return color2D[experiment];\n}\n\nfunction percentToHex(p: number): string {\n  const percent = Math.max(0, Math.min(100, p));\n  const intValue = Math.round((percent / 100) * 255);\n  const hexValue = intValue.toString(16);\n  return percent === 100 ? '' : hexValue.padStart(2, '0');\n}\n\nexport function adjustAlpha(color: string, factor: number): string {\n  return color + percentToHex(factor);\n}\n\nexport default function getColor(\n  isRandom = false,\n  usedColors: string[] = [],\n  opacity = 100,\n) {\n  const resetColors = COLORS.filter((c) => !usedColors.includes(c));\n  if (resetColors.length > 0 && !isRandom) {\n    return resetColors[0] + percentToHex(opacity);\n  } else {\n    const lum = -0.25;\n    let hex = String(\n      `#${Math.random().toString(16).slice(2, 8).toUpperCase()}`,\n    ).replace(/[^0-9a-f]/gi, '');\n    if (hex.length < 6) {\n      hex = hex[0] + hex[0] + hex[1] + hex[1] + hex[2] + hex[2];\n    }\n    let rgb = '#';\n    let c: number | string;\n    for (let i = 0; i < 3; i++) {\n      c = parseInt(hex.substr(i * 2, 2), 16);\n      c = Math.round(Math.min(Math.max(0, c + c * lum), 255)).toString(16);\n      rgb += `00${c}`.substr(c.length);\n    }\n\n    return rgb + percentToHex(opacity);\n  }\n}\n","import merge from 'lodash/merge';\n\nimport { Integrals } from '../../../types/data1d';\n\nexport function initiateIntegrals(options: Partial<{ integrals: Integrals }>) {\n  return merge(\n    {\n      values: [],\n      options: {\n        sum: undefined,\n        isSumConstant: true,\n        sumAuto: true,\n      },\n    },\n    options.integrals,\n  );\n}\n","import { Datum1D } from '../../types/data1d/Datum1D';\n\nexport function getSpectrumErrorValue(datum: Datum1D) {\n  const { x } = datum.data;\n  return (x[x.length - 1] - x[0]) / 10000;\n}\n","import * as FiltersTypes from '../../../Filters';\nimport { Datum1D } from '../../../types/data1d/Datum1D';\n\nexport function getShiftX(datum: Datum1D): number {\n  const filter =\n    datum?.filters &&\n    datum?.filters.find((filter) => filter.name === FiltersTypes.shiftX.id);\n\n  return filter?.flag ? filter.value : 0;\n}\n","import { Peak, Datum1D } from '../../../types/data1d';\nimport generateID from '../../../utilities/generateID';\nimport { getSpectrumErrorValue } from '../getSpectrumErrorValue';\nimport { getShiftX } from '../shift/getShiftX';\n\nfunction checkPeak(peak: Peak, datum: Datum1D, error) {\n  // check if the Peak is already exists\n  for (const { x } of datum.peaks?.values || []) {\n    if (Math.abs(peak.x - x) < error) {\n      return true;\n    }\n  }\n  return false;\n}\n\nexport function mapPeaks(peaks: Peak[], datum: Datum1D) {\n  const shiftX = getShiftX(datum);\n\n  const error = getSpectrumErrorValue(datum);\n\n  return peaks.reduce<Peak[]>((acc, newPeak) => {\n    // check if the peak is already exists\n    if (checkPeak(newPeak, datum, error)) return acc;\n\n    acc.push({\n      id: newPeak?.id || generateID(),\n      originalX: newPeak.x - shiftX,\n      x: newPeak.x,\n      y: newPeak.y,\n      width: newPeak.width,\n    });\n\n    return acc;\n  }, []);\n}\n","import merge from 'lodash/merge';\n\nimport { Datum1D, Peaks } from '../../../types/data1d';\n\nimport { mapPeaks } from './mapPeaks';\n\nexport function initiatePeaks(\n  options: Partial<{ peaks: Peaks }>,\n  datum: Datum1D,\n) {\n  return merge({ values: [], options: {} }, options.peaks, {\n    values: mapPeaks(options?.peaks?.values || [], datum),\n  });\n}\n","import { xyIntegration } from 'ml-spectra-processing';\n\nimport { DatumKind } from '../../../constants/SignalsKinds';\nimport { Datum1D, Range } from '../../../types/data1d';\nimport generateID from '../../../utilities/generateID';\nimport { getSpectrumErrorValue } from '../getSpectrumErrorValue';\nimport { getShiftX } from '../shift/getShiftX';\n\nfunction checkRange(range: Range, datum: Datum1D, error) {\n  // check if the range is already exists\n  for (const { from, to } of datum.ranges?.values || []) {\n    if (\n      Math.abs(range.from - from) < error &&\n      Math.abs(range.to - to) < error\n    ) {\n      return true;\n    }\n  }\n}\n\nexport function mapRanges(ranges: Range[], datum: Datum1D) {\n  const { x, re } = datum.data;\n  const shiftX = getShiftX(datum);\n  const error = getSpectrumErrorValue(datum);\n  return ranges.reduce<Array<Range>>((acc, newRange) => {\n    if (checkRange(newRange, datum, error)) return acc;\n\n    const absolute = xyIntegration(\n      { x, y: re },\n      { from: newRange.from, to: newRange.to, reverse: true },\n    );\n    const signals = newRange.signals.map((signal) => {\n      const { kind = null, id, ...resSignal } = signal;\n      return {\n        kind: kind || 'signal',\n        id: id || generateID(),\n        originDelta: signal.delta - shiftX,\n        ...resSignal,\n      };\n    });\n\n    acc.push({\n      ...newRange,\n      kind: signals?.[0].kind || DatumKind.signal,\n      originFrom: newRange.from - shiftX,\n      originTo: newRange.to - shiftX,\n      id: newRange.id || generateID(),\n      absolute,\n      signals,\n    });\n\n    return acc;\n  }, []);\n}\n","import merge from 'lodash/merge';\n\nimport { Datum1D, Ranges } from '../../../types/data1d';\n\nimport { mapRanges } from './mapRanges';\n\nexport function initiateRanges(\n  options: Partial<{ ranges: Ranges }>,\n  datum: Datum1D,\n) {\n  return merge(\n    {\n      values: [],\n      options: {\n        sum: undefined,\n        isSumConstant: true,\n        sumAuto: true,\n      },\n    },\n    options.ranges,\n    {\n      values: mapRanges(options?.ranges?.values || [], datum),\n    },\n  );\n}\n","import * as FiltersTypes from '../../Filters';\nimport * as FiltersManager from '../../FiltersManager';\nimport { Datum1D } from '../../types/data1d/Datum1D';\nimport generateID from '../../utilities/generateID';\nimport get1dColor from '../../utilities/getColor';\n\nimport { initiateIntegrals } from './integrals/initiateIntegrals';\nimport { initiatePeaks } from './peaks/initiatePeaks';\nimport { initiateRanges } from './ranges/initiateRanges';\n\nexport function initiateDatum1D(options: any, usedColors = {}): Datum1D {\n  const datum: Partial<Datum1D> = {};\n  datum.id = options.id || generateID();\n  datum.source = Object.assign(\n    {\n      jcampURL: null,\n      file: {\n        binary: null,\n        name: '',\n        extension: '',\n      },\n    },\n    options.source,\n  );\n\n  datum.display = Object.assign(\n    {\n      name: options.display?.name ? options.display.name : generateID(),\n      ...getColor(options, usedColors),\n      isVisible: true,\n      isPeaksMarkersVisible: true,\n      isRealSpectrumVisible: true,\n    },\n    options.display,\n  );\n\n  datum.info = Object.assign(\n    {\n      nucleus: '1H', // 1H, 13C, 19F, ...\n      isFid: false,\n      isComplex: false, // if isComplex is true that mean it contains real/ imaginary  x set, if not hid re/im button .\n      dimension: 1,\n    },\n    options.info,\n  );\n\n  datum.originalInfo = datum.info;\n\n  datum.meta = Object.assign({}, options.meta);\n  datum.data = Object.assign(\n    {\n      x: [],\n      re: [],\n      im: [],\n    },\n    options.data,\n  );\n  datum.originalData = datum.data;\n\n  datum.filters = Object.assign([], options.filters); //array of object {name: \"FilterName\", options: FilterOptions = {value | object} }\n\n  datum.peaks = initiatePeaks(options, datum as Datum1D);\n\n  // array of object {index: xIndex, xShift}\n  // in case the peak does not exactly correspond to the point value\n  // we can think about a second attributed `xShift`\n  datum.integrals = initiateIntegrals(options); // array of object (from: xIndex, to: xIndex)\n  datum.ranges = initiateRanges(options, datum as Datum1D);\n\n  //reapply filters after load the original data\n  FiltersManager.reapplyFilters(datum);\n\n  preprocessing(datum);\n  return datum as Datum1D;\n}\n\nfunction getColor(options, usedColors) {\n  let color = 'black';\n  if (options?.display?.color === undefined) {\n    color = get1dColor(false, usedColors['1d'] || []);\n  } else {\n    color = options.display.color;\n  }\n\n  if (usedColors['1d']) {\n    usedColors['1d'].push(color);\n  }\n\n  return { color };\n}\n\nfunction preprocessing(datum) {\n  if (\n    datum.info.isFid &&\n    datum.filters.findIndex((f) => f.name === FiltersTypes.digitalFilter.id) ===\n      -1 &&\n    datum.info.digitalFilter\n  ) {\n    FiltersManager.applyFilter(datum, [\n      {\n        name: FiltersTypes.digitalFilter.id,\n        options: {\n          digitalFilterValue: datum.info.digitalFilter,\n        },\n        isDeleteAllow: false,\n      },\n    ]);\n  }\n}\n","import { rangesToXY } from 'nmr-processing';\n\nimport { UsedColors } from '../../../../types/UsedColors';\nimport { Datum1D, Range } from '../../../types/data1d';\nimport { initiateDatum1D } from '../initiateDatum1D';\n\nimport { mapRanges } from './mapRanges';\n\nexport function generateSpectrumFromRanges(\n  ranges: Range[],\n  info: {\n    nucleus: string;\n    solvent: string;\n    name?: string;\n    frequency?: number;\n    color?: string;\n  },\n  usedColors: UsedColors,\n): Datum1D {\n  const { nucleus, solvent, name = null, frequency = 400 } = info;\n  const { x, y } = rangesToXY(ranges, {\n    frequency,\n    nbPoints: 524288,\n  });\n\n  const datum = initiateDatum1D(\n    {\n      data: { x, im: null, re: y },\n      display: { name },\n      info: {\n        nucleus,\n        originFrequency: frequency,\n        baseFrequency: frequency,\n        pulseSequence: '',\n        solvent,\n        isFt: true,\n      },\n    },\n    usedColors,\n  );\n  datum.ranges.values = mapRanges(ranges, datum);\n\n  return datum;\n}\n","import { resurrect } from 'nmr-processing';\n\nimport { UsedColors } from '../../../types/UsedColors';\nimport { Datum1D } from '../../types/data1d';\n\nimport { generateSpectrumFromRanges } from './ranges/generateSpectrumFromRanges';\n\nexport function generateSpectrumFromPublicationString(\n  publicationString: string,\n  usedColors: UsedColors,\n): Datum1D {\n  const {\n    ranges,\n    experiment: { nucleus, solvent },\n    parts,\n  } = resurrect(publicationString);\n  return generateSpectrumFromRanges(\n    ranges,\n    { nucleus, solvent, name: parts[0] },\n    usedColors,\n  );\n}\n","import { Datum1D } from '../../types/data1d';\n\n/**\n * @typedef {Object} datum\n * @property {number[]} x - The X points series\n * @property {number[]} y - The Y points series\n */\n\n/**\n *\n * @param spectrum 1d spectrum\n * @returns {datum} datum object includes x and y series\n */\n\nexport function get1DDataXY(spectrum: Datum1D): {\n  x: number[];\n  y: number[];\n} {\n  const {\n    display: { isRealSpectrumVisible },\n    data: { x, re, im },\n  } = spectrum;\n\n  return { x, y: isRealSpectrumVisible ? re : im };\n}\n","interface ReferenceInfo {\n  from: number;\n  to: number;\n  nbPeaks: number;\n  delta: number;\n}\n\nexport const REFERENCES: Record<string, Record<string, ReferenceInfo>> = {\n  '1H': {\n    tms: {\n      from: -0.1,\n      to: 0.1,\n      nbPeaks: 1,\n      delta: 0,\n    },\n    tsp: {\n      from: -0.1,\n      to: 0.1,\n      nbPeaks: 1,\n      delta: 0,\n    },\n    glucose: {\n      from: 5.18,\n      to: 5.28,\n      nbPeaks: 2,\n      delta: 5.23,\n    },\n  },\n  '13C': {},\n};\n\nexport function getRange(\n  options: { nucleus?: string; reference?: string } = {},\n): ReferenceInfo {\n  const { nucleus = '1H', reference = 'tms' } = options;\n\n  if (!REFERENCES[nucleus]) {\n    throw new Error(`Nucleus not found: ${nucleus}`);\n  }\n\n  const info = REFERENCES[nucleus][reference.toLowerCase()];\n\n  if (!info) {\n    throw new Error(`Reference not found: ${reference}`);\n  }\n\n  return {\n    from: info.delta - 0.05,\n    to: info.delta + 0.05,\n    delta: info.delta,\n    nbPeaks: info.nbPeaks,\n  };\n}\n","import type { DataXY } from 'cheminfo-types';\nimport mean from 'ml-array-mean';\nimport { gsd } from 'ml-gsd';\nimport { xFindClosestIndex } from 'ml-spectra-processing';\n\nimport { getRange } from '../../constants/References';\n\n/**\n *\n * @param {*} datum1D\n * @param {object} [options={}]\n * @param {number} [options.from]\n * @param {number} [options.to] Define the from zone where the reference is expected to be found\n * @param {number} [options.from]\n * @param {number} [options.nbPeaks]\n * @param {number} [options.targetX]\n * @param {string} [options.reference]\n */\nexport function getReferenceShift(datum1D, options) {\n  let { from, to, nbPeaks, targetX, reference } = options;\n  if (reference) {\n    let data = getRange({ reference: reference, nucleus: datum1D.nucleus });\n    from = data.from;\n    to = data.to;\n    nbPeaks = data.nbPeaks;\n    targetX = data.delta;\n  }\n\n  const { re, x } = datum1D.data;\n  return xyCalibrate({ x, y: re }, { from, to }, { nbPeaks, targetX });\n}\n\n// This is a copy of the function defined in https://github.com/cheminfo/spectra-processor/blob/b87f6f6c4d45a64dc16f3f9692d5f5dc7e398e5e/src/spectrum/xyCalibrate.js\nfunction xyCalibrate(\n  data: DataXY,\n  range: { to?: number; from?: number } = {},\n  options: {\n    targetX?: number;\n    nbPeaks?: number;\n    gsd?: {\n      minMaxRatio: number;\n      realTopDetection: boolean;\n      smoothY: boolean;\n      sgOptions: {\n        windowSize: number;\n        polynomial: number;\n      };\n    };\n  } = {},\n): number {\n  const {\n    targetX = 0,\n    nbPeaks = 1,\n    gsd: gsdOptions = {\n      minMaxRatio: 0.1,\n      realTopDetection: true,\n      smoothY: true,\n      sgOptions: {\n        windowSize: 7,\n        polynomial: 3,\n      },\n    },\n  } = options;\n  let { from, to } = range;\n  if (from === undefined || to === undefined) return 0;\n\n  const fromIndex = xFindClosestIndex(data.x, from);\n  const toIndex = xFindClosestIndex(data.x, to);\n  const sliceddata = {\n    x: data.x.slice(fromIndex, toIndex) as number[],\n    y: data.y.slice(fromIndex, toIndex) as number[],\n  };\n\n  let peaks = gsd(sliceddata, gsdOptions)\n    .sort((a, b) => b.y - a.y)\n    .slice(0, nbPeaks);\n\n  if (peaks.length === 0) return 0;\n\n  const middle = mean(peaks.map((peak) => peak.x));\n\n  return targetX - middle;\n}\n","import { Datum1D, Integral } from '../../../types/data1d';\n\nexport function changeIntegralsRelative(\n  datum: Datum1D,\n  newIntegral: { id: string; value: number },\n) {\n  const index = datum.integrals.values.findIndex(\n    (integral) => integral.id === newIntegral.id,\n  );\n  if (index !== -1) {\n    const ratio = datum.integrals.values[index].absolute / newIntegral.value;\n    const { values, sum } = datum.integrals.values.reduce<{\n      sum: number;\n      values: Integral[];\n    }>(\n      (acc, integral, index) => {\n        const newIntegralValue = integral.absolute / ratio;\n        acc.sum += newIntegralValue;\n        acc.values[index] = {\n          ...integral,\n          integral: newIntegralValue,\n        };\n\n        return acc;\n      },\n      { values: [], sum: 0 },\n    );\n\n    datum.integrals.values = values;\n    datum.integrals.options = {\n      ...datum.integrals.options,\n      mf: undefined,\n      moleculeKey: undefined,\n      sumAuto: false,\n      sum,\n    };\n  }\n}\n","import { SignalKindsToInclude } from '../../../constants/SignalsKinds';\nimport { Integral } from '../../../types/data1d';\n\n/**\n * check whether integral based on its kind can be included in another operation or not\n * @param integral  integral\n * @returns {boolean}\n */\nexport function checkIntegralKind(integral: Integral): boolean {\n  return SignalKindsToInclude.includes(integral.kind);\n}\n","/**\n * Sum values for specific key in the object\n * @param values array of object\n * @param key key\n * @param check custom check function to to indicate if certain object included or not in the summation\n * @returns number\n */\n\nexport function getSum<Type>(\n  values: Type[],\n  key: keyof Extract<Type, string>,\n  check: ((value: Type) => boolean) | null = null,\n) {\n  return values.reduce((sum, current) => {\n    return check && check(current) === true\n      ? (sum += Math.abs(current[key as string]))\n      : sum;\n  }, 0);\n}\n","import { Integral, Range, Integrals, Ranges } from '../../../types/data1d';\nimport { getSum } from '../../../utilities/getSum';\n\nexport function updateRelatives<Type extends Integral | Range>(\n  data: Type extends Integral ? Integrals : Ranges,\n  key: keyof Type,\n  check: (value: Type) => boolean,\n  forceCalculateIntegral = false,\n): void {\n  const { values, options } = data;\n\n  const currentSum = getSum<Type>(values as Type[], 'absolute', check);\n\n  let factor = 0;\n  if (options.sum) {\n    if (data.options.isSumConstant || forceCalculateIntegral) {\n      factor = currentSum > 0 ? options.sum / currentSum : 0.0;\n    } else {\n      if (data.values?.[0]) {\n        const item = data.values[0];\n        factor =\n          (item[key as string] ? item[key as string] : options.sum) /\n          item.absolute;\n      }\n    }\n  }\n  data.values = data.values.map((value) => {\n    return {\n      ...value,\n      ...(check(value) && {\n        [key as string]: value.absolute * factor,\n      }),\n    };\n  });\n\n  if (!data.options.isSumConstant && !forceCalculateIntegral) {\n    data.options.sum = getSum<Type>(data.values as Type[], key, check);\n  }\n}\n","import { Datum1D, Integral } from '../../../types/data1d';\n\nimport { checkIntegralKind } from './checkIntegralKind';\nimport { updateRelatives } from './updateRelatives';\n\nexport function updateIntegralsRelativeValues(\n  datum: Datum1D,\n  forceCalculateIntegral = false,\n) {\n  updateRelatives<Integral>(\n    datum.integrals,\n    'integral',\n    checkIntegralKind,\n    forceCalculateIntegral,\n  );\n}\n","import { Datum1D } from '../../types/data1d';\nimport { Datum2D } from '../../types/data2d';\n\nexport function isSpectrum1D(spectrum: Datum1D | Datum2D): spectrum is Datum1D {\n  return spectrum.info.dimension === 1;\n}\n","import median from 'ml-array-median';\nimport { xyAutoPeaksPicking } from 'nmr-processing';\n\nimport { Datum1D, Peak } from '../../../types/data1d';\n\nimport { mapPeaks } from './mapPeaks';\n\nexport function autoPeakPicking(datum1D: Datum1D, options) {\n  const {\n    minMaxRatio,\n    maxNumberOfPeaks,\n    noiseFactor,\n    lookNegative,\n    windowFromIndex,\n    windowToIndex,\n  } = options;\n  // we calculate the noise but this could be improved\n  const noise = median(datum1D.data.re.map((y) => Math.abs(y)));\n\n  let { re, x } = datum1D.data;\n\n  if (windowFromIndex !== undefined && windowToIndex !== undefined) {\n    x = x.slice(windowFromIndex, windowToIndex);\n    re = re.slice(windowFromIndex, windowToIndex);\n  }\n\n  let peaks = xyAutoPeaksPicking(\n    { x, y: re },\n    {\n      lookNegative,\n      noiseLevel: noise * noiseFactor,\n      minMaxRatio: minMaxRatio, // Threshold to determine if a given peak should be considered as a noise\n      realTopDetection: true,\n      smoothY: false,\n      sgOptions: { windowSize: 15, polynomial: 3 },\n    },\n  );\n  peaks.sort((a, b) => b.y - a.y);\n  if (maxNumberOfPeaks < peaks.length) peaks = peaks.slice(0, maxNumberOfPeaks);\n\n  return mapPeaks(peaks as Peak[], datum1D);\n}\n","import max from 'ml-array-max';\n\nimport { Data1D } from '../../../types/data1d/Data1D';\n\n// Lookup for apeak while the mouse move\n/**\n *\n * @param {object<{x:Array<number>,re:Array<number>}>} data\n * @param  {object<{from:number,to:number}>} options\n */\n\ninterface LookupPeakOptions {\n  from: number;\n  to: number;\n}\ninterface LookupPeakResult {\n  x: number;\n  y: number;\n  xIndex: number;\n}\n\nexport function lookupPeak(\n  data: Data1D,\n  options: LookupPeakOptions,\n): LookupPeakResult | null {\n  const { from, to } = options;\n  let minIndex = data.x.findIndex((number) => number >= from);\n  let maxIndex = data.x.findIndex((number) => number >= to) - 1;\n\n  if (minIndex > maxIndex) {\n    minIndex = maxIndex;\n    maxIndex = minIndex;\n  }\n  const dataRange = data.re.slice(minIndex, maxIndex);\n  if (dataRange && dataRange.length > 0) {\n    const yValue = max(dataRange);\n    const xIndex = dataRange.findIndex((value) => value === yValue);\n    const xValue = data.x[minIndex + xIndex];\n\n    return { x: xValue, y: yValue, xIndex: minIndex + xIndex };\n  }\n  return null;\n}\n","export default function getAtom(nucleus: string): string {\n  return nucleus?.replace(/[0-9]/g, '') || '';\n}\n","import { Draft } from 'immer';\n\nimport { State } from '../../../component/reducer/Reducer';\nimport { Molecule } from '../../molecules/Molecule';\nimport { Datum1D, Integrals, Ranges } from '../../types/data1d';\nimport { SumOptions } from '../../types/data1d/SumOptions';\nimport getAtom from '../../utilities/getAtom';\n\nimport {\n  isSpectrum1D,\n  updateRangesRelativeValues,\n  updateIntegralsRelativeValues,\n} from '.';\n\nexport interface SumParams {\n  nucleus: string;\n  molecules: Molecule[];\n}\n\nexport type SetSumOptions = Omit<SumOptions, 'isSumConstant'>;\n\nexport function initSumOptions(options: SumOptions, params: SumParams) {\n  let newOptions = { ...options };\n  const { molecules, nucleus } = params;\n\n  if (options.sumAuto && Array.isArray(molecules) && molecules.length > 0) {\n    const { mf, key } = molecules[0];\n    newOptions = { ...newOptions, sumAuto: true, mf, moleculeKey: key };\n  } else {\n    const { mf, moleculeKey, ...resOptions } = newOptions;\n    newOptions = { ...resOptions, sumAuto: false };\n  }\n  if (!newOptions.sum) {\n    newOptions.sum = getSum(newOptions.mf || null, nucleus);\n  }\n\n  return newOptions;\n}\n\nexport function getSum(mf: string | null | undefined, nucleus: string) {\n  const defaultSum = 100;\n\n  if (!mf || !nucleus) return defaultSum;\n\n  const atom = getAtom(nucleus);\n  const atoms = getAtoms(mf);\n\n  return atoms[atom] ? atoms[atom] : defaultSum;\n}\n\nexport function setSumOptions(\n  data: Ranges | Integrals,\n  params: { options: SetSumOptions; nucleus: string },\n) {\n  const { nucleus, options } = params;\n  if (options.sumAuto) {\n    const { mf, moleculeKey } = options;\n    const sum = getSum(mf, nucleus);\n    data.options = { ...data.options, sumAuto: true, moleculeKey, mf, sum };\n  } else {\n    const { mf, moleculeKey, ...resOptions } = data.options;\n    data.options = { ...resOptions, sumAuto: false, sum: options.sum };\n  }\n}\n\nexport function getAtoms(mf: string): Record<string, number> {\n  const result = {};\n  // eslint-disable-next-line prefer-named-capture-group\n  const data = mf.split(/(\\d+)/);\n  for (let i = 0; i < data.length - 1; i = i + 2) {\n    result[data[i]] = Number(data[i + 1]);\n  }\n  return result;\n}\n\n/**\n * change the sum for ranges and integrals in all spectra based on molecule\n * it handle three cases\n * 1 - edit and existing molecule\n * 2- delete molecule / edit molecule and as a result of that it generate more than one molecule\n * 3- add a molecule for the first time\n * @param draft     State draft\n * @param molKey    Molecule key\n * @param molecule  Molecules list\n */\nexport function changeSpectraRelativeSum(\n  draft: Draft<State>,\n  molKey: string,\n  molecule: Molecule,\n) {\n  const keys: (keyof Datum1D)[] = ['ranges', 'integrals'];\n\n  for (const spectrum of draft.data) {\n    if (isSpectrum1D(spectrum)) {\n      for (const key of keys) {\n        const { moleculeKey, mf, sumAuto } = spectrum[key].options;\n\n        if ((molKey === moleculeKey || (!moleculeKey && !mf)) && sumAuto) {\n          const options: Partial<SetSumOptions> = molecule\n            ? {\n                mf: molecule.mf,\n                moleculeKey: molecule.key,\n              }\n            : {\n                mf: undefined,\n                moleculeKey: undefined,\n              };\n\n          setSumOptions(spectrum[key], {\n            nucleus: spectrum.info.nucleus,\n            options: { ...options, sumAuto: true, sum: undefined },\n          });\n          updateRangesRelativeValues(spectrum, true);\n          updateIntegralsRelativeValues(spectrum, true);\n        }\n      }\n    }\n  }\n}\n","import { DatumKind } from '../constants/SignalsKinds';\nimport { Range } from '../types/data1d';\n\nexport function getDiaIDs(range: Range): string[] {\n  return ([] as string[]).concat(\n    range.diaIDs || [],\n    range.signals\n      ? range.signals.map((_signal) => _signal.diaIDs || []).flat()\n      : [],\n  );\n}\n\nexport function getNbAtoms(range: Range, signalIndex?: number): number {\n  if (signalIndex === undefined) {\n    return range.signals\n      ? range.signals.reduce(\n          (sum, signal) => (signal.nbAtoms ? signal.nbAtoms + sum : sum),\n          0,\n        )\n      : 0;\n  }\n\n  return range.signals[signalIndex].nbAtoms || 0;\n}\n\nexport function setNbAtoms(range: Range, signalIndex?: number): void {\n  range.nbAtoms = getNbAtoms(range, signalIndex);\n  if (range.nbAtoms === 0) {\n    delete range.nbAtoms;\n  }\n}\n\nexport function resetDiaIDs(range: Range): void {\n  delete range.diaIDs;\n  delete range.nbAtoms;\n  range.signals.forEach((_signal) => {\n    delete _signal.diaIDs;\n    delete _signal.nbAtoms;\n  });\n  delete range.nbAtoms;\n}\n\n/**\n *\n * @param {object} range\n * @param {String('both' | 'range' | 'signal')} unlinkType\n * @param {object} options\n * @param {number} [options.signalIndex]\n * @returns {object}\n */\nexport function unlink(\n  range: Range,\n  unlinkType = 'both',\n  options: any = {},\n): Range {\n  switch (unlinkType) {\n    case 'both':\n      resetDiaIDs(range);\n      break;\n    case 'range':\n      delete range.diaIDs;\n      delete range.nbAtoms;\n      break;\n    case 'signal':\n      delete range.signals[options.signalIndex].diaIDs;\n      delete range.signals[options.signalIndex].nbAtoms;\n      break;\n    default:\n      break;\n  }\n\n  setNbAtoms(range);\n\n  return range;\n}\n\nexport function addDefaultSignal(range) {\n  range.signals.push({\n    multiplicity: 'm',\n    kind: 'signal',\n    delta: (range.to + range.from) / 2,\n  });\n}\n\nexport function checkRangeKind(range) {\n  return range.kind === DatumKind.signal;\n}\n\nexport function checkSignalKinds(range, kinds) {\n  return !range.signals.some(\n    (_signal) => _signal.kind === undefined || !kinds.includes(_signal.kind),\n  );\n}\n\nexport function unlinkInAssignmentData(\n  assignmentData,\n  ranges: Partial<Range>[],\n) {\n  const ids = ranges.reduce((acc: string[], range) => {\n    if (range.id) {\n      acc.push(range.id);\n    }\n    if (range.signals) {\n      acc = acc.concat(range.signals.map((signal) => signal.id, []));\n    }\n    return acc;\n  }, []);\n  assignmentData.dispatch({\n    type: 'REMOVE_ALL',\n    payload: { id: ids, axis: 'x' },\n  });\n}\n","import { SignalKindsToInclude } from '../../../constants/SignalsKinds';\nimport { Range } from '../../../types/data1d';\nimport { checkSignalKinds } from '../../../utilities/RangeUtilities';\n\nexport function checkRangeKind(range: Range): boolean {\n  return range.signals && checkSignalKinds(range, SignalKindsToInclude);\n}\n","import { Datum1D } from '../../../types/data1d/Datum1D';\nimport { updateRelatives } from '../integrals/updateRelatives';\n\nimport { checkRangeKind } from './checkRangeKind';\n\nexport function updateRangesRelativeValues(\n  datum: Datum1D,\n  forceCalculateIntegral = false,\n) {\n  updateRelatives(\n    datum.ranges,\n    'integration',\n    checkRangeKind,\n    forceCalculateIntegral,\n  );\n}\n","import { xyIntegration } from 'ml-spectra-processing';\n\nimport { DatumKind } from '../../../constants/SignalsKinds';\nimport { Datum1D } from '../../../types/data1d/Datum1D';\nimport generateID from '../../../utilities/generateID';\nimport { initSumOptions, SumParams } from '../SumManager';\n\nimport detectSignal from './detectSignal';\nimport { mapRanges } from './mapRanges';\nimport { updateRangesRelativeValues } from './updateRangesRelativeValues';\n\ninterface AddRangeOptions {\n  from: number;\n  to: number;\n}\n\nexport function addRange(datum: Datum1D, options: AddRangeOptions & SumParams) {\n  const { from, to, molecules, nucleus } = options;\n  const { x, re } = datum.data;\n  const absolute = xyIntegration({ x, y: re }, { from, to, reverse: true });\n\n  // detectSignal use the advance multiplet-analysis that can crash if too many points\n  const signal = detectSignal(\n    x as unknown as Float64Array,\n    re as unknown as Float64Array,\n    from,\n    to,\n    datum.info.originFrequency,\n  );\n  if (!signal) return;\n  try {\n    const range = {\n      id: generateID(),\n      from,\n      to,\n      absolute, // the real value,\n      signals: [{ id: generateID(), ...signal }],\n      kind: DatumKind.signal,\n      integration: 0,\n    };\n\n    datum.ranges.options = initSumOptions(datum.ranges.options, {\n      molecules,\n      nucleus,\n    });\n\n    datum.ranges.values = datum.ranges.values.concat(mapRanges([range], datum));\n    updateRangesRelativeValues(datum);\n  } catch (e) {\n    throw new Error('Could not calculate the multiplicity');\n  }\n}\n","import { xyIntegration } from 'ml-spectra-processing';\n\nimport { Datum1D, Range } from '../../../types/data1d';\n\nimport { updateRangesRelativeValues } from './updateRangesRelativeValues';\n\nexport function changeRange(datum: Datum1D, range: Range) {\n  const { from, to } = range;\n  const { x, re } = datum.data;\n\n  const index = datum.ranges.values.findIndex((i) => i.id === range.id);\n  const absolute = xyIntegration({ x, y: re }, { from, to, reverse: true });\n\n  if (index !== -1) {\n    datum.ranges.values[index] = {\n      ...datum.ranges.values[index],\n      originFrom: from,\n      originTo: to,\n      ...range,\n      absolute,\n    };\n    updateRangesRelativeValues(datum);\n  }\n}\n","import { Datum1D } from '../../../types/data1d';\n\ninterface RangeProps {\n  id: string; // id of the selected range\n  value: number; // New relative value\n}\n\n/**\n * Change Range relative value and re-calculate the relative values for the other ranges\n * @param {Datum1D} datum  spectrum 1d\n * @param {RangeProps} newRange\n */\nexport function changeRangeRelativeValue(datum: Datum1D, newRange: RangeProps) {\n  const index = datum.ranges.values.findIndex(\n    (range) => range.id === newRange.id,\n  );\n  if (index !== -1 && datum.ranges.options.sum) {\n    const { absolute, integration } = datum.ranges.values[index];\n    const ratio = absolute / newRange.value;\n    const sum = (newRange.value / integration) * datum.ranges.options.sum;\n    datum.ranges.options = {\n      ...datum.ranges.options,\n      mf: undefined,\n      moleculeKey: undefined,\n      sumAuto: false,\n      sum,\n    };\n\n    datum.ranges.values = datum.ranges.values.map((range) => {\n      return {\n        ...range,\n        integration: range.absolute / ratio,\n      };\n    });\n  }\n}\n","import { Datum1D } from '../../../types/data1d/Datum1D';\n\ninterface RangeSignalOption {\n  rangeID: string;\n  signalID: string;\n  newSignalValue: number;\n}\n\nexport function changeRangeSignal(datum: Datum1D, options: RangeSignalOption) {\n  const { rangeID, signalID, newSignalValue } = options;\n\n  let shiftValue = 0;\n  const rangeIndex = datum.ranges.values.findIndex(\n    (range) => range.id === rangeID,\n  );\n  if (rangeIndex !== -1) {\n    const signalIndex = datum.ranges.values[rangeIndex].signals.findIndex(\n      (signal) => signal.id === signalID,\n    );\n    shiftValue =\n      newSignalValue -\n      datum.ranges.values[rangeIndex].signals[signalIndex].delta;\n    datum.ranges.values[rangeIndex].signals[signalIndex].delta = newSignalValue;\n  }\n  return shiftValue;\n}\n","import { xyIntegration, xyMaxYPoint, xyMinYPoint } from 'ml-spectra-processing';\n\nimport { RangeDetectionResult, Datum1D } from '../../../types/data1d';\nimport generateID from '../../../utilities/generateID';\nimport { getShiftX } from '../shift/getShiftX';\n\ninterface DetectRangeOptions {\n  from: number;\n  to: number;\n}\n\nexport function detectRange(\n  datum: Datum1D,\n  options: DetectRangeOptions,\n): RangeDetectionResult {\n  const { from, to } = options;\n  const { x, re: y } = datum.data;\n\n  const absolute = xyIntegration({ x, y }, { from, to, reverse: true });\n  const min = xyMinYPoint({ x, y }, { from, to }).y;\n  const max = xyMaxYPoint({ x, y }, { from, to }).y;\n\n  const shiftX = getShiftX(datum);\n\n  return {\n    id: generateID(),\n    originFrom: from - shiftX,\n    originTo: to - shiftX,\n    from,\n    to,\n    absolute, // the real value,\n    min,\n    max,\n  };\n}\n","import { xyAutoRangesPicking } from 'nmr-processing';\n\nimport { Datum1D, Range } from '../../../types/data1d';\n\nconst defaultPeakPickingOptions = {\n  minMaxRatio: 1,\n  realTopDetection: true,\n  maxCriteria: true,\n  smoothY: false,\n  integrationSum: 100,\n  factorStd: 5,\n  clean: true,\n  sgOptions: { windowSize: 7, polynomial: 3 },\n};\n\nexport default function autoRangesDetection(\n  datum1D: Datum1D,\n  options: any = {},\n): Range[] {\n  // we calculate the noise but this could be improved\n\n  let { re, x } = datum1D.data;\n\n  const { originFrequency, nucleus } = datum1D.info;\n\n  const { windowFromIndex, windowToIndex, peakPicking } = options;\n\n  const peakPickingOptions = {\n    ...defaultPeakPickingOptions,\n    ...peakPicking,\n  };\n\n  const rangesOptions = {\n    frequency: originFrequency,\n    nucleus,\n    compile: true,\n    frequencyCluster: 13,\n    keepPeaks: true,\n  };\n\n  if (windowFromIndex !== undefined && windowToIndex !== undefined) {\n    x = x.slice(windowFromIndex, windowToIndex);\n    re = re.slice(windowFromIndex, windowToIndex);\n  }\n\n  if (originFrequency) {\n    // we calculate the number of points per Hz\n    let pointsPerHz = 1 / originFrequency / (x[1] - x[0]);\n    // we can consider a peak with of 0.5 Hz for the windowSize\n    let ws = Math.max(Math.round(pointsPerHz / 2), 5);\n    peakPickingOptions.sgOptions = {\n      windowSize: ws - (ws % 2) + 1,\n      polynomial: 3,\n    };\n  }\n  peakPickingOptions.smoothY = undefined;\n  peakPickingOptions.sgOptions = undefined;\n\n  const ranges = xyAutoRangesPicking(\n    { x, y: re },\n    {\n      peakPicking: peakPickingOptions,\n      ranges: rangesOptions,\n    },\n  );\n  return ranges as Range[];\n}\n","import { Datum1D } from '../../../types/data1d/Datum1D';\nimport { initSumOptions, SumParams } from '../SumManager';\n\nimport autoRangesDetection from './autoRangesDetection';\nimport { mapRanges } from './mapRanges';\nimport { updateRangesRelativeValues } from './updateRangesRelativeValues';\n\ninterface DetectRangesOptions {\n  windowFromIndex?: number;\n  windowToIndex?: number;\n  peakPicking: {\n    factorStd: number; // default 8\n    minMaxRatio: number; // default 0.1\n    integrationSum: number; // default 100\n    compile: boolean; //default true\n    frequencyCluster: number; // default 16\n    clean: boolean; // default true\n    keepPeaks: boolean; //default true\n  };\n  impurities?: {\n    solvent: string;\n  };\n}\n\nexport function detectRanges(\n  datum: Datum1D,\n  options: DetectRangesOptions & SumParams,\n) {\n  const { molecules, nucleus, ...detectOptions } = options;\n  detectOptions.impurities = { solvent: datum.info.solvent || '' };\n  const ranges = autoRangesDetection(datum, detectOptions);\n  datum.ranges.options = initSumOptions(datum.ranges.options, {\n    molecules,\n    nucleus,\n  });\n  datum.ranges.values = datum.ranges.values.concat(mapRanges(ranges, datum));\n  updateRangesRelativeValues(datum);\n}\n","import { Datum1D } from '../../../../types/data1d';\n\nexport function updateIntegralXShift(datum: Datum1D, shiftValue: number) {\n  datum.integrals.values = datum.integrals.values.map((integral) => ({\n    ...integral,\n    from: integral.originFrom + shiftValue,\n    to: integral.originTo + shiftValue,\n  }));\n}\n","import { xFindClosestIndex } from 'ml-spectra-processing';\n\nimport { Datum1D, Peak } from '../../../../types/data1d';\n\nexport function updatePeaksXShift(datum: Datum1D, shiftValue: number) {\n  datum.peaks.values = datum.peaks.values.map<Peak>((peak) => {\n    const delta = peak.originalX + shiftValue;\n    const xIndex = xFindClosestIndex(datum.data.x, delta);\n    return {\n      ...peak,\n      y: datum.data.re[xIndex],\n      x: peak.originalX + shiftValue,\n    };\n  });\n}\n","import { Datum1D } from '../../../../types/data1d';\n\nexport function updateRangesXShift(datum: Datum1D, shiftValue: number) {\n  datum.ranges.values = datum.ranges.values.map((range) => ({\n    ...range,\n    from: (range.originFrom || 0) + shiftValue,\n    to: (range.originTo || 0) + shiftValue,\n    signals:\n      range?.signals &&\n      range.signals.map((s) => ({\n        ...s,\n        delta: (s.originDelta || 0) + shiftValue,\n      })),\n  }));\n}\n","import { Datum1D } from '../../../types/data1d';\n\nimport { getShiftX } from './getShiftX';\nimport { updateIntegralXShift } from './internal/updateIntegralXShift';\nimport { updatePeaksXShift } from './internal/updatePeaksXShift';\nimport { updateRangesXShift } from './internal/updateRangesXShift';\n\nexport function updateXShift(datum: Datum1D) {\n  const shiftX = getShiftX(datum);\n  updatePeaksXShift(datum, shiftX);\n  updateRangesXShift(datum, shiftX);\n  updateIntegralXShift(datum, shiftX);\n}\n","export const DEFAULT_YAXIS_SHIFT_VALUE = 20;\n\nexport enum DISPLAYER_MODE {\n  DM_1D = '1D',\n  DM_2D = '2D',\n}\n\nexport const MARGIN = {\n  '2D': { top: 100, right: 50, bottom: 70, left: 100 },\n  '1D': {\n    top: 10,\n    right: 10,\n    bottom: 70,\n    left: 10,\n  },\n};\n","import { initiateDatum1D } from './Spectrum1D';\n\nexport function fromBruker(result, options = {}, usedColors = {}) {\n  const { dependentVariables, info, meta, source } = result;\n  let data = getData(dependentVariables[0].components);\n  if (data.im) info.isComplex = true;\n\n  if (Array.isArray(info.nucleus)) info.nucleus = info.nucleus[0];\n\n  const datum1D = initiateDatum1D(\n    {\n      ...options,\n      source,\n      info,\n      meta,\n      data,\n    },\n    usedColors,\n  );\n\n  return datum1D;\n}\n\nexport function fromCSD(result, options = {}, usedColors = {}) {\n  let dimension = result.dimensions[0];\n  let dependentVariables = result.dependentVariables;\n\n  let quantityName = dimension.quantityName;\n  let n = dimension.count;\n  let incr = dimension.increment.magnitude;\n  let origin = dimension.originOffset.magnitude;\n  let offset = dimension.coordinatesOffset.magnitude;\n\n  let buffer = dependentVariables[0].components[0];\n  let re: number[] = [];\n  let im: number[] = [];\n  for (let i = buffer.length - 1; i > 0; i -= 2) {\n    re.push(buffer[i - 1]);\n    im.push(buffer[i]);\n  }\n\n  let data: any = {};\n  let i, x0;\n  switch (quantityName) {\n    case 'frequency':\n      x0 = 0 + (offset / origin) * 1000000;\n      i = (incr / origin) * 1000000;\n      data.re = re;\n      data.im = im;\n      break;\n    case 'time':\n      x0 = origin;\n      i = incr;\n      data.re = re.reverse();\n      data.im = im.reverse().map((z) => -z);\n      break;\n    default:\n      break;\n  }\n\n  let scale: number[] = [];\n  for (let x = 0; x < n; x++) {\n    scale.push(x0 + x * i);\n  }\n\n  data.x = scale;\n\n  const datum1D = initiateDatum1D(\n    {\n      ...options,\n      data,\n    },\n    usedColors,\n  );\n  return datum1D;\n}\n\nexport function fromParsedJcamp(\n  parsedJcamp,\n  options,\n  usedColors,\n  jcampSpectrumIndex: number,\n) {\n  const { dependentVariables, info, meta } = parsedJcamp;\n  let data = getData(dependentVariables[0].components);\n  if (Array.isArray(info.nucleus)) info.nucleus = info.nucleus[0];\n  const datum1D = initiateDatum1D(\n    {\n      ...options,\n      source: { ...options.source, jcampSpectrumIndex },\n      display: {\n        ...options.display,\n        name: options?.display?.name ? options.display.name : info?.title,\n      },\n      info,\n      meta,\n      data,\n    },\n    usedColors,\n  );\n\n  return datum1D;\n}\n\nfunction getData(spectra) {\n  let x = spectra[0]?.data?.x ? spectra[0].data.x : [];\n  let re = spectra[0]?.data?.y ? spectra[0].data.y : [];\n  let im = spectra[1]?.data?.y ? spectra[1].data.y : null;\n\n  if (x[0] > x[1]) {\n    x.reverse();\n    re.reverse();\n    if (im) im.reverse();\n  }\n  return { x, re, im };\n}\n","import { zoneToX } from 'ml-spectra-processing';\n\nimport { UsedColors } from '../../../types/UsedColors';\nimport { initiateDatum1D } from '../../data1d/Spectrum1D';\nimport { Datum2D } from '../../types/data2d/Datum2D';\n\n/**\n * calculate the missing projection\n */\n\nexport function getMissingProjection(\n  datum: Datum2D,\n  nucleus: string,\n  usedColors: UsedColors,\n) {\n  let index = datum.info.nucleus.indexOf(nucleus);\n  // temporary because nucleus was undefined;\n  if (index === -1) index = 0;\n\n  let info = {\n    nucleus: datum.info.nucleus[index], // 1H, 13C, 19F, ...\n    isFid: false,\n    isComplex: false, // if isComplex is true that mean it contains real/ imaginary  x set, if not hid re/im button .\n    dimension: 1,\n  };\n\n  let from = index === 0 ? datum.data.minX : datum.data.minY;\n  let to = index === 0 ? datum.data.maxX : datum.data.maxY;\n  let nbPoints = index === 0 ? datum.data.z[0].length : datum.data.z.length;\n  let projection = new Float64Array(nbPoints);\n  if (index === 1) {\n    for (let i = 0; i < datum.data.z.length; i++) {\n      for (let j = 0; j < datum.data.z[0].length; j++) {\n        projection[i] += datum.data.z[i][j];\n      }\n    }\n  } else {\n    for (let i = 0; i < datum.data.z[0].length; i++) {\n      for (const z of datum.data.z) {\n        projection[i] += z[i];\n      }\n    }\n  }\n\n  let data = {\n    x: zoneToX({ from, to }, nbPoints),\n    re: projection,\n  };\n  return initiateDatum1D({ info, data }, usedColors);\n}\n","import { zoneToX } from 'ml-spectra-processing';\n\nimport { initiateDatum1D } from '../../data1d/Spectrum1D';\nimport { Datum2D } from '../../types/data2d';\n\n/** get 2d projection\n * @param {number} x in ppm\n * @param {number} y in ppm\n */\n\ninterface SlicePosition {\n  x: number;\n  y: number;\n}\n\nexport function getSlice(spectrum: Datum2D, position: SlicePosition) {\n  const data = spectrum.data;\n  const xStep = (data.maxX - data.minX) / (data.z[0].length - 1);\n  const yStep = (data.maxY - data.minY) / (data.z.length - 1);\n  const xIndex = Math.floor((position.x - data.minX) / xStep);\n  const yIndex = Math.floor((position.y - data.minY) / yStep);\n\n  if (xIndex < 0 || xIndex >= data.z[0].length) return;\n  if (yIndex < 0 || yIndex >= data.z.length) return;\n\n  let infoX = {\n    nucleus: spectrum.info.nucleus[0], // 1H, 13C, 19F, ...\n    isFid: false,\n    isComplex: false, // if isComplex is true that mean it contains real/ imaginary  x set, if not hid re/im button .\n    dimension: 1,\n  };\n\n  let dataX = {\n    x: zoneToX(\n      { from: spectrum.data.minX, to: spectrum.data.maxX },\n      spectrum.data.z[0].length,\n    ),\n    re: new Float64Array(spectrum.data.z[0].length),\n  };\n\n  for (let i = 0; i < spectrum.data.z[0].length; i++) {\n    dataX.re[i] += spectrum.data.z[yIndex][i];\n  }\n\n  let infoY = {\n    nucleus: spectrum.info.nucleus[1], // 1H, 13C, 19F, ...\n    isFid: false,\n    isComplex: false, // if isComplex is true that mean it contains real/ imaginary  x set, if not hid re/im button .\n    dimension: 1,\n  };\n\n  let dataY = {\n    x: zoneToX(\n      { from: spectrum.data.minY, to: spectrum.data.maxY },\n      spectrum.data.z.length,\n    ),\n    re: new Float64Array(spectrum.data.z.length),\n  };\n\n  let index = spectrum.data.z.length - 1;\n  for (let i = 0; i < spectrum.data.z.length; i++) {\n    dataY.re[i] += spectrum.data.z[index--][xIndex];\n  }\n\n  const horizontal = initiateDatum1D({ info: infoX, data: dataX }, {});\n  const vertical = initiateDatum1D({ info: infoY, data: dataY }, {});\n  return { horizontal, vertical };\n}\n","import { Conrec } from 'ml-conrec';\n\nexport const defaultContourOptions = {\n  positive: {\n    contourLevels: [0, 21],\n    numberOfLayers: 10,\n  },\n  negative: {\n    contourLevels: [0, 21],\n    numberOfLayers: 10,\n  },\n};\n\nexport default class Processing2D {\n  private options: any;\n  private currentLevelPositive: number;\n  private currentLevelNegative: number;\n  private conrec: Conrec;\n  private median: number;\n  private minMax: any;\n\n  public constructor(\n    minMax: any,\n    options: any = defaultContourOptions,\n    defaultLevel: any = {\n      positive: 10,\n      negative: 10,\n    },\n  ) {\n    this.options = options;\n    const { positive, negative } = defaultLevel;\n\n    this.currentLevelPositive = positive;\n    this.currentLevelNegative = negative;\n\n    const xs = getRange(minMax.minX, minMax.maxX, minMax.z[0].length);\n\n    const ys = getRange(minMax.minY, minMax.maxY, minMax.z.length);\n\n    this.conrec = new Conrec(minMax.z, { xs, ys, swapAxes: false });\n\n    this.median = minMax.noise;\n\n    this.minMax = minMax;\n  }\n\n  public getLevel() {\n    return {\n      levelPositive: this.currentLevelPositive,\n      levelNegative: this.currentLevelNegative,\n    };\n  }\n\n  public setLevel(levelPositive, levelNegative) {\n    this.currentLevelPositive = levelPositive;\n    this.currentLevelNegative = levelNegative;\n  }\n\n  public setOptions(options) {\n    const positiveBoundary = options.positive.contourLevels;\n    const negativeBoundary = options.negative.contourLevels;\n\n    if (this.currentLevelPositive >= positiveBoundary[1]) {\n      this.currentLevelPositive = positiveBoundary[1];\n    } else if (this.currentLevelPositive <= positiveBoundary[0]) {\n      this.currentLevelPositive = positiveBoundary[0];\n    }\n\n    if (this.currentLevelNegative >= negativeBoundary[1]) {\n      this.currentLevelNegative = negativeBoundary[1];\n    } else if (this.currentLevelNegative <= negativeBoundary[0]) {\n      this.currentLevelNegative = negativeBoundary[0];\n    }\n\n    this.options = options;\n  }\n\n  public wheel(value) {\n    const sign = Math.sign(value);\n    const positiveBoundary = this.options.positive.contourLevels;\n    const negativeBoundary = this.options.negative.contourLevels;\n\n    if (\n      (this.currentLevelPositive > positiveBoundary[0] && sign === -1) ||\n      (this.currentLevelPositive < positiveBoundary[1] && sign === 1)\n    ) {\n      this.currentLevelPositive += sign;\n    }\n\n    if (\n      (this.currentLevelNegative > negativeBoundary[0] && sign === -1) ||\n      (this.currentLevelNegative < negativeBoundary[1] && sign === 1)\n    ) {\n      this.currentLevelNegative += sign;\n    }\n  }\n\n  public shiftWheel(value) {\n    const sign = Math.sign(value);\n    const [min, max] = this.options.positive.contourLevels;\n    if (\n      (this.currentLevelPositive === min && sign === -1) ||\n      (this.currentLevelPositive >= max && sign === 1)\n    ) {\n      return;\n    }\n\n    this.currentLevelPositive += sign;\n    return [];\n  }\n\n  public drawContours() {\n    const zoomPositive = this.currentLevelPositive / 2 + 1;\n    const zoomNegative = this.currentLevelNegative / 2 + 1;\n    const {\n      positive: { numberOfLayers: numberOfPositiveLayer },\n      negative: { numberOfLayers: numberOfNegativeLayer },\n    } = this.options;\n    return {\n      positive: this.getContours(zoomPositive, {\n        nbLevels: numberOfPositiveLayer,\n      }),\n      negative: this.getContours(zoomNegative, {\n        negative: true,\n        nbLevels: numberOfNegativeLayer,\n      }),\n    };\n  }\n\n  public getContours(zoomLevel, options: any = {}) {\n    const { negative = false, timeout = 2000, nbLevels = 10 } = options;\n\n    const max = Math.max(\n      Math.abs(this.minMax.maxZ),\n      Math.abs(this.minMax.minZ),\n    );\n\n    let _range = getRange(\n      this.median * 1 * Math.pow(2, zoomLevel),\n      max,\n      nbLevels,\n      2,\n    );\n\n    if (negative) {\n      _range = _range.map((value) => -value);\n    }\n    let contours = [];\n    try {\n      contours = this.conrec.drawContour({\n        contourDrawer: 'basic', // shape or basic\n        levels: _range,\n        timeout: timeout,\n      });\n    } catch (e) {\n      // eslint-disable-next-line no-console\n      console.log(e);\n      throw e;\n    }\n\n    return contours;\n  }\n}\n\nfunction getRange(min: number, max: number, length: number, exp?: number) {\n  if (exp !== undefined) {\n    const factors: number[] = [];\n\n    factors[0] = 0;\n\n    for (let i = 1; i <= length; i++) {\n      factors[i] = factors[i - 1] + (exp - 1) / Math.pow(exp, i);\n    }\n\n    const lastFactor = factors[length];\n\n    const result = new Array(length);\n\n    for (let i = 0; i < length; i++) {\n      result[i] = (max - min) * (1 - factors[i + 1] / lastFactor) + min;\n    }\n\n    return result;\n  } else {\n    const step = (max - min) / (length - 1);\n\n    return range(min, max + step / 2, step);\n  }\n}\n\nfunction range(from: number, to: number, step: number) {\n  const result: number[] = [];\n\n  for (let i = from; i < to; i += step) {\n    result.push(i);\n  }\n\n  return result;\n}\n","import * as FiltersManager from '../../FiltersManager';\nimport { Datum2D } from '../../types/data2d';\nimport generateID from '../../utilities/generateID';\nimport { get2DColor } from '../../utilities/getColor';\nimport Processing2D, { defaultContourOptions } from '../Processing2D';\n\nexport function initiateDatum2D(options: any, usedColors = {}): Datum2D {\n  const datum: any = {};\n\n  datum.id = options.id || generateID();\n  datum.source = Object.assign(\n    {\n      jcampURL: null,\n    },\n    options.source,\n  );\n  datum.display = Object.assign(\n    {\n      name: options.display?.name ? options.display.name : generateID(),\n      ...getColor(options, usedColors),\n      isPositiveVisible: true,\n      isNegativeVisible: true,\n      isVisible: true,\n      contourOptions: defaultContourOptions,\n      dimension: 2,\n    },\n    options.display,\n  );\n\n  datum.info = Object.assign(\n    {\n      nucleus: ['1H', '1H'],\n      isFt: true,\n      isFid: false,\n      isComplex: false, // if isComplex is true that mean it contains real/ imaginary  x set, if not hid re/im button .\n      dimension: 2,\n    },\n    options.info,\n  );\n\n  datum.originalInfo = datum.info;\n  datum.meta = Object.assign({}, options.meta);\n  datum.data = Object.assign(\n    {\n      z: [],\n      minX: 0,\n      minY: 0,\n      maxX: 0,\n      maxY: 0,\n    },\n    options.data,\n  );\n  datum.originalData = datum.data;\n  datum.filters = Object.assign([], options.filters);\n\n  datum.zones = Object.assign({ values: [], options: {} }, options.zones);\n\n  datum.processingController = new Processing2D(\n    datum.data,\n    datum.display.contourOptions,\n  );\n\n  //reapply filters after load the original data\n  FiltersManager.reapplyFilters(datum);\n\n  return datum;\n}\n\nfunction getColor(options, usedColors) {\n  let color = { positiveColor: 'red', negativeColor: 'blue' };\n  if (\n    options?.display?.negativeColor === undefined ||\n    options?.display?.positiveColor === undefined\n  ) {\n    color = get2DColor(options.info.experiment, usedColors['2d'] || []);\n  }\n\n  if (usedColors['2d']) {\n    usedColors['2d'].push(color.positiveColor);\n  }\n  return color;\n}\n","import { Datum1D } from '../../types/data1d';\nimport { Datum2D } from '../../types/data2d';\n\nexport function isSpectrum2D(spectrum: Datum1D | Datum2D): spectrum is Datum2D {\n  return spectrum.info.dimension === 2;\n}\n","import * as Filters from '../../../Filters';\nimport { Datum2D } from '../../../types/data2d';\n\nexport function getShift(datum: Datum2D): { xShift: number; yShift: number } {\n  let shift: any = { xShift: 0, yShift: 0 };\n  if (datum?.filters) {\n    shift = datum.filters.reduce(\n      (acc, filter) => {\n        if (filter.name === Filters.shift2DX.id) {\n          acc.xShift = filter?.flag ? filter.value : 0;\n        }\n        if (filter.name === Filters.shift2DY.id) {\n          acc.yShift = filter?.flag ? filter.value : 0;\n        }\n        return acc;\n      },\n      { xShift: 0, yShift: 0 },\n    );\n  }\n\n  return shift;\n}\n","import { Datum2D } from '../../../types/data2d';\n\nimport { getShift } from './getShift';\n\nexport function updateShift(datum: Datum2D) {\n  const { xShift, yShift } = getShift(datum);\n  updateZonesShift(datum, {\n    xShift,\n    yShift,\n  });\n}\n\nfunction updateZonesShift(datum: Datum2D, { xShift, yShift }) {\n  datum.zones.values = datum.zones.values.map((zone) => ({\n    ...zone,\n    signals: zone.signals?.map((signal) => ({\n      ...signal,\n      x: { ...signal.x, delta: signal.x.originDelta + xShift },\n      y: { ...signal.y, delta: signal.y.originDelta + yShift },\n    })),\n  }));\n}\n","import { DataExportOptions, DataExportOptionsType } from '../../SpectraManager';\nimport { Datum2D } from '../../types/data2d';\n\nexport function toJSON(\n  datum: Datum2D,\n  dataExportOption: DataExportOptionsType,\n) {\n  return {\n    id: datum.id,\n\n    ...(dataExportOption === DataExportOptions.ROW_DATA ||\n    (dataExportOption === DataExportOptions.DATA_SOURCE &&\n      !datum.source.jcampURL)\n      ? {\n          data: datum.originalData,\n          info: datum.originalInfo,\n          meta: datum.meta,\n          source: {\n            jcampURL: null,\n          },\n        }\n      : {\n          source: {\n            jcampURL: datum.source.jcampURL,\n            jcampSpectrumIndex: datum.source.jcampSpectrumIndex,\n          },\n        }),\n    zones: datum.zones,\n    filters: datum.filters,\n    display: datum.display,\n  };\n}\n","import { Datum2D } from '../../../types/data2d';\n\n/**\n *\n * @param {number} zoneID\n * @param {object} signal\n * @param {number} signal.x\n * @param {number} signal.y\n * @param {string} signal.id\n */\nexport function changeZoneSignal(\n  datum: Datum2D,\n  zoneID,\n  newSignal,\n): { xShift: number; yShift: number } {\n  const zoneIndex = datum.zones.values.findIndex((zone) => zone.id === zoneID);\n  if (zoneIndex !== -1) {\n    const signalIndex = datum.zones.values[zoneIndex].signals.findIndex(\n      (s) => s.id === newSignal.id,\n    );\n\n    const zone = datum.zones.values[zoneIndex];\n    if (signalIndex !== -1) {\n      const originalSignal: any = zone.signals[signalIndex];\n      const xShift =\n        newSignal?.x || newSignal?.x === 0\n          ? newSignal.x - originalSignal.x.delta\n          : 0;\n      const yShift =\n        newSignal?.y || newSignal?.y === 0\n          ? newSignal.y - originalSignal.y?.delta\n          : 0;\n\n      return { xShift, yShift };\n    }\n  }\n  return { xShift: 0, yShift: 0 };\n}\n","import { xyzAutoZonesPicking } from 'nmr-processing';\n\nimport { Datum2D } from '../../../types/data2d';\n\nexport interface DetectionZonesOptions {\n  selectedZone: {\n    fromX: number;\n    fromY: number;\n    toX: number;\n    toY: number;\n  };\n  thresholdFactor: number;\n  convolutionByFFT?: boolean;\n  enhanceSymmetry?: boolean;\n}\n\n/**\n *\n * @param {object} options\n * @param {object} options.selectedZone\n * @param {number} options.selectedZone.fromX\n * @param {number} options.selectedZone.fromY\n * @param {number} options.selectedZone.toX\n * @param {number} options.selectedZone.toY\n * @param {number} options.thresholdFactor\n * @param {boolean} options.convolutionByFFT\n */\nexport function getDetectionZones(\n  datum: Datum2D,\n  options: DetectionZonesOptions,\n) {\n  let dataMatrix = {};\n  if (options.selectedZone) {\n    options.enhanceSymmetry = false;\n    dataMatrix = getSubMatrix(datum, options.selectedZone);\n  } else {\n    dataMatrix = datum.data;\n  }\n  return autoZonesDetection(dataMatrix, { ...options, info: datum.info });\n}\n\nfunction autoZonesDetection(data, options) {\n  const { thresholdFactor, clean, maxPercentCutOff, convolutionByFFT } =\n    options;\n\n  const { nucleus: nuclei, originFrequency } = options.info;\n  const { enhanceSymmetry = nuclei[0] === nuclei[1] } = options;\n\n  let zones = xyzAutoZonesPicking(data, {\n    nuclei,\n    observedFrequencies: originFrequency,\n    thresholdFactor,\n    clean,\n    maxPercentCutOff,\n    enhanceSymmetry,\n    convolutionByFFT,\n  });\n\n  return zones;\n}\n\nfunction getSubMatrix(datum, selectedZone) {\n  const { fromX, toX, fromY, toY } = selectedZone;\n  const data = datum.data;\n  const xStep = (data.maxX - data.minX) / (data.z[0].length - 1);\n  const yStep = (data.maxY - data.minY) / (data.z.length - 1);\n  let xIndexFrom = Math.max(Math.floor((fromX - data.minX) / xStep), 0);\n  let yIndexFrom = Math.max(Math.floor((fromY - data.minY) / yStep), 0);\n  let xIndexTo = Math.min(\n    Math.floor((toX - data.minX) / xStep),\n    data.z[0].length - 1,\n  );\n  let yIndexTo = Math.min(\n    Math.floor((toY - data.minY) / yStep),\n    data.z.length - 1,\n  );\n\n  if (xIndexFrom > xIndexTo) [xIndexFrom, xIndexTo] = [xIndexTo, xIndexFrom];\n  if (yIndexFrom > yIndexTo) [yIndexFrom, yIndexTo] = [yIndexTo, yIndexFrom];\n\n  let dataMatrix: any = {\n    z: [],\n    maxX: data.minX + xIndexTo * xStep,\n    minX: data.minX + xIndexFrom * xStep,\n    maxY: data.minY + yIndexTo * yStep,\n    minY: data.minY + yIndexFrom * yStep,\n  };\n  let maxZ = Number.MIN_SAFE_INTEGER;\n  let minZ = Number.MAX_SAFE_INTEGER;\n\n  let nbXPoints = xIndexTo - xIndexFrom + 1;\n\n  for (let j = yIndexFrom; j < yIndexTo; j++) {\n    let row = new Float32Array(nbXPoints);\n    let xIndex = xIndexFrom;\n    for (let i = 0; i < nbXPoints; i++) {\n      row[i] = data.z[j][xIndex++];\n    }\n    for (let rowValue of row) {\n      if (maxZ < rowValue) maxZ = rowValue;\n      if (minZ > rowValue) minZ = rowValue;\n    }\n    dataMatrix.z.push(Array.from(row));\n  }\n  dataMatrix.minZ = minZ;\n  dataMatrix.maxZ = maxZ;\n  return dataMatrix;\n}\n","import { NMRZone } from 'nmr-processing';\n\nimport { DatumKind } from '../../../constants/SignalsKinds';\nimport { Zone } from '../../../types/data2d';\nimport generateID from '../../../utilities/generateID';\nimport { getShift } from '../shift/getShift';\n\nimport { DetectionZonesOptions, getDetectionZones } from './getDetectionZones';\n\nexport function detectZones(datum, options: DetectionZonesOptions): Zone[] {\n  const zones = getDetectionZones(datum, options);\n  const { xShift, yShift } = getShift(datum);\n\n  const { minX, maxX, minY, maxY } = datum.data;\n  const xError = Math.abs(maxX - minX) / 10000;\n  const yError = Math.abs(maxY - minY) / 10000;\n\n  const formattedZones = zones.reduce((acc: Zone[], zone: NMRZone) => {\n    const newXRange = zone.x || { from: 0, to: 0 };\n    const newYRange = zone.y || { from: 0, to: 0 };\n\n    // check if the zone is already exists\n    for (const { x, y } of datum.zones.values) {\n      if (\n        Math.abs(newXRange.from - x.from) < xError &&\n        Math.abs(newXRange.to - x.to) < xError &&\n        Math.abs(newYRange.from - y.from) < yError &&\n        Math.abs(newYRange.to - y.to) < yError\n      ) {\n        return acc;\n      }\n    }\n\n    const signals = zone.signals.map((signal) => {\n      return {\n        id: generateID(),\n        peaks: signal.peaks,\n        x: {\n          originDelta: signal.x.delta - xShift,\n          ...signal.x,\n        },\n        y: {\n          originDelta: signal.y.delta - yShift,\n          ...signal.y,\n        },\n        kind: 'signal',\n      };\n    });\n\n    acc.push({\n      id: generateID(),\n      x: { from: newXRange.from, to: newXRange.to },\n      y: { from: newYRange.from, to: newYRange.to },\n      signals,\n      kind: DatumKind.signal,\n    });\n\n    return acc;\n  }, []);\n  return formattedZones;\n}\n","import { DatumKind } from '../../../constants/SignalsKinds';\nimport { Zone } from '../../../types/data2d';\nimport generateID from '../../../utilities/generateID';\nimport { getShift } from '../shift/getShift';\n\nimport { DetectionZonesOptions, getDetectionZones } from './getDetectionZones';\n\n/**\n *\n * @param {object} options\n * @param {object} options.selectedZone\n * @param {number} options.selectedZone.fromX\n * @param {number} options.selectedZone.fromY\n * @param {number} options.selectedZone.toX\n * @param {number} options.selectedZone.toY\n * @param {number} options.thresholdFactor\n * @param {boolean} options.convolutionByFFT\n */\nexport function detectZonesManual(datum, options: DetectionZonesOptions) {\n  const zones = getDetectionZones(datum, options);\n  const { xShift, yShift } = getShift(datum);\n  const formattedZones: Zone[] = zones.map((zone) => {\n    const signals = zone.signals.map((signal) => {\n      return {\n        id: generateID(),\n        peaks: signal.peaks,\n        x: {\n          originDelta: signal.x.delta - xShift,\n          ...signal.x,\n        },\n        y: {\n          originDelta: signal.y.delta - yShift,\n          ...signal.y,\n        },\n        kind: signal.kind || 'signal',\n      };\n    });\n    return {\n      id: generateID(),\n      x: zone.x,\n      y: zone.y,\n      signals,\n      kind: DatumKind.signal,\n    };\n  }, []);\n\n  return formattedZones;\n}\n","import { initiateDatum2D } from './Spectrum2D';\n\nexport function fromParsedJcamp(\n  parsedJcamp,\n  options,\n  usedColors,\n  jcampSpectrumIndex: number,\n) {\n  const { dependentVariables, info, meta } = parsedJcamp;\n  let data = dependentVariables[0].components;\n  const ob = initiateDatum2D(\n    {\n      ...options,\n      source: { ...options?.source, jcampSpectrumIndex },\n      display: {\n        ...options.display,\n        name: options?.display?.name ? options.display.name : info?.title,\n      },\n      info,\n      meta,\n      data,\n    },\n    usedColors,\n  );\n  return ob;\n}\n\nexport function fromBruker(result, options = {}, usedColors = {}) {\n  const { dependentVariables, meta, source } = result;\n  let data = dependentVariables[0].components;\n  const datum2D = initiateDatum2D(\n    {\n      ...options,\n      source,\n      meta,\n      data,\n    },\n    usedColors,\n  );\n\n  return datum2D;\n}\n\n// TODO: implement this.\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nexport function fromCSD(result, options = {}, usedColors = {}) {\n  const datum2D = initiateDatum2D({}, usedColors);\n  return datum2D;\n}\n","export function changeKeys(data, changedKeys) {\n  return JSON.parse(JSON.stringify(data), function reviver(key, value) {\n    if (key in changedKeys) {\n      this[changedKeys[key]] = value;\n      return;\n    }\n    return value;\n  });\n}\n","import { changeKeys } from './changeKeys';\n\n/**\n * changes from version 0 to version 1:\n * all change done on objects keys naming\n *  j         =>   js\n *  signal    =>   signals\n *  integral  =>   integration\n *  peak      =>   peaks\n *  diaID     =>   diaIDs\n *\n */\n\nexport default function migrateToVersion1(data: any): any {\n  if (data?.version === 1) return data;\n\n  const newData = { ...data, version: 1 };\n  const changedKeys = {\n    j: 'js',\n    signal: 'signals',\n    integral: 'integration',\n    peak: 'peaks',\n    diaID: 'diaIDs',\n  };\n\n  for (const spectrum of newData.spectra) {\n    if (spectrum.ranges) {\n      spectrum.ranges = changeKeys(spectrum.ranges, changedKeys);\n    } else if (spectrum.zones) {\n      spectrum.zones = changeKeys(spectrum.zones, changedKeys);\n    }\n  }\n\n  return newData;\n}\n","import { changeKeys } from './changeKeys';\n\n/*\n    * changes from version 1 to version 2:\n           1- peaks :\n                delta => x , originDelta => originalX, intensity => y,\n               paths:\n               - peak\n\n           2- range/signals :\n                atomIDs => atoms , intensity => y,\n\n              paths:\n               - range > signals\n               - range > signals > js\n               - range > signals > peaks\n\n           3- zone/signals :\n              we have two cases the\n              a)\n                get out the inner object fromTo:{from,to} => {from,to}\n              paths:\n               - zone > signals > x\n               - zone > signals > y\n              b)\n                { fromTo,deltaX,resolutionX,nucleusX,deltaY,resolutionY,nucleusY,shiftX,shiftY} =>\n                {\n                  x: {\n                    from: fromTo[0].from,\n                    to: fromTo[0].to,\n                    delta: deltaX,\n                    resolution: resolutionX,\n                    nucleus: nucleusX,\n                  },\n                  y: {\n                    from: fromTo[1].from,\n                    to: fromTo[1].to,\n                    delta: deltaY,\n                    resolution: resolutionY,\n                    nucleus: nucleusY,\n                  },\n                  }\n\n                paths:\n                -zone>signals\n    */\n\nexport default function migrateToVersion2(data: any): any {\n  if (data?.version === 2) return data;\n\n  const newData = { ...data, version: 2 };\n\n  const changedKeys = {\n    peaks: {\n      delta: 'x',\n      originDelta: 'originalX',\n      intensity: 'y',\n    },\n    ranges: {\n      atomIDs: 'atoms', // signal\n      intensity: 'y', // signal > peaks\n    },\n  };\n\n  for (const spectrum of newData.spectra) {\n    if (spectrum.peaks) {\n      spectrum.peaks = changeKeys(spectrum.peaks, changedKeys.peaks);\n    } else if (spectrum.ranges) {\n      spectrum.ranges = changeKeys(spectrum.ranges, changedKeys.ranges);\n    } else if (spectrum.zones) {\n      spectrum.zones.values = mapZones(spectrum.zones.values);\n    }\n  }\n\n  return newData;\n}\n\nfunction mapZones(zones) {\n  return zones.map((zone) => {\n    if (zone.signals) {\n      zone.signals = zone.signals.map((signal) => {\n        if (signal.x && signal.y) {\n          const {\n            x: { fromTo: fromToX, ...resX },\n            y: { fromTo: fromToY, ...resY },\n          } = signal;\n          signal = {\n            ...signal,\n            x: { ...resX, ...fromToX },\n            y: { ...resY, ...fromToY },\n          };\n        } else {\n          const {\n            fromTo,\n            deltaX,\n            resolutionX,\n            nucleusX,\n            deltaY,\n            resolutionY,\n            nucleusY,\n\n            shiftX,\n            shiftY,\n            ...resSignal\n          } = signal;\n          signal = {\n            ...resSignal,\n            x: {\n              from: fromTo[0].from,\n              to: fromTo[0].to,\n              delta: deltaX,\n              resolution: resolutionX,\n              nucleus: nucleusX,\n            },\n            y: {\n              from: fromTo[1].from,\n              to: fromTo[1].to,\n              delta: deltaY,\n              resolution: resolutionY,\n              nucleus: nucleusY,\n            },\n          };\n        }\n        return signal;\n      }, []);\n    }\n    return zone;\n  }, []);\n}\n","import migrateToVersion1 from './migrateToVersion1';\nimport migrateToVersion2 from './migrateToVersion2';\n\nexport const CURRENT_EXPORT_VERSION = 2;\n\nfunction migrationPipe(functions: ((data: any) => any)[]) {\n  return (input: any) => functions.reduce((input, func) => func(input), input);\n}\n\nexport function migrate(data: any): any {\n  let migrationsFuncs: ((data: any) => any)[] = [\n    migrateToVersion1,\n    migrateToVersion2,\n  ];\n  let index = data?.version || 0;\n\n  if (index > CURRENT_EXPORT_VERSION) {\n    throw new Error(\n      'This file can not be imported using the current NMRium version, Please move to the new one !!! ',\n    );\n  }\n\n  return migrationPipe(migrationsFuncs.slice(index))(data);\n}\n","const mfCheck = /^(?:[A-Z][a-z]?\\d* *)+$/;\n\nexport default function getAtomsFromMF(mf: string): Record<string, number> {\n  if (!mfCheck.test(mf)) {\n    throw Error(`MF can not be parsed: ${mf}`);\n  }\n  const atoms = {};\n  const parts = mf.matchAll(/(?<atom>[A-Z][a-z]?)(?<number>[0-9]*)/g);\n  for (const part of parts) {\n    const { atom, number } = part.groups as { atom: string; number: string };\n    if (!atoms[atom]) {\n      atoms[atom] = 0;\n    }\n    atoms[atom] += number === '' ? 1 : Number(number);\n  }\n\n  return atoms;\n}\n","import { Molecule as OCLMolecule } from 'openchemlib/full';\n\nimport generateID from '../utilities/generateID';\nimport getAtomsFromMF from '../utilities/getAtomsFromMF';\n\ninterface MoleculeInnerProps {\n  key: string;\n  molfile: string;\n}\nexport interface Molecule extends MoleculeInnerProps {\n  mf: string;\n  em: number;\n  mw: number;\n  svg: string;\n  atoms: Record<string, number>;\n  isFloat: boolean;\n}\n\nexport function initMolecule(\n  options: Partial<MoleculeInnerProps> = {},\n): Molecule {\n  const key = options.key || generateID();\n  const molfile = options.molfile || '';\n\n  const mol = OCLMolecule.fromMolfile(molfile);\n  const mfInfo = mol.getMolecularFormula();\n\n  return {\n    key,\n    molfile,\n    mf: mfInfo.formula,\n    em: mfInfo.absoluteWeight,\n    mw: mfInfo.relativeWeight,\n    svg: mol.toSVG(50, 50),\n    atoms: getAtomsFromMF(mfInfo.formula),\n    isFloat: false,\n  };\n}\n\nexport function toJSON(molecule: Molecule): { molfile: string } {\n  return {\n    molfile: molecule.molfile,\n  };\n}\n","import { fromJEOL, fromJCAMP, fromBruker } from 'nmr-parser';\n\nimport { DISPLAYER_MODE } from '../component/reducer/core/Constants';\n\nimport * as Data1DManager from './data1d/Data1DManager';\nimport * as Datum1D from './data1d/Spectrum1D';\nimport * as Data2DManager from './data2d/Data2DManager';\nimport * as Datum2D from './data2d/Spectrum2D';\nimport { CURRENT_EXPORT_VERSION } from './migration/MigrationManager';\nimport * as Molecule from './molecules/Molecule';\n\nexport enum DataExportOptions {\n  ROW_DATA = 'ROW_DATA',\n  DATA_SOURCE = 'DATA_SOURCE',\n}\n\nexport type DataExportOptionsType = keyof typeof DataExportOptions;\n\nexport function addJcampFromURL(spectra, jcampURL, options, usedColors) {\n  return fetch(jcampURL)\n    .then((response) => response.arrayBuffer())\n    .then((jcamp) => {\n      addJcamp(spectra, jcamp, options, usedColors);\n    });\n}\n\nexport function addJcamp(spectra, jcamp, options, usedColors) {\n  options = options || {};\n  const entries = fromJCAMP(jcamp, {\n    noContour: true,\n    xy: true,\n    keepRecordsRegExp: /.*/,\n    profiling: true,\n  });\n  if (entries.length === 0) return;\n  // Should be improved when we have a more complex case\n  for (let index = 0; index < entries.length; index++) {\n    let entry = entries[index];\n\n    const components = entry.dependentVariables?.[0]?.components;\n    if (components && (components.length > 0 || components.z)) {\n      addJcampSS(spectra, { index, entry }, options, usedColors);\n    }\n  }\n}\n\nfunction addJcampSS(spectra, jcampDatum, options, usedColors) {\n  const source = options?.source || {};\n\n  if (\n    !('jcampSpectrumIndex' in source) ||\n    source.jcampSpectrumIndex === jcampDatum.index\n  ) {\n    const dimension = jcampDatum.entry.info.dimension;\n\n    if (dimension === 1) {\n      spectra.push(\n        Data1DManager.fromParsedJcamp(\n          jcampDatum.entry,\n          options,\n          usedColors,\n          jcampDatum.index,\n        ),\n      );\n    }\n    if (dimension === 2) {\n      // console.log(options, jcampDatum.entry);\n\n      spectra.push(\n        Data2DManager.fromParsedJcamp(\n          jcampDatum.entry,\n          options,\n          usedColors,\n          jcampDatum.index,\n        ),\n      );\n    }\n  }\n}\n\nfunction addData(spectra, datum, usedColors) {\n  const dimension = datum.info.dimension;\n  if (dimension === 1) {\n    spectra.push(Datum1D.initiateDatum1D(datum, usedColors));\n  }\n  if (dimension === 2) {\n    spectra.push(Datum2D.initiateDatum2D(datum, usedColors));\n  }\n}\n\nexport function addJDF(spectra, jdf, options: any = {}, usedColors: any = {}) {\n  // need to parse the jcamp\n  let converted = fromJEOL(jdf, {});\n  converted = converted[0];\n  let info = converted.description;\n  let metadata = info.metadata;\n  delete info.metadata;\n  info.acquisitionMode = 0;\n  info.experiment = info.dimension === 1 ? '1d' : '2d';\n  info.type = 'NMR SPECTRUM';\n  info.nucleus = info.nucleus[0];\n  info.numberOfPoints = info.numberOfPoints[0];\n  info.acquisitionTime = info.acquisitionTime[0];\n\n  info.baseFrequency = info.baseFrequency[0];\n  info.frequencyOffset = info.frequencyOffset[0];\n\n  info.spectralWidthClipped = converted.application.spectralWidthClipped;\n\n  if (info.dimension === 1) {\n    if (converted.dependentVariables) {\n      spectra.push(\n        Data1DManager.fromCSD(\n          converted,\n          {\n            ...options,\n            display: { ...options.display },\n            info: info,\n            meta: metadata,\n          },\n          usedColors,\n        ),\n      );\n    }\n  }\n  if (info.dimension === 2 && info.isFt) {\n    spectra.push(\n      Data2DManager.fromCSD(\n        converted,\n        {\n          ...options,\n          display: { ...options.display },\n          info,\n        },\n        usedColors,\n      ),\n    );\n  }\n}\n\nexport async function fromJSON(data: any[] = [], usedColors: any = {}) {\n  const spectra: any[] = [];\n  let promises: any[] = [];\n\n  for (let datum of data) {\n    const { jcamp, jcampURL } = datum?.source || {};\n    if (jcamp != null) {\n      addJcamp(spectra, jcamp, datum, usedColors);\n    } else if (jcampURL != null) {\n      promises.push(addJcampFromURL(spectra, jcampURL, datum, usedColors));\n    } else {\n      addData(spectra, datum, usedColors);\n    }\n  }\n  await Promise.all(promises);\n  return spectra;\n}\n\nexport async function addBruker(options, data, usedColors) {\n  const spectra: any[] = [];\n  let result = await fromBruker(data, {\n    xy: true,\n    noContours: true,\n    keepOriginal: true,\n  });\n  let entries = result;\n  for (let entry of entries) {\n    let { info, dependentVariables } = entry;\n    if (info.dimension === 1) {\n      if (dependentVariables[0].components) {\n        spectra.push(\n          Data1DManager.fromBruker(\n            entry,\n            {\n              ...options,\n              display: { ...options.display },\n            },\n            usedColors,\n          ),\n        );\n      }\n    } else if (info.dimension === 2) {\n      if (info.isFt) {\n        spectra.push(\n          Data2DManager.fromBruker(\n            entry,\n            {\n              ...options,\n              info,\n              display: { ...options.display },\n            },\n            usedColors,\n          ),\n        );\n      } else {\n        // in case of 2D FID spectrum\n      }\n    }\n  }\n  return spectra;\n}\n\n// handle zip files\nexport async function fromZip(zipFiles) {\n  const spectra = [];\n  for (let zipFile of zipFiles) {\n    await addBruker(\n      spectra,\n      { display: { name: zipFile.name } },\n      zipFile.binary,\n    );\n  }\n  return spectra;\n}\n\nexport function addJDFs(files, usedColors) {\n  const spectra = [];\n  for (const file of files) {\n    addJDF(\n      spectra,\n      file.binary,\n      {\n        display: {\n          name: file.name,\n        },\n        source: {\n          jcampURL: file.jcampURL ? file.jcampURL : null,\n          file,\n        },\n      },\n      usedColors,\n    );\n  }\n  return spectra;\n}\n\nexport function addJcamps(files, usedColors) {\n  const spectra = [];\n  for (const file of files) {\n    addJcamp(\n      spectra,\n      file.binary,\n      {\n        display: {\n          name: file.name,\n        },\n        source: {\n          jcampURL: file.jcampURL ? file.jcampURL : null,\n          file,\n        },\n      },\n      usedColors,\n    );\n  }\n  return spectra;\n}\n\nfunction getPreferences(state) {\n  const {\n    activeTab,\n    verticalAlign: { align },\n  } = state;\n  return {\n    activeTab,\n    ...(state.displayerMode === DISPLAYER_MODE.DM_1D\n      ? { verticalAlign: align }\n      : {}),\n  };\n}\n\n/**\n *\n * @param {object} state\n */\nexport function toJSON(\n  state,\n  dataExportOption: DataExportOptionsType = DataExportOptions.DATA_SOURCE,\n) {\n  const {\n    data,\n    molecules: mols,\n    correlations,\n    multipleAnalysis,\n    toolOptions: {\n      data: { exclusionZones },\n    },\n  } = state || {\n    data: [],\n    molecules: [],\n    correlations: {},\n    multipleAnalysis: {},\n    exclusionZones: {},\n  };\n  const spectra = data.map((ob) => {\n    return ob.info.dimension === 1\n      ? Datum1D.toJSON(ob, dataExportOption)\n      : Datum2D.toJSON(ob, dataExportOption);\n  });\n\n  const preferences = getPreferences(state);\n  const molecules = mols.map((mol) => Molecule.toJSON(mol));\n\n  return {\n    spectra,\n    molecules,\n    correlations,\n    multipleAnalysis,\n    exclusionZones,\n    version: CURRENT_EXPORT_VERSION,\n    preferences,\n  };\n}\n","import { DataExportOptions, DataExportOptionsType } from '../../SpectraManager';\nimport { Datum1D } from '../../types/data1d/Datum1D';\n\nexport function toJSON(\n  datum1D: Datum1D,\n  dataExportOption: DataExportOptionsType,\n) {\n  return {\n    id: datum1D.id,\n    display: datum1D.display,\n    ...(dataExportOption === DataExportOptions.ROW_DATA ||\n    (dataExportOption === DataExportOptions.DATA_SOURCE &&\n      !datum1D.source.jcampURL)\n      ? {\n          data: datum1D.originalData,\n          info: datum1D.originalInfo,\n          meta: datum1D.meta,\n          source: {\n            jcampURL: null,\n          },\n        }\n      : {\n          source: {\n            jcampURL: datum1D.source.jcampURL,\n            jcampSpectrumIndex: datum1D.source.jcampSpectrumIndex,\n          },\n        }),\n    peaks: datum1D.peaks,\n    integrals: datum1D.integrals,\n    ranges: datum1D.ranges,\n    filters: datum1D.filters,\n  };\n}\n","import {\n  predictAll,\n  signalsToXY,\n  signals2DToZ,\n  getFrequency,\n} from 'nmr-processing';\nimport OCL from 'openchemlib/full';\n\nimport { DatumKind } from './constants/SignalsKinds';\nimport {\n  initiateDatum1D,\n  mapRanges,\n  updateIntegralsRelativeValues,\n} from './data1d/Spectrum1D';\nimport { initiateDatum2D } from './data2d/Spectrum2D';\nimport { Datum1D } from './types/data1d';\nimport { Datum2D, Signal2D, Zone } from './types/data2d';\nimport generateID from './utilities/generateID';\nimport { adjustAlpha } from './utilities/getColor';\n\nexport interface PredictionOptions {\n  name: string;\n  frequency: number;\n  '1d': {\n    '1H': { from: number; to: number };\n    '13C': { from: number; to: number };\n    nbPoints: number;\n    lineWidth: number;\n  };\n  '2d': {\n    nbPoints: { x: number; y: number };\n  };\n  spectra: {\n    proton: boolean;\n    carbon: boolean;\n    cosy: boolean;\n    hsqc: boolean;\n    hmbc: boolean;\n  };\n}\n\nexport const defaultPredictionOptions: PredictionOptions = {\n  name: '',\n  frequency: 400,\n  '1d': {\n    '1H': { from: -1, to: 12 },\n    '13C': { from: -5, to: 220 },\n    nbPoints: 2 ** 17,\n    lineWidth: 1,\n  },\n  '2d': {\n    nbPoints: { x: 1024, y: 1024 },\n  },\n  spectra: {\n    proton: true,\n    carbon: true,\n    cosy: true,\n    hsqc: true,\n    hmbc: true,\n  },\n};\n\nexport const FREQUENCIES: Array<{ key: number; value: number; label: string }> =\n  [\n    { key: 1, value: 60, label: '60 MHz' },\n    { key: 2, value: 100, label: '100 MHz' },\n    { key: 3, value: 200, label: '200 MHz' },\n    { key: 4, value: 300, label: '300 MHz' },\n    { key: 5, value: 400, label: '400 MHz' },\n    { key: 6, value: 500, label: '500 MHz' },\n    { key: 7, value: 600, label: '600 MHz' },\n    { key: 8, value: 800, label: '800 MHz' },\n    { key: 9, value: 1000, label: '1000 MHz' },\n    { key: 10, value: 1200, label: '1200 MHz' },\n  ];\n\nconst baseURL = 'https://nmr-prediction.service.zakodium.com';\n\nexport async function predictSpectra(molfile: string): Promise<any> {\n  const molecule = OCL.Molecule.fromMolfile(molfile);\n\n  return predictAll(molecule, {\n    predictOptions: {\n      C: {\n        webserviceURL: `${baseURL}/v1/predict/carbon`,\n      },\n    },\n  });\n}\n\nexport function generateSpectra(\n  data: Record<string, any>,\n  inputOptions: PredictionOptions,\n  color: string,\n): Array<Datum1D | Datum2D> {\n  const spectra: Array<Datum1D | Datum2D> = [];\n  for (const experiment in data) {\n    if (inputOptions.spectra[experiment]) {\n      const spectrum = data[experiment];\n      switch (experiment) {\n        case 'proton':\n        case 'carbon': {\n          const datum = generated1DSpectrum({\n            spectrum,\n            inputOptions,\n            experiment,\n            color,\n          });\n          spectra.push(datum);\n\n          break;\n        }\n        case 'cosy':\n        case 'hsqc':\n        case 'hmbc': {\n          const datum = generated2DSpectrum({\n            spectrum,\n            inputOptions,\n            experiment,\n            color,\n          });\n          spectra.push(datum);\n\n          break;\n        }\n        default:\n          break;\n      }\n    }\n  }\n  return spectra;\n}\n\nfunction generated1DSpectrum(params: {\n  inputOptions: PredictionOptions;\n  spectrum: any;\n  experiment: string;\n  color: string;\n}) {\n  const { spectrum, inputOptions, experiment, color } = params;\n\n  const { signals, ranges, nucleus } = spectrum;\n\n  const {\n    name,\n    '1d': { nbPoints },\n    frequency: freq,\n  } = inputOptions;\n  const frequency = calculateFrequency(nucleus, freq);\n  const { x, y } = signalsToXY(signals, {\n    ...inputOptions['1d'][nucleus],\n    frequency,\n    nbPoints,\n  });\n  const datum = initiateDatum1D(\n    {\n      data: { x, im: null, re: y },\n      display: {\n        name,\n        color,\n      },\n      info: {\n        nucleus,\n        originFrequency: frequency,\n        baseFrequency: frequency,\n        pulseSequence: 'prediction',\n        solvent: '',\n        experiment,\n        isFt: true,\n      },\n    },\n    [],\n  );\n  datum.ranges.values = mapRanges(ranges, datum);\n  updateIntegralsRelativeValues(datum);\n  return datum;\n}\n\nfunction mapZones(zones: Array<Partial<Zone>>) {\n  return zones.reduce<Array<Zone>>((zonesAcc, zone: any) => {\n    const { signals, ...resZone } = zone;\n    const newSignals = signals.reduce(\n      (signalsAcc: Signal2D[], signal: Signal2D) => {\n        const { x, y, id, ...resSignal } = signal;\n        signalsAcc.push({\n          id: id || generateID(),\n          kind: 'signal',\n          x: { ...x, originDelta: x.delta || 0 },\n          y: { ...y, originDelta: y.delta || 0 },\n          ...resSignal,\n        });\n        return signalsAcc;\n      },\n      [],\n    );\n\n    zonesAcc.push({\n      id: generateID(),\n      ...resZone,\n      signals: newSignals,\n      kind: DatumKind.signal,\n    });\n    return zonesAcc;\n  }, []);\n}\n\nfunction generated2DSpectrum(params: {\n  inputOptions: PredictionOptions;\n  spectrum: any;\n  experiment: string;\n  color: string;\n}) {\n  const { spectrum, inputOptions, experiment, color } = params;\n  const { signals, zones, nuclei } = spectrum;\n\n  const xOption = inputOptions['1d'][nuclei[0]];\n  const yOption = inputOptions['1d'][nuclei[1]];\n\n  const width = get2DWidth(nuclei);\n  const frequency = calculateFrequency(nuclei, inputOptions.frequency);\n\n  const spectrumData = signals2DToZ(signals, {\n    from: { x: xOption.from, y: yOption.from },\n    to: { x: xOption.to, y: yOption.to },\n    nbPoints: {\n      x: inputOptions['2d'].nbPoints.x,\n      y: inputOptions['2d'].nbPoints.y,\n    },\n    width,\n    factor: 3,\n  });\n\n  const datum = initiateDatum2D(\n    {\n      data: { ...spectrumData, noise: 0.01 },\n      display: {\n        name: inputOptions.name,\n        positiveColor: color,\n        negativeColor: adjustAlpha(color, 40),\n      },\n      info: {\n        nucleus: nuclei,\n        originFrequency: frequency,\n        baseFrequency: frequency,\n        pulseSequence: experiment,\n        experiment: '2d',\n      },\n    },\n    [],\n  );\n  datum.zones.values = mapZones(zones);\n  return datum;\n}\n\nfunction get2DWidth(nucleus: string[]) {\n  return nucleus[0] === nucleus[1] ? 0.02 : { x: 0.02, y: 0.2133 };\n}\n\nfunction calculateFrequency(\n  nucleus: string | string[],\n  frequency: number,\n): number | string {\n  if (typeof nucleus === 'string') {\n    return getFrequency(nucleus, { nucleus: '1H', frequency });\n  } else {\n    if (nucleus[0] === nucleus[1]) {\n      return `${frequency},${frequency}`;\n    } else {\n      return `${frequency},${getFrequency(nucleus[1], {\n        nucleus: nucleus[0],\n        frequency,\n      })}`;\n    }\n  }\n}\n","// error colors in priority order\nconst ErrorColors: Array<{ key: string; color: string }> = [\n  { key: 'outOfLimit', color: 'red' },\n  { key: 'ambiguousAttachment', color: 'orange' },\n  { key: 'notAttached', color: 'blue' },\n  { key: 'incomplete', color: 'red' },\n];\n\nconst Errors = ErrorColors.map((errorColor) => errorColor.key);\n\nconst Hybridizations: Array<{ key: string; label: string; value: string }> = [\n  {\n    key: '-',\n    label: '',\n    value: '',\n  },\n  {\n    key: 'sp',\n    label: 'sp',\n    value: 'SP',\n  },\n  {\n    key: 'sp2',\n    label: 'sp2',\n    value: 'SP2',\n  },\n  {\n    key: 'sp3',\n    label: 'sp3',\n    value: 'SP3',\n  },\n];\n\nconst DefaultTolerance = {\n  C: 0.25,\n  H: 0.02,\n  N: 0.25,\n  F: 0.25,\n  Si: 0.25,\n  P: 0.25,\n};\n\nexport { DefaultTolerance, Errors, ErrorColors, Hybridizations };\n","import * as Filters from '../../data/Filters';\n\ninterface OptionItem {\n  id: string;\n  label: string;\n  hasOptionPanel: boolean;\n  isFilter: boolean;\n}\n\ntype RecordOptions = Record<\n  | 'zoom'\n  | 'peakPicking'\n  | 'integral'\n  | 'zone2D'\n  | 'slicingTool'\n  | 'HMove'\n  | 'equalizerTool'\n  | 'rangesPicking'\n  | 'zeroFilling'\n  | 'phaseCorrection'\n  | 'baseLineCorrection'\n  | 'generalSelector'\n  | 'editRange'\n  | 'multipleSpectraAnalysis'\n  | 'exclusionZones'\n  | 'databaseRangesSelection',\n  OptionItem\n>;\n\nexport const options: RecordOptions = {\n  zoom: {\n    id: 'zoom',\n    label: 'Zoom',\n    hasOptionPanel: false,\n    isFilter: false,\n  },\n  peakPicking: {\n    id: 'peakPicking',\n    label: 'Peaks Picking',\n    hasOptionPanel: true,\n    isFilter: false,\n  },\n  integral: {\n    id: 'integral',\n    label: 'integral Tool',\n    hasOptionPanel: false,\n    isFilter: false,\n  },\n  zone2D: {\n    id: 'zone2D',\n    label: 'Zone Tool',\n    hasOptionPanel: true,\n    isFilter: false,\n  },\n  slicingTool: {\n    id: 'slicingTool',\n    label: 'Slicing Tool',\n    hasOptionPanel: false,\n    isFilter: false,\n  },\n  HMove: {\n    id: 'HMove',\n    label: 'Move spectrum horizontally',\n    hasOptionPanel: false,\n    isFilter: false,\n  },\n  equalizerTool: {\n    id: 'equalizerTool',\n    label: 'Equalizer Tool',\n    hasOptionPanel: false,\n    isFilter: false,\n  },\n  rangesPicking: {\n    id: 'rangesPicking',\n    label: 'Ranges Picking',\n    hasOptionPanel: true,\n    isFilter: false,\n  },\n  zeroFilling: {\n    id: Filters.zeroFilling.id,\n    label: Filters.zeroFilling.name,\n    hasOptionPanel: true,\n    isFilter: true,\n  },\n  phaseCorrection: {\n    id: Filters.phaseCorrection.id,\n    label: Filters.phaseCorrection.name,\n    hasOptionPanel: true,\n    isFilter: true,\n  },\n  baseLineCorrection: {\n    id: 'baseLineCorrection',\n    label: 'baseline correction',\n    hasOptionPanel: true,\n    isFilter: true,\n  },\n  generalSelector: {\n    id: 'generalSelector',\n    label: 'range general selector',\n    hasOptionPanel: false,\n    isFilter: false,\n  },\n\n  editRange: {\n    id: 'editRange',\n    label: 'edit range',\n    hasOptionPanel: false,\n    isFilter: false,\n  },\n\n  multipleSpectraAnalysis: {\n    id: 'multipleSpectraAnalysis',\n    label: 'Multiple Spectra Analysis',\n    hasOptionPanel: false,\n    isFilter: false,\n  },\n  exclusionZones: {\n    id: 'exclusionZones',\n    label: 'Exclusion Zones',\n    hasOptionPanel: false,\n    isFilter: false,\n  },\n  databaseRangesSelection: {\n    id: 'databaseRangesSelection',\n    label: 'Filter Database',\n    hasOptionPanel: false,\n    isFilter: false,\n  },\n};\n","import { mapRanges } from '../../../../data/data1d/Spectrum1D';\n\nexport function addRanges(signals, datum) {\n  let ranges: Array<any> = [];\n  const { baseFrequency: frequency = 500 } = datum;\n  for (const signal of signals) {\n    const {\n      jCoupling: js,\n      delta,\n      diaIDs = [],\n      multiplicity,\n      integration,\n    } = signal;\n    const fromTo = computeFromTo({ delta, js, frequency });\n    if (js && multiplicity) {\n      if (js.length === multiplicity.length) {\n        js.sort((a, b) => b - a);\n        for (let i = 0; i < js.length; i++) {\n          js[i].multiplicity = multiplicity[i];\n        }\n      }\n    }\n\n    ranges.push({\n      ...fromTo,\n      integration,\n      signals: [\n        {\n          js,\n          delta,\n          diaIDs,\n          multiplicity,\n        },\n      ],\n    });\n  }\n  datum.ranges.values = mapRanges(joinRanges(ranges), datum);\n}\n\ninterface ComputeFromToOptions {\n  delta?: any;\n  js?: any;\n  couplings?: Array<any>;\n  frequency?: any;\n}\n\nfunction computeFromTo(options: ComputeFromToOptions = {}) {\n  const { delta, js: couplings = [], frequency } = options;\n  let width = 0.5;\n  for (let j of couplings) {\n    width += j.coupling;\n  }\n  width /= frequency;\n  return { from: delta - width, to: delta + width };\n}\n\nfunction joinRanges(ranges) {\n  ranges.sort((a, b) => a.from - b.from);\n  for (let i = 0; i < ranges.length - 1; i++) {\n    if (ranges[i].to > ranges[i + 1].from) {\n      ranges[i].to = Math.max(ranges[i + 1].to, ranges[i].to);\n      ranges[i].signals = ranges[i].signals.concat(ranges[i + 1].signals);\n      ranges[i].integration += ranges[i + 1].integration;\n      ranges.splice(i + 1, 1);\n      i--;\n    }\n  }\n  return ranges;\n}\n","import { getShift } from '../../../../data/data2d/Spectrum2D';\nimport generateID from '../../../../data/utilities/generateID';\n\nconst axisLabels = ['y', 'x'];\n\nexport function addZones(signals, datum) {\n  let zones: Array<any> = [];\n  const shift = getShift(datum);\n  const { baseFrequency } = datum.info;\n  const frequency = { x: baseFrequency[0], y: baseFrequency[1] };\n\n  for (const signal of signals) {\n    let zone = { x: {}, y: {}, id: generateID(), kind: 'signal' };\n    let signalFormated = { id: generateID(), kind: 'signal', peaks: [] };\n    let width = { x: 10, y: 10 };\n    for (let axis of axisLabels) {\n      let { coupling = [], delta, diaIDs = [] } = signal[axis];\n      for (let j of coupling) {\n        width[axis] += j.coupling;\n      }\n      if (signal.activeCoupling) {\n        const { activeCoupling = [] } = signal;\n        for (let j of activeCoupling) {\n          width[axis] += j.coupling;\n        }\n      }\n      width[axis] /= frequency[axis];\n\n      zone[axis] = {\n        from: delta - width[axis],\n        to: delta + width[axis],\n      };\n\n      signalFormated[axis] = {\n        delta,\n        diaIDs,\n        originDelta: delta - shift[`${axis}Shift`],\n      };\n    }\n    zones.push({\n      ...zone,\n      signals: [signalFormated],\n    });\n  }\n  datum.zones.values = zones;\n}\n","import Jszip from 'jszip';\nimport { NmrRecord, parseSDF } from 'nmredata';\n\nimport { addBruker, addJcamps } from '../../data/SpectraManager';\n\nimport { addRanges } from './util/nmredata/addRanges';\nimport { addZones } from './util/nmredata/addZones';\n\nexport async function nmredataToNmrium(file, usedColors) {\n  const jszip = new Jszip();\n  const zip = await jszip.loadAsync(file.binary);\n  const sdfFiles = await getSDF(zip.files);\n  const jsonData = await NmrRecord.toJSON({\n    sdf: sdfFiles[0],\n    zipFiles: zip.files,\n  });\n\n  let { spectra, molecules = [] } = jsonData;\n\n  let nmrium: { spectra: any[]; molecules: any[] } = {\n    spectra: [],\n    molecules,\n  };\n\n  for (const data of spectra) {\n    const { file, jcampURL } = data.source;\n\n    let spectrum = (await getSpectra(file, { jcampURL }, usedColors)) || [];\n\n    for (const spectrumData of spectrum) {\n      const { info } = spectrumData;\n\n      if (info.isFid) continue;\n\n      if (info.dimension > 1) {\n        addZones(data.signals, spectrumData);\n      } else {\n        addRanges(data.signals, spectrumData);\n      }\n    }\n\n    nmrium.spectra.push(...spectrum);\n  }\n\n  return nmrium;\n}\n\ninterface GetSpectraOptions {\n  xy?: boolean;\n  noContours?: boolean;\n  keepOriginal?: boolean;\n  jcampURL?: string;\n}\n\nasync function getSpectra(\n  file,\n  options: GetSpectraOptions = {},\n  usedColors = {},\n) {\n  const {\n    xy = true,\n    noContours = true,\n    keepOriginal = true,\n    jcampURL,\n  } = options;\n  switch (file.extension) {\n    case 'jdx':\n    case 'dx':\n      return addJcamps([file], usedColors);\n    case 'zip':\n      return addBruker(\n        { xy, noContours, keepOriginal },\n        file.binary,\n        usedColors,\n      );\n    default:\n      if (!jcampURL) {\n        new Error('file extension is not supported');\n        return;\n      }\n  }\n}\n\nasync function getSDF(zipFiles) {\n  let result: any[] = [];\n  for (const file in zipFiles) {\n    const pathFile = file.split('/');\n    if (/^[^.].+sdf$/.exec(pathFile[pathFile.length - 1])) {\n      const filename = pathFile[pathFile.length - 1].replace(/\\.sdf/, '');\n      const root = pathFile.slice(0, pathFile.length - 1).join('/');\n      const sdf = await zipFiles[file].async('string');\n      let parserResult = parseSDF(`${sdf}`, { mixedEOL: true });\n      parserResult.filename = filename;\n      parserResult.root = root !== '' ? `${root}/` : '';\n      result.push(parserResult);\n    }\n  }\n  return result;\n}\n","import { Draft } from 'immer';\nimport { SpectraData1D, SpectraData2D } from 'nmr-processing';\n\nimport { Datum1D, Range } from '../../../data/types/data1d';\nimport { Datum2D, Zone } from '../../../data/types/data2d';\nimport { State } from '../Reducer';\n\nfunction setAutomaticAssignmentsHandler(\n  draft: Draft<State>,\n  action: { payload: { assignments: (SpectraData1D | SpectraData2D)[] } },\n) {\n  const assignments = action.payload.assignments;\n\n  for (let datum of assignments) {\n    const index = draft.data.findIndex((spectrum) => spectrum.id === datum.id);\n    if (index !== -1) {\n      const dimension = draft.data[index].info.dimension;\n      if (dimension === 1) {\n        (draft.data[index] as Datum1D).ranges.values = (datum as SpectraData1D)\n          .ranges as Range[];\n      } else if (dimension === 2) {\n        (draft.data[index] as Datum2D).zones.values = (datum as SpectraData2D)\n          .zones as Zone[];\n      }\n    }\n  }\n}\n\nexport { setAutomaticAssignmentsHandler };\n","import { Spectra } from '../../component/NMRium';\nimport { Datum1D, Range, Signal1D } from '../types/data1d';\nimport { Datum2D, Signal2D, Zone } from '../types/data2d';\n\nfunction findSpectrum(\n  spectraData: Spectra,\n  spectrumID: string,\n  checkIsVisible: boolean,\n): Datum1D | Datum2D | undefined {\n  const spectrum = spectraData.find((_spectrum) => _spectrum.id === spectrumID);\n  if (\n    spectrum &&\n    checkIsVisible === true &&\n    spectrum.display.isVisible === false\n  ) {\n    return undefined;\n  }\n\n  return spectrum;\n}\n\nfunction findSignal1D(\n  spectrum: Datum1D,\n  signalID: string,\n): Signal1D | undefined {\n  for (let range of spectrum.ranges.values) {\n    const signalIndex = range.signals.findIndex(\n      (_signal) => _signal.id === signalID,\n    );\n    if (signalIndex >= 0) {\n      return range.signals[signalIndex];\n    }\n  }\n}\n\nfunction findSignal2D(\n  spectrum: Datum2D,\n  signalID: string,\n): Signal2D | undefined {\n  for (let zone of spectrum.zones.values) {\n    const signalIndex = zone.signals.findIndex(\n      (_signal) => _signal.id === signalID,\n    );\n    if (signalIndex >= 0) {\n      return zone.signals[signalIndex];\n    }\n  }\n}\n\nfunction findRange(spectrum: Datum1D, signalID: string): Range | undefined {\n  for (let range of spectrum.ranges.values) {\n    const signalIndex = range.signals.findIndex(\n      (_signal) => _signal.id === signalID,\n    );\n    if (signalIndex >= 0) {\n      return range;\n    }\n  }\n}\n\nfunction findZone(spectrum: Datum2D, signalID: string): Zone | undefined {\n  for (let zone of spectrum.zones.values) {\n    const signalIndex = zone.signals.findIndex(\n      (_signal) => _signal.id === signalID,\n    );\n    if (signalIndex >= 0) {\n      return zone;\n    }\n  }\n}\n\nfunction findRangeOrZoneID(\n  spectraData: Spectra,\n  experimentID: string,\n  signalID: string,\n  checkIsVisible: boolean,\n) {\n  const spectrum = findSpectrum(spectraData, experimentID, checkIsVisible);\n  if (spectrum) {\n    if (spectrum.info.dimension === 1) {\n      const range = findRange(spectrum as Datum1D, signalID);\n      if (range) return range.id;\n    } else if (spectrum.info.dimension === 2) {\n      const zone = findZone(spectrum as Datum2D, signalID);\n      if (zone) return zone.id;\n    }\n  }\n}\n\nexport {\n  findRange,\n  findRangeOrZoneID,\n  findSignal1D,\n  findSignal2D,\n  findSpectrum,\n  findZone,\n};\n","import { scaleLinear, zoomIdentity } from 'd3';\n\nfunction getXScale(state, spectrumId: number | null | string = null) {\n  const { width, margin, xDomains, xDomain, mode } = state;\n  const range =\n    mode === 'RTL'\n      ? [width - margin.right, margin.left]\n      : [margin.left, width - margin.right];\n  return scaleLinear(spectrumId ? xDomains[spectrumId] : xDomain, range);\n}\n\nfunction getYScale(state, spectrumId: number | null | string = null) {\n  const { height, margin, verticalAlign, yDomain, yDomains } = state;\n  const _height =\n    verticalAlign.align === 'center'\n      ? (height - 30) / 2\n      : height - margin.bottom - 30;\n  let domainY: [number, number] | [] = [];\n  if (spectrumId === null || yDomains[spectrumId] === undefined) {\n    domainY = [0, yDomain[1]];\n  } else {\n    domainY = [0, yDomains[spectrumId][1]];\n  }\n  return scaleLinear(domainY, [_height, margin.top]);\n}\n\nfunction getIntegralYScale(state) {\n  const { height, margin, verticalAlign, integralsYDomains, activeSpectrum } =\n    state;\n  const _height = verticalAlign.align === 'center' ? height / 2 : height;\n  return scaleLinear(\n    activeSpectrum?.id &&\n      integralsYDomains &&\n      integralsYDomains[activeSpectrum?.id]\n      ? integralsYDomains[activeSpectrum?.id]\n      : [0, 0],\n    [_height * 0.3, margin.top + _height * 0.1],\n  );\n}\n\nfunction reScaleY(scale: number, { domain, height, margin }) {\n  const _scale = scaleLinear(domain, [height - margin.bottom, margin.top]);\n\n  const t = zoomIdentity\n    .translate(0, _scale(0))\n    .scale(scale)\n    .translate(0, -_scale(0));\n\n  return t.rescaleY(_scale).domain();\n}\n\nexport { getXScale, getYScale, getIntegralYScale, reScaleY };\n","import { getXScale } from '../../1d/utilities/scale';\n\ninterface RangeOptions {\n  startX: number;\n  endX: number;\n}\n\nexport default function getRange(\n  draft,\n  options: RangeOptions,\n): [number, number] {\n  const { startX, endX } = options;\n  const scaleX = getXScale(draft);\n\n  const start = scaleX.invert(startX);\n  const end = scaleX.invert(endX);\n  const range: [number, number] = [0, 0];\n  if (start > end) {\n    range[0] = end;\n    range[1] = start;\n  } else {\n    range[0] = start;\n    range[1] = end;\n  }\n  return range;\n}\n","export default function nucleusToString(nucleus) {\n  return typeof nucleus === 'string' ? nucleus : nucleus.join(',');\n}\n","import { extent } from 'd3';\nimport { Draft } from 'immer';\n\nimport { get1DDataXY } from '../../../data/data1d/Spectrum1D/get1DDataXY';\nimport { isSpectrum2D } from '../../../data/data2d/Spectrum2D';\nimport { Datum1D } from '../../../data/types/data1d';\nimport { Datum2D } from '../../../data/types/data2d';\nimport nucleusToString from '../../utility/nucleusToString';\nimport { State } from '../Reducer';\nimport { DISPLAYER_MODE } from '../core/Constants';\n\nfunction getActiveData(draft: Draft<State>): Array<Datum1D> {\n  let data = draft.data.filter(\n    (datum) =>\n      nucleusToString(datum.info.nucleus) === draft.activeTab &&\n      datum.info.dimension === 1,\n  );\n\n  if (draft.activeSpectrum) {\n    const activeSpectrumIndex = data.findIndex(\n      (datum) => datum.id === draft.activeSpectrum?.id,\n    );\n    if (activeSpectrumIndex !== -1) {\n      const isFid = data[activeSpectrumIndex].info.isFid || false;\n      data = data.filter((datum) => datum.info.isFid === isFid);\n    }\n  } else {\n    data = data.filter((datum) => datum.info.isFid === false);\n  }\n\n  return data as Array<Datum1D>;\n}\n\nfunction getDomain(drfat: Draft<State>) {\n  let xArray: Array<number> = [];\n  let yArray: Array<number> = [];\n  let yDomains = {};\n  let xDomains = {};\n\n  const data = getActiveData(drfat);\n  try {\n    xArray = data.reduce<Array<number>>((acc, d: Datum1D) => {\n      const { display, data } = d;\n      const domain = [data.x[0], data.x[data.x.length - 1]];\n      xDomains[d.id] = domain;\n      if (display.isVisible) {\n        acc = acc.concat(domain);\n      }\n      return acc;\n    }, []);\n\n    yArray = data.reduce<Array<number>>((acc, d: Datum1D) => {\n      const { display } = d;\n      const data = get1DDataXY(d);\n\n      const _extent = extent(data.y) as Array<number>;\n      yDomains[d.id] = _extent;\n\n      if (display.isVisible) {\n        acc = acc.concat(_extent);\n      }\n      return acc;\n    }, []);\n  } catch (e) {\n    // eslint-disable-next-line no-console\n    console.log(e);\n  }\n\n  return {\n    xDomain: extent(xArray),\n    yDomain: extent(yArray),\n    yDomains,\n    xDomains,\n  };\n}\nfunction get2DDomain(state) {\n  let xArray = [];\n  let yArray = [];\n  let yDomains = {};\n  let xDomains = {};\n\n  const { activeTab, tabActiveSpectrum, data } = state;\n\n  const nucleus = activeTab.split(',');\n\n  try {\n    xArray = data.reduce((acc, datum: Datum1D | Datum2D) => {\n      if (\n        isSpectrum2D(datum) &&\n        datum.info.nucleus?.join(',') === activeTab &&\n        datum.info.isFt\n      ) {\n        acc = acc.concat([datum.data.minX, datum.data.maxX]);\n      }\n      return acc;\n    }, []);\n\n    yArray = data.reduce((acc, datum: Datum1D | Datum2D) => {\n      if (\n        isSpectrum2D(datum) &&\n        datum.info.nucleus?.join(',') === activeTab &&\n        datum.info.isFt\n      ) {\n        acc = acc.concat([datum.data.minY, datum.data.maxY]);\n      }\n      return acc;\n    }, []);\n  } catch (e) {\n    // eslint-disable-next-line no-console\n    console.log(e);\n  }\n\n  const spectrumsIDs = nucleus.map((n) => tabActiveSpectrum[n]?.id);\n\n  const filteredData = data.reduce((acc, datum: Datum1D | Datum2D) => {\n    return spectrumsIDs.includes(datum.id) && datum.info.dimension === 1\n      ? acc.concat(datum)\n      : acc.concat([]);\n  }, []);\n  try {\n    xDomains = filteredData.reduce((acc, d: Datum1D) => {\n      const { x } = d.data;\n      const domain = [x[0], x[x.length - 1]];\n      acc[d.id] = domain;\n      return acc;\n    }, {});\n\n    yDomains = filteredData.reduce((acc, d: Datum1D) => {\n      const _extent = extent(d.data.re);\n      acc[d.id] = _extent;\n      return acc;\n    }, {});\n  } catch (e) {\n    // eslint-disable-next-line no-console\n    console.log(e);\n  }\n\n  return {\n    xDomain: extent(xArray),\n    yDomain: extent(yArray),\n    yDomains,\n    xDomains,\n  };\n}\n\nexport interface SetDomainOptions {\n  yDomain?: {\n    isChanged?: boolean;\n    isShared?: boolean;\n  };\n}\n\nfunction setDomain(draft: Draft<State>, options?: SetDomainOptions) {\n  const { yDomain = { isChanged: true, isShared: true } } = options || {};\n  let domain;\n\n  if (draft.activeTab) {\n    if (draft.displayerMode === DISPLAYER_MODE.DM_1D) {\n      domain = getDomain(draft);\n    } else {\n      domain = get2DDomain(draft);\n    }\n    draft.xDomain = domain.xDomain;\n    draft.xDomains = domain.xDomains;\n    draft.originDomain = domain;\n\n    if (yDomain.isChanged) {\n      draft.yDomain = domain.yDomain;\n      if (draft.displayerMode === DISPLAYER_MODE.DM_1D && yDomain.isShared) {\n        draft.yDomains = Object.keys(domain.yDomains).reduce((acc, key) => {\n          acc[key] = domain.yDomain;\n          return acc;\n        }, {});\n      } else {\n        draft.yDomains = domain.yDomains;\n      }\n    } else {\n      draft.originDomain = {\n        ...draft.originDomain,\n        xDomain: domain.xDomain,\n        xDomains: domain.xDomains,\n      };\n    }\n  }\n}\n\nfunction getSpectrumIntegralsDomain(datum: Datum1D) {\n  const { integrals, ranges } = datum;\n  let max = Number.NEGATIVE_INFINITY;\n  for (const integral of integrals.values) {\n    max = Math.max(max, integral.absolute);\n  }\n  for (const range of ranges.values) {\n    max = Math.max(max, range.absolute);\n  }\n  return [0, max];\n}\nfunction setIntegralsYDomain(draft: Draft<State>, data: Datum1D[] | Datum1D) {\n  for (const spectrum of Array.isArray(data) ? data : [data]) {\n    if (spectrum?.info?.dimension === 1) {\n      draft.integralsYDomains[spectrum.id] =\n        getSpectrumIntegralsDomain(spectrum);\n    }\n  }\n}\n\nfunction setOriginalDomain(draft: Draft<State>, originDomain) {\n  draft.originDomain = originDomain;\n}\n\nfunction setXDomain(draft: Draft<State>, xDomain) {\n  draft.xDomain = xDomain;\n}\n\nfunction setYDomain(draft: Draft<State>, yDomain) {\n  draft.yDomain = yDomain;\n}\n\nfunction handelResetDomain(draft: Draft<State>) {\n  const { xDomain, yDomain, xDomains, yDomains } = draft.originDomain;\n  draft.xDomain = xDomain;\n  draft.yDomain = yDomain;\n  draft.xDomains = xDomains;\n  draft.yDomains = yDomains;\n}\n\nfunction setMode(draft: Draft<State>) {\n  const data = draft.data.filter(\n    (datum) =>\n      draft.xDomains[datum.id] &&\n      nucleusToString(datum.info.nucleus) === draft.activeTab,\n  );\n  draft.mode = (data[0] as Datum1D)?.info.isFid ? 'LTR' : 'RTL';\n}\n\nexport {\n  getDomain,\n  setOriginalDomain,\n  setXDomain,\n  setYDomain,\n  handelResetDomain,\n  setDomain,\n  setMode,\n  setIntegralsYDomain,\n};\n","import { Draft, original } from 'immer';\nimport cloneDeep from 'lodash/cloneDeep';\nimport { xFindClosestIndex } from 'ml-spectra-processing';\n\nimport * as Filters from '../../../data/Filters';\nimport * as FiltersManager from '../../../data/FiltersManager';\nimport {\n  DatumKind,\n  SignalKindsToInclude,\n} from '../../../data/constants/SignalsKinds';\nimport {\n  addRange,\n  changeRangeSignal,\n  detectRanges,\n  updateRangesRelativeValues,\n  changeRange,\n  changeRangeRelativeValue,\n  updateXShift,\n} from '../../../data/data1d/Spectrum1D';\nimport { setSumOptions } from '../../../data/data1d/Spectrum1D/SumManager';\nimport { Datum1D } from '../../../data/types/data1d';\nimport {\n  unlink,\n  unlinkInAssignmentData,\n} from '../../../data/utilities/RangeUtilities';\nimport { State } from '../Reducer';\nimport getRange from '../helper/getRange';\n\nimport { handleUpdateCorrelations } from './CorrelationsActions';\nimport { setDomain, setIntegralsYDomain } from './DomainActions';\n\nfunction handleAutoRangesDetection(draft: Draft<State>, options) {\n  const {\n    activeSpectrum,\n    data,\n    xDomain,\n    molecules,\n    activeTab: nucleus,\n  } = draft;\n  if (activeSpectrum?.id) {\n    const { index } = activeSpectrum;\n    const datum = data[index] as Datum1D;\n\n    const [from, to] = xDomain;\n    const windowFromIndex = xFindClosestIndex(datum.data.x, from);\n    const windowToIndex = xFindClosestIndex(datum.data.x, to);\n\n    const detectionOptions = {\n      factorStd: 8,\n      integrationSum: 100,\n      compile: true,\n      frequencyCluster: 16,\n      clean: true,\n      keepPeaks: true,\n      ...options, // minMaxRatio default 0.05, lookNegative default false,\n    };\n\n    detectRanges(datum, {\n      ...detectionOptions,\n      windowFromIndex,\n      windowToIndex,\n      molecules,\n      nucleus,\n    });\n    handleOnChangeRangesData(draft);\n    setIntegralsYDomain(draft, datum);\n  }\n}\n\nfunction handleAutoSpectraRangesDetection(draft: Draft<State>) {\n  const peakPicking = {\n    factorStd: 8,\n    minMaxRatio: 0.05,\n    integrationSum: 100,\n    compile: true,\n    frequencyCluster: 16,\n    clean: true,\n    keepPeaks: true,\n  };\n  const { data, activeTab: nucleus, molecules } = draft;\n  for (const datum of data) {\n    if (datum.info.dimension === 1) {\n      detectRanges(datum as Datum1D, { peakPicking, molecules, nucleus });\n      handleOnChangeRangesData(draft);\n    }\n  }\n}\n\nfunction getRangeIndex(draft: Draft<State>, spectrumIndex, rangeID) {\n  return (draft.data[spectrumIndex] as Datum1D).ranges.values.findIndex(\n    (range) => range.id === rangeID,\n  );\n}\n\nfunction handleDeleteRange(draft: Draft<State>, action) {\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n    const { id = null, assignmentData } = action.payload.data;\n    const datum = draft.data[index] as Datum1D;\n    if (id) {\n      const rangeIndex = getRangeIndex(draft, index, id);\n      unlinkInAssignmentData(assignmentData, [datum.ranges.values[rangeIndex]]);\n      datum.ranges.values.splice(rangeIndex, 1);\n    } else {\n      unlinkInAssignmentData(assignmentData, datum.ranges.values);\n      datum.ranges.values = [];\n    }\n    updateRangesRelativeValues(datum);\n    handleOnChangeRangesData(draft);\n  }\n}\n\nfunction handleChangeRangeSignalKind(draft: Draft<State>, action) {\n  const state = original(draft) as State;\n  if (state.activeSpectrum?.id) {\n    const { index } = state.activeSpectrum;\n    const { rowData, value } = action.payload.data;\n    const rangeIndex = getRangeIndex(state, index, rowData.id);\n    const _range = (draft.data[index] as Datum1D).ranges.values[rangeIndex];\n    if (_range?.signals) {\n      _range.signals[rowData.tableMetaInfo.signalIndex].kind = value;\n      _range.kind = SignalKindsToInclude.includes(value)\n        ? DatumKind.signal\n        : DatumKind.mixed;\n      updateRangesRelativeValues(draft.data[index] as Datum1D);\n      handleOnChangeRangesData(draft);\n    }\n  }\n}\n\nfunction handleSaveEditedRange(draft: Draft<State>, action) {\n  const state = original(draft) as State;\n  if (state.activeSpectrum?.id) {\n    const { index } = state.activeSpectrum;\n    const { editedRowData, assignmentData } = action.payload;\n\n    // reset temp range\n    draft.toolOptions.data.tempRange = null;\n\n    // remove assignments in global state\n\n    const _editedRowData: any = unlink(editedRowData);\n\n    delete _editedRowData.tableMetaInfo;\n    delete _editedRowData.rowKey;\n    // remove assignments in assignment hook data\n    // for now: clear all assignments for this range because signals or levels to store might have changed\n    unlinkInAssignmentData(assignmentData, [_editedRowData]);\n    const rangeIndex = getRangeIndex(state, index, _editedRowData.id);\n    (draft.data[index] as Datum1D).ranges.values[rangeIndex] = _editedRowData;\n    updateRangesRelativeValues(draft.data[index] as Datum1D);\n    handleOnChangeRangesData(draft);\n  }\n}\n\nfunction handleDeleteSignal(draft: Draft<State>, action) {\n  const {\n    spectrum,\n    range,\n    signal,\n    assignmentData,\n    unlinkSignalInAssignmentData = true,\n  } = action.payload;\n\n  if (spectrum && range) {\n    const datum1D = draft.data.find(\n      (datum) => datum.id === spectrum.id,\n    ) as Datum1D;\n    const rangeIndex = datum1D.ranges.values.findIndex(\n      (_range) => _range.id === range.id,\n    );\n    const signalIndex = range.signals.findIndex(\n      (_signal) => _signal.id === signal.id,\n    );\n    // remove assignments for the signal range object in global state\n    const _range = unlink(cloneDeep(range), 'signal', { signalIndex });\n    if (unlinkSignalInAssignmentData === true) {\n      unlinkInAssignmentData(assignmentData, [{ signals: [signal] }]);\n    }\n    _range.signals.splice(signalIndex, 1);\n    datum1D.ranges.values[rangeIndex] = _range;\n    // if no signals are existing in a range anymore then delete this range\n    if (_range.signals.length === 0) {\n      unlinkInAssignmentData(assignmentData, [_range]);\n      datum1D.ranges.values.splice(rangeIndex, 1);\n    }\n\n    handleOnChangeRangesData(draft);\n  }\n}\n\nfunction handleUnlinkRange(draft: Draft<State>, action) {\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n    const {\n      assignmentData,\n      rangeData = null,\n      signalIndex = -1,\n    } = action.payload;\n\n    // remove assignments in global state\n    if (rangeData) {\n      const rangeIndex = getRangeIndex(draft, index, rangeData.id);\n      const range = cloneDeep(\n        (draft.data[index] as Datum1D).ranges.values[rangeIndex],\n      );\n\n      let newRange: any = {};\n      let id = rangeData.id;\n      if (rangeData && signalIndex === -1) {\n        newRange = unlink(range, 'range');\n      } else {\n        newRange = unlink(range, 'signal', { signalIndex });\n        id = rangeData.signals[signalIndex].id;\n      }\n      // remove assignments in assignment hook data\n      unlinkInAssignmentData(assignmentData, [\n        {\n          id,\n        },\n      ]);\n      (draft.data[index] as Datum1D).ranges.values[rangeIndex] = newRange;\n    } else {\n      const ranges = (draft.data[index] as Datum1D).ranges.values.map(\n        (range) => {\n          return unlink(range);\n        },\n      );\n      (draft.data[index] as Datum1D).ranges.values = ranges;\n\n      unlinkInAssignmentData(assignmentData, ranges);\n    }\n  }\n}\n\nfunction handleSetDiaIDRange(draft: Draft<State>, action) {\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n    const { rangeData, diaIDs, signalIndex, nbAtoms } = action.payload;\n    const getNbAtoms = (input, current = 0) => input + current;\n    const rangeIndex = getRangeIndex(draft, index, rangeData.id);\n    const _range = (draft.data[index] as Datum1D).ranges.values[rangeIndex];\n    if (signalIndex === undefined) {\n      _range.diaIDs = diaIDs;\n      _range.nbAtoms = getNbAtoms(nbAtoms, _range.nbAtoms);\n    } else {\n      _range.signals[signalIndex].diaIDs = diaIDs;\n      _range.signals[signalIndex].nbAtoms = getNbAtoms(\n        nbAtoms,\n        _range.signals[signalIndex].nbAtoms,\n      );\n    }\n    // _range.nbAtoms = getNbAtoms(_range);\n  }\n}\n\nfunction handleResizeRange(draft: Draft<State>, action) {\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n    changeRange(draft.data[index] as Datum1D, action.data);\n  }\n}\n\nfunction handleChangeRangeSum(draft: Draft<State>, options) {\n  const { data, activeSpectrum, activeTab: nucleus } = draft;\n  if (activeSpectrum?.id) {\n    const { index } = activeSpectrum;\n    const datum = data[index] as Datum1D;\n    setSumOptions(datum.ranges, { options, nucleus });\n    updateRangesRelativeValues(datum, true);\n  }\n}\n\nfunction handleAddRange(draft: Draft<State>, action) {\n  const { startX, endX } = action.payload;\n  const { activeSpectrum, activeTab: nucleus, molecules } = draft;\n  const range = getRange(draft, { startX, endX });\n\n  if (activeSpectrum?.id) {\n    const { index } = activeSpectrum;\n    const [from, to] = range;\n    addRange(draft.data[index] as Datum1D, { from, to, nucleus, molecules });\n    handleOnChangeRangesData(draft);\n    setIntegralsYDomain(draft, draft.data[index] as Datum1D);\n  }\n}\n\nfunction handleChangeRangeRelativeValue(draft, action) {\n  const data = action.payload.data;\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n    changeRangeRelativeValue(draft.data[index], data);\n  }\n}\n\nfunction handleChangeRangeSignalValue(draft, action) {\n  const { rangeID, signalID, value } = action.payload;\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n\n    const shift = changeRangeSignal(draft.data[index], {\n      rangeID,\n      signalID,\n      newSignalValue: value,\n    });\n    FiltersManager.applyFilter(draft.data[index], [\n      { name: Filters.shiftX.id, options: shift },\n    ]);\n\n    updateXShift(draft.data[index] as Datum1D);\n\n    handleOnChangeRangesData(draft);\n    setDomain(draft);\n  }\n}\n\nfunction handleOnChangeRangesData(draft) {\n  handleUpdateCorrelations(draft);\n}\n\nfunction handleChangeRangesSumFlag(draft, action) {\n  const flag = action.payload;\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n    draft.data[index].ranges.options.isSumConstant = !flag;\n  }\n}\n\nfunction handleChangeTempRange(draft: Draft<State>, action) {\n  draft.toolOptions.data.tempRange = action.payload.tempRange;\n}\n\nfunction handleShowMultiplicityTrees(draft: Draft<State>) {\n  draft.toolOptions.data.showMultiplicityTrees =\n    !draft.toolOptions.data.showMultiplicityTrees;\n}\n\nfunction handleShowRangesIntegrals(draft: Draft<State>) {\n  draft.toolOptions.data.showRangesIntegrals =\n    !draft.toolOptions.data.showRangesIntegrals;\n}\n\nfunction handleShowJGraph(draft: Draft<State>) {\n  draft.toolOptions.data.showJGraph = !draft.toolOptions.data.showJGraph;\n}\n\nexport {\n  handleAutoRangesDetection,\n  handleDeleteRange,\n  handleDeleteSignal,\n  handleChangeRangeSum,\n  handleAddRange,\n  handleResizeRange,\n  handleChangeRangeRelativeValue,\n  handleChangeRangeSignalValue,\n  handleChangeRangeSignalKind,\n  handleSaveEditedRange,\n  handleUnlinkRange,\n  handleSetDiaIDRange,\n  handleChangeRangesSumFlag,\n  handleChangeTempRange,\n  handleShowMultiplicityTrees,\n  handleShowRangesIntegrals,\n  handleAutoSpectraRangesDetection,\n  handleShowJGraph,\n};\n","import { DatumKind } from '../constants/SignalsKinds';\nimport { Zone } from '../types/data2d';\n\nexport function getDiaIDs(zone: Zone, axis: string): string[] {\n  return ([] as string[]).concat(\n    zone[axis].diaIDs || [],\n    zone.signals\n      ? zone.signals.map((signal) => signal[axis].diaIDs || []).flat()\n      : [],\n  );\n}\n\nexport function getNbAtoms(zone: Zone, axis: string) {\n  return zone.signals\n    ? zone.signals.reduce(\n        (sum, signal) =>\n          signal[axis].nbAtoms ? sum + signal[axis].nbAtoms : sum,\n        0,\n      )\n    : 0;\n}\n\nexport function setNbAtoms(zone: Zone, axis: string): void {\n  zone[axis].nbAtoms = getNbAtoms(zone, axis);\n  if (zone[axis].nbAtoms === 0) {\n    delete zone[axis].nbAtoms;\n  }\n}\n\nexport function resetDiaIDs(zone: Zone, axis: string) {\n  delete zone[axis].diaIDs;\n  delete zone[axis].nbAtoms;\n  zone.signals.forEach((signal) => {\n    delete signal[axis].diaIDs;\n    delete signal[axis].nbAtoms;\n  });\n  return zone;\n}\n\nexport function checkZoneKind(zone: Zone): boolean {\n  return zone.kind === DatumKind.signal;\n}\n\nexport function checkSignalKinds(zone: Zone, kinds: string[]): boolean {\n  return !zone.signals.some(\n    (_signal) => _signal.kind === undefined || !kinds.includes(_signal.kind),\n  );\n}\n\nexport function unlink(\n  zone: Zone,\n  isOnZoneLevel?: boolean,\n  signalIndex?: number,\n  axis?: string,\n): Zone {\n  if (isOnZoneLevel !== undefined && axis !== undefined) {\n    if (isOnZoneLevel === true) {\n      delete zone[axis].diaIDs;\n      delete zone[axis].nbAtoms;\n    } else if (\n      typeof signalIndex === 'number' &&\n      signalIndex !== -1 &&\n      zone.signals[signalIndex]\n    ) {\n      delete zone.signals[signalIndex][axis].diaIDs;\n      delete zone.signals[signalIndex][axis].nbAtoms;\n    }\n    setNbAtoms(zone, axis);\n  } else if (axis !== undefined) {\n    resetDiaIDs(zone, axis);\n    setNbAtoms(zone, axis);\n  } else {\n    ['x', 'y'].forEach((key) => {\n      resetDiaIDs(zone, key);\n      setNbAtoms(zone, key);\n    });\n  }\n  return zone;\n}\n\nexport function unlinkInAssignmentData(\n  assignmentData,\n  zones: Partial<Zone>[],\n  axis?: string,\n): void {\n  const ids = zones.reduce((acc: string[], zone) => {\n    if (zone.id) {\n      acc.push(zone.id);\n    }\n    if (zone.signals) {\n      acc = acc.concat(zone.signals.map((signal) => signal.id, []));\n    }\n    return acc;\n  }, []);\n\n  if (axis) {\n    assignmentData.dispatch({\n      type: 'REMOVE_ALL',\n      payload: { id: ids, axis },\n    });\n  } else {\n    assignmentData.dispatch({\n      type: 'REMOVE_ALL',\n      payload: { id: ids, axis: 'x' },\n    });\n    assignmentData.dispatch({\n      type: 'REMOVE_ALL',\n      payload: { id: ids, axis: 'y' },\n    });\n  }\n}\n","const LAYOUT = {\n  TOP_1D: 'TOP_1D',\n  LEFT_1D: 'LEFT_1D',\n  CENTER_2D: 'CENTER_2D',\n};\n\ninterface MarginProps {\n  top: number;\n  left: number;\n  right: number;\n  bottom: number;\n}\n\nfunction get2DDimensionLayout({\n  width,\n  height,\n  margin,\n}: {\n  width: number;\n  height: number;\n  margin: MarginProps;\n}) {\n  return {\n    CENTER_2D: {\n      startX: margin.left,\n      startY: margin.top,\n      endX: width - margin.right,\n      endY: height - margin.bottom,\n    },\n    TOP_1D: {\n      startX: margin.left,\n      startY: 0,\n      endX: width - margin.right,\n      endY: margin.top,\n    },\n    LEFT_1D: {\n      startX: 0,\n      startY: margin.top,\n      endX: margin.left,\n      endY: height - margin.bottom,\n    },\n  };\n}\n\ninterface StartEndProps {\n  startX: number;\n  endX?: number;\n  startY: number;\n  endY?: number;\n}\n\ninterface DimensionType {\n  CENTER_2D: {\n    startX: number;\n    startY: number;\n    endX: number;\n    endY: number;\n  };\n  TOP_1D: {\n    startX: number;\n    startY: number;\n    endX: number;\n    endY: number;\n  };\n  LEFT_1D: {\n    startX: number;\n    startY: number;\n    endX: number;\n    endY: number;\n  };\n}\n\nfunction getLayoutID(dimension: DimensionType, brushData: StartEndProps) {\n  for (const key of Object.keys(dimension)) {\n    if (\n      brushData.startX >= dimension[key].startX &&\n      brushData.startX <= dimension[key].endX &&\n      brushData.startY >= dimension[key].startY &&\n      brushData.startY <= dimension[key].endY\n    ) {\n      return key;\n    }\n  }\n  return null;\n}\n\nexport { LAYOUT, get2DDimensionLayout, getLayoutID };\n","import { scaleLinear } from 'd3';\n\nimport { LAYOUT } from './DimensionLayout';\n\nfunction get2DXScale(props: {\n  width: number;\n  margin: { right: number; left: number };\n  xDomain: Array<number>;\n}) {\n  const { width, margin, xDomain } = props;\n  return scaleLinear(xDomain, [width - margin.right, margin.left]);\n}\n\nfunction get2DYScale(\n  props: {\n    height: number;\n    margin: { bottom: number; top: number };\n    yDomain: Array<number>;\n  },\n  reverse = false,\n) {\n  const { height, margin, yDomain } = props;\n  return scaleLinear(\n    yDomain,\n    reverse\n      ? [height - margin.bottom, margin.top]\n      : [margin.top, height - margin.bottom],\n  );\n}\n\ninterface TopLayout {\n  width: number;\n  margin: { right: number; left: number };\n  xDomain: Array<number>;\n}\n\ninterface LeftLayout {\n  height: number;\n  margin: { bottom: number; top: number };\n  yDomain: Array<number>;\n}\n\nfunction get1DXScale(props: TopLayout | LeftLayout, layout: string) {\n  if (![LAYOUT.TOP_1D, LAYOUT.LEFT_1D].includes(layout)) {\n    throw new Error(\n      `layout is required and must be ${LAYOUT.TOP_1D} or ${LAYOUT.LEFT_1D}  `,\n    );\n  }\n\n  switch (layout) {\n    case LAYOUT.TOP_1D: {\n      const { width, margin, xDomain } = props as TopLayout;\n      return scaleLinear(xDomain, [width - margin.right, margin.left]);\n    }\n    case LAYOUT.LEFT_1D: {\n      const { height, margin, yDomain } = props as LeftLayout;\n      return scaleLinear(yDomain, [height - margin.bottom, margin.top]);\n    }\n    default:\n      break;\n  }\n}\n\nfunction get1DYScale(yDomain: Array<number>, height: number, margin = 10) {\n  return scaleLinear(yDomain, [height - margin, margin]);\n}\n\nexport { get2DXScale, get2DYScale, get1DXScale, get1DYScale };\n","import { get2DXScale, get2DYScale } from '../../2d/utilities/scale';\n\nexport default function get2DRange(draft, options) {\n  const { startX, startY, endX, endY } = options;\n  const scaleX = get2DXScale(draft);\n  const scaleY = get2DYScale(draft);\n  const x1 = startX * 1000000 > endX * 1000000 ? endX : startX;\n  const x2 = startX * 1000000 > endX * 1000000 ? startX : endX;\n  const y1 = startY * 1000000 > endY * 1000000 ? endY : startY;\n  const y2 = startY * 1000000 > endY * 1000000 ? startY : endY;\n\n  const fromY = scaleY.invert(y1);\n  const fromX = scaleX.invert(x1);\n  const toY = scaleY.invert(y2);\n  const toX = scaleX.invert(x2);\n  return { fromX, fromY, toX, toY };\n}\n","import { FromTo } from 'cheminfo-types';\nimport { Draft, original } from 'immer';\nimport lodashCloneDeep from 'lodash/cloneDeep';\nimport { setPathLength } from 'nmr-correlation';\n\nimport * as Filters from '../../../data/Filters';\nimport * as FiltersManager from '../../../data/FiltersManager';\nimport {\n  DatumKind,\n  SignalKindsToInclude,\n} from '../../../data/constants/SignalsKinds';\nimport {\n  changeZoneSignal,\n  detectZones,\n  detectZonesManual,\n  updateShift,\n} from '../../../data/data2d/Spectrum2D';\nimport { Datum2D, Signal2D } from '../../../data/types/data2d';\nimport {\n  unlink,\n  unlinkInAssignmentData,\n} from '../../../data/utilities/ZoneUtilities';\nimport { State } from '../Reducer';\nimport get2DRange from '../helper/get2DRange';\n\nimport { handleUpdateCorrelations } from './CorrelationsActions';\nimport { setDomain } from './DomainActions';\n\nfunction changeZonesFactorHandler(draft: Draft<State>, action) {\n  draft.toolOptions.data.zonesNoiseFactor = action.payload;\n}\n\nfunction add2dZoneHandler(draft: Draft<State>, action) {\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n    const drawnZone = get2DRange(draft, action);\n    const datum = draft.data[index] as Datum2D;\n\n    const zones = detectZonesManual(original(datum), {\n      selectedZone: drawnZone,\n      thresholdFactor: draft.toolOptions.data.zonesNoiseFactor,\n      convolutionByFFT: false,\n    });\n\n    datum.zones.values = datum.zones.values.concat(zones);\n\n    handleOnChangeZonesData(draft);\n  }\n}\nfunction handleAutoZonesDetection(draft: Draft<State>, detectionOptions) {\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n\n    const [fromX, toX] = draft.xDomain;\n    const [fromY, toY] = draft.yDomain;\n    detectionOptions.selectedZone = { fromX, toX, fromY, toY };\n    const datum = draft.data[index] as Datum2D;\n    const zones = detectZones(original(datum), detectionOptions);\n    datum.zones.values = datum.zones.values.concat(zones);\n    handleOnChangeZonesData(draft);\n  }\n}\nfunction handleAutoSpectraZonesDetection(draft: Draft<State>) {\n  for (const datum of draft.data) {\n    if (datum.info.dimension === 2) {\n      const { minX, maxX, minY, maxY } = (datum as Datum2D).data;\n      const detectionOptions = {\n        selectedZone: { fromX: minX, toX: maxX, fromY: minY, toY: maxY },\n        thresholdFactor: 1,\n      };\n\n      const zones = detectZones(original(datum), detectionOptions);\n      (datum as Datum2D).zones.values = (datum as Datum2D).zones.values.concat(\n        zones,\n      );\n\n      handleOnChangeZonesData(draft);\n    }\n  }\n}\n\nfunction changeZoneSignalDelta(draft: Draft<State>, action) {\n  const { zoneID, signal } = action.payload;\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n    const { xShift, yShift } = changeZoneSignal(\n      draft.data[index] as Datum2D,\n      zoneID,\n      signal,\n    );\n    let filters: any = [];\n    if (xShift !== 0) {\n      filters.push({ name: Filters.shift2DX.id, options: xShift });\n    }\n    if (yShift !== 0) {\n      filters.push({ name: Filters.shift2DY.id, options: yShift });\n    }\n\n    FiltersManager.applyFilter(draft.data[index], filters);\n\n    updateShift(draft.data[index] as Datum2D);\n\n    setDomain(draft);\n    handleOnChangeZonesData(draft);\n  }\n}\n\nfunction getZoneIndex(state, spectrumIndex, zoneID) {\n  return state.data[spectrumIndex].zones.values.findIndex(\n    (zone) => zone.id === zoneID,\n  );\n}\n\nfunction handleChangeZoneSignalKind(draft: Draft<State>, action) {\n  const state = original(draft) as State;\n  if (state.activeSpectrum?.id) {\n    const { index } = state.activeSpectrum;\n    const { rowData, value } = action.payload;\n    const zoneIndex = getZoneIndex(state, index, rowData.id);\n    const _zone = (draft.data[index] as Datum2D).zones.values[zoneIndex];\n    _zone.signals[rowData.tableMetaInfo.signalIndex].kind = value;\n    _zone.kind = SignalKindsToInclude.includes(value)\n      ? DatumKind.signal\n      : DatumKind.mixed;\n    handleOnChangeZonesData(draft);\n  }\n}\n\nfunction handleDeleteZone(draft: Draft<State>, action) {\n  const state = original(draft) as State;\n  if (state.activeSpectrum?.id) {\n    const { index } = state.activeSpectrum;\n    const { id, assignmentData } = action.payload;\n    if (id) {\n      const zone = (draft.data[index] as Datum2D).zones.values.find(\n        (zone) => zone.id === id,\n      );\n      unlinkInAssignmentData(assignmentData, [zone || {}]);\n      const zoneIndex = getZoneIndex(state, index, id);\n      (draft.data[index] as Datum2D).zones.values.splice(zoneIndex, 1);\n    } else {\n      unlinkInAssignmentData(\n        assignmentData,\n        (draft.data[index] as Datum2D).zones.values,\n      );\n      (draft.data[index] as Datum2D).zones.values = [];\n    }\n    handleOnChangeZonesData(draft);\n  }\n}\n\nfunction handleDeleteSignal(draft: Draft<State>, action) {\n  const {\n    spectrum,\n    zone,\n    signal,\n    assignmentData,\n    unlinkSignalInAssignmentData = true,\n  } = action.payload;\n\n  if (spectrum && zone) {\n    const datum2D = draft.data.find(\n      (datum) => datum.id === spectrum.id,\n    ) as Datum2D;\n    const zoneIndex = datum2D.zones.values.findIndex(\n      (_zone) => _zone.id === zone.id,\n    );\n    const signalIndex = zone.signals.findIndex(\n      (_signal) => _signal.id === signal.id,\n    );\n    // remove assignments for the signal in zone object and global state\n    const _zone = unlink(lodashCloneDeep(zone), false, signalIndex, undefined);\n    if (unlinkSignalInAssignmentData === true) {\n      unlinkInAssignmentData(\n        assignmentData,\n        [{ signals: [signal] }],\n        undefined,\n      );\n    }\n    _zone.signals.splice(signalIndex, 1);\n    datum2D.zones.values[zoneIndex] = _zone;\n    // if no signals are existing in a zone anymore then delete this zone\n    if (_zone.signals.length === 0) {\n      unlinkInAssignmentData(assignmentData, [_zone]);\n      datum2D.zones.values.splice(zoneIndex, 1);\n    }\n\n    handleOnChangeZonesData(draft);\n  }\n}\n\nfunction handleSetSignalPathLength(draft: Draft<State>, action) {\n  const { spectrum, zone, signal, pathLength } = action.payload;\n  if (spectrum && zone) {\n    const datum2D = draft.data.find(\n      (datum) => datum.id === spectrum.id,\n    ) as Datum2D;\n    const zoneIndex = datum2D.zones.values.findIndex(\n      (_zone) => _zone.id === zone.id,\n    );\n    const signalIndex = zone.signals.findIndex(\n      (_signal) => _signal.id === signal.id,\n    );\n    const _zone = unlink(lodashCloneDeep(zone), false, signalIndex, undefined);\n    _zone.signals[signalIndex].j = {\n      ..._zone.signals[signalIndex].j,\n      pathLength,\n    };\n    datum2D.zones.values[zoneIndex] = _zone;\n\n    handleOnChangeZonesData(draft);\n  }\n}\n\nfunction handleUnlinkZone(draft: Draft<State>, action) {\n  const state = original(draft) as State;\n  if (state.activeSpectrum?.id) {\n    const { index } = state.activeSpectrum;\n    const {\n      zoneData = null,\n      assignmentData,\n      isOnZoneLevel = undefined,\n      signalIndex = -1,\n      axis = undefined,\n    } = action.payload;\n\n    if (zoneData) {\n      // remove assignments in global state\n\n      const zoneIndex = getZoneIndex(state, index, zoneData.id);\n\n      const zone = lodashCloneDeep(\n        (draft.data[index] as Datum2D).zones.values[zoneIndex],\n      );\n      const _zoneData = unlink(zone, isOnZoneLevel, signalIndex, axis);\n\n      unlinkInAssignmentData(\n        assignmentData,\n        [{ id: zoneData.signals[signalIndex].id }],\n        axis,\n      );\n      (draft.data[index] as Datum2D).zones.values[zoneIndex] = _zoneData;\n    } else {\n      const zones = (draft.data[index] as Datum2D).zones.values.map((zone) => {\n        return unlink(zone);\n      });\n      (draft.data[index] as Datum2D).zones.values = zones;\n\n      unlinkInAssignmentData(assignmentData, zones);\n    }\n  }\n}\n\nfunction handleSetDiaIDZone(draft: Draft<State>, action) {\n  const state = original(draft) as State;\n  if (state.activeSpectrum?.id) {\n    const { index } = state.activeSpectrum;\n    const { zoneData, diaIDs, axis, signalIndex, nbAtoms } = action.payload;\n    const getNbAtoms = (input, current = 0) => input + current;\n    const zoneIndex = getZoneIndex(state, index, zoneData.id);\n    const _zone = (draft.data[index] as Datum2D).zones.values[zoneIndex];\n    if (signalIndex === undefined) {\n      _zone[axis].diaIDs = diaIDs;\n      _zone[axis].nbAtoms = getNbAtoms(nbAtoms, _zone[axis].nbAtoms);\n    } else {\n      _zone.signals[signalIndex][axis].diaIDs = diaIDs;\n      _zone.signals[signalIndex][axis].nbAtoms = getNbAtoms(\n        nbAtoms,\n        _zone.signals[signalIndex][axis].nbAtoms,\n      );\n    }\n  }\n}\n\nfunction handleSaveEditedZone(draft: Draft<State>, action) {\n  const state = original(draft) as State;\n  if (state.activeSpectrum?.id) {\n    const { index } = state.activeSpectrum;\n    const { editedRowData } = action.payload;\n\n    delete editedRowData.tableMetaInfo;\n\n    const zoneIndex = getZoneIndex(state, index, editedRowData.id);\n    (draft.data[index] as Datum2D).zones.values[zoneIndex] = editedRowData;\n\n    if (editedRowData.signals) {\n      editedRowData.signals.forEach((signal: Signal2D) => {\n        setPathLength(\n          draft.correlations.values,\n          signal.id,\n          signal.j?.pathLength as FromTo,\n        );\n      });\n    }\n\n    handleOnChangeZonesData(draft);\n  }\n}\n\nfunction handleOnChangeZonesData(draft) {\n  handleUpdateCorrelations(draft);\n}\n\nexport {\n  add2dZoneHandler,\n  handleAutoZonesDetection,\n  handleDeleteSignal,\n  handleDeleteZone,\n  changeZoneSignalDelta,\n  handleChangeZoneSignalKind,\n  handleUnlinkZone,\n  handleSaveEditedZone,\n  handleSetDiaIDZone,\n  handleSetSignalPathLength,\n  changeZonesFactorHandler,\n  handleAutoSpectraZonesDetection,\n};\n","import { original, Draft } from 'immer';\nimport lodashCloneDeep from 'lodash/cloneDeep';\nimport {\n  buildCorrelationData,\n  setCorrelation,\n  Tolerance,\n  Options as CorrelationOptions,\n  Correlation,\n  Spectra,\n  Values as CorrelationValues,\n} from 'nmr-correlation';\n\nimport { Datum1D } from '../../../data/types/data1d';\nimport { Datum2D } from '../../../data/types/data2d';\nimport {\n  findRange,\n  findSignal1D,\n  findSignal2D,\n  findSpectrum,\n  findZone,\n} from '../../../data/utilities/FindUtilities';\nimport { State } from '../Reducer';\n\nimport { handleDeleteSignal as handleDeleteSignal1D } from './RangesActions';\nimport { handleDeleteSignal as handleDeleteSignal2D } from './ZonesActions';\n\nfunction handleUpdateCorrelations(draft: Draft<State>) {\n  const { data: spectra, correlations } = draft;\n  draft.correlations = buildCorrelationData(spectra as Spectra, {\n    ...correlations.options,\n    values: lodashCloneDeep(correlations.values),\n  });\n}\n\nfunction handleSetMF(draft: Draft<State>, payload: { mf: string }) {\n  const state = original(draft) as State;\n  const { data: spectra, correlations } = state;\n  const { mf } = payload;\n  // update of correlation data is needed only if the following is true\n  if (correlations.options.mf === '' || correlations.options.mf !== mf) {\n    draft.correlations = buildCorrelationData(spectra as Spectra, {\n      ...correlations.options,\n      mf,\n      values: lodashCloneDeep(correlations.values),\n    });\n  }\n}\n\nfunction handleSetTolerance(\n  draft: Draft<State>,\n  payload: { tolerance: Tolerance },\n) {\n  const state = original(draft) as State;\n  const { data: spectra, correlations } = state;\n  const { tolerance } = payload;\n  draft.correlations = buildCorrelationData(spectra as Spectra, {\n    ...correlations.options,\n    tolerance,\n    values: lodashCloneDeep(correlations.values),\n  });\n}\n\nfunction handleSetCorrelation(\n  draft: Draft<State>,\n  payload: {\n    id: string;\n    correlation: Correlation;\n    options: CorrelationOptions;\n  },\n) {\n  const state = original(draft) as State;\n  const { correlations } = state;\n  const { id, correlation, options } = payload;\n  draft.correlations = setCorrelation(correlations, id, correlation);\n  if (options) {\n    draft.correlations = {\n      ...draft.correlations,\n      options: { ...draft.correlations.options, ...options },\n    };\n  }\n  handleUpdateCorrelations(draft);\n}\n\nfunction handleSetCorrelations(\n  draft: Draft<State>,\n  payload: {\n    correlations: CorrelationValues;\n    options: CorrelationOptions;\n  },\n) {\n  const { correlations, options } = payload;\n  const state = original(draft) as State;\n  let correlationsData = lodashCloneDeep(state.correlations);\n  correlations.forEach((correlation) => {\n    correlationsData = setCorrelation(\n      correlationsData,\n      correlation.id,\n      correlation,\n    );\n  });\n  draft.correlations = correlationsData;\n  if (options) {\n    draft.correlations = {\n      ...draft.correlations,\n      options: { ...draft.correlations.options, ...options },\n    };\n  }\n  handleUpdateCorrelations(draft);\n}\n\nfunction handleDeleteCorrelation(\n  draft: Draft<State>,\n  payload: { correlation: Correlation; assignmentData },\n) {\n  const { correlation, assignmentData } = payload;\n  // delete all signals linked to the correlation\n  correlation.link.forEach((link) => {\n    const spectrum = findSpectrum(draft.data, link.experimentID, false);\n    if (spectrum) {\n      if (spectrum.info.dimension === 1) {\n        const range = findRange(spectrum as Datum1D, link.signal.id);\n        const signal = findSignal1D(spectrum as Datum1D, link.signal.id);\n        handleDeleteSignal1D(draft, {\n          payload: {\n            spectrum,\n            range,\n            signal,\n            assignmentData,\n          },\n        });\n      } else if (spectrum.info.dimension === 2) {\n        const zone = findZone(spectrum as Datum2D, link.signal.id);\n        const signal = findSignal2D(spectrum as Datum2D, link.signal.id);\n        handleDeleteSignal2D(draft, {\n          payload: {\n            spectrum,\n            zone,\n            signal,\n            assignmentData,\n          },\n        });\n      }\n    }\n  });\n}\n\nexport {\n  handleDeleteCorrelation,\n  handleSetCorrelation,\n  handleSetCorrelations,\n  handleSetMF,\n  handleSetTolerance,\n  handleUpdateCorrelations,\n};\n","import { zoomIdentity, scaleLinear } from 'd3';\nimport { Draft } from 'immer';\n\nimport { State } from '../Reducer';\n\nexport const ZoomType = {\n  HORIZONTAL: 'HORIZONTAL',\n  VERTICAL: 'VERTICAL',\n  STEP_HORIZONTAL: 'STEP_HORIZONTAL',\n  FULL: 'FULL',\n};\ninterface ZoomOptions {\n  factor?: number;\n  invert?: boolean;\n}\nfunction wheelZoom(\n  event: WheelEvent,\n  domain: number[],\n  zoomOptions: ZoomOptions = {},\n): number[] {\n  const { factor = 1, invert = false } = zoomOptions;\n  const deltaY =\n    Math.abs(event.deltaY) < 100 ? event.deltaY * 100 : event.deltaY;\n  const delta = deltaY * (invert ? -0.001 : 0.001) * factor;\n  const ratio = delta < 0 ? -1 / (delta - 1) : 1 + delta;\n\n  const [min, max] = domain;\n\n  return [min * ratio, max * ratio];\n}\n\nfunction setZoom(\n  draft: Draft<State>,\n  options: {\n    scale?: number;\n    spectrumID?: string;\n  } = {},\n) {\n  const { height, margin, activeSpectrum } = draft;\n  const { scale = 1, spectrumID = null } = options;\n\n  if (activeSpectrum === null && spectrumID === null) {\n    const { shareYDomain, yDomain, yDomains } = draft.originDomain;\n    draft.yDomains = Object.keys(draft.yDomains).reduce((acc, id) => {\n      const _scale = scaleLinear(shareYDomain ? yDomain : yDomains[id], [\n        height - margin.bottom,\n        margin.top,\n      ]);\n      const [min, max] = shareYDomain ? yDomain : yDomains[id];\n      const maxPoint = Math.max(Math.abs(max), Math.abs(min));\n      const scalePoint = maxPoint === max ? 0 : min;\n      const t = zoomIdentity\n        .translate(\n          0,\n          Math.sign(scalePoint) >= 0 ? _scale(scalePoint) : _scale(scalePoint),\n        )\n        .scale(scale)\n        .translate(0, -_scale(0));\n      const newYDomain = t.rescaleY(_scale).domain();\n      acc[id] = newYDomain;\n      return acc;\n    }, {});\n  } else {\n    const spectrumId = spectrumID || activeSpectrum?.id;\n    if (spectrumId) {\n      const _scale = scaleLinear(draft.originDomain.yDomains[spectrumId], [\n        height - margin.bottom,\n        margin.top,\n      ]);\n      const t = zoomIdentity\n        .translate(0, _scale(0))\n        .scale(scale)\n        .translate(0, -_scale(0));\n      const yDomain = t.rescaleY(_scale).domain();\n\n      draft.yDomains = {\n        ...draft.yDomains,\n        [spectrumId]: yDomain,\n      };\n    }\n  }\n}\n\nexport { setZoom, wheelZoom };\n","import { Draft } from 'immer';\n\nimport { generateSpectrumFromRanges } from '../../../data/data1d/Spectrum1D/ranges/generateSpectrumFromRanges';\nimport { State } from '../Reducer';\nimport { setZoom } from '../helper/Zoom1DManager';\n\nimport { setDomain } from './DomainActions';\n\nfunction handleRangeResurrecting(draft: Draft<State>, action) {\n  const { ranges, info } = action.payload;\n\n  const datum = generateSpectrumFromRanges(ranges, info, draft.usedColors);\n  draft.data.push(datum);\n  setDomain(draft, { yDomain: { isShared: false } });\n  setZoom(draft, { scale: 0.8, spectrumID: datum.id });\n}\n\nexport { handleRangeResurrecting };\n","import { Draft } from 'immer';\n\nimport { State } from '../Reducer';\n\nfunction setWidth(draft: Draft<State>, width) {\n  draft.width = width;\n}\n\nfunction handleSetDimensions(draft: Draft<State>, width, height) {\n  draft.width = width;\n  draft.height = height;\n}\n\nexport { setWidth, handleSetDimensions };\n","import { Datum1D } from '../../data/types/data1d/Datum1D';\nimport { Datum2D } from '../../data/types/data2d';\n\nimport nucleusToString from './nucleusToString';\n\nexport function getSpectraByNucleus(\n  nucleus: string,\n  data: (Datum1D | Datum2D)[],\n) {\n  return data.filter(\n    (spectrum) => nucleusToString(spectrum.info.nucleus) === nucleus,\n  );\n}\n","interface HistoryItem {\n  xDomain: Array<number>;\n  yDomain: Array<number>;\n}\n\nexport interface ZoomHistory {\n  [key: string]: Array<HistoryItem>;\n}\ninterface ZoomHistoryManager {\n  historyStack: Array<HistoryItem>;\n  push: (value: HistoryItem) => void;\n  pop: () => HistoryItem;\n  getLast: () => HistoryItem;\n  clear: () => void;\n}\n\nexport default function zoomHistoryManager(\n  zoomHistory: ZoomHistory,\n  nucleus: string,\n): ZoomHistoryManager {\n  if (!zoomHistory[nucleus] && !Array.isArray(zoomHistory[nucleus])) {\n    zoomHistory[nucleus] = [];\n  }\n\n  const push = preparePush(zoomHistory[nucleus]);\n  const pop = preparePop(zoomHistory[nucleus]);\n  const getLast = prepareGetLast(zoomHistory[nucleus]);\n  const clear = () => (zoomHistory[nucleus] = []);\n  return { historyStack: zoomHistory[nucleus], push, pop, getLast, clear };\n}\n\nfunction preparePush(historyStack) {\n  return (val: HistoryItem) => {\n    historyStack.push(val);\n  };\n}\n\nfunction preparePop(historyStack) {\n  return () => {\n    const val = historyStack.pop();\n    return val ? historyStack[historyStack.length - 1] : null;\n  };\n}\n\nfunction prepareGetLast(historyStack) {\n  return () => {\n    if (historyStack.length === 0) return null;\n    return historyStack[historyStack.length - 1];\n  };\n}\n","function getNucleusSum(input) {\n  const nucleus = input.split(',');\n  return nucleus.reduce((acc, i) => {\n    const additions = nucleus.length === 2 ? 100 : 0;\n    acc += Number(i.replace(/\\D/g, '')) + additions;\n    return acc;\n  }, 0);\n}\n\nexport default function GroupByInfoKey(key) {\n  return (array, orderByNucleus = false) => {\n    const unorderedGroup = array.reduce((objectsByKeyValue, obj) => {\n      const value = obj.info[key];\n      objectsByKeyValue[value] = (objectsByKeyValue[value] || []).concat(obj);\n      return objectsByKeyValue;\n    }, {});\n\n    if (!orderByNucleus) {\n      return unorderedGroup;\n    } else {\n      return Object.keys(unorderedGroup)\n        .sort((a, b) => getNucleusSum(a) - getNucleusSum(b))\n        .reduce((acc, key) => {\n          acc[key] = unorderedGroup[key];\n          return acc;\n        }, {});\n    }\n  };\n}\n","import { Draft } from 'immer';\nimport cloneDeep from 'lodash/cloneDeep';\n\nimport { Datum1D } from '../../../data/types/data1d';\nimport { Datum2D } from '../../../data/types/data2d';\nimport GroupByInfoKey from '../../utility/GroupByInfoKey';\nimport nucleusToString from '../../utility/nucleusToString';\nimport { State, VerticalAlignment } from '../Reducer';\nimport { DEFAULT_YAXIS_SHIFT_VALUE, DISPLAYER_MODE } from '../core/Constants';\n\nimport { setDomain } from './DomainActions';\n\ninterface AlignmentOptions {\n  align?: VerticalAlignment | 'auto-check';\n  checkData?: boolean;\n  activeTab?: string;\n}\n\nfunction changeSpectrumVerticalAlignment(\n  draft: Draft<State>,\n  options: AlignmentOptions,\n) {\n  if (draft.data && draft.data.length > 0) {\n    let dataPerNucleus: Datum1D[] = [];\n    if (['auto-check', 'stack'].includes(options.align || '')) {\n      dataPerNucleus = (draft.data as Datum1D[]).filter((datum) =>\n        datum.info.nucleus === options?.activeTab\n          ? options.activeTab\n          : draft.activeTab && datum.info.dimension === 1,\n      );\n    }\n\n    switch (options.align) {\n      case 'auto-check':\n      case 'bottom':\n      case 'center': {\n        if (\n          options.align === 'center' ||\n          (options.align === 'auto-check' &&\n            dataPerNucleus[0]?.info.isFid &&\n            !dataPerNucleus.some((d) => d.info.isFid === false))\n        ) {\n          const YAxisShift = draft.height / 2;\n          draft.verticalAlign.align = 'center';\n          draft.verticalAlign.verticalShift = YAxisShift;\n        } else {\n          draft.verticalAlign.align = 'bottom';\n          draft.verticalAlign.verticalShift = DEFAULT_YAXIS_SHIFT_VALUE;\n        }\n        break;\n      }\n\n      case 'stack': {\n        draft.verticalAlign.align = 'stack';\n        const visibleSpectra = dataPerNucleus.filter(\n          (datum) => datum.display.isVisible === true,\n        );\n        draft.verticalAlign.verticalShift = Math.abs(\n          Math.floor(\n            (draft.height - draft.margin.bottom) / (visibleSpectra.length + 2),\n          ),\n        );\n        break;\n      }\n\n      default:\n        return;\n    }\n  }\n}\n\nfunction setKeyPreferencesHandler(draft: Draft<State>, keyCode) {\n  const {\n    activeTab,\n    data,\n    activeSpectrum,\n    zoom,\n    xDomain,\n    xDomains,\n    yDomain,\n    yDomains,\n    originDomain,\n    margin,\n    displayerMode,\n    tabActiveSpectrum,\n  } = draft;\n\n  if (activeTab) {\n    const groupByNucleus = GroupByInfoKey('nucleus');\n\n    const spectrumsGroupsList = groupByNucleus(data);\n\n    const level =\n      displayerMode === DISPLAYER_MODE.DM_2D\n        ? spectrumsGroupsList[activeTab].reduce((acc, datum) => {\n            acc[datum.id] = datum.processingController.getLevel();\n            return acc;\n          }, {})\n        : null;\n\n    draft.keysPreferences[keyCode] = {\n      activeTab,\n      activeSpectrum,\n      displayerMode,\n      tabActiveSpectrum,\n      zoom,\n      xDomain,\n      xDomains,\n      yDomain,\n      yDomains,\n      originDomain,\n      level,\n      margin,\n      data: spectrumsGroupsList[activeTab].reduce((acc, datum) => {\n        acc[datum.id] = {\n          display: {\n            color: datum.display.color,\n            isVisible: datum.display.isVisible,\n            isPeaksMarkersVisible: datum.display.isPeaksMarkersVisible,\n          },\n        };\n        return acc;\n      }, {}),\n    };\n  }\n}\n\nfunction applyKeyPreferencesHandler(draft: Draft<State>, keyCode) {\n  const preferences = draft.keysPreferences[keyCode];\n  if (preferences) {\n    draft.activeTab = preferences.activeTab;\n    (draft.data as Datum1D[] | Datum2D[]).forEach((datum, index) => {\n      if (nucleusToString(datum.info.nucleus) === preferences.activeTab) {\n        draft.data[index].display = Object.assign(\n          cloneDeep(datum.display),\n          preferences.data[datum.id].display,\n        );\n      }\n    });\n    draft.displayerMode = preferences.displayerMode;\n    draft.tabActiveSpectrum = preferences.tabActiveSpectrum;\n    draft.activeSpectrum = preferences.activeSpectrum;\n\n    draft.margin = preferences.margin;\n\n    setDomain(draft);\n\n    draft.xDomain = preferences.xDomain;\n    draft.xDomains = preferences.xDomains;\n    draft.yDomain = preferences.yDomain;\n    draft.originDomain = preferences.originDomain;\n    draft.yDomains = preferences.yDomains;\n\n    if (draft.displayerMode === DISPLAYER_MODE.DM_2D) {\n      for (const datumID of Object.keys(preferences.level)) {\n        const { levelPositive, levelNegative } = preferences.level[datumID];\n        const index = draft.data.findIndex((datum) => datum.id === datumID);\n        const processController = (draft.data[index] as Datum2D)\n          .processingController;\n        processController.setLevel(levelPositive, levelNegative);\n\n        draft.contours[datumID] = processController.drawContours();\n      }\n    } else {\n      draft.zoom = preferences.zoom;\n    }\n  }\n}\n\nexport {\n  changeSpectrumVerticalAlignment,\n  setKeyPreferencesHandler,\n  applyKeyPreferencesHandler,\n};\n","import { max } from 'd3';\nimport { original, Draft, current } from 'immer';\nimport { xFindClosestIndex } from 'ml-spectra-processing';\n\nimport * as Filters from '../../../data/Filters';\nimport { Data1D, Datum1D } from '../../../data/types/data1d';\nimport { Datum2D } from '../../../data/types/data2d';\nimport generateID from '../../../data/utilities/generateID';\nimport { getYScale, getXScale } from '../../1d/utilities/scale';\nimport { LAYOUT } from '../../2d/utilities/DimensionLayout';\nimport { get2DYScale } from '../../2d/utilities/scale';\nimport { options } from '../../toolbar/ToolTypes';\nimport GroupByInfoKey from '../../utility/GroupByInfoKey';\nimport { getSpectraByNucleus } from '../../utility/getSpectraByNucleus';\nimport { State } from '../Reducer';\nimport { DISPLAYER_MODE, MARGIN } from '../core/Constants';\nimport { setZoom, wheelZoom, ZoomType } from '../helper/Zoom1DManager';\nimport zoomHistoryManager from '../helper/ZoomHistoryManager';\n\nimport {\n  setDomain,\n  SetDomainOptions,\n  setIntegralsYDomain,\n  setMode,\n} from './DomainActions';\nimport { resetSpectrumByFilter } from './FiltersActions';\nimport { changeSpectrumVerticalAlignment } from './PreferencesActions';\n\nfunction getStrongestPeak(draft: Draft<State>) {\n  const { activeSpectrum, data } = draft;\n  if (activeSpectrum) {\n    const activeData = data[activeSpectrum?.index].data as Data1D;\n    const strongestPeakValue = max(activeData.re);\n    const index = activeData.re.findIndex((val) => val === strongestPeakValue);\n    return {\n      xValue: activeData.x[index],\n      yValue: strongestPeakValue,\n      index: index,\n    };\n  }\n}\n\nfunction setFilterChanges(draft: Draft<State>, selectedFilter) {\n  const activeSpectrumId = draft.activeSpectrum?.id;\n\n  //save reduced snapshot\n  //select the equalizer tool when you enable manual phase correction filter\n  if (selectedFilter === Filters.phaseCorrection.id) {\n    const datumAfterPhaseCorrection = resetSpectrumByFilter(\n      draft,\n      Filters.phaseCorrection.id,\n      {\n        rollback: true,\n        searchBy: 'name',\n        returnCurrentDatum: true,\n      },\n    );\n    draft.tempData = current(draft).data;\n    if (datumAfterPhaseCorrection) {\n      draft.tempData[datumAfterPhaseCorrection?.index] =\n        datumAfterPhaseCorrection?.datum;\n    }\n    const { xValue, index } = getStrongestPeak(draft) || {\n      xValue: 0,\n      index: 0,\n    };\n\n    draft.toolOptions.data.pivot = { value: xValue, index };\n  } else {\n    if (draft.toolOptions.selectedTool === options.phaseCorrection.id) {\n      draft.toolOptions.data.activeFilterID = null;\n      const spectrumIndex = draft.data.findIndex(\n        (spectrum) => spectrum.id === activeSpectrumId,\n      );\n\n      draft.data[spectrumIndex].data = draft.tempData[spectrumIndex].data;\n    }\n  }\n}\n\nfunction resetTool(draft: Draft<State>, setDefaultTool = true) {\n  // reset temp range\n  draft.toolOptions.data.tempRange = null;\n\n  setSelectedOptionPanel(draft, null);\n  if (setDefaultTool) {\n    draft.toolOptions.selectedTool = options.zoom.id;\n  }\n  draft.toolOptions.data.baseLineZones = [];\n\n  if (draft.toolOptions.data.activeFilterID) {\n    resetSpectrumByFilter(draft);\n  }\n\n  if (draft.tempData) {\n    draft.tempData = null;\n    setDomain(draft);\n  }\n}\n\nfunction resetSelectedTool(draft: Draft<State>, filterOnly = false) {\n  if (\n    (draft.toolOptions.selectedTool &&\n      options[draft.toolOptions.selectedTool].isFilter) ||\n    !filterOnly\n  ) {\n    resetTool(draft);\n  }\n}\n\nfunction setSelectedTool(draft: Draft<State>, action) {\n  const { selectedTool } = action.payload;\n\n  if (draft?.data.length > 0) {\n    if (selectedTool) {\n      // start Range edit mode\n      if (selectedTool === options.editRange.id) {\n        draft.toolOptions.data.tempRange = action.payload.tempRange;\n      } else {\n        draft.toolOptions.data.tempRange = null;\n      }\n\n      if (selectedTool !== draft.toolOptions.selectedTool) {\n        resetTool(draft, false);\n      }\n\n      draft.toolOptions.selectedTool = selectedTool;\n\n      if (options[selectedTool].hasOptionPanel) {\n        setSelectedOptionPanel(draft, selectedTool);\n      }\n\n      if (options[selectedTool].isFilter) {\n        setFilterChanges(draft, selectedTool);\n      }\n    } else {\n      resetTool(draft, false);\n    }\n    setMargin(draft);\n  }\n}\n\nfunction setSelectedOptionPanel(draft: Draft<State>, selectedOptionPanel) {\n  draft.toolOptions.selectedOptionPanel = selectedOptionPanel;\n}\n\nfunction setSpectrumsVerticalAlign(draft: Draft<State>) {\n  const align = ['stack', 'center'].includes(draft.verticalAlign.align)\n    ? 'bottom'\n    : 'center';\n  changeSpectrumVerticalAlignment(draft, { align });\n}\n\nfunction handleChangeSpectrumDisplayMode(draft: Draft<State>) {\n  const align = draft.verticalAlign.align === 'stack' ? 'bottom' : 'stack';\n  changeSpectrumVerticalAlignment(draft, { align });\n}\n\nfunction handleAddBaseLineZone(draft: Draft<State>, { from, to }) {\n  const scaleX = getXScale(draft);\n\n  let start = scaleX.invert(from);\n  const end = scaleX.invert(to);\n\n  let zone: any = [];\n  if (start > end) {\n    zone = [end, start];\n  } else {\n    zone = [start, end];\n  }\n\n  const zones = draft.toolOptions.data.baseLineZones.slice();\n  zones.push({\n    id: generateID(),\n    from: zone[0],\n    to: zone[1],\n  });\n  draft.toolOptions.data.baseLineZones = zones;\n}\n\nfunction handleDeleteBaseLineZone(draft: Draft<State>, id) {\n  const state = original(draft) as State;\n  draft.toolOptions.data.baseLineZones =\n    state.toolOptions.data.baseLineZones.baseLineZones.filter(\n      (zone) => zone.id !== id,\n    );\n}\n\nfunction handleToggleRealImaginaryVisibility(draft) {\n  if (draft.activeSpectrum != null) {\n    const { index } = draft.activeSpectrum;\n\n    draft.data[index].display.isRealSpectrumVisible =\n      !draft.data[index].display.isRealSpectrumVisible;\n\n    setDomain(draft);\n  }\n}\n\nfunction handleBrushEnd(draft: Draft<State>, action) {\n  const is2D = draft.displayerMode === DISPLAYER_MODE.DM_2D;\n  const xScale = getXScale(draft);\n\n  const yScale = is2D ? get2DYScale(draft) : getYScale(draft);\n\n  const startX = xScale.invert(action.startX);\n  const endX = xScale.invert(action.endX);\n  const startY = yScale.invert(action.startY);\n  const endY = yScale.invert(action.endY);\n  const domainX = startX > endX ? [endX, startX] : [startX, endX];\n  const domainY = startY > endY ? [endY, startY] : [startY, endY];\n  const brushHistory = zoomHistoryManager(draft.zoom.history, draft.activeTab);\n  if (draft.displayerMode === DISPLAYER_MODE.DM_2D) {\n    switch (action.trackID) {\n      case LAYOUT.CENTER_2D:\n        draft.xDomain = domainX;\n        draft.yDomain = domainY;\n        break;\n      case LAYOUT.TOP_1D:\n        draft.xDomain = domainX;\n        break;\n      case LAYOUT.LEFT_1D:\n        draft.yDomain = domainY;\n        break;\n      default:\n        break;\n    }\n    if (brushHistory) {\n      brushHistory.push({ xDomain: draft.xDomain, yDomain: draft.yDomain });\n    }\n  } else {\n    draft.xDomain = domainX;\n    if (brushHistory) {\n      brushHistory.push({ xDomain: domainX, yDomain: domainY });\n    }\n  }\n}\nfunction setVerticalIndicatorXPosition(draft: Draft<State>, position) {\n  if (draft.activeSpectrum?.id) {\n    const scaleX = getXScale(draft);\n    const value = scaleX.invert(position);\n    const datum = draft.data[draft.activeSpectrum.index] as Datum1D;\n    const index = xFindClosestIndex(datum.data.x, value);\n    draft.toolOptions.data.pivot = { value, index };\n  }\n}\n\nfunction getSpectrumID(draft: Draft<State>, index): string | null {\n  const spectrum = draft.tabActiveSpectrum[draft.activeTab.split(',')[index]];\n  return spectrum?.id ? spectrum.id : null;\n}\n\nfunction handleZoom(draft: Draft<State>, action) {\n  const { event, trackID, selectedTool } = action;\n  const {\n    activeSpectrum,\n    toolOptions: {\n      data: { showRangesIntegrals },\n    },\n    displayerMode,\n  } = draft;\n  if (displayerMode === DISPLAYER_MODE.DM_2D) {\n    const index =\n      trackID === LAYOUT.TOP_1D ? 0 : trackID === LAYOUT.LEFT_1D ? 1 : null;\n    if (index !== null) {\n      const id = getSpectrumID(draft, index);\n      if (id) {\n        const domain = draft.yDomains[id];\n        draft.yDomains[id] = wheelZoom(event, domain);\n      }\n    }\n  } else {\n    if (activeSpectrum?.id) {\n      if (\n        (showRangesIntegrals || selectedTool === options.integral.id) &&\n        event.shiftKey\n      ) {\n        const domain = draft.integralsYDomains[activeSpectrum?.id];\n        draft.integralsYDomains[activeSpectrum?.id] = wheelZoom(event, domain);\n      } else {\n        const domain = draft.yDomains[activeSpectrum?.id];\n        draft.yDomains[activeSpectrum?.id] = wheelZoom(event, domain);\n      }\n    } else {\n      const spectra = getSpectraByNucleus(\n        draft.activeTab,\n        draft.data,\n      ) as Datum1D[];\n      for (const spectrum of spectra) {\n        const domain = draft.yDomains[spectrum.id];\n        draft.yDomains[spectrum.id] = wheelZoom(event, domain);\n      }\n    }\n  }\n}\n\nfunction zoomOut(draft: Draft<State>, action) {\n  if (draft?.data.length > 0) {\n    const { zoomType, trackID } = action;\n    const zoomHistory = zoomHistoryManager(draft.zoom.history, draft.activeTab);\n\n    if (draft.displayerMode === DISPLAYER_MODE.DM_1D) {\n      switch (zoomType) {\n        case ZoomType.HORIZONTAL: {\n          draft.xDomain = draft.originDomain.xDomain;\n          zoomHistory.clear();\n          break;\n        }\n        case ZoomType.VERTICAL:\n          setZoom(draft, { scale: 0.8 });\n          break;\n        case ZoomType.STEP_HORIZONTAL: {\n          const zoomValue = zoomHistory.pop();\n          draft.xDomain = zoomValue\n            ? zoomValue.xDomain\n            : draft.originDomain.xDomain;\n          setZoom(draft, { scale: 0.8 });\n          break;\n        }\n        default: {\n          draft.xDomain = draft.originDomain.xDomain;\n          setZoom(draft, { scale: 0.8 });\n          break;\n        }\n      }\n    } else {\n      const { xDomain, yDomain, yDomains } = draft.originDomain;\n\n      if ([LAYOUT.TOP_1D, LAYOUT.LEFT_1D, LAYOUT.CENTER_2D].includes(trackID)) {\n        const zoomValue = zoomHistory.pop();\n        draft.xDomain = zoomValue ? zoomValue.xDomain : xDomain;\n        draft.yDomain = zoomValue ? zoomValue.yDomain : yDomain;\n      } else {\n        zoomHistory.clear();\n        draft.xDomain = xDomain;\n        draft.yDomain = yDomain;\n        draft.yDomains = yDomains;\n      }\n    }\n  }\n}\n\nfunction hasAcceptedSpectrum(draft: Draft<State>, index) {\n  const nucleuses = draft.activeTab.split(',');\n  const activeSpectrum = draft.tabActiveSpectrum[nucleuses[index]];\n  return (\n    activeSpectrum?.id &&\n    !(draft.data[activeSpectrum.index] as Datum1D).info.isFid\n  );\n}\n\nfunction setMargin(draft: Draft<State>) {\n  if (\n    draft.displayerMode === DISPLAYER_MODE.DM_2D &&\n    draft.toolOptions.selectedTool !== options.slicingTool.id\n  ) {\n    const top = hasAcceptedSpectrum(draft, 0)\n      ? MARGIN['2D'].top\n      : MARGIN['1D'].top;\n    const left = hasAcceptedSpectrum(draft, 1)\n      ? MARGIN['2D'].left\n      : MARGIN['1D'].left;\n    draft.margin = { ...MARGIN['2D'], top, left };\n  } else if (draft.toolOptions.selectedTool === options.slicingTool.id) {\n    draft.margin = MARGIN['2D'];\n  } else if (draft.displayerMode === DISPLAYER_MODE.DM_1D) {\n    draft.margin = MARGIN['1D'];\n  }\n}\n\nfunction Processing2DData(draft: Draft<State>, data) {\n  if (draft.displayerMode === DISPLAYER_MODE.DM_2D) {\n    let _data = {};\n    for (const datum of data[draft.activeTab]) {\n      _data[datum.id] = datum.processingController.drawContours();\n    }\n    draft.contours = _data;\n  }\n}\n\nfunction setDisplayerMode(draft: Draft<State>, data) {\n  draft.displayerMode =\n    data && (data as Datum1D[] | Datum2D[]).some((d) => d.info.dimension === 2)\n      ? DISPLAYER_MODE.DM_2D\n      : DISPLAYER_MODE.DM_1D;\n}\n\nfunction setTabActiveSpectrum(draft: Draft<State>, dataGroupByTab) {\n  let tabs2D: any[] = [];\n  const tabActiveSpectrum = {};\n\n  const tabkeys = Object.keys(dataGroupByTab).sort((a, b) =>\n    a.split(',').length > b.split(',').length ? -1 : 1,\n  );\n  for (let tabKey of tabkeys) {\n    const data = dataGroupByTab[tabKey];\n    const nucleusLength = tabKey.split(',').length;\n    if (nucleusLength === 2) {\n      tabs2D.push(tabKey);\n    }\n\n    if (data.length === 1) {\n      const index = draft.data.findIndex((datum) => datum.id === data[0].id);\n      tabActiveSpectrum[tabKey] = { id: data[0].id, index };\n    } else {\n      const tabSpectra = dataGroupByTab[tabKey];\n      const tabSpectraLength = tabSpectra.length;\n      if (tabSpectraLength >= 2) {\n        const FTSpectrums = tabSpectra.filter((d) => !d.info.isFid);\n        if (\n          FTSpectrums.length > 0 &&\n          (nucleusLength === 2 ||\n            (nucleusLength === 1 && tabSpectraLength !== FTSpectrums.length))\n        ) {\n          const index = draft.data.findIndex(\n            (datum) => datum.id === FTSpectrums[0].id,\n          );\n          tabActiveSpectrum[tabKey] = { id: FTSpectrums[0].id, index };\n        } else {\n          tabActiveSpectrum[tabKey] = null;\n        }\n      } else {\n        tabActiveSpectrum[tabKey] = null;\n      }\n    }\n  }\n  draft.tabActiveSpectrum = tabActiveSpectrum;\n  return tabs2D;\n}\n\nfunction setTab(draft: Draft<State>, dataGroupByTab, tab, refresh = false) {\n  const groupByTab = Object.keys(dataGroupByTab).sort((a, b) =>\n    a.split(',').length > b.split(',').length ? -1 : 1,\n  );\n\n  if (\n    JSON.stringify(groupByTab) !==\n      JSON.stringify(Object.keys(draft.tabActiveSpectrum)) ||\n    refresh\n  ) {\n    const tabs2D = setTabActiveSpectrum(draft, dataGroupByTab);\n\n    if (tabs2D.length > 0 && tab == null) {\n      draft.activeSpectrum = draft.tabActiveSpectrum[tabs2D[0]];\n      draft.activeTab = tabs2D[0];\n    } else {\n      draft.activeSpectrum = tab ? draft.tabActiveSpectrum[tab] : tab;\n      draft.activeTab = tab;\n    }\n  } else {\n    draft.activeTab = tab;\n    draft.activeSpectrum = draft.tabActiveSpectrum[tab];\n  }\n\n  setDisplayerMode(draft, dataGroupByTab[draft.activeTab]);\n  setMargin(draft);\n}\n\ninterface SetActiveTabOptions {\n  tab?: string | null;\n  refreshActiveTab?: boolean;\n  domainOptions?: SetDomainOptions;\n}\n\nfunction setActiveTab(draft: Draft<State>, options?: SetActiveTabOptions) {\n  const {\n    tab = null,\n    refreshActiveTab = false,\n    domainOptions = {},\n  } = options || {};\n\n  const groupByNucleus = GroupByInfoKey('nucleus');\n  const dataGroupByNucleus = groupByNucleus(draft.data, true);\n  const tabs = Object.keys(dataGroupByNucleus);\n  const currentTab = !tab || !tabs.includes(tab || '') ? tabs[0] : tab;\n  setTab(draft, dataGroupByNucleus, currentTab, refreshActiveTab);\n  resetTool(draft);\n\n  Processing2DData(draft, dataGroupByNucleus);\n\n  setDomain(draft, domainOptions);\n  setIntegralsYDomain(draft, dataGroupByNucleus[currentTab]);\n\n  const zoomHistory = zoomHistoryManager(draft.zoom.history, draft.activeTab);\n  const zoomValue = zoomHistory.getLast();\n  if (zoomValue) {\n    draft.xDomain = zoomValue.xDomain;\n    draft.yDomain = zoomValue.yDomain;\n  }\n  setMode(draft);\n}\n\nfunction handelSetActiveTab(draft: Draft<State>, tab) {\n  if (tab) {\n    setActiveTab(draft, { tab });\n  }\n}\n\nfunction levelChangeHandler(draft: Draft<State>, { deltaY, shiftKey }) {\n  try {\n    if (draft.activeSpectrum?.id) {\n      const { index, id } = draft.activeSpectrum;\n      const processingController = (draft.data[index] as Datum2D)\n        .processingController;\n      if (shiftKey) {\n        processingController.shiftWheel(deltaY);\n      } else {\n        processingController.wheel(deltaY);\n      }\n      const contours = Object.freeze(processingController.drawContours());\n      draft.contours[id] = contours;\n    }\n  } catch (e) {\n    // eslint-disable-next-line no-console\n    console.log(e);\n  }\n}\n\nfunction setSpectraSameTopHandler(draft: Draft<State>) {\n  if (draft.displayerMode === DISPLAYER_MODE.DM_1D) {\n    draft.originDomain.shareYDomain = false;\n    setZoom(draft, { scale: 0.8 });\n  }\n}\nfunction resetSpectraScale(draft: Draft<State>) {\n  draft.originDomain.shareYDomain = true;\n  draft.yDomains = draft.originDomain.yDomains;\n  draft.yDomain = draft.originDomain.yDomain;\n  setZoom(draft, { scale: 0.8 });\n}\n\nexport {\n  resetSelectedTool,\n  setSelectedTool,\n  setSelectedOptionPanel,\n  setSpectrumsVerticalAlign,\n  handleChangeSpectrumDisplayMode,\n  handleAddBaseLineZone,\n  handleDeleteBaseLineZone,\n  handleToggleRealImaginaryVisibility,\n  handleBrushEnd,\n  setVerticalIndicatorXPosition,\n  handleZoom,\n  zoomOut,\n  handelSetActiveTab,\n  levelChangeHandler,\n  setActiveTab,\n  setTab,\n  setSpectraSameTopHandler,\n  resetSpectraScale,\n};\n","import { current, Draft } from 'immer';\n\nimport * as Filters from '../../../data/Filters';\nimport * as FiltersManager from '../../../data/FiltersManager';\nimport { updateXShift } from '../../../data/data1d/Spectrum1D';\nimport { apply as autoPhaseCorrection } from '../../../data/data1d/filter1d/autoPhaseCorrection';\nimport { apply as phaseCorrection } from '../../../data/data1d/filter1d/phaseCorrection';\nimport { updateShift as update2dShift } from '../../../data/data2d/Spectrum2D';\nimport { Datum1D } from '../../../data/types/data1d';\nimport { Datum2D } from '../../../data/types/data2d';\nimport generateID from '../../../data/utilities/generateID';\nimport { getSpectraByNucleus } from '../../utility/getSpectraByNucleus';\nimport nucleusToString from '../../utility/nucleusToString';\nimport { ActiveSpectrum, State } from '../Reducer';\nimport zoomHistoryManager from '../helper/ZoomHistoryManager';\nimport getRange from '../helper/getRange';\n\nimport { setDomain, setMode } from './DomainActions';\nimport { changeSpectrumVerticalAlignment } from './PreferencesActions';\nimport { resetSelectedTool } from './ToolsActions';\n\nfunction shiftSpectrumAlongXAxis(draft: Draft<State>, shiftValue) {\n  //apply filter into the spectrum\n  if (draft.activeSpectrum?.id) {\n    const index = draft.activeSpectrum?.index;\n\n    FiltersManager.applyFilter(draft.data[index], [\n      { name: Filters.shiftX.id, options: shiftValue },\n    ]);\n    updateXShift(draft.data[index] as Datum1D);\n    resetSelectedTool(draft);\n    setDomain(draft);\n  }\n}\n\nfunction applyZeroFillingFilter(draft: Draft<State>, filterOptions) {\n  if (draft.activeSpectrum?.id) {\n    const index = draft.activeSpectrum.index;\n    const filters = [\n      { name: Filters.zeroFilling.id, options: filterOptions.zeroFillingSize },\n      {\n        name: Filters.lineBroadening.id,\n        options: filterOptions.lineBroadeningValue,\n      },\n    ];\n    FiltersManager.applyFilter(draft.data[index], filters);\n    resetSelectedTool(draft);\n    setDomain(draft);\n    setMode(draft);\n  }\n}\nfunction applyFFTFilter(draft: Draft<State>) {\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n\n    //apply filter into the spectrum\n    FiltersManager.applyFilter(draft.data[index], [\n      { name: Filters.fft.id, options: {} },\n    ]);\n    resetSelectedTool(draft);\n    changeSpectrumVerticalAlignment(draft, { align: 'bottom' });\n\n    setDomain(draft, { yDomain: { isChanged: true } });\n    setMode(draft);\n  }\n}\nfunction applyManualPhaseCorrectionFilter(draft: Draft<State>, filterOptions) {\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n    const { ph0, ph1 } = filterOptions;\n\n    FiltersManager.applyFilter(draft.data[index], [\n      { name: Filters.phaseCorrection.id, options: { ph0, ph1 } },\n    ]);\n\n    resetSelectedTool(draft);\n    draft.tempData = null;\n    setDomain(draft);\n  }\n}\nfunction applyAbsoluteFilter(draft: Draft<State>) {\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n    FiltersManager.applyFilter(draft.data[index], [\n      { name: Filters.absolute.id, options: {} },\n    ]);\n\n    resetSelectedTool(draft);\n    draft.tempData = null;\n    setDomain(draft);\n  }\n}\n\nfunction applyAutoPhaseCorrectionFilter(draft: Draft<State>) {\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n\n    const { ph0, ph1 } = autoPhaseCorrection(draft.data[index]);\n\n    FiltersManager.applyFilter(draft.data[index], [\n      { name: Filters.phaseCorrection.id, options: { ph0, ph1 } },\n    ]);\n\n    resetSelectedTool(draft);\n    draft.tempData = null;\n    setDomain(draft);\n  }\n}\n\nfunction calculateManualPhaseCorrection(draft: Draft<State>, filterOptions) {\n  if (draft.activeSpectrum) {\n    const { index } = draft.activeSpectrum;\n    const {\n      data: { x, re, im },\n      info,\n    } = draft.data[index] as Datum1D;\n\n    const { ph0, ph1 } = filterOptions;\n    let _data = { data: { x: x, re: re, im }, info };\n    phaseCorrection(_data, { ph0, ph1 });\n    const { im: newIm, re: newRe } = _data.data;\n    draft.tempData[index].data.im = newIm;\n    draft.tempData[index].data.re = newRe;\n  }\n}\n\nfunction enableFilter(draft: Draft<State>, filterID, checked) {\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n\n    //apply filter into the spectrum\n    FiltersManager.enableFilter(draft.data[index], filterID, checked);\n\n    if (draft.data[index].info?.dimension === 1) {\n      updateXShift(draft.data[index] as Datum1D);\n    } else if (draft.data[index].info?.dimension === 2) {\n      update2dShift(draft.data[index] as Datum2D);\n    }\n\n    resetSelectedTool(draft);\n    setDomain(draft);\n    setMode(draft);\n\n    const zoomHistory = zoomHistoryManager(draft.zoom.history, draft.activeTab);\n    const zoomValue = zoomHistory.getLast();\n    if (zoomValue) {\n      draft.xDomain = zoomValue.xDomain;\n      draft.yDomain = zoomValue.yDomain;\n    }\n  }\n}\n\nfunction deleteFilter(draft: Draft<State>, actions) {\n  const filterID = actions.payload.id;\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n    //apply filter into the spectrum\n    FiltersManager.deleteFilter(draft.data[index], filterID);\n\n    if (draft.data[index].info?.dimension === 1) {\n      updateXShift(draft.data[index] as Datum1D);\n    } else if (draft.data[index].info?.dimension === 2) {\n      update2dShift(draft.data[index] as Datum2D);\n    }\n\n    resetSelectedTool(draft);\n    setDomain(draft);\n    setMode(draft);\n  }\n}\nfunction deleteSpectraFilter(draft: Draft<State>, actions) {\n  const filterType = actions.payload.filterType;\n\n  if (draft.activeTab) {\n    for (const datum of draft.data) {\n      if (nucleusToString(datum?.info?.nucleus) === draft.activeTab) {\n        const filtersResult =\n          datum.filters?.filter((filter) => filter.name === filterType) || [];\n\n        filtersResult.forEach((filter) => {\n          FiltersManager.deleteFilter(datum, filter.id);\n\n          if (datum.info?.dimension === 1) {\n            updateXShift(datum as Datum1D);\n          } else if (datum.info?.dimension === 2) {\n            update2dShift(datum as Datum2D);\n          }\n        });\n      }\n    }\n\n    resetSelectedTool(draft);\n    setDomain(draft);\n    setMode(draft);\n  }\n}\n\nfunction handleBaseLineCorrectionFilter(draft: Draft<State>, action) {\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n\n    FiltersManager.applyFilter(draft.data[index], [\n      {\n        name: Filters.baselineCorrection.id,\n        options: {\n          zones: draft.toolOptions.data.baseLineZones,\n          ...action.options,\n        },\n      },\n    ]);\n\n    draft.toolOptions.data.baseLineZones = [];\n    const xDomainSnapshot = draft.xDomain.slice();\n\n    resetSelectedTool(draft);\n    setDomain(draft);\n    draft.xDomain = xDomainSnapshot;\n  }\n}\n\n/**\n * reset spectrum data for specific point of time (Filter)\n * @param {object} draft\n * @param {string} id Filter id\n * @param {object} options\n * @param {boolean=} options.resetTool\n * @param {boolean=} options.updateDomain\n * @param {boolean=} options.rollback\n */\nfunction resetSpectrumByFilter(\n  draft,\n  id: string | null = null,\n  options: {\n    rollback?: boolean;\n    resetTool?: boolean;\n    updateDomain?: boolean;\n    returnCurrentDatum?: boolean;\n    searchBy?: 'id' | 'name';\n  } = {},\n  activeSpectrum: ActiveSpectrum | null = null,\n) {\n  const {\n    updateDomain = true,\n    rollback = false,\n    searchBy = 'id',\n    returnCurrentDatum = false,\n  } = options;\n\n  let currentDatum: any = null;\n\n  const currentActiveSpectrum = activeSpectrum\n    ? activeSpectrum\n    : draft.activeSpectrum;\n\n  if (currentActiveSpectrum?.id) {\n    const index = currentActiveSpectrum.index;\n    const datum = draft.data[index] as Datum1D | Datum2D;\n\n    if (id && draft.toolOptions.data.activeFilterID !== id) {\n      const filterIndex = datum.filters.findIndex((f) => f[searchBy] === id);\n      let filters: any[] = [];\n      if (filterIndex !== -1) {\n        filters = datum.filters.slice(\n          0,\n          rollback ? filterIndex : filterIndex + 1,\n        );\n\n        if (filters.length > 1) {\n          draft.toolOptions.data.activeFilterID =\n            datum.filters[rollback ? filterIndex - 1 : filterIndex]?.id;\n        } else {\n          draft.toolOptions.data.activeFilterID = null;\n        }\n\n        FiltersManager.reapplyFilters(datum, filters);\n\n        if (returnCurrentDatum) {\n          const { name, value: options } = datum.filters[filterIndex];\n          const newDatum = current(draft).data[index];\n          if (newDatum.info?.dimension === 1) {\n            FiltersManager.applyFilter(newDatum, [{ name, options }]);\n          }\n\n          currentDatum = { datum: newDatum, index };\n        }\n      }\n    } else {\n      //close filter snapshot mode and replay all enabled filters\n      draft.toolOptions.data.activeFilterID = null;\n      FiltersManager.reapplyFilters(datum);\n    }\n\n    if (datum.info?.dimension === 1) {\n      updateXShift(datum as Datum1D);\n    } else if (datum.info?.dimension === 2) {\n      update2dShift(datum as Datum2D);\n    }\n\n    if (updateDomain) {\n      setDomain(draft);\n      setMode(draft);\n    }\n  }\n  if (returnCurrentDatum) {\n    return currentDatum;\n  }\n}\n\nfunction filterSnapshotHandler(draft: Draft<State>, action) {\n  resetSpectrumByFilter(draft, action.id);\n}\n\nfunction handleMultipleSpectraFilter(draft: Draft<State>, action) {\n  const spectra = getSpectraByNucleus(draft.activeTab, draft.data);\n\n  if (spectra && spectra.length > 0 && Array.isArray(action.payload)) {\n    const exclusions =\n      spectra[0].filters.find((f) => f.name === Filters.exclusionZones.id)\n        ?.value || [];\n\n    for (const spectrum of spectra) {\n      const filters = action.payload.map((filter) => {\n        if (filter.name === Filters.equallySpaced.id) {\n          return {\n            ...filter,\n            options: { ...filter.options, exclusions },\n          };\n        }\n        return filter;\n      });\n\n      FiltersManager.applyFilter(spectrum, filters);\n    }\n  }\n  setDomain(draft);\n}\n\nfunction handleAddExclusionZone(draft: Draft<State>, action) {\n  const { from: startX, to: endX } = action.payload;\n  const range = getRange(draft, { startX, endX });\n\n  let spectra: Datum1D[];\n\n  if (draft.activeSpectrum?.id) {\n    const index = draft.activeSpectrum?.index;\n    spectra = [draft.data[index] as Datum1D];\n  } else {\n    spectra = getSpectraByNucleus(draft.activeTab, draft.data) as Datum1D[];\n  }\n\n  for (const spectrum of spectra) {\n    FiltersManager.applyFilter(spectrum, [\n      {\n        name: Filters.exclusionZones.id,\n        options: [\n          {\n            id: generateID(),\n            from: range[0],\n            to: range[1],\n          },\n        ],\n      },\n    ]);\n  }\n\n  setDomain(draft);\n}\n\nfunction handleDeleteExclusionZone(draft: Draft<State>, action) {\n  const { id, spectrumID } = action.payload;\n  const spectrumIndex = draft.data.findIndex(\n    (spectrum) => spectrum.id === spectrumID,\n  );\n  const exclusionZonesFilter = draft.data[spectrumIndex].filters.find(\n    (filter) => filter.name === Filters.exclusionZones.id,\n  );\n  if (exclusionZonesFilter) {\n    if (exclusionZonesFilter.value.length === 1) {\n      FiltersManager.deleteFilter(\n        draft.data[spectrumIndex],\n        exclusionZonesFilter.id,\n      );\n    } else {\n      exclusionZonesFilter.value = exclusionZonesFilter.value.filter(\n        (zone) => zone.id !== id,\n      );\n      FiltersManager.reapplyFilters(draft.data[spectrumIndex]);\n    }\n  }\n}\n\nexport {\n  shiftSpectrumAlongXAxis,\n  applyZeroFillingFilter,\n  applyFFTFilter,\n  applyManualPhaseCorrectionFilter,\n  applyAutoPhaseCorrectionFilter,\n  applyAbsoluteFilter,\n  calculateManualPhaseCorrection,\n  handleMultipleSpectraFilter,\n  enableFilter,\n  deleteFilter,\n  deleteSpectraFilter,\n  handleBaseLineCorrectionFilter,\n  filterSnapshotHandler,\n  resetSpectrumByFilter,\n  handleAddExclusionZone,\n  handleDeleteExclusionZone,\n};\n","import { Draft } from 'immer';\n\nimport { State } from '../Reducer';\n\nfunction setIsOverDisplayer(draft: Draft<State>, actions) {\n  draft.overDisplayer = actions.payload;\n}\nexport { setIsOverDisplayer };\n","import { setDomain, getDomain } from './DomainActions';\n\nfunction handleHistoryUndo(draft) {\n  const { past, present, future } = draft.history;\n  const previous = past[past.length - 1];\n  const newPast = past.slice(0, past.length - 1);\n  const newfuture = [present, ...future];\n\n  const hasRedo = newfuture.length !== 0;\n  const hasUndo = past.length !== 0;\n\n  const domain = getDomain(draft.data);\n  const history = {\n    past: newPast,\n    present: previous,\n    future: newfuture,\n    hasRedo,\n    hasUndo,\n  };\n\n  draft.xDomain = domain.xDomain;\n  draft.yDomain = domain.yDomain;\n  draft.originDomain = domain;\n  draft.history = history;\n}\n\nfunction handleHistoryRedo(draft) {\n  const { history } = draft;\n  const newPresent = history.future.shift();\n  history.past.push(history.present);\n  history.present = newPresent;\n  history.hasUndo = true;\n  history.hasRedo = history.future.length > 0;\n\n  setDomain(draft.data);\n}\n\nfunction handleHistoryReset(draft, action) {\n  draft.history = {\n    past: [],\n    present: action,\n    future: [],\n    hasRedo: false,\n    hasUndo: false,\n  };\n}\n\nexport { handleHistoryUndo, handleHistoryRedo, handleHistoryReset };\n","import { Draft, original } from 'immer';\nimport { xyIntegration } from 'ml-spectra-processing';\n\nimport {\n  updateIntegralsRelativeValues,\n  changeIntegralsRelative,\n  getShiftX,\n} from '../../../data/data1d/Spectrum1D';\nimport {\n  initSumOptions,\n  setSumOptions,\n} from '../../../data/data1d/Spectrum1D/SumManager';\nimport { Datum1D } from '../../../data/types/data1d';\nimport generateID from '../../../data/utilities/generateID';\nimport { State } from '../Reducer';\nimport getRange from '../helper/getRange';\n\nimport { setIntegralsYDomain } from './DomainActions';\n\nfunction handleChangeIntegralSum(draft: Draft<State>, options) {\n  const { data, activeSpectrum, activeTab: nucleus } = draft;\n  if (activeSpectrum?.id) {\n    const { index } = activeSpectrum;\n    const datum = data[index] as Datum1D;\n    setSumOptions(datum.integrals, { options, nucleus });\n    updateIntegralsRelativeValues(datum, true);\n  }\n}\n\nfunction addIntegral(draft: Draft<State>, action) {\n  const { startX, endX } = action;\n  const { data, molecules, activeTab: nucleus, activeSpectrum } = draft;\n  const [from, to] = getRange(draft, { startX, endX });\n\n  if (activeSpectrum?.id) {\n    const datum = data[activeSpectrum.index] as Datum1D;\n\n    const { x, re } = datum.data;\n\n    const shiftX = getShiftX(datum);\n\n    const integral = {\n      id: generateID(),\n      originFrom: from - shiftX,\n      originTo: to - shiftX,\n      from,\n      to,\n      absolute: xyIntegration({ x, y: re }, { from, to, reverse: true }), // the real value\n      kind: 'signal',\n    };\n    datum.integrals.values.push(integral);\n    datum.integrals.options = initSumOptions(datum.integrals.options, {\n      molecules,\n      nucleus,\n    });\n    updateIntegralsRelativeValues(datum);\n    setIntegralsYDomain(draft, datum);\n  }\n}\n\nfunction deleteIntegral(draft: Draft<State>, action) {\n  if (draft.activeSpectrum) {\n    const state = original(draft) as State;\n    const { index } = draft.activeSpectrum;\n    const { integralID } = action;\n\n    const datum = draft.data[index] as Datum1D;\n\n    if (integralID == null) {\n      datum.integrals.values = [];\n    } else {\n      const peakIndex = (\n        state.data[index] as Datum1D\n      ).integrals.values.findIndex((p) => p.id === integralID);\n      datum.integrals.values.splice(peakIndex, 1);\n      updateIntegralsRelativeValues(datum);\n    }\n  }\n}\n\nfunction changeIntegral(draft: Draft<State>, action) {\n  const state = original(draft) as State;\n  const integral = action.payload.data;\n\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n\n    const originalDatum = state.data[index] as Datum1D;\n    const datum = draft.data[index] as Datum1D;\n\n    const { x, re } = originalDatum.data;\n    const integralIndex = originalDatum.integrals.values.findIndex(\n      (i) => i.id === integral.id,\n    );\n\n    if (integralIndex !== -1) {\n      datum.integrals.values[integralIndex] = {\n        originFrom: integral.from,\n        originTo: integral.to,\n        ...integral,\n        absolute: xyIntegration(\n          { x, y: re },\n          { from: integral.from, to: integral.to, reverse: true },\n        ),\n      };\n      updateIntegralsRelativeValues(datum);\n    }\n  }\n}\n\nfunction handleChangeIntegralsRelativeValue(draft: Draft<State>, action) {\n  const data = action.payload.data;\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n    changeIntegralsRelative(draft.data[index] as Datum1D, data);\n  }\n}\n\nfunction handleChangeIntegralsSumFlag(draft, action) {\n  const flag = action.payload;\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n    draft.data[index].integrals.options.isSumConstant = !flag;\n  }\n}\n\nexport {\n  handleChangeIntegralSum,\n  addIntegral,\n  deleteIntegral,\n  changeIntegral,\n  handleChangeIntegralsRelativeValue,\n  handleChangeIntegralsSumFlag,\n};\n","import { Molecule as OCLMolecule } from 'openchemlib/full';\n\nimport { initMolecule, Molecule } from './Molecule';\n\nexport function fromJSON(mols: any[] = []) {\n  const molecules: Molecule[] = [];\n  for (const mol of mols) {\n    const molecule = OCLMolecule.fromMolfile(mol.molfile);\n    const fragments = molecule.getFragments();\n    for (let fragment of fragments) {\n      molecules.push(\n        initMolecule({\n          molfile: fragment.toMolfileV3(),\n        }),\n      );\n    }\n  }\n\n  return molecules;\n}\n\nexport function addMolfile(molecules, molfile) {\n  // try to parse molfile\n  // this will throw if the molecule can not be parsed !\n  const molecule = OCLMolecule.fromMolfile(molfile);\n  let fragments = molecule.getFragments();\n  for (let fragment of fragments) {\n    molecules.push(\n      initMolecule({\n        molfile: fragment.toMolfileV3(),\n      }),\n    );\n  }\n  // we will split if we have many fragments\n}\n\nexport function setMolfile(molecules, molfile, key) {\n  // try to parse molfile\n  // this will throw if the molecule can not be parsed !\n  let molecule = OCLMolecule.fromMolfile(molfile);\n  let fragments = molecule.getFragments();\n\n  if (fragments.length > 1) {\n    molecules = molecules.filter((m) => m.key !== key);\n\n    for (let fragment of fragments) {\n      molecules.push(\n        initMolecule({\n          molfile: fragment.toMolfileV3(),\n        }),\n      );\n    }\n  } else if (fragments.length === 1) {\n    const fragment = fragments[0];\n    const _mol = initMolecule({\n      molfile: fragment.toMolfileV3(),\n      key: key,\n    });\n    let molIndex = molecules.findIndex((m) => m.key === key);\n    molecules.splice(molIndex, 1, _mol);\n  }\n\n  // we will split if we have many fragments\n}\n","export type ActionType<Action, Payload = void> = Payload extends void\n  ? { type: Action }\n  : { type: Action; payload: Payload };\n\nexport const INITIATE = 'INITIATE';\nexport const SAVE_DATA_AS_JSON = 'SAVE_DATA_AS_JSON';\nexport const LOAD_JSON_FILE = 'LOAD_JSON_FILE';\nexport const LOAD_JCAMP_FILE = 'LOAD_JCAMP_FILE';\nexport const LOAD_NMREDATA_FILE = 'LOAD_NMREDATA_FILE';\nexport const LOAD_MOL_FILE = 'LOAD_MOL_FILE';\nexport const LOAD_ZIP_FILE = 'LOAD_ZIP_FILE';\nexport const LOAD_JDF_FILE = 'LOAD_JDF_FILE';\nexport const ADD_PEAK = 'ADD_PEAK';\nexport const ADD_PEAKS = 'ADD_PEAKS';\nexport const DELETE_PEAK_NOTATION = 'DELETE_PEAK_NOTATION';\nexport const SHIFT_SPECTRUM = 'SHIFT_SPECTRUM';\nexport const SET_X_DOMAIN = 'SET_X_DOMAIN';\nexport const SET_Y_DOMAIN = 'SET_Y_DOMAIN';\nexport const SET_ORIGINAL_DOMAIN = 'SET_ORIGINAL_DOMAIN';\nexport const SET_WIDTH = 'SET_WIDTH';\nexport const SET_DIMENSIONS = 'SET_DIMENSIONS';\nexport const SET_SELECTED_TOOL = 'SET_SELECTED_TOOL';\nexport const SET_SELECTED_FILTER = 'SET_SELECTED_FILTER';\nexport const CHANGE_SPECTRUM_SETTING = 'CHANGE_SPECTRUM_SETTING';\nexport const CHANGE_SPECTRUM_TYPE = 'CHANGE_SPECTRUM_TYPE';\nexport const FULL_ZOOM_OUT = 'FULL_ZOOM_OUT';\nexport const CHANGE_VISIBILITY = 'CHANGE_VISIBILITY';\nexport const CHANGE_PEAKS_MARKERS_VISIBILITY =\n  'CHANGE_PEAKS_MARKERS_VISIBILITY';\nexport const CHANGE_ACTIVE_SPECTRUM = 'CHANGE_ACTIVE_SPECTRUM';\nexport const CHANGE_SPECTRUM_COLOR = 'CHANGE_SPECTRUM_COLOR';\nexport const ADD_INTEGRAL = 'ADD_INTEGRAL';\nexport const DELETE_INTEGRAL = 'DELETE_INTEGRAL';\nexport const TOGGLE_REAL_IMAGINARY_VISIBILITY =\n  'TOGGLE_REAL_IMAGINARY_VISIBILITY';\nexport const SET_ZOOM = 'SET_ZOOM';\nexport const ADD_MOLECULE = 'ADD_MOLECULE';\nexport const SET_MOLECULE = 'SET_MOLECULE';\nexport const DELETE_MOLECULE = 'DELETE_MOLECULE';\nexport const SET_CORRELATION = 'SET_CORRELATION';\nexport const SET_CORRELATIONS = 'SET_CORRELATIONS';\nexport const DELETE_CORRELATION = 'DELETE_CORRELATION';\nexport const SET_CORRELATIONS_MF = 'SET_CORRELATIONS_MF';\nexport const SET_CORRELATIONS_TOLERANCE = 'SET_CORRELATIONS_TOLERANCE';\nexport const DELETE_SPECTRA = 'DELETE_SPECTRA';\nexport const CHANGE_SPECTRUM_DISPLAY_VIEW_MODE =\n  'CHANGE_SPECTRUM_DISPLAY_VIEW_MODE';\nexport const RESIZE_INTEGRAL = 'RESIZE_INTEGRAL';\nexport const BRUSH_END = 'BRUSH_END';\nexport const RESET_DOMAIN = 'RESET_X_DOMAIN';\nexport const ENABLE_FILTER = 'ENABLE_FILTER';\nexport const DELETE_FILTER = 'DELETE_FILTER';\nexport const DELETE_SPECTRA_FILTER = 'DELETE_SPECTRA_FILTER';\nexport const APPLY_ZERO_FILLING_FILTER = 'APPLY_ZERO_FILLING_FILTER';\nexport const APPLY_FFT_FILTER = 'APPLY_FFT_FILTER';\nexport const CALCULATE_MANUAL_PHASE_CORRECTION_FILTER =\n  'CALCULATE_MANUAL_PHASE_CORRECTION_FILTER';\nexport const APPLY_MANUAL_PHASE_CORRECTION_FILTER =\n  'APPLY_MANUAL_PHASE_CORRECTION_FILTER';\nexport const APPLY_AUTO_PHASE_CORRECTION_FILTER =\n  'APPLY_AUTO_PHASE_CORRECTION_FILTER';\nexport const APPLY_ABSOLUTE_FILTER = 'APPLY_ABSOLUTE_FILTER';\nexport const SET_VERTICAL_INDICATOR_X_POSITION =\n  'SET_VERTICAL_INDICATOR_X_POSITION';\nexport const AUTO_PEAK_PICKING = 'AUTO_PEAK_PICKING';\nexport const AUTO_RANGES_DETECTION = 'AUTO_RANGES_DETECTION';\nexport const AUTO_ZONES_DETECTION = 'AUTO_ZONES_DETECTION';\nexport const DELETE_RANGE = 'DELETE_RANGE';\nexport const DELETE_1D_SIGNAL = 'DELETE_1D_SIGNAL';\nexport const SET_SELECTED_OPTIONS_PANEL = 'SET_SELECTED_OPTIONS_PANEL';\nexport const SET_LOADING_FLAG = 'SET_LOADING_FLAG';\nexport const RESET_SELECTED_TOOL = 'RESET_SELECTED_TOOL';\nexport const SET_SPECTRUMS_VERTICAL_ALIGN = 'SET_SPECTRUMS_VERTICAL_AlIGN';\nexport const SAVE_AS_SVG = 'SAVE_AS_SVG';\nexport const CHANGE_INTEGRAL_DATA = 'CHANGE_INTEGRAL_DATA';\nexport const SET_ACTIVE_TAB = 'SET_ACTIVE_TAB';\nexport const CHANGE_INTEGRAL_SUM = 'CHANGE_INTEGRAL_SUM';\nexport const ADD_BASE_LINE_ZONE = 'ADD_BASE_LINE_ZONE';\nexport const DELETE_BASE_LINE_ZONE = 'DELETE_BASE_LINE_ZONE';\nexport const APPLY_BASE_LINE_CORRECTION_FILTER =\n  'APPLY_BASE_LINE_CORRECTION_FILTER';\nexport const SET_KEY_PREFERENCES = 'SET_KEY_PREFERENCES';\nexport const APPLY_KEY_PREFERENCES = 'APPLY_KEY_PREFERENCES';\nexport const RESIZE_RANGE = 'RESIZE_RANGE';\nexport const CHANGE_RANGE_SUM = 'CHANGE_RANGE_SUM';\nexport const ADD_RANGE = 'ADD_RANGE';\nexport const SET_2D_LEVEL = 'SET_2D_LEVEL';\nexport const ADD_2D_ZONE = 'ADD_2D_ZONE';\nexport const DELETE_2D_ZONE = 'DELETE_2D_ZONE';\nexport const DELETE_2D_SIGNAL = 'DELETE_2D_SIGNAL';\nexport const SET_2D_SIGNAL_PATH_LENGTH = 'SET_2D_SIGNAL_PATH_LENGTH';\nexport const ADD_MISSING_PROJECTION = 'ADD_MISSING_PROJECTION';\nexport const SET_FILTER_SNAPSHOT = 'SET_FILTER_SNAPSHOT';\nexport const CHANGE_RANGE_RELATIVE = 'CHANGE_RANGE_RELATIVE';\nexport const CHANGE_RANGE_SIGNAL_VALUE = 'CHANGE_RANGE_SIGNAL_VALUE';\nexport const CHANGE_RANGE_SIGNAL_KIND = 'CHANGE_RANGE_SIGNAL_KIND';\nexport const SAVE_EDITED_RANGE = 'SAVE_EDITED_RANGE';\nexport const UNLINK_RANGE = 'UNLINK_RANGE';\nexport const SET_DIAID_RANGE = 'SET_DIAID_RANGE';\nexport const CHANGE_INTEGRAL_RELATIVE = 'CHANGE_INTEGRAL_RELATIVE';\nexport const ANALYZE_SPECTRA = 'ANALYZE_SPECTRA';\nexport const DELETE_ANALYZE_SPECTRA_RANGE = 'DELETE_ANALYZE_SPECTRA_RANGE';\nexport const RESIZE_ANALYZE_SPECTRA_RANGE = 'RESIZE_ANALYZE_SPECTRA_RANGE';\nexport const SET_ANALYZE_SPECTRA_COLUMNS = 'SET_ANALYZE_SPECTRA_COLUMNS';\nexport const FILTER_SPECTRA_COLUMN = 'FILTER_SPECTRA_COLUMN';\nexport const ALIGN_SPECTRA = 'ALIGN_SPECTRA';\nexport const CHANGE_ZONE_SIGNAL_VALUE = 'CHANGE_ZONE_SIGNAL_VALUE';\nexport const CHANGE_ZONE_SIGNAL_KIND = 'CHANGE_ZONE_SIGNAL_KIND';\nexport const SAVE_EDITED_ZONE = 'SAVE_EDITED_ZONE';\nexport const UNLINK_ZONE = 'UNLINK_ZONE';\nexport const SET_DIAID_ZONE = 'SET_DIAID_ZONE';\nexport const PREDICT_SPECTRA = 'PREDICT_SPECTRA';\nexport const SET_SPECTRA_SAME_TOP = 'SET_SPECTRA_SAME_TOP';\nexport const RESET_SPECTRA_SCALE = 'RESET_SPECTRA_SCALE';\nexport const SET_MOUSE_OVER_DISPLAYER = 'SET_MOUSE_OVER_DISPLAYER';\nexport const APPLY_MULTIPLE_SPECTRA_FILTER = 'APPLY_MULTIPLE_SPECTRA_FILTER';\nexport const ADD_EXCLUSION_ZONE = 'ADD_EXCLUSION_ZONE';\nexport const DELETE_EXCLUSION_ZONE = 'DELETE_EXCLUSION_ZONE';\nexport const CHANGE_RANGES_SUM_FLAG = 'CHANGE_RANGES_SUM_FLAG';\nexport const CHANGE_INTEGRALS_SUM_FLAG = 'CHANGE_INTEGRALS_SUM_FLAG';\nexport const CHANGE_ZONES_NOISE_FACTOR = 'CHANGE_ZONES_NOISE_FACTOR';\nexport const CHANGE_TEMP_RANGE = 'CHANGE_TEMP_RANGE';\nexport const SHOW_MULTIPLICTY_TREES = 'SHOW_MULTIPLICTY_TREES';\nexport const SHOW_RANGES_INTEGRALS = 'SHOW_RANGES_INTEGRALS';\nexport const AUTO_RANGES_SPECTRA_PICKING = 'AUTO_RANGES_SPECTRA_PICKING';\nexport const AUTO_ZONES_SPECTRA_PICKING = 'AUTO_ZONES_SPECTRA_PICKING';\nexport const GENERATE_SPECTRUM_FROM_PUBLICATION_STRING =\n  'GENERATE_SPECTRUM_FROM_PUBLICATION_STRING';\nexport const RESURRECTING_SPECTRUM_FROM_RANGES =\n  'RESURRECTING_SPECTRUM_FROM_RANGES';\nexport const SHOW_J_GRAPH = 'SHOW_J_GRAPH';\nexport const SET_AUTOMATIC_ASSIGNMENTS = 'SET_AUTOMATIC_ASSIGNMENTS';\nexport const FLOAT_MOLECULE_OVER_SPECTRUM = 'FLOAT_MOLECULE_OVER_SPECTRUM';\n","import { Draft } from 'immer';\nimport { buildCorrelationData, CorrelationData } from 'nmr-correlation';\n\nimport { addJcamps, addJDFs } from '../../../data/SpectraManager';\nimport * as MoleculeManager from '../../../data/molecules/MoleculeManager';\nimport { UsedColors } from '../../../types/UsedColors';\nimport { Molecules, NMRiumPreferences, Spectra } from '../../NMRium';\nimport { DefaultTolerance } from '../../panels/SummaryPanel/CorrelationTable/Constants';\nimport { getInitialState, State } from '../Reducer';\nimport { INITIATE, LOAD_JSON_FILE, LOAD_NMREDATA_FILE } from '../types/Types';\n\nimport { changeSpectrumVerticalAlignment } from './PreferencesActions';\nimport { setActiveTab } from './ToolsActions';\n\nfunction setIsLoading(draft: Draft<State>, isLoading: boolean) {\n  draft.isLoading = isLoading;\n}\n\nfunction setColors(draft: Draft<State>, colors: UsedColors) {\n  draft.usedColors['1d'] = draft.usedColors['1d'].concat(colors['1d']);\n  draft.usedColors['2d'] = draft.usedColors['2d'].concat(colors['2d']);\n}\n\nfunction setData(\n  draft: Draft<State>,\n  data: {\n    spectra: Spectra;\n    molecules: Molecules;\n    preferences: NMRiumPreferences;\n    correlations: CorrelationData;\n    usedColors: UsedColors;\n  },\n) {\n  const { spectra, molecules, correlations, usedColors } = data || {\n    spectra: [],\n    molecules: [],\n    correlations: {},\n    multipleAnalysis: {},\n    exclusionZones: [],\n  };\n\n  setColors(draft, usedColors);\n  draft.data = spectra;\n  draft.molecules = MoleculeManager.fromJSON(molecules);\n\n  if (!correlations || Object.keys(correlations).length === 0) {\n    draft.correlations = buildCorrelationData([], {\n      tolerance: DefaultTolerance,\n    });\n  } else {\n    // in case of older NMRium data are imported, convert hybridization string to number array\n    // @TODO remove following command to overwrite correlations at some point in future\n    draft.correlations =\n      convertHybridizationStringValuesInCorrelations(correlations);\n\n    // draft.correlations = correlations // original command without overwriting\n  }\n}\n\nfunction convertHybridizationStringValuesInCorrelations(\n  correlations: CorrelationData,\n): CorrelationData {\n  return {\n    ...correlations,\n    values: correlations.values.map((correlation) => {\n      if (typeof correlation.hybridization === 'string') {\n        let values: number[] = [];\n        if (correlation.hybridization.length > 0) {\n          const hybridizationString: string =\n            correlation.hybridization.replaceAll('SP', '');\n          const value = Number(hybridizationString);\n          values.push(value);\n        }\n        correlation.hybridization = values;\n      }\n      return correlation;\n    }),\n  };\n}\n\nfunction setPreferences(draft: Draft<State>, data) {\n  const emptyPreferences = {\n    verticalAlign: null,\n  };\n\n  const { verticalAlign = null } = data || emptyPreferences;\n\n  if (verticalAlign) {\n    changeSpectrumVerticalAlignment(draft, {\n      align: verticalAlign,\n    });\n  } else {\n    changeSpectrumVerticalAlignment(draft, { align: 'auto-check' });\n  }\n}\n\nfunction initiate(draft: Draft<State>, action) {\n  const state = getInitialState();\n\n  setData(state, action.payload);\n  const preferences = action.payload?.preferences || {};\n  setActiveTab(state, { tab: preferences?.activeTab || '' });\n  state.width = draft.width;\n  state.height = draft.height;\n  setPreferences(state, action.payload);\n  state.isLoading = false;\n  state.actionType = INITIATE;\n  return state;\n}\n\nfunction loadJDFFile(draft: Draft<State>, actions) {\n  const { files } = actions;\n  const spectra = addJDFs(files, draft.usedColors);\n  for (const spectrum of spectra) {\n    draft.data.push(spectrum);\n  }\n\n  setActiveTab(draft);\n\n  draft.isLoading = false;\n}\n\nfunction loadJcampFile(draft: Draft<State>, actions) {\n  const { files } = actions;\n  const spectra = addJcamps(files, draft.usedColors);\n  for (const spectrum of spectra) {\n    draft.data.push(spectrum);\n  }\n  setActiveTab(draft);\n  changeSpectrumVerticalAlignment(draft, { align: 'auto-check' });\n\n  draft.isLoading = false;\n}\n\nfunction handleLoadJsonFile(draft: Draft<State>, action) {\n  const state = getInitialState();\n\n  setData(state, action.payload);\n  const preferences = action.payload?.preferences || {};\n  setActiveTab(state, { tab: preferences?.activeTab || '' });\n  state.width = draft.width;\n  state.height = draft.height;\n  setPreferences(state, preferences);\n  state.isLoading = false;\n  state.actionType = LOAD_JSON_FILE;\n  return state;\n}\n\nfunction handleLoadMOLFile(draft: Draft<State>, actions) {\n  const { files } = actions;\n  for (let file of files) {\n    MoleculeManager.addMolfile(draft.molecules, file.binary.toString());\n  }\n  draft.isLoading = false;\n}\n\nfunction handleLoadZIPFile(draft: Draft<State>, action) {\n  const { data, usedColors } = action.payload;\n  draft.data = draft.data.concat(data);\n  setColors(draft, usedColors);\n\n  setActiveTab(draft);\n  changeSpectrumVerticalAlignment(draft, { align: 'auto-check' });\n\n  draft.isLoading = false;\n}\n\nfunction handleLoadNmredata(draft: Draft<State>, action) {\n  const state = getInitialState();\n\n  setData(state, action.payload);\n  setActiveTab(state);\n  changeSpectrumVerticalAlignment(state, { align: 'auto-check' });\n  state.isLoading = false;\n  state.width = draft.width;\n  state.height = draft.height;\n  state.actionType = LOAD_NMREDATA_FILE;\n\n  return state;\n}\n\nexport {\n  setIsLoading,\n  initiate,\n  loadJcampFile,\n  loadJDFFile,\n  handleLoadJsonFile,\n  handleLoadNmredata,\n  handleLoadMOLFile,\n  handleLoadZIPFile,\n};\n","import { Draft } from 'immer';\n\nimport { generateSpectra } from '../../../data/PredictionManager';\nimport { changeSpectraRelativeSum } from '../../../data/data1d/Spectrum1D/SumManager';\nimport * as MoleculeManager from '../../../data/molecules/MoleculeManager';\nimport getColor from '../../../data/utilities/getColor';\nimport nucleusToString from '../../utility/nucleusToString';\nimport { State } from '../Reducer';\nimport { DISPLAYER_MODE } from '../core/Constants';\n\nimport { handleUnlinkRange } from './RangesActions';\nimport { setActiveTab } from './ToolsActions';\nimport { handleUnlinkZone } from './ZonesActions';\n\nfunction addMoleculeHandler(draft: Draft<State>, molfile) {\n  const isEmpty = draft.molecules.length === 0;\n  MoleculeManager.addMolfile(draft.molecules, molfile);\n\n  /**\n   *  if it's the first creation of a molecule after the molecules list was empty,\n   * set the relative sum for ranges and integrals base on the first molecule\n   */\n  const molecule = draft.molecules[0] || null;\n\n  if (isEmpty && molecule) {\n    changeSpectraRelativeSum(draft, molecule.key, molecule);\n  }\n}\n\nfunction setMoleculeHandler(draft: Draft<State>, molfile, key) {\n  MoleculeManager.setMolfile(draft.molecules, molfile, key);\n\n  /**\n   * update all spectra that its sum was based on this molecule with the new molecule\n   */\n  const index = draft.molecules.findIndex((molecule) => molecule.key === key);\n\n  changeSpectraRelativeSum(\n    draft,\n    key,\n    index !== -1 ? draft.molecules[index] : draft.molecules[0] || null,\n  );\n}\n\nfunction removeAssignments(draft: Draft<State>, assignmentData: any) {\n  if (draft.displayerMode === DISPLAYER_MODE.DM_1D) {\n    handleUnlinkRange(draft, { payload: { assignmentData, rangeData: null } });\n  }\n  if (draft.displayerMode === DISPLAYER_MODE.DM_2D) {\n    handleUnlinkZone(draft, { payload: { assignmentData, zoneData: null } });\n  }\n}\n\nfunction deleteMoleculeHandler(draft: Draft<State>, action) {\n  const { key, assignmentData } = action.payload;\n  // remove Assignments links of the active spectrum\n  removeAssignments(draft, assignmentData);\n\n  const moleculeIndex = draft.molecules.findIndex(\n    (molecule) => molecule.key === key,\n  );\n  draft.molecules.splice(moleculeIndex, 1);\n  /**\n   * update all spectra that its sum was based on this molecule with the first molecule\n   * from molecules list and if no remains molecules it sum will be 100\n   */\n  changeSpectraRelativeSum(draft, key, draft.molecules[0] || null);\n}\n\nfunction predictSpectraFromMoleculeHandler(draft: Draft<State>, action) {\n  const { data, options } = action.payload;\n  if (!data) {\n    draft.isLoading = false;\n  } else {\n    const color = getColor(false, draft.usedColors['1d']);\n    for (const spectrum of generateSpectra(data, options, color)) {\n      draft.data.push(spectrum);\n      draft.tabActiveSpectrum[nucleusToString(spectrum.info.nucleus)] = {\n        id: spectrum.id,\n        index: draft.data.length - 1,\n      };\n    }\n    draft.usedColors['1d'].push(color);\n  }\n  draft.toolOptions.data.predictionIndex++;\n  setActiveTab(draft);\n  draft.isLoading = false;\n}\nfunction floatMoleculeOverSpectrum(draft: Draft<State>, action) {\n  const { key } = action.payload;\n  const moleculeIndex = draft.molecules.findIndex(\n    (molecule) => molecule.key === key,\n  );\n  draft.molecules[moleculeIndex].isFloat =\n    !draft.molecules[moleculeIndex].isFloat;\n}\n\nexport {\n  addMoleculeHandler,\n  setMoleculeHandler,\n  deleteMoleculeHandler,\n  predictSpectraFromMoleculeHandler,\n  floatMoleculeOverSpectrum,\n};\n","import { Draft, original } from 'immer';\nimport { xFindClosestIndex } from 'ml-spectra-processing';\n\nimport {\n  getShiftX,\n  lookupPeak,\n  autoPeakPicking,\n} from '../../../data/data1d/Spectrum1D';\nimport { Datum1D } from '../../../data/types/data1d';\nimport { Data1D } from '../../../data/types/data1d/Data1D';\nimport { Peak } from '../../../data/types/data1d/Peak';\nimport generateID from '../../../data/utilities/generateID';\nimport { options } from '../../toolbar/ToolTypes';\nimport { State } from '../Reducer';\nimport getRange from '../helper/getRange';\n\nfunction addPeak(draft: Draft<State>, mouseCoordinates) {\n  const state = original(draft) as State;\n  if (draft.activeSpectrum?.id && state) {\n    const { index } = draft.activeSpectrum;\n    const xShift = 10;\n    const startX = mouseCoordinates.x - xShift;\n    const endX = mouseCoordinates.x + xShift;\n    const [from, to] = getRange(draft, { startX, endX });\n    const candidatePeak = lookupPeak(state.data[index].data as Data1D, {\n      from,\n      to,\n    });\n\n    const shiftX = getShiftX(draft.data[index] as Datum1D);\n\n    if (candidatePeak) {\n      const peak: Peak = {\n        id: generateID(),\n        originalX: candidatePeak.x - shiftX,\n        x: candidatePeak.x,\n        y: candidatePeak.y,\n        width: 0,\n      };\n      (draft.data[index] as Datum1D).peaks.values.push(peak);\n    }\n  }\n}\n\nfunction addPeaks(draft: Draft<State>, action) {\n  const state = original(draft) as State;\n\n  if (draft.activeSpectrum) {\n    const { index } = draft.activeSpectrum;\n    const datumOriginal = state.data[index] as Datum1D;\n\n    const { startX, endX } = action;\n    const [from, to] = getRange(draft, { startX, endX });\n\n    if (from !== to) {\n      const peak = lookupPeak(datumOriginal.data, { from, to });\n\n      const shiftX = getShiftX(draft.data[index] as Datum1D);\n\n      if (peak && !datumOriginal.peaks.values.some((p) => p.x === peak.x)) {\n        const newPeak: Peak = {\n          id: generateID(),\n          originalX: peak.x - shiftX,\n          x: peak.x,\n          y: peak.y,\n          width: 0,\n        };\n        (draft.data[index] as Datum1D).peaks.values.push(newPeak);\n      }\n    }\n  }\n}\n\nfunction deletePeak(draft: Draft<State>, peakData) {\n  if (draft.activeSpectrum) {\n    const { index } = draft.activeSpectrum;\n    const state = original(draft) as State;\n\n    if (peakData == null) {\n      (draft.data[index] as Datum1D).peaks.values = [];\n    } else {\n      const peakIndex = (state.data[index] as Datum1D).peaks.values.findIndex(\n        (p) => p.id === peakData.id,\n      );\n      (draft.data[index] as Datum1D).peaks.values.splice(peakIndex, 1);\n    }\n  }\n}\n\nfunction handleAutoPeakPicking(draft: Draft<State>, autOptions) {\n  if (draft.activeSpectrum?.id) {\n    draft.toolOptions.selectedTool = options.zoom.id;\n    draft.toolOptions.selectedOptionPanel = null;\n    const { index } = draft.activeSpectrum;\n    const datum = draft.data[index] as Datum1D;\n\n    const [from, to] = draft.xDomain;\n    const windowFromIndex = xFindClosestIndex(datum.data.x, from);\n    const windowToIndex = xFindClosestIndex(datum.data.x, to);\n\n    const peaks = autoPeakPicking(draft.data[index] as Datum1D, {\n      ...autOptions,\n      windowFromIndex,\n      windowToIndex,\n    });\n\n    datum.peaks.values = datum.peaks.values.concat(peaks);\n  }\n}\n\nexport { addPeak, addPeaks, deletePeak, handleAutoPeakPicking };\n","export default function generateChar(index: number): string {\n  const aPotions = 'a'.charCodeAt(0);\n  const zPostion = 'z'.charCodeAt(0);\n  const len = zPostion - aPotions + 1;\n\n  let chartResult = '';\n  while (index >= 0) {\n    chartResult = String.fromCharCode((index % len) + aPotions) + chartResult;\n    index = Math.floor(index / len) - 1;\n  }\n  return chartResult;\n}\n","import lodashGet from 'lodash/get';\n\nimport { Spectra } from '../../component/NMRium';\nimport { RangeDetectionResult } from '../types/data1d';\nimport generateChar from '../utilities/generateChar';\n\nimport { detectRange, isSpectrum1D } from './Spectrum1D';\n\nexport enum COLUMNS_TYPES {\n  NORMAL = 'NORMAL',\n  FORMULA = 'FORMULA',\n}\nexport enum COLUMNS_VALUES_KEYS {\n  RELATIVE = 'relative',\n  ABSOLUTE = 'absolute',\n  MIN = 'min',\n  MAX = 'max',\n}\n\nexport type ColumnType = keyof typeof COLUMNS_TYPES;\n\ninterface Column {\n  type: ColumnType;\n  valueKey: COLUMNS_VALUES_KEYS;\n  from: number;\n  to: number;\n  formula?: string;\n  index: number;\n}\n\ntype Columns = Record<string, Column>;\n\ninterface AnalysisOptions {\n  sum: number;\n  code: string | null;\n  columns: Columns;\n  columnIndex: number;\n}\n\ninterface AnalysisRow extends RangeDetectionResult {\n  SID: string;\n  colKey?: string;\n  value?: number;\n}\n\ninterface SpectraAnalysisData {\n  options: AnalysisOptions;\n  values: Record<string, AnalysisRow>;\n}\n\nexport type SpectraAnalysis = Record<string, SpectraAnalysisData>;\n\nfunction addColumnKey(\n  spectraAnalysis: SpectraAnalysis,\n  nucleus: string,\n  columnProps: Column,\n  columnKey: string,\n) {\n  const key = columnKey\n    ? columnKey\n    : generateChar(spectraAnalysis[nucleus].options.columnIndex).toUpperCase();\n  spectraAnalysis[nucleus].options.columns[key] = columnProps;\n  spectraAnalysis[nucleus].options.columnIndex++;\n  return key;\n}\n\nexport function getColumns(spectraAnalysis: SpectraAnalysis, nucleus: string) {\n  return spectraAnalysis[nucleus].options.columns;\n}\n\nexport function getValue(colKey: string, columns: Columns, data) {\n  return data[columns[colKey].valueKey];\n}\n\nexport function getSpectraAnalysis(\n  spectra: Spectra,\n  options,\n): { values: Array<AnalysisRow>; sum: number } {\n  const { from, to, nucleus } = options;\n  return spectra.reduce<{ values: Array<AnalysisRow>; sum: number }>(\n    (acc, datum) => {\n      if (\n        isSpectrum1D(datum) &&\n        datum.info.nucleus === nucleus &&\n        !datum.info.isFid\n      ) {\n        const range = detectRange(datum, { from, to });\n        acc.sum += range.absolute;\n        acc.values.push({ SID: datum.id, ...range });\n      }\n      return acc;\n    },\n    { values: [], sum: 0 },\n  );\n}\n\nfunction init(spectraAnalysis: SpectraAnalysis, nucleus: string) {\n  if (spectraAnalysis[nucleus] === undefined) {\n    spectraAnalysis[nucleus] = {\n      options: {\n        sum: 100,\n        code: null,\n        columns: {},\n        columnIndex: 0,\n      },\n      values: {},\n    };\n  }\n}\n\nexport function changeColumnValueKey(\n  spectraAnalysis: SpectraAnalysis,\n  nucleus: string,\n  columnKey: string,\n  newKey: COLUMNS_VALUES_KEYS,\n) {\n  spectraAnalysis[nucleus].options.columns[columnKey].valueKey = newKey;\n\n  spectraAnalysis[nucleus].values = refreshCalculation(\n    spectraAnalysis,\n    nucleus,\n  );\n}\n\nexport function setColumn(\n  spectraAnalysis: SpectraAnalysis,\n  nucleus: string,\n  { columns: inputColumns, code },\n) {\n  init(spectraAnalysis, nucleus);\n  spectraAnalysis[nucleus].options.code = code;\n  spectraAnalysis[nucleus].options.columns = Object.values(\n    inputColumns,\n  ).reduce<any>((acc, value: any) => {\n    const data = { ...value };\n    delete data.tempKey;\n    acc[value.tempKey] = data;\n    return acc;\n  }, {});\n\n  const { columns: newColumns } = spectraAnalysis[nucleus].options;\n\n  let data = Object.entries(spectraAnalysis[nucleus].values).reduce<any>(\n    (outerAcc, [spectraKey, spectra]) => {\n      outerAcc[spectraKey] = Object.keys(inputColumns).reduce((acc, key) => {\n        const newKey = inputColumns[key].tempKey;\n        if (spectra[key]) {\n          acc[newKey] = spectra[key];\n        }\n        return acc;\n      }, {});\n      return outerAcc;\n    },\n    {},\n  );\n\n  data = Object.entries(data).reduce((acc, spectra: any) => {\n    acc[spectra[0]] = Object.keys(newColumns).reduce((acc, key) => {\n      const isFormula = newColumns[key].type === COLUMNS_TYPES.FORMULA;\n      acc[key] = isFormula\n        ? {\n            colKey: key,\n            value: calculate(\n              newColumns,\n              data[spectra[0]],\n              newColumns[key].formula,\n            ),\n          }\n        : { ...spectra[1][key], colKey: key };\n\n      return acc;\n    }, {});\n\n    return acc;\n  }, {});\n  spectraAnalysis[nucleus].values = data;\n}\n\nfunction refreshByRow(row, columns) {\n  return Object.keys(columns).reduce((acc, key) => {\n    if (columns[key].type === COLUMNS_TYPES.FORMULA) {\n      acc[key] = {\n        colKey: key,\n        ...row,\n        value: calculate(columns, row, columns[key].formula),\n      };\n    }\n\n    return acc;\n  }, {});\n}\n\nfunction refreshCalculation(spectraAnalysis: SpectraAnalysis, nucleus: string) {\n  const { columns } = spectraAnalysis[nucleus].options;\n\n  const data = Object.entries(spectraAnalysis[nucleus].values).reduce(\n    (acc, spectra) => {\n      const [id, row] = spectra;\n      acc[id] = {\n        ...row,\n        ...refreshByRow(row, columns),\n      };\n      return acc;\n    },\n    {},\n  );\n\n  return data;\n}\n\nexport function analyzeSpectra(\n  spectra,\n  spectraAnalysis: SpectraAnalysis,\n  options,\n) {\n  const { from, to, nucleus, columnKey = null } = options;\n  init(spectraAnalysis, nucleus);\n  const colKey = addColumnKey(\n    spectraAnalysis,\n    nucleus,\n    {\n      type: COLUMNS_TYPES.NORMAL,\n      valueKey: COLUMNS_VALUES_KEYS.RELATIVE,\n      from,\n      to,\n      index: 1,\n    },\n    columnKey,\n  );\n\n  const { sum } = spectraAnalysis[nucleus].options;\n\n  const { values: result, sum: spectraSum } = getSpectraAnalysis(spectra, {\n    from,\n    to,\n    nucleus,\n  });\n\n  const prevNucleusData = lodashGet(spectraAnalysis, `${nucleus}.values`, {});\n\n  let data = result.reduce((acc, row) => {\n    const factor = spectraSum > 0 ? sum / spectraSum : 0.0;\n\n    acc[row.SID] = {\n      ...prevNucleusData[row.SID],\n      [colKey]: {\n        colKey,\n        ...row,\n        relative: Math.abs(row.absolute) * factor,\n      },\n    };\n    return acc;\n  }, {});\n\n  spectraAnalysis[nucleus].values = data;\n  spectraAnalysis[nucleus].values = refreshCalculation(\n    spectraAnalysis,\n    nucleus,\n  );\n}\n\nexport function deleteSpectraAnalysis(\n  spectraAnalysis: SpectraAnalysis,\n  colKey: string,\n  nucleus: string,\n) {\n  const result = Object.entries(spectraAnalysis[nucleus].values).reduce(\n    (acc, item: any) => {\n      // eslint-disable-next-line @typescript-eslint/no-dynamic-delete\n      delete item[1][colKey];\n      if (item[1] && Object.keys(item[1]).length > 0) {\n        acc[item[0]] = item[1];\n        return acc;\n      }\n      return acc;\n    },\n    {},\n  );\n\n  const { [colKey]: deletedColumnKey, ...resColumns } =\n    spectraAnalysis[nucleus].options.columns;\n\n  const currentColumns = Object.keys(spectraAnalysis[nucleus].options.columns);\n\n  if (currentColumns.length === 1) {\n    spectraAnalysis[nucleus].options.columnIndex = 0;\n  }\n\n  spectraAnalysis[nucleus].options.columns = resColumns;\n  spectraAnalysis[nucleus].values = result;\n  spectraAnalysis[nucleus].values = refreshCalculation(\n    spectraAnalysis,\n    nucleus,\n  );\n}\n\nfunction calculate(columns: Columns, data: AnalysisRow, formula = '') {\n  const array = formula.split(/\\+|-|\\*|\\/|%|\\(|\\)/);\n\n  const variables: string[] = [];\n\n  for (const col of array) {\n    const column = col.trim();\n    if (columns[column]) {\n      variables.push(column);\n    }\n  }\n\n  const params = variables.map((key) =>\n    data[key] ? data[key][columns[key].valueKey] : null,\n  );\n\n  let result;\n  try {\n    result = new Function(...variables, `return ${formula}`)(...params);\n  } catch (e) {\n    // eslint-disable-next-line no-console\n    console.error(e);\n    result = new Error(`Invalid Formula ( ${formula} ) `);\n  }\n  return result;\n}\n\nexport function getDataAsString(\n  spectraAnalysis: SpectraAnalysis,\n  nucleus: string,\n) {\n  if (spectraAnalysis?.[nucleus]) {\n    const {\n      values,\n      options: { columns },\n    } = spectraAnalysis[nucleus];\n\n    let result = '';\n\n    for (const letter in columns) {\n      result += `${letter}\\t`;\n    }\n    result += '\\n';\n\n    for (const spectrum of Object.values(values)) {\n      for (const letter in columns) {\n        result += `${spectrum[letter][columns[letter].valueKey]}\\t`;\n      }\n      result += '\\n';\n    }\n    return result;\n  }\n  return null;\n}\n","import { Draft } from 'immer';\n\nimport * as MultipleAnalysis from '../../../data/data1d/MultipleAnalysis';\nimport { State } from '../Reducer';\nimport getRange from '../helper/getRange';\n\nfunction analyzeSpectra(draft: Draft<State>, action) {\n  const [from, to] = getRange(draft, action);\n  MultipleAnalysis.analyzeSpectra(draft.data, draft.spectraAnalysis, {\n    from,\n    to,\n    nucleus: draft.activeTab,\n  });\n}\n\nfunction handleDeleteSpectraRanges(draft: Draft<State>, action) {\n  const { colKey } = action;\n\n  MultipleAnalysis.deleteSpectraAnalysis(\n    draft.spectraAnalysis,\n    colKey,\n    draft.activeTab,\n  );\n}\nfunction handleResizeSpectraRange(draft: Draft<State>, action) {\n  const { columnKey, from, to } = action.payload;\n  MultipleAnalysis.analyzeSpectra(draft.data, draft.spectraAnalysis, {\n    from,\n    to,\n    nucleus: draft.activeTab,\n    columnKey,\n  });\n}\nfunction handleSetColumns(draft: Draft<State>, action) {\n  const data = action.payload;\n\n  MultipleAnalysis.setColumn(draft.spectraAnalysis, draft.activeTab, data);\n}\nfunction handleFilterColumn(draft: Draft<State>, action) {\n  const { columnKey, valueKey } = action.payload;\n\n  MultipleAnalysis.changeColumnValueKey(\n    draft.spectraAnalysis,\n    draft.activeTab,\n    columnKey,\n    valueKey,\n  );\n}\n\nexport {\n  analyzeSpectra,\n  handleDeleteSpectraRanges,\n  handleResizeSpectraRange,\n  handleSetColumns,\n  handleFilterColumn,\n};\n","import { Draft, original } from 'immer';\n\nimport * as Filters from '../../../data/Filters';\nimport { applyFilter } from '../../../data/FiltersManager';\nimport {\n  generateSpectrumFromPublicationString,\n  getReferenceShift,\n} from '../../../data/data1d/Spectrum1D';\nimport { getMissingProjection } from '../../../data/data2d/Spectrum2D';\nimport { Datum1D } from '../../../data/types/data1d';\nimport { Datum2D } from '../../../data/types/data2d';\nimport { options } from '../../toolbar/ToolTypes';\nimport GroupByInfoKey from '../../utility/GroupByInfoKey';\nimport { State } from '../Reducer';\nimport { setZoom } from '../helper/Zoom1DManager';\n\nimport { setDomain, setMode } from './DomainActions';\nimport { resetSpectrumByFilter } from './FiltersActions';\nimport { setTab, setActiveTab } from './ToolsActions';\n\nfunction checkIsVisible2D(datum: Datum2D): boolean {\n  if (\n    datum.display.isPositiveVisible === false &&\n    datum.display.isNegativeVisible === false\n  ) {\n    return false;\n  }\n  return true;\n}\n\nfunction setVisible(datum, flag) {\n  if (datum.info.dimension === 2) {\n    (datum as Datum2D).display.isPositiveVisible = flag;\n    (datum as Datum2D).display.isNegativeVisible = flag;\n    (datum as Datum2D).display.isVisible = checkIsVisible2D(datum as Datum2D);\n  } else {\n    (datum as Datum1D).display.isVisible = flag;\n  }\n}\n\nfunction handleSpectrumVisibility(draft: Draft<State>, action) {\n  if (Array.isArray(action.id)) {\n    const IDs = action.id;\n    if (IDs.length === 0) {\n      for (const datum of draft.data) {\n        setVisible(datum, false);\n      }\n    } else {\n      for (const datum of draft.data) {\n        if (IDs.includes(datum.id)) {\n          setVisible(datum, true);\n        } else {\n          setVisible(datum, false);\n        }\n      }\n    }\n  } else {\n    const index = draft.data.findIndex((d) => d.id === action.id);\n    (draft.data[index] as Datum1D | Datum2D).display[action.key] = action.value;\n\n    if ((draft.data[index] as Datum1D | Datum2D).info.dimension === 2) {\n      (draft.data[index] as Datum2D).display.isVisible = checkIsVisible2D(\n        draft.data[index] as Datum2D,\n      );\n    }\n  }\n}\n\nfunction handleChangePeaksMarkersVisibility(draft: Draft<State>, data) {\n  for (let datum of draft.data) {\n    if (\n      datum.info?.dimension === 1 &&\n      data.some((activeData) => activeData.id === datum.id)\n    ) {\n      (datum as Datum1D).display.isPeaksMarkersVisible = true;\n    } else {\n      (datum as Datum1D).display.isPeaksMarkersVisible = false;\n    }\n  }\n}\n\nfunction handleChangeActiveSpectrum(draft: Draft<State>, activeSpectrum) {\n  let refreshDomain = false;\n\n  const currentActiveSpectrum = draft.activeSpectrum;\n  if (activeSpectrum) {\n    const newIndex = draft.data.findIndex((d) => d.id === activeSpectrum.id);\n    const oldIndex = draft.data.findIndex(\n      (d) => d.id === draft.activeSpectrum?.id,\n    );\n    if (newIndex !== -1) {\n      const newActiveSpectrum = draft.data[newIndex] as Datum1D | Datum2D;\n\n      newActiveSpectrum.display.isVisible = true;\n\n      if (oldIndex !== -1) {\n        refreshDomain =\n          (draft.data[oldIndex] as Datum1D | Datum2D).info.isFid ===\n          newActiveSpectrum.info.isFid\n            ? false\n            : true;\n      } else {\n        refreshDomain = newActiveSpectrum.info.isFid || false;\n      }\n    }\n    activeSpectrum = { ...activeSpectrum, index: newIndex };\n    draft.activeSpectrum = activeSpectrum;\n    draft.tabActiveSpectrum[draft.activeTab] = activeSpectrum;\n  } else {\n    if (currentActiveSpectrum) {\n      const index = draft.data.findIndex(\n        (d) => d.id === currentActiveSpectrum.id,\n      );\n      refreshDomain = draft.data[index].info.isFid;\n    } else {\n      refreshDomain = false;\n    }\n    draft.activeSpectrum = null;\n    draft.tabActiveSpectrum[draft.activeTab] = null;\n  }\n\n  if (options[draft.toolOptions.selectedTool].isFilter) {\n    draft.toolOptions.selectedTool = options.zoom.id;\n    draft.toolOptions.data.baseLineZones = [];\n    draft.toolOptions.selectedOptionPanel = null;\n    draft.tempData = null;\n  }\n\n  /**\n   * if the active spectrum not is FID then dont refresh the domain and the mode when the first time you activate soectrum\n   * if the new active spectrum different than the previous active spectrum fid then refresh the domain andf the mode.\n   */\n  if (draft.toolOptions.data.activeFilterID) {\n    resetSpectrumByFilter(draft, null, {}, currentActiveSpectrum);\n  } else if (refreshDomain) {\n    setDomain(draft);\n    setMode(draft);\n  }\n}\n\nfunction changeSpectrumSetting(draft: Draft<State>, { id, display }) {\n  const state = original(draft) as State;\n  const index = state.data.findIndex((d) => d.id === id);\n  if (index !== -1) {\n    draft.data[index].display = display;\n  }\n}\nfunction handleChangeSpectrumColor(draft: Draft<State>, { id, color, key }) {\n  const state = original(draft) as State;\n  const index = state.data.findIndex((d) => d.id === id);\n  if (index !== -1) {\n    (draft.data[index] as Datum1D | Datum2D).display[key] = color;\n  }\n}\n\nfunction handleDeleteSpectra(draft: Draft<State>, action) {\n  const state = original(draft) as State;\n  if (action.id) {\n    const index = state.data.findIndex((d) => d.id === action.id);\n    draft.data.splice(index, 1);\n  } else {\n    draft.data = [];\n  }\n  setActiveTab(draft, { tab: draft.activeTab, refreshActiveTab: true });\n}\nfunction addMissingProjectionHandler(draft, action) {\n  const state = original(draft);\n  const { nucleus } = action;\n  if (draft.activeSpectrum?.id) {\n    const { index } = draft.activeSpectrum;\n    for (let n of nucleus) {\n      const datum1D = getMissingProjection(\n        state.data[index],\n        n,\n        draft.usedColors,\n      );\n      draft.data.push(datum1D);\n    }\n    const groupByNucleus = GroupByInfoKey('nucleus');\n    const dataGroupByNucleus = groupByNucleus(draft.data);\n    setTab(draft, dataGroupByNucleus, draft.activeTab, true);\n    setDomain(draft);\n    setMode(draft);\n  }\n}\nfunction alignSpectraHandler(draft: Draft<State>, action) {\n  if (draft.data && draft.data.length > 0) {\n    for (let datum of draft.data) {\n      if (\n        datum.info?.dimension === 1 &&\n        datum.info.nucleus === draft.activeTab &&\n        !datum.info?.isFid\n      ) {\n        const shift = getReferenceShift(datum, { ...action.payload });\n        applyFilter(datum, [\n          {\n            name: Filters.shiftX.id,\n            options: shift,\n          },\n        ]);\n      }\n    }\n  }\n\n  setDomain(draft);\n  setMode(draft);\n}\n\nfunction generateSpectrumFromPublicationStringHandler(\n  draft: Draft<State>,\n  action,\n) {\n  const publicationString = action.payload.publicationText;\n\n  const spectrum = generateSpectrumFromPublicationString(\n    publicationString,\n    draft.usedColors,\n  );\n  draft.data.push(spectrum);\n  setActiveTab(draft);\n  setZoom(draft, { scale: 0.8, spectrumID: spectrum.id });\n}\n\nexport {\n  handleSpectrumVisibility,\n  handleChangePeaksMarkersVisibility,\n  handleChangeActiveSpectrum,\n  handleChangeSpectrumColor,\n  changeSpectrumSetting,\n  handleDeleteSpectra,\n  addMissingProjectionHandler,\n  alignSpectraHandler,\n  generateSpectrumFromPublicationStringHandler,\n};\n","export const UNDO = 'undo';\nexport const REDO = 'redo';\nexport const SET = 'set';\nexport const RESET = 'reset';\n","import { Draft, produce } from 'immer';\nimport { buildCorrelationData, CorrelationData } from 'nmr-correlation';\n\nimport { predictSpectra } from '../../data/PredictionManager';\nimport * as SpectraManager from '../../data/SpectraManager';\nimport { SpectraAnalysis } from '../../data/data1d/MultipleAnalysis';\nimport { migrate } from '../../data/migration/MigrationManager';\nimport { Molecule } from '../../data/molecules/Molecule';\nimport { Range } from '../../data/types/data1d';\nimport { Contours } from '../../data/types/data2d/Contours';\nimport generateID from '../../data/utilities/generateID';\nimport { UsedColors } from '../../types/UsedColors';\nimport { Spectra } from '../NMRium';\nimport { DefaultTolerance } from '../panels/SummaryPanel/CorrelationTable/Constants';\nimport { options } from '../toolbar/ToolTypes';\nimport { nmredataToNmrium } from '../utility/nmredataToNmrium';\n\nimport * as AssignmentsActions from './actions/AssignmentsActions';\nimport * as CorrelationsActions from './actions/CorrelationsActions';\nimport * as DatabaseActions from './actions/DatabaseActions';\nimport { setWidth, handleSetDimensions } from './actions/DimensionsActions';\nimport * as DomainActions from './actions/DomainActions';\nimport * as FiltersActions from './actions/FiltersActions';\nimport * as GlobalActions from './actions/GlobalActions';\nimport {\n  handleHistoryUndo,\n  handleHistoryRedo,\n  handleHistoryReset,\n} from './actions/HistoryActions';\nimport * as IntegralsActions from './actions/IntegralsActions';\nimport * as LoadActions from './actions/LoadActions';\nimport * as MoleculeActions from './actions/MoleculeActions';\nimport * as PeaksActions from './actions/PeaksActions';\nimport {\n  setKeyPreferencesHandler,\n  applyKeyPreferencesHandler,\n} from './actions/PreferencesActions';\nimport * as RangesActions from './actions/RangesActions';\nimport * as SpectraAnalysisActions from './actions/SpectraAnalysisAction';\nimport * as SpectrumsActions from './actions/SpectrumsActions';\nimport * as ToolsActions from './actions/ToolsActions';\nimport * as ZonesActions from './actions/ZonesActions';\nimport { DEFAULT_YAXIS_SHIFT_VALUE, DISPLAYER_MODE } from './core/Constants';\nimport { ZoomHistory } from './helper/ZoomHistoryManager';\nimport { UNDO, REDO, RESET } from './types/HistoryTypes';\nimport * as types from './types/Types';\n\nexport interface ActiveSpectrum {\n  id: string;\n  index: number;\n}\n\nexport interface Margin {\n  top: number;\n  right: number;\n  bottom: number;\n  left: number;\n}\nexport const getInitialState = (): State => ({\n  actionType: '',\n  data: [],\n  contours: {} as Contours,\n  tempData: null,\n  xDomain: [],\n  yDomain: [],\n  yDomains: {},\n  xDomains: {},\n  originDomain: {\n    xDomain: [],\n    yDomain: [],\n    xDomains: {},\n    yDomains: {},\n    shareYDomain: false,\n  },\n  integralsYDomains: {},\n  activeTab: '',\n  width: 0,\n  height: 0,\n  margin: {\n    top: 10,\n    right: 20,\n    bottom: 70,\n    left: 0,\n  },\n  activeSpectrum: null,\n  mode: 'RTL',\n  molecules: [],\n  verticalAlign: {\n    align: 'bottom',\n    verticalShift: DEFAULT_YAXIS_SHIFT_VALUE,\n  },\n  history: {\n    past: [],\n    present: null,\n    future: [],\n    hasUndo: false,\n    hasRedo: false,\n  },\n  isLoading: false,\n  keysPreferences: {},\n  displayerMode: DISPLAYER_MODE.DM_1D,\n  tabActiveSpectrum: {},\n  spectraAnalysis: {},\n  correlations: {},\n  displayerKey: '',\n  zoom: {\n    history: {} as ZoomHistory,\n  },\n  overDisplayer: false,\n  toolOptions: {\n    selectedTool: options.zoom.id,\n    selectedOptionPanel: null,\n    data: {\n      baseLineZones: [],\n      pivot: { value: 0, index: 0 },\n      zonesNoiseFactor: 1,\n      activeFilterID: null,\n      tempRange: null,\n      showMultiplicityTrees: false,\n      showRangesIntegrals: true,\n      showJGraph: false,\n      predictionIndex: 0,\n    },\n  },\n  usedColors: { '1d': [], '2d': [] },\n});\n\nexport const initialState = getInitialState();\n\nexport type VerticalAlignment = 'bottom' | 'center' | 'stack';\nexport interface VerticalAlign {\n  align: VerticalAlignment;\n  verticalShift: number;\n}\nexport interface State {\n  /**\n   * Last action type\n   *  base on the action type we can decide to trigger or not the callback function (onDataChange)\n   */\n  actionType: string;\n  /**\n   * spectra list (1d and 2d)\n   */\n  data: Spectra;\n  /**\n   * calculated contours for 2d spectra\n   */\n  contours: Contours;\n  /**\n   * snapshot of the spectra data once phase correction activated\n   *\n   */\n  tempData: any;\n  /**\n   * X axis domain\n   * value change when zooming in/out\n   * @default []\n   */\n  xDomain: Array<number>;\n  /**\n   * Y axis domain\n   * value change when vertical scale change for all spectra\n   * @default []\n   */\n  yDomain: Array<number>;\n\n  /**\n   * Y axis domain per spectrum\n   * value change when vertical scale change for the selected spectrum\n   * @default {}\n   */\n  yDomains: Record<string, Array<number>>;\n  /**\n   * X axis domain per spectrum\n   * value change when zooming in/out for the selected spectrum\n   * @default {}\n   */\n  xDomains: Record<string, Array<number>>;\n  /**\n   * Domain for X and Y axis once it calculated and it change in one case  when we load new spectra\n   * @default {}\n   */\n  originDomain: {\n    xDomain: Array<number>;\n    yDomain: Array<number>;\n    xDomains: Record<string, Array<number>>;\n    yDomains: Record<string, Array<number>>;\n    shareYDomain: boolean;\n  };\n  /**\n   * y axis domain per spectrum for integrals\n   * value change when vertical scale change for the integrals\n   * @default {}\n   */\n  integralsYDomains: Record<string, Array<number>>;\n\n  /**\n   * current select tab (nucleus)\n   * @default null\n   */\n  activeTab: string;\n  /**\n   * plot chart area width\n   * @default 0\n   */\n  width: number;\n  /**\n   * plot chart area height\n   * @default 0\n   */\n  height: number;\n  /**\n   * The margin Around the plot chart area\n   * @default {top: 10,right: 20,bottom: 70,left: 0}\n   */\n  margin: Margin;\n  /**\n   * current active spectrum\n   * @default null\n   */\n  activeSpectrum: ActiveSpectrum | null;\n  /**\n   * Scale direction\n   * @default 'RTL'\n   */\n  mode: 'RTL' | 'LTR';\n  /**\n   * molecules\n   * @default []\n   */\n  molecules: Array<Molecule>;\n  /**\n   * options to control spectra vertical alignment\n   * @default {align: 'bottom',value: DEFAULT_YAXIS_SHIFT_VALUE}\n   */\n  verticalAlign: VerticalAlign;\n  /**\n   * @todo for undo /redo features\n   */\n  history: Partial<{\n    past: Array<any>;\n    present: any;\n    future: Array<any>;\n    hasUndo: boolean;\n    hasRedo: boolean;\n  }>;\n\n  /**\n   * hide/show main loading indicator\n   * @default false\n   */\n  isLoading: boolean;\n\n  /**\n   * temporary snapshot of state once the user press on number from 1-9\n   */\n  keysPreferences: any;\n\n  /**\n   * displayer mode '1D' or '2D'\n   * @default '1D'\n   */\n  displayerMode: DISPLAYER_MODE;\n\n  /**\n   * active spectrum per nucleus\n   * @default {}\n   */\n  tabActiveSpectrum: Record<string, ActiveSpectrum | null>;\n\n  /**\n   * Multiple spectra analysis data\n   */\n\n  spectraAnalysis: SpectraAnalysis;\n  /**\n   * unique key identifier per Displayer instance\n   */\n  displayerKey: string;\n\n  /**\n   * Correlation data\n   */\n  correlations: CorrelationData;\n\n  /**\n   * Zoom Manager for vertical scale for spectra, integral, And undo zoom in per tab (nucleus)\n   * @default  {history: {},spectra: {},integral: {}}\n   */\n  zoom: {\n    history: ZoomHistory;\n  };\n\n  /**\n   * boolean indicator to check if the mouse over the displayer or not\n   * value change to true once the mouse come over the displayer and vice versa true once the mouse out of the displayer\n   * @default false\n   */\n  overDisplayer: boolean;\n\n  /**\n   * Basic options for the tools\n   */\n  toolOptions: {\n    /**\n     * The current selected tool\n     * @default `options.zoom.id`\n     */\n    selectedTool: string;\n    /**\n     * The current active options panel\n     * Part of tools has an options panel for more control over the tool, once the user select the tool then the options panel will be shown in the header\n     * @default null\n     */\n    selectedOptionPanel: string | null;\n\n    /**\n     * extra data for tools\n     */\n    data: {\n      /**\n       * list of zones for Baseline correction filter\n       */\n      baseLineZones: any;\n      /**\n       * pivot point for manual phase correction\n       * @default {value:0,index:0}\n       */\n      pivot: { value: number; index: number };\n      /**\n       * Noise factor for auto zones detection\n       * @default 1\n       */\n      zonesNoiseFactor: number;\n\n      /**\n       * The current active Filter\n       * @default null\n       */\n      activeFilterID: string | null;\n\n      /**\n       * copy of the range that the user start editing for multiplicity tree live updating\n       */\n      tempRange: Range | null;\n      /**\n       * boolean indicator to hide/show multiplicity tree\n       * @default false\n       */\n      showMultiplicityTrees: boolean;\n      /**\n       * boolean indicator to hide/show integrals for the spectrum ranges\n       * @default false\n       */\n      showRangesIntegrals: boolean;\n\n      /**\n       * boolean indicator to hide/show J graph for spectrum signals\n       * @default false\n       */\n\n      showJGraph: boolean;\n\n      /**\n       * prediction Index\n       * @default 0\n       */\n      predictionIndex: number;\n    };\n  };\n\n  usedColors: UsedColors;\n}\n\nexport function initState(state: State): State {\n  const displayerKey = generateID();\n  const correlations = buildCorrelationData([], {\n    tolerance: DefaultTolerance,\n  });\n\n  return {\n    ...state,\n    correlations,\n    displayerKey,\n    history: {},\n  };\n}\n\nexport function dispatchMiddleware(dispatch) {\n  const usedColors: UsedColors = { '1d': [], '2d': [] };\n\n  return (action) => {\n    switch (action.type) {\n      case types.INITIATE: {\n        if (action.payload) {\n          const { spectra, ...res } = migrate(action.payload);\n          void SpectraManager.fromJSON(spectra, usedColors).then((data) => {\n            action.payload = { spectra: data, ...res, usedColors };\n            dispatch(action);\n          });\n        }\n\n        break;\n      }\n      case types.LOAD_JSON_FILE: {\n        const parsedData = JSON.parse(action.files[0].binary.toString());\n        const data = migrate(parsedData);\n        void SpectraManager.fromJSON(data.spectra, usedColors).then(\n          (spectra) => {\n            action.payload = Object.assign(data, { spectra, usedColors });\n            dispatch(action);\n          },\n        );\n        break;\n      }\n      case types.LOAD_ZIP_FILE: {\n        for (let zipFile of action.files) {\n          void SpectraManager.addBruker(\n            { display: { name: zipFile.name } },\n            zipFile.binary,\n            usedColors,\n          ).then((data) => {\n            action.payload = { data, usedColors };\n            dispatch(action);\n          });\n        }\n        break;\n      }\n      case types.LOAD_NMREDATA_FILE: {\n        void nmredataToNmrium(action.file, usedColors).then((data) => {\n          action.payload = Object.assign(data, { usedColors });\n          dispatch(action);\n        });\n        break;\n      }\n      case types.PREDICT_SPECTRA: {\n        const {\n          mol: { molfile },\n          options,\n        } = action.payload;\n        void predictSpectra(molfile).then(\n          (data) => {\n            action.payload = { data, options };\n            dispatch(action);\n          },\n          () => {\n            dispatch(action);\n          },\n        );\n\n        break;\n      }\n\n      default:\n        action.usedColors = usedColors;\n        dispatch(action);\n\n        break;\n    }\n  };\n}\n\nfunction innerSpectrumReducer(draft: Draft<State>, action) {\n  if (\n    ![types.LOAD_JSON_FILE, types.LOAD_NMREDATA_FILE, types.INITIATE].includes(\n      action.type,\n    )\n  ) {\n    draft.actionType = action.type;\n  }\n\n  switch (action.type) {\n    case types.INITIATE:\n      return LoadActions.initiate(draft, action);\n    case types.SET_LOADING_FLAG:\n      return LoadActions.setIsLoading(draft, action.isLoading);\n    case types.LOAD_JSON_FILE:\n      return LoadActions.handleLoadJsonFile(draft, action);\n    case types.LOAD_JCAMP_FILE:\n      return LoadActions.loadJcampFile(draft, action);\n    case types.LOAD_JDF_FILE:\n      return LoadActions.loadJDFFile(draft, action);\n    case types.LOAD_MOL_FILE:\n      return LoadActions.handleLoadMOLFile(draft, action);\n    case types.LOAD_ZIP_FILE:\n      return LoadActions.handleLoadZIPFile(draft, action);\n    case types.LOAD_NMREDATA_FILE:\n      return LoadActions.handleLoadNmredata(draft, action);\n    case types.ADD_PEAK:\n      return PeaksActions.addPeak(draft, action.mouseCoordinates);\n    case types.ADD_PEAKS:\n      return PeaksActions.addPeaks(draft, action);\n\n    case types.DELETE_PEAK_NOTATION:\n      return PeaksActions.deletePeak(draft, action.data);\n\n    case types.ADD_INTEGRAL:\n      return IntegralsActions.addIntegral(draft, action);\n    case types.DELETE_INTEGRAL:\n      return IntegralsActions.deleteIntegral(draft, action);\n    case types.CHANGE_INTEGRAL_DATA:\n      return IntegralsActions.changeIntegral(draft, action);\n    case types.RESIZE_INTEGRAL:\n      return IntegralsActions.changeIntegral(draft, action);\n    case types.CHANGE_INTEGRAL_SUM:\n      return IntegralsActions.handleChangeIntegralSum(draft, action.value);\n    case types.CHANGE_INTEGRALS_SUM_FLAG:\n      return IntegralsActions.handleChangeIntegralsSumFlag(draft, action);\n    case types.CHANGE_INTEGRAL_RELATIVE:\n      return IntegralsActions.handleChangeIntegralsRelativeValue(draft, action);\n\n    case types.SET_ORIGINAL_DOMAIN:\n      return DomainActions.setOriginalDomain(draft, action.domain);\n\n    case types.SET_X_DOMAIN:\n      return DomainActions.setXDomain(draft, action.xDomain);\n\n    case types.SET_Y_DOMAIN:\n      return DomainActions.setYDomain(draft, action.yDomain);\n\n    case types.SET_WIDTH:\n      return setWidth(draft, action.width);\n\n    case types.SET_DIMENSIONS:\n      return handleSetDimensions(draft, action.width, action.height);\n\n    case types.SET_SELECTED_TOOL:\n      return ToolsActions.setSelectedTool(draft, action);\n    case types.RESET_SELECTED_TOOL:\n      return ToolsActions.resetSelectedTool(draft);\n    case types.SET_SELECTED_OPTIONS_PANEL:\n      return ToolsActions.setSelectedOptionPanel(\n        draft,\n        action.selectedOptionPanel,\n      );\n    case types.FULL_ZOOM_OUT:\n      return ToolsActions.zoomOut(draft, action);\n    case types.SHIFT_SPECTRUM:\n      return FiltersActions.shiftSpectrumAlongXAxis(draft, action.shiftValue);\n    case types.APPLY_ZERO_FILLING_FILTER:\n      return FiltersActions.applyZeroFillingFilter(draft, action.value);\n    case types.APPLY_FFT_FILTER:\n      return FiltersActions.applyFFTFilter(draft);\n    case types.APPLY_MANUAL_PHASE_CORRECTION_FILTER:\n      return FiltersActions.applyManualPhaseCorrectionFilter(\n        draft,\n        action.value,\n      );\n    case types.APPLY_AUTO_PHASE_CORRECTION_FILTER:\n      return FiltersActions.applyAutoPhaseCorrectionFilter(draft);\n    case types.APPLY_ABSOLUTE_FILTER:\n      return FiltersActions.applyAbsoluteFilter(draft);\n    case types.CALCULATE_MANUAL_PHASE_CORRECTION_FILTER:\n      return FiltersActions.calculateManualPhaseCorrection(draft, action.value);\n    case types.ENABLE_FILTER:\n      return FiltersActions.enableFilter(draft, action.id, action.checked);\n    case types.DELETE_FILTER:\n      return FiltersActions.deleteFilter(draft, action);\n    case types.DELETE_SPECTRA_FILTER:\n      return FiltersActions.deleteSpectraFilter(draft, action);\n    case types.SET_FILTER_SNAPSHOT:\n      return FiltersActions.filterSnapshotHandler(draft, action);\n    case types.APPLY_MULTIPLE_SPECTRA_FILTER:\n      return FiltersActions.handleMultipleSpectraFilter(draft, action);\n    case types.ADD_EXCLUSION_ZONE:\n      return FiltersActions.handleAddExclusionZone(draft, action);\n    case types.DELETE_EXCLUSION_ZONE:\n      return FiltersActions.handleDeleteExclusionZone(draft, action);\n\n    case types.CHANGE_VISIBILITY:\n      return SpectrumsActions.handleSpectrumVisibility(draft, action);\n\n    case types.CHANGE_PEAKS_MARKERS_VISIBILITY:\n      return SpectrumsActions.handleChangePeaksMarkersVisibility(\n        draft,\n        action.data,\n      );\n    case types.CHANGE_ACTIVE_SPECTRUM:\n      return SpectrumsActions.handleChangeActiveSpectrum(draft, action.data);\n    case types.CHANGE_SPECTRUM_COLOR:\n      return SpectrumsActions.handleChangeSpectrumColor(draft, action.data);\n    case types.CHANGE_SPECTRUM_SETTING:\n      return SpectrumsActions.changeSpectrumSetting(draft, action);\n    case types.ALIGN_SPECTRA:\n      return SpectrumsActions.alignSpectraHandler(draft, action);\n    case types.DELETE_SPECTRA:\n      return SpectrumsActions.handleDeleteSpectra(draft, action);\n    case types.ADD_MISSING_PROJECTION:\n      return SpectrumsActions.addMissingProjectionHandler(draft, action);\n    case types.GENERATE_SPECTRUM_FROM_PUBLICATION_STRING:\n      return SpectrumsActions.generateSpectrumFromPublicationStringHandler(\n        draft,\n        action,\n      );\n\n    case types.TOGGLE_REAL_IMAGINARY_VISIBILITY:\n      return ToolsActions.handleToggleRealImaginaryVisibility(draft);\n    case types.SET_ZOOM:\n      return ToolsActions.handleZoom(draft, action);\n    case types.SET_SPECTRA_SAME_TOP:\n      return ToolsActions.setSpectraSameTopHandler(draft);\n    case types.RESET_SPECTRA_SCALE:\n      return ToolsActions.resetSpectraScale(draft);\n\n    case types.CHANGE_SPECTRUM_DISPLAY_VIEW_MODE:\n      return ToolsActions.handleChangeSpectrumDisplayMode(draft);\n\n    case types.ADD_MOLECULE:\n      return MoleculeActions.addMoleculeHandler(draft, action.molfile);\n\n    case types.SET_MOLECULE:\n      return MoleculeActions.setMoleculeHandler(\n        draft,\n        action.molfile,\n        action.key,\n      );\n\n    case types.DELETE_MOLECULE:\n      return MoleculeActions.deleteMoleculeHandler(draft, action);\n\n    case types.PREDICT_SPECTRA:\n      return MoleculeActions.predictSpectraFromMoleculeHandler(draft, action);\n\n    case types.FLOAT_MOLECULE_OVER_SPECTRUM:\n      return MoleculeActions.floatMoleculeOverSpectrum(draft, action);\n\n    case types.SET_CORRELATIONS_MF:\n      return CorrelationsActions.handleSetMF(draft, action.payload);\n\n    case types.SET_CORRELATIONS_TOLERANCE:\n      return CorrelationsActions.handleSetTolerance(draft, action.payload);\n\n    case types.SET_CORRELATION:\n      return CorrelationsActions.handleSetCorrelation(draft, action.payload);\n\n    case types.SET_CORRELATIONS:\n      return CorrelationsActions.handleSetCorrelations(draft, action.payload);\n\n    case types.DELETE_CORRELATION:\n      return CorrelationsActions.handleDeleteCorrelation(draft, action.payload);\n\n    case types.BRUSH_END:\n      return ToolsActions.handleBrushEnd(draft, action);\n\n    case types.SET_VERTICAL_INDICATOR_X_POSITION:\n      return ToolsActions.setVerticalIndicatorXPosition(draft, action.position);\n    case types.SET_SPECTRUMS_VERTICAL_ALIGN:\n      return ToolsActions.setSpectrumsVerticalAlign(draft);\n\n    case types.AUTO_PEAK_PICKING:\n      return PeaksActions.handleAutoPeakPicking(draft, action.options);\n\n    case types.AUTO_ZONES_DETECTION:\n      return ZonesActions.handleAutoZonesDetection(draft, action.options);\n    case types.CHANGE_ZONES_NOISE_FACTOR:\n      return ZonesActions.changeZonesFactorHandler(draft, action);\n    case types.AUTO_RANGES_DETECTION:\n      return RangesActions.handleAutoRangesDetection(draft, action.options);\n    case types.ADD_RANGE:\n      return RangesActions.handleAddRange(draft, action);\n    case types.DELETE_RANGE:\n      return RangesActions.handleDeleteRange(draft, action);\n    case types.DELETE_1D_SIGNAL:\n      return RangesActions.handleDeleteSignal(draft, action);\n    case types.RESIZE_RANGE:\n      return RangesActions.handleResizeRange(draft, action);\n    case types.CHANGE_RANGE_SUM:\n      return RangesActions.handleChangeRangeSum(draft, action.value);\n    case types.CHANGE_RANGES_SUM_FLAG:\n      return RangesActions.handleChangeRangesSumFlag(draft, action);\n    case types.CHANGE_RANGE_RELATIVE:\n      return RangesActions.handleChangeRangeRelativeValue(draft, action);\n    case types.CHANGE_RANGE_SIGNAL_VALUE:\n      return RangesActions.handleChangeRangeSignalValue(draft, action);\n    case types.CHANGE_RANGE_SIGNAL_KIND:\n      return RangesActions.handleChangeRangeSignalKind(draft, action);\n    case types.SAVE_EDITED_RANGE:\n      return RangesActions.handleSaveEditedRange(draft, action);\n    case types.UNLINK_RANGE:\n      return RangesActions.handleUnlinkRange(draft, action);\n    case types.SET_DIAID_RANGE:\n      return RangesActions.handleSetDiaIDRange(draft, action);\n    case types.CHANGE_TEMP_RANGE:\n      return RangesActions.handleChangeTempRange(draft, action);\n    case types.SHOW_MULTIPLICTY_TREES:\n      return RangesActions.handleShowMultiplicityTrees(draft);\n    case types.SHOW_RANGES_INTEGRALS:\n      return RangesActions.handleShowRangesIntegrals(draft);\n    case types.AUTO_RANGES_SPECTRA_PICKING:\n      return RangesActions.handleAutoSpectraRangesDetection(draft);\n    case types.SHOW_J_GRAPH:\n      return RangesActions.handleShowJGraph(draft);\n\n    case types.SET_ACTIVE_TAB:\n      return ToolsActions.handelSetActiveTab(draft, action.tab);\n    case types.ADD_BASE_LINE_ZONE:\n      return ToolsActions.handleAddBaseLineZone(draft, action.zone);\n    case types.DELETE_BASE_LINE_ZONE:\n      return ToolsActions.handleDeleteBaseLineZone(draft, action.id);\n\n    case types.APPLY_BASE_LINE_CORRECTION_FILTER:\n      return FiltersActions.handleBaseLineCorrectionFilter(draft, action);\n    case types.SET_KEY_PREFERENCES:\n      return setKeyPreferencesHandler(draft, action.keyCode);\n    case types.APPLY_KEY_PREFERENCES:\n      return applyKeyPreferencesHandler(draft, action.keyCode);\n    case types.SET_2D_LEVEL:\n      return ToolsActions.levelChangeHandler(draft, action);\n    case types.ADD_2D_ZONE:\n      return ZonesActions.add2dZoneHandler(draft, action);\n    case types.DELETE_2D_ZONE:\n      return ZonesActions.handleDeleteZone(draft, action);\n    case types.DELETE_2D_SIGNAL:\n      return ZonesActions.handleDeleteSignal(draft, action);\n    case types.SET_2D_SIGNAL_PATH_LENGTH:\n      return ZonesActions.handleSetSignalPathLength(draft, action);\n    case types.RESET_DOMAIN:\n      return DomainActions.handelResetDomain(draft);\n    case types.CHANGE_ZONE_SIGNAL_VALUE:\n      return ZonesActions.changeZoneSignalDelta(draft, action);\n    case types.CHANGE_ZONE_SIGNAL_KIND:\n      return ZonesActions.handleChangeZoneSignalKind(draft, action);\n    case types.UNLINK_ZONE:\n      return ZonesActions.handleUnlinkZone(draft, action);\n    case types.SET_DIAID_ZONE:\n      return ZonesActions.handleSetDiaIDZone(draft, action);\n    case types.AUTO_ZONES_SPECTRA_PICKING:\n      return ZonesActions.handleAutoSpectraZonesDetection(draft);\n    case types.SAVE_EDITED_ZONE:\n      return ZonesActions.handleSaveEditedZone(draft, action);\n\n    case types.ANALYZE_SPECTRA:\n      return SpectraAnalysisActions.analyzeSpectra(draft, action);\n    case types.DELETE_ANALYZE_SPECTRA_RANGE:\n      return SpectraAnalysisActions.handleDeleteSpectraRanges(draft, action);\n    case types.RESIZE_ANALYZE_SPECTRA_RANGE:\n      return SpectraAnalysisActions.handleResizeSpectraRange(draft, action);\n    case types.SET_ANALYZE_SPECTRA_COLUMNS:\n      return SpectraAnalysisActions.handleSetColumns(draft, action);\n    case types.FILTER_SPECTRA_COLUMN:\n      return SpectraAnalysisActions.handleFilterColumn(draft, action);\n\n    case types.RESURRECTING_SPECTRUM_FROM_RANGES:\n      return DatabaseActions.handleRangeResurrecting(draft, action);\n\n    case types.SET_AUTOMATIC_ASSIGNMENTS:\n      return AssignmentsActions.setAutomaticAssignmentsHandler(draft, action);\n\n    case UNDO:\n      return handleHistoryUndo(draft);\n\n    case REDO:\n      return handleHistoryRedo(draft);\n\n    case RESET:\n      return handleHistoryReset(draft, action);\n\n    case types.SET_MOUSE_OVER_DISPLAYER:\n      return GlobalActions.setIsOverDisplayer(draft, action);\n\n    default:\n      return;\n  }\n}\n\nexport const spectrumReducer = produce(innerSpectrumReducer);\n","import { createContext, useContext } from 'react';\n\nimport { initialState, State } from '../reducer/Reducer';\n\nexport const ChartContext = createContext<State>(initialState);\nexport const ChartDataProvider = ChartContext.Provider;\n\nexport function useChartData() {\n  return useContext(ChartContext);\n}\n","import { createContext, useContext } from 'react';\n\nexport const dispatchContext = createContext<any>({});\n\nexport const DispatchProvider = dispatchContext.Provider;\n\nexport function useDispatch() {\n  return useContext(dispatchContext);\n}\n","import { useMemo } from 'react';\n\nimport { Datum1D } from '../../data/types/data1d';\nimport { Datum2D } from '../../data/types/data2d';\nimport { useChartData } from '../context/ChartContext';\n\nexport default function useSpectrum(defaultValue: any) {\n  const { data, activeSpectrum } = useChartData();\n\n  return useMemo<Datum1D | Datum2D>(() => {\n    if (data && activeSpectrum && activeSpectrum.id) {\n      const datum =\n        data.find((datum) => datum.id === activeSpectrum.id) || defaultValue;\n      return datum;\n    }\n    return defaultValue;\n  }, [activeSpectrum, data, defaultValue]);\n}\n","import { createContext, useContext } from 'react';\n\nfunction defaultLoader() {\n  // Empty\n}\n\nconst LoaderContext = createContext<() => void>(defaultLoader);\n\nexport const LoaderProvider = LoaderContext.Provider;\n\nexport function useLoader() {\n  return useContext(LoaderContext);\n}\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { ReactNode } from 'react';\n\nimport { useLoader } from '../context/LoaderContext';\n\nconst styles = css`\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background-color: rgba(255, 255, 255, 0.25);\n  flex-direction: column;\n  user-select: none;\n  width: 100%;\n  height: 100%;\n  outline: 10px dashed rgba(0, 0, 0, 0.3);\n  outline-offset: -10px;\n  padding-left: 20px;\n  padding-right: 20px;\n\n  p {\n    padding: 15px 30px;\n    background-color:rgba(0, 0, 0, 0.5);\n    border-radius: 39px;\n    color: white;\n    font-size: x-large;\n    font-weight: bold;\n\n  }\n}\n`;\n\ninterface NoDataProps {\n  isEmpty?: boolean;\n  canOpenLoader?: boolean;\n  emptyText?: ReactNode;\n}\n\nfunction NoData({\n  isEmpty = true,\n  emptyText = 'Drag and drop here a JCAMP-DX, zipped Bruker folder, Jeol jdf or NMRium file',\n  canOpenLoader = true,\n}: NoDataProps) {\n  const openLoader = useLoader();\n\n  if (!isEmpty) {\n    return null;\n  }\n\n  return (\n    <div css={styles} {...(canOpenLoader && { onClick: openLoader })}>\n      <p>{emptyText}</p>\n    </div>\n  );\n}\n\nexport default NoData;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\n\nconst styles = css`\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background-color: rgba(255, 255, 255, 0.25);\n  height: 100%;\n  flex-direction: column;\n  user-select: none;\n  position: absolute;\n  width: 100%;\n\n  svg {\n    animation-duration: 0.5s;\n    animation-name: spinAnimation;\n    animation-iteration-count: infinite;\n    animation-fill-mode: forwards;\n    animation-direction: inherit;\n    animation-timing-function: linear;\n    animation-duration: 1s;\n    width: 100px;\n    height: 100px;\n  }\n\n  @keyframes spinAnimation {\n    from {\n      transform: rotate(0deg);\n    }\n\n    to {\n      transform: rotate(360deg);\n    }\n  }\n`;\n\nexport default function DefaultSpinnerComponent() {\n  return (\n    <div css={styles}>\n      <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 841.9 595.3\">\n        <g fill=\"#61DAFB\">\n          <path d=\"M666.3 296.5c0-32.5-40.7-63.3-103.1-82.4 14.4-63.6 8-114.2-20.2-130.4-6.5-3.8-14.1-5.6-22.4-5.6v22.3c4.6 0 8.3.9 11.4 2.6 13.6 7.8 19.5 37.5 14.9 75.7-1.1 9.4-2.9 19.3-5.1 29.4-19.6-4.8-41-8.5-63.5-10.9-13.5-18.5-27.5-35.3-41.6-50 32.6-30.3 63.2-46.9 84-46.9V78c-27.5 0-63.5 19.6-99.9 53.6-36.4-33.8-72.4-53.2-99.9-53.2v22.3c20.7 0 51.4 16.5 84 46.6-14 14.7-28 31.4-41.3 49.9-22.6 2.4-44 6.1-63.6 11-2.3-10-4-19.7-5.2-29-4.7-38.2 1.1-67.9 14.6-75.8 3-1.8 6.9-2.6 11.5-2.6V78.5c-8.4 0-16 1.8-22.6 5.6-28.1 16.2-34.4 66.7-19.9 130.1-62.2 19.2-102.7 49.9-102.7 82.3 0 32.5 40.7 63.3 103.1 82.4-14.4 63.6-8 114.2 20.2 130.4 6.5 3.8 14.1 5.6 22.5 5.6 27.5 0 63.5-19.6 99.9-53.6 36.4 33.8 72.4 53.2 99.9 53.2 8.4 0 16-1.8 22.6-5.6 28.1-16.2 34.4-66.7 19.9-130.1 62-19.1 102.5-49.9 102.5-82.3zm-130.2-66.7c-3.7 12.9-8.3 26.2-13.5 39.5-4.1-8-8.4-16-13.1-24-4.6-8-9.5-15.8-14.4-23.4 14.2 2.1 27.9 4.7 41 7.9zm-45.8 106.5c-7.8 13.5-15.8 26.3-24.1 38.2-14.9 1.3-30 2-45.2 2-15.1 0-30.2-.7-45-1.9-8.3-11.9-16.4-24.6-24.2-38-7.6-13.1-14.5-26.4-20.8-39.8 6.2-13.4 13.2-26.8 20.7-39.9 7.8-13.5 15.8-26.3 24.1-38.2 14.9-1.3 30-2 45.2-2 15.1 0 30.2.7 45 1.9 8.3 11.9 16.4 24.6 24.2 38 7.6 13.1 14.5 26.4 20.8 39.8-6.3 13.4-13.2 26.8-20.7 39.9zm32.3-13c5.4 13.4 10 26.8 13.8 39.8-13.1 3.2-26.9 5.9-41.2 8 4.9-7.7 9.8-15.6 14.4-23.7 4.6-8 8.9-16.1 13-24.1zM421.2 430c-9.3-9.6-18.6-20.3-27.8-32 9 .4 18.2.7 27.5.7 9.4 0 18.7-.2 27.8-.7-9 11.7-18.3 22.4-27.5 32zm-74.4-58.9c-14.2-2.1-27.9-4.7-41-7.9 3.7-12.9 8.3-26.2 13.5-39.5 4.1 8 8.4 16 13.1 24 4.7 8 9.5 15.8 14.4 23.4zM420.7 163c9.3 9.6 18.6 20.3 27.8 32-9-.4-18.2-.7-27.5-.7-9.4 0-18.7.2-27.8.7 9-11.7 18.3-22.4 27.5-32zm-74 58.9c-4.9 7.7-9.8 15.6-14.4 23.7-4.6 8-8.9 16-13 24-5.4-13.4-10-26.8-13.8-39.8 13.1-3.1 26.9-5.8 41.2-7.9zm-90.5 125.2c-35.4-15.1-58.3-34.9-58.3-50.6 0-15.7 22.9-35.6 58.3-50.6 8.6-3.7 18-7 27.7-10.1 5.7 19.6 13.2 40 22.5 60.9-9.2 20.8-16.6 41.1-22.2 60.6-9.9-3.1-19.3-6.5-28-10.2zM310 490c-13.6-7.8-19.5-37.5-14.9-75.7 1.1-9.4 2.9-19.3 5.1-29.4 19.6 4.8 41 8.5 63.5 10.9 13.5 18.5 27.5 35.3 41.6 50-32.6 30.3-63.2 46.9-84 46.9-4.5-.1-8.3-1-11.3-2.7zm237.2-76.2c4.7 38.2-1.1 67.9-14.6 75.8-3 1.8-6.9 2.6-11.5 2.6-20.7 0-51.4-16.5-84-46.6 14-14.7 28-31.4 41.3-49.9 22.6-2.4 44-6.1 63.6-11 2.3 10.1 4.1 19.8 5.2 29.1zm38.5-66.7c-8.6 3.7-18 7-27.7 10.1-5.7-19.6-13.2-40-22.5-60.9 9.2-20.8 16.6-41.1 22.2-60.6 9.9 3.1 19.3 6.5 28.1 10.2 35.4 15.1 58.3 34.9 58.3 50.6-.1 15.7-23 35.6-58.4 50.6zM320.8 78.4z\" />\n          <path d=\"M520.5 78.1z\" />\n        </g>\n      </svg>\n      <p>Loading ...</p>\n    </div>\n  );\n}\n","import { createContext, ReactElement } from 'react';\n\nimport DefaultSpinnerComponent from './DefaultSpinnerComponent';\n\nexport function defaultGetSpinner() {\n  return <DefaultSpinnerComponent />;\n}\n\nexport const spinnerContext =\n  createContext<() => ReactElement>(defaultGetSpinner);\n\nexport const SpinnerProvider = spinnerContext.Provider;\n","import { useState, Fragment, useEffect, useContext, ReactNode } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\n\nimport NoData from './NoData';\nimport { spinnerContext } from './SpinnerContext';\n\ninterface SpinnerProps {\n  isLoading?: boolean;\n  emptyText?: ReactNode;\n}\n\nfunction Spinner({ isLoading = true, emptyText = undefined }: SpinnerProps) {\n  const { data } = useChartData();\n  const [checkEmpty, startCheckEmpty] = useState(false);\n\n  useEffect(() => {\n    let timeout: any = null;\n    if (!isLoading) {\n      timeout = setTimeout(() => {\n        startCheckEmpty(true);\n      }, 500);\n    }\n    return () => {\n      clearTimeout(timeout);\n    };\n  }, [isLoading]);\n\n  const getSpinner = useContext(spinnerContext);\n\n  return (\n    <Fragment>\n      {isLoading && getSpinner()}\n      {checkEmpty && !isLoading && (\n        <NoData isEmpty={data && data.length === 0} emptyText={emptyText} />\n      )}\n    </Fragment>\n  );\n}\n\nexport default Spinner;\n","import { CSSProperties, useContext } from 'react';\n\nimport { BrushContext } from '../EventsTrackers/BrushTracker';\nimport { useChartData } from '../context/ChartContext';\nimport { options } from '../toolbar/ToolTypes';\n\nconst styles: Record<'container', CSSProperties> = {\n  container: {\n    transformOrigin: 'top left',\n    position: 'absolute',\n    top: '0px',\n    left: '0px',\n    zoom: '100%',\n  },\n};\n\nconst allowTools: Array<string | number> = [\n  options.zoom.id,\n  options.zeroFilling.id,\n  options.peakPicking.id,\n  options.integral.id,\n  options.phaseCorrection.id,\n  options.baseLineCorrection.id,\n  options.rangesPicking.id,\n  options.zone2D.id,\n  options.slicingTool.id,\n  options.editRange.id,\n  options.multipleSpectraAnalysis.id,\n  options.exclusionZones.id,\n  options.databaseRangesSelection.id,\n];\n\nexport const BRUSH_TYPE = {\n  X: 1,\n  Y: 2,\n  XY: 3,\n};\n\nconst defaultDimensionBorder: {\n  startX: number;\n  startY: number;\n  endX?: number;\n  endY?: number;\n} = {\n  startX: 0,\n  startY: 0,\n};\n\ninterface BrushXYProps {\n  brushType: number;\n  dimensionBorder?: {\n    startX: number;\n    startY: number;\n    endX?: number;\n    endY?: number;\n  };\n  width?: number;\n  height?: number;\n}\n\nexport default function BrushXY({\n  brushType = BRUSH_TYPE.XY,\n  dimensionBorder = defaultDimensionBorder,\n  width: widthProps,\n  height: heightProps,\n}: BrushXYProps) {\n  let {\n    width,\n    height,\n    toolOptions: { selectedTool },\n  } = useChartData();\n  let { startX, endX, startY, endY, step } = useContext(BrushContext);\n\n  if (\n    !allowTools.includes(selectedTool) ||\n    step !== 'brushing' ||\n    !dimensionBorder ||\n    (dimensionBorder.startX && startX < dimensionBorder.startX) ||\n    (dimensionBorder.startY && startY < dimensionBorder.startY) ||\n    ((dimensionBorder.endX && Math.sign(endX - startX) === 1\n      ? endX > dimensionBorder.endX\n      : endX < dimensionBorder.startX) &&\n      (dimensionBorder.endX &&\n      dimensionBorder.endY &&\n      Math.sign(endY - startY) === 1\n        ? endY > dimensionBorder.endY\n        : endY < dimensionBorder.startY))\n  ) {\n    return null;\n  }\n\n  width = widthProps ? widthProps : width;\n\n  height = heightProps ? heightProps : height;\n\n  endX =\n    dimensionBorder.endX && endX > dimensionBorder.endX\n      ? dimensionBorder.endX\n      : dimensionBorder.startX && endX < dimensionBorder.startX\n      ? dimensionBorder.startX\n      : endX;\n  endY =\n    dimensionBorder.endY && endY > dimensionBorder.endY\n      ? dimensionBorder.endY\n      : dimensionBorder.startY && endY < dimensionBorder.startY\n      ? dimensionBorder.startY\n      : endY;\n\n  const scaleX =\n    brushType === BRUSH_TYPE.X || brushType === BRUSH_TYPE.XY\n      ? (endX - startX) / width\n      : 1;\n  startX =\n    brushType === BRUSH_TYPE.X || brushType === BRUSH_TYPE.XY ? startX : 0;\n\n  const scaleY =\n    brushType === BRUSH_TYPE.Y || brushType === BRUSH_TYPE.XY\n      ? (endY - startY) / height\n      : 1;\n  startY =\n    brushType === BRUSH_TYPE.Y || brushType === BRUSH_TYPE.XY ? startY : 0;\n  return (\n    <div\n      style={{\n        ...styles.container,\n        transform: `translate(${startX}px, ${startY}px) scale(${scaleX},${scaleY})`,\n        willChange: 'transform',\n      }}\n    >\n      <svg width={width} height={height}>\n        <rect\n          x=\"0\"\n          y=\"0\"\n          width={width}\n          height={height}\n          fill=\"gray\"\n          opacity=\"0.2\"\n        />\n      </svg>\n    </div>\n  );\n}\n","import { CSSProperties, useContext } from 'react';\n\nimport { BrushContext } from '../EventsTrackers/BrushTracker';\nimport { MouseContext } from '../EventsTrackers/MouseTracker';\nimport { useChartData } from '../context/ChartContext';\nimport { options } from '../toolbar/ToolTypes';\n\nconst styles: Record<'line', CSSProperties> = {\n  line: {\n    stroke: 'black',\n    strokeOpacity: 1,\n    shapeRendering: 'crispEdges',\n    strokeWidth: '1',\n    willChange: 'transform',\n  },\n};\n\nconst allowTools: Array<string | number> = [\n  options.zoom.id,\n  options.equalizerTool.id,\n  options.baseLineCorrection.id,\n  options.zone2D.id,\n  options.slicingTool.id,\n  options.integral.id,\n  options.rangesPicking.id,\n  options.editRange.id,\n  options.multipleSpectraAnalysis.id,\n  options.exclusionZones.id,\n  options.databaseRangesSelection.id,\n];\n\nfunction CrossLinePointer() {\n  const {\n    height,\n    width,\n    margin,\n    toolOptions: { selectedTool },\n  } = useChartData();\n  let position = useContext(MouseContext);\n  const brushState = useContext(BrushContext);\n\n  if (\n    !allowTools.includes(selectedTool) ||\n    brushState.step === 'brushing' ||\n    !position ||\n    position.x > width - margin.right ||\n    position.y > height - margin.bottom ||\n    !width ||\n    !height\n  ) {\n    return null;\n  }\n  return (\n    <div\n      key=\"crossLine\"\n      style={{\n        willChange: 'transform',\n        cursor: 'crosshair',\n        transform: `translate(${-width + position.x}px, ${\n          -height + position.y\n        }px)`,\n        position: 'absolute',\n        top: 0,\n        left: 0,\n        pointerEvents: 'none',\n        overflow: 'visible',\n        width: 2 * width,\n        height: 2 * height,\n      }}\n    >\n      <svg width={2 * width} height={2 * height}>\n        <line\n          style={styles.line}\n          x1={width}\n          y1=\"0\"\n          x2={width}\n          y2={height * 2}\n          key=\"vertical_line\"\n        />\n        <line\n          style={styles.line}\n          x1=\"0\"\n          y1={height}\n          x2={width * 2}\n          y2={height}\n          key=\"horizontal_line\"\n        />\n      </svg>\n    </div>\n  );\n}\n\nexport default CrossLinePointer;\n","import { createContext, useContext } from 'react';\n\nexport const GlobalConetxt = createContext<{\n  rootRef: HTMLDivElement | null;\n  elementsWrapperRef: HTMLDivElement | null;\n  viewerRef: HTMLDivElement | null;\n}>({ rootRef: null, elementsWrapperRef: null, viewerRef: null });\n\nexport const GlobalProvider = GlobalConetxt.Provider;\n\nexport function useGlobal() {\n  return useContext(GlobalConetxt);\n}\n","import { useCallback, useMemo, useRef, useState } from 'react';\n\nexport interface Position {\n  x: number;\n  y: number;\n}\n\ninterface UseDraggable {\n  position: Position;\n  parentElement?: HTMLElement | null;\n  fromEdge?: boolean;\n  dragHandleClassName?: string;\n}\nexport interface Draggable {\n  onMouseDown: (\n    event: React.MouseEvent<HTMLDivElement | SVGElement, MouseEvent>,\n  ) => void;\n  position: { value: Position; action: Action };\n  isActive: boolean;\n}\ntype Action = 'start' | 'move' | 'end' | null;\n\nexport default function useDraggable(props: UseDraggable): Draggable {\n  const {\n    position: { x, y },\n    parentElement,\n    fromEdge = false,\n    dragHandleClassName,\n  } = props;\n\n  const isActive = useRef<boolean>(false);\n  const positionRef = useRef<Position>({ x, y });\n  const [position, setPosition] = useState<{ value: Position; action: Action }>(\n    {\n      value: { x, y },\n      action: null,\n    },\n  );\n\n  const onMouseDown = useCallback(\n    (e: React.MouseEvent<HTMLDivElement | SVGElement, MouseEvent>) => {\n      e.stopPropagation();\n      isActive.current = true;\n      const eventTarget = e.currentTarget as HTMLElement;\n\n      const classes =\n        (e.target as HTMLElement).getAttribute('class')?.split(' ') || [];\n      if (\n        (dragHandleClassName && classes.includes(dragHandleClassName)) ||\n        !dragHandleClassName\n      ) {\n        const _parentElement = parentElement\n          ? parentElement\n          : eventTarget?.parentElement;\n        if (_parentElement) {\n          const parentBounding = _parentElement.getBoundingClientRect();\n          const currentBounding = eventTarget?.getBoundingClientRect();\n          const startPosition: Position = {\n            x:\n              parentBounding.x +\n              (!fromEdge ? e.clientX - currentBounding.x : 0),\n            y:\n              parentBounding.y +\n              (!fromEdge ? e.clientY - currentBounding.y : 0),\n          };\n\n          if (parentBounding) {\n            positionRef.current = startPosition;\n          }\n          setPosition((prevPortion) => ({ ...prevPortion, action: 'start' }));\n        }\n\n        window.addEventListener('mousemove', onMouseMove);\n        window.addEventListener('mouseup', onMouseUp);\n      }\n\n      function onMouseUp(e: MouseEvent) {\n        e.stopPropagation();\n        if (isActive.current) {\n          setPosition({\n            value: {\n              x: e.clientX - positionRef.current.x,\n              y: e.clientY - positionRef.current.y,\n            },\n            action: 'end',\n          });\n          isActive.current = false;\n        }\n\n        window.removeEventListener('mousemove', onMouseMove);\n        window.removeEventListener('mouseup', onMouseUp);\n      }\n      function onMouseMove(e: MouseEvent) {\n        e.stopPropagation();\n\n        if (isActive.current) {\n          setPosition({\n            value: {\n              x: e.clientX - positionRef.current.x,\n              y: e.clientY - positionRef.current.y,\n            },\n            action: 'move',\n          });\n        }\n      }\n    },\n    [dragHandleClassName, fromEdge, parentElement],\n  );\n\n  return useMemo(\n    () => ({\n      onMouseDown,\n      position,\n      isActive: isActive.current,\n    }),\n    [onMouseDown, position],\n  );\n}\n","import { useEffect, ReactFragment } from 'react';\n\nimport useDraggable, { Position } from './useDraggable';\n\ntype ChildType =\n  | Array<React.ReactElement>\n  | React.ReactElement\n  | ReactFragment\n  | boolean\n  | null;\n\ntype PositionChangeHandler = (data: Position) => void;\n\nexport interface DraggableProps {\n  children?: ChildType | ((x1: number, x2: number) => ChildType);\n  initialPosition?: Position;\n  width: number;\n  height: number;\n  onStart?: PositionChangeHandler;\n  onMove?: PositionChangeHandler;\n  onEnd?: PositionChangeHandler;\n  parentElement?: HTMLElement | null;\n  dragHandleClassName?: string;\n}\n\nexport default function SVGDraggable(props: DraggableProps) {\n  const {\n    children,\n    initialPosition = { x: 0, y: 0 },\n    width,\n    height,\n    onStart,\n    onMove,\n    onEnd,\n    parentElement,\n    dragHandleClassName,\n  } = props;\n\n  const {\n    position: {\n      value: { x, y },\n      action,\n    },\n    onMouseDown,\n  } = useDraggable({\n    position: initialPosition,\n    parentElement,\n    dragHandleClassName,\n  });\n\n  useEffect(() => {\n    const position: Position = {\n      x,\n      y,\n    };\n\n    switch (action) {\n      case 'start':\n        onStart?.(position);\n        break;\n      case 'move':\n        onMove?.(position);\n        break;\n      case 'end':\n        onEnd?.(position);\n        break;\n      default:\n        break;\n    }\n  }, [action, onEnd, onMove, onStart, x, y]);\n\n  return (\n    <g\n      style={{\n        transform: `translate(${x}px,${y}px)`,\n      }}\n      onMouseDown={onMouseDown}\n    >\n      {typeof children === 'function' ? children(width, height) : children}\n    </g>\n  );\n}\n","export const ConcatenationString = '___';\n\nexport function buildID(prefix: string, suffix: string): string {\n  return `${prefix}${ConcatenationString}${suffix}`;\n}\n","import { createContext, useCallback, useContext, useMemo } from 'react';\n\nimport { AssignmentsActions } from './AssignmentsReducer';\n\nexport type Axis = 'x' | 'y';\nexport type Assignment = Record<Axis, string[]>;\nexport type Assignments = Record<string, Assignment>;\n\nexport type AssignmentDimension = '1D' | '2D';\nexport interface AssignmentAction {\n  id: string;\n  axis: Axis | null;\n}\nexport interface AssignmentState {\n  assignments: Assignments;\n  activated: AssignmentAction | null;\n  highlighted: AssignmentAction | null;\n}\nexport interface AssignmentContext {\n  data: AssignmentState;\n  dispatch: (action: AssignmentsActions) => void;\n}\n\nexport interface AssignmentsData\n  extends Pick<AssignmentState, 'activated' | 'highlighted'> {\n  id: string;\n  isActive: boolean;\n  isOver: boolean;\n  assigned: Record<Axis, string[]>;\n  removeAll: (axis: Axis) => void;\n  toggle: (atomIDs: string[], dimension: AssignmentDimension) => void;\n  setActive: (axis: Axis) => void;\n  show: (axis?: Axis) => void;\n  hide: () => void;\n}\n\nexport const assignmentState: AssignmentState = {\n  assignments: {},\n  activated: null,\n  highlighted: null,\n};\n\nexport const assignmentContext = createContext<AssignmentContext>({\n  data: assignmentState,\n  dispatch: () => null,\n});\n\nexport const AssignmentProvider = assignmentContext.Provider;\n\nexport function useAssignmentData() {\n  const context = useContext(assignmentContext);\n\n  if (!context) {\n    throw new Error('Assignment context was not found');\n  }\n\n  return context;\n}\n\n// key can be signal id,range id or zone id\nexport function useAssignment(key): AssignmentsData {\n  const {\n    data: { activated, highlighted, assignments },\n    dispatch,\n  } = useAssignmentData();\n\n  if ((typeof key !== 'string' && typeof key !== 'number') || key === '') {\n    throw new Error(`assignment key must be a non-empty string or number`);\n  }\n  const id = String(key);\n\n  const isActive = useMemo(() => {\n    return activated?.id === id;\n  }, [activated?.id, id]);\n  const isOver = useMemo(() => {\n    return highlighted?.id === id;\n  }, [highlighted?.id, id]);\n\n  const assigned = useMemo(() => {\n    return assignments[id] || null;\n  }, [assignments, id]);\n\n  const removeAll = useCallback(\n    (axis: Axis) => {\n      dispatch({\n        type: 'REMOVE',\n        payload: { ids: [id], axis },\n      });\n    },\n    [dispatch, id],\n  );\n\n  const toggle = useCallback(\n    (atomIDs: string[], dimension: AssignmentDimension) => {\n      dispatch({\n        type: 'TOGGLE',\n        payload: { atomIDs, id, dimension },\n      });\n    },\n    [dispatch, id],\n  );\n\n  const setActive = useCallback(\n    (axis: Axis) => {\n      dispatch({\n        type: 'SET_ACTIVE',\n        payload: {\n          id,\n          axis,\n        },\n      });\n    },\n    [dispatch, id],\n  );\n\n  const show = useCallback(\n    (axis?: Axis) => {\n      dispatch({\n        type: 'SHOW',\n        payload: {\n          id,\n          axis,\n        },\n      });\n    },\n    [dispatch, id],\n  );\n  const hide = useCallback(() => {\n    dispatch({\n      type: 'HIDE',\n    });\n  }, [dispatch]);\n\n  return {\n    id,\n    activated,\n    isActive,\n    isOver,\n    highlighted,\n    assigned,\n    removeAll,\n    toggle,\n    setActive,\n    show,\n    hide,\n  };\n}\n","import { AssignmentContext } from '../AssignmentsContext';\n\nexport function filterForIDsWithAssignment(\n  assignmentData: AssignmentContext,\n  ids: string[],\n) {\n  return ids.filter((id) =>\n    Object.keys(assignmentData.data).filter((_id) => _id === id),\n  );\n}\n","export const positions = {\n  TOP_LEFT: 'top left',\n  TOP_CENTER: 'top center',\n  TOP_RIGHT: 'top right',\n  MIDDLE_LEFT: 'middle left',\n  MIDDLE: 'middle',\n  MIDDLE_RIGHT: 'middle right',\n  BOTTOM_LEFT: 'bottom left',\n  BOTTOM_CENTER: 'bottom center',\n  BOTTOM_RIGHT: 'bottom right',\n};\n\nexport const types = {\n  INFO: 'info',\n  SUCCESS: 'success',\n  ERROR: 'error',\n  PROGRESS_INDICATOR: 'progress_indicator',\n};\n\nexport const transitions = {\n  FADE: 'fade',\n  SCALE: 'scale',\n  SLIDE_RIGHT: 'slide_right',\n  SLIDE_LEFT: 'slide_left',\n  SLIDE_TOP: 'slide_top',\n  SLIDE_BOTTOM: 'slide_bottom',\n};\n","import { createContext, useContext } from 'react';\n\nconst AlertContext = createContext<any>({});\n\nexport const AlertProvider = AlertContext.Provider;\n\nexport function useAlert() {\n  return useContext(AlertContext);\n}\n","import { CSSProperties, ReactNode, useRef } from 'react';\nimport { Transition as ContainerTransition } from 'react-transition-group';\n\nimport { transitions } from './options';\n\nconst duration = 250;\n\nconst defaultStyle: Record<string, CSSProperties> = {\n  [transitions.FADE]: {\n    transition: `opacity ${duration}ms ease`,\n    opacity: 0,\n  },\n  [transitions.SCALE]: {\n    transform: 'scale(1)',\n    transition: `all ${duration}ms ease-in-out`,\n  },\n};\n\ntype TransitionStyles = Record<\n  string,\n  Partial<{\n    entering: CSSProperties;\n    entered: CSSProperties;\n    exiting: CSSProperties;\n    exited: CSSProperties;\n  }>\n>;\n\nconst defaultTransitionStyles: TransitionStyles = {\n  [transitions.FADE]: {\n    entering: { opacity: 0 },\n    entered: { opacity: 1 },\n  },\n  [transitions.SCALE]: {\n    entering: { transform: 'scale(0)' },\n    entered: { transform: 'scale(1)' },\n    exiting: { transform: 'scale(0)' },\n    exited: { transform: 'scale(1)' },\n  },\n};\n\ninterface TransitionProps {\n  children: ReactNode;\n  type: string;\n  transitionStyles?: TransitionStyles;\n}\n\nexport default function Transtion({\n  children,\n  type,\n  transitionStyles = defaultTransitionStyles,\n  ...props\n}: TransitionProps) {\n  const ref = useRef(null);\n  return (\n    <ContainerTransition nodeRef={ref} {...props} timeout={duration}>\n      {(state) => (\n        <div\n          ref={ref}\n          style={{\n            ...defaultStyle[type],\n            ...transitionStyles[type][state],\n            ...transitionStyles.default,\n          }}\n        >\n          {children}\n        </div>\n      )}\n    </ContainerTransition>\n  );\n}\n","import { useMemo } from 'react';\n\nimport { positions } from './options';\n\nfunction getStyles(position, containerStyle): any {\n  const initialStyles = {\n    position: 'fixed',\n    display: 'flex',\n    justifyContent: 'center',\n    alignItems: 'center',\n    flexDirection: 'column',\n    pointerEvents: 'none',\n    overflow: 'visible',\n    ...(containerStyle\n      ? {\n          top: `${containerStyle.top}px`,\n          left: `${containerStyle.left}px`,\n          height: `${containerStyle.height}px`,\n          width: `${containerStyle.width}px`,\n        }\n      : { width: '100%', height: '100%' }),\n  };\n\n  switch (position) {\n    case positions.TOP_LEFT:\n      return {\n        ...initialStyles,\n        justifyContent: 'flex-start',\n        alignItems: 'flex-start',\n      };\n    case positions.TOP_CENTER:\n      return {\n        ...initialStyles,\n        justifyContent: 'flex-start',\n      };\n    case positions.TOP_RIGHT:\n      return {\n        ...initialStyles,\n        justifyContent: 'flex-start',\n        alignItems: 'flex-end',\n      };\n    case positions.MIDDLE_LEFT:\n      return {\n        ...initialStyles,\n        justifyContent: 'center',\n        alignItems: 'flex-start',\n      };\n    case positions.MIDDLE: {\n      return {\n        ...initialStyles,\n        justifyContent: 'center',\n      };\n    }\n    case positions.MIDDLE_RIGHT:\n      return {\n        ...initialStyles,\n        justifyContent: 'center',\n\n        alignItems: 'flex-end',\n      };\n\n    case positions.BOTTOM_LEFT:\n      return {\n        ...initialStyles,\n        justifyContent: 'flex-end',\n\n        alignItems: 'flex-start',\n      };\n    case positions.BOTTOM_CENTER:\n      return {\n        ...initialStyles,\n        justifyContent: 'flex-end',\n      };\n    case positions.BOTTOM_RIGHT:\n      return {\n        ...initialStyles,\n        justifyContent: 'flex-end',\n\n        alignItems: 'flex-end',\n      };\n\n    default: {\n      return initialStyles;\n    }\n  }\n}\n\nexport default function Wrapper({\n  children,\n  options: { position },\n  containerStyle,\n  ...props\n}) {\n  const styles = useMemo(\n    () => getStyles(position, containerStyle),\n    [position, containerStyle],\n  );\n\n  return (\n    children.length > 0 && (\n      <div style={styles} {...props}>\n        {children}\n      </div>\n    )\n  );\n}\n","export function groupBy(\n  array: Array<any>,\n  fn: (item: any) => string,\n): Array<any> {\n  return array.reduce((result, item) => {\n    const key = fn(item);\n    if (!result[key]) result[key] = [];\n    result[key].push(item);\n    return result;\n  }, {});\n}\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\n\nconst styles = css`\n  width: 40px;\n  height: 40px;\n  margin: 0 auto;\n  :after {\n    content: ' ';\n    display: block;\n    width: 30px;\n    height: 30px;\n    margin-top: 10px;\n    border-radius: 50%;\n    border: 4px solid;\n    border-color: #fff transparent #fff transparent;\n    animation: ring-animation 1s linear infinite;\n  }\n  @keyframes ring-animation {\n    0% {\n      transform: rotate(0deg);\n    }\n    100% {\n      transform: rotate(360deg);\n    }\n  }\n`;\n\nexport default function ProgressIndicator() {\n  return <div css={styles} />;\n}\n","import {\n  Fragment,\n  useState,\n  useRef,\n  useEffect,\n  useCallback,\n  useMemo,\n  memo,\n  CSSProperties,\n  ReactNode,\n} from 'react';\nimport { createPortal } from 'react-dom';\nimport { FaTimes } from 'react-icons/fa';\nimport { TransitionGroup } from 'react-transition-group';\n\nimport Transition from '../Transition';\nimport Wrapper from '../Wrapper';\nimport { groupBy } from '../helpers';\nimport { positions, transitions, types } from '../options';\n\nimport { AlertProvider } from './Context';\nimport ProgressIndicator from './ProgressIndicator';\n\ninterface ProviderProps {\n  children: ReactNode;\n  offset?: string;\n  position?: any;\n  timeout?: number;\n  type?: any;\n  transition?: any;\n  containerStyle?: CSSProperties;\n  wrapperRef?: any;\n  context?: {\n    Provider?: any;\n    Consumer?: any;\n  };\n}\n\nfunction Provider({\n  children,\n  wrapperRef = null,\n  offset = '5px',\n  position = positions.BOTTOM_CENTER,\n  timeout = 3000,\n  type,\n  transition = transitions.FADE,\n  ...props\n}: ProviderProps) {\n  const root = useRef<any>(null);\n  const timersId = useRef<any>([]);\n  const [alerts, setAlerts] = useState<any[]>([]);\n\n  useEffect(() => {\n    root.current = document.createElement('div');\n    const ref = root.current;\n    const timersIdRef = timersId.current;\n\n    if (wrapperRef) {\n      wrapperRef.appendChild(ref);\n    }\n    return () => {\n      if (ref) {\n        if (wrapperRef) {\n          timersIdRef.forEach(clearTimeout);\n\n          wrapperRef.removeChild(ref);\n        }\n      }\n    };\n  }, [wrapperRef]);\n\n  const remove = useCallback((alert) => {\n    setAlerts((currentAlerts) => {\n      const lengthBeforeRemove = currentAlerts.length;\n      const filteredAlerts = currentAlerts.filter((a) => a.id !== alert.id);\n\n      if (lengthBeforeRemove > filteredAlerts.length && alert.options.onClose) {\n        alert.options.onClose();\n      }\n\n      return filteredAlerts;\n    });\n  }, []);\n\n  const show = useCallback(\n    (message = '', options: any = {}) => {\n      const id = Math.random().toString(36).substr(2, 9);\n\n      const alertOptions = {\n        position: options.position || position,\n        timeout,\n        type,\n        backgroundColor: 'black',\n        color: 'white',\n        ...options,\n      };\n\n      const alert: any = {\n        id,\n        message,\n        options: alertOptions,\n      };\n\n      alert.close = () => remove(alert);\n\n      if (alert.options.timeout) {\n        const timerId = setTimeout(() => {\n          remove(alert);\n\n          timersId.current.splice(timersId.current.indexOf(timerId), 1);\n        }, alert.options.timeout);\n\n        timersId.current.push(timerId);\n      }\n\n      setAlerts((state) => state.concat(alert));\n      if (alert.options.onOpen) alert.options.onOpen();\n\n      return alert;\n    },\n    [position, remove, timeout, type],\n  );\n\n  const success = useCallback(\n    (message = '', options: any = {}) => {\n      options.type = types.SUCCESS;\n      options = { backgroundColor: '#28ba62', color: 'white', ...options };\n\n      return show(message, options);\n    },\n    [show],\n  );\n\n  const error = useCallback(\n    (message = '', options: any = {}) => {\n      options.type = types.ERROR;\n      options = { backgroundColor: '#cf3c4f', color: 'white', ...options };\n      return show(message, options);\n    },\n    [show],\n  );\n\n  const info = useCallback(\n    (message = '', options: any = {}) => {\n      options.type = types.INFO;\n      options.color = '#28ba62';\n      return show(message, options);\n    },\n    [show],\n  );\n\n  const showLoading = useCallback(\n    (message = 'Process in progress', options: any = {}) => {\n      options.type = types.PROGRESS_INDICATOR;\n      options.timeout = 0;\n      options.backgroundColor = '#232323';\n\n      return new Promise((resolve) => {\n        const alert = show(message, options);\n        setTimeout(() => {\n          resolve(() => remove(alert));\n        }, 500);\n      });\n    },\n    [remove, show],\n  );\n\n  const closeHandler = useCallback(\n    (alert) => {\n      remove(alert);\n    },\n    [remove],\n  );\n\n  const alertsByPosition = groupBy(alerts, (alert) => alert.options.position);\n\n  const parentStyle = useMemo(() => {\n    return wrapperRef\n      ? wrapperRef.getBoundingClientRect()\n      : {\n          top: 0,\n          left: 0,\n          width: window.innerWidth,\n          height: window.innerHeight,\n        };\n  }, [wrapperRef]);\n\n  const alertContextValue = useMemo(\n    () => ({ show, success, error, info, showLoading }),\n    [show, success, error, info, showLoading],\n  );\n\n  return (\n    <AlertProvider value={alertContextValue}>\n      {children}\n      {root.current &&\n        createPortal(\n          <Fragment>\n            {Object.keys(positions).map((key) => {\n              const position = positions[key];\n\n              return (\n                <TransitionGroup\n                  appear\n                  key={position}\n                  options={{ position, zIndex: 999999 }}\n                  component={Wrapper}\n                  containerStyle={parentStyle}\n                  {...props}\n                >\n                  {alertsByPosition[position]\n                    ? alertsByPosition[position].map((alert) => (\n                        <Transition type={transition} key={alert.id}>\n                          <div\n                            style={{\n                              margin: offset,\n                              padding: '25px',\n                              borderRadius: '10px',\n                              pointerEvents: 'all',\n                              backgroundColor: alert.options.backgroundColor,\n                              color: alert.options.color,\n                              minHeight: '60px',\n                              position: 'relative',\n                            }}\n                            key={alert.id}\n                          >\n                            <button\n                              style={{\n                                position: 'absolute',\n                                right: '5px',\n                                top: '5px',\n                                border: 'none',\n                                backgroundColor: 'transparent',\n                                color: 'white',\n                              }}\n                              type=\"button\"\n                              onClick={() => closeHandler(alert)}\n                            >\n                              <FaTimes />\n                            </button>\n\n                            <span>{alert.message}</span>\n                            {alert.options.type ===\n                              types.PROGRESS_INDICATOR && <ProgressIndicator />}\n                          </div>\n                        </Transition>\n                      ))\n                    : null}\n                </TransitionGroup>\n              );\n            })}\n          </Fragment>,\n          root.current,\n        )}\n    </AlertProvider>\n  );\n}\n\nexport default memo(Provider);\n","import {\n  createContext,\n  useReducer,\n  useMemo,\n  useContext,\n  useCallback,\n  useEffect,\n} from 'react';\n\nexport enum HighlightedSource {\n  PEAK = 'PEAK',\n  INTEGRAL = 'INTEGRAL',\n  SIGNAL = 'SIGNAL',\n  RANGE = 'RANGE',\n  ZONE = 'ZONE',\n  EXCLUSION_ZONE = 'EXCLUSION_ZONE',\n  DATABASE = 'DATABASE',\n  UNKNOWN = 'UNKNOWN',\n}\n\ntype HighlightedSourceType = keyof typeof HighlightedSource;\n\ninterface SourceData {\n  type: HighlightedSourceType;\n  extra?: any;\n}\n\ntype HighlightActions = 'HIDE' | 'SHOW' | 'SET_PERMANENT' | 'UNSET_PERMANENT';\n\ninterface HighlightState {\n  highlights: Record<string, number>;\n  highlighted: string[];\n  highlightedPermanently: string[];\n  sourceData: SourceData | null;\n}\n\ninterface HighlightContextProps {\n  highlight: HighlightState;\n  dispatch: (props: { type: HighlightActions; payload?: any }) => void;\n  remove: () => void;\n}\n\nconst emptyState = {\n  highlight: {\n    highlights: {},\n    highlighted: [],\n    highlightedPermanently: [],\n    sourceData: null,\n  },\n  dispatch: () => null,\n  remove: () => null,\n};\n\nconst highlightContext = createContext<HighlightContextProps>(emptyState);\n\nfunction highlightReducer(state, action) {\n  switch (action.type) {\n    case 'SHOW': {\n      const { convertedHighlights, sourceData } = action.payload;\n      const { type = HighlightedSource.UNKNOWN, extra = null } =\n        sourceData || {};\n\n      const newState = {\n        ...state,\n        highlights: { ...state.highlights },\n        sourceData: { type, extra },\n      };\n      for (const value of convertedHighlights) {\n        if (!(value in newState.highlights)) {\n          newState.highlights[value] = 1;\n        }\n      }\n      newState.highlighted = Object.keys(newState.highlights);\n\n      return newState;\n    }\n    case 'HIDE': {\n      const { convertedHighlights } = action.payload;\n\n      const newState = {\n        ...state,\n        highlights: { ...state.highlights },\n        sourceData: null,\n      };\n      for (const value of convertedHighlights) {\n        if (value in newState.highlights) {\n          // eslint-disable-next-line @typescript-eslint/no-dynamic-delete\n          delete newState.highlights[value];\n        }\n      }\n      newState.highlighted = Object.keys(newState.highlights);\n      return newState;\n    }\n    case 'SET_PERMANENT': {\n      const newState = {\n        ...state,\n        // allow just one permanent highlights group at same time\n        highlightedPermanently: action.payload,\n      };\n\n      return newState;\n    }\n    case 'UNSET_PERMANENT': {\n      const newState = {\n        ...state,\n        highlightedPermanently: [],\n      };\n\n      return newState;\n    }\n    default: {\n      throw new Error(`unknown action type: ${action.type}`);\n    }\n  }\n}\n\nexport function HighlightProvider(props) {\n  const [highlight, dispatch] = useReducer(\n    highlightReducer,\n    emptyState.highlight,\n  );\n\n  const contextValue = useMemo(() => {\n    function remove() {\n      dispatch({\n        type: 'HIDE',\n        payload: { convertedHighlights: highlight.highlighted },\n      });\n    }\n    return { highlight, dispatch, remove };\n  }, [highlight]);\n\n  return (\n    <highlightContext.Provider value={contextValue}>\n      {props.children}\n    </highlightContext.Provider>\n  );\n}\n\nexport function useHighlightData() {\n  return useContext(highlightContext);\n}\n\n/**\n * @param {Array<string | number>}  highlights\n * @param {SourceData = null} sourceData\n */\nexport function useHighlight(\n  highlights: (string | number)[],\n  sourceData: SourceData | null = null,\n) {\n  if (!Array.isArray(highlights)) {\n    throw new Error('highlights must be an array');\n  }\n  const { dispatch, highlight } = useHighlightData();\n\n  const convertedHighlights = useMemo(() => {\n    const newHighlights: Array<any> = [];\n    for (const highlight of highlights) {\n      if (typeof highlight !== 'string' && typeof highlight !== 'number') {\n        throw new Error(`highlight key must be a string or number`);\n      }\n      if (highlight !== '') {\n        newHighlights.push(String(highlight));\n      }\n    }\n    return newHighlights;\n  }, [highlights]);\n\n  useEffect(() => {\n    // if deletion of component then also delete its highlight information -> componentWillUnmount\n    return () => {\n      dispatch({\n        type: 'HIDE',\n        payload: { convertedHighlights: [] },\n      });\n      dispatch({\n        type: 'UNSET_PERMANENT',\n      });\n    };\n  }, [dispatch]);\n\n  const isActive = useMemo(() => {\n    return highlight.highlighted.some((key) =>\n      convertedHighlights.includes(key),\n    );\n  }, [convertedHighlights, highlight.highlighted]);\n\n  const isActivePermanently = useMemo(() => {\n    return highlight.highlightedPermanently.some((key) =>\n      convertedHighlights.includes(key),\n    );\n  }, [convertedHighlights, highlight.highlightedPermanently]);\n\n  const show = useCallback(() => {\n    dispatch({\n      type: 'SHOW',\n      payload: {\n        convertedHighlights,\n        sourceData,\n      },\n    });\n  }, [dispatch, convertedHighlights, sourceData]);\n\n  const hide = useCallback(() => {\n    dispatch({\n      type: 'HIDE',\n      payload: {\n        convertedHighlights,\n      },\n    });\n  }, [convertedHighlights, dispatch]);\n\n  const add = useCallback(\n    (id) => {\n      dispatch({\n        type: 'SHOW',\n        payload: { convertedHighlights: [], id },\n      });\n    },\n    [dispatch],\n  );\n\n  const remove = useCallback(\n    (id) => {\n      dispatch({\n        type: 'HIDE',\n        payload: { convertedHighlights: [], id },\n      });\n    },\n    [dispatch],\n  );\n\n  const click = useCallback(\n    (e) => {\n      if (e) {\n        e.preventDefault();\n        e.stopPropagation();\n      }\n\n      if (!isActivePermanently) {\n        dispatch({\n          type: 'SET_PERMANENT',\n          payload: convertedHighlights,\n        });\n      } else {\n        dispatch({\n          type: 'UNSET_PERMANENT',\n        });\n      }\n    },\n    [convertedHighlights, dispatch, isActivePermanently],\n  );\n\n  return useMemo(() => {\n    return {\n      isActive,\n      onHover: {\n        onMouseEnter: show,\n        onMouseLeave: hide,\n      },\n      onClick: click,\n      show,\n      hide,\n      isActivePermanently,\n      click,\n      add,\n      remove,\n    };\n  }, [add, click, hide, isActive, isActivePermanently, remove, show]);\n}\n","import { Range } from '../../../data/types/data1d';\nimport { Zone } from '../../../data/types/data2d';\nimport { AssignmentContext, Axis } from '../../assignment/AssignmentsContext';\n\ninterface Atom {\n  oclID: string;\n  atomLabel: string;\n  nbAtoms: number;\n  nbHydrogens: number;\n  hydrogenOCLIDs: string[];\n}\nexport interface AtomData {\n  oclIDs: string[];\n  nbAtoms: number;\n}\n\nfunction getElements(activeTab: string) {\n  const nuclei = activeTab.split(',');\n  return nuclei.map((nucleus) => nucleus.replace(/[0-9]/g, ''));\n}\n\nexport function extractFromAtom(\n  atom: Atom,\n  activeTab: string,\n  axis?: Axis | null,\n): AtomData {\n  const elements = getElements(activeTab);\n\n  if (elements.length > 0 && Object.keys(atom).length > 0) {\n    const dim = axis === 'x' ? 0 : axis === 'y' ? 1 : null;\n    switch (dim !== null && elements[dim]) {\n      case atom.atomLabel: {\n        // take always oclID if atom type is same as element of activeTab)\n        return { oclIDs: [atom.oclID], nbAtoms: atom.nbAtoms };\n      }\n      case 'H': {\n        // if we are in proton spectrum and use then the IDs of attached hydrogens of an atom\n        return {\n          oclIDs: atom.hydrogenOCLIDs,\n          nbAtoms: atom.nbAtoms * atom.nbHydrogens,\n        };\n      }\n      default:\n        return {\n          oclIDs: [atom.oclID].concat(atom.hydrogenOCLIDs),\n          nbAtoms: atom.nbAtoms + atom.nbAtoms * atom.nbHydrogens,\n        };\n    }\n  }\n\n  return { oclIDs: [], nbAtoms: 0 };\n}\n\nexport function findDatumAndSignalIndex(data: (Range | Zone)[], id: string) {\n  // if datum could be found then the id is on range/zone level\n  let datum = data.find((_datum) => _datum.id === id);\n  let signalIndex;\n  if (!datum) {\n    // figure out the datum via id\n    for (const record of data) {\n      signalIndex = record.signals.findIndex((signal) => signal.id === id);\n      if (signalIndex >= 0) {\n        datum = record;\n        break;\n      }\n    }\n  }\n\n  return { datum, signalIndex };\n}\n\nexport function getHighlightsOnHover(\n  assignments: AssignmentContext,\n  oclIDs,\n  data,\n) {\n  // set all IDs to highlight when hovering over an atom from assignment data\n  let highlights: string[] = [];\n  const assignmentsByKey = assignments.data.assignments;\n\n  for (const key in assignmentsByKey) {\n    const assignments = assignmentsByKey[key];\n\n    for (const axis in assignments) {\n      if (assignments[axis]?.some((oclKey) => oclIDs.includes(oclKey))) {\n        highlights = highlights.concat(assignments[axis]);\n        const { datum, signalIndex } = findDatumAndSignalIndex(data, key);\n\n        if (datum) {\n          highlights.push(datum.id);\n          if (signalIndex !== undefined) {\n            highlights.push(datum.signals[signalIndex].id);\n          }\n        }\n      }\n    }\n  }\n\n  return highlights;\n}\n\nexport function getCurrentDiaIDsToHighlight(assignmentData: AssignmentContext) {\n  const { highlighted, assignments } = assignmentData.data;\n  const assignment = highlighted ? assignments[highlighted.id] : null;\n  const axisHover = highlighted ? highlighted.axis : null;\n\n  if (axisHover && assignment && assignment[axisHover]) {\n    return assignment[axisHover];\n  } else {\n    return (assignment?.x || []).concat(assignment?.y || []);\n  }\n}\n\nexport function toggleDiaIDs(diaIDs: string[], atomInformation: AtomData) {\n  let _diaIDs = diaIDs ? diaIDs.slice() : [];\n  const { nbAtoms, oclIDs } = atomInformation;\n  let tempNbAtoms = nbAtoms;\n  oclIDs.forEach((_oclID) => {\n    if (_diaIDs.includes(_oclID)) {\n      tempNbAtoms *= -1;\n      _diaIDs = _diaIDs.filter((_id) => _id !== _oclID);\n    } else {\n      _diaIDs.push(_oclID);\n    }\n  });\n  return [_diaIDs, tempNbAtoms];\n}\n","import { useCallback, useEffect, useMemo, useState } from 'react';\n\nimport { Range } from '../../../data/types/data1d';\nimport { Zone } from '../../../data/types/data2d';\nimport { ConcatenationString } from '../../../data/utilities/Concatenation';\nimport checkModifierKeyActivated from '../../../data/utilities/checkModifierKeyActivated';\nimport {\n  useAssignment,\n  useAssignmentData,\n} from '../../assignment/AssignmentsContext';\nimport { filterForIDsWithAssignment } from '../../assignment/utilities/filterForIDsWithAssignment';\nimport { useDispatch } from '../../context/DispatchContext';\nimport { useAlert } from '../../elements/popup/Alert';\nimport { HighlightedSource, useHighlightData } from '../../highlight';\nimport { DISPLAYER_MODE } from '../../reducer/core/Constants';\nimport { SET_DIAID_RANGE, SET_DIAID_ZONE } from '../../reducer/types/Types';\n\nimport {\n  AtomData,\n  extractFromAtom,\n  findDatumAndSignalIndex,\n  getCurrentDiaIDsToHighlight,\n  getHighlightsOnHover,\n  toggleDiaIDs,\n} from './Utilities';\n\nexport default function useAtomAssignment({\n  displayerMode,\n  activeTab: nucleus,\n  zones,\n  ranges,\n}) {\n  const alert = useAlert();\n  const dispatch = useDispatch();\n  const highlightData = useHighlightData();\n  const assignments = useAssignmentData();\n\n  const activeAssignment = useAssignment(\n    assignments.data.activated\n      ? assignments.data.activated.id\n      : ConcatenationString, // dummy value\n  );\n\n  const [onAtomHoverHighlights, setOnAtomHoverHighlights] = useState<any>([]);\n  const [onAtomHoverAction, setOnAtomHoverAction] = useState<\n    'show' | 'hide' | null\n  >(null);\n\n  useEffect(() => {\n    if (onAtomHoverAction) {\n      if (onAtomHoverAction === 'show') {\n        highlightData.dispatch({\n          type: 'SHOW',\n          payload: { convertedHighlights: onAtomHoverHighlights },\n        });\n      } else if (onAtomHoverAction === 'hide') {\n        highlightData.dispatch({\n          type: 'HIDE',\n          payload: { convertedHighlights: onAtomHoverHighlights },\n        });\n        setOnAtomHoverHighlights([]);\n      }\n      setOnAtomHoverAction(null);\n    }\n  }, [onAtomHoverAction, onAtomHoverHighlights, highlightData]);\n\n  const data = useMemo(() => {\n    if (zones || ranges) {\n      if (displayerMode === DISPLAYER_MODE.DM_1D && ranges && ranges.values) {\n        return ranges.values;\n      } else if (\n        displayerMode === DISPLAYER_MODE.DM_2D &&\n        zones &&\n        zones.values\n      ) {\n        return zones.values;\n      }\n    }\n    return [];\n  }, [displayerMode, ranges, zones]);\n\n  const assignedDiaIDs = useMemo(() => {\n    const assignedDiaID: { x: Array<any>; y: Array<any> } = { x: [], y: [] };\n    const assignment = assignments.data.assignments;\n    for (let id in assignment) {\n      if (assignment[id].x) {\n        assignedDiaID.x.push(...assignment[id].x);\n      }\n      if (assignment[id].y) {\n        assignedDiaID.y.push(...assignment[id].y);\n      }\n    }\n    // with its structure it's prepared for showing assigned IDs per axis\n    return assignedDiaID;\n  }, [assignments.data]);\n\n  // used for atom highlighting for now, until we would like to highlight atoms per axis separately\n  const assignedDiaIDsMerged = useMemo(\n    () => assignedDiaIDs.x.concat(assignedDiaIDs.y),\n    [assignedDiaIDs.x, assignedDiaIDs.y],\n  );\n\n  const currentDiaIDsToHighlight = useMemo(() => {\n    let highlights: string[] = [];\n    highlightData.highlight.highlighted.forEach((highlightID) => {\n      const temp = assignments.data.assignments[highlightID];\n      if (temp) {\n        const { datum } = findDatumAndSignalIndex(data, highlightID);\n        const type = highlightData.highlight.sourceData?.type;\n        if (\n          datum &&\n          (type === HighlightedSource.ZONE || type === HighlightedSource.RANGE)\n        ) {\n          // we are on range/zone level only, so add the belonging signal IDs to highlight too\n          highlights = highlights.concat(\n            datum.signals\n              .map((signal) =>\n                filterForIDsWithAssignment(assignments, [signal.id]).length > 0\n                  ? signal.diaIDs\n                  : [],\n              )\n              .flat(),\n          );\n        }\n      }\n    });\n    return getCurrentDiaIDsToHighlight(assignments).concat(highlights);\n  }, [\n    assignments,\n    data,\n    highlightData.highlight.highlighted,\n    highlightData.highlight.sourceData?.type,\n  ]);\n\n  const toggleAssignment = useCallback((diaID, atomInformation: AtomData) => {\n    // a previous version of the code prevented to assign many time the same atom\n    // see revision cc13abc18f77b6787b923e3c4edaef51750d9e90\n    return toggleDiaIDs(diaID, atomInformation);\n  }, []);\n\n  const handleOnClickAtom = useCallback(\n    (atom, event) => {\n      if (!checkModifierKeyActivated(event) && activeAssignment.activated) {\n        const { axis, id } = activeAssignment.activated;\n        if (id && axis) {\n          const atomInformation = extractFromAtom(atom, nucleus, axis);\n          if (atomInformation.nbAtoms > 0) {\n            // save assignment in assignment hook\n            const dimension =\n              displayerMode === DISPLAYER_MODE.DM_1D ? '1D' : '2D';\n            activeAssignment.toggle(atomInformation.oclIDs, dimension);\n            // console.log(activeAssignment);\n            // save assignment (diaIDs) in range/zone data\n            const { datum, signalIndex } = findDatumAndSignalIndex(\n              data,\n              activeAssignment.id,\n            );\n            if (datum) {\n              // determine the level of setting the diaIDs array (range vs. signal level) and save there\n              // let nbAtoms = 0;\n              // on range/zone level\n\n              if (displayerMode === DISPLAYER_MODE.DM_1D) {\n                const range = datum as Range;\n                let _diaIDs: string[] = [];\n                if (signalIndex === undefined) {\n                  _diaIDs = range?.diaIDs || [];\n                } else {\n                  _diaIDs = range?.signals[signalIndex]?.diaIDs || [];\n                }\n                const [_diaID, nbAtoms] = toggleAssignment(\n                  _diaIDs,\n                  atomInformation,\n                );\n                dispatch({\n                  type: SET_DIAID_RANGE,\n                  payload: {\n                    nbAtoms,\n                    rangeData: datum,\n                    diaIDs: _diaID,\n                    signalIndex,\n                  },\n                });\n              } else {\n                const zone = datum as Zone;\n                let _diaIDs: string[] = [];\n                if (signalIndex === undefined) {\n                  _diaIDs = zone[axis]?.diaIDs || [];\n                } else {\n                  _diaIDs = zone?.signals[signalIndex][axis]?.diaIDs || [];\n                }\n                const [_diaID, nbAtoms] = toggleAssignment(\n                  _diaIDs,\n                  atomInformation,\n                );\n                dispatch({\n                  type: SET_DIAID_ZONE,\n                  payload: {\n                    nbAtoms,\n                    zoneData: datum,\n                    diaIDs: _diaID,\n                    axis: axis,\n                    signalIndex,\n                  },\n                });\n              }\n            }\n            activeAssignment.setActive(axis);\n          } else {\n            alert.info(\n              'Not assigned! Different atom type or no attached hydrogens found!',\n            );\n          }\n        }\n      }\n    },\n    [\n      activeAssignment,\n      alert,\n      data,\n      dispatch,\n      displayerMode,\n      nucleus,\n      toggleAssignment,\n    ],\n  );\n\n  const handleOnAtomHover = useCallback(\n    (atom) => {\n      const { oclIDs } = extractFromAtom(atom, nucleus);\n\n      // on enter the atom\n      if (oclIDs.length > 0) {\n        // set all IDs to highlight when hovering over an atom from assignment data\n        const highlights = getHighlightsOnHover(assignments, oclIDs, data);\n        setOnAtomHoverHighlights(highlights);\n        setOnAtomHoverAction('show');\n      } else {\n        // on leave the atom\n        setOnAtomHoverAction('hide');\n      }\n      // }\n    },\n    [assignments, data, nucleus],\n  );\n\n  return {\n    handleOnAtomHover,\n    handleOnClickAtom,\n    currentDiaIDsToHighlight,\n    assignedDiaIDsMerged,\n  };\n}\n","/** @jsxImportSource @emotion/react */\nimport { css, CSSObject, SerializedStyles } from '@emotion/react';\nimport {\n  ReactNode,\n  ButtonHTMLAttributes,\n  CSSProperties,\n  MouseEvent,\n} from 'react';\n\ntype Size = 'xSmall' | 'small' | 'medium' | 'large';\n\ntype Color = CSSProperties['color'];\n\ninterface BaseColor {\n  base: Color;\n  hover: Color;\n  active?: Color;\n}\n\ntype Fill = 'clear' | 'outline' | 'solid';\n\ntype ColorTheme = 'success' | 'danger' | 'warning' | 'medium' | 'light';\n\ntype ColorPalettes = Record<\n  ColorTheme,\n  {\n    base: Color;\n    shade: Color;\n    tint: Color;\n  }\n>;\n\nconst colorPalettes: ColorPalettes = {\n  success: {\n    base: '#2dd36f',\n    shade: '#28ba62',\n    tint: '#42d77d',\n  },\n  danger: {\n    base: '#eb445a',\n    shade: '#cf3c4f',\n    tint: '#ed576b',\n  },\n  warning: {\n    base: '#ffc409',\n    shade: '#e0ac08',\n    tint: '#ffca22',\n  },\n  medium: {\n    base: '#92949c',\n    shade: '#808289',\n    tint: '#9d9fa6',\n  },\n  light: {\n    base: '#f4f5f8',\n    shade: '#d7d8da',\n    tint: '#f5f6f9',\n  },\n};\n\nconst sizeConfig: Record<\n  Size,\n  Pick<CSSProperties, 'fontSize' | 'padding' | 'borderRadius'>\n> = {\n  xSmall: {\n    fontSize: '0.75rem',\n    padding: '0.15rem 0.3rem',\n    borderRadius: '0.15rem',\n  },\n  small: {\n    fontSize: '0.8rem',\n    padding: '0.25rem 0.5rem',\n    borderRadius: '0.2rem',\n  },\n  medium: {\n    fontSize: '1rem',\n    padding: '0.375rem 0.75rem',\n    borderRadius: '0.25rem',\n  },\n  large: {\n    fontSize: '1.25rem',\n    padding: '0.5rem 1rem',\n    borderRadius: '0.3rem',\n  },\n};\n\ninterface ButtonStyle {\n  color: BaseColor;\n  size: Size;\n  borderColor: Color;\n  backgroundColor: BaseColor;\n  borderRadius?: CSSProperties['borderRadius'];\n  fill?: Fill;\n  style?: CSSObject;\n}\n\ninterface Style {\n  button: (props: ButtonStyle) => SerializedStyles;\n}\n\nfunction getFillStyle(props: ButtonStyle) {\n  const { borderColor, fill, backgroundColor, color } = props;\n\n  switch (fill) {\n    case 'solid': {\n      return css`\n        border-color: transparent;\n        background-color: ${backgroundColor.base};\n        color: ${color.hover};\n      `;\n    }\n    case 'outline': {\n      return css`\n        border-style: solid;\n        border-color: ${backgroundColor.base};\n        background-color: transparent;\n        color: ${color.base};\n      `;\n    }\n\n    case 'clear': {\n      return css`\n        border-color: transparent;\n        background-color: transparent;\n        color: ${color.base};\n      `;\n    }\n    default:\n      return css`\n        background-color: ${backgroundColor.base};\n        color: ${color.base};\n        border-color: ${borderColor};\n      `;\n  }\n}\n\nconst styles: Style = {\n  button: (props) => {\n    const { size, backgroundColor, color, borderRadius } = props;\n\n    const basic = css`\n      display: flex;\n      flex-direction: row;\n      border-width: 1px;\n      align-items: center;\n    `;\n\n    const fillStyle = getFillStyle(props);\n\n    const colorStyle = css`\n      &:not([disabled]):hover {\n        background-color: ${backgroundColor.hover};\n        color: ${color.hover};\n      }\n      &:not([disabled]):active {\n        background-color: ${backgroundColor?.active || backgroundColor.hover};\n        color: ${color?.active || color.hover};\n      }\n\n      &:disabled {\n        opacity: 0.25;\n      }\n    `;\n    return css([\n      basic,\n      sizeConfig[size],\n      fillStyle,\n      colorStyle,\n      { borderRadius },\n    ]);\n  },\n};\n\ninterface ButtonProps\n  extends Partial<ButtonStyle>,\n    Omit<ButtonHTMLAttributes<HTMLButtonElement>, 'color' | 'style'> {\n  onClick?: (event?: MouseEvent<HTMLButtonElement>) => void;\n  children: ReactNode;\n}\n\nconst Button = (props: ButtonProps) => {\n  const {\n    onClick,\n    size = 'small',\n    color = { base: 'black', hover: 'white' },\n    backgroundColor = { base: 'white', hover: 'black', active: 'black' },\n    borderColor = 'transparent',\n    fill,\n    borderRadius,\n    style = {},\n    ...restProps\n  } = props;\n\n  return (\n    <button\n      type=\"button\"\n      onClick={onClick}\n      css={[\n        styles.button({\n          size,\n          backgroundColor,\n          color,\n          borderColor,\n          fill,\n          borderRadius,\n        }),\n        style,\n      ]}\n      {...restProps}\n    >\n      <span style={{ flex: 1, pointerEvents: 'none' }}> {props.children}</span>\n    </button>\n  );\n};\n\nfunction ThemeButton(props: { colorTheme: ColorTheme } & ButtonProps) {\n  const { colorTheme, ...buttonProps } = props;\n  const { base, shade, tint } = colorPalettes[props.colorTheme];\n\n  const {\n    color = { base: shade, hover: 'white' },\n    backgroundColor = {\n      base: base,\n      hover: shade,\n      active: tint,\n    },\n    fill = 'solid',\n    ...restProps\n  } = buttonProps;\n  return <Button {...{ fill, ...restProps, backgroundColor, color }} />;\n}\n\nButton.Done = (props: ButtonProps) => {\n  return <ThemeButton {...props} colorTheme=\"success\" />;\n};\nButton.Danger = (props: ButtonProps) => {\n  return <ThemeButton {...props} colorTheme=\"danger\" />;\n};\nButton.Action = (props: ButtonProps) => {\n  return <ThemeButton {...props} colorTheme=\"medium\" />;\n};\n\nexport default Button;\n","import { BsArrowsMove } from 'react-icons/bs';\nimport { FaTimes } from 'react-icons/fa';\n\nimport Button from '../../elements/Button';\n\nexport default function ActionsButton({ onFloatBtnClick }) {\n  return (\n    <div data-no-export=\"true\" style={{ display: 'flex', zIndex: 0 }}>\n      <Button.Action\n        style={{ fontSize: '14px' }}\n        fill=\"clear\"\n        className=\"handle\"\n      >\n        <BsArrowsMove />\n      </Button.Action>\n      <Button.Danger\n        style={{ fontSize: '14px' }}\n        fill=\"clear\"\n        onClick={onFloatBtnClick}\n      >\n        <FaTimes />\n      </Button.Danger>\n    </div>\n  );\n}\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport OCL from 'openchemlib/full';\nimport { useCallback } from 'react';\nimport OCLnmr from 'react-ocl-nmr';\n\nimport { Molecule } from '../../../data/molecules/Molecule';\nimport { Ranges } from '../../../data/types/data1d';\nimport { Zones } from '../../../data/types/data2d';\nimport { useDispatch } from '../../context/DispatchContext';\nimport { useGlobal } from '../../context/GlobalContext';\nimport SVGDraggable from '../../elements/draggble/SVGDraggable';\nimport useAtomAssignment from '../../panels/MoleculesPanel/useAtomAssignment';\nimport { DISPLAYER_MODE } from '../../reducer/core/Constants';\nimport { FLOAT_MOLECULE_OVER_SPECTRUM } from '../../reducer/types/Types';\n\nimport ActionsButton from './ActionsButton';\n\ninterface DraggableStructureProps {\n  zones: Zones;\n  ranges: Ranges;\n  molecule: Molecule;\n  activeTab: string;\n  displayerMode: DISPLAYER_MODE;\n  index?: number;\n}\n\nconst style = css`\n  border: 1px solid transparent;\n  button {\n    visibility: hidden;\n  }\n\n  &:hover {\n    border: 1px solid #ebecf1;\n    background-color: white;\n    button {\n      visibility: visible;\n    }\n  }\n`;\nexport function DraggableStructure(props: DraggableStructureProps) {\n  const { zones, ranges, molecule, activeTab, displayerMode, index } = props;\n  const { viewerRef } = useGlobal();\n  const dispatch = useDispatch();\n\n  const {\n    currentDiaIDsToHighlight,\n    handleOnAtomHover,\n    handleOnClickAtom,\n    assignedDiaIDsMerged,\n  } = useAtomAssignment({ zones, ranges, activeTab, displayerMode });\n\n  const floatMoleculeHandler = useCallback(() => {\n    dispatch({\n      type: FLOAT_MOLECULE_OVER_SPECTRUM,\n      payload: { key: molecule.key },\n    });\n  }, [dispatch, molecule]);\n  return (\n    <SVGDraggable\n      key={molecule.key}\n      width={150}\n      height={100}\n      initialPosition={{ x: 100, y: 50 }}\n      dragHandleClassName=\"handle\"\n      parentElement={viewerRef}\n    >\n      {(width, height) => (\n        <foreignObject\n          width={width}\n          height={height + 30}\n          data-replace-float-structure=\"true\"\n          css={style}\n        >\n          <ActionsButton onFloatBtnClick={floatMoleculeHandler} />\n          <OCLnmr\n            OCL={OCL}\n            autoCrop\n            id={`molSVG${index || ''}`}\n            width={width - 20}\n            height={height}\n            molfile={molecule.molfile}\n            setSelectedAtom={handleOnClickAtom}\n            atomHighlightColor={\n              currentDiaIDsToHighlight?.length > 0 ? 'red' : '#FFD700'\n            }\n            atomHighlightOpacity={0.35}\n            highlights={\n              currentDiaIDsToHighlight?.length > 0\n                ? currentDiaIDsToHighlight\n                : assignedDiaIDsMerged\n            }\n            setHoverAtom={handleOnAtomHover}\n            setMolfile={() => null}\n          />\n        </foreignObject>\n      )}\n    </SVGDraggable>\n  );\n}\n","import { memo } from 'react';\n\nimport { Molecule } from '../../../data/molecules/Molecule';\nimport { Datum1D, Ranges } from '../../../data/types/data1d';\nimport { Datum2D, Zones } from '../../../data/types/data2d';\nimport { useChartData } from '../../context/ChartContext';\nimport useSpectrum from '../../hooks/useSpectrum';\nimport { DISPLAYER_MODE } from '../../reducer/core/Constants';\n\nimport { DraggableStructure } from './DraggableStructure';\n\ninterface FloatMoleculeStructuresProps {\n  zones: Zones;\n  ranges: Ranges;\n  molecules: Array<Molecule>;\n  activeTab: string;\n  displayerMode: DISPLAYER_MODE;\n}\n\nexport function FloatMoleculeStructuresInner(\n  props: FloatMoleculeStructuresProps,\n) {\n  const { zones, ranges, molecules, activeTab, displayerMode } = props;\n\n  if (!molecules || molecules.length === 0) return null;\n\n  return (\n    <g>\n      {molecules\n        .filter((molecule) => molecule.isFloat)\n        .map((molecule) => (\n          <DraggableStructure\n            key={molecule.key}\n            {...{ zones, ranges, activeTab, displayerMode, molecule }}\n          />\n        ))}\n    </g>\n  );\n}\n\nconst MemoizedFloatMoleculeStructures = memo(FloatMoleculeStructuresInner);\nconst emptyData = { ranges: {}, zones: {} };\n\nexport default function FloatMoleculeStructures() {\n  const { molecules, displayerMode, activeTab } = useChartData();\n\n  const data = useSpectrum(emptyData);\n  const ranges: Ranges = (data as Datum1D)?.ranges || {};\n  const zones: Zones = (data as Datum2D)?.zones || {};\n\n  return (\n    <MemoizedFloatMoleculeStructures\n      {...{\n        molecules,\n        displayerMode,\n        activeTab,\n        ranges,\n        zones,\n      }}\n    />\n  );\n}\n","import lodashGet from 'lodash/get';\nimport lodashSet from 'lodash/set';\nimport { useCallback, useEffect, useMemo, useState } from 'react';\n\nexport function useStateWithLocalStorage(localStorageKey, key?: string) {\n  const [value, setValue] = useState(\n    localStorage.getItem(localStorageKey) || '{}',\n  );\n  useEffect(() => {\n    localStorage.setItem(localStorageKey, value);\n  }, [localStorageKey, value]);\n\n  const setData = useCallback(\n    (data, key = null) => {\n      let castData = JSON.parse(value);\n      if (key) {\n        lodashSet(castData, key, data);\n      } else {\n        castData = { ...castData, ...data };\n      }\n      setValue(JSON.stringify(castData));\n    },\n    [value],\n  );\n\n  return useMemo(() => {\n    return [\n      key ? lodashGet(JSON.parse(value), key, {}) : JSON.parse(value),\n      setData,\n    ];\n  }, [key, setData, value]);\n}\n\nexport function getLocalStorage(localStorageKey, isJson = true) {\n  const settings = localStorage.getItem(localStorageKey);\n  return settings && isJson ? JSON.parse(settings) : settings;\n}\n\nexport function storeData(localStorageKey, value) {\n  localStorage.setItem(localStorageKey, value);\n}\n\nexport function removeData(localStorageKey) {\n  localStorage.removeItem(localStorageKey);\n}\n\nexport function getValue(object, keyPath, defaultValue: any = null) {\n  return lodashGet(object, keyPath, defaultValue);\n}\n","import { Workspace } from './Workspace';\n\nexport const basic: Workspace = {\n  version: 1,\n  label: 'Default workspace',\n  display: {\n    general: {\n      disableMultipletAnalysis: false,\n      hideSetSumFromMolecule: false,\n      hideGeneralSettings: false,\n      experimentalFeatures: { display: true },\n    },\n\n    panels: {\n      spectraPanel: { display: true, open: true },\n      informationPanel: { display: true, open: false },\n      peaksPanel: { display: true, open: false },\n      integralsPanel: { display: true, open: false },\n      rangesPanel: { display: true, open: false },\n      structuresPanel: { display: true, open: false },\n      filtersPanel: { display: true, open: false },\n      zonesPanel: { display: true, open: false },\n      summaryPanel: { display: false, open: false },\n      multipleSpectraAnalysisPanel: { display: false, open: false },\n      databasePanel: { display: false, open: false },\n      predictionPanel: { display: false, open: false },\n    },\n  },\n\n  controllers: {\n    dimmedSpectraTransparency: 0.1,\n  },\n  formatting: {\n    nuclei: {\n      '1h': { name: '1H', ppm: '0.00', hz: '0.00' },\n      '13c': { name: '13C', ppm: '0.00', hz: '0.00' },\n      '15n': { name: '15N', ppm: '0.00', hz: '0.00' },\n      '19f': { name: '19F', ppm: '0.00', hz: '0.00' },\n      '29si': { name: '29Si', ppm: '0.00', hz: '0.00' },\n      '31p': { name: '31P', ppm: '0.00', hz: '0.00' },\n    },\n    panels: {},\n  },\n  databases: [\n    {\n      label: 'Toc',\n      url: 'https://data.cheminfo.org/nmr/database/toc.json',\n      enabled: true,\n    },\n  ],\n};\n","import { Workspace } from './Workspace';\nimport { basic } from './basic';\n\nexport const embedded: Workspace = {\n  version: 1,\n  label: 'Embedded workspace',\n  display: {\n    general: {\n      disableMultipletAnalysis: false,\n      hideSetSumFromMolecule: false,\n      hideGeneralSettings: false,\n      experimentalFeatures: { display: true },\n      hidePanelOnLoad: true,\n    },\n\n    panels: {\n      spectraPanel: { display: true, open: true },\n      informationPanel: { display: true, open: false },\n      peaksPanel: { display: true, open: false },\n      integralsPanel: { display: true, open: false },\n      rangesPanel: { display: true, open: false },\n      structuresPanel: { display: true, open: false },\n      filtersPanel: { display: true, open: false },\n      zonesPanel: { display: true, open: false },\n      summaryPanel: { display: false, open: false },\n      multipleSpectraAnalysisPanel: { display: false, open: false },\n      databasePanel: { display: false, open: false },\n      predictionPanel: { display: false, open: false },\n    },\n  },\n  controllers: basic.controllers,\n  formatting: basic.formatting,\n  databases: basic.databases,\n};\n","import { Workspace } from './Workspace';\nimport { basic } from './basic';\n\nexport const exercise: Workspace = {\n  version: 1,\n  label: 'Exercise workspace',\n  display: {\n    general: {\n      disableMultipletAnalysis: true,\n      hideSetSumFromMolecule: true,\n      hideGeneralSettings: true,\n      experimentalFeatures: { hidden: true },\n    },\n\n    panels: {\n      spectraPanel: { display: true, open: true },\n      informationPanel: { hidden: true },\n      peaksPanel: { hidden: true },\n      integralsPanel: { display: true },\n      rangesPanel: { hidden: true },\n      structuresPanel: { hidden: true },\n      filtersPanel: { hidden: true },\n      zonesPanel: { hidden: true },\n      summaryPanel: { hidden: true },\n      multipleSpectraAnalysisPanel: { hidden: true },\n      databasePanel: { hidden: true },\n      predictionPanel: { hidden: true },\n    },\n\n    toolBarButtons: {\n      zoomTool: true,\n      zoomOutTool: true,\n      import: false,\n      exportAs: false,\n      spectraStackAlignments: true,\n      spectraCenterAlignments: true,\n      realImaginary: false,\n      peakTool: true,\n      integralTool: true,\n      zonePickingTool: false,\n      slicingTool: false,\n      autoRangesTool: false,\n      zeroFillingTool: false,\n      phaseCorrectionTool: false,\n      baseLineCorrectionTool: false,\n      FFTTool: false,\n      multipleSpectraAnalysisTool: false,\n      exclusionZonesTool: false,\n    },\n  },\n  controllers: basic.controllers,\n  formatting: basic.formatting,\n  databases: basic.databases,\n};\n","import { Workspace } from './Workspace';\nimport { basic } from './basic';\n\nexport const prediction: Workspace = {\n  version: 1,\n  label: 'Prediction workspace',\n  display: {\n    general: {\n      experimentalFeatures: { display: false },\n    },\n    panels: {\n      spectraPanel: { display: true },\n      rangesPanel: { display: true },\n      zonesPanel: { display: true },\n      predictionPanel: { display: true, open: true },\n      informationPanel: { display: false },\n      peaksPanel: { display: false },\n      integralsPanel: { display: false },\n      structuresPanel: { display: false },\n      filtersPanel: { display: false },\n      summaryPanel: { display: false },\n      multipleSpectraAnalysisPanel: { display: false },\n      databasePanel: { display: false },\n    },\n  },\n  controllers: basic.controllers,\n  formatting: basic.formatting,\n  databases: basic.databases,\n};\n","import { Workspace } from './Workspace';\nimport { basic } from './basic';\n\nexport const process1D: Workspace = {\n  version: 1,\n  label: 'Process 1D workspace',\n  display: {\n    general: {\n      disableMultipletAnalysis: true,\n    },\n\n    panels: {\n      zonesPanel: { display: true },\n      summaryPanel: { display: true },\n      multipleSpectraAnalysisPanel: { display: true, open: true },\n      spectraPanel: { display: true, open: true },\n      informationPanel: { hidden: true },\n      peaksPanel: { hidden: true },\n      integralsPanel: { hidden: true },\n      rangesPanel: { hidden: true },\n      structuresPanel: { hidden: true },\n      filtersPanel: { hidden: true },\n      databasePanel: { hidden: true },\n      predictionPanel: { hidden: true },\n    },\n\n    toolBarButtons: {\n      import: false,\n      exportAs: false,\n      autoRangesTool: false,\n      multipleSpectraAnalysisTool: false,\n      exclusionZonesTool: false,\n    },\n  },\n  controllers: basic.controllers,\n  formatting: basic.formatting,\n  databases: basic.databases,\n};\n","import { basic } from './basic';\nimport { embedded } from './embedded';\nimport { exercise } from './exercise';\nimport { prediction } from './prediction';\nimport { process1D } from './process1D';\n\nexport default { exercise, default: basic, process1D, prediction, embedded };\n","import { Draft, produce, original } from 'immer';\nimport lodashMerge from 'lodash/merge';\n\nimport generateID from '../../data/utilities/generateID';\nimport { NMRiumWorkspace, NMRiumPreferences } from '../NMRium';\nimport {\n  getLocalStorage,\n  removeData,\n  storeData,\n} from '../utility/LocalStorage';\nimport Workspaces from '../workspaces';\nimport { Formatting, Workspace } from '../workspaces/Workspace';\n\nimport { ActionType } from './types/Types';\n\ntype InitPreferencesAction = ActionType<\n  'INIT_PREFERENCES',\n  { display: NMRiumPreferences; workspace: NMRiumWorkspace; dispatch: any }\n>;\ntype SetPreferencesAction = ActionType<\n  'SET_PREFERENCES',\n  Omit<Workspace, 'version' | 'label'>\n>;\ntype SetPanelsPreferencesAction = ActionType<\n  'SET_PANELS_PREFERENCES',\n  { key: string; value: string }\n>;\n\ntype WorkspaceAction = ActionType<\n  'SET_WORKSPACE' | 'REMOVE_WORKSPACE',\n  { workspace: string }\n>;\ntype AddWorkspaceAction = ActionType<\n  'ADD_WORKSPACE',\n  { workspace: string; data: Omit<Workspace, 'version' | 'label'> }\n>;\n\ntype PreferencesActions =\n  | InitPreferencesAction\n  | SetPreferencesAction\n  | ActionType<'RESET_PREFERENCES'>\n  | SetPanelsPreferencesAction\n  | WorkspaceAction\n  | AddWorkspaceAction;\n\nconst LOCAL_STORAGE_VERSION = 7;\n\nexport const WORKSPACES: Array<{\n  key: NMRiumWorkspace;\n  label: string;\n}> = [\n  {\n    key: 'default',\n    label: Workspaces.default.label,\n  },\n  {\n    key: 'process1D',\n    label: Workspaces.process1D.label,\n  },\n  {\n    key: 'exercise',\n    label: Workspaces.exercise.label,\n  },\n  {\n    key: 'prediction',\n    label: Workspaces.prediction.label,\n  },\n  {\n    key: 'embedded',\n    label: Workspaces.embedded.label,\n  },\n];\n\nfunction getPreferencesByWorkspace(workspace: NMRiumWorkspace) {\n  return Workspaces?.[workspace] || {};\n}\n\nexport interface PreferencesState {\n  version: number;\n  workspaces: Record<string, Workspace>;\n  dispatch: (action?: PreferencesActions) => void;\n  workspace: {\n    current: NMRiumWorkspace;\n    base: NMRiumWorkspace | null;\n  };\n}\n\nfunction getActiveWorkspace(draft: Draft<PreferencesState>) {\n  return draft.workspaces[draft.workspace.current || 'default'];\n}\n\nexport const preferencesInitialState: PreferencesState = {\n  version: LOCAL_STORAGE_VERSION,\n  workspaces: {},\n  dispatch: () => null,\n  workspace: {\n    current: 'default',\n    base: null,\n  },\n};\n\nfunction filterObject(data: any) {\n  return JSON.parse(JSON.stringify(data), (key, value) => {\n    if (value?.hidden !== true) {\n      return value;\n    }\n  });\n}\nfunction FlatObject(data: any) {\n  let result = {};\n  JSON.parse(JSON.stringify(data), (key, value) => {\n    if (value?.hidden !== true && key) {\n      result[key] = result[key]++ || 1;\n    }\n  });\n  return result;\n}\n\nfunction checkKeysExists(sourceObject, targetObject) {\n  const source = FlatObject(sourceObject);\n  const target = FlatObject(targetObject);\n\n  if (Object.keys(target).length === 0) {\n    return false;\n  }\n\n  for (const [key, value] of Object.entries(source)) {\n    if (!target[key] || target[key] !== value) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nfunction mapNucleiFormatting(formatting: Formatting) {\n  const { nuclei, ...res } = formatting;\n  const _nuclei = Object.keys(nuclei).reduce((nucleusFormatting, key) => {\n    nucleusFormatting[nuclei[key].name.trim().toLowerCase()] = nuclei[key];\n    return nucleusFormatting;\n  }, {});\n  return { nuclei: _nuclei, ...res };\n}\n\nexport function initPreferencesState(\n  state: PreferencesState,\n): PreferencesState {\n  const nmrLocalStorageVersion = getLocalStorage(\n    'nmr-local-storage-version',\n    false,\n  );\n\n  let localData = getLocalStorage('nmr-general-settings');\n\n  // remove old nmr-local-storage-version key\n  if (nmrLocalStorageVersion && localData?.version) {\n    removeData('nmr-local-storage-version');\n  }\n\n  //  if the local setting version != current settings version number\n  if (!localData?.version || localData?.version !== LOCAL_STORAGE_VERSION) {\n    removeData('nmr-general-settings');\n  }\n  return {\n    ...state,\n    workspaces: localData?.workspaces || { default: Workspaces.default },\n  };\n}\n\nfunction handleInit(draft: Draft<PreferencesState>, action) {\n  if (action.payload) {\n    const localData = getLocalStorage('nmr-general-settings');\n\n    const { dispatch, workspace, ...resProps } = action.payload;\n    /**\n     * set the current workspace what the user-defined in the setting if the workspace is not defined at the level of component, otherwise\n     * use the default workspace\n     *\n     */\n    draft.workspace =\n      !workspace && localData?.currentWorkspace\n        ? { current: localData.currentWorkspace, base: null }\n        : { current: workspace || 'default', base: workspace };\n\n    const workspacePreferences = lodashMerge(\n      {},\n      getPreferencesByWorkspace(draft.workspace.current),\n      resProps,\n    );\n    const currentWorkspacePreferences = getActiveWorkspace(draft);\n\n    /**\n     * Update the local storage general preferences\n     * 1- if local storage is empty.\n     * 2- if predefine workspaces.\n     * 3- b) if workspace not exists in the local storage\n     *    c) if the local setting workspace version != current workspace version number\n     *    d) if hard code workspace parameters !=  current workspace parameters\n     */\n    if (\n      (Workspaces[draft.workspace.current] &&\n        (!currentWorkspacePreferences ||\n          workspacePreferences?.version !==\n            currentWorkspacePreferences?.version ||\n          !checkKeysExists(\n            workspacePreferences.display,\n            currentWorkspacePreferences?.display,\n          ))) ||\n      !localData\n    ) {\n      const {\n        workspaces,\n        version,\n        workspace: { current },\n      } = draft || {};\n      const display = filterObject(workspacePreferences.display);\n\n      const data = {\n        version,\n        ...(localData?.currentWorkspace && {\n          currentWorkspace: localData?.currentWorkspace,\n        }),\n        workspaces: {\n          ...workspaces,\n          [current]: {\n            ...workspacePreferences,\n            display,\n          },\n        },\n      };\n\n      draft.workspaces[current] = lodashMerge(\n        {},\n        currentWorkspacePreferences,\n        workspacePreferences,\n      );\n      storeData('nmr-general-settings', JSON.stringify(data));\n    } else {\n      currentWorkspacePreferences.display = lodashMerge(\n        {},\n        workspacePreferences.display,\n        currentWorkspacePreferences.display,\n      );\n    }\n\n    draft.dispatch = dispatch;\n  }\n}\n\nfunction handleSetPreferences(draft: Draft<PreferencesState>, action) {\n  if (action.payload) {\n    const currentWorkspacePreferences = getActiveWorkspace(draft);\n\n    let { controllers, formatting, display, databases } = action.payload;\n    formatting = mapNucleiFormatting(formatting);\n    let localData = getLocalStorage('nmr-general-settings');\n    localData.currentWorkspace = draft.workspace.current;\n    localData.workspaces = {\n      ...localData.workspaces,\n      [draft.workspace.current]: {\n        ...localData.workspaces[draft.workspace.current],\n        controllers,\n        formatting,\n        display,\n        databases,\n      },\n    };\n\n    storeData('nmr-general-settings', JSON.stringify(localData));\n\n    currentWorkspacePreferences.controllers = controllers;\n    currentWorkspacePreferences.formatting = formatting;\n    currentWorkspacePreferences.databases = databases;\n    currentWorkspacePreferences.display = {\n      ...currentWorkspacePreferences.display,\n      panels: display.panels,\n      general: {\n        ...(currentWorkspacePreferences.display.general || {}),\n        experimentalFeatures: display.general.experimentalFeatures,\n      },\n    };\n  }\n}\nfunction handleSetPanelsPreferences(draft: Draft<PreferencesState>, action) {\n  if (action.payload) {\n    const currentWorkspacePreferences = getActiveWorkspace(draft);\n\n    const { key, value } = action.payload;\n    let localData = getLocalStorage('nmr-general-settings');\n    localData.workspaces[draft.workspace.current].formatting.panels[key] =\n      value;\n    storeData('nmr-general-settings', JSON.stringify(localData));\n    currentWorkspacePreferences.formatting.panels[key] = value;\n  }\n}\nfunction handleResetPreferences(draft: Draft<PreferencesState>) {\n  const currentWorkspacePreferences = getActiveWorkspace(draft);\n  let localData = getLocalStorage('nmr-general-settings');\n  const workSpaceDisplayPreferences = getPreferencesByWorkspace(\n    draft.workspace.current,\n  ).display;\n\n  if (localData.workspaces[draft.workspace.current]) {\n    localData.workspaces[draft.workspace.current].display =\n      workSpaceDisplayPreferences;\n    storeData('nmr-general-settings', JSON.stringify(localData));\n  }\n  currentWorkspacePreferences.display = workSpaceDisplayPreferences;\n}\nfunction handleSetWorkspace(\n  draft: Draft<PreferencesState>,\n  action: WorkspaceAction,\n) {\n  const workspaceKey = action.payload.workspace;\n  if (!draft.workspaces[workspaceKey]) {\n    draft.workspaces[workspaceKey] = getPreferencesByWorkspace(\n      workspaceKey as NMRiumWorkspace,\n    );\n  }\n  draft.workspace.current = workspaceKey as NMRiumWorkspace;\n}\nfunction handleAddWorkspace(\n  draft: Draft<PreferencesState>,\n  action: AddWorkspaceAction,\n) {\n  const {\n    workspace: workspaceName,\n    data: { display, controllers, formatting, databases },\n  } = action.payload;\n  const newWorkSpace = {\n    version: 1,\n    label: workspaceName,\n    display,\n    controllers,\n    formatting,\n    databases,\n  };\n  const newWorkspaceKey = generateID();\n  const localData = getLocalStorage('nmr-general-settings');\n\n  localData.workspaces[newWorkspaceKey] = newWorkSpace;\n  storeData('nmr-general-settings', JSON.stringify(localData));\n  draft.workspaces[newWorkspaceKey] = newWorkSpace;\n  draft.workspace.current = newWorkspaceKey as any;\n}\nfunction handleRemoveWorkspace(\n  draft: Draft<PreferencesState>,\n  action: WorkspaceAction,\n) {\n  const { workspace } = action.payload;\n\n  if (workspace === draft.workspace.current) {\n    draft.workspace.current = 'default';\n  }\n\n  let localData = getLocalStorage('nmr-general-settings');\n  const storedWorkspaces = original(draft)?.workspaces || {};\n  const workspaces = Object.keys(storedWorkspaces).reduce((acc, key) => {\n    if (key !== workspace) {\n      acc[key] = storedWorkspaces[key];\n    }\n    return acc;\n  }, {});\n  draft.workspaces = workspaces;\n  localData.workspaces = filterObject(workspaces);\n  storeData('nmr-general-settings', JSON.stringify(localData));\n}\n\nfunction innerPreferencesReducer(\n  draft: Draft<PreferencesState>,\n  action: PreferencesActions,\n) {\n  switch (action.type) {\n    case 'INIT_PREFERENCES':\n      return handleInit(draft, action);\n    case 'SET_PREFERENCES':\n      return handleSetPreferences(draft, action);\n    case 'SET_PANELS_PREFERENCES':\n      return handleSetPanelsPreferences(draft, action);\n    case 'RESET_PREFERENCES':\n      return handleResetPreferences(draft);\n    case 'SET_WORKSPACE':\n      return handleSetWorkspace(draft, action);\n    case 'ADD_WORKSPACE':\n      return handleAddWorkspace(draft, action);\n    case 'REMOVE_WORKSPACE':\n      return handleRemoveWorkspace(draft, action);\n    default:\n      return draft;\n  }\n}\nconst preferencesReducer = produce(innerPreferencesReducer);\n\nexport default preferencesReducer;\n","import { createContext, useContext, useMemo } from 'react';\n\nimport {\n  preferencesInitialState,\n  PreferencesState,\n  WORKSPACES,\n} from '../reducer/preferencesReducer';\nimport Workspaces from '../workspaces';\n\nexport const PreferencesContext = createContext<PreferencesState>(\n  preferencesInitialState,\n);\nexport const PreferencesProvider = PreferencesContext.Provider;\n\nexport function usePreferences() {\n  const context = useContext(PreferencesContext);\n  if (!context) {\n    throw new Error('Preferences context was not found');\n  }\n\n  const { workspace, workspaces, dispatch } = context;\n\n  return useMemo(() => {\n    return {\n      current: workspaces[workspace.current] || {},\n      workspace,\n      workspaces,\n      dispatch,\n    };\n  }, [dispatch, workspace, workspaces]);\n}\n\nexport function useWorkspacesList() {\n  const { workspaces } = usePreferences();\n  return useMemo(() => {\n    const currentWorkspaces = Object.keys(workspaces).reduce<\n      { key: string; label: string }[]\n    >((acc, key) => {\n      if (!Workspaces[key]) {\n        acc.push({ key, label: workspaces[key].label });\n      }\n      return acc;\n    }, []);\n\n    return [...WORKSPACES, ...currentWorkspaces];\n  }, [workspaces]);\n}\n","export class PathBuilder {\n  private array: Array<string> = [];\n\n  public moveTo(x: number, y: number) {\n    this.array.push(`M ${x} ${y}`);\n  }\n\n  public lineTo(x: number, y: number) {\n    this.array.push(`L ${x} ${y}`);\n  }\n\n  public closePath() {\n    this.array.push('Z');\n  }\n\n  public toString() {\n    return this.array.join(' ');\n  }\n}\n","import get from 'lodash/get';\nimport { memo, useMemo } from 'react';\n\nimport { getShift } from '../../data/data2d/Spectrum2D';\nimport { Datum2D } from '../../data/types/data2d';\nimport { useChartData } from '../context/ChartContext';\nimport { usePreferences } from '../context/PreferencesContext';\nimport { PathBuilder } from '../utility/PathBuilder';\n\nimport { get2DXScale, get2DYScale } from './utilities/scale';\n\ninterface ContoursPathsProps {\n  id: string;\n  color: string;\n  sign: string;\n  datum: Datum2D;\n}\n\nfunction ContoursPaths({\n  id: spectrumID,\n  sign,\n  color,\n  datum,\n}: ContoursPathsProps) {\n  const { margin, width, height, xDomain, yDomain, contours, activeSpectrum } =\n    useChartData();\n\n  const preferences = usePreferences();\n  const { xShift, yShift } = getShift(datum);\n\n  const isActive = useMemo(() => {\n    return activeSpectrum === null\n      ? true\n      : spectrumID === activeSpectrum.id\n      ? true\n      : false;\n  }, [activeSpectrum, spectrumID]);\n\n  function buildContourPath(data) {\n    const _scaleX = get2DXScale({ margin, width, xDomain });\n    const _scaleY = get2DYScale({ margin, height, yDomain });\n    const path = new PathBuilder();\n\n    for (const element of data) {\n      if (element.lines) {\n        const lines = element.lines;\n        if (lines.length < 1e6) {\n          for (let i = 0; i < lines.length; i += 4) {\n            path.moveTo(\n              _scaleX(lines[i] + xShift),\n              _scaleY(lines[i + 1] + yShift),\n            );\n            path.lineTo(\n              _scaleX(lines[i + 2] + xShift),\n              _scaleY(lines[i + 3] + yShift),\n            );\n          }\n        }\n      } else {\n        path.moveTo(\n          _scaleX(element[0].x + xShift),\n          _scaleY(element[0].y + yShift),\n        );\n\n        for (let j = 1; j < element.length; j++) {\n          path.lineTo(\n            _scaleX(element[j].x + xShift),\n            _scaleY(element[j].y + yShift),\n          );\n        }\n      }\n    }\n\n    path.closePath();\n    return path.toString();\n  }\n\n  const data = useMemo(() => {\n    return get(contours, `${spectrumID}.${sign}`, []);\n  }, [contours, sign, spectrumID]);\n\n  return (\n    <path\n      fill=\"none\"\n      data-test-id=\"spectrum-line\"\n      stroke={color}\n      strokeWidth=\"1\"\n      style={{\n        opacity: isActive\n          ? 1\n          : get(\n              preferences.current,\n              'controllers.dimmedSpectraTransparency',\n              0.1,\n            ),\n      }}\n      d={buildContourPath(data)}\n    />\n  );\n}\n\ninterface ContoursInnerProps {\n  data: Array<Datum2D>;\n  displayerKey: string;\n}\n\nfunction ContoursInner({ data, displayerKey }: ContoursInnerProps) {\n  return (\n    <g clipPath={`url(#${displayerKey}clip-chart-2d)`} className=\"contours\">\n      {data?.map((datum, index) => (\n        <g key={`${datum.id + index}`}>\n          {datum.display.isPositiveVisible && (\n            <ContoursPaths\n              id={datum.id}\n              sign=\"positive\"\n              datum={datum}\n              color={datum.display.positiveColor}\n            />\n          )}\n          {datum.display.isNegativeVisible && (\n            <ContoursPaths\n              id={datum.id}\n              sign=\"negative\"\n              datum={datum}\n              color={datum.display.negativeColor}\n            />\n          )}\n        </g>\n      ))}\n    </g>\n  );\n}\n\nconst MemoizedContours = memo(ContoursInner);\n\nexport default function Contours() {\n  const { data: spectra, displayerKey } = useChartData();\n  const data = useMemo<Array<Datum2D>>(() => {\n    return spectra.filter(\n      (datum) => datum.info.dimension === 2 && datum.info.isFt,\n    ) as Array<Datum2D>;\n  }, [spectra]);\n\n  return <MemoizedContours {...{ data, displayerKey }} />;\n}\n","import { DataXY, DoubleArray } from 'cheminfo-types';\nimport { xyReduce } from 'ml-spectra-processing';\nimport { useCallback } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\n\nexport enum XYReducerDomainAxis {\n  XAxis = 'XAxis',\n  YAxis = 'YAxis',\n}\n\ntype XYReducerDomainAxisType = keyof typeof XYReducerDomainAxis;\n\nexport default function useXYReduce(\n  domainAxis: XYReducerDomainAxisType,\n): (data: { x: number[]; y: number[] }) => DataXY<DoubleArray> {\n  const { width, xDomain, yDomain } = useChartData();\n\n  return useCallback(\n    (data: { x: number[]; y: number[] }) => {\n      const { x, y } = data;\n      const [from, to] =\n        domainAxis === XYReducerDomainAxis.XAxis ? xDomain : yDomain;\n      return xyReduce(\n        { x, y },\n        { from, to, nbPoints: width * 4, optimize: true },\n      );\n    },\n    [domainAxis, width, xDomain, yDomain],\n  );\n}\n","import { useMemo, memo } from 'react';\n\nimport { Datum1D } from '../../data/types/data1d';\nimport { useChartData } from '../context/ChartContext';\nimport useXYReduce, { XYReducerDomainAxis } from '../hooks/useXYReduce';\nimport { PathBuilder } from '../utility/PathBuilder';\n\nimport { get1DYScale, get2DYScale } from './utilities/scale';\n\ninterface Left1DChartProps {\n  margin?: number;\n  data: Datum1D;\n}\n\nfunction Left1DChart({\n  margin: marignValue = 10,\n  data: spectrum,\n}: Left1DChartProps) {\n  const {\n    height: originHeight,\n    margin,\n    yDomain,\n    yDomains,\n    displayerKey,\n  } = useChartData();\n  const xyReduce = useXYReduce(XYReducerDomainAxis.YAxis);\n\n  const height = margin.left;\n\n  const paths = useMemo(() => {\n    if (spectrum) {\n      const scaleX = get2DYScale({\n        height: originHeight,\n        yDomain: [yDomain[0], yDomain[1]],\n        margin,\n      });\n      const scaleY = get1DYScale(yDomains[spectrum.id], height, marignValue);\n\n      const { x, re: y } = spectrum.data;\n      const pathPoints = xyReduce({ x, y });\n\n      const pathBuilder = new PathBuilder();\n\n      pathBuilder.moveTo(\n        scaleY(pathPoints.y[pathPoints.y.length - 1]),\n        scaleX(pathPoints.x.length - 1),\n      );\n\n      for (let i = pathPoints.x.length - 2; i >= 0; i--) {\n        pathBuilder.lineTo(scaleY(pathPoints.y[i]), scaleX(pathPoints.x[i]));\n      }\n\n      return pathBuilder.toString();\n    } else {\n      return undefined;\n    }\n  }, [\n    height,\n    margin,\n    marignValue,\n    originHeight,\n    spectrum,\n    xyReduce,\n    yDomain,\n    yDomains,\n  ]);\n\n  const mainHeight = originHeight - margin.bottom - margin.top;\n\n  if (!mainHeight || !height) return null;\n\n  return (\n    <svg\n      viewBox={`0 0 ${height} ${mainHeight + margin.top}`}\n      width={height}\n      height={mainHeight + margin.top}\n    >\n      <defs>\n        <clipPath id={`${displayerKey}clip-left`}>\n          <rect width={height} height={mainHeight} x=\"0\" y={margin.top} />\n        </clipPath>\n      </defs>\n      <g clipPath={`url(#${displayerKey}clip-left)`}>\n        <path className=\"line\" stroke=\"black\" fill=\"none\" d={paths} />\n      </g>\n    </svg>\n  );\n}\n\nexport default memo(Left1DChart);\n","import { useMemo, memo } from 'react';\n\nimport { Datum1D } from '../../data/types/data1d';\nimport { useChartData } from '../context/ChartContext';\nimport useXYReduce, { XYReducerDomainAxis } from '../hooks/useXYReduce';\nimport { PathBuilder } from '../utility/PathBuilder';\n\nimport { get1DYScale, get2DXScale } from './utilities/scale';\n\ninterface Top1DChartProps {\n  margin?: number;\n  data: Datum1D;\n}\n\nfunction Top1DChart({\n  margin: marginProps = 10,\n  data: spectrum,\n}: Top1DChartProps) {\n  const {\n    width,\n    margin: originMargin,\n    xDomain,\n    yDomains,\n    displayerKey,\n  } = useChartData();\n  const xyReduce = useXYReduce(XYReducerDomainAxis.XAxis);\n  const height = originMargin.top;\n\n  const paths = useMemo(() => {\n    if (spectrum) {\n      const scaleX = get2DXScale({ width, xDomain, margin: originMargin });\n      const scaleY = get1DYScale(yDomains[spectrum.id], height, marginProps);\n      const { x, re: y } = spectrum.data;\n      const pathPoints = xyReduce({ x, y });\n\n      const pathBuilder = new PathBuilder();\n      pathBuilder.moveTo(scaleX(pathPoints.x[0]), scaleY(pathPoints.y[0]));\n      for (let i = 1; i < pathPoints.x.length; i++) {\n        pathBuilder.lineTo(scaleX(pathPoints.x[i]), scaleY(pathPoints.y[i]));\n      }\n\n      return pathBuilder.toString();\n    } else {\n      return undefined;\n    }\n  }, [\n    height,\n    marginProps,\n    originMargin,\n    spectrum,\n    width,\n    xDomain,\n    xyReduce,\n    yDomains,\n  ]);\n\n  if (!width || !height) {\n    return null;\n  }\n\n  return (\n    <svg viewBox={`0 0 ${width} ${height}`} width={width} height={height}>\n      <defs>\n        <clipPath id={`${displayerKey}clip-top`}>\n          <rect\n            width={width - originMargin.left - originMargin.right}\n            height={height}\n            x={originMargin.left}\n            y={`${0}`}\n          />\n        </clipPath>\n      </defs>\n      <g clipPath={`url(#${displayerKey}clip-top)`}>\n        <path\n          className=\"line\"\n          stroke=\"red\"\n          fill=\"none\"\n          strokeWidth=\"1px\"\n          d={paths}\n        />\n      </g>\n    </svg>\n  );\n}\n\nexport default memo(Top1DChart);\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport * as d3 from 'd3';\nimport { useEffect, useRef, memo } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\n\nimport { get2DXScale } from './utilities/scale';\n\nconst axisStyles = css`\n  user-select: none;\n\n  path,\n  line {\n    fill: none;\n    stroke: black;\n    stroke-width: 1;\n    shape-rendering: crispEdges;\n    user-select: none;\n  }\n`;\n\nconst defaultMargin = { right: 100, top: 0, left: 0, bottom: 0 };\n\ninterface XAxisProps {\n  show?: boolean;\n  label?: string;\n  margin?: {\n    top: number;\n    right: number;\n    bottom: number;\n    left: number;\n  };\n}\n\nfunction XAxis(props: XAxisProps) {\n  const {\n    show = true,\n    label = 'δ [ppm]',\n    margin: marginProps = defaultMargin,\n  } = props;\n\n  const state = useChartData();\n  const { xDomain, height, width, margin, tabActiveSpectrum, activeTab } =\n    state;\n\n  const refAxis = useRef<SVGGElement>(null);\n\n  useEffect(() => {\n    if (!show) return;\n    const scaleX = get2DXScale({ width, margin, xDomain });\n    const xAxis = d3.axisBottom(scaleX).ticks(8).tickFormat(d3.format('0'));\n\n    // @ts-expect-error actually well typed\n    d3.select(refAxis.current).call(xAxis);\n  }, [\n    activeTab,\n    height,\n    margin,\n    margin.bottom,\n    margin.left,\n    margin.right,\n    margin.top,\n    show,\n    tabActiveSpectrum,\n    width,\n    xDomain,\n  ]);\n\n  if (!width || !height) {\n    return null;\n  }\n\n  return (\n    <>\n      {show && (\n        <g\n          className=\"x\"\n          css={axisStyles}\n          transform={`translate(0,${\n            height - (margin.bottom + marginProps.bottom)\n          })`}\n          ref={refAxis}\n        >\n          <text fill=\"#000\" x={width - 60} y=\"20\" dy=\"0.71em\" textAnchor=\"end\">\n            {label}\n          </text>\n        </g>\n      )}\n    </>\n  );\n}\n\nexport default memo(XAxis);\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport * as d3 from 'd3';\nimport { useEffect, useRef, memo } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\n\nimport { get2DYScale } from './utilities/scale';\n\nconst axisStyles = css`\n  user-select: 'none';\n  -webkit-user-select: none; /* Chrome all / Safari all */\n  -moz-user-select: none; /* Firefox all */\n\n  path,\n  line {\n    fill: none;\n    stroke: black;\n    stroke-width: 1;\n    shape-rendering: crispEdges;\n    user-select: 'none';\n    -webkit-user-select: none; /* Chrome all / Safari all */\n    -moz-user-select: none; /* Firefox all */\n  }\n`;\n\nconst defaultMargin = { right: 50, top: 0, bottom: 0, left: 0 };\n\ninterface YAxisProps {\n  show?: boolean;\n  label?: string;\n  margin?: {\n    right: number;\n    top: number;\n    bottom: number;\n    left: number;\n  };\n}\n\nfunction YAxis(props: YAxisProps) {\n  const {\n    show = true,\n    label = '',\n    margin: marginProps = defaultMargin,\n  } = props;\n\n  const refAxis = useRef<SVGGElement>(null);\n\n  const state = useChartData();\n  const { yDomain, width, height, activeTab, tabActiveSpectrum, margin } =\n    state;\n\n  useEffect(() => {\n    if (!show || !yDomain) return;\n    const scaleY = get2DYScale({ height, yDomain, margin });\n\n    const axis = d3.axisRight(scaleY).ticks(8).tickFormat(d3.format('0'));\n\n    // @ts-expect-error well typed\n    d3.select(refAxis.current).call(axis);\n  }, [show, yDomain, activeTab, tabActiveSpectrum, height, margin]);\n\n  if (!width || !height) {\n    return null;\n  }\n\n  return (\n    <>\n      <g\n        className=\"y\"\n        css={axisStyles}\n        transform={`translate(${width - marginProps.right})`}\n        ref={refAxis}\n      >\n        <text\n          fill=\"#000\"\n          x={-marginProps.top}\n          y={-(marginProps.right - 5)}\n          dy=\"0.71em\"\n          transform=\"rotate(-90)\"\n          textAnchor=\"end\"\n        >\n          {label}\n        </text>\n      </g>\n    </>\n  );\n}\n\nexport default memo(YAxis);\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useState, useEffect, useMemo } from 'react';\n\nimport { SignalKindsToInclude } from '../../../data/constants/SignalsKinds';\nimport { isSpectrum1D } from '../../../data/data1d/Spectrum1D';\nimport { useChartData } from '../../context/ChartContext';\nimport { get2DXScale, get2DYScale } from '../utilities/scale';\n\nconst lineStyle = css`\n  stroke: lightgrey;\n  opacity: 0.7;\n`;\n\ninterface IndicationLinesProps {\n  show: boolean;\n  axis: 'X' | 'Y';\n}\n\nfunction IndicationLines({ axis, show }: IndicationLinesProps) {\n  const {\n    data,\n    activeTab,\n    margin,\n    width,\n    height,\n    xDomain,\n    yDomain,\n    displayerMode,\n  } = useChartData();\n  const [deltas1D, setDeltas1D] = useState<Array<number>>([]);\n\n  const scaleX = get2DXScale({ margin, width, xDomain });\n  const scaleY = get2DYScale({ margin, height, yDomain });\n\n  useEffect(() => {\n    const split = activeTab.split(',');\n\n    const nucleus = axis === 'X' ? split[0] : axis === 'Y' ? split[1] : null;\n    if (nucleus !== null) {\n      const ranges = data\n        .filter(\n          (_datum) =>\n            _datum.display.isVisible === true &&\n            _datum.info.nucleus === nucleus,\n        )\n        .filter(isSpectrum1D)\n        .map((_datum) => _datum.ranges.values)\n        .flat();\n\n      const deltas = ranges\n        .map((_range) =>\n          _range.signals\n            .filter((_signal) =>\n              SignalKindsToInclude.some((_kind) => _signal.kind === _kind),\n            )\n            .map((_signal) => _signal.delta),\n        )\n        .flat();\n      setDeltas1D(deltas);\n    } else {\n      setDeltas1D([]);\n    }\n  }, [activeTab, axis, data, displayerMode]);\n\n  const indicationLines = useMemo(() => {\n    if (show === true && deltas1D.length > 0) {\n      const lines = deltas1D.map((_delta, i) => {\n        return axis === 'X' ? (\n          <line\n            css={lineStyle}\n            // eslint-disable-next-line react/no-array-index-key\n            key={`indicationLine${axis}${i}`}\n            x1={scaleX(_delta)}\n            x2={scaleX(_delta)}\n            y1={scaleY(yDomain[0])}\n            y2={scaleY(yDomain[1])}\n          />\n        ) : axis === 'Y' ? (\n          <line\n            css={lineStyle}\n            // eslint-disable-next-line react/no-array-index-key\n            key={`indicationLine${axis}${i}`}\n            x1={scaleX(xDomain[0])}\n            x2={scaleX(xDomain[1])}\n            y1={scaleY(_delta)}\n            y2={scaleY(_delta)}\n          />\n        ) : null;\n      });\n      return lines;\n    }\n  }, [axis, deltas1D, scaleX, scaleY, show, xDomain, yDomain]);\n\n  return <g>{indicationLines}</g>;\n}\n\nexport default IndicationLines;\n","import EventEmitter from 'eventemitter3';\n\nconst eventEmitter = new EventEmitter();\n\nconst Emitter = {\n  on: (event, fn) => eventEmitter.on(event, fn),\n  once: (event, fn) => eventEmitter.once(event, fn),\n  off: (event, fn) => eventEmitter.off(event, fn),\n  emit: (event, payload) => eventEmitter.emit(event, payload),\n};\n\nObject.freeze(Emitter);\n\nexport default Emitter;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useMemo } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\n\nimport { get2DXScale, get2DYScale } from './utilities/scale';\n\nconst lineStyle = css`\n  stroke: green;\n  stroke-width: 2;\n  opacity: 0.5;\n`;\n\ninterface SignalDeltaLineProps {\n  delta: number;\n  axis: 'X' | 'Y';\n  show: boolean;\n}\n\nfunction SignalDeltaLine({ delta, axis, show }: SignalDeltaLineProps) {\n  const { margin, width, height, xDomain, yDomain } = useChartData();\n  const scaleX = get2DXScale({ margin, width, xDomain });\n  const scaleY = get2DYScale({ margin, height, yDomain });\n\n  const line = useMemo(() => {\n    return show === true ? (\n      axis === 'X' ? (\n        <line\n          css={lineStyle}\n          key={`signalLine_${delta}_X`}\n          x1={scaleX(delta)}\n          x2={scaleX(delta)}\n          y1={scaleY(yDomain[0])}\n          y2={scaleY(yDomain[1])}\n        />\n      ) : axis === 'Y' ? (\n        <line\n          css={lineStyle}\n          key={`signalLine_${delta}_Y`}\n          x1={scaleX(xDomain[0])}\n          x2={scaleX(xDomain[1])}\n          y1={scaleY(delta)}\n          y2={scaleY(delta)}\n        />\n      ) : null\n    ) : null;\n  }, [axis, delta, scaleX, scaleY, show, xDomain, yDomain]);\n\n  return <g>{line}</g>;\n}\n\nexport default SignalDeltaLine;\n","/** @jsxImportSource @emotion/react */\n\nimport { useMemo } from 'react';\n\nimport { Signal2D } from '../../../data/types/data2d';\nimport { buildID } from '../../../data/utilities/Concatenation';\nimport { useHighlight } from '../../highlight';\nimport SignalDeltaLine from '../SignalDeltaLine';\n\ninterface SignalCrosshairProps {\n  signal: Signal2D;\n}\n\nfunction SignalCrosshair({ signal }: SignalCrosshairProps) {\n  const highlightIDsX = useMemo(() => {\n    return [buildID(signal.id, 'Crosshair'), buildID(signal.id, 'Crosshair_X')];\n  }, [signal.id]);\n\n  const highlightIDsY = useMemo(() => {\n    return [buildID(signal.id, 'Crosshair'), buildID(signal.id, 'Crosshair_Y')];\n  }, [signal.id]);\n\n  const highlightX = useHighlight(highlightIDsX);\n  const highlightY = useHighlight(highlightIDsY);\n  const highlight = useHighlight([signal.id]);\n\n  if (!signal?.x?.delta || !signal?.y?.delta) return null;\n\n  return (\n    <g>\n      <SignalDeltaLine\n        delta={signal.x.delta}\n        axis=\"X\"\n        show={highlightX.isActive || highlight.isActive}\n      />\n      <SignalDeltaLine\n        delta={signal.y.delta}\n        axis=\"Y\"\n        show={highlightY.isActive || highlight.isActive}\n      />\n    </g>\n  );\n}\n\nexport default SignalCrosshair;\n","/** @jsxImportSource @emotion/react */\n\nimport { memo, useState, useEffect, useCallback } from 'react';\n\nimport { Signal2D } from '../../../data/types/data2d';\nimport { buildID } from '../../../data/utilities/Concatenation';\nimport { useAssignment } from '../../assignment/AssignmentsContext';\nimport { useChartData } from '../../context/ChartContext';\nimport { useHighlightData, useHighlight } from '../../highlight';\nimport { get2DXScale, get2DYScale } from '../utilities/scale';\n\nimport SignalCrosshair from './SignalCrosshair';\n\ninterface SignalProps {\n  signal: Signal2D;\n  isVisible: {\n    signals?: boolean;\n    peaks?: boolean;\n    zones?: boolean;\n  };\n}\n\nconst Signal = memo(({ signal, isVisible }: SignalProps) => {\n  const { margin, width, height, xDomain, yDomain } = useChartData();\n  const scaleX = get2DXScale({ margin, width, xDomain });\n  const scaleY = get2DYScale({ margin, height, yDomain });\n\n  const buildIDs = useCallback((id) => {\n    return [id].concat(buildID(id, 'X'), buildID(id, 'Y'));\n  }, []);\n\n  const assignment = useAssignment(signal.id);\n  const highlight = useHighlight(buildIDs(assignment.id));\n  const highlightData = useHighlightData();\n\n  const [isHighlighted, setIsHighlighted] = useState(false);\n\n  useEffect(() => {\n    if (\n      highlightData.highlight.highlighted.some((_highlighted) =>\n        buildIDs(signal.id).includes(_highlighted),\n      ) ||\n      assignment.isActive\n    ) {\n      setIsHighlighted(true);\n    } else {\n      setIsHighlighted(false);\n    }\n  }, [\n    assignment.isActive,\n    buildIDs,\n    highlightData.highlight.highlighted,\n    signal.id,\n  ]);\n\n  if (!signal) return null;\n\n  return (\n    <g className=\"zone-signal\">\n      {isVisible.signals && (\n        <g>\n          <SignalCrosshair signal={signal} />\n          <circle\n            onMouseEnter={() => {\n              assignment.show();\n              highlight.show();\n            }}\n            onMouseLeave={() => {\n              assignment.hide();\n              highlight.hide();\n            }}\n            key={signal.id}\n            cx={scaleX(signal.x.delta || 0)}\n            cy={scaleY(signal.y.delta || 0)}\n            r={isHighlighted ? 6 : 4}\n            fill={isHighlighted ? 'green' : 'darkgreen'}\n          />\n        </g>\n      )}\n      <g className=\"zone-signal-peak\" style={{ pointerEvents: 'none' }}>\n        {isVisible.peaks &&\n          signal.peaks &&\n          signal.peaks.map((peak, i) => (\n            <circle\n              key={`${signal.id + i}`}\n              cx={scaleX(peak.x)}\n              cy={scaleY(peak.y)}\n              r={2}\n              fill=\"black\"\n            />\n          ))}\n      </g>\n    </g>\n  );\n});\n\nexport default Signal;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useState, useEffect } from 'react';\n\nimport { Zone as ZoneDataProps } from '../../../data/types/data2d';\nimport { checkZoneKind } from '../../../data/utilities/ZoneUtilities';\nimport { useAssignment } from '../../assignment/AssignmentsContext';\nimport { useChartData } from '../../context/ChartContext';\nimport { HighlightedSource, useHighlight } from '../../highlight';\nimport { get2DXScale, get2DYScale } from '../utilities/scale';\n\nimport Signal from './Signal';\n\nconst stylesOnHover = css`\n  pointer-events: bounding-box;\n  @-moz-document url-prefix() {\n    pointer-events: fill;\n  }\n  user-select: 'none';\n  -webkit-user-select: none; /* Chrome all / Safari all */\n  -moz-user-select: none; /* Firefox all */\n\n  .delete-button {\n    visibility: hidden;\n  }\n`;\n\nconst stylesHighlighted = css`\n  pointer-events: bounding-box;\n\n  @-moz-document url-prefix() {\n    pointer-events: fill;\n  }\n  .Integral-area {\n    fill: #ff6f0057;\n  }\n  .delete-button {\n    visibility: visible;\n    cursor: pointer;\n  }\n`;\n\ninterface ZoneProps {\n  zoneData: ZoneDataProps;\n  isVisible: {\n    zones: boolean;\n  };\n}\n\nconst Zone = ({ zoneData, isVisible }: ZoneProps) => {\n  const { x, y, id, signals } = zoneData;\n  const assignmentZone = useAssignment(id);\n  const highlightZone = useHighlight([assignmentZone.id], {\n    type: HighlightedSource.ZONE,\n    extra: { id: assignmentZone.id },\n  });\n  const { margin, width, height, xDomain, yDomain } = useChartData();\n  const scaleX = get2DXScale({ margin, width, xDomain });\n  const scaleY = get2DYScale({ margin, height, yDomain });\n\n  const { from: x1 = 0, to: x2 = 0 } = x;\n  const { from: y1 = 0, to: y2 = 0 } = y;\n\n  const [reduceOpacity, setReduceOpacity] = useState(false);\n\n  useEffect(() => {\n    setReduceOpacity(!checkZoneKind(zoneData));\n  }, [zoneData]);\n\n  return (\n    <g\n      css={\n        highlightZone.isActive || assignmentZone.isActive\n          ? stylesHighlighted\n          : stylesOnHover\n      }\n      key={id}\n      onMouseEnter={() => {\n        assignmentZone.show();\n        highlightZone.show();\n      }}\n      onMouseLeave={() => {\n        assignmentZone.hide();\n        highlightZone.hide();\n      }}\n    >\n      {isVisible.zones && (\n        <g transform={`translate(${scaleX(x2)},${scaleY(y1)})`}>\n          <rect\n            x=\"0\"\n            width={scaleX(x1) - scaleX(x2)}\n            height={scaleY(y2) - scaleY(y1)}\n            className=\"Integral-area\"\n            fill=\"#0000000f\"\n            stroke={reduceOpacity ? '#343a40' : 'darkgreen'}\n            strokeWidth={reduceOpacity ? '0' : '1'}\n          />\n        </g>\n      )}\n      {signals.map((_signal, i) => (\n        <Signal key={`${id + i}`} signal={_signal} isVisible={isVisible} />\n      ))}\n    </g>\n  );\n};\n\nexport default Zone;\n","import { useEffect, useState, memo } from 'react';\n\nimport {\n  Datum2D,\n  Display2D,\n  Zones as ZonesProps,\n} from '../../../data/types/data2d';\nimport { useChartData } from '../../context/ChartContext';\nimport useSpectrum from '../../hooks/useSpectrum';\nimport Events from '../../utility/Events';\n\nimport Zone from './Zone';\n\ninterface ZonesInnerProps {\n  zones: ZonesProps;\n  display: Display2D;\n  displayerKey: string;\n}\n\nfunction ZonesInner({ zones, display, displayerKey }: ZonesInnerProps) {\n  const [isVisible, setVisibility] = useState({\n    zones: true,\n    signals: true,\n    peaks: true,\n  });\n\n  useEffect(() => {\n    Events.on('onZonesVisibilityChange', ({ key }) => {\n      setVisibility((prevVisiblity) => ({\n        ...prevVisiblity,\n        [key]: !prevVisiblity[key],\n      }));\n    });\n  }, []);\n\n  return (\n    <g clipPath={`url(#${displayerKey}clip-chart-2d)`} className=\"2D-Zones\">\n      {display.isVisible &&\n        zones.values.map((zone) => (\n          <g className=\"zone\" key={zone.id}>\n            <Zone zoneData={zone} isVisible={isVisible} />\n          </g>\n        ))}\n    </g>\n  );\n}\n\nconst MemoizedZones = memo(ZonesInner);\n\nconst emptyData = { zones: {}, display: {} };\n\nexport default function Zones() {\n  const { displayerKey } = useChartData();\n\n  const { zones, display } = useSpectrum(emptyData) as Datum2D;\n\n  return <MemoizedZones {...{ zones, display, displayerKey }} />;\n}\n","import { memo } from 'react';\n\nimport { Datum1D } from '../../data/types/data1d';\nimport { useChartData } from '../context/ChartContext';\nimport { Margin } from '../reducer/Reducer';\nimport FloatMoleculeStructures from '../tool/FloatMoleculeStructures';\n\nimport Contours from './Contours';\nimport Left1DChart from './Left1DChart';\nimport Top1DChart from './Top1DChart';\nimport XAxis from './XAxis';\nimport YAxis from './YAxis';\nimport IndicationLines from './zones/IndicationLines';\nimport Zones from './zones/Zones';\n\ninterface Chart2DProps {\n  spectra?: Datum1D[];\n}\n\ninterface Chart2DInnerProps extends Chart2DProps {\n  width: number;\n  height: number;\n  margin: Margin;\n  displayerKey: string;\n}\n\nfunction chart2DInner({\n  spectra,\n  width,\n  height,\n  margin,\n  displayerKey,\n}: Chart2DInnerProps) {\n  return (\n    <svg\n      viewBox={`0 0 ${width} ${height}`}\n      width={width}\n      height={height}\n      id=\"nmrSVG\"\n    >\n      <defs>\n        <clipPath id={`${displayerKey}clip-chart-2d`}>\n          <rect\n            width={width - margin.left - margin.right}\n            height={height - margin.top - margin.bottom}\n            x={margin.left}\n            y={margin.top}\n          />\n        </clipPath>\n      </defs>\n      <rect\n        width={width - margin.left - margin.right}\n        height={height - margin.top - margin.bottom}\n        x={margin.left}\n        y={margin.top}\n        stroke=\"black\"\n        strokeWidth=\"1\"\n        fill=\"transparent\"\n      />\n      {spectra?.[0] && <Top1DChart data={spectra[0]} />}\n      {spectra?.[1] && <Left1DChart data={spectra[1]} />}\n      <Contours />\n      <Zones />\n      <IndicationLines axis=\"X\" show />\n      <IndicationLines axis=\"Y\" show />\n\n      <g className=\"container\" style={{ pointerEvents: 'none' }}>\n        <XAxis />\n        <YAxis />\n      </g>\n      <FloatMoleculeStructures />\n    </svg>\n  );\n}\n\nconst MemoizedChart2D = memo(chart2DInner);\n\nexport default function Chart2D({ spectra }: Chart2DProps) {\n  const { width, height, margin, displayerKey } = useChartData();\n\n  return (\n    <MemoizedChart2D {...{ spectra, width, height, margin, displayerKey }} />\n  );\n}\n","import lodashGet from 'lodash/get';\nimport Numeral from 'numeral';\nimport { useMemo } from 'react';\n\nimport { usePreferences } from '../context/PreferencesContext';\n\nfunction FormatNumber(value, format, prefix = '', suffix = '') {\n  return prefix + Numeral(value).format(format) + suffix;\n}\n\ntype ReturnFunction = (\n  value?: number | string,\n  formatKey?: string,\n  prefix?: string,\n  suffix?: string,\n) => string;\n\nexport function useFormatNumberByNucleus(\n  nucleus?: Array<string>,\n): Array<ReturnFunction>;\nexport function useFormatNumberByNucleus(nucleus?: string): ReturnFunction;\nexport function useFormatNumberByNucleus(nucleus?: string | Array<string>) {\n  const preferences = usePreferences();\n  const nucleusByKey = lodashGet(preferences.current, `formatting.nuclei`, {\n    ppm: '0.0',\n    hz: '0.0',\n  });\n\n  return useMemo(() => {\n    function formatFun(n: string) {\n      return (value: any, formatKey = 'ppm', prefix = '', suffix = '') => {\n        return (\n          prefix +\n          Numeral(Number(value)).format(\n            lodashGet(nucleusByKey, `${n.toLowerCase()}.${formatKey}`, '0.0'),\n          ) +\n          suffix\n        );\n      };\n    }\n\n    if (!nucleus) {\n      return () => undefined;\n    }\n\n    if (typeof nucleus === 'string') {\n      return formatFun(nucleus);\n    } else if (Array.isArray(nucleus)) {\n      return nucleus.map((n) => formatFun(n));\n    } else {\n      throw Error('nuclus must be string or array of string');\n    }\n  }, [nucleus, nucleusByKey]);\n}\n\nexport function getNumberOfDecimals(value: number | string) {\n  value = String(value).trim();\n  const lastIndex = value.lastIndexOf('.');\n  return lastIndex > 0 ? value.substr(lastIndex).split('').length - 1 : 0;\n}\n\nexport default FormatNumber;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { xFindClosestIndex } from 'ml-spectra-processing';\nimport { useContext, useMemo, Fragment } from 'react';\nimport { MF } from 'react-mf';\n\nimport { get1DDataXY } from '../../data/data1d/Spectrum1D/get1DDataXY';\nimport { BrushContext } from '../EventsTrackers/BrushTracker';\nimport { MouseContext } from '../EventsTrackers/MouseTracker';\nimport { useChartData } from '../context/ChartContext';\nimport { options } from '../toolbar/ToolTypes';\nimport { useFormatNumberByNucleus } from '../utility/FormatNumber';\n\nimport { getLayoutID, LAYOUT } from './utilities/DimensionLayout';\nimport { get2DXScale, get1DYScale, get2DYScale } from './utilities/scale';\n\nconst styles = css`\n  display: flex;\n  flex-firection: row;\n  align-items: center;\n  pointer-events: bounding-box;\n  user-select: 'none';\n  -webkit-user-select: none; /* Chrome all / Safari all */\n  -moz-user-select: none; /* Firefox all */\n  background-color: #f7f7f7;\n  height: 30px;\n  padding: 6px;\n  color: #8d0018;\n  position: absolute;\n  width: 100%;\n  bottom: 0;\n  div {\n    margin: 0px 10px;\n    display: inline-block;\n\n    .label {\n      font-size: 12px;\n      color: #4d4d4d;\n      font-weight: bold;\n    }\n    .value {\n      font-weight: bold;\n      font-size: 14px;\n    }\n    .unit {\n      font-weight: bold;\n      font-size: 10px;\n    }\n  }\n`;\n\nfunction FooterBanner({ layout, data1D }) {\n  const position = useContext(MouseContext);\n  const { startX, endX, startY, endY, step } = useContext(BrushContext);\n  const {\n    margin,\n    width,\n    height,\n    activeSpectrum,\n    xDomain,\n    yDomain,\n    yDomains,\n    activeTab,\n    data,\n    toolOptions: { selectedTool },\n  } = useChartData();\n\n  const trackID =\n    position &&\n    getLayoutID(layout, {\n      startX: position.x,\n      startY: position.y,\n    });\n\n  const nucleuses = activeTab.split(',');\n  const [formatX, formatY] = useFormatNumberByNucleus(nucleuses);\n\n  const scaleX = useMemo(() => {\n    if (!data1D || data1D.length === 0) {\n      return get2DXScale({ width, margin, xDomain });\n    }\n    if (selectedTool !== options.slicingTool.id) {\n      switch (trackID) {\n        case LAYOUT.TOP_1D:\n        case LAYOUT.CENTER_2D: {\n          return get2DXScale({ width, margin, xDomain });\n        }\n        case LAYOUT.LEFT_1D: {\n          return get2DYScale({ height, margin, yDomain });\n        }\n        default:\n          return null;\n      }\n    }\n    return null;\n  }, [data1D, height, margin, selectedTool, trackID, width, xDomain, yDomain]);\n\n  const scaleY = useMemo(() => {\n    if (!data1D || data1D.length === 0) {\n      return get2DYScale({ height, margin, yDomain });\n    }\n    if (selectedTool !== options.slicingTool.id) {\n      switch (trackID) {\n        case LAYOUT.CENTER_2D: {\n          return get2DYScale({ height, margin, yDomain });\n        }\n        case LAYOUT.TOP_1D: {\n          return data1D[0]\n            ? get1DYScale(yDomains[data1D[0].id], margin.top)\n            : null;\n        }\n        case LAYOUT.LEFT_1D: {\n          return data1D[1]\n            ? get1DYScale(yDomains[data1D[1].id], margin.left)\n            : null;\n        }\n        default:\n          return null;\n      }\n    }\n    return null;\n  }, [data1D, height, margin, selectedTool, trackID, yDomain, yDomains]);\n\n  if (\n    !activeSpectrum ||\n    !position ||\n    position.y < 10 ||\n    position.x < 10 ||\n    position.x > width - margin.right ||\n    position.y > height - margin.bottom\n  ) {\n    return <div css={styles} />;\n  }\n  const getRealYValue = (cordinate) => {\n    let index: number | null = null;\n    if (trackID === LAYOUT.TOP_1D) {\n      index = 0;\n    } else if (trackID === LAYOUT.LEFT_1D) {\n      index = 1;\n    }\n    if (index != null && scaleX != null) {\n      const datum = get1DDataXY(data1D[index]);\n      const xIndex = xFindClosestIndex(datum.x, scaleX.invert(cordinate));\n      return datum.y[xIndex];\n    }\n    return 1;\n  };\n\n  const getXValue = (x: number | null = null) => {\n    if (scaleX != null) {\n      switch (trackID) {\n        case LAYOUT.CENTER_2D:\n        case LAYOUT.TOP_1D: {\n          return scaleX.invert(x ? x : position.x);\n        }\n        case LAYOUT.LEFT_1D: {\n          return scaleX.invert(x ? x : position.y);\n        }\n        default:\n          return 0;\n      }\n    }\n    return 0;\n  };\n\n  const getYValue = () => {\n    if (scaleY != null) {\n      switch (trackID) {\n        case LAYOUT.CENTER_2D:\n        case LAYOUT.TOP_1D: {\n          return scaleY.invert(position.y);\n        }\n        case LAYOUT.LEFT_1D: {\n          return scaleY.invert(position.x);\n        }\n        default:\n          return 0;\n      }\n    }\n    return 0;\n  };\n\n  const getRation = () => {\n    switch (trackID) {\n      case LAYOUT.TOP_1D: {\n        return (\n          (getRealYValue(startX) / (getRealYValue(endX) || Number.MIN_VALUE)) *\n          100\n        ).toFixed(2);\n      }\n      case LAYOUT.LEFT_1D: {\n        return (\n          (getRealYValue(startY) / (getRealYValue(endY) || Number.MIN_VALUE)) *\n          100\n        ).toFixed(2);\n      }\n      default:\n        return 0;\n    }\n  };\n\n  const getDeltaX = () => {\n    switch (trackID) {\n      case LAYOUT.TOP_1D: {\n        return (getXValue(startX) - getXValue(endX)).toPrecision(6);\n      }\n      case LAYOUT.LEFT_1D: {\n        return (getXValue(startY) - getXValue(endY)).toPrecision(6);\n      }\n      default:\n        return 0;\n    }\n  };\n\n  const getLabel = (label2d, labelld, nucleus) => {\n    return trackID === LAYOUT.CENTER_2D ? (\n      <Fragment>\n        {label2d} ( <MF mf={nucleus} /> )\n      </Fragment>\n    ) : (\n      labelld\n    );\n  };\n\n  const getZValue = () => {\n    if (trackID === LAYOUT.CENTER_2D) {\n      const { maxX, maxY, minX, minY, z } = data[activeSpectrum.index]\n        .data as any;\n\n      const xStep = (maxX - minX) / (z[0].length - 1);\n      const yStep = (maxY - minY) / (z.length - 1);\n      const xIndex = Math.floor((getXValue() - minX) / xStep);\n      const yIndex = Math.floor((getYValue() - minY) / yStep);\n\n      if (xIndex < 0 || xIndex >= z[0].length) return 0;\n      if (yIndex < 0 || yIndex >= z.length) return 0;\n\n      return z[yIndex][xIndex];\n    }\n    return 0;\n  };\n\n  return (\n    <div css={styles}>\n      <div>\n        <span className=\"label\">{getLabel('F2', 'X', nucleuses[0])} :</span>\n        <span className=\"value\">{formatX(getXValue())}</span>\n        <span className=\"unit\">ppm</span>\n      </div>\n\n      <div>\n        <span className=\"label\">{getLabel('F1', 'Y', nucleuses[1])} :</span>\n        <span className=\"value\">{formatY(getYValue())}</span>\n        <span className=\"unit\">ppm</span>\n      </div>\n      <div>\n        <span className=\"label\">Intensity :</span>\n        <span className=\"value\">{getZValue()}</span>\n      </div>\n      {step === 'brushing' && (\n        <div>\n          <span className=\"label\"> Δppm :</span>\n          <span className=\"value\">{getDeltaX()}</span>\n        </div>\n      )}\n\n      {step === 'brushing' && (\n        <div>\n          <span className=\"label\"> ratio :</span>\n          <span className=\"value\">{getRation()}%</span>\n        </div>\n      )}\n    </div>\n  );\n}\n\nexport default FooterBanner;\n","import { useContext, useMemo, CSSProperties } from 'react';\n\nimport { BrushContext } from '../../EventsTrackers/BrushTracker';\nimport { MouseContext } from '../../EventsTrackers/MouseTracker';\nimport { useChartData } from '../../context/ChartContext';\nimport { useFormatNumberByNucleus } from '../../utility/FormatNumber';\nimport { getLayoutID, LAYOUT } from '../utilities/DimensionLayout';\nimport { get2DXScale, get2DYScale, get1DYScale } from '../utilities/scale';\n\nconst style: CSSProperties = {\n  cursor: 'crosshair',\n  transformOrigin: 'bottom right',\n  position: 'absolute',\n  top: '-18px',\n  left: '-88px',\n  fontWeight: 'bold',\n  pointerEvents: 'none',\n  overflow: 'visible',\n  userSelect: 'none',\n  width: '85px',\n  textAlign: 'right',\n};\n\nfunction XYLabelPointer({ layout, data1D }) {\n  const position = useContext(MouseContext);\n  const { step } = useContext(BrushContext);\n  const {\n    margin,\n    width,\n    height,\n    xDomain,\n    yDomain,\n    yDomains,\n    activeTab,\n    activeSpectrum,\n  } = useChartData();\n\n  const trackID =\n    position &&\n    getLayoutID(layout, {\n      startX: position.x,\n      startY: position.y,\n    });\n\n  const nucleuses = activeTab.split(',');\n  const [formatX, formatY] = useFormatNumberByNucleus(nucleuses);\n\n  const scaleX = useMemo(() => {\n    if (!activeSpectrum || !data1D || data1D.length === 0) {\n      return get2DXScale({ width, margin, xDomain });\n    }\n\n    switch (trackID) {\n      case LAYOUT.TOP_1D:\n      case LAYOUT.CENTER_2D: {\n        return get2DXScale({ width, margin, xDomain });\n      }\n      case LAYOUT.LEFT_1D: {\n        return get2DYScale({ height, margin, yDomain });\n      }\n      default:\n        return null;\n    }\n  }, [\n    activeSpectrum,\n    data1D,\n    height,\n    margin,\n    trackID,\n    width,\n    xDomain,\n    yDomain,\n  ]);\n\n  const scaleY = useMemo(() => {\n    if (!activeSpectrum || !data1D || data1D.length === 0) {\n      return get2DYScale({ height, margin, yDomain });\n    }\n\n    switch (trackID) {\n      case LAYOUT.CENTER_2D: {\n        return get2DYScale({ height, margin, yDomain });\n      }\n      case LAYOUT.TOP_1D: {\n        return data1D[0]\n          ? get1DYScale(yDomains[data1D[0].id], margin.top)\n          : null;\n      }\n      case LAYOUT.LEFT_1D: {\n        return data1D[1]\n          ? get1DYScale(yDomains[data1D[1].id], margin.left)\n          : null;\n      }\n      default:\n        return null;\n    }\n  }, [activeSpectrum, data1D, height, margin, trackID, yDomain, yDomains]);\n\n  if (\n    step === 'brushing' ||\n    !position ||\n    position.y < margin.top ||\n    position.x < margin.left ||\n    position.x > width - margin.right ||\n    position.y > height - margin.bottom\n  ) {\n    return null;\n  }\n\n  const getXValue = (x = null) => {\n    switch (trackID) {\n      case LAYOUT.CENTER_2D:\n      case LAYOUT.TOP_1D: {\n        return scaleX?.invert(x ? x : position.x);\n      }\n      case LAYOUT.LEFT_1D: {\n        return scaleX?.invert(x ? x : position.y);\n      }\n      default:\n        return 0;\n    }\n  };\n\n  const getYValue = () => {\n    switch (trackID) {\n      case LAYOUT.CENTER_2D:\n      case LAYOUT.TOP_1D: {\n        return scaleY?.invert(position.y);\n      }\n      case LAYOUT.LEFT_1D: {\n        return scaleY?.invert(position.x);\n      }\n      default:\n        return 0;\n    }\n  };\n\n  return (\n    <div\n      key=\"xLabelPointer\"\n      style={{\n        ...style,\n        transform: `translate(${position.x}px, ${position.y}px)`,\n      }}\n    >\n      <span>{formatY(getYValue())}</span>\n      <span style={{ color: 'gray' }}>{','}</span>\n      <span style={{ color: 'red' }}>{formatX(getXValue())}</span>\n    </div>\n  );\n}\n\nexport default XYLabelPointer;\n","import { extent, scaleLinear } from 'd3';\n\nfunction getTopXScale(\n  width: number,\n  margin: { right: number; left: number },\n  x: Array<number>,\n) {\n  const xDomain = extent<number>(x);\n  const scaleX = scaleLinear(extent(x) as number[], [\n    width - margin.right,\n    margin.left,\n  ]);\n\n  return {\n    xDomain,\n    scaleX,\n  };\n}\n\nfunction getLeftXScale(\n  width: number,\n  margin: { bottom: number; top: number },\n  x: Array<number>,\n) {\n  const xDomain = extent(x);\n\n  const scaleX = scaleLinear(extent(x) as number[], [\n    width - margin.bottom,\n    margin.top,\n  ]);\n\n  return {\n    xDomain,\n    scaleX,\n  };\n}\n\nfunction getYScale(height: number, y: Array<number>, margin = 10) {\n  return scaleLinear(extent(y) as number[], [height - margin, margin]);\n}\n\nexport { getTopXScale, getLeftXScale, getYScale };\n","import { useMemo, memo } from 'react';\n\nimport { useChartData } from '../../../context/ChartContext';\nimport useXYReduce, { XYReducerDomainAxis } from '../../../hooks/useXYReduce';\nimport { PathBuilder } from '../../../utility/PathBuilder';\nimport { get2DXScale } from '../../utilities/scale';\n\nimport { getYScale } from './SliceScale';\n\ninterface HorizontalSliceChartProps {\n  margin?: number;\n  data: {\n    x: Array<number>;\n    re: Array<number>;\n  };\n}\n\nfunction HorizontalSliceChart({\n  margin: marginProps = 10,\n  data,\n}: HorizontalSliceChartProps) {\n  const { width, margin: originMargin, xDomain, displayerKey } = useChartData();\n  const xyReduce = useXYReduce(XYReducerDomainAxis.XAxis);\n\n  const height = originMargin.top;\n\n  const paths = useMemo(() => {\n    if (data) {\n      const { x, re: y } = data;\n      const scaleX = get2DXScale({ margin: originMargin, width, xDomain });\n\n      const scaleY = getYScale(height, y, marginProps);\n      const pathPoints = xyReduce({ x, y });\n\n      const pathBuilder = new PathBuilder();\n      pathBuilder.moveTo(scaleX(pathPoints.x[0]), scaleY(pathPoints.y[0]));\n      for (let i = 1; i < pathPoints.x.length; i++) {\n        pathBuilder.lineTo(scaleX(pathPoints.x[i]), scaleY(pathPoints.y[i]));\n      }\n\n      return pathBuilder.toString();\n    } else {\n      return undefined;\n    }\n  }, [data, height, marginProps, originMargin, width, xDomain, xyReduce]);\n\n  if (!width || !height) {\n    return null;\n  }\n\n  return (\n    <svg viewBox={`0 0 ${width} ${height}`} width={width} height={height}>\n      <defs>\n        <clipPath id={`${displayerKey}clip-top`}>\n          <rect\n            width={width - originMargin.left - originMargin.right}\n            height={height}\n            x={originMargin.left}\n            y={`${0}`}\n          />\n        </clipPath>\n      </defs>\n      <g clipPath={`url(#${displayerKey}clip-top)`}>\n        <rect\n          width={width - originMargin.left - originMargin.right}\n          height={height}\n          x={originMargin.left}\n          y={`${0}`}\n          fillOpacity=\"0\"\n        />\n        <path className=\"line\" stroke=\"red\" fill=\"none\" d={paths} />\n      </g>\n    </svg>\n  );\n}\n\nexport default memo(HorizontalSliceChart);\n","import { useMemo, memo } from 'react';\n\nimport { useChartData } from '../../../context/ChartContext';\nimport useXYReduce, { XYReducerDomainAxis } from '../../../hooks/useXYReduce';\nimport { PathBuilder } from '../../../utility/PathBuilder';\nimport { get2DYScale } from '../../utilities/scale';\n\nimport { getYScale } from './SliceScale';\n\ninterface VerticalSliceChartProps {\n  margin?: number;\n  data: {\n    x: Array<number>;\n    re: Array<number>;\n  };\n}\n\nfunction VerticalSliceChart({\n  margin: marignValue = 10,\n  data,\n}: VerticalSliceChartProps) {\n  const {\n    height: originHeight,\n    margin,\n    yDomain,\n    displayerKey,\n  } = useChartData();\n  const xyReduce = useXYReduce(XYReducerDomainAxis.YAxis);\n\n  const height = margin.left;\n\n  const paths = useMemo(() => {\n    if (data) {\n      const { x, re: y } = data;\n      const scaleX = get2DYScale({ height: originHeight, margin, yDomain });\n\n      const scaleY = getYScale(height, y, marignValue);\n\n      const pathPoints = xyReduce({ x, y });\n\n      const pathBuilder = new PathBuilder();\n\n      pathBuilder.moveTo(\n        scaleY(pathPoints.y[pathPoints.y.length - 1]),\n        scaleX(pathPoints.x.length - 1),\n      );\n\n      for (let i = pathPoints.x.length - 2; i >= 0; i--) {\n        pathBuilder.lineTo(scaleY(pathPoints.y[i]), scaleX(pathPoints.x[i]));\n      }\n\n      return pathBuilder.toString();\n    } else {\n      return undefined;\n    }\n  }, [data, height, margin, marignValue, originHeight, xyReduce, yDomain]);\n\n  const mainHeight = originHeight - margin.bottom - margin.top;\n\n  if (!mainHeight || !height) return null;\n\n  return (\n    <svg\n      viewBox={`0 0 ${height} ${mainHeight + margin.top}`}\n      width={height}\n      height={mainHeight + margin.top}\n    >\n      <defs>\n        <clipPath id={`${displayerKey}clip-left`}>\n          <rect width={height} height={mainHeight} x=\"0\" y={margin.top} />\n        </clipPath>\n      </defs>\n      <g clipPath={`url(#${displayerKey}clip-left)`}>\n        <path className=\"line\" stroke=\"red\" fill=\"none\" d={paths} />\n      </g>\n    </svg>\n  );\n}\n\nexport default memo(VerticalSliceChart);\n","import { useMemo } from 'react';\n\nimport { getSlice } from '../../../../data/data2d/Spectrum2D';\nimport { Datum2D } from '../../../../data/types/data2d/Datum2D';\nimport { useMouseTracker } from '../../../EventsTrackers/MouseTracker';\nimport { useChartData } from '../../../context/ChartContext';\nimport { get2DXScale, get2DYScale } from '../../utilities/scale';\n\nimport HorizontalSliceChart from './HorizontalSliceChart';\nimport VerticalSliceChart from './VerticalSliceChart';\n\nfunction SlicingView() {\n  const {\n    width,\n    height,\n    margin,\n    activeSpectrum,\n    data: spectra,\n    xDomain,\n    yDomain,\n  } = useChartData();\n  const position = useMouseTracker();\n\n  const chart2d = useMemo(() => {\n    if (position && activeSpectrum && activeSpectrum.id) {\n      const { x, y } = position;\n      const scale2dX = get2DXScale({ margin, width, xDomain });\n      const scale2dY = get2DYScale({ margin, height, yDomain });\n      const data = getSlice(spectra[activeSpectrum.index] as Datum2D, {\n        x: scale2dX.invert(x),\n        y: scale2dY.invert(y),\n      });\n      return (\n        <svg\n          viewBox={`0 0 ${width} ${height}`}\n          width={width}\n          height={height}\n          style={{\n            position: 'absolute',\n            backgroundColor: 'rgba(255,255,255,0.8)',\n          }}\n        >\n          {data?.horizontal && (\n            <HorizontalSliceChart data={data.horizontal.data} />\n          )}\n          {data?.vertical && <VerticalSliceChart data={data.vertical.data} />}\n        </svg>\n      );\n    }\n    return null;\n  }, [\n    position,\n    activeSpectrum,\n    margin,\n    width,\n    xDomain,\n    height,\n    yDomain,\n    spectra,\n  ]);\n\n  if (!position) {\n    return null;\n  }\n\n  return chart2d;\n}\n\nexport default SlicingView;\n","import { useCallback, useEffect, useMemo, ReactNode } from 'react';\nimport { ResponsiveChart } from 'react-d3-utils';\n\nimport { BrushTracker } from '../EventsTrackers/BrushTracker';\nimport { MouseTracker } from '../EventsTrackers/MouseTracker';\nimport { useChartData } from '../context/ChartContext';\nimport { useDispatch } from '../context/DispatchContext';\nimport useSpectrum from '../hooks/useSpectrum';\nimport NoData from '../loader/NoData';\nimport Spinner from '../loader/Spinner';\nimport {\n  BRUSH_END,\n  FULL_ZOOM_OUT,\n  SET_DIMENSIONS,\n  SET_2D_LEVEL,\n  SET_ZOOM,\n  ADD_2D_ZONE,\n} from '../reducer/types/Types';\nimport BrushXY, { BRUSH_TYPE } from '../tool/BrushXY';\nimport CrossLinePointer from '../tool/CrossLinePointer';\nimport { options } from '../toolbar/ToolTypes';\n\nimport Chart2D from './Chart2D';\nimport FooterBanner from './FooterBanner';\nimport XYLabelPointer from './tools/XYLabelPointer';\nimport SlicingView from './tools/slicing/SlicingView';\nimport { get2DDimensionLayout, getLayoutID } from './utilities/DimensionLayout';\n\ninterface Viewer2DProps {\n  emptyText: ReactNode;\n}\n\nfunction Viewer2D({ emptyText = undefined }: Viewer2DProps) {\n  const state = useChartData();\n  const {\n    toolOptions: { selectedTool },\n    isLoading,\n    data,\n    margin,\n    tabActiveSpectrum,\n    activeTab,\n  } = state;\n\n  const dispatch = useDispatch();\n  const { info } = useSpectrum({ info: {} });\n  const isVisible = info.isFt || !('isFt' in info);\n\n  const spectrumData = useMemo(() => {\n    const nucleuses = activeTab.split(',');\n    return nucleuses.reduce<any>((acc, n) => {\n      if (tabActiveSpectrum[n]?.id) {\n        const id = tabActiveSpectrum[n]?.id;\n        const spectrum = data.find(\n          (datum) => datum.id === id && !datum.info.isFid,\n        );\n        if (spectrum) {\n          acc.push(spectrum);\n        }\n      } else {\n        acc.push(null);\n      }\n      return acc;\n    }, []);\n  }, [activeTab, data, tabActiveSpectrum]);\n\n  const DIMENSION = get2DDimensionLayout(state);\n\n  const handelBrushEnd = useCallback(\n    (brushData) => {\n      const trackID = getLayoutID(DIMENSION, brushData);\n      if (trackID) {\n        if (brushData.altKey) {\n          switch (selectedTool) {\n            default:\n              break;\n          }\n        } else if (brushData.shiftKey) {\n          switch (selectedTool) {\n            case options.zone2D.id:\n              dispatch({ type: ADD_2D_ZONE, ...brushData });\n              break;\n            default:\n              break;\n          }\n        } else {\n          switch (selectedTool) {\n            default:\n              if (selectedTool != null) {\n                return dispatch({\n                  type: BRUSH_END,\n                  ...brushData,\n                  trackID: getLayoutID(DIMENSION, brushData),\n                });\n              }\n          }\n        }\n      }\n    },\n    [selectedTool, dispatch, DIMENSION],\n  );\n\n  const handelOnDoubleClick = useCallback(\n    (e) => {\n      const { x: startX, y: startY } = e;\n      const trackID = getLayoutID(DIMENSION, { startX, startY });\n      if (trackID) {\n        dispatch({ type: FULL_ZOOM_OUT, trackID });\n      }\n    },\n    [DIMENSION, dispatch],\n  );\n\n  const handleZoom = (event) => {\n    const { x: startX, y: startY } = event;\n    const trackID = getLayoutID(DIMENSION, { startX, startY });\n\n    if (trackID) {\n      if (trackID === 'CENTER_2D') {\n        dispatch({ type: SET_2D_LEVEL, ...event });\n      } else {\n        dispatch({ type: SET_ZOOM, event, trackID });\n      }\n    }\n  };\n\n  const mouseClick = useCallback(\n    (position) => {\n      // eslint-disable-next-line @typescript-eslint/no-unused-vars\n      const { x, y } = position;\n      switch (selectedTool) {\n        default:\n          break;\n      }\n    },\n    [selectedTool],\n  );\n\n  if (!isVisible) {\n    return (\n      <NoData\n        emptyText=\"Currently FID can not be displayed for 2D spectra\"\n        canOpenLoader={false}\n      />\n    );\n  }\n\n  return (\n    <ResponsiveChart>\n      {({ width, height }) => (\n        <ViewerResponsiveWrapper width={width} height={height}>\n          <Spinner isLoading={isLoading} emptyText={emptyText} />\n          {data && data.length > 0 && (\n            <BrushTracker\n              onBrush={handelBrushEnd}\n              onDoubleClick={handelOnDoubleClick}\n              onClick={mouseClick}\n              onZoom={handleZoom}\n              style={{\n                width: '100%',\n                height: '100%',\n                margin: 'auto',\n                position: 'relative',\n                overflow: 'hidden',\n              }}\n            >\n              <MouseTracker\n                style={{ width: '100%', height: `100%`, position: 'absolute' }}\n              >\n                {selectedTool && selectedTool === options.slicingTool.id && (\n                  <SlicingView />\n                )}\n\n                <CrossLinePointer />\n                {spectrumData && (\n                  <XYLabelPointer data1D={spectrumData} layout={DIMENSION} />\n                )}\n\n                <BrushXY\n                  brushType={BRUSH_TYPE.XY}\n                  dimensionBorder={DIMENSION.CENTER_2D}\n                />\n                <>\n                  {spectrumData?.[0] && (\n                    <BrushXY\n                      brushType={BRUSH_TYPE.X}\n                      dimensionBorder={DIMENSION.TOP_1D}\n                      height={margin.top}\n                    />\n                  )}\n                  {spectrumData?.[1] && (\n                    <BrushXY\n                      brushType={BRUSH_TYPE.Y}\n                      dimensionBorder={DIMENSION.LEFT_1D}\n                      width={margin.left}\n                    />\n                  )}\n                </>\n                {spectrumData && (\n                  <FooterBanner data1D={spectrumData} layout={DIMENSION} />\n                )}\n\n                <Chart2D spectra={spectrumData} />\n              </MouseTracker>\n            </BrushTracker>\n          )}\n        </ViewerResponsiveWrapper>\n      )}\n    </ResponsiveChart>\n  );\n}\n\ninterface ViewerResponsiveWrapperProps {\n  width: number;\n  height: number;\n  children: any;\n}\n\nexport function ViewerResponsiveWrapper(props: ViewerResponsiveWrapperProps) {\n  const dispatch = useDispatch();\n  const { width, height, children } = props;\n\n  useEffect(() => {\n    dispatch({ type: SET_DIMENSIONS, ...{ width, height } });\n  }, [width, height, dispatch]);\n\n  return children;\n}\n\nexport default Viewer2D;\n","import { ScaleLinear } from 'd3';\nimport { produce } from 'immer';\n\nimport { getXScale, getYScale } from '../1d/utilities/scale';\n\nexport const SET_X_SCALE = 'SET_X_SCALE';\nexport const SET_Y_SCALE = 'SET_Y_SCALE';\nexport const SET_SCALE = 'SET_SCALE';\n\ntype ScaleLinearNumberFunction = (\n  spectrumId?: number | null | string,\n) => ScaleLinear<number, number, number>;\n\nexport interface ScaleState {\n  scaleX: ScaleLinearNumberFunction | null;\n  scaleY: ScaleLinearNumberFunction | null;\n}\n\nexport const scaleInitialState: ScaleState = {\n  scaleX: null,\n  scaleY: null,\n};\n\nfunction innerScaleReducer(draft: ScaleState, action) {\n  switch (action.type) {\n    case SET_X_SCALE:\n      draft.scaleX = (spectrumId = null) => getXScale(action, spectrumId);\n      break;\n\n    case SET_Y_SCALE:\n      draft.scaleY = (spectrumId = null) => getYScale(action, spectrumId);\n      break;\n\n    case SET_SCALE: {\n      draft.scaleX = (spectrumId = null) =>\n        getXScale(action.payload, spectrumId);\n      draft.scaleY = (spectrumId = null) =>\n        getYScale(action.payload, spectrumId);\n      break;\n    }\n    default:\n      return draft;\n  }\n}\n\nconst scaleReducer = produce(innerScaleReducer);\nexport default scaleReducer;\n","import { createContext, useContext } from 'react';\n\nimport { scaleInitialState, ScaleState } from '../reducer/scaleReducer';\n\nexport const scaleContext = createContext<ScaleState>(scaleInitialState);\nexport const ScaleProvider = scaleContext.Provider;\n\nexport function useScale() {\n  return useContext(scaleContext);\n}\n\ntype CheckedScaleState = {\n  [key in keyof ScaleState]: Exclude<ScaleState[key], null>;\n};\n\nexport function useScaleChecked(): CheckedScaleState {\n  const scale = useScale();\n\n  if (!scale.scaleX || !scale.scaleY) {\n    throw new Error('scale cannot be null');\n  }\n\n  return scale as CheckedScaleState;\n}\n","import { createContext, useContext } from 'react';\n\nconst ModalContext = createContext<any>({});\nexport const ModalProvider = ModalContext.Provider;\n\nexport function useModal() {\n  return useContext(ModalContext);\n}\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { CSSProperties, useCallback } from 'react';\n\nconst styles = css`\n  display: block;\n  border-radius: 5px;\n  overflow: hidden;\n  width: 300px;\n  border-top: 10px solid #ed0000;\n\n  .message {\n    font-weight: bold;\n    font-size: 14px;\n    text-align: center;\n    color: #af0000;\n    text-align: center;\n    padding: 25px;\n    display: block;\n  }\n  .buttons-container {\n    display: flex;\n    flex-direction: row-reverse;\n    align-items: flex-end;\n    padding: 5px;\n    border-top: 1px solid #efefef;\n\n    button:last-of-type {\n      border-radius: 5px 0 0 5px;\n    }\n    button:first-of-type {\n      border-radius: 0px 5px 5px 0px;\n      border-width: 1px;\n    }\n    button {\n      border-color: #dcdcdc;\n      border-width: 1px 0px 1px 1px;\n      background-color: white;\n      display: inline-block;\n      cursor: pointer;\n      color: #363636;\n      font-weight: bold;\n      padding: 6px 24px;\n      text-decoration: none;\n    }\n    button:hover {\n      background: -webkit-gradient(\n        linear,\n        left top,\n        left bottom,\n        color-stop(0.05, #f6f6f6),\n        color-stop(1, #ffffff)\n      );\n      background: -moz-linear-gradient(top, #f6f6f6 5%, #ffffff 100%);\n      background: -webkit-linear-gradient(top, #f6f6f6 5%, #ffffff 100%);\n      background: -o-linear-gradient(top, #f6f6f6 5%, #ffffff 100%);\n      background: -ms-linear-gradient(top, #f6f6f6 5%, #ffffff 100%);\n      background: linear-gradient(to bottom, #f6f6f6 5%, #ffffff 100%);\n      filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#f6f6f6', endColorstr='#ffffff',GradientType=0);\n      background-color: #f6f6f6;\n    }\n  }\n`;\n\ninterface ConfirmationDialogProps {\n  style?: CSSProperties;\n  buttons: Array<{ handler: () => void; text: string; style?: CSSProperties }>;\n  onClose: () => void;\n  message: string;\n}\n\nfunction ConfirmationDialog({\n  style = {},\n  buttons = [],\n  onClose,\n  message,\n}: ConfirmationDialogProps) {\n  const optionsHandler = useCallback(\n    (\n      e: React.MouseEvent,\n      { handler = () => null }: { handler: (e: React.MouseEvent) => void },\n    ) => {\n      handler(e);\n      onClose();\n    },\n    [onClose],\n  );\n\n  return (\n    <div style={style} css={styles}>\n      <p className=\"message\">{message}</p>\n      <div className=\"buttons-container\">\n        {buttons.map((option) => (\n          <button\n            key={option.text}\n            type=\"button\"\n            onClick={(e) => optionsHandler(e, option)}\n            style={option.style && option.style}\n          >\n            {option.text}\n          </button>\n        ))}\n      </div>\n    </div>\n  );\n}\n\nexport default ConfirmationDialog;\n","import { useRef, useEffect, cloneElement } from 'react';\nimport { useSize } from 'react-use';\n\nconst ModalContent = ({ modal, onClose, onLayout }) => {\n  const contentSize = useRef<any>();\n\n  const [Content, { width, height }] = useSize(() => {\n    return (\n      <div\n        style={{\n          height: '100%',\n          display: 'block',\n          overflow: 'auto',\n        }}\n      >\n        {cloneElement(modal.component, {\n          ...modal.options,\n          onClose: onClose,\n          style: { cursor: 'default' },\n        })}\n      </div>\n    );\n  });\n\n  useEffect(() => {\n    if (isFinite(height) && isFinite(width) && !contentSize.current) {\n      contentSize.current = { width, height };\n      onLayout({ modal, layout: { width, height } });\n    }\n  }, [width, height, contentSize, onLayout, modal]);\n\n  return Content;\n};\n\nexport default ModalContent;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport {\n  useRef,\n  useState,\n  useEffect,\n  useCallback,\n  Fragment,\n  useMemo,\n  CSSProperties,\n  ReactNode,\n} from 'react';\nimport { createPortal } from 'react-dom';\nimport { Rnd } from 'react-rnd';\nimport { TransitionGroup } from 'react-transition-group';\n\nimport Transition from '../Transition';\nimport Wrapper from '../Wrapper';\nimport { positions, transitions } from '../options';\n\nimport ConfirmDialog from './ConfirmDialog';\nimport { ModalProvider } from './Context';\nimport ModalContent from './ModalContent';\n\nconst transitionStyles: any = {\n  [transitions.FADE]: {\n    entering: { opacity: 0 },\n    entered: { opacity: 1 },\n  },\n  [transitions.SCALE]: {\n    entering: { transform: 'scale(0)' },\n    entered: { transform: 'scale(1)' },\n    exiting: { transform: 'scale(0)' },\n    exited: { transform: 'scale(0)' },\n  },\n};\n\ninterface ProviderProps {\n  children: ReactNode;\n  style?: CSSProperties;\n  offset?: string;\n  position?: any;\n  transition?: any;\n  wrapperRef?: any;\n}\n\nfunction Provider({\n  children,\n  style = undefined,\n  offset = '0px',\n  position = positions.MIDDLE,\n  transition = transitions.SCALE,\n  wrapperRef = null,\n}: ProviderProps) {\n  const root = useRef<any>();\n  const modalRef = useRef<any>();\n  const [modal, setModal] = useState<any>();\n\n  useEffect(() => {\n    root.current = document.createElement('div');\n    const ref = root.current;\n    if (wrapperRef) {\n      wrapperRef.appendChild(ref);\n    }\n    return () => {\n      if (ref) {\n        if (wrapperRef) {\n          wrapperRef.removeChild(ref);\n        }\n      }\n    };\n  }, [wrapperRef]);\n\n  const close = useCallback(\n    function close() {\n      setModal(null);\n    },\n    [setModal],\n  );\n\n  const parentStyle = useMemo(() => {\n    return wrapperRef\n      ? wrapperRef.getBoundingClientRect()\n      : {\n          top: 0,\n          left: 0,\n          width: window.innerWidth,\n          height: window.innerHeight,\n        };\n  }, [wrapperRef]);\n\n  /**\n   *\n   * @param {*} component  <component />\n   * @param {object} options    {onYest:()=>{}, prop1, .... etc}\n   * @param {transitions} options.transition\n   * @param {positions} options.position\n   * @param {boolean} options.isBackgroundBlur\n   * @param {boolean} options.enableResizing\n   */\n  const show = useCallback(\n    (component, options = {}) => {\n      const _modal: any = {\n        component,\n        options: { isBackgroundBlur: true, enableResizing: false, ...options },\n      };\n\n      _modal.close = close;\n\n      setModal(_modal);\n      if (_modal.options.onOpen) _modal.options.onOpen();\n      return _modal;\n    },\n    [close],\n  );\n\n  /**\n   * @param {object} dialogOptions\n   * @param {object} dialogOptions.message\n   * @param {Array<{ handler: Function,text: string,style: object}>} dialogOptions.buttons\n   * @param {object} dialogOptions.tyle\n   */\n  const showConfirmDialog = useCallback(\n    (dialogOptions, options = { enableResizing: false }) => {\n      const _modal: any = {\n        component: <ConfirmDialog {...dialogOptions} />,\n        options: { isBackgroundBlur: true, ...options },\n      };\n\n      _modal.close = close;\n\n      setModal(_modal);\n      if (_modal.options.onOpen) _modal.options.onOpen();\n\n      return _modal;\n    },\n    [close],\n  );\n\n  useEffect(() => {\n    function keyHandler(e) {\n      if (['Escape', 'Esc'].includes(e.key)) {\n        close();\n      }\n    }\n    document.addEventListener('keydown', keyHandler, false);\n    return () => document.removeEventListener('keydown', keyHandler, false);\n  }, [close]);\n\n  const styles = css`\n    position: absolute;\n    left: 0;\n    top: 0;\n    bottom: 0;\n    right: 0;\n    z-index: 0;\n    pointer-events: all;\n    .handle {\n      cursor: move;\n    }\n\n    .rnd-container {\n      box-sizing: initial;\n      background-color: #fff;\n      box-shadow: 0 0 0 0, 0 8px 16px rgba(0, 0, 0, 0.3);\n      border-radius: 5px;\n    }\n  `;\n\n  const outerStyle: CSSProperties = modal?.options.isBackgroundBlur\n    ? { backgroundColor: 'rgba(255,255,255,0.8)' }\n    : { pointerEvents: 'none' };\n\n  const modalContextValue = useMemo(\n    () => ({ show, close, showConfirmDialog }),\n    [show, close, showConfirmDialog],\n  );\n\n  const contentLayoutHandler = useCallback(\n    ({ modal, layout }) => {\n      const width = modal.options.width\n        ? modal.options.width\n        : layout.width > parentStyle.width\n        ? parentStyle.width\n        : layout.width;\n      const height = modal.options.height\n        ? modal.options.height\n        : layout.height > parentStyle.height\n        ? parentStyle.height\n        : layout.height;\n\n      modalRef.current.updateSize({ width, height });\n    },\n    [parentStyle.height, parentStyle.width],\n  );\n\n  return (\n    <ModalProvider value={modalContextValue}>\n      {children}\n      {root.current &&\n        createPortal(\n          <Fragment>\n            {modal ? (\n              <div\n                css={styles}\n                style={{\n                  ...outerStyle,\n                }}\n              >\n                <TransitionGroup\n                  appear\n                  key={\n                    positions[\n                      modal.options.transition\n                        ? modal.options.transition\n                        : transition\n                    ]\n                  }\n                  options={{\n                    position: modal.options.position\n                      ? modal.options.position\n                      : position,\n                  }}\n                  containerStyle={parentStyle}\n                  component={Wrapper}\n                >\n                  <Transition\n                    type={\n                      modal.options.transition\n                        ? modal.options.transition\n                        : transition\n                    }\n                    transitionStyles={{\n                      ...transitionStyles,\n                      default: {\n                        width: modal.options.width\n                          ? `${modal.options.width}px`\n                          : 'auto',\n                      },\n                      height: modal.options.height\n                        ? `${modal.options.height}px`\n                        : 'auto',\n                    }}\n                    key={modal.id}\n                  >\n                    <Rnd\n                      maxWidth={parentStyle.width}\n                      maxHeight={parentStyle.height}\n                      ref={modalRef}\n                      default={{\n                        width: modal.options.width\n                          ? modal.options.width\n                          : 'auto',\n                        height: modal.options.height\n                          ? modal.options.height\n                          : 'auto',\n                        x: 0,\n                        y: 0,\n                      }}\n                      className=\"rnd-container\"\n                      style={{\n                        ...style,\n                        margin: offset,\n                        position: 'static',\n                        pointerEvents: 'all',\n                        userSelect: 'none',\n                      }}\n                      enableResizing={modal.options.enableResizing}\n                      dragHandleClassName=\"handle\"\n                      enableUserSelectHack={false}\n                    >\n                      <ModalContent\n                        modal={modal}\n                        onClose={close}\n                        onLayout={contentLayoutHandler}\n                      />\n                    </Rnd>\n                  </Transition>\n                </TransitionGroup>\n              </div>\n            ) : null}\n          </Fragment>,\n          root.current,\n        )}\n    </ModalProvider>\n  );\n}\n\nexport default Provider;\n","import {\n  useRef,\n  useLayoutEffect,\n  useCallback,\n  useState,\n  memo,\n  Fragment,\n  CSSProperties,\n  ReactNode,\n} from 'react';\nimport { createPortal } from 'react-dom';\n\nimport { useGlobal } from '../../context/GlobalContext';\n\nconst styles: Record<'popup', CSSProperties> = {\n  popup: {\n    position: 'fixed',\n    top: 0,\n    left: 0,\n    pointerEvents: 'none',\n    backgroundColor: 'gray',\n    padding: '3px',\n    borderRadius: '2px',\n    color: 'white',\n    whiteSpace: 'nowrap',\n    fontSize: '10px',\n    fontFamily: 'tahoma',\n    textShadow: 'none',\n  },\n};\n\ninterface ToolTipProps {\n  style?: any;\n  className?: string;\n  popupPlacement: string;\n  children: ReactNode;\n  title: string;\n  offset?: { x: number; y: number };\n}\n\nfunction ToolTip({\n  style = { popup: {}, mainContainer: {} },\n  className = '',\n  popupPlacement = 'right',\n  children,\n  title,\n  offset = { x: 0, y: 0 },\n}: ToolTipProps) {\n  const refChild = useRef<HTMLDivElement>(null);\n  const refContent = useRef<HTMLDivElement>(null);\n\n  const [placement, setPlacement] = useState({ x: 0, y: 0 });\n  const [show, showToolTip] = useState(false);\n  const { elementsWrapperRef } = useGlobal();\n\n  useLayoutEffect(() => {\n    const getPopupPlacement = () => {\n      let x: number;\n      let y: number;\n\n      if (refChild.current === null || refContent.current === null) {\n        return null;\n      }\n\n      const childBounding = refChild.current.getBoundingClientRect();\n      const contentBounding = refContent.current.getBoundingClientRect();\n\n      switch (popupPlacement) {\n        case 'left':\n          x = -contentBounding.width;\n          y =\n            childBounding.height / 2 -\n            ((childBounding.height / 2) * contentBounding.height) /\n              childBounding.height;\n          break;\n        case 'right':\n          x = childBounding.width;\n          y =\n            childBounding.height / 2 -\n            ((childBounding.height / 2) * contentBounding.height) /\n              childBounding.height;\n          break;\n        case 'top':\n          x =\n            childBounding.width / 2 -\n            ((childBounding.width / 2) * contentBounding.width) /\n              childBounding.width;\n          y = -childBounding.height;\n          break;\n        case 'bottom':\n          x =\n            childBounding.width / 2 -\n            ((childBounding.width / 2) * contentBounding.width) /\n              childBounding.width;\n          y = childBounding.height;\n          break;\n        default:\n          x = 0;\n          y = 0;\n          break;\n      }\n      return { x: x + childBounding.x, y: y + childBounding.y };\n    };\n\n    if (show) {\n      const pl = getPopupPlacement();\n\n      if (pl) {\n        setPlacement(pl);\n      }\n    }\n  }, [popupPlacement, show]);\n\n  const mouseOverHandler = useCallback(() => {\n    showToolTip(true);\n  }, []);\n\n  const mouseLeaveHandler = useCallback(() => {\n    showToolTip(false);\n  }, []);\n\n  return (\n    <Fragment>\n      <div\n        style={{\n          position: 'relative',\n          height: '100%',\n          display: 'flex',\n          justifyContent: 'center',\n          alignItems: 'center',\n          ...style.mainContainer,\n        }}\n        ref={refChild}\n        onMouseOver={mouseOverHandler}\n        onMouseOut={mouseLeaveHandler}\n      >\n        {children}\n      </div>\n      {show &&\n        elementsWrapperRef &&\n        createPortal(\n          <div\n            ref={refContent}\n            style={{\n              ...styles.popup,\n              transform: `translate(${placement.x + offset.x}px,${\n                placement.y + offset.y\n              }px)`,\n              zIndex: 999999999,\n              ...style.popup,\n            }}\n            className={className}\n          >\n            <span style={{ pointerEvents: 'none' }}>{title}</span>\n          </div>,\n          elementsWrapperRef,\n        )}\n    </Fragment>\n  );\n}\n\nexport default memo(ToolTip);\n","import { CSSProperties, memo } from 'react';\nimport { FaTimes } from 'react-icons/fa';\n\nimport ToolTip from './ToolTip/ToolTip';\n\nconst styles: Record<'button' | 'svg', CSSProperties> = {\n  button: {\n    backgroundColor: 'transparent',\n    border: 'none',\n    height: '100%',\n    display: 'flex',\n    justifyContent: 'center',\n    alignItems: 'center',\n  },\n  svg: {\n    fill: '#ca0000',\n    fontSize: '16px',\n  },\n};\n\ninterface CloseButtonProps {\n  onClick?: () => void;\n  popupTitle?: string;\n  popupPlacement?: string;\n  className?: string;\n}\n\nfunction CloseButton(props: CloseButtonProps) {\n  const {\n    onClick = () => null,\n    popupTitle = 'Close',\n    popupPlacement = 'left',\n    className = '',\n  } = props;\n  return (\n    <div className={className}>\n      <ToolTip title={popupTitle} popupPlacement={popupPlacement}>\n        <button style={styles.button} type=\"button\" onClick={onClick}>\n          <FaTimes style={styles.svg} />\n        </button>\n      </ToolTip>\n    </div>\n  );\n}\n\nexport default memo(CloseButton);\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { xGetFromToIndex, xyToXYObject } from 'ml-spectra-processing';\nimport { analyseMultiplet } from 'multiplet-analysis';\nimport { useState, useEffect } from 'react';\nimport { Plot, LineSeries, Axis } from 'react-plot';\n\nimport { isSpectrum2D } from '../../data/data2d/Spectrum2D';\nimport { Spectra } from '../NMRium';\nimport CloseButton from '../elements/CloseButton';\nimport { ActiveSpectrum } from '../reducer/Reducer';\n\nconst styles = css`\n  display: flex;\n  flex-direction: column;\n  width: 900px;\n  height: 400px;\n  padding: 5px;\n  button:focus {\n    outline: none;\n  }\n  .header {\n    height: 24px;\n    border-bottom: 1px solid #f0f0f0;\n    display: flex;\n    span {\n      color: #464646;\n      font-size: 15px;\n      flex: 1;\n    }\n\n    button {\n      background-color: transparent;\n      border: none;\n      svg {\n        height: 16px;\n      }\n    }\n  }\n  .container {\n    overflow-y: auto;\n    background-color: white;\n    padding-top: 10px;\n\n    .row {\n      outline: none;\n      display: flex !important;\n      flex-direction: row;\n      margin: 0;\n      div {\n        flex: 4;\n      }\n      .multiplicity {\n        flex: 2;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n      }\n    }\n\n    .row:nth-child(odd) {\n      background: #fafafa;\n    }\n  }\n`;\n\nconst loaderStyles = css`\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  flex-direction: column;\n  user-select: none;\n  width: 900px;\n  height: 400px;\n\n  svg {\n    animation-duration: 0.5s;\n    animation-name: spinAnimation;\n    animation-iteration-count: infinite;\n    animation-fill-mode: forwards;\n    animation-direction: inherit;\n    animation-timing-function: linear;\n    animation-duration: 1s;\n    width: 100px;\n    height: 100px;\n  }\n\n  @keyframes spinAnimation {\n    from {\n      transform: rotate(0deg);\n    }\n\n    to {\n      transform: rotate(360deg);\n    }\n  }\n`;\n\ninterface MultipletAnalysisModalProps {\n  data: Spectra;\n  activeSpectrum: ActiveSpectrum;\n  scaleX: any;\n  startX: any;\n  endX: any;\n  onClose: (element?: string) => void;\n}\n\nexport default function MultipletAnalysisModal({\n  data,\n  activeSpectrum,\n  scaleX,\n  startX,\n  endX,\n  onClose,\n}: MultipletAnalysisModalProps) {\n  const [analysisData, setAnalysisData] = useState<any>();\n  const [calcStart, setCalcStartStatus] = useState(false);\n  const [isCalcFinished, setCalcFinished] = useState(false);\n\n  useEffect(() => {\n    setTimeout(() => {\n      setCalcStartStatus(true);\n    }, 400);\n  }, []);\n\n  useEffect(() => {\n    if (activeSpectrum && startX && endX && calcStart) {\n      const spectrum = data[activeSpectrum.index];\n      if (isSpectrum2D(spectrum)) {\n        throw new Error('unreachable');\n      }\n\n      const {\n        data: { x, re },\n        info,\n      } = spectrum;\n\n      const from = scaleX().invert(startX);\n      const to = scaleX().invert(endX);\n\n      const { fromIndex, toIndex } = xGetFromToIndex(x, {\n        from,\n        to,\n      });\n      const analysesProps = {\n        x: x.slice(fromIndex, toIndex),\n        y: re.slice(fromIndex, toIndex),\n      };\n      try {\n        const result = analyseMultiplet(analysesProps, {\n          frequency: info.originFrequency,\n          takeBestPartMultiplet: true,\n          symmetrizeEachStep: true,\n          debug: true,\n        });\n        setCalcFinished(true);\n        setAnalysisData(result);\n      } catch (err) {\n        // eslint-disable-next-line no-console\n        console.log(err);\n      }\n    }\n  }, [startX, endX, data, scaleX, activeSpectrum, calcStart]);\n\n  if (!isCalcFinished) {\n    return (\n      <div css={loaderStyles}>\n        <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 841.9 595.3\">\n          <g fill=\"#61DAFB\">\n            <path d=\"M666.3 296.5c0-32.5-40.7-63.3-103.1-82.4 14.4-63.6 8-114.2-20.2-130.4-6.5-3.8-14.1-5.6-22.4-5.6v22.3c4.6 0 8.3.9 11.4 2.6 13.6 7.8 19.5 37.5 14.9 75.7-1.1 9.4-2.9 19.3-5.1 29.4-19.6-4.8-41-8.5-63.5-10.9-13.5-18.5-27.5-35.3-41.6-50 32.6-30.3 63.2-46.9 84-46.9V78c-27.5 0-63.5 19.6-99.9 53.6-36.4-33.8-72.4-53.2-99.9-53.2v22.3c20.7 0 51.4 16.5 84 46.6-14 14.7-28 31.4-41.3 49.9-22.6 2.4-44 6.1-63.6 11-2.3-10-4-19.7-5.2-29-4.7-38.2 1.1-67.9 14.6-75.8 3-1.8 6.9-2.6 11.5-2.6V78.5c-8.4 0-16 1.8-22.6 5.6-28.1 16.2-34.4 66.7-19.9 130.1-62.2 19.2-102.7 49.9-102.7 82.3 0 32.5 40.7 63.3 103.1 82.4-14.4 63.6-8 114.2 20.2 130.4 6.5 3.8 14.1 5.6 22.5 5.6 27.5 0 63.5-19.6 99.9-53.6 36.4 33.8 72.4 53.2 99.9 53.2 8.4 0 16-1.8 22.6-5.6 28.1-16.2 34.4-66.7 19.9-130.1 62-19.1 102.5-49.9 102.5-82.3zm-130.2-66.7c-3.7 12.9-8.3 26.2-13.5 39.5-4.1-8-8.4-16-13.1-24-4.6-8-9.5-15.8-14.4-23.4 14.2 2.1 27.9 4.7 41 7.9zm-45.8 106.5c-7.8 13.5-15.8 26.3-24.1 38.2-14.9 1.3-30 2-45.2 2-15.1 0-30.2-.7-45-1.9-8.3-11.9-16.4-24.6-24.2-38-7.6-13.1-14.5-26.4-20.8-39.8 6.2-13.4 13.2-26.8 20.7-39.9 7.8-13.5 15.8-26.3 24.1-38.2 14.9-1.3 30-2 45.2-2 15.1 0 30.2.7 45 1.9 8.3 11.9 16.4 24.6 24.2 38 7.6 13.1 14.5 26.4 20.8 39.8-6.3 13.4-13.2 26.8-20.7 39.9zm32.3-13c5.4 13.4 10 26.8 13.8 39.8-13.1 3.2-26.9 5.9-41.2 8 4.9-7.7 9.8-15.6 14.4-23.7 4.6-8 8.9-16.1 13-24.1zM421.2 430c-9.3-9.6-18.6-20.3-27.8-32 9 .4 18.2.7 27.5.7 9.4 0 18.7-.2 27.8-.7-9 11.7-18.3 22.4-27.5 32zm-74.4-58.9c-14.2-2.1-27.9-4.7-41-7.9 3.7-12.9 8.3-26.2 13.5-39.5 4.1 8 8.4 16 13.1 24 4.7 8 9.5 15.8 14.4 23.4zM420.7 163c9.3 9.6 18.6 20.3 27.8 32-9-.4-18.2-.7-27.5-.7-9.4 0-18.7.2-27.8.7 9-11.7 18.3-22.4 27.5-32zm-74 58.9c-4.9 7.7-9.8 15.6-14.4 23.7-4.6 8-8.9 16-13 24-5.4-13.4-10-26.8-13.8-39.8 13.1-3.1 26.9-5.8 41.2-7.9zm-90.5 125.2c-35.4-15.1-58.3-34.9-58.3-50.6 0-15.7 22.9-35.6 58.3-50.6 8.6-3.7 18-7 27.7-10.1 5.7 19.6 13.2 40 22.5 60.9-9.2 20.8-16.6 41.1-22.2 60.6-9.9-3.1-19.3-6.5-28-10.2zM310 490c-13.6-7.8-19.5-37.5-14.9-75.7 1.1-9.4 2.9-19.3 5.1-29.4 19.6 4.8 41 8.5 63.5 10.9 13.5 18.5 27.5 35.3 41.6 50-32.6 30.3-63.2 46.9-84 46.9-4.5-.1-8.3-1-11.3-2.7zm237.2-76.2c4.7 38.2-1.1 67.9-14.6 75.8-3 1.8-6.9 2.6-11.5 2.6-20.7 0-51.4-16.5-84-46.6 14-14.7 28-31.4 41.3-49.9 22.6-2.4 44-6.1 63.6-11 2.3 10.1 4.1 19.8 5.2 29.1zm38.5-66.7c-8.6 3.7-18 7-27.7 10.1-5.7-19.6-13.2-40-22.5-60.9 9.2-20.8 16.6-41.1 22.2-60.6 9.9 3.1 19.3 6.5 28.1 10.2 35.4 15.1 58.3 34.9 58.3 50.6-.1 15.7-23 35.6-58.4 50.6zM320.8 78.4z\" />\n            <path d=\"M520.5 78.1z\" />\n          </g>\n        </svg>\n        <p>Analyse Multiplet in progress. Please wait ...</p>\n      </div>\n    );\n  }\n\n  return (\n    <div css={styles}>\n      <div className=\"header handle\">\n        <span>Analyse Multiplet</span>\n\n        <CloseButton onClick={onClose} />\n      </div>\n      <div className=\"container\">\n        {analysisData?.debug?.steps.map((d, index) => {\n          return (\n            // eslint-disable-next-line react/no-array-index-key\n            <div key={index} className=\"row\">\n              <Plot\n                width={400}\n                height={200}\n                svgStyle={{ overflow: 'visible' }}\n                seriesViewportStyle={{ stroke: 'black' }}\n              >\n                <LineSeries data={xyToXYObject(d.multiplet)} />\n                <Axis\n                  id=\"y\"\n                  position=\"left\"\n                  tickPosition=\"inner\"\n                  displayPrimaryGridLines\n                  hiddenTicks\n                  paddingStart={0.1}\n                  paddingEnd={0.1}\n                />\n                <Axis\n                  id=\"x\"\n                  position=\"bottom\"\n                  tickPosition=\"inner\"\n                  displayPrimaryGridLines\n                />\n              </Plot>\n              <div className=\"multiplicity\">\n                <p>\n                  {analysisData.js[index]\n                    ? `${\n                        analysisData.js[index]?.multiplicity\n                      }: ${analysisData.js[index]?.coupling.toFixed(3)} Hz`\n                    : ''}\n                </p>\n              </div>\n              <Plot\n                width={400}\n                height={200}\n                seriesViewportStyle={{ stroke: 'black' }}\n              >\n                <LineSeries\n                  data={xyToXYObject(d.errorFunction)}\n                  lineStyle={{ strokeWidth: 1 }}\n                />\n                <Axis\n                  id=\"y\"\n                  position=\"left\"\n                  tickPosition=\"inner\"\n                  displayPrimaryGridLines\n                  hiddenTicks\n                  paddingStart={0.1}\n                  paddingEnd={0.1}\n                />\n                <Axis\n                  id=\"x\"\n                  position=\"bottom\"\n                  tickPosition=\"inner\"\n                  displayPrimaryGridLines\n                />\n              </Plot>\n            </div>\n          );\n        })}\n      </div>\n    </div>\n  );\n}\n","import { useMemo } from 'react';\n\nimport { Datum1D } from '../../data/types/data1d';\nimport { Datum2D } from '../../data/types/data2d';\nimport { useChartData } from '../context/ChartContext';\nimport nucleusToString from '../utility/nucleusToString';\n\nexport default function useSpectraByActiveNucleus() {\n  const { data, activeTab } = useChartData();\n\n  return useMemo<Array<Datum1D | Datum2D>>(() => {\n    if (data) {\n      return (\n        data.filter(\n          (spectrum) => activeTab === nucleusToString(spectrum.info.nucleus),\n        ) || []\n      );\n    }\n    return [];\n  }, [activeTab, data]);\n}\n","import get from 'lodash/get';\nimport { useMemo } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\nimport { usePreferences } from '../context/PreferencesContext';\n\ninterface ActiveSpectrumOptionsResult {\n  isActive: boolean;\n  opacity: number;\n}\n\nexport default function useActiveSpectrumStyleOptions(\n  id: string,\n): ActiveSpectrumOptionsResult {\n  const { activeSpectrum } = useChartData();\n  const preferences = usePreferences();\n\n  return useMemo(() => {\n    const isActive =\n      activeSpectrum === null ? true : id === activeSpectrum.id ? true : false;\n    const opacity = isActive\n      ? 1\n      : get(preferences.current, 'controllers.dimmedSpectraTransparency', 0.1);\n    return { isActive, opacity };\n  }, [activeSpectrum, id, preferences]);\n}\n","import { memo } from 'react';\n\nimport { ExclusionZone } from '../../data/types/data1d/ExclusionZone';\nimport { useScaleChecked } from '../context/ScaleContext';\nimport { HighlightedSource, useHighlight } from '../highlight';\nimport useActiveSpectrumStyleOptions from '../hooks/useActiveSpectrumStyleOptions';\n\ninterface ExclusionZoneProps {\n  zone: ExclusionZone;\n  color: string;\n  vAlign: number;\n  spectrumID: string;\n}\n\nfunction ExclusionZoneAnnotation({\n  zone,\n  color,\n  vAlign,\n  spectrumID,\n}: ExclusionZoneProps) {\n  const { scaleX, scaleY } = useScaleChecked();\n  const highlight = useHighlight([zone.id], {\n    type: HighlightedSource.EXCLUSION_ZONE,\n    extra: { id: zone.id, spectrumID },\n  });\n\n  const { opacity } = useActiveSpectrumStyleOptions(spectrumID);\n\n  return (\n    <g key={zone.id} transform={`translate(${scaleX()(zone.to)},0)`}>\n      <rect\n        x=\"0\"\n        transform={`translate(0,${scaleY()(0) - (vAlign + 5)})`}\n        width={`${scaleX()(zone.from) - scaleX()(zone.to)}`}\n        height=\"10px\"\n        style={{\n          fill: highlight.isActive ? '#ff6f0057' : color,\n          opacity,\n        }}\n        {...highlight.onHover}\n      />\n    </g>\n  );\n}\n\nexport default memo(ExclusionZoneAnnotation);\n","import { VerticalAlign, VerticalAlignment } from '../../reducer/Reducer';\n\nexport default function getVerticalShift(\n  verticalAlign: VerticalAlign,\n  option: { index?: number; align?: VerticalAlignment },\n) {\n  const { index = 1, align = 'stack' } = option || {\n    index: 1,\n    align: 'stack',\n  };\n\n  return verticalAlign.align === align\n    ? index * verticalAlign.verticalShift\n    : 0;\n}\n","import { memo } from 'react';\n\nimport * as Filters from '../../data/Filters';\nimport { Datum1D } from '../../data/types/data1d';\nimport { ExclusionZone } from '../../data/types/data1d/ExclusionZone';\nimport { useChartData } from '../context/ChartContext';\nimport useSpectraByActiveNucleus from '../hooks/useSpectraPerNucleus';\nimport { VerticalAlign } from '../reducer/Reducer';\nimport { DISPLAYER_MODE } from '../reducer/core/Constants';\n\nimport ExclusionZoneAnnotation from './ExclusionZoneAnnotation';\nimport getVerticalShift from './utilities/getVerticalShift';\n\ninterface ExclusionZonesAnnotationsInnerProps {\n  displayerKey: string;\n  spectra: Datum1D[];\n  xDomains: any;\n  verticalAlign: VerticalAlign;\n}\n\nfunction ExclusionZonesAnnotationsInner({\n  displayerKey,\n  xDomains,\n  spectra,\n  verticalAlign,\n}: ExclusionZonesAnnotationsInnerProps) {\n  return (\n    <g\n      className=\"spectrum-exclusion-zones-group\"\n      clipPath={`url(#${displayerKey}clip-chart-1d)`}\n    >\n      {spectra\n        .filter((d) => d.display.isVisible === true && xDomains[d.id])\n        .map((d, index) =>\n          getExclusionZones(d).map((zone) => {\n            return (\n              <ExclusionZoneAnnotation\n                key={zone.id}\n                spectrumID={d.id}\n                vAlign={getVerticalShift(verticalAlign, { index })}\n                zone={zone}\n                color={d.display.color}\n              />\n            );\n          }),\n        )}\n    </g>\n  );\n}\n\nconst MemoizedPeakAnnotations = memo(ExclusionZonesAnnotationsInner);\n\nfunction ExclusionZonesAnnotations() {\n  const { displayerKey, xDomains, displayerMode, verticalAlign } =\n    useChartData();\n\n  const spectra = useSpectraByActiveNucleus() as Datum1D[];\n\n  if (displayerMode !== DISPLAYER_MODE.DM_1D) return null;\n\n  return (\n    <MemoizedPeakAnnotations\n      spectra={spectra}\n      displayerKey={displayerKey}\n      xDomains={xDomains}\n      verticalAlign={verticalAlign}\n    />\n  );\n}\n\nexport default ExclusionZonesAnnotations;\n\nfunction getExclusionZones(data: Datum1D): ExclusionZone[] {\n  return (\n    data.filters.find(\n      (filter) => filter.name === Filters.exclusionZones.id && filter.flag,\n    )?.value || []\n  );\n}\n","import { ScaleLinear } from 'd3';\nimport { useMemo } from 'react';\n\nimport { getXScale } from '../1d/utilities/scale';\nimport { useChartData } from '../context/ChartContext';\n\nexport function useXScale(): ScaleLinear<any, any, never> {\n  const { width, margin, xDomains, xDomain, mode } = useChartData();\n\n  return useMemo(\n    () => getXScale({ width, margin, xDomains, xDomain, mode }),\n    [margin, mode, width, xDomain, xDomains],\n  );\n}\n","import { ScaleLinear } from 'd3';\nimport { xyIntegral, xyReduce } from 'ml-spectra-processing';\nimport { useMemo } from 'react';\n\nimport { Data1D } from '../../data/types/data1d';\nimport { getIntegralYScale } from '../1d/utilities/scale';\nimport { useChartData } from '../context/ChartContext';\nimport { PathBuilder } from '../utility/PathBuilder';\n\nimport { useXScale } from './useXScale';\n\nfunction useIntegralYDomain(): ScaleLinear<number, number, number> {\n  const { height, margin, verticalAlign, activeSpectrum, integralsYDomains } =\n    useChartData();\n\n  return useMemo(\n    () =>\n      getIntegralYScale({\n        height,\n        margin,\n        verticalAlign,\n        activeSpectrum,\n        integralsYDomains,\n      }),\n    [activeSpectrum, height, integralsYDomains, margin, verticalAlign],\n  );\n}\n\nexport default function useIntegralPath(integralOptions: {\n  from: number;\n  to: number;\n}) {\n  const { data, activeSpectrum } = useChartData();\n\n  const scaleX = useXScale();\n  const scaleY = useIntegralYDomain();\n  const integral = useMemo(() => {\n    if (activeSpectrum) {\n      const { x, re } = data[activeSpectrum?.index].data as Data1D;\n      const { from, to } = integralOptions;\n      return xyIntegral(\n        { x, y: re },\n        {\n          from,\n          to,\n          reverse: true,\n        },\n      );\n    }\n    return { x: [], y: [] };\n  }, [activeSpectrum, data, integralOptions]);\n\n  const paths = useMemo(() => {\n    if (integral) {\n      const xySeries = xyReduce(integral, {\n        // from: xDomain[0],\n        // to: xDomain[1],\n        nbPoints: 200,\n        optimize: true,\n      });\n\n      const pathBuilder = new PathBuilder();\n      pathBuilder.moveTo(scaleX(xySeries.x[0]), scaleY(xySeries.y[0]));\n      for (let i = 1; i < xySeries.x.length; i++) {\n        pathBuilder.lineTo(scaleX(xySeries.x[i]), scaleY(xySeries.y[i]));\n      }\n\n      return pathBuilder.toString();\n    } else {\n      return '';\n    }\n  }, [integral, scaleX, scaleY]);\n\n  return paths;\n}\n","const integralDefaultValues = {\n  showAbsolute: false,\n  absoluteFormat: '0.00',\n  showRelative: true,\n  relativeFormat: '0.00',\n  color: '#000000',\n  strokeWidth: 1,\n};\n\nconst zoneDefaultValues = {\n  showFrom: false,\n  fromFormat: '0.00',\n  showTo: false,\n  toFormat: '0.00',\n  showAbsolute: false,\n  absoluteFormat: '0.00',\n  showRelative: true,\n  relativeFormat: '0.00',\n};\n\nconst getRangeDefaultValues = (nucleus?: string) => ({\n  showFrom: false,\n  fromFormat: '0.00',\n  showTo: false,\n  toFormat: '0.00',\n  showAbsolute: false,\n  absoluteFormat: '0.00',\n  showRelative: true,\n  relativeFormat: '0.00',\n  jGraphTolerance: nucleus === '1H' ? 0.2 : nucleus === '13C' ? 2 : 0, //J Graph tolerance for: 1H: 0.2Hz 13C: 2Hz\n});\n\nconst peaksDefaultValues = {\n  showPeakNumber: true,\n  peakNumberFormat: '0',\n  showPeakIndex: false,\n  peakIndexFormat: '0.00',\n  showDeltaPPM: true,\n  deltaPPMFormat: '0.00',\n  showDeltaHz: false,\n  deltaHzFormat: '0.00',\n  showPeakWidth: false,\n  peakWidthFormat: '00.0000',\n  showIntensity: true,\n  intensityFormat: '0.00',\n};\n\nconst databaseDefaultValues = {\n  showSmiles: true,\n  showSolvent: false,\n  showNames: true,\n  showRange: false,\n  showDelta: true,\n  showAssignment: false,\n  showCoupling: true,\n  showMultiplicity: true,\n};\n\nexport {\n  peaksDefaultValues,\n  integralDefaultValues,\n  getRangeDefaultValues,\n  zoneDefaultValues,\n  databaseDefaultValues,\n};\n","import { useEffect, useMemo, useRef } from 'react';\n\nimport useDraggable, { Draggable } from '../draggble/useDraggable';\n\nimport { ResizerProps, Position } from './Resizer';\n\ninterface UseResizer {\n  right: Draggable;\n  left: Draggable;\n  prevPosition: Position;\n  currentPosition: Position;\n  isActive: boolean;\n}\n\nexport default function useResizer(props: ResizerProps): UseResizer {\n  const {\n    initialPosition = { x1: 10, x2: 40 },\n    onStart,\n    onMove,\n    onEnd,\n    parentElement,\n  } = props;\n\n  const currentPosition = useRef<{ x1: number; x2: number }>(initialPosition);\n  const prevPosition = useRef<{ x1: number; x2: number }>(initialPosition);\n  const activeRef = useRef<boolean>(false);\n\n  const triggerEvent = useRef((position: Position, status: string | null) => {\n    switch (status) {\n      case 'start':\n        onStart?.(position);\n        activeRef.current = true;\n        break;\n      case 'move':\n        onMove?.(position);\n        break;\n      case 'end':\n        prevPosition.current = position;\n        activeRef.current = false;\n\n        onEnd?.(position);\n        break;\n      default:\n        break;\n    }\n  });\n\n  const right = useDraggable({\n    position: { x: initialPosition.x2, y: 0 },\n    parentElement,\n    fromEdge: true,\n  });\n  const left = useDraggable({\n    position: { x: initialPosition.x1, y: 0 },\n    parentElement,\n    fromEdge: true,\n  });\n\n  useEffect(() => {\n    currentPosition.current = {\n      x1: left.position.value.x,\n      x2: right.position.value.x,\n    };\n  }, [left.position.value.x, right.position.value.x]);\n\n  useEffect(() => {\n    const {\n      value: { x },\n      action,\n    } = left.position;\n    const position: Position = {\n      x1: x,\n      x2: currentPosition.current.x2,\n    };\n    triggerEvent.current(position, action);\n  }, [left.position]);\n\n  useEffect(() => {\n    const {\n      value: { x },\n      action,\n    } = right.position;\n    const position: Position = {\n      x1: currentPosition.current.x1,\n      x2: x,\n    };\n    triggerEvent.current(position, action);\n  }, [right.position]);\n\n  return useMemo(\n    () => ({\n      left,\n      right,\n      prevPosition: prevPosition.current,\n      currentPosition: currentPosition.current,\n      isActive: activeRef.current,\n    }),\n    [left, right],\n  );\n}\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { CSSProperties } from 'react';\n\nimport { Draggable } from '../draggble/useDraggable';\n\nimport { ResizerProps, Position } from './Resizer';\nimport useResizer from './useResizer';\n\nconst anchorStyle: CSSProperties = {\n  marginLeft: '5px',\n  width: '2px',\n  height: '100%',\n  pointerEvents: 'none',\n  position: 'relative',\n};\nconst styles = {\n  container: (position: number) => css`\n    position: absolute;\n    height: 100%;\n    width: 10px;\n    left: -5px;\n    cursor: e-resize;\n    transform: translateX(${position}px);\n    user-select: none;\n    z-index: 99999999;\n\n    &:hover {\n      div {\n        background-color: red;\n      }\n    }\n  `,\n\n  content: (left: Draggable, right: Draggable, prevPosition: Position) => {\n    const width = prevPosition.x2 - prevPosition.x1;\n\n    const baseCss = css`\n      position: absolute;\n      width: ${width}px;\n      overflow: hidden;\n    `;\n    if (right.position.action === 'move' || left.position.action === 'move') {\n      const scale = (right.position.value.x - left.position.value.x) / width;\n      return [\n        baseCss,\n        css`\n          transform: translateX(${left.position.value.x}px) scaleX(${scale});\n          transform-origin: left center;\n        `,\n      ];\n    } else {\n      return css([\n        baseCss,\n        css`\n          transform: translateX(${left.position.value.x}px);\n        `,\n      ]);\n    }\n  },\n};\n\nexport default function DivResizer(props: ResizerProps) {\n  const { children } = props;\n  const { left, right, prevPosition, currentPosition, isActive } =\n    useResizer(props);\n\n  return (\n    <>\n      <div\n        data-no-export=\"true\"\n        onMouseDown={right.onMouseDown}\n        css={styles.container(right.position.value.x)}\n      >\n        <div style={anchorStyle} />\n      </div>\n      <div css={styles.content(left, right, prevPosition)}>\n        {typeof children === 'function'\n          ? children?.(currentPosition, isActive)\n          : children}\n      </div>\n      <div\n        data-no-export=\"true\"\n        onMouseDown={left.onMouseDown}\n        css={styles.container(left.position.value.x)}\n      >\n        <div style={anchorStyle} />\n      </div>\n    </>\n  );\n}\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { CSSProperties, MouseEventHandler } from 'react';\n\nimport { ResizerProps } from './Resizer';\nimport useResizer from './useResizer';\n\nconst anchorStyle: CSSProperties = {\n  width: '2px',\n  height: '100%',\n  pointerEvents: 'none',\n  fill: 'transparent',\n};\nconst styles = {\n  container: (position: number) => css`\n    transform: translateX(${position}px);\n    &:hover {\n      rect:last-child {\n        fill: red !important;\n      }\n    }\n  `,\n  innerContainer: css`\n    position: absolute;\n    height: 100%;\n    fill: transparent;\n    width: 10px;\n    cursor: e-resize;\n    user-select: none;\n    z-index: 99999999;\n  `,\n};\n\nexport default function SVGResizer(props: ResizerProps) {\n  const { children } = props;\n  const { left, right, currentPosition, isActive } = useResizer(props);\n\n  return (\n    <g\n      style={{\n        transform: `translateX(${currentPosition.x1}px)`,\n      }}\n    >\n      {typeof children === 'function'\n        ? children(currentPosition, isActive)\n        : children}\n      <SVGResizerHandle onMouseDown={left.onMouseDown} position={0} />\n      <SVGResizerHandle\n        onMouseDown={right.onMouseDown}\n        position={Math.ceil(currentPosition.x2 - currentPosition.x1)}\n      />\n    </g>\n  );\n}\n\nfunction SVGResizerHandle(props: {\n  onMouseDown: MouseEventHandler<SVGGElement>;\n  position: number;\n}) {\n  return (\n    <g\n      onMouseDown={props.onMouseDown}\n      css={styles.container(props.position)}\n      data-no-export=\"true\"\n    >\n      <rect x=\"-5px\" css={styles.innerContainer} />\n      <rect x=\"-2.5px\" style={anchorStyle} />\n    </g>\n  );\n}\n","import { ReactFragment } from 'react';\n\nimport DivResizer from './DivResizer';\nimport SVGResizer from './SVGResizer';\n\nexport interface Position {\n  x1: number;\n  x2: number;\n}\n\ntype ChildType =\n  | Array<React.ReactElement>\n  | React.ReactElement\n  | ReactFragment\n  | boolean\n  | null;\n\nexport interface ResizerProps {\n  children?: ChildType | ((position: Position, isActive: boolean) => ChildType);\n  initialPosition?: Position;\n  position?: Position;\n  onStart?: PositionChangeHandler;\n  onMove?: PositionChangeHandler;\n  onEnd?: PositionChangeHandler;\n  tag?: 'div' | 'svg';\n  parentElement?: HTMLElement | null;\n  dragHandleClassName?: string;\n}\n\ntype PositionChangeHandler = (data: Position) => void;\n\nexport default function Resizer(props: ResizerProps) {\n  const { tag = 'div', ...resProps } = props;\n  if (tag === 'div') {\n    return <DivResizer {...resProps} />;\n  } else {\n    return <SVGResizer {...resProps} />;\n  }\n}\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\nimport { useDispatch } from '../context/DispatchContext';\nimport { useGlobal } from '../context/GlobalContext';\nimport { useScaleChecked } from '../context/ScaleContext';\nimport Resizer from '../elements/resizer/Resizer';\nimport { HighlightedSource, useHighlight } from '../highlight/index';\nimport { RESIZE_INTEGRAL } from '../reducer/types/Types';\n\nconst stylesOnHover = css`\n  pointer-events: bounding-box;\n  @-moz-document url-prefix() {\n    pointer-events: fill;\n  }\n  .highlight {\n    fill: transparent;\n  }\n  .target {\n    visibility: hidden;\n  }\n`;\n\nconst stylesHighlighted = css`\n  pointer-events: bounding-box;\n\n  @-moz-document url-prefix() {\n    pointer-events: fill;\n  }\n  fill: #ff6f0057;\n\n  .target {\n    visibility: visible;\n  }\n`;\n\ninterface IntegralResizableProps {\n  integralData: {\n    id: string;\n    from: number;\n    to: number;\n    integral?: number;\n  };\n}\n\nfunction IntegralResizable({ integralData }: IntegralResizableProps) {\n  const { height, margin } = useChartData();\n  const { viewerRef } = useGlobal();\n  const { scaleX } = useScaleChecked();\n  const dispatch = useDispatch();\n  const { id, integral } = integralData;\n  const highlight = useHighlight([id], {\n    type: HighlightedSource.INTEGRAL,\n    extra: { id },\n  });\n\n  const handleOnStopResizing = useCallback(\n    (position) => {\n      dispatch({\n        type: RESIZE_INTEGRAL,\n        payload: {\n          data: {\n            ...integralData,\n            from: scaleX().invert(position.x2),\n            to: scaleX().invert(position.x1),\n          },\n        },\n      });\n    },\n    [dispatch, integralData, scaleX],\n  );\n\n  const handleOnEnterNotation = useCallback(() => {\n    highlight.show();\n  }, [highlight]);\n\n  const handleOnMouseLeaveNotation = useCallback(() => {\n    highlight.hide();\n  }, [highlight]);\n\n  const from = integralData.from ? scaleX()(integralData.from) : 0;\n  const to = integralData.to ? scaleX()(integralData.to) : 0;\n\n  return (\n    <g\n      onMouseEnter={handleOnEnterNotation}\n      onMouseLeave={handleOnMouseLeaveNotation}\n    >\n      <Resizer\n        tag=\"svg\"\n        initialPosition={{ x1: to, x2: from }}\n        onEnd={handleOnStopResizing}\n        parentElement={viewerRef}\n        key={`${id}_${to}_${from}`}\n      >\n        {({ x1, x2 }, isActive) => (\n          <g\n            css={\n              highlight.isActive || isActive ? stylesHighlighted : stylesOnHover\n            }\n          >\n            <rect\n              x=\"0\"\n              y=\"0\"\n              width={x2 - x1}\n              height={height - margin.bottom}\n              className=\"highlight\"\n              data-no-export=\"true\"\n            />\n            <text\n              x={0}\n              y={height - margin.bottom + 30}\n              fill=\"black\"\n              style={{ fontSize: '12px', fontWeight: 'bold' }}\n            >\n              {integral !== undefined ? integral.toFixed(2) : ''}\n            </text>\n          </g>\n        )}\n      </Resizer>\n    </g>\n  );\n}\n\nexport default IntegralResizable;\n","import { useMemo } from 'react';\n\nimport { usePreferences } from '../context/PreferencesContext';\nimport useIntegralPath from '../hooks/useIntegralPath';\nimport { integralDefaultValues } from '../panels/extra/preferences/defaultValues';\nimport { getValue } from '../utility/LocalStorage';\n\nimport IntegralResizable from './IntegralResizable';\n\ninterface IntegralProps {\n  integral: { id: string; from: number; to: number; integral?: number };\n  isActive: boolean;\n}\n\nfunction Integral({ integral, isActive }: IntegralProps) {\n  const preferences = usePreferences();\n  const path = useIntegralPath(integral);\n\n  const integralSettings = useMemo(() => {\n    let {\n      color = integralDefaultValues.color,\n      strokeWidth = integralDefaultValues.strokeWidth,\n    } = getValue(preferences.current, 'formatting.panels.integrals') || {};\n    return { color, strokeWidth };\n  }, [preferences]);\n\n  return (\n    <g>\n      <path\n        className=\"line\"\n        stroke={integralSettings.color}\n        strokeWidth={integralSettings.strokeWidth}\n        fill=\"none\"\n        style={{\n          opacity: isActive ? 1 : 0.2,\n        }}\n        d={path}\n      />\n\n      <IntegralResizable integralData={integral} />\n    </g>\n  );\n}\n\nexport default Integral;\n","import { useMemo } from 'react';\n\nimport { isSpectrum1D } from '../../data/data1d/Spectrum1D';\nimport { useChartData } from '../context/ChartContext';\n\nimport Integral from './Integral';\n\nfunction IntegralsSeries() {\n  const { xDomains, activeSpectrum, data, displayerKey } = useChartData();\n\n  const Integrals = useMemo(() => {\n    const isActive = (id) => {\n      return activeSpectrum === null\n        ? true\n        : id === activeSpectrum.id\n        ? true\n        : false;\n    };\n\n    return (\n      <g className=\"integrals\">\n        {data?.[0] &&\n          data\n            .filter((d) => d.display.isVisible === true && xDomains[d.id])\n            .filter(isSpectrum1D)\n            .map((spectrum) =>\n              spectrum.integrals.values.map((integral) => (\n                <Integral\n                  key={integral.id}\n                  integral={integral}\n                  isActive={isActive(spectrum.id)}\n                />\n              )),\n            )}\n      </g>\n    );\n  }, [activeSpectrum, data, xDomains]);\n\n  return <g clipPath={`url(#${displayerKey}clip-chart-1d)`}>{Integrals}</g>;\n}\n\nexport default IntegralsSeries;\n","import { CSSProperties, useMemo } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\nimport { useScaleChecked } from '../context/ScaleContext';\nimport useActiveSpectrumStyleOptions from '../hooks/useActiveSpectrumStyleOptions';\nimport useXYReduce, { XYReducerDomainAxis } from '../hooks/useXYReduce';\nimport { PathBuilder } from '../utility/PathBuilder';\n\nimport getVerticalShift from './utilities/getVerticalShift';\n\ninterface LineProps {\n  data?: {\n    x: Array<number>;\n    y: Array<number>;\n  };\n  id: string;\n  display: {\n    color: CSSProperties['stroke'];\n  };\n  index: number;\n}\n\nfunction Line({ data, id, display, index }: LineProps) {\n  const { verticalAlign } = useChartData();\n  const { scaleX, scaleY } = useScaleChecked();\n  const xyReduce = useXYReduce(XYReducerDomainAxis.XAxis);\n  const { opacity } = useActiveSpectrumStyleOptions(id);\n\n  const vAlign = useMemo(() => {\n    return getVerticalShift(verticalAlign, { index });\n  }, [index, verticalAlign]);\n\n  const paths = useMemo(() => {\n    const _scaleX = scaleX();\n    const _scaleY = scaleY(id);\n\n    const pathBuilder = new PathBuilder();\n    if (data?.x && data?.y && _scaleX(0)) {\n      const pathPoints = xyReduce(data);\n\n      pathBuilder.moveTo(_scaleX(pathPoints.x[0]), _scaleY(pathPoints.y[0]));\n      for (let i = 1; i < pathPoints.x.length; i++) {\n        pathBuilder.lineTo(_scaleX(pathPoints.x[i]), _scaleY(pathPoints.y[i]));\n      }\n\n      return pathBuilder.toString();\n    } else {\n      return '';\n    }\n  }, [scaleX, scaleY, id, data, xyReduce]);\n\n  return (\n    <path\n      className=\"line\"\n      data-test-id=\"spectrum-line\"\n      key={id}\n      stroke={display.color}\n      fill=\"none\"\n      style={{\n        opacity,\n      }}\n      d={paths}\n      transform={`translate(0,-${vAlign})`}\n    />\n  );\n}\n\nexport default Line;\n","import { get1DDataXY } from '../../data/data1d/Spectrum1D/get1DDataXY';\nimport { useChartData } from '../context/ChartContext';\n\nimport Line from './Line';\n\nfunction LinesSeries() {\n  const { data, tempData, displayerKey, xDomains } = useChartData();\n  const _data = tempData ? tempData : data;\n\n  return (\n    <g clipPath={`url(#${displayerKey}clip-chart-1d)`} className=\"spectrums\">\n      {_data\n        ?.filter((d) => d.display.isVisible === true && xDomains[d.id])\n        .map((d, i) => (\n          <Line key={d.id} {...d} data={get1DDataXY(d)} index={i} />\n        ))}\n    </g>\n  );\n}\n\nexport default LinesSeries;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport {\n  useRef,\n  useState,\n  useCallback,\n  useLayoutEffect,\n  useEffect,\n  useMemo,\n} from 'react';\n\nimport { useDispatch } from '../context/DispatchContext';\nimport { HighlightedSource, useHighlight } from '../highlight';\nimport { SHIFT_SPECTRUM } from '../reducer/types/Types';\nimport { useFormatNumberByNucleus } from '../utility/FormatNumber';\n\nconst styles = css`\n  input {\n    -webkit-user-select: text; /* Safari 3.1+ */\n    -moz-user-select: text; /* Firefox 2+ */\n    -ms-user-select: text; /* IE 10+ */\n    user-select: text; /* Standard syntax */\n  }\n\n  input[type='number']::-webkit-outer-spin-button,\n  input[type='number']::-webkit-inner-spin-button {\n    -webkit-appearance: none;\n    margin: 0;\n  }\n\n  input[type='number'] {\n    -moz-appearance: textfield;\n  }\n\n  .notification-input-normal {\n    opacity: 1;\n    left: 4px;\n    position: fixed;\n    font-size: 10px;\n    outline: none;\n    background-color: transparent;\n  }\n\n  .notification-input-normal input:focus {\n    outline: none;\n    background-color: white;\n  }\n\n  .input-over {\n    background-color: white;\n    outline: none;\n  }\n`;\n\ninterface PeakAnnotationProps {\n  id: string;\n  x: number;\n  y: number;\n  sign: number;\n  color: string;\n  isActive: boolean;\n  value: number;\n  nucleus: string;\n}\n\nfunction PeakAnnotation({\n  id,\n  x,\n  y,\n  sign, // 1 positive -1 negative\n  value,\n  color,\n  isActive,\n  nucleus,\n}: PeakAnnotationProps) {\n  const refText = useRef<SVGTextElement>(null);\n  const [isSelected, setIsSelected] = useState(false);\n  const [_value, setValue] = useState(value);\n  const [containerSize, setContainerSize] = useState({ width: 0, height: 0 });\n  const format = useFormatNumberByNucleus(nucleus);\n  const highlight = useHighlight([id], {\n    type: HighlightedSource.PEAK,\n    extra: { id },\n  });\n\n  const dispatch = useDispatch();\n\n  const handleOnPeakChange = useCallback(\n    (e) => dispatch({ type: SHIFT_SPECTRUM, shiftValue: e.shiftValue }),\n    [dispatch],\n  );\n\n  useLayoutEffect(() => {\n    const textBox = refText.current?.getBBox();\n    setContainerSize({\n      width: textBox?.width || 0,\n      height: textBox?.height || 0,\n    });\n  }, [isSelected]);\n\n  useEffect(() => {\n    setValue(value);\n  }, [value]);\n\n  const handleKeyDown = useCallback(\n    (event: React.KeyboardEvent<HTMLInputElement>) => {\n      if (event.key === 'Enter') {\n        const newValue = event.currentTarget.valueAsNumber;\n        if (!isNaN(newValue)) {\n          const shiftValue = newValue - value;\n\n          handleOnPeakChange({\n            id,\n            value: newValue,\n            oldValue: value,\n            shiftValue: shiftValue,\n          });\n\n          event.currentTarget.blur();\n          setIsSelected(false);\n        }\n      } else if (event.key === 'Escape') {\n        setValue(value);\n        event.currentTarget.blur();\n        setIsSelected(false);\n      }\n    },\n    [value, handleOnPeakChange, id],\n  );\n\n  const handleChange = useCallback((event) => {\n    setValue(event.target.value);\n  }, []);\n\n  const handleSelectPeakAnnotation = useCallback((e) => {\n    e.stopPropagation();\n    setIsSelected(true);\n    return false;\n  }, []);\n\n  const handleOnEnterNotation = useCallback(() => {\n    highlight.show();\n  }, [highlight]);\n\n  const handleOnMouseLeaveNotation = useCallback(() => {\n    highlight.hide();\n  }, [highlight]);\n\n  const newValue = useMemo(\n    () => (isSelected ? value : format(value)),\n    [format, isSelected, value],\n  );\n  const oldValue = useMemo(\n    () => (isSelected ? _value : format(_value)),\n    [_value, format, isSelected],\n  );\n\n  return (\n    <g\n      css={styles}\n      id={id}\n      style={{ outline: 'none' }}\n      transform={`translate(${x}, ${y})`}\n      onMouseEnter={handleOnEnterNotation}\n      onMouseLeave={handleOnMouseLeaveNotation}\n    >\n      <line\n        x1=\"0\"\n        x2=\"0\"\n        y1={sign === -1 ? 10 : 0}\n        y2={sign === -1 ? 28 : -18}\n        stroke={color}\n        strokeWidth={highlight.isActive ? '7px' : '1px'}\n      />\n      <text\n        ref={refText}\n        className=\"peaks-text\"\n        x=\"0\"\n        y={sign === -1 ? 28 : -12}\n        dy=\"0\"\n        dx=\"0.35em\"\n        fill=\"transparent\"\n        fontSize=\"10px\"\n        fontWeight=\"100\"\n        style={{\n          position: 'absolute',\n        }}\n      >\n        {newValue}\n      </text>\n      <foreignObject\n        x=\"0\"\n        y={sign === -1 ? 16 : -22}\n        dy=\"0.1em\"\n        dx=\"0.35em\"\n        width={containerSize.width + 20}\n        height=\"40px\"\n        data-no-export=\"true\"\n      >\n        <div\n          style={{\n            width: containerSize.width + 20,\n            height: '100%',\n            paddingRight: 5,\n          }}\n        >\n          <input\n            onClick={handleSelectPeakAnnotation}\n            className={isSelected ? 'input-over' : 'notification-input-normal'}\n            style={{\n              width: 'inherit',\n              border: isSelected ? `1px solid ${color}` : `0`,\n              opacity: isActive ? 1 : 0.2,\n              userSelect: 'none',\n              color: color,\n            }}\n            value={oldValue}\n            onKeyDown={handleKeyDown}\n            onChange={handleChange}\n            type=\"number\"\n            disabled={!isActive}\n          />\n        </div>\n      </foreignObject>\n    </g>\n  );\n}\n\nexport default PeakAnnotation;\n","import { useMemo } from 'react';\n\nimport { isSpectrum1D } from '../../data/data1d/Spectrum1D';\nimport { useChartData } from '../context/ChartContext';\nimport { useScaleChecked } from '../context/ScaleContext';\n\nimport PeakAnnotation from './PeakAnnotation';\nimport getVerticalShift from './utilities/getVerticalShift';\n\nfunction PeakAnnotations() {\n  const { data, activeSpectrum, verticalAlign, displayerKey, xDomains } =\n    useChartData();\n  const { scaleX, scaleY } = useScaleChecked();\n\n  const Peaks = useMemo(() => {\n    const getVerticalAlign = (id) => {\n      const index = data.findIndex((d) => d.id === id);\n      return getVerticalShift(verticalAlign, { index });\n    };\n\n    const reSortData = () => {\n      const _data = [...data];\n      return activeSpectrum\n        ? _data.sort((x, y) => {\n            return x.id === activeSpectrum.id\n              ? 1\n              : y.id === activeSpectrum.id\n              ? -1\n              : 0;\n          })\n        : _data;\n    };\n\n    return (\n      data &&\n      reSortData()\n        .filter((d) => d.display.isVisible === true && xDomains[d.id])\n        .filter(isSpectrum1D)\n        .map((d) => {\n          return (\n            d.peaks?.values &&\n            d.display.isPeaksMarkersVisible && (\n              <g\n                key={d.id}\n                transform={`translate(0,-${getVerticalAlign(d.id)})`}\n              >\n                {d.peaks.values.map(({ x, y, id }) => (\n                  <PeakAnnotation\n                    key={id}\n                    x={scaleX()(x)}\n                    y={scaleY(d.id)(y) - 5}\n                    sign={Math.sign(y)}\n                    id={id}\n                    value={x}\n                    color=\"#730000\"\n                    nucleus={d.info.nucleus}\n                    isActive={\n                      activeSpectrum == null\n                        ? false\n                        : activeSpectrum.id === d.id\n                        ? true\n                        : false\n                    }\n                  />\n                ))}\n              </g>\n            )\n          );\n        })\n    );\n  }, [data, verticalAlign, activeSpectrum, xDomains, scaleX, scaleY]);\n\n  return (\n    <g className=\"peaks\" clipPath={`url(#${displayerKey}clip-chart-1d)`}>\n      {Peaks}\n    </g>\n  );\n}\n\nexport default PeakAnnotations;\n","import { extent } from 'd3';\nimport { rangesToXY } from 'nmr-processing';\n\nimport { Datum1D } from '../../data/types/data1d';\nimport { useChartData } from '../context/ChartContext';\nimport { useScaleChecked } from '../context/ScaleContext';\nimport { HighlightedSource, useHighlightData } from '../highlight';\nimport useSpectrum from '../hooks/useSpectrum';\n\nimport { getYScale } from './utilities/scale';\n\nconst emptyData = { info: { originFrequency: 400 } };\n\nfunction ResurrectedDatabaseRanges() {\n  const { displayerKey, verticalAlign, height, margin } = useChartData();\n  const { info } = useSpectrum(emptyData) as Datum1D;\n  const { highlight } = useHighlightData();\n  const { scaleX } = useScaleChecked();\n\n  if (highlight.sourceData?.type !== HighlightedSource.DATABASE) {\n    return null;\n  }\n\n  const fullHeight = height - margin.bottom;\n  const blockHight = fullHeight / 4;\n\n  const { ranges } = highlight.sourceData.extra || [];\n\n  let yDomain: any[] = [0, 0];\n\n  const spectra = ranges.map((range) => {\n    const { from, to } = range;\n    const diff = Math.abs(from - to) / 2;\n    const newForm = from - diff;\n    const newTo = to + diff;\n    const data = rangesToXY([range], {\n      frequency: info.originFrequency,\n      from: newForm,\n      to: newTo,\n      nbPoints: 256,\n    });\n    //calculate y domain\n    const domain = extent(data.y) as number[];\n    yDomain[0] = domain[0] < yDomain[0] ? domain[0] : yDomain[0];\n    yDomain[1] = domain[1] > yDomain[1] ? domain[1] : yDomain[1];\n\n    return { data, from: newForm, to: newTo };\n  }, []);\n\n  const scaleY = getYScale({\n    height: blockHight,\n    margin: { top: 0, bottom: 0 },\n    verticalAlign,\n    yDomain,\n  });\n\n  const paths = spectra.map(({ data: { x, y }, from, to }) => {\n    let path = `M ${scaleX()(x[0])} ${scaleY(y[0])} `;\n    path += x.slice(1).reduce((accumulator, point, i) => {\n      accumulator += ` L ${scaleX()(point)} ${scaleY(y[i + 1])}`;\n      return accumulator;\n    }, '');\n    return { path, from, to };\n  }, []);\n\n  return (\n    <g\n      clipPath={`url(#${displayerKey}clip-chart-1d)`}\n      className=\"resurrected-database-ranges\"\n      width=\"100%\"\n      height=\"100%\"\n    >\n      {paths.map(({ path, from, to }, index) => (\n        // eslint-disable-next-line react/no-array-index-key\n        <g key={`${index}`}>\n          <g transform={`translate(${scaleX()(to)},0)`}>\n            <rect\n              x=\"0\"\n              width={Math.abs(scaleX()(to) - scaleX()(from))}\n              height=\"100%\"\n              fill=\"#ff6f0057\"\n            />\n          </g>\n          <path\n            transform={`translate(0,${fullHeight - blockHight * 2})`}\n            stroke=\"black\"\n            fill=\"none\"\n            d={path}\n          />\n        </g>\n      ))}\n    </g>\n  );\n}\n\nexport default ResurrectedDatabaseRanges;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport * as d3 from 'd3';\nimport { useEffect, useRef } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\nimport { useScale } from '../context/ScaleContext';\n\nconst axisStyles = css`\n  user-select: none;\n\n  path,\n  line {\n    fill: none;\n    stroke: black;\n    stroke-width: 1;\n    shape-rendering: crispEdges;\n    user-select: none;\n  }\n`;\n\nconst gridStyles = css`\n  user-select: none;\n\n  line {\n    stroke: rgb(104, 104, 104);\n    stroke-opacity: 0.2;\n    shape-rendering: crispEdges;\n    stroke-dasharray: 3;\n    stroke-width: 1;\n    user-select: none;\n  }\n\n  path {\n    stroke-width: 0;\n  }\n`;\n\ninterface XAxisProps {\n  show?: boolean;\n  showGrid?: boolean;\n  mode?: string;\n  label?: string;\n}\n\nfunction XAxis(props: XAxisProps) {\n  const { show = true, showGrid = false, mode, label: labelProp } = props;\n  const { xDomain, height, width, margin } = useChartData();\n  const { scaleX } = useScale();\n\n  const refAxis = useRef<SVGGElement>(null);\n  const refGrid = useRef<SVGGElement>(null);\n\n  const label = labelProp ? labelProp : mode === 'RTL' ? 'δ [ppm]' : 'time [s]';\n\n  useEffect(() => {\n    if (!show || !scaleX) return;\n\n    const xAxis = d3\n      .axisBottom(scaleX().domain(xDomain))\n      .ticks(8)\n      .tickFormat(d3.format('0'));\n\n    const grid = d3\n      .axisBottom(scaleX().domain(xDomain))\n      .ticks(50)\n      .tickSize(-(height - margin.top - margin.bottom))\n      .tickFormat(() => '');\n\n    // @ts-expect-error This line of code is actually well typed ...\n    d3.select(refAxis.current).call(xAxis);\n\n    // @ts-expect-error ditto\n    d3.select(refGrid.current).call(grid);\n  }, [height, margin.bottom, margin.top, scaleX, show, xDomain]);\n\n  if (!width || !height || !scaleX) {\n    return null;\n  }\n\n  return (\n    <>\n      {show && (\n        <g\n          className=\"x\"\n          css={axisStyles}\n          transform={`translate(0,${height - margin.bottom})`}\n          ref={refAxis}\n        >\n          <text fill=\"#000\" x={width - 10} y=\"30\" dy=\"0.70em\" textAnchor=\"end\">\n            {label}\n          </text>\n        </g>\n      )}\n      {showGrid && (\n        <g\n          css={gridStyles}\n          className=\"grid\"\n          ref={refGrid}\n          transform={`translate(0,${height - margin.bottom})`}\n        />\n      )}\n    </>\n  );\n}\n\nexport default XAxis;\n","import { Jcoupling } from 'nmr-processing';\n\nimport { Range, Signal1D } from '../../types/data1d';\nimport generateID from '../../utilities/generateID';\n/**\n * Links object that use coupling as key and value is an array of objects {id:signal id ,x:signal delta,y:coupling}\n */\n\ninterface Coupling {\n  coupling: number;\n  delta: number;\n}\n\nexport interface CouplingLink {\n  id: string;\n  couplings: Coupling[];\n  from: number;\n  to: number;\n}\n\ninterface GenerateJGraphDataResult {\n  signals: Signal1D[];\n  jCouplingMax: number;\n  links: CouplingLink[];\n}\n\nexport default function generateJGraphData(\n  ranges: Range[],\n  jGraphTolerance: number,\n): GenerateJGraphDataResult | null {\n  if (!ranges && !Array.isArray(ranges)) return null;\n\n  let signals: Signal1D[] = [];\n  let jCouplingMax = 0;\n  let links: CouplingLink[] = createLinks(ranges, jGraphTolerance);\n  for (const range of ranges) {\n    for (const signal of range.signals) {\n      const { id: signalId, ...restSignal } = signal;\n\n      if (restSignal.js) {\n        signals.push({ id: `${range.id}${signalId}`, ...restSignal });\n        const tempMax = getJsCouplingMax(restSignal.js);\n        jCouplingMax = tempMax > jCouplingMax ? tempMax : jCouplingMax;\n      }\n    }\n  }\n\n  return { signals, jCouplingMax, links };\n}\n\nfunction getJsCouplingMax(js: Jcoupling[]): number {\n  let max = -Infinity;\n  for (const { coupling } of js) {\n    max = coupling > max ? coupling : max;\n  }\n  return max;\n}\n\nfunction getCouplings(ranges: Range[]): Coupling[] {\n  const couplings: Coupling[] = [];\n  for (let range of ranges) {\n    for (const { delta, js } of range.signals) {\n      for (const { coupling } of js || []) {\n        couplings.push({ coupling, delta });\n      }\n    }\n  }\n  return couplings;\n}\n\nfunction initLink(coupling: Coupling): CouplingLink {\n  const { delta } = coupling;\n  return {\n    id: generateID(),\n    from: delta,\n    to: delta,\n    couplings: [coupling],\n  };\n}\n\nfunction createLinks(ranges: Range[], jGraphTolerance = 0) {\n  const couplings = getCouplings(ranges).sort(\n    (a, b) => a.coupling - b.coupling,\n  );\n\n  if (!couplings || couplings.length === 0) return [];\n\n  const links: CouplingLink[] = [initLink(couplings[0])];\n\n  let index = 0;\n  let start = index;\n  let end = 1;\n\n  while (end < couplings.length) {\n    const nextCoupling = couplings[end];\n    if (\n      Math.abs(couplings[start].coupling - nextCoupling.coupling) <\n      jGraphTolerance\n    ) {\n      links[index].couplings.push(nextCoupling);\n\n      if (nextCoupling.delta > links[index].to) {\n        links[index].to = nextCoupling.delta;\n      } else if (nextCoupling.delta < links[index].from) {\n        links[index].from = nextCoupling.delta;\n      }\n\n      end++;\n    } else {\n      if (\n        Math.abs(couplings[end - 1].coupling - nextCoupling.coupling) <\n        jGraphTolerance\n      ) {\n        start = end - 1;\n      } else {\n        index++;\n        links[index] = initLink(couplings[end]);\n        start = end;\n        end = end + 1;\n      }\n    }\n  }\n\n  return links;\n}\n","import { ScaleLinear } from 'd3';\nimport { useContext, createContext } from 'react';\n\ninterface JGraphState {\n  scaleY: ScaleLinear<number, number, never> | null;\n  height: number;\n  maxValue: number;\n}\n\nconst JGraphContext = createContext<JGraphState>({\n  scaleY: null,\n  height: 0,\n  maxValue: 0,\n});\n\nexport const JGraphContextProvider = JGraphContext.Provider;\n\nexport function useJGraph() {\n  const jGraphState = useContext(JGraphContext);\n  if (!jGraphState.scaleY) {\n    throw new Error('scale cannot be null');\n  }\n\n  return jGraphState;\n}\n","import { ScaleLinear } from 'd3';\nimport { forwardRef, useRef, MutableRefObject } from 'react';\nimport { useLinearPrimaryTicks } from 'react-d3-utils';\n\ninterface BaseAxis {\n  x: number;\n  y: number;\n}\ninterface ScaleAxis {\n  scale: ScaleLinear<number, number>;\n}\n\ninterface Vertical {\n  height: number;\n  showGrid?: false;\n}\n\ninterface VerticalGrid {\n  height: number;\n  showGrid: true;\n  width: number;\n}\n\ninterface Ticks {\n  label: string;\n  position: number;\n}\n\ninterface TickAxis {\n  ticks: Ticks[];\n  // eslint-disable-next-line react/no-unused-prop-types\n  ref: MutableRefObject<SVGGElement | null>;\n}\n\ntype VerticalAxisProps = BaseAxis & (Vertical | VerticalGrid) & ScaleAxis;\ntype VerticalRenderProps = BaseAxis & (Vertical | VerticalGrid) & TickAxis;\n\nconst VerticalAxis = forwardRef<SVGGElement | null, VerticalRenderProps>(\n  (props, ref) => {\n    const { x, y, height, showGrid, ticks } = props;\n    return (\n      <g ref={ref} transform={`translate(${x}, ${y})`}>\n        <line y2={height} x1={15} x2={15} stroke=\"black\" />\n        {ticks.map(({ label, position }, index) => (\n          // eslint-disable-next-line react/no-array-index-key\n          <g key={index + label + position}>\n            {showGrid && props.width && (\n              <line\n                y1={position}\n                y2={position}\n                x1={15}\n                x2={props.width - x}\n                stroke=\"lightgray\"\n              />\n            )}\n            <line y1={position} y2={position} x1={15} x2={10} stroke=\"black\" />\n            <text y={position} dominantBaseline=\"middle\" textAnchor=\"end\">\n              {label}\n            </text>\n          </g>\n        ))}\n      </g>\n    );\n  },\n);\n\nexport function LinearVerticalAxis(props: VerticalAxisProps) {\n  const { scale, ...other } = props;\n  const ref = useRef<SVGGElement>(null);\n  const ticks = useLinearPrimaryTicks(scale, 'vertical', ref);\n  return <VerticalAxis {...other} ticks={ticks} ref={ref} />;\n}\n","import { useChartData } from '../../context/ChartContext';\nimport { LinearVerticalAxis } from '../../elements/linearAxis/LinearVerticalAxis';\n\nimport { useJGraph } from './JGraphContext';\n\nexport function JGraphVerticalAxis() {\n  const { width, margin } = useChartData();\n  const { height, scaleY } = useJGraph();\n\n  if (!scaleY) return null;\n\n  return (\n    <svg style={{ overflow: 'visible' }} height={height + 20} width={60}>\n      <LinearVerticalAxis\n        x={20}\n        y={0}\n        scale={scaleY}\n        height={height}\n        showGrid\n        width={width - margin.right}\n      />\n    </svg>\n  );\n}\n","import { useCallback } from 'react';\n\nimport { CouplingLink } from '../../../data/data1d/Spectrum1D/generateJGraphData';\nimport { useScaleChecked } from '../../context/ScaleContext';\n\nimport { useJGraph } from './JGraphContext';\n\ninterface JsCouplingLinksProps {\n  links: CouplingLink[];\n}\n\nexport default function JsCouplingLinks(props: JsCouplingLinksProps) {\n  const { links } = props;\n  const { scaleX } = useScaleChecked();\n  const { scaleY, maxValue } = useJGraph();\n  const generatePath = useCallback(\n    (link: CouplingLink): string => {\n      if (!scaleY) return '';\n\n      const { from, to, couplings } = link;\n      let paths: string[] = [];\n      for (const coupling of couplings) {\n        paths.push(\n          `M${scaleX()(from)},${scaleY(coupling.coupling)} L${scaleX()(\n            to,\n          )},${scaleY(coupling.coupling)}`,\n        );\n      }\n      return paths.join(' ');\n    },\n    [scaleX, scaleY],\n  );\n\n  return (\n    <g className=\"js-coupling-links\">\n      {links\n        .filter((link) => link.couplings.length > 1)\n        .map((link) => {\n          return (\n            <path\n              key={link.id}\n              d={generatePath(link)}\n              style={{\n                stroke: `hsl(${\n                  (link.couplings[0].coupling * 360) / maxValue\n                },100%,50%)`,\n              }}\n              strokeWidth=\"1\"\n            />\n          );\n        })}\n    </g>\n  );\n}\n","import { useState } from 'react';\n\nimport { useJGraph } from './JGraphContext';\n\ninterface JsCouplingProps {\n  value: number;\n}\n\nexport default function JsCoupling({ value }: JsCouplingProps) {\n  const { scaleY, maxValue } = useJGraph();\n  const [isOver, setOver] = useState<boolean>(false);\n\n  if (!scaleY) return null;\n\n  return (\n    <g\n      className=\"coupling\"\n      style={{ transform: `translate(0px,${scaleY(value)}px)` }}\n    >\n      <circle\n        onMouseEnter={() => setOver(true)}\n        onMouseLeave={() => setOver(false)}\n        cx={0}\n        cy={0}\n        r={4}\n        fill={`hsl(${(value * 360) / maxValue},100%,${isOver ? 45 : 50}%)`}\n        pointerEvents=\"all\"\n      />\n      {isOver && (\n        <g style={{ transform: `translate(0px,15px)` }}>\n          <text\n            pointerEvents=\"none\"\n            stroke=\"white\"\n            strokeWidth=\"0.6em\"\n            fontSize=\"11px\"\n            dominantBaseline=\"middle\"\n            textAnchor=\"end\"\n          >{`${value.toFixed(1)} Hz`}</text>\n          <text\n            pointerEvents=\"none\"\n            stroke=\"black\"\n            fontSize=\"11px\"\n            dominantBaseline=\"middle\"\n            textAnchor=\"end\"\n          >{`${value.toFixed(1)} Hz`}</text>\n        </g>\n      )}\n    </g>\n  );\n}\n","import { Signal1D } from '../../../data/types/data1d';\nimport { useScaleChecked } from '../../context/ScaleContext';\n\nimport { useJGraph } from './JGraphContext';\nimport JsCoupling from './JsCoupling';\n\ninterface JsCouplingsProps {\n  signals: Signal1D[];\n}\n\nexport default function JsCouplings(props: JsCouplingsProps) {\n  const { scaleX } = useScaleChecked();\n  const { height } = useJGraph();\n\n  return (\n    <g className=\"js-coupling\">\n      {props.signals.map((signal) => {\n        return (\n          <g\n            key={signal.id}\n            transform={`translate(${scaleX()(signal.delta)},0)`}\n          >\n            <line\n              x1=\"0\"\n              y1={height}\n              x2=\"0\"\n              y2=\"0\"\n              stroke=\"black\"\n              strokeWidth=\"1\"\n            />\n            {signal.js?.map((j) => {\n              return <JsCoupling key={`${j.coupling}`} value={j.coupling} />;\n            })}\n          </g>\n        );\n      })}\n    </g>\n  );\n}\n","import { scaleLinear } from 'd3';\nimport lodashGet from 'lodash/get';\nimport { memo, useMemo } from 'react';\n\nimport generateJGraphData, {\n  CouplingLink,\n} from '../../../data/data1d/Spectrum1D/generateJGraphData';\nimport { Signal1D } from '../../../data/types/data1d';\nimport { Datum1D } from '../../../data/types/data1d/Datum1D';\nimport { useChartData } from '../../context/ChartContext';\nimport { usePreferences } from '../../context/PreferencesContext';\nimport useSpectrum from '../../hooks/useSpectrum';\nimport { getRangeDefaultValues } from '../../panels/extra/preferences/defaultValues';\n\nimport { JGraphContextProvider } from './JGraphContext';\nimport { JGraphVerticalAxis } from './JGraphVerticalAxis';\nimport JCouplingLinks from './JsCouplingLinks';\nimport JsCouplings from './JsCouplings';\n\nconst marginTop = 50;\n\ninterface innerJGraphProps {\n  signals: Signal1D[];\n  links: CouplingLink[];\n}\n\nfunction InnerJGraph(props: innerJGraphProps) {\n  const { signals, links } = props;\n  return (\n    <g className=\"j-graph\" transform={`translate(0,${marginTop})`}>\n      <JGraphVerticalAxis />\n      <JCouplingLinks links={links} />\n      <JsCouplings signals={signals} />\n    </g>\n  );\n}\n\nconst emptyData = { ranges: {} };\nconst MemoizedJGraph = memo(InnerJGraph);\n\nexport default function JGraph() {\n  const preferences = usePreferences();\n\n  const {\n    height,\n    toolOptions: {\n      data: { showJGraph },\n    },\n    activeTab,\n  } = useChartData();\n\n  const graphHeight = height / 4;\n\n  const { ranges } = useSpectrum(emptyData) as Datum1D;\n\n  const jGraphTolerance = useMemo(() => {\n    const _preferences =\n      lodashGet(\n        preferences.current,\n        `formatting.panels.ranges.[${activeTab}]`,\n      ) || getRangeDefaultValues(activeTab);\n\n    return _preferences.jGraphTolerance;\n  }, [activeTab, preferences]);\n\n  const {\n    signals,\n    jCouplingMax: maxValue,\n    links,\n  } = useMemo(\n    () =>\n      generateJGraphData(ranges.values, jGraphTolerance) || {\n        signals: [],\n        jCouplingMax: 0,\n        links: [],\n      },\n    [jGraphTolerance, ranges.values],\n  );\n\n  const scaleY = useMemo(() => {\n    const maxRange = maxValue + maxValue * 0.1;\n    return scaleLinear().range([graphHeight, 0]).domain([0, maxRange]);\n  }, [graphHeight, maxValue]);\n\n  const JGraphState = useMemo(() => {\n    return { scaleY, height: graphHeight, maxValue };\n  }, [graphHeight, scaleY, maxValue]);\n\n  if (!showJGraph) return null;\n\n  return (\n    <JGraphContextProvider value={JGraphState}>\n      <MemoizedJGraph signals={signals} links={links} />\n    </JGraphContextProvider>\n  );\n}\n","interface DeleteButtonProps {\n  onDelete?: () => void;\n  fill?: string;\n  x: string | number;\n  y: string | number;\n}\n\nfunction DeleteButton(props: DeleteButtonProps) {\n  const {\n    x = 'initial',\n    y = 'initial',\n    onDelete = () => null,\n    fill = '#c81121',\n  } = props;\n\n  return (\n    <svg\n      className=\"delete-button\"\n      x={x}\n      y={y}\n      onClick={onDelete}\n      data-no-export=\"true\"\n    >\n      <rect rx=\"5\" width=\"16\" height=\"16\" fill={fill} />\n      <line x1=\"5\" x2=\"10\" y1=\"8\" y2=\"8\" stroke=\"white\" strokeWidth=\"2\" />\n    </svg>\n  );\n}\n\nexport default DeleteButton;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback } from 'react';\n\nimport { useDispatch } from '../../context/DispatchContext';\nimport { useGlobal } from '../../context/GlobalContext';\nimport { useScaleChecked } from '../../context/ScaleContext';\nimport DeleteButton from '../../elements/DeleteButton';\nimport Resizer from '../../elements/resizer/Resizer';\nimport { useHighlight } from '../../highlight';\nimport {\n  DELETE_ANALYZE_SPECTRA_RANGE,\n  RESIZE_ANALYZE_SPECTRA_RANGE,\n} from '../../reducer/types/Types';\n\nconst styles = {\n  common: css`\n    pointer-events: bounding-box;\n\n    @-moz-document url-prefix() {\n      pointer-events: fill;\n    }\n  `,\n  hover: css`\n    .delete-button {\n      visibility: hidden;\n    }\n  `,\n  Highlighted: css`\n    .range-area {\n      height: 100%;\n      fill: #ff6f0057;\n    }\n    .delete-button {\n      visibility: visible;\n      cursor: pointer;\n    }\n  `,\n};\n\ninterface AnalysisRangeProps {\n  columnKey: string;\n  rangeData: {\n    from: number;\n    to: number;\n  };\n}\n\nfunction AnalysisRange({ rangeData, columnKey }: AnalysisRangeProps) {\n  const highlight = useHighlight([columnKey]);\n  const { scaleX } = useScaleChecked();\n  const dispatch = useDispatch();\n  const { viewerRef } = useGlobal();\n  const deleteHandler = useCallback(() => {\n    dispatch({ type: DELETE_ANALYZE_SPECTRA_RANGE, colKey: columnKey });\n  }, [columnKey, dispatch]);\n\n  const resizeEndHandler = useCallback(\n    (resized) => {\n      dispatch({\n        type: RESIZE_ANALYZE_SPECTRA_RANGE,\n        payload: { ...rangeData, ...resized, columnKey },\n      });\n    },\n    [columnKey, dispatch, rangeData],\n  );\n\n  const from = scaleX()(rangeData.from);\n  const to = scaleX()(rangeData.to);\n\n  return (\n    <g {...highlight.onHover}>\n      <Resizer\n        tag=\"svg\"\n        onEnd={resizeEndHandler}\n        initialPosition={{ x2: from, x1: to }}\n        parentElement={viewerRef}\n        key={`${columnKey}_${to}_${from}`}\n      >\n        {({ x1, x2 }, isActive) => (\n          <>\n            <g\n              transform={`translate(0,25)`}\n              css={[\n                styles.common,\n                highlight.isActive || isActive\n                  ? styles.Highlighted\n                  : styles.hover,\n              ]}\n            >\n              <rect\n                x=\"0\"\n                width={x2 - x1}\n                height=\"6\"\n                className=\"range-area\"\n                fill=\"green\"\n              />\n              <text\n                textAnchor=\"middle\"\n                x={(x2 - x1) / 2}\n                y=\"-5\"\n                fontSize=\"12\"\n                fill=\"red\"\n                fontWeight=\"bolder\"\n                fillOpacity={highlight.isActive ? 1 : 0.6}\n              >\n                {columnKey}\n              </text>\n            </g>\n            <DeleteButton x={-20} y={10} onDelete={deleteHandler} />\n          </>\n        )}\n      </Resizer>\n    </g>\n  );\n}\n\nexport default AnalysisRange;\n","import { memo, useMemo } from 'react';\n\nimport { SpectraAnalysis } from '../../../data/data1d/MultipleAnalysis';\nimport { useChartData } from '../../context/ChartContext';\n\nimport AnalysisRange from './AnalysisRange';\n\ninterface MultiAnalysisRangesInnerProps {\n  activeTab: string;\n  displayerKey: string;\n  spectraAnalysis: SpectraAnalysis;\n}\n\nfunction MultiAnalysisRangesInner({\n  activeTab,\n  spectraAnalysis,\n  displayerKey,\n}: MultiAnalysisRangesInnerProps) {\n  const columns = useMemo(() => {\n    const {\n      options: { columns },\n    } = spectraAnalysis[activeTab] || {\n      options: { columns: {} },\n    };\n    return columns;\n  }, [activeTab, spectraAnalysis]);\n\n  const ranges = useMemo(() => {\n    return Object.keys(columns).map((key) => key, []);\n  }, [columns]);\n\n  if (!ranges || ranges.length === 0) {\n    return null;\n  }\n\n  return (\n    <g clipPath={`url(#${displayerKey}clip-chart-1d)`}>\n      {ranges.map((columnKey) => (\n        <AnalysisRange\n          key={columnKey}\n          columnKey={columnKey}\n          rangeData={columns[columnKey]}\n        />\n      ))}\n    </g>\n  );\n}\n\nconst MemoizedMultiAnalysisRanges = memo(MultiAnalysisRangesInner);\n\nexport default function MultiAnalysisRanges() {\n  const { activeTab, spectraAnalysis, displayerKey } = useChartData();\n\n  return (\n    <MemoizedMultiAnalysisRanges\n      {...{ activeTab, spectraAnalysis, displayerKey }}\n    />\n  );\n}\n","export interface MultipletDefinition {\n  label: string;\n  value: string;\n  multiplicity: number | null;\n}\n\nexport const Multiplets: MultipletDefinition[] = [\n  { label: 'massive (m)', value: 'm', multiplicity: null },\n  { label: 'singlet (s)', value: 's', multiplicity: 1 },\n  { label: 'doublet (d)', value: 'd', multiplicity: 2 },\n  { label: 'triplet (t)', value: 't', multiplicity: 3 },\n  { label: 'quartet (q)', value: 'q', multiplicity: 4 },\n  { label: 'quintet (i)', value: 'i', multiplicity: 5 },\n  { label: 'sextet (x)', value: 'x', multiplicity: 6 },\n  { label: 'septet (p)', value: 'p', multiplicity: 7 },\n  { label: 'octet (o)', value: 'o', multiplicity: 8 },\n  { label: 'nonet (n)', value: 'n', multiplicity: 9 },\n];\n","import { Multiplets } from '../../../../data/constants/Multiplets';\n\nfunction getMultiplicityNumber(string) {\n  const multiplet = Multiplets.find(\n    (_multiplet) => string === _multiplet.label || string === _multiplet.value,\n  );\n\n  return multiplet ? multiplet.multiplicity : null;\n}\n\nfunction checkMultiplet(multiplet, rejected: Array<any> = []) {\n  // options to determine whether a massive (m), for example, should be considered as rejected multiplet\n  if (multiplet === undefined || multiplet.length === 0) {\n    return false;\n  }\n  const _multiplet = Multiplets.find(\n    (m) => m.value === multiplet || m.label === multiplet,\n  );\n  return (\n    _multiplet &&\n    !rejected.includes(_multiplet.value) &&\n    !rejected.includes(_multiplet.label)\n  );\n}\n\nfunction checkMultiplicity(multiplicity, rejected: Array<string> = []) {\n  // options to determine whether a massive (m), for example, should be considered as rejected multiplicity\n  if (multiplicity === undefined || multiplicity.length === 0) {\n    return false;\n  }\n  return !multiplicity\n    .split('')\n    .find((_multiplet) => !checkMultiplet(_multiplet, rejected));\n}\n\nfunction translateMultiplet(multiplet) {\n  return multiplet.length === 1\n    ? Multiplets.find((_multiplet) => _multiplet.value === multiplet)?.label\n    : Multiplets.find((_multiplet) => _multiplet.label === multiplet)?.value;\n}\n\nfunction hasCouplingConstant(multiplet) {\n  if (multiplet.length > 1) {\n    multiplet = translateMultiplet(multiplet);\n  }\n  // with the pre-set rejected ones, we check the given multiplicity for the need of having a coupling constant (massive and singlet do not)\n  return checkMultiplicity(multiplet, ['m', 's']);\n}\n\nfunction getPascal(n, spin) {\n  if (n === undefined || n === 0 || spin === undefined) return [1];\n  let mult = 2 * spin + 1;\n  let previousLine: Array<any> = [];\n  for (let j = 0; j < mult - 1; j++) previousLine.push(1);\n  // complete with \"1 1\" or \"1 1 1\" for spin 1/2 and 1 respectively\n  for (let i = 0; i < n - 1; i++) {\n    // copy the line\n    let _line = previousLine.slice();\n    for (let j = 1; j < mult; j++) {\n      for (let k = 0; k < previousLine.length - 1; k++) {\n        _line[k + j] += previousLine[k];\n      } // add the previous line\n      _line.push(1); // complete the line\n    }\n    previousLine = _line.slice();\n  }\n  return previousLine;\n}\n\nexport {\n  checkMultiplet,\n  checkMultiplicity,\n  getMultiplicityNumber,\n  getPascal,\n  hasCouplingConstant,\n  translateMultiplet,\n};\n","export const TREE_LEVEL_COLORS: Array<string> = [\n  'red',\n  'green',\n  'blue',\n  'magenta',\n];\n","import { Signal1D } from '../../../data/types/data1d';\nimport { useScaleChecked } from '../../context/ScaleContext';\n\nimport { TREE_LEVEL_COLORS } from './TreeColors';\n\ninterface LevelNodeProps {\n  signal: Signal1D;\n  startY: number;\n  levelHeight: number;\n}\n\nfunction LevelNode({ signal, startY, levelHeight }: LevelNodeProps) {\n  const { scaleX } = useScaleChecked();\n\n  return (\n    <line\n      key={`startLevelNode_${signal.id}`}\n      x1={scaleX()(signal.delta)}\n      y1={startY}\n      x2={scaleX()(signal.delta)}\n      y2={startY + levelHeight}\n      stroke={TREE_LEVEL_COLORS[0]}\n    />\n  );\n}\n\nexport default LevelNode;\n","/* eslint-disable import/order */\nimport { CSSProperties } from 'react';\n\nimport { useScaleChecked } from '../../context/ScaleContext';\nimport { Signal1D } from '../../../data/types/data1d/Signal1D';\n\ninterface StringNodeProps {\n  signal: Signal1D;\n  startY: number;\n  levelHeight: number;\n  fontSize: CSSProperties['fontSize'];\n  showLabels: boolean;\n}\n\nfunction StringNode({\n  signal,\n  startY,\n  levelHeight,\n  fontSize,\n  showLabels,\n}: StringNodeProps) {\n  const { scaleX } = useScaleChecked();\n  return (\n    <text\n      key={`multiplicityString_${signal.id}`}\n      textAnchor=\"middle\"\n      x={scaleX()(signal.delta)}\n      y={startY + levelHeight / 2}\n      fontSize={fontSize}\n      lengthAdjust=\"spacing\"\n      fill=\"black\"\n      visibility={showLabels ? 'visible' : 'hidden'}\n    >\n      {signal.multiplicity}\n    </text>\n  );\n}\n\nexport default StringNode;\n","/* eslint-disable react/no-unused-prop-types */\nimport { CSSProperties, useCallback } from 'react';\n\nimport { useScaleChecked } from '../../context/ScaleContext';\n\ninterface NodeData {\n  startX: number;\n  _startX: number;\n  ratio: number;\n  multiplicityIndex: number;\n  color: string;\n}\n\ninterface TreeNodesProps {\n  showLabels: boolean;\n  startY: number;\n  signalID: string;\n  levelHeight: number;\n  nodesData: Array<NodeData>;\n  labelOptions: {\n    distance: number;\n    fontSize: CSSProperties['fontSize'];\n  };\n}\n\nfunction TreeNodes({\n  nodesData,\n  levelHeight,\n  startY,\n  signalID,\n  labelOptions,\n  showLabels,\n}: TreeNodesProps) {\n  const { scaleX } = useScaleChecked();\n  const buildTreeNodeAndEdge = useCallback(\n    ({ startX, _startX, ratio, multiplicityIndex, color }: NodeData) => {\n      const edgeLevel = 2 * multiplicityIndex + 2;\n      const _startYEdge = startY + edgeLevel * levelHeight;\n      const _startYNode = startY + (edgeLevel + 1) * levelHeight;\n\n      return (\n        <g\n          key={`${multiplicityIndex}_${signalID}_${startX}_${_startX}_${ratio}`}\n        >\n          {/* ratio text */}\n          <text\n            textAnchor=\"middle\"\n            x={scaleX()(_startX) + labelOptions.distance}\n            y={_startYNode + 2 * (levelHeight / 3)}\n            fontSize={labelOptions.fontSize}\n            fill={color}\n            visibility={showLabels ? 'visible' : 'hidden'}\n          >\n            {ratio}\n          </text>\n\n          <line\n            x1={scaleX()(startX)}\n            y1={_startYEdge}\n            x2={scaleX()(_startX)}\n            y2={_startYNode}\n            stroke={color}\n          />\n\n          <line\n            x1={scaleX()(_startX)}\n            y1={_startYNode}\n            x2={scaleX()(_startX)}\n            y2={_startYNode + levelHeight}\n            stroke={color}\n          />\n        </g>\n      );\n    },\n    [\n      signalID,\n      labelOptions.distance,\n      labelOptions.fontSize,\n      scaleX,\n      showLabels,\n      startY,\n      levelHeight,\n    ],\n  );\n\n  return <>{nodesData?.map((node) => buildTreeNodeAndEdge(node))}</>;\n}\n\nexport default TreeNodes;\n","import lodashGet from 'lodash/get';\n\nimport { Signal1D } from '../../../data/types/data1d';\nimport {\n  getMultiplicityNumber,\n  getPascal,\n} from '../../panels/extra/utilities/MultiplicityUtilities';\n\nimport { TREE_LEVEL_COLORS } from './TreeColors';\n\nfunction createTreeNodes(signal: Signal1D, spectrumData) {\n  function buildTreeNodesData(\n    multiplicityIndex,\n    jIndices,\n    treeNodesData,\n    startX,\n  ) {\n    if (!signal.multiplicity) {\n      return null;\n    }\n\n    if (multiplicityIndex >= signal.multiplicity.length) {\n      return treeNodesData;\n    }\n    // re-use colors if needed\n    const color =\n      TREE_LEVEL_COLORS[multiplicityIndex % TREE_LEVEL_COLORS.length];\n\n    const jIndex = jIndices.findIndex(\n      (_jIndex) => _jIndex === multiplicityIndex,\n    );\n    const frequency = lodashGet(spectrumData, 'info.originFrequency', 0);\n\n    const coupling =\n      jIndex >= 0 && frequency > 0 && signal?.js?.[jIndex]\n        ? signal.js[jIndex].coupling / frequency // convert to ppm\n        : null;\n\n    // in case of \"s\": no coupling constant and build one tree node only\n    if (!coupling) {\n      treeNodesData.push({\n        startX,\n        _startX: startX,\n        ratio: 1,\n        multiplicityIndex,\n        color,\n      });\n      // go to next multiplet in multiplicity string\n      buildTreeNodesData(\n        multiplicityIndex + 1,\n        jIndices,\n        treeNodesData,\n        startX,\n      );\n    } else {\n      // in case of other multiplets\n      const multiplicity = signal.multiplicity || '';\n      const pascal = getPascal(\n        getMultiplicityNumber(multiplicity.charAt(multiplicityIndex)),\n        0.5,\n      ); // @TODO for now we use the default spin of 1 / 2 only\n\n      let _startX =\n        pascal.length % 2 === 0\n          ? startX - (pascal.length / 2) * coupling + coupling / 2 // in case of even number of nodes\n          : startX - (pascal.length / 2 - 0.5) * coupling; // in case of odd number of nodes\n\n      pascal.forEach((ratio, k) => {\n        if (k > 0) {\n          _startX += coupling;\n        }\n        treeNodesData.push({\n          startX,\n          _startX,\n          ratio,\n          multiplicityIndex,\n          color,\n        });\n        // go to next multiplet in multiplicity string\n        buildTreeNodesData(\n          multiplicityIndex + 1,\n          jIndices,\n          treeNodesData,\n          _startX,\n        );\n      });\n    }\n\n    return treeNodesData;\n  }\n  return buildTreeNodesData;\n}\n\nexport default createTreeNodes;\n","/** @jsxImportSource @emotion/react */\nimport lodashGet from 'lodash/get';\nimport { useMemo, useState, useEffect, CSSProperties } from 'react';\n\nimport { Signal1D } from '../../../data/types/data1d';\nimport { useAssignment } from '../../assignment/AssignmentsContext';\nimport { useChartData } from '../../context/ChartContext';\nimport { useScaleChecked } from '../../context/ScaleContext';\nimport { HighlightedSource, useHighlight } from '../../highlight';\nimport {\n  hasCouplingConstant,\n  checkMultiplicity,\n} from '../../panels/extra/utilities/MultiplicityUtilities';\nimport { options } from '../../toolbar/ToolTypes';\n\nimport LevelNode from './LevelNode';\nimport StringNode from './StringNode';\nimport TreeNodes from './TreeNodes';\nimport createTreeNodes from './buildTreeNode';\n\nconst styles = {\n  cursor: 'default',\n  opacity: 0.6,\n  strokeWidth: 1,\n};\n\n// export interface SignalNodeProps {\n//   id: string;\n//   delta: number;\n//   multiplicity: string;\n// }\n\ninterface MultiplicityTreeProps {\n  rangeFrom: number;\n  rangeTo: number;\n  signal: Signal1D;\n  labelOptions?: {\n    distance: number;\n    fontSize: CSSProperties['fontSize'];\n  };\n}\n\nfunction extractID(assignment) {\n  return [assignment.id].concat(assignment.assigned?.x || []);\n}\n\nfunction MultiplicityTree({\n  rangeFrom,\n  rangeTo,\n  signal,\n  labelOptions = {\n    distance: 10,\n    fontSize: 11,\n  },\n}: MultiplicityTreeProps) {\n  const { scaleX, scaleY } = useScaleChecked();\n  const {\n    data: spectraData,\n    activeSpectrum,\n    toolOptions: { selectedTool },\n    width,\n  } = useChartData();\n  const assignment = useAssignment(signal.id);\n  const highlight = useHighlight(extractID(assignment), {\n    type: HighlightedSource.SIGNAL,\n    extra: extractID(assignment),\n  });\n\n  const spectrumData = useMemo(\n    () =>\n      // eslint-disable-next-line @typescript-eslint/restrict-template-expressions\n      lodashGet(spectraData, `${activeSpectrum?.index}`, null),\n    [activeSpectrum, spectraData],\n  );\n\n  const [xRange, setXRange] = useState({ x1: signal.delta, x2: signal.delta });\n  const [treeProps, setTreeProps] = useState({\n    width: 0,\n    height: 0,\n    levelHeight: 0,\n  });\n  const [drawInFullRange, setDrawInFullRange] = useState(false);\n  const [showLabels, setShowLabels] = useState(false);\n\n  useEffect(() => {\n    const _drawInFullRange = !checkMultiplicity(signal.multiplicity, ['m']);\n    const _treeWidth = _drawInFullRange\n      ? Math.abs(scaleX()(xRange.x1) - scaleX()(xRange.x2))\n      : Math.abs(scaleX()(xRange.x1) - scaleX()(xRange.x2)) +\n        labelOptions.distance;\n    const _treeHeight = _drawInFullRange ? _treeWidth / 3 : _treeWidth / 2;\n    // +2 because of multiplicity text and start level node before the actual tree starts\n    // 2* for levels between nodes (edges)\n    const length = signal?.multiplicity?.length || 0;\n    const _treeLevelHeight = _drawInFullRange\n      ? _treeHeight / (length + 2)\n      : _treeHeight / (2 * length + 2);\n\n    setTreeProps({\n      width: _treeWidth,\n      height: _treeHeight,\n      levelHeight: _treeLevelHeight,\n    });\n    setDrawInFullRange(_drawInFullRange);\n  }, [\n    labelOptions.distance,\n    scaleX,\n    signal.multiplicity,\n    xRange.x1,\n    xRange.x2,\n  ]);\n\n  useEffect(() => {\n    if (treeProps.width / width >= 0.1) {\n      setShowLabels(true);\n    } else {\n      setShowLabels(false);\n    }\n  }, [treeProps.width, width]);\n\n  const startY = useMemo(() => {\n    let yMax;\n    spectrumData.data.x.forEach((_x, i) => {\n      if (\n        _x >= rangeFrom &&\n        _x <= rangeTo &&\n        (!yMax || spectrumData.data.re[i] > yMax)\n      ) {\n        yMax = spectrumData.data.re[i];\n      }\n    });\n\n    return scaleY(spectrumData.id)(yMax) - treeProps.height - 30;\n  }, [\n    spectrumData.data.x,\n    spectrumData.data.re,\n    spectrumData.id,\n    scaleY,\n    treeProps.height,\n    rangeFrom,\n    rangeTo,\n  ]);\n\n  const treeNodesData = useMemo(() => {\n    if (signal.multiplicity) {\n      const buildTreeNodesData = createTreeNodes(signal, spectrumData);\n      const jIndices = signal.multiplicity\n        .split('')\n        .map((_mult, i) => (hasCouplingConstant(_mult) ? i : undefined))\n        .filter((_i) => _i !== undefined);\n\n      return buildTreeNodesData(0, jIndices, [], signal.delta);\n    }\n    return [];\n  }, [signal, spectrumData]);\n\n  useEffect(() => {\n    if (drawInFullRange) {\n      setXRange({ x1: rangeFrom, x2: rangeTo });\n    } else {\n      const _xRange = { x1: signal.delta, x2: signal.delta };\n      treeNodesData.forEach((_treeNodeData) => {\n        if (_treeNodeData.startX < _xRange.x1) {\n          _xRange.x1 = _treeNodeData.startX;\n        }\n        if (_treeNodeData.startX > _xRange.x2) {\n          _xRange.x2 = _treeNodeData.startX;\n        }\n        if (_treeNodeData._startX < _xRange.x1) {\n          _xRange.x1 = _treeNodeData._startX;\n        }\n        if (_treeNodeData._startX > _xRange.x2) {\n          _xRange.x2 = _treeNodeData._startX;\n        }\n      });\n      setXRange(_xRange);\n    }\n  }, [\n    drawInFullRange,\n    rangeFrom,\n    rangeTo,\n    signal.delta,\n    signal.multiplicity,\n    treeNodesData,\n  ]);\n\n  const multiplicityTree = useMemo(() => {\n    const { levelHeight } = treeProps;\n    // first tree level\n    const firstLevelStartY = startY;\n    let _startY = firstLevelStartY;\n    // second tree level\n    const secondLevelStartY = startY + levelHeight;\n    _startY = secondLevelStartY;\n\n    // third tree level\n    _startY += levelHeight;\n\n    if (drawInFullRange) {\n      const _rangeFrom = scaleX()(rangeFrom);\n      const _rangeTo = scaleX()(rangeTo);\n\n      const pathData = `M ${_rangeFrom} ${\n        _startY + levelHeight\n      } ${_rangeFrom} ${_startY} ${scaleX()(\n        signal.delta,\n      )} ${_startY} ${_rangeTo} ${_startY} ${_rangeTo} ${\n        _startY + levelHeight\n      }`;\n\n      return (\n        <g>\n          <StringNode\n            signal={signal}\n            startY={firstLevelStartY}\n            levelHeight={levelHeight}\n            fontSize={labelOptions.fontSize}\n            showLabels={showLabels}\n          />\n          <LevelNode\n            signal={signal}\n            startY={secondLevelStartY}\n            levelHeight={levelHeight}\n          />\n          <path d={pathData} stroke=\"blue\" fill=\"none\" />\n        </g>\n      );\n    }\n\n    return (\n      <g>\n        <StringNode\n          signal={signal}\n          startY={firstLevelStartY}\n          levelHeight={levelHeight}\n          fontSize={labelOptions.fontSize}\n          showLabels={showLabels}\n        />\n        <LevelNode\n          signal={signal}\n          startY={secondLevelStartY}\n          levelHeight={levelHeight}\n        />\n        <TreeNodes\n          nodesData={treeNodesData}\n          signalID={treeNodesData}\n          showLabels={showLabels}\n          startY={startY}\n          labelOptions={labelOptions}\n          levelHeight={levelHeight}\n        />\n      </g>\n    );\n  }, [\n    treeProps,\n    startY,\n    drawInFullRange,\n    signal,\n    labelOptions,\n    showLabels,\n    treeNodesData,\n    scaleX,\n    rangeFrom,\n    rangeTo,\n  ]);\n\n  return (\n    <g\n      css={\n        highlight.isActive || assignment.isActive\n          ? { ...styles, opacity: 1, strokeWidth: 1.5 }\n          : styles\n      }\n      {...{\n        onMouseEnter: () => {\n          assignment.show('x');\n          highlight.show();\n        },\n        onMouseLeave: () => {\n          assignment.hide();\n          highlight.hide();\n        },\n      }}\n      {...{\n        onClick:\n          selectedTool && selectedTool === options.editRange.id\n            ? () => {\n                return null;\n              }\n            : (e) => {\n                if (e.shiftKey) {\n                  e.stopPropagation();\n                  assignment.setActive('x');\n                }\n              },\n      }}\n    >\n      {multiplicityTree}\n    </g>\n  );\n}\n\nexport default MultiplicityTree;\n","import { memo } from 'react';\n\nimport { useChartData } from '../../context/ChartContext';\n\nimport MultiplicityTree from './MultiplicityTree';\n\ninterface TempMultiplicityTreeInnerProps {\n  range: any;\n}\n\nfunction TempMultiplicityTreeInner({ range }: TempMultiplicityTreeInnerProps) {\n  return (\n    range?.signals &&\n    range.signals.length > 0 &&\n    range.signals.map((signal) => (\n      <MultiplicityTree\n        rangeFrom={range.from}\n        rangeTo={range.to}\n        signal={signal}\n        key={signal.id}\n      />\n    ))\n  );\n}\n\nconst MemoizedTempMultiplicityTree = memo(TempMultiplicityTreeInner);\n\nexport default function TempMultiplicityTree() {\n  const {\n    toolOptions: {\n      data: { tempRange },\n    },\n  } = useChartData();\n\n  return <MemoizedTempMultiplicityTree range={tempRange} />;\n}\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback, useState, useEffect } from 'react';\n\nimport { Signal1D } from '../../../data/types/data1d';\nimport { checkRangeKind } from '../../../data/utilities/RangeUtilities';\nimport {\n  useAssignment,\n  useAssignmentData,\n} from '../../assignment/AssignmentsContext';\nimport { filterForIDsWithAssignment } from '../../assignment/utilities/filterForIDsWithAssignment';\nimport { useDispatch } from '../../context/DispatchContext';\nimport { useGlobal } from '../../context/GlobalContext';\nimport { useScaleChecked } from '../../context/ScaleContext';\nimport Resizer from '../../elements/resizer/Resizer';\nimport { HighlightedSource, useHighlight } from '../../highlight';\nimport { RESIZE_RANGE } from '../../reducer/types/Types';\nimport { options } from '../../toolbar/ToolTypes';\nimport MultiplicityTree from '../multiplicityTree/MultiplicityTree';\nimport TempMultiplicityTree from '../multiplicityTree/TempMultiplicityTree';\n\nconst stylesOnHover = css`\n  pointer-events: bounding-box;\n  @-moz-document url-prefix() {\n    pointer-events: fill;\n  }\n  user-select: 'none';\n  -webkit-user-select: none; /* Chrome all / Safari all */\n  -moz-user-select: none; /* Firefox all */\n\n  .delete-button {\n    visibility: hidden;\n  }\n`;\n\nconst stylesHighlighted = css`\n  pointer-events: bounding-box;\n\n  @-moz-document url-prefix() {\n    pointer-events: fill;\n  }\n  .range-area {\n    height: 100%;\n    fill: #ff6f0057;\n  }\n  .delete-button {\n    visibility: visible;\n    cursor: pointer;\n  }\n`;\n\nexport interface RangeData {\n  id: string;\n  from: number;\n  to: number;\n  integration: number;\n  signals: Signal1D[];\n}\n\ninterface RangeProps {\n  showMultiplicityTrees: boolean;\n  selectedTool: string;\n  rangeData: RangeData;\n  startEditMode: boolean;\n}\n\nfunction Range({\n  rangeData,\n  showMultiplicityTrees,\n  selectedTool,\n  startEditMode,\n}: RangeProps) {\n  const { viewerRef } = useGlobal();\n  const { id, integration, signals } = rangeData;\n  const assignmentData = useAssignmentData();\n  const assignmentRange = useAssignment(id);\n  const highlightRange = useHighlight(\n    [assignmentRange.id].concat(assignmentRange.assigned?.x || []).concat(\n      filterForIDsWithAssignment(\n        assignmentData,\n        signals.map((_signal) => _signal.id),\n      ),\n    ),\n    { type: HighlightedSource.RANGE, extra: { id } },\n  );\n\n  const { scaleX } = useScaleChecked();\n  const dispatch = useDispatch();\n\n  const [reduceOpacity, setReduceOpacity] = useState(false);\n  const [isBlockedByEditing, setIsBlockedByEditing] = useState(false);\n\n  useEffect(() => {\n    if (selectedTool && selectedTool === options.editRange.id) {\n      setIsBlockedByEditing(true);\n    } else {\n      setIsBlockedByEditing(false);\n    }\n  }, [selectedTool]);\n\n  useEffect(() => {\n    setReduceOpacity(!checkRangeKind(rangeData));\n  }, [rangeData]);\n\n  const handleOnStopResizing = useCallback(\n    (position) => {\n      dispatch({\n        type: RESIZE_RANGE,\n        data: {\n          ...rangeData,\n          from: scaleX().invert(position.x2),\n          to: scaleX().invert(position.x1),\n        },\n      });\n    },\n    [dispatch, rangeData, scaleX],\n  );\n\n  const mouseEnterHandler = useCallback(() => {\n    assignmentRange.show('x');\n    highlightRange.show();\n  }, [assignmentRange, highlightRange]);\n\n  const mouseLeaveHandler = useCallback(() => {\n    assignmentRange.hide();\n    highlightRange.hide();\n  }, [assignmentRange, highlightRange]);\n\n  const assignHandler = useCallback(\n    (e) => {\n      if (\n        selectedTool === options.rangesPicking.id &&\n        e.shiftKey &&\n        !isBlockedByEditing\n      ) {\n        assignmentRange.setActive('x');\n      }\n    },\n    [assignmentRange, isBlockedByEditing, selectedTool],\n  );\n  const from = scaleX()(rangeData.from);\n  const to = scaleX()(rangeData.to);\n  return (\n    <g\n      data-test-id=\"range\"\n      style={{ outline: 'none' }}\n      key={id}\n      onMouseEnter={mouseEnterHandler}\n      onMouseLeave={mouseLeaveHandler}\n      onClick={assignHandler}\n    >\n      <Resizer\n        tag=\"svg\"\n        initialPosition={{ x1: to, x2: from }}\n        onEnd={handleOnStopResizing}\n        parentElement={viewerRef}\n        key={`${id}_${to}_${from}`}\n      >\n        {({ x1, x2 }, isActive) => (\n          <g\n            transform={`translate(0,10)`}\n            css={\n              isBlockedByEditing ||\n              highlightRange.isActive ||\n              assignmentRange.isActive ||\n              isActive\n                ? stylesHighlighted\n                : stylesOnHover\n            }\n          >\n            <rect\n              data-no-export=\"true\"\n              x=\"0\"\n              width={x2 - x1}\n              height=\"6\"\n              className=\"range-area\"\n              fill=\"green\"\n              fillOpacity={\n                !reduceOpacity ||\n                highlightRange.isActive ||\n                assignmentRange.isActive\n                  ? 1\n                  : 0.4\n              }\n            />\n            <text\n              textAnchor=\"middle\"\n              x={(x2 - x1) / 2}\n              y=\"20\"\n              fontSize=\"10\"\n              fill=\"red\"\n              fillOpacity={\n                !reduceOpacity ||\n                highlightRange.isActive ||\n                assignmentRange.isActive\n                  ? 1\n                  : 0.6\n              }\n            >\n              {integration !== undefined ? integration.toFixed(2) : ''}\n            </text>\n          </g>\n        )}\n      </Resizer>\n\n      {startEditMode ? (\n        <TempMultiplicityTree />\n      ) : (\n        showMultiplicityTrees &&\n        signals &&\n        signals.length > 0 &&\n        signals.map((_signal) => (\n          <MultiplicityTree\n            rangeFrom={from}\n            rangeTo={to}\n            signal={_signal}\n            key={_signal.id}\n          />\n        ))\n      )}\n    </g>\n  );\n}\n\nexport default Range;\n","import useIntegralPath from '../../hooks/useIntegralPath';\n\ninterface IntegralProps {\n  range: { id: string; from: number; to: number; integral?: number };\n}\n\nfunction RangeIntegral({ range }: IntegralProps) {\n  const path = useIntegralPath(range);\n\n  return (\n    <path\n      className=\"line\"\n      stroke=\"black\"\n      strokeWidth=\"1\"\n      fill=\"none\"\n      d={path}\n    />\n  );\n}\n\nexport default RangeIntegral;\n","import { Fragment, memo } from 'react';\n\nimport { Datum1D, Ranges as RangesProps } from '../../../data/types/data1d';\nimport { useChartData } from '../../context/ChartContext';\nimport useSpectrum from '../../hooks/useSpectrum';\n\nimport Range from './Range';\nimport RangeIntegral from './RangeIntegral';\n\ninterface RangesInnerProps {\n  displayerKey: string;\n  selectedTool: string;\n  ranges: RangesProps;\n  editRangeID: string;\n  showMultiplicityTrees: boolean;\n  showRangesIntegrals: boolean;\n}\n\nfunction RangesInner({\n  ranges,\n  displayerKey,\n  selectedTool,\n  editRangeID,\n  showMultiplicityTrees,\n  showRangesIntegrals,\n}: RangesInnerProps) {\n  return (\n    <g clipPath={`url(#${displayerKey}clip-chart-1d)`}>\n      {ranges?.values?.map((range) => (\n        <Fragment key={range.id}>\n          <Range\n            rangeData={range}\n            selectedTool={selectedTool}\n            showMultiplicityTrees={showMultiplicityTrees}\n            startEditMode={\n              editRangeID && editRangeID === range.id ? true : false\n            }\n          />\n          {showRangesIntegrals && <RangeIntegral range={range} />}\n        </Fragment>\n      ))}\n    </g>\n  );\n}\n\nconst MemoizedRanges = memo(RangesInner);\n\nconst empyData = { ranges: {} };\n\nexport default function Ranges() {\n  const {\n    displayerKey,\n    toolOptions: {\n      selectedTool,\n      data: { tempRange, showMultiplicityTrees, showRangesIntegrals },\n    },\n  } = useChartData();\n\n  const { ranges } = useSpectrum(empyData) as Datum1D;\n\n  return (\n    <MemoizedRanges\n      {...{\n        ranges,\n        showMultiplicityTrees,\n        showRangesIntegrals,\n        selectedTool,\n        displayerKey,\n        editRangeID: tempRange?.id || '',\n      }}\n    />\n  );\n}\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback, useMemo } from 'react';\n\nimport { useChartData } from '../../context/ChartContext';\nimport { useDispatch } from '../../context/DispatchContext';\nimport { useScaleChecked } from '../../context/ScaleContext';\nimport DeleteButton from '../../elements/DeleteButton';\nimport { DELETE_BASE_LINE_ZONE } from '../../reducer/types/Types';\n\nconst styles = css`\n  pointer-events: bounding-box;\n  user-select: 'none';\n  -webkit-user-select: none; /* Chrome all / Safari all */\n  -moz-user-select: none; /* Firefox all */\n\n  .zone-area {\n    height: 100%;\n    fill: #b8b8b857;\n    cursor: pointer;\n  }\n  .delete-button {\n    display: none;\n    cursor: pointer;\n  }\n  :hover .delete-button {\n    display: block;\n  }\n`;\n\nfunction BaseLineZones() {\n  const { toolOptions } = useChartData();\n\n  const { scaleX } = useScaleChecked();\n  const dispatch = useDispatch();\n\n  const deleteRangeHandler = useCallback(\n    (id) => {\n      dispatch({ type: DELETE_BASE_LINE_ZONE, id });\n    },\n    [dispatch],\n  );\n\n  const baseLineZones = useMemo(() => {\n    return toolOptions.data.baseLineZones;\n  }, [toolOptions]);\n\n  return (\n    <>\n      {baseLineZones.length > 0 && (\n        <g>\n          {baseLineZones.map((zone) => (\n            <g\n              key={zone.id}\n              transform={`translate(${scaleX()(zone.to)},0)`}\n              css={styles}\n            >\n              <DeleteButton\n                x={-20}\n                y={10}\n                onDelete={() => deleteRangeHandler(zone.id)}\n              />\n              <rect\n                x=\"0\"\n                width={`${scaleX()(zone.from) - scaleX()(zone.to)}`}\n                className=\"zone-area\"\n              />\n            </g>\n          ))}\n        </g>\n      )}\n    </>\n  );\n}\n\nexport default BaseLineZones;\n","import FloatMoleculeStructures from '../tool/FloatMoleculeStructures';\n\nimport ExclusionZonesAnnotations from './ExclusionZonesAnnotations';\nimport IntegralsSeries from './IntegralsSeries';\nimport LinesSeries from './LinesSeries';\nimport PeakAnnotations from './PeakAnnotations';\nimport ResurrectedDatabaseRanges from './ResurrectedDatabaseRanges';\nimport XAxis from './XAxis';\nimport JGraph from './jCouplingGraph/JGraph';\nimport MultiAnalysisRanges from './multiAnalysis/MultiAnalysisRanges';\nimport Ranges from './ranges/Ranges';\nimport BaseLineZones from './tool/BaseLineZones';\n\nfunction Chart1D({ mode, width, height, margin, displayerKey }) {\n  return (\n    <svg\n      viewBox={`0 0 ${width} ${height}`}\n      width={width}\n      height={height}\n      id=\"nmrSVG\"\n    >\n      <defs>\n        <clipPath id={`${displayerKey}clip-chart-1d`}>\n          <rect\n            width={`${width - margin.left - margin.right}`}\n            height={`${height}`}\n            x={`${margin.left}`}\n            y={`${0}`}\n          />\n        </clipPath>\n      </defs>\n\n      <LinesSeries />\n      <IntegralsSeries />\n      <PeakAnnotations />\n      <Ranges />\n      <JGraph />\n      <MultiAnalysisRanges />\n      <BaseLineZones />\n      <ExclusionZonesAnnotations />\n      <ResurrectedDatabaseRanges />\n\n      <g className=\"container\" style={{ pointerEvents: 'none' }}>\n        <XAxis showGrid mode={mode} />\n      </g>\n      <FloatMoleculeStructures />\n    </svg>\n  );\n}\n\nexport default Chart1D;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { xFindClosestIndex } from 'ml-spectra-processing';\nimport { useContext, useCallback, Fragment, memo } from 'react';\nimport { BsCursor } from 'react-icons/bs';\nimport { IoPulseSharp } from 'react-icons/io5';\n\nimport { get1DDataXY } from '../../data/data1d/Spectrum1D/get1DDataXY';\nimport { Datum1D } from '../../data/types/data1d';\nimport { BrushContext } from '../EventsTrackers/BrushTracker';\nimport { MouseContext } from '../EventsTrackers/MouseTracker';\nimport { useChartData } from '../context/ChartContext';\nimport { useScaleChecked } from '../context/ScaleContext';\nimport useSpectrum from '../hooks/useSpectrum';\nimport { ActiveSpectrum } from '../reducer/Reducer';\nimport { useFormatNumberByNucleus } from '../utility/FormatNumber';\n\nconst styles = css`\n  display: flex;\n  flex-firection: row;\n  align-items: center;\n  pointer-events: bounding-box;\n  user-select: 'none';\n  -webkit-user-select: none; /* Chrome all / Safari all */\n  -moz-user-select: none; /* Firefox all */\n  background-color: #f7f7f7;\n  height: 30px;\n  padding: 6px;\n  color: #8d0018;\n  position: absolute;\n  width: 100%;\n  bottom: 0;\n\n  div {\n    margin: 0px 10px;\n    display: inline-block;\n\n    .label {\n      font-size: 12px;\n      color: #4d4d4d;\n      font-weight: bold;\n    }\n    .value {\n      font-weight: bold;\n      font-size: 14px;\n      display: inline-block;\n    }\n    .unit {\n      font-weight: bold;\n      font-size: 10px;\n    }\n    .xvalue {\n      min-width: 50px;\n    }\n    .yvalue {\n      min-width: 80px;\n    }\n  }\n\n  .separator {\n    border-left: 2px solid gray;\n    margin: 0 20px;\n    width: 1px;\n    height: 100%;\n  }\n`;\n\ninterface FooterBannerInnerProps {\n  margin: {\n    top: number;\n    left: number;\n    right: number;\n    bottom: number;\n  };\n  width: number;\n  height: number;\n  activeSpectrum: ActiveSpectrum | null;\n  spectrum: Datum1D;\n  activeTab: string;\n}\n\nfunction FooterBannerInner({\n  margin,\n  width,\n  height,\n  activeSpectrum,\n  spectrum,\n  activeTab,\n}: FooterBannerInnerProps) {\n  let position = useContext(MouseContext);\n  const { startX, endX, step } = useContext(BrushContext);\n  const { scaleX } = useScaleChecked();\n\n  const format = useFormatNumberByNucleus(activeTab);\n\n  const getYValue = useCallback(\n    (xPosition) => {\n      if (spectrum) {\n        const data = get1DDataXY(spectrum);\n        const xIndex = xFindClosestIndex(data.x, scaleX().invert(xPosition));\n        return data.y[xIndex];\n      }\n      return 1;\n    },\n    [spectrum, scaleX],\n  );\n\n  if (\n    !position ||\n    position.y < margin.top ||\n    position.x < margin.left ||\n    position.x > width - margin.right ||\n    position.y > height - margin.bottom\n  ) {\n    return <div css={styles} />;\n  }\n\n  return (\n    <div css={styles}>\n      <BsCursor />\n      <div>\n        <span className=\"label\"> 𝛅: </span>\n        <span className=\"value\">{format(scaleX().invert(position.x))}</span>\n        <span className=\"unit\">ppm</span>\n        {activeSpectrum && spectrum?.info?.originFrequency && (\n          <>\n            <span className=\"value\">\n              &nbsp;(\n              {format(\n                scaleX().invert(position.x) * spectrum?.info?.originFrequency,\n                'hz',\n              )}\n            </span>\n            <span className=\"unit\">Hz</span>\n            <span className=\"value\">) </span>\n          </>\n        )}\n      </div>\n\n      {step === 'brushing' && (\n        <div>\n          <span className=\"label\"> Δppm: </span>\n          <span className=\"value\">\n            {(scaleX().invert(startX) - scaleX().invert(endX)).toPrecision(6)}\n          </span>\n        </div>\n      )}\n\n      {activeSpectrum && (\n        <Fragment>\n          {spectrum?.info?.originFrequency && step === 'brushing' && (\n            <div>\n              <span className=\"label\"> ΔHz: </span>\n              <span className=\"value\">\n                {(\n                  (scaleX().invert(startX) - scaleX().invert(endX)) *\n                  spectrum?.info?.originFrequency\n                ).toPrecision(5)}\n              </span>\n            </div>\n          )}\n          {step === 'brushing' && (\n            <div>\n              <span className=\"label\"> ratio :</span>\n              <span className=\"value\">\n                {(\n                  (getYValue(startX) / (getYValue(endX) || Number.MIN_VALUE)) *\n                  100\n                ).toFixed(2)}\n                %\n              </span>\n            </div>\n          )}\n        </Fragment>\n      )}\n\n      {activeSpectrum && (\n        <Fragment>\n          <div className=\"separator\" />\n          <IoPulseSharp />\n          <div>\n            <span className=\"label\">Intensity: </span>\n            <span className=\"value yvalue\">\n              {format(getYValue(position.x))}\n            </span>\n          </div>\n        </Fragment>\n      )}\n    </div>\n  );\n}\n\nconst MemoizedFooterBanner = memo(FooterBannerInner);\n\nexport default function FooterBanner() {\n  const { margin, width, height, activeSpectrum, activeTab } = useChartData();\n  const spectrum = useSpectrum(null) as Datum1D;\n  return (\n    <MemoizedFooterBanner\n      {...{ margin, width, height, activeSpectrum, spectrum, activeTab }}\n    />\n  );\n}\n","import { xFindClosestIndex } from 'ml-spectra-processing';\nimport { CSSProperties, useContext, useEffect, useMemo, useState } from 'react';\n\nimport { get1DDataXY } from '../../data/data1d/Spectrum1D/get1DDataXY';\nimport { Datum1D } from '../../data/types/data1d';\nimport { MouseContext } from '../EventsTrackers/MouseTracker';\nimport { useChartData } from '../context/ChartContext';\nimport { useScale } from '../context/ScaleContext';\nimport Events from '../utility/Events';\n\nconst styles: Record<\n  'container' | 'value' | 'colorIndicator' | 'name',\n  CSSProperties\n> = {\n  container: {\n    position: 'absolute',\n    left: '10px',\n    top: '10px',\n  },\n  value: {\n    width: '67px',\n    display: 'inline-block',\n    margin: '0 5px',\n    fontSize: '12px',\n  },\n  colorIndicator: {\n    width: '10px',\n    height: '1px',\n    borderBottom: `2px solid`,\n    display: 'inline-block',\n    marginBottom: '3px',\n  },\n  name: {\n    fontSize: '12px',\n  },\n};\n\ninterface YTrackerProps {\n  datum: {\n    x: Array<number>;\n    y: Array<number>;\n  };\n}\n\nfunction YTracker({ datum }: YTrackerProps) {\n  const { scaleX } = useScale();\n  const position = useContext(MouseContext);\n\n  if (!scaleX || !position) {\n    return null;\n  }\n\n  const xIndex = xFindClosestIndex(datum.x, scaleX().invert(position.x));\n\n  return <span style={styles.value}>{datum.y[xIndex]}</span>;\n}\n\nfunction SpectraTracker() {\n  const { data, activeTab, xDomains } = useChartData();\n  const [isVisible, ToggleVisibility] = useState(false);\n\n  useEffect(() => {\n    function handler(flag) {\n      ToggleVisibility(flag);\n    }\n\n    Events.on('showYSpectraTrackers', handler);\n\n    return () => {\n      Events.off('showYSpectraTrackers', handler);\n    };\n  }, []);\n\n  const trackers = useMemo(() => {\n    return (\n      isVisible &&\n      data.map(\n        (spectrum) =>\n          spectrum.display.isVisible &&\n          xDomains[spectrum.id] &&\n          spectrum.info.nucleus === activeTab && (\n            <div style={{ display: 'block' }} key={spectrum.id}>\n              <span\n                style={{\n                  ...styles.colorIndicator,\n                  borderColor: (spectrum as Datum1D).display.color,\n                }}\n              />\n              <YTracker datum={get1DDataXY(spectrum as Datum1D)} />\n              <span style={styles.value}>{spectrum.display.name}</span>\n            </div>\n          ),\n        [],\n      )\n    );\n  }, [activeTab, data, isVisible, xDomains]);\n\n  if (!isVisible) return null;\n\n  return <div style={styles.container}>{trackers}</div>;\n}\n\nexport default SpectraTracker;\n","import max from 'ml-array-max';\nimport { useContext, useEffect, useState } from 'react';\n\nimport { get1DDataXY } from '../../../data/data1d/Spectrum1D/get1DDataXY';\nimport { Datum1D } from '../../../data/types/data1d';\nimport { BrushContext } from '../../EventsTrackers/BrushTracker';\nimport { MouseContext } from '../../EventsTrackers/MouseTracker';\nimport { useChartData } from '../../context/ChartContext';\nimport { useScaleChecked } from '../../context/ScaleContext';\nimport { options } from '../../toolbar/ToolTypes';\nimport getVerticalShift from '../utilities/getVerticalShift';\n\nconst styles = {\n  radius: 10,\n  borderColor: '#1f1f1f',\n  strokeWidth: 1,\n  fillOpacity: 0,\n  SVGPadding: 1,\n};\n\ninterface PeakPosition {\n  x: number;\n  y: number;\n  xIndex: number;\n}\n\nfunction PeakPointer() {\n  const {\n    height,\n    width,\n    margin,\n    activeSpectrum,\n    data,\n    mode,\n    toolOptions: { selectedTool },\n    verticalAlign,\n  } = useChartData();\n  const { scaleX, scaleY } = useScaleChecked();\n\n  let position = useContext(MouseContext);\n  const brushState = useContext(BrushContext);\n  const [closePeakPosition, setPosition] = useState<PeakPosition | null>();\n\n  useEffect(() => {\n    const vShift = activeSpectrum\n      ? getVerticalShift(verticalAlign, {\n          index: activeSpectrum?.index || 1,\n          align: 'center',\n        })\n      : 0;\n\n    const getClosePeak = (xShift, mouseCoordinates) => {\n      if (\n        activeSpectrum &&\n        position &&\n        selectedTool === options.peakPicking.id\n      ) {\n        const range = [\n          scaleX().invert(mouseCoordinates.x - xShift),\n          scaleX().invert(mouseCoordinates.x + xShift),\n        ].sort((a, b) => {\n          return a - b;\n        });\n\n        //get the active sepectrum data by looking for it by id\n        const spectrum = data.find(\n          (d) => d.id === activeSpectrum.id,\n        ) as Datum1D;\n\n        if (!spectrum) throw new Error('Unreachable');\n        const datum = get1DDataXY(spectrum);\n        const maxIndex = datum.x.findIndex((number) => number >= range[1]) - 1;\n        const minIndex = datum.x.findIndex((number) => number >= range[0]);\n\n        const yDataRange = datum.y.slice(minIndex, maxIndex);\n        if (yDataRange && yDataRange.length > 0) {\n          const yValue = max(yDataRange);\n          const xIndex = yDataRange.findIndex((value) => value === yValue);\n          const xValue = datum.x[minIndex + xIndex];\n          return {\n            x: scaleX()(xValue),\n            y: scaleY(activeSpectrum.id)(yValue) - vShift,\n            xIndex: minIndex + xIndex,\n          };\n        }\n      }\n      return null;\n    };\n\n    const candidatePeakPosition = getClosePeak(10, position);\n    setPosition(candidatePeakPosition);\n  }, [\n    activeSpectrum,\n    data,\n    mode,\n    position,\n    scaleX,\n    scaleY,\n    selectedTool,\n    verticalAlign,\n  ]);\n\n  if (\n    selectedTool !== options.peakPicking.id ||\n    !closePeakPosition ||\n    !activeSpectrum ||\n    brushState.step === 'brushing' ||\n    !position ||\n    position.y < margin.top ||\n    position.left < margin.left ||\n    position.x > width - margin.right ||\n    position.y > height - margin.bottom\n  ) {\n    return null;\n  }\n\n  return (\n    <div\n      key=\"peakPointer\"\n      style={{\n        cursor: 'crosshair',\n        transform: `translate(${closePeakPosition.x}px, ${closePeakPosition.y}px)`,\n        transformOrigin: 'top left',\n        position: 'absolute',\n        top: -(styles.radius + styles.SVGPadding),\n        left: -(styles.radius + styles.SVGPadding),\n        pointerEvents: 'none',\n        overflow: 'visible',\n      }}\n    >\n      <svg\n        width={styles.radius * 2 + styles.SVGPadding * 2}\n        height={styles.radius * 2 + styles.SVGPadding * 2}\n      >\n        <circle\n          cx={styles.radius + styles.SVGPadding}\n          cy={styles.radius + styles.SVGPadding}\n          r={styles.radius}\n          stroke={styles.borderColor}\n          strokeWidth={styles.strokeWidth}\n          fillOpacity={styles.fillOpacity}\n        />\n        <line\n          x1={styles.radius + styles.SVGPadding}\n          y1={styles.SVGPadding}\n          x2={styles.radius + styles.SVGPadding}\n          y2={styles.radius * 2 + styles.SVGPadding}\n          stroke={styles.borderColor}\n          strokeWidth={styles.strokeWidth}\n        />\n        <line\n          x1={styles.SVGPadding}\n          y1={styles.radius + styles.SVGPadding}\n          x2={styles.radius * 2 + styles.SVGPadding}\n          y2={styles.radius + styles.SVGPadding}\n          stroke={styles.borderColor}\n          strokeWidth={styles.strokeWidth}\n        />\n      </svg>\n    </div>\n  );\n}\n\nexport default PeakPointer;\n","import { CSSProperties } from 'react';\n\nimport { useChartData } from '../../context/ChartContext';\nimport { useScaleChecked } from '../../context/ScaleContext';\nimport { options } from '../../toolbar/ToolTypes';\n\nconst styles: CSSProperties = {\n  transformOrigin: 'top left',\n  position: 'absolute',\n  top: '0px',\n  left: '0px',\n  width: 1,\n  backgroundColor: 'red',\n};\n\nfunction VerticalIndicator() {\n  const {\n    height,\n    toolOptions: {\n      selectedTool,\n      data: { pivot },\n    },\n  } = useChartData();\n  const { scaleX } = useScaleChecked();\n\n  if (options.phaseCorrection.id !== selectedTool) return null;\n  return (\n    <div\n      style={{\n        ...styles,\n        transform: `translate(${scaleX()(pivot.value)}px, 0px)`,\n        height: height,\n      }}\n    />\n  );\n}\n\nexport default VerticalIndicator;\n","import { useContext, useCallback, useMemo, CSSProperties } from 'react';\n\nimport { Datum1D } from '../../../data/types/data1d';\nimport { BrushContext } from '../../EventsTrackers/BrushTracker';\nimport { MouseContext } from '../../EventsTrackers/MouseTracker';\nimport { useChartData } from '../../context/ChartContext';\nimport { useScaleChecked } from '../../context/ScaleContext';\nimport { useFormatNumberByNucleus } from '../../utility/FormatNumber';\n\nconst style: CSSProperties = {\n  cursor: 'crosshair',\n  transformOrigin: 'bottom right',\n  position: 'absolute',\n  top: '-18px',\n  left: '-30px',\n  pointerEvents: 'none',\n  overflow: 'visible',\n  userSelect: 'none',\n};\n\nfunction XLabelPointer() {\n  const { height, width, margin, data, activeSpectrum } = useChartData();\n  const { scaleX } = useScaleChecked();\n\n  const position = useContext(MouseContext);\n  const brushState = useContext(BrushContext);\n  const activeSpectrumData = useMemo(() => {\n    const spectrumData = activeSpectrum\n      ? data.find((d) => d.id === activeSpectrum.id)\n      : null;\n    return spectrumData;\n  }, [activeSpectrum, data]);\n\n  const format = useFormatNumberByNucleus(\n    (activeSpectrumData as Datum1D)?.info.nucleus,\n  );\n\n  const getXValue = useCallback(\n    (xVal) => {\n      if (activeSpectrumData) {\n        const xInvert = scaleX().invert(xVal);\n        return format(xInvert);\n      }\n    },\n    [activeSpectrumData, format, scaleX],\n  );\n\n  if (\n    !activeSpectrum ||\n    brushState.step === 'brushing' ||\n    !position ||\n    position.y < margin.top ||\n    position.x < margin.left ||\n    position.x > width - margin.right ||\n    position.y > height - margin.bottom\n  ) {\n    return null;\n  }\n  return (\n    <div\n      key=\"xLabelPointer\"\n      style={{\n        ...style,\n        transform: `translate(${position.x}px, ${position.y}px)`,\n      }}\n    >\n      <span>{getXValue(position.x)}</span>\n    </div>\n  );\n}\n\nexport default XLabelPointer;\n","import { xGetFromToIndex } from 'ml-spectra-processing';\nimport { useCallback, useEffect, useReducer, ReactNode } from 'react';\nimport { ResponsiveChart } from 'react-d3-utils';\n\nimport { MAX_LENGTH } from '../../data/data1d/Spectrum1D/ranges/detectSignal';\nimport { Datum1D } from '../../data/types/data1d';\nimport { ViewerResponsiveWrapper } from '../2d/Viewer2D';\nimport { BrushTracker } from '../EventsTrackers/BrushTracker';\nimport { MouseTracker } from '../EventsTrackers/MouseTracker';\nimport { useChartData } from '../context/ChartContext';\nimport { useDispatch } from '../context/DispatchContext';\nimport { usePreferences } from '../context/PreferencesContext';\nimport { ScaleProvider } from '../context/ScaleContext';\nimport { useAlert } from '../elements/popup/Alert';\nimport { useModal } from '../elements/popup/Modal';\nimport Spinner from '../loader/Spinner';\nimport MultipletAnalysisModal from '../modal/MultipletAnalysisModal';\nimport { ZoomType } from '../reducer/helper/Zoom1DManager';\nimport getRange from '../reducer/helper/getRange';\nimport scaleReducer, {\n  scaleInitialState,\n  SET_SCALE,\n} from '../reducer/scaleReducer';\nimport {\n  ADD_INTEGRAL,\n  ADD_PEAKS,\n  ADD_BASE_LINE_ZONE,\n  BRUSH_END,\n  FULL_ZOOM_OUT,\n  SET_ZOOM,\n  ADD_PEAK,\n  SET_VERTICAL_INDICATOR_X_POSITION,\n  ADD_RANGE,\n  ANALYZE_SPECTRA,\n  ADD_EXCLUSION_ZONE,\n} from '../reducer/types/Types';\nimport BrushXY, { BRUSH_TYPE } from '../tool/BrushXY';\nimport CrossLinePointer from '../tool/CrossLinePointer';\nimport { options } from '../toolbar/ToolTypes';\nimport Events from '../utility/Events';\n\nimport Chart1D from './Chart1D';\nimport FooterBanner from './FooterBanner';\nimport SpectraTracker from './SpectraTracker';\nimport PeakPointer from './tool/PeakPointer';\nimport VerticalIndicator from './tool/VerticalIndicator';\nimport XLabelPointer from './tool/XLabelPointer';\n\ninterface Viewer1DProps {\n  emptyText?: ReactNode;\n}\n\nfunction Viewer1D({ emptyText = undefined }: Viewer1DProps) {\n  const {\n    current: {\n      display: { general },\n    },\n  } = usePreferences();\n  const state = useChartData();\n\n  const {\n    toolOptions: { selectedTool },\n    isLoading,\n    data,\n    mode,\n    width: widthProp,\n    height: heightProp,\n    margin,\n    activeSpectrum,\n    xDomain,\n    xDomains,\n    yDomain,\n    yDomains,\n    verticalAlign,\n    displayerKey,\n  } = state;\n\n  const dispatch = useDispatch();\n  const modal = useModal();\n  const alert = useAlert();\n\n  const [scaleState, dispatchScale] = useReducer(\n    scaleReducer,\n    scaleInitialState,\n  );\n\n  useEffect(() => {\n    if (xDomain.length > 0 && yDomain.length > 0 && widthProp && heightProp) {\n      dispatchScale({\n        type: SET_SCALE,\n        payload: {\n          yDomain,\n          yDomains,\n          xDomain,\n          xDomains,\n          margin,\n          height: heightProp,\n          width: widthProp,\n          verticalAlign,\n          mode,\n        },\n      });\n    }\n  }, [\n    heightProp,\n    margin,\n    mode,\n    verticalAlign,\n    widthProp,\n    xDomain,\n    xDomains,\n    yDomain,\n    yDomains,\n  ]);\n\n  const handelBrushEnd = useCallback(\n    (brushData) => {\n      const propagateEvent = () => {\n        if (!scaleState.scaleX || !scaleState.scaleY) return;\n\n        const { startX, endX } = brushData;\n        const startXPPM = scaleState.scaleX().invert(startX);\n        const endXPPM = scaleState.scaleX().invert(endX);\n        Events.emit('brushEnd', {\n          ...brushData,\n          range: [startXPPM, endXPPM].sort((a, b) => a - b),\n        });\n      };\n\n      if (brushData.altKey) {\n        switch (selectedTool) {\n          case options.rangesPicking.id: {\n            if (!general?.disableMultipletAnalysis) {\n              modal.show(\n                <MultipletAnalysisModal\n                  data={data}\n                  activeSpectrum={activeSpectrum}\n                  scaleX={scaleState.scaleX}\n                  {...brushData}\n                />,\n                {\n                  onClose: () => {\n                    modal.close();\n                  },\n                },\n              );\n            }\n            break;\n          }\n          default:\n            break;\n        }\n      } else if (brushData.shiftKey) {\n        switch (selectedTool) {\n          case options.integral.id:\n            dispatch({\n              type: ADD_INTEGRAL,\n              ...brushData,\n            });\n            break;\n          case options.rangesPicking.id: {\n            const [from, to] = getRange(state, {\n              startX: brushData.startX,\n              endX: brushData.endX,\n            });\n\n            if (!activeSpectrum) break;\n\n            const {\n              data: { x },\n            } = state.data[activeSpectrum.index] as Datum1D;\n\n            const { fromIndex, toIndex } = xGetFromToIndex(x, { from, to });\n\n            if (toIndex - fromIndex <= MAX_LENGTH) {\n              dispatch({\n                type: ADD_RANGE,\n                payload: {\n                  ...brushData,\n                },\n              });\n            } else {\n              alert.error(\n                `Advanced peak picking only available for area up to ${MAX_LENGTH} points`,\n              );\n            }\n\n            break;\n          }\n          case options.multipleSpectraAnalysis.id:\n            dispatch({\n              type: ANALYZE_SPECTRA,\n              ...brushData,\n            });\n            break;\n\n          case options.peakPicking.id:\n            dispatch({\n              type: ADD_PEAKS,\n              ...brushData,\n            });\n            break;\n\n          case options.baseLineCorrection.id:\n            dispatch({\n              type: ADD_BASE_LINE_ZONE,\n              zone: { from: brushData.startX, to: brushData.endX },\n            });\n            break;\n\n          case options.exclusionZones.id:\n            dispatch({\n              type: ADD_EXCLUSION_ZONE,\n              payload: { from: brushData.startX, to: brushData.endX },\n            });\n            break;\n\n          default:\n            propagateEvent();\n            break;\n        }\n      } else {\n        switch (selectedTool) {\n          default:\n            if (selectedTool != null) {\n              dispatch({ type: BRUSH_END, ...brushData });\n            }\n            break;\n        }\n      }\n    },\n    [\n      scaleState,\n      selectedTool,\n      general?.disableMultipletAnalysis,\n      modal,\n      data,\n      activeSpectrum,\n      dispatch,\n      state,\n      alert,\n    ],\n  );\n\n  const handelOnDoubleClick = useCallback(() => {\n    dispatch({ type: FULL_ZOOM_OUT, zoomType: ZoomType.STEP_HORIZONTAL });\n  }, [dispatch]);\n\n  const handleZoom = useCallback(\n    (event) => {\n      dispatch({ type: SET_ZOOM, event, selectedTool });\n    },\n    [dispatch, selectedTool],\n  );\n\n  const mouseClick = useCallback(\n    (position) => {\n      const propagateEvent = () => {\n        if (!scaleState.scaleX) return;\n\n        const xPPM = scaleState.scaleX().invert(position.x);\n        Events.emit('mouseClick', {\n          ...position,\n          xPPM,\n        });\n      };\n\n      if (position.shiftKey) {\n        switch (selectedTool) {\n          case options.peakPicking.id:\n            dispatch({\n              type: ADD_PEAK,\n              mouseCoordinates: position,\n            });\n            break;\n          case options.editRange.id:\n            propagateEvent();\n            break;\n          default:\n            break;\n        }\n      } else {\n        switch (selectedTool) {\n          case options.phaseCorrection.id:\n            dispatch({\n              type: SET_VERTICAL_INDICATOR_X_POSITION,\n              position: position.x,\n            });\n            break;\n\n          default:\n        }\n      }\n    },\n    [dispatch, scaleState, selectedTool],\n  );\n\n  return (\n    <ScaleProvider value={scaleState}>\n      <ResponsiveChart>\n        {({ height, width }) => (\n          <ViewerResponsiveWrapper height={height} width={width}>\n            <div style={{ height: '100%', position: 'relative' }}>\n              <Spinner isLoading={isLoading} emptyText={emptyText} />\n\n              {scaleState.scaleX &&\n                scaleState.scaleY &&\n                data &&\n                data.length > 0 && (\n                  <BrushTracker\n                    onBrush={handelBrushEnd}\n                    onDoubleClick={handelOnDoubleClick}\n                    onClick={mouseClick}\n                    onZoom={handleZoom}\n                    style={{\n                      width: '100%',\n                      height: '100%',\n                      margin: 'auto',\n                      position: 'relative',\n                      overflow: 'hidden',\n                    }}\n                  >\n                    <MouseTracker\n                      style={{\n                        width: '100%',\n                        height: `100%`,\n                        position: 'absolute',\n                      }}\n                    >\n                      <SpectraTracker />\n                      <CrossLinePointer />\n                      <BrushXY brushType={BRUSH_TYPE.X} />\n                      <XLabelPointer />\n                      <PeakPointer />\n                      <VerticalIndicator />\n                      <FooterBanner />\n                      <Chart1D\n                        width={widthProp}\n                        height={heightProp}\n                        margin={margin}\n                        mode={mode}\n                        displayerKey={displayerKey}\n                      />\n                    </MouseTracker>\n                  </BrushTracker>\n                )}\n            </div>\n          </ViewerResponsiveWrapper>\n        )}\n      </ResponsiveChart>\n    </ScaleProvider>\n  );\n}\n\nexport default Viewer1D;\n","import { CSSProperties } from 'react';\nimport { FallbackProps } from 'react-error-boundary';\n\ntype RecordKey = 'container' | 'header' | 'title' | 'body';\n\nconst styles: Record<RecordKey, CSSProperties> = {\n  container: {\n    margin: '25px',\n  },\n\n  header: {\n    backgroundColor: '#ffffff',\n    padding: '20px',\n    borderRadius: '10px',\n    fontSize: '30px',\n    textAlign: 'center',\n  },\n\n  title: {\n    textDecoration: 'underline',\n  },\n\n  body: {\n    marginTop: '10px',\n    whiteSpace: 'pre-wrap',\n    backgroundColor: 'white',\n    padding: '20px',\n    borderRadius: '10px',\n    color: 'red',\n  },\n};\n\nexport default function ErrorOverlay(props: FallbackProps) {\n  return (\n    <div style={styles.container}>\n      <p style={styles.header}>Something went wrong.</p>\n      <details style={styles.body}>\n        <p style={styles.title}>{props.error.message}</p>\n        {props.error.stack}\n      </details>\n    </div>\n  );\n}\n","import { CSSProperties, MouseEvent } from 'react';\n\nimport Button from './Button';\n\ninterface ActionButtonsProps {\n  onDone: (event?: MouseEvent) => void;\n  onCancel: (event?: MouseEvent) => void;\n  doneLabel?: string;\n  cancelLabel?: string;\n  style?: CSSProperties;\n}\n\nexport default function ActionButtons(props: ActionButtonsProps) {\n  const {\n    onDone,\n    onCancel,\n    doneLabel = 'Apply',\n    cancelLabel = 'Cancel',\n    style = {},\n  } = props;\n  return (\n    <div style={{ margin: '0 10px', display: 'flex', ...style }}>\n      <Button.Done\n        onClick={onDone}\n        style={\n          style?.flexDirection === 'row-reverse'\n            ? {\n                marginLeft: '10px',\n              }\n            : {}\n        }\n      >\n        {doneLabel}\n      </Button.Done>\n      <Button.Danger\n        fill=\"outline\"\n        onClick={onCancel}\n        style={\n          !style.flexDirection || style.flexDirection === 'row'\n            ? {\n                marginLeft: '10px',\n              }\n            : {}\n        }\n      >\n        {cancelLabel}\n      </Button.Danger>\n    </div>\n  );\n}\n","import {\n  useState,\n  useCallback,\n  ChangeEvent,\n  forwardRef,\n  ForwardedRef,\n  CSSProperties,\n} from 'react';\n\nexport interface CheckBoxProps {\n  onChange?: (value: ChangeEvent<HTMLInputElement>) => void;\n  name?: string;\n  disabled?: boolean;\n  checked?: boolean;\n  style?: CSSProperties;\n}\n\nconst CheckBox = forwardRef(\n  (props: CheckBoxProps, ref: ForwardedRef<HTMLInputElement>) => {\n    const {\n      checked: checkProps = false,\n      disabled = false,\n      name = '',\n      onChange = () => null,\n      style = {},\n    } = props;\n\n    const [checked, setCheck] = useState<boolean>(checkProps);\n\n    const handleCheck = useCallback(\n      (e) => {\n        setCheck(!checked);\n        onChange(e);\n      },\n      [checked, onChange],\n    );\n\n    return (\n      <input\n        ref={ref}\n        type=\"checkbox\"\n        name={name}\n        id={name}\n        onChange={handleCheck}\n        defaultChecked={checkProps}\n        disabled={disabled}\n        style={style}\n      />\n    );\n  },\n);\n\nexport default CheckBox;\n","import { useFormikContext } from 'formik';\nimport lodashGet from 'lodash/get';\nimport { CSSProperties, useCallback } from 'react';\n\nimport CheckBox, { CheckBoxProps } from '../CheckBox';\n\ninterface FormikCheckBoxProps extends Omit<CheckBoxProps, 'style'> {\n  name: string;\n  label?: string;\n  className?: string;\n  reverse?: boolean;\n  style?: {\n    container?: CSSProperties;\n    label?: CSSProperties;\n    checkbox?: CSSProperties;\n  };\n}\n\nfunction FormikCheckBox(props: FormikCheckBoxProps) {\n  const {\n    label,\n    name,\n    onChange = () => null,\n    className = 'checkbox',\n    reverse = false,\n    style = { container: {}, label: {}, checkbox: {} },\n    ...resProps\n  } = props;\n\n  const { values, setFieldValue } = useFormikContext();\n  const value = reverse ? !lodashGet(values, name) : lodashGet(values, name);\n\n  const changeHandler = useCallback(\n    (e: React.ChangeEvent<HTMLInputElement>) => {\n      e.persist();\n      onChange(e);\n      setFieldValue(name, reverse ? value : !value);\n    },\n    [name, onChange, reverse, setFieldValue, value],\n  );\n\n  return (\n    <div\n      className={`${className} check-${value}`}\n      style={style.container ? style.container : {}}\n    >\n      {label && (\n        <label\n          htmlFor={name}\n          className=\"checkbox-label\"\n          style={style.label ? style.label : {}}\n        >\n          {label}\n        </label>\n      )}\n      <CheckBox\n        {...resProps}\n        name={name}\n        checked={value}\n        onChange={changeHandler}\n        style={style.checkbox ? style.checkbox : {}}\n      />\n    </div>\n  );\n}\n\nexport default FormikCheckBox;\n","import { Formik, FormikHelpers, FormikProps } from 'formik';\nimport { ForwardedRef, forwardRef, ReactNode } from 'react';\n\ninterface FormikFormProps {\n  initialValues?: any;\n  onSubmit?: (values: any, helpers: FormikHelpers<any>) => void;\n  validationSchema?: any;\n  children?: Array<ReactNode> | ReactNode;\n}\n\nconst FormikForm = forwardRef(\n  (props: FormikFormProps, ref: ForwardedRef<FormikProps<any>>) => {\n    const {\n      onSubmit = () => null,\n      initialValues = {},\n      validationSchema = null,\n    } = props;\n\n    return (\n      <Formik\n        innerRef={ref}\n        initialValues={initialValues}\n        onSubmit={onSubmit}\n        validationSchema={validationSchema}\n      >\n        <>{props.children}</>\n      </Formik>\n    );\n  },\n);\n\nexport default FormikForm;\n","import { LegacyRef, MutableRefObject, useEffect, useRef } from 'react';\n\nexport default function useCombinedRefs(\n  refs: Array<MutableRefObject<any> | LegacyRef<any>>,\n) {\n  const targetRef = useRef<any>();\n\n  useEffect(() => {\n    refs.forEach((ref) => {\n      if (!ref) return;\n      if (typeof ref === 'function') {\n        ref(targetRef.current);\n      } else {\n        (ref as MutableRefObject<any>).current = targetRef.current;\n      }\n    });\n  }, [refs]);\n\n  return targetRef;\n}\n","import debounce from 'lodash/debounce';\nimport {\n  useState,\n  useEffect,\n  useCallback,\n  useRef,\n  CSSProperties,\n  forwardRef,\n  ForwardedRef,\n  ReactElement,\n} from 'react';\n\nimport useCombinedRefs from '../hooks/useCombinedRefs';\n\nconst styles: Record<\n  'label' | 'input' | 'inputWrapper' | 'clearButton',\n  CSSProperties\n> = {\n  label: {\n    lineHeight: 2,\n    userSelect: 'none',\n  },\n\n  inputWrapper: {\n    height: '100%',\n    width: '100px',\n    borderRadius: '5px',\n    borderWidth: '0.55px',\n    borderColor: '#c7c7c7',\n    borderStyle: 'solid',\n    display: 'flex',\n    flexDirection: 'row',\n    alignItems: 'center',\n    overflow: 'hidden',\n  },\n  input: {\n    outline: 'none',\n    flex: 1,\n    height: '100%',\n    textAlign: 'center',\n    width: '100%',\n  },\n  clearButton: {\n    height: 'calc(100% - 4px)',\n    borderRadius: '50%',\n    backgroundColor: 'gray',\n    color: 'white',\n    aspectRatio: '1',\n    fontSize: '60%',\n    padding: 0,\n  },\n};\n\nexport interface InputProps\n  extends Omit<React.InputHTMLAttributes<HTMLInputElement>, 'style'> {\n  style?: {\n    input?: CSSProperties;\n    inputWrapper?: CSSProperties;\n  };\n  enableAutoSelect?: boolean;\n  debounceTime?: number;\n  checkValue?: (element: number | string) => boolean;\n  format?: () => (element: string) => number | string;\n  renderIcon?: (() => ReactElement) | null;\n  canClear?: boolean;\n  onClear?: () => void;\n}\n\nconst Input = forwardRef(\n  (\n    {\n      value = '',\n      name,\n      style = {\n        input: {},\n        inputWrapper: {},\n      },\n      onChange = () => null,\n      debounceTime = 0,\n      onKeyDown = () => null,\n      checkValue = () => true,\n      type = 'text',\n      enableAutoSelect = false,\n      className,\n      format = () => (value) => value,\n      onBlur = () => null,\n      onFocus = () => null,\n      renderIcon = null,\n      canClear = false,\n      onClear,\n      ...props\n    }: InputProps,\n    ref: ForwardedRef<HTMLInputElement>,\n  ) => {\n    const [val, setVal] = useState(value);\n    const localRef = useRef<any>();\n    const combinedRef = useCombinedRefs([ref, localRef]);\n\n    const debounceOnChange = useRef(\n      debounce((value) => {\n        onChange(value);\n      }, debounceTime),\n    ).current;\n\n    useEffect(() => {\n      setVal(value);\n    }, [value]);\n\n    useEffect(() => {\n      if (enableAutoSelect) {\n        combinedRef?.current?.select();\n      }\n    }, [enableAutoSelect, combinedRef]);\n\n    const getValue = useCallback(\n      (value) => {\n        const formatValue = format();\n        return formatValue(\n          type === 'number'\n            ? String(value).trim() === '-'\n              ? Number(0)\n              : Number(value)\n            : value,\n        );\n      },\n      [format, type],\n    );\n\n    const onChangeHandler = useCallback(\n      (e) => {\n        e.persist();\n        e.stopPropagation();\n        e.preventDefault();\n        function check(value) {\n          if (type === 'number') {\n            const pattern = /^(?:-?[0-9]*|[0-9]\\d*)(?:\\.\\d{0,20})?$/;\n            if (value.trim() === '' || pattern.test(value)) {\n              return true;\n            }\n            return false;\n          }\n          return true;\n        }\n\n        const _value: string = e.target.value;\n        if (check(_value) && checkValue(_value)) {\n          const formatValue = format();\n\n          setVal(formatValue(_value));\n\n          const val = {\n            ...e,\n            target: { name: e.target.name, value: getValue(_value) },\n          };\n\n          if (debounceTime) {\n            debounceOnChange(val);\n          } else {\n            onChange(val);\n          }\n        }\n      },\n      [\n        checkValue,\n        debounceOnChange,\n        debounceTime,\n        format,\n        getValue,\n        onChange,\n        type,\n      ],\n    );\n\n    const handleKeyDown = useCallback(\n      (event) => {\n        event.persist();\n        onKeyDown({\n          ...event,\n          target: { name: event.target.name, value: getValue(val) },\n        });\n      },\n      [getValue, onKeyDown, val],\n    );\n    const preventPropagate = useCallback((event) => {\n      event.stopPropagation();\n    }, []);\n\n    const clearHandler = useCallback(() => {\n      setVal('');\n      onClear?.();\n    }, [onClear]);\n\n    return (\n      <div\n        style={{\n          ...styles.inputWrapper,\n          ...(style?.inputWrapper ? style.inputWrapper : {}),\n        }}\n        className={`input ${className || ''}`}\n      >\n        {renderIcon?.()}\n        <input\n          {...props}\n          ref={combinedRef}\n          name={name}\n          style={{\n            ...styles.input,\n            ...(style?.input ? style.input : {}),\n          }}\n          data-test-id={name ? `input-${name}` : ''}\n          type=\"text\"\n          value={val}\n          onChange={onChangeHandler}\n          onKeyDown={handleKeyDown}\n          onKeyPress={preventPropagate}\n          onDoubleClick={(e) => e.stopPropagation()}\n          onFocus={onFocus}\n          onBlur={onBlur}\n        />\n        {canClear && val && (\n          <button\n            type=\"button\"\n            style={styles.clearButton}\n            onClick={clearHandler}\n          >\n            <span style={{ display: 'block', margin: '0 auto' }}>&#10005;</span>\n          </button>\n        )}\n      </div>\n    );\n  },\n);\n\nexport default Input;\n","import { useFormikContext } from 'formik';\nimport lodashGet from 'lodash/get';\nimport { useCallback, useEffect, useMemo } from 'react';\n\nimport Input, { InputProps } from '../Input';\n\ninterface FormikInputProps extends InputProps {\n  name: string;\n  checkErrorAfterInputTouched?: boolean;\n}\n\nfunction FormikInput(props: FormikInputProps) {\n  const {\n    name,\n    style = { label: {}, input: {} },\n    onChange = () => null,\n    checkValue = () => true,\n    type = 'text',\n    className = '',\n    value = null,\n    format = () => (value) => value,\n    checkErrorAfterInputTouched = true,\n    ...resProps\n  } = props;\n\n  const { values, handleChange, setFieldValue, errors, touched } =\n    useFormikContext();\n\n  const changeHandler = useCallback(\n    (e) => {\n      onChange(e);\n      handleChange(e);\n    },\n    [handleChange, onChange],\n  );\n\n  useEffect(() => {\n    if (value) {\n      setFieldValue(name, value);\n    }\n  }, [name, setFieldValue, value]);\n\n  const isInvalid = useMemo(() => {\n    if (checkErrorAfterInputTouched) {\n      return lodashGet(errors, name) && lodashGet(touched, name);\n    }\n    return lodashGet(errors, name);\n  }, [checkErrorAfterInputTouched, errors, name, touched]);\n\n  return (\n    <Input\n      name={name}\n      value={value ? value : lodashGet(values, name)}\n      onChange={changeHandler}\n      type={type}\n      style={{\n        ...style,\n        inputWrapper: {\n          ...style.input,\n          ...(isInvalid && { borderColor: 'red', outline: 'none' }),\n        },\n      }}\n      checkValue={checkValue}\n      className={className}\n      format={format}\n      {...resProps}\n    />\n  );\n}\n\nexport default FormikInput;\n","import { css } from '@emotion/react';\n\nexport const ModalStyles = css`\n  overflow: auto;\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n\n  .header {\n    text-align: center;\n    padding: 10px 0 10px 0px;\n    margin: 0px;\n    color: #005d9e;\n    place-items: normal;\n    text-transform: none;\n    background-color: #fcfcfc;\n  }\n\n  .tab-content {\n    width: 100%;\n  }\n  .row {\n    display: flex;\n  }\n\n  .inner-content {\n    padding: 15px 30px;\n    width: 100%;\n    overflow: auto;\n  }\n\n  .footer-container {\n    display: flex;\n    flex-direction: row;\n    align-items: end;\n    justify-content: end;\n\n    background: rgb(242, 242, 242);\n    background: -moz-linear-gradient(\n      0deg,\n      rgba(242, 242, 242, 1) 0%,\n      rgba(245, 245, 245, 1) 37%,\n      rgba(255, 255, 255, 1) 90%\n    );\n    background: -webkit-linear-gradient(\n      0deg,\n      rgba(242, 242, 242, 1) 0%,\n      rgba(245, 245, 245, 1) 37%,\n      rgba(255, 255, 255, 1) 90%\n    );\n    background: linear-gradient(\n      0deg,\n      rgba(242, 242, 242, 1) 0%,\n      rgba(245, 245, 245, 1) 37%,\n      rgba(255, 255, 255, 1) 90%\n    );\n    filter: progid:DXImageTransform.Microsoft.gradient(startColorstr=\"#f2f2f2\",endColorstr=\"#ffffff\",GradientType=1);\n    padding: 6px 15px;\n    height: 55px;\n  }\n\n  .section-header {\n    font-size: 13px;\n    color: #2ca8ff;\n    margin-bottom: 10px;\n    border-bottom: 0.55px solid #f9f9f9;\n    padding: 6px 2px;\n  }\n\n  .custom-label {\n    font-size: 12px;\n    font-weight: bold;\n    margin-right: 10px;\n    width: 120px;\n  }\n  .margin-10 {\n    margin: 10px 0;\n  }\n  .padding-h-10 {\n    margin: 10px;\n  }\n\n  .input {\n    font-size: 14px;\n    border-radius: 5px;\n    border: 1px solid #cccccc;\n    padding: 5px;\n    width: 100px;\n    margin-right: 10px;\n    height: initial !important;\n  }\n\n  .close-bt {\n    border: none;\n    color: red;\n    background-color: transparent;\n    outline: none;\n    position: absolute;\n    right: 10px;\n    top: 2px;\n    width: 30px;\n    height: 30px;\n  }\n`;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { Field } from 'formik';\nimport { useCallback, useRef } from 'react';\n\nimport { DataExportOptions } from '../../data/SpectraManager';\nimport ActionButtons from '../elements/ActionButtons';\nimport CloseButton from '../elements/CloseButton';\nimport FormikCheckBox from '../elements/formik/FormikCheckBox';\nimport FormikForm from '../elements/formik/FormikForm';\nimport FormikInput from '../elements/formik/FormikInput';\n\nimport { ModalStyles } from './ModalStyle';\n\nconst styles = css`\n  .row {\n    align-items: center;\n  }\n\n  .inner-content {\n    flex: 1;\n  }\n\n  .custom-label {\n    width: 80px;\n  }\n\n  .name {\n    width: 100% !important;\n    text-align: left !important;\n  }\n\n  .data-export-group {\n    label:first-child {\n      margin-right: 10px;\n    }\n    label {\n      display: inline-block;\n    }\n    input[type='radio'] {\n      margin-right: 5px;\n    }\n  }\n`;\n\nconst INITIAL_VALUE = {\n  name: '',\n  compressed: false,\n  pretty: false,\n  dataExportOption: DataExportOptions.ROW_DATA,\n};\n\ninterface SaveAsModalProps {\n  onClose?: (event?: MouseEvent) => void;\n  onSave: (element: any) => void;\n  name: string;\n}\n\nfunction SaveAsModal({ onClose, onSave, name }: SaveAsModalProps) {\n  const refForm = useRef<any>();\n\n  const handleSave = useCallback(() => {\n    refForm.current.submitForm();\n  }, []);\n\n  const submitHandler = useCallback(\n    (values) => {\n      onSave(values);\n      onClose?.();\n    },\n    [onClose, onSave],\n  );\n\n  return (\n    <div css={[ModalStyles, styles]}>\n      <div className=\"header handle\">\n        <span>Save as ... </span>\n        <CloseButton onClick={onClose} className=\"close-bt\" />\n      </div>\n      <div className=\"inner-content\">\n        <FormikForm\n          ref={refForm}\n          initialValues={{ ...INITIAL_VALUE, name }}\n          onSubmit={submitHandler}\n        >\n          <div className=\"row margin-10\">\n            <span className=\"custom-label\">Name</span>\n            <FormikInput\n              name=\"name\"\n              className=\"name\"\n              style={{\n                inputWrapper: { width: '100%' },\n              }}\n            />\n          </div>\n\n          <div className=\"row margin-10\">\n            <span className=\"custom-label\">Compressed</span>\n            <FormikCheckBox name=\"compressed\" />\n          </div>\n          <div className=\"row margin-10\">\n            <span className=\"custom-label\">Pretty Format</span>\n            <FormikCheckBox name=\"pretty\" />\n          </div>\n          <div className=\"row margin-10\">\n            <span className=\"custom-label\"> Include </span>\n            <div className=\"data-export-group\">\n              <label>\n                <Field\n                  type=\"radio\"\n                  name=\"dataExportOption\"\n                  value={DataExportOptions.ROW_DATA}\n                />\n                Raw Data\n              </label>\n              <label>\n                <Field\n                  type=\"radio\"\n                  name=\"dataExportOption\"\n                  value={DataExportOptions.DATA_SOURCE}\n                />\n                Data Source\n              </label>\n            </div>\n          </div>\n        </FormikForm>\n      </div>\n      <div className=\"footer-container\">\n        <ActionButtons\n          style={{ flexDirection: 'row-reverse', margin: 0 }}\n          onDone={handleSave}\n          doneLabel=\"Save\"\n          onCancel={() => onClose?.()}\n        />\n      </div>\n    </div>\n  );\n}\n\nexport default SaveAsModal;\n","import { saveAs } from 'file-saver';\nimport JSZip from 'jszip';\n\nfunction copyFormattedHtml(html) {\n  // Create an iframe (isolated container) for the HTML\n  let container = document.createElement('div');\n  container.innerHTML = html;\n\n  // Hide element\n  container.style.position = 'fixed';\n  container.style.pointerEvents = 'none';\n  container.style.opacity = '0';\n\n  // Detect all style sheets of the page\n  let activeSheets = Array.prototype.slice\n    .call(document.styleSheets)\n    .filter((sheet) => {\n      return !sheet.disabled;\n    });\n\n  // Mount the iframe to the DOM to make `contentWindow` available\n  document.body.appendChild(container);\n\n  // Copy to clipboard\n  window.getSelection()?.removeAllRanges();\n\n  let range = document.createRange();\n  range.selectNode(container);\n  window.getSelection()?.addRange(range);\n\n  document.execCommand('copy');\n  for (const active of activeSheets) {\n    active.disabled = true;\n  }\n\n  document.execCommand('copy');\n  for (const active of activeSheets) {\n    active.disabled = false;\n  }\n\n  // Remove the iframe\n  document.body.removeChild(container);\n}\n\nasync function copyHTMLToClipboard(data) {\n  try {\n    copyFormattedHtml(data);\n    return true;\n  } catch (err) {\n    return false;\n  }\n}\nasync function copyTextToClipboard(data) {\n  try {\n    await navigator.clipboard.writeText(data);\n    return true;\n  } catch (err) {\n    return false;\n  }\n}\n/**\n * export the experiments result in JSON format\n * @param {*} data\n */\nasync function exportAsJSON(\n  data,\n  fileName = 'experiment',\n  spaceIndent = 0,\n  isCompressed = false,\n) {\n  const fileData = JSON.stringify(\n    data,\n    (key, value) =>\n      ArrayBuffer.isView(value) ? Array.from(value as any) : value,\n    spaceIndent,\n  );\n  if (!isCompressed) {\n    const blob = new Blob([fileData], { type: 'text/plain' });\n    saveAs(blob, `${fileName}.nmrium`);\n  } else {\n    try {\n      const zip = new JSZip();\n      zip.file(`${fileName}.nmrium`, fileData);\n      const blob = await zip.generateAsync({\n        type: 'blob',\n        compression: 'DEFLATE',\n        compressionOptions: {\n          level: 9,\n        },\n      });\n      saveAs(blob, `${fileName}.nmrium`);\n    } catch (e) {\n      // eslint-disable-next-line no-console\n      console.log(e);\n    }\n  }\n}\n\nfunction exportAsMatrix(data, options, fileName = 'experiment') {\n  //columns labels\n  const columnsLables = ['name', 'experiment'];\n  for (const value of data[0].data.x) {\n    columnsLables.push(value);\n  }\n  let matrix = `${columnsLables.join('\\t')}\\n`;\n\n  for (const spectrum of data) {\n    const {\n      data: { re },\n      info: { experiment },\n      display: { name },\n    } = spectrum;\n    const cellsValues = [name, experiment];\n    for (const value of re) {\n      cellsValues.push(value);\n    }\n    matrix += `${cellsValues.join('\\t')}\\n`;\n  }\n\n  const blob = new Blob([matrix], { type: 'text/tab-separated-values' });\n  saveAs(blob, `${fileName}.tsv`);\n}\n\nfunction exportAsNMRE(data, fileName = 'experiment') {\n  data.generateAsync({ type: 'blob' }).then((content) => {\n    saveAs(content, `${fileName}.nmredata`);\n  });\n}\n\nfunction exportAsMol(data, fileName = 'mol') {\n  const blob = new Blob([data], { type: 'text/plain' });\n  saveAs(blob, `${fileName}.mol`);\n}\n/**\n * export the vitalization result as SVG, if you need to remove some content during exportation process enclose the the content with <!-- export-remove --> ${content} <!-- export-remove -->\n */\nfunction exportAsSVG(\n  rootRef: HTMLDivElement,\n  elementID: string,\n  fileName = 'experiment',\n) {\n  const { blob } = getBlob(rootRef, elementID);\n  saveAs(blob, `${fileName}.svg`);\n}\n\nfunction exportAsPng(\n  rootRef: HTMLDivElement,\n  elementID: string,\n  fileName = 'experiment',\n) {\n  const { blob, width, height } = getBlob(rootRef, elementID);\n  try {\n    let canvas = document.createElement('canvas');\n    canvas.width = width;\n    canvas.height = height;\n    let context = canvas.getContext('2d');\n\n    if (context) {\n      context.fillStyle = 'white';\n      context.fillRect(0, 0, canvas.width, canvas.height);\n    }\n\n    let img = new Image();\n    let url = URL.createObjectURL(blob);\n    img.onload = async () => {\n      context?.drawImage(img, 0, 0);\n      let png = canvas.toDataURL('image/png', 1);\n      saveAs(png, `${fileName}.png`);\n      URL.revokeObjectURL(png);\n    };\n    img.src = url;\n  } catch (e) {\n    // eslint-disable-next-line no-console\n    console.log(e);\n  }\n}\n\nfunction copyDataURLCliboard(image) {\n  const img = document.createElement('img');\n  img.src = image;\n\n  img.style.position = 'fixed';\n  img.style.pointerEvents = 'none';\n  img.style.opacity = '0';\n\n  document.body.appendChild(img);\n  const range = document.createRange();\n  range.selectNode(img);\n  window.getSelection()?.addRange(range);\n  document.execCommand('Copy');\n  document.body.removeChild(img);\n}\n\nfunction copyBlobToCliboard(canvas) {\n  canvas.toBlob((b) => {\n    const clip = new ClipboardItem({\n      [b.type]: b,\n    });\n\n    navigator.clipboard.write([clip]).then(\n      () => {\n        // eslint-disable-next-line no-console\n        console.log('experiment copied.');\n      },\n      (err) => {\n        // eslint-disable-next-line no-console\n        console.log(err);\n      },\n    );\n  });\n}\n\nfunction copyPNGToClipboard(rootRef: HTMLDivElement, elementID: string) {\n  const { blob, width, height } = getBlob(rootRef, elementID);\n  try {\n    let canvas = document.createElement('canvas');\n    canvas.width = width;\n    canvas.height = height;\n    let context = canvas.getContext('2d');\n\n    if (context) {\n      context.fillStyle = 'white';\n      context.fillRect(0, 0, canvas.width, canvas.height);\n    }\n\n    let img = new Image();\n    const url = URL.createObjectURL(blob);\n    img.onload = async () => {\n      context?.drawImage(img, 0, 0);\n      const png = canvas.toDataURL('image/png', 1);\n\n      // @ts-expect-error write exists in some browsers\n      if (navigator.clipboard.write) {\n        copyBlobToCliboard(canvas);\n      } else {\n        copyDataURLCliboard(png);\n      }\n\n      URL.revokeObjectURL(png);\n    };\n    img.src = url;\n  } catch (e) {\n    if (e instanceof ReferenceError) {\n      // eslint-disable-next-line no-alert\n      alert(\n        'Your browser does not support this feature, please use Google Chrome',\n      );\n    }\n    // eslint-disable-next-line no-console\n    console.log(e);\n  }\n}\n\nfunction getBlob(rootRef: HTMLDivElement, elementID: string) {\n  let _svg: any = (rootRef.getRootNode() as Document)\n    .getElementById(elementID)\n    ?.cloneNode(true);\n  const width = _svg?.getAttribute('width').replace('px', '');\n  const height = _svg?.getAttribute('height').replace('px', '');\n  _svg\n    .querySelectorAll('[data-no-export=\"true\"]')\n    .forEach((element) => element.remove());\n  _svg\n    .querySelectorAll('[data-replace-float-structure=\"true\"]')\n    .forEach((element: Element) => {\n      element.replaceWith(element.childNodes[0].childNodes[0]);\n      return element;\n    });\n  const head = `<svg class=\"nmr-svg\"  viewBox='0 0 ${width} ${height}' width=\"${width}\"  height=\"${height}\"  version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\">`;\n  const style = `<style>.grid line,.grid path{stroke:none;} .peaks-text{fill:#730000} .x path{stroke-width:1px} .x text{\n    font-size: 12px;\n    font-weight: bold;\n  } \n \n  .nmr-svg,.contours{\n    background-color:white;\n    fill:white;\n  }\n  \n\n  \n  </style>`;\n  const svg = `${head + style + _svg.innerHTML}</svg>`;\n  const blob = new Blob([svg], { type: 'image/svg+xml' });\n  return { blob, width, height };\n}\n\nexport {\n  exportAsSVG,\n  exportAsJSON,\n  exportAsNMRE,\n  exportAsPng,\n  copyPNGToClipboard,\n  copyTextToClipboard,\n  copyHTMLToClipboard,\n  exportAsMol,\n  exportAsMatrix,\n};\n","import Jszip from 'jszip';\n\nconst jszip = new Jszip();\n\ninterface addSourceOptions {\n  spectrum?: any;\n  source?: any;\n}\n\nexport async function addSource(nmrRecord, options: addSourceOptions = {}) {\n  const { spectrum, source } = options;\n  const { file = {}, jcampURL } = source;\n  let tag = '';\n  const dimension = `${spectrum.info.dimension}d`;\n  switch (file.extension) {\n    case 'jdx':\n    case 'dx':\n      tag += `\\nJcamp_Location=file:jcamp/${dimension}/${spectrum.display.name}\\\\`;\n      nmrRecord.file(\n        `jcamp/${dimension}/${spectrum.display.name}`,\n        file.binary,\n      );\n      break;\n    case 'zip':\n      if (!file.binary) return;\n      void jszip.loadAsync(file.binary).then(async (zip) => {\n        for (const file in zip.files) {\n          if (file.endsWith('/')) continue;\n          nmrRecord.file(\n            `Bruker/${file}`,\n            await zip.file(file)?.async('arraybuffer'),\n          );\n        }\n        tag += `\\nSpectrum_Location=file:Bruker/${getPathFromZip(zip)}\\\\`;\n      });\n      break;\n    default:\n      if (!jcampURL) break;\n      void (await fetch(jcampURL).then(async (jcamp) => {\n        if (!jcamp) return;\n        let name = jcampURL.split('/').slice(-1);\n        const path = `jcamp/${dimension}/${name}`;\n        tag += `\\nJcamp_Location=file:${path}\\\\`;\n        nmrRecord.file(path, await jcamp.arrayBuffer());\n      }));\n  }\n\n  return tag;\n}\n\nfunction getPathFromZip(zip) {\n  let files = zip.filter((relativePath) => {\n    if (relativePath.match('__MACOSX')) return false;\n    if (\n      relativePath.endsWith('fid') ||\n      relativePath.endsWith('1r') ||\n      relativePath.endsWith('ser') ||\n      relativePath.endsWith('2rr')\n    ) {\n      return true;\n    }\n    return false;\n  });\n  const index = files.findIndex(\n    (file) => file.name.endsWith('1r') || file.name.endsWith('2rr'),\n  );\n  return index > -1 ? files[index].name : files[0].name;\n}\n","export function getToFix(nucleusArray: string | Array<string>) {\n  if (!Array.isArray(nucleusArray)) nucleusArray = [nucleusArray];\n  let toFix: Array<number> = [];\n  for (let nucleus of nucleusArray) {\n    toFix.push(chooseDecimal(nucleus));\n  }\n  return toFix;\n}\n\nfunction chooseDecimal(nucleus: string) {\n  switch (nucleus.toUpperCase()) {\n    case '1H':\n      return 2;\n    case '13C':\n      return 1;\n    default:\n      return 1;\n  }\n}\n","import { addSource } from './addSource';\nimport { getToFix } from './getToFix';\n\ninterface Get1DSignalsOptions {\n  prefix?: string;\n  labels: {\n    byDiaID: Array<{ label: string }>;\n  };\n}\n\nexport async function get1DSignals(\n  data,\n  nmrRecord,\n  options: Get1DSignalsOptions = { labels: { byDiaID: [] } },\n) {\n  let { prefix = '', labels } = options;\n  let str = '';\n  let nucleusArray: Array<Array<any>> = [];\n  for (let spectrum of data) {\n    const { info } = spectrum;\n    if (info.isFid || info.dimension > 1) continue;\n    let partTag = '';\n    let ranges = spectrum.ranges.values || [];\n\n    let nucleus = spectrum.info.nucleus;\n    let counter = 1;\n    let subfix = '';\n    nucleusArray.forEach((e) => {\n      if (e === nucleus) counter++;\n    });\n    nucleusArray.push(nucleus);\n\n    if (counter > 1) subfix = `#${counter}`;\n\n    partTag += `${prefix}1D_${nucleus.toUpperCase()}${subfix}>`;\n\n    if (spectrum.info.baseFrequency) {\n      partTag += `\\nLarmor=${Number(spectrum.info.baseFrequency).toFixed(2)}\\\\`;\n    }\n\n    const { source = {} } = spectrum;\n\n    partTag += await addSource(nmrRecord, {\n      spectrum,\n      source,\n    });\n\n    let toFix = getToFix(nucleus)[0];\n\n    for (let range of ranges) {\n      let signals = range.signals;\n\n      for (let signal of signals) {\n        let { multiplicity } = signal;\n        if ((!multiplicity || multiplicity === 'm') && nucleus === '1H') {\n          partTag += `\\n${Number(range.from).toFixed(toFix)}-${Number(\n            range.to,\n          ).toFixed(toFix)}`;\n        } else if (signal.delta) {\n          partTag += `\\n${Number(signal.delta).toFixed(toFix)}`;\n        } else {\n          continue;\n        }\n\n        let signalLabel = '';\n\n        if (signal.diaIDs && signal.diaIDs.length > 0) {\n          signal.diaIDs.forEach((diaID, i, arr) => {\n            let separator = ', ';\n            if (i === arr.length - 1) separator = '';\n            let label = labels.byDiaID[diaID].label || diaID;\n            signalLabel += `${label}${separator}`;\n          });\n          partTag += `, L=${signalLabel}`;\n        }\n\n        if (nucleus === '1H') {\n          if (signal.multiplicity) partTag += `, S=${signal.multiplicity}`;\n\n          let jCoupling = signal.js;\n          if (Array.isArray(jCoupling) && jCoupling.length) {\n            let separator = ', J=';\n\n            for (const jCouplingElement of jCoupling) {\n              partTag += `${separator}${Number(\n                jCouplingElement.coupling,\n              ).toFixed(3)}`;\n              if (jCouplingElement.diaIDs) {\n                let { diaIDs } = jCouplingElement;\n                if (!Array.isArray(diaIDs)) diaIDs = [diaIDs];\n                if (!diaIDs.length) continue;\n                let jCouple =\n                  labels.byDiaID[diaIDs[0]].label || String(diaIDs[0]);\n                partTag += `(${jCouple})`;\n              }\n              separator = ', ';\n            }\n          }\n          if (range.integration) {\n            partTag += `, E=${Number(range.integration).toFixed(toFix)}`;\n          } else if (range.nbAtoms) {\n            partTag += `, E=${range.nbAtoms.toFixed(toFix)}`;\n          } else if (range.signals[0].nbAtoms !== undefined) {\n            partTag += `, E=${range.signals[0].nbAtoms}`;\n          }\n        }\n      }\n      if (signals.length) partTag += '\\\\';\n    }\n    partTag += '\\n';\n\n    if (/\\n/.exec(partTag)) str += partTag;\n  }\n  return str;\n}\n","export function getCouplingObserved(experiment: string) {\n  switch (experiment.toLowerCase()) {\n    case 'hsqc':\n    case 'cosy':\n      return '1J';\n    case 'hmbc':\n      return 'NJ';\n    default:\n      return 'NJ';\n  }\n}\n","import { addSource } from './addSource';\nimport { getCouplingObserved } from './getCouplingObserved';\nimport { getToFix } from './getToFix';\n\nconst isArray = Array.isArray;\n\ninterface Get2DSignalsOptions {\n  labels: { byDiaID?: string };\n  prefix?: string;\n}\n\nexport async function get2DSignals(\n  data,\n  nmrRecord,\n  options: Get2DSignalsOptions = { labels: {} },\n) {\n  const { byDiaID } = options.labels;\n  let str = '';\n  let nucleusRecorded: Array<Array<any>> = [];\n  const prefix = `\\n> <NMREDATA_2D_`;\n  for (let spectrum of data) {\n    if (spectrum.info.dimension < 2) continue;\n    let partTag = '';\n    const { info, source } = spectrum;\n    let { nucleus, experiment, pulseSequence } = info;\n\n    nucleusRecorded.push(nucleus);\n\n    let couplingObserved = getCouplingObserved(experiment);\n    if (nucleus) {\n      partTag += `${prefix}${nucleus[1]}_${couplingObserved}_${nucleus[0]}>`;\n    }\n    let toFix = getToFix(nucleus);\n\n    partTag += await addSource(nmrRecord, {\n      spectrum,\n      source,\n    });\n\n    if (experiment) partTag += `\\nCorType=${experiment} \\\\`;\n    if (pulseSequence) partTag += `\\nPulseProgram=${pulseSequence} \\\\`;\n\n    if (spectrum.info.baseFrequency) {\n      partTag += `\\nLarmor=${Number(spectrum.info.baseFrequency[0]).toFixed(\n        2,\n      )}\\\\`;\n    }\n\n    let zones = spectrum.zones.values || [];\n    for (let zone of zones) {\n      let signals = zone.signals;\n      for (let signal of signals) {\n        let { x, y, peaks } = signal;\n        let xLabel = getAssignment(x, byDiaID, toFix[0]);\n        let yLabel = getAssignment(y, byDiaID, toFix[1]);\n        let intensity = Math.max(...peaks.map((e) => e.z));\n        partTag += `\\n${xLabel}/${yLabel}, I=${intensity.toFixed(2)}\\\\`;\n      }\n    }\n    str += partTag;\n  }\n  return str.length > 0 ? `${str}\\n` : '';\n}\n\nfunction getAssignment(axis, labels, toFix) {\n  let { diaIDs, delta } = axis;\n  if (diaIDs) {\n    if (!isArray(diaIDs)) diaIDs = [diaIDs];\n    if (diaIDs.length < 1) return Number(delta).toFixed(toFix);\n    let label = diaIDs.map((diaID) => labels[diaID].label).join(',');\n    return diaIDs.length > 1 ? `(${label})` : label;\n  }\n  return Number(delta).toFixed(toFix);\n}\n","export function flat2DSignals(signals) {\n  let flattedSignal: Array<any> = [];\n  for (const { x, y } of signals) {\n    flattedSignal.push(x, y);\n  }\n  return flattedSignal;\n}\n","import { getShortestPaths } from 'openchemlib-utils';\n\nimport { flat2DSignals } from './flat2DSignals';\nimport { getToFix } from './getToFix';\n\ninterface GetLabelsOptions {\n  molecule?: any;\n  groupedDiaIDs: Array<any>;\n}\n\nexport function getLabels(\n  data,\n  options: GetLabelsOptions = { groupedDiaIDs: [] },\n) {\n  const { groupedDiaIDs, molecule } = options;\n\n  let connections = getShortestPaths(molecule, { toLabel: 'H', maxLength: 1 });\n\n  let byDiaID = {};\n  let byAssignNumber = {};\n  for (let spectrum of data) {\n    let { dimension, nucleus } = spectrum.info;\n    let toFix = getToFix(nucleus);\n\n    let [roiKey, flatSignals] =\n      dimension > 1 ? ['zones', flat2DSignals] : ['ranges', (s) => s || []];\n\n    let rois = spectrum[roiKey].values || [];\n    for (let roi of rois) {\n      let signals = flatSignals(roi.signals);\n      for (let i = 0; i < signals.length; i++) {\n        let diaIDs = signals[i].diaIDs || [];\n        for (let diaID of diaIDs) {\n          let delta = Number(signals[i].delta).toFixed(toFix[i % dimension]);\n          // get atomLabel\n          let groupedOclID = groupedDiaIDs.find((dia) => {\n            if (dia.oclID === diaID) return true;\n            return false;\n          });\n          // the addition of one in atom number it is because the atoms enumeration starts from zero\n\n          let labelOptions = {\n            atom: groupedOclID.atoms[0],\n            molecule,\n            connections,\n            atomLabel: groupedOclID.atomLabel,\n          };\n\n          byDiaID[diaID] = {\n            atoms: groupedOclID.atoms.map((e) => e + 1),\n            shift: delta,\n            label: createLabel(labelOptions),\n          };\n\n          for (let atom of groupedOclID.atoms) {\n            labelOptions.atom = atom;\n            byAssignNumber[atom] = {\n              shift: delta,\n              diaID,\n              label: createLabel(labelOptions),\n            };\n          }\n        }\n      }\n    }\n  }\n  return { byAssignNumber, byDiaID };\n}\n\nfunction createLabel(options) {\n  const { atom, molecule, atomLabel, connections } = options;\n  let label = '';\n  if (atomLabel !== 'C') {\n    let connectedTo = connections[atom];\n    let path = connectedTo.find((e) => e && e.length > 1);\n    let pLabel = `${atomLabel}${path[0] + 1}`;\n    let hLabel = `${molecule.getAtomLabel(path[1])}${path[1] + 1}`;\n    label = `${pLabel}${hLabel}`;\n  } else {\n    label = `${atomLabel}${atom + 1}`;\n  }\n  return label;\n}\n","import jszip from 'jszip';\nimport { getGroupedDiastereotopicAtomIDs } from 'openchemlib-utils';\nimport { Molecule as OCLMolecule } from 'openchemlib/full';\n\nimport { get1DSignals } from './util/nmredata/get1DSignals';\nimport { get2DSignals } from './util/nmredata/get2DSignals';\nimport { getLabels } from './util/nmredata/getLabels';\n\nconst tags = {\n  solvent: 'SOLVENT',\n  temperature: 'TEMPERATURE',\n  assignment: 'ASSIGNMENT',\n  j: 'J',\n  signals: 'SIGNALS',\n  id: 'ID',\n};\n\nexport async function nmriumToNmredata(state, options = {}) {\n  const {\n    data, // it would be changed depending of the final location\n    molecules,\n  } = state || {\n    data: [], // it would be changed depending of the final location\n    molecules: [],\n  };\n\n  let nmrRecord = new jszip();\n\n  for (const molecule of molecules) {\n    await addNMReDATA(data, nmrRecord, {\n      ...options,\n      molecule,\n    });\n  }\n\n  if (!molecules.length) await addNMReDATA(data, nmrRecord, options);\n  return nmrRecord;\n}\n\ninterface AddNMReDATAOptions {\n  id?: string;\n  prefix?: string;\n  filename?: string;\n  molecule?: any;\n}\n\nasync function addNMReDATA(data, nmrRecord, options: AddNMReDATAOptions = {}) {\n  let {\n    id,\n    prefix = '\\n> <NMREDATA_',\n    filename = 'nmredata',\n    molecule,\n  } = options;\n\n  let sdfResult = '';\n\n  let groupedDiaIDs;\n  if (molecule) {\n    molecule = OCLMolecule.fromMolfile(molecule.molfile);\n    sdfResult += molecule.toMolfile();\n    molecule.addImplicitHydrogens();\n    groupedDiaIDs = getGroupedDiastereotopicAtomIDs(molecule);\n  }\n\n  let labels: { byDiaID: any; byAssignNumber: any } = molecule\n    ? getLabels(data, { groupedDiaIDs, molecule })\n    : { byDiaID: undefined, byAssignNumber: undefined };\n\n  sdfResult += `${prefix}VERSION>\\n1.1\\\\\\n`;\n  sdfResult += putTag(data, 'temperature', { prefix });\n  sdfResult += putTag(data, 'solvent', { prefix });\n\n  if (id) sdfResult += `${prefix + tags.id}>\\nid\\\\\\n`;\n  sdfResult += formatAssignments(labels.byDiaID, { prefix });\n  sdfResult += await get1DSignals(data, nmrRecord, { prefix, labels });\n  sdfResult += await get2DSignals(data, nmrRecord, { prefix, labels });\n  sdfResult += '\\n$$$$\\n';\n  nmrRecord.file(`${filename}.sdf`, sdfResult);\n}\n\nfunction formatAssignments(labels, options) {\n  if (!labels) return '';\n  const { prefix } = options;\n  let str = `${prefix + tags.assignment}>\\n`;\n  for (let l in labels) {\n    let atoms = labels[l].atoms;\n    str += `${labels[l].label}, ${labels[l].shift}`; // change to add label\n    for (let atom of atoms) str += `, ${atom}`;\n    str += '\\\\\\n';\n  }\n  return str;\n}\n\nfunction putTag(spectra, tag, options: { prefix?: string } = { prefix: '' }) {\n  const { prefix } = options;\n  let str = '';\n  for (let spectrum of spectra) {\n    if (spectrum.info[tag]) {\n      str += `${prefix + tags[tag]}>\\n${String(spectrum.info[tag])}\\\\\\n`;\n      break;\n    }\n  }\n  return str;\n}\n","import { useCallback } from 'react';\n\nimport { toJSON } from '../../data/SpectraManager';\nimport { useChartData } from '../context/ChartContext';\nimport { useGlobal } from '../context/GlobalContext';\nimport { useAlert } from '../elements/popup/Alert';\nimport { positions, useModal } from '../elements/popup/Modal';\nimport SaveAsModal from '../modal/SaveAsModal';\nimport {\n  copyPNGToClipboard,\n  exportAsJSON,\n  exportAsNMRE,\n  exportAsPng,\n  exportAsSVG,\n} from '../utility/Export';\nimport { nmriumToNmredata } from '../utility/nmriumToNmredata';\n\nexport default function useExport() {\n  const { rootRef } = useGlobal();\n  const modal = useModal();\n  const alert = useAlert();\n  const state = useChartData();\n\n  const saveToClipboardHandler = useCallback(async () => {\n    if (state.data.length > 0 && rootRef) {\n      const hideLoading = await alert.showLoading(\n        'Exporting as NMRium process in progress',\n      );\n      setTimeout(() => {\n        copyPNGToClipboard(rootRef, 'nmrSVG');\n        hideLoading();\n        alert.success('Image copied to clipboard');\n      }, 0);\n    }\n  }, [rootRef, alert, state]);\n\n  const saveAsJSONHandler = useCallback(\n    async (spaceIndent = 0, isCompressed = true) => {\n      if (state.data.length > 0) {\n        const hideLoading = await alert.showLoading(\n          'Exporting as NMRium process in progress',\n        );\n\n        setTimeout(() => {\n          async function handle() {\n            //exported file name by default will be the first spectrum name\n            const fileName = state.data[0]?.display?.name;\n            const exportedData = toJSON(state);\n            await exportAsJSON(\n              exportedData,\n              fileName,\n              spaceIndent,\n              isCompressed,\n            );\n            hideLoading();\n          }\n\n          void handle();\n        }, 0);\n      }\n    },\n    [alert, state],\n  );\n\n  const saveAsNMREHandler = useCallback(async () => {\n    if (state.data.length > 0) {\n      const hideLoading = await alert.showLoading(\n        'Exporting as NMRE process in progress',\n      );\n      setTimeout(() => {\n        async function handle() {\n          const fileName = state.data[0]?.display?.name;\n          const exportedData = await nmriumToNmredata(state);\n          exportAsNMRE(exportedData, fileName);\n          hideLoading();\n        }\n\n        void handle();\n      }, 0);\n    }\n  }, [alert, state]);\n\n  const saveAsSVGHandler = useCallback(async () => {\n    if (state.data.length > 0 && rootRef) {\n      const hideLoading = await alert.showLoading(\n        'Exporting as SVG process in progress',\n      );\n      setTimeout(() => {\n        const fileName = state.data[0]?.display?.name;\n        exportAsSVG(rootRef, 'nmrSVG', fileName);\n        hideLoading();\n      }, 0);\n    }\n  }, [rootRef, alert, state.data]);\n\n  const saveAsPNGHandler = useCallback(async () => {\n    if (state.data.length > 0 && rootRef) {\n      const hideLoading = await alert.showLoading(\n        'Exporting as PNG process in progress',\n      );\n      setTimeout(() => {\n        const fileName = state.data[0]?.display?.name;\n        exportAsPng(rootRef, 'nmrSVG', fileName);\n        hideLoading();\n      }, 0);\n    }\n  }, [rootRef, alert, state.data]);\n\n  const saveHandler = useCallback(\n    (options) => {\n      async function handler() {\n        const { name, pretty, compressed, dataExportOption } = options;\n        const hideLoading = await alert.showLoading(\n          `Exporting as ${name}.nmrium process in progress`,\n        );\n        setTimeout(() => {\n          void (async () => {\n            const exportedData = toJSON(state, dataExportOption);\n            const spaceIndent = pretty ? 2 : 0;\n            await exportAsJSON(exportedData, name, spaceIndent, compressed);\n            hideLoading();\n          })();\n        }, 0);\n      }\n\n      void handler();\n    },\n    [alert, state],\n  );\n  const saveAsHandler = useCallback(async () => {\n    if (state.data.length > 0) {\n      const fileName = state.data[0]?.display?.name;\n      modal.show(<SaveAsModal name={fileName} onSave={saveHandler} />, {\n        isBackgroundBlur: false,\n        position: positions.TOP_CENTER,\n        width: 400,\n      });\n    }\n  }, [modal, saveHandler, state.data]);\n\n  return {\n    saveToClipboardHandler,\n    saveAsJSONHandler,\n    saveAsNMREHandler,\n    saveAsSVGHandler,\n    saveAsPNGHandler,\n    saveAsHandler,\n  };\n}\n","import lodashGet from 'lodash/get';\n\nimport { usePreferences } from '../context/PreferencesContext';\n\nexport default function useCheckExperimentalFeature(): boolean {\n  const preferences = usePreferences();\n  const value = lodashGet(\n    preferences.current,\n    'display.general.experimentalFeatures',\n    false,\n  );\n\n  if (value?.hidden === true || value?.display === false) {\n    return false;\n  }\n\n  return true;\n}\n","import { CSSProperties, InputHTMLAttributes, ReactNode } from 'react';\n\nimport ToolTip from './ToolTip/ToolTip';\n\ninterface ButtonToolTipProps\n  extends Omit<InputHTMLAttributes<HTMLButtonElement>, 'type'> {\n  popupTitle?: string;\n  popupPlacement?: string;\n  style?: CSSProperties;\n  children?: ReactNode;\n}\n\nfunction ButtonToolTip({\n  children,\n  style = {},\n  onClick = () => null,\n  popupTitle = '',\n  popupPlacement = 'right',\n  ...props\n}: ButtonToolTipProps) {\n  return (\n    <ToolTip title={popupTitle} popupPlacement={popupPlacement}>\n      <button style={style} type=\"button\" onClick={onClick} {...props}>\n        {children}\n      </button>\n    </ToolTip>\n  );\n}\n\nexport default ButtonToolTip;\n","import { css } from '@emotion/react';\n\nexport const tablePanelStyle = css`\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  width: 100%;\n\n  .inner-container {\n    height: 100%;\n    overflow: hidden;\n    isolation: isolate;\n  }\n\n  .table-container {\n    overflow: auto;\n    height: 100%;\n    display: block;\n    background-color: white;\n  }\n`;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { CSSProperties, memo, ReactNode, useCallback, useState } from 'react';\n\nimport ToolTip from './ToolTip/ToolTip';\n\nconst styles = css`\n  background-color: #f5f5f5;\n  border: none;\n  border-radius: 5px;\n\n  &:hover {\n    background-color: lightgray !important;\n    color: black !important;\n  }\n\n  &.toggle-active {\n    background-color: gray;\n    color: white;\n  }\n`;\n\ninterface ToggleButtonProps {\n  popupTitle: string;\n  popupPlacement: string;\n  style?: CSSProperties;\n  defaultValue?: boolean;\n  onClick: (element: boolean) => void;\n  disabled?: boolean;\n  children: ReactNode;\n  className?: string;\n}\n\nfunction ToggleButton({\n  children,\n  style = {},\n  onClick = () => null,\n  popupTitle = '',\n  popupPlacement = 'right',\n  defaultValue = false,\n  disabled = false,\n  className = '',\n}: ToggleButtonProps) {\n  const [flag, Toggle] = useState<boolean>(defaultValue);\n\n  const toggleHandler = useCallback(() => {\n    onClick(!flag);\n\n    Toggle(!flag);\n  }, [onClick, flag]);\n  return (\n    <ToolTip title={popupTitle} popupPlacement={popupPlacement}>\n      <button\n        disabled={disabled}\n        css={styles}\n        style={style}\n        className={(flag ? 'toggle toggle-active ' : 'toggle ') + className}\n        type=\"button\"\n        onClick={toggleHandler}\n      >\n        {children}\n      </button>\n    </ToolTip>\n  );\n}\n\nexport default memo(ToggleButton);\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { CSSProperties, memo, ReactNode } from 'react';\nimport { FaRegTrashAlt, FaCog, FaFilter } from 'react-icons/fa';\n\nimport ToggleButton from '../../elements/ToggleButton';\nimport ToolTip from '../../elements/ToolTip/ToolTip';\n\nconst styles = css`\n  display: flex;\n  flex-direction: row;\n  border-bottom: 0.55px solid rgb(240, 240, 240);\n  padding: 0px 5px;\n\n  .left-container {\n    display: flex;\n    flex-direction: row;\n    flex: 1;\n  }\n  button {\n    background-color: transparent;\n    border: none;\n    padding: 5px;\n  }\n\n  button:disabled {\n    opacity: 0.6;\n  }\n\n  .counter-label {\n    margin: 0;\n    text-align: right;\n    line-height: 22px;\n    padding: 0px 10px;\n    white-space: nowrap;\n  }\n`;\n\ninterface DefaultPanelHeaderProps {\n  counter?: number;\n  counterFiltered?: number;\n  deleteToolTip?: string;\n  filterToolTip?: string;\n  onDelete?: () => void;\n  onFilter?: () => void;\n  onSettingClick?: () => void;\n  filterIsActive?: boolean;\n  canDelete?: boolean;\n  showSettingButton?: boolean;\n  showCounter?: boolean;\n  children?: ReactNode;\n  style?: CSSProperties;\n  className?: string;\n}\n\nfunction DefaultPanelHeader({\n  counter,\n  onDelete = () => null,\n  deleteToolTip = 'Delete',\n  onFilter = () => null,\n  filterToolTip = '',\n  filterIsActive = false,\n  counterFiltered = 0,\n  children,\n  onSettingClick = () => null,\n  showSettingButton = false,\n  canDelete = true,\n  style = {},\n  className = '',\n}: DefaultPanelHeaderProps) {\n  return (\n    <div css={styles} {...{ style, className }}>\n      <div className=\"left-container\">\n        {canDelete && (\n          <ToolTip title={deleteToolTip} popupPlacement=\"right\">\n            <button type=\"button\" onClick={onDelete} disabled={counter === 0}>\n              <FaRegTrashAlt />\n            </button>\n          </ToolTip>\n        )}\n\n        {/* Optional if there is no filter needed, e.g. in spectra panel */}\n        {filterToolTip ? (\n          <ToggleButton\n            popupTitle={filterToolTip}\n            popupPlacement=\"right\"\n            onClick={onFilter}\n            defaultValue={filterIsActive}\n          >\n            <FaFilter style={{ pointerEvents: 'none', fontSize: '12px' }} />\n          </ToggleButton>\n        ) : null}\n\n        {children}\n      </div>\n      {counter !== undefined && (\n        <p className=\"counter-label\">\n          [{' '}\n          {filterIsActive &&\n          filterIsActive === true &&\n          counterFiltered !== undefined\n            ? `${counterFiltered}/${counter}`\n            : counter}{' '}\n          ]\n        </p>\n      )}\n      {showSettingButton && (\n        <ToolTip title=\"preferences\" popupPlacement=\"left\">\n          <button type=\"button\" onClick={onSettingClick}>\n            <FaCog />\n          </button>\n        </ToolTip>\n      )}\n    </div>\n  );\n}\n\nexport default memo(DefaultPanelHeader);\n","import lodashGet from 'lodash/get';\n\nimport { usePreferences } from '../context/PreferencesContext';\n\nexport function useCheckToolsVisibility(): (toolKey: string) => boolean {\n  const preferences = usePreferences();\n\n  return (toolKey) =>\n    lodashGet(preferences.current, `display.toolBarButtons.${toolKey}`, true);\n}\n","import { SvgNmrRangePicking } from 'cheminfo-font';\nimport { useCallback } from 'react';\n\nimport { useChartData } from '../../context/ChartContext';\nimport { useDispatch } from '../../context/DispatchContext';\nimport Button from '../../elements/ButtonToolTip';\nimport { useAlert } from '../../elements/popup/Alert';\nimport { useCheckToolsVisibility } from '../../hooks/useCheckToolsVisibility';\nimport {\n  AUTO_RANGES_SPECTRA_PICKING,\n  AUTO_ZONES_SPECTRA_PICKING,\n} from '../../reducer/types/Types';\n\nexport function SpectraAutomaticPickingButton() {\n  const dispatch = useDispatch();\n  const alert = useAlert();\n  const { data } = useChartData();\n  const isToolVisible = useCheckToolsVisibility();\n\n  const automaticPickingHandler = useCallback(() => {\n    void (async () => {\n      const hideLoading = await alert.showLoading(\n        'Automatic Ranges/Zones detection for all spectra in progress',\n      );\n      setTimeout(() => {\n        dispatch({ type: AUTO_RANGES_SPECTRA_PICKING });\n        dispatch({ type: AUTO_ZONES_SPECTRA_PICKING });\n        hideLoading();\n      }, 0);\n    })();\n  }, [dispatch, alert]);\n\n  if (\n    (Array.isArray(data) && data.length === 0) ||\n    !isToolVisible('autoRangesTool')\n  ) {\n    return null;\n  }\n\n  return (\n    <Button\n      popupTitle=\"Automatic Ranges/Zones picking for all spectra\"\n      onClick={automaticPickingHandler}\n    >\n      <SvgNmrRangePicking />\n    </Button>\n  );\n}\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport {\n  useState,\n  useImperativeHandle,\n  useCallback,\n  useRef,\n  useEffect,\n  forwardRef,\n} from 'react';\nimport { createPortal } from 'react-dom';\n\nimport { useGlobal } from '../context/GlobalContext';\n\nconst styles = css`\n  box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.25);\n  padding: 0px;\n  margin: 0px;\n  border-radius: 2px;\n  display: flex;\n  flex-direction: column;\n  position: fixed;\n  z-index: 99999;\n  padding: 2px;\n  background-color: white;\n  width: 150px;\n  pointer-events: all;\n\n  button {\n    background-color: transparent;\n    border: none;\n    border-bottom: 0.55px solid #f0f0f0;\n    font-size: 11px;\n    padding: 5px;\n    text-align: left;\n    outline: none;\n  }\n  button:hover {\n    background-color: #fafafa;\n    outline: none;\n  }\n\n  button:active {\n    background-color: #eaeaea;\n    outline: none;\n  }\n\n  button:last-of-type {\n    border: none;\n  }\n`;\n\n// TODO: remove this hacky ref usage.\nfunction ContextMenu({ context }, ref: any) {\n  const [position, setPosition] = useState<{ left: any; top: any }>({\n    left: 0,\n    top: 0,\n  });\n  const { rootRef, elementsWrapperRef } = useGlobal();\n  const [data, setData] = useState();\n  const [isVisible, show] = useState<boolean>();\n  const [sourceElement, setSourceElement] = useState(null);\n  const root = useRef<any>();\n\n  useEffect(() => {\n    root.current = document.createElement('div');\n    if (elementsWrapperRef) {\n      elementsWrapperRef.appendChild(root.current);\n    }\n    return () => {\n      if (root.current && elementsWrapperRef) {\n        elementsWrapperRef.removeChild(root.current);\n      }\n    };\n  }, [elementsWrapperRef]);\n\n  const contextMenuHandler = (event) => {\n    event.preventDefault();\n    setSourceElement(event.target.parentElement);\n    show(true);\n    const clickX = event.clientX;\n    const clickY = event.clientY;\n\n    const screenW = window.innerWidth;\n    const screenH = window.innerHeight;\n    const rootW = 150;\n    const rootH = 0;\n\n    const right = screenW - clickX > rootW;\n    let left: any = !right;\n    let top: any = screenH - clickY > rootH;\n    const bottom = !top;\n    if (right) {\n      left = `${clickX + 5}px`;\n    }\n\n    if (left) {\n      left = `${clickX - rootW - 5}px`;\n    }\n\n    if (top) {\n      top = `${clickY + 5}px`;\n    }\n\n    if (bottom) {\n      top = `${clickY - rootH - 5}px`;\n    }\n\n    setPosition({ left, top });\n  };\n\n  useImperativeHandle(ref, () => ({\n    handleContextMenu: (e, _data) => {\n      setData(_data);\n      contextMenuHandler(e);\n    },\n  }));\n\n  const clickHandler = useCallback(\n    (event, click) => {\n      event.preventDefault();\n      click(data);\n      show(false);\n    },\n    [data],\n  );\n\n  useEffect(() => {\n    const _handleGlobalClick = (event) => {\n      const wasOutside =\n        sourceElement &&\n        event.target.parentElement &&\n        !event.target.parentElement.isSameNode(sourceElement);\n      if (wasOutside && isVisible) show(false);\n    };\n    if (rootRef) {\n      rootRef.addEventListener('click', _handleGlobalClick);\n    }\n    return () => {\n      if (rootRef) {\n        rootRef.removeEventListener('click', _handleGlobalClick);\n      }\n    };\n  }, [isVisible, ref, rootRef, sourceElement]);\n\n  if (!isVisible) {\n    return null;\n  }\n\n  return (\n    root.current &&\n    createPortal(\n      context && (\n        <div ref={ref} css={[styles, position]}>\n          {context.map((c, index) => (\n            <button\n              // eslint-disable-next-line react/no-array-index-key\n              key={index}\n              type=\"button\"\n              onClick={(e) => clickHandler(e, c.onClick)}\n            >\n              {c.label}\n            </button>\n          ))}\n        </div>\n      ),\n      root.current,\n    )\n  );\n}\n\nexport default forwardRef(ContextMenu);\n","import { memo } from 'react';\n\ninterface ReactTableHeaderProps {\n  headerGroups: any;\n}\n\nfunction ReactTableHeader({ headerGroups }: ReactTableHeaderProps) {\n  return (\n    <thead>\n      {headerGroups.map((headerGroup) => (\n        <tr\n          key={headerGroup.getHeaderGroupProps().key}\n          {...headerGroup.getHeaderGroupProps()}\n        >\n          {headerGroup.headers.map((column) => (\n            <th\n              key={column.getHeaderProps().key}\n              {...column.getHeaderProps(column.getSortByToggleProps())}\n              style={column.style}\n            >\n              {column.render('Header')}\n              <span>\n                {column.isSorted ? (column.isSortedDesc ? ' ▼' : ' ▲') : ''}\n              </span>\n            </th>\n          ))}\n        </tr>\n      ))}\n    </thead>\n  );\n}\n\nexport default memo(ReactTableHeader);\n","/** @jsxImportSource @emotion/react */\n\nimport { css, CSSObject } from '@emotion/react';\nimport { useMemo, forwardRef, useEffect, useCallback } from 'react';\n\nimport { HighlightedSource, useHighlight } from '../../../highlight/index';\n\nfunction highlightStyle(isActive: boolean, row): CSSObject {\n  if (isActive) {\n    return { backgroundColor: '#ff6f0057' };\n  } else if (row.original?.isConstantlyHighlighted === true) {\n    return { backgroundColor: '#f5f5dc' };\n  }\n  return {};\n}\n\nconst rowCss = css`\n  &:hover {\n    background-color: #ff6f0091 !important;\n  }\n\n  &:active {\n    background-color: #ff6f0070 !important;\n  }\n`;\n\nexport interface ClickEvent {\n  onClick?: (event: Event, data: unknown) => void;\n}\ninterface ReactTableRowProps extends ClickEvent {\n  row: any;\n  highlightedSource?: HighlightedSource;\n  onContextMenu: () => void;\n  isVisible: boolean;\n  isRowActive: boolean;\n}\n\nfunction getIDs(row: any): string[] {\n  const id = row.original.id;\n  if (id) {\n    if (id instanceof Array) {\n      return id;\n    } else {\n      return [String(id)];\n    }\n  }\n  return [''];\n}\nfunction ReactTableRow(props: ReactTableRowProps, ref) {\n  const {\n    row,\n    highlightedSource = HighlightedSource.UNKNOWN,\n    onContextMenu,\n    onClick,\n    isRowActive = false,\n  } = props;\n  const data = useMemo(\n    () => ({\n      type: highlightedSource,\n      extra: row.original,\n    }),\n    [highlightedSource, row],\n  );\n  const highlight = useHighlight(getIDs(row), data);\n\n  useEffect(() => {\n    return () => {\n      highlight.hide();\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  const clickHandler = useCallback(\n    (event: Event) => {\n      onClick?.(event, row);\n    },\n    [onClick, row],\n  );\n\n  return useMemo(() => {\n    return (\n      <tr\n        ref={ref}\n        onContextMenu={onContextMenu}\n        key={row.getRowProps().key}\n        css={[\n          highlightStyle(highlight.isActive || isRowActive, row),\n          onClick && rowCss,\n        ]}\n        {...row.getRowProps()}\n        {...highlight.onHover}\n      >\n        {row.cells.map((cell) => {\n          const { style, padding } = cell.column;\n\n          if (cell.isRowSpanned) {\n            return null;\n          } else {\n            return (\n              <td\n                rowSpan={cell.rowSpan}\n                key={cell.key}\n                {...cell.getCellProps()}\n                onContextMenu={(e) => {\n                  e.preventDefault();\n\n                  return false;\n                }}\n                style={{ padding, ...style }}\n                onClick={clickHandler}\n              >\n                {cell.render('Cell')}\n              </td>\n            );\n          }\n        })}\n      </tr>\n    );\n  }, [\n    clickHandler,\n    highlight.isActive,\n    highlight.onHover,\n    onClick,\n    onContextMenu,\n    ref,\n    row,\n  ]);\n}\n\nexport default forwardRef(ReactTableRow);\n","import { css } from '@emotion/react';\n\nconst ReactTableStyle = css`\n  border-spacing: 0;\n  border: 1px solid #dedede;\n  width: 100%;\n  max-height: 100%;\n  font-size: 12px;\n\n  .react-contextmenu-wrapper {\n    display: contents;\n  }\n\n  tr {\n    :last-child {\n      td {\n        border-bottom: 0;\n      }\n    }\n  }\n\n  th {\n    position: sticky;\n    background-color: white;\n    z-index: 0;\n    top: 0;\n  }\n  th,\n  td {\n    margin: 0;\n    padding: 0.15rem 0.4rem;\n    border-bottom: 1px solid #dedede;\n    border-right: 1px solid #dedede;\n\n    // :last-child {\n    //   border-right: 0;\n    // }\n    button {\n      background-color: transparent;\n      border: none;\n    }\n  }\n`;\n\nexport { ReactTableStyle };\n","import { createContext, useContext } from 'react';\n\nimport { TableVirtualConfig } from '../ReactTable';\n\nconst reactContext = createContext<TableVirtualConfig | null>(null);\nexport const ReactTableProvider = reactContext.Provider;\n\nexport function useReactTableContext() {\n  const context = useContext(reactContext);\n  if (!context) {\n    throw new Error('react table context was not found ');\n  }\n  return context;\n}\n","export default function useRowSpan(hooks) {\n  hooks.useInstance.push(reducer);\n}\n\nfunction reducer(instance) {\n  const { allColumns } = instance;\n\n  let rowSpanHeaders: any[] = [];\n\n  allColumns.forEach((column) => {\n    const { id, enableRowSpan } = column;\n\n    if (enableRowSpan !== undefined && enableRowSpan !== false) {\n      rowSpanHeaders.push({ id, cellValue: null, cellIndex: 0 });\n    }\n  });\n\n  Object.assign(instance, {\n    rowSpanHeaders,\n  });\n}\n\nexport function prepareRowSpan(rows, index, rowSpanHeaders, groupKey?: string) {\n  const row = rows[index];\n  for (let j = 0; j < row.allCells.length; j++) {\n    const cell = row.allCells[j];\n    const rowSpanHeader = rowSpanHeaders.find((x) => x.id === cell.column.id);\n    if (rowSpanHeader !== undefined) {\n      const cellValue = groupKey\n        ? `${cell.value}-${row.original[groupKey]}`\n        : cell.value;\n\n      if (\n        rowSpanHeader.cellValue === null ||\n        rowSpanHeader.cellValue !== cellValue\n      ) {\n        cell.isRowSpanned = false;\n        rowSpanHeader.cellValue = cellValue;\n        rowSpanHeader.cellIndex = index;\n        cell.rowSpan = 1;\n      } else {\n        rows[rowSpanHeader.cellIndex].allCells[j].rowSpan++;\n        cell.isRowSpanned = true;\n      }\n    }\n  }\n}\n","/** @jsxImportSource @emotion/react */\nimport {\n  useRef,\n  useCallback,\n  memo,\n  forwardRef,\n  useState,\n  Ref,\n  useEffect,\n  UIEvent,\n} from 'react';\nimport { useTable, useSortBy } from 'react-table';\nimport { useMeasure } from 'react-use';\n\nimport checkModifierKeyActivated from '../../../data/utilities/checkModifierKeyActivated';\nimport { HighlightedSource } from '../../highlight';\nimport useCombinedRefs from '../../hooks/useCombinedRefs';\nimport ContextMenu from '../ContextMenu';\n\nimport ReactTableHeader from './Elements/ReactTableHeader';\nimport ReactTableRow, { ClickEvent } from './Elements/ReactTableRow';\nimport { ReactTableStyle } from './Style';\nimport {\n  ReactTableProvider,\n  useReactTableContext,\n} from './utility/ReactTableContext';\nimport useRowSpan, { prepareRowSpan } from './utility/useRowSpan';\n\ninterface ReactTableProps extends ClickEvent {\n  data: any;\n  columns: any;\n  highlightedSource?: HighlightedSource;\n  context?: Array<{ label: string; onClick: () => void }> | null;\n  approxItemHeight?: number;\n  groupKey?: string;\n  enableVirtualScroll?: boolean;\n  highlightActiveRow?: boolean;\n}\n\ninterface ReactTableInnerProps extends ReactTableProps {\n  onScroll: (event: UIEvent<HTMLDivElement>) => void;\n}\n\nconst styles = {\n  table: (enableVirtualScroll: boolean) => {\n    if (enableVirtualScroll) {\n      return { position: 'sticky', top: 0 };\n    }\n  },\n};\n\nconst ReactTableInner = forwardRef(function ReactTableInner(\n  props: ReactTableInnerProps,\n  ref: Ref<HTMLDivElement>,\n) {\n  const {\n    data,\n    columns,\n    highlightedSource,\n    context = null,\n    onScroll,\n    approxItemHeight = 40,\n    enableVirtualScroll = false,\n    groupKey,\n    onClick,\n    highlightActiveRow = false,\n  } = props;\n\n  const contextRef = useRef<any>(null);\n  const { index: indexBoundary } = useReactTableContext();\n  const [rowIndex, setRowIndex] = useState<number>();\n\n  const {\n    getTableProps,\n    getTableBodyProps,\n    headerGroups,\n    rows,\n    prepareRow,\n    rowSpanHeaders,\n  } = useTable(\n    {\n      columns,\n      data,\n    },\n    useSortBy,\n    useRowSpan,\n  );\n  const contextMenuHandler = useCallback(\n    (e, row) => {\n      if (!checkModifierKeyActivated(e)) {\n        e.preventDefault();\n        contextRef.current.handleContextMenu(e, row.original);\n      }\n    },\n    [contextRef],\n  );\n\n  const rowsData = enableVirtualScroll\n    ? rows.slice(indexBoundary.start, indexBoundary.end)\n    : rows;\n\n  const clickHandler = useCallback(\n    (event, row) => {\n      setRowIndex(row.index);\n      onClick?.(event, row);\n    },\n    [onClick],\n  );\n\n  return (\n    <div\n      ref={ref}\n      className=\"table-container\"\n      style={{\n        overflowY: 'auto',\n        position: 'relative',\n        height: '100%',\n      }}\n      {...(enableVirtualScroll && { onScroll })}\n    >\n      {enableVirtualScroll && (\n        <div\n          style={{\n            height: approxItemHeight * data.length,\n            position: 'absolute',\n            width: '100%',\n            pointerEvents: 'none',\n          }}\n        />\n      )}\n      <table\n        {...getTableProps()}\n        css={ReactTableStyle}\n        style={styles.table(enableVirtualScroll)}\n      >\n        <ReactTableHeader headerGroups={headerGroups} />\n        <tbody {...getTableBodyProps()}>\n          {rowsData.map((row, index) => {\n            prepareRow(row);\n            prepareRowSpan(\n              rows,\n              enableVirtualScroll ? index + indexBoundary.start : index,\n              rowSpanHeaders,\n              groupKey,\n            );\n\n            return (\n              <ReactTableRow\n                key={row.key}\n                row={row}\n                {...row.getRowProps()}\n                onContextMenu={(e) => contextMenuHandler(e, row)}\n                onClick={highlightActiveRow ? clickHandler : onClick}\n                highlightedSource={highlightedSource}\n                isRowActive={rowIndex === index}\n              />\n            );\n          })}\n        </tbody>\n      </table>\n      <ContextMenu ref={contextRef} context={context} />\n    </div>\n  );\n});\n\nexport interface TableVirtualConfig {\n  offsetHeight: number;\n  scrollHeight: number;\n  numberOfVisibleRows: number;\n  index: { start: number; end: number };\n}\n\nfunction ReactTable(props: ReactTableProps) {\n  const { data, approxItemHeight = 40, groupKey } = props;\n  const ref = useRef<HTMLDivElement | null>(null);\n  const [mRef, { height }] = useMeasure();\n  const combineRef = useCombinedRefs([mRef, ref]);\n\n  const [tableVirtualConfig, setTableVirtualConfig] =\n    useState<TableVirtualConfig>({\n      offsetHeight: 0,\n      scrollHeight: 0,\n      numberOfVisibleRows: 0,\n      index: { start: 0, end: 0 },\n    });\n\n  useEffect(() => {\n    if (combineRef.current) {\n      const { scrollHeight } = combineRef.current;\n      const numberOfVisibleRows = Math.ceil(height / approxItemHeight);\n      setTableVirtualConfig((prev) => ({\n        ...prev,\n        offsetHeight: height,\n        scrollHeight,\n        numberOfVisibleRows,\n        index: { start: 0, end: numberOfVisibleRows + 1 },\n      }));\n    }\n  }, [approxItemHeight, combineRef, height]);\n\n  const lookForGroupIndex = useCallback(\n    (currentIndex: number, side: 1 | -1) => {\n      const currentItem = data[currentIndex];\n      if (currentItem.index && groupKey) {\n        switch (side) {\n          case -1: {\n            let index = currentIndex - 1;\n            while (index > 0) {\n              if (data[index][groupKey] !== currentItem[groupKey]) {\n                return index + 1;\n              }\n              index--;\n            }\n            return currentIndex;\n          }\n          case 1: {\n            let index = currentIndex + 1;\n            while (index < data.length) {\n              if (data[index][groupKey] !== currentItem[groupKey]) {\n                return index - 1;\n              }\n              index++;\n            }\n            return currentIndex;\n          }\n          default:\n            return currentIndex;\n        }\n      }\n\n      return currentIndex;\n    },\n    [data, groupKey],\n  );\n\n  const findStartIndex = useCallback(\n    (index: number, numberOfVisibleRows: number) => {\n      const newIndex = index - numberOfVisibleRows;\n      const currentIndx = newIndex >= data.length ? newIndex : index;\n      // return currentIndx;\n      // Look for the first index of the group\n      return lookForGroupIndex(currentIndx, -1);\n    },\n    [data.length, lookForGroupIndex],\n  );\n  const findEndIndex = useCallback(\n    (index: number, numberOfVisibleRows: number) => {\n      const newIndex = index + numberOfVisibleRows;\n      const currentIndx = newIndex >= data.length ? data.length - 1 : newIndex;\n      // return currentIndx;\n      // Look for the last index of the group\n      return lookForGroupIndex(currentIndx, 1);\n    },\n    [data.length, lookForGroupIndex],\n  );\n\n  const scrollHandler = useCallback(() => {\n    if (ref.current && tableVirtualConfig) {\n      const { scrollTop } = ref.current;\n      const { numberOfVisibleRows, index } = tableVirtualConfig;\n      const currentIndx = Math.ceil(scrollTop / approxItemHeight);\n      const start = findStartIndex(currentIndx, numberOfVisibleRows);\n\n      if (currentIndx !== index.start) {\n        const end = findEndIndex(currentIndx, numberOfVisibleRows);\n        setTableVirtualConfig({\n          ...tableVirtualConfig,\n          index: { start, end: end + 1 },\n        });\n      }\n    }\n  }, [approxItemHeight, findEndIndex, findStartIndex, tableVirtualConfig]);\n\n  return (\n    <ReactTableProvider value={tableVirtualConfig}>\n      <ReactTableInner\n        onScroll={scrollHandler}\n        ref={combineRef}\n        {...{ ...props }}\n      />\n    </ReactTableProvider>\n  );\n}\n\nexport default memo(ReactTable);\n","import { CSSProperties } from 'react';\n\nconst styles: Record<'label' | 'container', CSSProperties> = {\n  container: {\n    height: '100%',\n    backgroundColor: 'white',\n  },\n  label: {\n    textAlign: 'center',\n    width: '100%',\n    fontSize: '11px',\n    padding: '5px',\n    color: 'gray',\n  },\n};\n\n// placeholder for empty tables if no data is available to show (e.g. peaks, integrals, ranges)\nfunction NoTableData({ text = 'No Data' }) {\n  return (\n    <div style={styles.container}>\n      <p style={styles.label}>{text}</p>\n    </div>\n  );\n}\n\nexport default NoTableData;\n","import { SvgNmrAssignment } from 'cheminfo-font';\nimport { useCallback, useMemo, memo } from 'react';\n\nimport { useDispatch } from '../../context/DispatchContext';\nimport ReactTable from '../../elements/ReactTable/ReactTable';\nimport { CustomColumn } from '../../elements/ReactTable/utility/addCustomColumn';\nimport { SET_AUTOMATIC_ASSIGNMENTS } from '../../reducer/types/Types';\nimport NoTableData from '../extra/placeholder/NoTableData';\n\nimport { AutoAssignmentsData } from './useAutoAssignments';\n\ninterface AutomaticAssignmentTableProps {\n  data: AutoAssignmentsData[];\n}\n\nfunction AutomaticAssignmentTable({ data }: AutomaticAssignmentTableProps) {\n  const dispatch = useDispatch();\n\n  const assignHandler = useCallback(\n    (e, row) => {\n      e.preventDefault();\n      e.stopPropagation();\n      const assignments = row.original.assignment;\n      dispatch({\n        type: SET_AUTOMATIC_ASSIGNMENTS,\n        payload: { assignments },\n      });\n    },\n    [dispatch],\n  );\n\n  const COLUMNS: CustomColumn[] = useMemo(\n    () => [\n      {\n        index: 1,\n        Header: '#',\n        Cell: ({ row }) => row.index + 1,\n        style: { width: '1%', maxWidth: '40px', minWidth: '40px' },\n      },\n      {\n        index: 2,\n        Header: 'Score',\n        accessor: 'score',\n      },\n      {\n        index: 3,\n        Header: '',\n        style: {\n          width: '1%',\n          maxWidth: '24px',\n          minWidth: '24px',\n        },\n        id: 'assign-button',\n        Cell: ({ row }) => (\n          <button\n            type=\"button\"\n            className=\"assign-button\"\n            onClick={(e) => assignHandler(e, row)}\n          >\n            <SvgNmrAssignment />\n          </button>\n        ),\n      },\n    ],\n    [assignHandler],\n  );\n\n  return data && data.length > 0 ? (\n    <ReactTable\n      data={data}\n      columns={COLUMNS}\n      onClick={assignHandler}\n      highlightActiveRow\n    />\n  ) : (\n    <NoTableData />\n  );\n}\n\nexport default memo(AutomaticAssignmentTable);\n","import {\n  getAssignments as getAssignmentsData,\n  SpectraData,\n  SpectraData1D,\n  SpectraData2D,\n} from 'nmr-processing';\nimport OCL from 'openchemlib/full';\nimport { useCallback, useMemo, useRef, useState } from 'react';\n\nimport { Datum1D } from '../../../data/types/data1d';\nimport { Datum2D } from '../../../data/types/data2d/Datum2D';\nimport { useChartData } from '../../context/ChartContext';\nimport { useDispatch } from '../../context/DispatchContext';\nimport { useAlert } from '../../elements/popup/Alert';\nimport { SET_AUTOMATIC_ASSIGNMENTS } from '../../reducer/types/Types';\n\nexport interface AutoAssignmentsData {\n  score: number;\n  assignment: (SpectraData1D | SpectraData2D)[];\n}\n\nfunction mapSpectra(data: (Datum1D | Datum2D)[]) {\n  return data.reduce<SpectraData[]>((acc, spectrum) => {\n    const { id, info } = spectrum;\n    const dimension = spectrum.info.dimension;\n    if (dimension === 1) {\n      const ranges = (spectrum as Datum1D).ranges.values;\n      acc.push({ id, info, ranges });\n    } else if (dimension === 2) {\n      const zones = (spectrum as Datum2D).zones.values;\n      acc.push({ id, info, zones });\n    }\n    return acc;\n  }, []);\n}\n\nexport function useAutoAssignments() {\n  const dispatch = useDispatch();\n  const { data, molecules } = useChartData();\n  const originData = useRef<SpectraData[]>();\n  const alert = useAlert();\n  const [assignments, setAssignments] = useState<AutoAssignmentsData[]>([]);\n\n  const restAssignments = useCallback(() => {\n    dispatch({\n      type: SET_AUTOMATIC_ASSIGNMENTS,\n      payload: { assignments: originData.current },\n    });\n  }, [dispatch]);\n\n  const getAssignments = useCallback(() => {\n    void (async () => {\n      const hideLoading = await alert.showLoading('Auto Assignments');\n      const molecule = OCL.Molecule.fromMolfile(molecules[0]?.molfile || '');\n      const spectra = mapSpectra(data);\n\n      if (!originData.current) {\n        originData.current = spectra;\n      }\n\n      const result = await getAssignmentsData(\n        {\n          spectra,\n          molecule,\n        },\n        { minScore: 0 },\n      );\n\n      if (result[0]?.assignment) {\n        dispatch({\n          type: SET_AUTOMATIC_ASSIGNMENTS,\n          payload: { assignments: result[0].assignment },\n        });\n      } else {\n        alert.error(\n          'Could not assign molecule, please check that all the ranges are defined correctly',\n        );\n      }\n\n      setAssignments(result);\n      hideLoading();\n    })();\n  }, [alert, data, dispatch, molecules]);\n\n  return useMemo(\n    () => ({\n      getAssignments,\n      assignments,\n      restAssignments,\n    }),\n\n    [assignments, getAssignments, restAssignments],\n  );\n}\n","/** @jsxImportSource @emotion/react */\nimport { SvgNmrAssignment2 } from 'cheminfo-font';\nimport { FaBolt } from 'react-icons/fa';\n\nimport Button from '../../elements/ButtonToolTip';\nimport { tablePanelStyle } from '../extra/BasicPanelStyle';\nimport DefaultPanelHeader from '../header/DefaultPanelHeader';\nimport { SpectraAutomaticPickingButton } from '../header/SpectraAutomaticPickingButton';\n\nimport AutomaticAssignmentTable from './AutomaticAssignmentTable';\nimport { useAutoAssignments } from './useAutoAssignments';\n\nfunction AutomaticAssignment() {\n  const { getAssignments, assignments, restAssignments } = useAutoAssignments();\n  return (\n    <div css={tablePanelStyle}>\n      {\n        <DefaultPanelHeader showSettingButton={false} canDelete={false}>\n          <SpectraAutomaticPickingButton />\n          <Button popupTitle=\"automatic assignment\" onClick={getAssignments}>\n            <SvgNmrAssignment2 style={{ fontSize: '18px' }} />\n          </Button>\n          <Button popupTitle=\"reset assignment\" onClick={restAssignments}>\n            <FaBolt />\n          </Button>\n        </DefaultPanelHeader>\n      }\n\n      <div className=\"inner-container\">\n        <AutomaticAssignmentTable data={assignments} />\n      </div>\n    </div>\n  );\n}\n\nexport default AutomaticAssignment;\n","/** @jsxImportSource @emotion/react */\n\nimport { memo } from 'react';\nimport { useTable, useSortBy, useFlexLayout } from 'react-table';\n\nimport { ReactTableStyle } from './Style';\n\ninterface ReactTableFlexLayoutProps {\n  data: any;\n  columns: any;\n  onMouseDown?: () => void;\n}\n\nfunction ReactTableFlexLayout({\n  data,\n  columns,\n  onMouseDown = () => null,\n}: ReactTableFlexLayoutProps) {\n  const { getTableProps, getTableBodyProps, headerGroups, rows, prepareRow } =\n    useTable(\n      {\n        columns,\n        data,\n      },\n      useSortBy,\n      useFlexLayout,\n    );\n  return (\n    <table\n      {...getTableProps()}\n      css={ReactTableStyle}\n      style={{ height: '100%' }}\n    >\n      <thead>\n        {headerGroups.map((headerGroup) => (\n          <tr\n            key={headerGroup.getHeaderGroupProps().key}\n            {...headerGroup.getHeaderGroupProps()}\n          >\n            {headerGroup.headers.map((column) => (\n              <th\n                key={column.getHeaderProps().key}\n                {...column.getHeaderProps(column.getSortByToggleProps())}\n              >\n                {column.render('Header')}\n                <span>\n                  {column.isSorted ? (column.isSortedDesc ? ' ▼' : ' ▲') : ''}\n                </span>\n              </th>\n            ))}\n          </tr>\n        ))}\n      </thead>\n      <tbody\n        {...getTableBodyProps()}\n        style={{ display: 'block', height: '100%', overflowY: 'auto' }}\n      >\n        {rows.map((row) => {\n          prepareRow(row);\n          return (\n            <tr\n              key={row.getRowProps().key}\n              {...row.getRowProps()}\n              onMouseDown={onMouseDown}\n            >\n              {row.cells.map((cell) => {\n                return (\n                  <td\n                    key={cell.getCellProps().key}\n                    {...cell.getCellProps()}\n                    style={{ ...cell.getCellProps().style, padding: '0px' }}\n                  >\n                    {cell.render('Cell')}\n                  </td>\n                );\n              })}\n            </tr>\n          );\n        })}\n      </tbody>\n    </table>\n  );\n}\n\nexport default memo(ReactTableFlexLayout);\n","import {\n  useState,\n  useCallback,\n  useEffect,\n  memo,\n  useMemo,\n  useRef,\n  CSSProperties,\n} from 'react';\n\nimport ReactTableFlexLayout from '../elements/ReactTable/ReactTableFlexLayout';\nimport useSpectrum from '../hooks/useSpectrum';\n\nconst styles: Record<\n  'container' | 'tableContainer' | 'searchInput',\n  CSSProperties\n> = {\n  container: {\n    height: '100%',\n    flexDirection: 'column',\n    display: 'flex',\n    width: '100%',\n  },\n  tableContainer: {\n    height: 'calc(100% - 30px)',\n    overflow: 'auto',\n    display: 'block',\n  },\n\n  searchInput: {\n    width: '100%',\n    borderRadius: '5px',\n    border: '0.55px solid gray',\n    padding: '5px',\n    marginBottom: '2px',\n  },\n};\n\ninterface InformationPanelInnerProps {\n  info: any;\n  meta: any;\n}\n\nfunction InformationPanelInner({ info, meta }: InformationPanelInnerProps) {\n  const [information, setInformation] = useState({});\n  const [matches, setMatchesData] = useState<string[]>([]);\n  const searchRef = useRef<HTMLInputElement>(null);\n\n  const handleSearch = useCallback(\n    (e) => {\n      const values = Object.keys(information).filter((key) =>\n        key\n          .toLowerCase()\n          .includes(e.target ? e.target.value.toLowerCase() : e.toLowerCase()),\n      );\n      setMatchesData(values);\n    },\n    [information],\n  );\n\n  useEffect(() => {\n    if (searchRef.current) {\n      handleSearch(searchRef.current.value);\n    }\n  }, [handleSearch, searchRef]);\n\n  useEffect(() => {\n    if (info && meta) {\n      const keys = Object.keys(info).concat(Object.keys(meta));\n      setMatchesData(keys);\n      setInformation({\n        ...info,\n        ...meta,\n      });\n    }\n  }, [info, meta]);\n\n  const columns = useMemo(\n    () => [\n      {\n        Header: 'Parameter',\n        sortType: 'basic',\n        minWidth: 100,\n        width: 20,\n        maxWidth: 20,\n        Cell: ({ row }) => (\n          <p style={{ padding: '5px', backgroundColor: 'white' }}>\n            {row.original}\n          </p>\n        ),\n      },\n      {\n        Header: 'Value',\n        sortType: 'basic',\n        resizable: true,\n        Cell: ({ row }) => (\n          <p\n            style={{\n              backgroundColor: '#efefef',\n              height: '100%',\n              padding: '5px',\n              fontFamily: 'monospace',\n              whiteSpace: 'pre',\n              overflow: 'hidden',\n            }}\n          >\n            {`${information[row.original]}`}\n          </p>\n        ),\n      },\n    ],\n    [information],\n  );\n\n  return (\n    <div style={styles.container}>\n      <div>\n        <input\n          type=\"text\"\n          style={styles.searchInput}\n          placeholder=\"Search for parameter...\"\n          onChange={handleSearch}\n          ref={searchRef}\n        />\n      </div>\n      <div style={styles.tableContainer}>\n        <ReactTableFlexLayout data={matches} columns={columns} />\n      </div>\n    </div>\n  );\n}\n\nconst MemoizedInformationPanel = memo(InformationPanelInner);\n\nconst emptyData = { info: {}, meta: {} };\n\nexport default function InformationPanel() {\n  const { info, meta } = useSpectrum(emptyData);\n\n  return <MemoizedInformationPanel {...{ info, meta }} />;\n}\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { FaTimes } from 'react-icons/fa';\n\nconst styles = css`\n  border-radius: 50%;\n  width: 16px;\n  height: 16px;\n  background-color: transparent;\n  border: none;\n  padding: 0;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n\n  :hover {\n    background-color: red;\n    border-radius: 50%;\n\n    .icon {\n      color: white;\n    }\n  }\n\n  .icon {\n    color: #252525;\n    width: 8px;\n  }\n`;\n\ninterface DeleteButtonProps {\n  onDelete: (element: React.MouseEvent<HTMLButtonElement, MouseEvent>) => void;\n  className?: string;\n}\n\nfunction DeleteButton({ onDelete, className = 'delete' }: DeleteButtonProps) {\n  return (\n    <button css={styles} className={className} type=\"button\" onClick={onDelete}>\n      <FaTimes className=\"icon\" />\n    </button>\n  );\n}\n\nexport default DeleteButton;\n","/** @jsxImportSource @emotion/react */\nimport { css, SerializedStyles } from '@emotion/react';\nimport { CSSProperties, ReactNode, useCallback } from 'react';\n\nimport DeleteButton from './DeleteButton';\n\nconst styles = (styles) => css`\n  position: relative;\n\n  .delete {\n    position: absolute;\n    top: 2px;\n    left: 2px;\n  }\n\n  ${styles}\n`;\n\nexport interface InternalTabProps {\n  tabid: string;\n  tablabel?: string;\n  isActive: boolean;\n  tabstyles?: CSSProperties | SerializedStyles;\n  canDelete?: boolean;\n  onDelete?: (element: any) => void;\n  onClick?: (element: any) => void;\n  render?: ({\n    isActive,\n    title,\n    id,\n  }: {\n    isActive: boolean;\n    title: string;\n    id: string | number;\n  }) => any;\n}\n\n/* eslint-disable react/no-unused-prop-types */\nexport interface TabProps {\n  tabid: string;\n  tablabel?: string;\n  canDelete?: boolean;\n  onDelete?: (element: any) => void;\n  tabstyles?: CSSProperties | SerializedStyles;\n  children: ReactNode;\n  render?: () => ReactNode;\n  className?: string;\n}\n/* eslint-enable react/no-unused-prop-types */\n\nexport function InternalTab({\n  tabid,\n  tablabel,\n  isActive,\n  onClick = () => null,\n  canDelete,\n  onDelete = () => null,\n  tabstyles,\n  render,\n}: InternalTabProps) {\n  let className = 'tab-list-item';\n\n  // use tab identifier if given (higher priority)\n  if (isActive) {\n    className += ' tab-list-active';\n  }\n\n  const clickHandler = useCallback(\n    (e) => {\n      onClick({ ...e, tablabel, tabid });\n    },\n    [onClick, tablabel, tabid],\n  );\n\n  const deleteHandler = useCallback(\n    (e) => {\n      // stop propagation here to not have set it\n      // as active tab too (via tab click event triggering)\n      e.stopPropagation();\n      onDelete({ ...e, tablabel, tabid });\n    },\n    [onDelete, tablabel, tabid],\n  );\n\n  return (\n    <li\n      className={className}\n      onClick={clickHandler}\n      css={styles(tabstyles)}\n      data-test-id={`tab-${tabid}`}\n    >\n      {canDelete && <DeleteButton onDelete={deleteHandler} />}\n      {render\n        ? render({ isActive, title: tablabel || '', id: tabid })\n        : tablabel}\n    </li>\n  );\n}\n\nexport default function Tab(props: TabProps) {\n  return <>{props.children}</>;\n}\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport {\n  isValidElement,\n  useCallback,\n  useMemo,\n  Children,\n  memo,\n  ReactElement,\n} from 'react';\n\nimport { InternalTab, TabProps } from './Tab';\n\nconst topStyles = css`\n  height: 100%;\n  width: 100%;\n  display: flex;\n  flex-direction: column;\n\n  .tab-list {\n    border-bottom: 1px solid #ccc;\n    padding-left: 0;\n    margin: 0;\n  }\n\n  .tab-list li:first-of-type {\n    margin-left: 5px;\n  }\n\n  .tab-list li:hover {\n    background-color: #f7f7f7;\n  }\n\n  .tab-list-item {\n    display: inline-block;\n    list-style: none;\n    padding: 0.5rem 2rem;\n  }\n\n  .tab-list-active {\n    background-color: white;\n    border: solid #ccc;\n    border-width: 1px 1px 0 1px;\n  }\n\n  .tab-content {\n    height: 100%;\n    overflow: auto;\n  }\n`;\n\nconst leftStyles = css`\n  display: flex;\n  height: 100%;\n  width: 100%;\n  .tab-list {\n    border-right: 1px solid #ccc;\n    padding-left: 0;\n    margin: 0;\n  }\n\n  .tab-list li:hover {\n    background-color: #f7f7f7;\n  }\n\n  .tab-list li:first-of-type {\n    margin-top: 10px;\n  }\n\n  .tab-list-item {\n    display: block;\n    list-style: none;\n    margin-right: -1px;\n    padding: 0.5rem 0.75rem;\n  }\n\n  .tab-list-active {\n    background-color: white;\n    border: solid #ccc;\n    border-width: 1px 0px 1px 1px;\n  }\n\n  .tab-content {\n    height: 100%;\n    overflow: auto;\n  }\n`;\n\nexport enum PositionsEnum {\n  TOP = 'TOP',\n  LEFT = 'LEFT',\n}\n\ninterface TabsProps {\n  children: Array<ReactElement<TabProps> | boolean>;\n  onClick: (element: any) => void;\n  activeTab: string;\n  position?: PositionsEnum;\n  onDelete?: (element: any) => void;\n}\n\nfunction Tabs({\n  children,\n  onClick,\n  position,\n  onDelete = () => null,\n  activeTab,\n}: TabsProps) {\n  const onClickTabHandler = useCallback(\n    (tab) => {\n      const { tablabel, tabid } = tab;\n      onClick({ tablabel, tabid });\n    },\n    [onClick],\n  );\n\n  let contentChild;\n  const tabs = Children.map(children, (child) => {\n    if (!isValidElement(child)) return null;\n\n    const { tabid } = child.props;\n\n    if (tabid === activeTab) {\n      contentChild = child.props.children;\n    }\n\n    return (\n      <InternalTab\n        {...child.props}\n        isActive={tabid === activeTab}\n        onClick={onClickTabHandler}\n        onDelete={onDelete}\n      />\n    );\n  });\n\n  const styles = useMemo(() => {\n    switch (position) {\n      case PositionsEnum.TOP:\n        return topStyles;\n      case PositionsEnum.LEFT:\n        return leftStyles;\n      default:\n        return topStyles;\n    }\n  }, [position]);\n\n  return (\n    <div className=\"tabs\" css={styles}>\n      <ol className=\"tab-list\">{tabs}</ol>\n      <div className=\"tab-content\">{contentChild}</div>\n    </div>\n  );\n}\n\nexport default memo(Tabs);\n","/** @jsxImportSource @emotion/react */\n\nimport { css } from '@emotion/react';\nimport {\n  ReactNode,\n  useState,\n  Children,\n  useMemo,\n  useEffect,\n  useCallback,\n  memo,\n} from 'react';\nimport { FaAngleLeft } from 'react-icons/fa';\nimport { useMeasure } from 'react-use';\n\ninterface ArrowProps {\n  direction: 'right' | 'left';\n  onClick: () => void;\n}\n\nfunction Arrow({ direction, onClick }: ArrowProps) {\n  return (\n    <div\n      onClick={onClick}\n      css={css`\n        display: flex;\n        position: absolute;\n        top: calc(50% - 20px);\n        ${direction === 'right' ? `right: 25px` : `left: 25px`};\n        height: 40px;\n        width: 40px;\n        justify-content: center;\n        background: white;\n        border-radius: 50%;\n        cursor: pointer;\n        align-items: center;\n        border: none;\n        transition: transform ease-in 0.1s;\n        background-color: #f7f7f7;\n\n        &:hover {\n          transform: scale(1.1);\n          background-color: #607d8b !important;\n          color: white;\n        }\n        img {\n          transform: translateX(${direction === 'left' ? '-2' : '2'}px);\n          &:focus {\n            outline: 0;\n          }\n        }\n      `}\n    >\n      <FaAngleLeft\n        style={{ transform: `scaleX(${direction === 'right' ? '-1' : '1'})` }}\n      />\n    </div>\n  );\n}\n\nconst transition = 0.45;\n\ninterface NextPrevProps {\n  children: ReactNode;\n  loop?: boolean;\n  defaultIndex?: number;\n  onChange?: (element: number) => void;\n}\n\nfunction NextPrev({\n  children,\n  loop = false,\n  defaultIndex = 0,\n  onChange = () => null,\n}: NextPrevProps) {\n  const [ref, { width }] = useMeasure<HTMLDivElement>();\n  const [activeIndex, setActiveIndex] = useState(0);\n  useEffect(() => {\n    setActiveIndex(defaultIndex);\n  }, [defaultIndex]);\n\n  const Sliders = useMemo(\n    () =>\n      Children.map(children, (child: any) => {\n        return (\n          <div\n            key={child.key}\n            css={css`\n              width: ${width}px;\n              height: 100%;\n            `}\n          >\n            {child}\n          </div>\n        );\n      }),\n    [children, width],\n  );\n\n  const nextHandler = useCallback(() => {\n    setActiveIndex((preActiveIndex) => {\n      if (Sliders && preActiveIndex === Sliders.length - 1) {\n        onChange(preActiveIndex);\n\n        if (loop) {\n          return 0;\n        } else {\n          return preActiveIndex;\n        }\n      }\n\n      const nextIndex = preActiveIndex + 1;\n      onChange(nextIndex);\n\n      return nextIndex;\n    });\n  }, [Sliders, loop, onChange]);\n\n  const prevHandler = useCallback(() => {\n    setActiveIndex((preActiveIndex) => {\n      if (preActiveIndex === 0) {\n        onChange(preActiveIndex);\n        if (loop) {\n          return 0;\n        } else {\n          return preActiveIndex;\n        }\n      }\n      const prevIndex = preActiveIndex - 1;\n\n      onChange(prevIndex);\n\n      return prevIndex;\n    });\n  }, [loop, onChange]);\n\n  if (!width && !Sliders) return null;\n  return (\n    <div\n      css={css`\n        position: relative;\n        height: 100%;\n        width: 100%;\n        margin: 0 auto;\n        overflow: hidden;\n        display: block;\n      `}\n      ref={ref}\n    >\n      <div\n        css={css`\n          transform: translateX(-${width * activeIndex}px);\n          transition: transform ease-out ${transition}s;\n          height: 100%;\n          width: ${width * (Sliders ? Sliders.length : 1)}px;\n          display: flex;\n        `}\n      >\n        {Sliders}\n      </div>\n\n      {activeIndex !== 0 && <Arrow direction=\"left\" onClick={prevHandler} />}\n      {Sliders && activeIndex !== Sliders.length - 1 && (\n        <Arrow direction=\"right\" onClick={nextHandler} />\n      )}\n    </div>\n  );\n}\n\nexport default memo(NextPrev);\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback, useEffect, useState } from 'react';\nimport MF from 'react-mf/lib/components/MF';\nimport { MolfileSvgRenderer } from 'react-ocl/full';\n\nimport { Molecule } from '../../data/molecules/Molecule';\n\nimport NextPrev from './NextPrev';\n\nconst toolbarStyle = css`\n  display: flex;\n  flex-direction: row;\n  border-top: 0.55px solid rgb(240, 240, 240);\n  border-bottom: 0.55px solid rgb(240, 240, 240);\n  padding: 0px 5px;\n\n  p {\n    margin: 0;\n    text-align: right;\n    width: 100%;\n    line-height: 22px;\n    padding: 0px 10px;\n  }\n`;\n\nconst moleculeContainerStyle = css`\n  width: 100%;\n  position: relative;\n  .slider {\n    height: 180px;\n    width: 100%;\n    padding: 0px;\n    padding: 0px;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    flex-direction: column;\n  }\n  .slider p {\n    width: 100%;\n    margin: 0 auto;\n    display: block;\n    position: relative;\n    text-align: center;\n  }\n  .slider svg polygon {\n    fill: gray !important;\n  }\n  button {\n    flex: 2;\n    padding: 5px;\n    border: 1px solid gray;\n    border-radius: 5px;\n    height: 36px;\n    margin: 0 auto;\n    margin-top: 15px;\n    display: block;\n    width: 20%;\n\n    color: white;\n    background-color: gray;\n  }\n`;\n\ninterface MoleculeSelectionProps {\n  molecules: Array<Molecule>;\n  onChange: (element: number) => void;\n  index?: number;\n}\n\nexport default function MoleculeSelection(props: MoleculeSelectionProps) {\n  const { molecules, onChange = () => null, index } = props;\n  const [currentIndex, setCurrentIndex] = useState<number>(0);\n\n  useEffect(() => {\n    const _index = index && index < molecules.length ? index : 0;\n    if (molecules && molecules.length > 0) {\n      setCurrentIndex(_index);\n    }\n  }, [index, molecules]);\n\n  const onChangeHandler = useCallback(\n    (slideIndex) => {\n      setCurrentIndex(slideIndex);\n      onChange(slideIndex);\n    },\n    [onChange],\n  );\n\n  return (\n    <div>\n      <div css={toolbarStyle}>\n        <p>\n          {molecules &&\n            molecules.length > 0 &&\n            `${+(currentIndex + 1)} / ${molecules.length}`}{' '}\n        </p>\n      </div>\n      <div css={moleculeContainerStyle}>\n        <NextPrev defaultIndex={currentIndex} onChange={onChangeHandler}>\n          {molecules?.map((mol, index) => (\n            <div key={mol.key} className=\"slider\">\n              <div>\n                {mol.molfile && (\n                  <MolfileSvgRenderer\n                    id={`molSVG${index}`}\n                    width={120}\n                    molfile={mol.molfile}\n                  />\n                )}\n              </div>\n              <p>\n                <MF mf={mol.mf} /> - {mol.mw?.toFixed(2)}\n              </p>\n            </div>\n          ))}\n        </NextPrev>\n      </div>\n    </div>\n  );\n}\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useFormikContext } from 'formik';\nimport { useCallback, useState, useEffect, useMemo } from 'react';\n\nimport getAtom from '../../../data/utilities/getAtom';\nimport { useChartData } from '../../context/ChartContext';\nimport MoleculeSelection from '../../elements/MoleculeSelection';\n\nconst styles = css`\n  .molecule-container {\n    display: flex;\n    flex-direction: column;\n    flex-grow: 1;\n    .title {\n      padding: 0px 10px;\n      width: 100%;\n      text-align: center;\n    }\n\n    .molecule-selection-container {\n      width: 450px;\n      display: block;\n      margin: 0 auto;\n    }\n\n    .newSumText {\n      margin-top: 15px;\n      padding: 0px 10px;\n      width: 100%;\n\n      text-align: center;\n    }\n  }\n\n  .empty {\n    width: 100%;\n    padding: 20%;\n    text-align: center;\n  }\n`;\n\ninterface SelectMoleculeProps {\n  name: string;\n}\n\nexport default function SelectMolecule(props: SelectMoleculeProps) {\n  const [currentIndex, setCurrentIndex] = useState<number>();\n  const { setFieldValue, errors, values } = useFormikContext<{\n    molecule: { mf: string; key: string } | null;\n    sum: number;\n  }>();\n  const { molecules, activeTab } = useChartData();\n  const element = getAtom(activeTab);\n  const newSum = useMemo(() => {\n    return element &&\n      molecules &&\n      molecules.length > 0 &&\n      currentIndex !== undefined &&\n      molecules[currentIndex].atoms[element]\n      ? molecules[currentIndex].atoms[element]\n      : 0;\n  }, [currentIndex, element, molecules]);\n\n  const setValue = useCallback(\n    (index: number) => {\n      setCurrentIndex(index);\n      setFieldValue(props.name, molecules[index]);\n    },\n    [molecules, props.name, setFieldValue],\n  );\n\n  useEffect(() => {\n    if (molecules && molecules.length > 0) {\n      const index = values[props.name]\n        ? molecules.findIndex(\n            (molecule) => molecule.key === values[props.name].key,\n          )\n        : -1;\n      setValue(index !== -1 ? index : 0);\n    }\n  }, [molecules, props.name, setValue, values]);\n\n  const onChangeMoleculeSelectionHandler = useCallback(\n    (index) => {\n      setValue(index);\n    },\n    [setValue],\n  );\n\n  return (\n    <div css={styles}>\n      {element && molecules && molecules.length > 0 ? (\n        <div className=\"molecule-container\">\n          <p className=\"title\">Select a molecule as reference!</p>\n\n          <div className=\"molecule-selection-container\">\n            <MoleculeSelection\n              index={currentIndex}\n              molecules={molecules}\n              onChange={onChangeMoleculeSelectionHandler}\n            />\n            <p className=\"newSumText\">\n              New sum for {element} will be {newSum}!\n            </p>\n          </div>\n        </div>\n      ) : (\n        <p\n          className=\"empty\"\n          style={{ color: errors[props.name] ? 'red' : 'black' }}\n        >\n          You have to Select a spectrum and Add a molecule from the Structure\n          panel to select as a reference!\n        </p>\n      )}\n    </div>\n  );\n}\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback, useEffect, useMemo, useRef, useState } from 'react';\nimport * as Yup from 'yup';\n\nimport { SumOptions } from '../../../data/types/data1d/SumOptions';\nimport { usePreferences } from '../../context/PreferencesContext';\nimport CloseButton from '../../elements/CloseButton';\nimport Tab from '../../elements/Tab/Tab';\nimport Tabs from '../../elements/Tab/Tabs';\nimport FormikForm from '../../elements/formik/FormikForm';\nimport FormikInput from '../../elements/formik/FormikInput';\nimport { ModalStyles } from '../ModalStyle';\n\nimport SelectMolecule from './SelectMolecule';\n\nconst styles = css`\n  width: 450px;\n  height: 400px;\n  .header {\n    display: flex;\n    padding: 10px;\n    span {\n      font-size: 14px;\n      flex: 1;\n    }\n  }\n\n  .tab-content {\n    flex: 1;\n  }\n\n  .manual-container {\n    padding: 30px 5px;\n\n    .input {\n      width: 80% !important;\n      height: 36px;\n      margin: 0 auto;\n    }\n    .input Input {\n      padding: 5px;\n      text-align: center;\n    }\n  }\n\n  .footer-container {\n    button {\n      width: 20%;\n      color: white;\n      background-color: gray !important;\n    }\n    button:hover {\n      border: 1px solid gray;\n      color: gray;\n      background-color: white !important;\n    }\n  }\n`;\n\nenum SumSetOptions {\n  Auto = 'auto',\n  Manual = 'manual',\n}\n\ntype SaveInput =\n  | {\n      sum: number;\n      sumAuto: false;\n    }\n  | {\n      moleculeKey: string;\n      mf: string;\n      sumAuto: true;\n    };\n\ninterface ChangeSumModalProps {\n  onSave: (saveInput: SaveInput) => void;\n  onClose: () => void;\n  header: string;\n  sumOptions: SumOptions;\n}\n\nexport default function ChangeSumModal({\n  onSave,\n  onClose,\n  header,\n  sumOptions,\n}: ChangeSumModalProps) {\n  const {\n    current: {\n      display: { general, panels },\n    },\n  } = usePreferences();\n\n  const [setOption, setActiveOption] = useState(SumSetOptions.Auto);\n  const formRef = useRef<any>(null);\n\n  const handleKeyDown = useCallback((event) => {\n    if (event.key === 'Enter') {\n      formRef.current.submitForm();\n    }\n  }, []);\n\n  const onTabChangeHandler = useCallback((tab) => {\n    setActiveOption(tab.tabid);\n  }, []);\n\n  useEffect(() => {\n    if (\n      sumOptions?.sumAuto &&\n      !general?.hideSetSumFromMolecule &&\n      !panels?.structuresPanel?.hidden\n    ) {\n      setActiveOption(SumSetOptions.Auto);\n      const { mf, moleculeKey: key } = sumOptions;\n      formRef.current.setValues({\n        sum: null,\n        molecule: key && mf ? { mf, key } : null,\n      });\n    } else {\n      setActiveOption(SumSetOptions.Manual);\n      formRef.current.setValues({ sum: sumOptions?.sum || '', molecule: null });\n    }\n  }, [general?.hideSetSumFromMolecule, panels?.structuresPanel, sumOptions]);\n\n  const saveHandler = useCallback(\n    (values) => {\n      switch (setOption) {\n        case SumSetOptions.Auto: {\n          const {\n            molecule: { mf, key: moleculeKey },\n          } = values;\n\n          onSave({ sumAuto: true, mf, moleculeKey });\n          break;\n        }\n        case SumSetOptions.Manual: {\n          const { sum } = values;\n          onSave({ sum, sumAuto: false });\n          break;\n        }\n        default:\n          return;\n      }\n      onClose();\n    },\n    [onClose, onSave, setOption],\n  );\n\n  const validationSchema = useMemo(() => {\n    switch (setOption) {\n      case SumSetOptions.Auto: {\n        return Yup.object({\n          molecule: Yup.object().required(),\n        });\n      }\n      case SumSetOptions.Manual: {\n        return Yup.object({\n          sum: Yup.number().required(),\n        });\n      }\n      default:\n        return null;\n    }\n  }, [setOption]);\n\n  return (\n    // <div css={modalContainer}>\n    <div css={[ModalStyles, styles]}>\n      <div className=\"header handle\">\n        <span>{header}</span>\n\n        <CloseButton onClick={onClose} />\n      </div>\n      <div className=\"tab-content\">\n        <FormikForm\n          ref={formRef}\n          onSubmit={saveHandler}\n          initialValues={{ sum: null, molecule: null }}\n          validationSchema={validationSchema}\n        >\n          <Tabs activeTab={setOption} onClick={onTabChangeHandler}>\n            {!general?.hideSetSumFromMolecule &&\n              !panels?.structuresPanel?.hidden && (\n                <Tab tablabel=\"Auto\" tabid={SumSetOptions.Auto}>\n                  <SelectMolecule name=\"molecule\" />\n                </Tab>\n              )}\n\n            <Tab tablabel=\"Manual\" tabid={SumSetOptions.Manual}>\n              <div className=\"manual-container\">\n                <FormikInput\n                  name=\"sum\"\n                  type=\"number\"\n                  placeholder=\"Enter the new value\"\n                  onKeyDown={handleKeyDown}\n                />\n              </div>\n            </Tab>\n          </Tabs>\n        </FormikForm>\n      </div>\n      <div className=\"footer-container\">\n        <button\n          type=\"button\"\n          onClick={() => formRef.current.submitForm()}\n          className=\"btn\"\n        >\n          Set\n        </button>\n      </div>\n    </div>\n  );\n}\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { memo } from 'react';\nimport { FaCheck } from 'react-icons/fa';\n\nimport ToolTip from './ToolTip/ToolTip';\n\nconst styles = css`\n  background-color: transparent;\n  border: none;\n  height: 100%;\n  svg {\n    fill: green;\n    font-size: 16px;\n  }\n`;\n\ninterface SaveButtonProps {\n  popupTitle?: string;\n  popupPlacement?: string;\n  disabled?: boolean;\n  className?: string;\n  onClick?: () => void;\n}\n\nfunction SaveButton(props: SaveButtonProps) {\n  const {\n    className = '',\n    disabled = false,\n    popupPlacement = 'left',\n    popupTitle = 'Save',\n    onClick,\n  } = props;\n\n  return (\n    <div className={className}>\n      <ToolTip title={popupTitle} popupPlacement={popupPlacement}>\n        <button\n          css={styles}\n          type=\"button\"\n          onClick={onClick}\n          disabled={disabled}\n          className={className}\n        >\n          <FaCheck />\n        </button>\n      </ToolTip>\n    </div>\n  );\n}\n\nexport default memo(SaveButton);\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { memo } from 'react';\n\nimport CloseButton from '../../elements/CloseButton';\nimport SaveButton from '../../elements/SaveButton';\n\nconst styles = css`\n  display: flex;\n  flex-direction: row-reverse;\n  border-bottom: 0.55px solid rgb(240, 240, 240);\n\n  button {\n    background-color: transparent;\n    border: none;\n    padding: 5px;\n  }\n  button:disabled {\n    opacity: 0.6;\n  }\n`;\n\ninterface PreferencesHeaderProps {\n  onClose: () => void;\n  onSave: () => void;\n}\n\nfunction PreferencesHeader({ onClose, onSave }: PreferencesHeaderProps) {\n  return (\n    <div css={styles}>\n      <CloseButton onClick={onClose} popupTitle=\"close Preferences\" />\n      <SaveButton onClick={onSave} popupTitle=\"save Preferences\" />\n    </div>\n  );\n}\n\nexport default memo(PreferencesHeader);\n","import {\n  CSSProperties,\n  forwardRef,\n  useCallback,\n  useEffect,\n  useImperativeHandle,\n  useState,\n} from 'react';\n\nimport Input from './Input';\n\ninterface EditableColumnProps {\n  onSave?: (element: any) => void;\n  onEditStart?: (element: any) => void;\n  type?: 'number' | 'text';\n  editStatus?: boolean;\n  value: string | number;\n  style?: CSSProperties;\n}\n\n// TODO: remove this hacky ref usage.\nfunction EditableColumn(props: EditableColumnProps, ref: any) {\n  const {\n    onSave = () => null,\n    value,\n    type = 'text',\n    style,\n    onEditStart = () => null,\n    editStatus = false,\n  } = props;\n\n  const [enabled, enableEdit] = useState<boolean | undefined>();\n\n  useEffect(() => {\n    enableEdit(editStatus);\n  }, [editStatus]);\n\n  useImperativeHandle(ref, () => ({\n    startEdit: () => {\n      enableEdit(true);\n    },\n    closeEdit: () => {\n      enableEdit(false);\n    },\n  }));\n\n  const mouseClickCallback = useCallback((e: MouseEvent) => {\n    if (!(e.target as HTMLInputElement).classList.contains('editable-column')) {\n      enableEdit(false);\n      window.removeEventListener('mousedown', mouseClickCallback);\n    }\n  }, []);\n\n  // TODO: refactor this to not mix mouse and keyboard events.\n  const editModeHandler = useCallback(\n    (flag, event?: React.KeyboardEvent) => {\n      if (!flag && event) {\n        // when press Enter or Tab\n        if (['Enter', 'Tab'].includes(event.key)) {\n          onSave(event);\n        }\n        // close edit mode if press Enter, Tab or Escape\n        if (['Enter', 'Tab', 'Escape'].includes(event.key)) {\n          enableEdit(flag);\n          window.removeEventListener('mousedown', mouseClickCallback);\n        }\n      } else {\n        // start edit mode and add mouse listener to handle mouse click outside the input to finish the mode\n        window.addEventListener('mousedown', mouseClickCallback);\n        onEditStart(event);\n        enableEdit(flag);\n      }\n    },\n    [mouseClickCallback, onEditStart, onSave],\n  );\n\n  return (\n    <div\n      style={{ display: 'table', width: '100%', height: '100%', ...style }}\n      onDoubleClick={() => editModeHandler(true)}\n    >\n      {!enabled && (\n        <span style={{ display: 'table-cell', verticalAlign: 'middle' }}>\n          {value}\n        </span>\n      )}\n      {enabled && (\n        <div style={{ display: 'table-cell', verticalAlign: 'middle' }}>\n          <Input\n            enableAutoSelect\n            className=\"editable-column\"\n            value={value}\n            type={type}\n            onKeyDown={(e) => editModeHandler(false, e)}\n          />\n        </div>\n      )}\n    </div>\n  );\n}\n\nexport default forwardRef(EditableColumn);\n","import { CSSProperties } from 'react';\n\nexport interface CustomColumn {\n  index: number;\n  id?: string;\n  Header?: (() => JSX.Element) | string;\n  sortType?: string;\n  Cell?: (rowData: { row: { original: any; index: number } }) => any;\n  accessor?: ((row?: any, index?: number) => any) | string;\n  enableRowSpan?: boolean;\n  style?: CSSProperties;\n  extraParams?: any;\n}\n\nexport default function addCustomColumn(array, options: CustomColumn) {\n  const {\n    index,\n    Header = () => null,\n    extraParams,\n    accessor = null,\n    Cell = null,\n    sortType = 'basic',\n    enableRowSpan = false,\n    style = {},\n    id,\n  } = options || {};\n\n  array.push({\n    index,\n    ...{ ...(id && { id }) },\n    ...{ ...(accessor ? { accessor } : {}) },\n    ...{ ...(Cell ? { Cell } : {}) },\n    Header,\n    sortType,\n    enableRowSpan,\n    style,\n    ...extraParams,\n  });\n}\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { CSSProperties, ForwardedRef, forwardRef, useCallback } from 'react';\n\nconst arrowDownIcon = `url('data:image/svg+xml;utf8,<svg  xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\" width=\"960px\" height=\"560px\" viewBox=\"0 0 960 560\" enable-background=\"new 0 0 960 560\" xml:space=\"preserve\"><g id=\"Rounded_Rectangle_33_copy_4_1_\"><path d=\"M480,344.181L268.869,131.889c-15.756-15.859-41.3-15.859-57.054,0c-15.754,15.857-15.754,41.57,0,57.431l237.632,238.937c8.395,8.451,19.562,12.254,30.553,11.698c10.993,0.556,22.159-3.247,30.555-11.698l237.631-238.937c15.756-15.86,15.756-41.571,0-57.431s-41.299-15.859-57.051,0L480,344.181z\"/></g></svg>')`;\n\nconst styles = {\n  select: (width: number | string | undefined) => css`\n    padding: 0px 5px;\n    border: 0.55px solid #cacaca;\n    font-size: 14px;\n    width: ${width ? Number(width) - 5 : 115}px;\n    margin: 0;\n    height: 100%;\n    background: ${arrowDownIcon} no-repeat right white;\n    -webkit-appearance: none;\n    background-position-x: calc(100% - 5px);\n    background-size: 15px 15px;\n    border-radius: 5px;\n    margin: 0px 5px;\n    align-self: center;\n    &:focus,\n    input:focus {\n      outline: none;\n    }\n\n    &:required:invalid {\n      color: #666;\n    }\n  `,\n};\n\nexport interface SelectEntry {\n  key: string | number;\n  value: string | number;\n  label: string | number;\n}\n\nexport interface SelectProps {\n  onChange?: (element: string) => void;\n  data: Array<SelectEntry>;\n  style?: CSSProperties;\n  defaultValue?: string | number;\n  name?: string;\n  className?: string;\n  placeholder?: string;\n}\n\nconst Select = forwardRef(function Select(\n  props: SelectProps,\n  ref: ForwardedRef<HTMLSelectElement>,\n) {\n  const {\n    data,\n    style = { width: 100 },\n    onChange = () => null,\n    defaultValue = '',\n    name = '',\n    className = '',\n    placeholder = '',\n  } = props;\n\n  const handleOnChanged = useCallback(\n    (e) => {\n      let value = e.target.value;\n      if (!isNaN(value)) {\n        value = Number(value);\n      }\n      onChange(value);\n    },\n    [onChange],\n  );\n\n  return (\n    <select\n      ref={ref}\n      css={styles.select(style?.width)}\n      name={name}\n      onChange={handleOnChanged}\n      defaultValue={defaultValue}\n      className={className}\n      style={style}\n      required\n    >\n      {placeholder && (\n        <option value=\"\" disabled>\n          {placeholder}\n        </option>\n      )}\n\n      {data.map((d) => (\n        <option key={`${d.key}`} value={d.value}>\n          {d.label}\n        </option>\n      ))}\n    </select>\n  );\n});\n\nexport default Select;\n","import lodashGet from 'lodash/get';\nimport { useCallback, useMemo, memo } from 'react';\nimport { FaRegTrashAlt } from 'react-icons/fa';\n\nimport { SignalKinds } from '../../../data/constants/SignalsKinds';\nimport { checkIntegralKind } from '../../../data/data1d/Spectrum1D';\nimport { Integral } from '../../../data/types/data1d';\nimport { useDispatch } from '../../context/DispatchContext';\nimport EditableColumn from '../../elements/EditableColumn';\nimport ReactTable from '../../elements/ReactTable/ReactTable';\nimport addCustomColumn, {\n  CustomColumn,\n} from '../../elements/ReactTable/utility/addCustomColumn';\nimport Select from '../../elements/Select';\nimport {\n  DELETE_INTEGRAL,\n  CHANGE_INTEGRAL_DATA,\n  CHANGE_INTEGRAL_RELATIVE,\n} from '../../reducer/types/Types';\nimport formatNumber from '../../utility/FormatNumber';\nimport { getValue } from '../../utility/LocalStorage';\nimport NoTableData from '../extra/placeholder/NoTableData';\nimport { integralDefaultValues } from '../extra/preferences/defaultValues';\n\nimport { IntegralPanelInnerProps } from './IntegralPanel';\n\nconst selectStyle = { marginLeft: 10, marginRight: 10, border: 'none' };\n\ninterface IntegralTableProps\n  extends Pick<IntegralPanelInnerProps, 'activeTab' | 'preferences'> {\n  data: Array<Integral>;\n}\n\nfunction IntegralTable({ activeTab, data, preferences }: IntegralTableProps) {\n  const dispatch = useDispatch();\n  const deleteIntegralHandler = useCallback(\n    (e, row) => {\n      e.preventDefault();\n      e.stopPropagation();\n      const params = row.original;\n      dispatch({\n        type: DELETE_INTEGRAL,\n        integralID: params.id,\n      });\n    },\n    [dispatch],\n  );\n  const changeIntegralDataHandler = useCallback(\n    (value, row) => {\n      const data = { ...row.original, kind: value };\n      dispatch({\n        type: CHANGE_INTEGRAL_DATA,\n        payload: { data },\n      });\n    },\n    [dispatch],\n  );\n  const initialColumns: CustomColumn[] = useMemo(\n    () => [\n      {\n        index: 1,\n        Header: '#',\n        Cell: ({ row }) => row.index + 1,\n        width: 10,\n      },\n\n      {\n        index: 2,\n        Header: 'From',\n        sortType: 'basic',\n        resizable: true,\n        accessor: (row) => row.from.toFixed(2),\n      },\n      {\n        index: 3,\n        Header: 'To',\n        sortType: 'basic',\n        resizable: true,\n        accessor: (row) => row.to.toFixed(2),\n      },\n      {\n        index: 6,\n        Header: 'Kind',\n        sortType: 'basic',\n        resizable: true,\n        accessor: (row) => row.kind,\n        Cell: ({ row }) => (\n          <Select\n            onChange={(value) => changeIntegralDataHandler(value, row)}\n            data={SignalKinds}\n            style={selectStyle}\n            defaultValue={row.original.kind}\n          />\n        ),\n      },\n      {\n        index: 7,\n        style: { width: '1%', maxWidth: '24px', minWidth: '24px' },\n        id: 'delete-button',\n        Cell: ({ row }) => (\n          <button\n            type=\"button\"\n            className=\"delete-button\"\n            onClick={(e) => deleteIntegralHandler(e, row)}\n          >\n            <FaRegTrashAlt />\n          </button>\n        ),\n      },\n    ],\n    [changeIntegralDataHandler, deleteIntegralHandler],\n  );\n\n  const saveRelativeHandler = useCallback(\n    (event, row) => {\n      const data = { value: event.target.value, id: row.id };\n      dispatch({\n        type: CHANGE_INTEGRAL_RELATIVE,\n        payload: { data },\n      });\n    },\n    [dispatch],\n  );\n\n  const integralsPreferences = useMemo(\n    () =>\n      getValue(\n        preferences.current,\n        `formatting.panels.integrals.[${activeTab}]`,\n        integralDefaultValues,\n      ),\n    [activeTab, preferences],\n  );\n\n  const COLUMNS: (CustomColumn & { showWhen: string })[] = useMemo(\n    () => [\n      {\n        showWhen: 'showAbsolute',\n        index: 4,\n        Header: 'Absolute',\n        accessor: (row) =>\n          formatNumber(\n            row.absolute,\n            lodashGet(\n              integralsPreferences,\n              'absoluteFormat',\n              integralDefaultValues.absoluteFormat,\n            ),\n          ),\n      },\n      {\n        showWhen: 'showRelative',\n        index: 5,\n        id: 'relative',\n        Header: () => {\n          const n = activeTab?.replace(/[0-9]/g, '');\n          return <span>{`Relative ${n}`}</span>;\n        },\n        accessor: (row) => {\n          return formatNumber(\n            row.integral,\n            lodashGet(\n              integralsPreferences,\n              'relativeFormat',\n              integralDefaultValues.relativeFormat,\n            ),\n          );\n        },\n        Cell: ({ row }) => {\n          const value = formatNumber(\n            row.original.integral,\n            lodashGet(\n              integralsPreferences,\n              'relativeFormat',\n              integralDefaultValues.relativeFormat,\n            ),\n          );\n          const flag = checkIntegralKind(row.original);\n          const integral = flag ? value : `[ ${value} ]`;\n\n          return (\n            <EditableColumn\n              value={integral}\n              onSave={(event) => saveRelativeHandler(event, row.original)}\n              type=\"number\"\n            />\n          );\n        },\n      },\n    ],\n    [activeTab, integralsPreferences, saveRelativeHandler],\n  );\n\n  const tableColumns = useMemo(() => {\n    let columns = [...initialColumns];\n    for (const col of COLUMNS) {\n      const { showWhen, ...colParams } = col;\n      if (integralsPreferences[showWhen]) {\n        addCustomColumn(columns, colParams);\n      }\n    }\n\n    return columns.sort((object1, object2) => object1.index - object2.index);\n  }, [COLUMNS, initialColumns, integralsPreferences]);\n\n  return data && data.length > 0 ? (\n    <ReactTable data={data} columns={tableColumns} />\n  ) : (\n    <NoTableData />\n  );\n}\n\nexport default memo(IntegralTable);\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback, memo, useState, useEffect } from 'react';\nimport { ChromePicker } from 'react-color';\n\nconst style = css`\n  display: flex;\n  margin: 5px 0px;\n\n.inputLabel{\n  flex: 2;\n  font-size: 11px;\n  font-weight: bold;\n  color: #232323;\n}\n\n.input {\n  width: '60%',\n  text-align: 'center',\n}\n\n.color{\n  width: 36px;\n  height: 14px;\n  border-radius: 2px;\n}\n\n.swatch{\n  padding: 5px;\n  background: #fff;\n  border-radius: 1px;\n  box-shadow: 0 0 0 1px rgba(0,0,0,.1);\n  display: inline-block;\n  cursor: pointer;\n}\n.color-popover {\n  position: absolute;\n  z-index: 2;\n}\n\n.cover {\n  position: fixed;\n  top: 0px;\n  right: 0px;\n  bottom: 0px;\n  left: 0px;\n}\n  .chrome-picker {\n    border-radius: none !important;\n    width: 200px !important;\n    height: 60px !important;\n    display: flex;\n\n\n  }\n  .chrome-picker > div:first-of-type {\n    padding: 0px !important;\n\n  }\n  .chrome-picker > div:last-child >  div:first-of-type {\n    width: 120px;\n\n  }\n  .chrome-picker > div:last-child >  div:last-child {\n    display:none !important;\n  }\n`;\n\nexport interface ColorInputProps {\n  value?: string;\n  label?: string;\n  name: string;\n  onColorChange?: (element: any) => void;\n}\n\nfunction ColorInput(props: ColorInputProps) {\n  const {\n    label = 'Color: ',\n    onColorChange = () => null,\n    name,\n    value = '#000000',\n  } = props;\n\n  const [displayColorPicker, showColorPicker] = useState(false);\n  const [selectedColor, setColor] = useState(value);\n\n  useEffect(() => {\n    setColor(value);\n  }, [value]);\n\n  const handleClick = useCallback(() => {\n    showColorPicker(!displayColorPicker);\n  }, [displayColorPicker]);\n\n  const handleClose = useCallback(() => {\n    showColorPicker(false);\n  }, []);\n\n  const handleOnColorChanged = useCallback(\n    (colorEvent) => {\n      const hex = `${colorEvent.hex}${Math.round(\n        colorEvent.rgb.a * 255,\n      ).toString(16)}`;\n      setColor(hex);\n      onColorChange({ ...colorEvent, hex, name });\n    },\n    [name, onColorChange],\n  );\n  return (\n    <div css={style}>\n      <span className=\"inputLabel\">{label}</span>\n      <div style={{ flex: 4 }}>\n        <div className=\"swatch\" onClick={handleClick}>\n          <div className=\"color\" style={{ backgroundColor: selectedColor }} />\n          <input type=\"hidden\" value={selectedColor} name={name} />\n        </div>\n        {displayColorPicker ? (\n          <div className=\"color-popover\">\n            <div className=\"cover\" onClick={handleClose} />\n            <ChromePicker\n              color={{ hex: selectedColor }}\n              onChangeComplete={handleOnColorChanged}\n            />\n          </div>\n        ) : null}\n      </div>\n    </div>\n  );\n}\n\nexport default memo(ColorInput);\n","import { useFormikContext } from 'formik';\nimport lodashGet from 'lodash/get';\nimport { useCallback, memo } from 'react';\n\nimport ColorInput, { ColorInputProps } from '../ColorInput';\n\ninterface FormikColorPickerProps extends ColorInputProps {\n  name: string;\n}\n\nfunction FormikColorPicker(props: FormikColorPickerProps) {\n  const { onColorChange = () => null, name, ...colorPickerProps } = props;\n\n  const { values, setFieldValue } = useFormikContext();\n\n  const colorChangeHandler = useCallback(\n    (color) => {\n      onColorChange(color);\n      setFieldValue(name, color.hex);\n    },\n    [name, onColorChange, setFieldValue],\n  );\n\n  return (\n    <ColorInput\n      {...colorPickerProps}\n      name={name}\n      onColorChange={colorChangeHandler}\n      value={lodashGet(values, name)}\n    />\n  );\n}\n\nexport default memo(FormikColorPicker);\n","import { useFormikContext } from 'formik';\nimport lodashGet from 'lodash/get';\nimport { CSSProperties, memo, useCallback } from 'react';\n\nimport Input from '../Input';\n\nconst styles: Record<'row' | 'inputLabel' | 'input', CSSProperties> = {\n  row: {\n    display: 'flex',\n    margin: '5px 0px',\n    alignItems: 'center',\n  },\n  inputLabel: {\n    flex: 2,\n    fontSize: '11px',\n    fontWeight: 'bold',\n    color: '#232323',\n  },\n  input: {\n    width: '60%',\n    textAlign: 'center',\n  },\n};\n\ninterface FormikColumnFormatFieldProps {\n  label: string;\n  checkControllerName: string;\n  formatControllerName?: string;\n  disableFormat?: boolean;\n  hideFormat?: boolean;\n}\n\nfunction FormikColumnFormatField(props: FormikColumnFormatFieldProps) {\n  const {\n    label,\n    checkControllerName,\n    formatControllerName,\n    disableFormat = false,\n    hideFormat = false,\n  } = props;\n\n  const { values, handleChange, setFieldValue } = useFormikContext();\n\n  const changeHandler = useCallback(\n    (e) => {\n      handleChange(e);\n    },\n    [handleChange],\n  );\n\n  const checkChangeHandler = useCallback(\n    (e) => {\n      setFieldValue(e.target.name, e.target.checked);\n    },\n    [setFieldValue],\n  );\n\n  return (\n    <div style={styles.row}>\n      <span style={styles.inputLabel}>{label}</span>\n      <div\n        style={{\n          flex: 4,\n          display: 'flex',\n          flexDirection: 'row',\n          alignItems: 'center',\n        }}\n      >\n        <input\n          type=\"checkbox\"\n          style={{ margin: '0px 5px' }}\n          name={checkControllerName}\n          onChange={checkChangeHandler}\n          checked={lodashGet(values, checkControllerName, false)}\n        />\n        {!hideFormat && formatControllerName && (\n          <Input\n            style={{ inputWrapper: styles.input }}\n            name={formatControllerName}\n            value={lodashGet(values, formatControllerName, '')}\n            onChange={changeHandler}\n            type=\"text\"\n            disabled={disableFormat}\n          />\n        )}\n      </div>\n    </div>\n  );\n}\n\nexport default memo(FormikColumnFormatField);\n","import {\n  CSSProperties,\n  ForwardedRef,\n  forwardRef,\n  useCallback,\n  useRef,\n} from 'react';\n\nconst styles: Record<\n  'container' | 'label' | 'inputContainer' | 'input',\n  CSSProperties\n> = {\n  container: {\n    display: 'flex',\n  },\n  label: {\n    lineHeight: 2,\n    userSelect: 'none',\n    flex: '2',\n  },\n  inputContainer: {\n    flex: '4',\n    display: 'flex',\n    justifyContent: 'flex-start',\n  },\n  input: {\n    height: '100%',\n    width: '100px',\n    borderRadius: '5px',\n    border: '0.55px solid #c7c7c7',\n    margin: '0px 5px 0px 5px',\n    textAlign: 'center',\n  },\n};\n\nexport interface NumberInputProps {\n  pattern?: string;\n  label?: string;\n  name?: string;\n  step?: any;\n  min?: any;\n  max?: any;\n  defaultValue?: number;\n  style?: {\n    container?: any;\n    label?: any;\n    inputContainer?: any;\n    input?: any;\n  };\n  onChange?: (element: any) => void;\n  onInput?: () => void;\n}\n\nconst NumberInput = forwardRef(\n  (\n    {\n      label,\n      name,\n      defaultValue = 0,\n      style = { label: {}, input: {}, container: {}, inputContainer: {} },\n      onChange = () => null,\n      onInput = () => null,\n      pattern = '^d*(.d{0,2})?$',\n      step = 'any',\n      min = 'any',\n      max = 'any',\n    }: NumberInputProps,\n    ref: ForwardedRef<HTMLInputElement>,\n  ) => {\n    const localRef = useRef<HTMLInputElement>(null);\n    const changeHander = useCallback(\n      (e) => {\n        if (e.target.checkValidity()) {\n          const value = Number(\n            e.target.value === '' ? defaultValue : e.target.value,\n          );\n          onChange({\n            ...e,\n            target: { ...e.target, name: e.target.name, value },\n          });\n        } else {\n          const _ref: any = ref ? ref : localRef;\n          _ref.current.value = Number(defaultValue);\n        }\n      },\n      [defaultValue, onChange, ref],\n    );\n    return (\n      <div style={{ ...styles.container, ...style.container }}>\n        <span style={{ ...styles.label, ...style.label }}>{label}</span>\n        <div style={{ ...styles.inputContainer, ...style.inputContainer }}>\n          <input\n            ref={ref ? ref : localRef}\n            name={name}\n            style={{ ...styles.input, ...style.input }}\n            type=\"number\"\n            pattern={pattern}\n            defaultValue={defaultValue}\n            step={step}\n            onChange={changeHander}\n            onInput={onInput}\n            min={min}\n            max={max}\n            key={defaultValue}\n          />\n        </div>\n      </div>\n    );\n  },\n);\n\nexport default NumberInput;\n","import { useFormikContext } from 'formik';\nimport lodashGet from 'lodash/get';\nimport { useCallback } from 'react';\n\nimport NumberInput, { NumberInputProps } from '../NumberInput';\n\ninterface FormikNumberInputProps extends NumberInputProps {\n  label: string;\n  name: string;\n}\n\nfunction FormikNumberInput(props: FormikNumberInputProps) {\n  const { label, name, ...resProps } = props;\n  const { values, handleChange } = useFormikContext();\n\n  const changeHandler = useCallback(\n    (e) => {\n      handleChange(e);\n    },\n    [handleChange],\n  );\n\n  return (\n    <NumberInput\n      label={label}\n      name={name}\n      defaultValue={lodashGet(values, name)}\n      onChange={changeHandler}\n      {...resProps}\n    />\n  );\n}\n\nexport default FormikNumberInput;\n","import { useMemo } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\n\nexport default function useNucleus() {\n  const { tabActiveSpectrum } = useChartData();\n  return useMemo<Array<string>>(() => {\n    if (tabActiveSpectrum && Object.keys(tabActiveSpectrum).length > 0) {\n      return Object.keys(tabActiveSpectrum);\n    }\n    return [];\n  }, [tabActiveSpectrum]);\n}\n","import {\n  useEffect,\n  useCallback,\n  useImperativeHandle,\n  useRef,\n  CSSProperties,\n  memo,\n  forwardRef,\n} from 'react';\nimport { MF } from 'react-mf';\n\nimport { usePreferences } from '../../context/PreferencesContext';\nimport FormikColorInput from '../../elements/formik/FormikColorInput';\nimport FormikColumnFormatField from '../../elements/formik/FormikColumnFormatField';\nimport FormikForm from '../../elements/formik/FormikForm';\nimport FormikNumberInput from '../../elements/formik/FormikNumberInput';\nimport { useAlert } from '../../elements/popup/Alert';\nimport useNucleus from '../../hooks/useNucleus';\nimport { getValue as getValueByKeyPath } from '../../utility/LocalStorage';\nimport { integralDefaultValues } from '../extra/preferences/defaultValues';\n\nconst styles: Record<\n  | 'container'\n  | 'groupContainer'\n  | 'row'\n  | 'header'\n  | 'inputLabel'\n  | 'input'\n  | 'inputLabel',\n  CSSProperties\n> = {\n  container: {\n    padding: 10,\n    backgroundColor: '#f1f1f1',\n    height: '100%',\n    overflowY: 'auto',\n  },\n  groupContainer: {\n    padding: '5px',\n    borderRadius: '5px',\n    margin: '10px 0px',\n    backgroundColor: 'white',\n  },\n  row: {\n    display: 'flex',\n    margin: '5px 0px',\n  },\n  header: {\n    borderBottom: '1px solid #e8e8e8',\n    paddingBottom: '5px',\n    fontWeight: 'bold',\n    color: '#4a4a4a',\n  },\n  inputLabel: {\n    flex: 2,\n    fontSize: '11px',\n    fontWeight: 'bold',\n    color: '#232323',\n  },\n  input: {\n    width: '30%',\n    textAlign: 'center',\n  },\n};\n\nconst formatFields = [\n  {\n    id: 1,\n    label: 'Absolute :',\n    checkController: 'showAbsolute',\n    formatController: 'absoluteFormat',\n  },\n  {\n    id: 2,\n    label: 'Relative :',\n    checkController: 'showRelative',\n    formatController: 'relativeFormat',\n  },\n];\n\ninterface IntegralsPreferencesInnerProps {\n  nucleus: Array<string>;\n  preferences: any;\n  innerRef: any;\n}\n\nfunction IntegralsPreferencesInner({\n  nucleus,\n  preferences,\n  innerRef,\n}: IntegralsPreferencesInnerProps) {\n  const alert = useAlert();\n\n  const formRef = useRef<any>();\n\n  const updateValues = useCallback(() => {\n    if (nucleus) {\n      const { color, strokeWidth, ...restProps } = integralDefaultValues;\n\n      const integralPreferences = getValueByKeyPath(\n        preferences.current,\n        `formatting.panels.integrals`,\n      );\n\n      let defaultValues = nucleus.reduce((acc, nucleusLabel) => {\n        acc[nucleusLabel] = restProps;\n        return acc;\n      }, {});\n      defaultValues = Object.assign(defaultValues, { color, strokeWidth });\n\n      formRef.current.setValues(\n        integralPreferences ? integralPreferences : defaultValues,\n      );\n    }\n  }, [nucleus, preferences]);\n\n  useEffect(() => {\n    updateValues();\n  }, [updateValues]);\n\n  const saveHandler = useCallback(\n    (values) => {\n      preferences.dispatch({\n        type: 'SET_PANELS_PREFERENCES',\n        payload: { key: 'integrals', value: values },\n      });\n      alert.success('Integrals preferences saved successfully');\n    },\n    [alert, preferences],\n  );\n\n  useImperativeHandle(innerRef, () => ({\n    saveSetting: () => {\n      formRef.current.submitForm();\n    },\n  }));\n\n  return (\n    <div style={styles.container}>\n      <FormikForm onSubmit={saveHandler} ref={formRef}>\n        <div style={styles.groupContainer}>\n          <p style={styles.header}>General</p>\n          <FormikColorInput name=\"color\" />\n          <FormikNumberInput\n            name=\"strokeWidth\"\n            label=\"stroke width :\"\n            style={{\n              label: { fontSize: '11px', fontWeight: 'bold', color: '#232323' },\n              input: {\n                width: '60%',\n                textAlign: 'center',\n                borderRadius: '5px',\n              },\n            }}\n            min={1}\n            max={9}\n            pattern=\"[1-9]+\"\n          />\n        </div>\n\n        {nucleus?.map((nucleusLabel) => (\n          <div key={nucleusLabel} style={styles.groupContainer}>\n            <p style={styles.header}>\n              <MF mf={nucleusLabel} />\n            </p>\n            {formatFields.map((field) => (\n              <FormikColumnFormatField\n                key={field.id}\n                label={field.label}\n                checkControllerName={`${nucleusLabel}.${field.checkController}`}\n                formatControllerName={`${nucleusLabel}.${field.formatController}`}\n              />\n            ))}\n          </div>\n        ))}\n      </FormikForm>\n    </div>\n  );\n}\n\nconst MemoizedIntegralsPreferences = memo(IntegralsPreferencesInner);\n\n// TODO: remove this hacky use of ref.\nfunction IntegralsPreferences(props, ref) {\n  const preferences = usePreferences();\n  const nucleus = useNucleus();\n\n  return (\n    <MemoizedIntegralsPreferences\n      innerRef={ref}\n      {...{\n        nucleus,\n        preferences,\n      }}\n    />\n  );\n}\n\nexport default forwardRef(IntegralsPreferences);\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { SvgNmrSum } from 'cheminfo-font';\nimport lodashGet from 'lodash/get';\nimport { useCallback, useMemo, useState, useRef, memo, Fragment } from 'react';\nimport { ImLink } from 'react-icons/im';\n\nimport { Datum1D, Info1D, Integrals } from '../../../data/types/data1d';\nimport { useChartData } from '../../context/ChartContext';\nimport { useDispatch } from '../../context/DispatchContext';\nimport { usePreferences } from '../../context/PreferencesContext';\nimport ToggleButton from '../../elements/ToggleButton';\nimport ToolTip from '../../elements/ToolTip/ToolTip';\nimport { useModal } from '../../elements/popup/Modal';\nimport useSpectrum from '../../hooks/useSpectrum';\nimport ChangeSumModal from '../../modal/changeSum/ChangeSumModal';\nimport {\n  DELETE_INTEGRAL,\n  CHANGE_INTEGRAL_SUM,\n  CHANGE_INTEGRALS_SUM_FLAG,\n} from '../../reducer/types/Types';\nimport { tablePanelStyle } from '../extra/BasicPanelStyle';\nimport DefaultPanelHeader from '../header/DefaultPanelHeader';\nimport PreferencesHeader from '../header/PreferencesHeader';\n\nimport IntegralTable from './IntegralTable';\nimport IntegralsPreferences from './IntegralsPreferences';\n\nconst style = css`\n  .sum-button {\n    width: 22px;\n    height: 22px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n  }\n\n  .fix-integral-toggle-btn {\n    svg {\n      font-size: 12px !important;\n    }\n  }\n`;\n\nexport interface IntegralPanelInnerProps {\n  integrals: Integrals;\n  info: Info1D;\n  activeTab: string;\n  xDomain: Array<number>;\n  preferences: any;\n}\n\nfunction IntegralPanelInner({\n  integrals,\n  info,\n  activeTab,\n  xDomain,\n  preferences,\n}: IntegralPanelInnerProps) {\n  const [filterIsActive, setFilterIsActive] = useState(false);\n\n  const dispatch = useDispatch();\n  const modal = useModal();\n  const [isFlipped, setFlipStatus] = useState(false);\n  const settingRef = useRef<any>();\n\n  const yesHandler = useCallback(() => {\n    dispatch({ type: DELETE_INTEGRAL, integralID: null });\n  }, [dispatch]);\n\n  const handleDeleteAll = useCallback(() => {\n    modal.showConfirmDialog({\n      message: 'All records will be deleted, Are You sure?',\n      buttons: [{ text: 'Yes', handler: yesHandler }, { text: 'No' }],\n    });\n  }, [modal, yesHandler]);\n\n  const changeIntegralSumHandler = useCallback(\n    (value) => {\n      dispatch({ type: CHANGE_INTEGRAL_SUM, value });\n      modal.close();\n    },\n    [dispatch, modal],\n  );\n\n  const currentSum = useMemo(() => {\n    return lodashGet(integrals, 'options.sum', null);\n  }, [integrals]);\n\n  const showChangeIntegralSumModal = useCallback(() => {\n    modal.show(\n      <ChangeSumModal\n        onClose={() => modal.close()}\n        onSave={changeIntegralSumHandler}\n        header={\n          currentSum\n            ? `Set new Integrals Sum (Current: ${Number(currentSum).toFixed(\n                2,\n              )})`\n            : 'Set new Integrals Sum'\n        }\n        sumOptions={integrals?.options}\n      />,\n    );\n  }, [changeIntegralSumHandler, currentSum, integrals?.options, modal]);\n\n  const settingsPanelHandler = useCallback(() => {\n    setFlipStatus(!isFlipped);\n  }, [isFlipped]);\n\n  const saveSettingHandler = useCallback(() => {\n    settingRef.current.saveSetting();\n    setFlipStatus(false);\n  }, []);\n\n  const handleOnFilter = useCallback(() => {\n    setFilterIsActive(!filterIsActive);\n  }, [filterIsActive]);\n\n  const toggleConstantSumHandler = useCallback(\n    (flag) => {\n      dispatch({ type: CHANGE_INTEGRALS_SUM_FLAG, payload: flag });\n    },\n    [dispatch],\n  );\n\n  const filteredData = useMemo(() => {\n    function isInRange(from, to) {\n      const factor = 10000;\n      to = to * factor;\n      from = from * factor;\n      return (\n        (to >= xDomain[0] * factor && from <= xDomain[1] * factor) ||\n        (from <= xDomain[0] * factor && to >= xDomain[1] * factor)\n      );\n    }\n    if (info.dimension === 1 && integrals?.values) {\n      const _integrals = filterIsActive\n        ? integrals.values.filter((integral) =>\n            isInRange(integral.from, integral.to),\n          )\n        : integrals.values;\n\n      return _integrals.map((integral) => {\n        return {\n          ...integral,\n          isConstantlyHighlighted: isInRange(integral.from, integral.to),\n        };\n      });\n    }\n    return [];\n  }, [filterIsActive, info.dimension, integrals, xDomain]);\n\n  return (\n    <Fragment>\n      <div\n        css={[\n          tablePanelStyle,\n          style,\n          isFlipped &&\n            css`\n              th {\n                position: relative;\n              }\n            `,\n        ]}\n      >\n        {!isFlipped && (\n          <DefaultPanelHeader\n            counter={integrals?.values?.length}\n            onDelete={handleDeleteAll}\n            deleteToolTip=\"Delete All Integrals\"\n            onFilter={handleOnFilter}\n            filterToolTip={\n              filterIsActive\n                ? 'Show all integrals'\n                : 'Hide integrals out of view'\n            }\n            filterIsActive={filterIsActive}\n            counterFiltered={filteredData.length}\n            showSettingButton\n            onSettingClick={settingsPanelHandler}\n          >\n            <ToolTip\n              title={\n                currentSum\n                  ? `Change Integrals Sum (${Number(currentSum).toFixed(2)})`\n                  : 'Change Integrals Sum'\n              }\n              popupPlacement=\"right\"\n            >\n              <button\n                className=\"sum-button\"\n                type=\"button\"\n                onClick={showChangeIntegralSumModal}\n              >\n                <SvgNmrSum />\n              </button>\n            </ToolTip>\n            <ToggleButton\n              className=\"fix-integral-toggle-btn\"\n              popupTitle=\"fix integral values\"\n              popupPlacement=\"right\"\n              onClick={toggleConstantSumHandler}\n            >\n              <ImLink />\n            </ToggleButton>\n          </DefaultPanelHeader>\n        )}\n        {isFlipped && (\n          <PreferencesHeader\n            onSave={saveSettingHandler}\n            onClose={settingsPanelHandler}\n          />\n        )}\n        <div className=\"inner-container\">\n          {!isFlipped ? (\n            <IntegralTable\n              data={filteredData}\n              activeTab={activeTab}\n              preferences={preferences}\n            />\n          ) : (\n            <IntegralsPreferences ref={settingRef} />\n          )}\n        </div>\n      </div>\n    </Fragment>\n  );\n}\n\nconst MemoizedIntegralPanel = memo(IntegralPanelInner);\n\nconst emptyData = { integrals: {}, info: {} };\n\nexport default function IntegralPanel() {\n  const { xDomain, activeTab } = useChartData();\n\n  const preferences = usePreferences();\n\n  const { integrals, info } = useSpectrum(emptyData) as Datum1D;\n\n  return (\n    <MemoizedIntegralPanel\n      {...{\n        integrals,\n        info,\n        preferences: preferences.current,\n        xDomain,\n        activeTab,\n      }}\n    />\n  );\n}\n","import React, { CSSProperties, ReactNode } from 'react';\n\ninterface LabelProps {\n  title: string;\n  children: ReactNode;\n  className?: string;\n  style?: {\n    label?: CSSProperties;\n    wrapper?: CSSProperties;\n  };\n}\n\nexport default function Label(props: LabelProps) {\n  const { title, className = '', children, style } = props;\n  return (\n    <div style={{ display: 'flex', alignItems: 'center' }}>\n      <span\n        className={className}\n        style={{\n          fontSize: '11px',\n          fontWeight: 'bold',\n          color: '#232323',\n          paddingRight: '10px',\n          width: 'max-content',\n          ...style?.label,\n        }}\n      >\n        {title}\n      </span>\n      <div style={style?.wrapper}>{children}</div>\n    </div>\n  );\n}\n","/** @jsxImportSource @emotion/react */\nimport { useCallback, useEffect, useRef } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\nimport Button from '../elements/Button';\nimport CloseButton from '../elements/CloseButton';\nimport Label from '../elements/Label';\nimport FormikForm from '../elements/formik/FormikForm';\nimport FormikInput from '../elements/formik/FormikInput';\nimport Events from '../utility/Events';\nimport { exportAsMatrix } from '../utility/Export';\n\nimport { ModalStyles } from './ModalStyle';\n\nconst INITIAL_VALUE = { from: -1, to: 1, nbPoints: 1024 };\n\ninterface ExportAsMatrixModalProps {\n  onClose?: (element?: string) => void;\n}\n\nfunction ExportAsMatrixModal({\n  onClose = () => null,\n}: ExportAsMatrixModalProps) {\n  const refForm = useRef<any>();\n  const { data } = useChartData();\n\n  const handleSave = useCallback(() => {\n    refForm.current.submitForm();\n  }, []);\n\n  const submitHandler = useCallback(\n    (options) => {\n      exportAsMatrix(data, options, 'fileName');\n      onClose();\n    },\n    [data, onClose],\n  );\n\n  useEffect(() => {\n    function handler(event: any) {\n      const [from, to] = event.range;\n      refForm.current.setValues({ ...refForm.current.values, from, to });\n    }\n\n    Events.on('brushEnd', handler);\n\n    return () => {\n      Events.off('brushEnd', handler);\n    };\n  }, []);\n\n  return (\n    <div css={ModalStyles}>\n      <div className=\"header handle\">\n        <span>Export spectra as a Matrix</span>\n        <CloseButton onClick={onClose} className=\"close-bt\" />\n      </div>\n      <div className=\"inner-content\">\n        <FormikForm\n          ref={refForm}\n          initialValues={INITIAL_VALUE}\n          onSubmit={submitHandler}\n        >\n          <div className=\"row margin-10\">\n            <span className=\"custom-label\">Range :</span>\n            <Label title=\"From : \">\n              <FormikInput name=\"from\" type=\"number\" />\n            </Label>\n            <Label title=\"To : \">\n              <FormikInput name=\"to\" type=\"number\" />\n            </Label>\n          </div>\n          <div className=\"row margin-10\">\n            <Label title=\"Number of Points :\" className=\"custom-label\">\n              <FormikInput name=\"nbPoints\" type=\"number\" />\n            </Label>\n          </div>\n        </FormikForm>\n      </div>\n      <div className=\"footer-container\">\n        <Button.Done onClick={handleSave}>Export Now</Button.Done>\n      </div>\n    </div>\n  );\n}\n\nexport default ExportAsMatrixModal;\n","import { FormikHelpers, FormikProps } from 'formik';\nimport { ForwardedRef, forwardRef } from 'react';\n\nimport { useChartData } from '../../context/ChartContext';\nimport Label from '../../elements/Label';\nimport FormikForm from '../../elements/formik/FormikForm';\nimport FormikInput from '../../elements/formik/FormikInput';\n\ninterface EquallySpacedFilterProps {\n  onSubmit: (values: any, helper: FormikHelpers<any>) => void;\n}\n\nfunction EquallySpacedFilter(\n  { onSubmit }: EquallySpacedFilterProps,\n  ref: ForwardedRef<FormikProps<any>>,\n) {\n  const { xDomain } = useChartData();\n  return (\n    <FormikForm\n      ref={ref}\n      initialValues={{\n        from: xDomain[0],\n        to: xDomain[1],\n        numberOfPoints: 1024,\n      }}\n      onSubmit={onSubmit}\n    >\n      <div className=\"row margin-10\">\n        <span className=\"custom-label\">Range :</span>\n        <Label title=\"From : \">\n          <FormikInput name=\"from\" type=\"number\" />\n        </Label>\n        <Label title=\"To : \">\n          <FormikInput name=\"to\" type=\"number\" />\n        </Label>\n      </div>\n      <div className=\"row margin-10\">\n        <Label className=\"custom-label\" title=\"Number of points : \">\n          <FormikInput name=\"numberOfPoints\" type=\"number\" />\n        </Label>\n      </div>\n    </FormikForm>\n  );\n}\n\nexport default forwardRef(EquallySpacedFilter);\n","import { FormikHelpers, FormikProps } from 'formik';\nimport { ForwardedRef, forwardRef } from 'react';\n\nimport { useChartData } from '../../context/ChartContext';\nimport Label from '../../elements/Label';\nimport FormikForm from '../../elements/formik/FormikForm';\nimport FormikInput from '../../elements/formik/FormikInput';\n\ninterface FromToFilterProps {\n  onSubmit: (values: any, helper: FormikHelpers<any>) => void;\n}\n\nfunction FromToFilter(\n  { onSubmit }: FromToFilterProps,\n  ref: ForwardedRef<FormikProps<any>>,\n) {\n  const { xDomain } = useChartData();\n  return (\n    <FormikForm\n      ref={ref}\n      initialValues={{ from: xDomain[0], to: xDomain[1] }}\n      onSubmit={onSubmit}\n    >\n      <div className=\"row margin-10\">\n        <span className=\"custom-label\">Range :</span>\n        <Label title=\"From :\">\n          <FormikInput name=\"from\" type=\"number\" />\n        </Label>\n        <Label title=\"To :\">\n          <FormikInput name=\"to\" type=\"number\" />\n        </Label>\n      </div>\n    </FormikForm>\n  );\n}\n\nexport default forwardRef(FromToFilter);\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback, useEffect, useMemo, useRef, useState } from 'react';\n\nimport * as Filters from '../../../data/Filters';\nimport { REFERENCES } from '../../../data/constants/References';\nimport { useDispatch } from '../../context/DispatchContext';\nimport ActionButtons from '../../elements/ActionButtons';\nimport CloseButton from '../../elements/CloseButton';\nimport Select from '../../elements/Select';\nimport FormikForm from '../../elements/formik/FormikForm';\nimport { APPLY_MULTIPLE_SPECTRA_FILTER } from '../../reducer/types/Types';\nimport Events from '../../utility/Events';\nimport { ModalStyles } from '../ModalStyle';\n\nimport EquallySpacedFilter from './EquallySpacedFilter';\nimport FromToFilter from './FromToFilter';\n\nconst baseList: Array<{\n  key: string | number;\n  value: number | string;\n  label: string;\n}> = [\n  { key: 0, value: 0, label: 'Select Filter' },\n  {\n    key: Filters.fromTo.id,\n    value: Filters.fromTo.id,\n    label: Filters.fromTo.name,\n  },\n  {\n    key: Filters.equallySpaced.id,\n    value: Filters.equallySpaced.id,\n    label: Filters.equallySpaced.name,\n  },\n  {\n    key: Filters.standardDeviation.id,\n    value: Filters.standardDeviation.id,\n    label: Filters.standardDeviation.name,\n  },\n  {\n    key: Filters.centerMean.id,\n    value: Filters.centerMean.id,\n    label: Filters.centerMean.name,\n  },\n  {\n    key: Filters.pareto.id,\n    value: Filters.pareto.id,\n    label: Filters.pareto.name,\n  },\n];\n\nconst styles = css`\n  .row {\n    align-items: center;\n  }\n\n  .container {\n    flex: 1;\n  }\n\n  .infoText {\n    padding: 10px;\n    font-size: 12px;\n    text-align: left;\n    color: white;\n    background-color: #5f5f5f;\n    border-radius: 5px;\n  }\n`;\n\ninterface MultipleSpectraFiltersModalProps {\n  onClose?: () => void;\n  nucleus?: string;\n}\n\nfunction MultipleSpectraFiltersModal({\n  onClose = () => null,\n  nucleus = '',\n}: MultipleSpectraFiltersModalProps) {\n  const refForm = useRef<any>();\n\n  const dispatch = useDispatch();\n  const [filter, setFilter] = useState('');\n\n  const List = useMemo(() => {\n    const list = REFERENCES[nucleus]\n      ? Object.entries(REFERENCES[nucleus]).map(\n          (item) => ({\n            key: item[0],\n            value: item[0],\n            label: item[0],\n          }),\n          [],\n        )\n      : [];\n\n    return baseList.concat(list as any);\n  }, [nucleus]);\n\n  const handleSave = useCallback((e) => {\n    e.preventDefault();\n    if (refForm.current) {\n      refForm.current.submitForm();\n    }\n  }, []);\n\n  const submitHandler = useCallback(\n    (options) => {\n      if (options) {\n        dispatch({\n          type: APPLY_MULTIPLE_SPECTRA_FILTER,\n          payload: [{ name: filter, options }],\n        });\n\n        onClose();\n      }\n    },\n    [dispatch, filter, onClose],\n  );\n\n  useEffect(() => {\n    function handle(event: any) {\n      const [from, to] = event.range;\n      if (refForm.current) {\n        refForm.current.setValues({ ...refForm.current.values, from, to });\n      }\n    }\n\n    Events.on('brushEnd', handle);\n\n    return () => {\n      Events.off('brushEnd', handle);\n    };\n  }, []);\n\n  const filterChangeHandler = useCallback((id) => {\n    setFilter(id);\n  }, []);\n\n  const filterOptions = useMemo(() => {\n    switch (filter) {\n      case Filters.fromTo.id:\n        return <FromToFilter onSubmit={submitHandler} ref={refForm} />;\n      case Filters.equallySpaced.id:\n        return <EquallySpacedFilter onSubmit={submitHandler} ref={refForm} />;\n      default:\n        <FormikForm\n          ref={refForm}\n          initialValues={null}\n          onSubmit={submitHandler}\n        />;\n        break;\n    }\n  }, [filter, submitHandler]);\n\n  return (\n    <div css={[ModalStyles, styles]}>\n      <div className=\"header handle\">\n        <span>Apply filters</span>\n        <CloseButton onClick={onClose} className=\"close-bt\" />\n      </div>\n      <div className=\"inner-content container\">\n        <p className=\"infoText\">\n          This filter will use the exclusions zones defined in the first\n          spectrum.\n        </p>\n        <div className=\"row margin-10\">\n          <span className=\"custom-label\">Filter :</span>\n\n          <Select\n            data={List}\n            style={{ width: 275, height: 30, margin: 0 }}\n            onChange={filterChangeHandler}\n          />\n        </div>\n        {filterOptions}\n      </div>\n      <div className=\"footer-container\">\n        <ActionButtons\n          style={{ flexDirection: 'row-reverse', margin: 0 }}\n          onDone={handleSave}\n          doneLabel=\"Save\"\n          onCancel={onClose}\n          cancelLabel=\"Close\"\n        />\n      </div>\n    </div>\n  );\n}\n\nexport default MultipleSpectraFiltersModal;\n","/** @jsxImportSource @emotion/react */\nimport { SvgNmrAddFilter, SvgNmrExportAsMatrix } from 'cheminfo-font';\nimport { useCallback } from 'react';\n\nimport { useDispatch } from '../../context/DispatchContext';\nimport Button from '../../elements/ButtonToolTip';\nimport { positions, useModal } from '../../elements/popup/Modal';\nimport ExportAsMatrixModal from '../../modal/ExportAsMatrixModal';\nimport MultipleSpectraFiltersModal from '../../modal/MultipleSpectraFiltersModal';\nimport { RESET_SELECTED_TOOL } from '../../reducer/types/Types';\nimport { tablePanelStyle } from '../extra/BasicPanelStyle';\nimport DefaultPanelHeader from '../header/DefaultPanelHeader';\n\nfunction MatrixGenerationPanel() {\n  const modal = useModal();\n  const dispatch = useDispatch();\n\n  const openFiltersModal = useCallback(() => {\n    dispatch({ type: RESET_SELECTED_TOOL });\n    modal.show(<MultipleSpectraFiltersModal />, {\n      isBackgroundBlur: false,\n      position: positions.TOP_CENTER,\n      width: 550,\n      height: 250,\n    });\n  }, [modal, dispatch]);\n\n  const openExportAsMatrixModal = useCallback(() => {\n    dispatch({ type: RESET_SELECTED_TOOL });\n    modal.show(<ExportAsMatrixModal />, {\n      isBackgroundBlur: false,\n      position: positions.TOP_CENTER,\n      width: 500,\n    });\n  }, [modal, dispatch]);\n\n  return (\n    <div css={tablePanelStyle}>\n      {\n        <DefaultPanelHeader\n          deleteToolTip=\"Delete All Peaks\"\n          showSettingButton\n          canDelete={false}\n        >\n          <Button popupTitle=\"Add Filter\" onClick={openFiltersModal}>\n            <SvgNmrAddFilter style={{ fontSize: '18px' }} />\n          </Button>\n          <Button\n            popupTitle=\"Export spectra as a Matrix\"\n            onClick={openExportAsMatrixModal}\n          >\n            <SvgNmrExportAsMatrix />\n          </Button>\n        </DefaultPanelHeader>\n      }\n\n      <div className=\"inner-container\" />\n    </div>\n  );\n}\n\nexport default MatrixGenerationPanel;\n","/** @jsxImportSource @emotion/react */\nimport { useState, useEffect, useCallback } from 'react';\nimport { StructureEditor } from 'react-ocl/full';\n\nimport { useDispatch } from '../context/DispatchContext';\nimport ActionButtons from '../elements/ActionButtons';\nimport { SET_MOLECULE, ADD_MOLECULE } from '../reducer/types/Types';\n\nimport { ModalStyles } from './ModalStyle';\n\ninterface MoleculeStructureEditorModalProps {\n  onClose?: (element?: string) => void;\n  selectedMolecule?: {\n    key: any;\n    molfile: string;\n  };\n}\n\nfunction MoleculeStructureEditorModal(\n  props: MoleculeStructureEditorModalProps,\n) {\n  const { onClose = () => null, selectedMolecule } = props;\n\n  const [molfile, setMolfile] = useState<string | null>(null);\n  const dispatch = useDispatch();\n  useEffect(() => {\n    if (selectedMolecule) {\n      setMolfile(selectedMolecule.molfile);\n    } else {\n      setMolfile(null);\n    }\n  }, [selectedMolecule]);\n\n  const cb = useCallback(\n    (newMolfile) => {\n      const molText =\n        /(?<s>M {2}V30 BEGIN BOND)(?<mol>.*?)(?<e>M {2}V30 END BOND)/gs.exec(\n          newMolfile,\n        )?.groups?.mol;\n\n      setMolfile(molText?.trim() ? newMolfile : null);\n    },\n    [setMolfile],\n  );\n\n  const handleClose = useCallback(() => {\n    onClose();\n  }, [onClose]);\n\n  const handleSave = useCallback(() => {\n    if (selectedMolecule) {\n      dispatch({ type: SET_MOLECULE, molfile, key: selectedMolecule.key });\n      onClose('replace');\n    } else {\n      dispatch({ type: ADD_MOLECULE, molfile });\n      onClose('new');\n    }\n  }, [dispatch, selectedMolecule, molfile, onClose]);\n\n  return (\n    <div css={ModalStyles}>\n      <StructureEditor\n        initialMolfile={selectedMolecule?.molfile}\n        svgMenu\n        fragment={false}\n        onChange={cb}\n      />\n      <div className=\"footer-container\">\n        <ActionButtons\n          style={{ flexDirection: 'row-reverse', margin: 0 }}\n          onDone={handleSave}\n          doneLabel=\"Save\"\n          onCancel={handleClose}\n        />\n      </div>\n    </div>\n  );\n}\n\nexport default MoleculeStructureEditorModal;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { ReactNode, useState, useCallback, useRef } from 'react';\n\nimport ToolTip from './ToolTip/ToolTip';\n\nconst menuStyles = css`\n  .menu {\n    box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.5);\n    padding: 0px;\n    margin: 0px;\n    border-radius: 5px;\n    display: flex;\n    flex-direction: column;\n    position: absolute;\n    z-index: 99999;\n    padding: 2px;\n    background-color: white;\n\n    button:hover {\n      background-color: #fafafa;\n    }\n  }\n\n  .menu-cover {\n    position: fixed;\n    width: 100%;\n    height: 100%;\n    top: 0;\n    left: 0;\n    z-index: 1;\n  }\n\n  .menu-item {\n    background-color: transparent;\n    border: none;\n    border-bottom: 0.55px solid whitesmoke;\n    height: 35px;\n    outline: outline;\n    display: table-cell;\n    vertical-align: middle;\n    text-align: left;\n    padding: 0 10px;\n\n    svg {\n      display: inline-block;\n    }\n\n    :focus {\n      outline: none !important;\n    }\n    span {\n      font-size: 10px;\n      padding: 0px 10px;\n    }\n  }\n`;\n\ninterface MenuItemProps {\n  icon: ReactNode;\n  label: string;\n  onClick: () => void;\n}\n\nfunction MenuItem({ icon, label, onClick }: MenuItemProps) {\n  return (\n    <button type=\"button\" className=\"menu-item\" onClick={onClick}>\n      {icon}\n      <span>{label}</span>\n    </button>\n  );\n}\n\ninterface MenuListProps {\n  items: Array<MenuItemProps & { id: string }>;\n  onClick: (element: MenuItemProps & { id: string }) => void;\n  boxBounding: any;\n}\n\nfunction MenuList({ items, boxBounding, onClick }: MenuListProps) {\n  return (\n    <div\n      className=\"menu\"\n      style={{\n        transform: `translate(${boxBounding.width}px, -${boxBounding.height}px) `,\n      }}\n    >\n      {items?.map((item) => {\n        return (\n          <MenuItem key={item.id} {...item} onClick={() => onClick(item)} />\n        );\n      })}\n    </div>\n  );\n}\n\ninterface MenuButtonProps {\n  style?: any;\n  component: any;\n  toolTip: string;\n  className?: string;\n  items: Array<any>;\n  onClick: (element: any) => void;\n}\n\nexport default function MenuButton({\n  style,\n  component,\n  toolTip = '',\n  className,\n  items = [],\n  onClick = () => null,\n}: MenuButtonProps) {\n  const menuButtonRef = useRef<HTMLButtonElement>(null);\n  const [isShown, showMenu] = useState(false);\n\n  const closeMenuButton = useCallback(() => {\n    showMenu(false);\n  }, []);\n\n  const handleClick = useCallback(() => {\n    showMenu((flag) => !flag);\n  }, []);\n  const clickHandler = useCallback(\n    (e) => {\n      showMenu(false);\n      onClick(e);\n    },\n    [onClick],\n  );\n\n  return (\n    <div style={{ height: 'auto' }} css={menuStyles}>\n      <button\n        ref={menuButtonRef}\n        type=\"button\"\n        css={style}\n        onClick={handleClick}\n        className={className}\n        style={{ boxSizing: 'border-box' }}\n      >\n        <ToolTip title={toolTip} popupPlacement=\"right\">\n          {component}\n        </ToolTip>\n      </button>\n      {isShown && (\n        <MenuList\n          items={items}\n          boxBounding={menuButtonRef.current?.getBoundingClientRect()}\n          onClick={clickHandler}\n        />\n      )}\n\n      {isShown && <div className=\"menu-cover\" onClick={closeMenuButton} />}\n    </div>\n  );\n}\n","export default function generateNumbersPowerOfX(\n  start: number,\n  end: number,\n  options?: { power?: number; format?: (input: number) => string | number },\n) {\n  const { power = 2, format = formatNumber } = options || {};\n  let values: Array<{ key: number; label: string | number; value: number }> =\n    [];\n  for (let i = start; i <= end; i++) {\n    const result = power ** i;\n    values.push({\n      key: result,\n      label: format(result),\n      value: result,\n    });\n  }\n  return values;\n}\n\nfunction formatNumber(number: number): string | number {\n  if (number >= 1024 * 1024) {\n    return `${number / (1024 * 1024)}M`;\n  } else if (number >= 1024) {\n    return `${number / 1024}K`;\n  } else {\n    return number;\n  }\n}\n","import { HTMLAttributes } from 'react';\n\ninterface IsotopesViewerProps extends HTMLAttributes<HTMLDivElement> {\n  value?: string;\n}\n\nfunction IsotopesViewer({ value = '', ...othersProps }: IsotopesViewerProps) {\n  return (\n    <div\n      {...othersProps}\n      // eslint-disable-next-line react/no-danger\n      dangerouslySetInnerHTML={{\n        __html: value.replace(/(?<isotope>[0-9]+)/g, '<sup>$<isotope></sup>'),\n      }}\n    />\n  );\n}\n\nexport default IsotopesViewer;\n","import { useFormikContext } from 'formik';\nimport { CSSProperties, useMemo } from 'react';\n\nconst styles: Record<'container' | 'text', CSSProperties> = {\n  container: {\n    backgroundColor: '#fd000c',\n    borderRadius: '5px',\n    padding: '0.4rem',\n  },\n  text: {\n    color: 'white',\n    margin: '0.5px',\n    fontSize: '0.9em',\n    listStyle: 'inside',\n  },\n};\n\nexport interface FormikErrorsSummaryProps {\n  style?: Record<'container' | 'text', CSSProperties>;\n}\n\nconst getErrors = (errorObj: Record<string, any>): string[] => {\n  const result: string[] = [];\n  function errorsIterators(obj) {\n    Object.keys(obj).forEach((key) => {\n      if (typeof obj[key] === 'object') {\n        errorsIterators(obj[key]);\n      } else {\n        result.push(obj[key]);\n      }\n    });\n  }\n\n  errorsIterators(errorObj);\n  return result;\n};\n\nfunction FormikErrorsSummary({ style }: FormikErrorsSummaryProps) {\n  const { errors, isValid } = useFormikContext();\n\n  const errorList = useMemo(() => {\n    return getErrors(errors);\n  }, [errors]);\n\n  if (isValid) return <div />;\n\n  return (\n    <ul style={{ ...styles.container, ...style?.container }}>\n      {errorList.map((errorText, index) => {\n        return (\n          // eslint-disable-next-line react/no-array-index-key\n          <li key={index} style={{ ...styles.text, ...style?.text }}>\n            {errorText}\n          </li>\n        );\n      })}\n    </ul>\n  );\n}\n\nexport default FormikErrorsSummary;\n","import { useFormikContext } from 'formik';\nimport lodashGet from 'lodash/get';\nimport { useCallback, useEffect } from 'react';\n\nimport Select, { SelectProps } from '../Select';\n\nconst FormikSelect = function FormikSelect(\n  props: SelectProps & { value?: string },\n) {\n  const { name = '', value, onChange = () => null, ...resProps } = props;\n\n  const { values, setFieldValue } = useFormikContext();\n  const changeHandler = useCallback(\n    (value) => {\n      onChange(value);\n      setFieldValue(name, value);\n    },\n    [name, onChange, setFieldValue],\n  );\n\n  useEffect(() => {\n    if (value) {\n      setFieldValue(name, value);\n    }\n  }, [name, setFieldValue, value]);\n\n  return (\n    <Select\n      name={name}\n      defaultValue={value ? value : lodashGet(values, name)}\n      onChange={changeHandler}\n      {...resProps}\n    />\n  );\n};\n\nexport default FormikSelect;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback, useRef, useState, useMemo } from 'react';\nimport * as Yup from 'yup';\n\nimport {\n  defaultPredictionOptions,\n  FREQUENCIES,\n} from '../../data/PredictionManager';\nimport generateNumbersPowerOfX from '../../data/utilities/generateNumbersPowerOfX';\nimport { useChartData } from '../context/ChartContext';\nimport { useDispatch } from '../context/DispatchContext';\nimport Button from '../elements/Button';\nimport CheckBox from '../elements/CheckBox';\nimport CloseButton from '../elements/CloseButton';\nimport IsotopesViewer from '../elements/IsotopesViewer';\nimport Label from '../elements/Label';\nimport FormikCheckBox from '../elements/formik/FormikCheckBox';\nimport FormikErrorsSummary from '../elements/formik/FormikErrorsSummary';\nimport FormikForm from '../elements/formik/FormikForm';\nimport FormikInput from '../elements/formik/FormikInput';\nimport FormikSelect from '../elements/formik/FormikSelect';\nimport { useAlert } from '../elements/popup/Alert';\nimport { PREDICT_SPECTRA, SET_LOADING_FLAG } from '../reducer/types/Types';\nimport { useStateWithLocalStorage } from '../utility/LocalStorage';\n\nimport { ModalStyles } from './ModalStyle';\n\nconst styles = css`\n  .row {\n    align-items: center;\n  }\n\n  .inner-content {\n    flex: 1;\n  }\n\n  .custom-label {\n    width: 160px;\n    font-weight: 500;\n  }\n\n  .nucleus-label {\n    padding: 0 10px;\n    color: black;\n    font-weight: 700;\n\n    &.disabled {\n      opacity: 0.5;\n      color: black;\n    }\n  }\n  .warning {\n    color: #c40000;\n    font-weight: bold;\n    font-size: 13px;\n    text-align: justify;\n    margin-top: 30px;\n  }\n\n  .warning-container {\n    margin-top: 5px;\n    display: flex;\n    input {\n      margin: 5px 5px 5px 0;\n    }\n  }\n\n  .middle-x {\n    padding: 0 10px;\n  }\n\n  .group-label {\n    width: 100%;\n    display: block;\n    border-bottom: 1px solid #efefef;\n    padding-bottom: 5px;\n    font-weight: 600;\n    color: #005d9e;\n  }\n`;\n\nconst NUMBER_OF_POINTS_1D = generateNumbersPowerOfX(12, 19);\nconst NUMBER_OF_POINTS_2D = generateNumbersPowerOfX(10, 10, {\n  format: (value) => value,\n});\n\nconst predictionFormValidation = Yup.object().shape({\n  name: Yup.string().required().label('Name'),\n  frequency: Yup.number().integer().required().label('Frequency'),\n  '1d': Yup.object({\n    '1H': Yup.object({\n      from: Yup.number().integer().required().label(\"1H ' From ' \"),\n      to: Yup.number().integer().required().label(\"1H ' To ' \"),\n    }),\n    '13C': Yup.object().shape({\n      from: Yup.number().integer().required().label(\"13C ' From ' \"),\n      to: Yup.number().integer().required().label(\"13C ' To ' \"),\n    }),\n    lineWidth: Yup.number().integer().min(1).required().label('Line Width'),\n    nbPoints: Yup.number().integer().required().label('1D Number Of Points'),\n  }),\n  '2d': Yup.object({\n    nbPoints: Yup.object({\n      x: Yup.number().integer().required().label('2D Number Of Points'),\n      y: Yup.number().integer().required().label('2D Number Of Points'),\n    }),\n  }),\n  spectra: Yup.object({\n    proton: Yup.boolean(),\n    carbon: Yup.boolean(),\n    cosy: Yup.boolean(),\n    hsqc: Yup.boolean(),\n    hmbc: Yup.boolean(),\n  }).test(\n    'check-options',\n    'You must check one of the options to start prediction',\n    (obj) => {\n      if (Object.values(obj).includes(true)) {\n        return true;\n      }\n      return false;\n    },\n  ),\n});\n\ninterface PredictSpectraModalProps {\n  onClose?: (element?: string) => void;\n  molfile: any;\n}\n\nfunction PredictSpectraModal({\n  onClose = () => null,\n  molfile,\n}: PredictSpectraModalProps) {\n  const refForm = useRef<any>();\n  const dispatch = useDispatch();\n  const alert = useAlert();\n  const [isApproved, setApproved] = useState(false);\n  const [predictionPreferences, setPredictionPreferences] =\n    useStateWithLocalStorage('nmrium-prediction-preferences');\n\n  const {\n    toolOptions: {\n      data: { predictionIndex },\n    },\n  } = useChartData();\n\n  const handleSave = useCallback(() => {\n    refForm.current.submitForm();\n  }, []);\n\n  const initValues = useMemo(() => {\n    const { isApproved: isAgree, ...options } = predictionPreferences;\n    setApproved(isAgree);\n    return Object.assign(defaultPredictionOptions, options, {\n      name: `Prediction ${predictionIndex + 1}`,\n    });\n  }, [predictionPreferences, predictionIndex]);\n\n  const submitHandler = useCallback(\n    (values) => {\n      void (async () => {\n        setPredictionPreferences({ ...values, isApproved });\n        dispatch({\n          type: SET_LOADING_FLAG,\n          isLoading: true,\n        });\n\n        const predictedSpectra = Object.entries(values.spectra)\n          .reduce<Array<string>>((acc, [key, value]) => {\n            if (value) {\n              acc.push(key);\n            }\n            return acc;\n          }, [])\n          .join(' , ');\n\n        const hideLoading = await alert.showLoading(\n          `Predict ${predictedSpectra} in progress`,\n        );\n\n        dispatch({\n          type: PREDICT_SPECTRA,\n          payload: { mol: molfile, options: values },\n        });\n\n        hideLoading();\n        onClose();\n      })();\n    },\n    [alert, dispatch, isApproved, molfile, onClose, setPredictionPreferences],\n  );\n\n  const approveCheckHandler = useCallback((e) => {\n    setApproved(e.target.checked);\n  }, []);\n\n  return (\n    <div css={[ModalStyles, styles]}>\n      <div className=\"header handle\">\n        <span>Prediction of NMR spectrum</span>\n        <CloseButton onClick={onClose} className=\"close-bt\" />\n      </div>\n      <div className=\"inner-content\">\n        <FormikForm\n          ref={refForm}\n          initialValues={initValues}\n          validationSchema={predictionFormValidation}\n          onSubmit={submitHandler}\n        >\n          <FormikErrorsSummary />\n          <div className=\"row margin-10\">\n            <span className=\"custom-label\">Name :</span>\n            <FormikInput\n              name=\"name\"\n              style={{ input: { width: '200px', textAlign: 'left' } }}\n            />\n          </div>\n          <div className=\"row margin-10\">\n            <span className=\"custom-label\">Spectrometer Frequency :</span>\n\n            <FormikSelect\n              data={FREQUENCIES}\n              style={{ width: 290, height: 30, margin: 0 }}\n              name=\"frequency\"\n            />\n          </div>\n\n          <span className=\"group-label\">1D Options </span>\n\n          <div className=\"row margin-10 padding-h-10\">\n            <IsotopesViewer value=\"1H\" className=\"custom-label\" />\n            <Label title=\"From\">\n              <FormikInput name=\"1d.1H.from\" type=\"number\" />\n            </Label>\n            <Label title=\"To\" style={{ label: { padding: '0 10px' } }}>\n              <FormikInput name=\"1d.1H.to\" type=\"number\" />\n            </Label>\n          </div>\n          <div className=\"row margin-10 padding-h-10\">\n            <IsotopesViewer value=\"13C\" className=\"custom-label\" />\n            <Label title=\"From\">\n              <FormikInput name=\"1d.13C.from\" type=\"number\" />\n            </Label>\n            <Label title=\"To\" style={{ label: { padding: '0 10px' } }}>\n              <FormikInput name=\"1d.13C.to\" type=\"number\" />\n            </Label>\n          </div>\n          <div className=\"row margin-10 padding-h-10\">\n            <span className=\"custom-label\">Line Width : </span>\n            <FormikInput\n              name=\"1d.lineWidth\"\n              type=\"number\"\n              style={{ input: { margin: 0 } }}\n            />\n            <span style={{ paddingLeft: '0.4rem' }}> Hz </span>\n          </div>\n          <div className=\"row margin-10 padding-h-10\">\n            <span className=\"custom-label\">Number of Points : </span>\n            <FormikSelect\n              data={NUMBER_OF_POINTS_1D}\n              name=\"1d.nbPoints\"\n              style={{ width: 290, height: 30, margin: 0 }}\n            />\n          </div>\n          <span className=\"group-label\">2D Options </span>\n\n          <div className=\"row margin-10 padding-h-10\">\n            <span className=\"custom-label\">Number of Points : </span>\n            <FormikSelect\n              data={NUMBER_OF_POINTS_2D}\n              name=\"2d.nbPoints.x\"\n              style={{ margin: 0, height: 30 }}\n            />\n            <span className=\"middle-x\"> X </span>\n            <FormikSelect\n              data={NUMBER_OF_POINTS_2D}\n              name=\"2d.nbPoints.y\"\n              style={{ margin: 0, height: 30 }}\n            />\n          </div>\n          <div className=\"row margin-10\">\n            <span className=\"group-label\">Spectra </span>\n          </div>\n          <div\n            className=\"row margin-10 padding-h-10\"\n            style={{ justifyContent: 'space-between' }}\n          >\n            <div className=\"row\">\n              <FormikCheckBox name=\"spectra.proton\" />\n              <IsotopesViewer value=\"1H\" className=\"nucleus-label\" />\n            </div>\n            <div className=\"row\">\n              <FormikCheckBox name=\"spectra.carbon\" />\n              <IsotopesViewer value=\"13C\" className=\"nucleus-label\" />\n            </div>\n            <div className=\"row\">\n              <FormikCheckBox name=\"spectra.cosy\" />\n              <IsotopesViewer value=\"COSY\" className=\"nucleus-label\" />\n            </div>\n            <div className=\"row\">\n              <FormikCheckBox name=\"spectra.hsqc\" />\n              <IsotopesViewer value=\"HSQC\" className=\"nucleus-label\" />\n            </div>\n            <div className=\"row\">\n              <FormikCheckBox name=\"spectra.hmbc\" />\n              <IsotopesViewer value=\"HMBC\" className=\"nucleus-label\" />\n            </div>\n          </div>\n        </FormikForm>\n        <p className=\"warning\">\n          In order to predict spectra we are calling an external service and the\n          chemical structure will leave your browser! You should never predict\n          spectra for confidential molecules.\n        </p>\n        <div className=\"warning-container\">\n          <CheckBox\n            onChange={approveCheckHandler}\n            checked={isApproved}\n            key={String(isApproved)}\n          />\n          <p>I confirm that the chemical structure is not confidential.</p>\n        </div>\n      </div>\n      <div className=\"footer-container\">\n        <Button.Done onClick={handleSave} disabled={!isApproved}>\n          Predict spectrum\n        </Button.Done>\n      </div>\n    </div>\n  );\n}\n\nexport default PredictSpectraModal;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { SvgNmrFt } from 'cheminfo-font';\nimport { useCallback } from 'react';\nimport {\n  FaCopy,\n  FaDownload,\n  FaFileExport,\n  FaFileImage,\n  FaPaste,\n  FaPlus,\n  FaRegTrashAlt,\n} from 'react-icons/fa';\nimport { IoOpenOutline } from 'react-icons/io5';\n\nimport { useAssignmentData } from '../../assignment/AssignmentsContext';\nimport { useDispatch } from '../../context/DispatchContext';\nimport { useGlobal } from '../../context/GlobalContext';\nimport ButtonToolTip from '../../elements/ButtonToolTip';\nimport MenuButton from '../../elements/MenuButton';\nimport ToggleButton from '../../elements/ToggleButton';\nimport ToolTip from '../../elements/ToolTip/ToolTip';\nimport { useAlert } from '../../elements/popup/Alert';\nimport { positions, useModal } from '../../elements/popup/Modal';\nimport PredictSpectraModal from '../../modal/PredictSpectraModal';\nimport {\n  ADD_MOLECULE,\n  DELETE_MOLECULE,\n  FLOAT_MOLECULE_OVER_SPECTRUM,\n} from '../../reducer/types/Types';\nimport {\n  copyPNGToClipboard,\n  copyTextToClipboard,\n  exportAsSVG,\n} from '../../utility/Export';\n\nconst toolbarStyle = css`\n  display: flex;\n  flex-direction: row;\n  border-bottom: 0.55px solid rgb(240, 240, 240);\n  padding: 0px 5px;\n\n  button svg {\n    fill: #4e4e4e;\n  }\n\n  button {\n    background-color: transparent;\n    border: none;\n    padding: 5px;\n  }\n\n  p {\n    margin: 0;\n    text-align: right;\n    width: 100%;\n    line-height: 22px;\n    padding: 0px 10px;\n  }\n`;\n\nconst MOL_EXPORT_MENU = [\n  {\n    id: 'molfile',\n    icon: <FaCopy />,\n    label: 'Copy as molfile',\n  },\n  {\n    id: 'png',\n    icon: <FaFileImage />,\n    label: 'Copy as PNG',\n  },\n  {\n    id: 'svg',\n    icon: <FaDownload />,\n    label: 'Export as SVG',\n  },\n];\n\nexport interface MoleculeHeaderActionsOptions {\n  hidePast?: boolean;\n  hideAdd?: boolean;\n  hideExport?: boolean;\n  hideDelete?: boolean;\n  hidePredict?: boolean;\n}\ninterface MoleculePanelHeaderProps {\n  currentIndex: number;\n  molecules: Array<any>;\n  onMoleculeIndexChange: (index: number) => void;\n  onOpenMoleculeEditor: () => void;\n  actionsOptions?: MoleculeHeaderActionsOptions;\n}\n\nexport default function MoleculePanelHeader({\n  currentIndex,\n  molecules,\n  onMoleculeIndexChange = () => null,\n  onOpenMoleculeEditor = () => null,\n  actionsOptions = {},\n}: MoleculePanelHeaderProps) {\n  const { rootRef } = useGlobal();\n  const alert = useAlert();\n  const dispatch = useDispatch();\n  const modal = useModal();\n  const assignmentData = useAssignmentData();\n\n  const saveAsSVGHandler = useCallback(() => {\n    if (!rootRef) return;\n    exportAsSVG(rootRef, `molSVG${currentIndex}`, 'molFile');\n  }, [rootRef, currentIndex]);\n\n  const saveAsPNGHandler = useCallback(() => {\n    if (!rootRef) return;\n    copyPNGToClipboard(rootRef, `molSVG${currentIndex}`);\n    alert.success('MOL copied as PNG to clipboard');\n  }, [rootRef, alert, currentIndex]);\n\n  const saveAsMolHandler = useCallback(() => {\n    if (molecules[currentIndex]) {\n      void copyTextToClipboard(molecules[currentIndex].molfile).then((flag) => {\n        if (flag) {\n          alert.success('MOLFile copied to clipboard');\n        } else {\n          alert.error('copied not completed');\n        }\n      });\n    }\n  }, [alert, currentIndex, molecules]);\n\n  const exportHandler = useCallback(\n    ({ id }) => {\n      switch (id) {\n        case 'molfile':\n          saveAsMolHandler();\n          break;\n        case 'png':\n          saveAsPNGHandler();\n          break;\n        case 'svg':\n          saveAsSVGHandler();\n          break;\n        default:\n          break;\n      }\n    },\n    [saveAsMolHandler, saveAsPNGHandler, saveAsSVGHandler],\n  );\n\n  const handlePaste = useCallback(() => {\n    void navigator.clipboard.readText().then((molfile) => {\n      dispatch({ type: ADD_MOLECULE, molfile });\n    });\n  }, [dispatch]);\n\n  const handleDelete = useCallback(() => {\n    if (molecules[currentIndex]?.key) {\n      onMoleculeIndexChange(0);\n      dispatch({\n        type: DELETE_MOLECULE,\n        payload: { key: molecules[currentIndex].key, assignmentData },\n      });\n    }\n  }, [\n    molecules,\n    currentIndex,\n    onMoleculeIndexChange,\n    dispatch,\n    assignmentData,\n  ]);\n\n  const openPredictSpectraModal = useCallback(() => {\n    modal.show(<PredictSpectraModal molfile={molecules[currentIndex]} />, {\n      position: positions.TOP_CENTER,\n      enableResizing: true,\n      width: 600,\n    });\n  }, [modal, molecules, currentIndex]);\n\n  const floatMoleculeHandler = useCallback(() => {\n    dispatch({\n      type: FLOAT_MOLECULE_OVER_SPECTRUM,\n      payload: { key: molecules[currentIndex].key },\n    });\n  }, [currentIndex, dispatch, molecules]);\n\n  return (\n    <div css={toolbarStyle}>\n      {!actionsOptions.hideExport && (\n        <MenuButton\n          component={<FaFileExport />}\n          toolTip=\"Export As\"\n          items={MOL_EXPORT_MENU}\n          onClick={exportHandler}\n        />\n      )}\n\n      {!actionsOptions.hidePast && (\n        <ToolTip title=\"Paste molfile\" popupPlacement=\"left\">\n          <button className=\"bar-button\" type=\"button\" onClick={handlePaste}>\n            <FaPaste />\n          </button>\n        </ToolTip>\n      )}\n      {!actionsOptions.hideAdd && (\n        <ToolTip title=\"Add Molecule\" popupPlacement=\"left\">\n          <button\n            className=\"bar-button\"\n            type=\"button\"\n            onClick={onOpenMoleculeEditor}\n            data-test-id=\"panel-structures-button-add\"\n          >\n            <FaPlus />\n          </button>\n        </ToolTip>\n      )}\n      {!actionsOptions.hideDelete && (\n        <ToolTip title=\"Delete Molecule\" popupPlacement=\"left\">\n          <button className=\"bar-button\" type=\"button\" onClick={handleDelete}>\n            <FaRegTrashAlt />\n          </button>\n        </ToolTip>\n      )}\n      {!actionsOptions.hidePredict && molecules && molecules.length > 0 && (\n        <ButtonToolTip\n          popupTitle=\"Predict Spectra\"\n          popupPlacement=\"left\"\n          onClick={openPredictSpectraModal}\n        >\n          <SvgNmrFt />\n        </ButtonToolTip>\n      )}\n\n      {molecules?.[currentIndex] && (\n        <ToggleButton\n          key={molecules[currentIndex].isFloat}\n          defaultValue={molecules[currentIndex].isFloat}\n          popupTitle=\"Float Molecule\"\n          popupPlacement=\"left\"\n          onClick={floatMoleculeHandler}\n        >\n          <IoOpenOutline />\n        </ToggleButton>\n      )}\n      <p>\n        {molecules &&\n          molecules.length > 0 &&\n          `${+(currentIndex + 1)} / ${molecules.length}`}{' '}\n      </p>\n    </div>\n  );\n}\n","/** @jsxImportSource @emotion/react */\nimport { css, SerializedStyles } from '@emotion/react';\nimport OCL from 'openchemlib/full';\nimport { useState, useCallback, useEffect, memo, ReactElement } from 'react';\nimport { ResponsiveChart } from 'react-d3-utils';\nimport { MF } from 'react-mf';\nimport OCLnmr from 'react-ocl-nmr';\n\nimport { Molecule } from '../../../data/molecules/Molecule';\nimport { Datum1D, Ranges } from '../../../data/types/data1d';\nimport { Datum2D, Zones } from '../../../data/types/data2d';\nimport { useChartData } from '../../context/ChartContext';\nimport { useDispatch } from '../../context/DispatchContext';\nimport NextPrev from '../../elements/NextPrev';\nimport { positions, useModal } from '../../elements/popup/Modal';\nimport useSpectrum from '../../hooks/useSpectrum';\nimport MoleculeStructureEditorModal from '../../modal/MoleculeStructureEditorModal';\nimport { DISPLAYER_MODE } from '../../reducer/core/Constants';\nimport { SET_MOLECULE } from '../../reducer/types/Types';\n\nimport MoleculePanelHeader, {\n  MoleculeHeaderActionsOptions,\n} from './MoleculePanelHeader';\nimport useAtomAssignment from './useAtomAssignment';\n\nconst styles: Record<\n  'panel' | 'innerPanel' | 'molecule' | 'toolbar' | 'slider' | 'items',\n  SerializedStyles\n> = {\n  panel: css({\n    display: 'flex',\n    overflow: 'auto',\n    flexGrow: 1,\n    width: '100%',\n    height: '100%',\n    flexDirection: 'column',\n  }),\n  innerPanel: css({\n    display: 'flex',\n    flex: '1',\n    flexDirection: 'column',\n    overflow: 'auto',\n  }),\n  molecule: css({\n    display: 'flex',\n    flex: '1',\n  }),\n  toolbar: css({\n    display: 'flex',\n    borderBottom: '0.55px solid rgb(240, 240, 240)',\n    padding: '0px 10px',\n    justifyContent: 'end',\n    height: 22,\n  }),\n  slider: css({\n    display: 'flex',\n    flexDirection: 'column',\n    justifyContent: 'center',\n    alignItems: 'center',\n    flexGrow: 1,\n    minHeight: 0,\n  }),\n  items: css({\n    display: 'flex',\n    flexDirection: 'column',\n    flex: '1 1 0%',\n    height: '100%',\n    minHeight: 0,\n  }),\n};\n\ninterface MoleculePanelInnerProps extends MoleculePanelProps {\n  zones: Zones;\n  ranges: Ranges;\n  molecules: Array<Molecule>;\n  activeTab: string;\n  displayerMode: DISPLAYER_MODE;\n}\n\nfunction MoleculePanelInner({\n  zones,\n  ranges,\n  molecules: moleculesProp,\n  activeTab,\n  displayerMode,\n  onMoleculeChange,\n  actionsOptions,\n  children,\n}: MoleculePanelInnerProps) {\n  const [currentIndex, setCurrentIndex] = useState(0);\n  const [molecules, setMolecules] = useState<any>([]);\n\n  const dispatch = useDispatch();\n  const modal = useModal();\n\n  const {\n    currentDiaIDsToHighlight,\n    handleOnAtomHover,\n    handleOnClickAtom,\n    assignedDiaIDsMerged,\n  } = useAtomAssignment({ zones, ranges, activeTab, displayerMode });\n\n  useEffect(() => {\n    if (moleculesProp) {\n      setMolecules((prevMolecules) => {\n        if (moleculesProp.length > prevMolecules.length) {\n          setCurrentIndex(molecules.length);\n        }\n        return moleculesProp;\n      });\n    }\n  }, [molecules.length, moleculesProp]);\n\n  useEffect(() => {\n    onMoleculeChange?.(molecules[currentIndex] || null);\n  }, [currentIndex, molecules, onMoleculeChange]);\n\n  const handleReplaceMolecule = useCallback(\n    (key, molfile) => {\n      dispatch({ type: SET_MOLECULE, molfile, key });\n    },\n    [dispatch],\n  );\n\n  const openMoleculeEditorHandler = useCallback(\n    (molecule?: Molecule) => {\n      modal.show(<MoleculeStructureEditorModal selectedMolecule={molecule} />, {\n        position: positions.TOP_CENTER,\n        width: 700,\n        height: 500,\n      });\n    },\n    [modal],\n  );\n\n  const moleculeIndexHandler = useCallback((index) => {\n    setCurrentIndex(index);\n  }, []);\n\n  return (\n    <div css={styles.panel}>\n      <MoleculePanelHeader\n        currentIndex={currentIndex}\n        molecules={molecules}\n        onOpenMoleculeEditor={() => openMoleculeEditorHandler()}\n        onMoleculeIndexChange={moleculeIndexHandler}\n        actionsOptions={actionsOptions}\n      />\n      <div css={styles.innerPanel}>\n        <div css={styles.molecule}>\n          <NextPrev\n            onChange={(slideIndex) => setCurrentIndex(slideIndex)}\n            defaultIndex={currentIndex}\n          >\n            {molecules && molecules.length > 0 ? (\n              molecules.map((mol: Molecule, index) => (\n                <div key={mol.key} css={styles.items}>\n                  <div css={styles.toolbar}>\n                    <span>\n                      <MF mf={mol.mf} /> - {mol.mw?.toFixed(2)}\n                    </span>\n                  </div>\n                  <div\n                    css={styles.slider}\n                    className=\"mol-svg-container\"\n                    onDoubleClick={() => openMoleculeEditorHandler(mol)}\n                    style={{\n                      backgroundColor:\n                        (index + 1) % 2 !== 0 ? '#fafafa' : 'white',\n                    }}\n                  >\n                    <ResponsiveChart>\n                      {({ height, width }) => {\n                        return (\n                          <OCLnmr\n                            OCL={OCL}\n                            id={`molSVG${index}`}\n                            width={width}\n                            height={height}\n                            molfile={mol.molfile || ''}\n                            setMolfile={(molfile) =>\n                              handleReplaceMolecule(mol.key, molfile)\n                            }\n                            setSelectedAtom={handleOnClickAtom}\n                            atomHighlightColor={\n                              currentDiaIDsToHighlight &&\n                              currentDiaIDsToHighlight.length > 0\n                                ? 'red'\n                                : '#FFD700'\n                            }\n                            atomHighlightOpacity={0.35}\n                            highlights={\n                              currentDiaIDsToHighlight &&\n                              currentDiaIDsToHighlight.length > 0\n                                ? currentDiaIDsToHighlight\n                                : assignedDiaIDsMerged\n                            }\n                            setHoverAtom={handleOnAtomHover}\n                          />\n                        );\n                      }}\n                    </ResponsiveChart>\n                  </div>\n                </div>\n              ))\n            ) : (\n              <div\n                css={styles.slider}\n                style={{ height: '100%' }}\n                onClick={() => openMoleculeEditorHandler()}\n              >\n                <span>Click to draw molecule</span>\n              </div>\n            )}\n          </NextPrev>\n        </div>\n        {children}\n      </div>\n    </div>\n  );\n}\n\nconst MemoizedMoleculePanel = memo(MoleculePanelInner);\nconst emptyData = { ranges: {}, zones: {} };\n\ninterface MoleculePanelProps {\n  onMoleculeChange?: (molecule: Molecule) => void;\n  children?: ReactElement;\n  actionsOptions?: MoleculeHeaderActionsOptions;\n}\n\nexport default function MoleculePanel({\n  onMoleculeChange,\n  children,\n  actionsOptions,\n}: MoleculePanelProps) {\n  const { molecules, displayerMode, activeTab } = useChartData();\n\n  const data = useSpectrum(emptyData);\n  const ranges: Ranges = (data as Datum1D)?.ranges || {};\n  const zones: Zones = (data as Datum2D)?.zones || {};\n\n  return (\n    <MemoizedMoleculePanel\n      {...{\n        molecules,\n        displayerMode,\n        activeTab,\n        ranges,\n        zones,\n        onMoleculeChange,\n        actionsOptions,\n      }}\n    >\n      {children}\n    </MemoizedMoleculePanel>\n  );\n}\n","/** @jsxImportSource @emotion/react */\nimport { useCallback, useEffect, useMemo, useRef } from 'react';\n\nimport { REFERENCES } from '../../data/constants/References';\nimport { useDispatch } from '../context/DispatchContext';\nimport Button from '../elements/Button';\nimport CloseButton from '../elements/CloseButton';\nimport Label from '../elements/Label';\nimport Select from '../elements/Select';\nimport FormikForm from '../elements/formik/FormikForm';\nimport FormikInput from '../elements/formik/FormikInput';\nimport { ALIGN_SPECTRA } from '../reducer/types/Types';\nimport Events from '../utility/Events';\n\nimport { ModalStyles } from './ModalStyle';\n\nconst baseList = [{ key: 1, value: 'manual', label: 'Manual' }];\n\ninterface AlignSpectraModalProps {\n  onClose?: (element?: string) => void;\n  nucleus: any;\n}\n\nfunction AlignSpectraModal({\n  onClose = () => null,\n  nucleus,\n}: AlignSpectraModalProps) {\n  const refForm = useRef<any>();\n  const dispatch = useDispatch();\n  const List = useMemo(() => {\n    const list = REFERENCES[nucleus]\n      ? Object.entries(REFERENCES[nucleus]).map(\n          (item) => ({\n            key: item[0],\n            value: item[0],\n            label: item[0],\n          }),\n          [],\n        )\n      : [];\n\n    return baseList.concat(list as any);\n  }, [nucleus]);\n  const handleSave = useCallback(() => {\n    refForm.current.submitForm();\n  }, []);\n\n  const submitHandler = useCallback(\n    (values) => {\n      dispatch({ type: ALIGN_SPECTRA, payload: values });\n      onClose();\n    },\n    [dispatch, onClose],\n  );\n\n  useEffect(() => {\n    function handler(event: any) {\n      const [from, to] = event.range;\n      refForm.current.setValues({ ...refForm.current.values, from, to });\n    }\n\n    Events.on('brushEnd', handler);\n\n    return () => {\n      Events.off('brushEnd', handler);\n    };\n  }, []);\n\n  const optionChangeHandler = useCallback(\n    (id) => {\n      const value = REFERENCES[nucleus][id];\n      const { delta = 0, ...resValues } = value || { delta: 0 };\n      refForm.current.setValues({\n        ...refForm.current.values,\n        targetX: delta,\n        ...resValues,\n      });\n    },\n    [nucleus],\n  );\n\n  return (\n    <div css={ModalStyles}>\n      <div className=\"header handle\">\n        <span>Spectra calibration</span>\n        <CloseButton onClick={onClose} className=\"close-bt\" />\n      </div>\n      <div className=\"inner-content\" style={{ flex: 1 }}>\n        <FormikForm\n          ref={refForm}\n          initialValues={{ from: -1, to: 1, nbPeaks: 1, targetX: 0 }}\n          onSubmit={submitHandler}\n        >\n          <div className=\"row margin-10\">\n            <span className=\"custom-label\">Options :</span>\n\n            <Select\n              data={List}\n              style={{ width: 270, height: 30, marginBottom: '20px' }}\n              onChange={optionChangeHandler}\n            />\n          </div>\n          <div className=\"row margin-10\">\n            <span className=\"custom-label\">Range :</span>\n            <Label title=\"From : \">\n              <FormikInput name=\"from\" type=\"number\" />\n            </Label>\n            <Label title=\"To : \">\n              <FormikInput name=\"to\" type=\"number\" />\n            </Label>\n          </div>\n          <div className=\" margin-10\">\n            <Label className=\"custom-label\" title=\"Number of Peaks : \">\n              <FormikInput name=\"nbPeaks\" type=\"number\" />\n            </Label>\n          </div>\n          <div className=\" margin-10\">\n            <Label className=\"custom-label\" title=\"Target PPM :\">\n              <FormikInput name=\"targetX\" type=\"number\" />\n            </Label>\n          </div>\n        </FormikForm>\n      </div>\n      <div className=\"footer-container\">\n        <Button.Done onClick={handleSave}>Done</Button.Done>\n      </div>\n    </div>\n  );\n}\n\nexport default AlignSpectraModal;\n","export default function calculate(code: string, args = null) {\n  try {\n    return new Function('args', `return ${code}`)(args);\n  } catch (e) {\n    return e;\n  }\n}\n","/** @jsxImportSource @emotion/react */\nimport { useFormikContext } from 'formik';\nimport { memo, useEffect, useState } from 'react';\n\nimport Eval from '../../utility/Evaluate';\n\nconst initCode = `function run(data) {\n\n  return JSON.stringify(data,undefined, 2);\n  \n}(args);\n`;\n\ninterface MultipleAnalysisCodeEditorProps {\n  data: any;\n}\n\nfunction MultipleAnalysisCodeEditor({ data }: MultipleAnalysisCodeEditorProps) {\n  const { values, setFieldValue } = useFormikContext<any>();\n  const [code, setCode] = useState(values.code ? values.code : initCode);\n  const [result, setResult] = useState('');\n\n  useEffect(() => {\n    const evalResult = Eval(code, data);\n    if (evalResult instanceof Error) {\n      setResult(evalResult.message);\n    } else {\n      setFieldValue('code', code);\n      setResult(evalResult);\n    }\n  }, [code, data, setFieldValue]);\n\n  return (\n    <div style={{ marginTop: '20px' }}>\n      <textarea\n        value={code}\n        onChange={(event) => setCode(event.target.value)}\n        style={{\n          fontFamily: '\"Fira code\", \"Fira Mono\", monospace',\n          fontSize: 12,\n          padding: '1em',\n          width: '90%',\n          backgroundColor: '#fcfcfc',\n          marginBottom: '10px',\n          minHeight: '100px',\n          overflow: 'auto',\n          maxHeight: '200px',\n        }}\n      />\n      <p style={{ marginBottom: '5px' }}>Result:</p>\n\n      <textarea\n        value={result}\n        readOnly\n        style={{\n          border: '0.55px solid #f3f3f3',\n          fontFamily: '\"Fira code\", \"Fira Mono\", monospace',\n          fontSize: 12,\n          padding: '1em',\n          width: '90%',\n          marginBottom: '10px',\n          minHeight: '100px',\n          overflow: 'auto',\n          maxHeight: '200px',\n        }}\n      />\n    </div>\n  );\n}\n\nexport default memo(MultipleAnalysisCodeEditor);\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport {\n  forwardRef,\n  useCallback,\n  useEffect,\n  useImperativeHandle,\n  useMemo,\n  useRef,\n  useState,\n} from 'react';\nimport { FaPlus } from 'react-icons/fa';\nimport * as Yup from 'yup';\n\nimport { COLUMNS_TYPES } from '../../../data/data1d/MultipleAnalysis';\nimport { useDispatch } from '../../context/DispatchContext';\nimport FormikForm from '../../elements/formik/FormikForm';\nimport FormikInput from '../../elements/formik/FormikInput';\nimport { SET_ANALYZE_SPECTRA_COLUMNS } from '../../reducer/types/Types';\n\nimport MultipleAnalysisCodeEditor from './MultipleAnalysisCodeEditor';\n\nconst styles = css`\n  width: 100%;\n  thead {\n    border-bottom: 1px solid lightgray;\n    background-color: #fafafa;\n    font-size: 12px;\n  }\n\n  td,\n  th {\n    padding: 3px 5px;\n    text-align: center;\n  }\n\n  .operation-col {\n    width: 30px;\n  }\n\n  .input {\n    height: 25px !important;\n    width: 100% !important;\n    margin: 0 !important;\n  }\n\n  .input.disbale {\n    background-color: #e8e8e8;\n    border-radius: 5px;\n  }\n\n  .label,\n  .index {\n    width: 100px;\n  }\n\n  .counter {\n    width: 50px;\n  }\n\n  .add {\n    background-color: transparent;\n    border: 0;\n    outline: none;\n    svg {\n      font-szie: 14px;\n      fill: green;\n    }\n  }\n`;\n\n// TODO: remove this hacky use of ref.\nfunction MultipleSpectraAnalysisPreferences({ data, onAfterSave }, ref: any) {\n  const dispatch = useDispatch();\n  const refForm = useRef<any>();\n  const [columns, setColumns] = useState({});\n\n  useImperativeHandle(ref, () => ({\n    saveSetting() {\n      refForm.current.submitForm();\n    },\n  }));\n\n  useEffect(() => {\n    const result = Object.keys(data.columns).reduce((acc, key) => {\n      acc[key] = { ...data.columns[key], tempKey: key };\n      return acc;\n    }, {});\n    setColumns(result);\n    refForm.current.setValues({ columns: result, code: data.code });\n  }, [data]);\n\n  const columnsKeys = useMemo(() => {\n    return Object.keys(columns);\n  }, [columns]);\n\n  const preferncesSchema = useMemo(() => {\n    function columnSchema() {\n      return columnsKeys.reduce((acc, key) => {\n        acc[key] = Yup.object().shape({\n          tempKey: Yup.string()\n            .required()\n            .test('unique', 'must be unique column name', (colmnName) => {\n              const formData = refForm.current.values.columns;\n              return (\n                Object.keys(formData).reduce((acc, colKey) => {\n                  if (formData[colKey].tempKey === colmnName) {\n                    (acc as any[]).push(colmnName);\n                  }\n                  return acc;\n                }, []).length === 1\n              );\n            }),\n          ...(columns[key].type === COLUMNS_TYPES.FORMULA\n            ? { formula: Yup.string().required() }\n            : {}),\n          index: Yup.string().required(),\n        });\n        return acc;\n      }, {});\n    }\n\n    return Yup.object().shape({\n      columns: Yup.object().shape(columnSchema()),\n    });\n  }, [columns, columnsKeys, refForm]);\n\n  const submitHandler = useCallback(\n    (values) => {\n      onAfterSave?.(true);\n      const result = Object.entries(values.columns).reduce(\n        (acc, [key, value]) => {\n          acc[key] = { ...columns[key], ...(value as any) };\n          return acc;\n        },\n        {},\n      );\n      dispatch({\n        type: SET_ANALYZE_SPECTRA_COLUMNS,\n        payload: { code: values.code, columns: result },\n      });\n    },\n    [columns, dispatch, onAfterSave],\n  );\n\n  const addNewColumn = useCallback((index) => {\n    setColumns((prevData) => {\n      return {\n        ...prevData,\n        [`temp${index}`]: {\n          tempKey: '',\n          type: 'FORMULA',\n          valueKey: 'value',\n          formula: '',\n          index: index,\n        },\n      };\n    });\n  }, []);\n\n  return (\n    <FormikForm\n      ref={refForm}\n      initialValues={{ columns, code: null }}\n      validationSchema={preferncesSchema}\n      onSubmit={submitHandler}\n    >\n      {columnsKeys && (\n        <table css={styles}>\n          <thead>\n            <tr>\n              <th className=\"counter\">#</th>\n              <th className=\"label\">Label</th>\n              <th>value</th>\n              <th className=\"index\">index</th>\n            </tr>\n          </thead>\n          <tbody>\n            {columnsKeys.map((key, index) => {\n              return (\n                <tr key={key}>\n                  <td className=\"counter\">{index + 1}</td>\n                  <td className=\"label\">\n                    <FormikInput\n                      key={key}\n                      name={`columns.${key}.tempKey`}\n                      value={columns[key].tempKey}\n                    />\n                  </td>\n                  <td>\n                    {columns[key].type === COLUMNS_TYPES.FORMULA ? (\n                      <FormikInput\n                        name={`columns.${key}.formula`}\n                        value={columns[key].formula}\n                      />\n                    ) : (\n                      <div className=\"input disbale\" />\n                    )}\n                  </td>\n                  <td className=\"index\">\n                    <FormikInput\n                      name={`columns.${key}.index`}\n                      value={columns[key].index}\n                    />\n                  </td>\n                  <td className=\"operation-col\">\n                    {columnsKeys.length === index + 1 && (\n                      <button\n                        className=\"add\"\n                        type=\"button\"\n                        onClick={() => addNewColumn(index + 1)}\n                      >\n                        <FaPlus />\n                      </button>\n                    )}\n                  </td>\n                </tr>\n              );\n            })}\n          </tbody>\n        </table>\n      )}\n      <MultipleAnalysisCodeEditor data={data} />\n    </FormikForm>\n  );\n}\n\nexport default forwardRef(MultipleSpectraAnalysisPreferences);\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useLayoutEffect, useRef } from 'react';\n\nimport { DropDownListProps } from './DropDownButton';\n\nconst styles = {\n  container: css`\n    background-color: white;\n    position: absolute;\n    height: auto;\n    z-index: 99999999999999;\n    box-shadow: 0 19px 38px rgba(0, 0, 0, 0.3), 0 15px 12px rgba(0, 0, 0, 0.22);\n    border-radius: 10px;\n    margin-bottom: 20px;\n    overflow: hidden;\n  `,\n  ul: css`\n    list-style-type: none;\n    padding: 0;\n    margin: 0;\n  `,\n  li: css`\n    text-align: center;\n    color: black;\n    border-bottom: 0.55px solid #f9f9f9;\n    min-width: 150px;\n    width: fit-content;\n    &:last-of-type {\n      border-bottom: none;\n    }\n\n    &:hover {\n      background-color: gray;\n      color: white;\n    }\n  `,\n  label: css`\n    padding: 5px 20px;\n    display: block;\n  `,\n};\n\nfunction DropDownList({\n  data = [],\n  onSelect,\n  renderItem = null,\n}: DropDownListProps) {\n  const ref = useRef<HTMLDivElement>(null);\n  useLayoutEffect(() => {\n    if (ref.current) {\n      const containerRect = ref.current?.getBoundingClientRect();\n      if (containerRect.right > window.innerWidth) {\n        ref.current.style.right = `${\n          containerRect.right - window.innerWidth\n        }px`;\n      }\n    }\n  }, []);\n  return (\n    <div css={styles.container} ref={ref}>\n      <ul css={styles.ul}>\n        {data.map((item, index) => (\n          <li css={styles.li} key={item.key} onClick={() => onSelect(index)}>\n            {renderItem?.(item) || <span css={styles.label}>{item.label}</span>}\n          </li>\n        ))}\n      </ul>\n    </div>\n  );\n}\n\nexport default DropDownList;\n","/** @jsxImportSource @emotion/react */\nimport { css, CSSObject } from '@emotion/react';\nimport { ReactNode, useCallback, useEffect, useRef, useState } from 'react';\nimport { FaEllipsisH } from 'react-icons/fa';\n\nimport DropDownList from './DropDownList';\n\nconst styles = {\n  container: css`\n    position: relative;\n    padding: 2px;\n    border-radius: 10px;\n    width: max-content;\n    display: inline-block;\n    border: 0.55px solid lightgray;\n    font-size: 10px;\n  `,\n  button: css`\n    width: 100%;\n  `,\n};\n\nexport interface DropDownListItem {\n  key: string;\n  label: string;\n  index?: number;\n}\n\nexport interface DropDownListProps {\n  data: Array<DropDownListItem>;\n  onSelect: (index: number) => void;\n  renderItem?: ((item: DropDownListItem) => ReactNode) | null;\n}\n\ninterface DropDownButtonProps extends Omit<DropDownListProps, 'onSelect'> {\n  selectedKey?: string;\n  onSelect?: (item: DropDownListItem) => void;\n  formatSelectedValue?: (Item: DropDownListItem) => string;\n  style?: CSSObject;\n}\n\nfunction DropDownButton(props: DropDownButtonProps) {\n  const {\n    data,\n    selectedKey,\n    onSelect,\n    formatSelectedValue = (item) => item.label,\n    renderItem = null,\n    style,\n  } = props;\n  const [open, setOpen] = useState(false);\n  const [item, setItem] = useState<DropDownListItem | null>();\n\n  const drop = useRef<HTMLDivElement>(null);\n\n  useEffect(() => {\n    if (selectedKey) {\n      const item = data.find((i) => i.key === selectedKey) || null;\n      setItem(item);\n    }\n  }, [selectedKey, data]);\n\n  useEffect(() => {\n    function handleClick() {\n      setOpen(false);\n    }\n    window.addEventListener('click', handleClick);\n    return () => window.removeEventListener('click', handleClick);\n  }, []);\n\n  const selectHandler = useCallback(\n    (index) => {\n      setItem(data[index]);\n      onSelect?.(data[index]);\n    },\n    [data, onSelect],\n  );\n\n  return (\n    <div className=\"dropdown\" ref={drop} css={[styles.container, style]}>\n      <button\n        css={styles.button}\n        type=\"button\"\n        onClick={(event) => {\n          setOpen((open) => !open);\n          event.stopPropagation();\n        }}\n      >\n        {!item ? <FaEllipsisH /> : formatSelectedValue(item)}\n      </button>\n      {open && (\n        <DropDownList\n          data={data}\n          onSelect={selectHandler}\n          renderItem={renderItem}\n        />\n      )}\n    </div>\n  );\n}\n\nexport default DropDownButton;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback } from 'react';\n\nimport {\n  COLUMNS_TYPES,\n  COLUMNS_VALUES_KEYS,\n} from '../../../data/data1d/MultipleAnalysis';\nimport { useDispatch } from '../../context/DispatchContext';\nimport DeleteButton from '../../elements/Tab/DeleteButton';\nimport DropDownButton from '../../elements/dropDownButton/DropDownButton';\nimport { DELETE_ANALYZE_SPECTRA_RANGE } from '../../reducer/types/Types';\n\nconst styles = (styles) => css`\n  position: relative;\n\n  .delete {\n    position: absolute;\n    right: 0px;\n    top: 0px;\n  }\n\n  .container {\n    display: flex;\n    flex-direction: column;\n    padding: 0;\n    margin: 0;\n  }\n\n  .dropDown-container {\n    justify-content: flex-start;\n    align-items: flex-start;\n  }\n\n  .label-container {\n    flex: 1;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    flex-direction: column;\n    min-height: 45px;\n  }\n\n  .label {\n    text-align: center;\n  }\n\n  ${styles}\n`;\n\nconst columnsFilters: Array<{ key: string; label: string }> = [\n  { key: COLUMNS_VALUES_KEYS.RELATIVE, label: 'Relative' },\n  { key: COLUMNS_VALUES_KEYS.ABSOLUTE, label: 'Absolute' },\n  { key: COLUMNS_VALUES_KEYS.MIN, label: 'Min Intensity' },\n  { key: COLUMNS_VALUES_KEYS.MAX, label: 'Max Intensity' },\n];\n\ninterface ColumnHeaderProps {\n  charLabel: string;\n  rangeLabel: string;\n  onColumnFilter: (element: any) => void;\n  data: {\n    type: string;\n    valueKey: string;\n  };\n}\n\nfunction ColumnHeader({\n  charLabel,\n  rangeLabel,\n  data,\n  onColumnFilter,\n}: ColumnHeaderProps) {\n  const dispatch = useDispatch();\n\n  const deleteHandler = useCallback(() => {\n    dispatch({ type: DELETE_ANALYZE_SPECTRA_RANGE, colKey: charLabel });\n  }, [charLabel, dispatch]);\n\n  return (\n    <div css={styles}>\n      <div className=\"container\">\n        {data.type === COLUMNS_TYPES.NORMAL && (\n          <div className=\"dropDown-container\">\n            <DropDownButton\n              data={columnsFilters}\n              formatSelectedValue={(item) => item.label.substring(0, 3)}\n              selectedKey={data.valueKey}\n              onSelect={onColumnFilter}\n            />\n          </div>\n        )}\n        <div className=\"label-container\">\n          <span className=\"label\"> {charLabel}</span>\n          <span className=\"label\">{rangeLabel}</span>\n        </div>\n      </div>\n      <DeleteButton onDelete={deleteHandler} />\n    </div>\n  );\n}\n\nexport default ColumnHeader;\n","import lodashGet from 'lodash/get';\nimport { useMemo, memo, useCallback, Fragment } from 'react';\n\nimport { useDispatch } from '../../context/DispatchContext';\nimport ReactTable from '../../elements/ReactTable/ReactTable';\nimport addCustomColumn, {\n  CustomColumn,\n} from '../../elements/ReactTable/utility/addCustomColumn';\nimport { FILTER_SPECTRA_COLUMN } from '../../reducer/types/Types';\nimport Eval from '../../utility/Evaluate';\nimport { useFormatNumberByNucleus } from '../../utility/FormatNumber';\nimport NoTableData from '../extra/placeholder/NoTableData';\n\nimport ColumnHeader from './ColumnHeader';\n\ninterface MultipleSpectraAnalysisTableProps {\n  data: any;\n  activeTab: string;\n}\n\nfunction MultipleSpectraAnalysisTable({\n  data,\n  activeTab,\n}: MultipleSpectraAnalysisTableProps) {\n  const format = useFormatNumberByNucleus(activeTab);\n\n  const codeEvaluation = useMemo(() => {\n    const code = lodashGet(data, 'code', '');\n    return Eval(code, data);\n  }, [data]);\n\n  const dispatch = useDispatch();\n\n  const columnFilterHandler = useCallback(\n    (columnKey, valueKey) => {\n      dispatch({\n        type: FILTER_SPECTRA_COLUMN,\n        payload: {\n          columnKey,\n          valueKey,\n        },\n      });\n    },\n    [dispatch],\n  );\n\n  const tableColumns = useMemo(() => {\n    const columns: CustomColumn[] = [\n      {\n        Header: '#',\n        index: 0,\n        Cell: ({ row }) => row.index + 1,\n      },\n    ];\n\n    function cellHandler(row, columnKey, valueKey) {\n      const value = row.original[columnKey][valueKey];\n      const result =\n        value instanceof Error ? (\n          <span style={{ color: 'red' }}>{value.message}</span>\n        ) : (\n          format(value)\n        );\n      return result;\n    }\n\n    function headerHandler(columnData, columnKey) {\n      return (\n        <ColumnHeader\n          charLabel={columnKey}\n          data={columnData}\n          onColumnFilter={(item) => columnFilterHandler(columnKey, item.key)}\n          rangeLabel={\n            columnData.from && columnData.to\n              ? `${format(columnData.from)} - ${format(columnData.to)}`\n              : ''\n          }\n        />\n      );\n    }\n\n    if (data.columns) {\n      Object.keys(data.columns).forEach((columnKey) => {\n        const { valueKey, index: columnIndex } = data.columns[columnKey];\n        addCustomColumn(columns, {\n          index: columnIndex + 1,\n          Cell: ({ row }) => cellHandler(row, columnKey, valueKey),\n          Header: () => headerHandler(data.columns[columnKey], columnKey),\n          id: columnKey,\n        });\n      });\n    }\n    return columns.sort((object1, object2) => object1.index - object2.index);\n  }, [columnFilterHandler, data.columns, format]);\n\n  return data.values && data.values.length > 0 ? (\n    <Fragment>\n      <ReactTable data={data.values} columns={tableColumns} />\n      <div\n        style={{\n          width: '100%',\n          padding: '10px',\n        }}\n        // eslint-disable-next-line react/no-danger\n        dangerouslySetInnerHTML={{ __html: codeEvaluation }}\n      />\n    </Fragment>\n  ) : (\n    <NoTableData />\n  );\n}\n\nexport default memo(MultipleSpectraAnalysisTable);\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { SvgNmrOverlay } from 'cheminfo-font';\nimport { useCallback, useState, useRef, memo, useMemo } from 'react';\nimport { FaFileExport } from 'react-icons/fa';\nimport { IoPulseOutline } from 'react-icons/io5';\n\nimport {\n  getDataAsString,\n  SpectraAnalysis,\n} from '../../../data/data1d/MultipleAnalysis';\nimport { useChartData } from '../../context/ChartContext';\nimport { useDispatch } from '../../context/DispatchContext';\nimport Button from '../../elements/ButtonToolTip';\nimport ToggleButton from '../../elements/ToggleButton';\nimport { positions, useAlert } from '../../elements/popup/Alert';\nimport { useModal } from '../../elements/popup/Modal';\nimport AlignSpectraModal from '../../modal/AlignSpectraModal';\nimport { RESET_SELECTED_TOOL } from '../../reducer/types/Types';\nimport Events from '../../utility/Events';\nimport { copyTextToClipboard } from '../../utility/Export';\nimport { tablePanelStyle } from '../extra/BasicPanelStyle';\nimport DefaultPanelHeader from '../header/DefaultPanelHeader';\nimport PreferencesHeader from '../header/PreferencesHeader';\n\nimport MultipleSpectraAnalysisPreferences from './MultipleSpectraAnalysisPreferences';\nimport MultipleSpectraAnalysisTable from './MultipleSpectraAnalysisTable';\n\ninterface MultipleSpectraAnalysisPanelInnerProps {\n  activeTab: string;\n  spectraAnalysis: SpectraAnalysis;\n}\n\nfunction MultipleSpectraAnalysisPanelInner({\n  activeTab,\n  spectraAnalysis,\n}: MultipleSpectraAnalysisPanelInnerProps) {\n  const [isFlipped, setFlipStatus] = useState(false);\n  const settingRef = useRef<any>();\n  const alert = useAlert();\n  const modal = useModal();\n  const dispatch = useDispatch();\n\n  const data = useMemo<any>(() => {\n    const {\n      values,\n      options: { columns, code },\n    } = spectraAnalysis[activeTab] || {\n      values: {},\n      options: { columns: {}, code: null },\n    };\n    return { values: Object.values(values), columns, code };\n  }, [activeTab, spectraAnalysis]);\n\n  const settingsPanelHandler = useCallback(() => {\n    setFlipStatus(!isFlipped);\n  }, [isFlipped]);\n\n  const saveSettingHandler = useCallback(() => {\n    settingRef.current.saveSetting();\n  }, []);\n\n  const afterSaveHandler = useCallback(() => {\n    setFlipStatus(false);\n  }, []);\n\n  const showTrackerHandler = useCallback((flag) => {\n    Events.emit('showYSpectraTrackers', flag);\n  }, []);\n  const openAlignSpectra = useCallback(() => {\n    dispatch({ type: RESET_SELECTED_TOOL });\n    modal.show(<AlignSpectraModal nucleus={activeTab} />, {\n      isBackgroundBlur: false,\n      position: positions.TOP_CENTER,\n      width: 500,\n    });\n  }, [activeTab, modal, dispatch]);\n\n  const copyToClipboardHandler = useCallback(() => {\n    void (async () => {\n      const data = getDataAsString(spectraAnalysis, activeTab);\n      const success = await copyTextToClipboard(data);\n      if (success) {\n        alert.success('Data copied to clipboard');\n      } else {\n        alert.error('copy to clipboard failed');\n      }\n    })();\n  }, [activeTab, alert, spectraAnalysis]);\n\n  return (\n    <div\n      css={[\n        tablePanelStyle,\n        isFlipped &&\n          css`\n            .table-container th {\n              position: relative;\n            }\n          `,\n      ]}\n    >\n      {!isFlipped && (\n        <DefaultPanelHeader\n          deleteToolTip=\"Delete All Peaks\"\n          showSettingButton\n          canDelete={false}\n          onSettingClick={settingsPanelHandler}\n        >\n          <Button\n            popupTitle=\"Copy To Clipboard\"\n            // style={styles.button}\n            onClick={copyToClipboardHandler}\n          >\n            <FaFileExport />\n          </Button>\n          <Button\n            popupTitle=\"Spectra calibration\"\n            // style={styles.button}\n            onClick={openAlignSpectra}\n          >\n            <SvgNmrOverlay style={{ fontSize: '18px' }} />\n          </Button>\n          <ToggleButton\n            popupTitle=\"Y Spectra Tracker\"\n            popupPlacement=\"right\"\n            onClick={showTrackerHandler}\n          >\n            <IoPulseOutline />\n          </ToggleButton>\n        </DefaultPanelHeader>\n      )}\n      {isFlipped && (\n        <PreferencesHeader\n          onSave={saveSettingHandler}\n          onClose={settingsPanelHandler}\n        />\n      )}\n      <div className=\"inner-container\">\n        {!isFlipped ? (\n          <MultipleSpectraAnalysisTable data={data} activeTab={activeTab} />\n        ) : (\n          <MultipleSpectraAnalysisPreferences\n            data={data}\n            onAfterSave={afterSaveHandler}\n            ref={settingRef}\n          />\n        )}\n      </div>\n    </div>\n  );\n}\n\nconst MemoizedMultipleSpectraAnalysisPanel = memo(\n  MultipleSpectraAnalysisPanelInner,\n);\n\nexport default function MultipleSpectraAnalysisPanel() {\n  const { activeTab, spectraAnalysis, displayerKey } = useChartData();\n\n  if (!activeTab) {\n    return <div />;\n  }\n\n  return (\n    <MemoizedMultipleSpectraAnalysisPanel\n      {...{ activeTab, spectraAnalysis, displayerKey }}\n    />\n  );\n}\n","import {\n  useEffect,\n  useCallback,\n  useImperativeHandle,\n  useRef,\n  CSSProperties,\n  memo,\n  forwardRef,\n} from 'react';\n\nimport { usePreferences } from '../../context/PreferencesContext';\nimport IsotopesViewer from '../../elements/IsotopesViewer';\nimport FormikColumnFormatField from '../../elements/formik/FormikColumnFormatField';\nimport FormikForm from '../../elements/formik/FormikForm';\nimport { useAlert } from '../../elements/popup/Alert';\nimport useNucleus from '../../hooks/useNucleus';\nimport { getValue as getValueByKeyPath } from '../../utility/LocalStorage';\nimport { peaksDefaultValues } from '../extra/preferences/defaultValues';\n\nconst styles: Record<\n  'container' | 'groupContainer' | 'row' | 'header' | 'inputLabel' | 'input',\n  CSSProperties\n> = {\n  container: {\n    padding: 10,\n    backgroundColor: '#f1f1f1',\n    height: '100%',\n    overflowY: 'auto',\n  },\n  groupContainer: {\n    padding: '5px',\n    borderRadius: '5px',\n    margin: '10px 0px',\n    backgroundColor: 'white',\n  },\n  row: {\n    display: 'flex',\n    margin: '5px 0px',\n  },\n  header: {\n    borderBottom: '1px solid #e8e8e8',\n    paddingBottom: '5px',\n    fontWeight: 'bold',\n    color: '#4a4a4a',\n  },\n  inputLabel: {\n    flex: 2,\n    fontSize: '11px',\n    fontWeight: 'bold',\n    color: '#232323',\n  },\n  input: {\n    width: '30%',\n    textAlign: 'center',\n  },\n};\n\nconst formatFields: Array<{\n  id: number;\n  label: string;\n  checkController: string;\n  formatController: string;\n}> = [\n  {\n    id: 1,\n    label: 'Peak Number :',\n    checkController: 'showPeakNumber',\n    formatController: 'peakNumberFormat',\n  },\n  {\n    id: 2,\n    label: 'Peak Index : ',\n    checkController: 'showPeakIndex',\n    formatController: 'peakIndexFormat',\n  },\n  {\n    id: 3,\n    label: 'δ (ppm) :',\n    checkController: 'showDeltaPPM',\n    formatController: 'deltaPPMFormat',\n  },\n  {\n    id: 4,\n    label: 'δ (Hz) :',\n    checkController: 'showDeltaHz',\n    formatController: 'deltaHzFormat',\n  },\n  {\n    id: 5,\n    label: 'Peak Width',\n    checkController: 'showPeakWidth',\n    formatController: 'peakWidthFormat',\n  },\n  {\n    id: 6,\n    label: 'Intensity :',\n    checkController: 'showIntensity',\n    formatController: 'intensityFormat',\n  },\n];\ninterface PeaksPreferencesInnerProps {\n  nucleus: Array<string>;\n  preferences: any;\n  innerRef: any;\n}\n\nfunction PeaksPreferencesInner({\n  nucleus,\n  preferences,\n  innerRef,\n}: PeaksPreferencesInnerProps) {\n  const alert = useAlert();\n  const formRef = useRef<any>(null);\n\n  const updateValues = useCallback(() => {\n    if (nucleus) {\n      const defaultValues = nucleus.reduce((acc, nucleusLabel) => {\n        acc[nucleusLabel] = peaksDefaultValues;\n        return acc;\n      }, {});\n      const peaksPreferences = getValueByKeyPath(\n        preferences.current,\n        `formatting.panels.peaks`,\n      );\n      formRef.current.setValues(\n        peaksPreferences ? peaksPreferences : defaultValues,\n      );\n    }\n  }, [nucleus, preferences]);\n\n  useEffect(() => {\n    updateValues();\n  }, [updateValues]);\n\n  const saveHandler = useCallback(\n    (values) => {\n      preferences.dispatch({\n        type: 'SET_PANELS_PREFERENCES',\n        payload: { key: 'peaks', value: values },\n      });\n      alert.success('Peaks preferences saved successfully');\n    },\n    [alert, preferences],\n  );\n\n  useImperativeHandle(\n    innerRef,\n    () => ({\n      saveSetting: () => {\n        formRef.current.submitForm();\n      },\n    }),\n    [],\n  );\n\n  return (\n    <div style={styles.container}>\n      <FormikForm onSubmit={saveHandler} ref={formRef}>\n        {nucleus?.map((nucleusLabel) => (\n          <div key={nucleusLabel} style={styles.groupContainer}>\n            <IsotopesViewer style={styles.header} value={nucleusLabel} />\n            {formatFields.map((field) => (\n              <FormikColumnFormatField\n                key={field.id}\n                label={field.label}\n                checkControllerName={`${nucleusLabel}.${field.checkController}`}\n                formatControllerName={`${nucleusLabel}.${field.formatController}`}\n                hideFormat={field.formatController === 'deltaPPMFormat'}\n              />\n            ))}\n          </div>\n        ))}\n      </FormikForm>\n    </div>\n  );\n}\n\nconst MemoizedPeaksPreferences = memo(PeaksPreferencesInner);\n\n// TODO: remove this hacky use of ref.\nfunction PeaksPreferences(props, ref: any) {\n  const nucleus = useNucleus();\n  const preferences = usePreferences();\n  return (\n    <MemoizedPeaksPreferences innerRef={ref} {...{ nucleus, preferences }} />\n  );\n}\n\nexport default forwardRef(PeaksPreferences);\n","import { useCallback, useMemo, memo } from 'react';\nimport { FaRegTrashAlt } from 'react-icons/fa';\n\nimport { useDispatch } from '../../context/DispatchContext';\nimport EditableColumn from '../../elements/EditableColumn';\nimport ReactTable from '../../elements/ReactTable/ReactTable';\nimport addCustomColumn, {\n  CustomColumn,\n} from '../../elements/ReactTable/utility/addCustomColumn';\nimport {\n  DELETE_PEAK_NOTATION,\n  SHIFT_SPECTRUM,\n} from '../../reducer/types/Types';\nimport formatNumber, {\n  useFormatNumberByNucleus,\n} from '../../utility/FormatNumber';\nimport { getValue } from '../../utility/LocalStorage';\nimport NoTableData from '../extra/placeholder/NoTableData';\nimport { peaksDefaultValues } from '../extra/preferences/defaultValues';\n\ninterface PeaksTableProps {\n  activeTab: string;\n  preferences: any;\n  data: any;\n  info: {\n    nucleus: string;\n  };\n}\n\nfunction PeaksTable({ activeTab, preferences, data, info }: PeaksTableProps) {\n  const dispatch = useDispatch();\n  const format = useFormatNumberByNucleus(info.nucleus);\n\n  const deletePeakHandler = useCallback(\n    (e, row) => {\n      e.preventDefault();\n      e.stopPropagation();\n      const params = row.original;\n      dispatch({\n        type: DELETE_PEAK_NOTATION,\n        data: { id: params.id, xIndex: params.xIndex },\n      });\n    },\n    [dispatch],\n  );\n\n  const peaksPreferences = useMemo(\n    () =>\n      getValue(\n        preferences.current,\n        `formatting.panels.peaks.[${activeTab}]`,\n        peaksDefaultValues,\n      ),\n    [activeTab, preferences],\n  );\n\n  const saveDeltaPPMRefsHandler = useCallback(\n    (event, row) => {\n      const shiftValue = parseFloat(event.target.value) - parseFloat(row.value);\n      dispatch({ type: SHIFT_SPECTRUM, shiftValue });\n    },\n    [dispatch],\n  );\n  const COLUMNS: (CustomColumn & { showWhen: string })[] = useMemo(\n    () => [\n      {\n        showWhen: 'showPeakNumber',\n        index: 1,\n        Header: '#',\n        Cell: ({ row }) => row.index + 1,\n        style: { width: '1%', maxWidth: '40px', minWidth: '40px' },\n      },\n      {\n        showWhen: 'showPeakIndex',\n        index: 2,\n        Header: 'index',\n        accessor: (row) =>\n          formatNumber(row.xIndex, peaksPreferences.peakIndexFormat),\n      },\n      {\n        showWhen: 'showDeltaPPM',\n        index: 3,\n        Header: 'δ (ppm)',\n        accessor: (row) => format(row.value),\n        Cell: ({ row }) => (\n          <EditableColumn\n            value={format(row.original.value)}\n            onSave={(event) => saveDeltaPPMRefsHandler(event, row.original)}\n            type=\"number\"\n          />\n        ),\n      },\n      {\n        showWhen: 'showDeltaHz',\n        index: 4,\n        Header: 'δ (Hz)',\n        accessor: (row) =>\n          formatNumber(row.valueHz, peaksPreferences.deltaHzFormat),\n      },\n      {\n        showWhen: 'showIntensity',\n        index: 5,\n        Header: 'Intensity',\n        style: { maxWidth: '80px' },\n        accessor: (row) =>\n          formatNumber(row.intensity, peaksPreferences.intensityFormat),\n      },\n      {\n        showWhen: 'showPeakWidth',\n        index: 6,\n        Header: 'Peak Width',\n        accessor: (row) =>\n          formatNumber(row.peakWidth, peaksPreferences.peakWidthFormat),\n      },\n    ],\n    [format, peaksPreferences, saveDeltaPPMRefsHandler],\n  );\n\n  const initialColumns: CustomColumn[] = useMemo(\n    () => [\n      {\n        index: 20,\n        Header: '',\n        style: {\n          width: '1%',\n          maxWidth: '24px',\n          minWidth: '24px',\n        },\n        id: 'delete-button',\n        Cell: ({ row }) => (\n          <button\n            type=\"button\"\n            className=\"delete-button\"\n            onClick={(e) => deletePeakHandler(e, row)}\n          >\n            <FaRegTrashAlt />\n          </button>\n        ),\n      },\n    ],\n    [deletePeakHandler],\n  );\n\n  const tableColumns = useMemo(() => {\n    let columns = [...initialColumns];\n    for (const col of COLUMNS) {\n      const { showWhen, ...colParams } = col;\n      if (peaksPreferences[showWhen]) {\n        addCustomColumn(columns, colParams);\n      }\n    }\n\n    return columns.sort((object1, object2) => object1.index - object2.index);\n  }, [COLUMNS, initialColumns, peaksPreferences]);\n\n  return data && data.length > 0 ? (\n    <ReactTable\n      data={data}\n      columns={tableColumns}\n      approxItemHeight={20}\n      enableVirtualScroll\n    />\n  ) : (\n    <NoTableData />\n  );\n}\n\nexport default memo(PeaksTable);\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback, useMemo, useState, useRef, memo } from 'react';\n\nimport { Datum1D, Info1D, Peaks } from '../../../data/types/data1d';\nimport { useChartData } from '../../context/ChartContext';\nimport { useDispatch } from '../../context/DispatchContext';\nimport { usePreferences } from '../../context/PreferencesContext';\nimport { useModal } from '../../elements/popup/Modal';\nimport useSpectrum from '../../hooks/useSpectrum';\nimport { DELETE_PEAK_NOTATION } from '../../reducer/types/Types';\nimport { useFormatNumberByNucleus } from '../../utility/FormatNumber';\nimport { tablePanelStyle } from '../extra/BasicPanelStyle';\nimport DefaultPanelHeader from '../header/DefaultPanelHeader';\nimport PreferencesHeader from '../header/PreferencesHeader';\n\nimport PeaksPreferences from './PeaksPreferences';\nimport PeaksTable from './PeaksTable';\n\ninterface PeaksPanelInnerProps {\n  peaks: Peaks;\n  xDomain: number[];\n  activeTab: string;\n  preferences: any;\n  info: Info1D;\n}\n\nfunction PeaksPanelInner({\n  peaks,\n  info,\n  xDomain,\n  activeTab,\n  preferences,\n}: PeaksPanelInnerProps) {\n  const [filterIsActive, setFilterIsActive] = useState(false);\n  const [isFlipped, setFlipStatus] = useState(false);\n  const format = useFormatNumberByNucleus(info.nucleus);\n\n  const dispatch = useDispatch();\n  const modal = useModal();\n\n  const settingRef = useRef<any>();\n\n  const yesHandler = useCallback(() => {\n    dispatch({ type: DELETE_PEAK_NOTATION, data: null });\n  }, [dispatch]);\n\n  const handleDeleteAll = useCallback(() => {\n    modal.showConfirmDialog({\n      message: 'All records will be deleted, Are You sure?',\n      buttons: [{ text: 'Yes', handler: yesHandler }, { text: 'No' }],\n    });\n  }, [modal, yesHandler]);\n\n  const settingsPanelHandler = useCallback(() => {\n    setFlipStatus(!isFlipped);\n  }, [isFlipped]);\n\n  const saveSettingHandler = useCallback(() => {\n    settingRef.current.saveSetting();\n    setFlipStatus(false);\n  }, []);\n\n  const handleOnFilter = useCallback(() => {\n    setFilterIsActive(!filterIsActive);\n  }, [filterIsActive]);\n\n  const filteredPeaks = useMemo(() => {\n    function isInRange(value) {\n      const factor = 100000;\n      return (\n        value * factor >= xDomain[0] * factor &&\n        value * factor <= xDomain[1] * factor\n      );\n    }\n    if (peaks?.values) {\n      const _peaks = filterIsActive\n        ? peaks.values.filter((peak) => isInRange(peak.x))\n        : peaks.values;\n\n      return _peaks\n        .map((peak) => {\n          const value = Number(format(peak.x));\n          return {\n            value: value,\n            valueHz: info?.originFrequency\n              ? Number(value) * info.originFrequency\n              : '',\n            id: peak.id,\n            intensity: peak.y,\n            peakWidth: peak.width ? peak.width : '',\n            isConstantlyHighlighted: isInRange(value),\n          };\n        })\n        .sort((prev, next) => prev.value - next.value);\n    }\n\n    return [];\n  }, [filterIsActive, format, info, peaks, xDomain]);\n\n  return (\n    <div\n      css={[\n        tablePanelStyle,\n        isFlipped &&\n          css`\n            .table-container {\n              table,\n              th {\n                position: relative !important;\n              }\n            }\n          `,\n      ]}\n    >\n      {!isFlipped && (\n        <DefaultPanelHeader\n          counter={peaks?.values?.length}\n          onDelete={handleDeleteAll}\n          deleteToolTip=\"Delete All Peaks\"\n          onFilter={handleOnFilter}\n          filterToolTip={\n            filterIsActive ? 'Show all peaks' : 'Hide peaks out of view'\n          }\n          filterIsActive={filterIsActive}\n          counterFiltered={filteredPeaks.length}\n          showSettingButton\n          onSettingClick={settingsPanelHandler}\n        />\n      )}\n      {isFlipped && (\n        <PreferencesHeader\n          onSave={saveSettingHandler}\n          onClose={settingsPanelHandler}\n        />\n      )}\n      <div className=\"inner-container\">\n        {!isFlipped ? (\n          <PeaksTable\n            data={filteredPeaks}\n            activeTab={activeTab}\n            preferences={preferences}\n            info={info}\n          />\n        ) : (\n          <PeaksPreferences ref={settingRef} />\n        )}\n      </div>\n    </div>\n  );\n}\n\nconst MemoizedPeaksPanel = memo(PeaksPanelInner);\n\nconst emptyData = { peaks: null, info: {} };\n\nexport default function PeaksPanel() {\n  const { xDomain, activeTab } = useChartData();\n  const { peaks, info } = useSpectrum(emptyData) as Datum1D;\n  const preferences = usePreferences();\n\n  return (\n    <MemoizedPeaksPanel {...{ peaks, info, xDomain, activeTab, preferences }} />\n  );\n}\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { FaCopy } from 'react-icons/fa';\n\nimport CloseButton from '../elements/CloseButton';\n\nconst styles = css`\n  overflow: auto;\n  width: 400px;\n  .innerContainer {\n    padding: 5px;\n    width: 100%;\n    height: 180px;\n    border: none;\n  }\n\n  .mainButtonsContainer {\n    padding: 5px 0px;\n    border-bottom: 0.55px solid #ebebeb;\n    display: flex;\n    justify-content: space-between;\n  }\n\n  button {\n    background-color: transparent;\n    border: none;\n    padding: 0 5px;\n  }\n\n  button:disabled {\n    opacity: 0.6;\n  }\n`;\n\ninterface CopyClipboardModalProps {\n  text: string;\n  onClose: () => void;\n  onCopyClick: (text: string) => void;\n}\n\nfunction CopyClipboardModal({\n  text,\n  onClose,\n  onCopyClick,\n}: CopyClipboardModalProps) {\n  return (\n    <div css={styles}>\n      <div className=\"mainButtonsContainer handle\">\n        <button type=\"button\" onClick={() => onCopyClick(text)}>\n          <FaCopy />\n        </button>\n\n        <CloseButton onClick={onClose} />\n      </div>\n      <div\n        className=\"innerContainer\"\n        // eslint-disable-next-line react/no-danger\n        dangerouslySetInnerHTML={{ __html: text }}\n      />\n    </div>\n  );\n}\n\nexport default CopyClipboardModal;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { SvgNmrIntegrate, SvgNmrSum } from 'cheminfo-font';\nimport lodashGet from 'lodash/get';\nimport { rangesToACS } from 'nmr-processing';\nimport { useCallback } from 'react';\nimport { FaFileExport, FaUnlink, FaSitemap, FaChartBar } from 'react-icons/fa';\nimport { ImLink } from 'react-icons/im';\n\nimport { useAssignmentData } from '../../assignment/AssignmentsContext';\nimport { useDispatch } from '../../context/DispatchContext';\nimport { usePreferences } from '../../context/PreferencesContext';\nimport Button from '../../elements/ButtonToolTip';\nimport ToggleButton from '../../elements/ToggleButton';\nimport { useAlert } from '../../elements/popup/Alert';\nimport { useModal } from '../../elements/popup/Modal';\nimport CopyClipboardModal from '../../modal/CopyClipboardModal';\nimport ChangeSumModal from '../../modal/changeSum/ChangeSumModal';\nimport {\n  CHANGE_RANGES_SUM_FLAG,\n  CHANGE_RANGE_SUM,\n  DELETE_RANGE,\n  SHOW_J_GRAPH,\n  SHOW_MULTIPLICTY_TREES,\n  SHOW_RANGES_INTEGRALS,\n} from '../../reducer/types/Types';\nimport { copyHTMLToClipboard } from '../../utility/Export';\nimport { getNumberOfDecimals } from '../../utility/FormatNumber';\nimport DefaultPanelHeader from '../header/DefaultPanelHeader';\n\nconst style = css`\n  .btn {\n    background-color: transparent;\n    border: none;\n  }\n\n  .icon svg {\n    font-size: 12px;\n  }\n\n  .preview-publication-icon svg {\n    font-size: 13px;\n  }\n\n  button {\n    margin-right: 2px;\n  }\n`;\n\nfunction RangesHeader({\n  ranges,\n  info,\n  onUnlink,\n  onFilterActivated,\n  onSettingClick,\n  isFilterActive,\n  filterCounter,\n  showMultiplicityTrees,\n  showJGraph,\n  showRangesIntegrals,\n}) {\n  const dispatch = useDispatch();\n  const modal = useModal();\n  const alert = useAlert();\n  const preferences = usePreferences();\n  const assignmentData = useAssignmentData();\n\n  const currentSum = lodashGet(ranges, 'options.sum', null);\n\n  const changeRangesSumHandler = useCallback(\n    (value) => {\n      dispatch({ type: CHANGE_RANGE_SUM, value });\n      modal.close();\n    },\n    [dispatch, modal],\n  );\n\n  const showChangeRangesSumModal = useCallback(() => {\n    modal.show(\n      <ChangeSumModal\n        onClose={() => modal.close()}\n        onSave={changeRangesSumHandler}\n        header={\n          currentSum\n            ? `Set new Ranges Sum (Current: ${Number(currentSum).toFixed(2)})`\n            : 'Set new Ranges Sum'\n        }\n        sumOptions={ranges?.options}\n      />,\n    );\n  }, [changeRangesSumHandler, currentSum, modal, ranges?.options]);\n\n  const removeAssignments = useCallback(() => {\n    onUnlink();\n  }, [onUnlink]);\n\n  const handleOnRemoveAssignments = useCallback(() => {\n    modal.showConfirmDialog({\n      message: 'All assignments will be removed. Are you sure?',\n      buttons: [{ text: 'Yes', handler: removeAssignments }, { text: 'No' }],\n    });\n  }, [removeAssignments, modal]);\n\n  const handleDeleteAll = useCallback(() => {\n    modal.showConfirmDialog({\n      message: 'All ranges will be deleted. Are You sure?',\n      buttons: [\n        {\n          text: 'Yes',\n          handler: () => {\n            dispatch({\n              type: DELETE_RANGE,\n              payload: { data: { assignmentData } },\n            });\n          },\n        },\n        { text: 'No' },\n      ],\n    });\n  }, [assignmentData, dispatch, modal]);\n\n  const handleSetShowMultiplicityTrees = useCallback(() => {\n    dispatch({ type: SHOW_MULTIPLICTY_TREES });\n  }, [dispatch]);\n\n  const handleShowIntegrals = useCallback(() => {\n    dispatch({ type: SHOW_RANGES_INTEGRALS });\n  }, [dispatch]);\n\n  const handleShowJGraph = useCallback(() => {\n    dispatch({ type: SHOW_J_GRAPH });\n  }, [dispatch]);\n\n  const saveToClipboardHandler = useCallback(\n    (value) => {\n      void (async () => {\n        const success = await copyHTMLToClipboard(value);\n        if (success) {\n          alert.success('Data copied to clipboard');\n        } else {\n          alert.error('copy to clipboard failed');\n        }\n      })();\n    },\n    [alert],\n  );\n\n  const saveAsHTMLHandler = useCallback(() => {\n    const { originFrequency: observedFrequency, nucleus } = info;\n    const format = lodashGet(\n      preferences.current,\n      `formatting.nuclei[${nucleus.toLowerCase()}]`,\n      '0.0',\n    );\n    const nbDecimalDelta = getNumberOfDecimals(format.ppm);\n    const nbDecimalJ = getNumberOfDecimals(format.hz);\n\n    const result = rangesToACS(ranges.values, {\n      nucleus, // '19f'\n      nbDecimalDelta, // 2\n      nbDecimalJ, // 1\n      observedFrequency, //400\n    });\n    modal.show(\n      <CopyClipboardModal\n        text={result}\n        onCopyClick={saveToClipboardHandler}\n        onClose={() => modal.close()}\n      />,\n      {},\n    );\n  }, [info, modal, preferences, ranges.values, saveToClipboardHandler]);\n\n  const changeSumConstantFlagHandler = useCallback(\n    (flag) => {\n      dispatch({\n        type: CHANGE_RANGES_SUM_FLAG,\n        payload: flag,\n      });\n    },\n    [dispatch],\n  );\n\n  return (\n    <div css={style}>\n      <DefaultPanelHeader\n        counter={ranges?.values?.length}\n        onDelete={handleDeleteAll}\n        deleteToolTip=\"Delete All Ranges\"\n        onFilter={onFilterActivated}\n        filterToolTip={\n          isFilterActive ? 'Show all ranges' : 'Hide ranges out of view'\n        }\n        filterIsActive={isFilterActive}\n        counterFiltered={filterCounter}\n        showSettingButton\n        onSettingClick={onSettingClick}\n      >\n        <Button\n          popupTitle=\"Preview publication string\"\n          popupPlacement=\"right\"\n          onClick={saveAsHTMLHandler}\n          className=\"btn preview-publication-icon\"\n        >\n          <FaFileExport />\n        </Button>\n        <Button\n          popupTitle={\n            currentSum\n              ? `Change Ranges Sum (${Number(currentSum).toFixed(2)})`\n              : 'Change Ranges Sum'\n          }\n          popupPlacement=\"right\"\n          onClick={showChangeRangesSumModal}\n          className=\"btn icon\"\n        >\n          <SvgNmrSum />\n        </Button>\n        <Button\n          popupTitle=\"Remove all Assignments\"\n          popupPlacement=\"right\"\n          onClick={handleOnRemoveAssignments}\n          disabled={!ranges || !ranges.values || ranges.values.length === 0}\n          className=\"btn icon\"\n        >\n          <FaUnlink />\n        </Button>\n        <ToggleButton\n          popupTitle={\n            showMultiplicityTrees\n              ? 'Hide Multiplicity Trees in Spectrum'\n              : 'Show Multiplicity Trees in Spectrum'\n          }\n          popupPlacement=\"right\"\n          onClick={handleSetShowMultiplicityTrees}\n          disabled={!ranges || !ranges.values || ranges.values.length === 0}\n        >\n          <FaSitemap style={{ pointerEvents: 'none', fontSize: '12px' }} />\n        </ToggleButton>\n        <ToggleButton\n          popupTitle={showJGraph ? 'Hide J Graph' : 'Show J Graph'}\n          popupPlacement=\"right\"\n          onClick={handleShowJGraph}\n          disabled={!ranges || !ranges.values || ranges.values.length === 0}\n        >\n          <FaChartBar style={{ pointerEvents: 'none', fontSize: '12px' }} />\n        </ToggleButton>\n        <ToggleButton\n          popupTitle={showRangesIntegrals ? 'Hide integrals' : 'Show integrals'}\n          popupPlacement=\"right\"\n          onClick={handleShowIntegrals}\n          defaultValue={showRangesIntegrals}\n          disabled={!ranges || !ranges.values || ranges.values.length === 0}\n        >\n          <SvgNmrIntegrate\n            style={{ pointerEvents: 'none', fontSize: '12px' }}\n          />\n        </ToggleButton>\n\n        <ToggleButton\n          className=\"icon\"\n          popupTitle=\"fix integral values\"\n          popupPlacement=\"right\"\n          onClick={changeSumConstantFlagHandler}\n        >\n          <ImLink />\n        </ToggleButton>\n      </DefaultPanelHeader>\n    </div>\n  );\n}\n\nexport default RangesHeader;\n","import {\n  useEffect,\n  useCallback,\n  useImperativeHandle,\n  useRef,\n  memo,\n  CSSProperties,\n  forwardRef,\n} from 'react';\n\nimport { usePreferences } from '../../context/PreferencesContext';\nimport IsotopesViewer from '../../elements/IsotopesViewer';\nimport Label from '../../elements/Label';\nimport FormikColumnFormatField from '../../elements/formik/FormikColumnFormatField';\nimport FormikForm from '../../elements/formik/FormikForm';\nimport FormikInput from '../../elements/formik/FormikInput';\nimport { useAlert } from '../../elements/popup/Alert';\nimport useNucleus from '../../hooks/useNucleus';\nimport { getValue as getValueByKeyPath } from '../../utility/LocalStorage';\nimport { getRangeDefaultValues } from '../extra/preferences/defaultValues';\n\nconst styles: Record<\n  | 'container'\n  | 'groupContainer'\n  | 'row'\n  | 'header'\n  | 'inputLabel'\n  | 'inputWrapper',\n  CSSProperties\n> = {\n  container: {\n    padding: 10,\n    backgroundColor: '#f1f1f1',\n    height: '100%',\n    overflowY: 'auto',\n  },\n  groupContainer: {\n    padding: '5px',\n    borderRadius: '5px',\n    margin: '10px 0px',\n    backgroundColor: 'white',\n  },\n  row: {\n    display: 'flex',\n    margin: '5px 0px',\n  },\n  header: {\n    borderBottom: '1px solid #e8e8e8',\n    paddingBottom: '5px',\n    fontWeight: 'bold',\n    color: '#4a4a4a',\n  },\n  inputLabel: {\n    flex: 2,\n  },\n\n  inputWrapper: {\n    width: '100px',\n    flex: '4',\n    borderRadius: '5px',\n  },\n};\n\nconst formatFields = [\n  {\n    id: 1,\n    label: 'From :',\n    checkController: 'showFrom',\n    formatController: 'fromFormat',\n  },\n  {\n    id: 2,\n    label: 'To :',\n    checkController: 'showTo',\n    formatController: 'toFormat',\n  },\n  {\n    id: 3,\n    label: 'Absolute :',\n    checkController: 'showAbsolute',\n    formatController: 'absoluteFormat',\n  },\n  {\n    id: 4,\n    label: 'Relative :',\n    checkController: 'showRelative',\n    formatController: 'relativeFormat',\n  },\n];\n\ninterface RangesPreferencesInnerProps {\n  nucleus: Array<string>;\n  preferences: any;\n  innerRef: any;\n}\n\nfunction RangesPreferencesInner({\n  nucleus,\n  preferences,\n  innerRef,\n}: RangesPreferencesInnerProps) {\n  const alert = useAlert();\n  const formRef = useRef<any>();\n\n  const updateValues = useCallback(() => {\n    if (nucleus) {\n      const defaultValues = nucleus.reduce((acc, nucleusLabel) => {\n        acc[nucleusLabel] = getRangeDefaultValues(nucleusLabel);\n        return acc;\n      }, {});\n      const rangesPreferences = getValueByKeyPath(\n        preferences.current,\n        `formatting.panels.ranges`,\n      );\n      formRef.current.setValues(\n        rangesPreferences ? rangesPreferences : defaultValues,\n      );\n    }\n  }, [nucleus, preferences]);\n\n  useEffect(() => {\n    updateValues();\n  }, [updateValues]);\n\n  const saveHandler = useCallback(\n    (values) => {\n      preferences.dispatch({\n        type: 'SET_PANELS_PREFERENCES',\n        payload: { key: 'ranges', value: values },\n      });\n      alert.success('ranges preferences saved successfully');\n    },\n    [alert, preferences],\n  );\n\n  useImperativeHandle(\n    innerRef,\n    () => ({\n      saveSetting: () => {\n        formRef.current.submitForm();\n      },\n    }),\n    [],\n  );\n\n  return (\n    <div style={styles.container}>\n      <FormikForm onSubmit={saveHandler} ref={formRef}>\n        {nucleus?.map((nucleusLabel) => (\n          <div key={nucleusLabel} style={styles.groupContainer}>\n            <IsotopesViewer style={styles.header} value={nucleusLabel} />\n            {formatFields.map((field) => (\n              <FormikColumnFormatField\n                key={field.id}\n                label={field.label}\n                checkControllerName={`${nucleusLabel}.${field.checkController}`}\n                formatControllerName={`${nucleusLabel}.${field.formatController}`}\n              />\n            ))}\n            <Label\n              title=\"J Graph tolerance (Hz) :\"\n              style={{ label: styles.inputLabel, wrapper: styles.inputWrapper }}\n            >\n              <FormikInput\n                name={`${nucleusLabel}.jGraphTolerance`}\n                type=\"number\"\n              />\n            </Label>\n          </div>\n        ))}\n      </FormikForm>\n    </div>\n  );\n}\n\nconst MemoizedRangesPreferences = memo(RangesPreferencesInner);\n\n// TODO: remove this hacky use of ref.\nfunction RangesPreferences(prop, ref: any) {\n  const nucleus = useNucleus();\n\n  const preferences = usePreferences();\n  return (\n    <MemoizedRangesPreferences\n      innerRef={ref}\n      {...{\n        preferences,\n        nucleus,\n      }}\n    />\n  );\n}\n\nexport default forwardRef(RangesPreferences);\n","import lodashGet from 'lodash/get';\nimport { useCallback, useMemo, useState } from 'react';\n\nexport enum SortType {\n  ASCENDING = 'asc',\n  DESCENDING = 'desc',\n  ORIGINAL = 'original',\n}\n\ninterface SortConfig {\n  key: string;\n  direction: SortType;\n}\n\nexport default function useTableSortBy(items, config = null) {\n  const [sortConfig, setSortConfig] = useState<SortConfig | null>(config);\n  const sortedItems = useMemo(() => {\n    const sortableItems = items.slice();\n    if (sortConfig !== null) {\n      sortableItems.sort((a, b) => {\n        if (sortConfig.direction === SortType.ASCENDING) {\n          return (\n            lodashGet(a, sortConfig.key, 0) - lodashGet(b, sortConfig.key, 0)\n          );\n        } else if (sortConfig.direction === SortType.DESCENDING) {\n          return (\n            lodashGet(b, sortConfig.key, 0) - lodashGet(a, sortConfig.key, 0)\n          );\n        }\n        return 0;\n      });\n    }\n    return sortableItems;\n  }, [items, sortConfig]);\n\n  const sortHandler = useCallback(\n    (event) => {\n      const key = event.currentTarget?.id;\n      let direction = SortType.ASCENDING;\n      if (key && sortConfig && sortConfig.key === key) {\n        switch (sortConfig.direction) {\n          case SortType.ASCENDING:\n            direction = SortType.DESCENDING;\n\n            break;\n          case SortType.DESCENDING:\n            direction = SortType.ORIGINAL;\n\n            break;\n          default:\n            direction = SortType.ASCENDING;\n\n            break;\n        }\n      }\n      setSortConfig({ key, direction });\n    },\n    [sortConfig],\n  );\n\n  const isSortedDesc = useCallback(\n    (columnName): { flag: boolean | null; content: string } => {\n      const defaultContent = { flag: null, content: ' ' };\n\n      if (!sortConfig || sortConfig.key !== columnName) {\n        return defaultContent;\n      }\n      switch (sortConfig.direction) {\n        case SortType.DESCENDING:\n          return { flag: true, content: ' ▼' };\n\n        case SortType.ASCENDING:\n          return { flag: false, content: ' ▲' };\n\n        default:\n          return defaultContent;\n      }\n    },\n    [sortConfig],\n  );\n\n  return { items: sortedItems, isSortedDesc, onSort: { onClick: sortHandler } };\n}\n","import lodashGet from 'lodash/get';\n\nimport FormatNumber from '../../../utility/FormatNumber';\n\nexport default class ColumnsHelper {\n  private preferences: any;\n  private defaultPreference: any;\n\n  public constructor(preferences, defaultPreference) {\n    this.preferences = preferences;\n    this.defaultPreference = defaultPreference;\n  }\n\n  public checkPreferences(preferencesToCheck, key) {\n    const val =\n      preferencesToCheck === undefined ||\n      Object.keys(preferencesToCheck).length === 0 ||\n      (preferencesToCheck && preferencesToCheck[key] === true)\n        ? true\n        : false;\n\n    return val;\n  }\n\n  public setCustomColumn(array, index, columnLabel, cellHandler) {\n    array.push({\n      orderIndex: index,\n      Header: columnLabel,\n      sortType: 'basic',\n      Cell: ({ row }) => cellHandler(row),\n    });\n  }\n\n  public addColumn(\n    columns: string,\n    flagKey: string,\n    formatKey: string,\n    columnKey: string,\n    columnLabel: string,\n    columnIndex: string,\n    options: {\n      formatPrefix?: string;\n      formatSuffix?: string;\n      showPrefixSuffixCallback?: (element: any) => boolean;\n    } = {},\n  ) {\n    const preferences = this.preferences || this.defaultPreference;\n\n    if (this.checkPreferences(preferences, flagKey)) {\n      this.setCustomColumn(columns, columnIndex, columnLabel, (row) => {\n        const format =\n          preferences &&\n          Object.prototype.hasOwnProperty.call(preferences, formatKey)\n            ? preferences[formatKey]\n            : this.defaultPreference[formatKey];\n\n        const {\n          formatPrefix = '',\n          formatSuffix = '',\n          showPrefixSuffixCallback = () => true,\n        } = options;\n\n        if (showPrefixSuffixCallback(row)) {\n          return FormatNumber(\n            row.original[columnKey],\n            format,\n            formatPrefix,\n            formatSuffix,\n          );\n        } else {\n          return FormatNumber(row.original[columnKey], format, '', '');\n        }\n      });\n    }\n  }\n}\n\nexport function isColumnVisible(preferences, key) {\n  return lodashGet(preferences, key, false);\n}\n","import { CSSProperties } from 'react';\n\nimport FormatNumber from '../../../utility/FormatNumber';\n\ninterface AbsoluteColumnProps {\n  value: any;\n  onHoverRange: {\n    onMouseEnter: () => void;\n    onMouseLeave: () => void;\n  };\n  rowSpanTags: {\n    rowSpan: any;\n    style: CSSProperties;\n  };\n  format: string;\n}\n\nfunction AbsoluteColumn({\n  rowSpanTags,\n  value,\n  onHoverRange,\n  format,\n}: AbsoluteColumnProps) {\n  return (\n    <td {...rowSpanTags} {...onHoverRange}>\n      {FormatNumber(value, format)}\n    </td>\n  );\n}\n\nexport default AbsoluteColumn;\n","import { useFormikContext } from 'formik';\nimport { useEffect } from 'react';\n\ninterface FormikOnChangeProps {\n  onChange?: (any) => void;\n  enableValidation?: boolean;\n}\n\nconst FormikOnChange = (props: FormikOnChangeProps) => {\n  const { onChange = () => null, enableValidation = true } = props;\n  const { values, errors } = useFormikContext();\n\n  useEffect(() => {\n    if (enableValidation) {\n      if (Object.keys(errors).length === 0) {\n        onChange(values);\n      }\n    } else {\n      onChange(values);\n    }\n  }, [values, enableValidation, errors, onChange]);\n\n  return null;\n};\n\nexport default FormikOnChange;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useFormikContext } from 'formik';\nimport { forwardRef, useCallback, useMemo } from 'react';\nimport { FaPlus } from 'react-icons/fa';\nimport * as Yup from 'yup';\n\nimport { useChartData } from '../../../../context/ChartContext';\nimport Button from '../../../../elements/Button';\nimport FormikForm from '../../../../elements/formik/FormikForm';\nimport FormikInput from '../../../../elements/formik/FormikInput';\nimport { translateMultiplet } from '../../../../panels/extra/utilities/MultiplicityUtilities';\nimport { useFormatNumberByNucleus } from '../../../../utility/FormatNumber';\n\nconst styles = {\n  container: css`\n    text-align: center;\n    width: 100%;\n    height: 100%;\n    padding: 0.4rem;\n  `,\n  inputInfo: css`\n    font-size: 10px;\n    color: black;\n    font-weight: bold;\n  `,\n  infoText: css`\n    padding: 10px;\n    font-size: 13px;\n  `,\n\n  signalContainer: css`\n    border: 0.55px solid #dedede;\n  `,\n  inputContainer: css`\n    display: flex;\n    justify-content: center;\n  `,\n  addSignalBtn: css`\n    margin-top: 15px;\n    margin-top: 20px;\n    width: 100%;\n    background-color: #fcfcfc;\n    border-top: 0.55px solid #dedede;\n    align-items: center;\n    justify-content: center;\n    display: flex;\n    padding: 0.4rem;\n    font-size: 12px;\n\n    & :disabled {\n      opacity: 0.6;\n    }\n  `,\n};\n\ninterface AddSignalFormTabProps {\n  onFocus: (element: any) => void;\n  onBlur?: () => void;\n  range: any;\n}\n\n// TODO: this seems to be a hacky use of ref.\nfunction AddSignalFormTab(\n  { onFocus, onBlur, range }: AddSignalFormTabProps,\n  ref: any,\n) {\n  const { values, setFieldValue } = useFormikContext<any>();\n  const { activeTab } = useChartData();\n  const format = useFormatNumberByNucleus(activeTab);\n\n  const saveHandler = useCallback(\n    (val) => {\n      const newSignal = {\n        multiplicity: 'm',\n        kind: 'signal',\n        delta: Number(val.newSignalDelta),\n        js: [{ multiplicity: translateMultiplet('m'), coupling: '' }],\n      };\n      const _signals = values.signals.slice().concat(newSignal);\n\n      setFieldValue('signals', _signals);\n      setFieldValue('activeTab', String(_signals.length - 1));\n    },\n    [setFieldValue, values.signals],\n  );\n\n  const validation = useMemo(() => {\n    return Yup.object().shape({\n      newSignalDelta: Yup.number()\n        .test(`test-range`, '', function testNewSignalDelta(value) {\n          const { path, createError } = this;\n          if (value && value > range.from && value < range.to) {\n            return true;\n          }\n\n          const errorMessage = ` ${\n            value ? value.toFixed(5) : 0\n          } ppm out of the range`;\n          return createError({ path, message: errorMessage });\n        })\n        .required(),\n    });\n  }, [range]);\n\n  const triggerSubmitHandler = useCallback(() => {\n    ref.current.submitForm();\n  }, [ref]);\n\n  return (\n    <div css={styles.container}>\n      <div>\n        <p css={styles.infoText}>\n          Edit or select a delta value of new signal (ppm):\n        </p>\n        <FormikForm\n          ref={ref}\n          validationSchema={validation}\n          initialValues={{\n            newSignalDelta: (range.from + range.to) / 2,\n          }}\n          onSubmit={saveHandler}\n        >\n          <div css={styles.inputContainer}>\n            <FormikInput\n              name=\"newSignalDelta\"\n              type=\"number\"\n              placeholder={`𝛅 (ppm)`}\n              onFocus={onFocus}\n              onBlur={onBlur}\n              style={{\n                input: {\n                  width: '250px',\n                  height: '30px',\n                },\n              }}\n              checkErrorAfterInputTouched={false}\n            />\n          </div>\n          <p css={styles.inputInfo}>\n            [ {`${format(range.from)} ppm - ${format(range.to)} ppm`} ]\n          </p>\n\n          <Button css={styles.addSignalBtn} onClick={triggerSubmitHandler}>\n            <FaPlus title=\"Add new signal\" />\n          </Button>\n        </FormikForm>\n      </div>\n    </div>\n  );\n}\n\nexport default forwardRef(AddSignalFormTab);\n","import { CSSProperties } from 'react';\n\nimport FormikInput from '../../../../elements/formik/FormikInput';\nimport { translateMultiplet } from '../../../../panels/extra/utilities/MultiplicityUtilities';\n\nconst style: Record<'input', CSSProperties> = {\n  input: {\n    width: '50px',\n    height: '26px',\n    borderWidth: 0,\n    margin: '0 5px',\n  },\n};\n\ninterface DeltaInputProps {\n  signal: any;\n  index: number;\n  onFocus: (element: any) => void;\n}\n\nfunction DeltaInput({ signal, index, onFocus }: DeltaInputProps) {\n  return (\n    <div style={{ display: 'flex', alignItems: 'center' }}>\n      <span>𝛅: </span>\n      <FormikInput\n        name={`signals.${index}.delta`}\n        type=\"number\"\n        placeholder={'J (Hz)'}\n        onFocus={onFocus}\n        style={style}\n        checkErrorAfterInputTouched={false}\n      />\n      <span>\n        {signal.js\n          .map((_coupling) => translateMultiplet(_coupling.multiplicity))\n          .join('')}\n      </span>\n    </div>\n  );\n}\n\nexport default DeltaInput;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useFormikContext } from 'formik';\nimport lodashGet from 'lodash/get';\nimport { memo, useMemo, useCallback } from 'react';\nimport { FaPlus, FaRegTrashAlt } from 'react-icons/fa';\n\nimport { Multiplets } from '../../../../../data/constants/Multiplets';\nimport Button from '../../../../elements/Button';\nimport FormikInput from '../../../../elements/formik/FormikInput';\nimport FormikSelect from '../../../../elements/formik/FormikSelect';\nimport {\n  hasCouplingConstant,\n  translateMultiplet,\n} from '../../../../panels/extra/utilities/MultiplicityUtilities';\n\nconst CouplingsTableStyle = css`\n  border-spacing: 0;\n  border: 1px solid #dedede;\n  width: 100%;\n  height: 100%;\n  font-size: 12px;\n\n  th,\n  td {\n    text-align: center;\n    margin: 0;\n    padding: 0.3rem;\n    border-bottom: 1px solid #f5f5f5;\n\n    button {\n      background-color: transparent;\n      border: none;\n    }\n\n    .add-button {\n      color: blue;\n      width: 100%;\n      height: 100%;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n    }\n\n    .delete-button {\n      border-radius: 25%;\n      padding: 0;\n      padding-left: 0.3rem;\n      padding-right: 0.3rem;\n    }\n    .delete-button:hover {\n      .icon {\n        color: red;\n      }\n    }\n\n    input {\n      background-color: transparent;\n      border: 0.5px solid #dedede;\n      height: 100%;\n      width: 100%;\n      text-align: center;\n    }\n    .selectBox {\n      background-color: transparent;\n      border: 0.5px solid #dedede;\n      height: 100%;\n      width: 100% !important;\n      text-align: center;\n      margin: 0;\n    }\n  }\n\n  tr {\n    :last-child {\n      background-color: #fcfcfc;\n    }\n  }\n`;\n\ninterface CouplingsTableProps {\n  push: (element: { multiplicity?: string; coupling: string }) => void;\n  remove: (element: number) => void;\n  onFocus: (element: any) => void;\n  onBlur?: () => void;\n}\n\nfunction CouplingsTable({\n  push,\n  remove,\n  onFocus,\n  onBlur,\n}: CouplingsTableProps) {\n  const { values, setFieldValue } = useFormikContext<any>();\n\n  const multiplicityChangeHandler = useCallback(\n    (value, name) => {\n      if (!hasCouplingConstant(value)) {\n        setFieldValue(name, '');\n      }\n    },\n    [setFieldValue],\n  );\n\n  const multipletsList = useMemo(() => {\n    return Multiplets.map((multiplet) => ({\n      key: multiplet.value,\n      ...multiplet,\n      value: multiplet.label,\n    }));\n  }, []);\n\n  return (\n    <table css={CouplingsTableStyle}>\n      <tbody>\n        <tr>\n          <th>#</th>\n          <th>Multiplicity</th>\n          <th>J (Hz)</th>\n          <th>{''}</th>\n        </tr>\n        {lodashGet(values, `signals[${values.activeTab}].js`, []).map(\n          (_coupling, i) => (\n            <tr\n              // eslint-disable-next-line react/no-array-index-key\n              key={`editCouplings${values.activeTab}${i}`}\n            >\n              <td>{i + 1}</td>\n              <td>\n                <FormikSelect\n                  className=\"selectBox\"\n                  name={`signals.${values.activeTab}.js.${i}.multiplicity`}\n                  data={multipletsList}\n                  onChange={(value) =>\n                    multiplicityChangeHandler(\n                      value,\n                      `signals.${values.activeTab}.js.${i}.coupling`,\n                    )\n                  }\n                />\n              </td>\n              <td>\n                <FormikInput\n                  name={`signals.${values.activeTab}.js.${i}.coupling`}\n                  type=\"number\"\n                  placeholder={'J (Hz)'}\n                  disabled={!hasCouplingConstant(_coupling.multiplicity)}\n                  onFocus={onFocus}\n                  onBlur={onBlur}\n                  style={{\n                    input: {\n                      width: '100%',\n                      height: '26px',\n                    },\n                  }}\n                  checkErrorAfterInputTouched={false}\n                />\n              </td>\n              <td>\n                <Button\n                  className=\"delete-button\"\n                  onClick={() => {\n                    remove(i);\n                  }}\n                >\n                  <FaRegTrashAlt className=\"icon\" title=\"Delete coupling\" />\n                </Button>\n              </td>\n            </tr>\n          ),\n        )}\n        <tr />\n        <tr>\n          <td colSpan={4}>\n            <Button\n              className=\"add-button\"\n              onClick={() =>\n                push({\n                  multiplicity: translateMultiplet('m'),\n                  coupling: '',\n                })\n              }\n            >\n              <FaPlus title=\"Add new coupling\" />\n            </Button>\n          </td>\n        </tr>\n      </tbody>\n    </table>\n  );\n}\n\nexport default memo(CouplingsTable);\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useFormikContext, FieldArray } from 'formik';\nimport { memo } from 'react';\n\nimport CouplingsTable from './CouplingsTable';\n\nconst SignalFormTabStyle = css`\n  border-spacing: 0;\n  width: 100%;\n  font-size: 12px;\n  height: 100%;\n\n  margin: 0;\n  padding: 0.4rem;\n  text-align: center;\n`;\n\ninterface SignalFormTabProps {\n  onFocus: (element: any) => void;\n  onBlur?: () => void;\n}\n\nfunction SignalFormTab({ onFocus, onBlur }: SignalFormTabProps) {\n  const { values } = useFormikContext<{ activeTab: string }>();\n\n  return (\n    <div css={SignalFormTabStyle}>\n      <FieldArray\n        name={`signals.${values.activeTab}.js`}\n        render={({ push, remove }) => (\n          <div>\n            <CouplingsTable\n              push={push}\n              remove={remove}\n              onFocus={onFocus}\n              onBlur={onBlur}\n            />\n          </div>\n        )}\n      />\n    </div>\n  );\n}\n\nexport default memo(SignalFormTab);\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useFormikContext } from 'formik';\nimport { useCallback, useMemo, memo, useEffect, useState, useRef } from 'react';\n\nimport { useChartData } from '../../../../context/ChartContext';\nimport Tab from '../../../../elements/Tab/Tab';\nimport Tabs from '../../../../elements/Tab/Tabs';\nimport useSpectrum from '../../../../hooks/useSpectrum';\nimport Events from '../../../../utility/Events';\nimport { useFormatNumberByNucleus } from '../../../../utility/FormatNumber';\n\nimport AddSignalFormTab from './AddSignalFormTab';\nimport DeltaInput from './DeltaInput';\nimport SignalFormTab from './SignalFormTab';\n\nconst textStyles = css`\n  text-align: center;\n  width: 100%;\n\n  .errorText {\n    color: red;\n  }\n\n  .infoText {\n    padding: 10px;\n    margin: 10px 0;\n    font-size: 14px;\n    text-align: left;\n    color: white;\n    background-color: #5f5f5f;\n    border-radius: 5px;\n  }\n`;\n\nconst tabStylesAddition = css`\n  color: red;\n`;\nconst tabStyles = css`\n  display: inline-grid;\n  list-style: none;\n  padding: 0.5rem 1.5rem;\n`;\n\ninterface SignalsFormProps {\n  range: number;\n}\n\nfunction SignalsForm({ range }: SignalsFormProps) {\n  const newSignalFormRef = useRef<any>();\n  const [activeField, setActiveField] = useState<string | null>(null);\n\n  const {\n    values,\n    setFieldValue,\n    errors,\n  }: {\n    values: any;\n    setFieldValue: (\n      field: string,\n      value: any,\n      shouldValidate?: boolean | undefined,\n    ) => void;\n    errors: any;\n  } = useFormikContext<any>();\n\n  const { activeTab } = useChartData();\n  const { info }: { info: any } = useSpectrum({ info: {} });\n  const format = useFormatNumberByNucleus(activeTab);\n\n  useEffect(() => {\n    function handle(event) {\n      if (info?.originFrequency && activeField) {\n        if (values.activeTab === 'addSignalTab') {\n          newSignalFormRef.current.setValues({\n            [activeField]:\n              (event.range[1] - event.range[0]) / 2 + event.range[0],\n          });\n        } else if (activeField.includes('delta')) {\n          setFieldValue(\n            activeField,\n            (event.range[1] - event.range[0]) / 2 + event.range[0],\n          );\n        } else {\n          const value = Number(\n            format(\n              Math.abs(event.range[0] - event.range[1]) * info.originFrequency,\n            ),\n          );\n          setFieldValue(activeField, value);\n        }\n      }\n\n      setActiveField(null);\n    }\n\n    Events.on('brushEnd', handle);\n\n    return () => {\n      Events.off('brushEnd', handle);\n    };\n  }, [activeField, setFieldValue, values.activeTab, format, info]);\n\n  useEffect(() => {\n    function handle(event) {\n      if (activeField) {\n        if (values.activeTab === 'addSignalTab') {\n          newSignalFormRef.current.setValues({ [activeField]: event.xPPM });\n        } else if (activeField.includes('delta')) {\n          setFieldValue(activeField, event.xPPM);\n        }\n      }\n      setActiveField(null);\n    }\n\n    Events.on('mouseClick', handle);\n\n    return () => {\n      Events.off('mouseClick', handle);\n    };\n  }, [values.activeTab, activeField, setFieldValue]);\n\n  const handleOnFocus = useCallback(\n    (event) => {\n      setActiveField(event.target.name);\n    },\n    [setActiveField],\n  );\n\n  const tapClickHandler = useCallback(\n    ({ tabid }) => {\n      setFieldValue('activeTab', tabid);\n    },\n    [setFieldValue],\n  );\n\n  const handleDeleteSignal = useCallback(\n    ({ tabid }) => {\n      const _signals = values.signals.filter(\n        (_signal, i) => i !== Number(tabid),\n      );\n      setFieldValue('signals', _signals);\n    },\n    [setFieldValue, values.signals],\n  );\n\n  useEffect(() => {\n    setFieldValue(\n      'activeTab',\n      values.signals.length > 0\n        ? (values.signals.length - 1).toString()\n        : 'addSignalTab',\n    );\n  }, [setFieldValue, values.signals.length]);\n\n  const tabContainsErrors = useCallback(\n    (i) => {\n      return errors?.signals && errors?.signals[i] ? true : false;\n    },\n    [errors],\n  );\n\n  const signalFormTabs = useMemo(() => {\n    const signalTabs =\n      values.signals.length > 0\n        ? values.signals.map((signal, i) => (\n            <Tab\n              // eslint-disable-next-line react/no-array-index-key\n              key={`signalForm${i}`}\n              tabid={`${i}`}\n              tabstyles={tabContainsErrors(i) ? tabStylesAddition : tabStyles}\n              canDelete\n              render={() => (\n                <DeltaInput signal={signal} index={i} onFocus={handleOnFocus} />\n              )}\n            >\n              <SignalFormTab onFocus={handleOnFocus} />\n            </Tab>\n          ))\n        : [];\n\n    const addSignalTab = (\n      <Tab\n        tablabel=\"+\"\n        tabid=\"addSignalTab\"\n        canDelete={false}\n        key=\"addSignalTab\"\n        className=\"add-signal-tab\"\n      >\n        <AddSignalFormTab\n          onFocus={handleOnFocus}\n          range={range}\n          ref={newSignalFormRef}\n        />\n      </Tab>\n    );\n\n    return signalTabs.concat(addSignalTab);\n  }, [handleOnFocus, range, tabContainsErrors, values.signals]);\n\n  const editSignalInfoText = (\n    <p className=\"infoText\">\n      Focus on an input field and press Shift + Drag &#38; Drop to draw a\n      coupling constant in spectrum view.\n    </p>\n  );\n\n  const addSignalInfoText = (\n    <p className=\"infoText\">\n      Focus on the input field and press Shift + Left mouse click to select new\n      signal delta value in spectrum view.\n    </p>\n  );\n\n  return (\n    <div>\n      <div css={textStyles}>\n        {errors.signals &&\n        (errors.signals.noSignals || errors.signals.noCouplings) ? (\n          <div>\n            <p className=\"errorText\">\n              {errors.signals.noSignals ||\n                errors.signals.noCouplings[0].message}\n            </p>\n            {errors.signals.noSignals ? addSignalInfoText : null}\n          </div>\n        ) : values.activeTab === 'addSignalTab' ? (\n          addSignalInfoText\n        ) : (\n          editSignalInfoText\n        )}\n      </div>\n      <Tabs\n        activeTab={values.activeTab}\n        onClick={tapClickHandler}\n        onDelete={handleDeleteSignal}\n      >\n        {signalFormTabs}\n      </Tabs>\n    </div>\n  );\n}\n\nexport default memo(SignalsForm);\n","import { useMemo } from 'react';\nimport * as Yup from 'yup';\n\nimport { hasCouplingConstant } from '../../../../panels/extra/utilities/MultiplicityUtilities';\n\nconst useValidation = () =>\n  useMemo(() => {\n    return Yup.object().shape({\n      signals: Yup.array()\n        .of(\n          Yup.object().shape({\n            j: Yup.array()\n              .of(\n                Yup.object().shape({\n                  multiplicity: Yup.string().required(),\n                  coupling: Yup.mixed().test(\n                    'checkValue',\n                    '',\n                    function testCoupling(value) {\n                      const { path, createError } = this;\n                      const hasCoupling = hasCouplingConstant(\n                        this.parent.multiplicity,\n                      );\n                      if (\n                        (!hasCoupling && isNaN(value)) ||\n                        (hasCoupling && !isNaN(value))\n                      ) {\n                        return true;\n                      }\n\n                      return createError({\n                        path,\n                        message: `${path} is required`,\n                      });\n                    },\n                  ),\n                }),\n              )\n              .min(1, 'There must be at least one coupling in a signal'),\n          }),\n        )\n        .min(1, 'There must be at least one signal in a range!'),\n    });\n  }, []);\n\nexport default useValidation;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useMemo, useCallback, useEffect, useRef } from 'react';\nimport { FaSearchPlus } from 'react-icons/fa';\n\nimport generateID from '../../../data/utilities/generateID';\nimport { useChartData } from '../../context/ChartContext';\nimport { useDispatch } from '../../context/DispatchContext';\nimport Button from '../../elements/Button';\nimport CloseButton from '../../elements/CloseButton';\nimport SaveButton from '../../elements/SaveButton';\nimport FormikForm from '../../elements/formik/FormikForm';\nimport FormikOnChange from '../../elements/formik/FormikOnChange';\nimport {\n  hasCouplingConstant,\n  translateMultiplet,\n} from '../../panels/extra/utilities/MultiplicityUtilities';\nimport { CHANGE_TEMP_RANGE } from '../../reducer/types/Types';\nimport { useFormatNumberByNucleus } from '../../utility/FormatNumber';\n\nimport SignalsForm from './forms/components/SignalsForm';\nimport useRangeFormValidation from './forms/validation/EditRangeValidation';\n\nconst styles = css`\n  width: 600px;\n  height: 500px;\n  padding: 5px;\n  button:focus {\n    outline: none;\n  }\n  .header {\n    height: 24px;\n    border-bottom: 1px solid #f0f0f0;\n    display: flex;\n    align-items: center;\n    span {\n      color: #464646;\n      font-size: 15px;\n      flex: 1;\n      border-left: 1px solid #ececec;\n      padding-left: 6px;\n    }\n\n    button {\n      background-color: transparent;\n      border: none;\n      padding: 5px;\n\n      svg {\n        height: 16px;\n      }\n    }\n  }\n  .container {\n    display: flex;\n    margin: 30px 5px;\n    input,\n    button {\n      padding: 5px;\n      border: 1px solid gray;\n      border-radius: 5px;\n      height: 36px;\n      margin: 2px;\n    }\n    input {\n      flex: 10;\n    }\n    button {\n      flex: 2;\n      color: white;\n      background-color: gray;\n    }\n  }\n`;\n\ninterface EditRangeModalProps {\n  onSaveEditRangeModal: (value: any) => Promise<void> | null | void;\n  onCloseEditRangeModal: () => void;\n  onZoomEditRangeModal: (value: any) => void;\n  range: any;\n  automaticZoom?: boolean;\n}\n\ninterface Coupling {\n  multiplicity: any;\n  coupling: string | number;\n}\n\nfunction EditRangeModal({\n  onSaveEditRangeModal = () => null,\n  onCloseEditRangeModal = () => null,\n  onZoomEditRangeModal = () => null,\n  range,\n  automaticZoom = true,\n}: EditRangeModalProps) {\n  const formRef = useRef<any>(null);\n  const { activeTab } = useChartData();\n  const dispatch = useDispatch();\n  const format = useFormatNumberByNucleus(activeTab);\n  const validation = useRangeFormValidation();\n\n  const handleOnZoom = useCallback(() => {\n    onZoomEditRangeModal(range);\n  }, [onZoomEditRangeModal, range]);\n\n  useEffect(() => {\n    if (automaticZoom) {\n      handleOnZoom();\n    }\n  }, [automaticZoom, handleOnZoom]);\n\n  const handleOnClose = useCallback(() => {\n    onCloseEditRangeModal();\n  }, [onCloseEditRangeModal]);\n\n  const getCouplings = useCallback(\n    (couplings) =>\n      couplings\n        .filter((coupling) => coupling.coupling !== '')\n        .map((coupling) => {\n          return {\n            ...coupling,\n            multiplicity: translateMultiplet(coupling.multiplicity),\n          };\n        }),\n    [],\n  );\n\n  const getSignals = useCallback(\n    (signals) => {\n      return signals.map((signal) => {\n        return {\n          id: generateID(),\n          ...signal,\n          multiplicity: signal.js\n            .map((_coupling) => translateMultiplet(_coupling.multiplicity))\n            .join(''),\n          js: getCouplings(signal.js),\n        };\n      });\n    },\n    [getCouplings],\n  );\n\n  const handleOnSave = useCallback(\n    (formValues) => {\n      void (async () => {\n        const _range = { ...range };\n        _range.signals = getSignals(formValues.signals);\n        await onSaveEditRangeModal(_range);\n        handleOnClose();\n      })();\n    },\n    [getSignals, handleOnClose, onSaveEditRangeModal, range],\n  );\n\n  const data = useMemo(() => {\n    const signals = range.signals.map((signal) => {\n      // counter within j array to access to right j values\n\n      let counterJ = 0;\n      const couplings: Array<Coupling> = [];\n      signal.multiplicity.split('').forEach((_multiplicity) => {\n        let coupling: Coupling = {\n          multiplicity: _multiplicity,\n          coupling: '',\n        };\n\n        if (hasCouplingConstant(_multiplicity)) {\n          coupling = { ...signal.js[counterJ] };\n          coupling.coupling = Number(format(coupling.coupling));\n          counterJ++;\n        }\n        coupling.multiplicity = translateMultiplet(coupling.multiplicity);\n        couplings.push(coupling);\n      });\n\n      return { ...signal, js: couplings };\n    });\n    return { activeTab: '0', signals };\n  }, [format, range]);\n\n  const changeHandler = useCallback(\n    (values) => {\n      const signals = getSignals(values.signals);\n      dispatch({\n        type: CHANGE_TEMP_RANGE,\n        payload: { tempRange: Object.assign({}, range, { signals }) },\n      });\n    },\n    [dispatch, getSignals, range],\n  );\n\n  return (\n    <div css={styles}>\n      <FormikForm\n        ref={formRef}\n        initialValues={data}\n        validationSchema={validation}\n        onSubmit={handleOnSave}\n      >\n        <div className=\"header handle\">\n          <Button onClick={handleOnZoom} className=\"zoom-button\">\n            <FaSearchPlus title=\"Set to default view on range in spectrum\" />\n          </Button>\n          <span>\n            {` Range and Signal edition: ${format(range.from)} ppm to ${format(\n              range.to,\n            )} ppm`}\n          </span>\n          <SaveButton\n            onClick={() => formRef.current.submitForm()}\n            popupTitle=\"Save and exit\"\n          />\n\n          <CloseButton onClick={handleOnClose} />\n        </div>\n        <SignalsForm range={range} />\n        <FormikOnChange onChange={changeHandler} />\n      </FormikForm>\n    </div>\n  );\n}\n\nexport default EditRangeModal;\n","import { useCallback, useMemo } from 'react';\n\nimport { useAssignmentData } from '../../../assignment/AssignmentsContext';\nimport { useDispatch } from '../../../context/DispatchContext';\nimport { useModal } from '../../../elements/popup/Modal';\nimport { positions, transitions } from '../../../elements/popup/options';\nimport EditRangeModal from '../../../modal/editRange/EditRangeModal';\nimport {\n  CHANGE_RANGE_SIGNAL_KIND,\n  DELETE_RANGE,\n  RESET_SELECTED_TOOL,\n  SAVE_EDITED_RANGE,\n  SET_SELECTED_TOOL,\n  SET_X_DOMAIN,\n} from '../../../reducer/types/Types';\nimport { options } from '../../../toolbar/ToolTypes';\n\nimport { RangeData } from './useMapRanges';\n\nexport default function useEditRangeModal(range: RangeData) {\n  const dispatch = useDispatch();\n  const modal = useModal();\n  const assignmentData = useAssignmentData();\n\n  const zoomRange = useCallback(() => {\n    const margin = Math.abs(range.from - range.to);\n    dispatch({\n      type: SET_X_DOMAIN,\n      xDomain: [range.from - margin, range.to + margin],\n    });\n  }, [dispatch, range.from, range.to]);\n\n  const deleteRange = useCallback(() => {\n    dispatch({\n      type: DELETE_RANGE,\n      payload: {\n        data: { id: range.id, assignmentData },\n      },\n    });\n  }, [assignmentData, dispatch, range.id]);\n\n  const changeRangeSignalKind = useCallback(\n    (value) => {\n      dispatch({\n        type: CHANGE_RANGE_SIGNAL_KIND,\n        payload: {\n          data: { rowData: range, value },\n        },\n      });\n    },\n    [dispatch, range],\n  );\n\n  const saveEditRangeHandler = useCallback(\n    (editedRowData) => {\n      dispatch({\n        type: SAVE_EDITED_RANGE,\n        payload: {\n          editedRowData,\n          assignmentData,\n        },\n      });\n    },\n    [assignmentData, dispatch],\n  );\n\n  const closeEditRangeHandler = useCallback(() => {\n    dispatch({ type: RESET_SELECTED_TOOL });\n    modal.close();\n  }, [dispatch, modal]);\n\n  const editRange = useCallback(() => {\n    dispatch({\n      type: SET_SELECTED_TOOL,\n      payload: { selectedTool: options.editRange.id, tempRange: range },\n    });\n    modal.show(\n      <EditRangeModal\n        onCloseEditRangeModal={closeEditRangeHandler}\n        onSaveEditRangeModal={saveEditRangeHandler}\n        onZoomEditRangeModal={zoomRange}\n        range={range}\n      />,\n      {\n        position: positions.MIDDLE_RIGHT,\n        transition: transitions.SCALE,\n        isBackgroundBlur: false,\n      },\n    );\n  }, [\n    closeEditRangeHandler,\n    dispatch,\n    modal,\n    range,\n    saveEditRangeHandler,\n    zoomRange,\n  ]);\n\n  return useMemo(\n    () => ({\n      editRange,\n      deleteRange,\n      zoomRange,\n      changeRangeSignalKind,\n    }),\n    [changeRangeSignalKind, deleteRange, editRange, zoomRange],\n  );\n}\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { Fragment, CSSProperties } from 'react';\nimport { FaRegTrashAlt, FaSearchPlus, FaEdit } from 'react-icons/fa';\n\nimport { SignalKinds } from '../../../../data/constants/SignalsKinds';\nimport Select from '../../../elements/Select';\nimport useEditRangeModal from '../hooks/useEditRangeModal';\nimport { RangeData } from '../hooks/useMapRanges';\n\nconst styles = css`\n  width: 66px;\n  padding: 0 !important;\n  button {import useEditRangeModal from './../../../hooks/useEditRangeModal';\n\n    background-color: transparent;\n    border: none;\n    padding: 5px;\n  }\n\n  button:disabled {\n    opacity: 0.6;\n  }\n`;\n\nconst selectBoxStyle: CSSProperties = {\n  marginLeft: 2,\n  marginRight: 2,\n  border: 'none',\n  height: '20px',\n};\n\ninterface ActionsColumnProps {\n  rowData: RangeData;\n  rowSpanTags: {\n    rowSpan: any;\n    style: CSSProperties;\n  };\n  onHoverSignal?: {\n    onMouseEnter: () => void;\n    onMouseLeave: () => void;\n  };\n  onHoverRange?: {\n    onMouseEnter: () => void;\n    onMouseLeave: () => void;\n  };\n}\n\nfunction ActionsColumn({\n  rowData,\n  onHoverSignal,\n  rowSpanTags,\n}: ActionsColumnProps) {\n  const { editRange, deleteRange, changeRangeSignalKind, zoomRange } =\n    useEditRangeModal(rowData);\n\n  return (\n    <Fragment>\n      <td {...onHoverSignal}>\n        <Select\n          onChange={changeRangeSignalKind}\n          data={SignalKinds}\n          defaultValue={rowData.tableMetaInfo.signal.kind}\n          style={selectBoxStyle}\n        />\n      </td>\n      <td {...rowSpanTags} css={styles}>\n        <button type=\"button\" className=\"delete-button\" onClick={deleteRange}>\n          <FaRegTrashAlt />\n        </button>\n        <button type=\"button\" className=\"zoom-button\" onClick={zoomRange}>\n          <FaSearchPlus title=\"Zoom to range in spectrum\" />\n        </button>\n        <button type=\"button\" className=\"edit-button\" onClick={editRange}>\n          <FaEdit color=\"blue\" />\n        </button>\n      </td>\n    </Fragment>\n  );\n}\n\nexport default ActionsColumn;\n","import lodashGet from 'lodash/get';\n\ninterface CouplingColumnProps {\n  rowData: {\n    id: number;\n    from: number;\n    to: number;\n    tableMetaInfo: any;\n  };\n  onHoverSignal?: {\n    onMouseEnter: () => void;\n    onMouseLeave: () => void;\n  };\n}\n\nfunction CouplingColumn({ rowData, onHoverSignal }: CouplingColumnProps) {\n  const result = lodashGet(rowData, 'tableMetaInfo.signal.js');\n  return (\n    <td {...onHoverSignal}>\n      {result\n        ?.map((coupling) =>\n          !isNaN(coupling.coupling) ? coupling.coupling.toFixed(1) : '',\n        )\n        .join(',')}\n    </td>\n  );\n}\n\nexport default CouplingColumn;\n","import lodashGet from 'lodash/get';\nimport { CSSProperties, useMemo, useCallback, memo } from 'react';\nimport { FaMinusCircle } from 'react-icons/fa';\n\nimport { AssignmentsData } from '../../../assignment/AssignmentsContext';\nimport { HighlightedSource } from '../../../highlight';\n\nconst spanStyle: CSSProperties = {\n  color: 'red',\n  fontWeight: 'bold',\n};\n\ninterface RangAssignmentColumnProps {\n  rowData: any;\n  onHover: {\n    onMouseEnter: () => void;\n    onMouseLeave: () => void;\n  };\n  assignment: AssignmentsData;\n  highlight: {\n    isActive: boolean;\n  };\n  onUnlinkVisibilityChange?: (element: any) => void;\n  unlinkVisibility: boolean;\n  onLink?: (a: any, b: any) => void;\n  onUnlink?: (element: any, b: boolean) => void;\n  rowSpanTags: any;\n  highlightData: any;\n}\n\nfunction RangeAssignmentsColumn({\n  rowData,\n  assignment,\n  highlight,\n  onUnlinkVisibilityChange,\n  unlinkVisibility,\n  onLink,\n  onUnlink,\n  rowSpanTags,\n  onHover,\n  highlightData,\n}: RangAssignmentColumnProps) {\n  const diaIDs = useMemo(() => {\n    return lodashGet(rowData, 'diaIDs', 0);\n  }, [rowData]);\n\n  const visibilityChangeHandler = useCallback(\n    (flag) => {\n      onUnlinkVisibilityChange?.(flag);\n    },\n    [onUnlinkVisibilityChange],\n  );\n\n  const spanCss: CSSProperties = useMemo(() => {\n    const flag =\n      assignment.isActive ||\n      assignment.isOver ||\n      (highlight.isActive &&\n        highlightData.highlight.sourceData?.type !== HighlightedSource.SIGNAL);\n    return flag\n      ? {\n          color: 'red',\n          fontWeight: 'bold',\n        }\n      : { color: 'black', fontWeight: 'normal' };\n  }, [\n    assignment.isActive,\n    assignment.isOver,\n    highlight.isActive,\n    highlightData.highlight.sourceData?.type,\n  ]);\n\n  return (\n    <td\n      {...rowSpanTags}\n      {...onHover}\n      {...{ onClick: (e) => onLink?.(e, assignment) }}\n    >\n      {rowData.nbAtoms !== undefined && rowData.nbAtoms > 0 ? (\n        rowData.diaIDs && rowData.diaIDs.length > 0 ? (\n          <div\n            onMouseEnter={() => visibilityChangeHandler(true)}\n            onMouseLeave={() => visibilityChangeHandler(false)}\n          >\n            {rowData.nbAtoms} {' ( '}\n            <span style={spanCss}>{diaIDs.length}</span>\n            {' ) '}\n            <sup>\n              <button\n                type=\"button\"\n                style={{\n                  visibility: unlinkVisibility ? 'visible' : 'hidden',\n                  padding: 0,\n                  margin: 0,\n                }}\n                onClick={(e) => onUnlink?.(e, true)}\n              >\n                <FaMinusCircle color=\"red\" />\n              </button>\n            </sup>\n          </div>\n        ) : assignment.isActive ? (\n          <div>\n            {`${rowData.nbAtoms} (`}\n            <span style={spanStyle}>0</span>\n            {')'}\n          </div>\n        ) : (\n          rowData.nbAtoms\n        )\n      ) : assignment.isActive ? (\n        <div>\n          {'0 ('}\n          <span style={spanStyle}>0</span>\n          {')'}\n        </div>\n      ) : (\n        ''\n      )}\n    </td>\n  );\n}\n\nexport default memo(RangeAssignmentsColumn);\n","import { CSSProperties, memo } from 'react';\n\nimport FormatNumber from '../../../utility/FormatNumber';\n\ninterface RangeColumnProps {\n  value: any;\n  rowSpanTags: {\n    rowSpan: any;\n    style: CSSProperties;\n  };\n  onHoverRange?: {\n    onMouseEnter: () => void;\n    onMouseLeave: () => void;\n  };\n  format: string;\n}\n\nfunction RangeColumn({\n  value,\n  rowSpanTags,\n  onHoverRange,\n  format,\n}: RangeColumnProps) {\n  return (\n    <td {...rowSpanTags} {...onHoverRange}>\n      {FormatNumber(value, format)}\n    </td>\n  );\n}\n\nexport default memo(RangeColumn);\n","import { useCallback, useMemo } from 'react';\n\nimport { checkRangeKind } from '../../../../data/utilities/RangeUtilities';\nimport { useDispatch } from '../../../context/DispatchContext';\nimport EditableColumn from '../../../elements/EditableColumn';\nimport { CHANGE_RANGE_RELATIVE } from '../../../reducer/types/Types';\nimport FormatNumber from '../../../utility/FormatNumber';\n\nfunction RelativeColumn({ rowData, rowSpanTags, onHoverRange, format }) {\n  const dispatch = useDispatch();\n\n  const integralVal = useMemo(() => {\n    const flag = checkRangeKind(rowData);\n    const formattedValue = FormatNumber(rowData.integration, format);\n    return flag ? formattedValue : `[ ${formattedValue} ]`;\n  }, [format, rowData]);\n\n  const saveHandler = useCallback(\n    (event) => {\n      dispatch({\n        type: CHANGE_RANGE_RELATIVE,\n        payload: {\n          data: { value: event.target.value, id: rowData.id },\n        },\n      });\n    },\n    [dispatch, rowData.id],\n  );\n\n  return (\n    <td {...rowSpanTags} {...onHoverRange}>\n      <EditableColumn\n        value={integralVal}\n        onSave={saveHandler}\n        type=\"number\"\n        style={{ padding: '0.1rem 0.4rem' }}\n      />\n    </td>\n  );\n}\n\nexport default RelativeColumn;\n","import lodashGet from 'lodash/get';\nimport { CSSProperties, useMemo, useCallback, memo } from 'react';\nimport { FaMinusCircle } from 'react-icons/fa';\n\nimport { AssignmentsData } from '../../../assignment/AssignmentsContext';\n\ninterface SignalAssignmentsColumnProps {\n  rowData: any;\n  onHover: {\n    onMouseEnter: () => void;\n    onMouseLeave: () => void;\n  };\n  assignment: AssignmentsData;\n  highlight: {\n    isActive: boolean;\n  };\n  onUnlinkVisibilityChange?: (element: any) => void;\n  unlinkVisibility: boolean;\n  onLink?: (a: any, b: any) => void;\n  onUnlink?: (element: any, b: boolean) => void;\n}\n\nfunction SignalAssignmentsColumn({\n  rowData,\n  onHover,\n  assignment,\n  highlight,\n  onUnlinkVisibilityChange,\n  unlinkVisibility,\n  onLink,\n  onUnlink,\n}: SignalAssignmentsColumnProps) {\n  const diaIDs = useMemo(() => {\n    return lodashGet(rowData, 'tableMetaInfo.signal.diaIDs', []);\n  }, [rowData]);\n\n  const tdCss: CSSProperties | undefined = useMemo(() => {\n    return assignment.isActive || highlight.isActive\n      ? {\n          color: 'red',\n          fontWeight: 'bold',\n        }\n      : undefined;\n  }, [assignment.isActive, highlight.isActive]);\n\n  const visibilityChangeHandler = useCallback(\n    (flag) => {\n      onUnlinkVisibilityChange?.(flag);\n    },\n    [onUnlinkVisibilityChange],\n  );\n  const assignHandler = useCallback(\n    (e) => {\n      onLink?.(e, assignment);\n    },\n    [assignment, onLink],\n  );\n\n  return (\n    <td {...onHover} onClick={assignHandler} style={tdCss}>\n      {diaIDs && diaIDs.length > 0 ? (\n        <div\n          onMouseEnter={() => visibilityChangeHandler(true)}\n          onMouseLeave={() => visibilityChangeHandler(false)}\n        >\n          {diaIDs.length}{' '}\n          <sup>\n            <button\n              type=\"button\"\n              style={{\n                visibility: unlinkVisibility ? 'visible' : 'hidden',\n                padding: 0,\n                margin: 0,\n              }}\n              onClick={(e) => onUnlink?.(e, false)}\n            >\n              <FaMinusCircle color=\"red\" />\n            </button>\n          </sup>\n        </div>\n      ) : assignment.isActive ? (\n        '0'\n      ) : (\n        ''\n      )}\n    </td>\n  );\n}\n\nexport default memo(SignalAssignmentsColumn);\n","import lodashGet from 'lodash/get';\n\nimport FormatNumber from '../../../utility/FormatNumber';\n\nexport default function useFormat(preferences) {\n  return (value, keysPath, prefix = '', suffix = '') => {\n    const format = lodashGet(preferences, keysPath, '0.000');\n    return FormatNumber(value, format, prefix, suffix);\n  };\n}\n","import { useCallback } from 'react';\n\nimport { useDispatch } from '../../../context/DispatchContext';\nimport EditableColumn from '../../../elements/EditableColumn';\nimport { CHANGE_RANGE_SIGNAL_VALUE } from '../../../reducer/types/Types';\nimport { checkMultiplicity } from '../../extra/utilities/MultiplicityUtilities';\n\nimport useFormat from './format';\n\ninterface SignalDeltaColumnProps {\n  rowData: any;\n  onHoverSignal: {\n    onMouseEnter: () => void;\n    onMouseLeave: () => void;\n  };\n  preferences: string;\n}\n\nfunction SignalDeltaColumn({\n  rowData,\n  onHoverSignal,\n  preferences,\n}: SignalDeltaColumnProps) {\n  const dispatch = useDispatch();\n  const signal = rowData.tableMetaInfo.signal;\n  const format = useFormat(preferences);\n\n  const saveHandler = useCallback(\n    (event) => {\n      dispatch({\n        type: CHANGE_RANGE_SIGNAL_VALUE,\n        payload: {\n          value: event.target.value,\n          rangeID: rowData.id,\n          signalID: signal.id,\n        },\n      });\n    },\n    [dispatch, rowData.id, signal.id],\n  );\n\n  if (!signal) return <td>{''}</td>;\n\n  return (\n    <td {...onHoverSignal}>\n      {!checkMultiplicity(signal.multiplicity, ['m']) ? (\n        `${format(rowData.from, 'fromFormat')} - ${format(\n          rowData.to,\n          'toFormat',\n        )}`\n      ) : (\n        <EditableColumn\n          value={signal.delta.toFixed(3)}\n          onSave={saveHandler}\n          type=\"number\"\n          style={{ padding: '0.1rem 0.4rem' }}\n        />\n      )}\n    </td>\n  );\n}\n\nexport default SignalDeltaColumn;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport lodashGet from 'lodash/get';\nimport { useMemo, useCallback, useState } from 'react';\n\nimport {\n  AssignmentsData,\n  useAssignment,\n  useAssignmentData,\n} from '../../assignment/AssignmentsContext';\nimport { filterForIDsWithAssignment } from '../../assignment/utilities/filterForIDsWithAssignment';\nimport {\n  HighlightedSource,\n  useHighlight,\n  useHighlightData,\n} from '../../highlight';\nimport { isColumnVisible } from '../extra/preferences/ColumnsHelper';\n\nimport AbsoluteColumn from './TableColumns/AbsoluteColumn';\nimport ActionsColumn from './TableColumns/ActionsColumn';\nimport CouplingColumn from './TableColumns/CouplingColumn';\nimport RangeAssignmentsColumn from './TableColumns/RangeAssignmentsColumn';\nimport RangeColumn from './TableColumns/RangeColumn';\nimport RelativeColumn from './TableColumns/RelativeColumn';\nimport SignalAssignmentsColumn from './TableColumns/SignalAssignmentsColumn';\nimport SignalDeltaColumn from './TableColumns/SignalDeltaColumn';\nimport useFormat from './TableColumns/format';\n\nconst HighlightedRowStyle = css`\n  background-color: #ff6f0057;\n`;\n\nconst ConstantlyHighlightedRowStyle = css`\n  background-color: #f5f5dc;\n`;\n\ninterface RangesTableRowProps {\n  rowData: any;\n  onUnlink: (a: any, b?: any) => void;\n  onContextMenu: (element: any, data: any) => void;\n  preferences: string;\n}\n\nfunction RangesTableRow({\n  rowData,\n  onUnlink,\n  onContextMenu,\n  preferences,\n}: RangesTableRowProps) {\n  const assignmentData = useAssignmentData();\n  const assignmentRange = useAssignment(rowData.id);\n  const highlightRange = useHighlight(\n    [assignmentRange.id].concat(assignmentRange.assigned?.x || []).concat(\n      filterForIDsWithAssignment(\n        assignmentData,\n        rowData.signals.map((_signal) => _signal.id),\n      ),\n    ),\n    { type: HighlightedSource.RANGE },\n  );\n  const highlightRangeAssignmentsColumn = useHighlight(\n    assignmentRange.assigned?.x || [],\n    { type: HighlightedSource.RANGE },\n  );\n  const assignmentSignal = useAssignment(rowData.tableMetaInfo.id);\n  const highlightSignal = useHighlight(\n    [assignmentSignal.id].concat(assignmentSignal.assigned?.x || []),\n    { type: HighlightedSource.SIGNAL },\n  );\n  const highlightData = useHighlightData();\n  const [unlinkRangeButtonVisibility, showUnlinkRangeButton] = useState(false);\n  const [unlinkSignalButtonVisibility, showUnlinkSignalButton] =\n    useState(false);\n\n  const getFormat = useFormat(preferences);\n\n  const rowSpanTags: any = useMemo(() => {\n    return {\n      rowSpan: rowData.tableMetaInfo.rowSpan,\n      style: lodashGet(rowData.tableMetaInfo, 'hide', false)\n        ? { display: 'none' }\n        : undefined,\n    };\n  }, [rowData.tableMetaInfo]);\n\n  const unlinkHandler = useCallback(\n    (e, isOnRangeLevel) => {\n      // stop propagation here to prevent enabling/disabling the assignment mode at the same time\n      if (e) {\n        e.stopPropagation();\n      }\n\n      if (isOnRangeLevel !== undefined) {\n        if (isOnRangeLevel) {\n          onUnlink(rowData);\n          showUnlinkRangeButton(false);\n          assignmentRange.removeAll('x');\n        } else {\n          onUnlink(\n            rowData,\n            lodashGet(rowData, 'tableMetaInfo.signalIndex', undefined),\n          );\n          showUnlinkSignalButton(false);\n          assignmentSignal.removeAll('x');\n        }\n      } else {\n        showUnlinkRangeButton(false);\n        showUnlinkSignalButton(false);\n      }\n    },\n    [assignmentRange, assignmentSignal, onUnlink, rowData],\n  );\n\n  const linkHandler = useCallback((e, assignment: AssignmentsData) => {\n    e.stopPropagation();\n    assignment.setActive('x');\n  }, []);\n\n  const onHoverRange = useMemo(() => {\n    return {\n      onMouseEnter: () => {\n        assignmentRange.show('x');\n        highlightRange.show();\n      },\n      onMouseLeave: () => {\n        assignmentRange.hide();\n        highlightRange.hide();\n      },\n    };\n  }, [assignmentRange, highlightRange]);\n\n  const onHoverRangeAssignmentsColumn = useMemo(() => {\n    return {\n      onMouseEnter: () => {\n        assignmentRange.show('x');\n        highlightRangeAssignmentsColumn.show();\n      },\n      onMouseLeave: () => {\n        assignmentRange.hide();\n        highlightRangeAssignmentsColumn.hide();\n      },\n    };\n  }, [assignmentRange, highlightRangeAssignmentsColumn]);\n\n  const onHoverSignal = useMemo(() => {\n    return {\n      onMouseEnter: () => {\n        assignmentSignal.show('x');\n        highlightSignal.show();\n      },\n      onMouseLeave: () => {\n        assignmentSignal.hide();\n        highlightSignal.hide();\n      },\n    };\n  }, [assignmentSignal, highlightSignal]);\n\n  const trCss = useMemo(() => {\n    return highlightRange.isActive || assignmentRange.isActive\n      ? HighlightedRowStyle\n      : lodashGet(rowData, 'tableMetaInfo.isConstantlyHighlighted', false)\n      ? ConstantlyHighlightedRowStyle\n      : null;\n  }, [assignmentRange.isActive, highlightRange.isActive, rowData]);\n\n  return (\n    <tr onContextMenu={(e) => onContextMenu(e, rowData)} css={trCss}>\n      <td {...rowSpanTags} {...onHoverRange}>\n        {rowData.tableMetaInfo.rowIndex + 1}\n      </td>\n\n      {isColumnVisible(preferences, 'showFrom') && (\n        <RangeColumn\n          value={rowData.from}\n          rowSpanTags={rowSpanTags}\n          onHoverRange={onHoverRange}\n          format={getFormat('showFrom', undefined)}\n        />\n      )}\n      {isColumnVisible(preferences, 'showTo') && (\n        <RangeColumn\n          value={rowData.to}\n          rowSpanTags={rowSpanTags}\n          onHoverRange={onHoverRange}\n          format={getFormat('toFormat', undefined)}\n        />\n      )}\n\n      <SignalDeltaColumn\n        rowData={rowData}\n        onHoverSignal={onHoverSignal}\n        preferences={preferences}\n      />\n\n      {isColumnVisible(preferences, 'showRelative') && (\n        <RelativeColumn\n          rowData={rowData}\n          rowSpanTags={rowSpanTags}\n          onHoverRange={onHoverRange}\n          format={getFormat('relativeFormat', undefined)}\n        />\n      )}\n\n      {isColumnVisible(preferences, 'showAbsolute') && (\n        <AbsoluteColumn\n          value={rowData.absolute}\n          rowSpanTags={rowSpanTags}\n          onHoverRange={onHoverRange}\n          format={getFormat('absoluteFormat', undefined)}\n        />\n      )}\n\n      <td {...onHoverSignal}>\n        {lodashGet(rowData, 'tableMetaInfo.signal.multiplicity', '')}\n      </td>\n\n      <CouplingColumn rowData={rowData} onHoverSignal={onHoverSignal} />\n\n      <SignalAssignmentsColumn\n        rowData={rowData}\n        assignment={assignmentSignal}\n        highlight={highlightSignal}\n        onHover={onHoverSignal}\n        unlinkVisibility={unlinkSignalButtonVisibility}\n        onUnlinkVisibilityChange={(flag) => showUnlinkSignalButton(flag)}\n        onLink={linkHandler}\n        onUnlink={unlinkHandler}\n      />\n\n      <RangeAssignmentsColumn\n        rowData={rowData}\n        assignment={assignmentRange}\n        highlight={highlightRangeAssignmentsColumn}\n        onHover={onHoverRangeAssignmentsColumn}\n        unlinkVisibility={unlinkRangeButtonVisibility}\n        onUnlinkVisibilityChange={(flag) => showUnlinkRangeButton(flag)}\n        onLink={linkHandler}\n        onUnlink={unlinkHandler}\n        rowSpanTags={rowSpanTags}\n        highlightData={highlightData}\n      />\n\n      <ActionsColumn\n        rowData={rowData}\n        onHoverSignal={onHoverSignal}\n        onHoverRange={onHoverRange}\n        rowSpanTags={rowSpanTags}\n      />\n    </tr>\n  );\n}\n\nexport default RangesTableRow;\n","import { useMemo } from 'react';\n\nimport { Range } from '../../../../data/types/data1d';\nimport generateID from '../../../../data/utilities/generateID';\n\nexport interface RangeData extends Range {\n  rowKey: string;\n  tableMetaInfo: any;\n}\n\nfunction useMapRanges(data) {\n  return useMemo(() => {\n    const _rangesData: Array<RangeData> = [];\n    data.forEach((range, i) => {\n      if (range.signals.length === 1) {\n        _rangesData.push({\n          rowKey: generateID(),\n          ...range,\n          tableMetaInfo: {\n            ...range.tableMetaInfo,\n            signal: range.signals[0],\n            rowIndex: i,\n            signalIndex: 0,\n            id: range.signals[0].id,\n          },\n        });\n      } else if (range.signals.length > 1) {\n        range.signals.forEach((signal, j) => {\n          let hide = false;\n          let rowSpan = null;\n          if (j < range.signals.length - 1) {\n            if (j === 0) {\n              rowSpan = range.signals.length;\n            } else {\n              hide = true;\n            }\n          } else {\n            hide = true;\n          }\n\n          _rangesData.push({\n            rowKey: generateID(),\n            ...range,\n            tableMetaInfo: {\n              ...range.tableMetaInfo,\n              signal,\n              rowSpan,\n              hide,\n              rowIndex: i,\n              signalIndex: j,\n              id: signal.id,\n            },\n          });\n        });\n      }\n    });\n\n    return _rangesData;\n  }, [data]);\n}\n\nexport default useMapRanges;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport lodashGet from 'lodash/get';\nimport { Fragment, useCallback, useRef } from 'react';\nimport { FaLink } from 'react-icons/fa';\n\nimport checkModifierKeyActivated from '../../../data/utilities/checkModifierKeyActivated';\nimport ContextMenu from '../../elements/ContextMenu';\nimport useTableSortBy from '../../hooks/useTableSortBy';\n\nimport RangesTableRow from './RangesTableRow';\nimport useMapRanges from './hooks/useMapRanges';\n\nconst tableStyle = css`\n  border-spacing: 0;\n  border: 1px solid #dedede;\n  width: 100%;\n  font-size: 12px;\n  .react-contextmenu-wrapper {\n    display: contents;\n  }\n  tr {\n    :last-child {\n      td {\n        border-bottom: 0;\n      }\n    }\n  }\n  th {\n    position: sticky;\n    top: 0;\n    background-color: white;\n    z-index: 1;\n  }\n  th,\n  td {\n    white-space: nowrap;\n    text-align: center;\n    margin: 0;\n    padding: 0.1rem 0.4rem;\n    border-bottom: 1px solid #dedede;\n    border-right: 1px solid #dedede;\n\n    :last-child {\n      border-right: 0;\n    }\n    button {\n      background-color: transparent;\n      border: none;\n    }\n  }\n`;\n\nfunction RangesTable({ tableData, onUnlink, context, activeTab, preferences }) {\n  const element = activeTab?.replace(/[0-9]/g, '');\n  const contextRef = useRef<any>();\n  const { items: sortedData, isSortedDesc, onSort } = useTableSortBy(tableData);\n  const data = useMapRanges(sortedData);\n\n  const isVisible = (key) => {\n    return lodashGet(preferences, key, false);\n  };\n\n  const contextMenuHandler = useCallback(\n    (e, rowData) => {\n      if (!checkModifierKeyActivated(e)) {\n        e.preventDefault();\n        contextRef.current.handleContextMenu(e, rowData);\n      }\n    },\n    [contextRef],\n  );\n\n  return (\n    <Fragment>\n      <table css={tableStyle}>\n        <thead>\n          <tr>\n            <th>#</th>\n            {isVisible('showFrom') ? (\n              <th id=\"from\" {...onSort}>\n                From\n                {isSortedDesc('from').content}\n              </th>\n            ) : null}\n            {isVisible('showTo') ? (\n              <th id=\"to\" {...onSort}>\n                To {isSortedDesc('to').content}\n              </th>\n            ) : null}\n            <th>δ (ppm) </th>\n\n            {isVisible('showRelative') ? (\n              <th id=\"integration\" {...onSort}>\n                Rel. {element} {isSortedDesc('integration').content}\n              </th>\n            ) : null}\n            {isVisible('showAbsolute') ? <th>Absolute</th> : null}\n            <th>Mult.</th>\n            <th>J (Hz)</th>\n            <th>\n              <FaLink style={{ fontSize: 10 }} />\n            </th>\n            <th>Σ</th>\n            <th>Kind</th>\n            <th>{''}</th>\n          </tr>\n        </thead>\n        <tbody>\n          {data?.map((range) => {\n            return (\n              <RangesTableRow\n                key={range.rowKey}\n                rowData={range}\n                onUnlink={onUnlink}\n                onContextMenu={(e, rowData) => contextMenuHandler(e, rowData)}\n                preferences={preferences}\n              />\n            );\n          })}\n        </tbody>\n      </table>\n      <ContextMenu ref={contextRef} context={context} />\n    </Fragment>\n  );\n}\n\nexport default RangesTable;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport lodashGet from 'lodash/get';\nimport { xGetFromToIndex } from 'ml-spectra-processing';\nimport { useCallback, useMemo, memo, useState, useRef } from 'react';\n\nimport { Molecule } from '../../../data/molecules/Molecule';\nimport { Data1D, Datum1D, Info1D, Ranges } from '../../../data/types/data1d';\nimport { useAssignmentData } from '../../assignment/AssignmentsContext';\nimport { useChartData } from '../../context/ChartContext';\nimport { useDispatch } from '../../context/DispatchContext';\nimport { usePreferences } from '../../context/PreferencesContext';\nimport { useAlert } from '../../elements/popup/Alert';\nimport useSpectrum from '../../hooks/useSpectrum';\nimport { UNLINK_RANGE } from '../../reducer/types/Types';\nimport { copyTextToClipboard } from '../../utility/Export';\nimport { tablePanelStyle } from '../extra/BasicPanelStyle';\nimport NoTableData from '../extra/placeholder/NoTableData';\nimport { getRangeDefaultValues } from '../extra/preferences/defaultValues';\nimport PreferencesHeader from '../header/PreferencesHeader';\n\nimport RangesHeader from './RangesHeader';\nimport RangesPreferences from './RangesPreferences';\nimport RangesTable from './RangesTable';\n\ninterface RangesTablePanelInnerProps {\n  ranges: Ranges;\n  data: Data1D;\n  info: Info1D;\n  xDomain: Array<number>;\n  activeTab: string;\n  molecules: Array<Molecule>;\n  showMultiplicityTrees: boolean;\n  showJGraph: boolean;\n  showRangesIntegrals: boolean;\n  preferences: any;\n}\n\nfunction RangesTablePanelInner({\n  ranges,\n  data,\n  info,\n  xDomain,\n  preferences,\n  activeTab,\n  molecules,\n  showMultiplicityTrees,\n  showJGraph,\n  showRangesIntegrals,\n}: RangesTablePanelInnerProps) {\n  const [isFilterActive, setFilterIsActive] = useState(false);\n  const assignmentData = useAssignmentData();\n\n  const dispatch = useDispatch();\n  const alert = useAlert();\n  const [isFlipped, setFlipStatus] = useState(false);\n\n  const settingRef = useRef<any>();\n\n  const rangesData = useMemo(() => {\n    const isInView = (from, to) => {\n      const factor = 10000;\n      to = to * factor;\n      from = from * factor;\n      return (\n        (to >= xDomain[0] * factor && from <= xDomain[1] * factor) ||\n        (from <= xDomain[0] * factor && to >= xDomain[1] * factor)\n      );\n    };\n\n    const getFilteredRanges = (ranges) => {\n      return ranges.filter((range) => isInView(range.from, range.to));\n    };\n\n    if (ranges.values) {\n      const _ranges = isFilterActive\n        ? getFilteredRanges(ranges.values)\n        : ranges.values;\n\n      return _ranges.map((range) => {\n        return {\n          ...range,\n          tableMetaInfo: {\n            isConstantlyHighlighted: isInView(range.from, range.to),\n          },\n        };\n      });\n    }\n    return [];\n  }, [isFilterActive, ranges.values, xDomain]);\n\n  const unlinkRangeHandler = useCallback(\n    (rangeData, signalIndex = -1) => {\n      dispatch({\n        type: UNLINK_RANGE,\n        payload: {\n          rangeData,\n          assignmentData,\n          signalIndex,\n        },\n      });\n    },\n    [assignmentData, dispatch],\n  );\n\n  const saveJSONToClipboardHandler = useCallback(\n    async (value) => {\n      if (data.x && data.re) {\n        const { x, re } = data;\n        const { from, to } = value;\n\n        const { fromIndex, toIndex } = xGetFromToIndex(x, {\n          from,\n          to,\n        });\n        const dataToClipboard = {\n          x: Array.from(x.slice(fromIndex, toIndex)),\n          y: Array.from(re.slice(fromIndex, toIndex)),\n          ...value,\n        };\n\n        const success = await copyTextToClipboard(\n          JSON.stringify(dataToClipboard, undefined, 2),\n        );\n\n        if (success) {\n          alert.show('Data copied to clipboard');\n        } else {\n          alert.error('copy to clipboard failed');\n        }\n      }\n    },\n    [data, alert],\n  );\n\n  const rangesPreferences = useMemo(() => {\n    const _preferences =\n      lodashGet(\n        preferences.current,\n        `formatting.panels.ranges.[${activeTab}]`,\n      ) || getRangeDefaultValues(activeTab);\n\n    return _preferences;\n  }, [activeTab, preferences]);\n\n  const contextMenu = useMemo(\n    () => [\n      {\n        label: 'Copy to clipboard',\n        onClick: saveJSONToClipboardHandler,\n      },\n    ],\n    [saveJSONToClipboardHandler],\n  );\n\n  const filterHandler = useCallback(() => {\n    setFilterIsActive(!isFilterActive);\n  }, [isFilterActive]);\n\n  const settingsPanelHandler = useCallback(() => {\n    setFlipStatus(!isFlipped);\n  }, [isFlipped]);\n\n  const saveSettingHandler = useCallback(() => {\n    settingRef.current.saveSetting();\n    setFlipStatus(false);\n  }, []);\n\n  return (\n    <>\n      <div\n        css={[\n          tablePanelStyle,\n          isFlipped &&\n            css`\n              th {\n                position: relative;\n              }\n            `,\n        ]}\n      >\n        {!isFlipped && (\n          <RangesHeader\n            {...{\n              ranges,\n              info,\n              activeTab,\n              molecules,\n              showRangesIntegrals,\n              showMultiplicityTrees,\n              showJGraph,\n              isFilterActive,\n            }}\n            onUnlink={unlinkRangeHandler}\n            onFilterActivated={filterHandler}\n            onSettingClick={settingsPanelHandler}\n            filterCounter={rangesData.length}\n          />\n        )}\n        {isFlipped && (\n          <PreferencesHeader\n            onSave={saveSettingHandler}\n            onClose={settingsPanelHandler}\n          />\n        )}\n        <div className=\"inner-container\">\n          {!isFlipped ? (\n            <div className=\"table-container\">\n              {rangesData && rangesData.length > 0 ? (\n                <RangesTable\n                  activeTab={activeTab}\n                  tableData={rangesData}\n                  onUnlink={unlinkRangeHandler}\n                  context={contextMenu}\n                  preferences={rangesPreferences}\n                />\n              ) : (\n                <NoTableData />\n              )}\n            </div>\n          ) : (\n            <RangesPreferences ref={settingRef} />\n          )}\n        </div>\n      </div>\n    </>\n  );\n}\n\nconst MemoizedRangesTablePanel = memo(RangesTablePanelInner);\n\nconst emptyData = { ranges: {}, data: {}, info: {} };\n\nexport default function RangesTablePanel() {\n  const {\n    displayerKey,\n    xDomain,\n    activeTab,\n    molecules,\n    toolOptions: {\n      selectedTool,\n      data: { showMultiplicityTrees, showRangesIntegrals, showJGraph },\n    },\n  } = useChartData();\n\n  const { ranges, data, info } = useSpectrum(emptyData) as Datum1D;\n  const preferences = usePreferences();\n\n  return (\n    <MemoizedRangesTablePanel\n      {...{\n        ranges,\n        data,\n        info,\n        showMultiplicityTrees,\n        showJGraph,\n        showRangesIntegrals,\n        selectedTool,\n        displayerKey,\n        preferences,\n        xDomain,\n        activeTab,\n        molecules,\n      }}\n    />\n  );\n}\n","import { SvgNmrSameTop, SvgNmrResetScale } from 'cheminfo-font';\nimport { memo, useCallback } from 'react';\nimport {\n  FaCreativeCommonsSamplingPlus,\n  FaEye,\n  FaEyeSlash,\n} from 'react-icons/fa';\n\nimport { Datum1D } from '../../../data/types/data1d';\nimport { Datum2D } from '../../../data/types/data2d';\nimport { useChartData } from '../../context/ChartContext';\nimport { useDispatch } from '../../context/DispatchContext';\nimport Button from '../../elements/ButtonToolTip';\nimport { useAlert } from '../../elements/popup/Alert';\nimport { useModal } from '../../elements/popup/Modal';\nimport { ActiveSpectrum } from '../../reducer/Reducer';\nimport { DISPLAYER_MODE } from '../../reducer/core/Constants';\nimport {\n  ADD_MISSING_PROJECTION,\n  CHANGE_VISIBILITY,\n  DELETE_SPECTRA,\n  RESET_SPECTRA_SCALE,\n  SET_SPECTRA_SAME_TOP,\n} from '../../reducer/types/Types';\nimport DefaultPanelHeader from '../header/DefaultPanelHeader';\nimport { SpectraAutomaticPickingButton } from '../header/SpectraAutomaticPickingButton';\n\ninterface SpectraPanelHeaderProps {\n  spectrums: Array<Datum1D | Datum2D>;\n}\n\ninterface SpectraPanelHeaderInnerProps extends SpectraPanelHeaderProps {\n  data: Array<Datum1D | Datum2D>;\n  activeTab: string;\n  activeSpectrum: ActiveSpectrum | null;\n  displayerMode: string;\n}\n\nfunction SpectraPanelHeaderInner({\n  data,\n  activeSpectrum,\n  activeTab,\n  displayerMode,\n  spectrums,\n}: SpectraPanelHeaderInnerProps) {\n  const modal = useModal();\n  const alert = useAlert();\n  const dispatch = useDispatch();\n\n  const handleDelete = useCallback(() => {\n    modal.showConfirmDialog({\n      message: 'All records will be deleted, Are You sure?',\n      buttons: [\n        {\n          text: 'Yes',\n          handler: () => {\n            dispatch({ type: DELETE_SPECTRA });\n          },\n        },\n        { text: 'No' },\n      ],\n    });\n  }, [dispatch, modal]);\n\n  const showAllSpectrumsHandler = useCallback(() => {\n    const spectrumsPerTab = spectrums.map((datum) => {\n      return datum.id;\n    });\n    dispatch({ type: CHANGE_VISIBILITY, id: spectrumsPerTab });\n  }, [dispatch, spectrums]);\n\n  const hideAllSpectrumsHandler = useCallback(() => {\n    dispatch({ type: CHANGE_VISIBILITY, id: [] });\n  }, [dispatch]);\n\n  const addMissingProjectionHandler = useCallback(() => {\n    function getMissingProjection(SpectrumsData) {\n      let nucleus = activeTab.split(',');\n      nucleus = nucleus[0] === nucleus[1] ? [nucleus[0]] : nucleus;\n      const missingNucleus: Array<string> = [];\n      for (const n of nucleus) {\n        const hasSpectrums = SpectrumsData.some((d) => d.info.nucleus === n);\n        if (!hasSpectrums) {\n          missingNucleus.push(n);\n        }\n      }\n      return missingNucleus;\n    }\n    const missingNucleus = getMissingProjection(data);\n    if (missingNucleus.length > 0) {\n      dispatch({ type: ADD_MISSING_PROJECTION, nucleus: missingNucleus });\n    } else {\n      alert.error('Nothing to calculate');\n    }\n  }, [activeTab, alert, data, dispatch]);\n\n  const setSameTopHandler = useCallback(() => {\n    dispatch({ type: SET_SPECTRA_SAME_TOP });\n  }, [dispatch]);\n  const resetScaleHandler = useCallback(() => {\n    dispatch({ type: RESET_SPECTRA_SCALE });\n  }, [dispatch]);\n\n  return (\n    <DefaultPanelHeader\n      onDelete={handleDelete}\n      counter={spectrums?.length}\n      deleteToolTip=\"Delete all spectra\"\n    >\n      <Button popupTitle=\"Hide all spectra\" onClick={hideAllSpectrumsHandler}>\n        <FaEyeSlash />\n      </Button>\n      <Button popupTitle=\"Show all spectra\" onClick={showAllSpectrumsHandler}>\n        <FaEye />\n      </Button>\n      {activeSpectrum && activeTab && activeTab.split(',').length > 1 && (\n        <Button\n          popupTitle=\"Add missing projection\"\n          onClick={addMissingProjectionHandler}\n        >\n          <FaCreativeCommonsSamplingPlus />\n        </Button>\n      )}\n      {displayerMode === DISPLAYER_MODE.DM_1D && spectrums.length > 1 && (\n        <>\n          <Button popupTitle=\"Reset Scale\" onClick={resetScaleHandler}>\n            <SvgNmrResetScale />\n          </Button>\n          <Button popupTitle=\"Same Top\" onClick={setSameTopHandler}>\n            <SvgNmrSameTop />\n          </Button>\n        </>\n      )}\n      <SpectraAutomaticPickingButton />\n    </DefaultPanelHeader>\n  );\n}\n\nconst MemoizedSpectraPanelHeader = memo(SpectraPanelHeaderInner);\n\nexport default function SpectrumsTabs({ spectrums }: SpectraPanelHeaderProps) {\n  const { data, activeSpectrum, activeTab, displayerMode } = useChartData();\n  return (\n    <MemoizedSpectraPanelHeader\n      {...{\n        data,\n        activeSpectrum,\n        activeTab,\n        displayerMode,\n        spectrums,\n      }}\n    />\n  );\n}\n","import { CSSProperties, memo } from 'react';\n\ninterface ColorIndicatorNDProps {\n  activated: boolean;\n}\n\ninterface ColorIndicator1DProps extends ColorIndicatorNDProps {\n  color: string;\n}\n\ninterface ColorIndicator2DProps extends ColorIndicatorNDProps {\n  positiveColor: string;\n  negativeColor: string;\n}\n\nfunction ColorIndicator1D({ color, activated }: ColorIndicator1DProps) {\n  return (\n    <div\n      style={{\n        backgroundColor: color,\n        height: '12px',\n        width: '12px',\n        opacity: activated ? 1 : 0.1,\n        display: 'inline-block',\n      }}\n    />\n  );\n}\n\nfunction ColorIndicator2D({\n  positiveColor,\n  negativeColor,\n  activated,\n}: ColorIndicator2DProps) {\n  return (\n    <svg\n      width=\"12\"\n      height=\"12\"\n      viewBox=\"0 0 12 12\"\n      opacity={activated ? 1 : 0.1}\n    >\n      <g>\n        <path d=\"M0,0H12L0,12Z\" fill={positiveColor} strokeWidth=\"0\" />\n        <path d=\"M12,12H0L12,0Z\" fill={negativeColor} strokeWidth=\"0\" />\n      </g>\n    </svg>\n  );\n}\n\ntype ColorIndicatorProps = BaseColorIndicatorProps &\n  (\n    | {\n        dimension: 1;\n        color: Omit<ColorIndicator1DProps, 'activated'>;\n      }\n    | { dimension: 2; color: Omit<ColorIndicator2DProps, 'activated'> }\n  );\n\ninterface BaseColorIndicatorProps {\n  activated: boolean;\n  onClick: (e: any) => void;\n  style: CSSProperties;\n}\n\nfunction ColorIndicator(props: ColorIndicatorProps) {\n  const { style, onClick = () => null, activated } = props;\n\n  return (\n    <button style={style} type=\"button\" onClick={onClick}>\n      {props.dimension === 2 ? (\n        <ColorIndicator2D {...props.color} activated={activated} />\n      ) : (\n        <ColorIndicator1D activated={activated} {...props.color} />\n      )}\n    </button>\n  );\n}\n\nexport default memo(ColorIndicator);\n","import { SvgNmrPeaks } from 'cheminfo-font';\nimport { CSSProperties } from 'react';\n\ninterface DataProps {\n  id: string;\n  peaks: {\n    values: Array<any>;\n  };\n}\n\ninterface MarkersProps {\n  id: string;\n}\n\ninterface ShowHideMarkersButtonProps {\n  style: CSSProperties;\n  data: DataProps;\n  onChangeMarkersVisibility: (data: DataProps) => void;\n  markersVisible: Array<MarkersProps>;\n}\n\nexport default function ShowHideMarkersButton({\n  data,\n  onChangeMarkersVisibility,\n  markersVisible,\n  style,\n}: ShowHideMarkersButtonProps) {\n  const isMarkerVisible = (id) => {\n    return markersVisible.findIndex((v) => v.id === id) !== -1 ? true : false;\n  };\n\n  return (\n    <button\n      style={{\n        ...style,\n        opacity:\n          isMarkerVisible(data.id) && data.peaks && data.peaks.values.length > 0\n            ? 1\n            : 0.1,\n      }}\n      type=\"button\"\n      onClick={() => onChangeMarkersVisibility(data)}\n      disabled={data.peaks && data.peaks.values.length === 0}\n    >\n      <SvgNmrPeaks />\n    </button>\n  );\n}\n","import { CSSProperties } from 'react';\nimport { FaEye } from 'react-icons/fa';\n\ninterface DataProps {\n  id: string;\n  display: { color: string; positiveColor: string; negativeColor: string };\n  info: {\n    dimension: 1 | 2;\n  };\n}\n\ninterface ShowHideSpectrumButtonProps {\n  data: DataProps;\n  onChangeVisibility: (\n    data: DataProps,\n    is: 'isVisible' | 'isPositiveVisible' | 'isNegativeVisible',\n  ) => void;\n  style: CSSProperties;\n}\n\nexport default function ShowHideSpectrumButton({\n  data,\n  onChangeVisibility,\n  style,\n}: ShowHideSpectrumButtonProps) {\n  const isVisible = (id, key) => {\n    return data ? data.display[key] : true;\n  };\n  return (\n    <>\n      {data.info.dimension === 1 && (\n        <button\n          data-test-id=\"hide-show-spectrum-button\"\n          style={style}\n          type=\"button\"\n          onClick={() => onChangeVisibility(data, 'isVisible')}\n        >\n          <FaEye\n            style={{\n              ...(isVisible(data.id, 'isVisible')\n                ? {\n                    opacity: 1,\n                    strokeWidth: '1px',\n                    fill: data.display.color,\n                  }\n                : {\n                    opacity: 0.1,\n                    fill: data.display.color,\n                  }),\n            }}\n          />\n        </button>\n      )}\n      {data.info.dimension === 2 && (\n        <div style={{ minWidth: '40px' }}>\n          <button\n            style={{ ...style, width: '20px', minWidth: '20px' }}\n            type=\"button\"\n            onClick={() => onChangeVisibility(data, 'isPositiveVisible')}\n          >\n            <FaEye\n              style={{\n                ...(isVisible(data.id, 'isPositiveVisible')\n                  ? {\n                      opacity: 1,\n                      strokeWidth: '1px',\n                      fill: data.display.positiveColor,\n                    }\n                  : {\n                      opacity: 0.1,\n                      fill: data.display.positiveColor,\n                    }),\n              }}\n            />\n          </button>\n          <button\n            style={{ ...style, width: '20px', minWidth: '20px' }}\n            type=\"button\"\n            onClick={() => onChangeVisibility(data, 'isNegativeVisible')}\n          >\n            <FaEye\n              style={{\n                ...(isVisible(data.id, 'isNegativeVisible')\n                  ? {\n                      opacity: 1,\n                      strokeWidth: '1px',\n                      fill: data.display.negativeColor,\n                    }\n                  : {\n                      opacity: 0.1,\n                      fill: data.display.negativeColor,\n                    }),\n              }}\n            />\n          </button>\n        </div>\n      )}\n    </>\n  );\n}\n","import { SvgNmrFid, SvgNmrFt, SvgNmr2D } from 'cheminfo-font';\nimport { CSSProperties, memo } from 'react';\n\nimport ColorIndicator from './base/ColorIndicator';\nimport ShowHideMarkersButton from './base/ShowHideMarkersButton';\nimport ShowHideSpectrumButton from './base/ShowHideSpectrumButton';\n\nconst styles: Record<\n  'button' | 'row' | 'name' | 'info' | 'icon',\n  CSSProperties\n> = {\n  button: {\n    backgroundColor: 'transparent',\n    border: 'none',\n    width: '26px',\n    minWidth: '26px',\n  },\n  row: {\n    display: 'flex',\n    alignContent: 'center',\n    height: '25px',\n    borderBottom: '0.55px solid #f1f1f1',\n  },\n  name: {\n    flex: 1,\n    height: '100%',\n    display: 'flex',\n  },\n  info: {\n    flex: '1 1 1px',\n    height: '100%',\n    display: 'block',\n    alignItems: 'center',\n    overflow: 'hidden',\n    textOverflow: 'ellipsis',\n    whiteSpace: 'nowrap',\n    lineHeight: '24px',\n  },\n  icon: {\n    display: 'flex',\n    margin: 'auto',\n    justifyContent: 'center',\n  },\n};\n\nfunction SpectrumListItem({\n  activeSpectrum,\n  markersVisible,\n  data,\n  onChangeVisibility,\n  onChangeMarkersVisibility,\n  onChangeActiveSpectrum,\n  onOpenSettingModal,\n  onContextMenu,\n}) {\n  const formatValueAsHTML = (value) => {\n    if (value) {\n      value = value.replace(/(?<value>[0-9]+)/g, '<sub>$<value></sub>');\n    }\n    return value;\n  };\n  const activated = activeSpectrum && activeSpectrum.id === data.id;\n  const { color, name, positiveColor, negativeColor } = data.display;\n  return (\n    <div\n      style={{\n        ...styles.row,\n        ...(activated\n          ? { backgroundColor: '#fafafa' }\n          : { opacity: activeSpectrum ? 0.2 : 1 }),\n      }}\n      onContextMenu={onContextMenu}\n    >\n      <ShowHideSpectrumButton\n        data={data}\n        onChangeVisibility={onChangeVisibility}\n        style={styles.button}\n      />\n\n      <div\n        data-test-id=\"activate-deactivate-spectrum-button\"\n        style={styles.name}\n        onClick={() => onChangeActiveSpectrum(data)}\n      >\n        <div style={{ ...styles.icon, width: '16px' }}>\n          {data.info.isFid ? (\n            <SvgNmrFid />\n          ) : data.info.dimension === 2 ? (\n            <SvgNmr2D />\n          ) : (\n            <SvgNmrFt />\n          )}\n        </div>\n        <span style={styles.info}>{name}</span>\n        <div\n          style={styles.info}\n          // eslint-disable-next-line react/no-danger\n          dangerouslySetInnerHTML={{\n            __html: data.info && formatValueAsHTML(data.info.solvent),\n          }}\n        />\n        <span style={styles.info}>\n          <span\n            style={{\n              borderLeft: '0.55px solid #e5e5e5',\n              paddingRight: '5px',\n            }}\n          />\n          {data.info?.experiment}\n        </span>\n\n        {/* {data.info && data.info.solvent} */}\n        {/* </div> */}\n        <span style={styles.info}>{data.info?.pulse}</span>\n      </div>\n\n      <ShowHideMarkersButton\n        data={data}\n        style={{\n          ...styles.icon,\n          ...styles.button,\n        }}\n        onChangeMarkersVisibility={onChangeMarkersVisibility}\n        markersVisible={markersVisible}\n      />\n      <ColorIndicator\n        style={styles.button}\n        dimension={data.info.dimension}\n        color={{ positiveColor, color, negativeColor }}\n        activated={activated}\n        onClick={(event) => onOpenSettingModal(data, event)}\n      />\n    </div>\n  );\n}\n\nexport default memo(SpectrumListItem);\n","import { useFormikContext } from 'formik';\nimport lodashGet from 'lodash/get';\nimport { useCallback, memo } from 'react';\nimport { SketchPicker } from 'react-color';\n\nimport { COLORS } from '../../../data/utilities/getColor';\n\ninterface FormikColorPickerProps {\n  name: string;\n  onColorChange?: (element: any) => void;\n}\n\nfunction FormikColorPicker(props: FormikColorPickerProps) {\n  const { onColorChange = () => null, name } = props;\n\n  const { values, setFieldValue } = useFormikContext();\n\n  const colorchangeHandler = useCallback(\n    (color) => {\n      onColorChange(color);\n      setFieldValue(\n        name,\n        `${color.hex}${Math.round(color.rgb.a * 255).toString(16)}`,\n      );\n    },\n    [name, onColorChange, setFieldValue],\n  );\n\n  return (\n    <SketchPicker\n      color={{ hex: lodashGet(values, name, '#000') }}\n      presetColors={COLORS}\n      onChangeComplete={(e) => colorchangeHandler(e)}\n    />\n  );\n}\n\nexport default memo(FormikColorPicker);\n","import {\n  Axis,\n  Heading,\n  Legend,\n  LineSeries,\n  Plot,\n  SeriesPoint,\n} from 'react-plot';\n\ninterface PlotData {\n  positive: SeriesPoint[];\n  negative: SeriesPoint[];\n}\ninterface PlotChartPros {\n  data: { sanPlot: PlotData; lines: PlotData };\n  sign: 'positive' | 'negative';\n  color: string;\n  yLogBase: number;\n  hideHeading?: boolean;\n}\n\nexport default function PlotChart({\n  data,\n  sign,\n  color,\n  yLogBase,\n  hideHeading = false,\n}: PlotChartPros) {\n  return (\n    <Plot width={180} height={220}>\n      {!hideHeading && <Heading title=\"Sanplot\" />}\n      <LineSeries\n        data={data.sanPlot?.[sign] || []}\n        xAxis=\"x\"\n        yAxis=\"y\"\n        label={sign}\n        lineStyle={{\n          stroke: color,\n          strokeWidth: 1.2,\n        }}\n        markerStyle={{\n          fill: color,\n          stroke: color,\n        }}\n      />\n      <LineSeries\n        data={data.lines?.[sign] || []}\n        xAxis=\"x\"\n        yAxis=\"y\"\n        label=\"noise level\"\n        lineStyle={{\n          stroke: 'blue',\n          strokeWidth: 0.8,\n          strokeDasharray: '3, 3',\n        }}\n        markerStyle={{\n          fill: color,\n          stroke: color,\n        }}\n      />\n      <Axis\n        id=\"x\"\n        label=\"Pt\"\n        position=\"bottom\"\n        tickLabelStyle={{ fontSize: '0.6rem' }}\n        labelStyle={{ fontSize: '0.6rem' }}\n      />\n      <Axis\n        id=\"y\"\n        label={`Intensity [Log${yLogBase}]`}\n        position=\"left\"\n        tickLabelStyle={{ fontSize: '0.6rem' }}\n        labelStyle={{ fontSize: '0.7rem' }}\n      />\n      <Legend position=\"embedded\" bottom={5} right={60} />\n    </Plot>\n  );\n}\n","import { xNoiseSanPlot, xyReduce } from 'ml-spectra-processing';\n\nimport { Data1D } from '../../../../../data/types/data1d';\nimport { Data2D } from '../../../../../data/types/data2d';\n\nexport function processSnapPlot<T extends '1D' | '2D'>(\n  dimension: T,\n  data: T extends '1D' ? Data1D : Data2D,\n  yLogBase: number,\n) {\n  const input =\n    dimension === '1D'\n      ? prepare1DData(data as Data1D)\n      : prepare2DData(data as Data2D);\n\n  const sanResult = xNoiseSanPlot(input);\n  const sanPlot: any = {};\n  const lines: any = {};\n  for (let plotKey in sanResult.sanplot) {\n    const { x, y } = xyReduce(sanResult.sanplot[plotKey]);\n    let result = new Array(x.length);\n    for (let i = 0; i < x.length; i++) {\n      result[i] = { x: x[i], y: y[i] };\n    }\n    sanPlot[plotKey] = result;\n    lines[plotKey] = getLine(sanResult[plotKey], result, { yLogBase });\n  }\n  return { sanPlot, lines };\n}\n\nfunction prepare1DData(data: Data1D) {\n  const length = data.re.length;\n  const jump = Math.floor(length / 307200) || 1;\n  const array = new Float64Array((length / jump) >> 0);\n  let index = 0;\n  for (let i = 0; i < array.length; i += jump) {\n    array[index++] = data.re[i];\n  }\n  return array;\n}\n\nfunction prepare2DData(data: Data2D) {\n  let cols = data.z[0].length;\n  let rows = data.z.length;\n  let jump = Math.floor((cols * rows) / 204800) || 1;\n  const array = new Float64Array(((cols * rows) / jump) >> 0);\n  let index = 0;\n  for (let i = 0; i < array.length; i += jump) {\n    array[index++] = data.z[(i / rows) >> 0][i % rows];\n  }\n  return array;\n}\n\nfunction getLine(value, data, options) {\n  const { log10, abs } = Math;\n  const { yLogBase } = options;\n  const first = data.length > 0 ? data[0].x : 0;\n  const last = data.length > 0 ? data[data.length - 1].x : 0;\n  const inLogScale = log10(abs(value)) / log10(yLogBase);\n  return [\n    { x: first, y: inLogScale },\n    { x: last, y: inLogScale },\n  ];\n}\n","import { memo, useMemo } from 'react';\n\nimport PlotChart from './PlotChart';\nimport { processSnapPlot } from './processSnapPlot';\n\nconst yLogBase = 2;\ninterface Spectrum1DHistogramProps {\n  color?: string;\n  data: any;\n}\n\nfunction Spectrum1DHistogram({\n  color = 'red',\n  data,\n}: Spectrum1DHistogramProps) {\n  const processedData = useMemo(() => {\n    return processSnapPlot('1D', data, yLogBase);\n  }, [data]);\n\n  return (\n    <div\n      style={{\n        display: 'flex',\n        flexDirection: 'column',\n        alignItems: 'center',\n        justifyContent: 'center',\n      }}\n    >\n      <div style={{ display: 'block' }}>\n        <PlotChart\n          data={processedData}\n          sign=\"positive\"\n          color={color}\n          yLogBase={yLogBase}\n        />\n      </div>\n      <div style={{ display: 'block', width: 180, height: 180 }}>\n        <PlotChart\n          data={processedData}\n          sign=\"negative\"\n          color={color}\n          yLogBase={yLogBase}\n          hideHeading\n        />\n      </div>\n    </div>\n  );\n}\n\nexport default memo(Spectrum1DHistogram);\n","import { useCallback, useRef } from 'react';\n\nimport FormikColorPicker from '../../../../elements/formik/FormikColorPicker';\nimport FormikForm from '../../../../elements/formik/FormikForm';\n\nimport Spectrum1DHistogram from './Spectrum1DHistogram';\n\ninterface Spectrum1DSettingProps {\n  data: any;\n  onSubmit: (values: any, helpers: any) => void;\n}\n\nfunction Spectrum1DSetting({\n  data: SpectrumData,\n  onSubmit,\n}: Spectrum1DSettingProps) {\n  const refForm = useRef<any>(null);\n\n  const triggerSubmitHandler = useCallback(() => {\n    if (refForm.current) {\n      refForm.current.submitForm();\n    }\n  }, []);\n\n  return (\n    <FormikForm\n      ref={refForm}\n      initialValues={SpectrumData.display}\n      onSubmit={onSubmit}\n    >\n      <div style={{ display: 'flex', flexDirection: 'column', gap: '1.25rem' }}>\n        <div style={{ display: 'block', position: 'relative' }}>\n          <FormikColorPicker\n            name=\"color\"\n            onColorChange={triggerSubmitHandler}\n          />\n        </div>\n        <Spectrum1DHistogram color=\"red\" data={SpectrumData.data} />\n      </div>\n    </FormikForm>\n  );\n}\n\nexport default Spectrum1DSetting;\n","import { useFormikContext } from 'formik';\nimport lodashGet from 'lodash/get';\nimport { useCallback, memo } from 'react';\nimport ReactSlider from 'react-slider';\n\ninterface FormikSliderProps {\n  name: string;\n  onAfterChange?: (element: any) => void;\n}\n\nfunction FormikSlider(props: FormikSliderProps) {\n  const { onAfterChange = () => null, name, ...sliderProps } = props;\n\n  const { values, setFieldValue } = useFormikContext();\n\n  const changeHandler = useCallback(\n    (value) => {\n      onAfterChange(value);\n      setFieldValue(name, value);\n    },\n    [name, onAfterChange, setFieldValue],\n  );\n\n  return (\n    <ReactSlider\n      className=\"horizontal-slider\"\n      thumbClassName=\"thumb\"\n      trackClassName=\"track\"\n      defaultValue={lodashGet(values, name, [0, 100])}\n      onAfterChange={changeHandler}\n      renderThumb={(props, state) => (\n        <div {...props}>\n          <span>{state.valueNow}</span>\n        </div>\n      )}\n      pearling\n      minDistance={10}\n      {...sliderProps}\n    />\n  );\n}\n\nexport default memo(FormikSlider);\n","import { memo, useMemo } from 'react';\n\nimport PlotChart from './PlotChart';\nimport { processSnapPlot } from './processSnapPlot';\n\ninterface Spectrum2DHistogramProps {\n  color?: string;\n  data: any;\n}\n\nconst yLogBase = 2;\n\nfunction Spectrum2DHistogram({\n  color = 'red',\n  data,\n}: Spectrum2DHistogramProps) {\n  const processedData = useMemo(() => {\n    return processSnapPlot('2D', data, yLogBase);\n  }, [data]);\n\n  return (\n    <div>\n      <div style={{ textAlign: 'center', paddingBottom: 5, paddingTop: 5 }}>\n        San Plot\n      </div>\n\n      <div\n        style={{\n          borderTop: '1px solid #ededed',\n          marginTop: '10px',\n          paddingTop: '10px',\n          display: 'flex',\n          flexDirection: 'row',\n        }}\n      >\n        <PlotChart\n          data={processedData}\n          sign=\"positive\"\n          color={color}\n          yLogBase={yLogBase}\n        />\n        <PlotChart\n          data={processedData}\n          sign=\"negative\"\n          color={color}\n          yLogBase={yLogBase}\n          hideHeading\n        />\n      </div>\n    </div>\n  );\n}\n\nexport default memo(Spectrum2DHistogram);\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback, useRef } from 'react';\n\nimport FormikColorPicker from '../../../../elements/formik/FormikColorPicker';\nimport FormikForm from '../../../../elements/formik/FormikForm';\nimport FormikInput from '../../../../elements/formik/FormikInput';\nimport FormikSlider from '../../../../elements/formik/FormikSlider';\n\nimport Spectrum2DHistogram from './Spectrum2DHistogram';\n\ninterface Spectrum2DSettingProps {\n  data: any;\n  onSubmit: (values: any, helpers: any) => void;\n}\n\nfunction Spectrum2DSetting({\n  data: SpectrumData,\n  onSubmit,\n}: Spectrum2DSettingProps) {\n  const refForm = useRef<any>(null);\n\n  const style = css`\n    .positive {\n      display: inline-block;\n      .track-1 {\n        background-color: ${SpectrumData.display.positiveColor} !important;\n      }\n    }\n    .negative {\n      display: inline-block;\n\n      .track-1 {\n        background-color: ${SpectrumData.display.negativeColor} !important;\n      }\n    }\n  `;\n\n  const triggerSubmitHandler = useCallback(() => {\n    refForm.current.submitForm();\n  }, []);\n\n  return (\n    <FormikForm\n      ref={refForm}\n      initialValues={SpectrumData.display}\n      onSubmit={onSubmit}\n    >\n      <div css={style}>\n        <div className=\"positive\">\n          <span style={{ padding: '0 10px' }}>Positive</span>\n          <FormikColorPicker\n            name=\"positiveColor\"\n            onColorChange={triggerSubmitHandler}\n          />\n          <div style={{ padding: '5px' }}>\n            <span className=\"label\">contour Levels [ min - max ]</span>\n            <FormikSlider\n              name=\"contourOptions.positive.contourLevels\"\n              onAfterChange={triggerSubmitHandler}\n            />\n            <span className=\"label\">number of Layers </span>\n            <FormikInput\n              name=\"contourOptions.positive.numberOfLayers\"\n              onChange={triggerSubmitHandler}\n              type=\"number\"\n            />\n          </div>\n        </div>\n        <div className=\"negative\">\n          <span style={{ padding: '0 10px' }}>Negative</span>\n          <FormikColorPicker\n            name=\"negativeColor\"\n            onColorChange={triggerSubmitHandler}\n          />\n          <div style={{ padding: '5px' }}>\n            <span className=\"label\">contour Levels [ min - max ]</span>\n            <FormikSlider\n              name=\"contourOptions.negative.contourLevels\"\n              onAfterChange={triggerSubmitHandler}\n            />\n            <span className=\"label\">number of Layers </span>\n            <FormikInput\n              name=\"contourOptions.negative.numberOfLayers\"\n              onChange={triggerSubmitHandler}\n              type=\"number\"\n            />\n          </div>\n        </div>\n        <Spectrum2DHistogram data={SpectrumData.data} />\n      </div>\n    </FormikForm>\n  );\n}\n\nexport default Spectrum2DSetting;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { memo, useCallback } from 'react';\n\nimport { useDispatch } from '../../../../context/DispatchContext';\nimport { CHANGE_SPECTRUM_SETTING } from '../../../../reducer/types/Types';\n\nimport Spectrum1DSetting from './Spectrum1DSetting';\nimport Spectrum2DSetting from './Spectrum2DSetting';\n\nconst style = css`\n  position: fixed;\n  z-index: 999999999;\n  width:100%;\n  height:100%;\n  left:0;\n  top:0;\n  .inner-conatiner{\n    position:absolute;\n    display: flex;\n    flex-direction: row-reverse;\n    border-radius: 4px;\n    background-color: white;\n    box-shadow: rgba(0, 0, 0, 0.15) 0px 0px 0px 1px,\n      rgba(0, 0, 0, 0.15) 0px 8px 16px;\n      overflow: auto;\n      height: 350px;\n  }\n\n\n  .sketch-picker {\n    border-radius: none !important;\n    box-shadow: none !important;\n  }\n\n\n  .horizontal-slider {\n    width: 80%;\n    height: 15px;\n  }\n\n  .thumb {\n    height: 15px;\n    line-height: 15px;\n    width: 20px;\n    text-align: center;\n    color: black;\n    border-radius: 5px;\n    cursor: grab;\n    font-size: 10px;\n    background-image: -webkit-linear-gradient(top, #f4f1ee, #fff);\n    background-image: linear-gradient(top, #f4f1ee, #fff);\n  }\n\n  .track {\n    top: 0;\n    bottom: 0;\n    background: #eaeaea;\n    border-radius: 999px;\n    border-radius: 5px;\n  }\n\n  .track-1 {\n    background: red;\n  }\n   \n  .label{\n    font-size: 12px;\n    margin: 8px 0;\n    display: block;\n  }\n \n  }\n`;\n\ninterface SpectrumSettingProps {\n  position: { x: number; y: number } | null;\n  data: any;\n  onClose: () => void;\n}\n\nfunction SpectrumSetting({ position, data, onClose }: SpectrumSettingProps) {\n  const dispatch = useDispatch();\n  const { id, info } = data;\n\n  const submitHandler = useCallback(\n    (values) => {\n      dispatch({ type: CHANGE_SPECTRUM_SETTING, id, display: values });\n    },\n    [dispatch, id],\n  );\n\n  const clickHandler = useCallback(\n    (e) => {\n      if (e.target === e.currentTarget) {\n        onClose();\n      }\n    },\n    [onClose],\n  );\n\n  if (!position) return null;\n  const { x, y } = position;\n\n  return (\n    <div css={style} onClick={clickHandler}>\n      <div\n        className=\"inner-conatiner\"\n        style={{\n          left: info.dimension === 2 ? x - 460 : x - 240,\n          width: info.dimension === 2 ? 460 : 240,\n          padding: info.dimension === 2 ? '10px 0' : '',\n          top: y,\n        }}\n      >\n        {info.dimension === 2 ? (\n          <Spectrum2DSetting onSubmit={submitHandler} data={data} />\n        ) : (\n          <Spectrum1DSetting onSubmit={submitHandler} data={data} />\n        )}\n      </div>\n    </div>\n  );\n}\n\nfunction arePropsEqual() {\n  return true;\n}\n\nexport default memo(SpectrumSetting, arePropsEqual);\n","import { useCallback, useState, useMemo, useRef, useEffect, memo } from 'react';\n\nimport { Datum1D } from '../../../data/types/data1d';\nimport { Datum2D } from '../../../data/types/data2d';\nimport checkModifierKeyActivated from '../../../data/utilities/checkModifierKeyActivated';\nimport { useChartData } from '../../context/ChartContext';\nimport { useDispatch } from '../../context/DispatchContext';\nimport ContextMenu from '../../elements/ContextMenu';\nimport Tab from '../../elements/Tab/Tab';\nimport Tabs from '../../elements/Tab/Tabs';\nimport { useAlert } from '../../elements/popup/Alert';\nimport { ActiveSpectrum } from '../../reducer/Reducer';\nimport {\n  CHANGE_PEAKS_MARKERS_VISIBILITY,\n  SET_ACTIVE_TAB,\n  CHANGE_VISIBILITY,\n  CHANGE_ACTIVE_SPECTRUM,\n  DELETE_SPECTRA,\n} from '../../reducer/types/Types';\nimport { copyTextToClipboard } from '../../utility/Export';\nimport GroupByInfoKey from '../../utility/GroupByInfoKey';\n\nimport SpectrumListItem from './SpectrumListItem';\nimport SpectrumSetting from './base/setting/SpectrumSetting';\n\ninterface TabChangeProps {\n  tab: string;\n  data: Array<Datum1D | Datum2D>;\n}\n\ninterface SpectrumsTabsProps {\n  onTabChange: (data: TabChangeProps) => void;\n}\ninterface SpectrumsTabsInnerProps extends SpectrumsTabsProps {\n  data: Array<Datum1D | Datum2D>;\n  activeTab: string;\n  activeSpectrum: ActiveSpectrum | null;\n}\n\nfunction SpectrumsTabsInner({\n  data,\n  activeSpectrum,\n  activeTab,\n  onTabChange,\n}: SpectrumsTabsInnerProps) {\n  const contextRef = useRef<any>();\n  const [markersVisible, setMarkersVisible] = useState<Array<{ id: string }>>(\n    [],\n  );\n  const [selectedSpectrumData, setSelectedSpectrum] = useState(null);\n  const [settingModalPosition, setSettingModalPosition] = useState<{\n    x: number;\n    y: number;\n  } | null>(null);\n  const [isSettingModalDisplayed, setIsSettingModalDisplayed] = useState(false);\n\n  const alert = useAlert();\n  const dispatch = useDispatch();\n\n  useEffect(() => {\n    if (data) {\n      const visibleMarkers = data.reduce((acc: any, datum) => {\n        if (\n          datum.info.dimension === 1 &&\n          (datum as Datum1D).display.isPeaksMarkersVisible === true\n        ) {\n          acc.push({ id: datum.id });\n        }\n        return acc;\n      }, []);\n\n      setMarkersVisible(visibleMarkers);\n    }\n  }, [data, dispatch]);\n\n  const spectrumsGroupByNucleus = useMemo(() => {\n    if (!data) return [];\n    const groupByNucleus = GroupByInfoKey('nucleus');\n    return groupByNucleus(data, true);\n  }, [data]);\n\n  useEffect(() => {\n    onTabChange({\n      tab: activeTab,\n      data: spectrumsGroupByNucleus[activeTab],\n    });\n  }, [activeTab, onTabChange, spectrumsGroupByNucleus]);\n\n  const handleChangeMarkersVisibility = useCallback(\n    (d) => {\n      const currentIndex = markersVisible.findIndex((v) => v.id === d.id);\n      const newChecked = [...markersVisible];\n      if (currentIndex === -1) {\n        newChecked.push({ id: d.id });\n      } else {\n        newChecked.splice(currentIndex, 1);\n      }\n      dispatch({ type: CHANGE_PEAKS_MARKERS_VISIBILITY, data: newChecked });\n      setMarkersVisible(newChecked);\n    },\n    [dispatch, markersVisible],\n  );\n\n  const onTabChangeHandler = useCallback(\n    (tab) => {\n      onTabChange({\n        tab: tab.tabid,\n        data: spectrumsGroupByNucleus[tab.tabid],\n      });\n\n      dispatch({ type: SET_ACTIVE_TAB, tab: tab.tabid });\n    },\n    [dispatch, onTabChange, spectrumsGroupByNucleus],\n  );\n\n  const contextMenu = useMemo(\n    () => [\n      {\n        label: 'Copy to Clipboard',\n        onClick: (spectrumData) => {\n          void (async () => {\n            const { x, y, info } = spectrumData;\n            const success = await copyTextToClipboard(\n              JSON.stringify({ x, y, info }, undefined, 2),\n            );\n\n            if (success) {\n              alert.success('Data copied to clipboard');\n            } else {\n              alert.error('Copy to clipboard failed');\n            }\n          })();\n        },\n      },\n      {\n        label: 'Delete',\n        onClick: (spectrumData) => {\n          setTimeout(() => {\n            dispatch({ type: DELETE_SPECTRA, id: spectrumData.id });\n          }, 0);\n        },\n      },\n    ],\n    [alert, dispatch],\n  );\n\n  const contextMenuHandler = useCallback(\n    (e, rowData) => {\n      if (!checkModifierKeyActivated(e)) {\n        e.preventDefault();\n        contextRef.current.handleContextMenu(e, rowData);\n      }\n    },\n    [contextRef],\n  );\n\n  const openSettingHandler = useCallback((selectedSpectrum, event) => {\n    setSettingModalPosition({\n      x: event.nativeEvent.clientX,\n      y: event.nativeEvent.clientY,\n    });\n    setSelectedSpectrum(selectedSpectrum);\n    setIsSettingModalDisplayed(true);\n  }, []);\n\n  const handleChangeVisibility = useCallback(\n    (d, key) => {\n      dispatch({\n        type: CHANGE_VISIBILITY,\n        id: d.id,\n        key,\n        value: !d.display[key],\n      });\n    },\n    [dispatch],\n  );\n\n  const handleChangeActiveSpectrum = useCallback(\n    (d) => {\n      setTimeout(() => {\n        if (activeSpectrum && activeSpectrum.id === d.id) {\n          dispatch({ type: CHANGE_ACTIVE_SPECTRUM, data: null });\n        } else {\n          dispatch({ type: CHANGE_ACTIVE_SPECTRUM, data: { id: d.id } });\n        }\n      }, 0);\n    },\n    [activeSpectrum, dispatch],\n  );\n\n  const mouseLeaveHandler = useCallback(() => {\n    setIsSettingModalDisplayed(false);\n  }, []);\n\n  return (\n    <div style={{ height: 'calc(100% - 25px)' }}>\n      <Tabs activeTab={activeTab} onClick={onTabChangeHandler}>\n        {spectrumsGroupByNucleus &&\n          Object.keys(spectrumsGroupByNucleus).map((group) => (\n            <Tab tablabel={group} tabid={group} key={group}>\n              {spectrumsGroupByNucleus[group]?.map((d) => (\n                <SpectrumListItem\n                  key={d.id}\n                  activeSpectrum={activeSpectrum}\n                  markersVisible={markersVisible}\n                  data={d}\n                  onChangeVisibility={handleChangeVisibility}\n                  onChangeMarkersVisibility={handleChangeMarkersVisibility}\n                  onChangeActiveSpectrum={handleChangeActiveSpectrum}\n                  onOpenSettingModal={openSettingHandler}\n                  onContextMenu={(e) => contextMenuHandler(e, d)}\n                />\n              ))}\n            </Tab>\n          ))}\n      </Tabs>\n      <ContextMenu ref={contextRef} context={contextMenu} />\n\n      {isSettingModalDisplayed ? (\n        <SpectrumSetting\n          onClose={mouseLeaveHandler}\n          data={selectedSpectrumData}\n          position={settingModalPosition}\n        />\n      ) : null}\n    </div>\n  );\n}\n\nconst MemoizedSpectra = memo(SpectrumsTabsInner);\n\nexport default function SpectrumsTabs({ onTabChange }: SpectrumsTabsProps) {\n  const { data, activeSpectrum, activeTab } = useChartData();\n\n  return (\n    <MemoizedSpectra {...{ data, activeSpectrum, activeTab, onTabChange }} />\n  );\n}\n","import { useCallback, memo, useState, CSSProperties } from 'react';\n\nimport SpectraPanelHeader from './SpectraPanelHeader';\nimport SpectrumsTabs from './SpectrumsTabs';\n\nconst styles: CSSProperties = {\n  overflow: 'hidden',\n  height: '100%',\n  display: 'flex',\n  flexDirection: 'column',\n  width: '100%',\n};\n\nfunction SpectrumListPanel() {\n  const [spectrums, setSpectrums] = useState<Array<any>>([]);\n\n  const tabChangeHandler = useCallback((e) => {\n    setSpectrums(e.data ? e.data : []);\n  }, []);\n\n  return (\n    <div style={styles}>\n      <SpectraPanelHeader spectrums={spectrums} />\n      <SpectrumsTabs onTabChange={tabChangeHandler} />\n    </div>\n  );\n}\n\nexport default memo(SpectrumListPanel);\n","import { FromTo } from 'cheminfo-types';\n\nexport interface DefaultPathLengthsInterface {\n  [key: string]: FromTo;\n}\n\nconst DefaultPathLengths: DefaultPathLengthsInterface = {\n  hmbc: { from: 2, to: 3 },\n  cosy: { from: 3, to: 4 },\n  hsqc: { from: 1, to: 1 },\n  hmqc: { from: 1, to: 1 },\n  inadequate: { from: 1, to: 1 },\n};\n\nexport default DefaultPathLengths;\n","import { FromTo } from 'cheminfo-types';\n\nimport DefaultPathLengths from '../../../../data/constants/DefaultPathLengths';\n\nfunction isDefaultPathLength(\n  pathLength: FromTo,\n  experimentType: string,\n): boolean {\n  return (\n    DefaultPathLengths[experimentType] &&\n    pathLength.from === DefaultPathLengths[experimentType].from &&\n    pathLength.to === DefaultPathLengths[experimentType].to\n  );\n}\n\nexport default isDefaultPathLength;\n","import { FromTo } from 'cheminfo-types';\nimport lodashCloneDeep from 'lodash/cloneDeep';\nimport lodashGet from 'lodash/get';\nimport {\n  addLink,\n  buildCorrelation,\n  buildLink,\n  getLinkDelta,\n  getLinkDim,\n  removeLink,\n  Correlation,\n  Link,\n} from 'nmr-correlation';\n\nimport DefaultPathLengths from '../../../../data/constants/DefaultPathLengths';\nimport { Datum2D } from '../../../../data/types/data2d';\nimport {\n  findSignal2D,\n  findSpectrum,\n} from '../../../../data/utilities/FindUtilities';\nimport { Spectra } from '../../../NMRium';\nimport isDefaultPathLength from '../../../modal/editZone/validation/isDefaultPathLength';\nimport { ActiveSpectrum } from '../../../reducer/Reducer';\nimport { DISPLAYER_MODE } from '../../../reducer/core/Constants';\nimport { ErrorColors } from '../CorrelationTable/Constants';\n\nfunction getAtomType(nucleus: string): string {\n  return nucleus.split(/\\d+/)[1];\n}\n\nfunction getLabelColor(correlationData, correlation) {\n  const error = lodashGet(\n    correlationData,\n    `state.${correlation.atomType}.error`,\n    null,\n  );\n\n  if (error) {\n    for (let { key, color } of ErrorColors) {\n      if (\n        key !== 'incomplete' && // do not consider this for a single atom type\n        (key === 'notAttached' || key === 'ambiguousAttachment') &&\n        lodashGet(error, `${key}`, []).some(\n          (index) => correlationData.values[index].id === correlation.id,\n        )\n      ) {\n        return color;\n      }\n    }\n  }\n\n  return null;\n}\n\nfunction findSignalMatch1D(\n  spectrum: Datum2D,\n  link: Link,\n  factor: number,\n  xDomain0: number,\n  xDomain1: number,\n) {\n  if (spectrum && spectrum.info.dimension === 2) {\n    const signal = findSignal2D(spectrum, link.signal.id);\n    if (signal) {\n      const otherAxis = link.axis === 'x' ? 'y' : 'x';\n      const delta = signal[otherAxis]?.delta;\n      if (delta !== undefined) {\n        return delta * factor >= xDomain0 && delta * factor <= xDomain1;\n      }\n    }\n  }\n  return false;\n}\n\nfunction findSignalMatch2D(\n  spectrum: Datum2D,\n  link: Link,\n  factor: number,\n  xDomain0: number,\n  xDomain1: number,\n  yDomain0: number,\n  yDomain1: number,\n): boolean {\n  if (spectrum && spectrum.info.dimension === 2) {\n    const signal = findSignal2D(spectrum, link.signal.id);\n    if (signal?.x.delta && signal?.y.delta) {\n      return (\n        signal.x.delta * factor >= xDomain0 &&\n        signal.x.delta * factor <= xDomain1 &&\n        signal.y.delta * factor >= yDomain0 &&\n        signal.y.delta * factor <= yDomain1\n      );\n    }\n  }\n  return false;\n}\n\nfunction getAbbreviation(link: Link): string {\n  let abbreviation = 'X';\n  if (link.experimentType === 'hsqc' || link.experimentType === 'hmqc') {\n    abbreviation =\n      !link.signal || link.signal.sign === 0\n        ? 'S'\n        : `S${link.signal.sign === 1 ? '+' : '-'}`;\n  } else if (\n    link.experimentType === 'hmbc' ||\n    link.experimentType === 'cosy' ||\n    link.experimentType === 'tocsy'\n  ) {\n    abbreviation = 'M';\n  } else if (\n    link.experimentType === 'noesy' ||\n    link.experimentType === 'roesy'\n  ) {\n    abbreviation = 'NOE';\n  } else if (link.experimentType === 'inadequate') {\n    abbreviation = 'I';\n  } else if (link.experimentType === 'adequate') {\n    abbreviation = 'A';\n  }\n\n  const pathLength: FromTo | undefined = link.signal.j?.pathLength;\n  if (pathLength) {\n    const isDefaultCorrelation =\n      DefaultPathLengths[link.experimentType] &&\n      pathLength.from >= DefaultPathLengths[link.experimentType].from &&\n      pathLength.from <= DefaultPathLengths[link.experimentType].to &&\n      pathLength.to >= DefaultPathLengths[link.experimentType].from &&\n      pathLength.to <= DefaultPathLengths[link.experimentType].to;\n\n    return `${abbreviation}${isDefaultCorrelation ? '' : '*'}`;\n  }\n\n  return abbreviation;\n}\n\nfunction buildNewLink1D(link) {\n  return buildLink({\n    ...link,\n    edited: {\n      ...link.edited,\n      moved: true,\n    },\n  });\n}\n\nfunction buildNewLink2D(link: Link, axis: 'x' | 'y') {\n  const linkIDs = link.id.split('_');\n  return buildLink({\n    ...link,\n    id: linkIDs[axis === 'x' ? 0 : 1],\n    axis,\n    match: [],\n    edited: {\n      ...link.edited,\n      moved: true,\n    },\n  });\n}\n\nfunction cloneCorrelationAndEditLink(\n  correlation: Correlation,\n  link: Link,\n  axis: 'x' | 'y',\n  action: 'add' | 'remove' | 'unmove',\n): Correlation {\n  const linkDim = getLinkDim(link);\n  const _correlation = lodashCloneDeep(correlation);\n  const split = link.id.split('_');\n  if (action === 'add') {\n    addLink(\n      _correlation,\n      linkDim === 1 ? buildNewLink1D(link) : buildNewLink2D(link, axis),\n    );\n  } else if (action === 'remove' || action === 'unmove') {\n    removeLink(_correlation, axis === 'x' ? split[0] : split[1]);\n  }\n\n  return _correlation;\n}\n\nfunction getEditedCorrelations({\n  correlationDim1,\n  correlationDim2,\n  selectedCorrelationIdDim1,\n  selectedCorrelationIdDim2,\n  action,\n  link,\n  correlations,\n}: {\n  correlationDim1: Correlation;\n  correlationDim2: Correlation;\n  action: 'move' | 'remove' | 'unmove' | 'setPathLength';\n  selectedCorrelationIdDim1: string | undefined;\n  selectedCorrelationIdDim2: string | undefined;\n  link: Link;\n  correlations: Correlation[];\n}) {\n  const selectedCorrelationDim1 = correlations.find(\n    (correlation) => correlation.id === selectedCorrelationIdDim1,\n  );\n  const selectedCorrelationDim2 = correlations.find(\n    (correlation) => correlation.id === selectedCorrelationIdDim2,\n  );\n  const hasChangedDim1 = selectedCorrelationDim1?.id !== correlationDim1.id;\n  const hasChangedDim2 =\n    correlationDim2 && selectedCorrelationDim2?.id !== correlationDim2?.id;\n  const linkDim = getLinkDim(link);\n\n  const editedCorrelations: Correlation[] = [];\n  const buildCorrelationDataOptions: {\n    skipDataUpdate?: boolean;\n  } = {};\n\n  if (action === 'move') {\n    if (linkDim === 1) {\n      // modify current cell correlation\n      const _correlationDim1 = cloneCorrelationAndEditLink(\n        correlationDim1,\n        link,\n        'x',\n        'remove',\n      );\n      // modify selected correlation\n      let newCorrelationDim1: Correlation;\n      if (selectedCorrelationDim1) {\n        newCorrelationDim1 = cloneCorrelationAndEditLink(\n          hasChangedDim1 ? selectedCorrelationDim1 : _correlationDim1,\n          link,\n          'x',\n          'add',\n        );\n      } else {\n        newCorrelationDim1 = buildCorrelation({\n          atomType: correlationDim1.atomType,\n          link: [buildNewLink1D(link)],\n        });\n      }\n      editedCorrelations.push(_correlationDim1, newCorrelationDim1);\n      buildCorrelationDataOptions.skipDataUpdate = true;\n    } else if (linkDim === 2) {\n      // modify current cell correlations\n      const _correlationDim1 = cloneCorrelationAndEditLink(\n        correlationDim1,\n        link,\n        'x',\n        'remove',\n      );\n      editedCorrelations.push(_correlationDim1);\n      const _correlationDim2 = cloneCorrelationAndEditLink(\n        correlationDim2,\n        link,\n        'y',\n        'remove',\n      );\n      editedCorrelations.push(_correlationDim2);\n\n      // modify selected correlations\n      if (selectedCorrelationDim1 && selectedCorrelationDim2) {\n        editedCorrelations.push(\n          cloneCorrelationAndEditLink(\n            hasChangedDim1 ? selectedCorrelationDim1 : _correlationDim1,\n            link,\n            'x',\n            'add',\n          ),\n        );\n        editedCorrelations.push(\n          cloneCorrelationAndEditLink(\n            hasChangedDim2 ? selectedCorrelationDim2 : _correlationDim2,\n            link,\n            'y',\n            'add',\n          ),\n        );\n      } else if (\n        selectedCorrelationDim1 &&\n        selectedCorrelationIdDim2 === 'new'\n      ) {\n        editedCorrelations.push(\n          cloneCorrelationAndEditLink(\n            hasChangedDim1 ? selectedCorrelationDim1 : _correlationDim1,\n            link,\n            'x',\n            'add',\n          ),\n        );\n        editedCorrelations.push(\n          buildCorrelation({\n            atomType: correlationDim2.atomType,\n            link: [buildNewLink2D(link, 'y')],\n          }),\n        );\n      } else if (\n        selectedCorrelationIdDim1 === 'new' &&\n        selectedCorrelationDim2\n      ) {\n        editedCorrelations.push(\n          buildCorrelation({\n            atomType: correlationDim1.atomType,\n            link: [buildNewLink2D(link, 'x')],\n          }),\n        );\n        editedCorrelations.push(\n          cloneCorrelationAndEditLink(\n            hasChangedDim2 ? selectedCorrelationDim2 : _correlationDim2,\n            link,\n            'y',\n            'add',\n          ),\n        );\n      } else if (\n        selectedCorrelationIdDim1 === 'new' &&\n        selectedCorrelationIdDim2 === 'new'\n      ) {\n        editedCorrelations.push(\n          buildCorrelation({\n            atomType: correlationDim1.atomType,\n            link: [buildNewLink2D(link, 'x')],\n          }),\n        );\n        editedCorrelations.push(\n          buildCorrelation({\n            atomType: correlationDim2.atomType,\n            link: [buildNewLink2D(link, 'y')],\n          }),\n        );\n      }\n      buildCorrelationDataOptions.skipDataUpdate = true;\n    }\n  } else if (action === 'remove') {\n    const _correlationDim1 = cloneCorrelationAndEditLink(\n      correlationDim1,\n      link,\n      'x',\n      'remove',\n    );\n    editedCorrelations.push(_correlationDim1);\n    if (getLinkDim(link) === 2) {\n      const _correlationDim2 = cloneCorrelationAndEditLink(\n        correlationDim2,\n        link,\n        'y',\n        'remove',\n      );\n      editedCorrelations.push(_correlationDim2);\n    }\n  } else if (action === 'unmove') {\n    if (linkDim === 1) {\n      if (selectedCorrelationDim1) {\n        editedCorrelations.push(\n          cloneCorrelationAndEditLink(\n            selectedCorrelationDim1,\n            link,\n            'x',\n            'unmove',\n          ),\n        );\n      }\n    } else if (linkDim === 2) {\n      if (selectedCorrelationDim1 && selectedCorrelationDim2) {\n        editedCorrelations.push(\n          cloneCorrelationAndEditLink(\n            selectedCorrelationDim1,\n            link,\n            'x',\n            'unmove',\n          ),\n        );\n        editedCorrelations.push(\n          cloneCorrelationAndEditLink(\n            selectedCorrelationDim2,\n            link,\n            'y',\n            'unmove',\n          ),\n        );\n      }\n    }\n  } else if (action === 'setPathLength') {\n    editedCorrelations.push(\n      cloneCorrelationAndSetPathLength(correlationDim1, link, 'x'),\n    );\n    editedCorrelations.push(\n      cloneCorrelationAndSetPathLength(correlationDim2, link, 'y'),\n    );\n  }\n\n  return { editedCorrelations, buildCorrelationDataOptions };\n}\n\nfunction cloneCorrelationAndSetPathLength(\n  correlation: Correlation,\n  editedLink: Link,\n  axis: 'x' | 'y',\n): Correlation {\n  const _correlation = lodashCloneDeep(correlation);\n  const linkDim = getLinkDim(editedLink);\n  if (linkDim === 2) {\n    const editedLinkID = editedLink.id.split('_')[axis === 'x' ? 0 : 1];\n    const _link = _correlation.link.find((link) => link.id === editedLinkID);\n    if (_link) {\n      const newPathLength: FromTo = editedLink.signal.j?.pathLength;\n      // remove (previous) pathLength if it is same as default\n      if (isDefaultPathLength(newPathLength, _link.experimentType)) {\n        delete _link.signal.j?.pathLength;\n        if (_link.signal.j && Object.keys(_link.signal.j).length === 0) {\n          delete _link.signal.j;\n        }\n        delete _link.edited.pathLength;\n      } else {\n        if (!_link.signal.j) {\n          _link.signal.j = { pathLength: newPathLength };\n        } else {\n          _link.signal.j.pathLength = newPathLength;\n        }\n        _link.edited.pathLength = true;\n      }\n    }\n  }\n\n  return _correlation;\n}\n\nfunction convertValuesString(\n  valuesString: string,\n  key: 'protonsCount' | 'hybridization',\n): number[] {\n  valuesString = valuesString\n    .toLowerCase()\n    .replace(/\\s+/g, '')\n    .split(',')\n    .map((token) => (token === 'sp' ? 'sp1' : token))\n    .join(',');\n  valuesString = valuesString.replaceAll('sp', '');\n\n  let values: number[] = [];\n  const regex = /^(?:[0-9],{0,1})+$/g;\n  if (regex.test(valuesString)) {\n    // allow digits followed by optional comma only\n    values = valuesString\n      .split(',')\n      .filter((char) => char.length > 0)\n      .map((char) => Number(char));\n  }\n\n  // allow key specific values only\n  // protonsCount: [0, 1, 2, 3, ...], hybridization: [1, 2, 3]\n  values = values.filter(\n    (value) =>\n      value >= (key === 'protonsCount' ? 0 : 1) &&\n      (key === 'protonsCount' || value <= 3),\n  );\n\n  // unique values\n  return values.filter((index, i, a) => a.indexOf(index) === i);\n}\n\nfunction isInView(\n  spectraData: Spectra,\n  activeTab: string,\n  activeSpectrum: ActiveSpectrum | null,\n  xDomain: number[],\n  yDomain: number[],\n  displayerMode: string,\n  correlation: Correlation,\n): boolean {\n  if (correlation.pseudo === true) {\n    return false;\n  }\n\n  if (\n    activeSpectrum === null ||\n    !correlation.link.some((link) => link.experimentID === activeSpectrum.id)\n  ) {\n    return false;\n  }\n\n  const atomTypesInView = activeTab.split(',').map((tab) => getAtomType(tab));\n\n  const factor = 10000;\n  const xDomain0 = xDomain[0] * factor;\n  const xDomain1 = xDomain[1] * factor;\n  const yDomain0 = yDomain[0] * factor;\n  const yDomain1 = yDomain[1] * factor;\n\n  if (displayerMode === DISPLAYER_MODE.DM_1D) {\n    const firstLink1D = correlation.link.find((link) => getLinkDim(link) === 1);\n    if (!firstLink1D) {\n      return false;\n    }\n    let delta = getLinkDelta(firstLink1D);\n    if (delta === undefined) {\n      return false;\n    }\n    delta *= factor;\n    const spectrum = findSpectrum(spectraData, firstLink1D.experimentID, true);\n    if (\n      spectrum &&\n      atomTypesInView[0] === correlation.atomType &&\n      delta >= xDomain0 &&\n      delta <= xDomain1\n    ) {\n      return true;\n    }\n    // try to find a link which contains the belonging 2D signal in the spectra in view\n    if (\n      correlation.link.some((link) => {\n        const spectrum = findSpectrum(\n          spectraData,\n          link.experimentID,\n          true,\n        ) as Datum2D;\n        return findSignalMatch1D(spectrum, link, factor, xDomain0, xDomain1);\n      })\n    ) {\n      return true;\n    }\n  } else if (displayerMode === DISPLAYER_MODE.DM_2D) {\n    if (!atomTypesInView.includes(correlation.atomType)) {\n      return false;\n    }\n    const firstLink2D = correlation.link.find((link) => getLinkDim(link) === 2);\n    if (!firstLink2D) {\n      return false;\n    }\n    const spectrum = findSpectrum(\n      spectraData,\n      firstLink2D.experimentID,\n      true,\n    ) as Datum2D;\n    // correlation is represented by a 2D signal\n    if (\n      findSignalMatch2D(\n        spectrum,\n        firstLink2D,\n        factor,\n        xDomain0,\n        xDomain1,\n        yDomain0,\n        yDomain1,\n      )\n    ) {\n      return true;\n    } else {\n      // try to find a link which contains the belonging 2D signal in the spectra in view\n      if (\n        correlation.link.some((link) => {\n          const spectrum = findSpectrum(\n            spectraData,\n            link.experimentID,\n            true,\n          ) as Datum2D;\n          return findSignalMatch2D(\n            spectrum,\n            link,\n            factor,\n            xDomain0,\n            xDomain1,\n            yDomain0,\n            yDomain1,\n          );\n        })\n      ) {\n        return true;\n      }\n    }\n  }\n  // do not show correlation\n  return false;\n}\n\nexport {\n  buildNewLink1D,\n  buildNewLink2D,\n  cloneCorrelationAndEditLink,\n  convertValuesString,\n  findSignalMatch1D,\n  findSignalMatch2D,\n  getAbbreviation,\n  getAtomType,\n  getEditedCorrelations,\n  getLabelColor,\n  isInView,\n};\n","import { Correlation } from 'nmr-correlation';\nimport { useMemo } from 'react';\n\nimport { useChartData } from '../../../context/ChartContext';\n\nimport { isInView } from './Utilities';\n\ninterface InputProps {\n  correlation: Correlation;\n}\n\nfunction IsInView({ correlation }: InputProps) {\n  const {\n    data: spectraData,\n    xDomain,\n    yDomain,\n    displayerMode,\n    activeTab,\n    activeSpectrum,\n  } = useChartData();\n\n  return useMemo(\n    () =>\n      isInView(\n        spectraData,\n        activeTab,\n        activeSpectrum,\n        xDomain,\n        yDomain,\n        displayerMode,\n        correlation,\n      ),\n    [\n      activeSpectrum,\n      activeTab,\n      correlation,\n      displayerMode,\n      spectraData,\n      xDomain,\n      yDomain,\n    ],\n  );\n}\n\nexport default IsInView;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback } from 'react';\n\nconst styles = css`\n  margin-top: 10px;\n  padding: 5px;\n  text-align: center;\n\n  p {\n    font-size: 14px;\n  }\n\n  button:focus {\n    outline: none;\n  }\n\n  button {\n    flex: 2;\n    padding: 5px;\n    border: 1px solid gray;\n    border-radius: 5px;\n    height: 30px;\n    margin: 0 auto;\n    margin-top: 15px;\n    display: block;\n    width: 90px;\n\n    color: white;\n    background-color: gray;\n  }\n`;\n\ninterface EditLinkConfirmationProps {\n  description: string;\n  onConfirm: () => void;\n}\n\nfunction EditLinkConfirmation({\n  description,\n  onConfirm,\n}: EditLinkConfirmationProps) {\n  const handleOnConfirm = useCallback(\n    (e) => {\n      e.preventDefault();\n      e.stopPropagation();\n\n      onConfirm();\n    },\n    [onConfirm],\n  );\n\n  return (\n    <div css={styles}>\n      <p>{description}</p>\n      <button type=\"button\" onClick={handleOnConfirm}>\n        Confirm\n      </button>\n    </div>\n  );\n}\n\nexport default EditLinkConfirmation;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { FromTo } from 'cheminfo-types';\nimport { useCallback, useEffect, useState } from 'react';\n\nimport DefaultPathLengths from '../../../../../data/constants/DefaultPathLengths';\nimport { Signal2D } from '../../../../../data/types/data2d';\nimport Button from '../../../../elements/Button';\nimport Input from '../../../../elements/Input';\nimport Label from '../../../../elements/Label';\n\nconst editPathLengthsStyles = css`\n  width: 100%;\n  height: 100%;\n  margin-top: 10px;\n  text-align: center;\n\n  .input-container {\n    width: 100%;\n    margin-top: 5px;\n    text-align: center;\n\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n  }\n\n  button {\n    flex: 2;\n    padding: 5px;\n    border: 1px solid gray;\n    border-radius: 5px;\n    height: 30px;\n    margin: 0 auto;\n    margin-top: 15px;\n    display: block;\n    width: 60px;\n\n    color: white;\n    background-color: gray;\n  }\n\n  .warning {\n    margin-top: 5px;\n    color: red;\n  }\n`;\n\ninterface InputProps {\n  signal: Signal2D;\n  experimentType: string;\n  onEdit: (editedSignal: Signal2D) => void;\n}\n\nfunction EditPathLength({ signal, experimentType, onEdit }: InputProps) {\n  const [from, setFrom] = useState<number>(\n    signal.j?.pathLength !== undefined\n      ? (signal.j.pathLength as FromTo).from\n      : DefaultPathLengths[experimentType]?.from || 0,\n  );\n  const [to, setTo] = useState<number>(\n    signal.j?.pathLength !== undefined\n      ? (signal.j.pathLength as FromTo).to\n      : DefaultPathLengths[experimentType]?.to || 0,\n  );\n  const [isError, setIsError] = useState<boolean>(false);\n\n  const handleOnEdit = useCallback(() => {\n    const pathLength: FromTo = {\n      from,\n      to,\n    };\n    const editedSignal: Signal2D = {\n      ...signal,\n      j: {\n        ...signal.j,\n        pathLength,\n      },\n    };\n\n    onEdit(editedSignal);\n  }, [to, from, onEdit, signal]);\n\n  useEffect(() => {\n    setIsError(from <= 0 || from > to);\n  }, [to, from]);\n\n  return (\n    <div css={editPathLengthsStyles}>\n      <p>Setting of the minimum and maximum path length (J coupling).</p>\n      <div className=\"input-container\">\n        <Label\n          title=\"Min:\"\n          style={{\n            label: {\n              marginRight: '5px',\n              fontSize: '14px',\n              fontWeight: 'normal',\n            },\n          }}\n        >\n          <Input\n            type=\"number\"\n            value={from}\n            onChange={(e) => {\n              setFrom(Number(e.target.value));\n            }}\n            style={{ input: { color: isError ? 'red' : 'black' } }}\n          />\n        </Label>\n        <Label\n          title=\"Max:\"\n          style={{\n            label: {\n              marginRight: '5px',\n              fontSize: '14px',\n              fontWeight: 'normal',\n            },\n          }}\n        >\n          <Input\n            type=\"number\"\n            value={to}\n            onChange={(e) => {\n              setTo(Number(e.target.value));\n            }}\n          />\n        </Label>\n      </div>\n      {isError ? (\n        <p className=\"warning\">\n          Minimum must not be 0 or higher than the maximum value.{' '}\n        </p>\n      ) : (\n        <Button type=\"button\" onClick={handleOnEdit} disabled={isError}>\n          Set\n        </Button>\n      )}\n    </div>\n  );\n}\n\nexport default EditPathLength;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { getCorrelationDelta, Correlation, Link } from 'nmr-correlation';\nimport { useCallback, useState } from 'react';\n\nimport Select from '../../../../elements/Select';\n\nconst moveLinkStyles = css`\n  width: 100%;\n  height: 100%;\n  margin-top: 10px;\n  text-align: center;\n\n  p {\n    font-size: 14px;\n  }\n\n  .selection-container {\n    margin-top: 10px;\n    width: 100%;\n    text-align: center;\n  }\n\n  button {\n    flex: 2;\n    padding: 5px;\n    border: 1px solid gray;\n    border-radius: 5px;\n    height: 30px;\n    margin: 0 auto;\n    margin-top: 15px;\n    display: block;\n    width: 60px;\n\n    color: white;\n    background-color: gray;\n  }\n`;\n\ninterface MoveLinkProps {\n  correlationDim1: Correlation;\n  correlationDim2: Correlation;\n  link: Link;\n  correlations: Correlation[];\n  onEdit: (\n    correlationIdDim1: string,\n    correlationIdDim2: string | undefined,\n  ) => void;\n}\n\nfunction MoveLink({\n  correlationDim1,\n  correlationDim2,\n  link,\n  correlations,\n  onEdit,\n}: MoveLinkProps) {\n  const [selectedCorrelationIdDim1, setSelectedCorrelationIdDim1] =\n    useState<string>(correlationDim1.id);\n  const [selectedCorrelationIdDim2, setSelectedCorrelationIdDim2] =\n    useState<string>(correlationDim2?.id || undefined);\n\n  function getCorrelationLabel(correlation: Correlation) {\n    const delta = getCorrelationDelta(correlation);\n    return `${delta ? delta.toFixed(2) : '?'}`;\n  }\n\n  const getSelection = useCallback(\n    (correlation: Correlation, dim: 0 | 1) => {\n      const selectionData = correlations.reduce((arr, _correlation) => {\n        if (\n          _correlation.pseudo === false &&\n          _correlation.atomType === link.atomType[dim]\n        ) {\n          arr.push({\n            key: _correlation.id,\n            value: _correlation.id,\n            label: `${_correlation.label.origin}: ${getCorrelationLabel(\n              _correlation,\n            )}`,\n          });\n        }\n        return arr;\n      }, []);\n      selectionData.push({\n        key: 'new',\n        value: 'new',\n        label: `new -> ${(\n          (dim === 0\n            ? getCorrelationDelta(correlationDim1)\n            : getCorrelationDelta(correlationDim2)) as number\n        ).toFixed(2)}`,\n      });\n\n      return (\n        <Select\n          onChange={(selection: string) => {\n            if (dim === 0) {\n              setSelectedCorrelationIdDim1(selection);\n            } else {\n              setSelectedCorrelationIdDim2(selection);\n            }\n          }}\n          data={selectionData}\n          defaultValue={correlation.id}\n          style={{\n            width: 110,\n            height: 25,\n            margin: 0,\n            border: '1px solid grey',\n          }}\n        />\n      );\n    },\n    [correlationDim1, correlationDim2, correlations, link.atomType],\n  );\n\n  return (\n    <div css={moveLinkStyles}>\n      <p>Move of signals on either one or both axes.</p>\n      <p>&quot;New&quot; means to separate into a new row or column.</p>\n      <div className=\"selection-container\">\n        {getSelection(correlationDim1, 0)}\n        {correlationDim2 && getSelection(correlationDim2, 1)}\n      </div>\n      <button\n        type=\"button\"\n        onClick={() =>\n          onEdit(selectedCorrelationIdDim1, selectedCorrelationIdDim2)\n        }\n      >\n        Move\n      </button>\n    </div>\n  );\n}\n\nexport default MoveLink;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { getLinkDim, Link } from 'nmr-correlation';\nimport { useCallback, useMemo, useState } from 'react';\n\nimport CloseButton from '../../../../elements/CloseButton';\nimport Tab from '../../../../elements/Tab/Tab';\nimport Tabs, { PositionsEnum } from '../../../../elements/Tab/Tabs';\nimport { getEditedCorrelations } from '../../utilities/Utilities';\n\nimport EditLinkConfirmation from './Confirmation';\nimport EditPathLength from './EditPathLength';\nimport MoveLink from './MoveLink';\n\nconst modalContainer = css`\n  width: 490px;\n  height: 220px;\n  padding: 5px;\n\n  button:focus {\n    outline: none;\n  }\n\n  .header {\n    height: 24px;\n    border-bottom: 1px solid #f0f0f0;\n    display: flex;\n    align-items: center;\n\n    button {\n      height: 36px;\n      margin: 2px;\n      background-color: transparent;\n      border: none;\n      svg {\n        height: 16px;\n      }\n    }\n\n    p {\n      font-weight: bold;\n\n      margin-bottom: 5px;\n      margin-right: 30px;\n      padding: 0px 10px;\n      width: 100%;\n\n      text-align: center;\n    }\n  }\n\n  button {\n    flex: 2;\n    padding: 5px;\n    border: 1px solid gray;\n    border-radius: 5px;\n    height: 30px;\n    margin: 0 auto;\n    margin-top: 15px;\n    display: block;\n    width: 20%;\n\n    color: white;\n    background-color: gray;\n  }\n\n  .tabs-container {\n    width: 100%;\n    flex: 1;\n    overflow: auto;\n    border: none;\n  }\n`;\n\nexport default function EditLinkModal({\n  correlationDim1,\n  correlationDim2,\n  link,\n  correlations,\n  onClose,\n  onEdit,\n}) {\n  const [activeTab, setActiveTab] = useState<string>('move');\n\n  const getLinkLabel = useCallback(() => {\n    const linkDim = getLinkDim(link);\n    if (linkDim === 1) {\n      return ` 1D (${link.signal.delta.toFixed(3)})`;\n    } else if (linkDim === 2) {\n      return `${link.signal.x ? `${link.signal.x.delta.toFixed(2)}` : '?'} (${\n        correlationDim1.label.origin\n      }), ${link.signal.y ? link.signal.y.delta.toFixed(2) : '?'} (${\n        correlationDim2.label.origin\n      })`;\n    }\n\n    return '';\n  }, [correlationDim1.label.origin, link, correlationDim2]);\n\n  const handleOnEdit = useCallback(\n    (\n      action: 'move' | 'remove' | 'unmove' | 'setPathLength',\n      selectedCorrelationIdDim1: string | undefined,\n      selectedCorrelationIdDim2: string | undefined,\n      editedLink?: Link,\n    ) => {\n      const { editedCorrelations, buildCorrelationDataOptions } =\n        getEditedCorrelations({\n          correlationDim1,\n          correlationDim2,\n          selectedCorrelationIdDim1,\n          selectedCorrelationIdDim2,\n          action,\n          link: editedLink || link,\n          correlations,\n        });\n      onEdit(\n        editedCorrelations,\n        action,\n        editedLink || link,\n        buildCorrelationDataOptions,\n      );\n\n      onClose?.();\n    },\n    [correlationDim1, correlationDim2, correlations, link, onClose, onEdit],\n  );\n\n  const tabsContainer = useMemo(\n    () => (\n      <div className=\"tabs-container\">\n        <Tabs\n          position={PositionsEnum.TOP}\n          activeTab={activeTab}\n          onClick={(tab) => setActiveTab(tab.tabid)}\n        >\n          <Tab tablabel=\"Move\" tabid={'move'}>\n            <MoveLink\n              correlationDim1={correlationDim1}\n              correlationDim2={correlationDim2}\n              link={link}\n              correlations={correlations}\n              onEdit={(correlationIdDim1, correlationIdDim2) =>\n                handleOnEdit('move', correlationIdDim1, correlationIdDim2)\n              }\n            />\n          </Tab>\n          <Tab tablabel=\"Unmove\" tabid=\"unmove\">\n            <EditLinkConfirmation\n              description=\"Movement of signal to its original place.\"\n              onConfirm={() =>\n                handleOnEdit('unmove', correlationDim1.id, correlationDim2.id)\n              }\n            />\n          </Tab>\n          <Tab tablabel=\"Remove\" tabid={'remove'}>\n            <EditLinkConfirmation\n              description=\"Deletion of signal.\"\n              onConfirm={() => handleOnEdit('remove', undefined, undefined)}\n            />\n          </Tab>\n          <Tab tablabel=\"J Coupling\" tabid={'setPathLength'}>\n            <EditPathLength\n              signal={link.signal}\n              experimentType={link.experimentType}\n              onEdit={(editedSignal) => {\n                const editedLink = { ...link, signal: editedSignal };\n                handleOnEdit(\n                  'setPathLength',\n                  correlationDim1,\n                  correlationDim2,\n                  editedLink,\n                );\n              }}\n            />\n          </Tab>\n        </Tabs>\n      </div>\n    ),\n    [\n      activeTab,\n      correlationDim1,\n      correlationDim2,\n      correlations,\n      handleOnEdit,\n      link,\n    ],\n  );\n\n  return (\n    <div css={modalContainer}>\n      <div className=\"header handle\">\n        <CloseButton onClick={onClose} />\n        <p className=\"header-info\">{`${link.experimentType.toUpperCase()} signal at ${getLinkLabel()}`}</p>\n      </div>\n      {tabsContainer}\n    </div>\n  );\n}\n","/** @jsxImportSource @emotion/react */\nimport { getCorrelationDelta, getLinkDim } from 'nmr-correlation';\nimport { useCallback, useMemo, useRef } from 'react';\n\nimport { buildID } from '../../../../data/utilities/Concatenation';\nimport { findRangeOrZoneID } from '../../../../data/utilities/FindUtilities';\nimport ContextMenu from '../../../elements/ContextMenu';\nimport { positions, useModal } from '../../../elements/popup/Modal';\nimport { useHighlight } from '../../../highlight';\nimport IsInView from '../utilities/IsInView';\nimport { getLabelColor } from '../utilities/Utilities';\n\nimport EditLinkModal from './editLink/EditLinkModal';\n\nfunction AdditionalColumnHeader({\n  spectraData,\n  correlationsData,\n  correlation,\n  onEdit,\n}) {\n  const contextRef = useRef<any>();\n  const modal = useModal();\n\n  const highlightIDsAdditionalColumn = useMemo(() => {\n    if (correlation.pseudo === true) {\n      return [];\n    }\n    const ids: string[] = [];\n    correlation.link.forEach((link) => {\n      if (link.pseudo === false) {\n        ids.push(link.signal.id);\n        ids.push(buildID(link.signal.id, 'Crosshair_X'));\n        const _id = findRangeOrZoneID(\n          spectraData,\n          link.experimentID,\n          link.signal.id,\n          true,\n        );\n        if (_id) {\n          ids.push(_id);\n        }\n      }\n    });\n\n    return ids;\n  }, [correlation, spectraData]);\n  const highlightAdditionalColumn = useHighlight(highlightIDsAdditionalColumn);\n\n  const mouseEnterHandler = useCallback(\n    (event) => {\n      event.currentTarget.focus();\n      highlightAdditionalColumn.show();\n    },\n    [highlightAdditionalColumn],\n  );\n  const mouseLeaveHandler = useCallback(\n    (event) => {\n      event.currentTarget.blur();\n      highlightAdditionalColumn.hide();\n    },\n    [highlightAdditionalColumn],\n  );\n\n  const isInView = IsInView({ correlation });\n\n  const tableHeaderProps = useMemo(() => {\n    return {\n      style: {\n        ...{ color: getLabelColor(correlationsData, correlation) || undefined },\n        backgroundColor: highlightAdditionalColumn.isActive\n          ? '#ff6f0057'\n          : isInView\n          ? '#f5f5dc'\n          : 'inherit',\n      },\n      title:\n        correlation.pseudo === false &&\n        correlation.link\n          .reduce((arr, link) => {\n            if (\n              link.pseudo === false &&\n              !arr.includes(link.experimentType.toUpperCase())\n            ) {\n              arr.push(link.experimentType.toUpperCase());\n            }\n            return arr;\n          }, [])\n          .sort()\n          .join('/'),\n      onMouseEnter: mouseEnterHandler,\n      onMouseLeave: mouseLeaveHandler,\n    };\n  }, [\n    correlation,\n    correlationsData,\n    highlightAdditionalColumn.isActive,\n    isInView,\n    mouseEnterHandler,\n    mouseLeaveHandler,\n  ]);\n\n  const equivalenceTextStyle = useMemo(() => {\n    return correlation.edited.equivalence\n      ? { backgroundColor: '#F7F2E0' }\n      : {\n          color: Number.isInteger(correlation.equivalence)\n            ? correlation.equivalence === 1\n              ? '#bebebe'\n              : 'black'\n            : 'red',\n        };\n  }, [correlation]);\n\n  const contextMenu = useMemo(() => {\n    return correlation.pseudo === false\n      ? correlation.link\n          .filter((link) => getLinkDim(link) === 1 && link.pseudo === false)\n          .map((link) => {\n            return {\n              label: `edit 1D (${link.signal.delta.toFixed(3)}${\n                link.edited?.moved === true ? '[MOVED]' : ''\n              })`,\n              onClick: () => {\n                highlightAdditionalColumn.hide();\n                modal.show(\n                  <EditLinkModal\n                    onClose={() => modal.close()}\n                    onEdit={onEdit}\n                    link={link}\n                    correlationDim1={correlation}\n                    correlationDim2={undefined}\n                    correlations={correlationsData.values}\n                  />,\n                  { position: positions.MIDDLE_RIGHT, isBackgroundBlur: false },\n                );\n              },\n            };\n          })\n          .concat([\n            {\n              label: `delete all (${correlation.label.origin})`,\n              onClick: () => {\n                modal.showConfirmDialog({\n                  message: `All signals of ${correlation.label.origin} (${(\n                    getCorrelationDelta(correlation) as number\n                  ).toFixed(2)}) will be deleted. Are you sure?`,\n                  buttons: [\n                    {\n                      text: 'Yes',\n                      handler: () => {\n                        onEdit([correlation], 'removeAll');\n                      },\n                    },\n                    { text: 'No' },\n                  ],\n                });\n                highlightAdditionalColumn.hide();\n              },\n            },\n          ])\n      : [];\n  }, [\n    correlation,\n    correlationsData.values,\n    highlightAdditionalColumn,\n    modal,\n    onEdit,\n  ]);\n\n  const contextMenuHandler = useCallback(\n    (e) => {\n      e.preventDefault();\n      contextRef.current.handleContextMenu(e);\n    },\n    [contextRef],\n  );\n\n  const { title, ...thProps } = tableHeaderProps;\n\n  return (\n    <th {...thProps} title={title === false ? undefined : title}>\n      <div\n        style={{ display: 'block' }}\n        onContextMenu={(e) => {\n          if (contextMenu.length > 0) {\n            contextMenuHandler(e);\n          }\n        }}\n      >\n        <p>{correlation.label.origin}</p>\n        <p>\n          {getCorrelationDelta(correlation)\n            ? getCorrelationDelta(correlation)?.toFixed(2)\n            : ''}\n        </p>\n        <p style={equivalenceTextStyle}>\n          {Number.isInteger(correlation.equivalence)\n            ? correlation.equivalence\n            : correlation.equivalence.toFixed(2)}\n        </p>\n        <ContextMenu ref={contextRef} context={contextMenu} />\n      </div>\n    </th>\n  );\n}\n\nexport default AdditionalColumnHeader;\n","import { buildLink, Correlation, Link } from 'nmr-correlation';\nimport { useCallback, useMemo, useRef } from 'react';\n\nimport { buildID } from '../../../../data/utilities/Concatenation';\nimport { findRangeOrZoneID } from '../../../../data/utilities/FindUtilities';\nimport generateID from '../../../../data/utilities/generateID';\nimport ContextMenu from '../../../elements/ContextMenu';\nimport { positions, useModal } from '../../../elements/popup/Modal';\nimport { useHighlight } from '../../../highlight';\nimport IsInView from '../utilities/IsInView';\nimport {\n  cloneCorrelationAndEditLink,\n  getAbbreviation,\n} from '../utilities/Utilities';\n\nimport EditLinkModal from './editLink/EditLinkModal';\n\nfunction AdditionalColumnField({\n  rowCorrelation,\n  columnCorrelation,\n  commonLinks,\n  correlations,\n  spectraData,\n  onEdit,\n}) {\n  const contextRef = useRef<any>();\n  const modal = useModal();\n\n  const highlightIDsCommonLinks = useMemo(() => {\n    const ids: Array<any> = [];\n    commonLinks.forEach((link: Link) => {\n      if (link.pseudo === false) {\n        ids.push(link.signal.id);\n        ids.push(buildID(link.signal.id, 'Crosshair'));\n        const _id = findRangeOrZoneID(\n          spectraData,\n          link.experimentID,\n          link.signal.id,\n          true,\n        );\n        if (_id) {\n          ids.push(_id);\n        }\n      }\n    });\n\n    return ids;\n  }, [commonLinks, spectraData]);\n  const highlightCommonLinks = useHighlight(highlightIDsCommonLinks);\n\n  const mouseEnterHandler = useCallback(\n    (event) => {\n      event.currentTarget.focus();\n      highlightCommonLinks.show();\n    },\n    [highlightCommonLinks],\n  );\n  const mouseLeaveHandler = useCallback(\n    (event) => {\n      event.currentTarget.blur();\n      highlightCommonLinks.hide();\n    },\n    [highlightCommonLinks],\n  );\n\n  const contextMenuHandler = useCallback(\n    (e) => {\n      e.preventDefault();\n      contextRef.current.handleContextMenu(e);\n    },\n    [contextRef],\n  );\n\n  const handleEditPseudoHSQC = useCallback(\n    (action: 'add' | 'remove', link?: Link) => {\n      const pseudoLinkCountHSQC = rowCorrelation.link.filter(\n        (_link) =>\n          (_link.experimentType === 'hsqc' ||\n            _link.experimentType === 'hmqc') &&\n          _link.pseudo === true,\n      ).length;\n\n      let _correlationDim1: Correlation;\n      let _correlationDim2: Correlation;\n      if (action === 'add') {\n        const commonPseudoLink = buildLink({\n          experimentType: 'hsqc',\n          experimentID: generateID(),\n          atomType: [columnCorrelation.atomType, rowCorrelation.atomType],\n          id: generateID(),\n          pseudo: true,\n          signal: { id: generateID(), sign: 0 }, // pseudo signal\n        });\n        _correlationDim1 = cloneCorrelationAndEditLink(\n          columnCorrelation,\n          commonPseudoLink,\n          'x',\n          'add',\n        );\n        _correlationDim2 = cloneCorrelationAndEditLink(\n          rowCorrelation,\n          commonPseudoLink,\n          'y',\n          'add',\n        );\n        // increase number of attached protons if no value was specified manually before\n        if (!_correlationDim2.edited.protonsCount) {\n          _correlationDim2.protonsCount = [pseudoLinkCountHSQC + 1];\n        }\n      } else {\n        _correlationDim1 = cloneCorrelationAndEditLink(\n          columnCorrelation,\n          link,\n          'x',\n          'remove',\n        );\n        _correlationDim2 = cloneCorrelationAndEditLink(\n          rowCorrelation,\n          link,\n          'y',\n          'remove',\n        );\n        // decrease number of attached protons if no value was specified manually before\n        if (!_correlationDim2.edited.protonsCount) {\n          _correlationDim2.protonsCount =\n            pseudoLinkCountHSQC - 1 > 0 ? [pseudoLinkCountHSQC - 1] : [];\n        }\n      }\n\n      onEdit([_correlationDim1, _correlationDim2], action, link, {\n        skipDataUpdate: true,\n      });\n    },\n    [columnCorrelation, onEdit, rowCorrelation],\n  );\n\n  const contextMenu = useMemo(() => {\n    // allow the edition of correlations\n    const commonLinksMenu = commonLinks\n      .map((commonLink) => {\n        const commonLinkContextMenuLabel = `${getAbbreviation(commonLink)} (${\n          commonLink.signal.x ? commonLink.signal.x.delta.toFixed(2) : '?'\n        }, ${\n          commonLink.signal.y ? commonLink.signal.y.delta.toFixed(2) : '?'\n        })${commonLink.edited?.moved === true ? '[MOVED]' : ''}`;\n\n        return commonLink.pseudo === false\n          ? [\n              {\n                label: `edit ${commonLinkContextMenuLabel}`,\n                onClick: () => {\n                  highlightCommonLinks.hide();\n                  modal.show(\n                    <EditLinkModal\n                      onClose={() => modal.close()}\n                      onEdit={onEdit}\n                      link={commonLink}\n                      correlationDim1={columnCorrelation}\n                      correlationDim2={rowCorrelation}\n                      correlations={correlations}\n                    />,\n                    {\n                      position: positions.MIDDLE_RIGHT,\n                      isBackgroundBlur: false,\n                    },\n                  );\n                },\n              },\n            ]\n          : [];\n      })\n      .flat();\n    // allow addition or removal of a pseudo HSQC link between pseudo heavy atom and proton\n    const commonPseudoLinkHSQC = commonLinks.find(\n      (commonLink) =>\n        commonLink.pseudo === true && commonLink.experimentType === 'hsqc',\n    );\n    if (rowCorrelation.pseudo === true) {\n      if (commonPseudoLinkHSQC) {\n        commonLinksMenu.push({\n          label: 'remove pseudo HSQC',\n          onClick: () => handleEditPseudoHSQC('remove', commonPseudoLinkHSQC),\n        });\n      } else {\n        commonLinksMenu.push({\n          label: 'add pseudo HSQC',\n          onClick: () => handleEditPseudoHSQC('add'),\n        });\n      }\n    }\n\n    return commonLinksMenu;\n  }, [\n    columnCorrelation,\n    commonLinks,\n    correlations,\n    handleEditPseudoHSQC,\n    highlightCommonLinks,\n    modal,\n    onEdit,\n    rowCorrelation,\n  ]);\n\n  const contentLabel = useMemo(\n    () =>\n      commonLinks.map((commonLink, i) => (\n        <label key={commonLink.id}>\n          <label\n            style={{\n              color:\n                commonLink.pseudo === true || commonLink.edited?.moved === true\n                  ? 'blue'\n                  : 'black',\n            }}\n          >\n            {getAbbreviation(commonLink)}\n          </label>\n          {i < commonLinks.length - 1 && <label>/</label>}\n        </label>\n      )),\n    [commonLinks],\n  );\n\n  const title = useMemo(\n    () =>\n      commonLinks\n        .reduce((arr, link) => {\n          if (!arr.includes(link.experimentType.toUpperCase())) {\n            arr.push(link.experimentType.toUpperCase());\n          }\n          return arr;\n        }, [])\n        .join('/'),\n    [commonLinks],\n  );\n\n  const isInViewRow = IsInView({ correlation: rowCorrelation });\n  const isInViewColumn = IsInView({ correlation: columnCorrelation });\n\n  return (\n    <td\n      onContextMenu={(e) => {\n        if (contextMenu.length > 0) {\n          contextMenuHandler(e);\n        }\n      }}\n      style={{\n        backgroundColor: highlightCommonLinks.isActive\n          ? '#ff6f0057'\n          : isInViewColumn || isInViewRow\n          ? '#f5f5dc'\n          : 'inherit',\n      }}\n      title={title}\n      onMouseEnter={mouseEnterHandler}\n      onMouseLeave={mouseLeaveHandler}\n    >\n      {contentLabel}\n      <ContextMenu ref={contextRef} context={contextMenu} />\n    </td>\n  );\n}\n\nexport default AdditionalColumnField;\n","import {\n  buildLink,\n  getCorrelationDelta,\n  getLabel,\n  getLinkDim,\n  Link,\n} from 'nmr-correlation';\nimport { useCallback, useMemo, useRef } from 'react';\n\nimport { buildID } from '../../../../data/utilities/Concatenation';\nimport { findRangeOrZoneID } from '../../../../data/utilities/FindUtilities';\nimport ContextMenu from '../../../elements/ContextMenu';\nimport EditableColumn from '../../../elements/EditableColumn';\nimport { positions, useModal } from '../../../elements/popup/Modal';\nimport { useHighlight } from '../../../highlight';\nimport IsInView from '../utilities/IsInView';\nimport { convertValuesString } from '../utilities/Utilities';\n\nimport AdditionalColumnField from './AdditionalColumnField';\nimport EditLinkModal from './editLink/EditLinkModal';\n\nfunction CorrelationTableRow({\n  additionalColumnData,\n  correlations,\n  correlation,\n  styleRow,\n  styleLabel,\n  onSaveEditEquivalences,\n  onSaveEditNumericValues,\n  onEditCorrelationTableCellHandler,\n  spectraData,\n}) {\n  const contextRef = useRef<any>();\n  const modal = useModal();\n\n  const highlightIDsRow = useMemo(() => {\n    if (correlation.pseudo === true) {\n      return [];\n    }\n    const ids: string[] = [];\n\n    correlation.link.forEach((link) => {\n      if (link.pseudo === false) {\n        ids.push(link.signal.id);\n        ids.push(buildID(link.signal.id, 'Crosshair_Y'));\n        const _id = findRangeOrZoneID(\n          spectraData,\n          link.experimentID,\n          link.signal.id,\n          true,\n        );\n        if (_id) {\n          ids.push(_id);\n        }\n      }\n    });\n\n    return ids;\n  }, [correlation, spectraData]);\n  const highlightRow = useHighlight(highlightIDsRow);\n\n  const onSaveEquivalencesHandler = useCallback(\n    (e) => {\n      onSaveEditEquivalences(correlation, e.target.value);\n    },\n    [correlation, onSaveEditEquivalences],\n  );\n\n  const onSaveEditNumericValuesHandler = useCallback(\n    (e, key: 'protonsCount' | 'hybridization') => {\n      onSaveEditNumericValues({\n        correlation,\n        values: convertValuesString(e.target.value, key),\n        key,\n      });\n    },\n    [correlation, onSaveEditNumericValues],\n  );\n\n  const additionalColumnFields = useMemo(() => {\n    return additionalColumnData.map((_correlation) => {\n      const commonLinks: Link[] = [];\n      correlation.link.forEach((link) => {\n        _correlation.link.forEach((_link) => {\n          if (\n            link.axis !== _link.axis &&\n            link.experimentID === _link.experimentID &&\n            link.signal.id === _link.signal.id &&\n            !commonLinks.some(\n              (_commonLink) => _commonLink.signal.id === link.signal.id,\n            )\n          ) {\n            let experimentLabel = link.experimentType;\n            if (link.signal && link.signal.sign !== 0) {\n              experimentLabel += link.signal.sign === 1 ? ' (+)' : ' (-)';\n            }\n            commonLinks.push(\n              buildLink({\n                ...link,\n                experimentLabel,\n                axis: undefined,\n                id: `${_link.id}_${link.id}`,\n              }),\n            );\n          }\n        });\n      });\n\n      return (\n        <AdditionalColumnField\n          key={`addColData_${correlation.id}_${_correlation.id}`}\n          rowCorrelation={correlation}\n          columnCorrelation={_correlation}\n          commonLinks={commonLinks}\n          correlations={correlations}\n          spectraData={spectraData}\n          onEdit={onEditCorrelationTableCellHandler}\n        />\n      );\n    });\n  }, [\n    additionalColumnData,\n    correlation,\n    correlations,\n    onEditCorrelationTableCellHandler,\n    spectraData,\n  ]);\n\n  const equivalenceCellStyle = useMemo(() => {\n    return correlation.edited.equivalence\n      ? { color: 'blue' }\n      : {\n          color: correlation.equivalence === 1 ? '#bebebe' : 'black',\n        };\n  }, [correlation]);\n\n  const mouseEnterHandler = useCallback(\n    (event) => {\n      event.currentTarget.focus();\n      highlightRow.show();\n    },\n    [highlightRow],\n  );\n  const mouseLeaveHandler = useCallback(\n    (event) => {\n      event.currentTarget.blur();\n      highlightRow.hide();\n    },\n    [highlightRow],\n  );\n\n  const isInView = IsInView({ correlation });\n\n  const tableDataProps = useMemo(() => {\n    return {\n      style: {\n        ...styleRow,\n        backgroundColor: highlightRow.isActive\n          ? '#ff6f0057'\n          : isInView\n          ? '#f5f5dc'\n          : 'inherit',\n      },\n      title:\n        correlation.pseudo === false &&\n        correlation.link\n          .reduce((arr, link) => {\n            if (\n              link.pseudo === false &&\n              !arr.includes(link.experimentType.toUpperCase())\n            ) {\n              arr.push(link.experimentType.toUpperCase());\n            }\n            return arr;\n          }, [])\n          .sort()\n          .join('/'),\n      onMouseEnter: mouseEnterHandler,\n      onMouseLeave: mouseLeaveHandler,\n    };\n  }, [\n    correlation.link,\n    correlation.pseudo,\n    highlightRow.isActive,\n    isInView,\n    mouseEnterHandler,\n    mouseLeaveHandler,\n    styleRow,\n  ]);\n\n  const contextMenu = useMemo(() => {\n    return correlation.pseudo === false\n      ? correlation.link\n          .filter((link) => getLinkDim(link) === 1 && link.pseudo === false)\n          .map((link) => {\n            return {\n              label: `edit 1D (${link.signal.delta.toFixed(3)})${\n                link.edited?.moved === true ? '[MOVED]' : ''\n              }`,\n              onClick: () => {\n                highlightRow.hide();\n                modal.show(\n                  <EditLinkModal\n                    onClose={() => modal.close()}\n                    onEdit={onEditCorrelationTableCellHandler}\n                    link={link}\n                    correlationDim1={correlation}\n                    correlationDim2={undefined}\n                    correlations={correlations}\n                  />,\n                  {\n                    position: positions.MIDDLE_RIGHT,\n                    isBackgroundBlur: false,\n                  },\n                );\n              },\n            };\n          })\n          .concat([\n            {\n              label: `delete ${correlation.label.origin}`,\n              onClick: () => {\n                modal.showConfirmDialog({\n                  message: `All signals of ${correlation.label.origin} (${(\n                    getCorrelationDelta(correlation) as number\n                  ).toFixed(2)}) will be deleted. Are you sure?`,\n                  buttons: [\n                    {\n                      text: 'Yes',\n                      handler: () => {\n                        onEditCorrelationTableCellHandler(\n                          [correlation],\n                          'removeAll',\n                        );\n                      },\n                    },\n                    { text: 'No' },\n                  ],\n                });\n                highlightRow.hide();\n              },\n            },\n          ])\n      : [];\n  }, [\n    correlation,\n    highlightRow,\n    modal,\n    onEditCorrelationTableCellHandler,\n    correlations,\n  ]);\n\n  const contextMenuHandler = useCallback(\n    (e) => {\n      e.preventDefault();\n      contextRef.current.handleContextMenu(e);\n    },\n    [contextRef],\n  );\n\n  const { title, ...otherTableDataProps } = tableDataProps;\n  const t = !title ? '' : title;\n\n  return (\n    <tr style={styleRow}>\n      <td\n        title={t}\n        {...{\n          ...otherTableDataProps,\n          style: { ...tableDataProps.style, styleLabel },\n        }}\n        onContextMenu={(e) => {\n          if (contextMenu.length > 0) {\n            contextMenuHandler(e);\n          }\n        }}\n      >\n        {getLabel(correlations, correlation)}\n        <ContextMenu ref={contextRef} context={contextMenu} />\n      </td>\n      <td title={t} {...otherTableDataProps}>\n        {getCorrelationDelta(correlation)\n          ? getCorrelationDelta(correlation)?.toFixed(2)\n          : ''}\n      </td>\n      <td title={t} {...otherTableDataProps}>\n        {correlation.pseudo === false ? (\n          correlation.atomType !== 'H' ? (\n            <EditableColumn\n              type=\"number\"\n              value={correlation.equivalence}\n              style={equivalenceCellStyle}\n              onSave={onSaveEquivalencesHandler}\n            />\n          ) : (\n            <text style={equivalenceCellStyle}>{correlation.equivalence}</text>\n          )\n        ) : (\n          ''\n        )}\n      </td>\n      <td title={t} {...otherTableDataProps}>\n        {correlation.atomType !== 'H' ? (\n          <EditableColumn\n            type=\"text\"\n            value={correlation.protonsCount.join(',')}\n            style={correlation.edited.protonsCount ? { color: 'blue' } : {}}\n            onSave={(e) => onSaveEditNumericValuesHandler(e, 'protonsCount')}\n          />\n        ) : (\n          ''\n        )}\n      </td>\n      <td\n        title={t}\n        {...{\n          ...otherTableDataProps,\n          style: { ...tableDataProps.style, borderRight: '1px solid' },\n        }}\n      >\n        {correlation.atomType !== 'H' ? (\n          <EditableColumn\n            type=\"text\"\n            value={correlation.hybridization\n              .map((hybrid) => `sp${hybrid}`)\n              .join(',')}\n            style={correlation.edited.hybridization ? { color: 'blue' } : {}}\n            onSave={(e) => onSaveEditNumericValuesHandler(e, 'hybridization')}\n          />\n        ) : (\n          ''\n        )}\n      </td>\n      {additionalColumnFields}\n    </tr>\n  );\n}\n\nexport default CorrelationTableRow;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { Correlation } from 'nmr-correlation';\nimport { useMemo } from 'react';\n\nimport { getLabelColor } from '../utilities/Utilities';\n\nimport AdditionalColumnHeader from './AdditionalColumnHeader';\nimport CorrelationTableRow from './CorrelationTableRow';\n\nconst tableStyle = css`\n  overflow: auto;\n  height: 100%;\n  display: block;\n  table {\n    border-spacing: 0;\n    border: 1px solid #dedede;\n    width: 100%;\n    font-size: 12px;\n    height: 100%;\n  }\n  tr {\n    :last-child {\n      td {\n        border-bottom: 0;\n      }\n    }\n  }\n  thead tr {\n    background-color: white !important;\n  }\n  th {\n    position: sticky;\n    background-color: white;\n    top: 0;\n  }\n\n  th,\n  td {\n    white-space: nowrap;\n    text-align: center;\n    margin: 0;\n    padding: 0.4rem;\n    border-bottom: 1px solid #dedede;\n    border-right: 1px solid #dedede;\n\n    :last-child {\n      border-right: 0;\n    }\n    button {\n      background-color: transparent;\n      border: none;\n    }\n  }\n`;\n\nfunction CorrelationTable({\n  correlationsData,\n  filteredCorrelationsData,\n  additionalColumnData,\n  editEquivalencesSaveHandler,\n  onSaveEditNumericValues,\n  onEditCorrelationTableCellHandler,\n  showProtonsAsRows,\n  spectraData,\n}) {\n  const rows = useMemo(() => {\n    if (!filteredCorrelationsData) {\n      return [];\n    }\n\n    return filteredCorrelationsData.values\n      .filter((correlation: Correlation) =>\n        showProtonsAsRows\n          ? correlation.atomType === 'H'\n          : correlation.atomType !== 'H',\n      )\n      .map((correlation: Correlation) => (\n        <CorrelationTableRow\n          additionalColumnData={additionalColumnData}\n          correlations={correlationsData.values}\n          correlation={correlation}\n          key={`correlation${correlation.atomType}${correlation.id}`}\n          styleRow={{ backgroundColor: 'mintcream' }}\n          styleLabel={\n            correlation.atomType === 'H'\n              ? {\n                  color: getLabelColor(correlationsData, correlation),\n                }\n              : {}\n          }\n          onSaveEditEquivalences={editEquivalencesSaveHandler}\n          onSaveEditNumericValues={onSaveEditNumericValues}\n          onEditCorrelationTableCellHandler={onEditCorrelationTableCellHandler}\n          spectraData={spectraData}\n        />\n      ));\n  }, [\n    filteredCorrelationsData,\n    showProtonsAsRows,\n    additionalColumnData,\n    correlationsData,\n    editEquivalencesSaveHandler,\n    onSaveEditNumericValues,\n    onEditCorrelationTableCellHandler,\n    spectraData,\n  ]);\n\n  const additionalColumnHeader = useMemo(\n    () =>\n      additionalColumnData.map((correlation: Correlation) => (\n        <AdditionalColumnHeader\n          key={`additionalCorrelationHeader_${correlation.id}`}\n          spectraData={spectraData}\n          correlationsData={correlationsData}\n          correlation={correlation}\n          onEdit={onEditCorrelationTableCellHandler}\n        />\n      )),\n    [\n      additionalColumnData,\n      correlationsData,\n      onEditCorrelationTableCellHandler,\n      spectraData,\n    ],\n  );\n\n  return (\n    <div css={tableStyle}>\n      <table>\n        <thead>\n          <tr>\n            <th>Atom</th>\n            <th>δ (ppm)</th>\n            <th>Equiv</th>\n            <th>#H</th>\n            <th style={{ borderRight: '1px solid' }}>Hybrid</th>\n            {additionalColumnHeader}\n          </tr>\n        </thead>\n        <tbody>{rows}</tbody>\n      </table>\n    </div>\n  );\n}\n\nexport default CorrelationTable;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { getAtomCounts } from 'nmr-correlation';\nimport { memo } from 'react';\n\nimport { ErrorColors, Errors } from './CorrelationTable/Constants';\n\nconst styles = css`\n  display: flex;\n  width: 100%;\n  font-size: 15px;\n  font-weight: 300;\n  white-space: nowrap;\n  span {\n    margin-left: 8px;\n  }\n`;\n\ninterface OverviewProps {\n  correlationsData?: {\n    options: {\n      mf: string;\n    };\n    state: any;\n  };\n}\n\nfunction Overview({ correlationsData }: OverviewProps) {\n  if (!correlationsData) {\n    return null;\n  }\n\n  const atoms = getAtomCounts(correlationsData.options.mf);\n\n  const elements =\n    Object.keys(atoms).length > 0 ? (\n      Object.keys(atoms).map((atomType, i) => {\n        const stateAtomType = correlationsData.state[atomType];\n        const error = stateAtomType ? stateAtomType.error : undefined;\n        const errorColorIndex = error\n          ? Errors.findIndex((_error) => error[_error] !== undefined)\n          : 'black';\n\n        return (\n          <span\n            // eslint-disable-next-line react/no-array-index-key\n            key={`molFormulaView_${i}`}\n            style={{\n              color: stateAtomType\n                ? stateAtomType.complete === true &&\n                  (!error || Object.keys(error).length === 0)\n                  ? 'green'\n                  : errorColorIndex >= 0\n                  ? ErrorColors[errorColorIndex].color\n                  : 'black'\n                : 'black',\n            }}\n          >\n            {`${atomType}: ${stateAtomType ? stateAtomType.current : '-'}/${\n              atoms[atomType]\n            }   `}\n          </span>\n        );\n      })\n    ) : (\n      <p style={{ fontStyle: 'italic', color: 'orange' }}>\n        Molecular formula is not set\n      </p>\n    );\n\n  return <div css={styles}>{elements}</div>;\n}\n\nexport default memo(Overview);\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback, useState } from 'react';\n\nimport getAtomsFromMF from '../../data/utilities/getAtomsFromMF';\n\nconst inputStyle = css`\n  text-align: center;\n\n  input {\n    height: 100%;\n    width: 200px;\n    border-radius: 5px;\n    border: 0.55px solid #c7c7c7;\n    margin: 0px 5px 0px 5px;\n    text-align: center;\n  }\n\n  button {\n    flex: 2;\n    padding: 5px;\n    border: 1px solid gray;\n    border-radius: 5px;\n    height: 36px;\n    margin: 0 auto;\n    margin-top: 15px;\n    display: block;\n    width: 20%;\n\n    color: white;\n    background-color: gray;\n  }\n`;\n\ninterface MolecularFormulaInputProps {\n  onSave?: (element: string) => void;\n  previousMF: string;\n}\n\nfunction MolecularFormulaInput({\n  onSave = () => null,\n  previousMF,\n}: MolecularFormulaInputProps) {\n  const [mf, setMF] = useState('');\n  const [isValidMF, setIsValidMF] = useState(true);\n  const [hasChanged, setHasChanged] = useState(false);\n\n  const checkMF = useCallback((mf: string) => {\n    if (mf.trim().length === 0) {\n      return false;\n    }\n    try {\n      getAtomsFromMF(mf);\n      return true;\n    } catch (error) {\n      return false;\n    }\n  }, []);\n\n  const onChangeHandler = useCallback(\n    (e) => {\n      setHasChanged(true);\n      if (checkMF(e.target.value)) {\n        setIsValidMF(true);\n        setMF(e.target.value);\n      } else {\n        setIsValidMF(false);\n        setMF('');\n      }\n    },\n    [checkMF],\n  );\n\n  const onSaveHandler = useCallback(() => {\n    onSave(hasChanged ? mf.trim() : previousMF);\n  }, [hasChanged, mf, onSave, previousMF]);\n\n  return (\n    <div css={inputStyle}>\n      <input type=\"text\" onChange={onChangeHandler} defaultValue={previousMF} />\n      <button type=\"button\" onClick={onSaveHandler} disabled={!isValidMF}>\n        {isValidMF ? 'Set' : 'Invalid'}\n      </button>\n    </div>\n  );\n}\n\nexport default MolecularFormulaInput;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback, useEffect, useState } from 'react';\n\nimport CloseButton from '../../elements/CloseButton';\nimport MolecularFormulaInput from '../../elements/MolecularFormulaInput';\nimport MoleculeSelection from '../../elements/MoleculeSelection';\n\nconst modalContainer = css`\n  overflow: auto;\n  width: 400px;\n  height: 550px;\n  padding: 5px;\n  button:focus {\n    outline: none;\n  }\n  .header {\n    height: 24px;\n    border-bottom: 1px solid #f0f0f0;\n    display: flex;\n    align-items: center;\n\n    button {\n      height: 36px;\n      margin: 2px;\n      background-color: transparent;\n      border: none;\n      svg {\n        height: 16px;\n      }\n    }\n  }\n\n  button {\n    flex: 2;\n    padding: 5px;\n    border: 1px solid gray;\n    border-radius: 5px;\n    height: 30px;\n    margin: 0 auto;\n    margin-top: 15px;\n    display: block;\n    width: 20%;\n\n    color: white;\n    background-color: gray;\n  }\n\n  .info {\n    margin-top: 0;\n    margin-bottom: 10px;\n    padding: 0px 10px;\n    width: 100%;\n\n    text-align: center;\n  }\n\n  .optional {\n    margin-top: 20px;\n    margin-bottom: 5px;\n    padding: 0px 10px;\n\n    text-align: center;\n    font-size: 18px;\n    font-weight: bold;\n  }\n  .optional2 {\n    margin-top: 5px;\n    margin-bottom: 25px;\n    padding: 0px 10px;\n    width: 100%;\n\n    text-align: center;\n  }\n`;\n\ninterface SetMolecularFormulaModalProps {\n  onClose: () => void;\n  onSave?: (element: any) => void;\n  molecules: any;\n  previousMF: any;\n}\n\nexport default function SetMolecularFormulaModal({\n  onClose,\n  onSave,\n  molecules,\n  previousMF,\n}: SetMolecularFormulaModalProps) {\n  const [currentIndex, setCurrentIndex] = useState<number>(0);\n\n  useEffect(() => {\n    if (molecules && molecules.length > 0) {\n      setCurrentIndex(0);\n    }\n  }, [molecules]);\n\n  const onSaveHandlerMolecularFormulaInput = useCallback(\n    (mf) => {\n      onSave?.(mf);\n      onClose?.();\n    },\n    [onClose, onSave],\n  );\n\n  const onSaveHandlerMoleculeSelection = useCallback(() => {\n    onSave?.(molecules[currentIndex].mf);\n    onClose?.();\n  }, [currentIndex, molecules, onClose, onSave]);\n\n  const onChangeHandlerMoleculeSelection = useCallback((index) => {\n    setCurrentIndex(index);\n  }, []);\n\n  return (\n    <div css={modalContainer}>\n      <div className=\"header handle\">\n        <CloseButton onClick={onClose} />\n      </div>\n      <div>\n        <p className=\"info\">Please type in a molecular formula!</p>\n      </div>\n      <MolecularFormulaInput\n        onSave={onSaveHandlerMolecularFormulaInput}\n        previousMF={previousMF}\n      />\n      <div>\n        <p className=\"optional\">OR</p>\n        <p className=\"optional2\">Select a molecule as reference!</p>\n      </div>\n      <MoleculeSelection\n        molecules={molecules}\n        onChange={onChangeHandlerMoleculeSelection}\n      />\n      <button type=\"button\" onClick={onSaveHandlerMoleculeSelection}>\n        Set\n      </button>\n    </div>\n  );\n}\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback, useEffect, useMemo, useState } from 'react';\n\nimport CloseButton from '../../elements/CloseButton';\n\nconst modalContainer = css`\n  width: 220px;\n  height: 270px;\n  padding: 5px;\n  text-align: center;\n\n  button:focus {\n    outline: none;\n  }\n\n  .header {\n    height: 24px;\n    border-bottom: 1px solid #f0f0f0;\n    display: flex;\n    align-items: center;\n\n    span {\n      color: #464646;\n      font-size: 15px;\n      flex: 1;\n      user-select: none;\n    }\n\n    button {\n      height: 36px;\n      margin: 2px;\n      background-color: transparent;\n      border: none;\n      svg {\n        height: 16px;\n      }\n    }\n  }\n\n  button {\n    flex: 2;\n    padding: 5px;\n    border: 1px solid gray;\n    border-radius: 5px;\n    height: 30px;\n    margin: 0 auto;\n    margin-top: 15px;\n    display: block;\n    width: 20%;\n\n    color: white;\n    background-color: gray;\n  }\n\n  table {\n    margin-top: 10px;\n    width: 100%;\n\n    input::-webkit-outer-spin-button,\n    input::-webkit-inner-spin-button {\n      -webkit-appearance: none;\n    }\n\n    input {\n      width: 100px;\n      text-align: center;\n      border-radius: 5px;\n      border: 0.55px solid #c7c7c7;\n    }\n  }\n`;\n\ninterface SetShiftToleranceModalProps {\n  onClose: () => void;\n  onSave?: (element: any) => void;\n  previousTolerance: any;\n}\n\nexport default function SetShiftToleranceModal({\n  onClose,\n  onSave,\n  previousTolerance,\n}: SetShiftToleranceModalProps) {\n  const [tolerance, setTolerance] = useState<any>();\n  const [isValid, setIsValid] = useState<{ [atomType: string]: boolean }>({});\n\n  useEffect(() => {\n    if (previousTolerance) {\n      setTolerance(previousTolerance);\n      const _isValid = {};\n      Object.keys(previousTolerance).forEach((atomType) => {\n        _isValid[atomType] = true;\n      });\n      setIsValid(_isValid);\n    } else {\n      setTolerance(undefined);\n    }\n  }, [previousTolerance]);\n\n  const onSaveHandler = useCallback(() => {\n    onSave?.(tolerance);\n    onClose?.();\n  }, [onClose, onSave, tolerance]);\n\n  const onChangeHandler = useCallback(\n    (e, atomType: string) => {\n      const value: string = e.target.value;\n      if (value.trim().length > 0) {\n        setTolerance({ ...tolerance, [atomType]: Number(value) });\n        setIsValid({ ...isValid, [atomType]: true });\n      } else {\n        setIsValid({ ...isValid, [atomType]: false });\n      }\n    },\n    [isValid, tolerance],\n  );\n\n  const rows = useMemo(() => {\n    return tolerance\n      ? Object.keys(tolerance).map((atomType) => {\n          return (\n            <tr key={`tolerance_${atomType}`}>\n              <td>{atomType}</td>\n              <td>\n                <input\n                  type=\"number\"\n                  onChange={(e) => onChangeHandler(e, atomType)}\n                  defaultValue={tolerance[atomType]}\n                  style={\n                    !isValid[atomType] ? { backgroundColor: 'orange' } : {}\n                  }\n                />\n              </td>\n            </tr>\n          );\n        })\n      : undefined;\n  }, [isValid, onChangeHandler, tolerance]);\n\n  return (\n    <div css={modalContainer}>\n      <div className=\"header handle\">\n        <span>Set Shift Tolerances</span>\n        <CloseButton onClick={onClose} />\n      </div>\n\n      <table>\n        <thead>\n          <tr>\n            <th>Atom</th>\n            <th>Value</th>\n          </tr>\n        </thead>\n        <tbody>{rows}</tbody>\n      </table>\n      <button\n        type=\"button\"\n        onClick={onSaveHandler}\n        disabled={Object.keys(isValid).some((atomType) => !isValid[atomType])}\n      >\n        Set\n      </button>\n    </div>\n  );\n}\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport {\n  getLinkDelta,\n  getLinkDim,\n  Correlation,\n  Values as CorrelationValues,\n  Options as CorrelationOptions,\n  Link,\n} from 'nmr-correlation';\nimport { memo, useCallback, useEffect, useMemo, useState } from 'react';\nimport { FaFlask, FaSlidersH } from 'react-icons/fa';\n\nimport { Datum1D } from '../../../data/types/data1d';\nimport { Datum2D } from '../../../data/types/data2d';\nimport {\n  findRange,\n  findSignal1D,\n  findSignal2D,\n  findSpectrum,\n  findZone,\n} from '../../../data/utilities/FindUtilities';\nimport { useAssignmentData } from '../../assignment/AssignmentsContext';\nimport { useChartData } from '../../context/ChartContext';\nimport { useDispatch } from '../../context/DispatchContext';\nimport Select from '../../elements/Select';\nimport ToolTip from '../../elements/ToolTip/ToolTip';\nimport { useModal } from '../../elements/popup/Modal';\nimport { DISPLAYER_MODE } from '../../reducer/core/Constants';\nimport {\n  DELETE_1D_SIGNAL,\n  DELETE_2D_SIGNAL,\n  DELETE_CORRELATION,\n  SET_2D_SIGNAL_PATH_LENGTH,\n  SET_CORRELATION,\n  SET_CORRELATIONS,\n  SET_CORRELATIONS_MF,\n  SET_CORRELATIONS_TOLERANCE,\n} from '../../reducer/types/Types';\nimport DefaultPanelHeader from '../header/DefaultPanelHeader';\n\nimport CorrelationTable from './CorrelationTable/CorrelationTable';\nimport Overview from './Overview';\nimport SetMolecularFormulaModal from './SetMolecularFormulaModal';\nimport SetShiftToleranceModal from './SetShiftTolerancesModal';\nimport {\n  findSignalMatch1D,\n  findSignalMatch2D,\n  getAtomType,\n} from './utilities/Utilities';\n\nconst panelStyle = css`\n  display: flex;\n  flex-direction: column;\n  text-align: center;\n  height: 100%;\n  width: 100%;\n\n  .extra-header-content {\n    display: flex;\n    width: 100%;\n\n    .overview-container {\n      width: 100%;\n      display: flex;\n      align-items: center;\n      margin-left: 10px;\n    }\n\n    .table-view-selection {\n      width: 100%;\n      display: flex;\n      align-items: center;\n      justify-content: flex-end;\n      margin-right: 2px;\n\n      white-space: nowrap;\n\n      label {\n        font-size: 13px;\n      }\n    }\n  }\n`;\n\nfunction SummaryPanel() {\n  const {\n    molecules,\n    correlations: correlationsData,\n    data: spectraData,\n    xDomain,\n    yDomain,\n    displayerMode,\n    activeTab,\n  } = useChartData();\n\n  const dispatch = useDispatch();\n  const modal = useModal();\n  const assignmentData = useAssignmentData();\n\n  const [additionalColumnData, setAdditionalColumnData] = useState([]);\n  const [\n    selectedAdditionalColumnsAtomType,\n    setSelectedAdditionalColumnsAtomType,\n  ] = useState<string>('H');\n  const [showProtonsAsRows, setShowProtonsAsRows] = useState(false);\n  const [filterIsActive, setFilterIsActive] = useState(false);\n\n  const filteredCorrelationsData = useMemo(() => {\n    const isInView = (correlation: Correlation): boolean => {\n      if (correlation.pseudo === true) {\n        return false;\n      }\n      const atomTypesInView = activeTab\n        .split(',')\n        .map((tab) => getAtomType(tab));\n\n      const factor = 10000;\n      const xDomain0 = xDomain[0] * factor;\n      const xDomain1 = xDomain[1] * factor;\n      const yDomain0 = yDomain[0] * factor;\n      const yDomain1 = yDomain[1] * factor;\n\n      if (displayerMode === DISPLAYER_MODE.DM_1D) {\n        const firstLink1D = correlation.link.find(\n          (link: Link) => getLinkDim(link) === 1,\n        );\n        if (!firstLink1D) {\n          return false;\n        }\n        let delta = getLinkDelta(firstLink1D);\n        if (delta === undefined) {\n          return false;\n        }\n        delta *= factor;\n        const spectrum = findSpectrum(\n          spectraData,\n          firstLink1D.experimentID,\n          true,\n        );\n        if (\n          spectrum &&\n          atomTypesInView[0] === correlation.atomType &&\n          delta >= xDomain0 &&\n          delta <= xDomain1\n        ) {\n          return true;\n        }\n        // try to find a link which contains the belonging 2D signal in the spectra in view\n        if (\n          correlation.link.some((link: Link) => {\n            const spectrum = findSpectrum(\n              spectraData,\n              link.experimentID,\n              true,\n            ) as Datum2D;\n            return findSignalMatch1D(\n              spectrum,\n              link,\n              factor,\n              xDomain0,\n              xDomain1,\n            );\n          })\n        ) {\n          return true;\n        }\n      } else if (displayerMode === DISPLAYER_MODE.DM_2D) {\n        if (!atomTypesInView.includes(correlation.atomType)) {\n          return false;\n        }\n        const firstLink2D = correlation.link.find(\n          (link: Link) => getLinkDim(link) === 2,\n        );\n        if (!firstLink2D) {\n          return false;\n        }\n        const spectrum = findSpectrum(\n          spectraData,\n          firstLink2D.experimentID,\n          true,\n        ) as Datum2D;\n        // correlation is represented by a 2D signal\n        if (\n          findSignalMatch2D(\n            spectrum,\n            firstLink2D,\n            factor,\n            xDomain0,\n            xDomain1,\n            yDomain0,\n            yDomain1,\n          )\n        ) {\n          return true;\n        } else {\n          // try to find a link which contains the belonging 2D signal in the spectra in view\n          if (\n            correlation.link.some((link) => {\n              const spectrum = findSpectrum(\n                spectraData,\n                link.experimentID,\n                true,\n              ) as Datum2D;\n              return findSignalMatch2D(\n                spectrum,\n                link,\n                factor,\n                xDomain0,\n                xDomain1,\n                yDomain0,\n                yDomain1,\n              );\n            })\n          ) {\n            return true;\n          }\n        }\n      }\n      // do not show correlation\n      return false;\n    };\n\n    if (correlationsData) {\n      const _values = filterIsActive\n        ? correlationsData.values.filter((correlation) => isInView(correlation))\n        : correlationsData.values;\n\n      return { ...correlationsData, values: _values };\n    }\n  }, [\n    activeTab,\n    correlationsData,\n    displayerMode,\n    filterIsActive,\n    spectraData,\n    xDomain,\n    yDomain,\n  ]);\n\n  const handleOnSetMolecularFormula = useCallback(\n    (mf) => {\n      dispatch({\n        type: SET_CORRELATIONS_MF,\n        payload: {\n          mf,\n        },\n      });\n    },\n    [dispatch],\n  );\n\n  const handleOnSetShiftTolerance = useCallback(\n    (tolerance) => {\n      dispatch({\n        type: SET_CORRELATIONS_TOLERANCE,\n        payload: {\n          tolerance,\n        },\n      });\n    },\n    [dispatch],\n  );\n\n  const showSetMolecularFormulaModal = useCallback(() => {\n    modal.show(\n      <SetMolecularFormulaModal\n        onClose={() => modal.close()}\n        onSave={handleOnSetMolecularFormula}\n        molecules={molecules}\n        previousMF={correlationsData.options.mf}\n      />,\n    );\n  }, [correlationsData, handleOnSetMolecularFormula, modal, molecules]);\n\n  const showSetShiftToleranceModal = useCallback(() => {\n    modal.show(\n      <SetShiftToleranceModal\n        onClose={() => modal.close()}\n        onSave={handleOnSetShiftTolerance}\n        previousTolerance={correlationsData.options.tolerance}\n      />,\n    );\n  }, [correlationsData, handleOnSetShiftTolerance, modal]);\n\n  const additionalColumnTypes = useMemo(() => {\n    const columnTypes = ['H', 'H-H'].concat(\n      correlationsData\n        ? correlationsData.values\n            .map((correlation) => correlation.atomType)\n            .filter(\n              (atomType, i, array) =>\n                atomType !== 'H' && array.indexOf(atomType) === i,\n            )\n        : [],\n    );\n\n    return columnTypes.map((columnType) => {\n      return {\n        key: columnType,\n        label: columnType,\n        value: columnType,\n      };\n    });\n  }, [correlationsData]);\n\n  useEffect(() => {\n    const _selectedAdditionalColumnsAtomType =\n      selectedAdditionalColumnsAtomType.split('-')[0];\n\n    setAdditionalColumnData(\n      filteredCorrelationsData\n        ? filteredCorrelationsData.values\n            .filter(\n              (correlation) =>\n                correlation.atomType === _selectedAdditionalColumnsAtomType,\n            )\n            .reverse()\n        : [],\n    );\n  }, [filteredCorrelationsData, selectedAdditionalColumnsAtomType]);\n\n  const editEquivalencesSaveHandler = useCallback(\n    (correlation: Correlation, value: number) => {\n      dispatch({\n        type: SET_CORRELATION,\n        payload: {\n          id: correlation.id,\n          correlation: {\n            ...correlation,\n            equivalence: value,\n            edited: { ...correlation.edited, equivalence: value !== 1 },\n          },\n        },\n      });\n    },\n    [dispatch],\n  );\n\n  const editNumericValuesSaveHandler = useCallback(\n    ({\n      correlation,\n      values,\n      key,\n    }: {\n      correlation: Correlation;\n      values: number[];\n      key: 'hybridization' | 'protonsCount';\n    }) => {\n      dispatch({\n        type: SET_CORRELATION,\n        payload: {\n          id: correlation.id,\n          correlation: {\n            ...correlation,\n            [key]: values,\n            edited: { ...correlation.edited, [key]: true },\n          },\n          options: {\n            skipDataUpdate: true,\n          },\n        },\n      });\n    },\n    [dispatch],\n  );\n\n  const setCorrelationsHandler = useCallback(\n    (correlations: CorrelationValues, options?: CorrelationOptions) => {\n      dispatch({\n        type: SET_CORRELATIONS,\n        payload: {\n          correlations,\n          options,\n        },\n      });\n    },\n    [dispatch],\n  );\n\n  const deleteCorrelationHandler = useCallback(\n    (correlation: Correlation) => {\n      dispatch({\n        type: DELETE_CORRELATION,\n        payload: {\n          correlation,\n          assignmentData,\n        },\n      });\n    },\n    [assignmentData, dispatch],\n  );\n\n  const deleteSignalHandler = useCallback(\n    (link: Link) => {\n      // remove linking signal in spectrum\n      const linkDim = getLinkDim(link);\n      if (linkDim === 1) {\n        const spectrum = findSpectrum(\n          spectraData,\n          link.experimentID,\n          false,\n        ) as Datum1D;\n        const range = findRange(spectrum, link.signal.id);\n        const signal = findSignal1D(spectrum, link.signal.id);\n\n        dispatch({\n          type: DELETE_1D_SIGNAL,\n          payload: {\n            spectrum,\n            range,\n            signal,\n            assignmentData,\n          },\n        });\n      } else if (linkDim === 2) {\n        const spectrum = findSpectrum(\n          spectraData,\n          link.experimentID,\n          false,\n        ) as Datum2D;\n        const zone = findZone(spectrum, link.signal.id);\n        const signal = findSignal2D(spectrum, link.signal.id);\n\n        dispatch({\n          type: DELETE_2D_SIGNAL,\n          payload: {\n            spectrum,\n            zone,\n            signal,\n            assignmentData,\n          },\n        });\n      }\n    },\n    [assignmentData, dispatch, spectraData],\n  );\n\n  const changeSignalPathLengthHandler = useCallback(\n    (link: Link) => {\n      const linkDim = getLinkDim(link);\n      if (linkDim === 2) {\n        const spectrum = findSpectrum(\n          spectraData,\n          link.experimentID,\n          false,\n        ) as Datum2D;\n        const zone = findZone(spectrum, link.signal.id);\n        const signal = findSignal2D(spectrum, link.signal.id);\n\n        dispatch({\n          type: SET_2D_SIGNAL_PATH_LENGTH,\n          payload: {\n            spectrum,\n            zone,\n            signal,\n            pathLength: link.signal.j?.pathLength,\n          },\n        });\n      }\n    },\n    [dispatch, spectraData],\n  );\n\n  const editCorrelationTableCellHandler = useCallback(\n    (\n      editedCorrelations: Correlation[],\n      action: string,\n      link?: Link,\n      options?: CorrelationOptions,\n    ) => {\n      if (\n        action === 'add' ||\n        action === 'move' ||\n        action === 'remove' ||\n        action === 'unmove' ||\n        action === 'setPathLength'\n      ) {\n        if (link && link.pseudo === false) {\n          if (action === 'remove') {\n            deleteSignalHandler(link);\n          } else if (action === 'setPathLength') {\n            changeSignalPathLengthHandler(link);\n          }\n        }\n        setCorrelationsHandler(editedCorrelations, options);\n      } else if (action === 'removeAll') {\n        deleteCorrelationHandler(editedCorrelations[0]);\n      }\n    },\n    [\n      changeSignalPathLengthHandler,\n      deleteCorrelationHandler,\n      deleteSignalHandler,\n      setCorrelationsHandler,\n    ],\n  );\n\n  const handleOnFilter = useCallback(() => {\n    setFilterIsActive(!filterIsActive);\n  }, [filterIsActive]);\n\n  return (\n    <div css={panelStyle}>\n      <DefaultPanelHeader\n        canDelete={false}\n        counter={correlationsData ? correlationsData.values.length : 0}\n        onFilter={handleOnFilter}\n        filterToolTip={\n          filterIsActive\n            ? 'Show all correlations'\n            : 'Hide correlations out of view'\n        }\n        filterIsActive={filterIsActive}\n        counterFiltered={filteredCorrelationsData?.values.length}\n      >\n        <ToolTip\n          title={`Set molecular formula (${correlationsData.options.mf})`}\n          popupPlacement=\"right\"\n        >\n          <button type=\"button\" onClick={showSetMolecularFormulaModal}>\n            <FaFlask />\n          </button>\n        </ToolTip>\n        <ToolTip title={`Set shift tolerance`} popupPlacement=\"right\">\n          <button type=\"button\" onClick={showSetShiftToleranceModal}>\n            <FaSlidersH />\n          </button>\n        </ToolTip>\n        <div className=\"extra-header-content\">\n          <div className=\"overview-container\">\n            <Overview correlationsData={correlationsData} />\n          </div>\n          <div className=\"table-view-selection\">\n            <span>\n              <label>View:</label>\n              <Select\n                onChange={(selection) => {\n                  setSelectedAdditionalColumnsAtomType(selection);\n                  if (selection === 'H-H') {\n                    setShowProtonsAsRows(true);\n                  } else {\n                    setShowProtonsAsRows(false);\n                  }\n                }}\n                data={additionalColumnTypes}\n                defaultValue={selectedAdditionalColumnsAtomType}\n                style={{\n                  fontSize: '12px',\n                  width: '70px',\n                  height: '18px',\n                  border: '1px solid grey',\n                }}\n              />\n            </span>\n          </div>\n        </div>\n      </DefaultPanelHeader>\n      <CorrelationTable\n        correlationsData={correlationsData}\n        filteredCorrelationsData={filteredCorrelationsData}\n        additionalColumnData={additionalColumnData}\n        editEquivalencesSaveHandler={editEquivalencesSaveHandler}\n        onSaveEditNumericValues={editNumericValuesSaveHandler}\n        onEditCorrelationTableCellHandler={editCorrelationTableCellHandler}\n        showProtonsAsRows={showProtonsAsRows}\n        spectraData={spectraData}\n      />\n    </div>\n  );\n}\n\nexport default memo(SummaryPanel);\n","import {\n  useEffect,\n  useCallback,\n  useImperativeHandle,\n  useRef,\n  memo,\n  CSSProperties,\n  forwardRef,\n} from 'react';\n\nimport { usePreferences } from '../../context/PreferencesContext';\nimport IsotopesViewer from '../../elements/IsotopesViewer';\nimport FormikColumnFormatField from '../../elements/formik/FormikColumnFormatField';\nimport FormikForm from '../../elements/formik/FormikForm';\nimport { useAlert } from '../../elements/popup/Alert';\nimport useNucleus from '../../hooks/useNucleus';\nimport { getValue as getValueByKeyPath } from '../../utility/LocalStorage';\nimport { zoneDefaultValues } from '../extra/preferences/defaultValues';\n\nconst styles: Record<\n  'container' | 'groupContainer' | 'row' | 'header' | 'inputLabel' | 'input',\n  CSSProperties\n> = {\n  container: {\n    padding: 10,\n    backgroundColor: '#f1f1f1',\n    height: '100%',\n    overflowY: 'auto',\n  },\n  groupContainer: {\n    padding: '5px',\n    borderRadius: '5px',\n    margin: '10px 0px',\n    backgroundColor: 'white',\n  },\n  row: {\n    display: 'flex',\n    margin: '5px 0px',\n  },\n  header: {\n    borderBottom: '1px solid #e8e8e8',\n    paddingBottom: '5px',\n    fontWeight: 'bold',\n    color: '#4a4a4a',\n  },\n  inputLabel: {\n    flex: 2,\n    fontSize: '11px',\n    fontWeight: 'bold',\n    color: '#232323',\n  },\n  input: {\n    width: '30%',\n    textAlign: 'center',\n  },\n};\n\nconst formatFields: Array<{\n  id: number;\n  label: string;\n  checkController: string;\n  formatController: string;\n}> = [\n  {\n    id: 1,\n    label: 'From :',\n    checkController: 'showFrom',\n    formatController: 'fromFormat',\n  },\n  {\n    id: 2,\n    label: 'To :',\n    checkController: 'showTo',\n    formatController: 'toFormat',\n  },\n  {\n    id: 3,\n    label: 'Absolute :',\n    checkController: 'showAbsolute',\n    formatController: 'absoluteFormat',\n  },\n  {\n    id: 4,\n    label: 'Relative :',\n    checkController: 'showRelative',\n    formatController: 'relativeFormat',\n  },\n];\n\ninterface ZonesPreferencesInnerProps {\n  nucleus: Array<string>;\n  innerRef: any;\n}\n\nfunction ZonesPreferencesInner({\n  nucleus,\n  innerRef,\n}: ZonesPreferencesInnerProps) {\n  const alert = useAlert();\n  const preferences = usePreferences();\n  const formRef = useRef<any>();\n\n  const updateValues = useCallback(() => {\n    if (nucleus) {\n      const defaultValues = nucleus.reduce((acc, nucleusLabel) => {\n        acc[nucleusLabel] = zoneDefaultValues;\n        return acc;\n      }, {});\n      const zonesPreferences = getValueByKeyPath(\n        preferences.current,\n        `formatting.panels.zones`,\n      );\n      formRef.current.setValues(\n        zonesPreferences ? zonesPreferences : defaultValues,\n      );\n    }\n  }, [nucleus, preferences]);\n\n  useEffect(() => {\n    updateValues();\n  }, [updateValues]);\n\n  const saveHandler = useCallback(\n    (values) => {\n      preferences.dispatch({\n        type: 'SET_PANELS_PREFERENCES',\n        payload: { key: 'zones', value: values },\n      });\n      alert.success('zones preferences saved successfully');\n    },\n    [alert, preferences],\n  );\n\n  useImperativeHandle(\n    innerRef,\n    () => ({\n      saveSetting: () => {\n        formRef.current.submitForm();\n      },\n    }),\n    [],\n  );\n\n  return (\n    <div style={styles.container}>\n      <FormikForm onSubmit={saveHandler} ref={formRef}>\n        {nucleus?.map((nucleusLabel) => (\n          <div key={nucleusLabel} style={styles.groupContainer}>\n            <IsotopesViewer style={styles.header} value={nucleusLabel} />\n            {formatFields.map((field) => (\n              <FormikColumnFormatField\n                key={field.id}\n                label={field.label}\n                checkControllerName={`${nucleusLabel}.${field.checkController}`}\n                formatControllerName={`${nucleusLabel}.${field.formatController}`}\n              />\n            ))}\n          </div>\n        ))}\n      </FormikForm>\n    </div>\n  );\n}\n\nconst MemoizedZonesPreferences = memo(ZonesPreferencesInner);\n\n// TODO: remove this hacky use of ref.\nfunction ZonesPreferences(props, ref: any) {\n  const nucleus = useNucleus();\n  return <MemoizedZonesPreferences innerRef={ref} {...{ nucleus }} />;\n}\n\nexport default forwardRef(ZonesPreferences);\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useFormikContext } from 'formik';\n\nimport DefaultPathLengths from '../../../data/constants/DefaultPathLengths';\nimport FormikNumberInput from '../../elements/formik/FormikNumberInput';\n\nconst editPathLengthsStyles = css`\n  width: 100%;\n  height: 100%;\n  margin-top: 10px;\n  text-align: center;\n\n  .input-container {\n    width: 100%;\n    margin-top: 5px;\n    text-align: center;\n\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n\n    input::-webkit-outer-spin-button,\n    input::-webkit-inner-spin-button {\n      -webkit-appearance: none;\n    }\n  }\n\n  button {\n    flex: 2;\n    padding: 5px;\n    border: 1px solid gray;\n    border-radius: 5px;\n    height: 30px;\n    margin: 0 auto;\n    margin-top: 15px;\n    display: block;\n    width: 60px;\n\n    color: white;\n    background-color: gray;\n  }\n\n  .warning {\n    margin-top: 5px;\n    color: red;\n  }\n`;\n\ninterface InputProps {\n  signalIndex: number;\n}\n\nfunction EditPathLengthFormik({ signalIndex }: InputProps) {\n  const {\n    errors,\n    values,\n  }: {\n    values: any;\n    setFieldValue: (\n      field: string,\n      value: any,\n      shouldValidate?: boolean | undefined,\n    ) => void;\n    errors: any;\n  } = useFormikContext();\n\n  return (\n    <div css={editPathLengthsStyles}>\n      <p>Setting of the minimum and maximum path length (J coupling).</p>\n      <div className=\"input-container\">\n        <FormikNumberInput\n          name={`signals[${signalIndex}].j.pathLength.from`}\n          defaultValue={\n            values.signals[signalIndex].j?.pathLength?.from ||\n            DefaultPathLengths[values.experimentType]?.from ||\n            1\n          }\n          label=\"Min: \"\n          style={{\n            input: {\n              color: errors.signals?.[signalIndex].j?.pathLength?.from\n                ? 'red'\n                : 'black',\n            },\n          }}\n          min={1}\n          max={\n            values.signals[signalIndex].j?.pathLength?.to ||\n            DefaultPathLengths[values.experimentType]?.to\n          }\n          pattern=\"[1-9]+\"\n        />\n        <FormikNumberInput\n          name={`signals[${signalIndex}].j.pathLength.to`}\n          defaultValue={\n            values.signals[signalIndex].j?.pathLength?.to ||\n            DefaultPathLengths[values.experimentType]?.to ||\n            1\n          }\n          label=\"Max: \"\n          style={{\n            input: {\n              color: errors.signals?.[signalIndex].j?.pathLength?.to\n                ? 'red'\n                : 'black',\n            },\n          }}\n          min={\n            values.signals[signalIndex].j?.pathLength?.from ||\n            DefaultPathLengths[values.experimentType]?.from ||\n            1\n          }\n          pattern=\"[1-9]+\"\n        />\n      </div>\n    </div>\n  );\n}\n\nexport default EditPathLengthFormik;\n","import EditPathLengthFormik from './EditPathLengthFormik';\n\ninterface SignalFormTabProps {\n  signalIndex: number;\n}\n\nfunction SignalFormTab({ signalIndex }: SignalFormTabProps) {\n  return <EditPathLengthFormik signalIndex={signalIndex} />;\n}\n\nexport default SignalFormTab;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useFormikContext } from 'formik';\nimport { useCallback, useMemo } from 'react';\n\nimport Tab from '../../elements/Tab/Tab';\nimport Tabs from '../../elements/Tab/Tabs';\n\nimport SignalFormTab from './SignalFormTab';\n\nconst textStyles = css`\n  text-align: center;\n  width: 100%;\n\n  .errorText {\n    color: red;\n  }\n\n  .infoText {\n    padding: 10px;\n    margin: 10px 0;\n    font-size: 14px;\n    text-align: left;\n    color: white;\n    background-color: #5f5f5f;\n    border-radius: 5px;\n  }\n`;\n\nconst tabStylesAddition = css`\n  color: red;\n`;\nconst tabStyles = css`\n  display: inline-grid;\n  list-style: none;\n  padding: 0.5rem 1.5rem;\n`;\n\nfunction SignalsForm() {\n  const {\n    values,\n    setFieldValue,\n    errors,\n  }: {\n    values: any;\n    setFieldValue: (\n      field: string,\n      value: any,\n      shouldValidate?: boolean | undefined,\n    ) => void;\n    errors: any;\n  } = useFormikContext<any>();\n\n  const tabContainsErrors = useCallback(\n    (i) => {\n      return errors?.signals && errors?.signals[i] ? true : false;\n    },\n    [errors],\n  );\n\n  const signalFormTabs = useMemo(() => {\n    const signalTabs =\n      values.signals.length > 0\n        ? values.signals.map((signal, i) => (\n            <Tab\n              // eslint-disable-next-line react/no-array-index-key\n              key={`signalForm_zone${i}`}\n              tabid={`${i}`}\n              tabstyles={tabContainsErrors(i) ? tabStylesAddition : tabStyles}\n              render={() => (\n                <div\n                  style={{\n                    display: 'flex',\n                    flexDirection: 'column',\n                    alignItems: 'center',\n                    fontSize: '11px',\n                  }}\n                >\n                  <span>\n                    𝛅<sub>{signal.x.nucleus}</sub>: {signal.x.delta.toFixed(2)}\n                  </span>\n                  <span>\n                    𝛅<sub>{signal.y.nucleus}</sub>: {signal.y.delta.toFixed(2)}\n                  </span>\n                </div>\n              )}\n            >\n              <SignalFormTab signalIndex={i} />\n            </Tab>\n          ))\n        : [];\n\n    return signalTabs;\n  }, [tabContainsErrors, values.signals]);\n\n  const tapClickHandler = useCallback(\n    ({ tabid }) => {\n      setFieldValue('activeTab', tabid);\n    },\n    [setFieldValue],\n  );\n\n  const handleDeleteSignal = useCallback(\n    ({ tabid }) => {\n      const _signals = values.signals.filter(\n        (_signal, i) => i !== Number(tabid),\n      );\n      setFieldValue('signals', _signals);\n    },\n    [setFieldValue, values.signals],\n  );\n\n  return (\n    <div>\n      <div css={textStyles} />\n      <Tabs\n        activeTab={values.activeTab}\n        onClick={tapClickHandler}\n        onDelete={handleDeleteSignal}\n      >\n        {signalFormTabs}\n      </Tabs>\n    </div>\n  );\n}\n\nexport default SignalsForm;\n","import { useMemo } from 'react';\nimport * as Yup from 'yup';\n\nconst useValidation = () =>\n  useMemo(() => {\n    return Yup.object().shape({\n      signals: Yup.array()\n        .of(\n          Yup.object().shape({\n            j: Yup.object().shape({\n              pathLength: Yup.object().shape({\n                from: Yup.number().required().positive().integer(),\n                to: Yup.number().required().positive().integer(),\n              }),\n            }),\n          }),\n        )\n        .min(1, 'There must be at least one signal in a zone!'),\n    });\n  }, []);\n\nexport default useValidation;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { FromTo } from 'cheminfo-types';\nimport { useCallback, useEffect, useMemo, useRef } from 'react';\nimport { FaSearchPlus } from 'react-icons/fa';\n\nimport DefaultPathLengths from '../../../data/constants/DefaultPathLengths';\nimport { Signal2D } from '../../../data/types/data2d';\nimport Button from '../../elements/Button';\nimport CloseButton from '../../elements/CloseButton';\nimport SaveButton from '../../elements/SaveButton';\nimport FormikForm from '../../elements/formik/FormikForm';\n\nimport SignalsForm from './SignalsForm';\nimport useRangeFormValidation from './validation/EditZoneValidation';\nimport isDefaultPathLength from './validation/isDefaultPathLength';\n\nconst styles = css`\n  width: 500px;\n  height: 250px;\n  padding: 5px;\n  button:focus {\n    outline: none;\n  }\n  .header {\n    height: 24px;\n    border-bottom: 1px solid #f0f0f0;\n    display: flex;\n    align-items: center;\n    span {\n      color: #464646;\n      font-size: 15px;\n      flex: 1;\n      border-left: 1px solid #ececec;\n      padding-left: 6px;\n    }\n\n    button {\n      background-color: transparent;\n      border: none;\n      padding: 5px;\n\n      svg {\n        height: 16px;\n      }\n    }\n  }\n  .container {\n    display: flex;\n    margin: 30px 5px;\n  }\n`;\n\ninterface EditZoneModalProps {\n  onSaveEditZoneModal: (value: any) => Promise<void> | null | void;\n  onCloseEditZoneModal: () => void;\n  onZoomEditZoneModal: (value: any) => void;\n  rowData: any;\n}\n\nfunction EditZoneModal({\n  onSaveEditZoneModal = () => null,\n  onCloseEditZoneModal = () => null,\n  onZoomEditZoneModal = () => null,\n  rowData,\n}: EditZoneModalProps) {\n  const formRef = useRef<any>(null);\n  const validation = useRangeFormValidation();\n\n  const handleOnZoom = useCallback(() => {\n    onZoomEditZoneModal(rowData);\n  }, [onZoomEditZoneModal, rowData]);\n\n  useEffect(() => {\n    handleOnZoom();\n  }, [handleOnZoom]);\n\n  const handleOnClose = useCallback(() => {\n    onCloseEditZoneModal();\n  }, [onCloseEditZoneModal]);\n\n  const handleOnSave = useCallback(\n    (formValues) => {\n      void (async () => {\n        const _rowData = {\n          ...rowData,\n          signals: formValues.signals.map((signal: Signal2D) => {\n            if (\n              isDefaultPathLength(\n                signal.j?.pathLength as FromTo,\n                rowData.tableMetaInfo.experiment,\n              )\n            ) {\n              delete signal.j?.pathLength;\n              if (signal.j && Object.keys(signal.j).length === 0) {\n                delete signal.j;\n              }\n            }\n\n            return signal;\n          }),\n        };\n\n        await onSaveEditZoneModal(_rowData);\n        handleOnClose();\n      })();\n    },\n    [handleOnClose, onSaveEditZoneModal, rowData],\n  );\n\n  const data = useMemo(() => {\n    return {\n      activeTab: '0',\n      signals: rowData.signals.map((signal: Signal2D): Signal2D => {\n        return {\n          ...signal,\n          j: {\n            pathLength: {\n              from:\n                DefaultPathLengths[rowData.tableMetaInfo.experiment]?.from || 1,\n              to: DefaultPathLengths[rowData.tableMetaInfo.experiment]?.to || 1,\n            },\n            ...signal.j,\n          },\n        };\n      }),\n    };\n  }, [rowData.signals, rowData.tableMetaInfo.experiment]);\n\n  return (\n    <div css={styles}>\n      <FormikForm\n        ref={formRef}\n        initialValues={data}\n        validationSchema={validation}\n        onSubmit={handleOnSave}\n      >\n        <div className=\"header handle\">\n          <Button onClick={handleOnZoom} className=\"zoom-button\">\n            <FaSearchPlus title=\"Set to default view on range in spectrum\" />\n          </Button>\n          <span>{`Zone and Signal edition`}</span>\n          <SaveButton\n            onClick={() => formRef.current.submitForm()}\n            popupTitle=\"Save and exit\"\n          />\n          <CloseButton onClick={handleOnClose} />\n        </div>\n        <SignalsForm />\n      </FormikForm>\n    </div>\n  );\n}\n\nexport default EditZoneModal;\n","import { CSSProperties, Fragment, useCallback } from 'react';\nimport { FaEdit, FaRegTrashAlt, FaSearchPlus } from 'react-icons/fa';\n\nimport { SignalKinds } from '../../../../data/constants/SignalsKinds';\nimport { useAssignmentData } from '../../../assignment/AssignmentsContext';\nimport { useDispatch } from '../../../context/DispatchContext';\nimport Select from '../../../elements/Select';\nimport {\n  useModal,\n  positions,\n  transitions,\n} from '../../../elements/popup/Modal';\nimport EditZoneModal from '../../../modal/editZone/EditZoneModal';\nimport {\n  CHANGE_ZONE_SIGNAL_KIND,\n  DELETE_2D_ZONE,\n  SAVE_EDITED_ZONE,\n  SET_SELECTED_TOOL,\n  SET_X_DOMAIN,\n  SET_Y_DOMAIN,\n} from '../../../reducer/types/Types';\nimport { options } from '../../../toolbar/ToolTypes';\n\nconst selectBoxStyle: CSSProperties = {\n  marginLeft: 2,\n  marginRight: 2,\n  border: 'none',\n  height: '20px',\n};\n\nexport interface RowDataProps {\n  id: number;\n  tableMetaInfo: {\n    id: number;\n    signalIndex: number;\n    rowSpan: any;\n    signal: {\n      kind: any;\n    };\n    experiment: string;\n  };\n  x: {\n    from: number;\n    to: number;\n  };\n  y: {\n    from: number;\n    to: number;\n  };\n}\n\ninterface ActionsColumnProps {\n  rowData: RowDataProps;\n  rowSpanTags: any;\n}\n\nfunction ActionsColumn({ rowData, rowSpanTags }: ActionsColumnProps) {\n  const dispatch = useDispatch();\n  const assignmentData = useAssignmentData();\n  const modal = useModal();\n\n  const changeSignalKindHandler = useCallback(\n    (value) => {\n      dispatch({\n        type: CHANGE_ZONE_SIGNAL_KIND,\n        payload: {\n          rowData,\n          value,\n        },\n      });\n    },\n    [dispatch, rowData],\n  );\n\n  const deleteZoneHandler = useCallback(() => {\n    dispatch({\n      type: DELETE_2D_ZONE,\n      payload: {\n        id: rowData.id,\n        assignmentData,\n      },\n    });\n  }, [assignmentData, dispatch, rowData]);\n\n  const zoomZoneHandler = useCallback(() => {\n    const xMargin = Math.abs(rowData.x.from - rowData.x.to) * 10;\n    dispatch({\n      type: SET_X_DOMAIN,\n      xDomain:\n        rowData.x.from <= rowData.x.to\n          ? [rowData.x.from - xMargin, rowData.x.to + xMargin]\n          : [rowData.x.to - xMargin, rowData.x.from + xMargin],\n    });\n    const yMargin = Math.abs(rowData.y.from - rowData.y.to) * 10;\n    dispatch({\n      type: SET_Y_DOMAIN,\n      yDomain:\n        rowData.y.from <= rowData.y.to\n          ? [rowData.y.from - yMargin, rowData.y.to + yMargin]\n          : [rowData.y.to - yMargin, rowData.y.from + yMargin],\n    });\n  }, [dispatch, rowData.x.from, rowData.x.to, rowData.y.from, rowData.y.to]);\n\n  const saveEditZoneHandler = useCallback(\n    (editedRowData) => {\n      dispatch({\n        type: SAVE_EDITED_ZONE,\n        payload: {\n          editedRowData,\n        },\n      });\n    },\n    [dispatch],\n  );\n\n  const openEditZoneHandler = useCallback(() => {\n    dispatch({\n      type: SET_SELECTED_TOOL,\n      payload: { selectedTool: options.editRange.id, tempRange: rowData },\n    });\n    modal.show(\n      <EditZoneModal\n        onCloseEditZoneModal={() => modal.close()}\n        onSaveEditZoneModal={saveEditZoneHandler}\n        onZoomEditZoneModal={() => zoomZoneHandler()}\n        rowData={rowData}\n      />,\n      {\n        position: positions.MIDDLE_RIGHT,\n        transition: transitions.SCALE,\n        isBackgroundBlur: false,\n      },\n    );\n  }, [dispatch, modal, rowData, saveEditZoneHandler, zoomZoneHandler]);\n\n  return (\n    <Fragment>\n      <td>\n        <Select\n          onChange={(value) => {\n            changeSignalKindHandler(value);\n          }}\n          data={SignalKinds}\n          defaultValue={rowData.tableMetaInfo.signal.kind}\n          style={selectBoxStyle}\n        />\n      </td>\n      <td {...rowSpanTags}>\n        <button\n          type=\"button\"\n          className=\"delete-button\"\n          onClick={deleteZoneHandler}\n        >\n          <FaRegTrashAlt />\n        </button>\n        <button type=\"button\" className=\"zoom-button\" onClick={zoomZoneHandler}>\n          <FaSearchPlus title=\"Zoom to zone in spectrum\" />\n        </button>\n        <button\n          type=\"button\"\n          className=\"edit-button\"\n          onClick={openEditZoneHandler}\n        >\n          <FaEdit color=\"blue\" />\n        </button>\n      </td>\n    </Fragment>\n  );\n}\n\nexport default ActionsColumn;\n","import lodashGet from 'lodash/get';\nimport { FaMinusCircle } from 'react-icons/fa';\n\nimport { AssignmentsData, Axis } from '../../../assignment/AssignmentsContext';\n\nimport { RowDataProps } from './ActionsColumn';\n\nexport interface SignalAssignmentsColumnProps {\n  rowData: RowDataProps;\n  assignment: AssignmentsData;\n  // assignment: {\n  //   isActive: any;\n  //   activeAxis: any;\n  // };\n  highlight: {\n    isActive: any;\n  };\n  onHover: () => void;\n  onClick: (event: any, assignment: AssignmentsData, axis: Axis) => void;\n  onUnlink: (event: any, flag: boolean, axis: Axis) => void;\n  showUnlinkButton: boolean;\n  axis: Axis;\n  setShowUnlinkButton: (element: boolean) => void;\n}\n\nfunction SignalAssignmentsColumn({\n  rowData,\n  assignment,\n  highlight,\n  onHover,\n  onClick,\n  onUnlink,\n  axis,\n  showUnlinkButton,\n  setShowUnlinkButton,\n}: SignalAssignmentsColumnProps) {\n  return (\n    <td\n      {...onHover}\n      {...{ onClick: (e) => onClick(e, assignment, axis) }}\n      style={\n        highlight.isActive ||\n        (assignment.isActive && assignment.activated?.axis === axis)\n          ? {\n              color: 'red',\n              fontWeight: 'bold',\n            }\n          : undefined\n      }\n    >\n      {lodashGet(rowData, `tableMetaInfo.signal.${axis}.diaIDs`, []).length >\n      0 ? (\n        <div\n          onMouseEnter={() => setShowUnlinkButton(true)}\n          onMouseLeave={() => setShowUnlinkButton(false)}\n        >\n          {rowData.tableMetaInfo.signal[axis].diaIDs.length}{' '}\n          <sup>\n            <button\n              type=\"button\"\n              style={{\n                visibility: showUnlinkButton ? 'visible' : 'hidden',\n                padding: 0,\n                margin: 0,\n              }}\n              onClick={(e) => onUnlink(e, false, axis)}\n            >\n              <FaMinusCircle color=\"red\" />\n            </button>\n          </sup>\n        </div>\n      ) : assignment.isActive && assignment.activated?.axis === axis ? (\n        '0'\n      ) : (\n        ''\n      )}\n    </td>\n  );\n}\n\nexport default SignalAssignmentsColumn;\n","import { Fragment } from 'react';\n\nimport { AssignmentsData, Axis } from '../../../assignment/AssignmentsContext';\n\nimport { RowDataProps } from './ActionsColumn';\nimport SignalAssignmentsColumn from './SignalAssignmentsColumn';\n\ninterface SignalAssignmentsColumnsProps {\n  rowData: RowDataProps;\n  onHoverSignalX: any;\n  onHoverSignalY: any;\n  showUnlinkButtonSignalX: boolean;\n  showUnlinkButtonSignalY: boolean;\n  setShowUnlinkButtonSignalX: (element: boolean) => void;\n  setShowUnlinkButtonSignalY: (element: boolean) => void;\n  onClick: (event: any, assignment: AssignmentsData, axis: Axis) => void;\n  onUnlink: (event: any, flag: boolean, axis: Axis) => void;\n  highlightSignalX: {\n    isActive: any;\n  };\n  highlightSignalY: {\n    isActive: any;\n  };\n  assignmentSignal: AssignmentsData;\n}\n\nfunction SignalAssignmentsColumns({\n  rowData,\n  assignmentSignal,\n  onHoverSignalX,\n  onHoverSignalY,\n  showUnlinkButtonSignalX,\n  showUnlinkButtonSignalY,\n  setShowUnlinkButtonSignalX,\n  setShowUnlinkButtonSignalY,\n  onClick,\n  onUnlink,\n  highlightSignalX,\n  highlightSignalY,\n}: SignalAssignmentsColumnsProps) {\n  return (\n    <Fragment>\n      <SignalAssignmentsColumn\n        rowData={rowData}\n        assignment={assignmentSignal}\n        highlight={highlightSignalX}\n        onHover={onHoverSignalX}\n        onClick={onClick}\n        onUnlink={onUnlink}\n        axis=\"x\"\n        showUnlinkButton={showUnlinkButtonSignalX}\n        setShowUnlinkButton={setShowUnlinkButtonSignalX}\n      />\n      <SignalAssignmentsColumn\n        rowData={rowData}\n        assignment={assignmentSignal}\n        highlight={highlightSignalY}\n        onHover={onHoverSignalY}\n        onClick={onClick}\n        onUnlink={onUnlink}\n        axis=\"y\"\n        showUnlinkButton={showUnlinkButtonSignalY}\n        setShowUnlinkButton={setShowUnlinkButtonSignalY}\n      />\n    </Fragment>\n  );\n}\n\nexport default SignalAssignmentsColumns;\n","import lodashGet from 'lodash/get';\nimport { Fragment, useCallback } from 'react';\n\nimport { useDispatch } from '../../../context/DispatchContext';\nimport EditableColumn from '../../../elements/EditableColumn';\nimport { CHANGE_ZONE_SIGNAL_VALUE } from '../../../reducer/types/Types';\n\nimport { RowDataProps } from './ActionsColumn';\n\ninterface SignalDeltaColumnProps {\n  rowData: RowDataProps;\n  onHoverSignalX: any;\n  onHoverSignalY: any;\n}\n\nfunction SignalDeltaColumn({\n  rowData,\n  onHoverSignalX,\n  onHoverSignalY,\n}: SignalDeltaColumnProps) {\n  const dispatch = useDispatch();\n\n  const signalDeltaX = lodashGet(rowData, 'tableMetaInfo.signal.x.delta', null);\n  const signalDeltaY = lodashGet(rowData, 'tableMetaInfo.signal.y.delta', null);\n  const id = lodashGet(rowData, 'tableMetaInfo.signal.id', undefined);\n\n  const saveXHandler = useCallback(\n    (event) => {\n      const value = event.target.value;\n      dispatch({\n        type: CHANGE_ZONE_SIGNAL_VALUE,\n        payload: {\n          zoneID: rowData.id,\n          signal: { id, x: value },\n        },\n      });\n    },\n    [dispatch, id, rowData.id],\n  );\n  const saveYHandler = useCallback(\n    (event) => {\n      const value = event.target.value;\n      dispatch({\n        type: CHANGE_ZONE_SIGNAL_VALUE,\n        payload: {\n          zoneID: rowData.id,\n          signal: { id, y: value },\n        },\n      });\n    },\n    [dispatch, id, rowData.id],\n  );\n\n  return (\n    <Fragment>\n      <td {...onHoverSignalX}>\n        {signalDeltaX !== null ? (\n          <EditableColumn\n            value={signalDeltaX.toFixed(2)}\n            onSave={saveXHandler}\n            type=\"number\"\n            style={{ padding: '0.1rem 0.4rem' }}\n          />\n        ) : (\n          ''\n        )}\n      </td>\n      <td {...onHoverSignalY}>\n        {signalDeltaY !== null ? (\n          <EditableColumn\n            value={signalDeltaY.toFixed(2)}\n            onSave={saveYHandler}\n            type=\"number\"\n            style={{ padding: '0.1rem 0.4rem' }}\n          />\n        ) : (\n          ''\n        )}\n      </td>\n    </Fragment>\n  );\n}\n\nexport default SignalDeltaColumn;\n","import lodashGet from 'lodash/get';\nimport { MouseEvent } from 'react';\nimport { FaMinusCircle } from 'react-icons/fa';\n\nimport { AssignmentsData, Axis } from '../../../assignment/AssignmentsContext';\n\nimport { RowDataProps } from './ActionsColumn';\n\nexport interface ZoneAssignmentColumnProps {\n  rowData: RowDataProps;\n  axis: any;\n  onHover: () => void;\n  onClick: (event: MouseEvent, assignment: AssignmentsData, axis: Axis) => void;\n  onUnlink: (event: MouseEvent, flag: boolean, axis: Axis) => void;\n  highlight: {\n    isActive: any;\n  };\n\n  assignment: AssignmentsData;\n  showUnlinkButton: boolean;\n  setShowUnlinkButton: (element: boolean) => void;\n  rowSpanTags: any;\n}\n\nfunction ZoneAssignmentColumn({\n  rowData,\n  assignment,\n  highlight,\n  onHover,\n  onClick,\n  onUnlink,\n  axis,\n  showUnlinkButton,\n  setShowUnlinkButton,\n  rowSpanTags,\n}: ZoneAssignmentColumnProps) {\n  return (\n    <td\n      {...rowSpanTags}\n      {...onHover}\n      {...{ onClick: (e) => onClick(e, assignment, axis) }}\n    >\n      {lodashGet(rowData, `${axis}.nbAtoms`, 0) > 0 ? (\n        lodashGet(rowData, `${axis}.diaIDs`, 0).length > 0 ? (\n          <div\n            onMouseEnter={() => setShowUnlinkButton(true)}\n            onMouseLeave={() => setShowUnlinkButton(false)}\n          >\n            {rowData[axis].nbAtoms} {`(`}\n            <span\n              style={\n                (assignment.isActive && assignment.activated?.axis === axis) ||\n                (assignment.isOver && assignment.highlighted?.axis === axis) ||\n                highlight.isActive\n                  ? {\n                      color: 'red',\n                      fontWeight: 'bold',\n                    }\n                  : { color: 'black', fontWeight: 'normal' }\n              }\n            >\n              {lodashGet(rowData, `${axis}.diaIDs`, []).length}\n            </span>\n            {`)`}{' '}\n            <sup>\n              <button\n                type=\"button\"\n                style={{\n                  visibility: showUnlinkButton ? 'visible' : 'hidden',\n                  padding: 0,\n                  margin: 0,\n                }}\n                onClick={(e) => onUnlink(e, true, axis)}\n              >\n                <FaMinusCircle color=\"red\" />\n              </button>\n            </sup>\n          </div>\n        ) : assignment.isActive && assignment.activated?.axis === axis ? (\n          <div>\n            {`${lodashGet(rowData, `${axis}.nbAtoms`, '')} (`}\n            <span\n              style={{\n                color: 'red',\n                fontWeight: 'bold',\n              }}\n            >\n              0\n            </span>\n            {')'}\n          </div>\n        ) : (\n          rowData[axis].nbAtoms\n        )\n      ) : assignment.isActive && assignment.activated?.axis === axis ? (\n        <div>\n          {'0 ('}\n          <span style={{ color: 'red', fontWeight: 'bold' }}>0</span>\n          {')'}\n        </div>\n      ) : (\n        ''\n      )}\n    </td>\n  );\n}\n\nexport default ZoneAssignmentColumn;\n","import { Fragment } from 'react';\n\nimport { AssignmentsData, Axis } from '../../../assignment/AssignmentsContext';\n\nimport { RowDataProps } from './ActionsColumn';\nimport ZoneAssignmentColumn from './ZoneAssignmentsColumn';\n\ninterface ZoneAssignmentsColumnsProps {\n  rowData: RowDataProps;\n  onHoverZoneX: any;\n  onHoverZoneY: any;\n  onClick: (event: any, assignment: AssignmentsData, axis: Axis) => void;\n  onUnlink: (event: any, flag: boolean, axis: Axis) => void;\n  rowSpanTags: any;\n  showUnlinkButtonZoneX: boolean;\n  showUnlinkButtonZoneY: boolean;\n  setShowUnlinkButtonZoneX: (element: boolean) => void;\n  setShowUnlinkButtonZoneY: (element: boolean) => void;\n  assignmentZone: AssignmentsData;\n  highlightZoneX: {\n    isActive: any;\n  };\n  highlightZoneY: {\n    isActive: any;\n  };\n}\n\nfunction ZoneAssignmentsColumns({\n  rowData,\n  assignmentZone,\n  onHoverZoneX,\n  onHoverZoneY,\n  showUnlinkButtonZoneX,\n  showUnlinkButtonZoneY,\n  setShowUnlinkButtonZoneX,\n  setShowUnlinkButtonZoneY,\n  rowSpanTags,\n  onClick,\n  onUnlink,\n  highlightZoneX,\n  highlightZoneY,\n}: ZoneAssignmentsColumnsProps) {\n  return (\n    <Fragment>\n      <ZoneAssignmentColumn\n        rowData={rowData}\n        assignment={assignmentZone}\n        highlight={highlightZoneX}\n        onHover={onHoverZoneX}\n        onClick={onClick}\n        onUnlink={onUnlink}\n        axis={'x'}\n        showUnlinkButton={showUnlinkButtonZoneX}\n        setShowUnlinkButton={setShowUnlinkButtonZoneX}\n        rowSpanTags={rowSpanTags}\n      />\n      <ZoneAssignmentColumn\n        rowData={rowData}\n        assignment={assignmentZone}\n        highlight={highlightZoneY}\n        onHover={onHoverZoneY}\n        onClick={onClick}\n        onUnlink={onUnlink}\n        axis={'y'}\n        showUnlinkButton={showUnlinkButtonZoneY}\n        setShowUnlinkButton={setShowUnlinkButtonZoneY}\n        rowSpanTags={rowSpanTags}\n      />\n    </Fragment>\n  );\n}\n\nexport default ZoneAssignmentsColumns;\n","/** @jsxImportSource @emotion/react */\n\nimport lodashGet from 'lodash/get';\nimport {\n  CSSProperties,\n  useMemo,\n  useCallback,\n  useState,\n  MouseEvent,\n} from 'react';\n\nimport { buildID } from '../../../data/utilities/Concatenation';\nimport {\n  Axis,\n  useAssignment,\n  AssignmentsData,\n} from '../../assignment/AssignmentsContext';\nimport { useHighlight } from '../../highlight';\n\nimport ActionsColumn, { RowDataProps } from './TableColumns/ActionsColumn';\nimport SignalAssignmentsColumns from './TableColumns/SignalAssignmentsColumns';\nimport SignalDeltaColumn from './TableColumns/SignalDeltaColumn';\nimport ZoneAssignmentsColumns from './TableColumns/ZoneAssignmentsColumns';\n\nconst HighlightedRowStyle: CSSProperties = { backgroundColor: '#ff6f0057' };\n\nconst ConstantlyHighlightedRowStyle = { backgroundColor: '#f5f5dc' };\n\ninterface ZonesTableRowProps {\n  rowData: RowDataProps;\n  onUnlink: (\n    rowData: RowDataProps,\n    isOnZoneLevel: boolean,\n    signalIndex: any,\n    axis: Axis,\n  ) => void;\n  onContextMenu: (a: any, rowData: RowDataProps) => void;\n  rowIndex: number;\n}\n\nfunction ZonesTableRow({\n  rowData,\n  onUnlink,\n  onContextMenu,\n  rowIndex,\n}: ZonesTableRowProps) {\n  const assignmentZone = useAssignment(rowData.id);\n  const highlightZone = useHighlight([assignmentZone.id]);\n  const highlightZoneX = useHighlight(\n    [buildID(assignmentZone.id, 'X')].concat(assignmentZone.assigned?.x || []),\n  );\n\n  const highlightZoneY = useHighlight(\n    [buildID(assignmentZone.id, 'Y')].concat(assignmentZone.assigned?.y || []),\n  );\n\n  const assignmentSignal = useAssignment(rowData.tableMetaInfo.id);\n  const highlightSignalX = useHighlight(\n    [buildID(assignmentSignal.id, 'X')].concat(\n      assignmentSignal.assigned?.x || [],\n      buildID(assignmentSignal.id, 'Crosshair'),\n    ),\n  );\n  const highlightSignalY = useHighlight(\n    [buildID(assignmentSignal.id, 'Y')].concat(\n      assignmentSignal.assigned?.y || [],\n      buildID(assignmentSignal.id, 'Crosshair'),\n    ),\n  );\n\n  const [showUnlinkButtonZoneX, setShowUnlinkButtonZoneX] = useState(false);\n  const [showUnlinkButtonZoneY, setShowUnlinkButtonZoneY] = useState(false);\n  const [showUnlinkButtonSignalX, setShowUnlinkButtonSignalX] = useState(false);\n  const [showUnlinkButtonSignalY, setShowUnlinkButtonSignalY] = useState(false);\n\n  const rowSpanTags = useMemo(() => {\n    return {\n      rowSpan: rowData.tableMetaInfo.rowSpan,\n      style:\n        lodashGet(rowData, 'tableMetaInfo.hide', false) === true\n          ? { display: 'none' }\n          : null,\n    };\n  }, [rowData]);\n\n  const unlinkHandler = useCallback(\n    (event: MouseEvent, isOnZoneLevel: boolean, axis: Axis) => {\n      // event handling here in case of unlink button clicked\n      if (event) {\n        event.stopPropagation();\n      }\n      onUnlink(rowData, isOnZoneLevel, rowData.tableMetaInfo.signalIndex, axis);\n      if (axis === 'x') {\n        if (isOnZoneLevel !== undefined) {\n          if (isOnZoneLevel) {\n            setShowUnlinkButtonZoneX(false);\n            assignmentZone.removeAll('x');\n          } else {\n            setShowUnlinkButtonSignalX(false);\n            assignmentSignal.removeAll('x');\n          }\n        } else {\n          setShowUnlinkButtonZoneX(false);\n          setShowUnlinkButtonSignalX(false);\n        }\n      } else if (axis === 'y') {\n        if (isOnZoneLevel !== undefined) {\n          if (isOnZoneLevel) {\n            setShowUnlinkButtonZoneY(false);\n            assignmentZone.removeAll('y');\n          } else {\n            setShowUnlinkButtonSignalY(false);\n            assignmentSignal.removeAll('y');\n          }\n        } else {\n          setShowUnlinkButtonZoneY(false);\n          setShowUnlinkButtonSignalY(false);\n        }\n      } else {\n        setShowUnlinkButtonZoneX(false);\n        assignmentZone.removeAll('x');\n        setShowUnlinkButtonSignalX(false);\n        assignmentSignal.removeAll('x');\n        setShowUnlinkButtonZoneY(false);\n        assignmentZone.removeAll('y');\n        setShowUnlinkButtonSignalY(false);\n        assignmentSignal.removeAll('y');\n      }\n    },\n    [assignmentSignal, assignmentZone, onUnlink, rowData],\n  );\n\n  const clickHandler = useCallback(\n    (event: MouseEvent, assignment: AssignmentsData, axis: Axis) => {\n      event.stopPropagation();\n      assignment.setActive(axis);\n    },\n    [],\n  );\n\n  const onHoverZoneX = useMemo(() => {\n    return {\n      onMouseEnter: () => {\n        assignmentZone.show('x');\n        highlightZoneX.show();\n      },\n      onMouseLeave: () => {\n        assignmentZone.hide();\n        highlightZoneX.hide();\n      },\n    };\n  }, [assignmentZone, highlightZoneX]);\n\n  const onHoverZoneY = useMemo(() => {\n    return {\n      onMouseEnter: () => {\n        assignmentZone.show('y');\n        highlightZoneY.show();\n      },\n      onMouseLeave: () => {\n        assignmentZone.hide();\n        highlightZoneY.hide();\n      },\n    };\n  }, [assignmentZone, highlightZoneY]);\n\n  const onHoverSignalX = useMemo(() => {\n    return {\n      onMouseEnter: () => {\n        assignmentSignal.show('x');\n        highlightSignalX.show();\n      },\n      onMouseLeave: () => {\n        assignmentSignal.hide();\n        highlightSignalX.hide();\n      },\n    };\n  }, [assignmentSignal, highlightSignalX]);\n\n  const onHoverSignalY = useMemo(() => {\n    return {\n      onMouseEnter: () => {\n        assignmentSignal.show('y');\n        highlightSignalY.show();\n      },\n      onMouseLeave: () => {\n        assignmentSignal.hide();\n        highlightSignalY.hide();\n      },\n    };\n  }, [assignmentSignal, highlightSignalY]);\n\n  return (\n    <tr\n      onContextMenu={(e) => onContextMenu(e, rowData)}\n      style={\n        highlightZone.isActive || assignmentZone.isActive\n          ? (HighlightedRowStyle as any)\n          : lodashGet(\n              rowData,\n              'tableMetaInfo.isConstantlyHighlighted',\n              false,\n            ) === true\n          ? ConstantlyHighlightedRowStyle\n          : null\n      }\n      {...highlightZone.onHover}\n    >\n      <td {...(rowSpanTags as any)}>{rowIndex + 1}</td>\n      <SignalDeltaColumn\n        rowData={rowData}\n        onHoverSignalX={onHoverSignalX}\n        onHoverSignalY={onHoverSignalY}\n      />\n      <SignalAssignmentsColumns\n        rowData={rowData}\n        assignmentSignal={assignmentSignal}\n        onHoverSignalX={onHoverSignalX}\n        onHoverSignalY={onHoverSignalY}\n        showUnlinkButtonSignalX={showUnlinkButtonSignalX}\n        showUnlinkButtonSignalY={showUnlinkButtonSignalY}\n        setShowUnlinkButtonSignalX={(show) => setShowUnlinkButtonSignalX(show)}\n        setShowUnlinkButtonSignalY={(show) => setShowUnlinkButtonSignalY(show)}\n        onClick={clickHandler}\n        onUnlink={unlinkHandler}\n        highlightSignalX={highlightSignalX}\n        highlightSignalY={highlightSignalY}\n      />\n      <ZoneAssignmentsColumns\n        rowData={rowData}\n        assignmentZone={assignmentZone}\n        onHoverZoneX={onHoverZoneX}\n        onHoverZoneY={onHoverZoneY}\n        showUnlinkButtonZoneX={showUnlinkButtonZoneX}\n        showUnlinkButtonZoneY={showUnlinkButtonZoneY}\n        setShowUnlinkButtonZoneX={(show) => setShowUnlinkButtonZoneX(show)}\n        setShowUnlinkButtonZoneY={(show) => setShowUnlinkButtonZoneY(show)}\n        rowSpanTags={rowSpanTags}\n        onClick={clickHandler}\n        onUnlink={unlinkHandler}\n        highlightZoneX={highlightZoneX}\n        highlightZoneY={highlightZoneY}\n      />\n      <ActionsColumn rowData={rowData} rowSpanTags={rowSpanTags} />\n    </tr>\n  );\n}\n\nexport default ZonesTableRow;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useMemo, useCallback, useRef, ReactNode } from 'react';\nimport { FaLink } from 'react-icons/fa';\n\nimport checkModifierKeyActivated from '../../../data/utilities/checkModifierKeyActivated';\nimport ContextMenu from '../../elements/ContextMenu';\nimport useTableSortBy from '../../hooks/useTableSortBy';\n\nimport ZonesTableRow from './ZonesTableRow';\n\nconst tableStyle = css`\n  border-spacing: 0;\n  border: 1px solid #dedede;\n  width: 100%;\n  font-size: 12px;\n  .react-contextmenu-wrapper {\n    display: contents;\n  }\n  tr {\n    :last-child {\n      td {\n        border-bottom: 0;\n      }\n    }\n  }\n  thead tr:nth-of-type(1) th {\n    top: 0;\n  }\n  thead tr:nth-of-type(2) th {\n    top: 21px;\n  }\n  th {\n    position: sticky;\n    background-color: white;\n    z-index: 2;\n  }\n  th,\n  td {\n    white-space: nowrap;\n    text-align: center;\n    margin: 0;\n    padding: 0.1rem 0.4rem;\n    border-bottom: 1px solid #dedede;\n    border-right: 1px solid #dedede;\n\n    :last-child {\n      border-right: 0;\n    }\n    button {\n      background-color: transparent;\n      border: none;\n      padding: 0 5px;\n    }\n  }\n`;\n\ninterface ZonesTableProps {\n  tableData: Array<{\n    signals: Array<any>;\n    tableMetaInfo: any;\n    rowIndex: number;\n    signalIndex: number;\n    id: number;\n  }>;\n  onUnlink: (\n    zoneData: any,\n    isOnZoneLevel: any,\n    signalIndex: any,\n    axis: any,\n  ) => void;\n  context?: any;\n  nuclei: string[];\n  experiment: string;\n}\n\nfunction ZonesTable({\n  tableData,\n  onUnlink,\n  context,\n  nuclei,\n  experiment,\n}: ZonesTableProps) {\n  const contextRef = useRef<any>(null);\n\n  const contextMenuHandler = useCallback(\n    (e, rowData) => {\n      if (!checkModifierKeyActivated(e)) {\n        e.preventDefault();\n        contextRef.current.handleContextMenu(e, rowData);\n      }\n    },\n    [contextRef],\n  );\n\n  const data = useMemo(() => {\n    const _data: Array<any> = [];\n    tableData.forEach((zone, i) => {\n      if (zone.signals.length === 1) {\n        _data.push({\n          ...zone,\n          tableMetaInfo: {\n            ...zone.tableMetaInfo,\n            signal: zone.signals[0],\n            rowIndex: i,\n            signalIndex: 0,\n            id: zone.signals[0].id,\n            experiment,\n            nuclei,\n          },\n        });\n      } else if (zone.signals.length > 1) {\n        zone.signals.forEach((signal, j) => {\n          let hide = false;\n          let rowSpan: number | null = null;\n          if (j < zone.signals.length - 1) {\n            if (j === 0) {\n              rowSpan = zone.signals.length;\n            } else {\n              hide = true;\n            }\n          } else {\n            hide = true;\n          }\n          _data.push({\n            ...zone,\n            tableMetaInfo: {\n              ...zone.tableMetaInfo,\n              signal,\n              rowSpan,\n              hide,\n              rowIndex: i,\n              signalIndex: j,\n              id: signal.id,\n              experiment,\n            },\n          });\n        });\n      }\n    });\n\n    return _data;\n  }, [experiment, nuclei, tableData]);\n\n  const { items: sortedData, isSortedDesc, onSort } = useTableSortBy(data);\n\n  const rows = useMemo(\n    () =>\n      sortedData.map((rowData, index) => (\n        <ZonesTableRow\n          rowIndex={index}\n          key={`${rowData.tableMetaInfo.id}`}\n          rowData={rowData}\n          onUnlink={onUnlink}\n          onContextMenu={(e, rowData) => contextMenuHandler(e, rowData)}\n        />\n      )),\n    [contextMenuHandler, sortedData, onUnlink],\n  );\n\n  return (\n    <div>\n      <table css={tableStyle}>\n        <thead>\n          <tr>\n            <th rowSpan={2}>#</th>\n            <th colSpan={2}>δ (ppm)</th>\n            <th colSpan={2}>\n              <FaLink />\n            </th>\n            <th colSpan={2}>Σ</th>\n            <th rowSpan={2}>Kind</th>\n            <th rowSpan={2}>{''}</th>\n          </tr>\n          <tr>\n            <th id=\"tableMetaInfo.signal.x.delta\" {...onSort}>\n              <SurroundedText text=\"F2\">\n                {nuclei[0]}{' '}\n                {isSortedDesc('tableMetaInfo.signal.x.delta').content}\n              </SurroundedText>\n            </th>\n            <th id=\"tableMetaInfo.signal.y.delta\" {...onSort}>\n              <SurroundedText text=\"F1\">\n                {nuclei[1]}{' '}\n                {isSortedDesc('tableMetaInfo.signal.y.delta').content}\n              </SurroundedText>\n            </th>\n            <th>\n              <SurroundedText text=\"F2\">{nuclei[0]}</SurroundedText>\n            </th>\n            <th>\n              <SurroundedText text=\"F1\">{nuclei[1]}</SurroundedText>\n            </th>\n            <th>\n              <SurroundedText text=\"F2\">{nuclei[0]}</SurroundedText>\n            </th>\n            <th>\n              <SurroundedText text=\"F1\">{nuclei[1]}</SurroundedText>\n            </th>\n          </tr>\n        </thead>\n        <tbody>{rows}</tbody>\n      </table>\n      <ContextMenu ref={contextRef} context={context} />\n    </div>\n  );\n}\n\nfunction SurroundedText(props: { text: 'F1' | 'F2'; children: ReactNode }) {\n  return (\n    <>\n      <div\n        style={{\n          position: 'absolute',\n          fontSize: 8,\n          color: '#3539E6',\n        }}\n      >\n        {props.text}\n      </div>\n      <div style={{ marginLeft: 5 }}>{props.children}</div>\n    </>\n  );\n}\n\nexport default ZonesTable;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useState, useMemo, useCallback, useRef, memo } from 'react';\nimport { FaUnlink } from 'react-icons/fa';\n\nimport { Datum2D } from '../../../data/types/data2d';\nimport { useAssignmentData } from '../../assignment/AssignmentsContext';\nimport { useChartData } from '../../context/ChartContext';\nimport { useDispatch } from '../../context/DispatchContext';\nimport ToggleButton from '../../elements/ToggleButton';\nimport ToolTip from '../../elements/ToolTip/ToolTip';\nimport { useModal } from '../../elements/popup/Modal';\nimport useSpectrum from '../../hooks/useSpectrum';\nimport { DELETE_2D_ZONE, UNLINK_ZONE } from '../../reducer/types/Types';\nimport Events from '../../utility/Events';\nimport { tablePanelStyle } from '../extra/BasicPanelStyle';\nimport NoTableData from '../extra/placeholder/NoTableData';\nimport DefaultPanelHeader from '../header/DefaultPanelHeader';\nimport PreferencesHeader from '../header/PreferencesHeader';\n\nimport ZonesPreferences from './ZonesPreferences';\nimport ZonesTable from './ZonesTable';\n\nconst style = css`\n  .remove-assignments-btn {\n    border-radius: 5px;\n    margin-top: 3px;\n    margin-left: 2px;\n    border: none;\n    height: 16px;\n    width: 18px;\n    font-size: 12px;\n    padding: 0;\n    background-color: transparent;\n  }\n  .toggle {\n    width: 22px;\n    height: 22px;\n    margin-left: 2px;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n  }\n`;\n\nfunction ZonesPanelInner({ zones, activeTab, xDomain, yDomain, experiment }) {\n  const [filterIsActive, setFilterIsActive] = useState(false);\n\n  const assignmentData = useAssignmentData();\n\n  const dispatch = useDispatch();\n  const modal = useModal();\n  const [isFlipped, setFlipStatus] = useState(false);\n  const settingRef = useRef<any>();\n\n  const tableData = useMemo(() => {\n    const isInView = (xFrom, xTo, yFrom, yTo) => {\n      const factor = 10000;\n      xFrom = xFrom * factor;\n      xTo = xTo * factor;\n      yFrom = yFrom * factor;\n      yTo = yTo * factor;\n      return (\n        ((xTo >= xDomain[0] * factor && xFrom <= xDomain[1] * factor) ||\n          (xFrom <= xDomain[0] * factor && xTo >= xDomain[1] * factor)) &&\n        ((yTo >= yDomain[0] * factor && yFrom <= yDomain[1] * factor) ||\n          (yFrom <= yDomain[0] * factor && yTo >= yDomain[1] * factor))\n      );\n    };\n\n    const getFilteredZones = (zones) => {\n      return zones.filter((zone) => {\n        return isInView(zone.x.from, zone.x.to, zone.y.from, zone.y.to);\n      });\n    };\n    if (zones.values) {\n      const _zones = filterIsActive\n        ? getFilteredZones(zones.values)\n        : zones.values;\n\n      return _zones.map((zone) => {\n        return {\n          ...zone,\n          tableMetaInfo: {\n            isConstantlyHighlighted: isInView(\n              zone.x.from,\n              zone.x.to,\n              zone.y.from,\n              zone.y.to,\n            ),\n          },\n        };\n      });\n    }\n  }, [zones, filterIsActive, xDomain, yDomain]);\n\n  const handleOnFilter = useCallback(() => {\n    setFilterIsActive(!filterIsActive);\n  }, [filterIsActive]);\n\n  const unlinkZoneHandler = useCallback(\n    (\n      zoneData = null,\n      isOnZoneLevel = undefined,\n      signalIndex = -1,\n      axis = undefined,\n    ) => {\n      dispatch({\n        type: UNLINK_ZONE,\n        payload: {\n          zoneData,\n          assignmentData,\n          isOnZoneLevel,\n          signalIndex,\n          axis,\n        },\n      });\n    },\n    [assignmentData, dispatch],\n  );\n\n  const removeAssignments = useCallback(() => {\n    unlinkZoneHandler();\n  }, [unlinkZoneHandler]);\n\n  const handleOnRemoveAssignments = useCallback(() => {\n    modal.showConfirmDialog({\n      message: 'All assignments will be removed. Are you sure?',\n      buttons: [{ text: 'Yes', handler: removeAssignments }, { text: 'No' }],\n    });\n  }, [removeAssignments, modal]);\n\n  const handleDeleteAll = useCallback(() => {\n    modal.showConfirmDialog({\n      message: 'All zones will be deleted. Are You sure?',\n      buttons: [\n        {\n          text: 'Yes',\n          handler: () => {\n            dispatch({ type: DELETE_2D_ZONE, payload: { assignmentData } });\n          },\n        },\n        { text: 'No' },\n      ],\n    });\n  }, [assignmentData, dispatch, modal]);\n\n  const settingsPanelHandler = useCallback(() => {\n    setFlipStatus(!isFlipped);\n  }, [isFlipped]);\n\n  const saveSettingHandler = useCallback(() => {\n    settingRef.current.saveSetting();\n    setFlipStatus(false);\n  }, []);\n\n  const visibilityHandler = useCallback((key) => {\n    Events.emit('onZonesVisibilityChange', { key });\n  }, []);\n\n  return (\n    <>\n      <div\n        css={[\n          tablePanelStyle,\n          style,\n          isFlipped &&\n            css`\n              th {\n                position: relative;\n              }\n            `,\n        ]}\n      >\n        {!isFlipped && (\n          <DefaultPanelHeader\n            counter={zones.values ? zones.values.length : 0}\n            onDelete={handleDeleteAll}\n            deleteToolTip=\"Delete All Zones\"\n            onFilter={handleOnFilter}\n            filterToolTip={\n              filterIsActive ? 'Show all zones' : 'Hide zones out of view'\n            }\n            filterIsActive={filterIsActive}\n            counterFiltered={tableData?.length}\n            showSettingButton\n            onSettingClick={settingsPanelHandler}\n          >\n            <ToolTip title={`Remove all Assignments`} popupPlacement=\"right\">\n              <button\n                className=\"remove-assignments-btn\"\n                type=\"button\"\n                onClick={handleOnRemoveAssignments}\n                disabled={!zones.values || zones.values.length === 0}\n              >\n                <FaUnlink />\n              </button>\n            </ToolTip>\n            <ToggleButton\n              popupTitle=\"show/hide zones\"\n              popupPlacement=\"right\"\n              defaultValue\n              onClick={() => visibilityHandler('zones')}\n            >\n              <span style={{ fontSize: '12px', pointerEvents: 'none' }}>z</span>\n            </ToggleButton>\n            <ToggleButton\n              popupTitle=\"show/hide signals\"\n              popupPlacement=\"right\"\n              defaultValue\n              onClick={() => visibilityHandler('signals')}\n            >\n              <span style={{ fontSize: '12px', pointerEvents: 'none' }}>s</span>\n            </ToggleButton>\n            <ToggleButton\n              popupTitle=\"show/hide peaks\"\n              popupPlacement=\"right\"\n              defaultValue\n              onClick={() => visibilityHandler('peaks')}\n            >\n              <span style={{ fontSize: '12px', pointerEvents: 'none' }}>p</span>\n            </ToggleButton>\n          </DefaultPanelHeader>\n        )}\n        {isFlipped && (\n          <PreferencesHeader\n            onSave={saveSettingHandler}\n            onClose={settingsPanelHandler}\n          />\n        )}\n        <div className=\"inner-container\">\n          {!isFlipped ? (\n            <div className=\"table-container\">\n              {tableData && tableData.length > 0 ? (\n                <ZonesTable\n                  tableData={tableData}\n                  onUnlink={unlinkZoneHandler}\n                  nuclei={\n                    activeTab && activeTab.split(',').length === 2\n                      ? activeTab.split(',')\n                      : ['?', '?']\n                  }\n                  experiment={experiment}\n                />\n              ) : (\n                <NoTableData />\n              )}\n            </div>\n          ) : (\n            <ZonesPreferences ref={settingRef} />\n          )}\n        </div>\n      </div>\n    </>\n  );\n}\n\nconst MemoizedZonesPanel = memo(ZonesPanelInner);\n\nconst emptyData = { zones: {}, info: {} };\n\nexport default function ZonesPanel() {\n  const { displayerKey, xDomain, yDomain, activeTab } = useChartData();\n  const { zones, info } = useSpectrum(emptyData) as Datum2D;\n\n  return (\n    <MemoizedZonesPanel\n      {...{\n        xDomain,\n        yDomain,\n        activeTab,\n        displayerKey,\n        zones,\n        experiment: info.experiment,\n      }}\n    />\n  );\n}\n","import {\n  protonImpurities,\n  carbonImpurities,\n  Jcoupling,\n  DatabaseNMREntry,\n} from 'nmr-processing';\nimport { filter } from 'smart-array-filter';\n\nimport generateID from '../utilities/generateID';\n\nexport interface DataBaseSignal {\n  assignment: string;\n  delta: number;\n}\n\nexport interface DataBaseRange {\n  from: number;\n  to: number;\n  signals: Array<DataBaseSignal>;\n}\n\nexport type DataBase = {\n  label: string;\n  url?: string;\n  value?: Array<DatabaseNMREntry>;\n}[];\n\nexport const databases: DataBase = [\n  {\n    label: 'Solvent database',\n    value: prepareDataBase([...protonImpurities, ...carbonImpurities]),\n  },\n];\n\nexport interface InitiateDatabaseResult {\n  data: DatabaseNMREntry[];\n  getSolvents: () => string[];\n  search: (keywords?: string | string[]) => DatabaseNMREntry[];\n}\n\nexport function initiateDatabase(\n  databases: DatabaseNMREntry[],\n  nucleus: string,\n): InitiateDatabaseResult {\n  const data = databases.filter((datum) => datum.nucleus === nucleus);\n\n  const getSolvents = () => prepareGetSolvents(data);\n  const search = (keywords: string | string[] = []) =>\n    filter(data, { keywords });\n\n  return { data, getSolvents, search };\n}\n\nfunction prepareGetSolvents(data) {\n  const result: string[] = [];\n  const map = new Map();\n  for (const item of data) {\n    if (!map.has(item.solvent)) {\n      map.set(item.solvent, true);\n      result.push(item.solvent);\n    }\n  }\n  return result;\n}\n\n// export function getDatabasesNames() {\n//   return databases.map((database, index) => {\n//     const { label } = database;\n//     return { id: index, name: label };\n//   });\n// }\n\nfunction prepareDataBase(array: Array<DatabaseNMREntry>) {\n  return array.map((item) => {\n    item.ranges = item.ranges.map((range) => ({\n      id: generateID(),\n      ...range,\n    }));\n    return item;\n  }, []);\n}\n\nexport type PrepareDataResult = Partial<\n  DataBaseRange | DataBaseSignal | Jcoupling\n>;\n\nexport function prepareData(\n  data: Array<DatabaseNMREntry>,\n): PrepareDataResult[] {\n  const result: PrepareDataResult[] = [];\n  let index = 0;\n  for (const item of data) {\n    let ids: string[] = [];\n    const { ranges = [], ...restItemKeys } = item;\n\n    for (const range of ranges) {\n      ids.push(range.id || generateID());\n      const { signals = [], ...restRangKeys } = range;\n      for (const signal of signals) {\n        const { js = [], ...restSignalKeys } = signal;\n        const jsResult = mapJs(js);\n\n        const data = {\n          ...restItemKeys,\n          ...restRangKeys,\n          ...restSignalKeys,\n          ...jsResult,\n          index,\n          id: ids,\n          ranges,\n        };\n        result.push(data);\n      }\n    }\n    index++;\n  }\n  return result;\n}\n\nfunction mapJs(js: Jcoupling[]) {\n  if (js && js.length > 0) {\n    const { coupling, multiplicity } = js.reduce<any>(\n      (acc, { coupling, multiplicity }) => {\n        acc.coupling.push(coupling.toFixed(1));\n        acc.multiplicity += multiplicity;\n        return acc;\n      },\n      { coupling: [], multiplicity: '' },\n    );\n    return { multiplicity, coupling: coupling.join(',') };\n  } else {\n    return { multiplicity: 's', coupling: '' };\n  }\n}\n","import {\n  useEffect,\n  useCallback,\n  useImperativeHandle,\n  useRef,\n  CSSProperties,\n  forwardRef,\n} from 'react';\n\nimport { usePreferences } from '../../context/PreferencesContext';\nimport FormikColumnFormatField from '../../elements/formik/FormikColumnFormatField';\nimport FormikForm from '../../elements/formik/FormikForm';\nimport { useAlert } from '../../elements/popup/Alert';\nimport { getValue as getValueByKeyPath } from '../../utility/LocalStorage';\nimport { databaseDefaultValues } from '../extra/preferences/defaultValues';\n\nconst styles: Record<\n  | 'container'\n  | 'groupContainer'\n  | 'header'\n  | 'inputContainer'\n  | 'input'\n  | 'inputLabel',\n  CSSProperties\n> = {\n  container: {\n    padding: 10,\n    backgroundColor: '#f1f1f1',\n    height: '100%',\n    overflowY: 'auto',\n  },\n  groupContainer: {\n    padding: '5px',\n    borderRadius: '5px',\n    margin: '10px 0px',\n    backgroundColor: 'white',\n  },\n\n  header: {\n    borderBottom: '1px solid #e8e8e8',\n    paddingBottom: '5px',\n    fontWeight: 'bold',\n    color: '#4a4a4a',\n  },\n  inputContainer: {\n    flex: 4,\n    borderRadius: '5px',\n  },\n  inputLabel: {\n    flex: 2,\n    fontSize: '11px',\n    fontWeight: 'bold',\n    color: '#232323',\n  },\n  input: {\n    width: '100px',\n  },\n};\n\nfunction DatabasePreferences(props, ref) {\n  const preferences = usePreferences();\n  const alert = useAlert();\n\n  const formRef = useRef<any>();\n\n  const updateValues = useCallback(() => {\n    const databasePreferences = getValueByKeyPath(\n      preferences.current,\n      `formatting.panels.database`,\n    );\n\n    formRef.current.setValues(\n      databasePreferences ? databasePreferences : databaseDefaultValues,\n    );\n  }, [preferences]);\n\n  useEffect(() => {\n    updateValues();\n  }, [updateValues]);\n\n  const saveHandler = useCallback(\n    (values) => {\n      preferences.dispatch({\n        type: 'SET_PANELS_PREFERENCES',\n        payload: { key: 'database', value: values },\n      });\n      alert.success('database preferences saved successfully');\n    },\n    [alert, preferences],\n  );\n\n  useImperativeHandle(ref, () => ({\n    saveSetting: () => {\n      formRef.current.submitForm();\n    },\n  }));\n\n  return (\n    <div style={styles.container}>\n      <FormikForm onSubmit={saveHandler} ref={formRef}>\n        <div style={styles.groupContainer}>\n          <FormikColumnFormatField\n            label=\"structure\"\n            checkControllerName=\"showSmiles\"\n            hideFormat\n          />\n          <FormikColumnFormatField\n            label=\"Solvent\"\n            checkControllerName=\"showSolvent\"\n            hideFormat\n          />\n          <FormikColumnFormatField\n            label=\"Names\"\n            checkControllerName=\"showNames\"\n            hideFormat\n          />\n          <FormikColumnFormatField\n            label=\"Range\"\n            checkControllerName=\"showRange\"\n            hideFormat\n          />\n          <FormikColumnFormatField\n            label=\"δ (ppm)\"\n            checkControllerName=\"showDelta\"\n            hideFormat\n          />\n          <FormikColumnFormatField\n            label=\"Assignment\"\n            checkControllerName=\"showAssignment\"\n            hideFormat\n          />\n          <FormikColumnFormatField\n            label=\"J (Hz)\"\n            checkControllerName=\"showCoupling\"\n            hideFormat\n          />\n          <FormikColumnFormatField\n            label=\"Multiplicity\"\n            checkControllerName=\"showMultiplicity\"\n            hideFormat\n          />\n        </div>\n      </FormikForm>\n    </div>\n  );\n}\n\nexport default forwardRef(DatabasePreferences);\n","/** @jsxImportSource @emotion/react */\nimport { useMemo, memo, CSSProperties } from 'react';\nimport { ResponsiveChart } from 'react-d3-utils';\nimport { FaPlus } from 'react-icons/fa';\nimport { IdcodeSvgRenderer, SmilesSvgRenderer } from 'react-ocl/full';\n\nimport { usePreferences } from '../../context/PreferencesContext';\nimport ReactTable from '../../elements/ReactTable/ReactTable';\nimport addCustomColumn, {\n  CustomColumn,\n} from '../../elements/ReactTable/utility/addCustomColumn';\nimport { HighlightedSource } from '../../highlight';\nimport { getValue } from '../../utility/LocalStorage';\nimport { databaseDefaultValues } from '../extra/preferences/defaultValues';\n\ninterface DatabaseTableProps {\n  data: any;\n  onAdd: (row: any) => void;\n}\n\nconst overFlowStyle: CSSProperties = {\n  overflow: 'hidden',\n  whiteSpace: 'nowrap',\n  textOverflow: 'ellipsis',\n};\n\nconst COLUMNS: (CustomColumn & { showWhen: string })[] = [\n  {\n    showWhen: 'showNames',\n    index: 1,\n    Header: 'names',\n    accessor: (row) => (row.names ? row.names.join(',') : ''),\n    enableRowSpan: true,\n    style: {\n      width: '100px',\n      minWidth: '100px',\n      maxWidth: '100px',\n      ...overFlowStyle,\n    },\n  },\n  {\n    showWhen: 'showRange',\n    index: 2,\n    Header: 'From - To',\n    accessor: (row) => `${row.from.toFixed(2)} - ${row.to.toFixed(2)}`,\n    enableRowSpan: true,\n  },\n  {\n    showWhen: 'showDelta',\n    index: 3,\n    Header: 'δ (ppm)',\n    accessor: 'delta',\n  },\n  {\n    showWhen: 'showAssignment',\n    index: 4,\n    Header: 'Assignment',\n    accessor: 'assignment',\n  },\n  {\n    showWhen: 'showMultiplicity',\n    index: 5,\n    Header: 'Multi.',\n    accessor: 'multiplicity',\n  },\n  {\n    showWhen: 'showCoupling',\n    index: 6,\n    Header: 'J (Hz)',\n    accessor: 'coupling',\n    style: {\n      width: '60px',\n      minWidth: '60px',\n      ...overFlowStyle,\n    },\n  },\n  {\n    showWhen: 'showSolvent',\n    index: 7,\n    Header: 'Solvent',\n    accessor: 'solvent',\n    style: {\n      width: '80px',\n      minWidth: '80px',\n      ...overFlowStyle,\n    },\n  },\n  {\n    showWhen: 'showSmiles',\n    index: 8,\n    Header: 'structure',\n    accessor: 'index',\n    style: { height: 0 },\n    enableRowSpan: true,\n    Cell: ({ row }) => {\n      const { idCode, coordinates } = row.original?.ocl || {};\n      const smiles = row.original?.smiles;\n      return (\n        <ResponsiveChart>\n          {({ width, height }) => {\n            if (idCode && coordinates) {\n              return (\n                <IdcodeSvgRenderer\n                  height={height}\n                  width={width}\n                  idcode={idCode}\n                  coordinates={coordinates}\n                />\n              );\n            } else if (smiles) {\n              return (\n                <SmilesSvgRenderer\n                  height={height}\n                  width={width}\n                  smiles={smiles}\n                />\n              );\n            } else {\n              return null;\n            }\n          }}\n        </ResponsiveChart>\n      );\n    },\n  },\n];\n\nfunction DatabaseTable({ data, onAdd }: DatabaseTableProps) {\n  const preferences = usePreferences();\n\n  const initialColumns = useMemo(\n    () => [\n      {\n        index: 10,\n        Header: '',\n        width: '1%',\n        maxWidth: '24px',\n        minWidth: '24px',\n        id: 'add-button',\n        accessor: 'index',\n        enableRowSpan: true,\n        Cell: ({ row }) => (\n          <button\n            type=\"button\"\n            className=\"add-button\"\n            onClick={() => onAdd(row)}\n          >\n            <FaPlus />\n          </button>\n        ),\n      },\n    ],\n    [onAdd],\n  );\n\n  const tableColumns = useMemo(() => {\n    const databasePreferences = getValue(\n      preferences.current,\n      'formatting.panels.database',\n      databaseDefaultValues,\n    );\n\n    let columns = [...initialColumns];\n    for (const col of COLUMNS) {\n      const { showWhen, ...colParams } = col;\n      if (databasePreferences[showWhen]) {\n        addCustomColumn(columns, colParams);\n      }\n    }\n\n    return columns.sort((object1, object2) => object1.index - object2.index);\n  }, [initialColumns, preferences]);\n  return (\n    <ReactTable\n      data={data}\n      columns={tableColumns}\n      highlightedSource={HighlightedSource.DATABASE}\n      groupKey=\"index\"\n      approxItemHeight={30}\n      enableVirtualScroll\n    />\n  );\n}\n\nexport default memo(DatabaseTable);\n","import { useMemo } from 'react';\n\nimport { databases } from '../../../data/data1d/database';\nimport { usePreferences } from '../../context/PreferencesContext';\n\nexport function useDatabases() {\n  const { current } = usePreferences();\n\n  return useMemo(() => {\n    const data = current.databases || [];\n    return databases.concat(data.filter((datum) => datum.enabled));\n  }, [current.databases]);\n}\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { DatabaseNMREntry } from 'nmr-processing';\nimport { useCallback, useState, useRef, memo, useEffect, useMemo } from 'react';\nimport { FaICursor } from 'react-icons/fa';\nimport { IoSearchOutline } from 'react-icons/io5';\n\nimport {\n  initiateDatabase,\n  InitiateDatabaseResult,\n  prepareData,\n} from '../../../data/data1d/database';\nimport { useChartData } from '../../context/ChartContext';\nimport { useDispatch } from '../../context/DispatchContext';\nimport Input from '../../elements/Input';\nimport Select, { SelectEntry } from '../../elements/Select';\nimport ToggleButton from '../../elements/ToggleButton';\nimport { useAlert } from '../../elements/popup/Alert';\nimport useToolsFunctions from '../../hooks/useToolsFunctions';\nimport { RESURRECTING_SPECTRUM_FROM_RANGES } from '../../reducer/types/Types';\nimport { options } from '../../toolbar/ToolTypes';\nimport Events from '../../utility/Events';\nimport { useFormatNumberByNucleus } from '../../utility/FormatNumber';\nimport { tablePanelStyle } from '../extra/BasicPanelStyle';\nimport NoTableData from '../extra/placeholder/NoTableData';\nimport DefaultPanelHeader from '../header/DefaultPanelHeader';\nimport PreferencesHeader from '../header/PreferencesHeader';\n\nimport DatabasePreferences from './DatabasePreferences';\nimport DatabaseTable from './DatabaseTable';\nimport { useDatabases } from './useDatabases';\n\nconst style = css`\n  .header {\n    height: 30px;\n    padding: 2px 0px 2px 5px;\n  }\n  .input-container {\n    width: 100%;\n  }\n  .search-input {\n    width: 100% !important;\n    border-radius: 5px;\n    border: 0.55px solid gray;\n    padding: 0 5px;\n    outline: none;\n  }\n`;\n\nexport interface DatabaseInnerProps {\n  nucleus: string;\n  selectedTool: string;\n}\n\ninterface ResultEntry {\n  data: DatabaseNMREntry[];\n  databases: SelectEntry[];\n  solvents: SelectEntry[];\n}\n\nconst emptyKeywords = {\n  solvent: '',\n  searchKeywords: '',\n};\n\nfunction DatabasePanelInner({ nucleus, selectedTool }: DatabaseInnerProps) {\n  const dispatch = useDispatch();\n  const alert = useAlert();\n  const { handleChangeOption } = useToolsFunctions();\n  const format = useFormatNumberByNucleus(nucleus);\n  const databases = useDatabases();\n  const [isFlipped, setFlipStatus] = useState(false);\n  const settingRef = useRef<any>();\n  const [keywords, setKeywords] = useState<{\n    solvent: string;\n    searchKeywords: string;\n  }>(emptyKeywords);\n  const databaseInstance = useRef<InitiateDatabaseResult | null>(null);\n  const [result, setResult] = useState<ResultEntry>({\n    data: [],\n    databases: [],\n    solvents: [],\n  });\n\n  const settingsPanelHandler = useCallback(() => {\n    setFlipStatus(!isFlipped);\n  }, [isFlipped]);\n\n  const saveSettingHandler = useCallback(() => {\n    settingRef.current.saveSetting();\n    setFlipStatus(false);\n  }, []);\n\n  const handleSearch = useCallback((input) => {\n    if (typeof input === 'string' || input === -1) {\n      const solvent = String(input);\n      setKeywords((prevState) => ({ ...prevState, solvent }));\n    } else {\n      setKeywords((prevState) => ({\n        ...prevState,\n        searchKeywords: input.target.value,\n      }));\n    }\n  }, []);\n\n  useEffect(() => {\n    const { solvent, searchKeywords } = keywords;\n    setTimeout(() => {\n      if (databaseInstance.current) {\n        if (!solvent && !searchKeywords) {\n          const data = databaseInstance.current.data;\n          const solvents = mapSolventsToSelect(\n            databaseInstance.current.getSolvents(),\n          );\n          setResult((prevResult) => ({ ...prevResult, data, solvents }));\n        } else {\n          const values = [...searchKeywords.split(' ')];\n          if (solvent !== '-1') {\n            values.unshift(`solvent:${solvent}`);\n          }\n\n          const data = databaseInstance.current.search(values.join(' '));\n          setResult((prevResult) => ({ ...prevResult, data }));\n        }\n      }\n    });\n  }, [keywords]);\n\n  useEffect(() => {\n    function handle(event) {\n      if (selectedTool === options.databaseRangesSelection.id) {\n        setKeywords((prevState) => {\n          const oldKeywords = prevState.searchKeywords\n            ? prevState.searchKeywords.split(' ')\n            : [];\n          const [from, to] = event.range;\n          const searchKeywords = [\n            ...oldKeywords,\n            `delta:${format(from)}..${format(to)}`,\n          ].join(' ');\n          return { ...prevState, searchKeywords };\n        });\n      }\n    }\n\n    Events.on('brushEnd', handle);\n\n    return () => {\n      Events.off('brushEnd', handle);\n    };\n  }, [format, selectedTool]);\n\n  const handleChangeDatabase = useCallback(\n    (databaseIndex) => {\n      void (async () => {\n        let _database: DatabaseNMREntry[] = [];\n        const { url, label, value } = databases[databaseIndex];\n        if (url) {\n          const hideLoading = await alert.showLoading(`load ${label} database`);\n\n          try {\n            _database = await fetch(url).then((response) => response.json());\n          } catch (e) {\n            alert.error(`Failed to load ${url}`);\n          } finally {\n            hideLoading();\n          }\n        } else {\n          _database = value as DatabaseNMREntry[];\n        }\n        databaseInstance.current = initiateDatabase(_database, nucleus);\n        setKeywords({ ...emptyKeywords });\n      })();\n    },\n    [alert, databases, nucleus],\n  );\n\n  const tableData = useMemo(() => {\n    return prepareData(result.data);\n  }, [result.data]);\n\n  const resurrectHandler = useCallback(\n    (row) => {\n      const { index } = row.original;\n      const { ranges, solvent, names = [] } = result.data[index];\n      dispatch({\n        type: RESURRECTING_SPECTRUM_FROM_RANGES,\n        payload: { ranges, info: { solvent, nucleus, name: names[0] } },\n      });\n    },\n    [dispatch, nucleus, result.data],\n  );\n\n  const clearHandler = useCallback(() => {\n    setKeywords((prevState) => ({ ...prevState, searchKeywords: '' }));\n  }, []);\n\n  const enableFilterHandler = useCallback(\n    (flag) => {\n      const tool = !flag ? options.zoom.id : options.databaseRangesSelection.id;\n      handleChangeOption(tool);\n    },\n    [handleChangeOption],\n  );\n\n  return (\n    <div\n      css={[\n        tablePanelStyle,\n        style,\n        isFlipped &&\n          css`\n            .table-container {\n              table,\n              th {\n                position: relative !important;\n              }\n            }\n          `,\n      ]}\n    >\n      {!isFlipped && (\n        <DefaultPanelHeader\n          showSettingButton\n          onSettingClick={settingsPanelHandler}\n          canDelete={false}\n          className=\"header\"\n        >\n          <ToggleButton\n            key={`${selectedTool}`}\n            defaultValue={selectedTool === options.databaseRangesSelection.id}\n            popupTitle=\"Filter by select ranges\"\n            popupPlacement=\"right\"\n            onClick={enableFilterHandler}\n          >\n            <FaICursor\n              style={{\n                pointerEvents: 'none',\n                fontSize: '12px',\n                transform: 'rotate(90deg)',\n              }}\n            />\n          </ToggleButton>\n          <Select\n            style={{ flex: 2 }}\n            data={mapDatabasesToSelect(databases)}\n            onChange={handleChangeDatabase}\n            placeholder=\"Select database\"\n          />\n          <Select\n            style={{ flex: 1 }}\n            data={result.solvents}\n            placeholder=\"Solvent\"\n            onChange={handleSearch}\n          />\n          <Input\n            value={keywords.searchKeywords}\n            renderIcon={() => <IoSearchOutline />}\n            style={{ inputWrapper: { flex: 3 } }}\n            className=\"search-input\"\n            type=\"text\"\n            debounceTime={250}\n            placeholder=\"Search for parameter...\"\n            onChange={handleSearch}\n            onClear={clearHandler}\n            canClear\n          />\n        </DefaultPanelHeader>\n      )}\n      {isFlipped && (\n        <PreferencesHeader\n          onSave={saveSettingHandler}\n          onClose={settingsPanelHandler}\n        />\n      )}\n      <div className=\"inner-container\">\n        {!isFlipped ? (\n          tableData && tableData.length > 0 ? (\n            <DatabaseTable data={tableData} onAdd={resurrectHandler} />\n          ) : (\n            <NoTableData\n              text={\n                databases && databases.length > 0\n                  ? 'Please select a database'\n                  : 'Please add databases URL in the general preferences'\n              }\n            />\n          )\n        ) : (\n          <DatabasePreferences ref={settingRef} />\n        )}\n      </div>\n    </div>\n  );\n}\n\nconst MemoizedDatabasePanel = memo(DatabasePanelInner);\n\nexport default function PeaksPanel() {\n  const {\n    activeTab,\n    toolOptions: { selectedTool },\n  } = useChartData();\n  if (!activeTab) return <div />;\n  return (\n    <MemoizedDatabasePanel nucleus={activeTab} selectedTool={selectedTool} />\n  );\n}\n\nfunction mapSolventsToSelect(solvents: string[]) {\n  const result = solvents.map((key) => {\n    return {\n      key,\n      label: key,\n      value: key,\n    };\n  }, []);\n  result.unshift({ key: '-1', label: 'All', value: '-1' });\n  return result;\n}\n\nfunction mapDatabasesToSelect(databases) {\n  return databases.map(({ label }, index) => ({\n    key: index,\n    value: index,\n    label,\n  }));\n}\n","import { CSSProperties, memo, ReactNode } from 'react';\n\nconst styles: CSSProperties = {\n  width: '100%',\n  height: '100%',\n  padding: '0px',\n  display: 'flex',\n  flexDirection: 'column',\n};\n\ninterface TableProps {\n  children: ReactNode;\n  className?: string;\n  style?: CSSProperties;\n  testID?: string;\n}\n\nfunction Table({ children, className, style, testID }: TableProps) {\n  return (\n    <div\n      className={className}\n      style={{ ...styles, ...style }}\n      data-test-id={testID}\n    >\n      {children}\n    </div>\n  );\n}\n\nexport default memo(Table);\n","import {\n  useMemo,\n  memo,\n  Children,\n  cloneElement,\n  ReactNode,\n  CSSProperties,\n} from 'react';\n\nconst styles: CSSProperties = {\n  width: '100%',\n  overflowY: 'auto',\n  display: 'flex',\n  flexDirection: 'column',\n  padding: '5px 0px',\n  color: 'gray',\n};\n\ninterface TableBodyProps {\n  children: ReactNode;\n  className?: string;\n  style?: CSSProperties;\n}\n\nfunction TableBody({ children, className, style }: TableBodyProps) {\n  const mappedChildren = useMemo(() => {\n    return Children.map(children, (child: any) =>\n      cloneElement(child, {\n        style: { borderBottom: '0.55px solid #d8d8d8', ...child.props.style },\n      }),\n    );\n  }, [children]);\n\n  return (\n    <div className={className} style={{ ...styles, ...style }}>\n      {mappedChildren}\n    </div>\n  );\n}\n\nexport default memo(TableBody);\n","import { CSSProperties, memo, ReactNode } from 'react';\n\nconst styles = {\n  width: '100%',\n  display: 'flex',\n  alignItems: 'flex-start',\n};\n\nfunction getVAlign(align) {\n  if (align.toLowerCase() === 'top') {\n    return 'flex-start';\n  } else if (align.toLowerCase() === 'bottom') {\n    return 'flex-end';\n  }\n  return 'center';\n}\n\ninterface TableHeaderProps {\n  className?: string;\n  style?: CSSProperties;\n  children: ReactNode;\n  align?: CSSProperties['textAlign'];\n  vAlign?: 'center' | 'top' | 'bottom';\n  size?: number;\n  onClick?: () => void;\n}\n\nfunction TableHeader({\n  children,\n  className,\n  style,\n  align = 'center',\n  vAlign = 'center',\n  size = 1,\n  onClick = () => null,\n}: TableHeaderProps) {\n  return (\n    <div\n      className={className}\n      style={{\n        ...styles,\n        alignItems: getVAlign(vAlign),\n        textAlign: align,\n        flex: size,\n        ...style,\n      }}\n      onClick={onClick}\n    >\n      {children}\n    </div>\n  );\n}\n\nexport default memo(TableHeader);\n","import { CSSProperties, memo, ReactNode } from 'react';\n\nconst styles: CSSProperties = {\n  width: '100%',\n  display: 'flex',\n  padding: '0px 5px',\n  color: '#424242',\n  backgroundColor: '#d8d8d8',\n  borderBottom: '0.55px solid #d8d8d8',\n  fontSize: 11,\n  fontWeight: 'bold',\n};\n\ninterface TableHeadProps {\n  children: ReactNode;\n  className?: string;\n  style?: CSSProperties;\n}\n\nfunction TableHead({ children, className, style }: TableHeadProps) {\n  return (\n    <div className={className} style={{ ...styles, ...style }}>\n      {children}\n    </div>\n  );\n}\n\nexport default memo(TableHead);\n","import { CSSProperties, memo, ReactNode } from 'react';\n\nconst styles = {\n  width: '100%',\n  display: 'flex',\n  padding: '5px 0px',\n};\n\ninterface TableHeaderProps {\n  children: ReactNode;\n  className?: string;\n  style?: CSSProperties;\n  onClick?: () => void;\n}\n\nfunction TableHeader({\n  children,\n  className,\n  style,\n  onClick = () => null,\n}: TableHeaderProps) {\n  return (\n    <div\n      className={className}\n      style={{ ...styles, ...style }}\n      onClick={onClick}\n    >\n      {children}\n    </div>\n  );\n}\n\nexport default memo(TableHeader);\n","import { useMemo, useCallback, memo, useRef } from 'react';\nimport { FaRegTrashAlt } from 'react-icons/fa';\nimport { ObjectInspector } from 'react-inspector';\n\nimport { useChartData } from '../../context/ChartContext';\nimport { useDispatch } from '../../context/DispatchContext';\nimport CheckBox from '../../elements/CheckBox';\nimport TableCell from '../../elements/Table/TableCell';\nimport TableRow from '../../elements/Table/TableRow';\nimport { useAlert } from '../../elements/popup/Alert';\nimport { useModal } from '../../elements/popup/Modal';\nimport useSpectraByActiveNucleus from '../../hooks/useSpectraPerNucleus';\nimport useSpectrum from '../../hooks/useSpectrum';\nimport {\n  ENABLE_FILTER,\n  DELETE_FILTER,\n  SET_FILTER_SNAPSHOT,\n  DELETE_SPECTRA_FILTER,\n} from '../../reducer/types/Types';\n\nimport { FiltersProps } from './FilterPanel';\n\ninterface FiltersTableInnerProps {\n  filters: Array<FiltersProps>;\n  spectraCounter: number;\n  selectedTool: string | null;\n  activeFilterID: string | null;\n}\n\nfunction FiltersTableInner({\n  filters,\n  spectraCounter,\n  selectedTool,\n  activeFilterID,\n}: FiltersTableInnerProps) {\n  const dispatch = useDispatch();\n  const modal = useModal();\n  const alert = useAlert();\n  const selectedFilterRef = useRef<{ index: string | number | null }>({\n    index: null,\n  });\n\n  const handelFilterCheck = useCallback(\n    (id, checked) => {\n      void (async () => {\n        const hideLoading = await alert.showLoading(\n          `${checked ? 'Enable' : 'Disable'} filter in progress`,\n        );\n        setTimeout(() => {\n          dispatch({ type: ENABLE_FILTER, id, checked });\n          hideLoading();\n        }, 0);\n      })();\n    },\n    [alert, dispatch],\n  );\n  const handelDeleteFilter = useCallback(\n    ({ id, name }) => {\n      const buttons = [\n        {\n          text: 'Yes',\n          handler: async () => {\n            const hideLoading = await alert.showLoading(\n              'Delete filter process in progress',\n            );\n            dispatch({ type: DELETE_FILTER, payload: { id } });\n            hideLoading();\n          },\n        },\n        { text: 'No' },\n      ];\n\n      if (spectraCounter > 1) {\n        buttons.unshift({\n          text: 'Yes, for all spectra',\n          handler: async () => {\n            const hideLoading = await alert.showLoading(\n              'Delete all spectra filter process in progress',\n            );\n            dispatch({\n              type: DELETE_SPECTRA_FILTER,\n              payload: { filterType: name },\n            });\n            hideLoading();\n          },\n        });\n      }\n\n      modal.showConfirmDialog({\n        message: 'Are you sure you want to delete the spectrum?',\n        buttons,\n      });\n    },\n    [alert, dispatch, modal, spectraCounter],\n  );\n  const filterSnapShotHandler = useCallback(\n    (newID) => {\n      void (async () => {\n        const hideLoading = await alert.showLoading(\n          'Filter snapshot process in progress',\n        );\n        setTimeout(() => {\n          dispatch({ type: SET_FILTER_SNAPSHOT, id: newID });\n          hideLoading();\n        }, 0);\n      })();\n    },\n    [alert, dispatch],\n  );\n\n  const getStyle = useCallback(\n    (filter, index) => {\n      const { id, name } = filter;\n\n      if (activeFilterID && activeFilterID === id) {\n        selectedFilterRef.current.index = index;\n      } else if (!activeFilterID) {\n        selectedFilterRef.current.index = null;\n      }\n\n      const classes: string[] = ['filter-row'];\n      if (activeFilterID === id) {\n        classes.push('filter-active');\n      } else if (selectedTool === name) {\n        classes.push('filter-current');\n      } else if (\n        selectedFilterRef.current.index != null &&\n        index > selectedFilterRef.current.index\n      ) {\n        classes.push('filter-deactive');\n      }\n\n      return classes.join(' ');\n    },\n    [activeFilterID, selectedTool],\n  );\n\n  const filtersTableRow = useMemo(() => {\n    return filters?.map((d, index) => {\n      return (\n        <TableRow key={d.id} className={getStyle(d, index)}>\n          <TableCell\n            align=\"center\"\n            size={2}\n            onClick={() => filterSnapShotHandler(d.id)}\n          >\n            {d.label}\n          </TableCell>\n          <TableCell align=\"left\" size={3}>\n            <div onClick={(e) => e.stopPropagation()}>\n              <ObjectInspector data={d.error ? d.error : d.value} />\n            </div>\n          </TableCell>\n          <TableCell align=\"center\" vAlign=\"center\" size={1}>\n            <CheckBox\n              checked={d.flag}\n              onChange={(event) =>\n                handelFilterCheck(d.id, event.target.checked)\n              }\n            />\n            {d.isDeleteAllow && (\n              <button\n                className=\"btn\"\n                type=\"button\"\n                onClick={() => handelDeleteFilter(d)}\n              >\n                <FaRegTrashAlt />\n              </button>\n            )}\n          </TableCell>\n        </TableRow>\n      );\n    });\n  }, [\n    filterSnapShotHandler,\n    filters,\n    getStyle,\n    handelDeleteFilter,\n    handelFilterCheck,\n  ]);\n\n  return <>{filtersTableRow}</>;\n}\n\nconst emptyData = { filters: [] };\n\nconst MemoizedFiltersTable = memo(FiltersTableInner);\n\nexport default function FilterTable() {\n  const {\n    toolOptions: {\n      selectedTool,\n      data: { activeFilterID },\n    },\n  } = useChartData();\n  const { filters } = useSpectrum(emptyData);\n  const spectraCounter = useSpectraByActiveNucleus().length;\n\n  return (\n    <MemoizedFiltersTable\n      {...{ selectedTool, filters, spectraCounter, activeFilterID }}\n    />\n  );\n}\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useMemo, memo } from 'react';\n\nimport { Filter } from '../../../data/FiltersManager';\nimport Table from '../../elements/Table/Table';\nimport TableBody from '../../elements/Table/TableBody';\nimport TableCell from '../../elements/Table/TableCell';\nimport TableHead from '../../elements/Table/TableHead';\nimport TableRow from '../../elements/Table/TableRow';\nimport useSpectrum from '../../hooks/useSpectrum';\nimport NoTableData from '../extra/placeholder/NoTableData';\n\nimport FiltersTable from './FiltersTable';\n\nconst styles = css`\n  .btn {\n    background-color: transparent;\n    border: none;\n    height: 25;\n    width: 25;\n    padding: 5px;\n  }\n  .filter-row {\n    padding: 5px !important;\n  }\n  .filter-active {\n    background-color: #f7f7f7;\n    div,\n    span,\n    .btn {\n      color: black !important;\n    }\n\n    li {\n      background-color: transparent !important;\n    }\n  }\n  .filter-current {\n    background-color: #707070;\n    div,\n    span,\n    .btn {\n      color: white !important;\n    }\n\n    li {\n      background-color: transparent !important;\n    }\n  }\n\n  .filter-deactive {\n    opacity: 0.3;\n  }\n`;\n\nexport interface FiltersProps extends Filter {\n  error?: any;\n}\n\ninterface FiltersPanelInnerProps {\n  filters: Array<FiltersProps>;\n}\n\nfunction FilterPanelInner({ filters }: FiltersPanelInnerProps) {\n  const filtersTable = useMemo(() => {\n    return filters ? (\n      <Table testID=\"filters-table\">\n        <TableHead>\n          <TableRow>\n            <TableCell align=\"center\" size={1}>\n              Label\n            </TableCell>\n            <TableCell align=\"center\" size={2}>\n              Properties\n            </TableCell>\n          </TableRow>\n        </TableHead>\n        <TableBody css={styles}>\n          <FiltersTable />\n        </TableBody>\n      </Table>\n    ) : (\n      <NoTableData />\n    );\n  }, [filters]);\n\n  return filtersTable;\n}\n\nconst emptyData = { filters: [] };\n\nconst MemoizedFilterPanel = memo(FilterPanelInner);\n\nexport default function FilterPanel() {\n  const { filters } = useSpectrum(emptyData);\n\n  return <MemoizedFilterPanel filters={filters} />;\n}\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback, useRef } from 'react';\nimport * as Yup from 'yup';\n\nimport {\n  PredictionOptions as PredictionOptionsInterface,\n  defaultPredictionOptions,\n  FREQUENCIES,\n} from '../../../data/PredictionManager';\nimport Button from '../../elements/Button';\nimport IsotopesViewer from '../../elements/IsotopesViewer';\nimport Label from '../../elements/Label';\nimport FormikErrorsSummary from '../../elements/formik/FormikErrorsSummary';\nimport FormikForm from '../../elements/formik/FormikForm';\nimport FormikInput from '../../elements/formik/FormikInput';\nimport FormikSelect from '../../elements/formik/FormikSelect';\n\nconst styles = css`\n  padding: 10px;\n  border-top: solid #f2f2f2 1px;\n\n  .row {\n    flex: row;\n    display: flex;\n    padding-bottom: 10px;\n  }\n\n  .inner-content {\n    flex: 1;\n  }\n\n  .custom-label {\n    width: 160px;\n  }\n\n  .footer-container {\n    display: flex;\n    flex-direction: row-reverse;\n    align-items: flex-end;\n  }\n\n  .input {\n    font-size: 14px;\n    border-radius: 5px;\n    border: 1px solid #cccccc;\n    padding: 5px;\n    width: 100px;\n    margin-right: 10px;\n    height: initial !important;\n  }\n`;\n\nconst predictionFormValidation = Yup.object().shape({\n  frequency: Yup.number().integer().required().label('Frequency'),\n  '1d': Yup.object({\n    '1H': Yup.object({\n      from: Yup.number().integer().required().label(\"1H ' From ' \"),\n      to: Yup.number().integer().required().label(\"1H ' To ' \"),\n    }),\n    '13C': Yup.object().shape({\n      from: Yup.number().integer().required().label(\"13C ' From ' \"),\n      to: Yup.number().integer().required().label(\"13C ' To ' \"),\n    }),\n    lineWidth: Yup.number().integer().min(1).required().label('Line Width'),\n  }),\n});\n\ninterface PredictionOptionsProps {\n  onPredict?: (options?: PredictionOptionsInterface) => void;\n}\n\nfunction PredictionOptions({ onPredict = () => null }: PredictionOptionsProps) {\n  const refForm = useRef<any>();\n\n  const handleSave = useCallback(() => {\n    refForm.current.submitForm();\n  }, []);\n\n  const submitHandler = useCallback(\n    (values) => {\n      void (async () => {\n        onPredict(values);\n      })();\n    },\n    [onPredict],\n  );\n\n  return (\n    <div css={styles}>\n      <div>\n        <FormikForm\n          ref={refForm}\n          initialValues={defaultPredictionOptions}\n          validationSchema={predictionFormValidation}\n          onSubmit={submitHandler}\n        >\n          <FormikErrorsSummary />\n          <div className=\"row margin-10\">\n            <span className=\"custom-label\">Frequency : </span>\n            <FormikSelect\n              data={FREQUENCIES}\n              style={{ width: 290, height: 30, margin: 0 }}\n              name=\"frequency\"\n            />\n          </div>\n\n          <div className=\"row\">\n            <IsotopesViewer value=\"1H\" className=\"custom-label\" />\n            <Label title=\"From\">\n              <FormikInput name=\"1d.1H.from\" type=\"number\" />\n            </Label>\n            <Label title=\"To\" style={{ label: { padding: '0 10px' } }}>\n              <FormikInput name=\"1d.1H.to\" type=\"number\" />\n            </Label>\n          </div>\n          <div className=\"row\">\n            <IsotopesViewer value=\"13C\" className=\"custom-label\" />\n            <Label title=\"From\">\n              <FormikInput name=\"1d.13C.from\" type=\"number\" />\n            </Label>\n            <Label title=\"To\" style={{ label: { padding: '0 10px' } }}>\n              <FormikInput name=\"1d.13C.to\" type=\"number\" />\n            </Label>\n          </div>\n          <div className=\"row margin-10 padding-h-10\">\n            <span className=\"custom-label\">Line Width : </span>\n            <FormikInput\n              name=\"1d.lineWidth\"\n              type=\"number\"\n              style={{ input: { margin: 0 } }}\n            />\n            <span style={{ paddingLeft: '0.4rem' }}> Hz </span>\n          </div>\n        </FormikForm>\n      </div>\n      <div>\n        <Button.Done onClick={handleSave}>Predict spectrum</Button.Done>\n      </div>\n    </div>\n  );\n}\n\nexport default PredictionOptions;\n","import { useState, useCallback } from 'react';\n\nimport { Molecule } from '../../../data/molecules/Molecule';\nimport { useDispatch } from '../../context/DispatchContext';\nimport { useAlert } from '../../elements/popup/Alert';\nimport { PREDICT_SPECTRA, SET_LOADING_FLAG } from '../../reducer/types/Types';\nimport MoleculePanel from '../MoleculesPanel/MoleculePanel';\n\nimport PredictionPreferences from './PredictionOptions';\n\nexport default function PredictionPane() {\n  const [molecule, setMolecule] = useState<Molecule | null>();\n\n  const changeHandler = useCallback((molecule) => {\n    setMolecule(molecule);\n  }, []);\n  const dispatch = useDispatch();\n  const alert = useAlert();\n\n  const predictHandler = useCallback(\n    (values) => {\n      void (async () => {\n        if (molecule) {\n          dispatch({\n            type: SET_LOADING_FLAG,\n            isLoading: true,\n          });\n\n          const hideLoading = await alert.showLoading(\n            `Predict 1H, 13C, COSY, HSQC, and HMBC in progress`,\n          );\n\n          dispatch({\n            type: PREDICT_SPECTRA,\n            payload: { mol: molecule, options: values },\n          });\n\n          hideLoading();\n        } else {\n          alert.error('No Molecule selected');\n        }\n      })();\n    },\n    [alert, dispatch, molecule],\n  );\n\n  return (\n    <MoleculePanel\n      onMoleculeChange={changeHandler}\n      actionsOptions={{ hidePredict: true, hideDelete: true, hideExport: true }}\n    >\n      <PredictionPreferences onPredict={predictHandler} />\n    </MoleculePanel>\n  );\n}\n","import { Accordion } from 'analysis-ui-components';\nimport lodashGet from 'lodash/get';\nimport { useCallback, memo, ReactElement, CSSProperties } from 'react';\n\nimport { PanelPreferencesType } from '../../types/PanelPreferencesType';\nimport { useChartData } from '../context/ChartContext';\nimport { usePreferences } from '../context/PreferencesContext';\nimport useCheckExperimentalFeature from '../hooks/useCheckExperimentalFeature';\nimport { DISPLAYER_MODE } from '../reducer/core/Constants';\n\nimport AutomaticAssignment from './AutomaticAssignment/AutomaticAssignment';\nimport InformationPanel from './InformationPanel';\nimport IntegralPanel from './IntegralsPanel/IntegralPanel';\nimport MatrixGenerationPanel from './MatrixGenerationPanel/MatrixGenerationPanel';\nimport MoleculePanel from './MoleculesPanel/MoleculePanel';\nimport MultipleSpectraAnalysisPanel from './MultipleSpectraAnalysisPanel/MultipleSpectraAnalysisPanel';\nimport PeaksPanel from './PeaksPanel/PeaksPanel';\nimport RangesPanel from './RangesPanel/RangesPanel';\nimport SpectrumListPanel from './SpectrumsPanel/SpectrumListPanel';\nimport SummaryPanel from './SummaryPanel/SummaryPanel';\nimport ZonesPanel from './ZonesPanel/ZonesPanel';\nimport DatabasePanel from './databasePanel/DatabasePanel';\nimport FilterPanel from './filtersPanel/FilterPanel';\nimport PredictionPane from './predictionPanel/PredictionPanel';\n\ninterface AccordionItem {\n  title: string;\n  component: ReactElement;\n  style?: CSSProperties;\n  hidePreferenceKey: string;\n  mode: '1D' | '2D' | null;\n  isExperimental?: boolean;\n}\n\nconst accordionItems: AccordionItem[] = [\n  {\n    title: 'Spectra',\n    component: <SpectrumListPanel />,\n    hidePreferenceKey: 'spectraPanel',\n    mode: null,\n  },\n  {\n    title: 'Information',\n    component: <InformationPanel />,\n    style: { overflow: 'hidden' },\n    hidePreferenceKey: 'informationPanel',\n    mode: null,\n  },\n  {\n    title: 'Peaks',\n    component: <PeaksPanel />,\n    hidePreferenceKey: 'peaksPanel',\n    mode: null,\n  },\n  {\n    title: 'Filters',\n    component: <FilterPanel />,\n    hidePreferenceKey: 'filtersPanel',\n    mode: null,\n  },\n  {\n    title: 'Integrals',\n    component: <IntegralPanel />,\n    hidePreferenceKey: 'integralsPanel',\n    mode: null,\n  },\n  {\n    title: 'Ranges',\n    component: <RangesPanel />,\n    hidePreferenceKey: 'rangesPanel',\n    mode: DISPLAYER_MODE.DM_1D,\n  },\n  {\n    title: 'Multiple Spectra Analysis',\n    component: <MultipleSpectraAnalysisPanel />,\n    hidePreferenceKey: 'multipleSpectraAnalysisPanel',\n    mode: null,\n  },\n  {\n    title: 'Matrix Generation',\n    component: <MatrixGenerationPanel />,\n    hidePreferenceKey: '',\n    mode: null,\n    isExperimental: true,\n  },\n  {\n    title: 'Zones',\n    component: <ZonesPanel />,\n    hidePreferenceKey: 'zonesPanel',\n    mode: DISPLAYER_MODE.DM_2D,\n  },\n  {\n    title: 'Summary',\n    component: <SummaryPanel />,\n    hidePreferenceKey: 'summaryPanel',\n    mode: null,\n  },\n  {\n    title: 'Structures',\n    component: <MoleculePanel />,\n    hidePreferenceKey: 'structuresPanel',\n    mode: null,\n  },\n  {\n    title: 'Databases',\n    component: <DatabasePanel />,\n    hidePreferenceKey: 'databasePanel',\n    mode: null,\n  },\n  {\n    title: 'Automatic Assignment',\n    component: <AutomaticAssignment />,\n    hidePreferenceKey: '',\n    mode: null,\n    isExperimental: true,\n  },\n  {\n    title: 'Prediction',\n    component: <PredictionPane />,\n    hidePreferenceKey: 'predictionPanel',\n    mode: null,\n  },\n];\n\nexport const TOOLS_PANELS_ACCORDION: Record<string, string> = {\n  null: 'Spectra',\n  peakPicking: 'Peaks',\n  integral: 'Integrals',\n  rangesPicking: 'Ranges',\n  zone2D: 'Zones',\n  multipleSpectraAnalysis: 'Multiple Spectra Analysis',\n};\n\nfunction usePanelPreferences(): (item: AccordionItem) => PanelPreferencesType {\n  const preferences = usePreferences();\n\n  return useCallback(\n    (item: AccordionItem) => {\n      return lodashGet(\n        preferences.current,\n        `display.panels.${item.hidePreferenceKey}`,\n      );\n    },\n    [preferences],\n  );\n}\n\nfunction PanelsInner({ displayerMode: displayedMode }) {\n  const getPanelPreferences = usePanelPreferences();\n  const isExperimental = useCheckExperimentalFeature();\n  const check = useCallback(\n    (item) => {\n      const panelOptions = getPanelPreferences(item);\n      return (\n        (panelOptions?.hidden !== true &&\n          panelOptions?.display === true &&\n          item.isExperimental === undefined &&\n          (item.mode == null || item.mode === displayedMode)) ||\n        (item.isExperimental && isExperimental)\n      );\n    },\n    [displayedMode, getPanelPreferences, isExperimental],\n  );\n\n  const isOpened = useCallback(\n    (item: AccordionItem) => {\n      const panelOptions = getPanelPreferences(item);\n      return panelOptions?.hidden !== true && panelOptions?.open;\n    },\n    [getPanelPreferences],\n  );\n\n  return (\n    <div style={{ width: '100%', height: '100%', flex: '1 1 0%' }}>\n      <Accordion>\n        {accordionItems.map((item) => {\n          return (\n            check(item) && (\n              <Accordion.Item\n                key={item.title}\n                title={item.title}\n                defaultOpened={isOpened(item)}\n              >\n                {item.component}\n              </Accordion.Item>\n            )\n          );\n        })}\n      </Accordion>\n    </div>\n  );\n}\n\nconst MemoizedPanels = memo(PanelsInner);\n\nexport default function Panels() {\n  const {\n    displayerMode,\n    toolOptions: { selectedTool },\n  } = useChartData();\n\n  return <MemoizedPanels {...{ displayerMode, selectedTool }} />;\n}\n","import { useToggleAccordion } from 'analysis-ui-components';\nimport lodashDebounce from 'lodash/debounce';\nimport lodashMap from 'lodash/map';\nimport { useCallback, useRef, useState } from 'react';\n\nimport { useDispatch } from '../context/DispatchContext';\nimport { useAlert } from '../elements/popup/Alert';\nimport { TOOLS_PANELS_ACCORDION } from '../panels/Panels';\nimport { ZoomType } from '../reducer/helper/Zoom1DManager';\nimport {\n  CHANGE_SPECTRUM_DISPLAY_VIEW_MODE,\n  FULL_ZOOM_OUT,\n  SET_SELECTED_TOOL,\n  SET_SPECTRUMS_VERTICAL_ALIGN,\n  TOGGLE_REAL_IMAGINARY_VISIBILITY,\n} from '../reducer/types/Types';\nimport { options } from '../toolbar/ToolTypes';\n\nexport default function useToolsFunctions() {\n  const dispatch = useDispatch();\n  const alert = useAlert();\n\n  const { open: openPanel } = useToggleAccordion();\n  const [isRealSpectrumShown, setIsRealSpectrumShown] = useState(false);\n\n  const debounceClickEventsRef = useRef<{ clicks: Array<any> }>({ clicks: [] });\n  const handleChangeOption = useCallback(\n    (selectedTool) => {\n      if (\n        [\n          options.peakPicking.id,\n          options.integral.id,\n          options.zone2D.id,\n          options.exclusionZones.id,\n        ].includes(selectedTool)\n      ) {\n        alert.show('Press Shift + Left Mouse button to select zone');\n      }\n\n      if (Object.keys(TOOLS_PANELS_ACCORDION).includes(selectedTool)) {\n        openPanel(TOOLS_PANELS_ACCORDION[selectedTool]);\n      }\n\n      dispatch({\n        type: SET_SELECTED_TOOL,\n        payload: { selectedTool },\n      });\n    },\n    [alert, dispatch, openPanel],\n  );\n\n  const handleFullZoomOut = useCallback(() => {\n    if (debounceClickEventsRef.current.clicks.length === 0) {\n      dispatch({\n        type: FULL_ZOOM_OUT,\n        zoomType: ZoomType.HORIZONTAL,\n      });\n    }\n    const callback = lodashDebounce(() => {\n      debounceClickEventsRef.current.clicks = [];\n    }, 500);\n    debounceClickEventsRef.current.clicks.push(callback);\n\n    callback();\n\n    if (debounceClickEventsRef.current.clicks.length > 1) {\n      lodashMap(debounceClickEventsRef.current.clicks, (debounce) =>\n        debounce.cancel(),\n      );\n      debounceClickEventsRef.current.clicks = [];\n      dispatch({\n        type: FULL_ZOOM_OUT,\n      });\n    }\n  }, [dispatch, debounceClickEventsRef]);\n\n  const changeDisplayViewModeHandler = useCallback(() => {\n    dispatch({\n      type: CHANGE_SPECTRUM_DISPLAY_VIEW_MODE,\n    });\n  }, [dispatch]);\n\n  const changeSpectrumViewHandler = useCallback(() => {\n    dispatch({\n      type: TOGGLE_REAL_IMAGINARY_VISIBILITY,\n      isRealSpectrumVisible: !isRealSpectrumShown,\n    });\n    setIsRealSpectrumShown(!isRealSpectrumShown);\n  }, [dispatch, isRealSpectrumShown]);\n\n  const alignSpectrumsVerticallyHandler = useCallback(() => {\n    dispatch({\n      type: SET_SPECTRUMS_VERTICAL_ALIGN,\n    });\n  }, [dispatch]);\n\n  return {\n    handleChangeOption,\n    handleFullZoomOut,\n    changeDisplayViewModeHandler,\n    changeSpectrumViewHandler,\n    alignSpectrumsVerticallyHandler,\n    isRealSpectrumShown,\n  };\n}\n","import { useCallback, useEffect, useMemo } from 'react';\n\nimport checkModifierKeyActivated from '../../data/utilities/checkModifierKeyActivated';\nimport { useAssignmentData } from '../assignment/AssignmentsContext';\nimport { useChartData } from '../context/ChartContext';\nimport { useDispatch } from '../context/DispatchContext';\nimport { useLoader } from '../context/LoaderContext';\nimport { useAlert } from '../elements/popup/Alert';\nimport { HighlightedSource, useHighlightData } from '../highlight/index';\nimport useExport from '../hooks/useExport';\nimport useToolsFunctions from '../hooks/useToolsFunctions';\nimport { DISPLAYER_MODE } from '../reducer/core/Constants';\nimport {\n  SET_KEY_PREFERENCES,\n  APPLY_KEY_PREFERENCES,\n  DELETE_INTEGRAL,\n  DELETE_PEAK_NOTATION,\n  DELETE_RANGE,\n  DELETE_2D_ZONE,\n  DELETE_EXCLUSION_ZONE,\n} from '../reducer/types/Types';\nimport { options } from '../toolbar/ToolTypes';\n\nfunction KeysListenerTracker() {\n  const {\n    keysPreferences,\n    displayerMode,\n    overDisplayer,\n    data,\n    activeSpectrum,\n  } = useChartData();\n  const dispatch = useDispatch();\n  const alert = useAlert();\n  const openLoader = useLoader();\n\n  const {\n    handleChangeOption,\n    handleFullZoomOut,\n    alignSpectrumsVerticallyHandler,\n    changeDisplayViewModeHandler,\n  } = useToolsFunctions();\n\n  const { saveToClipboardHandler, saveAsJSONHandler, saveAsHandler } =\n    useExport();\n\n  const { highlight, remove } = useHighlightData();\n\n  const assignmentData = useAssignmentData();\n  const allow1DTool = useMemo(() => {\n    return displayerMode === DISPLAYER_MODE.DM_1D && data && data.length > 0;\n  }, [data, displayerMode]);\n\n  const deleteHandler = useCallback(\n    async (sourceData) => {\n      const {\n        type,\n        extra: { id },\n      } = sourceData;\n\n      switch (type) {\n        case HighlightedSource.INTEGRAL: {\n          dispatch({\n            type: DELETE_INTEGRAL,\n            integralID: id,\n          });\n          // remove keys from the highlighted list after delete\n          remove();\n\n          break;\n        }\n        case HighlightedSource.PEAK: {\n          dispatch({\n            type: DELETE_PEAK_NOTATION,\n            data: { id },\n          });\n          // remove keys from the highlighted list after delete\n          remove();\n\n          break;\n        }\n        case HighlightedSource.RANGE: {\n          dispatch({\n            type: DELETE_RANGE,\n            payload: {\n              data: {\n                id,\n                assignmentData,\n              },\n            },\n          });\n          // remove keys from the highlighted list after delete\n          remove();\n\n          break;\n        }\n        case HighlightedSource.ZONE: {\n          dispatch({\n            type: DELETE_2D_ZONE,\n            payload: {\n              id,\n              assignmentData,\n            },\n          });\n          // remove keys from the highlighted list after delete\n          remove();\n\n          break;\n        }\n        case HighlightedSource.EXCLUSION_ZONE: {\n          const hideLoading = await alert.showLoading(\n            `Exclusion filter in progress`,\n          );\n          dispatch({\n            type: DELETE_EXCLUSION_ZONE,\n            payload: {\n              id,\n              spectrumID: sourceData.extra.spectrumID,\n            },\n          });\n          hideLoading();\n          // remove keys from the highlighted list after delete\n          remove();\n\n          break;\n        }\n\n        default:\n          break;\n      }\n    },\n    [assignmentData, dispatch, remove, alert],\n  );\n\n  const keysPreferencesListenerHandler = useCallback(\n    (e, num) => {\n      if (data && data.length > 0 && num >= 1 && num <= 9) {\n        if (e.shiftKey) {\n          dispatch({\n            type: SET_KEY_PREFERENCES,\n            keyCode: num,\n          });\n          alert.show(`Configuration Reset, press '${num}' again to reload it.`);\n        } else {\n          if (!checkModifierKeyActivated(e)) {\n            if (keysPreferences?.[num]) {\n              dispatch({\n                type: APPLY_KEY_PREFERENCES,\n                keyCode: num,\n              });\n            } else {\n              dispatch({\n                type: SET_KEY_PREFERENCES,\n                keyCode: num,\n              });\n              alert.show(\n                `Configuration saved, press '${num}' again to reload it.`,\n              );\n            }\n          }\n        }\n      }\n    },\n    [alert, data, dispatch, keysPreferences],\n  );\n\n  const toolsListenerHandler = useCallback(\n    (e) => {\n      function check1DModeWithActiveSpectrum(\n        label: string,\n        checkSwitch = true,\n      ) {\n        if (displayerMode === DISPLAYER_MODE.DM_1D && !activeSpectrum) {\n          throw new Error(`Select a spectrum to proceed with ${label}`);\n        } else if (checkSwitch && displayerMode === DISPLAYER_MODE.DM_2D) {\n          throw new Error(\n            `Switch to 1D Mode and select a spectrum to proceed with ${label}`,\n          );\n        }\n      }\n      function check2DModeWithActiveSpectrum(\n        label: string,\n        checkSwitch = true,\n      ) {\n        if (displayerMode === DISPLAYER_MODE.DM_2D && !activeSpectrum) {\n          throw new Error(`Select a spectrum to proceed with ${label}`);\n        } else if (checkSwitch && displayerMode === DISPLAYER_MODE.DM_1D) {\n          throw new Error(\n            `Switch to 2D Mode and select a spectrum to proceed with ${label}`,\n          );\n        }\n      }\n\n      try {\n        if (!e.shiftKey && !e.metaKey) {\n          switch (e.key) {\n            case 'f':\n              handleFullZoomOut();\n              break;\n            case 'z':\n            case 'Escape':\n              handleChangeOption(options.zoom.id);\n              break;\n            case 'r': {\n              if (displayerMode === DISPLAYER_MODE.DM_2D) {\n                check2DModeWithActiveSpectrum(options.zone2D.label, false);\n                handleChangeOption(options.zone2D.id);\n              } else {\n                check1DModeWithActiveSpectrum(\n                  options.rangesPicking.label,\n                  false,\n                );\n                handleChangeOption(options.rangesPicking.id);\n              }\n              break;\n            }\n            case 'a': {\n              check1DModeWithActiveSpectrum(options.phaseCorrection.label);\n              handleChangeOption(options.phaseCorrection.id);\n\n              break;\n            }\n            case 'b': {\n              check1DModeWithActiveSpectrum(options.baseLineCorrection.label);\n              handleChangeOption(options.baseLineCorrection.id);\n\n              break;\n            }\n            case 'p': {\n              check1DModeWithActiveSpectrum(options.peakPicking.label);\n              handleChangeOption(options.peakPicking.id);\n\n              break;\n            }\n            case 'i': {\n              check1DModeWithActiveSpectrum(options.integral.label);\n              handleChangeOption(options.integral.id);\n\n              break;\n            }\n            case 'e': {\n              check1DModeWithActiveSpectrum(options.exclusionZones.label);\n              handleChangeOption(options.exclusionZones.id);\n\n              break;\n            }\n            default:\n          }\n        }\n\n        if (!e.shiftKey && !e.metaKey && !e.ctrlKey) {\n          switch (e.key) {\n            case 'c': {\n              if (allow1DTool) {\n                alignSpectrumsVerticallyHandler();\n              }\n              break;\n            }\n            case 's': {\n              if (allow1DTool) {\n                changeDisplayViewModeHandler();\n              }\n              break;\n            }\n            default:\n          }\n        }\n\n        if (!e.shiftKey && (e.metaKey || e.ctrlKey)) {\n          switch (e.key) {\n            case 'c':\n              void saveToClipboardHandler();\n              e.preventDefault();\n              break;\n            case 's':\n              void saveAsJSONHandler();\n              e.preventDefault();\n              break;\n            case 'o':\n              openLoader();\n              e.preventDefault();\n              break;\n            default:\n          }\n        }\n        if (e.shiftKey && (e.metaKey || e.ctrlKey)) {\n          switch (e.key) {\n            case 's':\n            case 'S':\n              void saveAsHandler();\n              e.preventDefault();\n              break;\n            default:\n          }\n        }\n      } catch (e: any) {\n        alert.error(e.message);\n      }\n    },\n    [\n      activeSpectrum,\n      alert,\n      alignSpectrumsVerticallyHandler,\n      allow1DTool,\n      changeDisplayViewModeHandler,\n      displayerMode,\n      handleChangeOption,\n      handleFullZoomOut,\n      openLoader,\n      saveAsHandler,\n      saveAsJSONHandler,\n      saveToClipboardHandler,\n    ],\n  );\n\n  function checkNotInputField(e: Event) {\n    const tags = ['input', 'textarea'];\n    const tagName = (e.composedPath()[0] as HTMLElement).tagName.toLowerCase();\n    if (!tags.includes(tagName)) return true;\n\n    return false;\n  }\n\n  const handleOnKeyDown = useCallback(\n    (e) => {\n      if (checkNotInputField(e) && overDisplayer) {\n        const num = Number(e.code.substr(e.code.length - 1)) || 0;\n        if (num > 0) {\n          keysPreferencesListenerHandler(e, num);\n        } else {\n          if (['Delete', 'Backspace'].includes(e.key) && highlight.sourceData) {\n            e.preventDefault();\n            void deleteHandler(highlight.sourceData);\n          } else {\n            toolsListenerHandler(e);\n          }\n        }\n      }\n    },\n    [\n      deleteHandler,\n      highlight,\n      keysPreferencesListenerHandler,\n      overDisplayer,\n      toolsListenerHandler,\n    ],\n  );\n\n  useEffect(() => {\n    document.addEventListener('keydown', handleOnKeyDown);\n\n    return () => document.removeEventListener('keydown', handleOnKeyDown);\n  }, [handleOnKeyDown]);\n\n  return null;\n}\n\nexport default KeysListenerTracker;\n","import { SplitPane } from 'analysis-ui-components';\n\nimport { usePreferences } from './context/PreferencesContext';\n\nexport function SplitPaneWrapper({ children }) {\n  const { current } = usePreferences();\n  return (\n    <SplitPane\n      key={current?.display?.general?.hidePanelOnLoad ? 'true' : 'false'}\n      initialSeparation=\"590px\"\n      orientation=\"horizontal\"\n      sideSeparation=\"end\"\n      initialClosed={current?.display?.general?.hidePanelOnLoad || false}\n    >\n      {children}\n    </SplitPane>\n  );\n}\n","import { isSpectrum1D } from '../../../data/data1d/Spectrum1D';\nimport { Datum1D } from '../../../data/types/data1d';\nimport { Ranges } from '../../../data/types/data1d/Ranges';\nimport { Datum2D, Zones } from '../../../data/types/data2d';\nimport { assignmentState, AssignmentState, Axis } from '../AssignmentsContext';\n\nexport default function initAssignment(action) {\n  const newState = {\n    ...assignmentState,\n  };\n\n  const spectra = (action.payload.spectra || []) as (Datum1D | Datum2D)[];\n  for (const spectrum of spectra) {\n    if (isSpectrum1D(spectrum)) {\n      setRangesAssignments(newState, spectrum.ranges);\n    } else {\n      setZonesAssignments(newState, spectrum.zones);\n    }\n  }\n  return newState;\n}\n\nfunction setRangesAssignments(state: AssignmentState, ranges: Ranges) {\n  const diaIDRecords = ranges.values.reduce<{ id: string; diaIDs: string[] }[]>(\n    (acc, { id, diaIDs, signals }) => {\n      acc.push({ id, diaIDs: diaIDs || [] });\n      for (const signal of signals) {\n        acc.push({ id: signal.id, diaIDs: signal.diaIDs || [] });\n      }\n      return acc;\n    },\n    [],\n  );\n\n  for (const { id, diaIDs } of diaIDRecords) {\n    for (const diaID of diaIDs) {\n      setAssignment(state, id, 'x', diaID);\n    }\n  }\n}\nfunction setZonesAssignments(state: AssignmentState, zones: Zones) {\n  const diaIDRecords = zones.values.reduce<\n    { id: string; diaIDs: Record<Axis, string[]> }[]\n  >((acc, { id, x, y, signals }) => {\n    acc.push({ id, diaIDs: { x: x.diaIDs || [], y: y.diaIDs || [] } });\n    for (const signal of signals) {\n      acc.push({\n        id: signal.id,\n        diaIDs: { x: signal.x.diaIDs || [], y: signal.y.diaIDs || [] },\n      });\n    }\n    return acc;\n  }, []);\n\n  for (const { id, diaIDs } of diaIDRecords) {\n    (['x', 'y'] as Axis[]).forEach((axis) => {\n      for (const diaID of diaIDs[axis]) {\n        setAssignment(state, id, axis, diaID);\n      }\n    });\n  }\n}\n\nfunction setAssignment(state: AssignmentState, id, axis: Axis, diaID: string) {\n  if (\n    Array.isArray(state.assignments?.[id]?.[axis]) &&\n    !state.assignments[id][axis].includes(diaID)\n  ) {\n    state.assignments[id][axis].push(diaID);\n  } else {\n    state.assignments = {\n      ...state.assignments,\n      [id]: { ...state.assignments[id], [axis]: [diaID] },\n    };\n  }\n}\n","import { AssignmentState, Axis } from '../AssignmentsContext';\n\ninterface RemoveAction {\n  ids: string[];\n  atomID?: string;\n  axis: Axis;\n}\n\ninterface AssignmentRemoveOptions extends Omit<RemoveAction, 'ids'> {\n  id: string;\n}\n\nexport function removeAssignment(\n  state: AssignmentState,\n  options: AssignmentRemoveOptions,\n) {\n  const { id, atomID = '', axis } = options;\n\n  const atomIDs = state.assignments?.[id]?.[axis] || null;\n\n  if (atomIDs) {\n    if (atomID) {\n      atomIDs.filter((id) => id !== atomID);\n      state.assignments[id][axis] = atomIDs;\n    } else {\n      state.assignments[id][axis] = [];\n    }\n  }\n}\n\nexport default function removeAssignments(\n  state: AssignmentState,\n  action: RemoveAction,\n) {\n  const newState = {\n    ...state,\n  };\n  // signal id\n  const { ids, atomID = '', axis } = action;\n  for (const id of ids) {\n    removeAssignment(newState, { id, atomID, axis });\n  }\n  return newState;\n}\n","import { AssignmentState } from '../AssignmentsContext';\nimport { SetActiveAction } from '../AssignmentsReducer';\n\nexport default function setActiveAssignment(\n  state: AssignmentState,\n  action: SetActiveAction,\n) {\n  let { id, axis } = action.payload;\n  const isActive = state.activated?.id === id;\n\n  return {\n    ...state,\n    activated: !isActive ? { id, axis: axis || null } : null,\n  };\n}\n","import {\n  AssignmentDimension,\n  AssignmentState,\n  Axis,\n} from '../AssignmentsContext';\nimport { ToggleAction } from '../AssignmentsReducer';\n\nimport { removeAssignment } from './removeAssignment';\n\ninterface AddAction {\n  id: string;\n  atomID: string;\n  axis: Axis;\n  dimension: AssignmentDimension;\n}\n\nfunction addAssignment(state: AssignmentState, action: AddAction) {\n  const { id, atomID, axis, dimension } = action;\n\n  const assignment = state.assignments?.[id] || null;\n  const axisAssignments = assignment?.[axis] || null;\n\n  // avoid duplicates\n  if (axisAssignments) {\n    if (!axisAssignments.includes(id)) {\n      axisAssignments.push(atomID);\n    }\n  } else {\n    const otherAxis = axis === 'x' ? 'y' : 'x';\n    state.assignments = {\n      ...state.assignments,\n      [id]: {\n        ...state.assignments[id],\n        [axis]: [atomID],\n        ...(dimension === '2D' && {\n          [otherAxis]: assignment?.[otherAxis] ? assignment[otherAxis] : [],\n        }),\n      },\n    };\n  }\n}\n\nexport default function ToggleAssignments(\n  state: AssignmentState,\n  action: ToggleAction,\n) {\n  const newState = {\n    ...state,\n  };\n  const { id, atomIDs: atomsKeys, dimension } = action.payload;\n  const axis = state.activated?.axis;\n  if (axis) {\n    const atomIDs = state.assignments?.[id]?.[axis] || [];\n\n    for (const atomID of atomsKeys) {\n      if (!atomIDs.includes(id)) {\n        addAssignment(newState, { axis, id, atomID, dimension });\n      } else {\n        removeAssignment(newState, { atomID, axis, id });\n      }\n    }\n  }\n  return newState;\n}\n","import { Data1D } from '../../data/types/data1d';\nimport { Data2D } from '../../data/types/data2d';\nimport { ActionType } from '../reducer/types/Types';\n\nimport {\n  AssignmentDimension,\n  AssignmentState,\n  Axis,\n} from './AssignmentsContext';\nimport initAssignment from './actions/initAssignment';\nimport removeAssignments from './actions/removeAssignment';\nimport setActiveAssignment from './actions/setActiveAssignment';\nimport toggleAssignment from './actions/toggleAssignment';\n\nexport type InitiateAction = ActionType<\n  'INITIATE_ASSIGNMENTS',\n  { spectra: (Data1D | Data2D)[] }\n>;\nexport type ToggleAction = ActionType<\n  'TOGGLE',\n  { atomIDs: string[]; id: string; dimension: AssignmentDimension }\n>;\nexport type AddAction = ActionType<\n  'ADD',\n  { id: string; atomID: string; axis: Axis }\n>;\nexport type RemoveAction = ActionType<\n  'REMOVE',\n  { ids: string[]; atomID?: string; axis: Axis }\n>;\nexport type SetActiveAction = ActionType<\n  'SET_ACTIVE',\n  { id: string; axis: Axis }\n>;\nexport type ShowAction = ActionType<'SHOW', { id: string; axis?: Axis }>;\n\nexport type AssignmentsActions =\n  | InitiateAction\n  | ToggleAction\n  | AddAction\n  | RemoveAction\n  | SetActiveAction\n  | ShowAction\n  | ActionType<'HIDE'>;\n\nexport default function assignmentReducer(\n  state: AssignmentState,\n  action: AssignmentsActions,\n): AssignmentState {\n  switch (action.type) {\n    case 'INITIATE_ASSIGNMENTS': {\n      return initAssignment(action);\n    }\n    case 'REMOVE': {\n      const { axis, ids, atomID } = action.payload;\n      return removeAssignments(state, { axis, ids, atomID });\n    }\n    case 'TOGGLE': {\n      return toggleAssignment(state, action);\n    }\n    case 'SET_ACTIVE': {\n      return setActiveAssignment(state, action);\n    }\n    case 'SHOW': {\n      const { id, axis } = action.payload;\n      return {\n        ...state,\n        highlighted: {\n          id,\n          axis: axis || null,\n        },\n      };\n    }\n    case 'HIDE': {\n      return {\n        ...state,\n        highlighted: null,\n      };\n    }\n\n    default:\n      return state;\n  }\n}\n","import { useReducer, useMemo, useEffect, Reducer } from 'react';\n\nimport {\n  AssignmentContext,\n  assignmentState,\n  AssignmentState,\n  assignmentContext,\n} from './AssignmentsContext';\nimport assignmentReducer, { AssignmentsActions } from './AssignmentsReducer';\n\nexport function AssignmentProvider(props) {\n  const { spectraData: spectra } = props;\n  const [data, dispatch] = useReducer<\n    Reducer<AssignmentState, AssignmentsActions>\n  >(assignmentReducer, assignmentState);\n\n  const state = useMemo<AssignmentContext>(() => ({ data, dispatch }), [data]);\n\n  useEffect(() => {\n    if (spectra) {\n      dispatch({\n        type: 'INITIATE_ASSIGNMENTS',\n        payload: { spectra },\n      });\n    }\n  }, [spectra]);\n\n  return (\n    <assignmentContext.Provider value={state}>\n      {props.children}\n    </assignmentContext.Provider>\n  );\n}\n","export const docsBaseUrl = 'https://docs.nmrium.org';\n\nexport const helpList: Record<string, { text: string; url: string }> = {\n  zoomIn: {\n    text: 'Zoom Tool',\n    url: `${docsBaseUrl}/help/zoom-and-scale`,\n  },\n  peakPicking: {\n    text: 'peak picking tool',\n    url: `${docsBaseUrl}/help/peaks`,\n  },\n  integralPicking: {\n    text: 'integral tool',\n    url: `${docsBaseUrl}/help/integrations`,\n  },\n  fullScreen: {\n    text: 'Full Screen mode',\n    url: `${docsBaseUrl}/help/general`,\n  },\n  loadSpectrum: {\n    text: 'load spectrums',\n    url: `${docsBaseUrl}/help/loading-a-spectrum`,\n  },\n};\n","export default { version: 'git-6e293a81de73bcd3f681ac3f59e404b48f7934bc' };\n","interface LogoProps {\n  width?: number;\n  height?: number;\n}\n\nexport default function Logo({ width = 100, height = 100 }: LogoProps) {\n  return (\n    <svg\n      style={{ width: width, height: height }}\n      xmlns=\"http://www.w3.org/2000/svg\"\n      viewBox=\"0 0 752.34 221.73\"\n    >\n      <path\n        fill=\"#ea580c\"\n        fillRule=\"evenodd\"\n        d=\"M.64,31.7A31.67,31.67,0,0,1,54.72,9.29l0,0A31.66,31.66,0,0,1,64,31.7V190a13.39,13.39,0,0,0,26.77,0V54a31.7,31.7,0,0,1,31.7-31.7V40.58A13.38,13.38,0,0,0,109.13,54V190a31.71,31.71,0,0,1-63.41,0V31.7a13.29,13.29,0,0,0-3.88-9.46l0,0A13.41,13.41,0,0,0,19,31.7V164.82H.64Z\"\n      />\n      <path\n        fill=\"#2b143e\"\n        fillRule=\"evenodd\"\n        d=\"M154.21,54v68.17a13.34,13.34,0,0,0,3.89,9.47h0A13.39,13.39,0,0,0,181,122.14V99.32h-.06a31.63,31.63,0,0,1,9.29-22.38l0,0a31.65,31.65,0,0,1,44.8,0l0,0a31.58,31.58,0,0,1,9.3,22.39V118H226V99.32a13.3,13.3,0,0,0-3.89-9.46h0a13.44,13.44,0,0,0-18.93,0l0,0a13.3,13.3,0,0,0-3.83,8.19v24.09a31.7,31.7,0,0,1-54.11,22.42v0a31.66,31.66,0,0,1-9.3-22.4V54Z\"\n      />\n      <path\n        fill=\"#2b143e\"\n        fillRule=\"evenodd\"\n        d=\"M729.19,96.34c-8.65,0-14.26,3.17-17.67,8-3.41-5.12-8.78-8-16-8-8.16,0-13.52,3.17-16.32,7.31v-5.6H661V159h18.28V124.62c0-7.19,3.41-11.46,9.5-11.46,5.85,0,8.78,3.9,8.78,10V159h18.27V124.62c0-7.19,3.42-11.46,9.51-11.46,5.85,0,8.77,3.9,8.77,10V159h18.28V121.57C752.34,106.33,743.2,96.34,729.19,96.34Z\"\n      />\n      <path\n        fill=\"#2b143e\"\n        fillRule=\"evenodd\"\n        d=\"M629.26,98.05v33.26c0,8.66-4.63,12.56-11.33,12.56-5.85,0-10.6-3.54-10.6-11.09V98.05H589.05v37.41c0,16.45,10.48,25.22,22.79,25.22,8,0,14.13-2.92,17.42-7.43V159h18.28V98.05Z\"\n      />\n      <rect fill=\"#2b143e\" x=\"558.22\" y=\"98.05\" width=\"18.28\" height=\"60.93\" />\n      <path\n        fill=\"#2b143e\"\n        fillRule=\"evenodd\"\n        d=\"M567.36,92.68a11,11,0,1,0-11-11A11.08,11.08,0,0,0,567.36,92.68Z\"\n      />\n      <path\n        fill=\"#ea580c\"\n        fillRule=\"evenodd\"\n        d=\"M478.77,159H498V116.57L525.66,159H549.2l-22.3-34.75c5.45-2.13,8.12-4.14,11.48-8.86a31.07,31.07,0,0,0,6.07-18.26V94.62c0-10.61-3.45-15.93-9.28-21.78S520.75,63.09,510,63.09H478.71l.06,95.89Zm33.1-50.27h-6.46v-.06H498V82.19h10.87c4.67,0,9.44,1.38,11.94,3.81a12.84,12.84,0,0,1,3.81,9.2C524.58,102.52,518.92,108.71,511.87,108.71Z\"\n      />\n      <polygon\n        fill=\"#ea580c\"\n        fillRule=\"evenodd\"\n        points=\"372.91 60.8 372.91 158.98 392.16 158.98 392.16 119.23 419.91 157.41 447.61 119.23 447.61 158.98 466.87 158.98 466.87 60.8 419.91 125.22 372.91 60.8\"\n      />\n      <polygon\n        fill=\"#ea580c\"\n        fillRule=\"evenodd\"\n        points=\"283.89 61.04 283.89 159.1 303.14 159.1 303.14 105.85 361.01 160.93 361.01 62.83 341.67 62.83 341.67 116.08 283.89 61.04\"\n      />\n    </svg>\n  );\n}\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\n\nimport versionInfo from '../../versionInfo';\nimport CloseButton from '../elements/CloseButton';\nimport Logo from '../elements/Logo';\n\nconst styles = css`\n  display: flex;\n  flex-direction: column;\n  user-select:\n  button:focus {\n    outline: none;\n  }\n  .header {\n    height: 34px;\n    border-bottom: 1px solid #f0f0f0;\n    display: flex;\n    padding: 5px;\n\n    span {\n      color: #464646;\n      font-size: 15px;\n      flex: 1;\n      user-select: none;\n\n    }\n\n    button {\n      background-color: transparent;\n      border: none;\n      svg {\n        height: 16px;\n      }\n    }\n  }\n  .container {\n    width: 100%;\n    height: 100%;\n    padding: 20px;\n  }\n\n  .center-container {\n    width: 100%;\n    height: 100%;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n  }\n  ul {\n    list-style-type: disc;\n    margin-left:20px;\n    }\n  span,li{\n    user-select: text;\n  }\n  span.title {\n    font-weight: bold;\n    color: #ea580c;\n  }\n  span.content {\n    color: #2b143e;\n    font-size: 14px;\n    text-align: left;\n  }\n\n  img {\n    width: 100px;\n  }\n\n  a {\n    color: #969696;\n  }\n\n  a:hover,\n  a:focus {\n    color: #00bcd4;\n  }\n\n  .separator {\n    border-bottom: 1px solid gray;\n    width: 15px;\n    height: 1px;\n    margin: 10px 0px;\n  }\n`;\n\ninterface AboutUsModalProps {\n  onClose?: () => null;\n}\n\nfunction AboutUsModal({ onClose = () => null }: AboutUsModalProps) {\n  return (\n    <div css={styles}>\n      <div className=\"header handle\">\n        <span>About NMRium</span>\n\n        <CloseButton onClick={onClose} />\n      </div>\n      <div className=\"container\">\n        <div className=\"center-container\">\n          <Logo width={160} height={50} />\n          Version <VersionInfo />\n          <span className=\"separator\" />\n          <a href=\"https://git.nmrium.org\" target=\"_blank\" rel=\"noreferrer\">\n            GitHub ( https://git.nmrium.org )\n          </a>\n        </div>\n        <div className=\"center-container\">\n          <span className=\"separator\" />\n        </div>\n\n        <span className=\"content\">\n          This project is developed by Zakodium Sàrl (Switzerland), the\n          University of Cologne (Germany), Johannes Gutenberg University Mainz\n          (Germany) and Universidad del Valle (Colombia).\n        </span>\n        <div className=\"center-container\">\n          <span className=\"separator\" />\n          <span className=\"title\">Funding is provided by</span>\n          <span className=\"separator\" />\n        </div>\n\n        <div className=\"content\">\n          <ul>\n            <li>\n              IDNMR grant, which part of the Scientific Library Services and\n              Information Systems (LIS) initiative of the DFG.\n            </li>\n            <li>Zakodium Sàrl (Switzerland).</li>\n            <li>Universidad del Valle (Cali, Colombia).</li>\n          </ul>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default AboutUsModal;\n\nfunction VersionInfo() {\n  const { version } = versionInfo;\n  if (version === 'HEAD') {\n    return <>HEAD</>;\n  } else if (version.startsWith('git-')) {\n    return (\n      <a\n        href={`https://github.com/cheminfo/nmrium/tree/${version.slice(4)}`}\n        target=\"_blank\"\n        rel=\"noreferrer\"\n      >\n        git-{version.slice(4, 14)}\n      </a>\n    );\n  } else {\n    return (\n      <a\n        href={`https://github.com/cheminfo/nmrium/tree/${version}`}\n        target=\"_blank\"\n        rel=\"noreferrer\"\n      >\n        {version}\n      </a>\n    );\n  }\n}\n","import Label from '../../elements/Label';\nimport FormikInput from '../../elements/formik/FormikInput';\n\nfunction ControllersTabContent() {\n  return (\n    <>\n      <p className=\"section-header\">Spectra</p>\n      <Label\n        title=\"Transparency of Dimmed Spectra [ 0 - 1 ]\"\n        // style={{ label: styles.inputLabel, wrapper: styles.inputWrapper }}\n      >\n        <FormikInput\n          name=\"controllers.dimmedSpectraTransparency\"\n          checkValue={(value) => value >= 0 && value <= 1}\n          type=\"number\"\n        />\n      </Label>\n    </>\n  );\n}\n\nexport default ControllersTabContent;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useFormikContext } from 'formik';\nimport lodashGet from 'lodash/get';\nimport { useCallback, useMemo } from 'react';\nimport { FaPlus, FaTimes } from 'react-icons/fa';\n\nimport { NMRiumWorkspace } from '../../NMRium';\nimport Button from '../../elements/Button';\nimport FormikCheckBox from '../../elements/formik/FormikCheckBox';\nimport FormikInput from '../../elements/formik/FormikInput';\nimport Workspaces from '../../workspaces';\n\nconst style = {\n  addButton: css`\n    background-color: transparent;\n    border: 0;\n    outline: none;\n    margin-left: 5px;\n    svg {\n      font-size: 14px;\n      fill: green;\n    }\n  `,\n  table: {\n    width: '100%',\n  },\n  th: {\n    fontSize: '12px',\n  },\n  input: {\n    input: { width: '100%' },\n  },\n  labelCol: {\n    width: '30%',\n  },\n  serialCol: {\n    width: '5%',\n  },\n};\n\ninterface DatabasesTabContentProps {\n  currentWorkspace: NMRiumWorkspace;\n}\n\nfunction DatabasesTabContent({ currentWorkspace }: DatabasesTabContentProps) {\n  const { values, setFieldValue } = useFormikContext();\n\n  const databases = useMemo(() => lodashGet(values, 'databases', []), [values]);\n\n  const deleteHandler = useCallback(\n    (index: number) => {\n      const _database = databases.slice();\n      _database.splice(index, 1);\n      setFieldValue('databases', _database);\n    },\n    [databases, setFieldValue],\n  );\n  const addNewDatabaseHandler = useCallback(() => {\n    const newDatabase = {\n      label: '',\n      url: '',\n      enabled: true,\n    };\n    setFieldValue('databases', [...databases, newDatabase]);\n  }, [databases, setFieldValue]);\n  const resetDatabaseHandler = useCallback(() => {\n    const database =\n      Workspaces?.[currentWorkspace]?.databases || Workspaces.default.databases;\n\n    setFieldValue('databases', database);\n  }, [currentWorkspace, setFieldValue]);\n\n  return (\n    <>\n      <div className=\"section-header\" style={{ display: 'flex' }}>\n        <p style={{ flex: 1 }}>Databases</p>\n        <div style={{ display: 'flex', justifyContent: 'space-between' }}>\n          <Button.Danger\n            fill=\"clear\"\n            size=\"xSmall\"\n            onClick={resetDatabaseHandler}\n            style={{ margin: '0 5px' }}\n          >\n            Reset Databases\n          </Button.Danger>\n          <Button.Done\n            fill=\"outline\"\n            size=\"xSmall\"\n            onClick={addNewDatabaseHandler}\n          >\n            Add Database\n          </Button.Done>\n        </div>\n      </div>\n      <div>\n        <table style={style.table}>\n          <thead>\n            <tr>\n              <th style={style.th}>#</th>\n              <th style={style.th}>Label </th>\n              <th style={style.th}>URL</th>\n              <th style={style.th}>Enabled</th>\n              <th />\n            </tr>\n          </thead>\n          <tbody>\n            {databases?.map((item, index) => {\n              const num = index + 1;\n              return (\n                // eslint-disable-next-line react/no-array-index-key\n                <tr key={`${index}`} style={{ height: '33px' }}>\n                  <td style={style.serialCol}>\n                    <span>{num}</span>{' '}\n                  </td>\n                  <td style={style.labelCol}>\n                    <FormikInput\n                      style={style.input}\n                      name={`databases.${index}.label`}\n                      checkErrorAfterInputTouched={false}\n                    />\n                  </td>\n                  <td>\n                    <FormikInput\n                      style={style.input}\n                      name={`databases.${index}.url`}\n                      checkErrorAfterInputTouched={false}\n                    />\n                  </td>\n                  <td>\n                    <FormikCheckBox\n                      style={{\n                        container: {\n                          display: 'block',\n                          margin: '0 auto',\n                          width: 'fit-content',\n                        },\n                      }}\n                      className=\"checkbox-element\"\n                      name={`databases.${index}.enabled`}\n                    />\n                  </td>\n                  <td>\n                    <div\n                      style={{\n                        display: 'flex',\n                        height: '100%',\n                      }}\n                    >\n                      <Button.Danger\n                        style={{ fontSize: '14px' }}\n                        fill=\"clear\"\n                        onClick={() => deleteHandler(index)}\n                      >\n                        <FaTimes />\n                      </Button.Danger>\n\n                      {databases.length === index + 1 && (\n                        <Button.Done\n                          fill=\"clear\"\n                          style={{ fontSize: '14px' }}\n                          onClick={addNewDatabaseHandler}\n                        >\n                          <FaPlus />\n                        </Button.Done>\n                      )}\n                    </div>\n                  </td>\n                </tr>\n              );\n            })}\n          </tbody>\n        </table>\n      </div>\n    </>\n  );\n}\n\nexport default DatabasesTabContent;\n","import lodashGet from 'lodash/get';\nimport { useMemo } from 'react';\n\nimport { NMRiumPreferences } from '../../NMRium';\nimport ReactTable from '../../elements/ReactTable/ReactTable';\nimport { CustomColumn } from '../../elements/ReactTable/utility/addCustomColumn';\nimport FormikCheckBox from '../../elements/formik/FormikCheckBox';\n\ninterface ListItem {\n  label: string;\n  name: string;\n  hideOpenOption?: boolean;\n}\nconst LIST: ListItem[] = [\n  {\n    label: 'Spectra selection panel',\n    name: 'panels.spectraPanel',\n  },\n  {\n    label: 'Spectra information Panel',\n    name: 'panels.informationPanel',\n  },\n  {\n    label: 'Peaks and peak picking',\n    name: 'panels.peaksPanel',\n  },\n  {\n    label: 'Integration and integrals',\n    name: 'panels.integralsPanel',\n  },\n  {\n    label: '1D ranges peak picking',\n    name: 'panels.rangesPanel',\n  },\n  {\n    label: 'Chemical structure panel',\n    name: 'panels.structuresPanel',\n  },\n  {\n    label: 'Filters Panel',\n    name: 'panels.filtersPanel',\n  },\n  {\n    label: '2D zones peak picking',\n    name: 'panels.zonesPanel',\n  },\n  {\n    label: 'Assignment summary Panel',\n    name: 'panels.summaryPanel',\n  },\n  {\n    label: 'Multiple Spectra Analysis Panel',\n    name: 'panels.multipleSpectraAnalysisPanel',\n  },\n  {\n    label: 'Databases Panel',\n    name: 'panels.databasePanel',\n  },\n  {\n    label: 'Prediction Panel',\n    name: 'panels.predictionPanel',\n  },\n  {\n    label: 'Experimental Features',\n    name: 'general.experimentalFeatures',\n    hideOpenOption: true,\n  },\n];\n\ninterface DisplayTabContentProps {\n  preferences: NMRiumPreferences;\n}\n\nfunction CheckBoxCell(props) {\n  return (\n    <FormikCheckBox\n      style={{\n        container: { display: 'block', margin: '0 auto', width: 'fit-content' },\n      }}\n      key={props.name}\n      className=\"checkbox-element\"\n      name={props.name}\n    />\n  );\n}\n\nfunction DisplayTabContent({ preferences }: DisplayTabContentProps) {\n  const COLUMNS: CustomColumn[] = useMemo(\n    () => [\n      {\n        index: 1,\n        Header: '#',\n        Cell: ({ row }) => row.index + 1,\n      },\n      {\n        index: 1,\n        Header: 'Feature',\n        accessor: 'label',\n        style: { width: '60%' },\n      },\n      {\n        index: 2,\n        Header: 'Active',\n        Cell: ({ row }) => (\n          <CheckBoxCell name={`display.${row.original.name}.display`} />\n        ),\n      },\n      {\n        index: 3,\n        Header: 'Open on load',\n        Cell: ({ row }) =>\n          !row.original.hideOpenOption ? (\n            <CheckBoxCell name={`display.${row.original.name}.open`} />\n          ) : (\n            <div />\n          ),\n      },\n    ],\n    [],\n  );\n\n  const data = useMemo(() => {\n    return LIST.filter(\n      (item) => lodashGet(preferences, `${item.name}.hidden`) !== true,\n    );\n  }, [preferences]);\n\n  return (\n    <div style={{ width: '100%', overflow: 'hidden' }}>\n      <ReactTable columns={COLUMNS} data={data} />\n    </div>\n  );\n}\n\nexport default DisplayTabContent;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useFormikContext } from 'formik';\nimport lodashGet from 'lodash/get';\nimport { Fragment, useCallback, useMemo } from 'react';\nimport { FaPlus, FaTimes } from 'react-icons/fa';\n\nimport generateID from '../../../data/utilities/generateID';\nimport Button from '../../elements/Button';\nimport FormikInput from '../../elements/formik/FormikInput';\n\nconst styles = css`\n  .counter-col {\n    width: 30px;\n  }\n  .nucleus-label-col {\n    display: flex;\n    justify-content: center;\n    width: 80px;\n  }\n\n  .input {\n    width: 100% !important;\n    margin: 0px !important;\n  }\n\n  .nucleus-format-input-col {\n    text-align: center;\n    width: 100px;\n  }\n\n  th {\n    font-size: 11px;\n    font-weight: 600;\n  }\n  .operation-container {\n    display: flex;\n  }\n  .add {\n    background-color: transparent;\n    border: 0;\n    outline: none;\n    svg {\n      font-szie: 14px;\n      fill: green;\n    }\n  }\n`;\n\nfunction FormattingTabContent() {\n  const { values, setFieldValue } = useFormikContext();\n  const nuclei = useMemo(\n    () => lodashGet(values, 'formatting.nuclei', {}),\n    [values],\n  );\n\n  const deleteHandler = useCallback(\n    (key: string) => {\n      let _nuclei = {};\n      for (const nucleus in nuclei) {\n        if (nucleus !== key) {\n          _nuclei[nucleus] = nuclei[nucleus];\n        }\n      }\n      setFieldValue('formatting.nuclei', _nuclei);\n    },\n    [nuclei, setFieldValue],\n  );\n\n  const addNewNucleusFormatHandler = useCallback(() => {\n    const newFormat = {\n      name: '',\n      ppm: '0.00',\n      hz: '0.00',\n    };\n    const key = generateID();\n    const newNuclei = { ...nuclei, [key]: newFormat };\n    setFieldValue('formatting.nuclei', newNuclei);\n  }, [nuclei, setFieldValue]);\n\n  const nucleiList = Object.keys(nuclei);\n\n  return (\n    <Fragment>\n      <p className=\"section-header\">Nuclei Formatting</p>\n      <div css={styles}>\n        <table>\n          <thead>\n            <tr>\n              <th className=\"counter-col\">#</th>\n              <th className=\"nucleus-label-col\">Nucleus </th>\n              <th className=\"nucleus-format-input-col\">δ (ppm)</th>\n              <th className=\"nucleus-format-input-col\">Coupling (Hz)</th>\n              <th className=\"nucleus-format-input-col\" />\n            </tr>\n          </thead>\n          <tbody>\n            {nucleiList?.map((key, index) => {\n              const num = index + 1;\n              return (\n                <tr key={`${key}`}>\n                  <td className=\"counter-col\">\n                    <span>{num} - </span>{' '}\n                  </td>\n                  <td className=\"nucleus-label-col\">\n                    <FormikInput\n                      name={`formatting.nuclei.${key}.name`}\n                      className=\"input\"\n                      checkErrorAfterInputTouched={false}\n                    />\n                  </td>\n                  <td className=\"nucleus-format-input-col\">\n                    <FormikInput\n                      name={`formatting.nuclei.${key}.ppm`}\n                      className=\"input\"\n                    />\n                  </td>\n                  <td className=\"nucleus-format-input-col\">\n                    <FormikInput\n                      name={`formatting.nuclei.${key}.hz`}\n                      className=\"input\"\n                    />\n                  </td>\n                  <td className=\"operation-container\">\n                    <Button.Danger\n                      style={{ fontSize: '14px' }}\n                      fill=\"clear\"\n                      onClick={() => deleteHandler(key)}\n                    >\n                      <FaTimes />\n                    </Button.Danger>\n                    {nucleiList.length === index + 1 && (\n                      <Button.Done\n                        fill=\"clear\"\n                        style={{ fontSize: '14px' }}\n                        onClick={addNewNucleusFormatHandler}\n                      >\n                        <FaPlus />\n                      </Button.Done>\n                    )}\n                  </td>\n                </tr>\n              );\n            })}\n          </tbody>\n        </table>\n      </div>\n    </Fragment>\n  );\n}\n\nexport default FormattingTabContent;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback, useState } from 'react';\n\nimport workspaces from '../../workspaces';\n\nconst styles = css`\n  .container {\n    display: flex;\n    span {\n      padding: 5px !important;\n    }\n    span {\n      flex: 1;\n      text-align: left !important;\n    }\n  }\n\n  .new-container {\n    background-color: #f6f6f6;\n    display: flex;\n    padding: 0.3em;\n\n    input {\n      padding: 0.5em;\n      color: black;\n      outline: none;\n      background-color: transparent !important;\n    }\n  }\n\n  .delete-button:hover {\n    color: white;\n  }\n\n  .save-button:hover {\n    color: green;\n  }\n  .delete-button,\n  .save-button {\n    padding: 5px;\n  }\n`;\n\nconst WorkspaceItem = ({ item, onSave, onDelete }) => {\n  const [name, setName] = useState<string>('');\n  const addWorkspaceHandler = useCallback(\n    (e) => {\n      e.stopPropagation();\n      setName('');\n      onSave(name);\n    },\n    [name, onSave],\n  );\n\n  const deleteWorkspaceHandler = useCallback(\n    (e) => {\n      e.stopPropagation();\n      onDelete(item.key);\n    },\n    [item.key, onDelete],\n  );\n\n  const onTextChange = useCallback((e) => {\n    setName(e.target.value);\n  }, []);\n\n  return (\n    <div css={styles}>\n      {item.key === 'new' ? (\n        <div className=\"new-container\">\n          <input\n            value={name}\n            placeholder=\"Custom workspace\"\n            onClick={(e) => e.stopPropagation()}\n            onChange={onTextChange}\n          />\n          <button\n            type=\"button\"\n            className=\"save-button\"\n            onClick={addWorkspaceHandler}\n            disabled={!name}\n          >\n            save\n          </button>\n        </div>\n      ) : (\n        <div className=\"container\">\n          <span>{item.label}</span>\n          {!workspaces[item.key] && (\n            <button\n              type=\"button\"\n              className=\"delete-button\"\n              onClick={deleteWorkspaceHandler}\n            >\n              Delete\n            </button>\n          )}\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default WorkspaceItem;\n","import * as Yup from 'yup';\n\nimport { Workspace } from '../../workspaces/Workspace';\n\nconst formattingElementValidation = (obj: Workspace) =>\n  Object.keys(obj.formatting.nuclei).reduce((validate, key) => {\n    validate[key] = Yup.object().shape({\n      name: Yup.string().trim().required('Nucleus is a required field'),\n      ppm: Yup.string().trim().required('PPM format is a required field'),\n      hz: Yup.string().trim().required('Hz format  is a required field'),\n    });\n    return validate;\n  }, {});\n\nconst formattingValidation = (obj: Workspace) =>\n  Yup.object().shape<any>({\n    nuclei: Yup.object()\n      .shape(formattingElementValidation(obj))\n      .test(\n        'Unique',\n        'Nuclei need te be unique',\n        function check(nuclei: Record<string, any>) {\n          let nucleusFrequencies: Record<\n            string,\n            { value: number; fields: string[] }\n          > = {};\n          for (const key of Object.keys(nuclei)) {\n            const _key = nuclei[key].name?.toLowerCase() || '';\n            if (_key) {\n              if (nucleusFrequencies[_key]) {\n                ++nucleusFrequencies[_key].value;\n                nucleusFrequencies[_key].fields.push(key);\n              } else {\n                nucleusFrequencies[_key] = { value: 1, fields: [key] };\n              }\n            }\n          }\n\n          const errors = Object.keys(nucleusFrequencies).reduce<\n            Yup.ValidationError[]\n          >((errorList, key) => {\n            const { value, fields } = nucleusFrequencies[key];\n            if (value > 1) {\n              for (let field of fields) {\n                errorList.push(\n                  new Yup.ValidationError(\n                    `${key} nucleus must te be unique`,\n                    nuclei[key].name,\n                    `${this.path}.${field}.name`,\n                  ),\n                );\n              }\n            }\n            return errorList;\n          }, []);\n\n          return new Yup.ValidationError(errors);\n        },\n      ),\n  });\n\nconst databasesValidation = Yup.array().of(\n  Yup.object().shape({\n    label: Yup.string().trim().required('Label is a required field'),\n    url: Yup.string().trim().url().required('URL is a required field'),\n  }),\n);\n\nexport const validation = Yup.lazy((obj: Workspace) =>\n  Yup.object().shape({\n    formatting: formattingValidation(obj),\n    databases: databasesValidation,\n  }),\n);\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback, useMemo, useRef, useState } from 'react';\n\nimport {\n  usePreferences,\n  useWorkspacesList,\n} from '../../context/PreferencesContext';\nimport ActionButtons from '../../elements/ActionButtons';\nimport CloseButton from '../../elements/CloseButton';\nimport Tab from '../../elements/Tab/Tab';\nimport Tabs, { PositionsEnum } from '../../elements/Tab/Tabs';\nimport DropDownButton, {\n  DropDownListItem,\n} from '../../elements/dropDownButton/DropDownButton';\nimport FormikForm from '../../elements/formik/FormikForm';\nimport { useAlert } from '../../elements/popup/Alert';\nimport { ModalStyles } from '../ModalStyle';\n\nimport ControllersTabContent from './ControllersTabContent';\nimport DatabasesTabContent from './DatabasesTabContent';\nimport DisplayTabContent from './DisplayTabContent';\nimport FormattingTabContent from './FormattingTabContent';\nimport WorkspaceItem from './WorkspaceItem';\nimport { validation } from './settingsValidation';\n\nconst styles = css`\n  .main-content {\n    width: 100%;\n    flex: 1;\n    overflow: auto;\n    border: none;\n  }\n\n  .tab-content {\n    width: 100%;\n  }\n\n  .section-header {\n    font-size: 13px;\n    color: #2ca8ff;\n    margin-bottom: 10px;\n    border-bottom: 0.55px solid #f9f9f9;\n    padding: 6px 2px;\n  }\n\n  .label {\n    font-size: 12px;\n    font-weight: bold;\n    margin-right: 10px;\n  }\n\n  .input {\n    font-size: 14px;\n    border-radius: 5px;\n    border: 1px solid #cccccc;\n    padding: 5px;\n    width: 100px;\n    margin-right: 10px;\n    height: initial !important;\n  }\n\n  .close-bt {\n    border: none;\n    color: red;\n    background-color: transparent;\n    outline: none;\n    position: absolute;\n    right: 10px;\n    top: 2px;\n    width: 30px;\n    height: 30px;\n  }\n\n  .checkbox-label {\n    min-width: 300px;\n    display: inline-block;\n  }\n\n  .help-checkbox-element {\n    .checkbox-label {\n      width: 260px;\n    }\n  }\n\n  .workspace-container {\n    display: flex;\n    background-color: #f4f4f4;\n    align-items: center;\n    cursor: default;\n    padding: 0.5em;\n    .dropdown {\n      padding: 0.4em 1em;\n    }\n    & .label {\n      font-size: 0.8em;\n    }\n  }\n`;\n\ninterface GeneralSettingsProps {\n  onClose?: () => void;\n}\n\nfunction GeneralSettings({ onClose }: GeneralSettingsProps) {\n  const [activeTab, setActiveTab] = useState('controllers');\n  const { dispatch, ...preferences } = usePreferences();\n  const alert = useAlert();\n  const refForm = useRef<any>();\n  const workspaces = useWorkspacesList();\n\n  const workspacesList = useMemo(() => {\n    return workspaces.concat([\n      {\n        key: 'new',\n        label: 'Custom workspace',\n      },\n    ]);\n  }, [workspaces]);\n\n  const handleSave = useCallback(() => {\n    refForm.current.submitForm();\n  }, []);\n  const handleReset = useCallback(() => {\n    dispatch({ type: 'RESET_PREFERENCES' });\n    alert.success('Settings saved successfully');\n    onClose?.();\n  }, [alert, dispatch, onClose]);\n\n  const submitHandler = useCallback(\n    (values) => {\n      dispatch({ type: 'SET_PREFERENCES', payload: values });\n      alert.success('Settings saved successfully');\n\n      onClose?.();\n    },\n    [alert, dispatch, onClose],\n  );\n\n  const tabChangeHandler = useCallback((tab) => {\n    setActiveTab(tab.tabid);\n  }, []);\n\n  const addWorkSpaceHandler = useCallback(\n    (name) => {\n      dispatch({\n        type: 'ADD_WORKSPACE',\n        payload: {\n          workspace: name,\n          data: refForm.current.values,\n        },\n      });\n    },\n    [dispatch],\n  );\n  const deleteWorkSpaceHandler = useCallback(\n    (key) => {\n      dispatch({\n        type: 'REMOVE_WORKSPACE',\n        payload: {\n          workspace: key,\n        },\n      });\n    },\n    [dispatch],\n  );\n\n  const ChangeWorkspaceHandler = useCallback(\n    (option: DropDownListItem) => {\n      dispatch({\n        type: 'SET_WORKSPACE',\n        payload: {\n          workspace: option.key,\n        },\n      });\n    },\n    [dispatch],\n  );\n\n  const renderItem = useCallback(\n    (item) => {\n      return (\n        <WorkspaceItem\n          item={item}\n          onSave={addWorkSpaceHandler}\n          onDelete={deleteWorkSpaceHandler}\n        />\n      );\n    },\n    [addWorkSpaceHandler, deleteWorkSpaceHandler],\n  );\n\n  return (\n    <div css={[ModalStyles, styles]}>\n      <div className=\"header handle\">\n        <span>General Settings</span>\n        <CloseButton onClick={onClose} className=\"close-bt\" />\n      </div>\n      <div className=\"workspace-container\">\n        <span className=\"label\">Workspace : </span>\n\n        <DropDownButton\n          data={workspacesList}\n          renderItem={renderItem}\n          selectedKey={preferences?.workspace.current}\n          onSelect={ChangeWorkspaceHandler}\n        />\n      </div>\n      <div className=\"main-content\">\n        <FormikForm\n          key={JSON.stringify(preferences.current)}\n          ref={refForm}\n          initialValues={preferences.current}\n          validationSchema={validation}\n          onSubmit={submitHandler}\n        >\n          <Tabs\n            position={PositionsEnum.LEFT}\n            activeTab={activeTab}\n            onClick={tabChangeHandler}\n          >\n            <Tab tablabel=\"Controllers\" tabid=\"controllers\">\n              <div className=\"inner-content\">\n                <ControllersTabContent />\n              </div>\n            </Tab>\n\n            <Tab tablabel=\"Formatting\" tabid=\"formatting\">\n              <div className=\"inner-content\">\n                <FormattingTabContent />\n              </div>\n            </Tab>\n\n            <Tab tablabel=\"Display\" tabid=\"display\">\n              <div className=\"inner-content\">\n                <DisplayTabContent preferences={preferences.current.display} />\n              </div>\n            </Tab>\n\n            <Tab tablabel=\"Databases\" tabid=\"databases\">\n              <div className=\"inner-content\">\n                <DatabasesTabContent\n                  currentWorkspace={preferences.workspace.current}\n                />\n              </div>\n            </Tab>\n          </Tabs>\n        </FormikForm>\n      </div>\n      <div className=\"footer-container\">\n        <ActionButtons\n          style={{ flexDirection: 'row-reverse', margin: 0 }}\n          onDone={handleSave}\n          doneLabel=\"Save\"\n          onCancel={handleReset}\n          cancelLabel=\"Reset\"\n        />\n      </div>\n    </div>\n  );\n}\n\nexport default GeneralSettings;\n","import { CSSProperties, useCallback, useRef } from 'react';\n\nimport { useDispatch } from '../context/DispatchContext';\nimport Button from '../elements/Button';\nimport CheckBox from '../elements/CheckBox';\nimport NumberInput from '../elements/NumberInput';\nimport { AUTO_PEAK_PICKING } from '../reducer/types/Types';\n\nconst styles: Record<\n  'container' | 'input' | 'inputContainer' | 'label',\n  CSSProperties\n> = {\n  container: {\n    height: '100%',\n    display: 'flex',\n    fontSize: '12px',\n    alignItems: 'center',\n  },\n  input: {\n    width: '50px',\n  },\n  inputContainer: {\n    flex: '2',\n  },\n  label: {\n    flex: '5',\n  },\n};\n\nfunction AutoPeakPickingOptionPanel() {\n  const dispatch = useDispatch();\n  const minMaxRatioRef = useRef<any>();\n  const maxNumberOfPeaksRef = useRef<any>();\n  const noiseFactor = useRef<any>();\n  const lookNegativeRef = useRef<any>();\n\n  const handleApplyFilter = useCallback(() => {\n    dispatch({\n      type: AUTO_PEAK_PICKING,\n      options: {\n        maxNumberOfPeaks: maxNumberOfPeaksRef.current.value,\n        minMaxRatio: minMaxRatioRef.current.value,\n        noiseFactor: noiseFactor.current.value,\n        lookNegative: lookNegativeRef.current.checked,\n      },\n    });\n  }, [dispatch]);\n\n  return (\n    <div style={styles.container}>\n      <NumberInput\n        ref={maxNumberOfPeaksRef}\n        label=\"Max Number Of Peaks:\"\n        name=\"maxNumberOfPeaks\"\n        style={{\n          input: styles.input,\n          inputContainer: styles.inputContainer,\n          label: styles.label,\n        }}\n        defaultValue={50}\n      />\n      <NumberInput\n        ref={noiseFactor}\n        label=\"Noise factor\"\n        name=\"noiseFactor\"\n        style={{\n          input: styles.input,\n          inputContainer: styles.inputContainer,\n          label: styles.label,\n        }}\n        defaultValue={3}\n      />\n      <NumberInput\n        ref={minMaxRatioRef}\n        label=\"Min Max Ratio:\"\n        name=\"minMaxRatio\"\n        style={{\n          input: styles.input,\n          inputContainer: styles.inputContainer,\n          label: styles.label,\n        }}\n        defaultValue={0.1}\n        step=\"0.01\"\n      />\n\n      <div style={{ justifyItems: 'baseline', marginRight: '3px' }}>\n        <label\n          style={{ marginRight: '2px', lineHeight: 2, userSelect: 'none' }}\n          htmlFor=\"lookNegative\"\n        >\n          Detect Negative:\n        </label>\n        <CheckBox name=\"lookNegative\" ref={lookNegativeRef} />\n      </div>\n      <Button.Done onClick={handleApplyFilter} style={{ margin: '0 10px' }}>\n        Apply\n      </Button.Done>\n    </div>\n  );\n}\n\nexport default AutoPeakPickingOptionPanel;\n","import { useCallback, useRef, useState, CSSProperties, useMemo } from 'react';\nimport * as Yup from 'yup';\n\nimport { baselineAlgorithms } from '../../data/data1d/filter1d/baselineCorrection';\nimport { useDispatch } from '../context/DispatchContext';\nimport ActionButtons from '../elements/ActionButtons';\nimport Label from '../elements/Label';\nimport Select from '../elements/Select';\nimport FormikForm from '../elements/formik/FormikForm';\nimport FormikInput from '../elements/formik/FormikInput';\nimport {\n  RESET_SELECTED_TOOL,\n  APPLY_BASE_LINE_CORRECTION_FILTER,\n} from '../reducer/types/Types';\n\nconst styles: Record<'container' | 'label', CSSProperties> = {\n  container: {\n    padding: '5px',\n    height: '100%',\n    display: 'flex',\n    alignItems: 'center',\n  },\n  label: {\n    lineHeight: 2,\n    userSelect: 'none',\n  },\n};\n\nfunction BaseLineCorrectionPanel() {\n  const dispatch = useDispatch();\n  const formRef = useRef<any>();\n  const algorithmRef = useRef<any>();\n\n  const [algorithm, setAlgorithm] = useState('polynomial');\n\n  const handleApplyFilter = useCallback(\n    (values) => {\n      let options = {};\n      switch (algorithm) {\n        case 'airpls':\n          options = {\n            algorithm: algorithmRef.current.value,\n            ...values,\n          };\n          break;\n        case 'polynomial':\n          options = {\n            algorithm: algorithmRef.current.value,\n            ...values,\n          };\n          break;\n        default:\n          break;\n      }\n      dispatch({\n        type: APPLY_BASE_LINE_CORRECTION_FILTER,\n        options,\n      });\n    },\n    [algorithm, dispatch],\n  );\n\n  const handleCancelFilter = useCallback(() => {\n    dispatch({\n      type: RESET_SELECTED_TOOL,\n    });\n  }, [dispatch]);\n\n  const getAlgorithmsList = useCallback(() => {\n    return Object.keys(baselineAlgorithms).map((val) => {\n      return { key: val, label: baselineAlgorithms[val], value: val };\n    });\n  }, []);\n\n  const changeAlgorithmHandler = useCallback((val) => {\n    setAlgorithm(val);\n  }, []);\n\n  const formData = useMemo(() => {\n    switch (algorithm) {\n      case 'airpls': {\n        const validation = Yup.object().shape({\n          maxIterations: Yup.number().integer().min(1).required(),\n          tolerance: Yup.number().moreThan(0).required(),\n        });\n        return {\n          validation,\n          initialValue: { maxIterations: 100, tolerance: 0.001 },\n        };\n      }\n      case 'autoPolynomial':\n      case 'polynomial': {\n        const validation = Yup.object().shape({\n          degree: Yup.number().integer().min(1).max(6).required(),\n        });\n\n        return { validation, initialValue: { degree: 3 } };\n      }\n      default:\n        return { validation: {}, initialValue: {} };\n    }\n  }, [algorithm]);\n\n  return (\n    <div style={styles.container}>\n      <span style={styles.label}>Algorithm: </span>\n      <Select\n        ref={algorithmRef}\n        data={getAlgorithmsList()}\n        style={{ marginLeft: 10, marginRight: 10 }}\n        onChange={changeAlgorithmHandler}\n        defaultValue=\"polynomial\"\n      />\n\n      <FormikForm\n        ref={formRef}\n        onSubmit={handleApplyFilter}\n        key={JSON.stringify(formData.initialValue)}\n        initialValues={formData.initialValue}\n        validationSchema={formData.validation}\n      >\n        {algorithm && algorithm === 'airpls' && (\n          <div style={{ display: 'flex' }}>\n            <Label title=\"maxIterations:\">\n              <FormikInput type=\"number\" name=\"maxIterations\" />\n            </Label>\n            <Label title=\"tolerance:\" style={{ label: { padding: '0 5px' } }}>\n              <FormikInput type=\"number\" name=\"tolerance\" />\n            </Label>\n          </div>\n        )}\n\n        {algorithm && ['autoPolynomial', 'polynomial'].includes(algorithm) && (\n          <Label title=\"degree [ 1 - 6 ]:\">\n            <FormikInput\n              type=\"number\"\n              name=\"degree\"\n              min={1}\n              max={6}\n              style={{ inputWrapper: { height: '100%' } }}\n            />\n          </Label>\n        )}\n      </FormikForm>\n\n      <ActionButtons\n        onDone={() => formRef.current.submitForm()}\n        onCancel={handleCancelFilter}\n      />\n    </div>\n  );\n}\n\nexport default BaseLineCorrectionPanel;\n","import {\n  CSSProperties,\n  forwardRef,\n  useCallback,\n  useImperativeHandle,\n  useRef,\n} from 'react';\n\nconst styles: Record<'container' | 'label', CSSProperties> = {\n  container: {\n    width: '100%',\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'center',\n    border: '0.55px solid #c7c7c7',\n    borderRadius: '5px',\n    userSelect: 'none',\n    backgroundColor: '#18ce0f14',\n    fontSize: '10px',\n    color: '#00801d',\n    margin: '0px 5px',\n    cursor: 'ew-resize',\n  },\n  label: {\n    whiteSpace: 'nowrap',\n    textOverflow: 'ellipsis',\n    overflow: 'hidden',\n    maxWidth: '100%',\n    paddingLeft: '5px',\n    paddingRight: '5px',\n  },\n};\n\ninterface InputRangeProps {\n  name: string;\n  value?: number;\n  onChange: (element: any) => void;\n  label?: string;\n  style?: CSSProperties;\n  className?: string;\n}\n\n// TODO: remove this hacky ref usage.\nfunction InputRange(props: InputRangeProps, ref: any) {\n  const { name, value = 0, onChange, label, style, className } = props;\n  const previousPosition = useRef(0);\n  const valueRef = useRef(value);\n\n  useImperativeHandle(ref, () => ({\n    setValue: (value) => {\n      valueRef.current = value;\n    },\n  }));\n\n  const mouseDownCallback = useCallback(\n    (event) => {\n      function mouseMoveCallback(event) {\n        let diff = event.clientX - previousPosition.current;\n        previousPosition.current = event.clientX;\n        if (event.buttons === 1) {\n          const step = diff / (event.shiftKey ? 10 : 1);\n          valueRef.current = valueRef.current + step;\n          onChange({\n            value: valueRef.current,\n            name,\n          });\n        }\n      }\n\n      function mouseUpCallback() {\n        window.removeEventListener('mousemove', mouseMoveCallback);\n        window.removeEventListener('mouseup', mouseUpCallback);\n      }\n\n      previousPosition.current = event.clientX;\n      window.addEventListener('mousemove', mouseMoveCallback);\n      window.addEventListener('mouseup', mouseUpCallback);\n    },\n    [name, onChange],\n  );\n\n  return (\n    <div\n      style={{ ...styles.container, ...style }}\n      className={className}\n      onMouseDown={mouseDownCallback}\n    >\n      <span style={styles.label}>{label}</span>\n    </div>\n  );\n}\n\nexport default forwardRef(InputRange);\n","import {\n  useMemo,\n  CSSProperties,\n  memo,\n  useCallback,\n  useEffect,\n  useRef,\n  useState,\n} from 'react';\n\nimport * as Filters from '../../data/Filters';\nimport { Filter } from '../../data/FiltersManager';\nimport { Data1D, Datum1D } from '../../data/types/data1d';\nimport { useChartData } from '../context/ChartContext';\nimport { useDispatch } from '../context/DispatchContext';\nimport ActionButtons from '../elements/ActionButtons';\nimport Input from '../elements/Input';\nimport InputRange from '../elements/InputRange';\nimport Label from '../elements/Label';\nimport Select from '../elements/Select';\nimport useSpectrum from '../hooks/useSpectrum';\nimport {\n  APPLY_MANUAL_PHASE_CORRECTION_FILTER,\n  APPLY_AUTO_PHASE_CORRECTION_FILTER,\n  CALCULATE_MANUAL_PHASE_CORRECTION_FILTER,\n  RESET_SELECTED_TOOL,\n  APPLY_ABSOLUTE_FILTER,\n} from '../reducer/types/Types';\n\nconst styles: Record<'container' | 'input' | 'select', CSSProperties> = {\n  container: {\n    padding: '5px',\n    height: '100%',\n    display: 'flex',\n  },\n  input: {\n    width: '100px',\n  },\n  select: {\n    marginLeft: '5px',\n    marginRight: '10px',\n    border: 'none',\n    height: '20px',\n  },\n};\n\nconst phaseCorrectionTypes = {\n  manual: 'manual',\n  automatic: 'automatic',\n  absolute: 'absolute',\n};\n\nconst algorithms = [\n  {\n    key: phaseCorrectionTypes.manual,\n    label: 'Manual',\n    value: phaseCorrectionTypes.manual,\n  },\n  {\n    key: phaseCorrectionTypes.automatic,\n    label: 'Automatic',\n    value: phaseCorrectionTypes.automatic,\n  },\n  {\n    key: phaseCorrectionTypes.absolute,\n    label: 'Absolute',\n    value: phaseCorrectionTypes.absolute,\n  },\n];\n\ninterface ManualPhaseCorrectionPanelInnerProps {\n  data: Data1D;\n  pivot: { index: number };\n  filter: Filter | null;\n}\n\nfunction ManualPhaseCorrectionPanelInner({\n  data,\n  pivot,\n  filter,\n}: ManualPhaseCorrectionPanelInnerProps) {\n  const dispatch = useDispatch();\n  const [value, setValue] = useState({ ph0: 0, ph1: 0 });\n  const valueRef = useRef({ ph0: 0, ph1: 0 });\n\n  const ph0Ref = useRef<any>();\n  const ph1Ref = useRef<any>();\n\n  const [phaseCorrectionType, setPhaseCorrectionType] = useState(\n    phaseCorrectionTypes.manual,\n  );\n\n  useEffect(() => {\n    if (filter) {\n      valueRef.current = filter.value;\n      setValue(filter.value);\n      ph0Ref.current.setValue(filter.value.ph0);\n      ph1Ref.current.setValue(filter.value.ph1);\n    } else {\n      ph0Ref.current.setValue(valueRef.current.ph0);\n      ph1Ref.current.setValue(valueRef.current.ph1);\n    }\n  }, [filter]);\n\n  const handleApplyFilter = useCallback(() => {\n    switch (phaseCorrectionType) {\n      case phaseCorrectionTypes.automatic: {\n        dispatch({\n          type: APPLY_AUTO_PHASE_CORRECTION_FILTER,\n        });\n        break;\n      }\n\n      case phaseCorrectionTypes.manual: {\n        dispatch({\n          type: APPLY_MANUAL_PHASE_CORRECTION_FILTER,\n          value,\n        });\n        break;\n      }\n      case phaseCorrectionTypes.absolute: {\n        dispatch({\n          type: APPLY_ABSOLUTE_FILTER,\n        });\n        break;\n      }\n      default:\n        break;\n    }\n  }, [dispatch, phaseCorrectionType, value]);\n\n  const calcPhaseCorrectionHandler = useCallback(\n    (newValues, filedName) => {\n      if (filedName === 'ph1' && data.re) {\n        const diff0 = newValues.ph0 - valueRef.current.ph0;\n        const diff1 = newValues.ph1 - valueRef.current.ph1;\n        newValues.ph0 += diff0 - (diff1 * pivot?.index) / data.re.length;\n      }\n\n      dispatch({\n        type: CALCULATE_MANUAL_PHASE_CORRECTION_FILTER,\n        value: newValues,\n      });\n    },\n    [data.re, dispatch, pivot?.index],\n  );\n\n  const handleInput = useCallback(\n    (e) => {\n      const { name, value } = e.target;\n      if (e.target) {\n        const newValue = { ...valueRef.current, [name]: value };\n        if (String(value).trim() !== '-') {\n          calcPhaseCorrectionHandler(newValue, name);\n        }\n        valueRef.current = newValue;\n        setValue(valueRef.current);\n      }\n    },\n    [calcPhaseCorrectionHandler],\n  );\n\n  const handleRangeChange = useCallback(\n    (e) => {\n      const newValue = { ...valueRef.current, [e.name]: e.value };\n      calcPhaseCorrectionHandler(newValue, e.name);\n      valueRef.current = newValue;\n      setValue(valueRef.current);\n    },\n    [calcPhaseCorrectionHandler],\n  );\n\n  const handleCancelFilter = useCallback(() => {\n    dispatch({\n      type: RESET_SELECTED_TOOL,\n    });\n  }, [dispatch]);\n\n  const onChangeHandler = useCallback((val) => {\n    setPhaseCorrectionType(val);\n  }, []);\n\n  return (\n    <div style={styles.container}>\n      <Select\n        onChange={onChangeHandler}\n        data={algorithms}\n        defaultValue={phaseCorrectionTypes.manual}\n        style={styles.select}\n      />\n\n      {phaseCorrectionType === phaseCorrectionTypes.manual && (\n        <>\n          <Label title=\"PH0 :\" style={{ wrapper: { marginRight: '5px' } }}>\n            <Input\n              name=\"ph0\"\n              style={{ input: styles.input }}\n              onChange={handleInput}\n              value={value.ph0}\n              type=\"number\"\n              debounceTime={250}\n            />\n          </Label>\n          <Label title=\"PH1 :\">\n            <Input\n              name=\"ph1\"\n              style={{ input: styles.input }}\n              onChange={handleInput}\n              value={value.ph1}\n              type=\"number\"\n              debounceTime={250}\n            />\n          </Label>\n          <InputRange\n            ref={ph0Ref}\n            name=\"ph0\"\n            label=\"Change Ph0 By mouse click and drag\"\n            style={{ width: '20%' }}\n            onChange={handleRangeChange}\n          />\n          <InputRange\n            ref={ph1Ref}\n            name=\"ph1\"\n            label=\"Change Ph1 By mouse click and drag\"\n            style={{ width: '20%' }}\n            onChange={handleRangeChange}\n          />\n        </>\n      )}\n\n      <ActionButtons onDone={handleApplyFilter} onCancel={handleCancelFilter} />\n    </div>\n  );\n}\n\nconst MemoizedManualPhaseCorrectionPanel = memo(\n  ManualPhaseCorrectionPanelInner,\n);\n\nconst emptyData = { datum: {}, filter: null };\nexport default function ManualPhaseCorrectionPanel() {\n  const {\n    toolOptions: {\n      data: { pivot },\n    },\n  } = useChartData();\n\n  const { data, filters } = useSpectrum(emptyData) as Datum1D;\n\n  const filter = useMemo(() => {\n    return (\n      filters.find((filter) => filter.name === Filters.phaseCorrection.id) ||\n      null\n    );\n  }, [filters]);\n\n  return <MemoizedManualPhaseCorrectionPanel {...{ data, filter, pivot }} />;\n}\n","import { CSSProperties, useCallback, useRef } from 'react';\n\nimport { useDispatch } from '../context/DispatchContext';\nimport Button from '../elements/Button';\nimport CheckBox from '../elements/CheckBox';\nimport NumberInput from '../elements/NumberInput';\nimport { AUTO_RANGES_DETECTION } from '../reducer/types/Types';\n\nconst styles: Record<\n  'container' | 'input' | 'inputContainer' | 'label' | 'hint',\n  CSSProperties\n> = {\n  container: {\n    padding: '5px',\n    height: '100%',\n    display: 'flex',\n    fontSize: '12px',\n    alignItems: 'baseline',\n  },\n  input: {\n    height: '100%',\n    width: '50px',\n    borderRadius: '5px',\n    border: '0.55px solid #c7c7c7',\n    margin: '0px 5px 0px 5px',\n    textAlign: 'center',\n  },\n  inputContainer: {\n    flex: 2,\n  },\n  label: {\n    flex: 5,\n  },\n\n  hint: {\n    lineHeight: 2,\n    userSelect: 'none',\n    fontSize: '11px',\n  },\n};\n\nfunction RangesPickingOptionPanel() {\n  const dispatch = useDispatch();\n  const lookNegativeRef = useRef<any>();\n  const minMaxRatioRef = useRef<any>();\n\n  const handleApplyFilter = useCallback(() => {\n    dispatch({\n      type: AUTO_RANGES_DETECTION,\n      options: {\n        peakPicking: {\n          minMaxRatio: Number(minMaxRatioRef.current.value) || 0.05,\n          lookNegative: lookNegativeRef.current.checked,\n        },\n      },\n    });\n  }, [dispatch]);\n\n  return (\n    <div style={styles.container}>\n      <div style={{ justifyItems: 'baseline', margin: '0 10px' }}>\n        <label\n          style={{ marginRight: '2px', lineHeight: 2, userSelect: 'none' }}\n          htmlFor=\"lookNegative\"\n        >\n          Detect negative:\n        </label>\n        <CheckBox name=\"lookNegative\" ref={lookNegativeRef} />\n      </div>\n      <NumberInput\n        ref={minMaxRatioRef}\n        label=\"Min Max Ratio:\"\n        name=\"minMaxRatio\"\n        style={{\n          input: styles.input,\n          inputContainer: styles.inputContainer,\n          label: styles.label,\n        }}\n        defaultValue={0.05}\n        step=\"0.01\"\n      />\n\n      <Button.Done onClick={handleApplyFilter} style={{ margin: '0 10px' }}>\n        Auto ranges picking\n      </Button.Done>\n      <span style={styles.hint}>\n        Manual selection using SHIFT + select zone or click on Auto peak picking\n      </span>\n    </div>\n  );\n}\n\nexport default RangesPickingOptionPanel;\n","import { CSSProperties, useCallback, useRef, useState } from 'react';\n\nimport { Data1D } from '../../data/types/data1d';\nimport generateNumbersPowerOfX from '../../data/utilities/generateNumbersPowerOfX';\nimport { useChartData } from '../context/ChartContext';\nimport { useDispatch } from '../context/DispatchContext';\nimport ActionButtons from '../elements/ActionButtons';\nimport Select from '../elements/Select';\nimport {\n  APPLY_ZERO_FILLING_FILTER,\n  RESET_SELECTED_TOOL,\n} from '../reducer/types/Types';\n\nconst styles: Record<'container' | 'input' | 'label', CSSProperties> = {\n  container: {\n    padding: '5px',\n    height: '100%',\n    display: 'flex',\n  },\n\n  input: {\n    height: '100%',\n    width: '80px',\n    borderRadius: '5px',\n    border: '0.55px solid #c7c7c7',\n    margin: '0px 5px 0px 5px',\n    textAlign: 'center',\n  },\n\n  label: {\n    lineHeight: 2,\n    userSelect: 'none',\n  },\n};\n\nconst Sizes = generateNumbersPowerOfX(8, 21);\n\nfunction ZeroFillingOptionsPanel() {\n  const dispatch = useDispatch();\n  const { data, activeSpectrum } = useChartData();\n  const sizeTextInputRef = useRef<any>();\n  const [lineBroadeningValue, setLineBroadeningValue] = useState(1);\n\n  const handleApplyFilter = useCallback(() => {\n    dispatch({\n      type: APPLY_ZERO_FILLING_FILTER,\n      value: {\n        zeroFillingSize: Number(sizeTextInputRef.current.value),\n        lineBroadeningValue: lineBroadeningValue,\n      },\n    });\n  }, [dispatch, lineBroadeningValue]);\n\n  const getDefaultValue = useCallback(() => {\n    if (data && activeSpectrum?.id) {\n      return (\n        2 **\n        Math.round(\n          Math.log2((data[activeSpectrum.index].data as Data1D).x.length),\n        )\n      );\n    }\n    return '';\n  }, [activeSpectrum, data]);\n\n  const handleInput = useCallback(\n    (e) => {\n      if (e.target) {\n        const _value = e.target.validity.valid\n          ? Number(e.target.value)\n          : lineBroadeningValue;\n        setLineBroadeningValue(_value);\n      }\n    },\n    [lineBroadeningValue],\n  );\n\n  const handleCancelFilter = useCallback(() => {\n    dispatch({\n      type: RESET_SELECTED_TOOL,\n    });\n  }, [dispatch]);\n\n  return (\n    <div style={styles.container}>\n      <span style={styles.label}>Size: </span>\n      <Select\n        ref={sizeTextInputRef}\n        data={Sizes}\n        style={{ marginLeft: 10, marginRight: 10 }}\n        defaultValue={getDefaultValue()}\n      />\n      <span style={styles.label}>Line Broadening: </span>\n      <input\n        name=\"line-broadening\"\n        style={styles.input}\n        type=\"number\"\n        defaultValue={lineBroadeningValue}\n        onInput={handleInput}\n        pattern=\"^\\d*(\\.\\d{0,2})?$\"\n        step=\"any\"\n      />\n      <ActionButtons onDone={handleApplyFilter} onCancel={handleCancelFilter} />\n    </div>\n  );\n}\n\nexport default ZeroFillingOptionsPanel;\n","import { CSSProperties, useCallback, useRef } from 'react';\n\nimport { useDispatch } from '../context/DispatchContext';\nimport Button from '../elements/Button';\nimport NumberInput from '../elements/NumberInput';\nimport {\n  AUTO_ZONES_DETECTION,\n  CHANGE_ZONES_NOISE_FACTOR,\n} from '../reducer/types/Types';\n\nconst styles: Record<\n  'container' | 'input' | 'inputContainer' | 'label',\n  CSSProperties\n> = {\n  container: {\n    padding: '5px',\n    height: '100%',\n    display: 'flex',\n    fontSize: '12px',\n  },\n  input: {\n    width: '50px',\n  },\n  inputContainer: {\n    flex: '2',\n  },\n  label: {\n    flex: '5',\n  },\n};\n\nfunction Zones2DOptionPanel() {\n  const dispatch = useDispatch();\n  const thresholdFactor = useRef<any>();\n\n  const handleApplyFilter = useCallback(() => {\n    dispatch({\n      type: AUTO_ZONES_DETECTION,\n      options: {\n        thresholdFactor: thresholdFactor.current.value,\n      },\n    });\n  }, [dispatch]);\n\n  const handleInput = useCallback(\n    (e) => {\n      if (e.target) {\n        dispatch({ type: CHANGE_ZONES_NOISE_FACTOR, payload: e.target.value });\n      }\n    },\n    [dispatch],\n  );\n\n  return (\n    <div style={styles.container}>\n      <NumberInput\n        ref={thresholdFactor}\n        label=\"NoiseFactor\"\n        name=\"noiseFactor\"\n        style={{\n          input: styles.input,\n          inputContainer: styles.inputContainer,\n          label: styles.label,\n        }}\n        defaultValue={1}\n        onChange={handleInput}\n      />\n      <Button.Done onClick={handleApplyFilter} style={{ margin: '0 10px' }}>\n        Auto Zones Picking\n      </Button.Done>\n    </div>\n  );\n}\n\nexport default Zones2DOptionPanel;\n","import { Header, Toolbar } from 'analysis-ui-components';\nimport { SvgLogoNmrium } from 'cheminfo-font';\nimport { useMemo, useCallback, memo } from 'react';\nimport {\n  FaRegWindowMaximize,\n  FaWrench,\n  FaQuestionCircle,\n} from 'react-icons/fa';\n\nimport { docsBaseUrl } from '../../constants';\nimport { useChartData } from '../context/ChartContext';\nimport {\n  usePreferences,\n  useWorkspacesList,\n} from '../context/PreferencesContext';\nimport DropDownButton, {\n  DropDownListItem,\n} from '../elements/dropDownButton/DropDownButton';\nimport { useModal, positions } from '../elements/popup/Modal';\nimport AboutUsModal from '../modal/AboutUsModal';\nimport GeneralSettings from '../modal/setting/GeneralSettings';\nimport { options } from '../toolbar/ToolTypes';\n\nimport AutoPeakPickingOptionPanel from './AutoPeakPickingOptionPanel';\nimport BaseLineCorrectionPanel from './BaseLineCorrectionPanel';\nimport ManualPhaseCorrectionPanel from './ManualPhaseCorrectionPanel';\nimport RangesPickingOptionPanel from './RangesPickingOptionPanel';\nimport ZeroFillingOptionsPanel from './ZeroFillingOptionsPanel';\nimport Zones2DOptionPanel from './Zones2DOptionPanel';\n\ninterface HeaderInnerProps {\n  onMaximize?: () => void;\n  isFullscreen: boolean;\n  selectedOptionPanel: string | null;\n}\n\nfunction HeaderInner(props: HeaderInnerProps) {\n  const { isFullscreen, onMaximize = () => null, selectedOptionPanel } = props;\n\n  const modal = useModal();\n  const {\n    current: {\n      display: { general },\n    },\n    workspace,\n    dispatch,\n  } = usePreferences();\n\n  const workspacesList = useWorkspacesList();\n  const hideGeneralSettings =\n    general?.hideGeneralSettings && workspace.base ? true : false;\n\n  const selectedPanel = useMemo(() => {\n    switch (selectedOptionPanel) {\n      case options.zeroFilling.id:\n        return <ZeroFillingOptionsPanel />;\n      case options.phaseCorrection.id:\n        return <ManualPhaseCorrectionPanel />;\n      case options.peakPicking.id:\n        return <AutoPeakPickingOptionPanel />;\n      case options.rangesPicking.id:\n        return <RangesPickingOptionPanel />;\n      case options.baseLineCorrection.id:\n        return <BaseLineCorrectionPanel />;\n      case options.zone2D.id:\n        return <Zones2DOptionPanel />;\n      default:\n        break;\n    }\n  }, [selectedOptionPanel]);\n\n  const openGeneralSettingsHandler = useCallback(() => {\n    modal.show(<GeneralSettings />, {\n      position: positions.TOP_CENTER,\n      enableResizing: true,\n      width: 600,\n      height: 400,\n    });\n  }, [modal]);\n\n  const openAboutUs = useCallback(() => {\n    modal.show(<AboutUsModal />, {\n      isBackgroundBlur: false,\n      position: positions.MIDDLE,\n      width: 500,\n      height: 480,\n    });\n  }, [modal]);\n\n  const changeWorkspaceHandler = useCallback(\n    (option: DropDownListItem) => {\n      dispatch({\n        type: 'SET_WORKSPACE',\n        payload: {\n          workspace: option.key,\n        },\n      });\n    },\n    [dispatch],\n  );\n\n  return (\n    <Header>\n      <div\n        style={{\n          display: 'flex',\n          flexDirection: 'row',\n          alignItems: 'center',\n        }}\n      >\n        <div>\n          <Toolbar orientation=\"horizontal\">\n            <Toolbar.Item\n              onClick={openAboutUs}\n              titleOrientation=\"horizontal\"\n              id=\"logo\"\n              title=\"About NMRium\"\n            >\n              <div\n                style={{\n                  display: 'flex',\n                  alignItems: 'center',\n                  justifyContent: 'center',\n                }}\n              >\n                <SvgLogoNmrium />\n              </div>\n            </Toolbar.Item>\n          </Toolbar>\n        </div>\n        <div className=\"toolOptionsPanel\">{selectedPanel}</div>\n      </div>\n      <div\n        style={{\n          display: 'flex',\n          flexDirection: 'row',\n          alignItems: 'center',\n        }}\n      >\n        {!hideGeneralSettings && (\n          <DropDownButton\n            data={workspacesList}\n            selectedKey={workspace.current}\n            onSelect={changeWorkspaceHandler}\n          />\n        )}\n        <div>\n          <Toolbar orientation=\"horizontal\">\n            <Toolbar.Item\n              id=\"user-manual\"\n              title=\"User manual\"\n              onClick={() => window.open(docsBaseUrl, '_blank')}\n            >\n              <FaQuestionCircle />\n            </Toolbar.Item>\n            {!hideGeneralSettings && (\n              <Toolbar.Item\n                id=\"general-settings\"\n                onClick={openGeneralSettingsHandler}\n                title=\"General settings\"\n              >\n                <FaWrench />\n              </Toolbar.Item>\n            )}\n\n            {!isFullscreen && (\n              <Toolbar.Item\n                id=\"full-screen\"\n                onClick={onMaximize}\n                title=\"Full Screen\"\n                className=\"windowButton\"\n              >\n                <FaRegWindowMaximize />\n              </Toolbar.Item>\n            )}\n          </Toolbar>\n        </div>\n      </div>\n    </Header>\n  );\n}\n\nconst MemoizedHeader = memo(HeaderInner);\n\nexport default function HeaderWrapper({ isFullscreen, onMaximize }) {\n  const {\n    toolOptions: { selectedOptionPanel },\n  } = useChartData();\n  return (\n    <MemoizedHeader\n      {...{\n        selectedOptionPanel,\n        isFullscreen,\n        onMaximize,\n      }}\n    />\n  );\n}\n","export const FILES_TYPES = {\n  MOL: 'mol',\n  NMRIUM: 'nmrium',\n  JSON: 'json',\n  DX: 'dx',\n  JDX: 'jdx',\n  JDF: 'jdf',\n  ZIP: 'zip',\n  NMREDATA: 'nmredata',\n};\nexport const FILES_SIGNATURES = {\n  ZIP: '504b0304',\n};\n\nfunction getFileSignature(fileArrayBuffer) {\n  return new Uint8Array(fileArrayBuffer)\n    .slice(0, 4)\n    .reduce((acc, byte) => (acc += byte.toString(16).padStart(2, '0')), '');\n}\n\nasync function loadFile(file, options = { asBuffer: false }) {\n  const response = await fetch(file);\n  checkStatus(response);\n  const data = options.asBuffer ? response.arrayBuffer() : response.text();\n  return data;\n}\n\nfunction checkStatus(response) {\n  if (!response.ok) {\n    throw new Error(`HTTP ${response.status} - ${response.statusText}`);\n  }\n  return response;\n}\n\nfunction getFileExtension(name) {\n  return name.replace(/^.*\\./, '').toLowerCase();\n}\n\nfunction getFileName(name) {\n  return name.substr(0, name.lastIndexOf('.'));\n}\n\nfunction extractFileMetaFromPath(path) {\n  const meta = path.replace(/^.*[\\\\/]/, '').split('.');\n\n  return { name: meta[0].toLowerCase(), extension: meta[1].toLowerCase() };\n}\n/**\n *\n * @param {Array<File>} acceptedFiles\n * @param {object} options\n * @param {boolean} options.asBuffer\n * @returns\n */\nfunction loadFiles<T = unknown>(\n  acceptedFiles,\n  options: { asBuffer?: boolean } = {},\n) {\n  return Promise.all(\n    ([] as Array<T>).map.call(acceptedFiles, (file: any) => {\n      return new Promise((resolve, reject) => {\n        const reader = new FileReader();\n        reader.onabort = (e) => reject(e);\n        reader.onerror = (e) => reject(e);\n        reader.onload = () => {\n          if (reader.result) {\n            const binary = reader.result;\n            const name = getFileName(file.name);\n            const extension = getFileExtension(file.name);\n            resolve({ binary, name, extension });\n          }\n        };\n        if (options.asBuffer) {\n          reader.readAsArrayBuffer(file);\n        } else {\n          reader.readAsBinaryString(file);\n        }\n      });\n    }),\n  ) as Promise<Array<T>>;\n}\n\nasync function loadFilesFromZip(files, options: { asBuffer?: boolean } = {}) {\n  const result: Array<{ binary: any; name: string; extension: string }> = [];\n  for (const file of files) {\n    try {\n      const binary = await file.async(options.asBuffer ? 'uint8array' : 'text');\n      const name = getFileName(file.name);\n      const extension = getFileExtension(file.name);\n      result.push({ binary, name, extension });\n    } catch (e) {\n      // eslint-disable-next-line no-console\n      console.error(e);\n    }\n  }\n  return result;\n}\n\nexport {\n  loadFiles,\n  loadFilesFromZip,\n  loadFile,\n  getFileExtension,\n  getFileName,\n  extractFileMetaFromPath,\n  getFileSignature,\n};\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport Zip from 'jszip';\nimport { useCallback } from 'react';\nimport { useDropzone } from 'react-dropzone';\nimport { FaUpload } from 'react-icons/fa';\n\nimport { File } from '../../data/types/common/File';\nimport { useChartData } from '../context/ChartContext';\nimport { useDispatch } from '../context/DispatchContext';\nimport { LoaderProvider } from '../context/LoaderContext';\nimport { useAlert } from '../elements/popup/Alert';\nimport {\n  LOAD_MOL_FILE,\n  LOAD_JSON_FILE,\n  LOAD_JCAMP_FILE,\n  SET_LOADING_FLAG,\n  LOAD_ZIP_FILE,\n  LOAD_JDF_FILE,\n  LOAD_NMREDATA_FILE,\n} from '../reducer/types/Types';\nimport {\n  FILES_TYPES,\n  FILES_SIGNATURES,\n  getFileExtension,\n  getFileSignature,\n  loadFiles,\n  loadFilesFromZip,\n} from '../utility/FileUtility';\n\nconst style = css`\n  height: 100%;\n  background-color: #b5b5b599;\n  position: absolute;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  flex-flow: column;\n  z-index: 99999;\n\n  p {\n    color: white;\n    background-color: rgb(104, 104, 104);\n    padding: 1.5%;\n    border-radius: 30px;\n    margin: 0px;\n  }\n\n  svg {\n    stroke-width: 0;\n    font-size: 3rem !important;\n    fill: white;\n  }\n`;\n\nconst containerStyle = css`\n  border: 0.55px #e6e6e6 solid;\n  display: flex;\n  flex: 1;\n  flex-direction: 'column';\n  height: 100%;\n`;\n\nfunction DropZone(props) {\n  const { width, height } = useChartData();\n  const dispatch = useDispatch();\n  const alert = useAlert();\n\n  const loadSubFilesFromZip = useCallback(\n    async (extractedfiles, uniqueFileExtensions) => {\n      for (let extension of uniqueFileExtensions) {\n        const selectedFilesByExtensions = extractedfiles.filter(\n          (file) => getFileExtension(file.name) === extension,\n        );\n\n        switch (extension) {\n          case FILES_TYPES.MOL: {\n            const files = await loadFilesFromZip(selectedFilesByExtensions);\n            dispatch({ type: LOAD_MOL_FILE, files });\n            break;\n          }\n          case FILES_TYPES.NMRIUM:\n          case FILES_TYPES.JSON: {\n            const files = await loadFilesFromZip(selectedFilesByExtensions, {\n              asBuffer: true,\n            });\n            if (selectedFilesByExtensions.length === 1) {\n              const decoder = new TextDecoder('utf8');\n              files[0].binary = decoder.decode(files[0].binary);\n\n              dispatch({ type: LOAD_JSON_FILE, files });\n            } else {\n              throw new Error('You can add only one json file');\n            }\n\n            break;\n          }\n          case FILES_TYPES.JDX:\n          case FILES_TYPES.DX: {\n            const files = await loadFilesFromZip(selectedFilesByExtensions, {\n              asBuffer: true,\n            });\n            dispatch({ type: LOAD_JCAMP_FILE, files });\n\n            break;\n          }\n          case FILES_TYPES.JDF: {\n            const files = await loadFilesFromZip(selectedFilesByExtensions, {\n              asBuffer: true,\n            });\n            dispatch({ type: LOAD_JDF_FILE, files });\n            break;\n          }\n          default:\n            break;\n        }\n      }\n    },\n    [dispatch],\n  );\n\n  const loadFilesHandler = useCallback(\n    async (files) => {\n      const uniqueFileExtensions = [\n        ...new Set(files.map((file) => getFileExtension(file.name))),\n      ];\n\n      for (let extension of uniqueFileExtensions) {\n        const selectedFilesByExtensions = files.filter(\n          (file) => getFileExtension(file.name) === extension,\n        );\n        try {\n          switch (extension) {\n            case FILES_TYPES.MOL: {\n              const files = await loadFiles(selectedFilesByExtensions);\n              dispatch({ type: LOAD_MOL_FILE, files });\n\n              break;\n            }\n            case FILES_TYPES.NMRIUM:\n            case FILES_TYPES.JSON:\n              if (selectedFilesByExtensions.length === 1) {\n                const files = await loadFiles<{ binary: any }>(\n                  selectedFilesByExtensions,\n                  {\n                    asBuffer: true,\n                  },\n                );\n                // InputFileFormat\n                const fileSignature = getFileSignature(files[0].binary);\n                if (fileSignature === FILES_SIGNATURES.ZIP) {\n                  const unzipResult = await Zip.loadAsync(files[0].binary);\n                  await loadSubFilesFromZip(Object.values(unzipResult.files), [\n                    FILES_TYPES.NMRIUM,\n                  ]);\n                } else {\n                  const decoder = new TextDecoder('utf8');\n                  files[0].binary = decoder.decode(files[0].binary);\n                  dispatch({ type: LOAD_JSON_FILE, files });\n                }\n              } else {\n                throw new Error('You can add only one json file');\n              }\n\n              break;\n            case FILES_TYPES.JDX:\n            case FILES_TYPES.DX: {\n              const files = await loadFiles(selectedFilesByExtensions, {\n                asBuffer: true,\n              });\n              dispatch({ type: LOAD_JCAMP_FILE, files });\n\n              break;\n            }\n            case FILES_TYPES.JDF: {\n              const files = await loadFiles(selectedFilesByExtensions, {\n                asBuffer: true,\n              });\n              dispatch({ type: LOAD_JDF_FILE, files });\n\n              break;\n            }\n            case FILES_TYPES.ZIP: {\n              const files: File[] = await loadFiles(selectedFilesByExtensions, {\n                asBuffer: true,\n              });\n              for (const zipFile of files) {\n                const unzipResult = await Zip.loadAsync(zipFile.binary);\n\n                const uniqueFileExtensions = [\n                  ...new Set(\n                    Object.values(unzipResult.files).map((file) =>\n                      getFileExtension(file.name),\n                    ),\n                  ),\n                ];\n                const isNotZip = uniqueFileExtensions.some(\n                  (ex) =>\n                    FILES_TYPES[ex.toUpperCase()] && ex !== FILES_TYPES.ZIP,\n                );\n                if (isNotZip) {\n                  const hasBruker = Object.keys(unzipResult.files).some(\n                    (path) => {\n                      return ['2rr', 'fid', '1r'].some((brukerFile) =>\n                        path.endsWith(brukerFile),\n                      );\n                    },\n                  );\n                  if (hasBruker) dispatch({ type: LOAD_ZIP_FILE, files });\n                  await loadSubFilesFromZip(\n                    Object.values(unzipResult.files),\n                    uniqueFileExtensions,\n                  );\n                } else {\n                  dispatch({ type: LOAD_ZIP_FILE, files });\n                }\n              }\n\n              break;\n            }\n            case FILES_TYPES.NMREDATA:\n              void loadFiles(selectedFilesByExtensions, {\n                asBuffer: true,\n              }).then(async (files) => {\n                for (const zipFile of files) {\n                  dispatch({\n                    type: LOAD_NMREDATA_FILE,\n                    file: zipFile,\n                  });\n                }\n              });\n              break;\n            default:\n              throw new Error(\n                'The file extension must be zip, dx, jdx, json, mol, nmredata or nmrium.',\n              );\n          }\n        } catch (e: any) {\n          dispatch({ type: SET_LOADING_FLAG, isLoading: false });\n          alert.error(e.message);\n        }\n      }\n    },\n    [alert, dispatch, loadSubFilesFromZip],\n  );\n\n  const onDrop = useCallback(\n    (droppedFiles) => {\n      dispatch({ type: SET_LOADING_FLAG, isLoading: true });\n      void loadFilesHandler(droppedFiles);\n    },\n    [dispatch, loadFilesHandler],\n  );\n\n  const {\n    getRootProps,\n    getInputProps,\n    isDragActive,\n    open: openImportDialog,\n  } = useDropzone({\n    onDrop,\n    noClick: true,\n    noKeyboard: true,\n  });\n\n  const open = useCallback(() => {\n    openImportDialog();\n  }, [openImportDialog]);\n\n  return (\n    <LoaderProvider value={open}>\n      <div {...getRootProps()} role=\"none\" css={containerStyle}>\n        <input data-test-id=\"dropzone-input\" {...getInputProps()} />\n        {isDragActive && (\n          <div\n            css={style}\n            style={{\n              width: `${width}px`,\n              height: `${height}px`,\n              marginTop: '30px',\n              marginLeft: '30px',\n            }}\n          >\n            <FaUpload />\n            <p>Drop your files here</p>\n          </div>\n        )}\n        {props.children}\n      </div>\n    </LoaderProvider>\n  );\n}\n\nexport default DropZone;\n","import * as types from './types/Types';\n\nconst ignoreActions = [\n  types.APPLY_KEY_PREFERENCES,\n  types.BRUSH_END,\n  types.RESET_DOMAIN,\n  types.RESET_SELECTED_TOOL,\n  types.SET_KEY_PREFERENCES,\n  types.SET_LOADING_FLAG,\n  types.SET_ORIGINAL_DOMAIN,\n  types.SET_SELECTED_FILTER,\n  types.SET_SELECTED_OPTIONS_PANEL,\n  types.SET_SELECTED_TOOL,\n  types.SET_SPECTRUMS_VERTICAL_ALIGN,\n  types.SET_VERTICAL_INDICATOR_X_POSITION,\n  types.SET_WIDTH,\n  types.SET_DIMENSIONS,\n  types.SET_X_DOMAIN,\n  types.SET_Y_DOMAIN,\n  types.SET_ZOOM,\n  types.TOGGLE_REAL_IMAGINARY_VISIBILITY,\n  types.CALCULATE_MANUAL_PHASE_CORRECTION_FILTER,\n  types.CHANGE_SPECTRUM_DISPLAY_VIEW_MODE,\n  types.FULL_ZOOM_OUT,\n  types.SAVE_AS_SVG,\n  types.SAVE_DATA_AS_JSON,\n  types.SET_ACTIVE_TAB,\n  types.CHANGE_VISIBILITY,\n  types.CHANGE_PEAKS_MARKERS_VISIBILITY,\n  types.CHANGE_ACTIVE_SPECTRUM,\n  types.CHANGE_SPECTRUM_COLOR,\n  types.SET_MOUSE_OVER_DISPLAYER,\n];\n\nfunction checkActionType(type: string): boolean {\n  if (!ignoreActions.includes(type)) return true;\n  return false;\n}\n\nexport default checkActionType;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { Toolbar } from 'analysis-ui-components';\nimport {\n  ReactNode,\n  useState,\n  useCallback,\n  useRef,\n  useLayoutEffect,\n} from 'react';\n\nconst menuStyles = css`\n  .menu {\n    box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.5);\n    padding: 0px;\n    margin: 0px;\n    border-radius: 5px;\n    display: flex;\n    flex-direction: column;\n    position: absolute;\n    z-index: 99999;\n    padding: 2px;\n    background-color: white;\n\n    button:hover {\n      background-color: #fafafa;\n    }\n  }\n\n  .menu-cover {\n    position: fixed;\n    width: 100%;\n    height: 100%;\n    top: 0;\n    left: 0;\n    z-index: 1;\n  }\n\n  .menu-item {\n    background-color: transparent;\n    border: none;\n    border-bottom: 0.55px solid whitesmoke;\n    height: 35px;\n    outline: outline;\n    display: table-cell;\n    vertical-align: middle;\n    text-align: left;\n    padding: 0 10px;\n\n    svg {\n      display: inline-block;\n    }\n\n    :focus {\n      outline: none !important;\n    }\n    span {\n      font-size: 10px;\n      padding: 0px 10px;\n    }\n  }\n`;\n\ninterface MenuItemProps {\n  icon: ReactNode;\n  label: string;\n  onClick: () => void;\n}\n\nfunction MenuItem({ icon, label, onClick }: MenuItemProps) {\n  return (\n    <button type=\"button\" className=\"menu-item\" onClick={onClick}>\n      {icon}\n      <span>{label}</span>\n    </button>\n  );\n}\n\ninterface MenuListProps {\n  items: Array<MenuItemProps & { id: string }>;\n  onClick: (element: MenuItemProps & { id: string }) => void;\n  boxBounding: any;\n}\n\nfunction MenuList({ items, boxBounding, onClick }: MenuListProps) {\n  const listRef = useRef<any>();\n  const [translate, setTranslate] = useState({\n    x: boxBounding.width,\n    y: boxBounding.height,\n  });\n\n  useLayoutEffect(() => {\n    const boxSize = listRef.current.getBoundingClientRect();\n    setTranslate((oldTransform) => {\n      let y = boxBounding.height;\n      if (boxSize.bottom > window.innerHeight) {\n        y = boxBounding.height * 2 + (boxSize.bottom - window.innerHeight);\n      }\n      return {\n        ...oldTransform,\n        y,\n      };\n    });\n  }, [boxBounding.height]);\n\n  return (\n    <div\n      ref={listRef}\n      className=\"menu\"\n      style={{\n        transform: `translate(${translate.x}px, -${translate.y}px) `,\n      }}\n    >\n      {items?.map((item) => {\n        return (\n          <MenuItem key={item.id} {...item} onClick={() => onClick(item)} />\n        );\n      })}\n    </div>\n  );\n}\n\ninterface MenuButtonProps {\n  component: any;\n  toolTip: string;\n  items: Array<any>;\n  onClick: (element: any) => void;\n}\n\nexport default function ToolbarMenu({\n  component,\n  toolTip = '',\n  items = [],\n  onClick = () => null,\n}: MenuButtonProps) {\n  const menuButtonRef = useRef<HTMLDivElement>(null);\n  const [isShown, showMenu] = useState(false);\n\n  const closeMenuButton = useCallback(() => {\n    showMenu(false);\n  }, []);\n\n  const handleClick = useCallback(() => {\n    showMenu((flag) => !flag);\n  }, []);\n\n  const clickHandler = useCallback(\n    (e) => {\n      showMenu(false);\n      onClick(e);\n    },\n    [onClick],\n  );\n\n  const boxBounding = useCallback(() => {\n    return menuButtonRef.current?.getBoundingClientRect();\n  }, []);\n\n  return (\n    <div style={{ height: 'auto' }} css={menuStyles}>\n      <div ref={menuButtonRef}>\n        <Toolbar.Item\n          id={`menu-${toolTip}`}\n          title={toolTip}\n          active={isShown}\n          onClick={handleClick}\n        >\n          {component}\n        </Toolbar.Item>\n      </div>\n      {isShown && (\n        <MenuList\n          items={items}\n          boxBounding={boxBounding()}\n          onClick={clickHandler}\n        />\n      )}\n\n      {isShown && <div className=\"menu-cover\" onClick={closeMenuButton} />}\n    </div>\n  );\n}\n","import { useMemo } from 'react';\n\nimport { Info1D as Datum1DInfo, Data1D } from '../../data/types/data1d';\nimport { Info2D as Datum2DInfo, Data2D } from '../../data/types/data2d';\nimport { useChartData } from '../context/ChartContext';\nimport nucleusToString from '../utility/nucleusToString';\n\ninterface SpectrumWithStatisticsProps {\n  info: Datum1DInfo | Datum2DInfo;\n  datum: Data1D | Data2D;\n  ftCounter: number;\n  fidCounter: number;\n}\n\nconst emptyData = { info: {}, datum: {}, ftCounter: 0, fidCounter: 0 };\n\nexport default function useDatumWithSpectraStatistics(): SpectrumWithStatisticsProps {\n  const { data, activeSpectrum, activeTab } = useChartData();\n\n  return useMemo(() => {\n    if (data) {\n      let info: any = {};\n      let datum: any = {};\n      let ftCounter = 0;\n      let fidCounter = 0;\n\n      for (const dataInfo of data) {\n        const { isFid, isFt, nucleus } = dataInfo.info;\n\n        if (activeTab === nucleusToString(nucleus)) {\n          if (isFid) {\n            fidCounter++;\n          }\n          if (isFt) {\n            ftCounter++;\n          }\n          if (activeSpectrum && dataInfo.id === activeSpectrum.id) {\n            info = dataInfo.info;\n            datum = dataInfo.data;\n          }\n        }\n      }\n\n      return {\n        info,\n        datum,\n        ftCounter,\n        fidCounter,\n      };\n    }\n    return emptyData;\n  }, [activeSpectrum, data, activeTab]);\n}\n","import { useFormikContext } from 'formik';\nimport lodashGet from 'lodash/get';\nimport { useCallback, useEffect, useMemo, CSSProperties } from 'react';\n\ninterface FormikTextareaProps\n  extends Omit<React.TextareaHTMLAttributes<HTMLTextAreaElement>, 'style'> {\n  name: string;\n  style?: CSSProperties;\n  value?: string;\n  className?: string;\n}\n\nfunction FormikTextarea(props: FormikTextareaProps) {\n  const {\n    name,\n    style = {},\n    onChange = () => null,\n    className = '',\n    value,\n    placeholder = '',\n    ...resProps\n  } = props;\n\n  const { values, handleChange, setFieldValue, errors } = useFormikContext();\n\n  const changeHandler = useCallback(\n    (e) => {\n      onChange(e);\n      handleChange(e);\n    },\n    [handleChange, onChange],\n  );\n\n  useEffect(() => {\n    if (value) {\n      setFieldValue(name, value);\n    }\n  }, [name, setFieldValue, value]);\n\n  const isInvalid = useMemo(() => {\n    return lodashGet(errors, name);\n  }, [errors, name]);\n\n  return (\n    <textarea\n      {...{ name, className, placeholder }}\n      value={value ? value : lodashGet(values, name)}\n      onChange={changeHandler}\n      style={{\n        ...style,\n        ...(isInvalid && {\n          borderColor: 'red',\n          borderWidth: '1px',\n          outline: 'none',\n        }),\n      }}\n      {...resProps}\n    />\n  );\n}\n\nexport default FormikTextarea;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useCallback, useRef } from 'react';\nimport * as yup from 'yup';\n\nimport { useDispatch } from '../context/DispatchContext';\nimport Button from '../elements/Button';\nimport CloseButton from '../elements/CloseButton';\nimport FormikForm from '../elements/formik/FormikForm';\nimport FormikTextarea from '../elements/formik/FormikTextarea';\nimport { useAlert } from '../elements/popup/Alert';\nimport { GENERATE_SPECTRUM_FROM_PUBLICATION_STRING } from '../reducer/types/Types';\n\nimport { ModalStyles } from './ModalStyle';\n\nconst styles = css`\n  width: 600px;\n  height: 300px;\n\n  .inner-content {\n    flex: 1;\n    border: none;\n    overflow: hidden;\n    padding: 0px;\n  }\n\n  .text-area {\n    width: 100%;\n    height: 100%;\n    outline: none;\n    resize: none;\n    padding: 0 0 0 15px;\n  }\n`;\n\nconst validationSchema = yup.object({\n  publicationText: yup.string().required(),\n});\n\ninterface ImportPublicationStringModalProps {\n  onClose: () => void;\n}\n\nfunction ImportPublicationStringModal({\n  onClose,\n}: ImportPublicationStringModalProps) {\n  const formRef = useRef<any>();\n  const dispatch = useDispatch();\n  const alert = useAlert();\n  const publicationStringHandler = useCallback(\n    (values) => {\n      void (async () => {\n        const hideLoading = await alert.showLoading(\n          'Generate spectrum from publication string in progress',\n        );\n        setTimeout(() => {\n          dispatch({\n            type: GENERATE_SPECTRUM_FROM_PUBLICATION_STRING,\n            payload: values,\n          });\n          hideLoading();\n        });\n        onClose();\n      })();\n    },\n    [alert, dispatch, onClose],\n  );\n\n  return (\n    <div css={[ModalStyles, styles]}>\n      <div className=\"header handle\">\n        <span>Import from publication string</span>\n        <CloseButton onClick={onClose} className=\"close-bt\" />\n      </div>\n      <div className=\"inner-content\">\n        <FormikForm\n          ref={formRef}\n          initialValues={{\n            publicationText:\n              '1H NMR (CDCl3, 400MHz) δ 10.58 (b, 1H), 7.40 (d, 1H, J = 8.0 Hz), 6.19 (d, 1H, J = 7.6 Hz), 4.88 (s, 1H), 2.17 (s, 3H), 1.02 (s, 9H), 1.01 (s, 9H), 0.89 (s, 9H)',\n          }}\n          validationSchema={validationSchema}\n          onSubmit={publicationStringHandler}\n        >\n          <FormikTextarea\n            name=\"publicationText\"\n            className=\"text-area\"\n            placeholder=\"Enter publication string\"\n          />\n        </FormikForm>\n      </div>\n      <div className=\"footer-container\">\n        <Button.Done onClick={() => formRef.current.submitForm()}>\n          Import\n        </Button.Done>\n      </div>\n    </div>\n  );\n}\n\nexport default ImportPublicationStringModal;\n","/** @jsxImportSource @emotion/react */\nimport { css } from '@emotion/react';\nimport { useRef, useCallback } from 'react';\n\nimport Button from '../elements/Button';\nimport CloseButton from '../elements/CloseButton';\nimport { loadFile, extractFileMetaFromPath } from '../utility/FileUtility';\n\nconst styles = css`\n  display: flex;\n  flex-direction: column;\n  width: 450px;\n  padding: 5px;\n  button:focus {\n    outline: none;\n  }\n  .header {\n    height: 24px;\n    border-bottom: 1px solid #f0f0f0;\n    display: flex;\n    span {\n      color: #464646;\n      font-size: 15px;\n      flex: 1;\n    }\n\n    button {\n      background-color: transparent;\n      border: none;\n      svg {\n        height: 16px;\n      }\n    }\n  }\n  .container {\n    display: flex;\n    margin: 30px 5px;\n    align-items: center;\n    height: 36px;\n\n    input {\n      padding: 5px;\n      border: 1px solid gray;\n      border-radius: 5px;\n      margin: 2px;\n    }\n    input {\n      flex: 10;\n    }\n    button {\n      flex: 2;\n      height: 100%;\n    }\n  }\n`;\nconst allowedExtensions = ['dx', 'jdx'];\n\ninterface LoadJCAMPModalProps {\n  onLoadClick: (element: any) => void;\n  startLoading: () => void;\n  onClose: (element?: string) => void;\n}\n\nexport default function LoadJCAMPModal({\n  onLoadClick,\n  onClose,\n  startLoading,\n}: LoadJCAMPModalProps) {\n  const pathReft = useRef<any>();\n\n  const loadJCAMPHandler = useCallback(() => {\n    const path = pathReft.current.value;\n    const { name, extension } = extractFileMetaFromPath(path);\n    if (allowedExtensions.includes(extension)) {\n      startLoading?.();\n      void loadFile(path, { asBuffer: true }).then((data) => {\n        const file = {\n          binary: data,\n          name,\n          extension,\n          jcampURL: path,\n        };\n        onLoadClick(file);\n      });\n    } else {\n      onLoadClick(null);\n    }\n  }, [onLoadClick, startLoading]);\n  return (\n    <div css={styles}>\n      <div className=\"header handle\">\n        <span>Load JCAMP Dialog</span>\n\n        <CloseButton onClick={onClose} />\n      </div>\n      <div className=\"container\">\n        <input\n          ref={pathReft}\n          type=\"text\"\n          placeholder=\"Enter URL to JCAMP-DX file\"\n        />\n        <Button.Done onClick={loadJCAMPHandler}>Load</Button.Done>\n      </div>\n    </div>\n  );\n}\n","import { Toolbar } from 'analysis-ui-components';\nimport {\n  SvgNmrRealImag,\n  SvgNmrOverlay3,\n  SvgNmrOverlay3Aligned,\n  SvgNmrAlignBottom,\n  SvgNmrAlignCenter,\n} from 'cheminfo-font';\nimport { Fragment, useCallback, memo, useMemo } from 'react';\nimport {\n  FaDownload,\n  FaFileDownload,\n  FaFileImage,\n  FaCopy,\n  FaFileExport,\n  FaFile,\n  FaFileImport,\n} from 'react-icons/fa';\n\nimport { Info1D } from '../../data/types/data1d';\nimport { Info2D } from '../../data/types/data2d';\nimport { useChartData } from '../context/ChartContext';\nimport { useDispatch } from '../context/DispatchContext';\nimport { useLoader } from '../context/LoaderContext';\nimport ToolbarMenu from '../elements/ToolbarMenu';\nimport { useAlert } from '../elements/popup/Alert';\nimport { useModal } from '../elements/popup/Modal';\nimport useCheckExperimentalFeature from '../hooks/useCheckExperimentalFeature';\nimport { useCheckToolsVisibility } from '../hooks/useCheckToolsVisibility';\nimport useDatumWithSpectraStatistics from '../hooks/useDatumWithSpectraStatistics';\nimport useExport from '../hooks/useExport';\nimport useToolsFunctions from '../hooks/useToolsFunctions';\nimport ImportPublicationStringModal from '../modal/ImportPublicationStringModal';\nimport LoadJCAMPModal from '../modal/LoadJCAMPModal';\nimport { ActiveSpectrum, VerticalAlignment } from '../reducer/Reducer';\nimport { DISPLAYER_MODE } from '../reducer/core/Constants';\nimport { LOAD_JCAMP_FILE, SET_LOADING_FLAG } from '../reducer/types/Types';\n\nconst IMPORT_MENU = [\n  {\n    id: 'importFile',\n    icon: <FaFile />,\n    label: 'Import from file system (Press Ctrl + O)',\n  },\n  {\n    id: 'importJDX',\n    icon: <FaFile />,\n    label: 'Add JCAMP-DX from URL',\n  },\n  {\n    id: 'importPublicationString',\n    icon: <FaFile />,\n    label: 'Import from publication string',\n  },\n];\n\nconst EXPORT_MENU = [\n  {\n    id: 'svg',\n    icon: <FaDownload />,\n    label: 'Export as SVG',\n  },\n  {\n    id: 'png',\n    icon: <FaFileImage />,\n    label: 'Export as PNG',\n  },\n  {\n    id: 'json',\n    icon: <FaFileDownload />,\n    label: 'Save data ( Press Ctrl + S )',\n  },\n  {\n    id: 'advance_save',\n    icon: <FaFileDownload />,\n    label: 'Save data as  ( Press Ctrl + Shift + S )',\n  },\n  {\n    id: 'nmre',\n    icon: <FaFileDownload />,\n    label: 'Save NMRE data',\n  },\n  {\n    id: 'copy',\n    icon: <FaCopy />,\n    label: 'Copy image to Clipboard ( Press Ctrl + C )',\n  },\n];\n\ninterface BasicToolBarInnerProps {\n  activeSpectrum: ActiveSpectrum | null;\n  fidCounter: number;\n  ftCounter: number;\n  displayerMode: DISPLAYER_MODE;\n  info: Info1D | Info2D;\n  verticalAlign: {\n    align: VerticalAlignment;\n  };\n}\n\nfunction BasicToolBarInner({\n  info,\n  verticalAlign,\n  displayerMode,\n  ftCounter,\n  fidCounter,\n  activeSpectrum,\n}: BasicToolBarInnerProps) {\n  const dispatch = useDispatch();\n  const alert = useAlert();\n  const modal = useModal();\n  const openLoader = useLoader();\n\n  const isExperimentalFeature = useCheckExperimentalFeature();\n  const isButtonVisible = useCheckToolsVisibility();\n\n  const importMenu = useMemo(() => {\n    return isExperimentalFeature\n      ? IMPORT_MENU\n      : IMPORT_MENU.filter((item) => item.id !== 'importPublicationString');\n  }, [isExperimentalFeature]);\n\n  const {\n    isRealSpectrumShown,\n    changeSpectrumViewHandler,\n    changeDisplayViewModeHandler,\n    alignSpectrumsVerticallyHandler,\n  } = useToolsFunctions();\n\n  const {\n    saveAsSVGHandler,\n    saveAsPNGHandler,\n    saveAsJSONHandler,\n    saveAsNMREHandler,\n    saveToClipboardHandler,\n    saveAsHandler,\n  } = useExport();\n\n  const LoadJacmpHandler = useCallback(\n    (file) => {\n      if (file) {\n        dispatch({ type: LOAD_JCAMP_FILE, files: [file] });\n        modal.close();\n      } else {\n        alert.error('you file must be one of those extensions [ .jdx, dx ] ');\n      }\n    },\n    [alert, dispatch, modal],\n  );\n\n  const startLoadingHandler = useCallback(() => {\n    modal.close();\n    dispatch({ type: SET_LOADING_FLAG, isLoading: true });\n  }, [dispatch, modal]);\n\n  const importJCAMPFile = useCallback(() => {\n    modal.show(\n      <LoadJCAMPModal\n        onLoadClick={LoadJacmpHandler}\n        onClose={() => modal.close()}\n        startLoading={startLoadingHandler}\n      />,\n      {},\n    );\n  }, [LoadJacmpHandler, modal, startLoadingHandler]);\n\n  const openImportPublicationStringModal = useCallback(() => {\n    modal.show(\n      <ImportPublicationStringModal onClose={() => modal.close()} />,\n      {},\n    );\n  }, [modal]);\n\n  const importHandler = useCallback(\n    ({ id }) => {\n      switch (id) {\n        case 'importFile':\n          openLoader();\n          break;\n        case 'importJDX':\n          importJCAMPFile();\n          break;\n        case 'importPublicationString':\n          openImportPublicationStringModal();\n          break;\n        default:\n          return;\n      }\n    },\n    [openLoader, importJCAMPFile, openImportPublicationStringModal],\n  );\n\n  const exportHandler = useCallback(\n    ({ id }) => {\n      switch (id) {\n        case 'svg':\n          void saveAsSVGHandler();\n          break;\n        case 'png':\n          void saveAsPNGHandler();\n          break;\n        case 'json':\n          void saveAsJSONHandler();\n          break;\n        case 'advance_save':\n          void saveAsHandler();\n          break;\n        case 'nmre':\n          void saveAsNMREHandler();\n          break;\n        case 'copy':\n          void saveToClipboardHandler();\n          break;\n\n        default:\n          break;\n      }\n    },\n    [\n      saveAsSVGHandler,\n      saveAsPNGHandler,\n      saveAsJSONHandler,\n      saveAsHandler,\n      saveAsNMREHandler,\n      saveToClipboardHandler,\n    ],\n  );\n\n  return (\n    <Fragment>\n      {isButtonVisible('import') && (\n        <ToolbarMenu\n          component={<FaFileImport />}\n          toolTip=\"Import\"\n          onClick={(element) => {\n            importHandler(element);\n            return null;\n          }}\n          items={importMenu}\n        />\n      )}\n      {isButtonVisible('exportAs') && (\n        <ToolbarMenu\n          component={<FaFileExport />}\n          toolTip=\"Export As\"\n          onClick={(element) => {\n            exportHandler(element);\n            return null;\n          }}\n          items={EXPORT_MENU}\n        />\n      )}\n\n      {displayerMode === DISPLAYER_MODE.DM_1D &&\n        isButtonVisible('spectraStackAlignments') &&\n        ftCounter > 1 &&\n        (info?.isFt || !activeSpectrum) && (\n          <Toolbar.Item\n            id=\"spectra-alignment\"\n            className=\"cheminfo\"\n            title=\"Spectra alignment ( Press s )\"\n            onClick={changeDisplayViewModeHandler}\n          >\n            {verticalAlign.align === 'stack' ? (\n              <SvgNmrOverlay3Aligned />\n            ) : (\n              <SvgNmrOverlay3 />\n            )}\n          </Toolbar.Item>\n        )}\n      {displayerMode === DISPLAYER_MODE.DM_1D &&\n        isButtonVisible('realImaginary') &&\n        info.isComplex && (\n          <Toolbar.Item\n            id=\"display\"\n            title={isRealSpectrumShown ? 'Display Real ' : 'Display Imaginary'}\n            onClick={changeSpectrumViewHandler}\n            className=\"cheminfo\"\n          >\n            <SvgNmrRealImag />\n          </Toolbar.Item>\n        )}\n      {displayerMode === DISPLAYER_MODE.DM_1D &&\n        isButtonVisible('spectraCenterAlignments') &&\n        (ftCounter > 0 || fidCounter > 0) && (\n          <Toolbar.Item\n            id=\"baseline-position\"\n            title={\n              verticalAlign.align === 'bottom'\n                ? 'Baseline  Center ( Press c )'\n                : 'Baseline  Bottom ( Press c )'\n            }\n            onClick={alignSpectrumsVerticallyHandler}\n            className=\"cheminfo\"\n          >\n            <div style={{ fontSize: 24 }}>\n              {verticalAlign.align === 'bottom' ? (\n                <SvgNmrAlignCenter />\n              ) : (\n                <SvgNmrAlignBottom />\n              )}\n            </div>\n          </Toolbar.Item>\n        )}\n    </Fragment>\n  );\n}\n\nconst MemoizedBasicToolBar = memo(BasicToolBarInner);\n\nexport default function BasicToolBar() {\n  const { activeSpectrum, verticalAlign, displayerMode, activeTab } =\n    useChartData();\n\n  const { info, fidCounter, ftCounter } = useDatumWithSpectraStatistics();\n  return (\n    <MemoizedBasicToolBar\n      {...{\n        info,\n        fidCounter,\n        ftCounter,\n        activeSpectrum,\n        verticalAlign,\n        displayerMode,\n        activeTab,\n      }}\n    />\n  );\n}\n","import { Toolbar } from 'analysis-ui-components';\nimport {\n  useCallback,\n  useState,\n  useEffect,\n  ReactElement,\n  JSXElementConstructor,\n} from 'react';\n\ninterface ToggleButtonProps {\n  isActive?: boolean;\n  value?: any;\n  onChange?: (value: any) => null;\n  children: ReactElement<any, string | JSXElementConstructor<any>>;\n  isVisible?: boolean;\n}\n\nexport default function ToggleButton(\n  props: ToggleButtonProps & { title: string; id: string },\n) {\n  const {\n    children,\n    value = null,\n    isActive = false,\n    onChange = () => null,\n    isVisible = true,\n    id,\n    title,\n  } = props;\n\n  const [active, setActive] = useState(props.isActive);\n\n  const toggleButton = useCallback(() => {\n    const _isActive = !active;\n    setActive(_isActive);\n\n    if (_isActive) {\n      onChange(value);\n    } else {\n      onChange(null);\n    }\n  }, [active, onChange, value]);\n\n  useEffect(() => {\n    setActive(isActive);\n  }, [isActive]);\n\n  if (!isVisible) {\n    return null;\n  }\n\n  return (\n    <Toolbar.Item onClick={toggleButton} title={title} id={id} active={active}>\n      {children}\n    </Toolbar.Item>\n  );\n}\n","import {\n  useCallback,\n  useState,\n  useMemo,\n  useEffect,\n  Children,\n  cloneElement,\n  ReactNode,\n} from 'react';\n\nimport ToggleButton from './ToggleButton';\n\ninterface ToggleButtonGroupProps {\n  children: ReactNode;\n  value: string;\n  onChange?: (value: any) => void;\n}\n\nexport default function ToggleButtonGroup({\n  children,\n  value,\n  onChange = () => null,\n}: ToggleButtonGroupProps) {\n  const [toggleButtons, setToggleButtons] = useState<any>([]);\n  const handleOnChange = useCallback(\n    (val) => {\n      const _toggles: Array<any> = [...toggleButtons];\n      const toggles = _toggles.map((toggle) => {\n        return {\n          value: toggle.value,\n          isActive: toggle.value === val ? true : false,\n        };\n      });\n\n      setToggleButtons(toggles);\n      onChange(val);\n    },\n    [onChange, toggleButtons],\n  );\n\n  const mappedChildren = useMemo(() => {\n    let index = 0;\n    return Children.map(children, (child: any) => {\n      if (child) {\n        if (child.type === ToggleButton) {\n          const _child = cloneElement(child, {\n            onChange: handleOnChange,\n            isActive: toggleButtons[index]?.isActive,\n            index,\n          });\n          index++;\n          return _child;\n        } else {\n          return cloneElement(child);\n        }\n      }\n    });\n  }, [children, handleOnChange, toggleButtons]);\n\n  useEffect(() => {\n    const val = Children.map(children, (child: any) => {\n      if (child && child.type === ToggleButton) {\n        return {\n          value: child.props.value,\n          isActive: child.props.value === value ? true : false,\n        };\n      }\n    });\n    setToggleButtons(val);\n  }, [children, value]);\n\n  return <>{mappedChildren}</>;\n}\n","import { Toolbar } from 'analysis-ui-components';\nimport {\n  SvgNmrBaselineCorrection,\n  SvgNmrFourierTransform,\n  SvgNmrIntegrate,\n  SvgNmrMultipleAnalysis,\n  SvgNmrPeakPicking,\n  SvgNmrPhaseCorrection,\n  SvgNmrRangePicking,\n  SvgNmrZeroFilling,\n} from 'cheminfo-font';\nimport { useState, useEffect, useCallback, memo } from 'react';\nimport { FaSearchPlus, FaExpand, FaDiceFour } from 'react-icons/fa';\n\nimport * as Filters from '../../data/Filters';\nimport { Info1D, Data1D } from '../../data/types/data1d';\nimport { Info2D, Data2D } from '../../data/types/data2d';\nimport { useChartData } from '../context/ChartContext';\nimport { useDispatch } from '../context/DispatchContext';\nimport ToggleButton from '../elements/toggle/ToggleButton';\nimport ToggleButtonGroup from '../elements/toggle/ToggleButtonGroup';\nimport { useCheckToolsVisibility } from '../hooks/useCheckToolsVisibility';\nimport useDatumWithSpectraStatistics from '../hooks/useDatumWithSpectraStatistics';\nimport useToolsFunctions from '../hooks/useToolsFunctions';\nimport { ActiveSpectrum } from '../reducer/Reducer';\nimport { DISPLAYER_MODE } from '../reducer/core/Constants';\nimport { APPLY_FFT_FILTER, SET_SELECTED_FILTER } from '../reducer/types/Types';\n\nimport { options } from './ToolTypes';\n\ninterface FunctionToolBarInnerProps {\n  defaultValue: string;\n  activeSpectrum: ActiveSpectrum | null;\n  ftCounter: number;\n  displayerMode: DISPLAYER_MODE;\n  info: Info1D | Info2D;\n  datum: Data1D | Data2D;\n  mode: string;\n}\n\nfunction FunctionToolBarInner({\n  defaultValue,\n  activeSpectrum,\n  info,\n  datum,\n  displayerMode,\n  ftCounter,\n  mode,\n}: FunctionToolBarInnerProps) {\n  const [option, setOption] = useState<string>('');\n  const isButtonVisible = useCheckToolsVisibility();\n\n  const dispatch = useDispatch();\n\n  const { handleChangeOption, handleFullZoomOut } = useToolsFunctions();\n\n  const handleChange = useCallback(\n    (selectedOption) => {\n      setOption(selectedOption);\n      handleChangeOption(selectedOption);\n    },\n    [handleChangeOption],\n  );\n\n  useEffect(() => {\n    setOption(defaultValue);\n  }, [defaultValue]);\n\n  const handleOnFFTFilter = useCallback(() => {\n    dispatch({\n      type: APPLY_FFT_FILTER,\n      value: '',\n    });\n    dispatch({ type: SET_SELECTED_FILTER, selectedFilter: null });\n  }, [dispatch]);\n\n  return (\n    <>\n      <ToggleButtonGroup value={option} onChange={handleChange}>\n        {isButtonVisible('zoomTool') && (\n          <ToggleButton\n            key={options.zoom.id}\n            value={options.zoom.id}\n            id=\"zoomIn\"\n            title={`${options.zoom.label} ( Press z )`}\n          >\n            <div style={{ fontSize: 14 }}>\n              <FaSearchPlus />\n            </div>\n          </ToggleButton>\n        )}\n\n        {isButtonVisible('zoomOutTool') && (\n          <Toolbar.Item\n            id=\"zoom-out\"\n            onClick={handleFullZoomOut}\n            title=\"Horizontal zoom out ( Press f ), Horizontal and Vertical zoom out, double click ( Press ff )\"\n          >\n            <div style={{ fontSize: 14 }}>\n              <FaExpand />\n            </div>\n          </Toolbar.Item>\n        )}\n\n        {displayerMode === DISPLAYER_MODE.DM_1D && isButtonVisible('peakTool') && (\n          <ToggleButton\n            key={options.peakPicking.id}\n            value={options.peakPicking.id}\n            title={`${options.peakPicking.label} ( Press p )`}\n            isVisible={activeSpectrum && !info?.isFid ? true : false}\n            id=\"peakPicking\"\n          >\n            <SvgNmrPeakPicking />\n          </ToggleButton>\n        )}\n        {displayerMode === DISPLAYER_MODE.DM_1D &&\n          isButtonVisible('integralTool') && (\n            <ToggleButton\n              key={options.integral.id}\n              value={options.integral.id}\n              isVisible={activeSpectrum && !info?.isFid ? true : false}\n              id=\"integralPicking\"\n              title={`${options.integral.label} ( Press i )`}\n            >\n              <SvgNmrIntegrate />\n            </ToggleButton>\n          )}\n        {displayerMode === DISPLAYER_MODE.DM_2D &&\n          isButtonVisible('zonePickingTool') && (\n            <ToggleButton\n              key={options.zone2D.id}\n              value={options.zone2D.id}\n              id=\"zone2d\"\n              isVisible={activeSpectrum && !info?.isFid ? true : false}\n              title={`${options.zone2D.label} ( Press r )`}\n            >\n              <FaDiceFour />\n            </ToggleButton>\n          )}\n        {displayerMode === DISPLAYER_MODE.DM_2D &&\n          isButtonVisible('slicingTool') && (\n            <ToggleButton\n              key={options.slicingTool.id}\n              value={options.slicingTool.id}\n              isVisible={activeSpectrum && !info?.isFid ? true : false}\n              id=\"slic\"\n              title={`${options.slicingTool.label}`}\n            >\n              <p>Slic</p>\n            </ToggleButton>\n          )}\n        {displayerMode === DISPLAYER_MODE.DM_1D &&\n          isButtonVisible('autoRangesTool') && (\n            <ToggleButton\n              key={options.rangesPicking.id}\n              value={options.rangesPicking.id}\n              isVisible={activeSpectrum && !info?.isFid ? true : false}\n              title={`${options.rangesPicking.label} ( Press r )`}\n              id=\"ranges-pick\"\n            >\n              <SvgNmrRangePicking />\n            </ToggleButton>\n          )}\n        {displayerMode === DISPLAYER_MODE.DM_1D &&\n          isButtonVisible('multipleSpectraAnalysisTool') &&\n          ftCounter > 1 &&\n          mode === 'RTL' && (\n            <ToggleButton\n              key={options.multipleSpectraAnalysis.id}\n              value={options.multipleSpectraAnalysis.id}\n              id=\"multipleSpectraAnalysis\"\n              title={options.multipleSpectraAnalysis.label}\n            >\n              <SvgNmrMultipleAnalysis />\n            </ToggleButton>\n          )}\n        {displayerMode === DISPLAYER_MODE.DM_1D &&\n          isButtonVisible('zeroFillingTool') && (\n            <ToggleButton\n              key={options.zeroFilling.id}\n              value={options.zeroFilling.id}\n              isVisible={Filters.zeroFilling.isApplicable({ info })}\n              id=\"zeroFilling\"\n              title={options.zeroFilling.label}\n            >\n              <SvgNmrZeroFilling />\n            </ToggleButton>\n          )}\n        {displayerMode === DISPLAYER_MODE.DM_1D &&\n          isButtonVisible('phaseCorrectionTool') && (\n            <ToggleButton\n              key={options.phaseCorrection.id}\n              value={options.phaseCorrection.id}\n              id=\"phaseCorrection\"\n              title={`${options.phaseCorrection.label} ( Press a )`}\n              isVisible={\n                activeSpectrum &&\n                info &&\n                Filters.phaseCorrection.isApplicable({ info }) &&\n                (datum as Data1D).im\n                  ? true\n                  : false\n              }\n            >\n              <SvgNmrPhaseCorrection />\n            </ToggleButton>\n          )}\n\n        {displayerMode === DISPLAYER_MODE.DM_1D &&\n          isButtonVisible('baseLineCorrectionTool') && (\n            <ToggleButton\n              key={options.baseLineCorrection.id}\n              value={options.baseLineCorrection.id}\n              id=\"baseLineCorrection\"\n              title={`${options.baseLineCorrection.label} ( Press b )`}\n              isVisible={\n                activeSpectrum &&\n                info &&\n                Filters.baselineCorrection.isApplicable({ info })\n                  ? true\n                  : false\n              }\n            >\n              <SvgNmrBaselineCorrection />\n            </ToggleButton>\n          )}\n\n        {displayerMode === DISPLAYER_MODE.DM_1D &&\n          isButtonVisible('exclusionZonesTool') &&\n          !info?.isFid &&\n          ftCounter > 0 && (\n            <ToggleButton\n              key={options.exclusionZones.id}\n              value={options.exclusionZones.id}\n              title={`${options.exclusionZones.label} ( Press e )`}\n              id=\"exclusionZones\"\n            >\n              <div style={{ fontSize: 18 }}>\n                <SvgNmrMultipleAnalysis />\n              </div>\n            </ToggleButton>\n          )}\n      </ToggleButtonGroup>\n\n      {displayerMode === DISPLAYER_MODE.DM_1D &&\n        isButtonVisible('FFTTool') &&\n        info &&\n        Filters.fft.isApplicable({ info }) && (\n          <Toolbar.Item\n            id=\"fft-filter\"\n            className=\"cheminfo\"\n            title=\"FFT Filter\"\n            onClick={handleOnFFTFilter}\n          >\n            <SvgNmrFourierTransform />\n          </Toolbar.Item>\n        )}\n    </>\n  );\n}\n\nconst MemoizedFunctionToolBar = memo(FunctionToolBarInner);\n\nexport default function FunctionToolBar({\n  defaultValue = options.zoom.id,\n}: {\n  defaultValue?: string;\n}) {\n  const { activeSpectrum, displayerMode, activeTab, mode } = useChartData();\n\n  const data = useDatumWithSpectraStatistics();\n\n  return (\n    <MemoizedFunctionToolBar\n      {...{\n        ...data,\n        activeSpectrum,\n        displayerMode,\n        activeTab,\n        defaultValue,\n        mode,\n      }}\n    />\n  );\n}\n","import { Toolbar } from 'analysis-ui-components';\nimport { memo } from 'react';\n\nimport { useChartData } from '../context/ChartContext';\n\nimport BasicToolBar from './BasicToolBar';\nimport FunctionToolBar from './FunctionToolBar';\n\ninterface ToolBarInnerProps {\n  selectedTool: string;\n}\n\nfunction ToolBarInner({ selectedTool }: ToolBarInnerProps) {\n  return (\n    <div style={{ fontSize: 18 }}>\n      <Toolbar orientation=\"vertical\">\n        <FunctionToolBar defaultValue={selectedTool} />\n        {/* <HistoryToolBar /> */}\n        <BasicToolBar />\n      </Toolbar>\n    </div>\n  );\n}\n\nconst MemoizedToolBar = memo(ToolBarInner);\n\nexport default function ToolBar() {\n  const {\n    toolOptions: { selectedTool },\n  } = useChartData();\n\n  return <MemoizedToolBar {...{ selectedTool }} />;\n}\n","/** @jsxImportSource @emotion/react */\n\nimport { css } from '@emotion/react';\nimport { RootLayout } from 'analysis-ui-components';\nimport { CorrelationData } from 'nmr-correlation';\nimport {\n  useEffect,\n  useCallback,\n  useReducer,\n  useMemo,\n  useRef,\n  memo,\n  Reducer,\n  ReactElement,\n  ReactNode,\n} from 'react';\nimport { ErrorBoundary } from 'react-error-boundary';\nimport { useToggle, useFullscreen } from 'react-use';\n\nimport { Datum1D } from '../data/types/data1d';\nimport { Datum2D } from '../data/types/data2d';\nimport checkModifierKeyActivated from '../data/utilities/checkModifierKeyActivated';\nimport { PanelPreferencesType } from '../types/PanelPreferencesType';\n\nimport Viewer1D from './1d/Viewer1D';\nimport Viewer2D from './2d/Viewer2D';\nimport ErrorOverlay from './ErrorOverlay';\nimport KeysListenerTracker from './EventsTrackers/KeysListenerTracker';\nimport { SplitPaneWrapper } from './SplitPaneWrapper';\nimport { AssignmentProvider } from './assignment';\nimport { ChartDataProvider } from './context/ChartContext';\nimport { DispatchProvider } from './context/DispatchContext';\nimport { GlobalProvider } from './context/GlobalContext';\nimport { PreferencesProvider } from './context/PreferencesContext';\nimport { AlertProvider } from './elements/popup/Alert';\nimport { ModalProvider } from './elements/popup/Modal';\nimport Header from './header/Header';\nimport { HighlightProvider } from './highlight';\nimport DropZone from './loader/DropZone';\nimport { defaultGetSpinner, SpinnerProvider } from './loader/SpinnerContext';\nimport Panels from './panels/Panels';\nimport checkActionType from './reducer/IgnoreActions';\nimport {\n  spectrumReducer,\n  initialState,\n  dispatchMiddleware,\n  initState,\n  State,\n} from './reducer/Reducer';\nimport { DISPLAYER_MODE } from './reducer/core/Constants';\nimport preferencesReducer, {\n  preferencesInitialState,\n  PreferencesState,\n  initPreferencesState,\n} from './reducer/preferencesReducer';\nimport {\n  INITIATE,\n  SET_LOADING_FLAG,\n  SET_MOUSE_OVER_DISPLAYER,\n} from './reducer/types/Types';\nimport ToolBar from './toolbar/ToolBar';\n\nconst viewerContainerStyle = css`\n  border: 0.55px #e6e6e6 solid;\n  display: flex;\n  flex: 1;\n  flex-direction: 'column';\n  height: 100%;\n  margin-left: -1px;\n`;\n\nconst containerStyles = css`\n  background-color: white;\n  width: 100%;\n  display: block;\n  height: 100%;\n  font-size: 14px;\n\n  div:focus {\n    outline: none !important;\n  }\n\n  button {\n    cursor: pointer;\n    &:disabled {\n      cursor: default;\n    }\n  }\n\n  button:active,\n  button:hover,\n  button:focus,\n  [type='button']:focus,\n  button {\n    outline: none !important;\n  }\n  * {\n    -webkit-user-drag: none;\n    -moz-user-drag: none;\n    -o-user-drag: none;\n    user-drag: none;\n    -moz-user-select: none;\n    -webkit-user-select: none;\n    -ms-user-select: none;\n    user-select: none;\n  }\n\n  .SplitPane {\n    height: 100%;\n  }\n`;\n\nexport type NMRiumWorkspace =\n  | 'exercise'\n  | 'process1D'\n  | 'default'\n  | 'prediction'\n  | 'embedded';\n\nexport interface NMRiumProps {\n  data?: NMRiumData;\n  onDataChange?: (data: State) => void;\n  workspace?: NMRiumWorkspace;\n  preferences?: NMRiumPreferences;\n  emptyText?: ReactNode;\n  /**\n   * Returns a custom spinner that will be rendered while loading data.\n   */\n  getSpinner?: () => ReactElement;\n}\n\nexport type NMRiumPreferences = Partial<{\n  general: Partial<{\n    disableMultipletAnalysis: boolean;\n    hideSetSumFromMolecule: boolean;\n    hideGeneralSettings: boolean;\n    experimentalFeatures: PanelPreferencesType;\n    hidePanelOnLoad: boolean;\n  }>;\n  panels: Partial<{\n    spectraPanel: PanelPreferencesType;\n    informationPanel: PanelPreferencesType;\n    peaksPanel: PanelPreferencesType;\n    integralsPanel: PanelPreferencesType;\n    rangesPanel: PanelPreferencesType;\n    structuresPanel: PanelPreferencesType;\n    filtersPanel: PanelPreferencesType;\n    zonesPanel: PanelPreferencesType;\n    summaryPanel: PanelPreferencesType;\n    multipleSpectraAnalysisPanel: PanelPreferencesType;\n    databasePanel: PanelPreferencesType;\n    predictionPanel: PanelPreferencesType;\n  }>;\n  toolBarButtons: Partial<{\n    zoomTool: boolean;\n    zoomOutTool: boolean;\n    import: boolean;\n    exportAs: boolean;\n    spectraStackAlignments: boolean;\n    spectraCenterAlignments: boolean;\n    realImaginary: boolean;\n    peakTool: boolean;\n    integralTool: boolean;\n    zonePickingTool: boolean;\n    slicingTool: boolean;\n    autoRangesTool: boolean;\n    zeroFillingTool: boolean;\n    phaseCorrectionTool: boolean;\n    baseLineCorrectionTool: boolean;\n    FFTTool: boolean;\n    multipleSpectraAnalysisTool: boolean;\n    exclusionZonesTool: boolean;\n  }>;\n}>;\n\nexport type Molecules = Array<{ molfile: string }>;\nexport type Spectra = Array<Datum1D | Datum2D>;\n\ntype DeepPartial<T> = {\n  [P in keyof T]?: DeepPartial<T[P]>;\n};\n\nexport interface NMRiumData {\n  molecules?: Molecules;\n  spectra: DeepPartial<Spectra>;\n  correlations?: CorrelationData;\n}\n\nconst defaultPreferences = {};\nconst defaultData: NMRiumData = {\n  spectra: [],\n};\n\nfunction NMRium(props: NMRiumProps) {\n  return (\n    <RootLayout style={{ width: '100%' }}>\n      <ErrorBoundary FallbackComponent={ErrorOverlay}>\n        <InnerNMRium {...props} />\n      </ErrorBoundary>\n    </RootLayout>\n  );\n}\n\nfunction InnerNMRium({\n  data: dataProp = defaultData,\n  workspace,\n  preferences = defaultPreferences,\n  getSpinner = defaultGetSpinner,\n  onDataChange,\n  emptyText,\n}: NMRiumProps) {\n  const rootRef = useRef<HTMLDivElement>(null);\n  const elementsWrapperRef = useRef<HTMLDivElement>(null);\n  const viewerRef = useRef<HTMLDivElement>(null);\n  const [show, toggle] = useToggle(false);\n\n  const isFullscreen = useFullscreen(rootRef, show, {\n    onClose: () => {\n      toggle(false);\n    },\n  });\n\n  const [state, dispatch] = useReducer<Reducer<State, any>, State>(\n    spectrumReducer,\n    initialState,\n    initState,\n  );\n\n  const [preferencesState, dispatchPreferences] = useReducer<\n    Reducer<PreferencesState, any>,\n    PreferencesState\n  >(preferencesReducer, preferencesInitialState, initPreferencesState);\n\n  const { displayerMode, data: spectraData } = state;\n\n  useEffect(() => {\n    if (checkActionType(state.actionType)) {\n      onDataChange?.(state);\n    }\n  }, [onDataChange, state]);\n\n  const dispatchMiddleWare = useMemo(() => {\n    return dispatchMiddleware(dispatch);\n  }, []);\n\n  useEffect(() => {\n    rootRef.current?.focus();\n  }, [isFullscreen]);\n\n  useEffect(() => {\n    dispatchPreferences({\n      type: 'INIT_PREFERENCES',\n      payload: {\n        display: preferences,\n        workspace,\n        dispatch: dispatchPreferences,\n      },\n    });\n  }, [preferences, workspace]);\n\n  useEffect(() => {\n    dispatchMiddleWare({ type: SET_LOADING_FLAG, isLoading: true });\n    if (dataProp) {\n      dispatchMiddleWare({ type: INITIATE, payload: dataProp });\n    }\n  }, [dataProp, dispatchMiddleWare]);\n\n  const preventContextMenuHandler = useCallback((e) => {\n    if (!checkModifierKeyActivated(e)) {\n      e.preventDefault();\n    }\n  }, []);\n\n  const mainDivRef = useRef<HTMLDivElement>(null);\n  useEffect(() => {\n    const div = mainDivRef.current;\n    if (!div) {\n      return;\n    }\n    function mouseEnterHandler() {\n      dispatchMiddleWare({ type: SET_MOUSE_OVER_DISPLAYER, payload: true });\n    }\n    function mouseLeaveHandler() {\n      dispatchMiddleWare({ type: SET_MOUSE_OVER_DISPLAYER, payload: false });\n    }\n    div.addEventListener('mouseenter', mouseEnterHandler);\n    div.addEventListener('mouseleave', mouseLeaveHandler);\n    return () => {\n      div.removeEventListener('mouseenter', mouseEnterHandler);\n      div.removeEventListener('mouseleave', mouseLeaveHandler);\n    };\n  }, [dispatchMiddleWare]);\n\n  return (\n    <GlobalProvider\n      value={{\n        rootRef: rootRef.current,\n        elementsWrapperRef: elementsWrapperRef.current,\n        viewerRef: viewerRef.current,\n      }}\n    >\n      <PreferencesProvider value={preferencesState}>\n        <div ref={mainDivRef} style={{ height: '100%', position: 'relative' }}>\n          <AlertProvider wrapperRef={elementsWrapperRef.current}>\n            <DispatchProvider value={dispatchMiddleWare}>\n              <ChartDataProvider value={state}>\n                <ModalProvider wrapperRef={elementsWrapperRef.current}>\n                  <HighlightProvider>\n                    <AssignmentProvider spectraData={spectraData}>\n                      <SpinnerProvider value={getSpinner}>\n                        <div\n                          className=\"nmrium-container\"\n                          ref={rootRef}\n                          css={containerStyles}\n                          onContextMenu={preventContextMenuHandler}\n                          style={{ height: '100%', width: '100%' }}\n                        >\n                          <DropZone>\n                            <div\n                              style={{\n                                display: 'flex',\n                                flexDirection: 'column',\n                                backgroundColor: 'white',\n                                width: '100%',\n                              }}\n                            >\n                              <Header\n                                isFullscreen={isFullscreen}\n                                onMaximize={toggle}\n                              />\n\n                              <div\n                                style={{\n                                  display: 'flex',\n                                  flexDirection: 'row',\n                                  height: '100%',\n                                }}\n                              >\n                                <ToolBar />\n                                <SplitPaneWrapper>\n                                  <div css={viewerContainerStyle}>\n                                    <KeysListenerTracker />\n                                    <div\n                                      data-test-id=\"viewer\"\n                                      ref={viewerRef}\n                                      style={{\n                                        width: '100%',\n                                        height: '100%',\n                                      }}\n                                    >\n                                      {displayerMode ===\n                                      DISPLAYER_MODE.DM_1D ? (\n                                        <Viewer1D emptyText={emptyText} />\n                                      ) : (\n                                        <Viewer2D emptyText={emptyText} />\n                                      )}\n                                    </div>\n                                  </div>\n                                  <Panels />\n                                </SplitPaneWrapper>\n\n                                <div\n                                  ref={elementsWrapperRef}\n                                  key={String(isFullscreen)}\n                                  id=\"main-wrapper\"\n                                  style={{\n                                    position: 'absolute',\n                                    pointerEvents: 'none',\n                                    zIndex: 0,\n                                    left: 0,\n                                    right: 0,\n                                    top: 0,\n                                    bottom: 0,\n                                  }}\n                                />\n                              </div>\n                            </div>\n                          </DropZone>\n                        </div>\n                      </SpinnerProvider>\n                    </AssignmentProvider>\n                  </HighlightProvider>\n                </ModalProvider>\n              </ChartDataProvider>\n            </DispatchProvider>\n          </AlertProvider>\n        </div>\n      </PreferencesProvider>\n    </GlobalProvider>\n  );\n}\nexport default memo(NMRium);\n","import { DropZone } from 'analysis-ui-components';\nimport debounce from 'lodash/debounce';\nimport { useState, useEffect, useCallback } from 'react';\nimport { ObjectInspector } from 'react-inspector';\n\nimport NMRium from '../../component/NMRium';\nimport { loadFiles } from '../../component/utility/FileUtility';\n\nfunction searchDeep(obj, searchKey) {\n  let result: any = [];\n  function objectHelper(obj) {\n    Object.keys(obj).forEach((key) => {\n      if (searchKey === key) {\n        result.push({ [key]: obj[key] });\n      }\n      if (Array.isArray(obj[key])) {\n        obj[key].forEach((object) => {\n          objectHelper(object);\n        });\n      } else if (typeof obj[key] === 'object' && obj[key] !== null) {\n        objectHelper(obj[key]);\n      }\n    });\n  }\n\n  objectHelper(obj);\n  return result;\n}\n\nfunction Inspector(data: any) {\n  const [filteredData, seData] = useState<any>();\n  const [key, setKey] = useState<string>('');\n  useEffect(() => {\n    const result = searchDeep(data, key);\n    seData(key ? result : data);\n  }, [data, key]);\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  const handleSearch = useCallback(\n    debounce((e) => {\n      const key = e.target.value;\n      setKey(key);\n    }, 500),\n    [data],\n  );\n\n  return (\n    <div\n      style={{ display: 'flex', flexDirection: 'column', paddingTop: '10px' }}\n    >\n      <input\n        style={{ border: '1px solid gray', padding: '5px' }}\n        type=\"text\"\n        placeholder=\"Search for key...\"\n        onChange={handleSearch}\n      />\n      <ObjectInspector data={filteredData} />;\n    </div>\n  );\n}\n\nexport default function Test() {\n  const [data, setData] = useState<any>();\n  const [callBackData, setCallBackData] = useState<any>({});\n\n  const dropFileHandler = useCallback((dropfiles) => {\n    void (async () => {\n      try {\n        const files = await loadFiles<{ binary: any }>(dropfiles, {\n          asBuffer: true,\n        });\n\n        const decoder = new TextDecoder('utf8');\n        const data = JSON.parse(decoder.decode(files[0].binary));\n        setData(data);\n      } catch (e) {\n        // eslint-disable-next-line no-alert\n        alert('Invalid JSON file');\n      }\n    })();\n  }, []);\n  const dataChangeHandler = useCallback((data) => {\n    setCallBackData(data);\n  }, []);\n\n  return (\n    <div style={{ display: 'flex', height: '100vh', padding: '20px' }}>\n      <div style={{ flex: 9 }}>\n        <NMRium data={data} onDataChange={dataChangeHandler} />\n      </div>\n      <div\n        style={{\n          display: 'flex',\n          flexDirection: 'column',\n          padding: '10px',\n          flex: 3,\n        }}\n      >\n        <div style={{ flex: 3 }}>\n          <DropZone onDrop={dropFileHandler} color=\"gray\" />\n        </div>\n        <div style={{ flex: 9 }}>\n          <Inspector data={callBackData} />\n        </div>\n      </div>\n    </div>\n  );\n}\n","import { lazy, Suspense } from 'react';\nimport { Switch, Route } from 'react-router-dom';\n\nimport Test from '../views/Test';\n\nconst TestHighlight = lazy(() => import('./TestHighlight'));\n\nexport default function TestRoutes() {\n  return (\n    <Suspense fallback={null}>\n      <Switch>\n        <Route path=\"/test/highlight\" component={TestHighlight} />\n        <Route path=\"/\" component={Test} />\n        <Route render={() => <div>Page not found</div>} />\n      </Switch>\n    </Suspense>\n  );\n}\n","import { createRoot } from 'react-dom/client';\nimport { HashRouter, Route, Switch } from 'react-router-dom';\n\nimport Main from './demo/layouts/Main';\nimport TestRoutes from './demo/test/TestRoutes';\n\n// Reset styles so they do not affect development of the React component.\nimport 'modern-normalize/modern-normalize.css';\nimport './demo/preflight.css';\n\nimport './demo/index.css';\n\nconst rootElement = document.getElementById('root');\nif (!rootElement) {\n  throw new Error('#root element not found');\n}\n\nconst root = createRoot(rootElement);\nroot.render(\n  <HashRouter>\n    <Switch>\n      <Route path=\"/test\" component={TestRoutes} />\n      <Route path=\"/\" render={(props) => <Main {...props} />} />\n    </Switch>\n  </HashRouter>,\n);\n"],"file":"assets/index.d5ef5b83.js"}